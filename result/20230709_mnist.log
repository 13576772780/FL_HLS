nohup: ignoring input
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.269, Test loss: 2.258, Test accuracy: 27.27 

Round   0, Global train loss: 2.269, Global test loss: 2.287, Global test accuracy: 21.30 

Round   1, Train loss: 2.062, Test loss: 2.120, Test accuracy: 38.62 

Round   1, Global train loss: 2.062, Global test loss: 2.186, Global test accuracy: 26.97 

Round   2, Train loss: 2.006, Test loss: 2.042, Test accuracy: 48.10 

Round   2, Global train loss: 2.006, Global test loss: 2.224, Global test accuracy: 22.23 

Round   3, Train loss: 1.898, Test loss: 1.889, Test accuracy: 63.77 

Round   3, Global train loss: 1.898, Global test loss: 2.206, Global test accuracy: 22.05 

Round   4, Train loss: 1.591, Test loss: 1.824, Test accuracy: 68.77 

Round   4, Global train loss: 1.591, Global test loss: 2.179, Global test accuracy: 25.80 

Round   5, Train loss: 1.658, Test loss: 1.767, Test accuracy: 74.63 

Round   5, Global train loss: 1.658, Global test loss: 2.165, Global test accuracy: 35.72 

Round   6, Train loss: 1.634, Test loss: 1.696, Test accuracy: 82.33 

Round   6, Global train loss: 1.634, Global test loss: 2.197, Global test accuracy: 22.87 

Round   7, Train loss: 1.537, Test loss: 1.689, Test accuracy: 82.57 

Round   7, Global train loss: 1.537, Global test loss: 2.164, Global test accuracy: 35.98 

Round   8, Train loss: 1.562, Test loss: 1.643, Test accuracy: 85.70 

Round   8, Global train loss: 1.562, Global test loss: 2.131, Global test accuracy: 33.83 

Round   9, Train loss: 1.483, Test loss: 1.630, Test accuracy: 87.30 

Round   9, Global train loss: 1.483, Global test loss: 2.114, Global test accuracy: 39.23 

Round  10, Train loss: 1.550, Test loss: 1.604, Test accuracy: 88.05 

Round  10, Global train loss: 1.550, Global test loss: 2.190, Global test accuracy: 26.45 

Round  11, Train loss: 1.614, Test loss: 1.568, Test accuracy: 91.55 

Round  11, Global train loss: 1.614, Global test loss: 2.128, Global test accuracy: 40.33 

Round  12, Train loss: 1.476, Test loss: 1.566, Test accuracy: 91.57 

Round  12, Global train loss: 1.476, Global test loss: 2.129, Global test accuracy: 49.67 

Round  13, Train loss: 1.530, Test loss: 1.562, Test accuracy: 91.57 

Round  13, Global train loss: 1.530, Global test loss: 2.018, Global test accuracy: 47.42 

Round  14, Train loss: 1.475, Test loss: 1.560, Test accuracy: 91.70 

Round  14, Global train loss: 1.475, Global test loss: 2.030, Global test accuracy: 43.87 

Round  15, Train loss: 1.581, Test loss: 1.558, Test accuracy: 91.72 

Round  15, Global train loss: 1.581, Global test loss: 2.113, Global test accuracy: 49.10 

Round  16, Train loss: 1.534, Test loss: 1.553, Test accuracy: 91.80 

Round  16, Global train loss: 1.534, Global test loss: 2.137, Global test accuracy: 30.77 

Round  17, Train loss: 1.524, Test loss: 1.552, Test accuracy: 91.82 

Round  17, Global train loss: 1.524, Global test loss: 2.156, Global test accuracy: 30.62 

Round  18, Train loss: 1.474, Test loss: 1.551, Test accuracy: 91.83 

Round  18, Global train loss: 1.474, Global test loss: 2.131, Global test accuracy: 37.62 

Round  19, Train loss: 1.526, Test loss: 1.550, Test accuracy: 91.83 

Round  19, Global train loss: 1.526, Global test loss: 2.238, Global test accuracy: 18.53 

Round  20, Train loss: 1.575, Test loss: 1.550, Test accuracy: 91.82 

Round  20, Global train loss: 1.575, Global test loss: 2.129, Global test accuracy: 35.27 

Round  21, Train loss: 1.523, Test loss: 1.550, Test accuracy: 91.87 

Round  21, Global train loss: 1.523, Global test loss: 2.087, Global test accuracy: 37.70 

Round  22, Train loss: 1.467, Test loss: 1.550, Test accuracy: 91.83 

Round  22, Global train loss: 1.467, Global test loss: 2.093, Global test accuracy: 43.25 

Round  23, Train loss: 1.520, Test loss: 1.549, Test accuracy: 91.88 

Round  23, Global train loss: 1.520, Global test loss: 2.111, Global test accuracy: 47.15 

Round  24, Train loss: 1.575, Test loss: 1.549, Test accuracy: 91.97 

Round  24, Global train loss: 1.575, Global test loss: 2.182, Global test accuracy: 30.98 

Round  25, Train loss: 1.464, Test loss: 1.549, Test accuracy: 91.95 

Round  25, Global train loss: 1.464, Global test loss: 2.073, Global test accuracy: 49.12 

Round  26, Train loss: 1.504, Test loss: 1.536, Test accuracy: 93.42 

Round  26, Global train loss: 1.504, Global test loss: 2.163, Global test accuracy: 37.33 

Round  27, Train loss: 1.467, Test loss: 1.536, Test accuracy: 93.40 

Round  27, Global train loss: 1.467, Global test loss: 2.195, Global test accuracy: 28.87 

Round  28, Train loss: 1.573, Test loss: 1.536, Test accuracy: 93.40 

Round  28, Global train loss: 1.573, Global test loss: 2.169, Global test accuracy: 25.77 

Round  29, Train loss: 1.518, Test loss: 1.536, Test accuracy: 93.42 

Round  29, Global train loss: 1.518, Global test loss: 2.171, Global test accuracy: 22.52 

Round  30, Train loss: 1.465, Test loss: 1.536, Test accuracy: 93.40 

Round  30, Global train loss: 1.465, Global test loss: 2.095, Global test accuracy: 38.85 

Round  31, Train loss: 1.520, Test loss: 1.535, Test accuracy: 93.38 

Round  31, Global train loss: 1.520, Global test loss: 2.146, Global test accuracy: 29.78 

Round  32, Train loss: 1.525, Test loss: 1.533, Test accuracy: 93.50 

Round  32, Global train loss: 1.525, Global test loss: 2.191, Global test accuracy: 21.83 

Round  33, Train loss: 1.467, Test loss: 1.532, Test accuracy: 93.53 

Round  33, Global train loss: 1.467, Global test loss: 2.062, Global test accuracy: 42.72 

Round  34, Train loss: 1.465, Test loss: 1.532, Test accuracy: 93.52 

Round  34, Global train loss: 1.465, Global test loss: 2.097, Global test accuracy: 31.53 

Round  35, Train loss: 1.518, Test loss: 1.532, Test accuracy: 93.50 

Round  35, Global train loss: 1.518, Global test loss: 2.170, Global test accuracy: 24.58 

Round  36, Train loss: 1.464, Test loss: 1.532, Test accuracy: 93.50 

Round  36, Global train loss: 1.464, Global test loss: 2.107, Global test accuracy: 47.63 

Round  37, Train loss: 1.518, Test loss: 1.532, Test accuracy: 93.48 

Round  37, Global train loss: 1.518, Global test loss: 2.173, Global test accuracy: 25.57 

Round  38, Train loss: 1.465, Test loss: 1.532, Test accuracy: 93.48 

Round  38, Global train loss: 1.465, Global test loss: 2.151, Global test accuracy: 24.92 

Round  39, Train loss: 1.463, Test loss: 1.532, Test accuracy: 93.47 

Round  39, Global train loss: 1.463, Global test loss: 2.111, Global test accuracy: 31.27 

Round  40, Train loss: 1.462, Test loss: 1.532, Test accuracy: 93.47 

Round  40, Global train loss: 1.462, Global test loss: 2.000, Global test accuracy: 51.87 

Round  41, Train loss: 1.465, Test loss: 1.531, Test accuracy: 93.47 

Round  41, Global train loss: 1.465, Global test loss: 2.104, Global test accuracy: 35.30 

Round  42, Train loss: 1.519, Test loss: 1.531, Test accuracy: 93.45 

Round  42, Global train loss: 1.519, Global test loss: 2.099, Global test accuracy: 49.00 

Round  43, Train loss: 1.515, Test loss: 1.525, Test accuracy: 94.32 

Round  43, Global train loss: 1.515, Global test loss: 2.210, Global test accuracy: 16.95 

Round  44, Train loss: 1.464, Test loss: 1.525, Test accuracy: 94.35 

Round  44, Global train loss: 1.464, Global test loss: 2.169, Global test accuracy: 31.88 

Round  45, Train loss: 1.465, Test loss: 1.525, Test accuracy: 94.35 

Round  45, Global train loss: 1.465, Global test loss: 2.116, Global test accuracy: 38.83 

Round  46, Train loss: 1.519, Test loss: 1.525, Test accuracy: 94.35 

Round  46, Global train loss: 1.519, Global test loss: 2.058, Global test accuracy: 40.37 

Round  47, Train loss: 1.481, Test loss: 1.519, Test accuracy: 94.82 

Round  47, Global train loss: 1.481, Global test loss: 2.091, Global test accuracy: 43.53 

Round  48, Train loss: 1.473, Test loss: 1.518, Test accuracy: 94.78 

Round  48, Global train loss: 1.473, Global test loss: 2.178, Global test accuracy: 24.38 

Round  49, Train loss: 1.522, Test loss: 1.518, Test accuracy: 94.80 

Round  49, Global train loss: 1.522, Global test loss: 2.128, Global test accuracy: 34.50 

Round  50, Train loss: 1.467, Test loss: 1.518, Test accuracy: 94.80 

Round  50, Global train loss: 1.467, Global test loss: 2.091, Global test accuracy: 39.80 

Round  51, Train loss: 1.516, Test loss: 1.518, Test accuracy: 94.80 

Round  51, Global train loss: 1.516, Global test loss: 2.018, Global test accuracy: 42.42 

Round  52, Train loss: 1.464, Test loss: 1.518, Test accuracy: 94.80 

Round  52, Global train loss: 1.464, Global test loss: 2.065, Global test accuracy: 38.95 

Round  53, Train loss: 1.463, Test loss: 1.518, Test accuracy: 94.80 

Round  53, Global train loss: 1.463, Global test loss: 2.044, Global test accuracy: 42.48 

Round  54, Train loss: 1.517, Test loss: 1.518, Test accuracy: 94.80 

Round  54, Global train loss: 1.517, Global test loss: 2.052, Global test accuracy: 40.87 

Round  55, Train loss: 1.516, Test loss: 1.518, Test accuracy: 94.80 

Round  55, Global train loss: 1.516, Global test loss: 2.111, Global test accuracy: 38.88 

Round  56, Train loss: 1.465, Test loss: 1.517, Test accuracy: 94.78 

Round  56, Global train loss: 1.465, Global test loss: 2.170, Global test accuracy: 25.02 

Round  57, Train loss: 1.518, Test loss: 1.517, Test accuracy: 94.78 

Round  57, Global train loss: 1.518, Global test loss: 2.091, Global test accuracy: 36.87 

Round  58, Train loss: 1.465, Test loss: 1.517, Test accuracy: 94.80 

Round  58, Global train loss: 1.465, Global test loss: 2.097, Global test accuracy: 31.78 

Round  59, Train loss: 1.463, Test loss: 1.517, Test accuracy: 94.80 

Round  59, Global train loss: 1.463, Global test loss: 2.169, Global test accuracy: 29.60 

Round  60, Train loss: 1.466, Test loss: 1.517, Test accuracy: 94.77 

Round  60, Global train loss: 1.466, Global test loss: 2.115, Global test accuracy: 37.92 

Round  61, Train loss: 1.516, Test loss: 1.517, Test accuracy: 94.77 

Round  61, Global train loss: 1.516, Global test loss: 2.048, Global test accuracy: 39.77 

Round  62, Train loss: 1.464, Test loss: 1.517, Test accuracy: 94.77 

Round  62, Global train loss: 1.464, Global test loss: 2.102, Global test accuracy: 40.57 

Round  63, Train loss: 1.462, Test loss: 1.517, Test accuracy: 94.77 

Round  63, Global train loss: 1.462, Global test loss: 2.118, Global test accuracy: 37.03 

Round  64, Train loss: 1.517, Test loss: 1.517, Test accuracy: 94.77 

Round  64, Global train loss: 1.517, Global test loss: 2.077, Global test accuracy: 40.47 

Round  65, Train loss: 1.462, Test loss: 1.517, Test accuracy: 94.77 

Round  65, Global train loss: 1.462, Global test loss: 2.134, Global test accuracy: 37.12 

Round  66, Train loss: 1.519, Test loss: 1.517, Test accuracy: 94.77 

Round  66, Global train loss: 1.519, Global test loss: 2.139, Global test accuracy: 27.10 

Round  67, Train loss: 1.464, Test loss: 1.517, Test accuracy: 94.77 

Round  67, Global train loss: 1.464, Global test loss: 2.039, Global test accuracy: 41.22 

Round  68, Train loss: 1.464, Test loss: 1.517, Test accuracy: 94.77 

Round  68, Global train loss: 1.464, Global test loss: 2.114, Global test accuracy: 37.92 

Round  69, Train loss: 1.464, Test loss: 1.517, Test accuracy: 94.77 

Round  69, Global train loss: 1.464, Global test loss: 2.123, Global test accuracy: 34.88 

Round  70, Train loss: 1.464, Test loss: 1.517, Test accuracy: 94.77 

Round  70, Global train loss: 1.464, Global test loss: 2.057, Global test accuracy: 41.13 

Round  71, Train loss: 1.494, Test loss: 1.504, Test accuracy: 96.25 

Round  71, Global train loss: 1.494, Global test loss: 2.036, Global test accuracy: 60.25 

Round  72, Train loss: 1.464, Test loss: 1.504, Test accuracy: 96.25 

Round  72, Global train loss: 1.464, Global test loss: 2.127, Global test accuracy: 32.80 

Round  73, Train loss: 1.469, Test loss: 1.502, Test accuracy: 96.33 

Round  73, Global train loss: 1.469, Global test loss: 2.047, Global test accuracy: 42.37 

Round  74, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.33 

Round  74, Global train loss: 1.463, Global test loss: 2.059, Global test accuracy: 43.28 

Round  75, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.33 

Round  75, Global train loss: 1.464, Global test loss: 2.063, Global test accuracy: 43.93 

Round  76, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.35 

Round  76, Global train loss: 1.465, Global test loss: 2.055, Global test accuracy: 40.68 

Round  77, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  77, Global train loss: 1.464, Global test loss: 2.120, Global test accuracy: 35.80 

Round  78, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  78, Global train loss: 1.464, Global test loss: 2.114, Global test accuracy: 39.80 

Round  79, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  79, Global train loss: 1.464, Global test loss: 2.082, Global test accuracy: 44.62 

Round  80, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.35 

Round  80, Global train loss: 1.465, Global test loss: 2.142, Global test accuracy: 30.68 

Round  81, Train loss: 1.462, Test loss: 1.502, Test accuracy: 96.35 

Round  81, Global train loss: 1.462, Global test loss: 2.072, Global test accuracy: 41.30 

Round  82, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.32 

Round  82, Global train loss: 1.465, Global test loss: 2.044, Global test accuracy: 40.73 

Round  83, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.30 

Round  83, Global train loss: 1.464, Global test loss: 2.076, Global test accuracy: 38.55 

Round  84, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.30 

Round  84, Global train loss: 1.464, Global test loss: 2.132, Global test accuracy: 35.17 

Round  85, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.35 

Round  85, Global train loss: 1.465, Global test loss: 2.102, Global test accuracy: 43.85 

Round  86, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.35 

Round  86, Global train loss: 1.463, Global test loss: 2.130, Global test accuracy: 30.33 

Round  87, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  87, Global train loss: 1.464, Global test loss: 2.038, Global test accuracy: 40.67 

Round  88, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.35 

Round  88, Global train loss: 1.463, Global test loss: 2.108, Global test accuracy: 37.98 

Round  89, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.33 

Round  89, Global train loss: 1.463, Global test loss: 2.105, Global test accuracy: 36.73 

Round  90, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.35 

Round  90, Global train loss: 1.463, Global test loss: 2.000, Global test accuracy: 44.65 

Round  91, Train loss: 1.464, Test loss: 1.501, Test accuracy: 96.33 

Round  91, Global train loss: 1.464, Global test loss: 2.146, Global test accuracy: 30.28 

Round  92, Train loss: 1.464, Test loss: 1.501, Test accuracy: 96.32 

Round  92, Global train loss: 1.464, Global test loss: 2.203, Global test accuracy: 22.22 

Round  93, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.30 

Round  93, Global train loss: 1.463, Global test loss: 2.061, Global test accuracy: 42.63 

Round  94, Train loss: 1.465, Test loss: 1.501, Test accuracy: 96.30 

Round  94, Global train loss: 1.465, Global test loss: 2.213, Global test accuracy: 21.68 

Round  95, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.30 

Round  95, Global train loss: 1.463, Global test loss: 2.184, Global test accuracy: 27.93 

Round  96, Train loss: 1.464, Test loss: 1.501, Test accuracy: 96.32 

Round  96, Global train loss: 1.464, Global test loss: 2.174, Global test accuracy: 24.65 

Round  97, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.33 

Round  97, Global train loss: 1.463, Global test loss: 2.242, Global test accuracy: 18.45 

Round  98, Train loss: 1.464, Test loss: 1.501, Test accuracy: 96.33 

Round  98, Global train loss: 1.464, Global test loss: 2.104, Global test accuracy: 31.62 

Round  99, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.33 

Round  99, Global train loss: 1.463, Global test loss: 2.094, Global test accuracy: 39.13 

Final Round, Train loss: 1.463, Test loss: 1.501, Test accuracy: 96.30 

Final Round, Global train loss: 1.463, Global test loss: 2.094, Global test accuracy: 39.13 

Average accuracy final 10 rounds: 96.32166666666663 

Average global accuracy final 10 rounds: 30.325 

652.1971094608307
[1.4650397300720215, 2.0543580055236816, 2.642822027206421, 3.2454962730407715, 3.8358123302459717, 4.4255101680755615, 5.0170745849609375, 5.610614061355591, 6.204153060913086, 6.796467065811157, 7.4025444984436035, 8.004981994628906, 8.589513540267944, 9.173144817352295, 9.758314371109009, 10.348073482513428, 10.934141635894775, 11.52626633644104, 12.110948324203491, 12.698799848556519, 13.291520118713379, 13.902054071426392, 14.490164756774902, 15.079703569412231, 15.667486429214478, 16.256399154663086, 16.8415048122406, 17.43034315109253, 18.02016544342041, 18.664326429367065, 19.312561988830566, 19.95477533340454, 20.598862886428833, 21.187469720840454, 21.779533624649048, 22.374667644500732, 22.963995456695557, 23.554601669311523, 24.14235544204712, 24.731323719024658, 25.327274560928345, 25.919321537017822, 26.508034467697144, 27.10117244720459, 27.690491437911987, 28.28376054763794, 28.8763108253479, 29.46479105949402, 30.058277130126953, 30.673726081848145, 31.35386562347412, 32.04692077636719, 32.63366484642029, 33.22103476524353, 33.80750632286072, 34.40081858634949, 34.98374533653259, 35.57280993461609, 36.15923571586609, 36.74272346496582, 37.330029249191284, 37.91412568092346, 38.50000476837158, 39.09154963493347, 39.67455816268921, 40.26274561882019, 40.846136808395386, 41.43584632873535, 42.021958112716675, 42.605196475982666, 43.195727586746216, 43.77943682670593, 44.37080097198486, 44.9595365524292, 45.54555010795593, 46.13659048080444, 46.7253634929657, 47.31131315231323, 47.89371132850647, 48.476930141448975, 49.06467342376709, 49.65261888504028, 50.239879846572876, 50.82560467720032, 51.40853667259216, 51.994773626327515, 52.58142375946045, 53.170156717300415, 53.75761580467224, 54.34446573257446, 54.93343138694763, 55.52099633216858, 56.11394739151001, 56.69864845275879, 57.286107301712036, 57.8731586933136, 58.46129560470581, 59.04850101470947, 59.63441348075867, 60.220730781555176, 61.39368987083435]
[27.266666666666666, 38.61666666666667, 48.1, 63.766666666666666, 68.76666666666667, 74.63333333333334, 82.33333333333333, 82.56666666666666, 85.7, 87.3, 88.05, 91.55, 91.56666666666666, 91.56666666666666, 91.7, 91.71666666666667, 91.8, 91.81666666666666, 91.83333333333333, 91.83333333333333, 91.81666666666666, 91.86666666666666, 91.83333333333333, 91.88333333333334, 91.96666666666667, 91.95, 93.41666666666667, 93.4, 93.4, 93.41666666666667, 93.4, 93.38333333333334, 93.5, 93.53333333333333, 93.51666666666667, 93.5, 93.5, 93.48333333333333, 93.48333333333333, 93.46666666666667, 93.46666666666667, 93.46666666666667, 93.45, 94.31666666666666, 94.35, 94.35, 94.35, 94.81666666666666, 94.78333333333333, 94.8, 94.8, 94.8, 94.8, 94.8, 94.8, 94.8, 94.78333333333333, 94.78333333333333, 94.8, 94.8, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 94.76666666666667, 96.25, 96.25, 96.33333333333333, 96.33333333333333, 96.33333333333333, 96.35, 96.35, 96.35, 96.35, 96.35, 96.35, 96.31666666666666, 96.3, 96.3, 96.35, 96.35, 96.35, 96.35, 96.33333333333333, 96.35, 96.33333333333333, 96.31666666666666, 96.3, 96.3, 96.3, 96.31666666666666, 96.33333333333333, 96.33333333333333, 96.33333333333333, 96.3]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.280, Test loss: 2.280, Test accuracy: 19.85 

Round   0, Global train loss: 2.280, Global test loss: 2.296, Global test accuracy: 10.43 

Round   1, Train loss: 2.181, Test loss: 2.186, Test accuracy: 33.12 

Round   1, Global train loss: 2.181, Global test loss: 2.244, Global test accuracy: 21.07 

Round   2, Train loss: 2.000, Test loss: 2.027, Test accuracy: 56.62 

Round   2, Global train loss: 2.000, Global test loss: 2.150, Global test accuracy: 44.77 

Round   3, Train loss: 1.855, Test loss: 1.918, Test accuracy: 58.03 

Round   3, Global train loss: 1.855, Global test loss: 2.074, Global test accuracy: 41.35 

Round   4, Train loss: 1.608, Test loss: 1.821, Test accuracy: 67.67 

Round   4, Global train loss: 1.608, Global test loss: 2.038, Global test accuracy: 40.83 

Round   5, Train loss: 1.716, Test loss: 1.740, Test accuracy: 75.83 

Round   5, Global train loss: 1.716, Global test loss: 1.963, Global test accuracy: 48.95 

Round   6, Train loss: 1.673, Test loss: 1.696, Test accuracy: 80.12 

Round   6, Global train loss: 1.673, Global test loss: 1.932, Global test accuracy: 55.80 

Round   7, Train loss: 1.642, Test loss: 1.645, Test accuracy: 84.83 

Round   7, Global train loss: 1.642, Global test loss: 1.910, Global test accuracy: 58.10 

Round   8, Train loss: 1.568, Test loss: 1.643, Test accuracy: 84.72 

Round   8, Global train loss: 1.568, Global test loss: 1.897, Global test accuracy: 57.50 

Round   9, Train loss: 1.573, Test loss: 1.624, Test accuracy: 86.58 

Round   9, Global train loss: 1.573, Global test loss: 1.866, Global test accuracy: 60.18 

Round  10, Train loss: 1.625, Test loss: 1.622, Test accuracy: 86.55 

Round  10, Global train loss: 1.625, Global test loss: 1.838, Global test accuracy: 66.97 

Round  11, Train loss: 1.658, Test loss: 1.621, Test accuracy: 86.38 

Round  11, Global train loss: 1.658, Global test loss: 1.866, Global test accuracy: 60.08 

Round  12, Train loss: 1.599, Test loss: 1.620, Test accuracy: 86.52 

Round  12, Global train loss: 1.599, Global test loss: 1.843, Global test accuracy: 63.10 

Round  13, Train loss: 1.704, Test loss: 1.620, Test accuracy: 86.57 

Round  13, Global train loss: 1.704, Global test loss: 1.782, Global test accuracy: 71.95 

Round  14, Train loss: 1.546, Test loss: 1.618, Test accuracy: 86.73 

Round  14, Global train loss: 1.546, Global test loss: 1.808, Global test accuracy: 67.10 

Round  15, Train loss: 1.606, Test loss: 1.616, Test accuracy: 86.68 

Round  15, Global train loss: 1.606, Global test loss: 1.811, Global test accuracy: 67.30 

Round  16, Train loss: 1.703, Test loss: 1.614, Test accuracy: 86.88 

Round  16, Global train loss: 1.703, Global test loss: 1.815, Global test accuracy: 66.45 

Round  17, Train loss: 1.612, Test loss: 1.615, Test accuracy: 86.72 

Round  17, Global train loss: 1.612, Global test loss: 1.853, Global test accuracy: 63.38 

Round  18, Train loss: 1.589, Test loss: 1.614, Test accuracy: 86.83 

Round  18, Global train loss: 1.589, Global test loss: 1.769, Global test accuracy: 71.55 

Round  19, Train loss: 1.599, Test loss: 1.612, Test accuracy: 86.88 

Round  19, Global train loss: 1.599, Global test loss: 1.762, Global test accuracy: 73.57 

Round  20, Train loss: 1.596, Test loss: 1.610, Test accuracy: 86.92 

Round  20, Global train loss: 1.596, Global test loss: 1.774, Global test accuracy: 69.30 

Round  21, Train loss: 1.544, Test loss: 1.610, Test accuracy: 86.83 

Round  21, Global train loss: 1.544, Global test loss: 1.754, Global test accuracy: 71.57 

Round  22, Train loss: 1.544, Test loss: 1.611, Test accuracy: 86.70 

Round  22, Global train loss: 1.544, Global test loss: 1.753, Global test accuracy: 71.52 

Round  23, Train loss: 1.541, Test loss: 1.611, Test accuracy: 86.77 

Round  23, Global train loss: 1.541, Global test loss: 1.754, Global test accuracy: 71.47 

Round  24, Train loss: 1.649, Test loss: 1.595, Test accuracy: 87.03 

Round  24, Global train loss: 1.649, Global test loss: 1.769, Global test accuracy: 69.50 

Round  25, Train loss: 1.589, Test loss: 1.595, Test accuracy: 87.03 

Round  25, Global train loss: 1.589, Global test loss: 1.783, Global test accuracy: 69.58 

Round  26, Train loss: 1.592, Test loss: 1.594, Test accuracy: 87.00 

Round  26, Global train loss: 1.592, Global test loss: 1.777, Global test accuracy: 69.20 

Round  27, Train loss: 1.590, Test loss: 1.593, Test accuracy: 87.05 

Round  27, Global train loss: 1.590, Global test loss: 1.806, Global test accuracy: 65.38 

Round  28, Train loss: 1.538, Test loss: 1.594, Test accuracy: 86.95 

Round  28, Global train loss: 1.538, Global test loss: 1.764, Global test accuracy: 70.28 

Round  29, Train loss: 1.476, Test loss: 1.594, Test accuracy: 86.90 

Round  29, Global train loss: 1.476, Global test loss: 1.790, Global test accuracy: 66.68 

Round  30, Train loss: 1.583, Test loss: 1.594, Test accuracy: 86.87 

Round  30, Global train loss: 1.583, Global test loss: 1.778, Global test accuracy: 68.12 

Round  31, Train loss: 1.636, Test loss: 1.594, Test accuracy: 86.83 

Round  31, Global train loss: 1.636, Global test loss: 1.786, Global test accuracy: 67.40 

Round  32, Train loss: 1.593, Test loss: 1.594, Test accuracy: 86.83 

Round  32, Global train loss: 1.593, Global test loss: 1.723, Global test accuracy: 74.90 

Round  33, Train loss: 1.543, Test loss: 1.594, Test accuracy: 86.98 

Round  33, Global train loss: 1.543, Global test loss: 1.742, Global test accuracy: 72.00 

Round  34, Train loss: 1.583, Test loss: 1.593, Test accuracy: 87.00 

Round  34, Global train loss: 1.583, Global test loss: 1.725, Global test accuracy: 75.45 

Round  35, Train loss: 1.587, Test loss: 1.594, Test accuracy: 86.97 

Round  35, Global train loss: 1.587, Global test loss: 1.770, Global test accuracy: 69.17 

Round  36, Train loss: 1.688, Test loss: 1.594, Test accuracy: 86.97 

Round  36, Global train loss: 1.688, Global test loss: 1.720, Global test accuracy: 74.37 

Round  37, Train loss: 1.529, Test loss: 1.594, Test accuracy: 87.00 

Round  37, Global train loss: 1.529, Global test loss: 1.750, Global test accuracy: 72.12 

Round  38, Train loss: 1.639, Test loss: 1.595, Test accuracy: 86.98 

Round  38, Global train loss: 1.639, Global test loss: 1.743, Global test accuracy: 73.22 

Round  39, Train loss: 1.542, Test loss: 1.592, Test accuracy: 87.18 

Round  39, Global train loss: 1.542, Global test loss: 1.716, Global test accuracy: 75.53 

Round  40, Train loss: 1.481, Test loss: 1.592, Test accuracy: 87.22 

Round  40, Global train loss: 1.481, Global test loss: 1.708, Global test accuracy: 77.28 

Round  41, Train loss: 1.589, Test loss: 1.591, Test accuracy: 87.28 

Round  41, Global train loss: 1.589, Global test loss: 1.699, Global test accuracy: 78.72 

Round  42, Train loss: 1.580, Test loss: 1.591, Test accuracy: 87.27 

Round  42, Global train loss: 1.580, Global test loss: 1.726, Global test accuracy: 74.88 

Round  43, Train loss: 1.478, Test loss: 1.589, Test accuracy: 87.40 

Round  43, Global train loss: 1.478, Global test loss: 1.793, Global test accuracy: 67.22 

Round  44, Train loss: 1.528, Test loss: 1.590, Test accuracy: 87.38 

Round  44, Global train loss: 1.528, Global test loss: 1.745, Global test accuracy: 71.75 

Round  45, Train loss: 1.529, Test loss: 1.591, Test accuracy: 87.28 

Round  45, Global train loss: 1.529, Global test loss: 1.712, Global test accuracy: 75.90 

Round  46, Train loss: 1.579, Test loss: 1.590, Test accuracy: 87.30 

Round  46, Global train loss: 1.579, Global test loss: 1.717, Global test accuracy: 75.70 

Round  47, Train loss: 1.583, Test loss: 1.590, Test accuracy: 87.27 

Round  47, Global train loss: 1.583, Global test loss: 1.707, Global test accuracy: 76.10 

Round  48, Train loss: 1.586, Test loss: 1.589, Test accuracy: 87.28 

Round  48, Global train loss: 1.586, Global test loss: 1.726, Global test accuracy: 75.17 

Round  49, Train loss: 1.580, Test loss: 1.590, Test accuracy: 87.17 

Round  49, Global train loss: 1.580, Global test loss: 1.773, Global test accuracy: 68.33 

Round  50, Train loss: 1.586, Test loss: 1.590, Test accuracy: 87.18 

Round  50, Global train loss: 1.586, Global test loss: 1.688, Global test accuracy: 79.07 

Round  51, Train loss: 1.532, Test loss: 1.590, Test accuracy: 87.17 

Round  51, Global train loss: 1.532, Global test loss: 1.694, Global test accuracy: 77.93 

Round  52, Train loss: 1.532, Test loss: 1.589, Test accuracy: 87.30 

Round  52, Global train loss: 1.532, Global test loss: 1.694, Global test accuracy: 77.85 

Round  53, Train loss: 1.525, Test loss: 1.589, Test accuracy: 87.33 

Round  53, Global train loss: 1.525, Global test loss: 1.743, Global test accuracy: 71.70 

Round  54, Train loss: 1.641, Test loss: 1.590, Test accuracy: 87.23 

Round  54, Global train loss: 1.641, Global test loss: 1.693, Global test accuracy: 77.47 

Round  55, Train loss: 1.477, Test loss: 1.589, Test accuracy: 87.30 

Round  55, Global train loss: 1.477, Global test loss: 1.708, Global test accuracy: 75.72 

Round  56, Train loss: 1.579, Test loss: 1.589, Test accuracy: 87.33 

Round  56, Global train loss: 1.579, Global test loss: 1.724, Global test accuracy: 74.05 

Round  57, Train loss: 1.485, Test loss: 1.589, Test accuracy: 87.23 

Round  57, Global train loss: 1.485, Global test loss: 1.708, Global test accuracy: 75.92 

Round  58, Train loss: 1.527, Test loss: 1.589, Test accuracy: 87.32 

Round  58, Global train loss: 1.527, Global test loss: 1.703, Global test accuracy: 76.25 

Round  59, Train loss: 1.529, Test loss: 1.589, Test accuracy: 87.35 

Round  59, Global train loss: 1.529, Global test loss: 1.690, Global test accuracy: 78.42 

Round  60, Train loss: 1.578, Test loss: 1.588, Test accuracy: 87.35 

Round  60, Global train loss: 1.578, Global test loss: 1.710, Global test accuracy: 75.40 

Round  61, Train loss: 1.532, Test loss: 1.589, Test accuracy: 87.33 

Round  61, Global train loss: 1.532, Global test loss: 1.701, Global test accuracy: 76.70 

Round  62, Train loss: 1.584, Test loss: 1.589, Test accuracy: 87.28 

Round  62, Global train loss: 1.584, Global test loss: 1.705, Global test accuracy: 75.67 

Round  63, Train loss: 1.580, Test loss: 1.589, Test accuracy: 87.28 

Round  63, Global train loss: 1.580, Global test loss: 1.694, Global test accuracy: 77.13 

Round  64, Train loss: 1.579, Test loss: 1.589, Test accuracy: 87.33 

Round  64, Global train loss: 1.579, Global test loss: 1.682, Global test accuracy: 79.35 

Round  65, Train loss: 1.522, Test loss: 1.589, Test accuracy: 87.30 

Round  65, Global train loss: 1.522, Global test loss: 1.696, Global test accuracy: 77.05 

Round  66, Train loss: 1.524, Test loss: 1.589, Test accuracy: 87.27 

Round  66, Global train loss: 1.524, Global test loss: 1.699, Global test accuracy: 76.77 

Round  67, Train loss: 1.691, Test loss: 1.589, Test accuracy: 87.33 

Round  67, Global train loss: 1.691, Global test loss: 1.699, Global test accuracy: 76.47 

Round  68, Train loss: 1.633, Test loss: 1.589, Test accuracy: 87.23 

Round  68, Global train loss: 1.633, Global test loss: 1.676, Global test accuracy: 80.03 

Round  69, Train loss: 1.477, Test loss: 1.588, Test accuracy: 87.37 

Round  69, Global train loss: 1.477, Global test loss: 1.722, Global test accuracy: 74.37 

Round  70, Train loss: 1.581, Test loss: 1.588, Test accuracy: 87.35 

Round  70, Global train loss: 1.581, Global test loss: 1.675, Global test accuracy: 79.80 

Round  71, Train loss: 1.522, Test loss: 1.588, Test accuracy: 87.33 

Round  71, Global train loss: 1.522, Global test loss: 1.675, Global test accuracy: 79.83 

Round  72, Train loss: 1.581, Test loss: 1.588, Test accuracy: 87.35 

Round  72, Global train loss: 1.581, Global test loss: 1.686, Global test accuracy: 78.48 

Round  73, Train loss: 1.635, Test loss: 1.588, Test accuracy: 87.35 

Round  73, Global train loss: 1.635, Global test loss: 1.704, Global test accuracy: 76.23 

Round  74, Train loss: 1.582, Test loss: 1.588, Test accuracy: 87.30 

Round  74, Global train loss: 1.582, Global test loss: 1.675, Global test accuracy: 79.83 

Round  75, Train loss: 1.528, Test loss: 1.588, Test accuracy: 87.35 

Round  75, Global train loss: 1.528, Global test loss: 1.682, Global test accuracy: 78.83 

Round  76, Train loss: 1.583, Test loss: 1.588, Test accuracy: 87.35 

Round  76, Global train loss: 1.583, Global test loss: 1.724, Global test accuracy: 73.88 

Round  77, Train loss: 1.631, Test loss: 1.588, Test accuracy: 87.37 

Round  77, Global train loss: 1.631, Global test loss: 1.743, Global test accuracy: 71.83 

Round  78, Train loss: 1.687, Test loss: 1.588, Test accuracy: 87.38 

Round  78, Global train loss: 1.687, Global test loss: 1.708, Global test accuracy: 75.38 

Round  79, Train loss: 1.522, Test loss: 1.588, Test accuracy: 87.42 

Round  79, Global train loss: 1.522, Global test loss: 1.694, Global test accuracy: 77.68 

Round  80, Train loss: 1.583, Test loss: 1.588, Test accuracy: 87.38 

Round  80, Global train loss: 1.583, Global test loss: 1.708, Global test accuracy: 75.47 

Round  81, Train loss: 1.574, Test loss: 1.588, Test accuracy: 87.37 

Round  81, Global train loss: 1.574, Global test loss: 1.696, Global test accuracy: 76.62 

Round  82, Train loss: 1.580, Test loss: 1.588, Test accuracy: 87.37 

Round  82, Global train loss: 1.580, Global test loss: 1.702, Global test accuracy: 75.92 

Round  83, Train loss: 1.523, Test loss: 1.588, Test accuracy: 87.33 

Round  83, Global train loss: 1.523, Global test loss: 1.700, Global test accuracy: 76.30 

Round  84, Train loss: 1.633, Test loss: 1.588, Test accuracy: 87.30 

Round  84, Global train loss: 1.633, Global test loss: 1.700, Global test accuracy: 76.65 

Round  85, Train loss: 1.527, Test loss: 1.589, Test accuracy: 87.30 

Round  85, Global train loss: 1.527, Global test loss: 1.686, Global test accuracy: 78.60 

Round  86, Train loss: 1.524, Test loss: 1.588, Test accuracy: 87.38 

Round  86, Global train loss: 1.524, Global test loss: 1.676, Global test accuracy: 79.92 

Round  87, Train loss: 1.474, Test loss: 1.587, Test accuracy: 87.50 

Round  87, Global train loss: 1.474, Global test loss: 1.688, Global test accuracy: 77.92 

Round  88, Train loss: 1.576, Test loss: 1.588, Test accuracy: 87.42 

Round  88, Global train loss: 1.576, Global test loss: 1.681, Global test accuracy: 78.83 

Round  89, Train loss: 1.578, Test loss: 1.588, Test accuracy: 87.43 

Round  89, Global train loss: 1.578, Global test loss: 1.676, Global test accuracy: 79.22 

Round  90, Train loss: 1.631, Test loss: 1.588, Test accuracy: 87.42 

Round  90, Global train loss: 1.631, Global test loss: 1.679, Global test accuracy: 79.32 

Round  91, Train loss: 1.576, Test loss: 1.588, Test accuracy: 87.47 

Round  91, Global train loss: 1.576, Global test loss: 1.672, Global test accuracy: 79.95 

Round  92, Train loss: 1.524, Test loss: 1.588, Test accuracy: 87.45 

Round  92, Global train loss: 1.524, Global test loss: 1.674, Global test accuracy: 79.45 

Round  93, Train loss: 1.525, Test loss: 1.588, Test accuracy: 87.37 

Round  93, Global train loss: 1.525, Global test loss: 1.685, Global test accuracy: 78.70 

Round  94, Train loss: 1.632, Test loss: 1.588, Test accuracy: 87.37 

Round  94, Global train loss: 1.632, Global test loss: 1.667, Global test accuracy: 80.68 

Round  95, Train loss: 1.577, Test loss: 1.588, Test accuracy: 87.38 

Round  95, Global train loss: 1.577, Global test loss: 1.693, Global test accuracy: 77.27 

Round  96, Train loss: 1.524, Test loss: 1.588, Test accuracy: 87.45 

Round  96, Global train loss: 1.524, Global test loss: 1.675, Global test accuracy: 79.50 

Round  97, Train loss: 1.523, Test loss: 1.587, Test accuracy: 87.43 

Round  97, Global train loss: 1.523, Global test loss: 1.713, Global test accuracy: 74.50 

Round  98, Train loss: 1.578, Test loss: 1.588, Test accuracy: 87.40 

Round  98, Global train loss: 1.578, Global test loss: 1.674, Global test accuracy: 79.83 

Round  99, Train loss: 1.575, Test loss: 1.588, Test accuracy: 87.47 

Round  99, Global train loss: 1.575, Global test loss: 1.664, Global test accuracy: 80.63 

Final Round, Train loss: 1.565, Test loss: 1.586, Test accuracy: 87.50 

Final Round, Global train loss: 1.565, Global test loss: 1.664, Global test accuracy: 80.63 

Average accuracy final 10 rounds: 87.42 

Average global accuracy final 10 rounds: 78.98333333333333 

746.5535604953766
[1.6014251708984375, 2.1951727867126465, 2.7908174991607666, 3.3890268802642822, 3.9859719276428223, 4.5861570835113525, 5.184910297393799, 5.779228925704956, 6.378106594085693, 6.980371952056885, 7.578032493591309, 8.16996693611145, 8.770514488220215, 9.36950945854187, 9.967469453811646, 10.565001010894775, 11.160156726837158, 11.752393960952759, 12.345791578292847, 12.942706823348999, 13.536969661712646, 14.132174491882324, 14.724433422088623, 15.320131778717041, 15.917118787765503, 16.514114141464233, 17.10880208015442, 17.70607089996338, 18.325695037841797, 18.92170238494873, 19.521172285079956, 20.119988203048706, 20.716620206832886, 21.317784070968628, 21.91459584236145, 22.517305850982666, 23.114508867263794, 23.804584503173828, 24.498064041137695, 25.20022463798523, 25.90266752243042, 26.602327823638916, 27.3033447265625, 28.0027437210083, 28.70413851737976, 29.40250015258789, 30.102283716201782, 30.802085638046265, 31.499823570251465, 32.19856905937195, 32.9120831489563, 33.60951471328735, 34.311158418655396, 35.003751039505005, 35.70211172103882, 36.39452886581421, 37.0905442237854, 37.7872588634491, 38.48433876037598, 39.17180562019348, 39.85078835487366, 40.54537272453308, 41.23726940155029, 41.93205809593201, 42.62511348724365, 43.31722640991211, 43.968053579330444, 44.620039224624634, 45.27059841156006, 45.93428039550781, 46.58337664604187, 47.23536944389343, 47.88515257835388, 48.527438163757324, 49.12080502510071, 49.711857080459595, 50.30285096168518, 50.89245796203613, 51.48260974884033, 52.07214665412903, 52.66640496253967, 53.256675243377686, 53.85114502906799, 54.446550607681274, 55.04069757461548, 55.633246660232544, 56.22499489784241, 56.818970680236816, 57.41653919219971, 58.008644342422485, 58.6018922328949, 59.195655822753906, 59.7846896648407, 60.37859225273132, 60.96971082687378, 61.56254839897156, 62.15688157081604, 62.74882364273071, 63.34007716178894, 63.93201804161072, 65.13472890853882]
[19.85, 33.11666666666667, 56.61666666666667, 58.03333333333333, 67.66666666666667, 75.83333333333333, 80.11666666666666, 84.83333333333333, 84.71666666666667, 86.58333333333333, 86.55, 86.38333333333334, 86.51666666666667, 86.56666666666666, 86.73333333333333, 86.68333333333334, 86.88333333333334, 86.71666666666667, 86.83333333333333, 86.88333333333334, 86.91666666666667, 86.83333333333333, 86.7, 86.76666666666667, 87.03333333333333, 87.03333333333333, 87.0, 87.05, 86.95, 86.9, 86.86666666666666, 86.83333333333333, 86.83333333333333, 86.98333333333333, 87.0, 86.96666666666667, 86.96666666666667, 87.0, 86.98333333333333, 87.18333333333334, 87.21666666666667, 87.28333333333333, 87.26666666666667, 87.4, 87.38333333333334, 87.28333333333333, 87.3, 87.26666666666667, 87.28333333333333, 87.16666666666667, 87.18333333333334, 87.16666666666667, 87.3, 87.33333333333333, 87.23333333333333, 87.3, 87.33333333333333, 87.23333333333333, 87.31666666666666, 87.35, 87.35, 87.33333333333333, 87.28333333333333, 87.28333333333333, 87.33333333333333, 87.3, 87.26666666666667, 87.33333333333333, 87.23333333333333, 87.36666666666666, 87.35, 87.33333333333333, 87.35, 87.35, 87.3, 87.35, 87.35, 87.36666666666666, 87.38333333333334, 87.41666666666667, 87.38333333333334, 87.36666666666666, 87.36666666666666, 87.33333333333333, 87.3, 87.3, 87.38333333333334, 87.5, 87.41666666666667, 87.43333333333334, 87.41666666666667, 87.46666666666667, 87.45, 87.36666666666666, 87.36666666666666, 87.38333333333334, 87.45, 87.43333333333334, 87.4, 87.46666666666667, 87.5]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.295, Test loss: 2.299, Test accuracy: 28.43 

Round   1, Train loss: 2.293, Test loss: 2.297, Test accuracy: 20.68 

Round   2, Train loss: 2.284, Test loss: 2.291, Test accuracy: 15.93 

Round   3, Train loss: 2.264, Test loss: 2.277, Test accuracy: 31.93 

Round   4, Train loss: 2.175, Test loss: 2.204, Test accuracy: 34.60 

Round   5, Train loss: 2.027, Test loss: 2.078, Test accuracy: 46.00 

Round   6, Train loss: 1.818, Test loss: 1.942, Test accuracy: 59.15 

Round   7, Train loss: 1.813, Test loss: 1.876, Test accuracy: 63.50 

Round   8, Train loss: 1.765, Test loss: 1.792, Test accuracy: 72.47 

Round   9, Train loss: 1.675, Test loss: 1.757, Test accuracy: 74.73 

Round  10, Train loss: 1.722, Test loss: 1.717, Test accuracy: 78.12 

Round  11, Train loss: 1.622, Test loss: 1.690, Test accuracy: 79.88 

Round  12, Train loss: 1.600, Test loss: 1.671, Test accuracy: 81.33 

Round  13, Train loss: 1.535, Test loss: 1.652, Test accuracy: 83.18 

Round  14, Train loss: 1.586, Test loss: 1.627, Test accuracy: 85.67 

Round  15, Train loss: 1.534, Test loss: 1.609, Test accuracy: 87.18 

Round  16, Train loss: 1.580, Test loss: 1.601, Test accuracy: 88.20 

Round  17, Train loss: 1.617, Test loss: 1.582, Test accuracy: 90.13 

Round  18, Train loss: 1.555, Test loss: 1.580, Test accuracy: 90.20 

Round  19, Train loss: 1.545, Test loss: 1.577, Test accuracy: 90.22 

Round  20, Train loss: 1.554, Test loss: 1.574, Test accuracy: 90.42 

Round  21, Train loss: 1.563, Test loss: 1.569, Test accuracy: 90.78 

Round  22, Train loss: 1.561, Test loss: 1.567, Test accuracy: 90.73 

Round  23, Train loss: 1.537, Test loss: 1.558, Test accuracy: 91.55 

Round  24, Train loss: 1.515, Test loss: 1.556, Test accuracy: 91.67 

Round  25, Train loss: 1.561, Test loss: 1.553, Test accuracy: 92.03 

Round  26, Train loss: 1.491, Test loss: 1.552, Test accuracy: 92.05 

Round  27, Train loss: 1.549, Test loss: 1.551, Test accuracy: 92.05 

Round  28, Train loss: 1.545, Test loss: 1.545, Test accuracy: 92.65 

Round  29, Train loss: 1.549, Test loss: 1.544, Test accuracy: 92.82 

Round  30, Train loss: 1.541, Test loss: 1.543, Test accuracy: 92.77 

Round  31, Train loss: 1.498, Test loss: 1.543, Test accuracy: 92.75 

Round  32, Train loss: 1.558, Test loss: 1.535, Test accuracy: 93.82 

Round  33, Train loss: 1.513, Test loss: 1.538, Test accuracy: 93.10 

Round  34, Train loss: 1.551, Test loss: 1.533, Test accuracy: 93.62 

Round  35, Train loss: 1.493, Test loss: 1.529, Test accuracy: 93.98 

Round  36, Train loss: 1.565, Test loss: 1.526, Test accuracy: 94.27 

Round  37, Train loss: 1.489, Test loss: 1.525, Test accuracy: 94.33 

Round  38, Train loss: 1.491, Test loss: 1.524, Test accuracy: 94.42 

Round  39, Train loss: 1.489, Test loss: 1.523, Test accuracy: 94.42 

Round  40, Train loss: 1.480, Test loss: 1.523, Test accuracy: 94.43 

Round  41, Train loss: 1.477, Test loss: 1.523, Test accuracy: 94.40 

Round  42, Train loss: 1.486, Test loss: 1.523, Test accuracy: 94.42 

Round  43, Train loss: 1.478, Test loss: 1.522, Test accuracy: 94.47 

Round  44, Train loss: 1.528, Test loss: 1.523, Test accuracy: 94.52 

Round  45, Train loss: 1.489, Test loss: 1.522, Test accuracy: 94.48 

Round  46, Train loss: 1.537, Test loss: 1.522, Test accuracy: 94.55 

Round  47, Train loss: 1.486, Test loss: 1.522, Test accuracy: 94.48 

Round  48, Train loss: 1.474, Test loss: 1.523, Test accuracy: 94.28 

Round  49, Train loss: 1.539, Test loss: 1.522, Test accuracy: 94.33 

Round  50, Train loss: 1.529, Test loss: 1.521, Test accuracy: 94.55 

Round  51, Train loss: 1.476, Test loss: 1.521, Test accuracy: 94.47 

Round  52, Train loss: 1.481, Test loss: 1.521, Test accuracy: 94.45 

Round  53, Train loss: 1.490, Test loss: 1.520, Test accuracy: 94.52 

Round  54, Train loss: 1.541, Test loss: 1.519, Test accuracy: 94.70 

Round  55, Train loss: 1.535, Test loss: 1.519, Test accuracy: 94.73 

Round  56, Train loss: 1.480, Test loss: 1.519, Test accuracy: 94.67 

Round  57, Train loss: 1.530, Test loss: 1.519, Test accuracy: 94.62 

Round  58, Train loss: 1.477, Test loss: 1.518, Test accuracy: 94.67 

Round  59, Train loss: 1.479, Test loss: 1.519, Test accuracy: 94.63 

Round  60, Train loss: 1.474, Test loss: 1.518, Test accuracy: 94.70 

Round  61, Train loss: 1.475, Test loss: 1.518, Test accuracy: 94.82 

Round  62, Train loss: 1.529, Test loss: 1.518, Test accuracy: 94.72 

Round  63, Train loss: 1.477, Test loss: 1.518, Test accuracy: 94.67 

Round  64, Train loss: 1.534, Test loss: 1.517, Test accuracy: 94.83 

Round  65, Train loss: 1.479, Test loss: 1.517, Test accuracy: 94.68 

Round  66, Train loss: 1.531, Test loss: 1.517, Test accuracy: 94.72 

Round  67, Train loss: 1.531, Test loss: 1.516, Test accuracy: 94.87 

Round  68, Train loss: 1.530, Test loss: 1.516, Test accuracy: 94.85 

Round  69, Train loss: 1.480, Test loss: 1.517, Test accuracy: 94.93 

Round  70, Train loss: 1.529, Test loss: 1.516, Test accuracy: 94.90 

Round  71, Train loss: 1.471, Test loss: 1.516, Test accuracy: 94.93 

Round  72, Train loss: 1.477, Test loss: 1.517, Test accuracy: 94.88 

Round  73, Train loss: 1.476, Test loss: 1.517, Test accuracy: 94.93 

Round  74, Train loss: 1.533, Test loss: 1.516, Test accuracy: 94.92 

Round  75, Train loss: 1.472, Test loss: 1.516, Test accuracy: 94.88 

Round  76, Train loss: 1.475, Test loss: 1.516, Test accuracy: 94.88 

Round  77, Train loss: 1.471, Test loss: 1.515, Test accuracy: 95.00 

Round  78, Train loss: 1.475, Test loss: 1.515, Test accuracy: 94.95 

Round  79, Train loss: 1.521, Test loss: 1.515, Test accuracy: 94.95 

Round  80, Train loss: 1.481, Test loss: 1.515, Test accuracy: 94.95 

Round  81, Train loss: 1.524, Test loss: 1.515, Test accuracy: 95.05 

Round  82, Train loss: 1.477, Test loss: 1.515, Test accuracy: 94.97 

Round  83, Train loss: 1.481, Test loss: 1.515, Test accuracy: 95.05 

Round  84, Train loss: 1.475, Test loss: 1.515, Test accuracy: 94.98 

Round  85, Train loss: 1.527, Test loss: 1.515, Test accuracy: 94.97 

Round  86, Train loss: 1.473, Test loss: 1.515, Test accuracy: 95.13 

Round  87, Train loss: 1.471, Test loss: 1.515, Test accuracy: 95.07 

Round  88, Train loss: 1.478, Test loss: 1.515, Test accuracy: 94.92 

Round  89, Train loss: 1.469, Test loss: 1.515, Test accuracy: 94.98 

Round  90, Train loss: 1.476, Test loss: 1.515, Test accuracy: 94.92 

Round  91, Train loss: 1.467, Test loss: 1.515, Test accuracy: 94.92 

Round  92, Train loss: 1.466, Test loss: 1.514, Test accuracy: 94.92 

Round  93, Train loss: 1.527, Test loss: 1.514, Test accuracy: 95.02 

Round  94, Train loss: 1.472, Test loss: 1.514, Test accuracy: 95.05 

Round  95, Train loss: 1.479, Test loss: 1.514, Test accuracy: 95.10 

Round  96, Train loss: 1.532, Test loss: 1.514, Test accuracy: 95.08 

Round  97, Train loss: 1.472, Test loss: 1.513, Test accuracy: 95.12 

Round  98, Train loss: 1.473, Test loss: 1.513, Test accuracy: 95.13 

Round  99, Train loss: 1.472, Test loss: 1.513, Test accuracy: 95.22 

Final Round, Train loss: 1.488, Test loss: 1.513, Test accuracy: 95.15 

Average accuracy final 10 rounds: 95.04666666666667 

459.8310375213623
[1.41548490524292, 1.9306426048278809, 2.4466893672943115, 2.9610564708709717, 3.474958896636963, 3.9912796020507812, 4.505531072616577, 5.002230167388916, 5.516467571258545, 6.031285762786865, 6.49928879737854, 6.959951400756836, 7.4745166301727295, 7.988731622695923, 8.50260329246521, 9.01661467552185, 9.53407335281372, 10.05400037765503, 10.571184158325195, 11.088685512542725, 11.605015993118286, 12.11953330039978, 12.641242265701294, 13.1553955078125, 13.706205368041992, 14.262246370315552, 14.778850793838501, 15.295682430267334, 15.813244581222534, 16.331392288208008, 16.84620690345764, 17.361530542373657, 17.877166032791138, 18.396649599075317, 18.91102123260498, 19.424102544784546, 19.93790340423584, 20.449831247329712, 20.963085651397705, 21.479249477386475, 21.994608640670776, 22.512831449508667, 23.03652286529541, 23.55162811279297, 24.063190937042236, 24.57368803024292, 25.083949327468872, 25.59587597846985, 26.112110376358032, 26.622535228729248, 27.158196687698364, 27.673701524734497, 28.189647912979126, 28.703350067138672, 29.212626934051514, 29.725547790527344, 30.238015174865723, 30.75587010383606, 31.268832206726074, 31.782814741134644, 32.29901337623596, 32.815590143203735, 33.33074498176575, 33.844218254089355, 34.36136603355408, 34.900338888168335, 35.41896152496338, 35.937763690948486, 36.45154666900635, 36.96688771247864, 37.48259925842285, 37.99971604347229, 38.52315855026245, 39.03583073616028, 39.55177092552185, 40.06324505805969, 40.58158588409424, 41.10110688209534, 41.62358212471008, 42.13546085357666, 42.65500545501709, 43.173499584198, 43.689932346343994, 44.21147155761719, 44.725427865982056, 45.242661237716675, 45.691582441329956, 46.13523244857788, 46.583003759384155, 47.089287996292114, 47.60446333885193, 48.125483989715576, 48.63994526863098, 49.15678429603577, 49.67005467414856, 50.184510946273804, 50.69908595085144, 51.2128381729126, 51.733686208724976, 52.25374627113342, 53.18171525001526]
[28.433333333333334, 20.683333333333334, 15.933333333333334, 31.933333333333334, 34.6, 46.0, 59.15, 63.5, 72.46666666666667, 74.73333333333333, 78.11666666666666, 79.88333333333334, 81.33333333333333, 83.18333333333334, 85.66666666666667, 87.18333333333334, 88.2, 90.13333333333334, 90.2, 90.21666666666667, 90.41666666666667, 90.78333333333333, 90.73333333333333, 91.55, 91.66666666666667, 92.03333333333333, 92.05, 92.05, 92.65, 92.81666666666666, 92.76666666666667, 92.75, 93.81666666666666, 93.1, 93.61666666666666, 93.98333333333333, 94.26666666666667, 94.33333333333333, 94.41666666666667, 94.41666666666667, 94.43333333333334, 94.4, 94.41666666666667, 94.46666666666667, 94.51666666666667, 94.48333333333333, 94.55, 94.48333333333333, 94.28333333333333, 94.33333333333333, 94.55, 94.46666666666667, 94.45, 94.51666666666667, 94.7, 94.73333333333333, 94.66666666666667, 94.61666666666666, 94.66666666666667, 94.63333333333334, 94.7, 94.81666666666666, 94.71666666666667, 94.66666666666667, 94.83333333333333, 94.68333333333334, 94.71666666666667, 94.86666666666666, 94.85, 94.93333333333334, 94.9, 94.93333333333334, 94.88333333333334, 94.93333333333334, 94.91666666666667, 94.88333333333334, 94.88333333333334, 95.0, 94.95, 94.95, 94.95, 95.05, 94.96666666666667, 95.05, 94.98333333333333, 94.96666666666667, 95.13333333333334, 95.06666666666666, 94.91666666666667, 94.98333333333333, 94.91666666666667, 94.91666666666667, 94.91666666666667, 95.01666666666667, 95.05, 95.1, 95.08333333333333, 95.11666666666666, 95.13333333333334, 95.21666666666667, 95.15]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedper  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedper , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedper
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.288, Test loss: 2.299, Test accuracy: 16.00 

Round   1, Train loss: 2.244, Test loss: 2.265, Test accuracy: 53.80 

Round   2, Train loss: 2.010, Test loss: 2.099, Test accuracy: 51.22 

Round   3, Train loss: 1.662, Test loss: 1.894, Test accuracy: 60.55 

Round   4, Train loss: 1.624, Test loss: 1.827, Test accuracy: 66.53 

Round   5, Train loss: 1.552, Test loss: 1.754, Test accuracy: 74.13 

Round   6, Train loss: 1.565, Test loss: 1.711, Test accuracy: 79.18 

Round   7, Train loss: 1.624, Test loss: 1.653, Test accuracy: 84.02 

Round   8, Train loss: 1.532, Test loss: 1.611, Test accuracy: 87.47 

Round   9, Train loss: 1.508, Test loss: 1.580, Test accuracy: 90.48 

Round  10, Train loss: 1.503, Test loss: 1.578, Test accuracy: 90.07 

Round  11, Train loss: 1.543, Test loss: 1.573, Test accuracy: 90.50 

Round  12, Train loss: 1.559, Test loss: 1.556, Test accuracy: 92.32 

Round  13, Train loss: 1.505, Test loss: 1.547, Test accuracy: 92.92 

Round  14, Train loss: 1.490, Test loss: 1.542, Test accuracy: 93.17 

Round  15, Train loss: 1.491, Test loss: 1.541, Test accuracy: 93.25 

Round  16, Train loss: 1.502, Test loss: 1.535, Test accuracy: 93.50 

Round  17, Train loss: 1.489, Test loss: 1.533, Test accuracy: 93.60 

Round  18, Train loss: 1.512, Test loss: 1.520, Test accuracy: 95.08 

Round  19, Train loss: 1.487, Test loss: 1.519, Test accuracy: 95.13 

Round  20, Train loss: 1.472, Test loss: 1.520, Test accuracy: 95.05 

Round  21, Train loss: 1.483, Test loss: 1.518, Test accuracy: 95.18 

Round  22, Train loss: 1.481, Test loss: 1.517, Test accuracy: 95.18 

Round  23, Train loss: 1.484, Test loss: 1.516, Test accuracy: 95.17 

Round  24, Train loss: 1.483, Test loss: 1.515, Test accuracy: 95.22 

Round  25, Train loss: 1.483, Test loss: 1.512, Test accuracy: 95.57 

Round  26, Train loss: 1.475, Test loss: 1.512, Test accuracy: 95.52 

Round  27, Train loss: 1.477, Test loss: 1.511, Test accuracy: 95.48 

Round  28, Train loss: 1.481, Test loss: 1.509, Test accuracy: 95.82 

Round  29, Train loss: 1.475, Test loss: 1.510, Test accuracy: 95.62 

Round  30, Train loss: 1.470, Test loss: 1.510, Test accuracy: 95.65 

Round  31, Train loss: 1.482, Test loss: 1.507, Test accuracy: 95.85 

Round  32, Train loss: 1.473, Test loss: 1.507, Test accuracy: 95.83 

Round  33, Train loss: 1.472, Test loss: 1.506, Test accuracy: 95.97 

Round  34, Train loss: 1.476, Test loss: 1.506, Test accuracy: 95.98 

Round  35, Train loss: 1.474, Test loss: 1.506, Test accuracy: 95.98 

Round  36, Train loss: 1.473, Test loss: 1.506, Test accuracy: 95.85 

Round  37, Train loss: 1.473, Test loss: 1.506, Test accuracy: 95.92 

Round  38, Train loss: 1.476, Test loss: 1.505, Test accuracy: 95.97 

Round  39, Train loss: 1.471, Test loss: 1.505, Test accuracy: 95.92 

Round  40, Train loss: 1.476, Test loss: 1.504, Test accuracy: 96.07 

Round  41, Train loss: 1.479, Test loss: 1.504, Test accuracy: 96.08 

Round  42, Train loss: 1.473, Test loss: 1.503, Test accuracy: 96.07 

Round  43, Train loss: 1.470, Test loss: 1.503, Test accuracy: 96.15 

Round  44, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.17 

Round  45, Train loss: 1.473, Test loss: 1.503, Test accuracy: 96.15 

Round  46, Train loss: 1.470, Test loss: 1.502, Test accuracy: 96.23 

Round  47, Train loss: 1.468, Test loss: 1.502, Test accuracy: 96.27 

Round  48, Train loss: 1.476, Test loss: 1.502, Test accuracy: 96.38 

Round  49, Train loss: 1.472, Test loss: 1.502, Test accuracy: 96.37 

Round  50, Train loss: 1.470, Test loss: 1.502, Test accuracy: 96.35 

Round  51, Train loss: 1.471, Test loss: 1.502, Test accuracy: 96.35 

Round  52, Train loss: 1.468, Test loss: 1.502, Test accuracy: 96.33 

Round  53, Train loss: 1.470, Test loss: 1.502, Test accuracy: 96.32 

Round  54, Train loss: 1.467, Test loss: 1.502, Test accuracy: 96.37 

Round  55, Train loss: 1.473, Test loss: 1.501, Test accuracy: 96.48 

Round  56, Train loss: 1.473, Test loss: 1.501, Test accuracy: 96.45 

Round  57, Train loss: 1.468, Test loss: 1.500, Test accuracy: 96.45 

Round  58, Train loss: 1.470, Test loss: 1.501, Test accuracy: 96.48 

Round  59, Train loss: 1.469, Test loss: 1.500, Test accuracy: 96.48 

Round  60, Train loss: 1.468, Test loss: 1.500, Test accuracy: 96.40 

Round  61, Train loss: 1.473, Test loss: 1.500, Test accuracy: 96.50 

Round  62, Train loss: 1.468, Test loss: 1.500, Test accuracy: 96.45 

Round  63, Train loss: 1.466, Test loss: 1.500, Test accuracy: 96.47 

Round  64, Train loss: 1.465, Test loss: 1.500, Test accuracy: 96.50 

Round  65, Train loss: 1.469, Test loss: 1.500, Test accuracy: 96.48 

Round  66, Train loss: 1.471, Test loss: 1.500, Test accuracy: 96.45 

Round  67, Train loss: 1.467, Test loss: 1.500, Test accuracy: 96.45 

Round  68, Train loss: 1.468, Test loss: 1.500, Test accuracy: 96.45 

Round  69, Train loss: 1.472, Test loss: 1.499, Test accuracy: 96.47 

Round  70, Train loss: 1.468, Test loss: 1.499, Test accuracy: 96.52 

Round  71, Train loss: 1.467, Test loss: 1.499, Test accuracy: 96.50 

Round  72, Train loss: 1.471, Test loss: 1.499, Test accuracy: 96.50 

Round  73, Train loss: 1.465, Test loss: 1.499, Test accuracy: 96.53 

Round  74, Train loss: 1.472, Test loss: 1.499, Test accuracy: 96.55 

Round  75, Train loss: 1.470, Test loss: 1.499, Test accuracy: 96.57 

Round  76, Train loss: 1.466, Test loss: 1.499, Test accuracy: 96.52 

Round  77, Train loss: 1.472, Test loss: 1.499, Test accuracy: 96.52 

Round  78, Train loss: 1.471, Test loss: 1.499, Test accuracy: 96.52 

Round  79, Train loss: 1.467, Test loss: 1.499, Test accuracy: 96.53 

Round  80, Train loss: 1.468, Test loss: 1.499, Test accuracy: 96.55 

Round  81, Train loss: 1.467, Test loss: 1.499, Test accuracy: 96.50 

Round  82, Train loss: 1.468, Test loss: 1.499, Test accuracy: 96.55 

Round  83, Train loss: 1.467, Test loss: 1.499, Test accuracy: 96.53 

Round  84, Train loss: 1.467, Test loss: 1.499, Test accuracy: 96.52 

Round  85, Train loss: 1.466, Test loss: 1.499, Test accuracy: 96.52 

Round  86, Train loss: 1.470, Test loss: 1.498, Test accuracy: 96.50 

Round  87, Train loss: 1.469, Test loss: 1.498, Test accuracy: 96.55 

Round  88, Train loss: 1.467, Test loss: 1.498, Test accuracy: 96.50 

Round  89, Train loss: 1.469, Test loss: 1.498, Test accuracy: 96.48 

Round  90, Train loss: 1.468, Test loss: 1.498, Test accuracy: 96.43 

Round  91, Train loss: 1.470, Test loss: 1.498, Test accuracy: 96.47 

Round  92, Train loss: 1.466, Test loss: 1.498, Test accuracy: 96.47 

Round  93, Train loss: 1.466, Test loss: 1.499, Test accuracy: 96.48 

Round  94, Train loss: 1.473, Test loss: 1.498, Test accuracy: 96.50 

Round  95, Train loss: 1.467, Test loss: 1.498, Test accuracy: 96.48 

Round  96, Train loss: 1.470, Test loss: 1.498, Test accuracy: 96.52 

Round  97, Train loss: 1.468, Test loss: 1.498, Test accuracy: 96.53 

Round  98, Train loss: 1.466, Test loss: 1.498, Test accuracy: 96.48 

Round  99, Train loss: 1.467, Test loss: 1.498, Test accuracy: 96.50 

Final Round, Train loss: 1.468, Test loss: 1.498, Test accuracy: 96.57 

Average accuracy final 10 rounds: 96.48666666666668 

509.0891807079315
[1.4811089038848877, 2.1682045459747314, 2.7590389251708984, 3.3623900413513184, 3.956371545791626, 4.552495956420898, 5.146643161773682, 5.752705097198486, 6.352917909622192, 6.949147462844849, 7.543980836868286, 8.13835620880127, 8.735885858535767, 9.333631753921509, 9.92557978630066, 10.519485473632812, 11.115533828735352, 11.708572626113892, 12.302374124526978, 12.887477159500122, 13.48830270767212, 14.072013854980469, 14.681075811386108, 15.265517711639404, 15.847821235656738, 16.433264017105103, 17.01828384399414, 17.60096049308777, 18.18204092979431, 18.76431703567505, 19.400965929031372, 20.03843402862549, 20.672035217285156, 21.312023878097534, 21.9484703540802, 22.590327262878418, 23.228775024414062, 23.86715269088745, 24.505317449569702, 25.142186641693115, 25.778148889541626, 26.41555166244507, 27.05374002456665, 27.691673517227173, 28.328871488571167, 28.9672429561615, 29.60610008239746, 30.246842622756958, 30.88212013244629, 31.522895336151123, 32.157089948654175, 32.735127210617065, 33.31273674964905, 33.895267724990845, 34.47786211967468, 35.0642466545105, 35.64890003204346, 36.233638048172, 36.85689568519592, 37.44623684883118, 38.04003071784973, 38.57872676849365, 39.16456127166748, 39.756696462631226, 40.35281014442444, 40.9431734085083, 41.534313678741455, 42.124751806259155, 42.712889432907104, 43.2984983921051, 43.88929581642151, 44.478320598602295, 45.066263914108276, 45.65574669837952, 46.24412298202515, 46.832913637161255, 47.42219066619873, 48.01138782501221, 48.600624084472656, 49.19071626663208, 49.779491901397705, 50.3709671497345, 50.9613721370697, 51.55235528945923, 52.14005970954895, 52.72565150260925, 53.31264781951904, 53.89870095252991, 54.51712965965271, 55.10276913642883, 55.68744134902954, 56.27204775810242, 56.85527849197388, 57.44170141220093, 58.02927088737488, 58.6173255443573, 59.20741033554077, 59.80058765411377, 60.39355731010437, 60.981972455978394, 61.905277252197266]
[16.0, 53.8, 51.21666666666667, 60.55, 66.53333333333333, 74.13333333333334, 79.18333333333334, 84.01666666666667, 87.46666666666667, 90.48333333333333, 90.06666666666666, 90.5, 92.31666666666666, 92.91666666666667, 93.16666666666667, 93.25, 93.5, 93.6, 95.08333333333333, 95.13333333333334, 95.05, 95.18333333333334, 95.18333333333334, 95.16666666666667, 95.21666666666667, 95.56666666666666, 95.51666666666667, 95.48333333333333, 95.81666666666666, 95.61666666666666, 95.65, 95.85, 95.83333333333333, 95.96666666666667, 95.98333333333333, 95.98333333333333, 95.85, 95.91666666666667, 95.96666666666667, 95.91666666666667, 96.06666666666666, 96.08333333333333, 96.06666666666666, 96.15, 96.16666666666667, 96.15, 96.23333333333333, 96.26666666666667, 96.38333333333334, 96.36666666666666, 96.35, 96.35, 96.33333333333333, 96.31666666666666, 96.36666666666666, 96.48333333333333, 96.45, 96.45, 96.48333333333333, 96.48333333333333, 96.4, 96.5, 96.45, 96.46666666666667, 96.5, 96.48333333333333, 96.45, 96.45, 96.45, 96.46666666666667, 96.51666666666667, 96.5, 96.5, 96.53333333333333, 96.55, 96.56666666666666, 96.51666666666667, 96.51666666666667, 96.51666666666667, 96.53333333333333, 96.55, 96.5, 96.55, 96.53333333333333, 96.51666666666667, 96.51666666666667, 96.5, 96.55, 96.5, 96.48333333333333, 96.43333333333334, 96.46666666666667, 96.46666666666667, 96.48333333333333, 96.5, 96.48333333333333, 96.51666666666667, 96.53333333333333, 96.48333333333333, 96.5, 96.56666666666666]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: lg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

lg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 17098 (global); Percentage 3.11 (17098/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.286, Test loss: 2.297, Test accuracy: 16.83 

Round   1, Train loss: 2.243, Test loss: 2.252, Test accuracy: 22.50 

Round   2, Train loss: 2.064, Test loss: 2.161, Test accuracy: 44.67 

Round   3, Train loss: 1.813, Test loss: 2.052, Test accuracy: 50.15 

Round   4, Train loss: 1.801, Test loss: 1.970, Test accuracy: 60.62 

Round   5, Train loss: 1.682, Test loss: 1.904, Test accuracy: 66.47 

Round   6, Train loss: 1.779, Test loss: 1.844, Test accuracy: 73.78 

Round   7, Train loss: 1.562, Test loss: 1.776, Test accuracy: 75.98 

Round   8, Train loss: 1.544, Test loss: 1.724, Test accuracy: 82.42 

Round   9, Train loss: 1.548, Test loss: 1.665, Test accuracy: 85.23 

Round  10, Train loss: 1.503, Test loss: 1.626, Test accuracy: 87.82 

Round  11, Train loss: 1.513, Test loss: 1.585, Test accuracy: 91.25 

Round  12, Train loss: 1.484, Test loss: 1.566, Test accuracy: 92.65 

Round  13, Train loss: 1.478, Test loss: 1.561, Test accuracy: 93.13 

Round  14, Train loss: 1.485, Test loss: 1.552, Test accuracy: 93.67 

Round  15, Train loss: 1.479, Test loss: 1.546, Test accuracy: 94.22 

Round  16, Train loss: 1.478, Test loss: 1.542, Test accuracy: 94.40 

Round  17, Train loss: 1.478, Test loss: 1.532, Test accuracy: 94.82 

Round  18, Train loss: 1.477, Test loss: 1.525, Test accuracy: 95.27 

Round  19, Train loss: 1.472, Test loss: 1.522, Test accuracy: 95.50 

Round  20, Train loss: 1.474, Test loss: 1.518, Test accuracy: 95.43 

Round  21, Train loss: 1.468, Test loss: 1.516, Test accuracy: 95.65 

Round  22, Train loss: 1.469, Test loss: 1.515, Test accuracy: 95.77 

Round  23, Train loss: 1.468, Test loss: 1.514, Test accuracy: 95.80 

Round  24, Train loss: 1.470, Test loss: 1.513, Test accuracy: 95.87 

Round  25, Train loss: 1.470, Test loss: 1.511, Test accuracy: 95.95 

Round  26, Train loss: 1.467, Test loss: 1.511, Test accuracy: 96.03 

Round  27, Train loss: 1.470, Test loss: 1.509, Test accuracy: 96.12 

Round  28, Train loss: 1.467, Test loss: 1.509, Test accuracy: 96.12 

Round  29, Train loss: 1.469, Test loss: 1.508, Test accuracy: 96.22 

Round  30, Train loss: 1.465, Test loss: 1.507, Test accuracy: 96.25 

Round  31, Train loss: 1.466, Test loss: 1.507, Test accuracy: 96.20 

Round  32, Train loss: 1.464, Test loss: 1.507, Test accuracy: 96.13 

Round  33, Train loss: 1.465, Test loss: 1.506, Test accuracy: 96.28 

Round  34, Train loss: 1.466, Test loss: 1.506, Test accuracy: 96.13 

Round  35, Train loss: 1.465, Test loss: 1.506, Test accuracy: 96.13 

Round  36, Train loss: 1.465, Test loss: 1.505, Test accuracy: 96.32 

Round  37, Train loss: 1.464, Test loss: 1.505, Test accuracy: 96.30 

Round  38, Train loss: 1.465, Test loss: 1.504, Test accuracy: 96.37 

Round  39, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.32 

Round  40, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.37 

Round  41, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.37 

Round  42, Train loss: 1.467, Test loss: 1.504, Test accuracy: 96.40 

Round  43, Train loss: 1.465, Test loss: 1.504, Test accuracy: 96.40 

Round  44, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.37 

Round  45, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.40 

Round  46, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.32 

Round  47, Train loss: 1.463, Test loss: 1.504, Test accuracy: 96.37 

Round  48, Train loss: 1.465, Test loss: 1.504, Test accuracy: 96.37 

Round  49, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.32 

Round  50, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.30 

Round  51, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.28 

Round  52, Train loss: 1.463, Test loss: 1.503, Test accuracy: 96.27 

Round  53, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.30 

Round  54, Train loss: 1.463, Test loss: 1.503, Test accuracy: 96.28 

Round  55, Train loss: 1.463, Test loss: 1.503, Test accuracy: 96.30 

Round  56, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.32 

Round  57, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.32 

Round  58, Train loss: 1.463, Test loss: 1.503, Test accuracy: 96.30 

Round  59, Train loss: 1.464, Test loss: 1.503, Test accuracy: 96.27 

Round  60, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.27 

Round  61, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.32 

Round  62, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.35 

Round  63, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.35 

Round  64, Train loss: 1.464, Test loss: 1.503, Test accuracy: 96.35 

Round  65, Train loss: 1.463, Test loss: 1.503, Test accuracy: 96.35 

Round  66, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.33 

Round  67, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  68, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.33 

Round  69, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.30 

Round  70, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.30 

Round  71, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.27 

Round  72, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.37 

Round  73, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.33 

Round  74, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.33 

Round  75, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.38 

Round  76, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  77, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.38 

Round  78, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.37 

Round  79, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.37 

Round  80, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.38 

Round  81, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.37 

Round  82, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.35 

Round  83, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.35 

Round  84, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.35 

Round  85, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.33 

Round  86, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.37 

Round  87, Train loss: 1.467, Test loss: 1.502, Test accuracy: 96.42 

Round  88, Train loss: 1.462, Test loss: 1.502, Test accuracy: 96.40 

Round  89, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.38 

Round  90, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.38 

Round  91, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.38 

Round  92, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.38 

Round  93, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.38 

Round  94, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.42 

Round  95, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.42 

Round  96, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.40 

Round  97, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.40 

Round  98, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.38 

Round  99, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.38 

Final Round, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.38 

Average accuracy final 10 rounds: 96.39333333333333 

528.1285178661346
[1.4939236640930176, 2.1695196628570557, 2.7430853843688965, 3.3202528953552246, 3.8541176319122314, 4.383889198303223, 4.910131454467773, 5.432661533355713, 5.955057144165039, 6.479443550109863, 6.999091148376465, 7.5256359577178955, 8.046600580215454, 8.570656299591064, 9.095114707946777, 9.722193241119385, 10.354270935058594, 10.982712268829346, 11.611611127853394, 12.24130654335022, 12.867833137512207, 13.495660305023193, 14.123596906661987, 14.753964185714722, 15.38259768486023, 16.006409406661987, 16.62930989265442, 17.254693508148193, 17.876299619674683, 18.503862619400024, 19.12791085243225, 19.756598949432373, 20.382556676864624, 21.006877183914185, 21.632918119430542, 22.258233785629272, 22.884800672531128, 23.511000156402588, 24.13636875152588, 24.761881589889526, 25.384504318237305, 25.991571187973022, 26.602367401123047, 27.21274495124817, 27.825164794921875, 28.433441400527954, 29.048675060272217, 29.658076763153076, 30.281746864318848, 30.914981603622437, 31.545036554336548, 32.17381548881531, 32.80058240890503, 33.42676877975464, 34.05404353141785, 34.679242849349976, 35.30349135398865, 35.93156337738037, 36.56198310852051, 37.189223766326904, 37.8166081905365, 38.44986176490784, 39.08019185066223, 39.706228733062744, 40.338133573532104, 40.972251415252686, 41.60103130340576, 42.230592012405396, 42.858471155166626, 43.48620080947876, 44.116780281066895, 44.748021841049194, 45.37888240814209, 46.00715613365173, 46.633583784103394, 47.26168632507324, 47.89023566246033, 48.519169330596924, 49.14487957954407, 49.77261137962341, 50.40930247306824, 51.04014992713928, 51.67315912246704, 52.308515310287476, 52.941007137298584, 53.57349610328674, 54.211729288101196, 54.84385275840759, 55.47336673736572, 56.108885526657104, 56.74622941017151, 57.37715530395508, 58.01462173461914, 58.64727592468262, 59.28103232383728, 59.91127967834473, 60.53979563713074, 61.17558574676514, 61.80630159378052, 62.437774896621704, 63.53046488761902]
[16.833333333333332, 22.5, 44.666666666666664, 50.15, 60.61666666666667, 66.46666666666667, 73.78333333333333, 75.98333333333333, 82.41666666666667, 85.23333333333333, 87.81666666666666, 91.25, 92.65, 93.13333333333334, 93.66666666666667, 94.21666666666667, 94.4, 94.81666666666666, 95.26666666666667, 95.5, 95.43333333333334, 95.65, 95.76666666666667, 95.8, 95.86666666666666, 95.95, 96.03333333333333, 96.11666666666666, 96.11666666666666, 96.21666666666667, 96.25, 96.2, 96.13333333333334, 96.28333333333333, 96.13333333333334, 96.13333333333334, 96.31666666666666, 96.3, 96.36666666666666, 96.31666666666666, 96.36666666666666, 96.36666666666666, 96.4, 96.4, 96.36666666666666, 96.4, 96.31666666666666, 96.36666666666666, 96.36666666666666, 96.31666666666666, 96.3, 96.28333333333333, 96.26666666666667, 96.3, 96.28333333333333, 96.3, 96.31666666666666, 96.31666666666666, 96.3, 96.26666666666667, 96.26666666666667, 96.31666666666666, 96.35, 96.35, 96.35, 96.35, 96.33333333333333, 96.35, 96.33333333333333, 96.3, 96.3, 96.26666666666667, 96.36666666666666, 96.33333333333333, 96.33333333333333, 96.38333333333334, 96.35, 96.38333333333334, 96.36666666666666, 96.36666666666666, 96.38333333333334, 96.36666666666666, 96.35, 96.35, 96.35, 96.33333333333333, 96.36666666666666, 96.41666666666667, 96.4, 96.38333333333334, 96.38333333333334, 96.38333333333334, 96.38333333333334, 96.38333333333334, 96.41666666666667, 96.41666666666667, 96.4, 96.4, 96.38333333333334, 96.38333333333334, 96.38333333333334]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.318, Test loss: 2.300, Test accuracy: 14.60
Round   1, Train loss: 2.289, Test loss: 2.294, Test accuracy: 41.98
Round   2, Train loss: 2.265, Test loss: 2.263, Test accuracy: 16.17
Round   3, Train loss: 2.211, Test loss: 2.222, Test accuracy: 40.85
Round   4, Train loss: 2.091, Test loss: 2.139, Test accuracy: 47.85
Round   5, Train loss: 2.041, Test loss: 2.037, Test accuracy: 53.60
Round   6, Train loss: 1.859, Test loss: 1.967, Test accuracy: 57.73
Round   7, Train loss: 1.762, Test loss: 1.881, Test accuracy: 63.12
Round   8, Train loss: 1.744, Test loss: 1.815, Test accuracy: 67.67
Round   9, Train loss: 1.737, Test loss: 1.727, Test accuracy: 80.02
Round  10, Train loss: 1.680, Test loss: 1.684, Test accuracy: 83.85
Round  11, Train loss: 1.600, Test loss: 1.660, Test accuracy: 85.53
Round  12, Train loss: 1.589, Test loss: 1.641, Test accuracy: 87.18
Round  13, Train loss: 1.605, Test loss: 1.607, Test accuracy: 90.55
Round  14, Train loss: 1.585, Test loss: 1.585, Test accuracy: 93.13
Round  15, Train loss: 1.554, Test loss: 1.573, Test accuracy: 93.85
Round  16, Train loss: 1.572, Test loss: 1.562, Test accuracy: 94.30
Round  17, Train loss: 1.515, Test loss: 1.562, Test accuracy: 94.12
Round  18, Train loss: 1.549, Test loss: 1.556, Test accuracy: 94.27
Round  19, Train loss: 1.529, Test loss: 1.549, Test accuracy: 95.07
Round  20, Train loss: 1.526, Test loss: 1.545, Test accuracy: 95.12
Round  21, Train loss: 1.518, Test loss: 1.542, Test accuracy: 95.18
Round  22, Train loss: 1.530, Test loss: 1.536, Test accuracy: 95.63
Round  23, Train loss: 1.518, Test loss: 1.533, Test accuracy: 95.58
Round  24, Train loss: 1.521, Test loss: 1.531, Test accuracy: 95.87
Round  25, Train loss: 1.516, Test loss: 1.529, Test accuracy: 95.93
Round  26, Train loss: 1.505, Test loss: 1.527, Test accuracy: 96.10
Round  27, Train loss: 1.501, Test loss: 1.527, Test accuracy: 96.12
Round  28, Train loss: 1.505, Test loss: 1.525, Test accuracy: 96.07
Round  29, Train loss: 1.506, Test loss: 1.523, Test accuracy: 96.15
Round  30, Train loss: 1.503, Test loss: 1.523, Test accuracy: 96.23
Round  31, Train loss: 1.510, Test loss: 1.521, Test accuracy: 96.30
Round  32, Train loss: 1.496, Test loss: 1.521, Test accuracy: 96.35
Round  33, Train loss: 1.499, Test loss: 1.519, Test accuracy: 96.48
Round  34, Train loss: 1.501, Test loss: 1.517, Test accuracy: 96.62
Round  35, Train loss: 1.490, Test loss: 1.518, Test accuracy: 96.38
Round  36, Train loss: 1.501, Test loss: 1.516, Test accuracy: 96.52
Round  37, Train loss: 1.492, Test loss: 1.517, Test accuracy: 96.38
Round  38, Train loss: 1.508, Test loss: 1.516, Test accuracy: 96.43
Round  39, Train loss: 1.504, Test loss: 1.516, Test accuracy: 96.53
Round  40, Train loss: 1.498, Test loss: 1.516, Test accuracy: 96.43
Round  41, Train loss: 1.486, Test loss: 1.516, Test accuracy: 96.45
Round  42, Train loss: 1.489, Test loss: 1.516, Test accuracy: 96.47
Round  43, Train loss: 1.487, Test loss: 1.515, Test accuracy: 96.50
Round  44, Train loss: 1.491, Test loss: 1.514, Test accuracy: 96.58
Round  45, Train loss: 1.493, Test loss: 1.512, Test accuracy: 96.67
Round  46, Train loss: 1.488, Test loss: 1.511, Test accuracy: 96.63
Round  47, Train loss: 1.499, Test loss: 1.510, Test accuracy: 96.75
Round  48, Train loss: 1.493, Test loss: 1.509, Test accuracy: 96.88
Round  49, Train loss: 1.492, Test loss: 1.509, Test accuracy: 96.73
Round  50, Train loss: 1.502, Test loss: 1.509, Test accuracy: 96.83
Round  51, Train loss: 1.483, Test loss: 1.508, Test accuracy: 96.98
Round  52, Train loss: 1.488, Test loss: 1.508, Test accuracy: 96.88
Round  53, Train loss: 1.481, Test loss: 1.507, Test accuracy: 96.95
Round  54, Train loss: 1.495, Test loss: 1.506, Test accuracy: 97.02
Round  55, Train loss: 1.480, Test loss: 1.507, Test accuracy: 97.03
Round  56, Train loss: 1.485, Test loss: 1.506, Test accuracy: 97.03
Round  57, Train loss: 1.488, Test loss: 1.506, Test accuracy: 96.90
Round  58, Train loss: 1.482, Test loss: 1.506, Test accuracy: 96.95
Round  59, Train loss: 1.479, Test loss: 1.506, Test accuracy: 96.92
Round  60, Train loss: 1.482, Test loss: 1.506, Test accuracy: 96.95
Round  61, Train loss: 1.486, Test loss: 1.505, Test accuracy: 97.10
Round  62, Train loss: 1.479, Test loss: 1.505, Test accuracy: 97.05
Round  63, Train loss: 1.484, Test loss: 1.505, Test accuracy: 97.13
Round  64, Train loss: 1.483, Test loss: 1.505, Test accuracy: 97.18
Round  65, Train loss: 1.487, Test loss: 1.505, Test accuracy: 97.13
Round  66, Train loss: 1.480, Test loss: 1.504, Test accuracy: 97.13
Round  67, Train loss: 1.486, Test loss: 1.504, Test accuracy: 97.13
Round  68, Train loss: 1.484, Test loss: 1.504, Test accuracy: 97.08
Round  69, Train loss: 1.480, Test loss: 1.503, Test accuracy: 97.18
Round  70, Train loss: 1.490, Test loss: 1.504, Test accuracy: 97.20
Round  71, Train loss: 1.479, Test loss: 1.504, Test accuracy: 97.13
Round  72, Train loss: 1.484, Test loss: 1.505, Test accuracy: 97.05
Round  73, Train loss: 1.487, Test loss: 1.504, Test accuracy: 97.17
Round  74, Train loss: 1.481, Test loss: 1.502, Test accuracy: 97.13
Round  75, Train loss: 1.485, Test loss: 1.503, Test accuracy: 97.17
Round  76, Train loss: 1.480, Test loss: 1.501, Test accuracy: 97.25
Round  77, Train loss: 1.482, Test loss: 1.501, Test accuracy: 97.25
Round  78, Train loss: 1.480, Test loss: 1.500, Test accuracy: 97.30
Round  79, Train loss: 1.475, Test loss: 1.500, Test accuracy: 97.25
Round  80, Train loss: 1.477, Test loss: 1.500, Test accuracy: 97.38
Round  81, Train loss: 1.486, Test loss: 1.500, Test accuracy: 97.28
Round  82, Train loss: 1.478, Test loss: 1.500, Test accuracy: 97.35
Round  83, Train loss: 1.475, Test loss: 1.500, Test accuracy: 97.40
Round  84, Train loss: 1.479, Test loss: 1.499, Test accuracy: 97.45
Round  85, Train loss: 1.477, Test loss: 1.499, Test accuracy: 97.45
Round  86, Train loss: 1.476, Test loss: 1.499, Test accuracy: 97.40
Round  87, Train loss: 1.478, Test loss: 1.499, Test accuracy: 97.47
Round  88, Train loss: 1.479, Test loss: 1.499, Test accuracy: 97.37
Round  89, Train loss: 1.475, Test loss: 1.498, Test accuracy: 97.45
Round  90, Train loss: 1.472, Test loss: 1.498, Test accuracy: 97.50
Round  91, Train loss: 1.477, Test loss: 1.498, Test accuracy: 97.47
Round  92, Train loss: 1.479, Test loss: 1.497, Test accuracy: 97.52
Round  93, Train loss: 1.477, Test loss: 1.497, Test accuracy: 97.43
Round  94, Train loss: 1.473, Test loss: 1.497, Test accuracy: 97.47
Round  95, Train loss: 1.480, Test loss: 1.497, Test accuracy: 97.47
Round  96, Train loss: 1.478, Test loss: 1.498, Test accuracy: 97.37
Round  97, Train loss: 1.474, Test loss: 1.497, Test accuracy: 97.48
Round  98, Train loss: 1.475, Test loss: 1.497, Test accuracy: 97.53
Round  99, Train loss: 1.473, Test loss: 1.497, Test accuracy: 97.58
Final Round, Train loss: 1.471, Test loss: 1.496, Test accuracy: 97.55
Average accuracy final 10 rounds: 97.48166666666665
530.501284122467
[1.539189338684082, 2.184631109237671, 2.8221123218536377, 3.4558889865875244, 4.088024139404297, 4.72885799407959, 5.340730905532837, 5.9566709995269775, 6.583445310592651, 7.225446701049805, 7.864195823669434, 8.492310762405396, 9.119369983673096, 9.752099514007568, 10.370814561843872, 10.995246171951294, 11.628437995910645, 12.26639986038208, 12.897707462310791, 13.515915870666504, 14.149413108825684, 14.77174162864685, 15.404642105102539, 16.034712314605713, 16.66974902153015, 17.296042442321777, 17.906925916671753, 18.521932363510132, 19.153183221817017, 19.777358055114746, 20.41064476966858, 21.0539333820343, 21.697205781936646, 22.33921194076538, 22.97358226776123, 23.612399339675903, 24.248423099517822, 24.88591432571411, 25.5234854221344, 26.16295099258423, 26.83024024963379, 27.46148133277893, 28.09467577934265, 28.729780912399292, 29.362704753875732, 29.99527931213379, 30.62679934501648, 31.260244131088257, 31.893626928329468, 32.525219678878784, 33.15984034538269, 33.794004678726196, 34.433327436447144, 35.065139055252075, 35.7006950378418, 36.33378577232361, 36.969624042510986, 37.60654616355896, 38.244751930236816, 38.878265619277954, 39.51081824302673, 40.145336866378784, 40.78243088722229, 41.41772937774658, 42.051679611206055, 42.686524391174316, 43.32202458381653, 43.959028005599976, 44.5929696559906, 45.22570013999939, 45.85671663284302, 46.49201989173889, 47.12777018547058, 47.76121497154236, 48.41027617454529, 49.04465627670288, 49.680800437927246, 50.31701636314392, 50.94880771636963, 51.580498695373535, 52.20969295501709, 52.841618061065674, 53.47260093688965, 54.106382846832275, 54.735265493392944, 55.368096113204956, 55.998467445373535, 56.62789845466614, 57.259764671325684, 57.894829988479614, 58.52703046798706, 59.158061027526855, 59.80206298828125, 60.43277406692505, 61.08671712875366, 61.716514587402344, 62.35107922554016, 62.986398458480835, 63.62100672721863, 64.25498914718628, 65.20561122894287]
[14.6, 41.983333333333334, 16.166666666666668, 40.85, 47.85, 53.6, 57.733333333333334, 63.11666666666667, 67.66666666666667, 80.01666666666667, 83.85, 85.53333333333333, 87.18333333333334, 90.55, 93.13333333333334, 93.85, 94.3, 94.11666666666666, 94.26666666666667, 95.06666666666666, 95.11666666666666, 95.18333333333334, 95.63333333333334, 95.58333333333333, 95.86666666666666, 95.93333333333334, 96.1, 96.11666666666666, 96.06666666666666, 96.15, 96.23333333333333, 96.3, 96.35, 96.48333333333333, 96.61666666666666, 96.38333333333334, 96.51666666666667, 96.38333333333334, 96.43333333333334, 96.53333333333333, 96.43333333333334, 96.45, 96.46666666666667, 96.5, 96.58333333333333, 96.66666666666667, 96.63333333333334, 96.75, 96.88333333333334, 96.73333333333333, 96.83333333333333, 96.98333333333333, 96.88333333333334, 96.95, 97.01666666666667, 97.03333333333333, 97.03333333333333, 96.9, 96.95, 96.91666666666667, 96.95, 97.1, 97.05, 97.13333333333334, 97.18333333333334, 97.13333333333334, 97.13333333333334, 97.13333333333334, 97.08333333333333, 97.18333333333334, 97.2, 97.13333333333334, 97.05, 97.16666666666667, 97.13333333333334, 97.16666666666667, 97.25, 97.25, 97.3, 97.25, 97.38333333333334, 97.28333333333333, 97.35, 97.4, 97.45, 97.45, 97.4, 97.46666666666667, 97.36666666666666, 97.45, 97.5, 97.46666666666667, 97.51666666666667, 97.43333333333334, 97.46666666666667, 97.46666666666667, 97.36666666666666, 97.48333333333333, 97.53333333333333, 97.58333333333333, 97.55]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_ditto%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
Round   0, Train loss: 2.291, Test loss: 2.293, Test accuracy: 15.03
Round   1, Train loss: 2.213, Test loss: 2.239, Test accuracy: 23.47
Round   2, Train loss: 2.115, Test loss: 2.199, Test accuracy: 43.97
Round   3, Train loss: 1.922, Test loss: 2.080, Test accuracy: 50.80
Round   4, Train loss: 1.762, Test loss: 2.007, Test accuracy: 45.80
Round   5, Train loss: 1.604, Test loss: 1.945, Test accuracy: 54.83
Round   6, Train loss: 1.631, Test loss: 1.886, Test accuracy: 63.52
Round   7, Train loss: 1.543, Test loss: 1.945, Test accuracy: 50.70
Round   8, Train loss: 1.532, Test loss: 1.844, Test accuracy: 67.52
Round   9, Train loss: 1.583, Test loss: 1.823, Test accuracy: 69.30
Round  10, Train loss: 1.574, Test loss: 1.812, Test accuracy: 69.77
Round  11, Train loss: 1.597, Test loss: 1.764, Test accuracy: 76.08
Round  12, Train loss: 1.535, Test loss: 1.861, Test accuracy: 59.85
Round  13, Train loss: 1.501, Test loss: 1.787, Test accuracy: 68.43
Round  14, Train loss: 1.571, Test loss: 1.737, Test accuracy: 77.82
Round  15, Train loss: 1.539, Test loss: 1.739, Test accuracy: 76.30
Round  16, Train loss: 1.485, Test loss: 1.737, Test accuracy: 75.53
Round  17, Train loss: 1.496, Test loss: 1.820, Test accuracy: 65.12
Round  18, Train loss: 1.540, Test loss: 1.754, Test accuracy: 72.38
Round  19, Train loss: 1.556, Test loss: 1.780, Test accuracy: 69.67
Round  20, Train loss: 1.487, Test loss: 1.761, Test accuracy: 70.78
Round  21, Train loss: 1.546, Test loss: 1.706, Test accuracy: 78.53
Round  22, Train loss: 1.487, Test loss: 1.700, Test accuracy: 78.85
Round  23, Train loss: 1.485, Test loss: 1.712, Test accuracy: 77.07
Round  24, Train loss: 1.488, Test loss: 1.703, Test accuracy: 78.12
Round  25, Train loss: 1.493, Test loss: 1.696, Test accuracy: 79.05
Round  26, Train loss: 1.484, Test loss: 1.672, Test accuracy: 80.47
Round  27, Train loss: 1.488, Test loss: 1.701, Test accuracy: 77.72
Round  28, Train loss: 1.483, Test loss: 1.706, Test accuracy: 76.42
Round  29, Train loss: 1.531, Test loss: 1.655, Test accuracy: 82.82
Round  30, Train loss: 1.532, Test loss: 1.655, Test accuracy: 82.80
Round  31, Train loss: 1.537, Test loss: 1.653, Test accuracy: 83.03
Round  32, Train loss: 1.474, Test loss: 1.673, Test accuracy: 80.77
Round  33, Train loss: 1.474, Test loss: 1.673, Test accuracy: 80.22
Round  34, Train loss: 1.525, Test loss: 1.649, Test accuracy: 83.05
Round  35, Train loss: 1.483, Test loss: 1.664, Test accuracy: 80.72
Round  36, Train loss: 1.480, Test loss: 1.663, Test accuracy: 81.35
Round  37, Train loss: 1.470, Test loss: 1.650, Test accuracy: 82.58
Round  38, Train loss: 1.525, Test loss: 1.680, Test accuracy: 79.65
Round  39, Train loss: 1.582, Test loss: 1.663, Test accuracy: 81.42
Round  40, Train loss: 1.482, Test loss: 1.639, Test accuracy: 84.05
Round  41, Train loss: 1.525, Test loss: 1.646, Test accuracy: 83.27
Round  42, Train loss: 1.483, Test loss: 1.662, Test accuracy: 81.82
Round  43, Train loss: 1.471, Test loss: 1.643, Test accuracy: 83.50
Round  44, Train loss: 1.475, Test loss: 1.647, Test accuracy: 82.82
Round  45, Train loss: 1.531, Test loss: 1.641, Test accuracy: 83.33
Round  46, Train loss: 1.470, Test loss: 1.631, Test accuracy: 84.52
Round  47, Train loss: 1.476, Test loss: 1.648, Test accuracy: 82.32
Round  48, Train loss: 1.480, Test loss: 1.686, Test accuracy: 78.82
Round  49, Train loss: 1.524, Test loss: 1.630, Test accuracy: 85.00
Round  50, Train loss: 1.522, Test loss: 1.638, Test accuracy: 84.20
Round  51, Train loss: 1.529, Test loss: 1.642, Test accuracy: 83.15
Round  52, Train loss: 1.475, Test loss: 1.660, Test accuracy: 81.02
Round  53, Train loss: 1.583, Test loss: 1.644, Test accuracy: 82.87
Round  54, Train loss: 1.525, Test loss: 1.640, Test accuracy: 83.18
Round  55, Train loss: 1.527, Test loss: 1.640, Test accuracy: 83.55
Round  56, Train loss: 1.523, Test loss: 1.653, Test accuracy: 81.48
Round  57, Train loss: 1.532, Test loss: 1.638, Test accuracy: 83.07
Round  58, Train loss: 1.471, Test loss: 1.630, Test accuracy: 84.70
Round  59, Train loss: 1.470, Test loss: 1.628, Test accuracy: 85.00
Round  60, Train loss: 1.478, Test loss: 1.705, Test accuracy: 76.05
Round  61, Train loss: 1.475, Test loss: 1.652, Test accuracy: 81.65
Round  62, Train loss: 1.523, Test loss: 1.658, Test accuracy: 80.78
Round  63, Train loss: 1.469, Test loss: 1.671, Test accuracy: 79.62
Round  64, Train loss: 1.577, Test loss: 1.647, Test accuracy: 82.85
Round  65, Train loss: 1.472, Test loss: 1.663, Test accuracy: 80.43
Round  66, Train loss: 1.525, Test loss: 1.689, Test accuracy: 77.93
Round  67, Train loss: 1.524, Test loss: 1.665, Test accuracy: 80.28
Round  68, Train loss: 1.523, Test loss: 1.616, Test accuracy: 85.93
Round  69, Train loss: 1.471, Test loss: 1.644, Test accuracy: 82.47
Round  70, Train loss: 1.522, Test loss: 1.669, Test accuracy: 79.65
Round  71, Train loss: 1.577, Test loss: 1.629, Test accuracy: 84.23
Round  72, Train loss: 1.523, Test loss: 1.616, Test accuracy: 85.72
Round  73, Train loss: 1.521, Test loss: 1.644, Test accuracy: 82.33
Round  74, Train loss: 1.470, Test loss: 1.637, Test accuracy: 83.68
Round  75, Train loss: 1.525, Test loss: 1.658, Test accuracy: 81.42
Round  76, Train loss: 1.470, Test loss: 1.733, Test accuracy: 72.68
Round  77, Train loss: 1.471, Test loss: 1.635, Test accuracy: 83.52
Round  78, Train loss: 1.470, Test loss: 1.636, Test accuracy: 83.55
Round  79, Train loss: 1.476, Test loss: 1.627, Test accuracy: 84.28
Round  80, Train loss: 1.520, Test loss: 1.636, Test accuracy: 83.53
Round  81, Train loss: 1.470, Test loss: 1.631, Test accuracy: 83.95
Round  82, Train loss: 1.468, Test loss: 1.622, Test accuracy: 84.68
Round  83, Train loss: 1.519, Test loss: 1.625, Test accuracy: 84.72
Round  84, Train loss: 1.468, Test loss: 1.619, Test accuracy: 85.33
Round  85, Train loss: 1.474, Test loss: 1.634, Test accuracy: 83.38
Round  86, Train loss: 1.470, Test loss: 1.631, Test accuracy: 83.93
Round  87, Train loss: 1.475, Test loss: 1.643, Test accuracy: 82.67
Round  88, Train loss: 1.527, Test loss: 1.617, Test accuracy: 85.33
Round  89, Train loss: 1.475, Test loss: 1.636, Test accuracy: 83.05
Round  90, Train loss: 1.469, Test loss: 1.637, Test accuracy: 82.63
Round  91, Train loss: 1.520, Test loss: 1.627, Test accuracy: 83.73
Round  92, Train loss: 1.469, Test loss: 1.638, Test accuracy: 82.92
Round  93, Train loss: 1.469, Test loss: 1.649, Test accuracy: 82.07
Round  94, Train loss: 1.471, Test loss: 1.643, Test accuracy: 82.67
Round  95, Train loss: 1.476, Test loss: 1.656, Test accuracy: 80.50
Round  96, Train loss: 1.470, Test loss: 1.620, Test accuracy: 84.87
Round  97, Train loss: 1.522, Test loss: 1.632, Test accuracy: 83.48
Round  98, Train loss: 1.469, Test loss: 1.639, Test accuracy: 82.72
Round  99, Train loss: 1.522, Test loss: 1.612, Test accuracy: 86.10
Final Round, Train loss: 1.502, Test loss: 1.600, Test accuracy: 87.13
Average accuracy final 10 rounds: 83.16833333333332
1101.9345562458038
[2.4562363624572754, 4.023912191390991, 5.589466333389282, 7.18036150932312, 8.74727177619934, 10.31305742263794, 11.881648302078247, 13.449217557907104, 15.019187688827515, 16.59339189529419, 18.161309719085693, 19.7292697429657, 21.299031019210815, 22.865228176116943, 24.433632612228394, 25.999201774597168, 27.568225860595703, 29.13146734237671, 30.69629144668579, 32.264222383499146, 33.831658124923706, 35.40622353553772, 36.989808082580566, 38.55456328392029, 40.12259840965271, 41.68435096740723, 43.24743294715881, 44.810638427734375, 46.379520893096924, 47.93856859207153, 49.5150933265686, 51.0874969959259, 52.60669994354248, 54.13561749458313, 55.6931266784668, 57.251410484313965, 58.81190204620361, 60.368600606918335, 61.923927307128906, 63.481311559677124, 65.03849744796753, 66.60039734840393, 68.16054058074951, 69.72484922409058, 71.28642177581787, 72.87796664237976, 74.4523434638977, 76.02328586578369, 77.59472990036011, 79.16557049751282, 80.72837829589844, 82.31154727935791, 83.8840217590332, 85.45341444015503, 87.02262663841248, 88.59166741371155, 90.1574432849884, 91.72715592384338, 93.29526948928833, 94.85637974739075, 96.41842031478882, 97.97725439071655, 99.54002046585083, 101.09954690933228, 102.66129088401794, 104.21978759765625, 105.77760577201843, 107.33325505256653, 108.89193153381348, 110.45166230201721, 112.01207828521729, 113.57250905036926, 115.13126373291016, 116.68705534934998, 118.24552869796753, 119.79700565338135, 121.35340738296509, 122.92572808265686, 124.48402333259583, 126.04021978378296, 127.59809947013855, 129.1561405658722, 130.7151644229889, 132.27417397499084, 133.83700108528137, 135.38838076591492, 136.93517541885376, 138.48259234428406, 140.03039360046387, 141.5861256122589, 143.1450777053833, 144.70490622520447, 146.26215243339539, 147.82203722000122, 149.37965178489685, 150.941575050354, 152.50163435935974, 154.0140209197998, 155.52954053878784, 157.04816102981567, 158.56208658218384]
[15.033333333333333, 23.466666666666665, 43.96666666666667, 50.8, 45.8, 54.833333333333336, 63.516666666666666, 50.7, 67.51666666666667, 69.3, 69.76666666666667, 76.08333333333333, 59.85, 68.43333333333334, 77.81666666666666, 76.3, 75.53333333333333, 65.11666666666666, 72.38333333333334, 69.66666666666667, 70.78333333333333, 78.53333333333333, 78.85, 77.06666666666666, 78.11666666666666, 79.05, 80.46666666666667, 77.71666666666667, 76.41666666666667, 82.81666666666666, 82.8, 83.03333333333333, 80.76666666666667, 80.21666666666667, 83.05, 80.71666666666667, 81.35, 82.58333333333333, 79.65, 81.41666666666667, 84.05, 83.26666666666667, 81.81666666666666, 83.5, 82.81666666666666, 83.33333333333333, 84.51666666666667, 82.31666666666666, 78.81666666666666, 85.0, 84.2, 83.15, 81.01666666666667, 82.86666666666666, 83.18333333333334, 83.55, 81.48333333333333, 83.06666666666666, 84.7, 85.0, 76.05, 81.65, 80.78333333333333, 79.61666666666666, 82.85, 80.43333333333334, 77.93333333333334, 80.28333333333333, 85.93333333333334, 82.46666666666667, 79.65, 84.23333333333333, 85.71666666666667, 82.33333333333333, 83.68333333333334, 81.41666666666667, 72.68333333333334, 83.51666666666667, 83.55, 84.28333333333333, 83.53333333333333, 83.95, 84.68333333333334, 84.71666666666667, 85.33333333333333, 83.38333333333334, 83.93333333333334, 82.66666666666667, 85.33333333333333, 83.05, 82.63333333333334, 83.73333333333333, 82.91666666666667, 82.06666666666666, 82.66666666666667, 80.5, 84.86666666666666, 83.48333333333333, 82.71666666666667, 86.1, 87.13333333333334]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_apfl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
Round   0, Train loss: 1.522, Test loss: 2.236, Test accuracy: 35.40
Round   1, Train loss: 1.351, Test loss: 2.099, Test accuracy: 60.80
Round   2, Train loss: 1.217, Test loss: 1.966, Test accuracy: 63.77
Round   3, Train loss: 1.361, Test loss: 1.907, Test accuracy: 70.27
Round   4, Train loss: 1.313, Test loss: 1.859, Test accuracy: 73.55
Round   5, Train loss: 1.194, Test loss: 1.815, Test accuracy: 73.65
Round   6, Train loss: 1.204, Test loss: 1.755, Test accuracy: 79.60
Round   7, Train loss: 1.196, Test loss: 1.729, Test accuracy: 81.40
Round   8, Train loss: 1.187, Test loss: 1.723, Test accuracy: 80.43
Round   9, Train loss: 1.253, Test loss: 1.697, Test accuracy: 83.10
Round  10, Train loss: 1.183, Test loss: 1.690, Test accuracy: 83.10
Round  11, Train loss: 1.144, Test loss: 1.687, Test accuracy: 82.73
Round  12, Train loss: 1.223, Test loss: 1.682, Test accuracy: 83.10
Round  13, Train loss: 1.189, Test loss: 1.673, Test accuracy: 83.53
Round  14, Train loss: 1.187, Test loss: 1.667, Test accuracy: 83.43
Round  15, Train loss: 1.194, Test loss: 1.664, Test accuracy: 83.57
Round  16, Train loss: 1.158, Test loss: 1.659, Test accuracy: 83.55
Round  17, Train loss: 1.192, Test loss: 1.654, Test accuracy: 84.82
Round  18, Train loss: 1.188, Test loss: 1.652, Test accuracy: 84.87
Round  19, Train loss: 1.187, Test loss: 1.652, Test accuracy: 84.65
Round  20, Train loss: 1.183, Test loss: 1.647, Test accuracy: 84.97
Round  21, Train loss: 1.223, Test loss: 1.646, Test accuracy: 84.85
Round  22, Train loss: 1.225, Test loss: 1.644, Test accuracy: 84.80
Round  23, Train loss: 1.225, Test loss: 1.645, Test accuracy: 84.53
Round  24, Train loss: 1.227, Test loss: 1.647, Test accuracy: 84.25
Round  25, Train loss: 1.144, Test loss: 1.643, Test accuracy: 84.55
Round  26, Train loss: 1.161, Test loss: 1.634, Test accuracy: 85.37
Round  27, Train loss: 1.222, Test loss: 1.630, Test accuracy: 85.73
Round  28, Train loss: 1.184, Test loss: 1.632, Test accuracy: 85.65
Round  29, Train loss: 1.225, Test loss: 1.633, Test accuracy: 85.58
Round  30, Train loss: 1.186, Test loss: 1.635, Test accuracy: 85.27
Round  31, Train loss: 1.144, Test loss: 1.632, Test accuracy: 85.45
Round  32, Train loss: 1.263, Test loss: 1.630, Test accuracy: 85.43
Round  33, Train loss: 1.184, Test loss: 1.633, Test accuracy: 85.45
Round  34, Train loss: 1.184, Test loss: 1.635, Test accuracy: 85.03
Round  35, Train loss: 1.184, Test loss: 1.632, Test accuracy: 85.27
Round  36, Train loss: 1.142, Test loss: 1.636, Test accuracy: 84.93
Round  37, Train loss: 1.185, Test loss: 1.639, Test accuracy: 84.67
Round  38, Train loss: 1.148, Test loss: 1.640, Test accuracy: 84.33
Round  39, Train loss: 1.184, Test loss: 1.641, Test accuracy: 84.30
Round  40, Train loss: 1.143, Test loss: 1.635, Test accuracy: 84.63
Round  41, Train loss: 1.182, Test loss: 1.634, Test accuracy: 84.63
Round  42, Train loss: 1.182, Test loss: 1.634, Test accuracy: 84.68
Round  43, Train loss: 1.221, Test loss: 1.635, Test accuracy: 84.52
Round  44, Train loss: 1.184, Test loss: 1.640, Test accuracy: 84.03
Round  45, Train loss: 1.140, Test loss: 1.639, Test accuracy: 84.05
Round  46, Train loss: 1.098, Test loss: 1.639, Test accuracy: 84.03
Round  47, Train loss: 1.141, Test loss: 1.641, Test accuracy: 83.93
Round  48, Train loss: 1.182, Test loss: 1.641, Test accuracy: 83.85
Round  49, Train loss: 1.100, Test loss: 1.643, Test accuracy: 83.68
Round  50, Train loss: 1.143, Test loss: 1.643, Test accuracy: 83.63
Round  51, Train loss: 1.142, Test loss: 1.642, Test accuracy: 83.78
Round  52, Train loss: 1.224, Test loss: 1.641, Test accuracy: 83.73
Round  53, Train loss: 1.180, Test loss: 1.638, Test accuracy: 83.98
Round  54, Train loss: 1.141, Test loss: 1.636, Test accuracy: 84.15
Round  55, Train loss: 1.100, Test loss: 1.639, Test accuracy: 83.92
Round  56, Train loss: 1.183, Test loss: 1.643, Test accuracy: 83.58
Round  57, Train loss: 1.142, Test loss: 1.642, Test accuracy: 83.57
Round  58, Train loss: 1.140, Test loss: 1.642, Test accuracy: 83.65
Round  59, Train loss: 1.221, Test loss: 1.640, Test accuracy: 83.77
Round  60, Train loss: 1.099, Test loss: 1.641, Test accuracy: 83.57
Round  61, Train loss: 1.141, Test loss: 1.642, Test accuracy: 83.43
Round  62, Train loss: 1.141, Test loss: 1.647, Test accuracy: 83.02
Round  63, Train loss: 1.182, Test loss: 1.644, Test accuracy: 83.28
Round  64, Train loss: 1.140, Test loss: 1.643, Test accuracy: 83.42
Round  65, Train loss: 1.222, Test loss: 1.643, Test accuracy: 83.42
Round  66, Train loss: 1.182, Test loss: 1.643, Test accuracy: 83.38
Round  67, Train loss: 1.138, Test loss: 1.643, Test accuracy: 83.47
Round  68, Train loss: 1.140, Test loss: 1.643, Test accuracy: 83.38
Round  69, Train loss: 1.221, Test loss: 1.641, Test accuracy: 83.52
Round  70, Train loss: 1.141, Test loss: 1.642, Test accuracy: 83.58
Round  71, Train loss: 1.142, Test loss: 1.643, Test accuracy: 83.25
Round  72, Train loss: 1.140, Test loss: 1.642, Test accuracy: 83.40
Round  73, Train loss: 1.184, Test loss: 1.646, Test accuracy: 82.97
Round  74, Train loss: 1.101, Test loss: 1.646, Test accuracy: 82.87
Round  75, Train loss: 1.180, Test loss: 1.645, Test accuracy: 82.95
Round  76, Train loss: 1.139, Test loss: 1.644, Test accuracy: 82.93
Round  77, Train loss: 1.180, Test loss: 1.645, Test accuracy: 82.92
Round  78, Train loss: 1.180, Test loss: 1.646, Test accuracy: 82.85
Round  79, Train loss: 1.181, Test loss: 1.645, Test accuracy: 82.68
Round  80, Train loss: 1.221, Test loss: 1.647, Test accuracy: 82.72
Round  81, Train loss: 1.181, Test loss: 1.650, Test accuracy: 82.33
Round  82, Train loss: 1.225, Test loss: 1.652, Test accuracy: 82.37
Round  83, Train loss: 1.220, Test loss: 1.650, Test accuracy: 82.22
Round  84, Train loss: 1.221, Test loss: 1.650, Test accuracy: 82.17
Round  85, Train loss: 1.098, Test loss: 1.648, Test accuracy: 82.32
Round  86, Train loss: 1.179, Test loss: 1.648, Test accuracy: 82.42
Round  87, Train loss: 1.223, Test loss: 1.648, Test accuracy: 82.33
Round  88, Train loss: 1.262, Test loss: 1.647, Test accuracy: 82.40
Round  89, Train loss: 1.222, Test loss: 1.646, Test accuracy: 82.57
Round  90, Train loss: 1.139, Test loss: 1.648, Test accuracy: 82.43
Round  91, Train loss: 1.180, Test loss: 1.648, Test accuracy: 82.33
Round  92, Train loss: 1.181, Test loss: 1.646, Test accuracy: 82.43
Round  93, Train loss: 1.139, Test loss: 1.650, Test accuracy: 82.07
Round  94, Train loss: 1.139, Test loss: 1.649, Test accuracy: 82.17
Round  95, Train loss: 1.184, Test loss: 1.655, Test accuracy: 81.73
Round  96, Train loss: 1.180, Test loss: 1.652, Test accuracy: 82.03
Round  97, Train loss: 1.181, Test loss: 1.650, Test accuracy: 82.02
Round  98, Train loss: 1.222, Test loss: 1.652, Test accuracy: 81.98
Round  99, Train loss: 1.181, Test loss: 1.648, Test accuracy: 82.30
Final Round, Train loss: 1.173, Test loss: 1.650, Test accuracy: 82.27
Average accuracy final 10 rounds: 82.15
894.7443511486053
[]
[35.4, 60.8, 63.766666666666666, 70.26666666666667, 73.55, 73.65, 79.6, 81.4, 80.43333333333334, 83.1, 83.1, 82.73333333333333, 83.1, 83.53333333333333, 83.43333333333334, 83.56666666666666, 83.55, 84.81666666666666, 84.86666666666666, 84.65, 84.96666666666667, 84.85, 84.8, 84.53333333333333, 84.25, 84.55, 85.36666666666666, 85.73333333333333, 85.65, 85.58333333333333, 85.26666666666667, 85.45, 85.43333333333334, 85.45, 85.03333333333333, 85.26666666666667, 84.93333333333334, 84.66666666666667, 84.33333333333333, 84.3, 84.63333333333334, 84.63333333333334, 84.68333333333334, 84.51666666666667, 84.03333333333333, 84.05, 84.03333333333333, 83.93333333333334, 83.85, 83.68333333333334, 83.63333333333334, 83.78333333333333, 83.73333333333333, 83.98333333333333, 84.15, 83.91666666666667, 83.58333333333333, 83.56666666666666, 83.65, 83.76666666666667, 83.56666666666666, 83.43333333333334, 83.01666666666667, 83.28333333333333, 83.41666666666667, 83.41666666666667, 83.38333333333334, 83.46666666666667, 83.38333333333334, 83.51666666666667, 83.58333333333333, 83.25, 83.4, 82.96666666666667, 82.86666666666666, 82.95, 82.93333333333334, 82.91666666666667, 82.85, 82.68333333333334, 82.71666666666667, 82.33333333333333, 82.36666666666666, 82.21666666666667, 82.16666666666667, 82.31666666666666, 82.41666666666667, 82.33333333333333, 82.4, 82.56666666666666, 82.43333333333334, 82.33333333333333, 82.43333333333334, 82.06666666666666, 82.16666666666667, 81.73333333333333, 82.03333333333333, 82.01666666666667, 81.98333333333333, 82.3, 82.26666666666667]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Fed_scaffold %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.285, Test loss: 2.285, Test accuracy: 24.77
Round   0: Global train loss: 2.285, Global test loss: 2.301, Global test accuracy: 10.50
Round   1, Train loss: 2.246, Test loss: 2.244, Test accuracy: 28.58
Round   1: Global train loss: 2.246, Global test loss: 2.300, Global test accuracy: 13.28
Round   2, Train loss: 2.242, Test loss: 2.252, Test accuracy: 27.50
Round   2: Global train loss: 2.242, Global test loss: 2.300, Global test accuracy: 12.17
Round   3, Train loss: 2.051, Test loss: 2.223, Test accuracy: 32.27
Round   3: Global train loss: 2.051, Global test loss: 2.300, Global test accuracy: 13.52
Round   4, Train loss: 2.030, Test loss: 2.145, Test accuracy: 40.08
Round   4: Global train loss: 2.030, Global test loss: 2.299, Global test accuracy: 17.65
Round   5, Train loss: 1.783, Test loss: 2.029, Test accuracy: 54.33
Round   5: Global train loss: 1.783, Global test loss: 2.296, Global test accuracy: 24.65
Round   6, Train loss: 2.110, Test loss: 2.126, Test accuracy: 38.88
Round   6: Global train loss: 2.110, Global test loss: 2.296, Global test accuracy: 30.58
Round   7, Train loss: 1.895, Test loss: 2.147, Test accuracy: 31.00
Round   7: Global train loss: 1.895, Global test loss: 2.296, Global test accuracy: 29.92
Round   8, Train loss: 1.929, Test loss: 2.112, Test accuracy: 34.80
Round   8: Global train loss: 1.929, Global test loss: 2.296, Global test accuracy: 29.25
Round   9, Train loss: 1.343, Test loss: 2.079, Test accuracy: 36.45
Round   9: Global train loss: 1.343, Global test loss: 2.294, Global test accuracy: 33.37
Round  10, Train loss: 1.575, Test loss: 2.025, Test accuracy: 43.68
Round  10: Global train loss: 1.575, Global test loss: 2.292, Global test accuracy: 35.42
Round  11, Train loss: 1.284, Test loss: 1.987, Test accuracy: 51.17
Round  11: Global train loss: 1.284, Global test loss: 2.291, Global test accuracy: 33.47
Round  12, Train loss: 1.218, Test loss: 1.995, Test accuracy: 47.80
Round  12: Global train loss: 1.218, Global test loss: 2.289, Global test accuracy: 33.92
Round  13, Train loss: 1.014, Test loss: 1.996, Test accuracy: 47.90
Round  13: Global train loss: 1.014, Global test loss: 2.290, Global test accuracy: 33.05
Round  14, Train loss: 1.290, Test loss: 1.987, Test accuracy: 52.10
Round  14: Global train loss: 1.290, Global test loss: 2.291, Global test accuracy: 35.68
Round  15, Train loss: 1.446, Test loss: 2.053, Test accuracy: 44.95
Round  15: Global train loss: 1.446, Global test loss: 2.293, Global test accuracy: 34.27
Round  16, Train loss: 0.418, Test loss: 1.885, Test accuracy: 60.88
Round  16: Global train loss: 0.418, Global test loss: 2.290, Global test accuracy: 37.75
Round  17, Train loss: 1.332, Test loss: 1.982, Test accuracy: 53.48
Round  17: Global train loss: 1.332, Global test loss: 2.293, Global test accuracy: 34.58
Round  18, Train loss: 0.368, Test loss: 1.989, Test accuracy: 53.05
Round  18: Global train loss: 0.368, Global test loss: 2.294, Global test accuracy: 33.13
Round  19, Train loss: 1.142, Test loss: 2.087, Test accuracy: 42.15
Round  19: Global train loss: 1.142, Global test loss: 2.297, Global test accuracy: 23.17
Round  20, Train loss: 0.798, Test loss: 1.944, Test accuracy: 54.62
Round  20: Global train loss: 0.798, Global test loss: 2.294, Global test accuracy: 27.48
Round  21, Train loss: 0.222, Test loss: 1.961, Test accuracy: 52.12
Round  21: Global train loss: 0.222, Global test loss: 2.295, Global test accuracy: 31.65
Round  22, Train loss: -0.683, Test loss: 1.800, Test accuracy: 67.27
Round  22: Global train loss: -0.683, Global test loss: 2.288, Global test accuracy: 38.73
Round  23, Train loss: 0.434, Test loss: 1.915, Test accuracy: 58.07
Round  23: Global train loss: 0.434, Global test loss: 2.289, Global test accuracy: 30.78
Round  24, Train loss: -0.133, Test loss: 1.850, Test accuracy: 64.43
Round  24: Global train loss: -0.133, Global test loss: 2.289, Global test accuracy: 34.97
Round  25, Train loss: -0.405, Test loss: 1.880, Test accuracy: 62.52
Round  25: Global train loss: -0.405, Global test loss: 2.288, Global test accuracy: 32.40
Round  26, Train loss: -0.787, Test loss: 1.873, Test accuracy: 61.63
Round  26: Global train loss: -0.787, Global test loss: 2.287, Global test accuracy: 32.98
Round  27, Train loss: -0.217, Test loss: 1.809, Test accuracy: 69.32
Round  27: Global train loss: -0.217, Global test loss: 2.284, Global test accuracy: 35.50
Round  28, Train loss: 0.231, Test loss: 1.862, Test accuracy: 66.05
Round  28: Global train loss: 0.231, Global test loss: 2.281, Global test accuracy: 28.27
Round  29, Train loss: -0.523, Test loss: 1.888, Test accuracy: 61.83
Round  29: Global train loss: -0.523, Global test loss: 2.281, Global test accuracy: 23.08
Round  30, Train loss: 0.000, Test loss: 1.936, Test accuracy: 55.60
Round  30: Global train loss: 0.000, Global test loss: 2.288, Global test accuracy: 23.07
Round  31, Train loss: -1.422, Test loss: 1.802, Test accuracy: 68.62
Round  31: Global train loss: -1.422, Global test loss: 2.282, Global test accuracy: 23.18
Round  32, Train loss: -0.431, Test loss: 1.812, Test accuracy: 66.43
Round  32: Global train loss: -0.431, Global test loss: 2.283, Global test accuracy: 23.07
Round  33, Train loss: -1.183, Test loss: 1.772, Test accuracy: 70.25
Round  33: Global train loss: -1.183, Global test loss: 2.282, Global test accuracy: 32.58
Round  34, Train loss: -0.564, Test loss: 1.827, Test accuracy: 66.30
Round  34: Global train loss: -0.564, Global test loss: 2.281, Global test accuracy: 31.20
Round  35, Train loss: -0.864, Test loss: 1.818, Test accuracy: 66.23
Round  35: Global train loss: -0.864, Global test loss: 2.286, Global test accuracy: 26.63
Round  36, Train loss: -1.780, Test loss: 1.752, Test accuracy: 72.68
Round  36: Global train loss: -1.780, Global test loss: 2.284, Global test accuracy: 26.48
Round  37, Train loss: -1.359, Test loss: 1.732, Test accuracy: 73.52
Round  37: Global train loss: -1.359, Global test loss: 2.284, Global test accuracy: 24.40
Round  38, Train loss: -2.011, Test loss: 1.686, Test accuracy: 78.15
Round  38: Global train loss: -2.011, Global test loss: 2.278, Global test accuracy: 21.22
Round  39, Train loss: -2.776, Test loss: 1.624, Test accuracy: 85.75
Round  39: Global train loss: -2.776, Global test loss: 2.265, Global test accuracy: 33.32
Round  40, Train loss: -0.844, Test loss: 1.685, Test accuracy: 79.35
Round  40: Global train loss: -0.844, Global test loss: 2.268, Global test accuracy: 28.48
Round  41, Train loss: -1.467, Test loss: 1.749, Test accuracy: 73.03
Round  41: Global train loss: -1.467, Global test loss: 2.271, Global test accuracy: 26.32
Round  42, Train loss: -2.393, Test loss: 1.717, Test accuracy: 75.37
Round  42: Global train loss: -2.393, Global test loss: 2.264, Global test accuracy: 27.62
Round  43, Train loss: -1.867, Test loss: 1.740, Test accuracy: 71.93
Round  43: Global train loss: -1.867, Global test loss: 2.269, Global test accuracy: 31.08
Round  44, Train loss: -3.219, Test loss: 1.638, Test accuracy: 82.87
Round  44: Global train loss: -3.219, Global test loss: 2.257, Global test accuracy: 34.48
Round  45, Train loss: -0.750, Test loss: 1.651, Test accuracy: 82.35
Round  45: Global train loss: -0.750, Global test loss: 2.262, Global test accuracy: 29.43
Round  46, Train loss: -2.524, Test loss: 1.627, Test accuracy: 84.22
Round  46: Global train loss: -2.524, Global test loss: 2.257, Global test accuracy: 31.17
Round  47, Train loss: -3.878, Test loss: 1.617, Test accuracy: 85.32
Round  47: Global train loss: -3.878, Global test loss: 2.246, Global test accuracy: 37.83
Round  48, Train loss: -2.398, Test loss: 1.623, Test accuracy: 84.72
Round  48: Global train loss: -2.398, Global test loss: 2.238, Global test accuracy: 35.77
Round  49, Train loss: -2.814, Test loss: 1.614, Test accuracy: 85.68
Round  49: Global train loss: -2.814, Global test loss: 2.225, Global test accuracy: 38.13
Round  50, Train loss: -2.385, Test loss: 1.624, Test accuracy: 84.25
Round  50: Global train loss: -2.385, Global test loss: 2.223, Global test accuracy: 41.53
Round  51, Train loss: -2.672, Test loss: 1.653, Test accuracy: 81.12
Round  51: Global train loss: -2.672, Global test loss: 2.217, Global test accuracy: 30.42
Round  52, Train loss: -1.790, Test loss: 1.667, Test accuracy: 79.12
Round  52: Global train loss: -1.790, Global test loss: 2.216, Global test accuracy: 33.38
Round  53, Train loss: -2.904, Test loss: 1.656, Test accuracy: 80.17
Round  53: Global train loss: -2.904, Global test loss: 2.211, Global test accuracy: 30.68
Round  54, Train loss: -2.540, Test loss: 1.620, Test accuracy: 83.78
Round  54: Global train loss: -2.540, Global test loss: 2.210, Global test accuracy: 36.75
Round  55, Train loss: -3.327, Test loss: 1.619, Test accuracy: 84.03
Round  55: Global train loss: -3.327, Global test loss: 2.214, Global test accuracy: 36.25
Round  56, Train loss: -1.862, Test loss: 1.610, Test accuracy: 84.48
Round  56: Global train loss: -1.862, Global test loss: 2.216, Global test accuracy: 29.87
Round  57, Train loss: -3.296, Test loss: 1.594, Test accuracy: 86.58
Round  57: Global train loss: -3.296, Global test loss: 2.208, Global test accuracy: 32.32
Round  58, Train loss: -3.305, Test loss: 1.581, Test accuracy: 87.75
Round  58: Global train loss: -3.305, Global test loss: 2.201, Global test accuracy: 35.03
Round  59, Train loss: -3.801, Test loss: 1.581, Test accuracy: 87.80
Round  59: Global train loss: -3.801, Global test loss: 2.200, Global test accuracy: 31.95
Round  60, Train loss: -2.446, Test loss: 1.625, Test accuracy: 83.18
Round  60: Global train loss: -2.446, Global test loss: 2.200, Global test accuracy: 35.90
Round  61, Train loss: -2.453, Test loss: 1.613, Test accuracy: 84.72
Round  61: Global train loss: -2.453, Global test loss: 2.193, Global test accuracy: 34.83
Round  62, Train loss: -4.027, Test loss: 1.612, Test accuracy: 84.67
Round  62: Global train loss: -4.027, Global test loss: 2.188, Global test accuracy: 40.30
Round  63, Train loss: -3.307, Test loss: 1.600, Test accuracy: 86.30
Round  63: Global train loss: -3.307, Global test loss: 2.181, Global test accuracy: 40.57
Round  64, Train loss: -3.359, Test loss: 1.596, Test accuracy: 86.50
Round  64: Global train loss: -3.359, Global test loss: 2.180, Global test accuracy: 39.00
Round  65, Train loss: -3.403, Test loss: 1.601, Test accuracy: 86.02
Round  65: Global train loss: -3.403, Global test loss: 2.174, Global test accuracy: 35.30
Round  66, Train loss: -3.596, Test loss: 1.558, Test accuracy: 90.42
Round  66: Global train loss: -3.596, Global test loss: 2.164, Global test accuracy: 38.87
Round  67, Train loss: -2.829, Test loss: 1.595, Test accuracy: 86.88
Round  67: Global train loss: -2.829, Global test loss: 2.161, Global test accuracy: 40.25
Round  68, Train loss: -3.005, Test loss: 1.552, Test accuracy: 90.78
Round  68: Global train loss: -3.005, Global test loss: 2.153, Global test accuracy: 39.58
Round  69, Train loss: -2.902, Test loss: 1.570, Test accuracy: 88.78
Round  69: Global train loss: -2.902, Global test loss: 2.146, Global test accuracy: 39.00
Round  70, Train loss: -3.060, Test loss: 1.569, Test accuracy: 88.95
Round  70: Global train loss: -3.060, Global test loss: 2.150, Global test accuracy: 38.57
Round  71, Train loss: -4.219, Test loss: 1.561, Test accuracy: 89.68
Round  71: Global train loss: -4.219, Global test loss: 2.142, Global test accuracy: 37.35
Round  72, Train loss: -3.820, Test loss: 1.562, Test accuracy: 89.58
Round  72: Global train loss: -3.820, Global test loss: 2.136, Global test accuracy: 40.45
Round  73, Train loss: -3.423, Test loss: 1.606, Test accuracy: 85.25
Round  73: Global train loss: -3.423, Global test loss: 2.138, Global test accuracy: 39.78
Round  74, Train loss: -4.179, Test loss: 1.599, Test accuracy: 85.93
Round  74: Global train loss: -4.179, Global test loss: 2.128, Global test accuracy: 40.12
Round  75, Train loss: -3.475, Test loss: 1.556, Test accuracy: 90.40
Round  75: Global train loss: -3.475, Global test loss: 2.127, Global test accuracy: 41.73
Round  76, Train loss: -3.477, Test loss: 1.559, Test accuracy: 90.30
Round  76: Global train loss: -3.477, Global test loss: 2.115, Global test accuracy: 42.23
Round  77, Train loss: -3.181, Test loss: 1.545, Test accuracy: 91.73
Round  77: Global train loss: -3.181, Global test loss: 2.106, Global test accuracy: 41.77
Round  78, Train loss: -3.800, Test loss: 1.556, Test accuracy: 90.42
Round  78: Global train loss: -3.800, Global test loss: 2.094, Global test accuracy: 42.40
Round  79, Train loss: -2.862, Test loss: 1.517, Test accuracy: 94.42
Round  79: Global train loss: -2.862, Global test loss: 2.084, Global test accuracy: 43.57
Round  80, Train loss: -2.666, Test loss: 1.544, Test accuracy: 91.77
Round  80: Global train loss: -2.666, Global test loss: 2.077, Global test accuracy: 44.87
Round  81, Train loss: -2.085, Test loss: 1.536, Test accuracy: 92.97
Round  81: Global train loss: -2.085, Global test loss: 2.074, Global test accuracy: 44.02
Round  82, Train loss: -2.924, Test loss: 1.530, Test accuracy: 93.40
Round  82: Global train loss: -2.924, Global test loss: 2.067, Global test accuracy: 44.62
Round  83, Train loss: -4.069, Test loss: 1.525, Test accuracy: 93.57
Round  83: Global train loss: -4.069, Global test loss: 2.058, Global test accuracy: 46.35
Round  84, Train loss: -3.053, Test loss: 1.541, Test accuracy: 92.02
Round  84: Global train loss: -3.053, Global test loss: 2.049, Global test accuracy: 48.17
Round  85, Train loss: -2.582, Test loss: 1.526, Test accuracy: 93.50
Round  85: Global train loss: -2.582, Global test loss: 2.052, Global test accuracy: 48.22
Round  86, Train loss: -2.741, Test loss: 1.527, Test accuracy: 93.43
Round  86: Global train loss: -2.741, Global test loss: 2.052, Global test accuracy: 51.33
Round  87, Train loss: -3.207, Test loss: 1.555, Test accuracy: 90.55
Round  87: Global train loss: -3.207, Global test loss: 2.050, Global test accuracy: 52.88
Round  88, Train loss: -3.238, Test loss: 1.522, Test accuracy: 93.93
Round  88: Global train loss: -3.238, Global test loss: 2.045, Global test accuracy: 54.22
Round  89, Train loss: -2.466, Test loss: 1.537, Test accuracy: 92.48
Round  89: Global train loss: -2.466, Global test loss: 2.037, Global test accuracy: 53.68
Round  90, Train loss: -2.902, Test loss: 1.552, Test accuracy: 90.93
Round  90: Global train loss: -2.902, Global test loss: 2.034, Global test accuracy: 56.48
Round  91, Train loss: -3.580, Test loss: 1.538, Test accuracy: 92.40
Round  91: Global train loss: -3.580, Global test loss: 2.030, Global test accuracy: 58.33
Round  92, Train loss: -2.253, Test loss: 1.509, Test accuracy: 95.32
Round  92: Global train loss: -2.253, Global test loss: 2.022, Global test accuracy: 59.35
Round  93, Train loss: -1.694, Test loss: 1.536, Test accuracy: 92.57
Round  93: Global train loss: -1.694, Global test loss: 2.022, Global test accuracy: 58.50
Round  94, Train loss: -2.550, Test loss: 1.538, Test accuracy: 92.35
Round  94: Global train loss: -2.550, Global test loss: 2.021, Global test accuracy: 58.55
Round  95, Train loss: -2.599, Test loss: 1.524, Test accuracy: 93.82
Round  95: Global train loss: -2.599, Global test loss: 2.017, Global test accuracy: 58.80
Round  96, Train loss: -1.396, Test loss: 1.566, Test accuracy: 89.57
Round  96: Global train loss: -1.396, Global test loss: 2.018, Global test accuracy: 56.37
Round  97, Train loss: -1.731, Test loss: 1.549, Test accuracy: 91.25
Round  97: Global train loss: -1.731, Global test loss: 2.013, Global test accuracy: 57.73
Round  98, Train loss: -3.073, Test loss: 1.537, Test accuracy: 92.53
Round  98: Global train loss: -3.073, Global test loss: 2.001, Global test accuracy: 57.08
Round  99, Train loss: -2.685, Test loss: 1.538, Test accuracy: 92.38
Round  99: Global train loss: -2.685, Global test loss: 1.998, Global test accuracy: 56.67
Final Round: Train loss: 1.578, Test loss: 1.533, Test accuracy: 94.30
Final Round: Global train loss: 1.578, Global test loss: 1.988, Global test accuracy: 57.00
Average accuracy final 10 rounds: 92.31166666666667
Average global accuracy final 10 rounds: 57.78666666666667
686.9636476039886
[]
[24.766666666666666, 28.583333333333332, 27.5, 32.266666666666666, 40.083333333333336, 54.333333333333336, 38.88333333333333, 31.0, 34.8, 36.45, 43.68333333333333, 51.166666666666664, 47.8, 47.9, 52.1, 44.95, 60.88333333333333, 53.483333333333334, 53.05, 42.15, 54.61666666666667, 52.11666666666667, 67.26666666666667, 58.06666666666667, 64.43333333333334, 62.516666666666666, 61.63333333333333, 69.31666666666666, 66.05, 61.833333333333336, 55.6, 68.61666666666666, 66.43333333333334, 70.25, 66.3, 66.23333333333333, 72.68333333333334, 73.51666666666667, 78.15, 85.75, 79.35, 73.03333333333333, 75.36666666666666, 71.93333333333334, 82.86666666666666, 82.35, 84.21666666666667, 85.31666666666666, 84.71666666666667, 85.68333333333334, 84.25, 81.11666666666666, 79.11666666666666, 80.16666666666667, 83.78333333333333, 84.03333333333333, 84.48333333333333, 86.58333333333333, 87.75, 87.8, 83.18333333333334, 84.71666666666667, 84.66666666666667, 86.3, 86.5, 86.01666666666667, 90.41666666666667, 86.88333333333334, 90.78333333333333, 88.78333333333333, 88.95, 89.68333333333334, 89.58333333333333, 85.25, 85.93333333333334, 90.4, 90.3, 91.73333333333333, 90.41666666666667, 94.41666666666667, 91.76666666666667, 92.96666666666667, 93.4, 93.56666666666666, 92.01666666666667, 93.5, 93.43333333333334, 90.55, 93.93333333333334, 92.48333333333333, 90.93333333333334, 92.4, 95.31666666666666, 92.56666666666666, 92.35, 93.81666666666666, 89.56666666666666, 91.25, 92.53333333333333, 92.38333333333334, 94.3]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  pFedMe   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.304, Test loss: 2.303, Test accuracy: 8.33 

Round   0, Global train loss: 2.304, Global test loss: 2.303, Global test accuracy: 8.33 

Round   1, Train loss: 2.302, Test loss: 2.303, Test accuracy: 8.33 

Round   1, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round   2, Train loss: 2.303, Test loss: 2.303, Test accuracy: 8.33 

Round   2, Global train loss: 2.303, Global test loss: 2.303, Global test accuracy: 8.33 

Round   3, Train loss: 2.301, Test loss: 2.303, Test accuracy: 8.33 

Round   3, Global train loss: 2.301, Global test loss: 2.303, Global test accuracy: 8.33 

Round   4, Train loss: 2.302, Test loss: 2.303, Test accuracy: 8.33 

Round   4, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round   5, Train loss: 2.302, Test loss: 2.303, Test accuracy: 8.33 

Round   5, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round   6, Train loss: 2.302, Test loss: 2.303, Test accuracy: 8.33 

Round   6, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round   7, Train loss: 2.302, Test loss: 2.303, Test accuracy: 8.33 

Round   7, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round   8, Train loss: 2.302, Test loss: 2.303, Test accuracy: 8.33 

Round   8, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round   9, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.33 

Round   9, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round  10, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.33 

Round  10, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round  11, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.33 

Round  11, Global train loss: 2.302, Global test loss: 2.303, Global test accuracy: 8.33 

Round  12, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.33 

Round  12, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.33 

Round  13, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.33 

Round  13, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  14, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.33 

Round  14, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.33 

Round  15, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.33 

Round  15, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  16, Train loss: 2.305, Test loss: 2.302, Test accuracy: 8.33 

Round  16, Global train loss: 2.305, Global test loss: 2.302, Global test accuracy: 8.33 

Round  17, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.33 

Round  17, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.33 

Round  18, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.33 

Round  18, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.33 

Round  19, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.35 

Round  19, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.35 

Round  20, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  20, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.35 

Round  21, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.35 

Round  21, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.35 

Round  22, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.35 

Round  22, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.35 

Round  23, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  23, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  24, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  24, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  25, Train loss: 2.300, Test loss: 2.302, Test accuracy: 8.35 

Round  25, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.33 

Round  26, Train loss: 2.300, Test loss: 2.302, Test accuracy: 8.35 

Round  26, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.33 

Round  27, Train loss: 2.300, Test loss: 2.302, Test accuracy: 8.35 

Round  27, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.33 

Round  28, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.35 

Round  28, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.33 

Round  29, Train loss: 2.300, Test loss: 2.302, Test accuracy: 8.35 

Round  29, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.33 

Round  30, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.33 

Round  30, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  31, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.33 

Round  31, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.32 

Round  32, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.33 

Round  32, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.32 

Round  33, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.33 

Round  33, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.32 

Round  34, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.33 

Round  34, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.33 

Round  35, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.35 

Round  35, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.33 

Round  36, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.33 

Round  36, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.33 

Round  37, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.33 

Round  37, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  38, Train loss: 2.299, Test loss: 2.302, Test accuracy: 8.35 

Round  38, Global train loss: 2.299, Global test loss: 2.302, Global test accuracy: 8.33 

Round  39, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  39, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.35 

Round  40, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.35 

Round  40, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.35 

Round  41, Train loss: 2.300, Test loss: 2.302, Test accuracy: 8.35 

Round  41, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.35 

Round  42, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  42, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  43, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  43, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.33 

Round  44, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.35 

Round  44, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.35 

Round  45, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.38 

Round  45, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.33 

Round  46, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.38 

Round  46, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.35 

Round  47, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.38 

Round  47, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.33 

Round  48, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.38 

Round  48, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.35 

Round  49, Train loss: 2.303, Test loss: 2.302, Test accuracy: 8.38 

Round  49, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 8.33 

Round  50, Train loss: 2.302, Test loss: 2.302, Test accuracy: 8.38 

Round  50, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.33 

Round  51, Train loss: 2.300, Test loss: 2.302, Test accuracy: 8.38 

Round  51, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.30 

Round  52, Train loss: 2.301, Test loss: 2.302, Test accuracy: 8.42 

Round  52, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 8.35 

Round  53, Train loss: 2.302, Test loss: 2.301, Test accuracy: 8.42 

Round  53, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 8.35 

Round  54, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.35 

Round  54, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.35 

Round  55, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.33 

Round  55, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.35 

Round  56, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.33 

Round  56, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 8.35 

Round  57, Train loss: 2.303, Test loss: 2.301, Test accuracy: 8.33 

Round  57, Global train loss: 2.303, Global test loss: 2.301, Global test accuracy: 8.35 

Round  58, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.35 

Round  58, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.35 

Round  59, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.37 

Round  59, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.40 

Round  60, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.35 

Round  60, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.40 

Round  61, Train loss: 2.302, Test loss: 2.301, Test accuracy: 8.38 

Round  61, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 8.40 

Round  62, Train loss: 2.303, Test loss: 2.301, Test accuracy: 8.42 

Round  62, Global train loss: 2.303, Global test loss: 2.301, Global test accuracy: 8.38 

Round  63, Train loss: 2.302, Test loss: 2.301, Test accuracy: 8.40 

Round  63, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 8.38 

Round  64, Train loss: 2.303, Test loss: 2.301, Test accuracy: 8.42 

Round  64, Global train loss: 2.303, Global test loss: 2.301, Global test accuracy: 8.43 

Round  65, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.48 

Round  65, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.47 

Round  66, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.50 

Round  66, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.50 

Round  67, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.57 

Round  67, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.55 

Round  68, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.58 

Round  68, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.57 

Round  69, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.67 

Round  69, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.83 

Round  70, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.68 

Round  70, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.82 

Round  71, Train loss: 2.302, Test loss: 2.301, Test accuracy: 8.85 

Round  71, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 8.93 

Round  72, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.87 

Round  72, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.93 

Round  73, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.85 

Round  73, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.93 

Round  74, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.90 

Round  74, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.93 

Round  75, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.90 

Round  75, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.95 

Round  76, Train loss: 2.300, Test loss: 2.301, Test accuracy: 8.92 

Round  76, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 8.90 

Round  77, Train loss: 2.301, Test loss: 2.301, Test accuracy: 8.97 

Round  77, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.88 

Round  78, Train loss: 2.302, Test loss: 2.301, Test accuracy: 9.03 

Round  78, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 8.85 

Round  79, Train loss: 2.301, Test loss: 2.301, Test accuracy: 9.00 

Round  79, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 8.85 

Round  80, Train loss: 2.299, Test loss: 2.301, Test accuracy: 9.02 

Round  80, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 8.87 

Round  81, Train loss: 2.300, Test loss: 2.301, Test accuracy: 9.13 

Round  81, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 9.00 

Round  82, Train loss: 2.301, Test loss: 2.301, Test accuracy: 9.25 

Round  82, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 9.10 

Round  83, Train loss: 2.300, Test loss: 2.301, Test accuracy: 9.23 

Round  83, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 9.07 

Round  84, Train loss: 2.300, Test loss: 2.301, Test accuracy: 9.35 

Round  84, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 9.08 

Round  85, Train loss: 2.299, Test loss: 2.301, Test accuracy: 9.35 

Round  85, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 9.10 

Round  86, Train loss: 2.301, Test loss: 2.301, Test accuracy: 9.50 

Round  86, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 9.32 

Round  87, Train loss: 2.299, Test loss: 2.301, Test accuracy: 9.38 

Round  87, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 9.35 

Round  88, Train loss: 2.300, Test loss: 2.301, Test accuracy: 9.45 

Round  88, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 9.38 

Round  89, Train loss: 2.299, Test loss: 2.301, Test accuracy: 9.57 

Round  89, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 9.43 

Round  90, Train loss: 2.301, Test loss: 2.301, Test accuracy: 9.60 

Round  90, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 9.58 

Round  91, Train loss: 2.301, Test loss: 2.301, Test accuracy: 9.62 

Round  91, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 9.58 

Round  92, Train loss: 2.302, Test loss: 2.301, Test accuracy: 9.62 

Round  92, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 9.55 

Round  93, Train loss: 2.300, Test loss: 2.301, Test accuracy: 9.87 

Round  93, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 9.65 

Round  94, Train loss: 2.301, Test loss: 2.300, Test accuracy: 10.00 

Round  94, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 9.72 

Round  95, Train loss: 2.299, Test loss: 2.300, Test accuracy: 9.97 

Round  95, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 9.78 

Round  96, Train loss: 2.301, Test loss: 2.300, Test accuracy: 9.97 

Round  96, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 9.88 

Round  97, Train loss: 2.300, Test loss: 2.300, Test accuracy: 10.10 

Round  97, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 9.87 

Round  98, Train loss: 2.298, Test loss: 2.300, Test accuracy: 10.12 

Round  98, Global train loss: 2.298, Global test loss: 2.300, Global test accuracy: 10.13 

Round  99, Train loss: 2.300, Test loss: 2.300, Test accuracy: 10.25 

Round  99, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 10.22 

Final Round, Train loss: 2.300, Test loss: 2.300, Test accuracy: 10.87 

Final Round, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 10.22 

Average accuracy final 10 rounds: 9.910000000000002 

Average global accuracy final 10 rounds: 9.796666666666667 

676.0844020843506
[1.5465731620788574, 2.196113348007202, 2.8726236820220947, 3.533377170562744, 4.180395126342773, 4.821177005767822, 5.465542316436768, 6.116310119628906, 6.7607057094573975, 7.4064741134643555, 8.050285577774048, 8.696661710739136, 9.3418607711792, 9.987974643707275, 10.633900165557861, 11.282585620880127, 12.047933340072632, 12.820732593536377, 13.59259557723999, 14.36197805404663, 15.132495164871216, 15.775896310806274, 16.424296140670776, 17.07405185699463, 17.722042083740234, 18.36816930770874, 19.017104625701904, 19.65948796272278, 20.302712202072144, 20.948353052139282, 21.59169292449951, 22.23903512954712, 22.887054920196533, 23.53249478340149, 24.183305501937866, 24.828215837478638, 25.473424434661865, 26.116921424865723, 26.76272225379944, 27.40908908843994, 28.054550170898438, 28.699650764465332, 29.345746755599976, 29.990445613861084, 30.637988328933716, 31.284416675567627, 31.925212860107422, 32.57020044326782, 33.21789598464966, 33.86590242385864, 34.526447057724, 35.17111015319824, 35.818273305892944, 36.46392297744751, 37.11163640022278, 37.75511860847473, 38.403136014938354, 39.046353816986084, 39.695876598358154, 40.33623480796814, 40.9801070690155, 41.6217155456543, 42.266969203948975, 42.912073612213135, 43.563989877700806, 44.219133138656616, 44.86586022377014, 45.5081148147583, 46.151779890060425, 46.79523825645447, 47.437785387039185, 48.085304975509644, 48.7293016910553, 49.37718605995178, 50.02380108833313, 50.67447304725647, 51.32147192955017, 51.963602781295776, 52.61143469810486, 53.255807876586914, 53.899848222732544, 54.545682430267334, 55.19477605819702, 55.84203290939331, 56.489219665527344, 57.13569259643555, 57.78182578086853, 58.43029022216797, 59.07776355743408, 59.57949471473694, 60.07768177986145, 60.57959771156311, 61.083898305892944, 61.57925605773926, 62.07424736022949, 62.57016396522522, 63.07182478904724, 63.57573366165161, 64.07275986671448, 64.57453942298889, 65.56990480422974]
[8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.35, 8.333333333333334, 8.333333333333334, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.35, 8.383333333333333, 8.383333333333333, 8.383333333333333, 8.383333333333333, 8.383333333333333, 8.383333333333333, 8.383333333333333, 8.416666666666666, 8.416666666666666, 8.35, 8.333333333333334, 8.333333333333334, 8.333333333333334, 8.35, 8.366666666666667, 8.35, 8.383333333333333, 8.416666666666666, 8.4, 8.416666666666666, 8.483333333333333, 8.5, 8.566666666666666, 8.583333333333334, 8.666666666666666, 8.683333333333334, 8.85, 8.866666666666667, 8.85, 8.9, 8.9, 8.916666666666666, 8.966666666666667, 9.033333333333333, 9.0, 9.016666666666667, 9.133333333333333, 9.25, 9.233333333333333, 9.35, 9.35, 9.5, 9.383333333333333, 9.45, 9.566666666666666, 9.6, 9.616666666666667, 9.616666666666667, 9.866666666666667, 10.0, 9.966666666666667, 9.966666666666667, 10.1, 10.116666666666667, 10.25, 10.866666666666667]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.289, Test loss: 2.285, Test accuracy: 28.72 

Round   0, Global train loss: 2.289, Global test loss: 2.298, Global test accuracy: 22.08 

Round   1, Train loss: 2.112, Test loss: 2.147, Test accuracy: 31.95 

Round   1, Global train loss: 2.112, Global test loss: 2.246, Global test accuracy: 18.25 

Round   2, Train loss: 1.976, Test loss: 2.004, Test accuracy: 53.32 

Round   2, Global train loss: 1.976, Global test loss: 2.195, Global test accuracy: 30.55 

Round   3, Train loss: 1.710, Test loss: 1.914, Test accuracy: 58.25 

Round   3, Global train loss: 1.710, Global test loss: 2.182, Global test accuracy: 21.87 

Round   4, Train loss: 1.628, Test loss: 1.831, Test accuracy: 69.23 

Round   4, Global train loss: 1.628, Global test loss: 2.150, Global test accuracy: 31.88 

Round   5, Train loss: 1.600, Test loss: 1.748, Test accuracy: 76.95 

Round   5, Global train loss: 1.600, Global test loss: 2.203, Global test accuracy: 24.22 

Round   6, Train loss: 1.544, Test loss: 1.737, Test accuracy: 77.92 

Round   6, Global train loss: 1.544, Global test loss: 2.255, Global test accuracy: 15.25 

Round   7, Train loss: 1.678, Test loss: 1.655, Test accuracy: 86.32 

Round   7, Global train loss: 1.678, Global test loss: 2.080, Global test accuracy: 38.92 

Round   8, Train loss: 1.636, Test loss: 1.629, Test accuracy: 86.48 

Round   8, Global train loss: 1.636, Global test loss: 2.253, Global test accuracy: 16.72 

Round   9, Train loss: 1.568, Test loss: 1.582, Test accuracy: 91.70 

Round   9, Global train loss: 1.568, Global test loss: 2.084, Global test accuracy: 35.02 

Round  10, Train loss: 1.541, Test loss: 1.559, Test accuracy: 93.52 

Round  10, Global train loss: 1.541, Global test loss: 2.143, Global test accuracy: 29.57 

Round  11, Train loss: 1.543, Test loss: 1.525, Test accuracy: 95.28 

Round  11, Global train loss: 1.543, Global test loss: 2.127, Global test accuracy: 36.58 

Round  12, Train loss: 1.483, Test loss: 1.523, Test accuracy: 95.45 

Round  12, Global train loss: 1.483, Global test loss: 2.194, Global test accuracy: 22.33 

Round  13, Train loss: 1.491, Test loss: 1.518, Test accuracy: 95.52 

Round  13, Global train loss: 1.491, Global test loss: 2.212, Global test accuracy: 25.98 

Round  14, Train loss: 1.477, Test loss: 1.516, Test accuracy: 95.50 

Round  14, Global train loss: 1.477, Global test loss: 2.198, Global test accuracy: 22.50 

Round  15, Train loss: 1.471, Test loss: 1.516, Test accuracy: 95.47 

Round  15, Global train loss: 1.471, Global test loss: 2.100, Global test accuracy: 41.75 

Round  16, Train loss: 1.475, Test loss: 1.515, Test accuracy: 95.50 

Round  16, Global train loss: 1.475, Global test loss: 2.179, Global test accuracy: 24.15 

Round  17, Train loss: 1.470, Test loss: 1.515, Test accuracy: 95.48 

Round  17, Global train loss: 1.470, Global test loss: 2.151, Global test accuracy: 29.45 

Round  18, Train loss: 1.481, Test loss: 1.512, Test accuracy: 95.67 

Round  18, Global train loss: 1.481, Global test loss: 2.099, Global test accuracy: 35.50 

Round  19, Train loss: 1.474, Test loss: 1.512, Test accuracy: 95.57 

Round  19, Global train loss: 1.474, Global test loss: 2.150, Global test accuracy: 35.52 

Round  20, Train loss: 1.475, Test loss: 1.511, Test accuracy: 95.60 

Round  20, Global train loss: 1.475, Global test loss: 2.118, Global test accuracy: 32.75 

Round  21, Train loss: 1.472, Test loss: 1.511, Test accuracy: 95.60 

Round  21, Global train loss: 1.472, Global test loss: 2.157, Global test accuracy: 31.78 

Round  22, Train loss: 1.470, Test loss: 1.511, Test accuracy: 95.62 

Round  22, Global train loss: 1.470, Global test loss: 2.125, Global test accuracy: 29.97 

Round  23, Train loss: 1.465, Test loss: 1.511, Test accuracy: 95.63 

Round  23, Global train loss: 1.465, Global test loss: 2.152, Global test accuracy: 28.15 

Round  24, Train loss: 1.467, Test loss: 1.511, Test accuracy: 95.63 

Round  24, Global train loss: 1.467, Global test loss: 2.134, Global test accuracy: 31.77 

Round  25, Train loss: 1.466, Test loss: 1.510, Test accuracy: 95.70 

Round  25, Global train loss: 1.466, Global test loss: 2.156, Global test accuracy: 30.87 

Round  26, Train loss: 1.468, Test loss: 1.510, Test accuracy: 95.70 

Round  26, Global train loss: 1.468, Global test loss: 2.074, Global test accuracy: 40.58 

Round  27, Train loss: 1.469, Test loss: 1.510, Test accuracy: 95.62 

Round  27, Global train loss: 1.469, Global test loss: 2.244, Global test accuracy: 17.00 

Round  28, Train loss: 1.468, Test loss: 1.510, Test accuracy: 95.62 

Round  28, Global train loss: 1.468, Global test loss: 2.095, Global test accuracy: 37.37 

Round  29, Train loss: 1.467, Test loss: 1.509, Test accuracy: 95.67 

Round  29, Global train loss: 1.467, Global test loss: 2.126, Global test accuracy: 31.18 

Round  30, Train loss: 1.468, Test loss: 1.509, Test accuracy: 95.67 

Round  30, Global train loss: 1.468, Global test loss: 2.084, Global test accuracy: 36.02 

Round  31, Train loss: 1.469, Test loss: 1.509, Test accuracy: 95.68 

Round  31, Global train loss: 1.469, Global test loss: 2.129, Global test accuracy: 28.02 

Round  32, Train loss: 1.466, Test loss: 1.509, Test accuracy: 95.67 

Round  32, Global train loss: 1.466, Global test loss: 2.277, Global test accuracy: 16.72 

Round  33, Train loss: 1.470, Test loss: 1.509, Test accuracy: 95.68 

Round  33, Global train loss: 1.470, Global test loss: 2.206, Global test accuracy: 20.13 

Round  34, Train loss: 1.468, Test loss: 1.509, Test accuracy: 95.65 

Round  34, Global train loss: 1.468, Global test loss: 2.174, Global test accuracy: 26.02 

Round  35, Train loss: 1.465, Test loss: 1.508, Test accuracy: 95.67 

Round  35, Global train loss: 1.465, Global test loss: 2.101, Global test accuracy: 37.15 

Round  36, Train loss: 1.469, Test loss: 1.508, Test accuracy: 95.72 

Round  36, Global train loss: 1.469, Global test loss: 2.163, Global test accuracy: 28.45 

Round  37, Train loss: 1.464, Test loss: 1.508, Test accuracy: 95.72 

Round  37, Global train loss: 1.464, Global test loss: 2.045, Global test accuracy: 42.15 

Round  38, Train loss: 1.464, Test loss: 1.508, Test accuracy: 95.72 

Round  38, Global train loss: 1.464, Global test loss: 2.021, Global test accuracy: 45.63 

Round  39, Train loss: 1.467, Test loss: 1.508, Test accuracy: 95.73 

Round  39, Global train loss: 1.467, Global test loss: 2.196, Global test accuracy: 22.65 

Round  40, Train loss: 1.467, Test loss: 1.508, Test accuracy: 95.73 

Round  40, Global train loss: 1.467, Global test loss: 2.070, Global test accuracy: 43.00 

Round  41, Train loss: 1.466, Test loss: 1.508, Test accuracy: 95.72 

Round  41, Global train loss: 1.466, Global test loss: 2.089, Global test accuracy: 38.47 

Round  42, Train loss: 1.467, Test loss: 1.508, Test accuracy: 95.72 

Round  42, Global train loss: 1.467, Global test loss: 2.105, Global test accuracy: 29.42 

Round  43, Train loss: 1.466, Test loss: 1.508, Test accuracy: 95.72 

Round  43, Global train loss: 1.466, Global test loss: 2.118, Global test accuracy: 30.92 

Round  44, Train loss: 1.464, Test loss: 1.508, Test accuracy: 95.72 

Round  44, Global train loss: 1.464, Global test loss: 2.039, Global test accuracy: 46.28 

Round  45, Train loss: 1.467, Test loss: 1.508, Test accuracy: 95.73 

Round  45, Global train loss: 1.467, Global test loss: 2.125, Global test accuracy: 35.75 

Round  46, Train loss: 1.466, Test loss: 1.508, Test accuracy: 95.73 

Round  46, Global train loss: 1.466, Global test loss: 2.111, Global test accuracy: 38.38 

Round  47, Train loss: 1.467, Test loss: 1.508, Test accuracy: 95.73 

Round  47, Global train loss: 1.467, Global test loss: 2.132, Global test accuracy: 29.37 

Round  48, Train loss: 1.467, Test loss: 1.508, Test accuracy: 95.73 

Round  48, Global train loss: 1.467, Global test loss: 2.063, Global test accuracy: 36.72 

Round  49, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.73 

Round  49, Global train loss: 1.466, Global test loss: 2.230, Global test accuracy: 23.65 

Round  50, Train loss: 1.463, Test loss: 1.507, Test accuracy: 95.73 

Round  50, Global train loss: 1.463, Global test loss: 2.217, Global test accuracy: 19.67 

Round  51, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.75 

Round  51, Global train loss: 1.466, Global test loss: 2.149, Global test accuracy: 28.90 

Round  52, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.75 

Round  52, Global train loss: 1.466, Global test loss: 2.096, Global test accuracy: 34.93 

Round  53, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.75 

Round  53, Global train loss: 1.466, Global test loss: 2.080, Global test accuracy: 39.85 

Round  54, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.75 

Round  54, Global train loss: 1.464, Global test loss: 2.191, Global test accuracy: 23.78 

Round  55, Train loss: 1.467, Test loss: 1.507, Test accuracy: 95.77 

Round  55, Global train loss: 1.467, Global test loss: 2.062, Global test accuracy: 44.40 

Round  56, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.77 

Round  56, Global train loss: 1.466, Global test loss: 2.213, Global test accuracy: 22.80 

Round  57, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.77 

Round  57, Global train loss: 1.466, Global test loss: 2.152, Global test accuracy: 27.45 

Round  58, Train loss: 1.465, Test loss: 1.507, Test accuracy: 95.77 

Round  58, Global train loss: 1.465, Global test loss: 2.167, Global test accuracy: 25.92 

Round  59, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.78 

Round  59, Global train loss: 1.466, Global test loss: 2.104, Global test accuracy: 29.70 

Round  60, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.78 

Round  60, Global train loss: 1.466, Global test loss: 2.119, Global test accuracy: 35.83 

Round  61, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.77 

Round  61, Global train loss: 1.466, Global test loss: 2.081, Global test accuracy: 35.55 

Round  62, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.77 

Round  62, Global train loss: 1.466, Global test loss: 2.271, Global test accuracy: 16.80 

Round  63, Train loss: 1.463, Test loss: 1.507, Test accuracy: 95.77 

Round  63, Global train loss: 1.463, Global test loss: 2.065, Global test accuracy: 40.00 

Round  64, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.77 

Round  64, Global train loss: 1.464, Global test loss: 2.156, Global test accuracy: 28.50 

Round  65, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.77 

Round  65, Global train loss: 1.466, Global test loss: 2.264, Global test accuracy: 17.20 

Round  66, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.77 

Round  66, Global train loss: 1.464, Global test loss: 2.062, Global test accuracy: 49.27 

Round  67, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.77 

Round  67, Global train loss: 1.464, Global test loss: 2.075, Global test accuracy: 39.75 

Round  68, Train loss: 1.465, Test loss: 1.507, Test accuracy: 95.77 

Round  68, Global train loss: 1.465, Global test loss: 2.032, Global test accuracy: 45.05 

Round  69, Train loss: 1.465, Test loss: 1.507, Test accuracy: 95.77 

Round  69, Global train loss: 1.465, Global test loss: 2.144, Global test accuracy: 33.30 

Round  70, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.77 

Round  70, Global train loss: 1.464, Global test loss: 2.039, Global test accuracy: 38.80 

Round  71, Train loss: 1.468, Test loss: 1.507, Test accuracy: 95.77 

Round  71, Global train loss: 1.468, Global test loss: 2.063, Global test accuracy: 46.43 

Round  72, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.75 

Round  72, Global train loss: 1.464, Global test loss: 2.142, Global test accuracy: 33.93 

Round  73, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.75 

Round  73, Global train loss: 1.464, Global test loss: 2.160, Global test accuracy: 29.22 

Round  74, Train loss: 1.466, Test loss: 1.507, Test accuracy: 95.75 

Round  74, Global train loss: 1.466, Global test loss: 2.069, Global test accuracy: 38.07 

Round  75, Train loss: 1.465, Test loss: 1.507, Test accuracy: 95.77 

Round  75, Global train loss: 1.465, Global test loss: 2.160, Global test accuracy: 31.62 

Round  76, Train loss: 1.463, Test loss: 1.507, Test accuracy: 95.77 

Round  76, Global train loss: 1.463, Global test loss: 2.040, Global test accuracy: 41.60 

Round  77, Train loss: 1.464, Test loss: 1.507, Test accuracy: 95.77 

Round  77, Global train loss: 1.464, Global test loss: 2.129, Global test accuracy: 29.70 

Round  78, Train loss: 1.465, Test loss: 1.507, Test accuracy: 95.78 

Round  78, Global train loss: 1.465, Global test loss: 2.191, Global test accuracy: 26.37 

Round  79, Train loss: 1.467, Test loss: 1.506, Test accuracy: 95.78 

Round  79, Global train loss: 1.467, Global test loss: 2.117, Global test accuracy: 34.85 

Round  80, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.80 

Round  80, Global train loss: 1.465, Global test loss: 2.050, Global test accuracy: 42.50 

Round  81, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.82 

Round  81, Global train loss: 1.465, Global test loss: 2.054, Global test accuracy: 44.05 

Round  82, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.78 

Round  82, Global train loss: 1.465, Global test loss: 2.053, Global test accuracy: 39.25 

Round  83, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.78 

Round  83, Global train loss: 1.465, Global test loss: 2.040, Global test accuracy: 40.53 

Round  84, Train loss: 1.466, Test loss: 1.506, Test accuracy: 95.80 

Round  84, Global train loss: 1.466, Global test loss: 2.258, Global test accuracy: 17.08 

Round  85, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.80 

Round  85, Global train loss: 1.465, Global test loss: 2.115, Global test accuracy: 32.58 

Round  86, Train loss: 1.466, Test loss: 1.506, Test accuracy: 95.77 

Round  86, Global train loss: 1.466, Global test loss: 2.166, Global test accuracy: 28.22 

Round  87, Train loss: 1.463, Test loss: 1.506, Test accuracy: 95.78 

Round  87, Global train loss: 1.463, Global test loss: 1.998, Global test accuracy: 49.32 

Round  88, Train loss: 1.464, Test loss: 1.506, Test accuracy: 95.80 

Round  88, Global train loss: 1.464, Global test loss: 2.153, Global test accuracy: 29.45 

Round  89, Train loss: 1.464, Test loss: 1.506, Test accuracy: 95.83 

Round  89, Global train loss: 1.464, Global test loss: 2.076, Global test accuracy: 38.68 

Round  90, Train loss: 1.464, Test loss: 1.506, Test accuracy: 95.83 

Round  90, Global train loss: 1.464, Global test loss: 2.185, Global test accuracy: 24.30 

Round  91, Train loss: 1.464, Test loss: 1.506, Test accuracy: 95.83 

Round  91, Global train loss: 1.464, Global test loss: 2.035, Global test accuracy: 48.90 

Round  92, Train loss: 1.466, Test loss: 1.506, Test accuracy: 95.82 

Round  92, Global train loss: 1.466, Global test loss: 2.127, Global test accuracy: 33.38 

Round  93, Train loss: 1.466, Test loss: 1.506, Test accuracy: 95.82 

Round  93, Global train loss: 1.466, Global test loss: 2.058, Global test accuracy: 45.87 

Round  94, Train loss: 1.464, Test loss: 1.506, Test accuracy: 95.83 

Round  94, Global train loss: 1.464, Global test loss: 2.087, Global test accuracy: 39.12 

Round  95, Train loss: 1.463, Test loss: 1.506, Test accuracy: 95.83 

Round  95, Global train loss: 1.463, Global test loss: 2.128, Global test accuracy: 33.17 

Round  96, Train loss: 1.466, Test loss: 1.506, Test accuracy: 95.83 

Round  96, Global train loss: 1.466, Global test loss: 2.129, Global test accuracy: 33.32 

Round  97, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.83 

Round  97, Global train loss: 1.465, Global test loss: 2.144, Global test accuracy: 25.92 

Round  98, Train loss: 1.466, Test loss: 1.506, Test accuracy: 95.83 

Round  98, Global train loss: 1.466, Global test loss: 2.123, Global test accuracy: 35.27 

Round  99, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.83 

Round  99, Global train loss: 1.465, Global test loss: 2.098, Global test accuracy: 37.30 

Final Round, Train loss: 1.465, Test loss: 1.506, Test accuracy: 95.85 

Final Round, Global train loss: 1.465, Global test loss: 2.098, Global test accuracy: 37.30 

Average accuracy final 10 rounds: 95.82999999999997 

Average global accuracy final 10 rounds: 35.653333333333336 

591.391092300415
[1.4934957027435303, 2.0194203853607178, 2.518923759460449, 3.1156468391418457, 3.7125191688537598, 4.306679010391235, 4.897475481033325, 5.507754325866699, 6.089344024658203, 6.68004846572876, 7.2689433097839355, 7.861323595046997, 8.452969789505005, 9.04868483543396, 9.64059329032898, 10.23934006690979, 10.837762117385864, 11.436463594436646, 12.037525177001953, 12.633561372756958, 13.230336427688599, 13.825176000595093, 14.422168731689453, 15.018215656280518, 15.613181591033936, 16.21067714691162, 16.78499937057495, 17.358758211135864, 17.930910348892212, 18.52067470550537, 19.11278986930847, 19.56837558746338, 20.02440094947815, 20.4778733253479, 20.93637180328369, 21.392523765563965, 21.85344886779785, 22.31319808959961, 22.77619481086731, 23.233991146087646, 23.700339317321777, 24.15881872177124, 24.62180781364441, 25.07876944541931, 25.53884720802307, 26.007331371307373, 26.468451976776123, 26.93241310119629, 27.402029037475586, 27.86634612083435, 28.45885396003723, 29.050776720046997, 29.6526038646698, 30.246747255325317, 30.841432571411133, 31.436360836029053, 32.03598618507385, 32.633745193481445, 33.23300242424011, 33.829357624053955, 34.4207022190094, 35.01164746284485, 35.602275371551514, 36.19386649131775, 36.79423499107361, 37.24606680870056, 37.69347548484802, 38.1460542678833, 38.594600200653076, 39.043548345565796, 39.49089479446411, 39.9480664730072, 40.39935088157654, 40.84554719924927, 41.29188585281372, 41.73845028877258, 42.18753147125244, 42.63500905036926, 43.083982944488525, 43.53219509124756, 43.97660207748413, 44.425259590148926, 44.87166500091553, 45.321616888046265, 45.76928520202637, 46.21593976020813, 46.663758993148804, 47.11237716674805, 47.5618622303009, 48.0101854801178, 48.45986533164978, 48.906174421310425, 49.35044860839844, 49.797032833099365, 50.244065046310425, 50.69071888923645, 51.14199995994568, 51.59170627593994, 52.03812599182129, 52.48345637321472, 53.379080057144165]
[28.716666666666665, 31.95, 53.31666666666667, 58.25, 69.23333333333333, 76.95, 77.91666666666667, 86.31666666666666, 86.48333333333333, 91.7, 93.51666666666667, 95.28333333333333, 95.45, 95.51666666666667, 95.5, 95.46666666666667, 95.5, 95.48333333333333, 95.66666666666667, 95.56666666666666, 95.6, 95.6, 95.61666666666666, 95.63333333333334, 95.63333333333334, 95.7, 95.7, 95.61666666666666, 95.61666666666666, 95.66666666666667, 95.66666666666667, 95.68333333333334, 95.66666666666667, 95.68333333333334, 95.65, 95.66666666666667, 95.71666666666667, 95.71666666666667, 95.71666666666667, 95.73333333333333, 95.73333333333333, 95.71666666666667, 95.71666666666667, 95.71666666666667, 95.71666666666667, 95.73333333333333, 95.73333333333333, 95.73333333333333, 95.73333333333333, 95.73333333333333, 95.73333333333333, 95.75, 95.75, 95.75, 95.75, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.78333333333333, 95.78333333333333, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.75, 95.75, 95.75, 95.76666666666667, 95.76666666666667, 95.76666666666667, 95.78333333333333, 95.78333333333333, 95.8, 95.81666666666666, 95.78333333333333, 95.78333333333333, 95.8, 95.8, 95.76666666666667, 95.78333333333333, 95.8, 95.83333333333333, 95.83333333333333, 95.83333333333333, 95.81666666666666, 95.81666666666666, 95.83333333333333, 95.83333333333333, 95.83333333333333, 95.83333333333333, 95.83333333333333, 95.83333333333333, 95.85]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.284, Test loss: 2.280, Test accuracy: 20.78 

Round   0, Global train loss: 2.284, Global test loss: 2.294, Global test accuracy: 15.00 

Round   1, Train loss: 2.203, Test loss: 2.207, Test accuracy: 25.37 

Round   1, Global train loss: 2.203, Global test loss: 2.245, Global test accuracy: 16.98 

Round   2, Train loss: 2.072, Test loss: 2.112, Test accuracy: 37.38 

Round   2, Global train loss: 2.072, Global test loss: 2.193, Global test accuracy: 22.08 

Round   3, Train loss: 2.004, Test loss: 2.024, Test accuracy: 46.57 

Round   3, Global train loss: 2.004, Global test loss: 2.234, Global test accuracy: 17.07 

Round   4, Train loss: 1.849, Test loss: 1.906, Test accuracy: 61.13 

Round   4, Global train loss: 1.849, Global test loss: 2.109, Global test accuracy: 38.28 

Round   5, Train loss: 1.679, Test loss: 1.807, Test accuracy: 68.87 

Round   5, Global train loss: 1.679, Global test loss: 2.066, Global test accuracy: 39.43 

Round   6, Train loss: 1.803, Test loss: 1.753, Test accuracy: 73.72 

Round   6, Global train loss: 1.803, Global test loss: 2.080, Global test accuracy: 33.62 

Round   7, Train loss: 1.706, Test loss: 1.686, Test accuracy: 79.93 

Round   7, Global train loss: 1.706, Global test loss: 1.967, Global test accuracy: 50.17 

Round   8, Train loss: 1.643, Test loss: 1.676, Test accuracy: 80.18 

Round   8, Global train loss: 1.643, Global test loss: 1.979, Global test accuracy: 49.53 

Round   9, Train loss: 1.557, Test loss: 1.635, Test accuracy: 84.63 

Round   9, Global train loss: 1.557, Global test loss: 1.997, Global test accuracy: 44.70 

Round  10, Train loss: 1.597, Test loss: 1.626, Test accuracy: 84.83 

Round  10, Global train loss: 1.597, Global test loss: 1.872, Global test accuracy: 62.30 

Round  11, Train loss: 1.540, Test loss: 1.622, Test accuracy: 84.95 

Round  11, Global train loss: 1.540, Global test loss: 1.813, Global test accuracy: 70.82 

Round  12, Train loss: 1.535, Test loss: 1.619, Test accuracy: 85.22 

Round  12, Global train loss: 1.535, Global test loss: 1.786, Global test accuracy: 72.10 

Round  13, Train loss: 1.568, Test loss: 1.604, Test accuracy: 86.68 

Round  13, Global train loss: 1.568, Global test loss: 1.776, Global test accuracy: 73.28 

Round  14, Train loss: 1.618, Test loss: 1.601, Test accuracy: 86.92 

Round  14, Global train loss: 1.618, Global test loss: 1.783, Global test accuracy: 70.72 

Round  15, Train loss: 1.607, Test loss: 1.599, Test accuracy: 86.97 

Round  15, Global train loss: 1.607, Global test loss: 1.770, Global test accuracy: 72.73 

Round  16, Train loss: 1.555, Test loss: 1.582, Test accuracy: 88.55 

Round  16, Global train loss: 1.555, Global test loss: 1.756, Global test accuracy: 71.27 

Round  17, Train loss: 1.605, Test loss: 1.582, Test accuracy: 88.55 

Round  17, Global train loss: 1.605, Global test loss: 1.758, Global test accuracy: 72.22 

Round  18, Train loss: 1.552, Test loss: 1.581, Test accuracy: 88.52 

Round  18, Global train loss: 1.552, Global test loss: 1.782, Global test accuracy: 69.60 

Round  19, Train loss: 1.597, Test loss: 1.581, Test accuracy: 88.43 

Round  19, Global train loss: 1.597, Global test loss: 1.769, Global test accuracy: 70.90 

Round  20, Train loss: 1.600, Test loss: 1.581, Test accuracy: 88.47 

Round  20, Global train loss: 1.600, Global test loss: 1.770, Global test accuracy: 70.98 

Round  21, Train loss: 1.494, Test loss: 1.580, Test accuracy: 88.37 

Round  21, Global train loss: 1.494, Global test loss: 1.753, Global test accuracy: 72.98 

Round  22, Train loss: 1.547, Test loss: 1.576, Test accuracy: 88.70 

Round  22, Global train loss: 1.547, Global test loss: 1.731, Global test accuracy: 74.35 

Round  23, Train loss: 1.532, Test loss: 1.577, Test accuracy: 88.72 

Round  23, Global train loss: 1.532, Global test loss: 1.744, Global test accuracy: 72.98 

Round  24, Train loss: 1.592, Test loss: 1.577, Test accuracy: 88.75 

Round  24, Global train loss: 1.592, Global test loss: 1.742, Global test accuracy: 74.00 

Round  25, Train loss: 1.589, Test loss: 1.576, Test accuracy: 88.80 

Round  25, Global train loss: 1.589, Global test loss: 1.730, Global test accuracy: 74.37 

Round  26, Train loss: 1.553, Test loss: 1.577, Test accuracy: 88.77 

Round  26, Global train loss: 1.553, Global test loss: 1.736, Global test accuracy: 74.30 

Round  27, Train loss: 1.490, Test loss: 1.577, Test accuracy: 88.75 

Round  27, Global train loss: 1.490, Global test loss: 1.790, Global test accuracy: 69.88 

Round  28, Train loss: 1.541, Test loss: 1.577, Test accuracy: 88.73 

Round  28, Global train loss: 1.541, Global test loss: 1.735, Global test accuracy: 74.30 

Round  29, Train loss: 1.607, Test loss: 1.577, Test accuracy: 88.70 

Round  29, Global train loss: 1.607, Global test loss: 1.722, Global test accuracy: 74.50 

Round  30, Train loss: 1.645, Test loss: 1.577, Test accuracy: 88.73 

Round  30, Global train loss: 1.645, Global test loss: 1.728, Global test accuracy: 73.63 

Round  31, Train loss: 1.536, Test loss: 1.577, Test accuracy: 88.67 

Round  31, Global train loss: 1.536, Global test loss: 1.709, Global test accuracy: 77.05 

Round  32, Train loss: 1.538, Test loss: 1.578, Test accuracy: 88.57 

Round  32, Global train loss: 1.538, Global test loss: 1.710, Global test accuracy: 77.37 

Round  33, Train loss: 1.586, Test loss: 1.578, Test accuracy: 88.60 

Round  33, Global train loss: 1.586, Global test loss: 1.706, Global test accuracy: 77.12 

Round  34, Train loss: 1.589, Test loss: 1.578, Test accuracy: 88.57 

Round  34, Global train loss: 1.589, Global test loss: 1.705, Global test accuracy: 75.58 

Round  35, Train loss: 1.583, Test loss: 1.577, Test accuracy: 88.62 

Round  35, Global train loss: 1.583, Global test loss: 1.735, Global test accuracy: 73.32 

Round  36, Train loss: 1.591, Test loss: 1.576, Test accuracy: 88.75 

Round  36, Global train loss: 1.591, Global test loss: 1.722, Global test accuracy: 74.68 

Round  37, Train loss: 1.591, Test loss: 1.573, Test accuracy: 88.97 

Round  37, Global train loss: 1.591, Global test loss: 1.681, Global test accuracy: 80.82 

Round  38, Train loss: 1.585, Test loss: 1.574, Test accuracy: 88.78 

Round  38, Global train loss: 1.585, Global test loss: 1.694, Global test accuracy: 77.45 

Round  39, Train loss: 1.584, Test loss: 1.573, Test accuracy: 88.92 

Round  39, Global train loss: 1.584, Global test loss: 1.714, Global test accuracy: 75.82 

Round  40, Train loss: 1.594, Test loss: 1.574, Test accuracy: 88.87 

Round  40, Global train loss: 1.594, Global test loss: 1.695, Global test accuracy: 78.65 

Round  41, Train loss: 1.586, Test loss: 1.574, Test accuracy: 88.93 

Round  41, Global train loss: 1.586, Global test loss: 1.733, Global test accuracy: 73.20 

Round  42, Train loss: 1.532, Test loss: 1.573, Test accuracy: 88.97 

Round  42, Global train loss: 1.532, Global test loss: 1.719, Global test accuracy: 76.90 

Round  43, Train loss: 1.588, Test loss: 1.575, Test accuracy: 88.80 

Round  43, Global train loss: 1.588, Global test loss: 1.694, Global test accuracy: 78.20 

Round  44, Train loss: 1.584, Test loss: 1.575, Test accuracy: 88.87 

Round  44, Global train loss: 1.584, Global test loss: 1.692, Global test accuracy: 77.38 

Round  45, Train loss: 1.532, Test loss: 1.575, Test accuracy: 88.80 

Round  45, Global train loss: 1.532, Global test loss: 1.679, Global test accuracy: 78.73 

Round  46, Train loss: 1.536, Test loss: 1.576, Test accuracy: 88.72 

Round  46, Global train loss: 1.536, Global test loss: 1.681, Global test accuracy: 78.85 

Round  47, Train loss: 1.530, Test loss: 1.575, Test accuracy: 88.75 

Round  47, Global train loss: 1.530, Global test loss: 1.678, Global test accuracy: 79.00 

Round  48, Train loss: 1.526, Test loss: 1.575, Test accuracy: 88.72 

Round  48, Global train loss: 1.526, Global test loss: 1.697, Global test accuracy: 76.55 

Round  49, Train loss: 1.481, Test loss: 1.574, Test accuracy: 88.82 

Round  49, Global train loss: 1.481, Global test loss: 1.676, Global test accuracy: 79.20 

Round  50, Train loss: 1.583, Test loss: 1.573, Test accuracy: 88.82 

Round  50, Global train loss: 1.583, Global test loss: 1.687, Global test accuracy: 77.08 

Round  51, Train loss: 1.525, Test loss: 1.574, Test accuracy: 88.82 

Round  51, Global train loss: 1.525, Global test loss: 1.672, Global test accuracy: 79.60 

Round  52, Train loss: 1.529, Test loss: 1.575, Test accuracy: 88.68 

Round  52, Global train loss: 1.529, Global test loss: 1.703, Global test accuracy: 76.57 

Round  53, Train loss: 1.531, Test loss: 1.575, Test accuracy: 88.75 

Round  53, Global train loss: 1.531, Global test loss: 1.706, Global test accuracy: 76.20 

Round  54, Train loss: 1.477, Test loss: 1.575, Test accuracy: 88.67 

Round  54, Global train loss: 1.477, Global test loss: 1.715, Global test accuracy: 75.78 

Round  55, Train loss: 1.583, Test loss: 1.576, Test accuracy: 88.52 

Round  55, Global train loss: 1.583, Global test loss: 1.722, Global test accuracy: 74.33 

Round  56, Train loss: 1.530, Test loss: 1.575, Test accuracy: 88.72 

Round  56, Global train loss: 1.530, Global test loss: 1.681, Global test accuracy: 77.70 

Round  57, Train loss: 1.526, Test loss: 1.575, Test accuracy: 88.75 

Round  57, Global train loss: 1.526, Global test loss: 1.712, Global test accuracy: 75.35 

Round  58, Train loss: 1.587, Test loss: 1.573, Test accuracy: 88.90 

Round  58, Global train loss: 1.587, Global test loss: 1.658, Global test accuracy: 81.90 

Round  59, Train loss: 1.580, Test loss: 1.573, Test accuracy: 88.92 

Round  59, Global train loss: 1.580, Global test loss: 1.676, Global test accuracy: 79.45 

Round  60, Train loss: 1.586, Test loss: 1.573, Test accuracy: 88.87 

Round  60, Global train loss: 1.586, Global test loss: 1.680, Global test accuracy: 78.42 

Round  61, Train loss: 1.641, Test loss: 1.573, Test accuracy: 88.88 

Round  61, Global train loss: 1.641, Global test loss: 1.652, Global test accuracy: 82.15 

Round  62, Train loss: 1.584, Test loss: 1.572, Test accuracy: 88.98 

Round  62, Global train loss: 1.584, Global test loss: 1.668, Global test accuracy: 80.78 

Round  63, Train loss: 1.581, Test loss: 1.573, Test accuracy: 88.97 

Round  63, Global train loss: 1.581, Global test loss: 1.650, Global test accuracy: 82.73 

Round  64, Train loss: 1.527, Test loss: 1.572, Test accuracy: 88.95 

Round  64, Global train loss: 1.527, Global test loss: 1.654, Global test accuracy: 82.73 

Round  65, Train loss: 1.582, Test loss: 1.572, Test accuracy: 88.97 

Round  65, Global train loss: 1.582, Global test loss: 1.685, Global test accuracy: 77.42 

Round  66, Train loss: 1.633, Test loss: 1.573, Test accuracy: 88.93 

Round  66, Global train loss: 1.633, Global test loss: 1.673, Global test accuracy: 78.38 

Round  67, Train loss: 1.527, Test loss: 1.572, Test accuracy: 88.93 

Round  67, Global train loss: 1.527, Global test loss: 1.700, Global test accuracy: 76.15 

Round  68, Train loss: 1.526, Test loss: 1.572, Test accuracy: 88.88 

Round  68, Global train loss: 1.526, Global test loss: 1.681, Global test accuracy: 77.72 

Round  69, Train loss: 1.528, Test loss: 1.572, Test accuracy: 88.87 

Round  69, Global train loss: 1.528, Global test loss: 1.664, Global test accuracy: 81.45 

Round  70, Train loss: 1.527, Test loss: 1.572, Test accuracy: 88.92 

Round  70, Global train loss: 1.527, Global test loss: 1.659, Global test accuracy: 81.17 

Round  71, Train loss: 1.527, Test loss: 1.572, Test accuracy: 88.97 

Round  71, Global train loss: 1.527, Global test loss: 1.666, Global test accuracy: 80.18 

Round  72, Train loss: 1.577, Test loss: 1.572, Test accuracy: 88.90 

Round  72, Global train loss: 1.577, Global test loss: 1.665, Global test accuracy: 80.23 

Round  73, Train loss: 1.688, Test loss: 1.572, Test accuracy: 88.87 

Round  73, Global train loss: 1.688, Global test loss: 1.688, Global test accuracy: 77.93 

Round  74, Train loss: 1.530, Test loss: 1.573, Test accuracy: 88.78 

Round  74, Global train loss: 1.530, Global test loss: 1.654, Global test accuracy: 82.37 

Round  75, Train loss: 1.633, Test loss: 1.573, Test accuracy: 88.82 

Round  75, Global train loss: 1.633, Global test loss: 1.682, Global test accuracy: 78.85 

Round  76, Train loss: 1.635, Test loss: 1.573, Test accuracy: 88.80 

Round  76, Global train loss: 1.635, Global test loss: 1.645, Global test accuracy: 83.37 

Round  77, Train loss: 1.583, Test loss: 1.573, Test accuracy: 88.85 

Round  77, Global train loss: 1.583, Global test loss: 1.676, Global test accuracy: 79.00 

Round  78, Train loss: 1.578, Test loss: 1.573, Test accuracy: 88.85 

Round  78, Global train loss: 1.578, Global test loss: 1.672, Global test accuracy: 78.87 

Round  79, Train loss: 1.580, Test loss: 1.573, Test accuracy: 88.85 

Round  79, Global train loss: 1.580, Global test loss: 1.679, Global test accuracy: 78.50 

Round  80, Train loss: 1.580, Test loss: 1.573, Test accuracy: 88.88 

Round  80, Global train loss: 1.580, Global test loss: 1.670, Global test accuracy: 79.38 

Round  81, Train loss: 1.524, Test loss: 1.573, Test accuracy: 88.88 

Round  81, Global train loss: 1.524, Global test loss: 1.668, Global test accuracy: 79.95 

Round  82, Train loss: 1.582, Test loss: 1.573, Test accuracy: 88.90 

Round  82, Global train loss: 1.582, Global test loss: 1.648, Global test accuracy: 83.15 

Round  83, Train loss: 1.525, Test loss: 1.572, Test accuracy: 88.92 

Round  83, Global train loss: 1.525, Global test loss: 1.686, Global test accuracy: 76.98 

Round  84, Train loss: 1.632, Test loss: 1.572, Test accuracy: 88.97 

Round  84, Global train loss: 1.632, Global test loss: 1.711, Global test accuracy: 74.95 

Round  85, Train loss: 1.582, Test loss: 1.572, Test accuracy: 88.93 

Round  85, Global train loss: 1.582, Global test loss: 1.642, Global test accuracy: 82.63 

Round  86, Train loss: 1.526, Test loss: 1.572, Test accuracy: 88.90 

Round  86, Global train loss: 1.526, Global test loss: 1.649, Global test accuracy: 82.75 

Round  87, Train loss: 1.470, Test loss: 1.572, Test accuracy: 88.77 

Round  87, Global train loss: 1.470, Global test loss: 1.660, Global test accuracy: 80.80 

Round  88, Train loss: 1.580, Test loss: 1.572, Test accuracy: 88.82 

Round  88, Global train loss: 1.580, Global test loss: 1.663, Global test accuracy: 80.30 

Round  89, Train loss: 1.578, Test loss: 1.572, Test accuracy: 88.83 

Round  89, Global train loss: 1.578, Global test loss: 1.685, Global test accuracy: 77.78 

Round  90, Train loss: 1.527, Test loss: 1.573, Test accuracy: 88.73 

Round  90, Global train loss: 1.527, Global test loss: 1.635, Global test accuracy: 84.02 

Round  91, Train loss: 1.526, Test loss: 1.573, Test accuracy: 88.77 

Round  91, Global train loss: 1.526, Global test loss: 1.645, Global test accuracy: 82.88 

Round  92, Train loss: 1.524, Test loss: 1.572, Test accuracy: 88.83 

Round  92, Global train loss: 1.524, Global test loss: 1.641, Global test accuracy: 82.97 

Round  93, Train loss: 1.577, Test loss: 1.572, Test accuracy: 88.73 

Round  93, Global train loss: 1.577, Global test loss: 1.655, Global test accuracy: 81.67 

Round  94, Train loss: 1.468, Test loss: 1.573, Test accuracy: 88.78 

Round  94, Global train loss: 1.468, Global test loss: 1.645, Global test accuracy: 82.77 

Round  95, Train loss: 1.525, Test loss: 1.572, Test accuracy: 88.83 

Round  95, Global train loss: 1.525, Global test loss: 1.653, Global test accuracy: 81.42 

Round  96, Train loss: 1.523, Test loss: 1.572, Test accuracy: 88.90 

Round  96, Global train loss: 1.523, Global test loss: 1.644, Global test accuracy: 82.87 

Round  97, Train loss: 1.580, Test loss: 1.572, Test accuracy: 88.92 

Round  97, Global train loss: 1.580, Global test loss: 1.667, Global test accuracy: 79.30 

Round  98, Train loss: 1.578, Test loss: 1.571, Test accuracy: 88.98 

Round  98, Global train loss: 1.578, Global test loss: 1.653, Global test accuracy: 81.40 

Round  99, Train loss: 1.524, Test loss: 1.572, Test accuracy: 88.90 

Round  99, Global train loss: 1.524, Global test loss: 1.652, Global test accuracy: 81.85 

Final Round, Train loss: 1.549, Test loss: 1.572, Test accuracy: 88.75 

Final Round, Global train loss: 1.549, Global test loss: 1.652, Global test accuracy: 81.85 

Average accuracy final 10 rounds: 88.83833333333335 

Average global accuracy final 10 rounds: 82.11333333333333 

642.7448492050171
[1.472015619277954, 2.0619335174560547, 2.6527645587921143, 3.240341901779175, 3.830770254135132, 4.418861627578735, 5.006895542144775, 5.597878932952881, 6.187048673629761, 6.780205011367798, 7.36830472946167, 7.956808805465698, 8.548903465270996, 9.137728929519653, 9.71904706954956, 10.31156587600708, 10.904818296432495, 11.495946168899536, 12.08333444595337, 12.676516771316528, 13.268306970596313, 13.860279083251953, 14.451289653778076, 15.041691064834595, 15.632164239883423, 16.220402002334595, 16.809250116348267, 17.39829182624817, 17.98701047897339, 18.575411081314087, 19.16385316848755, 19.75052785873413, 20.340261220932007, 20.927542209625244, 21.519312143325806, 22.1063232421875, 22.6932430267334, 23.283450841903687, 23.867270469665527, 24.45467710494995, 25.040607690811157, 25.62845802307129, 26.21494150161743, 26.802873134613037, 27.393901348114014, 27.98522162437439, 28.573254585266113, 29.156474828720093, 29.741767644882202, 30.332738399505615, 30.927566051483154, 31.513413429260254, 32.103843450546265, 32.68938064575195, 33.274930238723755, 33.86082410812378, 34.44521975517273, 35.03109788894653, 35.61847925186157, 36.20852208137512, 36.79982376098633, 37.39031457901001, 37.979992389678955, 38.567840576171875, 39.15390729904175, 39.74243474006653, 40.33609390258789, 40.92470026016235, 41.510246992111206, 42.09942626953125, 42.68638730049133, 43.29663014411926, 43.89023208618164, 44.482337474823, 45.07550549507141, 45.66519498825073, 46.25517654418945, 46.846274614334106, 47.43666434288025, 48.031994104385376, 48.62371611595154, 49.21604585647583, 49.80822229385376, 50.40122437477112, 50.98780679702759, 51.57873320579529, 52.171435594558716, 52.76229476928711, 53.34996581077576, 53.94731283187866, 54.53917837142944, 55.130850315093994, 55.7216055393219, 56.313469886779785, 56.904807567596436, 57.50163769721985, 58.091442584991455, 58.67976212501526, 59.27295732498169, 59.860589265823364, 61.036715030670166]
[20.783333333333335, 25.366666666666667, 37.38333333333333, 46.56666666666667, 61.13333333333333, 68.86666666666666, 73.71666666666667, 79.93333333333334, 80.18333333333334, 84.63333333333334, 84.83333333333333, 84.95, 85.21666666666667, 86.68333333333334, 86.91666666666667, 86.96666666666667, 88.55, 88.55, 88.51666666666667, 88.43333333333334, 88.46666666666667, 88.36666666666666, 88.7, 88.71666666666667, 88.75, 88.8, 88.76666666666667, 88.75, 88.73333333333333, 88.7, 88.73333333333333, 88.66666666666667, 88.56666666666666, 88.6, 88.56666666666666, 88.61666666666666, 88.75, 88.96666666666667, 88.78333333333333, 88.91666666666667, 88.86666666666666, 88.93333333333334, 88.96666666666667, 88.8, 88.86666666666666, 88.8, 88.71666666666667, 88.75, 88.71666666666667, 88.81666666666666, 88.81666666666666, 88.81666666666666, 88.68333333333334, 88.75, 88.66666666666667, 88.51666666666667, 88.71666666666667, 88.75, 88.9, 88.91666666666667, 88.86666666666666, 88.88333333333334, 88.98333333333333, 88.96666666666667, 88.95, 88.96666666666667, 88.93333333333334, 88.93333333333334, 88.88333333333334, 88.86666666666666, 88.91666666666667, 88.96666666666667, 88.9, 88.86666666666666, 88.78333333333333, 88.81666666666666, 88.8, 88.85, 88.85, 88.85, 88.88333333333334, 88.88333333333334, 88.9, 88.91666666666667, 88.96666666666667, 88.93333333333334, 88.9, 88.76666666666667, 88.81666666666666, 88.83333333333333, 88.73333333333333, 88.76666666666667, 88.83333333333333, 88.73333333333333, 88.78333333333333, 88.83333333333333, 88.9, 88.91666666666667, 88.98333333333333, 88.9, 88.75]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.294, Test loss: 2.296, Test accuracy: 30.73 

Round   1, Train loss: 2.282, Test loss: 2.288, Test accuracy: 36.65 

Round   2, Train loss: 2.253, Test loss: 2.256, Test accuracy: 21.72 

Round   3, Train loss: 2.178, Test loss: 2.207, Test accuracy: 39.70 

Round   4, Train loss: 2.067, Test loss: 2.139, Test accuracy: 37.02 

Round   5, Train loss: 1.981, Test loss: 2.039, Test accuracy: 45.37 

Round   6, Train loss: 1.752, Test loss: 1.960, Test accuracy: 52.35 

Round   7, Train loss: 1.808, Test loss: 1.898, Test accuracy: 58.78 

Round   8, Train loss: 1.787, Test loss: 1.865, Test accuracy: 60.53 

Round   9, Train loss: 1.713, Test loss: 1.844, Test accuracy: 62.53 

Round  10, Train loss: 1.793, Test loss: 1.828, Test accuracy: 63.83 

Round  11, Train loss: 1.759, Test loss: 1.790, Test accuracy: 67.65 

Round  12, Train loss: 1.679, Test loss: 1.778, Test accuracy: 69.60 

Round  13, Train loss: 1.791, Test loss: 1.761, Test accuracy: 71.20 

Round  14, Train loss: 1.768, Test loss: 1.737, Test accuracy: 73.88 

Round  15, Train loss: 1.678, Test loss: 1.724, Test accuracy: 74.93 

Round  16, Train loss: 1.787, Test loss: 1.716, Test accuracy: 75.72 

Round  17, Train loss: 1.679, Test loss: 1.714, Test accuracy: 75.80 

Round  18, Train loss: 1.723, Test loss: 1.712, Test accuracy: 75.73 

Round  19, Train loss: 1.710, Test loss: 1.704, Test accuracy: 76.53 

Round  20, Train loss: 1.680, Test loss: 1.695, Test accuracy: 77.80 

Round  21, Train loss: 1.701, Test loss: 1.693, Test accuracy: 77.82 

Round  22, Train loss: 1.616, Test loss: 1.693, Test accuracy: 77.78 

Round  23, Train loss: 1.701, Test loss: 1.692, Test accuracy: 77.60 

Round  24, Train loss: 1.724, Test loss: 1.674, Test accuracy: 79.75 

Round  25, Train loss: 1.614, Test loss: 1.671, Test accuracy: 79.78 

Round  26, Train loss: 1.710, Test loss: 1.671, Test accuracy: 79.83 

Round  27, Train loss: 1.766, Test loss: 1.669, Test accuracy: 79.97 

Round  28, Train loss: 1.760, Test loss: 1.669, Test accuracy: 79.83 

Round  29, Train loss: 1.701, Test loss: 1.669, Test accuracy: 79.88 

Round  30, Train loss: 1.722, Test loss: 1.670, Test accuracy: 79.25 

Round  31, Train loss: 1.659, Test loss: 1.653, Test accuracy: 81.18 

Round  32, Train loss: 1.605, Test loss: 1.650, Test accuracy: 81.32 

Round  33, Train loss: 1.516, Test loss: 1.633, Test accuracy: 83.20 

Round  34, Train loss: 1.670, Test loss: 1.625, Test accuracy: 84.47 

Round  35, Train loss: 1.543, Test loss: 1.624, Test accuracy: 84.60 

Round  36, Train loss: 1.649, Test loss: 1.623, Test accuracy: 84.70 

Round  37, Train loss: 1.717, Test loss: 1.620, Test accuracy: 84.78 

Round  38, Train loss: 1.534, Test loss: 1.620, Test accuracy: 84.43 

Round  39, Train loss: 1.610, Test loss: 1.609, Test accuracy: 85.83 

Round  40, Train loss: 1.603, Test loss: 1.607, Test accuracy: 86.13 

Round  41, Train loss: 1.489, Test loss: 1.606, Test accuracy: 86.28 

Round  42, Train loss: 1.597, Test loss: 1.605, Test accuracy: 86.28 

Round  43, Train loss: 1.609, Test loss: 1.604, Test accuracy: 86.23 

Round  44, Train loss: 1.592, Test loss: 1.604, Test accuracy: 86.32 

Round  45, Train loss: 1.484, Test loss: 1.603, Test accuracy: 86.35 

Round  46, Train loss: 1.604, Test loss: 1.602, Test accuracy: 86.42 

Round  47, Train loss: 1.657, Test loss: 1.600, Test accuracy: 86.53 

Round  48, Train loss: 1.593, Test loss: 1.600, Test accuracy: 86.57 

Round  49, Train loss: 1.610, Test loss: 1.591, Test accuracy: 87.47 

Round  50, Train loss: 1.541, Test loss: 1.590, Test accuracy: 87.62 

Round  51, Train loss: 1.547, Test loss: 1.590, Test accuracy: 87.58 

Round  52, Train loss: 1.508, Test loss: 1.577, Test accuracy: 89.00 

Round  53, Train loss: 1.546, Test loss: 1.576, Test accuracy: 89.15 

Round  54, Train loss: 1.539, Test loss: 1.573, Test accuracy: 89.43 

Round  55, Train loss: 1.590, Test loss: 1.573, Test accuracy: 89.37 

Round  56, Train loss: 1.601, Test loss: 1.574, Test accuracy: 89.28 

Round  57, Train loss: 1.592, Test loss: 1.574, Test accuracy: 89.27 

Round  58, Train loss: 1.482, Test loss: 1.575, Test accuracy: 89.20 

Round  59, Train loss: 1.586, Test loss: 1.574, Test accuracy: 89.30 

Round  60, Train loss: 1.517, Test loss: 1.561, Test accuracy: 90.40 

Round  61, Train loss: 1.487, Test loss: 1.559, Test accuracy: 90.55 

Round  62, Train loss: 1.535, Test loss: 1.558, Test accuracy: 90.70 

Round  63, Train loss: 1.548, Test loss: 1.557, Test accuracy: 90.78 

Round  64, Train loss: 1.530, Test loss: 1.559, Test accuracy: 90.52 

Round  65, Train loss: 1.538, Test loss: 1.557, Test accuracy: 90.77 

Round  66, Train loss: 1.526, Test loss: 1.557, Test accuracy: 90.60 

Round  67, Train loss: 1.506, Test loss: 1.546, Test accuracy: 91.88 

Round  68, Train loss: 1.534, Test loss: 1.545, Test accuracy: 91.95 

Round  69, Train loss: 1.475, Test loss: 1.545, Test accuracy: 91.98 

Round  70, Train loss: 1.543, Test loss: 1.542, Test accuracy: 92.23 

Round  71, Train loss: 1.532, Test loss: 1.543, Test accuracy: 92.28 

Round  72, Train loss: 1.485, Test loss: 1.542, Test accuracy: 92.23 

Round  73, Train loss: 1.509, Test loss: 1.532, Test accuracy: 93.43 

Round  74, Train loss: 1.569, Test loss: 1.529, Test accuracy: 93.78 

Round  75, Train loss: 1.478, Test loss: 1.529, Test accuracy: 93.65 

Round  76, Train loss: 1.492, Test loss: 1.530, Test accuracy: 93.60 

Round  77, Train loss: 1.551, Test loss: 1.530, Test accuracy: 93.52 

Round  78, Train loss: 1.487, Test loss: 1.528, Test accuracy: 93.70 

Round  79, Train loss: 1.478, Test loss: 1.528, Test accuracy: 93.70 

Round  80, Train loss: 1.534, Test loss: 1.528, Test accuracy: 93.65 

Round  81, Train loss: 1.477, Test loss: 1.528, Test accuracy: 93.75 

Round  82, Train loss: 1.533, Test loss: 1.527, Test accuracy: 93.78 

Round  83, Train loss: 1.481, Test loss: 1.527, Test accuracy: 93.77 

Round  84, Train loss: 1.537, Test loss: 1.527, Test accuracy: 93.83 

Round  85, Train loss: 1.481, Test loss: 1.527, Test accuracy: 93.90 

Round  86, Train loss: 1.530, Test loss: 1.526, Test accuracy: 93.98 

Round  87, Train loss: 1.490, Test loss: 1.526, Test accuracy: 93.92 

Round  88, Train loss: 1.478, Test loss: 1.526, Test accuracy: 93.93 

Round  89, Train loss: 1.496, Test loss: 1.524, Test accuracy: 94.20 

Round  90, Train loss: 1.472, Test loss: 1.524, Test accuracy: 94.10 

Round  91, Train loss: 1.478, Test loss: 1.524, Test accuracy: 94.03 

Round  92, Train loss: 1.474, Test loss: 1.524, Test accuracy: 94.08 

Round  93, Train loss: 1.484, Test loss: 1.524, Test accuracy: 94.15 

Round  94, Train loss: 1.479, Test loss: 1.524, Test accuracy: 94.10 

Round  95, Train loss: 1.531, Test loss: 1.524, Test accuracy: 94.05 

Round  96, Train loss: 1.532, Test loss: 1.523, Test accuracy: 94.12 

Round  97, Train loss: 1.475, Test loss: 1.524, Test accuracy: 93.93 

Round  98, Train loss: 1.479, Test loss: 1.522, Test accuracy: 94.15 

Round  99, Train loss: 1.537, Test loss: 1.523, Test accuracy: 94.12 

Final Round, Train loss: 1.491, Test loss: 1.510, Test accuracy: 95.42 

Average accuracy final 10 rounds: 94.08333333333333 

466.00286984443665
[1.4331419467926025, 1.998993158340454, 2.6025476455688477, 3.169895887374878, 3.7339730262756348, 4.298070430755615, 4.86059308052063, 5.425809383392334, 5.94978404045105, 6.471844911575317, 6.991499423980713, 7.514983415603638, 8.042261362075806, 8.561705112457275, 9.084162473678589, 9.603871583938599, 10.123937129974365, 10.64468502998352, 11.1673743724823, 11.686486959457397, 12.209672689437866, 12.733269214630127, 13.255034446716309, 13.772407293319702, 14.291310548782349, 14.815305233001709, 15.33708667755127, 15.859870195388794, 16.379242658615112, 16.900437593460083, 17.420970916748047, 17.94421076774597, 18.46636986732483, 18.985761165618896, 19.508655071258545, 20.022183418273926, 20.53948473930359, 21.064321756362915, 21.58409070968628, 22.10537052154541, 22.627519845962524, 23.148552417755127, 23.67068839073181, 24.190056324005127, 24.71570897102356, 25.23613977432251, 25.75572443008423, 26.292084217071533, 26.817145824432373, 27.338455200195312, 27.85742163658142, 28.377958059310913, 28.8991539478302, 29.42168402671814, 29.93811798095703, 30.462491750717163, 30.981769561767578, 31.502137899398804, 32.01877784729004, 32.54095220565796, 33.06154251098633, 33.580363750457764, 34.09949326515198, 34.619656801223755, 35.138591289520264, 35.65502643585205, 36.175734519958496, 36.69806265830994, 37.2212929725647, 37.75363850593567, 38.2738356590271, 38.79838514328003, 39.320204734802246, 39.84054160118103, 40.36170411109924, 40.881956577301025, 41.402928829193115, 41.925058126449585, 42.44263505935669, 42.95975375175476, 43.48581314086914, 44.0118625164032, 44.5342743396759, 45.06836748123169, 45.59156942367554, 46.11497974395752, 46.63268041610718, 47.15305995941162, 47.672160387039185, 48.19524359703064, 48.71548795700073, 49.23745393753052, 49.75450921058655, 50.272621631622314, 50.792285442352295, 51.31000280380249, 51.82689023017883, 52.34531378746033, 52.86380124092102, 53.38004207611084, 54.27553582191467]
[30.733333333333334, 36.65, 21.716666666666665, 39.7, 37.016666666666666, 45.36666666666667, 52.35, 58.78333333333333, 60.53333333333333, 62.53333333333333, 63.833333333333336, 67.65, 69.6, 71.2, 73.88333333333334, 74.93333333333334, 75.71666666666667, 75.8, 75.73333333333333, 76.53333333333333, 77.8, 77.81666666666666, 77.78333333333333, 77.6, 79.75, 79.78333333333333, 79.83333333333333, 79.96666666666667, 79.83333333333333, 79.88333333333334, 79.25, 81.18333333333334, 81.31666666666666, 83.2, 84.46666666666667, 84.6, 84.7, 84.78333333333333, 84.43333333333334, 85.83333333333333, 86.13333333333334, 86.28333333333333, 86.28333333333333, 86.23333333333333, 86.31666666666666, 86.35, 86.41666666666667, 86.53333333333333, 86.56666666666666, 87.46666666666667, 87.61666666666666, 87.58333333333333, 89.0, 89.15, 89.43333333333334, 89.36666666666666, 89.28333333333333, 89.26666666666667, 89.2, 89.3, 90.4, 90.55, 90.7, 90.78333333333333, 90.51666666666667, 90.76666666666667, 90.6, 91.88333333333334, 91.95, 91.98333333333333, 92.23333333333333, 92.28333333333333, 92.23333333333333, 93.43333333333334, 93.78333333333333, 93.65, 93.6, 93.51666666666667, 93.7, 93.7, 93.65, 93.75, 93.78333333333333, 93.76666666666667, 93.83333333333333, 93.9, 93.98333333333333, 93.91666666666667, 93.93333333333334, 94.2, 94.1, 94.03333333333333, 94.08333333333333, 94.15, 94.1, 94.05, 94.11666666666666, 93.93333333333334, 94.15, 94.11666666666666, 95.41666666666667]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedper  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedper , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedper
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.288, Test loss: 2.297, Test accuracy: 22.78 

Round   1, Train loss: 2.254, Test loss: 2.273, Test accuracy: 27.07 

Round   2, Train loss: 2.036, Test loss: 2.146, Test accuracy: 36.17 

Round   3, Train loss: 1.705, Test loss: 1.997, Test accuracy: 54.57 

Round   4, Train loss: 1.617, Test loss: 1.818, Test accuracy: 72.03 

Round   5, Train loss: 1.580, Test loss: 1.745, Test accuracy: 79.10 

Round   6, Train loss: 1.611, Test loss: 1.665, Test accuracy: 84.13 

Round   7, Train loss: 1.538, Test loss: 1.622, Test accuracy: 87.60 

Round   8, Train loss: 1.517, Test loss: 1.615, Test accuracy: 87.18 

Round   9, Train loss: 1.570, Test loss: 1.596, Test accuracy: 88.70 

Round  10, Train loss: 1.558, Test loss: 1.573, Test accuracy: 91.20 

Round  11, Train loss: 1.499, Test loss: 1.567, Test accuracy: 91.37 

Round  12, Train loss: 1.508, Test loss: 1.563, Test accuracy: 91.68 

Round  13, Train loss: 1.503, Test loss: 1.555, Test accuracy: 92.10 

Round  14, Train loss: 1.489, Test loss: 1.551, Test accuracy: 92.45 

Round  15, Train loss: 1.498, Test loss: 1.546, Test accuracy: 92.72 

Round  16, Train loss: 1.502, Test loss: 1.539, Test accuracy: 93.12 

Round  17, Train loss: 1.492, Test loss: 1.536, Test accuracy: 93.52 

Round  18, Train loss: 1.494, Test loss: 1.534, Test accuracy: 93.72 

Round  19, Train loss: 1.482, Test loss: 1.533, Test accuracy: 93.75 

Round  20, Train loss: 1.535, Test loss: 1.532, Test accuracy: 93.72 

Round  21, Train loss: 1.544, Test loss: 1.529, Test accuracy: 93.85 

Round  22, Train loss: 1.489, Test loss: 1.529, Test accuracy: 93.90 

Round  23, Train loss: 1.488, Test loss: 1.526, Test accuracy: 94.00 

Round  24, Train loss: 1.483, Test loss: 1.525, Test accuracy: 94.25 

Round  25, Train loss: 1.484, Test loss: 1.524, Test accuracy: 94.13 

Round  26, Train loss: 1.479, Test loss: 1.523, Test accuracy: 94.30 

Round  27, Train loss: 1.503, Test loss: 1.512, Test accuracy: 95.47 

Round  28, Train loss: 1.487, Test loss: 1.511, Test accuracy: 95.72 

Round  29, Train loss: 1.477, Test loss: 1.510, Test accuracy: 95.60 

Round  30, Train loss: 1.473, Test loss: 1.510, Test accuracy: 95.60 

Round  31, Train loss: 1.483, Test loss: 1.510, Test accuracy: 95.47 

Round  32, Train loss: 1.478, Test loss: 1.509, Test accuracy: 95.58 

Round  33, Train loss: 1.476, Test loss: 1.508, Test accuracy: 95.57 

Round  34, Train loss: 1.472, Test loss: 1.508, Test accuracy: 95.63 

Round  35, Train loss: 1.479, Test loss: 1.508, Test accuracy: 95.63 

Round  36, Train loss: 1.476, Test loss: 1.508, Test accuracy: 95.58 

Round  37, Train loss: 1.482, Test loss: 1.508, Test accuracy: 95.58 

Round  38, Train loss: 1.477, Test loss: 1.507, Test accuracy: 95.70 

Round  39, Train loss: 1.479, Test loss: 1.506, Test accuracy: 95.75 

Round  40, Train loss: 1.474, Test loss: 1.506, Test accuracy: 95.78 

Round  41, Train loss: 1.476, Test loss: 1.506, Test accuracy: 95.77 

Round  42, Train loss: 1.474, Test loss: 1.506, Test accuracy: 95.70 

Round  43, Train loss: 1.475, Test loss: 1.506, Test accuracy: 95.83 

Round  44, Train loss: 1.470, Test loss: 1.505, Test accuracy: 95.80 

Round  45, Train loss: 1.475, Test loss: 1.505, Test accuracy: 95.80 

Round  46, Train loss: 1.473, Test loss: 1.505, Test accuracy: 95.73 

Round  47, Train loss: 1.473, Test loss: 1.505, Test accuracy: 95.82 

Round  48, Train loss: 1.473, Test loss: 1.505, Test accuracy: 95.75 

Round  49, Train loss: 1.471, Test loss: 1.505, Test accuracy: 95.83 

Round  50, Train loss: 1.474, Test loss: 1.505, Test accuracy: 95.90 

Round  51, Train loss: 1.475, Test loss: 1.505, Test accuracy: 95.73 

Round  52, Train loss: 1.473, Test loss: 1.505, Test accuracy: 95.73 

Round  53, Train loss: 1.472, Test loss: 1.505, Test accuracy: 95.80 

Round  54, Train loss: 1.473, Test loss: 1.504, Test accuracy: 95.83 

Round  55, Train loss: 1.473, Test loss: 1.505, Test accuracy: 95.82 

Round  56, Train loss: 1.472, Test loss: 1.505, Test accuracy: 95.78 

Round  57, Train loss: 1.468, Test loss: 1.504, Test accuracy: 95.87 

Round  58, Train loss: 1.471, Test loss: 1.504, Test accuracy: 95.87 

Round  59, Train loss: 1.470, Test loss: 1.504, Test accuracy: 95.87 

Round  60, Train loss: 1.470, Test loss: 1.504, Test accuracy: 95.85 

Round  61, Train loss: 1.469, Test loss: 1.504, Test accuracy: 95.78 

Round  62, Train loss: 1.471, Test loss: 1.503, Test accuracy: 95.82 

Round  63, Train loss: 1.471, Test loss: 1.503, Test accuracy: 95.88 

Round  64, Train loss: 1.467, Test loss: 1.503, Test accuracy: 95.93 

Round  65, Train loss: 1.473, Test loss: 1.503, Test accuracy: 95.88 

Round  66, Train loss: 1.470, Test loss: 1.503, Test accuracy: 95.88 

Round  67, Train loss: 1.470, Test loss: 1.503, Test accuracy: 95.92 

Round  68, Train loss: 1.470, Test loss: 1.503, Test accuracy: 96.00 

Round  69, Train loss: 1.470, Test loss: 1.503, Test accuracy: 95.95 

Round  70, Train loss: 1.469, Test loss: 1.503, Test accuracy: 95.90 

Round  71, Train loss: 1.470, Test loss: 1.503, Test accuracy: 95.92 

Round  72, Train loss: 1.467, Test loss: 1.503, Test accuracy: 95.93 

Round  73, Train loss: 1.472, Test loss: 1.503, Test accuracy: 95.92 

Round  74, Train loss: 1.469, Test loss: 1.503, Test accuracy: 95.83 

Round  75, Train loss: 1.472, Test loss: 1.503, Test accuracy: 95.83 

Round  76, Train loss: 1.469, Test loss: 1.503, Test accuracy: 95.83 

Round  77, Train loss: 1.468, Test loss: 1.503, Test accuracy: 95.87 

Round  78, Train loss: 1.469, Test loss: 1.502, Test accuracy: 95.92 

Round  79, Train loss: 1.471, Test loss: 1.502, Test accuracy: 95.95 

Round  80, Train loss: 1.471, Test loss: 1.502, Test accuracy: 95.98 

Round  81, Train loss: 1.469, Test loss: 1.502, Test accuracy: 96.03 

Round  82, Train loss: 1.468, Test loss: 1.502, Test accuracy: 96.02 

Round  83, Train loss: 1.470, Test loss: 1.502, Test accuracy: 95.95 

Round  84, Train loss: 1.467, Test loss: 1.502, Test accuracy: 95.92 

Round  85, Train loss: 1.467, Test loss: 1.502, Test accuracy: 95.93 

Round  86, Train loss: 1.469, Test loss: 1.502, Test accuracy: 95.92 

Round  87, Train loss: 1.467, Test loss: 1.502, Test accuracy: 95.95 

Round  88, Train loss: 1.470, Test loss: 1.502, Test accuracy: 96.07 

Round  89, Train loss: 1.468, Test loss: 1.502, Test accuracy: 95.95 

Round  90, Train loss: 1.469, Test loss: 1.502, Test accuracy: 95.98 

Round  91, Train loss: 1.470, Test loss: 1.502, Test accuracy: 95.97 

Round  92, Train loss: 1.469, Test loss: 1.502, Test accuracy: 95.95 

Round  93, Train loss: 1.468, Test loss: 1.502, Test accuracy: 95.93 

Round  94, Train loss: 1.469, Test loss: 1.502, Test accuracy: 96.03 

Round  95, Train loss: 1.469, Test loss: 1.502, Test accuracy: 96.02 

Round  96, Train loss: 1.470, Test loss: 1.502, Test accuracy: 96.05 

Round  97, Train loss: 1.470, Test loss: 1.502, Test accuracy: 96.00 

Round  98, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.03 

Round  99, Train loss: 1.468, Test loss: 1.501, Test accuracy: 96.03 

Final Round, Train loss: 1.469, Test loss: 1.501, Test accuracy: 96.05 

Average accuracy final 10 rounds: 96.0 

508.14487171173096
[1.4713010787963867, 2.0600521564483643, 2.657043218612671, 3.2462222576141357, 3.83434796333313, 4.424192190170288, 5.015489101409912, 5.606456279754639, 6.198281526565552, 6.78771448135376, 7.3748438358306885, 7.9643495082855225, 8.554112434387207, 9.144449234008789, 9.73575472831726, 10.32621169090271, 10.915311813354492, 11.506438255310059, 12.098016023635864, 12.68790864944458, 13.274723291397095, 13.865192174911499, 14.45203948020935, 15.038441181182861, 15.625253915786743, 16.216922521591187, 16.80843234062195, 17.402682304382324, 17.995063066482544, 18.582939624786377, 19.174028158187866, 19.766008853912354, 20.361167907714844, 20.954973697662354, 21.55191731452942, 22.134678840637207, 22.72800326347351, 23.31682014465332, 23.907566785812378, 24.498105764389038, 25.092884063720703, 25.683311462402344, 26.271673917770386, 26.8603835105896, 27.449321508407593, 28.036412715911865, 28.62432622909546, 29.213884830474854, 29.802114725112915, 30.39328908920288, 30.98411512374878, 31.575268507003784, 32.16446828842163, 32.75381016731262, 33.34761333465576, 33.94841647148132, 34.54721784591675, 35.166077613830566, 35.75360560417175, 36.34228730201721, 36.9326376914978, 37.51901721954346, 38.11078906059265, 38.70102334022522, 39.285478591918945, 39.86661624908447, 40.45197534561157, 41.036945819854736, 41.62039017677307, 42.206002950668335, 42.78961682319641, 43.36967658996582, 43.95187211036682, 44.534446477890015, 45.11814761161804, 45.69852137565613, 46.276296615600586, 46.86367416381836, 47.44676065444946, 48.032750368118286, 48.61713910102844, 49.2029492855072, 49.785338401794434, 50.364298582077026, 50.949835538864136, 51.54751634597778, 52.129902839660645, 52.71285343170166, 53.295323610305786, 53.875866651535034, 54.45900511741638, 55.03969049453735, 55.62468957901001, 56.30623269081116, 56.991549491882324, 57.68253755569458, 58.370725870132446, 59.05734348297119, 59.74070739746094, 60.424110651016235, 61.32926559448242]
[22.783333333333335, 27.066666666666666, 36.166666666666664, 54.56666666666667, 72.03333333333333, 79.1, 84.13333333333334, 87.6, 87.18333333333334, 88.7, 91.2, 91.36666666666666, 91.68333333333334, 92.1, 92.45, 92.71666666666667, 93.11666666666666, 93.51666666666667, 93.71666666666667, 93.75, 93.71666666666667, 93.85, 93.9, 94.0, 94.25, 94.13333333333334, 94.3, 95.46666666666667, 95.71666666666667, 95.6, 95.6, 95.46666666666667, 95.58333333333333, 95.56666666666666, 95.63333333333334, 95.63333333333334, 95.58333333333333, 95.58333333333333, 95.7, 95.75, 95.78333333333333, 95.76666666666667, 95.7, 95.83333333333333, 95.8, 95.8, 95.73333333333333, 95.81666666666666, 95.75, 95.83333333333333, 95.9, 95.73333333333333, 95.73333333333333, 95.8, 95.83333333333333, 95.81666666666666, 95.78333333333333, 95.86666666666666, 95.86666666666666, 95.86666666666666, 95.85, 95.78333333333333, 95.81666666666666, 95.88333333333334, 95.93333333333334, 95.88333333333334, 95.88333333333334, 95.91666666666667, 96.0, 95.95, 95.9, 95.91666666666667, 95.93333333333334, 95.91666666666667, 95.83333333333333, 95.83333333333333, 95.83333333333333, 95.86666666666666, 95.91666666666667, 95.95, 95.98333333333333, 96.03333333333333, 96.01666666666667, 95.95, 95.91666666666667, 95.93333333333334, 95.91666666666667, 95.95, 96.06666666666666, 95.95, 95.98333333333333, 95.96666666666667, 95.95, 95.93333333333334, 96.03333333333333, 96.01666666666667, 96.05, 96.0, 96.03333333333333, 96.03333333333333, 96.05]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: lg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

lg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 17098 (global); Percentage 3.11 (17098/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.281, Test loss: 2.280, Test accuracy: 27.62 

Round   1, Train loss: 2.131, Test loss: 2.192, Test accuracy: 34.05 

Round   2, Train loss: 1.854, Test loss: 2.069, Test accuracy: 46.42 

Round   3, Train loss: 1.705, Test loss: 1.951, Test accuracy: 60.58 

Round   4, Train loss: 1.695, Test loss: 1.875, Test accuracy: 64.92 

Round   5, Train loss: 1.606, Test loss: 1.791, Test accuracy: 72.63 

Round   6, Train loss: 1.806, Test loss: 1.746, Test accuracy: 75.47 

Round   7, Train loss: 1.567, Test loss: 1.715, Test accuracy: 77.45 

Round   8, Train loss: 1.588, Test loss: 1.684, Test accuracy: 80.37 

Round   9, Train loss: 1.582, Test loss: 1.676, Test accuracy: 80.75 

Round  10, Train loss: 1.509, Test loss: 1.652, Test accuracy: 84.20 

Round  11, Train loss: 1.511, Test loss: 1.621, Test accuracy: 87.47 

Round  12, Train loss: 1.478, Test loss: 1.611, Test accuracy: 88.30 

Round  13, Train loss: 1.549, Test loss: 1.601, Test accuracy: 88.05 

Round  14, Train loss: 1.532, Test loss: 1.580, Test accuracy: 90.67 

Round  15, Train loss: 1.501, Test loss: 1.577, Test accuracy: 90.63 

Round  16, Train loss: 1.471, Test loss: 1.580, Test accuracy: 90.32 

Round  17, Train loss: 1.496, Test loss: 1.551, Test accuracy: 94.07 

Round  18, Train loss: 1.475, Test loss: 1.553, Test accuracy: 93.73 

Round  19, Train loss: 1.474, Test loss: 1.549, Test accuracy: 94.15 

Round  20, Train loss: 1.478, Test loss: 1.535, Test accuracy: 94.77 

Round  21, Train loss: 1.472, Test loss: 1.532, Test accuracy: 94.93 

Round  22, Train loss: 1.477, Test loss: 1.524, Test accuracy: 95.22 

Round  23, Train loss: 1.471, Test loss: 1.523, Test accuracy: 95.27 

Round  24, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.55 

Round  25, Train loss: 1.472, Test loss: 1.513, Test accuracy: 95.85 

Round  26, Train loss: 1.470, Test loss: 1.514, Test accuracy: 95.72 

Round  27, Train loss: 1.473, Test loss: 1.513, Test accuracy: 95.78 

Round  28, Train loss: 1.470, Test loss: 1.511, Test accuracy: 95.98 

Round  29, Train loss: 1.471, Test loss: 1.509, Test accuracy: 96.12 

Round  30, Train loss: 1.470, Test loss: 1.508, Test accuracy: 96.10 

Round  31, Train loss: 1.467, Test loss: 1.508, Test accuracy: 96.12 

Round  32, Train loss: 1.466, Test loss: 1.508, Test accuracy: 96.03 

Round  33, Train loss: 1.469, Test loss: 1.508, Test accuracy: 96.02 

Round  34, Train loss: 1.467, Test loss: 1.507, Test accuracy: 95.97 

Round  35, Train loss: 1.470, Test loss: 1.507, Test accuracy: 95.95 

Round  36, Train loss: 1.467, Test loss: 1.507, Test accuracy: 96.00 

Round  37, Train loss: 1.468, Test loss: 1.507, Test accuracy: 95.93 

Round  38, Train loss: 1.468, Test loss: 1.507, Test accuracy: 96.00 

Round  39, Train loss: 1.466, Test loss: 1.506, Test accuracy: 96.00 

Round  40, Train loss: 1.469, Test loss: 1.506, Test accuracy: 96.03 

Round  41, Train loss: 1.471, Test loss: 1.506, Test accuracy: 96.02 

Round  42, Train loss: 1.466, Test loss: 1.506, Test accuracy: 96.05 

Round  43, Train loss: 1.467, Test loss: 1.506, Test accuracy: 96.05 

Round  44, Train loss: 1.467, Test loss: 1.505, Test accuracy: 96.03 

Round  45, Train loss: 1.467, Test loss: 1.505, Test accuracy: 96.05 

Round  46, Train loss: 1.466, Test loss: 1.505, Test accuracy: 96.05 

Round  47, Train loss: 1.466, Test loss: 1.505, Test accuracy: 96.05 

Round  48, Train loss: 1.467, Test loss: 1.505, Test accuracy: 96.03 

Round  49, Train loss: 1.465, Test loss: 1.505, Test accuracy: 96.05 

Round  50, Train loss: 1.464, Test loss: 1.504, Test accuracy: 96.07 

Round  51, Train loss: 1.465, Test loss: 1.504, Test accuracy: 96.07 

Round  52, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.08 

Round  53, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.03 

Round  54, Train loss: 1.464, Test loss: 1.504, Test accuracy: 96.03 

Round  55, Train loss: 1.465, Test loss: 1.504, Test accuracy: 96.05 

Round  56, Train loss: 1.465, Test loss: 1.504, Test accuracy: 96.02 

Round  57, Train loss: 1.466, Test loss: 1.504, Test accuracy: 96.02 

Round  58, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.03 

Round  59, Train loss: 1.467, Test loss: 1.504, Test accuracy: 95.98 

Round  60, Train loss: 1.464, Test loss: 1.504, Test accuracy: 96.00 

Round  61, Train loss: 1.470, Test loss: 1.503, Test accuracy: 96.10 

Round  62, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.12 

Round  63, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.13 

Round  64, Train loss: 1.468, Test loss: 1.503, Test accuracy: 96.12 

Round  65, Train loss: 1.468, Test loss: 1.503, Test accuracy: 96.10 

Round  66, Train loss: 1.469, Test loss: 1.503, Test accuracy: 96.10 

Round  67, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.10 

Round  68, Train loss: 1.468, Test loss: 1.503, Test accuracy: 96.08 

Round  69, Train loss: 1.468, Test loss: 1.503, Test accuracy: 96.08 

Round  70, Train loss: 1.469, Test loss: 1.503, Test accuracy: 96.08 

Round  71, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.07 

Round  72, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.07 

Round  73, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.03 

Round  74, Train loss: 1.468, Test loss: 1.503, Test accuracy: 96.08 

Round  75, Train loss: 1.468, Test loss: 1.503, Test accuracy: 96.07 

Round  76, Train loss: 1.464, Test loss: 1.503, Test accuracy: 96.07 

Round  77, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.08 

Round  78, Train loss: 1.464, Test loss: 1.503, Test accuracy: 96.10 

Round  79, Train loss: 1.469, Test loss: 1.503, Test accuracy: 96.08 

Round  80, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.08 

Round  81, Train loss: 1.466, Test loss: 1.503, Test accuracy: 96.07 

Round  82, Train loss: 1.469, Test loss: 1.503, Test accuracy: 96.10 

Round  83, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.07 

Round  84, Train loss: 1.467, Test loss: 1.503, Test accuracy: 96.05 

Round  85, Train loss: 1.465, Test loss: 1.503, Test accuracy: 96.07 

Round  86, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.05 

Round  87, Train loss: 1.467, Test loss: 1.502, Test accuracy: 96.08 

Round  88, Train loss: 1.467, Test loss: 1.502, Test accuracy: 96.08 

Round  89, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.08 

Round  90, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.10 

Round  91, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.08 

Round  92, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.12 

Round  93, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.10 

Round  94, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.08 

Round  95, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.12 

Round  96, Train loss: 1.463, Test loss: 1.502, Test accuracy: 96.12 

Round  97, Train loss: 1.465, Test loss: 1.502, Test accuracy: 96.08 

Round  98, Train loss: 1.464, Test loss: 1.502, Test accuracy: 96.07 

Round  99, Train loss: 1.468, Test loss: 1.502, Test accuracy: 96.08 

Final Round, Train loss: 1.466, Test loss: 1.502, Test accuracy: 96.08 

Average accuracy final 10 rounds: 96.095 

506.1812870502472
[1.4599802494049072, 2.062059164047241, 2.6592838764190674, 3.2503528594970703, 3.8447065353393555, 4.437463760375977, 5.031951427459717, 5.626696825027466, 6.219472169876099, 6.81399130821228, 7.4088664054870605, 8.000475645065308, 8.59037446975708, 9.183279514312744, 9.776535987854004, 10.366966962814331, 10.958070278167725, 11.551311731338501, 12.143293380737305, 12.73482084274292, 13.323933362960815, 13.912876605987549, 14.501620769500732, 15.092373847961426, 15.681868553161621, 16.27568531036377, 16.872636318206787, 17.46439290046692, 18.05496573448181, 18.646735191345215, 19.24156427383423, 19.831664323806763, 20.423744916915894, 21.016589403152466, 21.602317333221436, 22.19284749031067, 22.78186559677124, 23.371421575546265, 23.965988397598267, 24.560200214385986, 25.152065753936768, 25.747405529022217, 26.339386463165283, 26.92816662788391, 27.519641876220703, 28.111567735671997, 28.703478813171387, 29.29343605041504, 29.885671138763428, 30.47608757019043, 31.06559729576111, 31.656754970550537, 32.25029420852661, 32.85042691230774, 33.441004514694214, 34.03376531600952, 34.624449014663696, 35.21526265144348, 35.80470108985901, 36.39514875411987, 36.98956322669983, 37.58304166793823, 38.17062258720398, 38.763490438461304, 39.35174918174744, 39.9387309551239, 40.52932810783386, 41.115500688552856, 41.70391273498535, 42.29449009895325, 42.886605739593506, 43.4773428440094, 44.07202076911926, 44.66540217399597, 45.26497030258179, 45.854381799697876, 46.441322803497314, 47.029892444610596, 47.61493754386902, 48.20250201225281, 48.78848624229431, 49.37625980377197, 49.96614980697632, 50.55243444442749, 51.14027523994446, 51.72518992424011, 52.31427311897278, 52.90273833274841, 53.49198007583618, 54.07896327972412, 54.66877746582031, 55.25950288772583, 55.849215269088745, 56.432215452194214, 57.022862672805786, 57.608423709869385, 58.19380784034729, 58.78468871116638, 59.37997531890869, 59.974668741226196, 61.00106620788574]
[27.616666666666667, 34.05, 46.416666666666664, 60.583333333333336, 64.91666666666667, 72.63333333333334, 75.46666666666667, 77.45, 80.36666666666666, 80.75, 84.2, 87.46666666666667, 88.3, 88.05, 90.66666666666667, 90.63333333333334, 90.31666666666666, 94.06666666666666, 93.73333333333333, 94.15, 94.76666666666667, 94.93333333333334, 95.21666666666667, 95.26666666666667, 95.55, 95.85, 95.71666666666667, 95.78333333333333, 95.98333333333333, 96.11666666666666, 96.1, 96.11666666666666, 96.03333333333333, 96.01666666666667, 95.96666666666667, 95.95, 96.0, 95.93333333333334, 96.0, 96.0, 96.03333333333333, 96.01666666666667, 96.05, 96.05, 96.03333333333333, 96.05, 96.05, 96.05, 96.03333333333333, 96.05, 96.06666666666666, 96.06666666666666, 96.08333333333333, 96.03333333333333, 96.03333333333333, 96.05, 96.01666666666667, 96.01666666666667, 96.03333333333333, 95.98333333333333, 96.0, 96.1, 96.11666666666666, 96.13333333333334, 96.11666666666666, 96.1, 96.1, 96.1, 96.08333333333333, 96.08333333333333, 96.08333333333333, 96.06666666666666, 96.06666666666666, 96.03333333333333, 96.08333333333333, 96.06666666666666, 96.06666666666666, 96.08333333333333, 96.1, 96.08333333333333, 96.08333333333333, 96.06666666666666, 96.1, 96.06666666666666, 96.05, 96.06666666666666, 96.05, 96.08333333333333, 96.08333333333333, 96.08333333333333, 96.1, 96.08333333333333, 96.11666666666666, 96.1, 96.08333333333333, 96.11666666666666, 96.11666666666666, 96.08333333333333, 96.06666666666666, 96.08333333333333, 96.08333333333333]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.309, Test loss: 2.296, Test accuracy: 18.00
Round   1, Train loss: 2.284, Test loss: 2.286, Test accuracy: 35.40
Round   2, Train loss: 2.240, Test loss: 2.250, Test accuracy: 39.00
Round   3, Train loss: 2.137, Test loss: 2.178, Test accuracy: 45.70
Round   4, Train loss: 1.959, Test loss: 2.045, Test accuracy: 46.53
Round   5, Train loss: 1.914, Test loss: 1.991, Test accuracy: 55.18
Round   6, Train loss: 1.851, Test loss: 1.901, Test accuracy: 62.18
Round   7, Train loss: 1.754, Test loss: 1.852, Test accuracy: 66.07
Round   8, Train loss: 1.677, Test loss: 1.788, Test accuracy: 71.63
Round   9, Train loss: 1.670, Test loss: 1.718, Test accuracy: 79.68
Round  10, Train loss: 1.573, Test loss: 1.684, Test accuracy: 83.17
Round  11, Train loss: 1.577, Test loss: 1.678, Test accuracy: 82.08
Round  12, Train loss: 1.608, Test loss: 1.634, Test accuracy: 87.30
Round  13, Train loss: 1.651, Test loss: 1.594, Test accuracy: 92.10
Round  14, Train loss: 1.588, Test loss: 1.576, Test accuracy: 93.45
Round  15, Train loss: 1.564, Test loss: 1.566, Test accuracy: 93.28
Round  16, Train loss: 1.542, Test loss: 1.559, Test accuracy: 93.63
Round  17, Train loss: 1.530, Test loss: 1.557, Test accuracy: 93.60
Round  18, Train loss: 1.548, Test loss: 1.544, Test accuracy: 95.33
Round  19, Train loss: 1.524, Test loss: 1.540, Test accuracy: 95.67
Round  20, Train loss: 1.545, Test loss: 1.535, Test accuracy: 95.93
Round  21, Train loss: 1.531, Test loss: 1.533, Test accuracy: 95.95
Round  22, Train loss: 1.521, Test loss: 1.529, Test accuracy: 96.02
Round  23, Train loss: 1.518, Test loss: 1.528, Test accuracy: 96.05
Round  24, Train loss: 1.518, Test loss: 1.526, Test accuracy: 96.12
Round  25, Train loss: 1.517, Test loss: 1.523, Test accuracy: 96.25
Round  26, Train loss: 1.526, Test loss: 1.521, Test accuracy: 96.38
Round  27, Train loss: 1.509, Test loss: 1.519, Test accuracy: 96.47
Round  28, Train loss: 1.502, Test loss: 1.519, Test accuracy: 96.30
Round  29, Train loss: 1.515, Test loss: 1.516, Test accuracy: 96.45
Round  30, Train loss: 1.511, Test loss: 1.515, Test accuracy: 96.50
Round  31, Train loss: 1.510, Test loss: 1.514, Test accuracy: 96.65
Round  32, Train loss: 1.510, Test loss: 1.513, Test accuracy: 96.68
Round  33, Train loss: 1.503, Test loss: 1.512, Test accuracy: 96.77
Round  34, Train loss: 1.502, Test loss: 1.512, Test accuracy: 96.55
Round  35, Train loss: 1.508, Test loss: 1.511, Test accuracy: 96.63
Round  36, Train loss: 1.495, Test loss: 1.511, Test accuracy: 96.75
Round  37, Train loss: 1.492, Test loss: 1.511, Test accuracy: 96.72
Round  38, Train loss: 1.500, Test loss: 1.511, Test accuracy: 96.73
Round  39, Train loss: 1.492, Test loss: 1.510, Test accuracy: 96.82
Round  40, Train loss: 1.500, Test loss: 1.510, Test accuracy: 96.72
Round  41, Train loss: 1.500, Test loss: 1.509, Test accuracy: 96.77
Round  42, Train loss: 1.486, Test loss: 1.509, Test accuracy: 96.75
Round  43, Train loss: 1.489, Test loss: 1.508, Test accuracy: 96.82
Round  44, Train loss: 1.497, Test loss: 1.508, Test accuracy: 96.95
Round  45, Train loss: 1.491, Test loss: 1.507, Test accuracy: 96.80
Round  46, Train loss: 1.491, Test loss: 1.507, Test accuracy: 96.85
Round  47, Train loss: 1.492, Test loss: 1.506, Test accuracy: 96.92
Round  48, Train loss: 1.492, Test loss: 1.506, Test accuracy: 96.97
Round  49, Train loss: 1.485, Test loss: 1.505, Test accuracy: 96.95
Round  50, Train loss: 1.491, Test loss: 1.505, Test accuracy: 96.95
Round  51, Train loss: 1.489, Test loss: 1.505, Test accuracy: 97.02
Round  52, Train loss: 1.490, Test loss: 1.505, Test accuracy: 96.97
Round  53, Train loss: 1.484, Test loss: 1.505, Test accuracy: 97.02
Round  54, Train loss: 1.490, Test loss: 1.504, Test accuracy: 97.05
Round  55, Train loss: 1.487, Test loss: 1.504, Test accuracy: 96.95
Round  56, Train loss: 1.483, Test loss: 1.504, Test accuracy: 97.08
Round  57, Train loss: 1.483, Test loss: 1.504, Test accuracy: 97.03
Round  58, Train loss: 1.488, Test loss: 1.503, Test accuracy: 97.18
Round  59, Train loss: 1.488, Test loss: 1.503, Test accuracy: 97.07
Round  60, Train loss: 1.485, Test loss: 1.503, Test accuracy: 97.10
Round  61, Train loss: 1.482, Test loss: 1.502, Test accuracy: 97.18
Round  62, Train loss: 1.483, Test loss: 1.502, Test accuracy: 97.18
Round  63, Train loss: 1.484, Test loss: 1.502, Test accuracy: 97.25
Round  64, Train loss: 1.483, Test loss: 1.501, Test accuracy: 97.17
Round  65, Train loss: 1.483, Test loss: 1.500, Test accuracy: 97.20
Round  66, Train loss: 1.484, Test loss: 1.500, Test accuracy: 97.20
Round  67, Train loss: 1.481, Test loss: 1.500, Test accuracy: 97.25
Round  68, Train loss: 1.476, Test loss: 1.500, Test accuracy: 97.25
Round  69, Train loss: 1.484, Test loss: 1.500, Test accuracy: 97.23
Round  70, Train loss: 1.479, Test loss: 1.500, Test accuracy: 97.27
Round  71, Train loss: 1.484, Test loss: 1.499, Test accuracy: 97.38
Round  72, Train loss: 1.477, Test loss: 1.499, Test accuracy: 97.37
Round  73, Train loss: 1.476, Test loss: 1.499, Test accuracy: 97.32
Round  74, Train loss: 1.480, Test loss: 1.499, Test accuracy: 97.32
Round  75, Train loss: 1.479, Test loss: 1.498, Test accuracy: 97.33
Round  76, Train loss: 1.478, Test loss: 1.498, Test accuracy: 97.33
Round  77, Train loss: 1.478, Test loss: 1.498, Test accuracy: 97.33
Round  78, Train loss: 1.478, Test loss: 1.499, Test accuracy: 97.45
Round  79, Train loss: 1.477, Test loss: 1.498, Test accuracy: 97.45
Round  80, Train loss: 1.479, Test loss: 1.497, Test accuracy: 97.45
Round  81, Train loss: 1.476, Test loss: 1.498, Test accuracy: 97.37
Round  82, Train loss: 1.472, Test loss: 1.498, Test accuracy: 97.42
Round  83, Train loss: 1.474, Test loss: 1.497, Test accuracy: 97.42
Round  84, Train loss: 1.477, Test loss: 1.497, Test accuracy: 97.43
Round  85, Train loss: 1.476, Test loss: 1.497, Test accuracy: 97.50
Round  86, Train loss: 1.476, Test loss: 1.497, Test accuracy: 97.42
Round  87, Train loss: 1.475, Test loss: 1.497, Test accuracy: 97.43
Round  88, Train loss: 1.474, Test loss: 1.496, Test accuracy: 97.53
Round  89, Train loss: 1.474, Test loss: 1.496, Test accuracy: 97.47
Round  90, Train loss: 1.475, Test loss: 1.496, Test accuracy: 97.43
Round  91, Train loss: 1.475, Test loss: 1.496, Test accuracy: 97.50
Round  92, Train loss: 1.475, Test loss: 1.496, Test accuracy: 97.38
Round  93, Train loss: 1.475, Test loss: 1.496, Test accuracy: 97.58
Round  94, Train loss: 1.473, Test loss: 1.495, Test accuracy: 97.60
Round  95, Train loss: 1.471, Test loss: 1.495, Test accuracy: 97.53
Round  96, Train loss: 1.473, Test loss: 1.495, Test accuracy: 97.58
Round  97, Train loss: 1.477, Test loss: 1.495, Test accuracy: 97.48
Round  98, Train loss: 1.472, Test loss: 1.495, Test accuracy: 97.57
Round  99, Train loss: 1.472, Test loss: 1.495, Test accuracy: 97.52
Final Round, Train loss: 1.469, Test loss: 1.494, Test accuracy: 97.48
Average accuracy final 10 rounds: 97.51833333333332
538.3597650527954
[1.5207293033599854, 2.1728289127349854, 2.8203585147857666, 3.464111328125, 4.112508296966553, 4.755418300628662, 5.400485277175903, 6.044501304626465, 6.695478200912476, 7.344996929168701, 7.9901063442230225, 8.639842987060547, 9.2891263961792, 9.93221664428711, 10.577960968017578, 11.218413591384888, 11.860655069351196, 12.507508516311646, 13.155623435974121, 13.798147916793823, 14.438945055007935, 15.079047441482544, 15.72406554222107, 16.364121675491333, 17.016907215118408, 17.651543378829956, 18.289165019989014, 18.925976276397705, 19.563403844833374, 20.207355976104736, 20.84703779220581, 21.492920637130737, 22.130600929260254, 22.768900156021118, 23.40668225288391, 24.049933910369873, 24.692122220993042, 25.33493161201477, 25.976934909820557, 26.6221342086792, 27.263782262802124, 27.907584190368652, 28.554550409317017, 29.198482513427734, 29.837332487106323, 30.47942042350769, 31.122309923171997, 31.762898206710815, 32.399961948394775, 33.041943311691284, 33.684996128082275, 34.32611131668091, 34.97223997116089, 35.61773943901062, 36.257699728012085, 36.89991068840027, 37.53908920288086, 38.17425847053528, 38.81394362449646, 39.45619344711304, 40.10840964317322, 40.74857020378113, 41.386722564697266, 42.046165227890015, 42.68751287460327, 43.327619552612305, 43.96994471549988, 44.611055850982666, 45.2489116191864, 45.8888578414917, 46.52632808685303, 47.16822552680969, 47.81400179862976, 48.45674991607666, 49.09918522834778, 49.74118733406067, 50.38741636276245, 51.02720260620117, 51.668914556503296, 52.309571743011475, 52.95305848121643, 53.59585094451904, 54.241798877716064, 54.888394355773926, 55.5356023311615, 56.185794830322266, 56.830692529678345, 57.479074001312256, 58.12336778640747, 58.76843214035034, 59.43523716926575, 60.07554507255554, 60.71944808959961, 61.36185097694397, 62.00834631919861, 62.65381693840027, 63.3023784160614, 63.94577074050903, 64.59198570251465, 65.23529720306396, 66.18381524085999]
[18.0, 35.4, 39.0, 45.7, 46.53333333333333, 55.18333333333333, 62.18333333333333, 66.06666666666666, 71.63333333333334, 79.68333333333334, 83.16666666666667, 82.08333333333333, 87.3, 92.1, 93.45, 93.28333333333333, 93.63333333333334, 93.6, 95.33333333333333, 95.66666666666667, 95.93333333333334, 95.95, 96.01666666666667, 96.05, 96.11666666666666, 96.25, 96.38333333333334, 96.46666666666667, 96.3, 96.45, 96.5, 96.65, 96.68333333333334, 96.76666666666667, 96.55, 96.63333333333334, 96.75, 96.71666666666667, 96.73333333333333, 96.81666666666666, 96.71666666666667, 96.76666666666667, 96.75, 96.81666666666666, 96.95, 96.8, 96.85, 96.91666666666667, 96.96666666666667, 96.95, 96.95, 97.01666666666667, 96.96666666666667, 97.01666666666667, 97.05, 96.95, 97.08333333333333, 97.03333333333333, 97.18333333333334, 97.06666666666666, 97.1, 97.18333333333334, 97.18333333333334, 97.25, 97.16666666666667, 97.2, 97.2, 97.25, 97.25, 97.23333333333333, 97.26666666666667, 97.38333333333334, 97.36666666666666, 97.31666666666666, 97.31666666666666, 97.33333333333333, 97.33333333333333, 97.33333333333333, 97.45, 97.45, 97.45, 97.36666666666666, 97.41666666666667, 97.41666666666667, 97.43333333333334, 97.5, 97.41666666666667, 97.43333333333334, 97.53333333333333, 97.46666666666667, 97.43333333333334, 97.5, 97.38333333333334, 97.58333333333333, 97.6, 97.53333333333333, 97.58333333333333, 97.48333333333333, 97.56666666666666, 97.51666666666667, 97.48333333333333]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_ditto%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
Round   0, Train loss: 2.292, Test loss: 2.295, Test accuracy: 24.62
Round   1, Train loss: 2.225, Test loss: 2.246, Test accuracy: 29.15
Round   2, Train loss: 1.965, Test loss: 2.146, Test accuracy: 30.38
Round   3, Train loss: 1.904, Test loss: 2.098, Test accuracy: 41.12
Round   4, Train loss: 1.674, Test loss: 1.994, Test accuracy: 50.90
Round   5, Train loss: 1.762, Test loss: 2.011, Test accuracy: 41.87
Round   6, Train loss: 1.591, Test loss: 1.944, Test accuracy: 50.25
Round   7, Train loss: 1.604, Test loss: 1.946, Test accuracy: 49.12
Round   8, Train loss: 1.518, Test loss: 1.877, Test accuracy: 60.18
Round   9, Train loss: 1.606, Test loss: 1.828, Test accuracy: 66.13
Round  10, Train loss: 1.570, Test loss: 1.833, Test accuracy: 63.47
Round  11, Train loss: 1.545, Test loss: 1.808, Test accuracy: 66.55
Round  12, Train loss: 1.559, Test loss: 1.764, Test accuracy: 71.88
Round  13, Train loss: 1.496, Test loss: 1.775, Test accuracy: 70.92
Round  14, Train loss: 1.501, Test loss: 1.776, Test accuracy: 68.40
Round  15, Train loss: 1.543, Test loss: 1.759, Test accuracy: 71.27
Round  16, Train loss: 1.577, Test loss: 1.811, Test accuracy: 66.42
Round  17, Train loss: 1.557, Test loss: 1.779, Test accuracy: 68.90
Round  18, Train loss: 1.552, Test loss: 1.786, Test accuracy: 67.40
Round  19, Train loss: 1.552, Test loss: 1.727, Test accuracy: 78.43
Round  20, Train loss: 1.502, Test loss: 1.743, Test accuracy: 73.97
Round  21, Train loss: 1.498, Test loss: 1.765, Test accuracy: 72.08
Round  22, Train loss: 1.518, Test loss: 1.749, Test accuracy: 72.48
Round  23, Train loss: 1.532, Test loss: 1.732, Test accuracy: 73.95
Round  24, Train loss: 1.542, Test loss: 1.701, Test accuracy: 79.08
Round  25, Train loss: 1.486, Test loss: 1.717, Test accuracy: 78.30
Round  26, Train loss: 1.530, Test loss: 1.725, Test accuracy: 75.02
Round  27, Train loss: 1.538, Test loss: 1.703, Test accuracy: 75.53
Round  28, Train loss: 1.489, Test loss: 1.717, Test accuracy: 75.22
Round  29, Train loss: 1.539, Test loss: 1.708, Test accuracy: 75.65
Round  30, Train loss: 1.584, Test loss: 1.713, Test accuracy: 75.00
Round  31, Train loss: 1.595, Test loss: 1.723, Test accuracy: 74.20
Round  32, Train loss: 1.528, Test loss: 1.689, Test accuracy: 79.37
Round  33, Train loss: 1.485, Test loss: 1.737, Test accuracy: 72.78
Round  34, Train loss: 1.498, Test loss: 1.767, Test accuracy: 69.60
Round  35, Train loss: 1.485, Test loss: 1.716, Test accuracy: 74.77
Round  36, Train loss: 1.494, Test loss: 1.684, Test accuracy: 78.98
Round  37, Train loss: 1.528, Test loss: 1.708, Test accuracy: 76.20
Round  38, Train loss: 1.487, Test loss: 1.696, Test accuracy: 77.95
Round  39, Train loss: 1.483, Test loss: 1.721, Test accuracy: 76.05
Round  40, Train loss: 1.538, Test loss: 1.665, Test accuracy: 81.98
Round  41, Train loss: 1.486, Test loss: 1.676, Test accuracy: 80.18
Round  42, Train loss: 1.473, Test loss: 1.678, Test accuracy: 81.18
Round  43, Train loss: 1.480, Test loss: 1.689, Test accuracy: 78.87
Round  44, Train loss: 1.480, Test loss: 1.664, Test accuracy: 81.78
Round  45, Train loss: 1.589, Test loss: 1.704, Test accuracy: 76.68
Round  46, Train loss: 1.542, Test loss: 1.698, Test accuracy: 77.25
Round  47, Train loss: 1.485, Test loss: 1.678, Test accuracy: 80.68
Round  48, Train loss: 1.481, Test loss: 1.673, Test accuracy: 80.40
Round  49, Train loss: 1.539, Test loss: 1.677, Test accuracy: 79.35
Round  50, Train loss: 1.485, Test loss: 1.700, Test accuracy: 76.20
Round  51, Train loss: 1.486, Test loss: 1.685, Test accuracy: 79.20
Round  52, Train loss: 1.540, Test loss: 1.650, Test accuracy: 82.92
Round  53, Train loss: 1.530, Test loss: 1.680, Test accuracy: 79.80
Round  54, Train loss: 1.535, Test loss: 1.657, Test accuracy: 82.05
Round  55, Train loss: 1.532, Test loss: 1.653, Test accuracy: 82.72
Round  56, Train loss: 1.479, Test loss: 1.679, Test accuracy: 79.17
Round  57, Train loss: 1.491, Test loss: 1.684, Test accuracy: 78.23
Round  58, Train loss: 1.536, Test loss: 1.662, Test accuracy: 81.25
Round  59, Train loss: 1.545, Test loss: 1.681, Test accuracy: 78.70
Round  60, Train loss: 1.488, Test loss: 1.655, Test accuracy: 82.42
Round  61, Train loss: 1.523, Test loss: 1.654, Test accuracy: 81.78
Round  62, Train loss: 1.528, Test loss: 1.685, Test accuracy: 77.83
Round  63, Train loss: 1.536, Test loss: 1.644, Test accuracy: 82.87
Round  64, Train loss: 1.523, Test loss: 1.692, Test accuracy: 76.77
Round  65, Train loss: 1.528, Test loss: 1.637, Test accuracy: 83.73
Round  66, Train loss: 1.470, Test loss: 1.645, Test accuracy: 82.68
Round  67, Train loss: 1.532, Test loss: 1.652, Test accuracy: 82.05
Round  68, Train loss: 1.536, Test loss: 1.644, Test accuracy: 83.00
Round  69, Train loss: 1.530, Test loss: 1.641, Test accuracy: 83.22
Round  70, Train loss: 1.479, Test loss: 1.660, Test accuracy: 81.75
Round  71, Train loss: 1.477, Test loss: 1.674, Test accuracy: 78.48
Round  72, Train loss: 1.528, Test loss: 1.635, Test accuracy: 83.72
Round  73, Train loss: 1.530, Test loss: 1.667, Test accuracy: 80.67
Round  74, Train loss: 1.530, Test loss: 1.643, Test accuracy: 83.22
Round  75, Train loss: 1.474, Test loss: 1.649, Test accuracy: 81.90
Round  76, Train loss: 1.526, Test loss: 1.636, Test accuracy: 83.43
Round  77, Train loss: 1.483, Test loss: 1.636, Test accuracy: 83.67
Round  78, Train loss: 1.589, Test loss: 1.675, Test accuracy: 79.78
Round  79, Train loss: 1.527, Test loss: 1.656, Test accuracy: 81.20
Round  80, Train loss: 1.472, Test loss: 1.647, Test accuracy: 82.82
Round  81, Train loss: 1.536, Test loss: 1.672, Test accuracy: 80.23
Round  82, Train loss: 1.530, Test loss: 1.636, Test accuracy: 83.82
Round  83, Train loss: 1.522, Test loss: 1.663, Test accuracy: 79.72
Round  84, Train loss: 1.475, Test loss: 1.641, Test accuracy: 83.30
Round  85, Train loss: 1.487, Test loss: 1.676, Test accuracy: 78.42
Round  86, Train loss: 1.533, Test loss: 1.666, Test accuracy: 80.37
Round  87, Train loss: 1.470, Test loss: 1.651, Test accuracy: 82.13
Round  88, Train loss: 1.469, Test loss: 1.640, Test accuracy: 83.07
Round  89, Train loss: 1.524, Test loss: 1.654, Test accuracy: 81.67
Round  90, Train loss: 1.534, Test loss: 1.636, Test accuracy: 83.57
Round  91, Train loss: 1.476, Test loss: 1.640, Test accuracy: 82.73
Round  92, Train loss: 1.468, Test loss: 1.645, Test accuracy: 82.30
Round  93, Train loss: 1.479, Test loss: 1.634, Test accuracy: 83.65
Round  94, Train loss: 1.535, Test loss: 1.632, Test accuracy: 84.02
Round  95, Train loss: 1.520, Test loss: 1.633, Test accuracy: 83.82
Round  96, Train loss: 1.521, Test loss: 1.647, Test accuracy: 82.23
Round  97, Train loss: 1.475, Test loss: 1.659, Test accuracy: 80.47
Round  98, Train loss: 1.523, Test loss: 1.656, Test accuracy: 81.12
Round  99, Train loss: 1.526, Test loss: 1.656, Test accuracy: 80.92
Final Round, Train loss: 1.505, Test loss: 1.628, Test accuracy: 84.28
Average accuracy final 10 rounds: 82.48166666666667
1078.8284313678741
[2.3951544761657715, 3.9313082695007324, 5.470880746841431, 7.013784646987915, 8.552934646606445, 10.102408170700073, 11.644185543060303, 13.184484958648682, 14.717000484466553, 16.237823247909546, 17.763224840164185, 19.289989233016968, 20.819538593292236, 22.371312141418457, 23.901323795318604, 25.43744945526123, 26.972843885421753, 28.50577449798584, 30.038771152496338, 31.573869466781616, 33.1068000793457, 34.64019012451172, 36.17283082008362, 37.70045614242554, 39.23427891731262, 40.768088579177856, 42.31582951545715, 43.85293793678284, 45.38730502128601, 46.9196674823761, 48.452199935913086, 49.98162651062012, 51.51659965515137, 53.05341839790344, 54.58675980567932, 56.12172317504883, 57.66447901725769, 59.20403242111206, 60.74026679992676, 62.27781534194946, 63.81512212753296, 65.35149025917053, 66.89144277572632, 68.42743420600891, 69.96575403213501, 71.5042736530304, 73.0400698184967, 74.57679915428162, 76.11430239677429, 77.65060424804688, 79.18648028373718, 80.72169876098633, 82.26229500770569, 83.80129909515381, 85.33820080757141, 86.87510752677917, 88.41536664962769, 89.9513897895813, 91.48458552360535, 93.01586890220642, 94.5502598285675, 96.08390021324158, 97.64370393753052, 99.17800974845886, 100.71356391906738, 102.25349068641663, 103.7915678024292, 105.32913255691528, 106.86706614494324, 108.4054765701294, 109.94271445274353, 111.47917294502258, 113.01371192932129, 114.55142426490784, 116.08667540550232, 117.62171864509583, 119.1581518650055, 120.69733500480652, 122.2252128124237, 123.7535789012909, 125.23847436904907, 126.69153571128845, 128.22704577445984, 129.76179575920105, 131.29763984680176, 132.83305740356445, 134.37202167510986, 135.90553998947144, 137.4392900466919, 138.9693841934204, 140.50003123283386, 142.06591701507568, 143.6007161140442, 145.1303825378418, 146.6601746082306, 148.19204664230347, 149.729749917984, 151.2667591571808, 152.80407238006592, 154.3388922214508, 155.87595462799072]
[24.616666666666667, 29.15, 30.383333333333333, 41.11666666666667, 50.9, 41.86666666666667, 50.25, 49.11666666666667, 60.18333333333333, 66.13333333333334, 63.46666666666667, 66.55, 71.88333333333334, 70.91666666666667, 68.4, 71.26666666666667, 66.41666666666667, 68.9, 67.4, 78.43333333333334, 73.96666666666667, 72.08333333333333, 72.48333333333333, 73.95, 79.08333333333333, 78.3, 75.01666666666667, 75.53333333333333, 75.21666666666667, 75.65, 75.0, 74.2, 79.36666666666666, 72.78333333333333, 69.6, 74.76666666666667, 78.98333333333333, 76.2, 77.95, 76.05, 81.98333333333333, 80.18333333333334, 81.18333333333334, 78.86666666666666, 81.78333333333333, 76.68333333333334, 77.25, 80.68333333333334, 80.4, 79.35, 76.2, 79.2, 82.91666666666667, 79.8, 82.05, 82.71666666666667, 79.16666666666667, 78.23333333333333, 81.25, 78.7, 82.41666666666667, 81.78333333333333, 77.83333333333333, 82.86666666666666, 76.76666666666667, 83.73333333333333, 82.68333333333334, 82.05, 83.0, 83.21666666666667, 81.75, 78.48333333333333, 83.71666666666667, 80.66666666666667, 83.21666666666667, 81.9, 83.43333333333334, 83.66666666666667, 79.78333333333333, 81.2, 82.81666666666666, 80.23333333333333, 83.81666666666666, 79.71666666666667, 83.3, 78.41666666666667, 80.36666666666666, 82.13333333333334, 83.06666666666666, 81.66666666666667, 83.56666666666666, 82.73333333333333, 82.3, 83.65, 84.01666666666667, 83.81666666666666, 82.23333333333333, 80.46666666666667, 81.11666666666666, 80.91666666666667, 84.28333333333333]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_apfl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
Round   0, Train loss: 1.538, Test loss: 2.239, Test accuracy: 38.97
Round   1, Train loss: 1.391, Test loss: 2.138, Test accuracy: 41.95
Round   2, Train loss: 1.389, Test loss: 2.044, Test accuracy: 51.98
Round   3, Train loss: 1.368, Test loss: 1.936, Test accuracy: 67.05
Round   4, Train loss: 1.355, Test loss: 1.913, Test accuracy: 66.10
Round   5, Train loss: 1.310, Test loss: 1.886, Test accuracy: 65.67
Round   6, Train loss: 1.431, Test loss: 1.874, Test accuracy: 66.77
Round   7, Train loss: 1.196, Test loss: 1.857, Test accuracy: 66.55
Round   8, Train loss: 1.314, Test loss: 1.840, Test accuracy: 66.48
Round   9, Train loss: 1.381, Test loss: 1.816, Test accuracy: 69.72
Round  10, Train loss: 1.352, Test loss: 1.812, Test accuracy: 69.88
Round  11, Train loss: 1.354, Test loss: 1.807, Test accuracy: 69.95
Round  12, Train loss: 1.322, Test loss: 1.798, Test accuracy: 71.42
Round  13, Train loss: 1.269, Test loss: 1.790, Test accuracy: 71.13
Round  14, Train loss: 1.280, Test loss: 1.780, Test accuracy: 72.95
Round  15, Train loss: 1.228, Test loss: 1.770, Test accuracy: 73.00
Round  16, Train loss: 1.350, Test loss: 1.764, Test accuracy: 73.17
Round  17, Train loss: 1.388, Test loss: 1.764, Test accuracy: 73.28
Round  18, Train loss: 1.308, Test loss: 1.761, Test accuracy: 73.08
Round  19, Train loss: 1.185, Test loss: 1.759, Test accuracy: 73.15
Round  20, Train loss: 1.184, Test loss: 1.755, Test accuracy: 73.02
Round  21, Train loss: 1.305, Test loss: 1.756, Test accuracy: 72.95
Round  22, Train loss: 1.348, Test loss: 1.752, Test accuracy: 72.95
Round  23, Train loss: 1.269, Test loss: 1.751, Test accuracy: 73.00
Round  24, Train loss: 1.224, Test loss: 1.751, Test accuracy: 72.80
Round  25, Train loss: 1.224, Test loss: 1.751, Test accuracy: 72.88
Round  26, Train loss: 1.305, Test loss: 1.751, Test accuracy: 72.68
Round  27, Train loss: 1.267, Test loss: 1.750, Test accuracy: 72.65
Round  28, Train loss: 1.265, Test loss: 1.752, Test accuracy: 72.37
Round  29, Train loss: 1.267, Test loss: 1.753, Test accuracy: 72.38
Round  30, Train loss: 1.224, Test loss: 1.752, Test accuracy: 72.43
Round  31, Train loss: 1.224, Test loss: 1.755, Test accuracy: 72.25
Round  32, Train loss: 1.265, Test loss: 1.752, Test accuracy: 72.33
Round  33, Train loss: 1.264, Test loss: 1.754, Test accuracy: 72.32
Round  34, Train loss: 1.308, Test loss: 1.753, Test accuracy: 72.25
Round  35, Train loss: 1.265, Test loss: 1.753, Test accuracy: 72.27
Round  36, Train loss: 1.264, Test loss: 1.753, Test accuracy: 72.32
Round  37, Train loss: 1.267, Test loss: 1.752, Test accuracy: 72.27
Round  38, Train loss: 1.265, Test loss: 1.754, Test accuracy: 72.10
Round  39, Train loss: 1.307, Test loss: 1.754, Test accuracy: 72.05
Round  40, Train loss: 1.428, Test loss: 1.753, Test accuracy: 72.07
Round  41, Train loss: 1.266, Test loss: 1.754, Test accuracy: 71.95
Round  42, Train loss: 1.307, Test loss: 1.754, Test accuracy: 71.92
Round  43, Train loss: 1.346, Test loss: 1.754, Test accuracy: 71.98
Round  44, Train loss: 1.346, Test loss: 1.754, Test accuracy: 71.90
Round  45, Train loss: 1.346, Test loss: 1.753, Test accuracy: 72.10
Round  46, Train loss: 1.307, Test loss: 1.753, Test accuracy: 72.12
Round  47, Train loss: 1.183, Test loss: 1.753, Test accuracy: 72.07
Round  48, Train loss: 1.348, Test loss: 1.753, Test accuracy: 72.00
Round  49, Train loss: 1.224, Test loss: 1.753, Test accuracy: 71.97
Round  50, Train loss: 1.305, Test loss: 1.753, Test accuracy: 71.85
Round  51, Train loss: 1.306, Test loss: 1.755, Test accuracy: 71.73
Round  52, Train loss: 1.306, Test loss: 1.752, Test accuracy: 72.02
Round  53, Train loss: 1.264, Test loss: 1.754, Test accuracy: 71.77
Round  54, Train loss: 1.266, Test loss: 1.753, Test accuracy: 71.85
Round  55, Train loss: 1.223, Test loss: 1.756, Test accuracy: 71.62
Round  56, Train loss: 1.264, Test loss: 1.754, Test accuracy: 71.78
Round  57, Train loss: 1.304, Test loss: 1.756, Test accuracy: 71.65
Round  58, Train loss: 1.264, Test loss: 1.755, Test accuracy: 71.77
Round  59, Train loss: 1.304, Test loss: 1.755, Test accuracy: 71.72
Round  60, Train loss: 1.265, Test loss: 1.758, Test accuracy: 71.53
Round  61, Train loss: 1.345, Test loss: 1.757, Test accuracy: 71.57
Round  62, Train loss: 1.305, Test loss: 1.757, Test accuracy: 71.70
Round  63, Train loss: 1.262, Test loss: 1.758, Test accuracy: 71.50
Round  64, Train loss: 1.182, Test loss: 1.758, Test accuracy: 71.58
Round  65, Train loss: 1.306, Test loss: 1.756, Test accuracy: 71.65
Round  66, Train loss: 1.264, Test loss: 1.757, Test accuracy: 71.55
Round  67, Train loss: 1.305, Test loss: 1.757, Test accuracy: 71.53
Round  68, Train loss: 1.182, Test loss: 1.758, Test accuracy: 71.37
Round  69, Train loss: 1.262, Test loss: 1.758, Test accuracy: 71.30
Round  70, Train loss: 1.265, Test loss: 1.760, Test accuracy: 71.17
Round  71, Train loss: 1.222, Test loss: 1.760, Test accuracy: 71.07
Round  72, Train loss: 1.305, Test loss: 1.759, Test accuracy: 71.25
Round  73, Train loss: 1.264, Test loss: 1.759, Test accuracy: 71.15
Round  74, Train loss: 1.306, Test loss: 1.759, Test accuracy: 71.12
Round  75, Train loss: 1.181, Test loss: 1.759, Test accuracy: 71.15
Round  76, Train loss: 1.345, Test loss: 1.759, Test accuracy: 71.03
Round  77, Train loss: 1.264, Test loss: 1.759, Test accuracy: 71.15
Round  78, Train loss: 1.263, Test loss: 1.760, Test accuracy: 71.05
Round  79, Train loss: 1.262, Test loss: 1.761, Test accuracy: 70.88
Round  80, Train loss: 1.222, Test loss: 1.762, Test accuracy: 70.83
Round  81, Train loss: 1.264, Test loss: 1.762, Test accuracy: 70.80
Round  82, Train loss: 1.305, Test loss: 1.761, Test accuracy: 70.90
Round  83, Train loss: 1.387, Test loss: 1.763, Test accuracy: 70.67
Round  84, Train loss: 1.304, Test loss: 1.762, Test accuracy: 70.78
Round  85, Train loss: 1.264, Test loss: 1.762, Test accuracy: 70.77
Round  86, Train loss: 1.387, Test loss: 1.762, Test accuracy: 70.70
Round  87, Train loss: 1.306, Test loss: 1.764, Test accuracy: 70.67
Round  88, Train loss: 1.346, Test loss: 1.764, Test accuracy: 70.65
Round  89, Train loss: 1.305, Test loss: 1.765, Test accuracy: 70.50
Round  90, Train loss: 1.262, Test loss: 1.764, Test accuracy: 70.63
Round  91, Train loss: 1.181, Test loss: 1.765, Test accuracy: 70.53
Round  92, Train loss: 1.180, Test loss: 1.765, Test accuracy: 70.60
Round  93, Train loss: 1.262, Test loss: 1.765, Test accuracy: 70.47
Round  94, Train loss: 1.222, Test loss: 1.766, Test accuracy: 70.50
Round  95, Train loss: 1.388, Test loss: 1.766, Test accuracy: 70.33
Round  96, Train loss: 1.180, Test loss: 1.766, Test accuracy: 70.43
Round  97, Train loss: 1.345, Test loss: 1.766, Test accuracy: 70.43
Round  98, Train loss: 1.263, Test loss: 1.764, Test accuracy: 70.42
Round  99, Train loss: 1.305, Test loss: 1.767, Test accuracy: 70.17
Final Round, Train loss: 1.284, Test loss: 1.768, Test accuracy: 70.00
Average accuracy final 10 rounds: 70.45166666666667
908.5790014266968
[]
[38.96666666666667, 41.95, 51.983333333333334, 67.05, 66.1, 65.66666666666667, 66.76666666666667, 66.55, 66.48333333333333, 69.71666666666667, 69.88333333333334, 69.95, 71.41666666666667, 71.13333333333334, 72.95, 73.0, 73.16666666666667, 73.28333333333333, 73.08333333333333, 73.15, 73.01666666666667, 72.95, 72.95, 73.0, 72.8, 72.88333333333334, 72.68333333333334, 72.65, 72.36666666666666, 72.38333333333334, 72.43333333333334, 72.25, 72.33333333333333, 72.31666666666666, 72.25, 72.26666666666667, 72.31666666666666, 72.26666666666667, 72.1, 72.05, 72.06666666666666, 71.95, 71.91666666666667, 71.98333333333333, 71.9, 72.1, 72.11666666666666, 72.06666666666666, 72.0, 71.96666666666667, 71.85, 71.73333333333333, 72.01666666666667, 71.76666666666667, 71.85, 71.61666666666666, 71.78333333333333, 71.65, 71.76666666666667, 71.71666666666667, 71.53333333333333, 71.56666666666666, 71.7, 71.5, 71.58333333333333, 71.65, 71.55, 71.53333333333333, 71.36666666666666, 71.3, 71.16666666666667, 71.06666666666666, 71.25, 71.15, 71.11666666666666, 71.15, 71.03333333333333, 71.15, 71.05, 70.88333333333334, 70.83333333333333, 70.8, 70.9, 70.66666666666667, 70.78333333333333, 70.76666666666667, 70.7, 70.66666666666667, 70.65, 70.5, 70.63333333333334, 70.53333333333333, 70.6, 70.46666666666667, 70.5, 70.33333333333333, 70.43333333333334, 70.43333333333334, 70.41666666666667, 70.16666666666667, 70.0]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Fed_scaffold %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.269, Test loss: 2.262, Test accuracy: 28.10
Round   0: Global train loss: 2.269, Global test loss: 2.300, Global test accuracy: 15.00
Round   1, Train loss: 2.213, Test loss: 2.236, Test accuracy: 26.77
Round   1: Global train loss: 2.213, Global test loss: 2.299, Global test accuracy: 15.00
Round   2, Train loss: 2.132, Test loss: 2.221, Test accuracy: 27.97
Round   2: Global train loss: 2.132, Global test loss: 2.299, Global test accuracy: 15.15
Round   3, Train loss: 2.034, Test loss: 2.150, Test accuracy: 31.45
Round   3: Global train loss: 2.034, Global test loss: 2.297, Global test accuracy: 15.33
Round   4, Train loss: 1.931, Test loss: 2.113, Test accuracy: 35.27
Round   4: Global train loss: 1.931, Global test loss: 2.296, Global test accuracy: 15.02
Round   5, Train loss: 1.963, Test loss: 2.168, Test accuracy: 30.27
Round   5: Global train loss: 1.963, Global test loss: 2.297, Global test accuracy: 15.15
Round   6, Train loss: 1.806, Test loss: 2.096, Test accuracy: 38.93
Round   6: Global train loss: 1.806, Global test loss: 2.294, Global test accuracy: 15.10
Round   7, Train loss: 1.533, Test loss: 2.099, Test accuracy: 35.70
Round   7: Global train loss: 1.533, Global test loss: 2.293, Global test accuracy: 15.10
Round   8, Train loss: 1.640, Test loss: 2.055, Test accuracy: 40.42
Round   8: Global train loss: 1.640, Global test loss: 2.293, Global test accuracy: 19.00
Round   9, Train loss: 1.190, Test loss: 1.943, Test accuracy: 52.30
Round   9: Global train loss: 1.190, Global test loss: 2.286, Global test accuracy: 28.95
Round  10, Train loss: 1.434, Test loss: 1.953, Test accuracy: 54.13
Round  10: Global train loss: 1.434, Global test loss: 2.286, Global test accuracy: 33.32
Round  11, Train loss: 1.067, Test loss: 1.941, Test accuracy: 53.48
Round  11: Global train loss: 1.067, Global test loss: 2.284, Global test accuracy: 36.57
Round  12, Train loss: 1.078, Test loss: 1.922, Test accuracy: 55.40
Round  12: Global train loss: 1.078, Global test loss: 2.280, Global test accuracy: 34.92
Round  13, Train loss: 1.161, Test loss: 1.997, Test accuracy: 50.02
Round  13: Global train loss: 1.161, Global test loss: 2.284, Global test accuracy: 35.57
Round  14, Train loss: 1.694, Test loss: 2.090, Test accuracy: 41.05
Round  14: Global train loss: 1.694, Global test loss: 2.288, Global test accuracy: 34.43
Round  15, Train loss: 0.680, Test loss: 1.937, Test accuracy: 58.12
Round  15: Global train loss: 0.680, Global test loss: 2.284, Global test accuracy: 37.62
Round  16, Train loss: 1.224, Test loss: 1.992, Test accuracy: 54.68
Round  16: Global train loss: 1.224, Global test loss: 2.289, Global test accuracy: 27.85
Round  17, Train loss: 0.330, Test loss: 1.847, Test accuracy: 64.10
Round  17: Global train loss: 0.330, Global test loss: 2.285, Global test accuracy: 24.98
Round  18, Train loss: 0.406, Test loss: 1.900, Test accuracy: 60.98
Round  18: Global train loss: 0.406, Global test loss: 2.286, Global test accuracy: 30.65
Round  19, Train loss: 0.460, Test loss: 1.978, Test accuracy: 53.30
Round  19: Global train loss: 0.460, Global test loss: 2.290, Global test accuracy: 29.63
Round  20, Train loss: 1.138, Test loss: 2.026, Test accuracy: 46.48
Round  20: Global train loss: 1.138, Global test loss: 2.292, Global test accuracy: 28.02
Round  21, Train loss: 0.118, Test loss: 1.985, Test accuracy: 49.50
Round  21: Global train loss: 0.118, Global test loss: 2.293, Global test accuracy: 20.57
Round  22, Train loss: -0.211, Test loss: 1.841, Test accuracy: 61.00
Round  22: Global train loss: -0.211, Global test loss: 2.287, Global test accuracy: 28.35
Round  23, Train loss: 0.726, Test loss: 1.925, Test accuracy: 53.28
Round  23: Global train loss: 0.726, Global test loss: 2.290, Global test accuracy: 27.45
Round  24, Train loss: -0.133, Test loss: 1.853, Test accuracy: 60.88
Round  24: Global train loss: -0.133, Global test loss: 2.287, Global test accuracy: 26.67
Round  25, Train loss: -0.553, Test loss: 1.803, Test accuracy: 66.75
Round  25: Global train loss: -0.553, Global test loss: 2.283, Global test accuracy: 32.93
Round  26, Train loss: 0.554, Test loss: 1.949, Test accuracy: 53.72
Round  26: Global train loss: 0.554, Global test loss: 2.289, Global test accuracy: 22.22
Round  27, Train loss: -0.342, Test loss: 1.945, Test accuracy: 53.88
Round  27: Global train loss: -0.342, Global test loss: 2.292, Global test accuracy: 27.03
Round  28, Train loss: -0.702, Test loss: 1.907, Test accuracy: 56.68
Round  28: Global train loss: -0.702, Global test loss: 2.292, Global test accuracy: 27.00
Round  29, Train loss: -1.015, Test loss: 1.813, Test accuracy: 66.93
Round  29: Global train loss: -1.015, Global test loss: 2.289, Global test accuracy: 27.82
Round  30, Train loss: -0.625, Test loss: 1.862, Test accuracy: 64.38
Round  30: Global train loss: -0.625, Global test loss: 2.289, Global test accuracy: 28.52
Round  31, Train loss: -0.945, Test loss: 1.901, Test accuracy: 57.53
Round  31: Global train loss: -0.945, Global test loss: 2.290, Global test accuracy: 28.70
Round  32, Train loss: -1.303, Test loss: 1.834, Test accuracy: 65.07
Round  32: Global train loss: -1.303, Global test loss: 2.290, Global test accuracy: 28.12
Round  33, Train loss: -0.894, Test loss: 1.854, Test accuracy: 61.85
Round  33: Global train loss: -0.894, Global test loss: 2.290, Global test accuracy: 24.43
Round  34, Train loss: -1.080, Test loss: 1.765, Test accuracy: 70.57
Round  34: Global train loss: -1.080, Global test loss: 2.289, Global test accuracy: 26.67
Round  35, Train loss: -1.803, Test loss: 1.730, Test accuracy: 75.10
Round  35: Global train loss: -1.803, Global test loss: 2.284, Global test accuracy: 27.38
Round  36, Train loss: -2.570, Test loss: 1.684, Test accuracy: 79.35
Round  36: Global train loss: -2.570, Global test loss: 2.281, Global test accuracy: 40.05
Round  37, Train loss: -0.837, Test loss: 1.735, Test accuracy: 73.48
Round  37: Global train loss: -0.837, Global test loss: 2.283, Global test accuracy: 34.43
Round  38, Train loss: -2.754, Test loss: 1.684, Test accuracy: 77.28
Round  38: Global train loss: -2.754, Global test loss: 2.274, Global test accuracy: 34.88
Round  39, Train loss: -2.148, Test loss: 1.724, Test accuracy: 73.47
Round  39: Global train loss: -2.148, Global test loss: 2.277, Global test accuracy: 35.83
Round  40, Train loss: -1.554, Test loss: 1.713, Test accuracy: 73.72
Round  40: Global train loss: -1.554, Global test loss: 2.274, Global test accuracy: 32.72
Round  41, Train loss: -2.320, Test loss: 1.677, Test accuracy: 78.25
Round  41: Global train loss: -2.320, Global test loss: 2.267, Global test accuracy: 40.65
Round  42, Train loss: -3.092, Test loss: 1.620, Test accuracy: 84.25
Round  42: Global train loss: -3.092, Global test loss: 2.252, Global test accuracy: 38.58
Round  43, Train loss: -1.308, Test loss: 1.683, Test accuracy: 77.33
Round  43: Global train loss: -1.308, Global test loss: 2.254, Global test accuracy: 30.72
Round  44, Train loss: -2.046, Test loss: 1.673, Test accuracy: 79.67
Round  44: Global train loss: -2.046, Global test loss: 2.253, Global test accuracy: 29.80
Round  45, Train loss: -2.156, Test loss: 1.677, Test accuracy: 80.82
Round  45: Global train loss: -2.156, Global test loss: 2.257, Global test accuracy: 31.13
Round  46, Train loss: -3.402, Test loss: 1.642, Test accuracy: 84.18
Round  46: Global train loss: -3.402, Global test loss: 2.252, Global test accuracy: 36.87
Round  47, Train loss: -2.234, Test loss: 1.607, Test accuracy: 87.80
Round  47: Global train loss: -2.234, Global test loss: 2.241, Global test accuracy: 42.42
Round  48, Train loss: -1.428, Test loss: 1.607, Test accuracy: 88.67
Round  48: Global train loss: -1.428, Global test loss: 2.246, Global test accuracy: 51.72
Round  49, Train loss: -1.710, Test loss: 1.630, Test accuracy: 85.78
Round  49: Global train loss: -1.710, Global test loss: 2.240, Global test accuracy: 39.37
Round  50, Train loss: -2.838, Test loss: 1.633, Test accuracy: 85.67
Round  50: Global train loss: -2.838, Global test loss: 2.237, Global test accuracy: 49.97
Round  51, Train loss: -2.939, Test loss: 1.597, Test accuracy: 87.57
Round  51: Global train loss: -2.939, Global test loss: 2.228, Global test accuracy: 36.73
Round  52, Train loss: -1.746, Test loss: 1.602, Test accuracy: 87.13
Round  52: Global train loss: -1.746, Global test loss: 2.229, Global test accuracy: 43.50
Round  53, Train loss: -3.871, Test loss: 1.583, Test accuracy: 89.12
Round  53: Global train loss: -3.871, Global test loss: 2.221, Global test accuracy: 42.55
Round  54, Train loss: -3.316, Test loss: 1.586, Test accuracy: 88.72
Round  54: Global train loss: -3.316, Global test loss: 2.219, Global test accuracy: 37.57
Round  55, Train loss: -2.159, Test loss: 1.574, Test accuracy: 89.90
Round  55: Global train loss: -2.159, Global test loss: 2.214, Global test accuracy: 37.40
Round  56, Train loss: -2.420, Test loss: 1.556, Test accuracy: 90.77
Round  56: Global train loss: -2.420, Global test loss: 2.209, Global test accuracy: 31.35
Round  57, Train loss: -3.158, Test loss: 1.568, Test accuracy: 89.47
Round  57: Global train loss: -3.158, Global test loss: 2.200, Global test accuracy: 24.25
Round  58, Train loss: -3.124, Test loss: 1.570, Test accuracy: 89.32
Round  58: Global train loss: -3.124, Global test loss: 2.195, Global test accuracy: 27.55
Round  59, Train loss: -2.460, Test loss: 1.541, Test accuracy: 92.35
Round  59: Global train loss: -2.460, Global test loss: 2.189, Global test accuracy: 42.37
Round  60, Train loss: -2.870, Test loss: 1.552, Test accuracy: 91.17
Round  60: Global train loss: -2.870, Global test loss: 2.187, Global test accuracy: 42.97
Round  61, Train loss: -2.460, Test loss: 1.531, Test accuracy: 93.52
Round  61: Global train loss: -2.460, Global test loss: 2.190, Global test accuracy: 38.92
Round  62, Train loss: -2.897, Test loss: 1.532, Test accuracy: 93.77
Round  62: Global train loss: -2.897, Global test loss: 2.185, Global test accuracy: 47.98
Round  63, Train loss: -3.636, Test loss: 1.526, Test accuracy: 94.13
Round  63: Global train loss: -3.636, Global test loss: 2.176, Global test accuracy: 51.75
Round  64, Train loss: -3.539, Test loss: 1.542, Test accuracy: 92.43
Round  64: Global train loss: -3.539, Global test loss: 2.165, Global test accuracy: 53.02
Round  65, Train loss: -4.226, Test loss: 1.525, Test accuracy: 94.23
Round  65: Global train loss: -4.226, Global test loss: 2.155, Global test accuracy: 52.33
Round  66, Train loss: -2.873, Test loss: 1.525, Test accuracy: 94.37
Round  66: Global train loss: -2.873, Global test loss: 2.161, Global test accuracy: 50.73
Round  67, Train loss: -4.093, Test loss: 1.522, Test accuracy: 94.48
Round  67: Global train loss: -4.093, Global test loss: 2.155, Global test accuracy: 47.73
Round  68, Train loss: -2.631, Test loss: 1.532, Test accuracy: 93.37
Round  68: Global train loss: -2.631, Global test loss: 2.157, Global test accuracy: 45.07
Round  69, Train loss: -2.577, Test loss: 1.535, Test accuracy: 93.10
Round  69: Global train loss: -2.577, Global test loss: 2.148, Global test accuracy: 46.15
Round  70, Train loss: -3.597, Test loss: 1.535, Test accuracy: 93.15
Round  70: Global train loss: -3.597, Global test loss: 2.140, Global test accuracy: 48.62
Round  71, Train loss: -2.847, Test loss: 1.547, Test accuracy: 91.33
Round  71: Global train loss: -2.847, Global test loss: 2.128, Global test accuracy: 51.75
Round  72, Train loss: -2.225, Test loss: 1.523, Test accuracy: 93.78
Round  72: Global train loss: -2.225, Global test loss: 2.123, Global test accuracy: 54.05
Round  73, Train loss: -3.603, Test loss: 1.524, Test accuracy: 93.72
Round  73: Global train loss: -3.603, Global test loss: 2.111, Global test accuracy: 55.25
Round  74, Train loss: -3.234, Test loss: 1.523, Test accuracy: 93.93
Round  74: Global train loss: -3.234, Global test loss: 2.103, Global test accuracy: 55.13
Round  75, Train loss: -2.895, Test loss: 1.539, Test accuracy: 92.33
Round  75: Global train loss: -2.895, Global test loss: 2.107, Global test accuracy: 53.93
Round  76, Train loss: -2.811, Test loss: 1.539, Test accuracy: 92.27
Round  76: Global train loss: -2.811, Global test loss: 2.106, Global test accuracy: 53.67
Round  77, Train loss: -2.877, Test loss: 1.534, Test accuracy: 92.80
Round  77: Global train loss: -2.877, Global test loss: 2.110, Global test accuracy: 49.92
Round  78, Train loss: -2.673, Test loss: 1.532, Test accuracy: 92.97
Round  78: Global train loss: -2.673, Global test loss: 2.110, Global test accuracy: 48.15
Round  79, Train loss: -2.972, Test loss: 1.534, Test accuracy: 92.80
Round  79: Global train loss: -2.972, Global test loss: 2.103, Global test accuracy: 50.53
Round  80, Train loss: -2.272, Test loss: 1.542, Test accuracy: 91.87
Round  80: Global train loss: -2.272, Global test loss: 2.095, Global test accuracy: 52.60
Round  81, Train loss: -3.079, Test loss: 1.544, Test accuracy: 91.63
Round  81: Global train loss: -3.079, Global test loss: 2.088, Global test accuracy: 51.95
Round  82, Train loss: -2.668, Test loss: 1.541, Test accuracy: 91.97
Round  82: Global train loss: -2.668, Global test loss: 2.082, Global test accuracy: 53.47
Round  83, Train loss: -2.719, Test loss: 1.529, Test accuracy: 93.22
Round  83: Global train loss: -2.719, Global test loss: 2.067, Global test accuracy: 53.75
Round  84, Train loss: -2.588, Test loss: 1.512, Test accuracy: 94.95
Round  84: Global train loss: -2.588, Global test loss: 2.059, Global test accuracy: 53.22
Round  85, Train loss: -3.043, Test loss: 1.525, Test accuracy: 93.60
Round  85: Global train loss: -3.043, Global test loss: 2.046, Global test accuracy: 54.22
Round  86, Train loss: -2.708, Test loss: 1.513, Test accuracy: 94.80
Round  86: Global train loss: -2.708, Global test loss: 2.044, Global test accuracy: 51.17
Round  87, Train loss: -1.991, Test loss: 1.525, Test accuracy: 93.58
Round  87: Global train loss: -1.991, Global test loss: 2.048, Global test accuracy: 48.02
Round  88, Train loss: -2.506, Test loss: 1.528, Test accuracy: 93.23
Round  88: Global train loss: -2.506, Global test loss: 2.043, Global test accuracy: 47.78
Round  89, Train loss: -1.803, Test loss: 1.514, Test accuracy: 94.73
Round  89: Global train loss: -1.803, Global test loss: 2.033, Global test accuracy: 51.13
Round  90, Train loss: -2.880, Test loss: 1.528, Test accuracy: 93.32
Round  90: Global train loss: -2.880, Global test loss: 2.031, Global test accuracy: 51.00
Round  91, Train loss: -2.468, Test loss: 1.512, Test accuracy: 94.93
Round  91: Global train loss: -2.468, Global test loss: 2.030, Global test accuracy: 49.48
Round  92, Train loss: -2.738, Test loss: 1.528, Test accuracy: 93.28
Round  92: Global train loss: -2.738, Global test loss: 2.029, Global test accuracy: 47.48
Round  93, Train loss: -2.290, Test loss: 1.527, Test accuracy: 93.37
Round  93: Global train loss: -2.290, Global test loss: 2.025, Global test accuracy: 47.92
Round  94, Train loss: -2.759, Test loss: 1.526, Test accuracy: 93.40
Round  94: Global train loss: -2.759, Global test loss: 2.025, Global test accuracy: 46.00
Round  95, Train loss: -2.679, Test loss: 1.529, Test accuracy: 93.20
Round  95: Global train loss: -2.679, Global test loss: 2.021, Global test accuracy: 48.80
Round  96, Train loss: -2.832, Test loss: 1.527, Test accuracy: 93.42
Round  96: Global train loss: -2.832, Global test loss: 2.015, Global test accuracy: 51.55
Round  97, Train loss: -2.141, Test loss: 1.522, Test accuracy: 94.00
Round  97: Global train loss: -2.141, Global test loss: 2.011, Global test accuracy: 50.58
Round  98, Train loss: -2.355, Test loss: 1.525, Test accuracy: 93.73
Round  98: Global train loss: -2.355, Global test loss: 2.011, Global test accuracy: 49.03
Round  99, Train loss: -1.789, Test loss: 1.510, Test accuracy: 95.08
Round  99: Global train loss: -1.789, Global test loss: 2.000, Global test accuracy: 51.73
Final Round: Train loss: 1.574, Test loss: 1.541, Test accuracy: 92.87
Final Round: Global train loss: 1.574, Global test loss: 1.993, Global test accuracy: 51.95
Average accuracy final 10 rounds: 93.77333333333334
Average global accuracy final 10 rounds: 49.358333333333334
676.7428600788116
[]
[28.1, 26.766666666666666, 27.966666666666665, 31.45, 35.266666666666666, 30.266666666666666, 38.93333333333333, 35.7, 40.416666666666664, 52.3, 54.13333333333333, 53.483333333333334, 55.4, 50.016666666666666, 41.05, 58.11666666666667, 54.68333333333333, 64.1, 60.983333333333334, 53.3, 46.483333333333334, 49.5, 61.0, 53.28333333333333, 60.88333333333333, 66.75, 53.71666666666667, 53.88333333333333, 56.68333333333333, 66.93333333333334, 64.38333333333334, 57.53333333333333, 65.06666666666666, 61.85, 70.56666666666666, 75.1, 79.35, 73.48333333333333, 77.28333333333333, 73.46666666666667, 73.71666666666667, 78.25, 84.25, 77.33333333333333, 79.66666666666667, 80.81666666666666, 84.18333333333334, 87.8, 88.66666666666667, 85.78333333333333, 85.66666666666667, 87.56666666666666, 87.13333333333334, 89.11666666666666, 88.71666666666667, 89.9, 90.76666666666667, 89.46666666666667, 89.31666666666666, 92.35, 91.16666666666667, 93.51666666666667, 93.76666666666667, 94.13333333333334, 92.43333333333334, 94.23333333333333, 94.36666666666666, 94.48333333333333, 93.36666666666666, 93.1, 93.15, 91.33333333333333, 93.78333333333333, 93.71666666666667, 93.93333333333334, 92.33333333333333, 92.26666666666667, 92.8, 92.96666666666667, 92.8, 91.86666666666666, 91.63333333333334, 91.96666666666667, 93.21666666666667, 94.95, 93.6, 94.8, 93.58333333333333, 93.23333333333333, 94.73333333333333, 93.31666666666666, 94.93333333333334, 93.28333333333333, 93.36666666666666, 93.4, 93.2, 93.41666666666667, 94.0, 93.73333333333333, 95.08333333333333, 92.86666666666666]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  pFedMe   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.303, Test loss: 2.302, Test accuracy: 11.67 

Round   0, Global train loss: 2.303, Global test loss: 2.303, Global test accuracy: 11.55 

Round   1, Train loss: 2.302, Test loss: 2.302, Test accuracy: 12.03 

Round   1, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 11.68 

Round   2, Train loss: 2.303, Test loss: 2.302, Test accuracy: 12.18 

Round   2, Global train loss: 2.303, Global test loss: 2.302, Global test accuracy: 11.77 

Round   3, Train loss: 2.300, Test loss: 2.302, Test accuracy: 12.50 

Round   3, Global train loss: 2.300, Global test loss: 2.302, Global test accuracy: 11.90 

Round   4, Train loss: 2.302, Test loss: 2.302, Test accuracy: 12.48 

Round   4, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 11.97 

Round   5, Train loss: 2.302, Test loss: 2.302, Test accuracy: 12.60 

Round   5, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 11.98 

Round   6, Train loss: 2.301, Test loss: 2.302, Test accuracy: 12.72 

Round   6, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 12.17 

Round   7, Train loss: 2.302, Test loss: 2.302, Test accuracy: 12.70 

Round   7, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 12.20 

Round   8, Train loss: 2.301, Test loss: 2.302, Test accuracy: 12.80 

Round   8, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 12.28 

Round   9, Train loss: 2.302, Test loss: 2.302, Test accuracy: 12.98 

Round   9, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 12.23 

Round  10, Train loss: 2.302, Test loss: 2.302, Test accuracy: 13.05 

Round  10, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 12.38 

Round  11, Train loss: 2.302, Test loss: 2.302, Test accuracy: 13.25 

Round  11, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 12.43 

Round  12, Train loss: 2.302, Test loss: 2.302, Test accuracy: 13.37 

Round  12, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 12.60 

Round  13, Train loss: 2.301, Test loss: 2.302, Test accuracy: 13.33 

Round  13, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 12.72 

Round  14, Train loss: 2.301, Test loss: 2.302, Test accuracy: 13.52 

Round  14, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 12.75 

Round  15, Train loss: 2.302, Test loss: 2.302, Test accuracy: 13.57 

Round  15, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 12.78 

Round  16, Train loss: 2.301, Test loss: 2.302, Test accuracy: 13.55 

Round  16, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 12.90 

Round  17, Train loss: 2.301, Test loss: 2.302, Test accuracy: 13.63 

Round  17, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 12.90 

Round  18, Train loss: 2.301, Test loss: 2.302, Test accuracy: 13.77 

Round  18, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 13.22 

Round  19, Train loss: 2.301, Test loss: 2.302, Test accuracy: 13.88 

Round  19, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 13.25 

Round  20, Train loss: 2.301, Test loss: 2.302, Test accuracy: 14.00 

Round  20, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 13.43 

Round  21, Train loss: 2.301, Test loss: 2.302, Test accuracy: 14.23 

Round  21, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 13.58 

Round  22, Train loss: 2.302, Test loss: 2.302, Test accuracy: 14.48 

Round  22, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 13.77 

Round  23, Train loss: 2.301, Test loss: 2.301, Test accuracy: 14.80 

Round  23, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 14.00 

Round  24, Train loss: 2.302, Test loss: 2.301, Test accuracy: 14.85 

Round  24, Global train loss: 2.302, Global test loss: 2.302, Global test accuracy: 14.07 

Round  25, Train loss: 2.301, Test loss: 2.301, Test accuracy: 15.00 

Round  25, Global train loss: 2.301, Global test loss: 2.302, Global test accuracy: 14.37 

Round  26, Train loss: 2.300, Test loss: 2.301, Test accuracy: 15.17 

Round  26, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 14.48 

Round  27, Train loss: 2.300, Test loss: 2.301, Test accuracy: 15.28 

Round  27, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 14.60 

Round  28, Train loss: 2.300, Test loss: 2.301, Test accuracy: 15.33 

Round  28, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 14.67 

Round  29, Train loss: 2.302, Test loss: 2.301, Test accuracy: 15.35 

Round  29, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 14.60 

Round  30, Train loss: 2.301, Test loss: 2.301, Test accuracy: 15.57 

Round  30, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 14.85 

Round  31, Train loss: 2.300, Test loss: 2.301, Test accuracy: 15.75 

Round  31, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 15.00 

Round  32, Train loss: 2.301, Test loss: 2.301, Test accuracy: 16.05 

Round  32, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 15.18 

Round  33, Train loss: 2.302, Test loss: 2.301, Test accuracy: 16.17 

Round  33, Global train loss: 2.302, Global test loss: 2.301, Global test accuracy: 15.33 

Round  34, Train loss: 2.300, Test loss: 2.301, Test accuracy: 15.97 

Round  34, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 15.37 

Round  35, Train loss: 2.301, Test loss: 2.301, Test accuracy: 15.97 

Round  35, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 15.50 

Round  36, Train loss: 2.300, Test loss: 2.301, Test accuracy: 16.07 

Round  36, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 15.45 

Round  37, Train loss: 2.300, Test loss: 2.301, Test accuracy: 16.15 

Round  37, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 15.65 

Round  38, Train loss: 2.300, Test loss: 2.301, Test accuracy: 16.23 

Round  38, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 15.58 

Round  39, Train loss: 2.301, Test loss: 2.301, Test accuracy: 16.37 

Round  39, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 15.78 

Round  40, Train loss: 2.301, Test loss: 2.301, Test accuracy: 16.32 

Round  40, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 15.98 

Round  41, Train loss: 2.299, Test loss: 2.301, Test accuracy: 16.55 

Round  41, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 16.08 

Round  42, Train loss: 2.301, Test loss: 2.301, Test accuracy: 16.68 

Round  42, Global train loss: 2.301, Global test loss: 2.301, Global test accuracy: 16.17 

Round  43, Train loss: 2.300, Test loss: 2.301, Test accuracy: 16.90 

Round  43, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 16.33 

Round  44, Train loss: 2.299, Test loss: 2.301, Test accuracy: 17.28 

Round  44, Global train loss: 2.299, Global test loss: 2.301, Global test accuracy: 16.67 

Round  45, Train loss: 2.300, Test loss: 2.301, Test accuracy: 17.45 

Round  45, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 16.77 

Round  46, Train loss: 2.300, Test loss: 2.301, Test accuracy: 17.43 

Round  46, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 16.95 

Round  47, Train loss: 2.300, Test loss: 2.301, Test accuracy: 17.80 

Round  47, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 17.08 

Round  48, Train loss: 2.300, Test loss: 2.300, Test accuracy: 18.10 

Round  48, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 17.28 

Round  49, Train loss: 2.300, Test loss: 2.300, Test accuracy: 18.23 

Round  49, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 17.43 

Round  50, Train loss: 2.300, Test loss: 2.300, Test accuracy: 18.47 

Round  50, Global train loss: 2.300, Global test loss: 2.301, Global test accuracy: 17.65 

Round  51, Train loss: 2.299, Test loss: 2.300, Test accuracy: 18.68 

Round  51, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 18.17 

Round  52, Train loss: 2.298, Test loss: 2.300, Test accuracy: 18.87 

Round  52, Global train loss: 2.298, Global test loss: 2.300, Global test accuracy: 18.32 

Round  53, Train loss: 2.300, Test loss: 2.300, Test accuracy: 19.23 

Round  53, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 18.32 

Round  54, Train loss: 2.300, Test loss: 2.300, Test accuracy: 19.30 

Round  54, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 18.60 

Round  55, Train loss: 2.299, Test loss: 2.300, Test accuracy: 19.38 

Round  55, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 18.73 

Round  56, Train loss: 2.300, Test loss: 2.300, Test accuracy: 19.37 

Round  56, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 18.77 

Round  57, Train loss: 2.299, Test loss: 2.300, Test accuracy: 19.48 

Round  57, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 18.95 

Round  58, Train loss: 2.299, Test loss: 2.300, Test accuracy: 19.63 

Round  58, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 19.05 

Round  59, Train loss: 2.298, Test loss: 2.300, Test accuracy: 19.70 

Round  59, Global train loss: 2.298, Global test loss: 2.300, Global test accuracy: 19.25 

Round  60, Train loss: 2.299, Test loss: 2.300, Test accuracy: 19.85 

Round  60, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 19.42 

Round  61, Train loss: 2.298, Test loss: 2.300, Test accuracy: 20.08 

Round  61, Global train loss: 2.298, Global test loss: 2.300, Global test accuracy: 19.58 

Round  62, Train loss: 2.299, Test loss: 2.300, Test accuracy: 20.23 

Round  62, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 19.62 

Round  63, Train loss: 2.300, Test loss: 2.300, Test accuracy: 20.17 

Round  63, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 19.73 

Round  64, Train loss: 2.300, Test loss: 2.300, Test accuracy: 20.58 

Round  64, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 20.25 

Round  65, Train loss: 2.300, Test loss: 2.300, Test accuracy: 20.85 

Round  65, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 20.55 

Round  66, Train loss: 2.300, Test loss: 2.300, Test accuracy: 21.13 

Round  66, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 20.97 

Round  67, Train loss: 2.299, Test loss: 2.300, Test accuracy: 21.53 

Round  67, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 21.27 

Round  68, Train loss: 2.300, Test loss: 2.300, Test accuracy: 21.95 

Round  68, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 21.23 

Round  69, Train loss: 2.299, Test loss: 2.300, Test accuracy: 22.32 

Round  69, Global train loss: 2.299, Global test loss: 2.300, Global test accuracy: 21.68 

Round  70, Train loss: 2.300, Test loss: 2.299, Test accuracy: 22.55 

Round  70, Global train loss: 2.300, Global test loss: 2.300, Global test accuracy: 21.98 

Round  71, Train loss: 2.298, Test loss: 2.299, Test accuracy: 22.75 

Round  71, Global train loss: 2.298, Global test loss: 2.300, Global test accuracy: 22.05 

Round  72, Train loss: 2.301, Test loss: 2.299, Test accuracy: 22.80 

Round  72, Global train loss: 2.301, Global test loss: 2.300, Global test accuracy: 22.32 

Round  73, Train loss: 2.298, Test loss: 2.299, Test accuracy: 22.98 

Round  73, Global train loss: 2.298, Global test loss: 2.300, Global test accuracy: 22.15 

Round  74, Train loss: 2.298, Test loss: 2.299, Test accuracy: 23.18 

Round  74, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 22.88 

Round  75, Train loss: 2.299, Test loss: 2.299, Test accuracy: 23.50 

Round  75, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 22.90 

Round  76, Train loss: 2.299, Test loss: 2.299, Test accuracy: 23.43 

Round  76, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 22.75 

Round  77, Train loss: 2.297, Test loss: 2.299, Test accuracy: 24.23 

Round  77, Global train loss: 2.297, Global test loss: 2.299, Global test accuracy: 23.00 

Round  78, Train loss: 2.299, Test loss: 2.299, Test accuracy: 24.03 

Round  78, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 22.88 

Round  79, Train loss: 2.299, Test loss: 2.299, Test accuracy: 24.07 

Round  79, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 23.13 

Round  80, Train loss: 2.297, Test loss: 2.299, Test accuracy: 24.37 

Round  80, Global train loss: 2.297, Global test loss: 2.299, Global test accuracy: 23.23 

Round  81, Train loss: 2.300, Test loss: 2.299, Test accuracy: 24.32 

Round  81, Global train loss: 2.300, Global test loss: 2.299, Global test accuracy: 23.40 

Round  82, Train loss: 2.299, Test loss: 2.299, Test accuracy: 24.32 

Round  82, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 23.63 

Round  83, Train loss: 2.299, Test loss: 2.299, Test accuracy: 24.57 

Round  83, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 23.62 

Round  84, Train loss: 2.298, Test loss: 2.299, Test accuracy: 24.63 

Round  84, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 23.57 

Round  85, Train loss: 2.299, Test loss: 2.299, Test accuracy: 24.67 

Round  85, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 23.75 

Round  86, Train loss: 2.298, Test loss: 2.299, Test accuracy: 24.83 

Round  86, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 23.82 

Round  87, Train loss: 2.297, Test loss: 2.299, Test accuracy: 24.95 

Round  87, Global train loss: 2.297, Global test loss: 2.299, Global test accuracy: 24.07 

Round  88, Train loss: 2.297, Test loss: 2.299, Test accuracy: 25.05 

Round  88, Global train loss: 2.297, Global test loss: 2.299, Global test accuracy: 24.20 

Round  89, Train loss: 2.299, Test loss: 2.299, Test accuracy: 25.07 

Round  89, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 24.43 

Round  90, Train loss: 2.298, Test loss: 2.299, Test accuracy: 25.17 

Round  90, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 24.20 

Round  91, Train loss: 2.298, Test loss: 2.299, Test accuracy: 25.25 

Round  91, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 24.50 

Round  92, Train loss: 2.299, Test loss: 2.299, Test accuracy: 25.27 

Round  92, Global train loss: 2.299, Global test loss: 2.299, Global test accuracy: 24.30 

Round  93, Train loss: 2.298, Test loss: 2.298, Test accuracy: 25.63 

Round  93, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 24.48 

Round  94, Train loss: 2.298, Test loss: 2.298, Test accuracy: 25.57 

Round  94, Global train loss: 2.298, Global test loss: 2.299, Global test accuracy: 24.47 

Round  95, Train loss: 2.297, Test loss: 2.298, Test accuracy: 25.43 

Round  95, Global train loss: 2.297, Global test loss: 2.299, Global test accuracy: 24.60 

Round  96, Train loss: 2.298, Test loss: 2.298, Test accuracy: 25.68 

Round  96, Global train loss: 2.298, Global test loss: 2.298, Global test accuracy: 25.00 

Round  97, Train loss: 2.297, Test loss: 2.298, Test accuracy: 25.77 

Round  97, Global train loss: 2.297, Global test loss: 2.298, Global test accuracy: 25.25 

Round  98, Train loss: 2.297, Test loss: 2.298, Test accuracy: 26.05 

Round  98, Global train loss: 2.297, Global test loss: 2.298, Global test accuracy: 25.48 

Round  99, Train loss: 2.298, Test loss: 2.298, Test accuracy: 25.98 

Round  99, Global train loss: 2.298, Global test loss: 2.298, Global test accuracy: 25.22 

Final Round, Train loss: 2.298, Test loss: 2.298, Test accuracy: 26.95 

Final Round, Global train loss: 2.298, Global test loss: 2.298, Global test accuracy: 25.22 

Average accuracy final 10 rounds: 25.58 

Average global accuracy final 10 rounds: 24.75 

705.2268371582031
[1.5684213638305664, 2.2741830348968506, 2.9327003955841064, 3.5878875255584717, 4.253978490829468, 4.904184341430664, 5.563318967819214, 6.214963912963867, 6.8700408935546875, 7.524118661880493, 8.179750919342041, 8.835494995117188, 9.486039400100708, 10.142057180404663, 10.793936491012573, 11.492004871368408, 12.19209361076355, 12.888938426971436, 13.533768653869629, 14.180878400802612, 14.83008360862732, 15.4766104221344, 16.12620735168457, 16.774866104125977, 17.420987367630005, 18.066520929336548, 18.713846683502197, 19.362495183944702, 20.007952451705933, 20.65405035018921, 21.30358123779297, 21.955177307128906, 22.600054264068604, 23.256085634231567, 23.90210795402527, 24.550536394119263, 25.19718861579895, 25.84416961669922, 26.49132776260376, 27.218891143798828, 27.917251348495483, 28.619767665863037, 29.31535577774048, 30.01807713508606, 30.753180503845215, 31.456766605377197, 32.15838956832886, 32.86286401748657, 33.569790840148926, 34.27269721031189, 34.97683620452881, 35.6812264919281, 36.385347843170166, 37.09247136116028, 37.79363965988159, 38.49702787399292, 39.197442293167114, 39.90243196487427, 40.60630178451538, 41.34295320510864, 42.04306435585022, 42.74127554893494, 43.438905477523804, 44.14004898071289, 44.83829712867737, 45.53832244873047, 46.239912271499634, 46.941884994506836, 47.639427185058594, 48.36048698425293, 49.05790686607361, 49.75416302680969, 50.454694986343384, 51.14873123168945, 51.84574341773987, 52.54061198234558, 53.24006772041321, 53.93549180030823, 54.63361120223999, 55.33318114280701, 56.04026961326599, 56.73657155036926, 57.432133197784424, 58.12712788581848, 58.82624936103821, 59.5224130153656, 60.21738576889038, 60.913153648376465, 61.60801911354065, 62.30882143974304, 63.00480628013611, 63.703447103500366, 64.40697002410889, 65.11742687225342, 65.81817388534546, 66.51679801940918, 67.21696925163269, 67.91840767860413, 68.61552810668945, 69.31391167640686, 70.70367217063904]
[11.666666666666666, 12.033333333333333, 12.183333333333334, 12.5, 12.483333333333333, 12.6, 12.716666666666667, 12.7, 12.8, 12.983333333333333, 13.05, 13.25, 13.366666666666667, 13.333333333333334, 13.516666666666667, 13.566666666666666, 13.55, 13.633333333333333, 13.766666666666667, 13.883333333333333, 14.0, 14.233333333333333, 14.483333333333333, 14.8, 14.85, 15.0, 15.166666666666666, 15.283333333333333, 15.333333333333334, 15.35, 15.566666666666666, 15.75, 16.05, 16.166666666666668, 15.966666666666667, 15.966666666666667, 16.066666666666666, 16.15, 16.233333333333334, 16.366666666666667, 16.316666666666666, 16.55, 16.683333333333334, 16.9, 17.283333333333335, 17.45, 17.433333333333334, 17.8, 18.1, 18.233333333333334, 18.466666666666665, 18.683333333333334, 18.866666666666667, 19.233333333333334, 19.3, 19.383333333333333, 19.366666666666667, 19.483333333333334, 19.633333333333333, 19.7, 19.85, 20.083333333333332, 20.233333333333334, 20.166666666666668, 20.583333333333332, 20.85, 21.133333333333333, 21.533333333333335, 21.95, 22.316666666666666, 22.55, 22.75, 22.8, 22.983333333333334, 23.183333333333334, 23.5, 23.433333333333334, 24.233333333333334, 24.033333333333335, 24.066666666666666, 24.366666666666667, 24.316666666666666, 24.316666666666666, 24.566666666666666, 24.633333333333333, 24.666666666666668, 24.833333333333332, 24.95, 25.05, 25.066666666666666, 25.166666666666668, 25.25, 25.266666666666666, 25.633333333333333, 25.566666666666666, 25.433333333333334, 25.683333333333334, 25.766666666666666, 26.05, 25.983333333333334, 26.95]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 1, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.290, Test loss: 2.269, Test accuracy: 38.45 

Round   0, Global train loss: 2.290, Global test loss: 2.272, Global test accuracy: 34.45 

Round   1, Train loss: 2.121, Test loss: 2.064, Test accuracy: 48.35 

Round   1, Global train loss: 2.121, Global test loss: 2.093, Global test accuracy: 41.08 

Round   2, Train loss: 1.814, Test loss: 1.935, Test accuracy: 59.03 

Round   2, Global train loss: 1.814, Global test loss: 2.024, Global test accuracy: 47.32 

Round   3, Train loss: 1.675, Test loss: 1.835, Test accuracy: 67.35 

Round   3, Global train loss: 1.675, Global test loss: 2.034, Global test accuracy: 43.48 

Round   4, Train loss: 1.675, Test loss: 1.735, Test accuracy: 77.25 

Round   4, Global train loss: 1.675, Global test loss: 2.007, Global test accuracy: 48.30 

Round   5, Train loss: 1.690, Test loss: 1.702, Test accuracy: 77.93 

Round   5, Global train loss: 1.690, Global test loss: 2.036, Global test accuracy: 42.52 

Round   6, Train loss: 1.609, Test loss: 1.653, Test accuracy: 84.92 

Round   6, Global train loss: 1.609, Global test loss: 2.024, Global test accuracy: 43.37 

Round   7, Train loss: 1.641, Test loss: 1.645, Test accuracy: 83.17 

Round   7, Global train loss: 1.641, Global test loss: 2.037, Global test accuracy: 41.35 

Round   8, Train loss: 1.631, Test loss: 1.588, Test accuracy: 89.57 

Round   8, Global train loss: 1.631, Global test loss: 2.071, Global test accuracy: 36.38 

Round   9, Train loss: 1.491, Test loss: 1.588, Test accuracy: 89.10 

Round   9, Global train loss: 1.491, Global test loss: 2.001, Global test accuracy: 48.08 

Round  10, Train loss: 1.547, Test loss: 1.567, Test accuracy: 91.57 

Round  10, Global train loss: 1.547, Global test loss: 2.009, Global test accuracy: 45.40 

Round  11, Train loss: 1.538, Test loss: 1.564, Test accuracy: 91.57 

Round  11, Global train loss: 1.538, Global test loss: 2.044, Global test accuracy: 39.08 

Round  12, Train loss: 1.480, Test loss: 1.561, Test accuracy: 91.62 

Round  12, Global train loss: 1.480, Global test loss: 2.042, Global test accuracy: 40.55 

Round  13, Train loss: 1.485, Test loss: 1.557, Test accuracy: 91.82 

Round  13, Global train loss: 1.485, Global test loss: 2.018, Global test accuracy: 43.32 

Round  14, Train loss: 1.479, Test loss: 1.557, Test accuracy: 91.72 

Round  14, Global train loss: 1.479, Global test loss: 2.030, Global test accuracy: 42.80 

Round  15, Train loss: 1.479, Test loss: 1.555, Test accuracy: 91.77 

Round  15, Global train loss: 1.479, Global test loss: 2.007, Global test accuracy: 46.67 

Round  16, Train loss: 1.477, Test loss: 1.551, Test accuracy: 92.00 

Round  16, Global train loss: 1.477, Global test loss: 2.027, Global test accuracy: 41.33 

Round  17, Train loss: 1.470, Test loss: 1.551, Test accuracy: 92.03 

Round  17, Global train loss: 1.470, Global test loss: 2.005, Global test accuracy: 44.73 

Round  18, Train loss: 1.526, Test loss: 1.550, Test accuracy: 92.07 

Round  18, Global train loss: 1.526, Global test loss: 2.018, Global test accuracy: 43.38 

Round  19, Train loss: 1.522, Test loss: 1.550, Test accuracy: 92.08 

Round  19, Global train loss: 1.522, Global test loss: 2.014, Global test accuracy: 42.77 

Round  20, Train loss: 1.482, Test loss: 1.547, Test accuracy: 92.07 

Round  20, Global train loss: 1.482, Global test loss: 2.039, Global test accuracy: 39.57 

Round  21, Train loss: 1.466, Test loss: 1.547, Test accuracy: 92.12 

Round  21, Global train loss: 1.466, Global test loss: 1.994, Global test accuracy: 46.67 

Round  22, Train loss: 1.527, Test loss: 1.546, Test accuracy: 92.17 

Round  22, Global train loss: 1.527, Global test loss: 2.040, Global test accuracy: 39.53 

Round  23, Train loss: 1.472, Test loss: 1.546, Test accuracy: 92.15 

Round  23, Global train loss: 1.472, Global test loss: 2.047, Global test accuracy: 41.32 

Round  24, Train loss: 1.525, Test loss: 1.546, Test accuracy: 92.10 

Round  24, Global train loss: 1.525, Global test loss: 1.993, Global test accuracy: 47.27 

Round  25, Train loss: 1.575, Test loss: 1.545, Test accuracy: 92.17 

Round  25, Global train loss: 1.575, Global test loss: 2.002, Global test accuracy: 45.90 

Round  26, Train loss: 1.521, Test loss: 1.545, Test accuracy: 92.22 

Round  26, Global train loss: 1.521, Global test loss: 2.016, Global test accuracy: 44.27 

Round  27, Train loss: 1.558, Test loss: 1.531, Test accuracy: 93.67 

Round  27, Global train loss: 1.558, Global test loss: 1.999, Global test accuracy: 47.75 

Round  28, Train loss: 1.471, Test loss: 1.529, Test accuracy: 93.80 

Round  28, Global train loss: 1.471, Global test loss: 2.006, Global test accuracy: 43.83 

Round  29, Train loss: 1.470, Test loss: 1.529, Test accuracy: 93.82 

Round  29, Global train loss: 1.470, Global test loss: 2.088, Global test accuracy: 34.38 

Round  30, Train loss: 1.465, Test loss: 1.529, Test accuracy: 93.80 

Round  30, Global train loss: 1.465, Global test loss: 2.002, Global test accuracy: 44.65 

Round  31, Train loss: 1.471, Test loss: 1.529, Test accuracy: 93.88 

Round  31, Global train loss: 1.471, Global test loss: 2.060, Global test accuracy: 38.20 

Round  32, Train loss: 1.478, Test loss: 1.516, Test accuracy: 95.28 

Round  32, Global train loss: 1.478, Global test loss: 2.021, Global test accuracy: 43.22 

Round  33, Train loss: 1.468, Test loss: 1.515, Test accuracy: 95.27 

Round  33, Global train loss: 1.468, Global test loss: 2.037, Global test accuracy: 41.23 

Round  34, Train loss: 1.466, Test loss: 1.515, Test accuracy: 95.25 

Round  34, Global train loss: 1.466, Global test loss: 2.003, Global test accuracy: 44.63 

Round  35, Train loss: 1.467, Test loss: 1.515, Test accuracy: 95.27 

Round  35, Global train loss: 1.467, Global test loss: 2.051, Global test accuracy: 39.22 

Round  36, Train loss: 1.470, Test loss: 1.515, Test accuracy: 95.27 

Round  36, Global train loss: 1.470, Global test loss: 2.013, Global test accuracy: 43.77 

Round  37, Train loss: 1.466, Test loss: 1.515, Test accuracy: 95.25 

Round  37, Global train loss: 1.466, Global test loss: 2.039, Global test accuracy: 40.85 

Round  38, Train loss: 1.463, Test loss: 1.515, Test accuracy: 95.25 

Round  38, Global train loss: 1.463, Global test loss: 2.022, Global test accuracy: 43.83 

Round  39, Train loss: 1.466, Test loss: 1.515, Test accuracy: 95.23 

Round  39, Global train loss: 1.466, Global test loss: 2.045, Global test accuracy: 41.77 

Round  40, Train loss: 1.464, Test loss: 1.515, Test accuracy: 95.23 

Round  40, Global train loss: 1.464, Global test loss: 2.009, Global test accuracy: 44.93 

Round  41, Train loss: 1.465, Test loss: 1.514, Test accuracy: 95.25 

Round  41, Global train loss: 1.465, Global test loss: 2.011, Global test accuracy: 45.23 

Round  42, Train loss: 1.466, Test loss: 1.514, Test accuracy: 95.22 

Round  42, Global train loss: 1.466, Global test loss: 2.005, Global test accuracy: 44.73 

Round  43, Train loss: 1.463, Test loss: 1.514, Test accuracy: 95.22 

Round  43, Global train loss: 1.463, Global test loss: 2.054, Global test accuracy: 40.47 

Round  44, Train loss: 1.466, Test loss: 1.514, Test accuracy: 95.18 

Round  44, Global train loss: 1.466, Global test loss: 1.995, Global test accuracy: 47.05 

Round  45, Train loss: 1.464, Test loss: 1.514, Test accuracy: 95.22 

Round  45, Global train loss: 1.464, Global test loss: 2.007, Global test accuracy: 44.17 

Round  46, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.23 

Round  46, Global train loss: 1.465, Global test loss: 2.027, Global test accuracy: 42.33 

Round  47, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.27 

Round  47, Global train loss: 1.465, Global test loss: 2.016, Global test accuracy: 42.73 

Round  48, Train loss: 1.468, Test loss: 1.513, Test accuracy: 95.25 

Round  48, Global train loss: 1.468, Global test loss: 2.065, Global test accuracy: 36.85 

Round  49, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.25 

Round  49, Global train loss: 1.464, Global test loss: 2.010, Global test accuracy: 44.43 

Round  50, Train loss: 1.467, Test loss: 1.513, Test accuracy: 95.25 

Round  50, Global train loss: 1.467, Global test loss: 2.020, Global test accuracy: 44.37 

Round  51, Train loss: 1.463, Test loss: 1.513, Test accuracy: 95.25 

Round  51, Global train loss: 1.463, Global test loss: 2.062, Global test accuracy: 38.48 

Round  52, Train loss: 1.462, Test loss: 1.513, Test accuracy: 95.25 

Round  52, Global train loss: 1.462, Global test loss: 2.000, Global test accuracy: 46.25 

Round  53, Train loss: 1.469, Test loss: 1.513, Test accuracy: 95.25 

Round  53, Global train loss: 1.469, Global test loss: 2.023, Global test accuracy: 43.03 

Round  54, Train loss: 1.463, Test loss: 1.513, Test accuracy: 95.23 

Round  54, Global train loss: 1.463, Global test loss: 2.044, Global test accuracy: 40.35 

Round  55, Train loss: 1.466, Test loss: 1.513, Test accuracy: 95.23 

Round  55, Global train loss: 1.466, Global test loss: 2.014, Global test accuracy: 43.43 

Round  56, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.23 

Round  56, Global train loss: 1.465, Global test loss: 1.997, Global test accuracy: 47.67 

Round  57, Train loss: 1.463, Test loss: 1.513, Test accuracy: 95.23 

Round  57, Global train loss: 1.463, Global test loss: 2.012, Global test accuracy: 44.62 

Round  58, Train loss: 1.466, Test loss: 1.513, Test accuracy: 95.22 

Round  58, Global train loss: 1.466, Global test loss: 2.008, Global test accuracy: 44.42 

Round  59, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.22 

Round  59, Global train loss: 1.465, Global test loss: 2.001, Global test accuracy: 44.73 

Round  60, Train loss: 1.467, Test loss: 1.513, Test accuracy: 95.22 

Round  60, Global train loss: 1.467, Global test loss: 2.056, Global test accuracy: 39.05 

Round  61, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.22 

Round  61, Global train loss: 1.464, Global test loss: 2.000, Global test accuracy: 45.63 

Round  62, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.22 

Round  62, Global train loss: 1.465, Global test loss: 2.018, Global test accuracy: 43.72 

Round  63, Train loss: 1.462, Test loss: 1.513, Test accuracy: 95.22 

Round  63, Global train loss: 1.462, Global test loss: 2.063, Global test accuracy: 38.33 

Round  64, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.22 

Round  64, Global train loss: 1.464, Global test loss: 1.988, Global test accuracy: 47.07 

Round  65, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.22 

Round  65, Global train loss: 1.464, Global test loss: 1.998, Global test accuracy: 46.05 

Round  66, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.22 

Round  66, Global train loss: 1.464, Global test loss: 2.023, Global test accuracy: 42.80 

Round  67, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.22 

Round  67, Global train loss: 1.464, Global test loss: 2.069, Global test accuracy: 37.80 

Round  68, Train loss: 1.466, Test loss: 1.513, Test accuracy: 95.22 

Round  68, Global train loss: 1.466, Global test loss: 2.006, Global test accuracy: 45.15 

Round  69, Train loss: 1.468, Test loss: 1.512, Test accuracy: 95.23 

Round  69, Global train loss: 1.468, Global test loss: 2.022, Global test accuracy: 42.10 

Round  70, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.23 

Round  70, Global train loss: 1.464, Global test loss: 2.012, Global test accuracy: 43.42 

Round  71, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.23 

Round  71, Global train loss: 1.465, Global test loss: 2.048, Global test accuracy: 39.53 

Round  72, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.23 

Round  72, Global train loss: 1.464, Global test loss: 2.016, Global test accuracy: 43.32 

Round  73, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.22 

Round  73, Global train loss: 1.465, Global test loss: 2.013, Global test accuracy: 43.43 

Round  74, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.22 

Round  74, Global train loss: 1.465, Global test loss: 2.020, Global test accuracy: 43.40 

Round  75, Train loss: 1.462, Test loss: 1.512, Test accuracy: 95.22 

Round  75, Global train loss: 1.462, Global test loss: 2.022, Global test accuracy: 42.80 

Round  76, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.22 

Round  76, Global train loss: 1.463, Global test loss: 2.012, Global test accuracy: 43.55 

Round  77, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.23 

Round  77, Global train loss: 1.465, Global test loss: 2.062, Global test accuracy: 38.20 

Round  78, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.23 

Round  78, Global train loss: 1.463, Global test loss: 2.027, Global test accuracy: 41.82 

Round  79, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.23 

Round  79, Global train loss: 1.464, Global test loss: 1.991, Global test accuracy: 46.87 

Round  80, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.23 

Round  80, Global train loss: 1.463, Global test loss: 2.006, Global test accuracy: 45.33 

Round  81, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.25 

Round  81, Global train loss: 1.466, Global test loss: 2.008, Global test accuracy: 44.32 

Round  82, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.25 

Round  82, Global train loss: 1.465, Global test loss: 2.015, Global test accuracy: 45.07 

Round  83, Train loss: 1.467, Test loss: 1.512, Test accuracy: 95.25 

Round  83, Global train loss: 1.467, Global test loss: 2.003, Global test accuracy: 45.55 

Round  84, Train loss: 1.467, Test loss: 1.512, Test accuracy: 95.25 

Round  84, Global train loss: 1.467, Global test loss: 2.058, Global test accuracy: 38.30 

Round  85, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.25 

Round  85, Global train loss: 1.463, Global test loss: 1.987, Global test accuracy: 47.60 

Round  86, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.25 

Round  86, Global train loss: 1.465, Global test loss: 2.021, Global test accuracy: 41.88 

Round  87, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.25 

Round  87, Global train loss: 1.465, Global test loss: 2.040, Global test accuracy: 39.38 

Round  88, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.25 

Round  88, Global train loss: 1.463, Global test loss: 2.027, Global test accuracy: 42.20 

Round  89, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.25 

Round  89, Global train loss: 1.463, Global test loss: 2.031, Global test accuracy: 41.75 

Round  90, Train loss: 1.461, Test loss: 1.512, Test accuracy: 95.25 

Round  90, Global train loss: 1.461, Global test loss: 2.004, Global test accuracy: 44.90 

Round  91, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.25 

Round  91, Global train loss: 1.464, Global test loss: 2.008, Global test accuracy: 44.20 

Round  92, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.25 

Round  92, Global train loss: 1.464, Global test loss: 2.015, Global test accuracy: 44.73 

Round  93, Train loss: 1.468, Test loss: 1.512, Test accuracy: 95.23 

Round  93, Global train loss: 1.468, Global test loss: 2.016, Global test accuracy: 46.08 

Round  94, Train loss: 1.467, Test loss: 1.512, Test accuracy: 95.23 

Round  94, Global train loss: 1.467, Global test loss: 2.005, Global test accuracy: 44.80 

Round  95, Train loss: 1.461, Test loss: 1.512, Test accuracy: 95.23 

Round  95, Global train loss: 1.461, Global test loss: 2.016, Global test accuracy: 43.30 

Round  96, Train loss: 1.467, Test loss: 1.512, Test accuracy: 95.25 

Round  96, Global train loss: 1.467, Global test loss: 2.014, Global test accuracy: 44.88 

Round  97, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.25 

Round  97, Global train loss: 1.466, Global test loss: 2.035, Global test accuracy: 42.13 

Round  98, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.25 

Round  98, Global train loss: 1.463, Global test loss: 2.000, Global test accuracy: 45.32 

Round  99, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.25 

Round  99, Global train loss: 1.463, Global test loss: 2.006, Global test accuracy: 44.68 

Final Round, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.27 

Final Round, Global train loss: 1.464, Global test loss: 2.006, Global test accuracy: 44.68 

Average accuracy final 10 rounds: 95.24500000000002 

Average global accuracy final 10 rounds: 44.50333333333334 

667.908385515213
[1.481550693511963, 2.0771851539611816, 2.6683051586151123, 3.262648582458496, 3.856213092803955, 4.461967706680298, 5.053958415985107, 5.649006366729736, 6.243164300918579, 6.836046934127808, 7.425554513931274, 8.021260261535645, 8.613493919372559, 9.207539081573486, 9.80269193649292, 10.398928165435791, 10.993109703063965, 11.58839464187622, 12.182575464248657, 12.780489206314087, 13.381032705307007, 13.979819297790527, 14.574647903442383, 15.169414043426514, 15.765783786773682, 16.364139080047607, 16.95958113670349, 17.551374197006226, 18.144778966903687, 18.736606121063232, 19.329543590545654, 19.923501014709473, 20.51628041267395, 21.1093807220459, 21.69668412208557, 22.2952983379364, 22.890774250030518, 23.49159336090088, 24.08429479598999, 24.678874492645264, 25.275117874145508, 25.874917030334473, 26.46993637084961, 27.064975261688232, 27.660791635513306, 28.25618886947632, 28.852454900741577, 29.454137325286865, 30.044594049453735, 30.637819051742554, 31.247740745544434, 31.84394121170044, 32.43666124343872, 33.034483432769775, 33.62932085990906, 34.22256684303284, 34.821645736694336, 35.41973066329956, 36.01589846611023, 36.61052083969116, 37.209078311920166, 37.80488085746765, 38.3992702960968, 38.995020389556885, 39.590476751327515, 40.18657636642456, 40.78055143356323, 41.37370800971985, 41.96772861480713, 42.570834159851074, 43.16510558128357, 43.76164150238037, 44.354737520217896, 44.954036712646484, 45.55049419403076, 46.157628297805786, 46.75473976135254, 47.352911949157715, 47.94767427444458, 48.54633569717407, 49.12929344177246, 49.711283683776855, 50.309797286987305, 50.90628004074097, 51.501439571380615, 52.09660458564758, 52.690306663513184, 53.28831648826599, 53.88562226295471, 54.4787163734436, 55.073237657547, 55.667625188827515, 56.264387369155884, 56.857388734817505, 57.45592999458313, 58.05385732650757, 58.655622720718384, 59.253167152404785, 59.85279560089111, 60.44906687736511, 61.63977670669556]
[38.45, 48.35, 59.03333333333333, 67.35, 77.25, 77.93333333333334, 84.91666666666667, 83.16666666666667, 89.56666666666666, 89.1, 91.56666666666666, 91.56666666666666, 91.61666666666666, 91.81666666666666, 91.71666666666667, 91.76666666666667, 92.0, 92.03333333333333, 92.06666666666666, 92.08333333333333, 92.06666666666666, 92.11666666666666, 92.16666666666667, 92.15, 92.1, 92.16666666666667, 92.21666666666667, 93.66666666666667, 93.8, 93.81666666666666, 93.8, 93.88333333333334, 95.28333333333333, 95.26666666666667, 95.25, 95.26666666666667, 95.26666666666667, 95.25, 95.25, 95.23333333333333, 95.23333333333333, 95.25, 95.21666666666667, 95.21666666666667, 95.18333333333334, 95.21666666666667, 95.23333333333333, 95.26666666666667, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.21666666666667, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.25, 95.23333333333333, 95.23333333333333, 95.23333333333333, 95.25, 95.25, 95.25, 95.25, 95.26666666666667]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 3, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.295, Test loss: 2.284, Test accuracy: 44.00 

Round   0, Global train loss: 2.295, Global test loss: 2.286, Global test accuracy: 33.80 

Round   1, Train loss: 2.207, Test loss: 2.128, Test accuracy: 40.52 

Round   1, Global train loss: 2.207, Global test loss: 2.124, Global test accuracy: 33.33 

Round   2, Train loss: 1.941, Test loss: 2.004, Test accuracy: 53.10 

Round   2, Global train loss: 1.941, Global test loss: 2.054, Global test accuracy: 40.20 

Round   3, Train loss: 1.771, Test loss: 1.868, Test accuracy: 67.98 

Round   3, Global train loss: 1.771, Global test loss: 2.031, Global test accuracy: 41.90 

Round   4, Train loss: 1.702, Test loss: 1.778, Test accuracy: 75.00 

Round   4, Global train loss: 1.702, Global test loss: 2.025, Global test accuracy: 42.02 

Round   5, Train loss: 1.776, Test loss: 1.766, Test accuracy: 76.10 

Round   5, Global train loss: 1.776, Global test loss: 2.012, Global test accuracy: 44.05 

Round   6, Train loss: 1.614, Test loss: 1.734, Test accuracy: 79.15 

Round   6, Global train loss: 1.614, Global test loss: 1.995, Global test accuracy: 47.03 

Round   7, Train loss: 1.735, Test loss: 1.691, Test accuracy: 79.63 

Round   7, Global train loss: 1.735, Global test loss: 2.010, Global test accuracy: 45.07 

Round   8, Train loss: 1.731, Test loss: 1.700, Test accuracy: 78.43 

Round   8, Global train loss: 1.731, Global test loss: 2.000, Global test accuracy: 45.17 

Round   9, Train loss: 1.736, Test loss: 1.699, Test accuracy: 78.52 

Round   9, Global train loss: 1.736, Global test loss: 1.984, Global test accuracy: 47.53 

Round  10, Train loss: 1.630, Test loss: 1.690, Test accuracy: 79.30 

Round  10, Global train loss: 1.630, Global test loss: 1.983, Global test accuracy: 47.38 

Round  11, Train loss: 1.716, Test loss: 1.689, Test accuracy: 79.47 

Round  11, Global train loss: 1.716, Global test loss: 1.995, Global test accuracy: 45.98 

Round  12, Train loss: 1.706, Test loss: 1.659, Test accuracy: 82.37 

Round  12, Global train loss: 1.706, Global test loss: 2.000, Global test accuracy: 45.32 

Round  13, Train loss: 1.555, Test loss: 1.641, Test accuracy: 83.63 

Round  13, Global train loss: 1.555, Global test loss: 2.032, Global test accuracy: 41.87 

Round  14, Train loss: 1.756, Test loss: 1.641, Test accuracy: 83.53 

Round  14, Global train loss: 1.756, Global test loss: 1.989, Global test accuracy: 46.50 

Round  15, Train loss: 1.620, Test loss: 1.641, Test accuracy: 83.50 

Round  15, Global train loss: 1.620, Global test loss: 1.985, Global test accuracy: 46.77 

Round  16, Train loss: 1.581, Test loss: 1.630, Test accuracy: 83.52 

Round  16, Global train loss: 1.581, Global test loss: 2.007, Global test accuracy: 44.60 

Round  17, Train loss: 1.617, Test loss: 1.629, Test accuracy: 83.73 

Round  17, Global train loss: 1.617, Global test loss: 2.015, Global test accuracy: 43.28 

Round  18, Train loss: 1.658, Test loss: 1.629, Test accuracy: 83.65 

Round  18, Global train loss: 1.658, Global test loss: 1.982, Global test accuracy: 47.78 

Round  19, Train loss: 1.518, Test loss: 1.629, Test accuracy: 83.73 

Round  19, Global train loss: 1.518, Global test loss: 1.995, Global test accuracy: 45.68 

Round  20, Train loss: 1.654, Test loss: 1.631, Test accuracy: 83.50 

Round  20, Global train loss: 1.654, Global test loss: 1.969, Global test accuracy: 49.10 

Round  21, Train loss: 1.562, Test loss: 1.629, Test accuracy: 83.72 

Round  21, Global train loss: 1.562, Global test loss: 1.951, Global test accuracy: 51.02 

Round  22, Train loss: 1.524, Test loss: 1.613, Test accuracy: 85.40 

Round  22, Global train loss: 1.524, Global test loss: 1.973, Global test accuracy: 48.12 

Round  23, Train loss: 1.609, Test loss: 1.611, Test accuracy: 85.55 

Round  23, Global train loss: 1.609, Global test loss: 1.962, Global test accuracy: 49.53 

Round  24, Train loss: 1.552, Test loss: 1.611, Test accuracy: 85.57 

Round  24, Global train loss: 1.552, Global test loss: 1.954, Global test accuracy: 50.48 

Round  25, Train loss: 1.669, Test loss: 1.598, Test accuracy: 86.83 

Round  25, Global train loss: 1.669, Global test loss: 1.956, Global test accuracy: 50.20 

Round  26, Train loss: 1.649, Test loss: 1.596, Test accuracy: 87.12 

Round  26, Global train loss: 1.649, Global test loss: 1.964, Global test accuracy: 49.57 

Round  27, Train loss: 1.549, Test loss: 1.582, Test accuracy: 88.48 

Round  27, Global train loss: 1.549, Global test loss: 1.956, Global test accuracy: 50.62 

Round  28, Train loss: 1.514, Test loss: 1.581, Test accuracy: 88.25 

Round  28, Global train loss: 1.514, Global test loss: 1.949, Global test accuracy: 51.25 

Round  29, Train loss: 1.587, Test loss: 1.581, Test accuracy: 88.42 

Round  29, Global train loss: 1.587, Global test loss: 1.955, Global test accuracy: 50.00 

Round  30, Train loss: 1.549, Test loss: 1.581, Test accuracy: 88.45 

Round  30, Global train loss: 1.549, Global test loss: 1.962, Global test accuracy: 49.38 

Round  31, Train loss: 1.571, Test loss: 1.567, Test accuracy: 89.98 

Round  31, Global train loss: 1.571, Global test loss: 1.999, Global test accuracy: 45.70 

Round  32, Train loss: 1.617, Test loss: 1.584, Test accuracy: 88.03 

Round  32, Global train loss: 1.617, Global test loss: 1.960, Global test accuracy: 49.63 

Round  33, Train loss: 1.622, Test loss: 1.598, Test accuracy: 86.67 

Round  33, Global train loss: 1.622, Global test loss: 1.940, Global test accuracy: 51.93 

Round  34, Train loss: 1.538, Test loss: 1.584, Test accuracy: 88.08 

Round  34, Global train loss: 1.538, Global test loss: 1.938, Global test accuracy: 51.67 

Round  35, Train loss: 1.541, Test loss: 1.583, Test accuracy: 88.27 

Round  35, Global train loss: 1.541, Global test loss: 1.951, Global test accuracy: 50.38 

Round  36, Train loss: 1.550, Test loss: 1.581, Test accuracy: 88.48 

Round  36, Global train loss: 1.550, Global test loss: 1.962, Global test accuracy: 49.68 

Round  37, Train loss: 1.514, Test loss: 1.579, Test accuracy: 88.63 

Round  37, Global train loss: 1.514, Global test loss: 1.960, Global test accuracy: 49.98 

Round  38, Train loss: 1.486, Test loss: 1.563, Test accuracy: 90.18 

Round  38, Global train loss: 1.486, Global test loss: 1.957, Global test accuracy: 49.78 

Round  39, Train loss: 1.534, Test loss: 1.563, Test accuracy: 90.23 

Round  39, Global train loss: 1.534, Global test loss: 1.978, Global test accuracy: 47.28 

Round  40, Train loss: 1.624, Test loss: 1.579, Test accuracy: 88.58 

Round  40, Global train loss: 1.624, Global test loss: 1.950, Global test accuracy: 50.40 

Round  41, Train loss: 1.540, Test loss: 1.592, Test accuracy: 87.20 

Round  41, Global train loss: 1.540, Global test loss: 1.956, Global test accuracy: 50.25 

Round  42, Train loss: 1.581, Test loss: 1.593, Test accuracy: 87.15 

Round  42, Global train loss: 1.581, Global test loss: 1.936, Global test accuracy: 52.28 

Round  43, Train loss: 1.640, Test loss: 1.578, Test accuracy: 88.67 

Round  43, Global train loss: 1.640, Global test loss: 1.942, Global test accuracy: 51.37 

Round  44, Train loss: 1.482, Test loss: 1.578, Test accuracy: 88.72 

Round  44, Global train loss: 1.482, Global test loss: 1.930, Global test accuracy: 52.83 

Round  45, Train loss: 1.541, Test loss: 1.577, Test accuracy: 88.83 

Round  45, Global train loss: 1.541, Global test loss: 1.952, Global test accuracy: 50.18 

Round  46, Train loss: 1.560, Test loss: 1.577, Test accuracy: 88.95 

Round  46, Global train loss: 1.560, Global test loss: 1.952, Global test accuracy: 50.72 

Round  47, Train loss: 1.535, Test loss: 1.577, Test accuracy: 88.85 

Round  47, Global train loss: 1.535, Global test loss: 1.957, Global test accuracy: 49.88 

Round  48, Train loss: 1.521, Test loss: 1.561, Test accuracy: 90.28 

Round  48, Global train loss: 1.521, Global test loss: 1.949, Global test accuracy: 51.47 

Round  49, Train loss: 1.592, Test loss: 1.554, Test accuracy: 91.00 

Round  49, Global train loss: 1.592, Global test loss: 1.945, Global test accuracy: 50.97 

Round  50, Train loss: 1.487, Test loss: 1.553, Test accuracy: 91.05 

Round  50, Global train loss: 1.487, Global test loss: 1.952, Global test accuracy: 50.42 

Round  51, Train loss: 1.538, Test loss: 1.551, Test accuracy: 91.30 

Round  51, Global train loss: 1.538, Global test loss: 1.966, Global test accuracy: 48.97 

Round  52, Train loss: 1.536, Test loss: 1.566, Test accuracy: 89.65 

Round  52, Global train loss: 1.536, Global test loss: 1.971, Global test accuracy: 48.37 

Round  53, Train loss: 1.587, Test loss: 1.576, Test accuracy: 88.70 

Round  53, Global train loss: 1.587, Global test loss: 1.991, Global test accuracy: 46.08 

Round  54, Train loss: 1.538, Test loss: 1.592, Test accuracy: 87.17 

Round  54, Global train loss: 1.538, Global test loss: 1.933, Global test accuracy: 52.53 

Round  55, Train loss: 1.591, Test loss: 1.593, Test accuracy: 87.00 

Round  55, Global train loss: 1.591, Global test loss: 1.954, Global test accuracy: 50.10 

Round  56, Train loss: 1.667, Test loss: 1.579, Test accuracy: 88.45 

Round  56, Global train loss: 1.667, Global test loss: 1.962, Global test accuracy: 49.35 

Round  57, Train loss: 1.537, Test loss: 1.578, Test accuracy: 88.55 

Round  57, Global train loss: 1.537, Global test loss: 1.955, Global test accuracy: 50.28 

Round  58, Train loss: 1.580, Test loss: 1.577, Test accuracy: 88.53 

Round  58, Global train loss: 1.580, Global test loss: 1.971, Global test accuracy: 48.65 

Round  59, Train loss: 1.579, Test loss: 1.566, Test accuracy: 89.70 

Round  59, Global train loss: 1.579, Global test loss: 1.956, Global test accuracy: 50.53 

Round  60, Train loss: 1.599, Test loss: 1.564, Test accuracy: 89.92 

Round  60, Global train loss: 1.599, Global test loss: 1.963, Global test accuracy: 49.05 

Round  61, Train loss: 1.597, Test loss: 1.577, Test accuracy: 88.55 

Round  61, Global train loss: 1.597, Global test loss: 1.948, Global test accuracy: 50.87 

Round  62, Train loss: 1.583, Test loss: 1.577, Test accuracy: 88.67 

Round  62, Global train loss: 1.583, Global test loss: 1.970, Global test accuracy: 48.42 

Round  63, Train loss: 1.533, Test loss: 1.576, Test accuracy: 88.72 

Round  63, Global train loss: 1.533, Global test loss: 1.960, Global test accuracy: 49.45 

Round  64, Train loss: 1.535, Test loss: 1.591, Test accuracy: 87.22 

Round  64, Global train loss: 1.535, Global test loss: 1.951, Global test accuracy: 50.32 

Round  65, Train loss: 1.531, Test loss: 1.593, Test accuracy: 87.03 

Round  65, Global train loss: 1.531, Global test loss: 1.941, Global test accuracy: 51.32 

Round  66, Train loss: 1.509, Test loss: 1.577, Test accuracy: 88.78 

Round  66, Global train loss: 1.509, Global test loss: 1.955, Global test accuracy: 50.13 

Round  67, Train loss: 1.533, Test loss: 1.578, Test accuracy: 88.67 

Round  67, Global train loss: 1.533, Global test loss: 1.948, Global test accuracy: 51.02 

Round  68, Train loss: 1.565, Test loss: 1.563, Test accuracy: 90.18 

Round  68, Global train loss: 1.565, Global test loss: 1.952, Global test accuracy: 50.15 

Round  69, Train loss: 1.536, Test loss: 1.564, Test accuracy: 89.88 

Round  69, Global train loss: 1.536, Global test loss: 1.942, Global test accuracy: 51.80 

Round  70, Train loss: 1.509, Test loss: 1.534, Test accuracy: 92.93 

Round  70, Global train loss: 1.509, Global test loss: 1.949, Global test accuracy: 51.17 

Round  71, Train loss: 1.566, Test loss: 1.533, Test accuracy: 93.03 

Round  71, Global train loss: 1.566, Global test loss: 1.974, Global test accuracy: 48.35 

Round  72, Train loss: 1.498, Test loss: 1.532, Test accuracy: 93.25 

Round  72, Global train loss: 1.498, Global test loss: 1.940, Global test accuracy: 51.87 

Round  73, Train loss: 1.487, Test loss: 1.533, Test accuracy: 93.02 

Round  73, Global train loss: 1.487, Global test loss: 1.939, Global test accuracy: 51.82 

Round  74, Train loss: 1.498, Test loss: 1.532, Test accuracy: 93.27 

Round  74, Global train loss: 1.498, Global test loss: 1.944, Global test accuracy: 50.77 

Round  75, Train loss: 1.489, Test loss: 1.533, Test accuracy: 93.32 

Round  75, Global train loss: 1.489, Global test loss: 1.956, Global test accuracy: 48.72 

Round  76, Train loss: 1.498, Test loss: 1.532, Test accuracy: 93.32 

Round  76, Global train loss: 1.498, Global test loss: 1.947, Global test accuracy: 51.57 

Round  77, Train loss: 1.534, Test loss: 1.518, Test accuracy: 94.67 

Round  77, Global train loss: 1.534, Global test loss: 1.957, Global test accuracy: 50.08 

Round  78, Train loss: 1.527, Test loss: 1.534, Test accuracy: 93.02 

Round  78, Global train loss: 1.527, Global test loss: 1.949, Global test accuracy: 50.68 

Round  79, Train loss: 1.500, Test loss: 1.535, Test accuracy: 92.85 

Round  79, Global train loss: 1.500, Global test loss: 1.948, Global test accuracy: 51.08 

Round  80, Train loss: 1.498, Test loss: 1.537, Test accuracy: 92.77 

Round  80, Global train loss: 1.498, Global test loss: 1.972, Global test accuracy: 48.30 

Round  81, Train loss: 1.586, Test loss: 1.568, Test accuracy: 89.62 

Round  81, Global train loss: 1.586, Global test loss: 1.945, Global test accuracy: 51.42 

Round  82, Train loss: 1.542, Test loss: 1.567, Test accuracy: 89.68 

Round  82, Global train loss: 1.542, Global test loss: 1.973, Global test accuracy: 48.68 

Round  83, Train loss: 1.502, Test loss: 1.568, Test accuracy: 89.72 

Round  83, Global train loss: 1.502, Global test loss: 1.944, Global test accuracy: 51.57 

Round  84, Train loss: 1.485, Test loss: 1.565, Test accuracy: 89.95 

Round  84, Global train loss: 1.485, Global test loss: 1.940, Global test accuracy: 51.90 

Round  85, Train loss: 1.516, Test loss: 1.551, Test accuracy: 91.32 

Round  85, Global train loss: 1.516, Global test loss: 1.953, Global test accuracy: 50.40 

Round  86, Train loss: 1.477, Test loss: 1.535, Test accuracy: 92.97 

Round  86, Global train loss: 1.477, Global test loss: 1.936, Global test accuracy: 52.35 

Round  87, Train loss: 1.530, Test loss: 1.519, Test accuracy: 94.53 

Round  87, Global train loss: 1.530, Global test loss: 1.927, Global test accuracy: 53.10 

Round  88, Train loss: 1.494, Test loss: 1.520, Test accuracy: 94.37 

Round  88, Global train loss: 1.494, Global test loss: 1.934, Global test accuracy: 52.63 

Round  89, Train loss: 1.493, Test loss: 1.520, Test accuracy: 94.47 

Round  89, Global train loss: 1.493, Global test loss: 1.948, Global test accuracy: 50.73 

Round  90, Train loss: 1.479, Test loss: 1.519, Test accuracy: 94.47 

Round  90, Global train loss: 1.479, Global test loss: 1.944, Global test accuracy: 51.35 

Round  91, Train loss: 1.526, Test loss: 1.534, Test accuracy: 93.10 

Round  91, Global train loss: 1.526, Global test loss: 1.947, Global test accuracy: 50.65 

Round  92, Train loss: 1.490, Test loss: 1.532, Test accuracy: 93.17 

Round  92, Global train loss: 1.490, Global test loss: 1.948, Global test accuracy: 50.60 

Round  93, Train loss: 1.588, Test loss: 1.548, Test accuracy: 91.43 

Round  93, Global train loss: 1.588, Global test loss: 1.941, Global test accuracy: 51.57 

Round  94, Train loss: 1.597, Test loss: 1.549, Test accuracy: 91.38 

Round  94, Global train loss: 1.597, Global test loss: 1.958, Global test accuracy: 49.77 

Round  95, Train loss: 1.531, Test loss: 1.548, Test accuracy: 91.50 

Round  95, Global train loss: 1.531, Global test loss: 1.960, Global test accuracy: 48.95 

Round  96, Train loss: 1.529, Test loss: 1.566, Test accuracy: 89.73 

Round  96, Global train loss: 1.529, Global test loss: 1.948, Global test accuracy: 51.15 

Round  97, Train loss: 1.476, Test loss: 1.567, Test accuracy: 89.62 

Round  97, Global train loss: 1.476, Global test loss: 1.976, Global test accuracy: 47.52 

Round  98, Train loss: 1.561, Test loss: 1.567, Test accuracy: 89.52 

Round  98, Global train loss: 1.561, Global test loss: 1.957, Global test accuracy: 49.73 

Round  99, Train loss: 1.474, Test loss: 1.566, Test accuracy: 89.78 

Round  99, Global train loss: 1.474, Global test loss: 1.927, Global test accuracy: 53.07 

Final Round, Train loss: 1.475, Test loss: 1.520, Test accuracy: 94.40 

Final Round, Global train loss: 1.475, Global test loss: 1.927, Global test accuracy: 53.07 

Average accuracy final 10 rounds: 91.37 

Average global accuracy final 10 rounds: 50.435 

612.8691735267639
[1.4993646144866943, 2.064971446990967, 2.64017391204834, 3.2365331649780273, 3.834321975708008, 4.436038494110107, 5.035754203796387, 5.6339194774627686, 6.234644174575806, 6.833832263946533, 7.4291276931762695, 8.026156425476074, 8.621187686920166, 9.218892812728882, 9.813844680786133, 10.412234783172607, 11.009934425354004, 11.607101917266846, 12.204060316085815, 12.804028511047363, 13.403506755828857, 14.002002239227295, 14.601310968399048, 15.203056573867798, 15.805071830749512, 16.402451276779175, 17.00179386138916, 17.59722399711609, 18.192782402038574, 18.78941583633423, 19.386934995651245, 19.98283863067627, 20.57996702194214, 21.17522358894348, 21.775349855422974, 22.370748281478882, 22.964365482330322, 23.56256937980652, 24.020461082458496, 24.47508716583252, 24.930250644683838, 25.386528491973877, 25.8420250415802, 26.296687364578247, 26.7525417804718, 27.20869731903076, 27.665082931518555, 28.11767053604126, 28.570464849472046, 29.026553630828857, 29.48164415359497, 29.93569850921631, 30.390040636062622, 30.843807697296143, 31.30430269241333, 31.760432720184326, 32.213794231414795, 32.666794538497925, 33.132078886032104, 33.59565472602844, 34.0539767742157, 34.511895179748535, 34.96549987792969, 35.42066287994385, 35.87925624847412, 36.33625388145447, 36.78799223899841, 37.24050331115723, 37.70400047302246, 38.16917014122009, 38.62710499763489, 39.08329486846924, 39.53624773025513, 39.989646673202515, 40.444605588912964, 40.90369462966919, 41.36785054206848, 41.831835985183716, 42.28443193435669, 42.73738956451416, 43.201128005981445, 43.65647268295288, 44.111663818359375, 44.567493200302124, 45.02417325973511, 45.485225439071655, 45.95157217979431, 46.40782308578491, 46.863810539245605, 47.45648670196533, 48.050405740737915, 48.64751958847046, 49.245811462402344, 49.84226965904236, 50.43775963783264, 51.03782653808594, 51.63651251792908, 52.230780363082886, 52.82683730125427, 53.424718618392944, 54.856550216674805]
[44.0, 40.516666666666666, 53.1, 67.98333333333333, 75.0, 76.1, 79.15, 79.63333333333334, 78.43333333333334, 78.51666666666667, 79.3, 79.46666666666667, 82.36666666666666, 83.63333333333334, 83.53333333333333, 83.5, 83.51666666666667, 83.73333333333333, 83.65, 83.73333333333333, 83.5, 83.71666666666667, 85.4, 85.55, 85.56666666666666, 86.83333333333333, 87.11666666666666, 88.48333333333333, 88.25, 88.41666666666667, 88.45, 89.98333333333333, 88.03333333333333, 86.66666666666667, 88.08333333333333, 88.26666666666667, 88.48333333333333, 88.63333333333334, 90.18333333333334, 90.23333333333333, 88.58333333333333, 87.2, 87.15, 88.66666666666667, 88.71666666666667, 88.83333333333333, 88.95, 88.85, 90.28333333333333, 91.0, 91.05, 91.3, 89.65, 88.7, 87.16666666666667, 87.0, 88.45, 88.55, 88.53333333333333, 89.7, 89.91666666666667, 88.55, 88.66666666666667, 88.71666666666667, 87.21666666666667, 87.03333333333333, 88.78333333333333, 88.66666666666667, 90.18333333333334, 89.88333333333334, 92.93333333333334, 93.03333333333333, 93.25, 93.01666666666667, 93.26666666666667, 93.31666666666666, 93.31666666666666, 94.66666666666667, 93.01666666666667, 92.85, 92.76666666666667, 89.61666666666666, 89.68333333333334, 89.71666666666667, 89.95, 91.31666666666666, 92.96666666666667, 94.53333333333333, 94.36666666666666, 94.46666666666667, 94.46666666666667, 93.1, 93.16666666666667, 91.43333333333334, 91.38333333333334, 91.5, 89.73333333333333, 89.61666666666666, 89.51666666666667, 89.78333333333333, 94.4]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.302, Test loss: 2.294, Test accuracy: 28.47 

Round   1, Train loss: 2.280, Test loss: 2.252, Test accuracy: 33.33 

Round   2, Train loss: 2.184, Test loss: 2.137, Test accuracy: 33.33 

Round   3, Train loss: 2.089, Test loss: 2.097, Test accuracy: 36.05 

Round   4, Train loss: 2.040, Test loss: 2.075, Test accuracy: 39.95 

Round   5, Train loss: 2.014, Test loss: 2.057, Test accuracy: 40.05 

Round   6, Train loss: 1.947, Test loss: 2.020, Test accuracy: 46.43 

Round   7, Train loss: 1.872, Test loss: 1.982, Test accuracy: 51.03 

Round   8, Train loss: 1.849, Test loss: 1.948, Test accuracy: 54.47 

Round   9, Train loss: 1.765, Test loss: 1.910, Test accuracy: 57.55 

Round  10, Train loss: 1.739, Test loss: 1.887, Test accuracy: 59.08 

Round  11, Train loss: 1.783, Test loss: 1.842, Test accuracy: 64.38 

Round  12, Train loss: 1.755, Test loss: 1.819, Test accuracy: 65.93 

Round  13, Train loss: 1.651, Test loss: 1.784, Test accuracy: 69.70 

Round  14, Train loss: 1.721, Test loss: 1.774, Test accuracy: 69.95 

Round  15, Train loss: 1.826, Test loss: 1.778, Test accuracy: 69.62 

Round  16, Train loss: 1.782, Test loss: 1.764, Test accuracy: 70.98 

Round  17, Train loss: 1.722, Test loss: 1.747, Test accuracy: 73.03 

Round  18, Train loss: 1.771, Test loss: 1.725, Test accuracy: 75.78 

Round  19, Train loss: 1.721, Test loss: 1.720, Test accuracy: 76.02 

Round  20, Train loss: 1.600, Test loss: 1.715, Test accuracy: 76.12 

Round  21, Train loss: 1.755, Test loss: 1.712, Test accuracy: 76.58 

Round  22, Train loss: 1.581, Test loss: 1.711, Test accuracy: 76.15 

Round  23, Train loss: 1.657, Test loss: 1.715, Test accuracy: 75.68 

Round  24, Train loss: 1.686, Test loss: 1.712, Test accuracy: 75.73 

Round  25, Train loss: 1.725, Test loss: 1.708, Test accuracy: 76.27 

Round  26, Train loss: 1.637, Test loss: 1.707, Test accuracy: 76.27 

Round  27, Train loss: 1.707, Test loss: 1.705, Test accuracy: 76.23 

Round  28, Train loss: 1.650, Test loss: 1.705, Test accuracy: 76.17 

Round  29, Train loss: 1.606, Test loss: 1.710, Test accuracy: 75.55 

Round  30, Train loss: 1.545, Test loss: 1.710, Test accuracy: 75.52 

Round  31, Train loss: 1.688, Test loss: 1.701, Test accuracy: 76.68 

Round  32, Train loss: 1.676, Test loss: 1.706, Test accuracy: 76.03 

Round  33, Train loss: 1.763, Test loss: 1.704, Test accuracy: 76.18 

Round  34, Train loss: 1.639, Test loss: 1.691, Test accuracy: 77.48 

Round  35, Train loss: 1.520, Test loss: 1.689, Test accuracy: 77.93 

Round  36, Train loss: 1.596, Test loss: 1.690, Test accuracy: 77.58 

Round  37, Train loss: 1.565, Test loss: 1.689, Test accuracy: 77.68 

Round  38, Train loss: 1.640, Test loss: 1.681, Test accuracy: 78.72 

Round  39, Train loss: 1.619, Test loss: 1.684, Test accuracy: 78.28 

Round  40, Train loss: 1.662, Test loss: 1.680, Test accuracy: 78.60 

Round  41, Train loss: 1.659, Test loss: 1.681, Test accuracy: 78.48 

Round  42, Train loss: 1.656, Test loss: 1.676, Test accuracy: 79.13 

Round  43, Train loss: 1.596, Test loss: 1.675, Test accuracy: 79.13 

Round  44, Train loss: 1.613, Test loss: 1.672, Test accuracy: 79.63 

Round  45, Train loss: 1.602, Test loss: 1.672, Test accuracy: 79.33 

Round  46, Train loss: 1.611, Test loss: 1.672, Test accuracy: 79.55 

Round  47, Train loss: 1.758, Test loss: 1.671, Test accuracy: 79.58 

Round  48, Train loss: 1.702, Test loss: 1.671, Test accuracy: 79.53 

Round  49, Train loss: 1.602, Test loss: 1.672, Test accuracy: 79.42 

Round  50, Train loss: 1.699, Test loss: 1.671, Test accuracy: 79.43 

Round  51, Train loss: 1.506, Test loss: 1.671, Test accuracy: 79.35 

Round  52, Train loss: 1.544, Test loss: 1.669, Test accuracy: 79.47 

Round  53, Train loss: 1.710, Test loss: 1.669, Test accuracy: 79.57 

Round  54, Train loss: 1.600, Test loss: 1.668, Test accuracy: 79.57 

Round  55, Train loss: 1.590, Test loss: 1.668, Test accuracy: 79.57 

Round  56, Train loss: 1.707, Test loss: 1.670, Test accuracy: 79.57 

Round  57, Train loss: 1.594, Test loss: 1.668, Test accuracy: 79.57 

Round  58, Train loss: 1.746, Test loss: 1.668, Test accuracy: 79.60 

Round  59, Train loss: 1.654, Test loss: 1.665, Test accuracy: 79.80 

Round  60, Train loss: 1.661, Test loss: 1.663, Test accuracy: 80.08 

Round  61, Train loss: 1.812, Test loss: 1.664, Test accuracy: 80.18 

Round  62, Train loss: 1.696, Test loss: 1.663, Test accuracy: 80.08 

Round  63, Train loss: 1.598, Test loss: 1.666, Test accuracy: 79.82 

Round  64, Train loss: 1.658, Test loss: 1.664, Test accuracy: 79.95 

Round  65, Train loss: 1.541, Test loss: 1.662, Test accuracy: 80.15 

Round  66, Train loss: 1.645, Test loss: 1.663, Test accuracy: 80.22 

Round  67, Train loss: 1.642, Test loss: 1.662, Test accuracy: 80.20 

Round  68, Train loss: 1.647, Test loss: 1.661, Test accuracy: 80.23 

Round  69, Train loss: 1.541, Test loss: 1.661, Test accuracy: 80.27 

Round  70, Train loss: 1.646, Test loss: 1.662, Test accuracy: 80.25 

Round  71, Train loss: 1.537, Test loss: 1.661, Test accuracy: 80.32 

Round  72, Train loss: 1.644, Test loss: 1.660, Test accuracy: 80.40 

Round  73, Train loss: 1.645, Test loss: 1.660, Test accuracy: 80.28 

Round  74, Train loss: 1.702, Test loss: 1.659, Test accuracy: 80.48 

Round  75, Train loss: 1.752, Test loss: 1.658, Test accuracy: 80.35 

Round  76, Train loss: 1.534, Test loss: 1.658, Test accuracy: 80.48 

Round  77, Train loss: 1.592, Test loss: 1.660, Test accuracy: 80.25 

Round  78, Train loss: 1.594, Test loss: 1.659, Test accuracy: 80.43 

Round  79, Train loss: 1.643, Test loss: 1.659, Test accuracy: 80.53 

Round  80, Train loss: 1.639, Test loss: 1.658, Test accuracy: 80.65 

Round  81, Train loss: 1.592, Test loss: 1.657, Test accuracy: 80.68 

Round  82, Train loss: 1.690, Test loss: 1.657, Test accuracy: 80.68 

Round  83, Train loss: 1.644, Test loss: 1.657, Test accuracy: 80.75 

Round  84, Train loss: 1.584, Test loss: 1.657, Test accuracy: 80.78 

Round  85, Train loss: 1.588, Test loss: 1.654, Test accuracy: 80.93 

Round  86, Train loss: 1.690, Test loss: 1.654, Test accuracy: 81.00 

Round  87, Train loss: 1.583, Test loss: 1.654, Test accuracy: 81.02 

Round  88, Train loss: 1.586, Test loss: 1.654, Test accuracy: 81.03 

Round  89, Train loss: 1.695, Test loss: 1.654, Test accuracy: 81.07 

Round  90, Train loss: 1.688, Test loss: 1.654, Test accuracy: 81.12 

Round  91, Train loss: 1.582, Test loss: 1.653, Test accuracy: 81.08 

Round  92, Train loss: 1.747, Test loss: 1.653, Test accuracy: 81.13 

Round  93, Train loss: 1.587, Test loss: 1.654, Test accuracy: 81.15 

Round  94, Train loss: 1.750, Test loss: 1.653, Test accuracy: 81.23 

Round  95, Train loss: 1.693, Test loss: 1.653, Test accuracy: 81.27 

Round  96, Train loss: 1.587, Test loss: 1.652, Test accuracy: 81.35 

Round  97, Train loss: 1.480, Test loss: 1.652, Test accuracy: 81.35 

Round  98, Train loss: 1.691, Test loss: 1.652, Test accuracy: 81.25 

Round  99, Train loss: 1.635, Test loss: 1.652, Test accuracy: 81.33 

Final Round, Train loss: 1.624, Test loss: 1.652, Test accuracy: 81.22 

Average accuracy final 10 rounds: 81.22666666666666 

468.09065532684326
[1.484255075454712, 1.9796197414398193, 2.470292091369629, 2.987285614013672, 3.5394136905670166, 4.064937353134155, 4.587800979614258, 5.118151426315308, 5.640657901763916, 6.163216829299927, 6.685405015945435, 7.2095324993133545, 7.733270883560181, 8.256911754608154, 8.78079867362976, 9.304798364639282, 9.827695846557617, 10.354259967803955, 10.878870964050293, 11.402252435684204, 11.926950931549072, 12.450807332992554, 12.97892165184021, 13.50437617301941, 14.030070543289185, 14.554006576538086, 15.074906349182129, 15.593158960342407, 16.118304014205933, 16.640811681747437, 17.164534091949463, 17.689576387405396, 18.211952447891235, 18.729676485061646, 19.252814054489136, 19.778054237365723, 20.301520824432373, 20.824356079101562, 21.3487606048584, 21.86983299255371, 22.398300170898438, 22.920403242111206, 23.444576025009155, 23.965744495391846, 24.49245262145996, 25.01457405090332, 25.538909196853638, 26.06123995780945, 26.580989122390747, 27.105127811431885, 27.631433963775635, 28.16005039215088, 28.683996200561523, 29.207422733306885, 29.731070041656494, 30.255686044692993, 30.77996850013733, 31.30545949935913, 31.830370903015137, 32.35221195220947, 32.87409830093384, 33.39991736412048, 33.925233125686646, 34.44671177864075, 34.97214913368225, 35.49674725532532, 36.0212607383728, 36.54490804672241, 37.06767272949219, 37.59987783432007, 38.1237051486969, 38.642059087753296, 39.161214113235474, 39.67789268493652, 40.20187520980835, 40.717926263809204, 41.236443758010864, 41.75335431098938, 42.271278858184814, 42.786980390548706, 43.305296659469604, 43.82201600074768, 44.33754920959473, 44.853917598724365, 45.36934733390808, 45.8906192779541, 46.40907669067383, 46.927618980407715, 47.44458770751953, 47.96690082550049, 48.50446891784668, 49.0240261554718, 49.54171586036682, 50.06062459945679, 50.57708668708801, 51.09819960594177, 51.614662647247314, 52.13259935379028, 52.65163516998291, 53.17082619667053, 54.0868136882782]
[28.466666666666665, 33.333333333333336, 33.333333333333336, 36.05, 39.95, 40.05, 46.43333333333333, 51.03333333333333, 54.46666666666667, 57.55, 59.083333333333336, 64.38333333333334, 65.93333333333334, 69.7, 69.95, 69.61666666666666, 70.98333333333333, 73.03333333333333, 75.78333333333333, 76.01666666666667, 76.11666666666666, 76.58333333333333, 76.15, 75.68333333333334, 75.73333333333333, 76.26666666666667, 76.26666666666667, 76.23333333333333, 76.16666666666667, 75.55, 75.51666666666667, 76.68333333333334, 76.03333333333333, 76.18333333333334, 77.48333333333333, 77.93333333333334, 77.58333333333333, 77.68333333333334, 78.71666666666667, 78.28333333333333, 78.6, 78.48333333333333, 79.13333333333334, 79.13333333333334, 79.63333333333334, 79.33333333333333, 79.55, 79.58333333333333, 79.53333333333333, 79.41666666666667, 79.43333333333334, 79.35, 79.46666666666667, 79.56666666666666, 79.56666666666666, 79.56666666666666, 79.56666666666666, 79.56666666666666, 79.6, 79.8, 80.08333333333333, 80.18333333333334, 80.08333333333333, 79.81666666666666, 79.95, 80.15, 80.21666666666667, 80.2, 80.23333333333333, 80.26666666666667, 80.25, 80.31666666666666, 80.4, 80.28333333333333, 80.48333333333333, 80.35, 80.48333333333333, 80.25, 80.43333333333334, 80.53333333333333, 80.65, 80.68333333333334, 80.68333333333334, 80.75, 80.78333333333333, 80.93333333333334, 81.0, 81.01666666666667, 81.03333333333333, 81.06666666666666, 81.11666666666666, 81.08333333333333, 81.13333333333334, 81.15, 81.23333333333333, 81.26666666666667, 81.35, 81.35, 81.25, 81.33333333333333, 81.21666666666667]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedper  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedper , epochs: 100, shard_per_user: 3, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

fedper
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.289, Test loss: 2.271, Test accuracy: 34.87 

Round   1, Train loss: 2.130, Test loss: 2.097, Test accuracy: 39.35 

Round   2, Train loss: 1.851, Test loss: 2.030, Test accuracy: 45.55 

Round   3, Train loss: 1.740, Test loss: 1.997, Test accuracy: 49.10 

Round   4, Train loss: 1.623, Test loss: 1.987, Test accuracy: 47.02 

Round   5, Train loss: 1.704, Test loss: 1.943, Test accuracy: 52.82 

Round   6, Train loss: 1.647, Test loss: 1.960, Test accuracy: 49.97 

Round   7, Train loss: 1.653, Test loss: 1.928, Test accuracy: 53.90 

Round   8, Train loss: 1.596, Test loss: 1.939, Test accuracy: 52.92 

Round   9, Train loss: 1.584, Test loss: 1.926, Test accuracy: 53.87 

Round  10, Train loss: 1.629, Test loss: 1.926, Test accuracy: 52.53 

Round  11, Train loss: 1.540, Test loss: 1.898, Test accuracy: 56.87 

Round  12, Train loss: 1.623, Test loss: 1.921, Test accuracy: 54.30 

Round  13, Train loss: 1.561, Test loss: 1.903, Test accuracy: 56.17 

Round  14, Train loss: 1.620, Test loss: 1.880, Test accuracy: 59.12 

Round  15, Train loss: 1.507, Test loss: 1.873, Test accuracy: 59.78 

Round  16, Train loss: 1.588, Test loss: 1.881, Test accuracy: 58.27 

Round  17, Train loss: 1.567, Test loss: 1.871, Test accuracy: 59.48 

Round  18, Train loss: 1.580, Test loss: 1.878, Test accuracy: 58.88 

Round  19, Train loss: 1.560, Test loss: 1.881, Test accuracy: 58.92 

Round  20, Train loss: 1.500, Test loss: 1.860, Test accuracy: 61.28 

Round  21, Train loss: 1.596, Test loss: 1.867, Test accuracy: 58.73 

Round  22, Train loss: 1.491, Test loss: 1.864, Test accuracy: 60.47 

Round  23, Train loss: 1.554, Test loss: 1.835, Test accuracy: 63.37 

Round  24, Train loss: 1.551, Test loss: 1.839, Test accuracy: 62.82 

Round  25, Train loss: 1.543, Test loss: 1.835, Test accuracy: 62.67 

Round  26, Train loss: 1.496, Test loss: 1.821, Test accuracy: 65.33 

Round  27, Train loss: 1.486, Test loss: 1.823, Test accuracy: 64.30 

Round  28, Train loss: 1.592, Test loss: 1.814, Test accuracy: 65.37 

Round  29, Train loss: 1.490, Test loss: 1.797, Test accuracy: 68.20 

Round  30, Train loss: 1.591, Test loss: 1.816, Test accuracy: 65.63 

Round  31, Train loss: 1.586, Test loss: 1.831, Test accuracy: 62.98 

Round  32, Train loss: 1.590, Test loss: 1.822, Test accuracy: 64.45 

Round  33, Train loss: 1.591, Test loss: 1.810, Test accuracy: 65.23 

Round  34, Train loss: 1.516, Test loss: 1.805, Test accuracy: 66.40 

Round  35, Train loss: 1.514, Test loss: 1.816, Test accuracy: 65.00 

Round  36, Train loss: 1.509, Test loss: 1.818, Test accuracy: 65.03 

Round  37, Train loss: 1.484, Test loss: 1.788, Test accuracy: 67.72 

Round  38, Train loss: 1.530, Test loss: 1.788, Test accuracy: 67.58 

Round  39, Train loss: 1.587, Test loss: 1.801, Test accuracy: 66.42 

Round  40, Train loss: 1.495, Test loss: 1.798, Test accuracy: 66.75 

Round  41, Train loss: 1.535, Test loss: 1.793, Test accuracy: 67.25 

Round  42, Train loss: 1.546, Test loss: 1.776, Test accuracy: 69.50 

Round  43, Train loss: 1.473, Test loss: 1.762, Test accuracy: 70.35 

Round  44, Train loss: 1.527, Test loss: 1.771, Test accuracy: 69.50 

Round  45, Train loss: 1.589, Test loss: 1.766, Test accuracy: 69.83 

Round  46, Train loss: 1.478, Test loss: 1.778, Test accuracy: 68.07 

Round  47, Train loss: 1.477, Test loss: 1.765, Test accuracy: 69.47 

Round  48, Train loss: 1.480, Test loss: 1.749, Test accuracy: 71.90 

Round  49, Train loss: 1.475, Test loss: 1.753, Test accuracy: 71.43 

Round  50, Train loss: 1.480, Test loss: 1.753, Test accuracy: 71.13 

Round  51, Train loss: 1.478, Test loss: 1.754, Test accuracy: 71.33 

Round  52, Train loss: 1.528, Test loss: 1.737, Test accuracy: 73.30 

Round  53, Train loss: 1.530, Test loss: 1.734, Test accuracy: 73.22 

Round  54, Train loss: 1.529, Test loss: 1.745, Test accuracy: 72.12 

Round  55, Train loss: 1.475, Test loss: 1.747, Test accuracy: 72.05 

Round  56, Train loss: 1.471, Test loss: 1.752, Test accuracy: 70.87 

Round  57, Train loss: 1.529, Test loss: 1.743, Test accuracy: 71.98 

Round  58, Train loss: 1.471, Test loss: 1.730, Test accuracy: 73.75 

Round  59, Train loss: 1.478, Test loss: 1.725, Test accuracy: 74.28 

Round  60, Train loss: 1.583, Test loss: 1.711, Test accuracy: 76.27 

Round  61, Train loss: 1.578, Test loss: 1.733, Test accuracy: 73.13 

Round  62, Train loss: 1.527, Test loss: 1.726, Test accuracy: 74.08 

Round  63, Train loss: 1.525, Test loss: 1.716, Test accuracy: 75.48 

Round  64, Train loss: 1.526, Test loss: 1.710, Test accuracy: 75.77 

Round  65, Train loss: 1.524, Test loss: 1.696, Test accuracy: 77.62 

Round  66, Train loss: 1.471, Test loss: 1.719, Test accuracy: 74.68 

Round  67, Train loss: 1.532, Test loss: 1.695, Test accuracy: 77.28 

Round  68, Train loss: 1.470, Test loss: 1.693, Test accuracy: 77.57 

Round  69, Train loss: 1.468, Test loss: 1.686, Test accuracy: 78.62 

Round  70, Train loss: 1.468, Test loss: 1.705, Test accuracy: 76.77 

Round  71, Train loss: 1.529, Test loss: 1.697, Test accuracy: 77.02 

Round  72, Train loss: 1.579, Test loss: 1.711, Test accuracy: 75.33 

Round  73, Train loss: 1.469, Test loss: 1.691, Test accuracy: 77.52 

Round  74, Train loss: 1.580, Test loss: 1.703, Test accuracy: 76.12 

Round  75, Train loss: 1.469, Test loss: 1.695, Test accuracy: 76.98 

Round  76, Train loss: 1.524, Test loss: 1.688, Test accuracy: 77.82 

Round  77, Train loss: 1.527, Test loss: 1.682, Test accuracy: 78.75 

Round  78, Train loss: 1.526, Test loss: 1.688, Test accuracy: 78.12 

Round  79, Train loss: 1.472, Test loss: 1.681, Test accuracy: 79.20 

Round  80, Train loss: 1.524, Test loss: 1.678, Test accuracy: 79.08 

Round  81, Train loss: 1.521, Test loss: 1.677, Test accuracy: 79.23 

Round  82, Train loss: 1.469, Test loss: 1.679, Test accuracy: 78.75 

Round  83, Train loss: 1.523, Test loss: 1.676, Test accuracy: 79.17 

Round  84, Train loss: 1.521, Test loss: 1.677, Test accuracy: 78.92 

Round  85, Train loss: 1.521, Test loss: 1.684, Test accuracy: 78.28 

Round  86, Train loss: 1.521, Test loss: 1.671, Test accuracy: 79.47 

Round  87, Train loss: 1.573, Test loss: 1.674, Test accuracy: 79.35 

Round  88, Train loss: 1.524, Test loss: 1.663, Test accuracy: 80.57 

Round  89, Train loss: 1.520, Test loss: 1.668, Test accuracy: 79.53 

Round  90, Train loss: 1.522, Test loss: 1.667, Test accuracy: 80.18 

Round  91, Train loss: 1.468, Test loss: 1.667, Test accuracy: 79.92 

Round  92, Train loss: 1.468, Test loss: 1.654, Test accuracy: 81.33 

Round  93, Train loss: 1.467, Test loss: 1.666, Test accuracy: 80.02 

Round  94, Train loss: 1.522, Test loss: 1.666, Test accuracy: 79.97 

Round  95, Train loss: 1.466, Test loss: 1.660, Test accuracy: 80.53 

Round  96, Train loss: 1.574, Test loss: 1.657, Test accuracy: 81.02 

Round  97, Train loss: 1.575, Test loss: 1.660, Test accuracy: 80.75 

Round  98, Train loss: 1.520, Test loss: 1.644, Test accuracy: 82.27 

Round  99, Train loss: 1.522, Test loss: 1.646, Test accuracy: 82.05 

Final Round, Train loss: 1.540, Test loss: 1.599, Test accuracy: 86.98 

Average accuracy final 10 rounds: 80.80333333333333 

519.5646831989288
[1.4967389106750488, 2.1033060550689697, 2.7028136253356934, 3.3017749786376953, 3.9004688262939453, 4.4994964599609375, 5.099516153335571, 5.700899124145508, 6.302112579345703, 6.902009725570679, 7.499384880065918, 8.098663330078125, 8.724732160568237, 9.345559358596802, 9.940325260162354, 10.539194107055664, 11.136269807815552, 11.736767053604126, 12.331382751464844, 12.92611575126648, 13.520324468612671, 14.113977670669556, 14.711374044418335, 15.30616044998169, 15.903945207595825, 16.50000309944153, 17.09735655784607, 17.695019721984863, 18.294032096862793, 18.89146065711975, 19.484352588653564, 20.08218240737915, 20.675755262374878, 21.26823139190674, 21.86150860786438, 22.45691442489624, 23.04930806159973, 23.64425277709961, 24.236886024475098, 24.828815460205078, 25.434378623962402, 26.029805898666382, 26.628394603729248, 27.22552514076233, 27.824604988098145, 28.4237380027771, 29.020642280578613, 29.620076894760132, 30.23547387123108, 30.83221673965454, 31.432361602783203, 32.028592586517334, 32.622936964035034, 33.221359729766846, 33.82508873939514, 34.424073696136475, 35.020463705062866, 35.61852693557739, 36.21938395500183, 36.8185715675354, 37.413329124450684, 38.007582902908325, 38.606016635894775, 39.20029020309448, 39.7999107837677, 40.39490461349487, 40.99073505401611, 41.585760831832886, 42.183398723602295, 42.77336406707764, 43.365692138671875, 43.96108031272888, 44.55740547180176, 45.15311551094055, 45.74775433540344, 46.34624695777893, 46.94325518608093, 47.537330865859985, 48.13260555267334, 48.72819972038269, 49.327009201049805, 49.92175102233887, 50.515373945236206, 51.11132478713989, 51.707308530807495, 52.302470684051514, 52.896888971328735, 53.48967957496643, 54.08669424057007, 54.67869758605957, 55.275415897369385, 55.873175621032715, 56.47088575363159, 57.06880831718445, 57.66298151016235, 58.2858989238739, 58.8857946395874, 59.485852003097534, 60.079754114151, 60.674243450164795, 61.58655333518982]
[34.86666666666667, 39.35, 45.55, 49.1, 47.016666666666666, 52.81666666666667, 49.96666666666667, 53.9, 52.916666666666664, 53.86666666666667, 52.53333333333333, 56.86666666666667, 54.3, 56.166666666666664, 59.11666666666667, 59.78333333333333, 58.266666666666666, 59.483333333333334, 58.88333333333333, 58.916666666666664, 61.28333333333333, 58.733333333333334, 60.46666666666667, 63.36666666666667, 62.81666666666667, 62.666666666666664, 65.33333333333333, 64.3, 65.36666666666666, 68.2, 65.63333333333334, 62.983333333333334, 64.45, 65.23333333333333, 66.4, 65.0, 65.03333333333333, 67.71666666666667, 67.58333333333333, 66.41666666666667, 66.75, 67.25, 69.5, 70.35, 69.5, 69.83333333333333, 68.06666666666666, 69.46666666666667, 71.9, 71.43333333333334, 71.13333333333334, 71.33333333333333, 73.3, 73.21666666666667, 72.11666666666666, 72.05, 70.86666666666666, 71.98333333333333, 73.75, 74.28333333333333, 76.26666666666667, 73.13333333333334, 74.08333333333333, 75.48333333333333, 75.76666666666667, 77.61666666666666, 74.68333333333334, 77.28333333333333, 77.56666666666666, 78.61666666666666, 76.76666666666667, 77.01666666666667, 75.33333333333333, 77.51666666666667, 76.11666666666666, 76.98333333333333, 77.81666666666666, 78.75, 78.11666666666666, 79.2, 79.08333333333333, 79.23333333333333, 78.75, 79.16666666666667, 78.91666666666667, 78.28333333333333, 79.46666666666667, 79.35, 80.56666666666666, 79.53333333333333, 80.18333333333334, 79.91666666666667, 81.33333333333333, 80.01666666666667, 79.96666666666667, 80.53333333333333, 81.01666666666667, 80.75, 82.26666666666667, 82.05, 86.98333333333333]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  lg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: lg , epochs: 100, shard_per_user: 3, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.2  

lg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 17098 (global); Percentage 3.11 (17098/550346 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.298, Test loss: 2.286, Test accuracy: 36.80 

Round   1, Train loss: 2.224, Test loss: 2.148, Test accuracy: 33.33 

Round   2, Train loss: 2.014, Test loss: 2.036, Test accuracy: 49.47 

Round   3, Train loss: 1.750, Test loss: 1.869, Test accuracy: 69.18 

Round   4, Train loss: 1.655, Test loss: 1.718, Test accuracy: 80.52 

Round   5, Train loss: 1.586, Test loss: 1.629, Test accuracy: 88.53 

Round   6, Train loss: 1.505, Test loss: 1.601, Test accuracy: 90.35 

Round   7, Train loss: 1.480, Test loss: 1.596, Test accuracy: 90.37 

Round   8, Train loss: 1.508, Test loss: 1.547, Test accuracy: 93.33 

Round   9, Train loss: 1.481, Test loss: 1.544, Test accuracy: 93.43 

Round  10, Train loss: 1.475, Test loss: 1.542, Test accuracy: 93.47 

Round  11, Train loss: 1.478, Test loss: 1.531, Test accuracy: 93.70 

Round  12, Train loss: 1.475, Test loss: 1.530, Test accuracy: 93.77 

Round  13, Train loss: 1.474, Test loss: 1.528, Test accuracy: 93.87 

Round  14, Train loss: 1.469, Test loss: 1.528, Test accuracy: 93.87 

Round  15, Train loss: 1.471, Test loss: 1.527, Test accuracy: 93.90 

Round  16, Train loss: 1.470, Test loss: 1.526, Test accuracy: 94.10 

Round  17, Train loss: 1.476, Test loss: 1.517, Test accuracy: 95.08 

Round  18, Train loss: 1.471, Test loss: 1.517, Test accuracy: 95.15 

Round  19, Train loss: 1.470, Test loss: 1.516, Test accuracy: 95.10 

Round  20, Train loss: 1.466, Test loss: 1.516, Test accuracy: 95.10 

Round  21, Train loss: 1.462, Test loss: 1.516, Test accuracy: 95.12 

Round  22, Train loss: 1.469, Test loss: 1.516, Test accuracy: 95.12 

Round  23, Train loss: 1.468, Test loss: 1.515, Test accuracy: 95.13 

Round  24, Train loss: 1.467, Test loss: 1.515, Test accuracy: 95.17 

Round  25, Train loss: 1.464, Test loss: 1.515, Test accuracy: 95.15 

Round  26, Train loss: 1.469, Test loss: 1.514, Test accuracy: 95.13 

Round  27, Train loss: 1.467, Test loss: 1.514, Test accuracy: 95.12 

Round  28, Train loss: 1.465, Test loss: 1.514, Test accuracy: 95.13 

Round  29, Train loss: 1.463, Test loss: 1.514, Test accuracy: 95.13 

Round  30, Train loss: 1.463, Test loss: 1.514, Test accuracy: 95.20 

Round  31, Train loss: 1.465, Test loss: 1.514, Test accuracy: 95.17 

Round  32, Train loss: 1.464, Test loss: 1.514, Test accuracy: 95.23 

Round  33, Train loss: 1.468, Test loss: 1.514, Test accuracy: 95.23 

Round  34, Train loss: 1.468, Test loss: 1.513, Test accuracy: 95.20 

Round  35, Train loss: 1.468, Test loss: 1.513, Test accuracy: 95.18 

Round  36, Train loss: 1.472, Test loss: 1.513, Test accuracy: 95.17 

Round  37, Train loss: 1.463, Test loss: 1.513, Test accuracy: 95.15 

Round  38, Train loss: 1.467, Test loss: 1.513, Test accuracy: 95.20 

Round  39, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.18 

Round  40, Train loss: 1.467, Test loss: 1.513, Test accuracy: 95.17 

Round  41, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.18 

Round  42, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.13 

Round  43, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.17 

Round  44, Train loss: 1.466, Test loss: 1.513, Test accuracy: 95.15 

Round  45, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.15 

Round  46, Train loss: 1.463, Test loss: 1.513, Test accuracy: 95.20 

Round  47, Train loss: 1.466, Test loss: 1.513, Test accuracy: 95.20 

Round  48, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.18 

Round  49, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.20 

Round  50, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.18 

Round  51, Train loss: 1.467, Test loss: 1.513, Test accuracy: 95.18 

Round  52, Train loss: 1.464, Test loss: 1.513, Test accuracy: 95.15 

Round  53, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.15 

Round  54, Train loss: 1.468, Test loss: 1.513, Test accuracy: 95.13 

Round  55, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.13 

Round  56, Train loss: 1.469, Test loss: 1.513, Test accuracy: 95.13 

Round  57, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.15 

Round  58, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.15 

Round  59, Train loss: 1.467, Test loss: 1.513, Test accuracy: 95.17 

Round  60, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.17 

Round  61, Train loss: 1.466, Test loss: 1.513, Test accuracy: 95.17 

Round  62, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.12 

Round  63, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.10 

Round  64, Train loss: 1.462, Test loss: 1.513, Test accuracy: 95.10 

Round  65, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.13 

Round  66, Train loss: 1.463, Test loss: 1.513, Test accuracy: 95.12 

Round  67, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.12 

Round  68, Train loss: 1.465, Test loss: 1.513, Test accuracy: 95.10 

Round  69, Train loss: 1.462, Test loss: 1.513, Test accuracy: 95.08 

Round  70, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.08 

Round  71, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.10 

Round  72, Train loss: 1.467, Test loss: 1.512, Test accuracy: 95.10 

Round  73, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.10 

Round  74, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.12 

Round  75, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.10 

Round  76, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.10 

Round  77, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.12 

Round  78, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.13 

Round  79, Train loss: 1.467, Test loss: 1.512, Test accuracy: 95.13 

Round  80, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.13 

Round  81, Train loss: 1.462, Test loss: 1.512, Test accuracy: 95.13 

Round  82, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.17 

Round  83, Train loss: 1.462, Test loss: 1.512, Test accuracy: 95.17 

Round  84, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.15 

Round  85, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.15 

Round  86, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.15 

Round  87, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.17 

Round  88, Train loss: 1.462, Test loss: 1.512, Test accuracy: 95.15 

Round  89, Train loss: 1.462, Test loss: 1.512, Test accuracy: 95.17 

Round  90, Train loss: 1.462, Test loss: 1.512, Test accuracy: 95.18 

Round  91, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.18 

Round  92, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.17 

Round  93, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.17 

Round  94, Train loss: 1.461, Test loss: 1.512, Test accuracy: 95.18 

Round  95, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.18 

Round  96, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.18 

Round  97, Train loss: 1.466, Test loss: 1.512, Test accuracy: 95.20 

Round  98, Train loss: 1.463, Test loss: 1.512, Test accuracy: 95.18 

Round  99, Train loss: 1.465, Test loss: 1.512, Test accuracy: 95.18 

Final Round, Train loss: 1.464, Test loss: 1.512, Test accuracy: 95.20 

Average accuracy final 10 rounds: 95.18166666666666 

513.7417061328888
[1.540391445159912, 2.245702028274536, 2.972693920135498, 3.6805169582366943, 4.295279026031494, 4.8876564502716064, 5.48002028465271, 6.073395013809204, 6.665782451629639, 7.262228012084961, 7.854199409484863, 8.446304082870483, 9.040580749511719, 9.631647109985352, 10.226610898971558, 10.824073553085327, 11.420703411102295, 12.016411781311035, 12.614348649978638, 13.211868047714233, 13.80708909034729, 14.402426481246948, 15.029549837112427, 15.633845806121826, 16.230886697769165, 16.825325965881348, 17.419355392456055, 18.014102935791016, 18.60781478881836, 19.223162412643433, 19.826183319091797, 20.42317509651184, 21.03636932373047, 21.629340887069702, 22.22023606300354, 22.816885471343994, 23.409502744674683, 24.003118991851807, 24.600019216537476, 25.19330906867981, 25.78498148918152, 26.399484395980835, 26.9931218624115, 27.590389728546143, 28.190179109573364, 28.785492181777954, 29.379055976867676, 29.975273847579956, 30.5724618434906, 31.16567301750183, 31.75982904434204, 32.35602784156799, 32.95251488685608, 33.547733306884766, 34.138336420059204, 34.72947382926941, 35.32175397872925, 35.93496060371399, 36.549179553985596, 37.14186429977417, 37.73768472671509, 38.332541942596436, 38.92979097366333, 39.52842378616333, 40.12252235412598, 40.714216470718384, 41.31383967399597, 41.91262125968933, 42.51045751571655, 43.104005575180054, 43.70176291465759, 44.299046754837036, 44.893025636672974, 45.4863166809082, 46.080320835113525, 46.67652606964111, 47.26904630661011, 47.86721611022949, 48.45949959754944, 49.05569386482239, 49.65150737762451, 50.24578666687012, 50.839905738830566, 51.4429452419281, 52.03856587409973, 52.63051462173462, 53.24308395385742, 53.84120488166809, 54.43728709220886, 55.032288551330566, 55.65101099014282, 56.24046516418457, 56.82928705215454, 57.423495292663574, 58.013853788375854, 58.60633707046509, 59.20228719711304, 59.79230237007141, 60.38175559043884, 60.97592806816101, 62.00209593772888]
[36.8, 33.333333333333336, 49.46666666666667, 69.18333333333334, 80.51666666666667, 88.53333333333333, 90.35, 90.36666666666666, 93.33333333333333, 93.43333333333334, 93.46666666666667, 93.7, 93.76666666666667, 93.86666666666666, 93.86666666666666, 93.9, 94.1, 95.08333333333333, 95.15, 95.1, 95.1, 95.11666666666666, 95.11666666666666, 95.13333333333334, 95.16666666666667, 95.15, 95.13333333333334, 95.11666666666666, 95.13333333333334, 95.13333333333334, 95.2, 95.16666666666667, 95.23333333333333, 95.23333333333333, 95.2, 95.18333333333334, 95.16666666666667, 95.15, 95.2, 95.18333333333334, 95.16666666666667, 95.18333333333334, 95.13333333333334, 95.16666666666667, 95.15, 95.15, 95.2, 95.2, 95.18333333333334, 95.2, 95.18333333333334, 95.18333333333334, 95.15, 95.15, 95.13333333333334, 95.13333333333334, 95.13333333333334, 95.15, 95.15, 95.16666666666667, 95.16666666666667, 95.16666666666667, 95.11666666666666, 95.1, 95.1, 95.13333333333334, 95.11666666666666, 95.11666666666666, 95.1, 95.08333333333333, 95.08333333333333, 95.1, 95.1, 95.1, 95.11666666666666, 95.1, 95.1, 95.11666666666666, 95.13333333333334, 95.13333333333334, 95.13333333333334, 95.13333333333334, 95.16666666666667, 95.16666666666667, 95.15, 95.15, 95.15, 95.16666666666667, 95.15, 95.16666666666667, 95.18333333333334, 95.18333333333334, 95.16666666666667, 95.16666666666667, 95.18333333333334, 95.18333333333334, 95.18333333333334, 95.2, 95.18333333333334, 95.18333333333334, 95.2]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC-K-Means%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 3, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 1, dataset: mnist  

fedrep
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
401408
401920
532992
533248
549632
549696
550336
550346
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_k_means.py", line 291, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_grob_local, idx=idx, w_glob_keys=w_glob_keys, lr=args.lr, last=last, concept_matrix_local=concept_matrix[idx])
  File "/data/jij/csm/code/FL_HLS/models/Update.py", line 2127, in train
    featrue = self.features.detach().numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_ditto%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
Round   0, Train loss: 2.290, Test loss: 2.262, Test accuracy: 35.47
Round   1, Train loss: 2.187, Test loss: 2.086, Test accuracy: 34.27
Round   2, Train loss: 1.926, Test loss: 2.015, Test accuracy: 48.73
Round   3, Train loss: 1.730, Test loss: 2.002, Test accuracy: 46.05
Round   4, Train loss: 1.623, Test loss: 1.982, Test accuracy: 47.98
Round   5, Train loss: 1.612, Test loss: 1.975, Test accuracy: 48.75
Round   6, Train loss: 1.520, Test loss: 1.989, Test accuracy: 46.28
Round   7, Train loss: 1.582, Test loss: 2.000, Test accuracy: 44.22
Round   8, Train loss: 1.537, Test loss: 1.993, Test accuracy: 45.33
Round   9, Train loss: 1.571, Test loss: 2.003, Test accuracy: 45.02
Round  10, Train loss: 1.550, Test loss: 1.994, Test accuracy: 46.12
Round  11, Train loss: 1.560, Test loss: 1.987, Test accuracy: 47.37
Round  12, Train loss: 1.547, Test loss: 1.950, Test accuracy: 50.88
Round  13, Train loss: 1.483, Test loss: 1.957, Test accuracy: 50.17
Round  14, Train loss: 1.555, Test loss: 2.000, Test accuracy: 45.63
Round  15, Train loss: 1.491, Test loss: 2.018, Test accuracy: 42.60
Round  16, Train loss: 1.549, Test loss: 2.007, Test accuracy: 43.70
Round  17, Train loss: 1.492, Test loss: 1.994, Test accuracy: 45.77
Round  18, Train loss: 1.484, Test loss: 1.983, Test accuracy: 46.90
Round  19, Train loss: 1.530, Test loss: 1.981, Test accuracy: 47.65
Round  20, Train loss: 1.532, Test loss: 1.962, Test accuracy: 49.58
Round  21, Train loss: 1.519, Test loss: 1.938, Test accuracy: 52.45
Round  22, Train loss: 1.476, Test loss: 1.973, Test accuracy: 48.43
Round  23, Train loss: 1.473, Test loss: 1.953, Test accuracy: 50.43
Round  24, Train loss: 1.539, Test loss: 1.948, Test accuracy: 51.27
Round  25, Train loss: 1.475, Test loss: 1.948, Test accuracy: 51.38
Round  26, Train loss: 1.530, Test loss: 1.984, Test accuracy: 47.18
Round  27, Train loss: 1.488, Test loss: 1.969, Test accuracy: 49.07
Round  28, Train loss: 1.478, Test loss: 1.955, Test accuracy: 50.58
Round  29, Train loss: 1.476, Test loss: 1.997, Test accuracy: 45.33
Round  30, Train loss: 1.470, Test loss: 1.964, Test accuracy: 49.27
Round  31, Train loss: 1.472, Test loss: 1.991, Test accuracy: 46.30
Round  32, Train loss: 1.473, Test loss: 1.951, Test accuracy: 51.47
Round  33, Train loss: 1.475, Test loss: 1.984, Test accuracy: 46.85
Round  34, Train loss: 1.477, Test loss: 1.964, Test accuracy: 49.40
Round  35, Train loss: 1.474, Test loss: 1.960, Test accuracy: 49.88
Round  36, Train loss: 1.471, Test loss: 1.939, Test accuracy: 52.22
Round  37, Train loss: 1.475, Test loss: 1.965, Test accuracy: 49.35
Round  38, Train loss: 1.473, Test loss: 1.997, Test accuracy: 45.33
Round  39, Train loss: 1.473, Test loss: 1.975, Test accuracy: 48.18
Round  40, Train loss: 1.470, Test loss: 1.973, Test accuracy: 48.72
Round  41, Train loss: 1.470, Test loss: 1.960, Test accuracy: 49.65
Round  42, Train loss: 1.472, Test loss: 1.949, Test accuracy: 50.85
Round  43, Train loss: 1.472, Test loss: 1.962, Test accuracy: 49.47
Round  44, Train loss: 1.471, Test loss: 1.947, Test accuracy: 51.13
Round  45, Train loss: 1.471, Test loss: 1.957, Test accuracy: 50.23
Round  46, Train loss: 1.468, Test loss: 1.962, Test accuracy: 49.43
Round  47, Train loss: 1.467, Test loss: 1.962, Test accuracy: 49.82
Round  48, Train loss: 1.473, Test loss: 1.967, Test accuracy: 49.37
Round  49, Train loss: 1.469, Test loss: 1.952, Test accuracy: 50.65
Round  50, Train loss: 1.468, Test loss: 1.945, Test accuracy: 51.42
Round  51, Train loss: 1.468, Test loss: 1.942, Test accuracy: 52.20
Round  52, Train loss: 1.471, Test loss: 1.961, Test accuracy: 49.75
Round  53, Train loss: 1.467, Test loss: 1.942, Test accuracy: 51.73
Round  54, Train loss: 1.468, Test loss: 1.966, Test accuracy: 48.77
Round  55, Train loss: 1.467, Test loss: 1.954, Test accuracy: 50.65
Round  56, Train loss: 1.468, Test loss: 1.954, Test accuracy: 50.37
Round  57, Train loss: 1.469, Test loss: 1.952, Test accuracy: 50.35
Round  58, Train loss: 1.469, Test loss: 1.944, Test accuracy: 52.00
Round  59, Train loss: 1.467, Test loss: 1.947, Test accuracy: 51.22
Round  60, Train loss: 1.468, Test loss: 1.960, Test accuracy: 49.25
Round  61, Train loss: 1.465, Test loss: 1.997, Test accuracy: 44.80
Round  62, Train loss: 1.468, Test loss: 1.953, Test accuracy: 50.18
Round  63, Train loss: 1.468, Test loss: 1.969, Test accuracy: 48.30
Round  64, Train loss: 1.467, Test loss: 1.941, Test accuracy: 51.35
Round  65, Train loss: 1.466, Test loss: 1.953, Test accuracy: 50.80
Round  66, Train loss: 1.468, Test loss: 1.977, Test accuracy: 47.33
Round  67, Train loss: 1.468, Test loss: 1.965, Test accuracy: 49.08
Round  68, Train loss: 1.467, Test loss: 1.951, Test accuracy: 50.18
Round  69, Train loss: 1.466, Test loss: 1.941, Test accuracy: 51.53
Round  70, Train loss: 1.465, Test loss: 1.941, Test accuracy: 51.73
Round  71, Train loss: 1.465, Test loss: 1.942, Test accuracy: 51.45
Round  72, Train loss: 1.466, Test loss: 1.942, Test accuracy: 51.78
Round  73, Train loss: 1.466, Test loss: 1.949, Test accuracy: 50.93
Round  74, Train loss: 1.465, Test loss: 1.930, Test accuracy: 53.20
Round  75, Train loss: 1.466, Test loss: 1.950, Test accuracy: 50.85
Round  76, Train loss: 1.466, Test loss: 1.977, Test accuracy: 47.57
Round  77, Train loss: 1.465, Test loss: 1.976, Test accuracy: 47.85
Round  78, Train loss: 1.467, Test loss: 1.955, Test accuracy: 49.78
Round  79, Train loss: 1.464, Test loss: 1.938, Test accuracy: 52.00
Round  80, Train loss: 1.465, Test loss: 1.949, Test accuracy: 50.72
Round  81, Train loss: 1.467, Test loss: 1.963, Test accuracy: 49.37
Round  82, Train loss: 1.466, Test loss: 1.957, Test accuracy: 49.20
Round  83, Train loss: 1.466, Test loss: 1.958, Test accuracy: 49.82
Round  84, Train loss: 1.464, Test loss: 1.947, Test accuracy: 50.73
Round  85, Train loss: 1.465, Test loss: 1.929, Test accuracy: 52.98
Round  86, Train loss: 1.465, Test loss: 1.992, Test accuracy: 46.25
Round  87, Train loss: 1.464, Test loss: 1.975, Test accuracy: 48.40
Round  88, Train loss: 1.467, Test loss: 1.952, Test accuracy: 50.43
Round  89, Train loss: 1.465, Test loss: 1.964, Test accuracy: 49.38
Round  90, Train loss: 1.464, Test loss: 1.947, Test accuracy: 51.33
Round  91, Train loss: 1.465, Test loss: 1.982, Test accuracy: 47.58
Round  92, Train loss: 1.464, Test loss: 1.954, Test accuracy: 50.62
Round  93, Train loss: 1.464, Test loss: 1.952, Test accuracy: 50.52
Round  94, Train loss: 1.466, Test loss: 1.981, Test accuracy: 46.92
Round  95, Train loss: 1.464, Test loss: 1.954, Test accuracy: 49.95
Round  96, Train loss: 1.465, Test loss: 1.967, Test accuracy: 48.50
Round  97, Train loss: 1.465, Test loss: 1.954, Test accuracy: 50.02
Round  98, Train loss: 1.465, Test loss: 1.949, Test accuracy: 51.02
Round  99, Train loss: 1.465, Test loss: 1.947, Test accuracy: 50.85
Final Round, Train loss: 1.464, Test loss: 1.932, Test accuracy: 52.33
Average accuracy final 10 rounds: 49.73
1146.1719281673431
[2.45430064201355, 4.045843601226807, 5.639087915420532, 7.2129740715026855, 8.791735649108887, 10.369429588317871, 11.947278022766113, 13.524406909942627, 15.105377912521362, 16.684287548065186, 18.269490242004395, 19.857949256896973, 21.440585136413574, 23.16435742378235, 24.868547916412354, 26.571577787399292, 28.273946285247803, 29.971821546554565, 31.556736946105957, 33.14255714416504, 34.724709033966064, 36.30607843399048, 37.88925838470459, 39.47423982620239, 41.058971643447876, 42.645535707473755, 44.222113847732544, 45.80864858627319, 47.42024898529053, 49.01346707344055, 50.603500843048096, 52.19648575782776, 53.804672956466675, 55.39882040023804, 56.999117612838745, 58.59959554672241, 60.19509243965149, 61.787529706954956, 63.378700733184814, 64.9718062877655, 66.56447839736938, 68.16430354118347, 69.76077246665955, 71.35585618019104, 72.95290279388428, 74.66483950614929, 76.37760138511658, 78.087965965271, 79.79848122596741, 81.50980067253113, 83.2240858078003, 84.81839632987976, 86.40612030029297, 87.99385046958923, 89.58692526817322, 91.1796875, 92.76966571807861, 94.36105394363403, 95.952561378479, 97.55735993385315, 99.15308403968811, 100.76592707633972, 102.3625967502594, 103.96081686019897, 105.560617685318, 107.15859150886536, 108.7557282447815, 110.35038352012634, 112.2119357585907, 114.07819294929504, 115.94041013717651, 117.8021080493927, 119.66037631034851, 121.5201427936554, 123.38016843795776, 125.24297213554382, 126.83356022834778, 128.42579865455627, 130.01678490638733, 131.60059523582458, 133.1887743473053, 134.77776217460632, 136.36735200881958, 137.95765733718872, 139.55017805099487, 141.1460177898407, 142.74108171463013, 144.33094477653503, 145.92195296287537, 147.5116081237793, 149.10250067710876, 150.69951224327087, 152.28983759880066, 153.87803483009338, 155.47197699546814, 157.0660800933838, 158.6602394580841, 160.24996280670166, 161.84308981895447, 163.4314522743225, 165.2850284576416]
[35.46666666666667, 34.266666666666666, 48.733333333333334, 46.05, 47.983333333333334, 48.75, 46.28333333333333, 44.21666666666667, 45.333333333333336, 45.016666666666666, 46.11666666666667, 47.36666666666667, 50.88333333333333, 50.166666666666664, 45.63333333333333, 42.6, 43.7, 45.766666666666666, 46.9, 47.65, 49.583333333333336, 52.45, 48.43333333333333, 50.43333333333333, 51.266666666666666, 51.38333333333333, 47.18333333333333, 49.06666666666667, 50.583333333333336, 45.333333333333336, 49.266666666666666, 46.3, 51.46666666666667, 46.85, 49.4, 49.88333333333333, 52.21666666666667, 49.35, 45.333333333333336, 48.18333333333333, 48.71666666666667, 49.65, 50.85, 49.46666666666667, 51.13333333333333, 50.233333333333334, 49.43333333333333, 49.81666666666667, 49.36666666666667, 50.65, 51.416666666666664, 52.2, 49.75, 51.733333333333334, 48.766666666666666, 50.65, 50.36666666666667, 50.35, 52.0, 51.21666666666667, 49.25, 44.8, 50.18333333333333, 48.3, 51.35, 50.8, 47.333333333333336, 49.083333333333336, 50.18333333333333, 51.53333333333333, 51.733333333333334, 51.45, 51.78333333333333, 50.93333333333333, 53.2, 50.85, 47.56666666666667, 47.85, 49.78333333333333, 52.0, 50.71666666666667, 49.36666666666667, 49.2, 49.81666666666667, 50.733333333333334, 52.983333333333334, 46.25, 48.4, 50.43333333333333, 49.38333333333333, 51.333333333333336, 47.583333333333336, 50.61666666666667, 50.516666666666666, 46.916666666666664, 49.95, 48.5, 50.016666666666666, 51.016666666666666, 50.85, 52.333333333333336]
/data/jij/csm/code/FL_HLS/utils/sampling.py:91: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fed_apfl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
Round   0, Train loss: 1.573, Test loss: 2.194, Test accuracy: 51.82
Round   1, Train loss: 1.276, Test loss: 2.011, Test accuracy: 63.73
Round   2, Train loss: 1.206, Test loss: 1.914, Test accuracy: 71.48
Round   3, Train loss: 1.155, Test loss: 1.851, Test accuracy: 76.97
Round   4, Train loss: 1.171, Test loss: 1.812, Test accuracy: 79.27
Round   5, Train loss: 1.241, Test loss: 1.784, Test accuracy: 80.27
Round   6, Train loss: 1.161, Test loss: 1.740, Test accuracy: 83.93
Round   7, Train loss: 1.148, Test loss: 1.729, Test accuracy: 84.05
Round   8, Train loss: 1.112, Test loss: 1.710, Test accuracy: 85.38
Round   9, Train loss: 1.146, Test loss: 1.694, Test accuracy: 85.60
Round  10, Train loss: 1.107, Test loss: 1.687, Test accuracy: 85.60
Round  11, Train loss: 1.104, Test loss: 1.674, Test accuracy: 86.67
Round  12, Train loss: 1.176, Test loss: 1.663, Test accuracy: 87.35
Round  13, Train loss: 1.149, Test loss: 1.652, Test accuracy: 87.65
Round  14, Train loss: 1.143, Test loss: 1.642, Test accuracy: 88.32
Round  15, Train loss: 1.146, Test loss: 1.625, Test accuracy: 89.48
Round  16, Train loss: 1.106, Test loss: 1.621, Test accuracy: 89.48
Round  17, Train loss: 1.102, Test loss: 1.617, Test accuracy: 89.60
Round  18, Train loss: 1.123, Test loss: 1.599, Test accuracy: 91.18
Round  19, Train loss: 1.143, Test loss: 1.596, Test accuracy: 91.25
Round  20, Train loss: 1.107, Test loss: 1.593, Test accuracy: 91.20
Round  21, Train loss: 1.144, Test loss: 1.592, Test accuracy: 90.95
Round  22, Train loss: 1.104, Test loss: 1.589, Test accuracy: 91.15
Round  23, Train loss: 1.144, Test loss: 1.588, Test accuracy: 91.28
Round  24, Train loss: 1.102, Test loss: 1.584, Test accuracy: 91.33
Round  25, Train loss: 1.100, Test loss: 1.583, Test accuracy: 91.23
Round  26, Train loss: 1.102, Test loss: 1.584, Test accuracy: 91.08
Round  27, Train loss: 1.142, Test loss: 1.582, Test accuracy: 91.30
Round  28, Train loss: 1.185, Test loss: 1.583, Test accuracy: 91.15
Round  29, Train loss: 1.102, Test loss: 1.582, Test accuracy: 91.15
Round  30, Train loss: 1.146, Test loss: 1.581, Test accuracy: 91.17
Round  31, Train loss: 1.142, Test loss: 1.580, Test accuracy: 91.15
Round  32, Train loss: 1.143, Test loss: 1.578, Test accuracy: 91.30
Round  33, Train loss: 1.144, Test loss: 1.575, Test accuracy: 91.17
Round  34, Train loss: 1.142, Test loss: 1.573, Test accuracy: 91.15
Round  35, Train loss: 1.102, Test loss: 1.572, Test accuracy: 91.18
Round  36, Train loss: 1.143, Test loss: 1.572, Test accuracy: 91.22
Round  37, Train loss: 1.099, Test loss: 1.571, Test accuracy: 91.23
Round  38, Train loss: 1.100, Test loss: 1.571, Test accuracy: 91.25
Round  39, Train loss: 1.140, Test loss: 1.570, Test accuracy: 91.27
Round  40, Train loss: 1.142, Test loss: 1.569, Test accuracy: 91.28
Round  41, Train loss: 1.140, Test loss: 1.569, Test accuracy: 91.27
Round  42, Train loss: 1.099, Test loss: 1.567, Test accuracy: 91.30
Round  43, Train loss: 1.141, Test loss: 1.568, Test accuracy: 91.28
Round  44, Train loss: 1.181, Test loss: 1.568, Test accuracy: 91.33
Round  45, Train loss: 1.103, Test loss: 1.567, Test accuracy: 91.37
Round  46, Train loss: 1.098, Test loss: 1.566, Test accuracy: 91.30
Round  47, Train loss: 1.099, Test loss: 1.566, Test accuracy: 91.28
Round  48, Train loss: 1.139, Test loss: 1.566, Test accuracy: 91.30
Round  49, Train loss: 1.101, Test loss: 1.564, Test accuracy: 91.50
Round  50, Train loss: 1.181, Test loss: 1.565, Test accuracy: 91.47
Round  51, Train loss: 1.100, Test loss: 1.564, Test accuracy: 91.45
Round  52, Train loss: 1.139, Test loss: 1.564, Test accuracy: 91.37
Round  53, Train loss: 1.100, Test loss: 1.564, Test accuracy: 91.37
Round  54, Train loss: 1.141, Test loss: 1.563, Test accuracy: 91.40
Round  55, Train loss: 1.143, Test loss: 1.563, Test accuracy: 91.37
Round  56, Train loss: 1.099, Test loss: 1.563, Test accuracy: 91.33
Round  57, Train loss: 1.143, Test loss: 1.563, Test accuracy: 91.28
Round  58, Train loss: 1.141, Test loss: 1.563, Test accuracy: 91.20
Round  59, Train loss: 1.180, Test loss: 1.563, Test accuracy: 91.15
Round  60, Train loss: 1.098, Test loss: 1.563, Test accuracy: 91.12
Round  61, Train loss: 1.140, Test loss: 1.563, Test accuracy: 91.20
Round  62, Train loss: 1.140, Test loss: 1.562, Test accuracy: 91.15
Round  63, Train loss: 1.138, Test loss: 1.562, Test accuracy: 91.12
Round  64, Train loss: 1.139, Test loss: 1.562, Test accuracy: 91.15
Round  65, Train loss: 1.100, Test loss: 1.562, Test accuracy: 91.08
Round  66, Train loss: 1.141, Test loss: 1.563, Test accuracy: 91.02
Round  67, Train loss: 1.098, Test loss: 1.563, Test accuracy: 90.98
Round  68, Train loss: 1.099, Test loss: 1.563, Test accuracy: 90.90
Round  69, Train loss: 1.139, Test loss: 1.563, Test accuracy: 90.98
Round  70, Train loss: 1.100, Test loss: 1.563, Test accuracy: 90.83
Round  71, Train loss: 1.141, Test loss: 1.563, Test accuracy: 90.83
Round  72, Train loss: 1.099, Test loss: 1.564, Test accuracy: 90.78
Round  73, Train loss: 1.100, Test loss: 1.565, Test accuracy: 90.67
Round  74, Train loss: 1.140, Test loss: 1.565, Test accuracy: 90.63
Round  75, Train loss: 1.100, Test loss: 1.565, Test accuracy: 90.63
Round  76, Train loss: 1.098, Test loss: 1.565, Test accuracy: 90.62
Round  77, Train loss: 1.098, Test loss: 1.564, Test accuracy: 90.55
Round  78, Train loss: 1.139, Test loss: 1.565, Test accuracy: 90.48
Round  79, Train loss: 1.138, Test loss: 1.565, Test accuracy: 90.53
Round  80, Train loss: 1.100, Test loss: 1.565, Test accuracy: 90.58
Round  81, Train loss: 1.100, Test loss: 1.565, Test accuracy: 90.47
Round  82, Train loss: 1.098, Test loss: 1.565, Test accuracy: 90.58
Round  83, Train loss: 1.139, Test loss: 1.565, Test accuracy: 90.43
Round  84, Train loss: 1.098, Test loss: 1.565, Test accuracy: 90.43
Round  85, Train loss: 1.100, Test loss: 1.565, Test accuracy: 90.38
Round  86, Train loss: 1.098, Test loss: 1.565, Test accuracy: 90.32
Round  87, Train loss: 1.142, Test loss: 1.565, Test accuracy: 90.32
Round  88, Train loss: 1.100, Test loss: 1.564, Test accuracy: 90.40
Round  89, Train loss: 1.139, Test loss: 1.565, Test accuracy: 90.37
Round  90, Train loss: 1.139, Test loss: 1.564, Test accuracy: 90.40
Round  91, Train loss: 1.099, Test loss: 1.564, Test accuracy: 90.35
Round  92, Train loss: 1.140, Test loss: 1.565, Test accuracy: 90.25
Round  93, Train loss: 1.099, Test loss: 1.565, Test accuracy: 90.38
Round  94, Train loss: 1.098, Test loss: 1.565, Test accuracy: 90.30
Round  95, Train loss: 1.099, Test loss: 1.565, Test accuracy: 90.32
Round  96, Train loss: 1.097, Test loss: 1.566, Test accuracy: 90.20
Round  97, Train loss: 1.101, Test loss: 1.566, Test accuracy: 90.13
Round  98, Train loss: 1.102, Test loss: 1.565, Test accuracy: 90.35
Round  99, Train loss: 1.140, Test loss: 1.564, Test accuracy: 90.38
Final Round, Train loss: 1.123, Test loss: 1.565, Test accuracy: 90.27
Average accuracy final 10 rounds: 90.30666666666667
917.0544362068176
[]
[51.81666666666667, 63.733333333333334, 71.48333333333333, 76.96666666666667, 79.26666666666667, 80.26666666666667, 83.93333333333334, 84.05, 85.38333333333334, 85.6, 85.6, 86.66666666666667, 87.35, 87.65, 88.31666666666666, 89.48333333333333, 89.48333333333333, 89.6, 91.18333333333334, 91.25, 91.2, 90.95, 91.15, 91.28333333333333, 91.33333333333333, 91.23333333333333, 91.08333333333333, 91.3, 91.15, 91.15, 91.16666666666667, 91.15, 91.3, 91.16666666666667, 91.15, 91.18333333333334, 91.21666666666667, 91.23333333333333, 91.25, 91.26666666666667, 91.28333333333333, 91.26666666666667, 91.3, 91.28333333333333, 91.33333333333333, 91.36666666666666, 91.3, 91.28333333333333, 91.3, 91.5, 91.46666666666667, 91.45, 91.36666666666666, 91.36666666666666, 91.4, 91.36666666666666, 91.33333333333333, 91.28333333333333, 91.2, 91.15, 91.11666666666666, 91.2, 91.15, 91.11666666666666, 91.15, 91.08333333333333, 91.01666666666667, 90.98333333333333, 90.9, 90.98333333333333, 90.83333333333333, 90.83333333333333, 90.78333333333333, 90.66666666666667, 90.63333333333334, 90.63333333333334, 90.61666666666666, 90.55, 90.48333333333333, 90.53333333333333, 90.58333333333333, 90.46666666666667, 90.58333333333333, 90.43333333333334, 90.43333333333334, 90.38333333333334, 90.31666666666666, 90.31666666666666, 90.4, 90.36666666666666, 90.4, 90.35, 90.25, 90.38333333333334, 90.3, 90.31666666666666, 90.2, 90.13333333333334, 90.35, 90.38333333333334, 90.26666666666667]
