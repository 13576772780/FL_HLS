nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.434, Test loss: 1.339, Test accuracy: 52.68 

Round   0, Global train loss: 1.434, Global test loss: 2.659, Global test accuracy: 16.00 

Round   1, Train loss: 1.080, Test loss: 1.228, Test accuracy: 58.08 

Round   1, Global train loss: 1.080, Global test loss: 2.634, Global test accuracy: 16.00 

Round   2, Train loss: 0.892, Test loss: 1.243, Test accuracy: 60.12 

Round   2, Global train loss: 0.892, Global test loss: 2.687, Global test accuracy: 16.00 

Round   3, Train loss: 0.755, Test loss: 1.221, Test accuracy: 62.04 

Round   3, Global train loss: 0.755, Global test loss: 2.679, Global test accuracy: 16.00 

Round   4, Train loss: 0.626, Test loss: 1.279, Test accuracy: 63.48 

Round   4, Global train loss: 0.626, Global test loss: 2.640, Global test accuracy: 16.00 

Round   5, Train loss: 0.538, Test loss: 1.321, Test accuracy: 62.08 

Round   5, Global train loss: 0.538, Global test loss: 2.532, Global test accuracy: 16.00 

Round   6, Train loss: 0.449, Test loss: 1.407, Test accuracy: 65.24 

Round   6, Global train loss: 0.449, Global test loss: 2.624, Global test accuracy: 16.00 

Round   7, Train loss: 0.373, Test loss: 1.232, Test accuracy: 68.80 

Round   7, Global train loss: 0.373, Global test loss: 2.718, Global test accuracy: 16.00 

Round   8, Train loss: 0.311, Test loss: 1.525, Test accuracy: 63.44 

Round   8, Global train loss: 0.311, Global test loss: 2.909, Global test accuracy: 16.00 

Round   9, Train loss: 0.248, Test loss: 1.356, Test accuracy: 69.36 

Round   9, Global train loss: 0.248, Global test loss: 2.767, Global test accuracy: 16.00 

Round  10, Train loss: 0.224, Test loss: 1.404, Test accuracy: 67.72 

Round  10, Global train loss: 0.224, Global test loss: 2.655, Global test accuracy: 16.00 

Round  11, Train loss: 0.181, Test loss: 1.517, Test accuracy: 66.64 

Round  11, Global train loss: 0.181, Global test loss: 2.752, Global test accuracy: 16.00 

Round  12, Train loss: 0.152, Test loss: 1.578, Test accuracy: 67.84 

Round  12, Global train loss: 0.152, Global test loss: 2.857, Global test accuracy: 16.00 

Round  13, Train loss: 0.133, Test loss: 1.574, Test accuracy: 69.96 

Round  13, Global train loss: 0.133, Global test loss: 2.695, Global test accuracy: 16.00 

Round  14, Train loss: 0.141, Test loss: 1.431, Test accuracy: 69.24 

Round  14, Global train loss: 0.141, Global test loss: 2.600, Global test accuracy: 16.00 

Round  15, Train loss: 0.102, Test loss: 1.456, Test accuracy: 70.16 

Round  15, Global train loss: 0.102, Global test loss: 2.702, Global test accuracy: 16.00 

Round  16, Train loss: 0.097, Test loss: 1.568, Test accuracy: 69.96 

Round  16, Global train loss: 0.097, Global test loss: 2.582, Global test accuracy: 16.00 

Round  17, Train loss: 0.085, Test loss: 1.666, Test accuracy: 68.44 

Round  17, Global train loss: 0.085, Global test loss: 2.541, Global test accuracy: 16.00 

Round  18, Train loss: 0.063, Test loss: 1.495, Test accuracy: 71.52 

Round  18, Global train loss: 0.063, Global test loss: 2.638, Global test accuracy: 16.00 

Round  19, Train loss: 0.060, Test loss: 1.564, Test accuracy: 70.76 

Round  19, Global train loss: 0.060, Global test loss: 2.746, Global test accuracy: 16.00 

Round  20, Train loss: 0.075, Test loss: 1.765, Test accuracy: 68.84 

Round  20, Global train loss: 0.075, Global test loss: 2.737, Global test accuracy: 16.00 

Round  21, Train loss: 0.066, Test loss: 1.560, Test accuracy: 70.52 

Round  21, Global train loss: 0.066, Global test loss: 2.605, Global test accuracy: 16.00 

Round  22, Train loss: 0.058, Test loss: 1.725, Test accuracy: 67.72 

Round  22, Global train loss: 0.058, Global test loss: 2.591, Global test accuracy: 16.00 

Round  23, Train loss: 0.048, Test loss: 1.668, Test accuracy: 69.00 

Round  23, Global train loss: 0.048, Global test loss: 2.669, Global test accuracy: 16.00 

Round  24, Train loss: 0.039, Test loss: 1.731, Test accuracy: 70.88 

Round  24, Global train loss: 0.039, Global test loss: 2.668, Global test accuracy: 16.00 

Round  25, Train loss: 0.028, Test loss: 1.587, Test accuracy: 72.12 

Round  25, Global train loss: 0.028, Global test loss: 2.688, Global test accuracy: 16.00 

Round  26, Train loss: 0.034, Test loss: 1.650, Test accuracy: 70.56 

Round  26, Global train loss: 0.034, Global test loss: 2.643, Global test accuracy: 16.00 

Round  27, Train loss: 0.024, Test loss: 1.660, Test accuracy: 71.88 

Round  27, Global train loss: 0.024, Global test loss: 2.720, Global test accuracy: 16.00 

Round  28, Train loss: 0.012, Test loss: 1.652, Test accuracy: 72.44 

Round  28, Global train loss: 0.012, Global test loss: 2.609, Global test accuracy: 16.00 

Round  29, Train loss: 0.026, Test loss: 1.659, Test accuracy: 71.92 

Round  29, Global train loss: 0.026, Global test loss: 2.594, Global test accuracy: 16.00 

Round  30, Train loss: 0.031, Test loss: 1.645, Test accuracy: 71.44 

Round  30, Global train loss: 0.031, Global test loss: 2.663, Global test accuracy: 16.00 

Round  31, Train loss: 0.031, Test loss: 1.702, Test accuracy: 70.92 

Round  31, Global train loss: 0.031, Global test loss: 2.662, Global test accuracy: 16.00 

Round  32, Train loss: 0.043, Test loss: 1.602, Test accuracy: 72.08 

Round  32, Global train loss: 0.043, Global test loss: 2.559, Global test accuracy: 16.00 

Round  33, Train loss: 0.028, Test loss: 1.700, Test accuracy: 70.24 

Round  33, Global train loss: 0.028, Global test loss: 2.529, Global test accuracy: 16.00 

Round  34, Train loss: 0.013, Test loss: 1.666, Test accuracy: 72.24 

Round  34, Global train loss: 0.013, Global test loss: 2.531, Global test accuracy: 16.00 

Final Round, Train loss: 0.020, Test loss: 1.684, Test accuracy: 72.12 

Final Round, Global train loss: 0.020, Global test loss: 2.531, Global test accuracy: 16.00 

Average accuracy final 10 rounds: 71.58399999999999 

Average global accuracy final 10 rounds: 15.999999999999998 

1465.1981296539307
[12.881234884262085, 19.793549299240112, 26.8139386177063, 33.87826657295227, 40.82390761375427, 47.798359394073486, 54.91713213920593, 61.84984612464905, 68.99161410331726, 75.94703555107117, 83.01177835464478, 90.11986708641052, 97.07283568382263, 104.02237582206726, 111.03553509712219, 117.86400079727173, 124.77843523025513, 131.8902292251587, 138.83018612861633, 145.7457938194275, 152.6435866355896, 159.64243268966675, 166.70465970039368, 173.58110189437866, 180.14794850349426, 186.67273473739624, 193.05885529518127, 199.5234293937683, 205.94127821922302, 212.39824414253235, 218.81338262557983, 225.2373387813568, 231.67144465446472, 238.17936825752258, 244.5944640636444, 257.54748916625977]
[52.68, 58.08, 60.12, 62.04, 63.48, 62.08, 65.24, 68.8, 63.44, 69.36, 67.72, 66.64, 67.84, 69.96, 69.24, 70.16, 69.96, 68.44, 71.52, 70.76, 68.84, 70.52, 67.72, 69.0, 70.88, 72.12, 70.56, 71.88, 72.44, 71.92, 71.44, 70.92, 72.08, 70.24, 72.24, 72.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.437, Test loss: 1.398, Test accuracy: 50.20 

Round   0, Global train loss: 1.437, Global test loss: 2.363, Global test accuracy: 16.00 

Round   1, Train loss: 1.293, Test loss: 1.319, Test accuracy: 52.56 

Round   1, Global train loss: 1.293, Global test loss: 2.185, Global test accuracy: 24.44 

Round   2, Train loss: 1.163, Test loss: 1.252, Test accuracy: 53.88 

Round   2, Global train loss: 1.163, Global test loss: 1.840, Global test accuracy: 36.44 

Round   3, Train loss: 1.026, Test loss: 1.199, Test accuracy: 59.56 

Round   3, Global train loss: 1.026, Global test loss: 1.704, Global test accuracy: 42.92 

Round   4, Train loss: 0.927, Test loss: 1.174, Test accuracy: 62.40 

Round   4, Global train loss: 0.927, Global test loss: 1.633, Global test accuracy: 44.84 

Round   5, Train loss: 0.851, Test loss: 1.068, Test accuracy: 63.68 

Round   5, Global train loss: 0.851, Global test loss: 1.672, Global test accuracy: 46.08 

Round   6, Train loss: 0.774, Test loss: 1.141, Test accuracy: 64.44 

Round   6, Global train loss: 0.774, Global test loss: 1.399, Global test accuracy: 52.44 

Round   7, Train loss: 0.707, Test loss: 1.061, Test accuracy: 66.84 

Round   7, Global train loss: 0.707, Global test loss: 1.320, Global test accuracy: 57.16 

Round   8, Train loss: 0.647, Test loss: 1.091, Test accuracy: 65.36 

Round   8, Global train loss: 0.647, Global test loss: 1.379, Global test accuracy: 54.64 

Round   9, Train loss: 0.605, Test loss: 1.210, Test accuracy: 65.24 

Round   9, Global train loss: 0.605, Global test loss: 1.312, Global test accuracy: 57.76 

Round  10, Train loss: 0.551, Test loss: 1.100, Test accuracy: 69.04 

Round  10, Global train loss: 0.551, Global test loss: 1.242, Global test accuracy: 59.28 

Round  11, Train loss: 0.518, Test loss: 1.217, Test accuracy: 67.20 

Round  11, Global train loss: 0.518, Global test loss: 1.458, Global test accuracy: 55.76 

Round  12, Train loss: 0.471, Test loss: 0.890, Test accuracy: 73.08 

Round  12, Global train loss: 0.471, Global test loss: 1.247, Global test accuracy: 60.16 

Round  13, Train loss: 0.428, Test loss: 1.025, Test accuracy: 71.00 

Round  13, Global train loss: 0.428, Global test loss: 1.233, Global test accuracy: 60.32 

Round  14, Train loss: 0.398, Test loss: 1.069, Test accuracy: 70.84 

Round  14, Global train loss: 0.398, Global test loss: 1.188, Global test accuracy: 63.12 

Round  15, Train loss: 0.371, Test loss: 1.051, Test accuracy: 72.20 

Round  15, Global train loss: 0.371, Global test loss: 1.276, Global test accuracy: 60.48 

Round  16, Train loss: 0.354, Test loss: 1.038, Test accuracy: 71.28 

Round  16, Global train loss: 0.354, Global test loss: 1.247, Global test accuracy: 62.56 

Round  17, Train loss: 0.313, Test loss: 1.002, Test accuracy: 73.32 

Round  17, Global train loss: 0.313, Global test loss: 1.216, Global test accuracy: 63.44 

Round  18, Train loss: 0.310, Test loss: 1.062, Test accuracy: 73.32 

Round  18, Global train loss: 0.310, Global test loss: 1.208, Global test accuracy: 64.92 

Round  19, Train loss: 0.279, Test loss: 1.223, Test accuracy: 70.76 

Round  19, Global train loss: 0.279, Global test loss: 1.192, Global test accuracy: 64.32 

Round  20, Train loss: 0.269, Test loss: 1.018, Test accuracy: 75.04 

Round  20, Global train loss: 0.269, Global test loss: 1.179, Global test accuracy: 64.28 

Round  21, Train loss: 0.240, Test loss: 1.191, Test accuracy: 71.84 

Round  21, Global train loss: 0.240, Global test loss: 1.187, Global test accuracy: 65.20 

Round  22, Train loss: 0.216, Test loss: 1.046, Test accuracy: 74.84 

Round  22, Global train loss: 0.216, Global test loss: 1.169, Global test accuracy: 65.80 

Round  23, Train loss: 0.214, Test loss: 1.067, Test accuracy: 73.68 

Round  23, Global train loss: 0.214, Global test loss: 1.119, Global test accuracy: 66.44 

Round  24, Train loss: 0.201, Test loss: 1.096, Test accuracy: 72.96 

Round  24, Global train loss: 0.201, Global test loss: 1.199, Global test accuracy: 65.96 

Round  25, Train loss: 0.183, Test loss: 1.453, Test accuracy: 69.24 

Round  25, Global train loss: 0.183, Global test loss: 1.173, Global test accuracy: 66.36 

Round  26, Train loss: 0.188, Test loss: 1.023, Test accuracy: 76.68 

Round  26, Global train loss: 0.188, Global test loss: 1.137, Global test accuracy: 67.24 

Round  27, Train loss: 0.159, Test loss: 1.037, Test accuracy: 76.28 

Round  27, Global train loss: 0.159, Global test loss: 1.197, Global test accuracy: 66.16 

Round  28, Train loss: 0.168, Test loss: 1.120, Test accuracy: 73.96 

Round  28, Global train loss: 0.168, Global test loss: 1.149, Global test accuracy: 67.48 

Round  29, Train loss: 0.152, Test loss: 1.137, Test accuracy: 75.28 

Round  29, Global train loss: 0.152, Global test loss: 1.266, Global test accuracy: 65.36 

Round  30, Train loss: 0.127, Test loss: 1.203, Test accuracy: 74.48 

Round  30, Global train loss: 0.127, Global test loss: 1.197, Global test accuracy: 67.60 

Round  31, Train loss: 0.135, Test loss: 1.129, Test accuracy: 74.84 

Round  31, Global train loss: 0.135, Global test loss: 1.206, Global test accuracy: 67.04 

Round  32, Train loss: 0.118, Test loss: 1.057, Test accuracy: 76.40 

Round  32, Global train loss: 0.118, Global test loss: 1.132, Global test accuracy: 67.88 

Round  33, Train loss: 0.111, Test loss: 1.061, Test accuracy: 75.76 

Round  33, Global train loss: 0.111, Global test loss: 1.194, Global test accuracy: 67.64 

Round  34, Train loss: 0.134, Test loss: 1.074, Test accuracy: 75.52 

Round  34, Global train loss: 0.134, Global test loss: 1.193, Global test accuracy: 67.24 

Round  35, Train loss: 0.106, Test loss: 0.954, Test accuracy: 77.24 

Round  35, Global train loss: 0.106, Global test loss: 1.161, Global test accuracy: 68.56 

Round  36, Train loss: 0.090, Test loss: 1.068, Test accuracy: 76.00 

Round  36, Global train loss: 0.090, Global test loss: 1.196, Global test accuracy: 68.24 

Round  37, Train loss: 0.067, Test loss: 1.067, Test accuracy: 76.28 

Round  37, Global train loss: 0.067, Global test loss: 1.206, Global test accuracy: 68.12 

Round  38, Train loss: 0.092, Test loss: 1.161, Test accuracy: 76.00 

Round  38, Global train loss: 0.092, Global test loss: 1.183, Global test accuracy: 67.16 

Round  39, Train loss: 0.087, Test loss: 1.166, Test accuracy: 75.40 

Round  39, Global train loss: 0.087, Global test loss: 1.166, Global test accuracy: 68.44 

Round  40, Train loss: 0.068, Test loss: 1.000, Test accuracy: 78.20 

Round  40, Global train loss: 0.068, Global test loss: 1.214, Global test accuracy: 68.28 

Round  41, Train loss: 0.074, Test loss: 1.039, Test accuracy: 77.92 

Round  41, Global train loss: 0.074, Global test loss: 1.154, Global test accuracy: 68.68 

Round  42, Train loss: 0.075, Test loss: 1.149, Test accuracy: 77.68 

Round  42, Global train loss: 0.075, Global test loss: 1.180, Global test accuracy: 68.32 

Round  43, Train loss: 0.058, Test loss: 0.998, Test accuracy: 79.32 

Round  43, Global train loss: 0.058, Global test loss: 1.213, Global test accuracy: 68.20 

Round  44, Train loss: 0.054, Test loss: 1.108, Test accuracy: 77.64 

Round  44, Global train loss: 0.054, Global test loss: 1.161, Global test accuracy: 69.40 

Round  45, Train loss: 0.072, Test loss: 1.445, Test accuracy: 73.64 

Round  45, Global train loss: 0.072, Global test loss: 1.224, Global test accuracy: 67.92 

Round  46, Train loss: 0.044, Test loss: 0.991, Test accuracy: 78.68 

Round  46, Global train loss: 0.044, Global test loss: 1.183, Global test accuracy: 69.00 

Round  47, Train loss: 0.041, Test loss: 1.148, Test accuracy: 77.56 

Round  47, Global train loss: 0.041, Global test loss: 1.239, Global test accuracy: 68.60 

Round  48, Train loss: 0.031, Test loss: 1.016, Test accuracy: 79.12 

Round  48, Global train loss: 0.031, Global test loss: 1.210, Global test accuracy: 69.20 

Round  49, Train loss: 0.055, Test loss: 1.088, Test accuracy: 78.56 

Round  49, Global train loss: 0.055, Global test loss: 1.202, Global test accuracy: 69.20 

Final Round, Train loss: 0.074, Test loss: 1.274, Test accuracy: 76.16 

Final Round, Global train loss: 0.074, Global test loss: 1.202, Global test accuracy: 69.20 

Average accuracy final 10 rounds: 77.832 

Average global accuracy final 10 rounds: 68.67999999999999 

2117.9627656936646
[13.004499197006226, 20.430302143096924, 27.531039237976074, 34.5691921710968, 41.79527711868286, 48.97555947303772, 56.00116205215454, 63.1304235458374, 70.32321429252625, 77.43990111351013, 84.66295790672302, 91.52877116203308, 98.72666716575623, 105.7279851436615, 112.68757176399231, 119.66033673286438, 126.64051485061646, 133.9510486125946, 141.27006196975708, 148.5718858242035, 155.90541100502014, 163.09742951393127, 169.9661829471588, 176.96602368354797, 184.0699188709259, 191.4846270084381, 198.33485984802246, 205.27393102645874, 212.2299222946167, 219.2915437221527, 226.69991612434387, 233.73102855682373, 240.6784164905548, 247.81520581245422, 254.83857107162476, 261.7275080680847, 268.80560851097107, 275.8118772506714, 282.65618348121643, 289.4682583808899, 296.3820662498474, 303.5974717140198, 310.74539828300476, 317.72207474708557, 324.8421587944031, 331.7904453277588, 338.8020830154419, 346.11260890960693, 353.14917063713074, 360.2673499584198, 374.1725125312805]
[50.2, 52.56, 53.88, 59.56, 62.4, 63.68, 64.44, 66.84, 65.36, 65.24, 69.04, 67.2, 73.08, 71.0, 70.84, 72.2, 71.28, 73.32, 73.32, 70.76, 75.04, 71.84, 74.84, 73.68, 72.96, 69.24, 76.68, 76.28, 73.96, 75.28, 74.48, 74.84, 76.4, 75.76, 75.52, 77.24, 76.0, 76.28, 76.0, 75.4, 78.2, 77.92, 77.68, 79.32, 77.64, 73.64, 78.68, 77.56, 79.12, 78.56, 76.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.538, Test loss: 1.795, Test accuracy: 24.80 

Round   1, Train loss: 1.334, Test loss: 1.595, Test accuracy: 34.60 

Round   2, Train loss: 1.205, Test loss: 1.335, Test accuracy: 43.96 

Round   3, Train loss: 1.095, Test loss: 1.143, Test accuracy: 53.84 

Round   4, Train loss: 1.010, Test loss: 1.115, Test accuracy: 54.88 

Round   5, Train loss: 0.948, Test loss: 1.119, Test accuracy: 55.08 

Round   6, Train loss: 0.902, Test loss: 0.987, Test accuracy: 62.04 

Round   7, Train loss: 0.835, Test loss: 0.915, Test accuracy: 64.80 

Round   8, Train loss: 0.786, Test loss: 0.915, Test accuracy: 65.72 

Round   9, Train loss: 0.739, Test loss: 0.889, Test accuracy: 65.40 

Round  10, Train loss: 0.689, Test loss: 0.789, Test accuracy: 70.00 

Round  11, Train loss: 0.631, Test loss: 0.733, Test accuracy: 72.16 

Round  12, Train loss: 0.601, Test loss: 0.732, Test accuracy: 73.60 

Round  13, Train loss: 0.560, Test loss: 0.776, Test accuracy: 72.64 

Round  14, Train loss: 0.523, Test loss: 0.706, Test accuracy: 73.16 

Round  15, Train loss: 0.497, Test loss: 0.703, Test accuracy: 74.36 

Round  16, Train loss: 0.462, Test loss: 0.703, Test accuracy: 75.28 

Round  17, Train loss: 0.428, Test loss: 0.669, Test accuracy: 76.36 

Round  18, Train loss: 0.407, Test loss: 0.687, Test accuracy: 76.64 

Round  19, Train loss: 0.385, Test loss: 0.665, Test accuracy: 77.04 

Round  20, Train loss: 0.366, Test loss: 0.658, Test accuracy: 77.04 

Round  21, Train loss: 0.343, Test loss: 0.702, Test accuracy: 76.56 

Round  22, Train loss: 0.307, Test loss: 0.655, Test accuracy: 77.40 

Round  23, Train loss: 0.299, Test loss: 0.654, Test accuracy: 77.72 

Round  24, Train loss: 0.276, Test loss: 0.633, Test accuracy: 78.36 

Round  25, Train loss: 0.254, Test loss: 0.695, Test accuracy: 76.84 

Round  26, Train loss: 0.244, Test loss: 0.681, Test accuracy: 78.52 

Round  27, Train loss: 0.233, Test loss: 0.645, Test accuracy: 79.08 

Round  28, Train loss: 0.206, Test loss: 0.643, Test accuracy: 79.60 

Round  29, Train loss: 0.199, Test loss: 0.708, Test accuracy: 78.32 

Round  30, Train loss: 0.205, Test loss: 0.696, Test accuracy: 78.20 

Round  31, Train loss: 0.175, Test loss: 0.648, Test accuracy: 79.16 

Round  32, Train loss: 0.163, Test loss: 0.729, Test accuracy: 77.56 

Round  33, Train loss: 0.160, Test loss: 0.664, Test accuracy: 79.48 

Round  34, Train loss: 0.141, Test loss: 0.703, Test accuracy: 78.48 

Round  35, Train loss: 0.140, Test loss: 0.680, Test accuracy: 79.76 

Round  36, Train loss: 0.127, Test loss: 0.663, Test accuracy: 80.00 

Round  37, Train loss: 0.127, Test loss: 0.663, Test accuracy: 80.36 

Round  38, Train loss: 0.111, Test loss: 0.689, Test accuracy: 80.08 

Round  39, Train loss: 0.115, Test loss: 0.723, Test accuracy: 79.12 

Round  40, Train loss: 0.106, Test loss: 0.665, Test accuracy: 80.44 

Round  41, Train loss: 0.103, Test loss: 0.658, Test accuracy: 80.12 

Round  42, Train loss: 0.091, Test loss: 0.690, Test accuracy: 80.24 

Round  43, Train loss: 0.092, Test loss: 0.715, Test accuracy: 80.28 

Round  44, Train loss: 0.082, Test loss: 0.679, Test accuracy: 80.84 

Round  45, Train loss: 0.065, Test loss: 0.691, Test accuracy: 80.72 

Round  46, Train loss: 0.066, Test loss: 0.684, Test accuracy: 80.72 

Round  47, Train loss: 0.071, Test loss: 0.708, Test accuracy: 79.84 

Round  48, Train loss: 0.070, Test loss: 0.720, Test accuracy: 79.96 

Round  49, Train loss: 0.063, Test loss: 0.757, Test accuracy: 79.76 

Final Round, Train loss: 0.035, Test loss: 0.744, Test accuracy: 80.24 

Average accuracy final 10 rounds: 80.29199999999999 

1488.5695934295654
[11.278446197509766, 16.590208292007446, 21.66517686843872, 27.134496688842773, 32.465306997299194, 37.59679985046387, 43.013561725616455, 48.31712508201599, 53.38344740867615, 58.45972681045532, 64.16616892814636, 69.23731184005737, 74.45034575462341, 80.1679196357727, 85.88024592399597, 91.28911566734314, 96.77577829360962, 102.12871527671814, 107.60270357131958, 112.8991162776947, 118.22676682472229, 123.62302494049072, 129.0824112892151, 134.6549084186554, 140.14037537574768, 145.61698484420776, 150.94305634498596, 156.41406655311584, 161.7669768333435, 167.08541679382324, 172.38344383239746, 177.730366230011, 183.0838179588318, 188.53823947906494, 193.92052102088928, 199.26666355133057, 204.68169927597046, 210.01381063461304, 215.31522464752197, 220.70998287200928, 226.00840735435486, 231.29125142097473, 236.61733102798462, 241.81774473190308, 247.32381796836853, 252.7294864654541, 258.2586851119995, 263.7553391456604, 269.1261405944824, 274.5286331176758, 280.09721755981445]
[24.8, 34.6, 43.96, 53.84, 54.88, 55.08, 62.04, 64.8, 65.72, 65.4, 70.0, 72.16, 73.6, 72.64, 73.16, 74.36, 75.28, 76.36, 76.64, 77.04, 77.04, 76.56, 77.4, 77.72, 78.36, 76.84, 78.52, 79.08, 79.6, 78.32, 78.2, 79.16, 77.56, 79.48, 78.48, 79.76, 80.0, 80.36, 80.08, 79.12, 80.44, 80.12, 80.24, 80.28, 80.84, 80.72, 80.72, 79.84, 79.96, 79.76, 80.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.553, Test loss: 1.815, Test accuracy: 27.40
Round   1, Train loss: 1.348, Test loss: 1.434, Test accuracy: 40.44
Round   2, Train loss: 1.191, Test loss: 1.240, Test accuracy: 51.08
Round   3, Train loss: 1.082, Test loss: 1.090, Test accuracy: 54.88
Round   4, Train loss: 0.981, Test loss: 1.050, Test accuracy: 61.40
Round   5, Train loss: 0.925, Test loss: 0.888, Test accuracy: 65.72
Round   6, Train loss: 0.863, Test loss: 0.875, Test accuracy: 65.12
Round   7, Train loss: 0.824, Test loss: 0.890, Test accuracy: 65.64
Round   8, Train loss: 0.759, Test loss: 0.924, Test accuracy: 65.48
Round   9, Train loss: 0.710, Test loss: 0.875, Test accuracy: 67.40
Round  10, Train loss: 0.673, Test loss: 0.865, Test accuracy: 67.56
Round  11, Train loss: 0.622, Test loss: 0.748, Test accuracy: 72.16
Round  12, Train loss: 0.588, Test loss: 0.709, Test accuracy: 74.28
Round  13, Train loss: 0.553, Test loss: 0.716, Test accuracy: 74.48
Round  14, Train loss: 0.493, Test loss: 0.676, Test accuracy: 75.44
Round  15, Train loss: 0.475, Test loss: 0.668, Test accuracy: 76.32
Round  16, Train loss: 0.449, Test loss: 0.674, Test accuracy: 76.44
Round  17, Train loss: 0.422, Test loss: 0.688, Test accuracy: 75.96
Round  18, Train loss: 0.388, Test loss: 0.655, Test accuracy: 77.00
Round  19, Train loss: 0.377, Test loss: 0.673, Test accuracy: 77.08
Round  20, Train loss: 0.351, Test loss: 0.637, Test accuracy: 77.84
Round  21, Train loss: 0.331, Test loss: 0.628, Test accuracy: 77.88
Round  22, Train loss: 0.310, Test loss: 0.635, Test accuracy: 78.12
Round  23, Train loss: 0.299, Test loss: 0.734, Test accuracy: 76.76
Round  24, Train loss: 0.270, Test loss: 0.637, Test accuracy: 78.84
Round  25, Train loss: 0.256, Test loss: 0.610, Test accuracy: 79.68
Round  26, Train loss: 0.229, Test loss: 0.639, Test accuracy: 79.56
Round  27, Train loss: 0.229, Test loss: 0.640, Test accuracy: 79.52
Round  28, Train loss: 0.216, Test loss: 0.625, Test accuracy: 80.20
Round  29, Train loss: 0.199, Test loss: 0.647, Test accuracy: 79.84
Round  30, Train loss: 0.179, Test loss: 0.622, Test accuracy: 80.16
Round  31, Train loss: 0.189, Test loss: 0.638, Test accuracy: 80.08
Round  32, Train loss: 0.163, Test loss: 0.639, Test accuracy: 79.56
Round  33, Train loss: 0.165, Test loss: 0.651, Test accuracy: 80.40
Round  34, Train loss: 0.155, Test loss: 0.635, Test accuracy: 81.32
Round  35, Train loss: 0.146, Test loss: 0.643, Test accuracy: 80.76
Round  36, Train loss: 0.130, Test loss: 0.619, Test accuracy: 81.28
Round  37, Train loss: 0.118, Test loss: 0.635, Test accuracy: 81.48
Round  38, Train loss: 0.134, Test loss: 0.640, Test accuracy: 81.52
Round  39, Train loss: 0.102, Test loss: 0.632, Test accuracy: 81.20
Round  40, Train loss: 0.113, Test loss: 0.661, Test accuracy: 81.20
Round  41, Train loss: 0.102, Test loss: 0.622, Test accuracy: 81.40
Round  42, Train loss: 0.085, Test loss: 0.671, Test accuracy: 80.56
Round  43, Train loss: 0.089, Test loss: 0.665, Test accuracy: 80.80
Round  44, Train loss: 0.083, Test loss: 0.672, Test accuracy: 80.72
Round  45, Train loss: 0.076, Test loss: 0.649, Test accuracy: 81.60
Round  46, Train loss: 0.077, Test loss: 0.658, Test accuracy: 81.28
Round  47, Train loss: 0.070, Test loss: 0.646, Test accuracy: 82.00
Round  48, Train loss: 0.059, Test loss: 0.662, Test accuracy: 81.16
Round  49, Train loss: 0.066, Test loss: 0.671, Test accuracy: 81.28
Final Round, Train loss: 0.036, Test loss: 0.663, Test accuracy: 81.56
Average accuracy final 10 rounds: 81.2
1762.8136253356934
[11.847084045410156, 18.166748046875, 24.499008655548096, 30.84909987449646, 37.667213678359985, 43.934205055236816, 50.22843098640442, 56.7845618724823, 63.42365336418152, 69.75770497322083, 76.15731954574585, 82.5282654762268, 88.74620985984802, 95.22606658935547, 101.6362817287445, 108.01311302185059, 114.5894422531128, 121.00811958312988, 127.36453485488892, 134.5376513004303, 141.03973531723022, 147.56875443458557, 154.1620228290558, 160.79071807861328, 167.09380316734314, 173.61665391921997, 179.9953281879425, 186.41188716888428, 193.1726508140564, 200.22859001159668, 206.9011516571045, 213.35394763946533, 220.07823371887207, 226.56041073799133, 232.74478101730347, 239.14170622825623, 245.7394745349884, 252.27152490615845, 258.72208881378174, 265.58477449417114, 271.95512771606445, 278.56051778793335, 285.14676237106323, 292.009818315506, 298.85745191574097, 305.4575500488281, 311.77633476257324, 318.6005733013153, 324.88528847694397, 331.5535373687744, 338.3518805503845]
[27.4, 40.44, 51.08, 54.88, 61.4, 65.72, 65.12, 65.64, 65.48, 67.4, 67.56, 72.16, 74.28, 74.48, 75.44, 76.32, 76.44, 75.96, 77.0, 77.08, 77.84, 77.88, 78.12, 76.76, 78.84, 79.68, 79.56, 79.52, 80.2, 79.84, 80.16, 80.08, 79.56, 80.4, 81.32, 80.76, 81.28, 81.48, 81.52, 81.2, 81.2, 81.4, 80.56, 80.8, 80.72, 81.6, 81.28, 82.0, 81.16, 81.28, 81.56]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.137, Train accuracy: 96.000, Test loss: 0.989, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.100, Train accuracy: 97.800, Test loss: 0.988, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.094, Train accuracy: 96.600, Test loss: 1.287, Test accuracy: 69.80 

Round   0, Train loss: 0.094, Test loss: 1.287, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.056, Train accuracy: 98.600, Test loss: 1.101, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.600, Test loss: 1.395, Test accuracy: 69.80 

Round   1, Train loss: 0.054, Test loss: 1.395, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.274, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.162, Train accuracy: 93.600, Test loss: 1.871, Test accuracy: 66.00 

Round   2, Train loss: 0.162, Test loss: 1.871, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.400, Test loss: 1.253, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.454, Test accuracy: 71.00 

Round   3, Train loss: 0.022, Test loss: 1.454, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.062, Train accuracy: 98.600, Test loss: 1.524, Test accuracy: 70.00 

Round   4, Train loss: 0.062, Test loss: 1.524, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.407, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.199, Test accuracy: 74.60 

Round   5, Train loss: 0.004, Test loss: 1.199, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.200, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.258, Test accuracy: 74.60 

Round   6, Train loss: 0.008, Test loss: 1.258, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.288, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.491, Test accuracy: 74.40 

Round   7, Train loss: 0.036, Test loss: 1.491, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 73.80 

Round   8, Train loss: 0.004, Test loss: 1.320, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.335, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 74.40 

Round   9, Train loss: 0.007, Test loss: 1.435, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.396, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 74.60 

Round  10, Train loss: 0.002, Test loss: 1.361, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.323, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.195, Test accuracy: 75.80 

Round  11, Train loss: 0.001, Test loss: 1.195, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.299, Test accuracy: 76.40 

Round  12, Train loss: 0.001, Test loss: 1.299, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 98.400, Test loss: 1.916, Test accuracy: 71.80 

Round  13, Train loss: 0.031, Test loss: 1.916, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.440, Test accuracy: 76.60 

Round  14, Train loss: 0.000, Test loss: 1.440, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.443, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.395, Test accuracy: 77.00 

Round  15, Train loss: 0.000, Test loss: 1.395, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 72.00 

Round  16, Train loss: 0.000, Test loss: 1.505, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.486, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 75.20 

Round  17, Train loss: 0.000, Test loss: 1.377, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 74.80 

Round  18, Train loss: 0.002, Test loss: 1.374, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 75.20 

Round  19, Train loss: 0.001, Test loss: 1.376, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.352, Test accuracy: 76.00 

Final Round, Train loss: 0.000, Test loss: 1.355, Test accuracy: 76.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.648, Train accuracy: 74.000, Test loss: 0.793, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.627, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.622, Train accuracy: 77.200, Test loss: 0.753, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.201, Train accuracy: 93.400, Test loss: 0.765, Test accuracy: 76.60 

Round   0, Train loss: 0.101, Test loss: 1.012, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.322, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.249, Train accuracy: 93.000, Test loss: 0.691, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.106, Train accuracy: 96.800, Test loss: 0.838, Test accuracy: 78.80 

Round   1, Train loss: 0.056, Test loss: 1.012, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.210, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.249, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.112, Train accuracy: 97.000, Test loss: 0.669, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.400, Test loss: 0.959, Test accuracy: 77.00 

Round   2, Train loss: 0.038, Test loss: 1.034, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.600, Test loss: 0.742, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 0.798, Test accuracy: 78.20 

Round   3, Train loss: 0.016, Test loss: 0.947, Test accuracy: 79.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.600, Test loss: 0.781, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 98.800, Test loss: 1.128, Test accuracy: 75.00 

Round   4, Train loss: 0.026, Test loss: 1.021, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.240, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.803, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 0.928, Test accuracy: 78.40 

Round   5, Train loss: 0.012, Test loss: 0.992, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 1.299, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.153, Train accuracy: 95.000, Test loss: 1.201, Test accuracy: 72.80 

Round   6, Train loss: 0.092, Test loss: 1.088, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.065, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 0.854, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.130, Test accuracy: 76.20 

Round   7, Train loss: 0.004, Test loss: 0.997, Test accuracy: 78.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.203, Test accuracy: 76.00 

Round   8, Train loss: 0.009, Test loss: 1.150, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 79.40 

Round   9, Train loss: 0.001, Test loss: 0.990, Test accuracy: 79.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 79.60 

Round  10, Train loss: 0.001, Test loss: 1.047, Test accuracy: 79.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.154, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.117, Train accuracy: 97.400, Test loss: 1.212, Test accuracy: 75.60 

Round  11, Train loss: 0.059, Test loss: 1.125, Test accuracy: 78.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.187, Test accuracy: 78.00 

Round  12, Train loss: 0.010, Test loss: 1.149, Test accuracy: 78.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.159, Train accuracy: 94.800, Test loss: 1.625, Test accuracy: 72.20 

Round  13, Train loss: 0.080, Test loss: 1.197, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.320, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 78.80 

Round  14, Train loss: 0.002, Test loss: 1.090, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.998, Test accuracy: 76.80 

Round  15, Train loss: 0.003, Test loss: 1.071, Test accuracy: 78.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.281, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 78.60 

Round  16, Train loss: 0.002, Test loss: 1.134, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.185, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 80.20 

Round  17, Train loss: 0.000, Test loss: 1.038, Test accuracy: 79.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 80.00 

Round  18, Train loss: 0.000, Test loss: 1.037, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.331, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 80.00 

Round  19, Train loss: 0.000, Test loss: 1.113, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 79.40 

Final Round, Train loss: 0.000, Test loss: 1.084, Test accuracy: 79.30 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.681, Train accuracy: 73.000, Test loss: 0.909, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.965, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.728, Train accuracy: 72.000, Test loss: 0.927, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.203, Train accuracy: 93.400, Test loss: 1.232, Test accuracy: 69.00 

Round   0, Train loss: 0.071, Test loss: 0.965, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.071, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.386, Train accuracy: 85.200, Test loss: 0.913, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.100, Train accuracy: 97.200, Test loss: 1.152, Test accuracy: 70.60 

Round   1, Train loss: 0.036, Test loss: 0.982, Test accuracy: 76.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 82.20 

        train local model (freeze embeding):client   2,  Train loss: 0.207, Train accuracy: 93.800, Test loss: 0.993, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.053, Train accuracy: 98.600, Test loss: 1.271, Test accuracy: 70.20 

Round   2, Train loss: 0.018, Test loss: 0.996, Test accuracy: 77.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.029, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.090, Train accuracy: 97.600, Test loss: 1.004, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.112, Train accuracy: 96.000, Test loss: 1.497, Test accuracy: 66.80 

Round   3, Train loss: 0.038, Test loss: 1.009, Test accuracy: 76.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 80.60 

        train local model (freeze embeding):client   2,  Train loss: 0.057, Train accuracy: 99.200, Test loss: 1.137, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 98.000, Test loss: 1.402, Test accuracy: 68.60 

Round   4, Train loss: 0.022, Test loss: 0.955, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.150, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 98.600, Test loss: 1.383, Test accuracy: 69.60 

Round   5, Train loss: 0.013, Test loss: 0.960, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.177, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.111, Train accuracy: 96.000, Test loss: 1.748, Test accuracy: 66.80 

Round   6, Train loss: 0.039, Test loss: 1.011, Test accuracy: 77.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.249, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.601, Test accuracy: 68.60 

Round   7, Train loss: 0.013, Test loss: 1.018, Test accuracy: 77.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.755, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.219, Train accuracy: 93.600, Test loss: 2.251, Test accuracy: 61.80 

Round   8, Train loss: 0.073, Test loss: 1.016, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.782, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 81.60 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.268, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.554, Test accuracy: 73.00 

Round   9, Train loss: 0.002, Test loss: 1.020, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.782, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.000, Test loss: 1.525, Test accuracy: 71.80 

Round  10, Train loss: 0.014, Test loss: 1.041, Test accuracy: 78.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.122, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.547, Test accuracy: 71.80 

Round  11, Train loss: 0.005, Test loss: 1.048, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.830, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.005, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 70.40 

Round  12, Train loss: 0.004, Test loss: 0.998, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.947, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.823, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.556, Test accuracy: 72.00 

Round  13, Train loss: 0.002, Test loss: 1.073, Test accuracy: 78.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.089, Train accuracy: 96.800, Test loss: 1.554, Test accuracy: 71.40 

Round  14, Train loss: 0.030, Test loss: 1.041, Test accuracy: 78.73 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.400, Test loss: 0.868, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 1.872, Test accuracy: 67.60 

Round  15, Train loss: 0.028, Test loss: 1.042, Test accuracy: 78.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.200, Test loss: 1.676, Test accuracy: 68.80 

Round  16, Train loss: 0.009, Test loss: 1.047, Test accuracy: 79.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.844, Test accuracy: 70.00 

Round  17, Train loss: 0.007, Test loss: 1.054, Test accuracy: 78.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.734, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.451, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.539, Test accuracy: 73.20 

Round  18, Train loss: 0.001, Test loss: 1.092, Test accuracy: 78.87 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.855, Test accuracy: 71.20 

Round  19, Train loss: 0.006, Test loss: 1.095, Test accuracy: 79.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.780, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 83.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 75.20 

Final Round, Train loss: 0.000, Test loss: 1.086, Test accuracy: 79.27 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.579, Train accuracy: 77.800, Test loss: 0.771, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.783, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.543, Train accuracy: 80.800, Test loss: 0.716, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.084, Train accuracy: 98.600, Test loss: 0.861, Test accuracy: 75.60 

Round   0, Train loss: 0.021, Test loss: 0.944, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.933, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.302, Train accuracy: 88.200, Test loss: 0.694, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.055, Train accuracy: 98.400, Test loss: 0.912, Test accuracy: 75.40 

Round   1, Train loss: 0.017, Test loss: 0.909, Test accuracy: 79.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.393, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.800, Test loss: 1.441, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.193, Train accuracy: 92.800, Test loss: 0.730, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.136, Train accuracy: 95.200, Test loss: 1.150, Test accuracy: 71.40 

Round   2, Train loss: 0.040, Test loss: 0.882, Test accuracy: 80.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.846, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.110, Train accuracy: 97.000, Test loss: 0.753, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 0.962, Test accuracy: 75.60 

Round   3, Train loss: 0.012, Test loss: 0.891, Test accuracy: 79.95 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.715, Test accuracy: 69.20 

        train local model (freeze embeding):client   3,  Train loss: 0.064, Train accuracy: 98.800, Test loss: 0.789, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 1.051, Test accuracy: 76.00 

Round   4, Train loss: 0.017, Test loss: 0.939, Test accuracy: 79.35 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.581, Test accuracy: 70.60 

        train local model (freeze embeding):client   3,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 0.809, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.107, Test accuracy: 75.60 

Round   5, Train loss: 0.008, Test loss: 0.957, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.240, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.706, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.540, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.836, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.321, Train accuracy: 87.800, Test loss: 1.637, Test accuracy: 66.20 

Round   6, Train loss: 0.085, Test loss: 0.941, Test accuracy: 79.05 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.090, Train accuracy: 97.600, Test loss: 1.257, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.267, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.843, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 0.875, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.191, Test accuracy: 75.20 

Round   7, Train loss: 0.041, Test loss: 0.985, Test accuracy: 79.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.171, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.588, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 0.885, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.111, Test accuracy: 76.00 

Round   8, Train loss: 0.008, Test loss: 0.937, Test accuracy: 79.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.671, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.726, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.041, Train accuracy: 98.400, Test loss: 1.347, Test accuracy: 72.40 

Round   9, Train loss: 0.011, Test loss: 0.939, Test accuracy: 79.85 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.764, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.691, Test accuracy: 72.20 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.064, Train accuracy: 97.800, Test loss: 1.347, Test accuracy: 72.20 

Round  10, Train loss: 0.022, Test loss: 0.945, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.495, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.168, Test accuracy: 77.60 

Round  11, Train loss: 0.002, Test loss: 0.923, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.724, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.400, Test loss: 1.272, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.104, Test accuracy: 78.20 

Round  12, Train loss: 0.015, Test loss: 0.907, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.655, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.785, Test accuracy: 84.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 78.60 

Round  13, Train loss: 0.002, Test loss: 0.903, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.226, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.074, Train accuracy: 97.200, Test loss: 1.634, Test accuracy: 69.80 

Round  14, Train loss: 0.025, Test loss: 0.974, Test accuracy: 80.15 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.721, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.258, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.317, Test accuracy: 76.60 

Round  15, Train loss: 0.002, Test loss: 0.936, Test accuracy: 80.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.081, Train accuracy: 98.200, Test loss: 1.140, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.785, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 76.60 

Round  16, Train loss: 0.023, Test loss: 0.941, Test accuracy: 80.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.600, Test loss: 1.604, Test accuracy: 71.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 78.60 

Round  17, Train loss: 0.009, Test loss: 0.959, Test accuracy: 80.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.694, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 84.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.570, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 78.00 

Round  18, Train loss: 0.004, Test loss: 0.952, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 81.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.207, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 78.00 

Round  19, Train loss: 0.001, Test loss: 0.956, Test accuracy: 80.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.696, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 76.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 79.60 

Final Round, Train loss: 0.000, Test loss: 0.944, Test accuracy: 80.70 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.599, Train accuracy: 77.800, Test loss: 0.693, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.788, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.011, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.180, Test accuracy: 75.20 

        train local model (freeze embeding):client   4,  Train loss: 0.544, Train accuracy: 80.600, Test loss: 0.665, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.087, Train accuracy: 97.200, Test loss: 0.930, Test accuracy: 75.60 

Round   0, Train loss: 0.023, Test loss: 0.889, Test accuracy: 80.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.750, Test accuracy: 84.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 76.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.319, Test accuracy: 76.00 

        train local model (freeze embeding):client   4,  Train loss: 0.348, Train accuracy: 87.800, Test loss: 0.720, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.800, Test loss: 0.993, Test accuracy: 76.60 

Round   1, Train loss: 0.011, Test loss: 0.903, Test accuracy: 80.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 82.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.064, Train accuracy: 97.200, Test loss: 2.079, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 79.20 

        train local model (freeze embeding):client   4,  Train loss: 0.209, Train accuracy: 93.400, Test loss: 0.768, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.057, Train accuracy: 98.400, Test loss: 0.972, Test accuracy: 75.20 

Round   2, Train loss: 0.025, Test loss: 0.895, Test accuracy: 80.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.697, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.482, Test accuracy: 74.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 99.400, Test loss: 1.289, Test accuracy: 75.60 

        train local model (freeze embeding):client   4,  Train loss: 0.149, Train accuracy: 95.000, Test loss: 0.707, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.005, Test accuracy: 77.40 

Round   3, Train loss: 0.017, Test loss: 0.853, Test accuracy: 81.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.340, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.213, Test accuracy: 79.60 

        train local model (freeze embeding):client   4,  Train loss: 0.100, Train accuracy: 97.200, Test loss: 0.748, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.132, Train accuracy: 95.600, Test loss: 1.396, Test accuracy: 72.40 

Round   4, Train loss: 0.028, Test loss: 0.892, Test accuracy: 80.64 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.086, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.753, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 77.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.197, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.087, Train accuracy: 97.400, Test loss: 0.782, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.800, Test loss: 0.889, Test accuracy: 75.20 

Round   5, Train loss: 0.008, Test loss: 0.864, Test accuracy: 80.76 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 78.20 

        train local model (freeze embeding):client   4,  Train loss: 0.042, Train accuracy: 99.800, Test loss: 0.769, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.083, Train accuracy: 97.200, Test loss: 1.446, Test accuracy: 72.00 

Round   6, Train loss: 0.018, Test loss: 0.890, Test accuracy: 80.64 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.746, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.446, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.512, Test accuracy: 74.40 

        train local model (freeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 0.857, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.121, Test accuracy: 75.20 

Round   7, Train loss: 0.019, Test loss: 0.892, Test accuracy: 80.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.936, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 75.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 78.20 

        train local model (freeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 0.837, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.200, Test loss: 1.112, Test accuracy: 75.40 

Round   8, Train loss: 0.012, Test loss: 0.889, Test accuracy: 81.04 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.733, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 77.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.306, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 0.925, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 1.138, Test accuracy: 74.60 

Round   9, Train loss: 0.011, Test loss: 0.875, Test accuracy: 81.28 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.742, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 83.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.702, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 1.903, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.284, Test accuracy: 78.60 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 0.903, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.091, Test accuracy: 76.20 

Round  10, Train loss: 0.012, Test loss: 0.912, Test accuracy: 80.32 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.364, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.025, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 78.80 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 98.600, Test loss: 1.195, Test accuracy: 76.40 

Round  11, Train loss: 0.009, Test loss: 0.875, Test accuracy: 81.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.726, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.674, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 83.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.145, Test accuracy: 78.60 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 1.165, Test accuracy: 74.60 

Round  12, Train loss: 0.010, Test loss: 0.866, Test accuracy: 82.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.751, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.736, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.402, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.192, Test accuracy: 77.40 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 74.20 

Round  13, Train loss: 0.005, Test loss: 0.886, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 84.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.724, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.148, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 78.80 

Round  14, Train loss: 0.002, Test loss: 0.872, Test accuracy: 81.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.734, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.717, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.242, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.446, Test accuracy: 74.60 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.309, Test accuracy: 74.60 

Round  15, Train loss: 0.015, Test loss: 0.892, Test accuracy: 81.44 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.018, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.623, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 79.80 

Round  16, Train loss: 0.006, Test loss: 0.917, Test accuracy: 81.68 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.054, Train accuracy: 98.400, Test loss: 1.291, Test accuracy: 72.00 

Round  17, Train loss: 0.012, Test loss: 0.907, Test accuracy: 81.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.729, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.216, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.142, Train accuracy: 95.000, Test loss: 1.844, Test accuracy: 70.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.199, Test accuracy: 78.40 

Round  18, Train loss: 0.029, Test loss: 0.920, Test accuracy: 81.36 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.742, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.372, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.422, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.141, Test accuracy: 75.80 

Round  19, Train loss: 0.008, Test loss: 0.893, Test accuracy: 81.52 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 80.80 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 78.60 

Final Round, Train loss: 0.001, Test loss: 0.896, Test accuracy: 81.84 

Average accuracy final 10 rounds: 394.5803333333334 

6138.9842364788055
[19.03223991394043, 37.87529754638672, 57.07682180404663, 76.37036347389221, 95.30226445198059, 113.94114565849304, 132.82001495361328, 151.40860438346863, 170.67686581611633, 188.9625277519226, 208.7376971244812, 227.58266234397888, 246.3534801006317, 264.9057631492615, 284.3083288669586, 303.4117867946625, 322.47232031822205, 341.650089263916, 361.3953595161438, 380.7166361808777, 391.1695101261139, 410.854371547699, 429.7949552536011, 449.04893040657043, 468.3358654975891, 487.6868050098419, 507.01521825790405, 526.121768951416, 545.5413157939911, 564.6023669242859, 583.6949443817139, 602.7543580532074, 621.9361510276794, 641.0041654109955, 660.1373648643494, 679.2832298278809, 698.3550989627838, 717.6214666366577, 737.302885055542, 756.8156154155731, 776.8080201148987, 787.4401803016663, 806.7758357524872, 826.36248254776, 845.4925105571747, 864.6151723861694, 883.7019834518433, 902.8181600570679, 922.0249683856964, 941.7731909751892, 961.1112945079803, 980.4942798614502, 999.4280426502228, 1018.9866318702698, 1038.5235686302185, 1057.8331727981567, 1077.8891191482544, 1096.8360967636108, 1116.418496131897, 1135.6885344982147, 1154.7136578559875, 1173.5686521530151, 1184.586805343628, 1203.2356431484222, 1222.1955406665802, 1241.619369983673, 1260.4925599098206, 1279.5328209400177, 1298.489908695221, 1317.876537322998, 1336.559496164322, 1355.618057012558, 1374.7158634662628, 1393.652313709259, 1412.5252130031586, 1431.2252941131592, 1450.18816781044, 1469.1791791915894, 1489.1065328121185, 1508.1445291042328, 1527.452208518982, 1546.3346252441406, 1565.5947661399841, 1576.1990451812744, 1595.5597071647644, 1614.5328845977783, 1633.547213792801, 1652.7204496860504, 1671.7977306842804, 1691.4490399360657, 1710.8878951072693, 1730.2605907917023, 1749.0832998752594, 1768.123458623886, 1788.059434890747, 1807.341679096222, 1827.2488372325897, 1846.3927764892578, 1865.6495106220245, 1884.734530210495, 1903.7602441310883, 1922.553995847702, 1941.7623362541199, 1960.7650020122528, 1972.9977233409882]
[69.8, 69.8, 66.0, 71.0, 70.0, 74.6, 74.6, 74.4, 73.8, 74.4, 74.6, 75.8, 76.4, 71.8, 76.6, 77.0, 72.0, 75.2, 74.8, 75.2, 76.4, 76.6, 76.4, 77.4, 79.1, 78.5, 78.5, 76.6, 78.6, 77.5, 79.1, 79.4, 78.4, 78.1, 77.4, 81.1, 78.8, 78.2, 79.3, 79.2, 79.2, 79.3, 76.4, 76.93333333333334, 77.13333333333334, 76.73333333333333, 77.8, 77.8, 77.66666666666667, 77.93333333333334, 78.0, 78.66666666666667, 78.33333333333333, 78.66666666666667, 78.66666666666667, 78.6, 78.73333333333333, 78.93333333333334, 79.06666666666666, 78.8, 78.86666666666666, 79.06666666666666, 79.26666666666667, 79.2, 79.65, 80.15, 79.95, 79.35, 79.2, 79.05, 79.1, 79.9, 79.85, 80.0, 80.25, 81.1, 81.1, 80.15, 80.4, 80.6, 80.1, 80.5, 80.65, 80.7, 80.2, 80.76, 80.76, 81.4, 80.64, 80.76, 80.64, 80.96, 81.04, 81.28, 80.32, 81.48, 82.12, 82.0, 81.6, 81.44, 81.68, 81.2, 81.36, 81.52, 81.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.501, Test loss: 1.302, Test accuracy: 47.24 

Round   0, Global train loss: 1.501, Global test loss: 2.330, Global test accuracy: 16.64 

Round   1, Train loss: 1.160, Test loss: 1.350, Test accuracy: 52.96 

Round   1, Global train loss: 1.160, Global test loss: 2.348, Global test accuracy: 16.00 

Round   2, Train loss: 1.004, Test loss: 1.324, Test accuracy: 53.40 

Round   2, Global train loss: 1.004, Global test loss: 2.453, Global test accuracy: 20.36 

Round   3, Train loss: 0.871, Test loss: 1.301, Test accuracy: 56.60 

Round   3, Global train loss: 0.871, Global test loss: 2.330, Global test accuracy: 19.88 

Round   4, Train loss: 0.757, Test loss: 1.477, Test accuracy: 56.08 

Round   4, Global train loss: 0.757, Global test loss: 2.347, Global test accuracy: 20.28 

Round   5, Train loss: 0.646, Test loss: 1.418, Test accuracy: 58.16 

Round   5, Global train loss: 0.646, Global test loss: 2.374, Global test accuracy: 16.08 

Round   6, Train loss: 0.551, Test loss: 1.593, Test accuracy: 56.04 

Round   6, Global train loss: 0.551, Global test loss: 2.394, Global test accuracy: 16.08 

Round   7, Train loss: 0.478, Test loss: 1.871, Test accuracy: 55.56 

Round   7, Global train loss: 0.478, Global test loss: 2.465, Global test accuracy: 16.04 

Round   8, Train loss: 0.397, Test loss: 1.710, Test accuracy: 57.44 

Round   8, Global train loss: 0.397, Global test loss: 2.394, Global test accuracy: 16.76 

Round   9, Train loss: 0.335, Test loss: 1.693, Test accuracy: 59.16 

Round   9, Global train loss: 0.335, Global test loss: 2.351, Global test accuracy: 16.00 

Round  10, Train loss: 0.302, Test loss: 1.821, Test accuracy: 59.88 

Round  10, Global train loss: 0.302, Global test loss: 2.361, Global test accuracy: 16.04 

Round  11, Train loss: 0.231, Test loss: 1.902, Test accuracy: 60.40 

Round  11, Global train loss: 0.231, Global test loss: 2.462, Global test accuracy: 16.04 

Round  12, Train loss: 0.225, Test loss: 1.866, Test accuracy: 59.84 

Round  12, Global train loss: 0.225, Global test loss: 2.421, Global test accuracy: 16.68 

Round  13, Train loss: 0.180, Test loss: 2.074, Test accuracy: 59.56 

Round  13, Global train loss: 0.180, Global test loss: 2.439, Global test accuracy: 16.00 

Round  14, Train loss: 0.170, Test loss: 2.045, Test accuracy: 60.64 

Round  14, Global train loss: 0.170, Global test loss: 2.379, Global test accuracy: 16.00 

Round  15, Train loss: 0.134, Test loss: 2.068, Test accuracy: 59.80 

Round  15, Global train loss: 0.134, Global test loss: 2.459, Global test accuracy: 16.00 

Round  16, Train loss: 0.126, Test loss: 1.970, Test accuracy: 62.40 

Round  16, Global train loss: 0.126, Global test loss: 2.454, Global test accuracy: 16.04 

Round  17, Train loss: 0.123, Test loss: 2.078, Test accuracy: 61.04 

Round  17, Global train loss: 0.123, Global test loss: 2.419, Global test accuracy: 16.04 

Round  18, Train loss: 0.080, Test loss: 2.163, Test accuracy: 61.44 

Round  18, Global train loss: 0.080, Global test loss: 2.480, Global test accuracy: 16.04 

Round  19, Train loss: 0.096, Test loss: 2.196, Test accuracy: 61.08 

Round  19, Global train loss: 0.096, Global test loss: 2.440, Global test accuracy: 16.04 

Round  20, Train loss: 0.077, Test loss: 2.170, Test accuracy: 61.60 

Round  20, Global train loss: 0.077, Global test loss: 2.436, Global test accuracy: 16.04 

Round  21, Train loss: 0.067, Test loss: 2.115, Test accuracy: 63.56 

Round  21, Global train loss: 0.067, Global test loss: 2.399, Global test accuracy: 16.04 

Round  22, Train loss: 0.062, Test loss: 2.139, Test accuracy: 61.52 

Round  22, Global train loss: 0.062, Global test loss: 2.434, Global test accuracy: 16.04 

Round  23, Train loss: 0.044, Test loss: 2.085, Test accuracy: 62.92 

Round  23, Global train loss: 0.044, Global test loss: 2.482, Global test accuracy: 16.00 

Round  24, Train loss: 0.051, Test loss: 2.262, Test accuracy: 62.00 

Round  24, Global train loss: 0.051, Global test loss: 2.440, Global test accuracy: 16.04 

Round  25, Train loss: 0.065, Test loss: 2.299, Test accuracy: 60.80 

Round  25, Global train loss: 0.065, Global test loss: 2.404, Global test accuracy: 16.04 

Round  26, Train loss: 0.044, Test loss: 2.351, Test accuracy: 61.64 

Round  26, Global train loss: 0.044, Global test loss: 2.420, Global test accuracy: 16.04 

Round  27, Train loss: 0.046, Test loss: 2.105, Test accuracy: 63.64 

Round  27, Global train loss: 0.046, Global test loss: 2.373, Global test accuracy: 16.04 

Round  28, Train loss: 0.046, Test loss: 2.204, Test accuracy: 62.44 

Round  28, Global train loss: 0.046, Global test loss: 2.386, Global test accuracy: 16.00 

Round  29, Train loss: 0.044, Test loss: 2.262, Test accuracy: 62.20 

Round  29, Global train loss: 0.044, Global test loss: 2.375, Global test accuracy: 16.20 

Round  30, Train loss: 0.034, Test loss: 2.222, Test accuracy: 62.84 

Round  30, Global train loss: 0.034, Global test loss: 2.355, Global test accuracy: 16.32 

Round  31, Train loss: 0.035, Test loss: 2.299, Test accuracy: 62.28 

Round  31, Global train loss: 0.035, Global test loss: 2.359, Global test accuracy: 16.04 

Round  32, Train loss: 0.029, Test loss: 2.398, Test accuracy: 63.08 

Round  32, Global train loss: 0.029, Global test loss: 2.363, Global test accuracy: 16.04 

Round  33, Train loss: 0.027, Test loss: 2.240, Test accuracy: 63.48 

Round  33, Global train loss: 0.027, Global test loss: 2.416, Global test accuracy: 16.04 

Round  34, Train loss: 0.030, Test loss: 2.241, Test accuracy: 63.72 

Round  34, Global train loss: 0.030, Global test loss: 2.377, Global test accuracy: 16.04 

Final Round, Train loss: 0.024, Test loss: 2.241, Test accuracy: 63.68 

Final Round, Global train loss: 0.024, Global test loss: 2.377, Global test accuracy: 16.04 

Average accuracy final 10 rounds: 62.612 

Average global accuracy final 10 rounds: 16.079999999999995 

1473.505716085434
[12.550217866897583, 19.356526136398315, 26.159385442733765, 33.033437967300415, 40.05532455444336, 46.93758487701416, 53.934365034103394, 60.70834708213806, 67.60444688796997, 74.68334603309631, 81.52463865280151, 88.3447036743164, 95.28086805343628, 102.36438870429993, 109.3120973110199, 116.3584258556366, 123.19761180877686, 130.09145307540894, 136.87697577476501, 143.67729878425598, 150.37341237068176, 157.36887383460999, 164.4505307674408, 171.48645210266113, 178.3182578086853, 185.20104908943176, 192.2765407562256, 199.2024097442627, 206.0641167163849, 212.93638253211975, 219.90007090568542, 226.97910714149475, 233.82810974121094, 240.73103022575378, 247.6269233226776, 261.0459837913513]
[47.24, 52.96, 53.4, 56.6, 56.08, 58.16, 56.04, 55.56, 57.44, 59.16, 59.88, 60.4, 59.84, 59.56, 60.64, 59.8, 62.4, 61.04, 61.44, 61.08, 61.6, 63.56, 61.52, 62.92, 62.0, 60.8, 61.64, 63.64, 62.44, 62.2, 62.84, 62.28, 63.08, 63.48, 63.72, 63.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.502, Test loss: 1.436, Test accuracy: 45.16 

Round   0, Global train loss: 1.502, Global test loss: 2.419, Global test accuracy: 17.88 

Round   1, Train loss: 1.357, Test loss: 1.360, Test accuracy: 48.28 

Round   1, Global train loss: 1.357, Global test loss: 2.115, Global test accuracy: 22.96 

Round   2, Train loss: 1.228, Test loss: 1.355, Test accuracy: 49.20 

Round   2, Global train loss: 1.228, Global test loss: 1.856, Global test accuracy: 34.48 

Round   3, Train loss: 1.114, Test loss: 1.224, Test accuracy: 54.12 

Round   3, Global train loss: 1.114, Global test loss: 1.750, Global test accuracy: 37.92 

Round   4, Train loss: 1.036, Test loss: 1.313, Test accuracy: 54.12 

Round   4, Global train loss: 1.036, Global test loss: 1.579, Global test accuracy: 44.12 

Round   5, Train loss: 0.950, Test loss: 1.313, Test accuracy: 54.84 

Round   5, Global train loss: 0.950, Global test loss: 1.646, Global test accuracy: 43.76 

Round   6, Train loss: 0.890, Test loss: 1.119, Test accuracy: 60.44 

Round   6, Global train loss: 0.890, Global test loss: 1.470, Global test accuracy: 48.16 

Round   7, Train loss: 0.824, Test loss: 1.356, Test accuracy: 56.88 

Round   7, Global train loss: 0.824, Global test loss: 1.452, Global test accuracy: 49.64 

Round   8, Train loss: 0.786, Test loss: 1.236, Test accuracy: 59.52 

Round   8, Global train loss: 0.786, Global test loss: 1.476, Global test accuracy: 49.72 

Round   9, Train loss: 0.726, Test loss: 1.264, Test accuracy: 60.12 

Round   9, Global train loss: 0.726, Global test loss: 1.309, Global test accuracy: 54.84 

Round  10, Train loss: 0.677, Test loss: 1.492, Test accuracy: 58.08 

Round  10, Global train loss: 0.677, Global test loss: 1.383, Global test accuracy: 52.76 

Round  11, Train loss: 0.637, Test loss: 1.286, Test accuracy: 61.36 

Round  11, Global train loss: 0.637, Global test loss: 1.329, Global test accuracy: 55.76 

Round  12, Train loss: 0.576, Test loss: 1.204, Test accuracy: 65.20 

Round  12, Global train loss: 0.576, Global test loss: 1.286, Global test accuracy: 56.92 

Round  13, Train loss: 0.558, Test loss: 1.657, Test accuracy: 59.00 

Round  13, Global train loss: 0.558, Global test loss: 1.279, Global test accuracy: 57.56 

Round  14, Train loss: 0.523, Test loss: 1.222, Test accuracy: 64.60 

Round  14, Global train loss: 0.523, Global test loss: 1.301, Global test accuracy: 57.96 

Round  15, Train loss: 0.488, Test loss: 1.206, Test accuracy: 66.16 

Round  15, Global train loss: 0.488, Global test loss: 1.452, Global test accuracy: 55.36 

Round  16, Train loss: 0.451, Test loss: 1.486, Test accuracy: 61.60 

Round  16, Global train loss: 0.451, Global test loss: 1.305, Global test accuracy: 59.28 

Round  17, Train loss: 0.428, Test loss: 1.651, Test accuracy: 63.36 

Round  17, Global train loss: 0.428, Global test loss: 1.265, Global test accuracy: 60.92 

Round  18, Train loss: 0.401, Test loss: 1.465, Test accuracy: 62.32 

Round  18, Global train loss: 0.401, Global test loss: 1.312, Global test accuracy: 59.20 

Round  19, Train loss: 0.370, Test loss: 1.425, Test accuracy: 64.80 

Round  19, Global train loss: 0.370, Global test loss: 1.367, Global test accuracy: 60.32 

Round  20, Train loss: 0.333, Test loss: 1.442, Test accuracy: 64.92 

Round  20, Global train loss: 0.333, Global test loss: 1.262, Global test accuracy: 61.60 

Round  21, Train loss: 0.336, Test loss: 1.372, Test accuracy: 65.60 

Round  21, Global train loss: 0.336, Global test loss: 1.276, Global test accuracy: 61.04 

Round  22, Train loss: 0.321, Test loss: 1.316, Test accuracy: 67.08 

Round  22, Global train loss: 0.321, Global test loss: 1.313, Global test accuracy: 60.92 

Round  23, Train loss: 0.291, Test loss: 1.345, Test accuracy: 66.80 

Round  23, Global train loss: 0.291, Global test loss: 1.266, Global test accuracy: 61.84 

Round  24, Train loss: 0.269, Test loss: 1.666, Test accuracy: 64.36 

Round  24, Global train loss: 0.269, Global test loss: 1.359, Global test accuracy: 61.12 

Round  25, Train loss: 0.242, Test loss: 1.491, Test accuracy: 65.64 

Round  25, Global train loss: 0.242, Global test loss: 1.366, Global test accuracy: 61.04 

Round  26, Train loss: 0.226, Test loss: 1.382, Test accuracy: 68.44 

Round  26, Global train loss: 0.226, Global test loss: 1.341, Global test accuracy: 62.92 

Round  27, Train loss: 0.227, Test loss: 1.460, Test accuracy: 66.32 

Round  27, Global train loss: 0.227, Global test loss: 1.310, Global test accuracy: 63.76 

Round  28, Train loss: 0.211, Test loss: 1.540, Test accuracy: 66.40 

Round  28, Global train loss: 0.211, Global test loss: 1.317, Global test accuracy: 62.60 

Round  29, Train loss: 0.198, Test loss: 1.458, Test accuracy: 69.04 

Round  29, Global train loss: 0.198, Global test loss: 1.338, Global test accuracy: 62.44 

Round  30, Train loss: 0.195, Test loss: 1.543, Test accuracy: 66.60 

Round  30, Global train loss: 0.195, Global test loss: 1.388, Global test accuracy: 62.32 

Round  31, Train loss: 0.179, Test loss: 1.373, Test accuracy: 68.72 

Round  31, Global train loss: 0.179, Global test loss: 1.369, Global test accuracy: 61.88 

Round  32, Train loss: 0.163, Test loss: 1.478, Test accuracy: 66.76 

Round  32, Global train loss: 0.163, Global test loss: 1.381, Global test accuracy: 62.72 

Round  33, Train loss: 0.174, Test loss: 1.594, Test accuracy: 67.68 

Round  33, Global train loss: 0.174, Global test loss: 1.363, Global test accuracy: 62.32 

Round  34, Train loss: 0.120, Test loss: 1.526, Test accuracy: 68.56 

Round  34, Global train loss: 0.120, Global test loss: 1.348, Global test accuracy: 63.12 

Round  35, Train loss: 0.135, Test loss: 1.485, Test accuracy: 69.56 

Round  35, Global train loss: 0.135, Global test loss: 1.426, Global test accuracy: 63.24 

Round  36, Train loss: 0.151, Test loss: 1.631, Test accuracy: 66.24 

Round  36, Global train loss: 0.151, Global test loss: 1.364, Global test accuracy: 63.24 

Round  37, Train loss: 0.113, Test loss: 1.470, Test accuracy: 69.52 

Round  37, Global train loss: 0.113, Global test loss: 1.342, Global test accuracy: 64.36 

Round  38, Train loss: 0.134, Test loss: 1.467, Test accuracy: 70.64 

Round  38, Global train loss: 0.134, Global test loss: 1.376, Global test accuracy: 63.44 

Round  39, Train loss: 0.123, Test loss: 1.431, Test accuracy: 69.96 

Round  39, Global train loss: 0.123, Global test loss: 1.365, Global test accuracy: 63.88 

Round  40, Train loss: 0.089, Test loss: 1.924, Test accuracy: 67.08 

Round  40, Global train loss: 0.089, Global test loss: 1.519, Global test accuracy: 61.68 

Round  41, Train loss: 0.130, Test loss: 1.403, Test accuracy: 70.12 

Round  41, Global train loss: 0.130, Global test loss: 1.370, Global test accuracy: 63.48 

Round  42, Train loss: 0.087, Test loss: 1.452, Test accuracy: 69.92 

Round  42, Global train loss: 0.087, Global test loss: 1.386, Global test accuracy: 63.84 

Round  43, Train loss: 0.074, Test loss: 1.535, Test accuracy: 68.32 

Round  43, Global train loss: 0.074, Global test loss: 1.470, Global test accuracy: 63.12 

Round  44, Train loss: 0.082, Test loss: 1.541, Test accuracy: 69.12 

Round  44, Global train loss: 0.082, Global test loss: 1.415, Global test accuracy: 63.48 

Round  45, Train loss: 0.075, Test loss: 1.563, Test accuracy: 69.64 

Round  45, Global train loss: 0.075, Global test loss: 1.419, Global test accuracy: 63.80 

Round  46, Train loss: 0.066, Test loss: 1.472, Test accuracy: 70.36 

Round  46, Global train loss: 0.066, Global test loss: 1.448, Global test accuracy: 63.44 

Round  47, Train loss: 0.079, Test loss: 1.750, Test accuracy: 67.40 

Round  47, Global train loss: 0.079, Global test loss: 1.436, Global test accuracy: 64.08 

Round  48, Train loss: 0.065, Test loss: 1.520, Test accuracy: 69.96 

Round  48, Global train loss: 0.065, Global test loss: 1.411, Global test accuracy: 64.40 

Round  49, Train loss: 0.073, Test loss: 1.671, Test accuracy: 68.16 

Round  49, Global train loss: 0.073, Global test loss: 1.463, Global test accuracy: 64.24 

Final Round, Train loss: 0.072, Test loss: 1.820, Test accuracy: 67.52 

Final Round, Global train loss: 0.072, Global test loss: 1.463, Global test accuracy: 64.24 

Average accuracy final 10 rounds: 69.008 

Average global accuracy final 10 rounds: 63.556 

2071.460197687149
[12.353539943695068, 19.51562762260437, 26.432470083236694, 33.464354038238525, 40.47102093696594, 47.479970932006836, 54.37922477722168, 61.347941398620605, 68.43834853172302, 75.37989473342896, 82.3877124786377, 89.24331164360046, 96.20689105987549, 102.98475480079651, 109.74843263626099, 116.6132378578186, 123.52834701538086, 130.40513157844543, 137.4397280216217, 144.524160861969, 151.57646369934082, 158.37794280052185, 165.28825330734253, 172.07610297203064, 178.84579873085022, 185.5573959350586, 192.1860008239746, 198.8677294254303, 205.66843795776367, 212.73444867134094, 219.80050659179688, 226.74341225624084, 233.60267639160156, 240.72365427017212, 247.6047327518463, 254.49461483955383, 261.63422679901123, 268.6083116531372, 275.8065388202667, 282.65378403663635, 289.3359398841858, 295.9680941104889, 302.8902518749237, 309.8840425014496, 316.6846787929535, 323.54744839668274, 330.2663764953613, 337.22879910469055, 344.07174468040466, 351.0343883037567, 364.49929022789]
[45.16, 48.28, 49.2, 54.12, 54.12, 54.84, 60.44, 56.88, 59.52, 60.12, 58.08, 61.36, 65.2, 59.0, 64.6, 66.16, 61.6, 63.36, 62.32, 64.8, 64.92, 65.6, 67.08, 66.8, 64.36, 65.64, 68.44, 66.32, 66.4, 69.04, 66.6, 68.72, 66.76, 67.68, 68.56, 69.56, 66.24, 69.52, 70.64, 69.96, 67.08, 70.12, 69.92, 68.32, 69.12, 69.64, 70.36, 67.4, 69.96, 68.16, 67.52]
