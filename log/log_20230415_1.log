nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.434, Test loss: 1.339, Test accuracy: 52.68 

Round   0, Global train loss: 1.434, Global test loss: 2.659, Global test accuracy: 16.00 

Round   1, Train loss: 1.080, Test loss: 1.228, Test accuracy: 58.08 

Round   1, Global train loss: 1.080, Global test loss: 2.634, Global test accuracy: 16.00 

Round   2, Train loss: 0.892, Test loss: 1.243, Test accuracy: 60.12 

Round   2, Global train loss: 0.892, Global test loss: 2.687, Global test accuracy: 16.00 

Round   3, Train loss: 0.755, Test loss: 1.221, Test accuracy: 62.04 

Round   3, Global train loss: 0.755, Global test loss: 2.679, Global test accuracy: 16.00 

Round   4, Train loss: 0.626, Test loss: 1.279, Test accuracy: 63.48 

Round   4, Global train loss: 0.626, Global test loss: 2.640, Global test accuracy: 16.00 

Round   5, Train loss: 0.538, Test loss: 1.321, Test accuracy: 62.08 

Round   5, Global train loss: 0.538, Global test loss: 2.532, Global test accuracy: 16.00 

Round   6, Train loss: 0.449, Test loss: 1.407, Test accuracy: 65.24 

Round   6, Global train loss: 0.449, Global test loss: 2.624, Global test accuracy: 16.00 

Round   7, Train loss: 0.373, Test loss: 1.232, Test accuracy: 68.80 

Round   7, Global train loss: 0.373, Global test loss: 2.718, Global test accuracy: 16.00 

Round   8, Train loss: 0.311, Test loss: 1.525, Test accuracy: 63.44 

Round   8, Global train loss: 0.311, Global test loss: 2.909, Global test accuracy: 16.00 

Round   9, Train loss: 0.248, Test loss: 1.356, Test accuracy: 69.36 

Round   9, Global train loss: 0.248, Global test loss: 2.767, Global test accuracy: 16.00 

Round  10, Train loss: 0.224, Test loss: 1.404, Test accuracy: 67.72 

Round  10, Global train loss: 0.224, Global test loss: 2.655, Global test accuracy: 16.00 

Round  11, Train loss: 0.181, Test loss: 1.517, Test accuracy: 66.64 

Round  11, Global train loss: 0.181, Global test loss: 2.752, Global test accuracy: 16.00 

Round  12, Train loss: 0.152, Test loss: 1.578, Test accuracy: 67.84 

Round  12, Global train loss: 0.152, Global test loss: 2.857, Global test accuracy: 16.00 

Round  13, Train loss: 0.133, Test loss: 1.574, Test accuracy: 69.96 

Round  13, Global train loss: 0.133, Global test loss: 2.695, Global test accuracy: 16.00 

Round  14, Train loss: 0.141, Test loss: 1.431, Test accuracy: 69.24 

Round  14, Global train loss: 0.141, Global test loss: 2.600, Global test accuracy: 16.00 

Round  15, Train loss: 0.102, Test loss: 1.456, Test accuracy: 70.16 

Round  15, Global train loss: 0.102, Global test loss: 2.702, Global test accuracy: 16.00 

Round  16, Train loss: 0.097, Test loss: 1.568, Test accuracy: 69.96 

Round  16, Global train loss: 0.097, Global test loss: 2.582, Global test accuracy: 16.00 

Round  17, Train loss: 0.085, Test loss: 1.666, Test accuracy: 68.44 

Round  17, Global train loss: 0.085, Global test loss: 2.541, Global test accuracy: 16.00 

Round  18, Train loss: 0.063, Test loss: 1.495, Test accuracy: 71.52 

Round  18, Global train loss: 0.063, Global test loss: 2.638, Global test accuracy: 16.00 

Round  19, Train loss: 0.060, Test loss: 1.564, Test accuracy: 70.76 

Round  19, Global train loss: 0.060, Global test loss: 2.746, Global test accuracy: 16.00 

Round  20, Train loss: 0.075, Test loss: 1.765, Test accuracy: 68.84 

Round  20, Global train loss: 0.075, Global test loss: 2.737, Global test accuracy: 16.00 

Round  21, Train loss: 0.066, Test loss: 1.560, Test accuracy: 70.52 

Round  21, Global train loss: 0.066, Global test loss: 2.605, Global test accuracy: 16.00 

Round  22, Train loss: 0.058, Test loss: 1.725, Test accuracy: 67.72 

Round  22, Global train loss: 0.058, Global test loss: 2.591, Global test accuracy: 16.00 

Round  23, Train loss: 0.048, Test loss: 1.668, Test accuracy: 69.00 

Round  23, Global train loss: 0.048, Global test loss: 2.669, Global test accuracy: 16.00 

Round  24, Train loss: 0.039, Test loss: 1.731, Test accuracy: 70.88 

Round  24, Global train loss: 0.039, Global test loss: 2.668, Global test accuracy: 16.00 

Round  25, Train loss: 0.028, Test loss: 1.587, Test accuracy: 72.12 

Round  25, Global train loss: 0.028, Global test loss: 2.688, Global test accuracy: 16.00 

Round  26, Train loss: 0.034, Test loss: 1.650, Test accuracy: 70.56 

Round  26, Global train loss: 0.034, Global test loss: 2.643, Global test accuracy: 16.00 

Round  27, Train loss: 0.024, Test loss: 1.660, Test accuracy: 71.88 

Round  27, Global train loss: 0.024, Global test loss: 2.720, Global test accuracy: 16.00 

Round  28, Train loss: 0.012, Test loss: 1.652, Test accuracy: 72.44 

Round  28, Global train loss: 0.012, Global test loss: 2.609, Global test accuracy: 16.00 

Round  29, Train loss: 0.026, Test loss: 1.659, Test accuracy: 71.92 

Round  29, Global train loss: 0.026, Global test loss: 2.594, Global test accuracy: 16.00 

Round  30, Train loss: 0.031, Test loss: 1.645, Test accuracy: 71.44 

Round  30, Global train loss: 0.031, Global test loss: 2.663, Global test accuracy: 16.00 

Round  31, Train loss: 0.031, Test loss: 1.702, Test accuracy: 70.92 

Round  31, Global train loss: 0.031, Global test loss: 2.662, Global test accuracy: 16.00 

Round  32, Train loss: 0.043, Test loss: 1.602, Test accuracy: 72.08 

Round  32, Global train loss: 0.043, Global test loss: 2.559, Global test accuracy: 16.00 

Round  33, Train loss: 0.028, Test loss: 1.700, Test accuracy: 70.24 

Round  33, Global train loss: 0.028, Global test loss: 2.529, Global test accuracy: 16.00 

Round  34, Train loss: 0.013, Test loss: 1.666, Test accuracy: 72.24 

Round  34, Global train loss: 0.013, Global test loss: 2.531, Global test accuracy: 16.00 

Final Round, Train loss: 0.020, Test loss: 1.684, Test accuracy: 72.12 

Final Round, Global train loss: 0.020, Global test loss: 2.531, Global test accuracy: 16.00 

Average accuracy final 10 rounds: 71.58399999999999 

Average global accuracy final 10 rounds: 15.999999999999998 

1465.1981296539307
[12.881234884262085, 19.793549299240112, 26.8139386177063, 33.87826657295227, 40.82390761375427, 47.798359394073486, 54.91713213920593, 61.84984612464905, 68.99161410331726, 75.94703555107117, 83.01177835464478, 90.11986708641052, 97.07283568382263, 104.02237582206726, 111.03553509712219, 117.86400079727173, 124.77843523025513, 131.8902292251587, 138.83018612861633, 145.7457938194275, 152.6435866355896, 159.64243268966675, 166.70465970039368, 173.58110189437866, 180.14794850349426, 186.67273473739624, 193.05885529518127, 199.5234293937683, 205.94127821922302, 212.39824414253235, 218.81338262557983, 225.2373387813568, 231.67144465446472, 238.17936825752258, 244.5944640636444, 257.54748916625977]
[52.68, 58.08, 60.12, 62.04, 63.48, 62.08, 65.24, 68.8, 63.44, 69.36, 67.72, 66.64, 67.84, 69.96, 69.24, 70.16, 69.96, 68.44, 71.52, 70.76, 68.84, 70.52, 67.72, 69.0, 70.88, 72.12, 70.56, 71.88, 72.44, 71.92, 71.44, 70.92, 72.08, 70.24, 72.24, 72.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.437, Test loss: 1.398, Test accuracy: 50.20 

Round   0, Global train loss: 1.437, Global test loss: 2.363, Global test accuracy: 16.00 

Round   1, Train loss: 1.293, Test loss: 1.319, Test accuracy: 52.56 

Round   1, Global train loss: 1.293, Global test loss: 2.185, Global test accuracy: 24.44 

Round   2, Train loss: 1.163, Test loss: 1.252, Test accuracy: 53.88 

Round   2, Global train loss: 1.163, Global test loss: 1.840, Global test accuracy: 36.44 

Round   3, Train loss: 1.026, Test loss: 1.199, Test accuracy: 59.56 

Round   3, Global train loss: 1.026, Global test loss: 1.704, Global test accuracy: 42.92 

Round   4, Train loss: 0.927, Test loss: 1.174, Test accuracy: 62.40 

Round   4, Global train loss: 0.927, Global test loss: 1.633, Global test accuracy: 44.84 

Round   5, Train loss: 0.851, Test loss: 1.068, Test accuracy: 63.68 

Round   5, Global train loss: 0.851, Global test loss: 1.672, Global test accuracy: 46.08 

Round   6, Train loss: 0.774, Test loss: 1.141, Test accuracy: 64.44 

Round   6, Global train loss: 0.774, Global test loss: 1.399, Global test accuracy: 52.44 

Round   7, Train loss: 0.707, Test loss: 1.061, Test accuracy: 66.84 

Round   7, Global train loss: 0.707, Global test loss: 1.320, Global test accuracy: 57.16 

Round   8, Train loss: 0.647, Test loss: 1.091, Test accuracy: 65.36 

Round   8, Global train loss: 0.647, Global test loss: 1.379, Global test accuracy: 54.64 

Round   9, Train loss: 0.605, Test loss: 1.210, Test accuracy: 65.24 

Round   9, Global train loss: 0.605, Global test loss: 1.312, Global test accuracy: 57.76 

Round  10, Train loss: 0.551, Test loss: 1.100, Test accuracy: 69.04 

Round  10, Global train loss: 0.551, Global test loss: 1.242, Global test accuracy: 59.28 

Round  11, Train loss: 0.518, Test loss: 1.217, Test accuracy: 67.20 

Round  11, Global train loss: 0.518, Global test loss: 1.458, Global test accuracy: 55.76 

Round  12, Train loss: 0.471, Test loss: 0.890, Test accuracy: 73.08 

Round  12, Global train loss: 0.471, Global test loss: 1.247, Global test accuracy: 60.16 

Round  13, Train loss: 0.428, Test loss: 1.025, Test accuracy: 71.00 

Round  13, Global train loss: 0.428, Global test loss: 1.233, Global test accuracy: 60.32 

Round  14, Train loss: 0.398, Test loss: 1.069, Test accuracy: 70.84 

Round  14, Global train loss: 0.398, Global test loss: 1.188, Global test accuracy: 63.12 

Round  15, Train loss: 0.371, Test loss: 1.051, Test accuracy: 72.20 

Round  15, Global train loss: 0.371, Global test loss: 1.276, Global test accuracy: 60.48 

Round  16, Train loss: 0.354, Test loss: 1.038, Test accuracy: 71.28 

Round  16, Global train loss: 0.354, Global test loss: 1.247, Global test accuracy: 62.56 

Round  17, Train loss: 0.313, Test loss: 1.002, Test accuracy: 73.32 

Round  17, Global train loss: 0.313, Global test loss: 1.216, Global test accuracy: 63.44 

Round  18, Train loss: 0.310, Test loss: 1.062, Test accuracy: 73.32 

Round  18, Global train loss: 0.310, Global test loss: 1.208, Global test accuracy: 64.92 

Round  19, Train loss: 0.279, Test loss: 1.223, Test accuracy: 70.76 

Round  19, Global train loss: 0.279, Global test loss: 1.192, Global test accuracy: 64.32 

Round  20, Train loss: 0.269, Test loss: 1.018, Test accuracy: 75.04 

Round  20, Global train loss: 0.269, Global test loss: 1.179, Global test accuracy: 64.28 

Round  21, Train loss: 0.240, Test loss: 1.191, Test accuracy: 71.84 

Round  21, Global train loss: 0.240, Global test loss: 1.187, Global test accuracy: 65.20 

Round  22, Train loss: 0.216, Test loss: 1.046, Test accuracy: 74.84 

Round  22, Global train loss: 0.216, Global test loss: 1.169, Global test accuracy: 65.80 

Round  23, Train loss: 0.214, Test loss: 1.067, Test accuracy: 73.68 

Round  23, Global train loss: 0.214, Global test loss: 1.119, Global test accuracy: 66.44 

Round  24, Train loss: 0.201, Test loss: 1.096, Test accuracy: 72.96 

Round  24, Global train loss: 0.201, Global test loss: 1.199, Global test accuracy: 65.96 

Round  25, Train loss: 0.183, Test loss: 1.453, Test accuracy: 69.24 

Round  25, Global train loss: 0.183, Global test loss: 1.173, Global test accuracy: 66.36 

Round  26, Train loss: 0.188, Test loss: 1.023, Test accuracy: 76.68 

Round  26, Global train loss: 0.188, Global test loss: 1.137, Global test accuracy: 67.24 

Round  27, Train loss: 0.159, Test loss: 1.037, Test accuracy: 76.28 

Round  27, Global train loss: 0.159, Global test loss: 1.197, Global test accuracy: 66.16 

Round  28, Train loss: 0.168, Test loss: 1.120, Test accuracy: 73.96 

Round  28, Global train loss: 0.168, Global test loss: 1.149, Global test accuracy: 67.48 

Round  29, Train loss: 0.152, Test loss: 1.137, Test accuracy: 75.28 

Round  29, Global train loss: 0.152, Global test loss: 1.266, Global test accuracy: 65.36 

Round  30, Train loss: 0.127, Test loss: 1.203, Test accuracy: 74.48 

Round  30, Global train loss: 0.127, Global test loss: 1.197, Global test accuracy: 67.60 

Round  31, Train loss: 0.135, Test loss: 1.129, Test accuracy: 74.84 

Round  31, Global train loss: 0.135, Global test loss: 1.206, Global test accuracy: 67.04 

Round  32, Train loss: 0.118, Test loss: 1.057, Test accuracy: 76.40 

Round  32, Global train loss: 0.118, Global test loss: 1.132, Global test accuracy: 67.88 

Round  33, Train loss: 0.111, Test loss: 1.061, Test accuracy: 75.76 

Round  33, Global train loss: 0.111, Global test loss: 1.194, Global test accuracy: 67.64 

Round  34, Train loss: 0.134, Test loss: 1.074, Test accuracy: 75.52 

Round  34, Global train loss: 0.134, Global test loss: 1.193, Global test accuracy: 67.24 

Round  35, Train loss: 0.106, Test loss: 0.954, Test accuracy: 77.24 

Round  35, Global train loss: 0.106, Global test loss: 1.161, Global test accuracy: 68.56 

Round  36, Train loss: 0.090, Test loss: 1.068, Test accuracy: 76.00 

Round  36, Global train loss: 0.090, Global test loss: 1.196, Global test accuracy: 68.24 

Round  37, Train loss: 0.067, Test loss: 1.067, Test accuracy: 76.28 

Round  37, Global train loss: 0.067, Global test loss: 1.206, Global test accuracy: 68.12 

Round  38, Train loss: 0.092, Test loss: 1.161, Test accuracy: 76.00 

Round  38, Global train loss: 0.092, Global test loss: 1.183, Global test accuracy: 67.16 

Round  39, Train loss: 0.087, Test loss: 1.166, Test accuracy: 75.40 

Round  39, Global train loss: 0.087, Global test loss: 1.166, Global test accuracy: 68.44 

Round  40, Train loss: 0.068, Test loss: 1.000, Test accuracy: 78.20 

Round  40, Global train loss: 0.068, Global test loss: 1.214, Global test accuracy: 68.28 

Round  41, Train loss: 0.074, Test loss: 1.039, Test accuracy: 77.92 

Round  41, Global train loss: 0.074, Global test loss: 1.154, Global test accuracy: 68.68 

Round  42, Train loss: 0.075, Test loss: 1.149, Test accuracy: 77.68 

Round  42, Global train loss: 0.075, Global test loss: 1.180, Global test accuracy: 68.32 

Round  43, Train loss: 0.058, Test loss: 0.998, Test accuracy: 79.32 

Round  43, Global train loss: 0.058, Global test loss: 1.213, Global test accuracy: 68.20 

Round  44, Train loss: 0.054, Test loss: 1.108, Test accuracy: 77.64 

Round  44, Global train loss: 0.054, Global test loss: 1.161, Global test accuracy: 69.40 

Round  45, Train loss: 0.072, Test loss: 1.445, Test accuracy: 73.64 

Round  45, Global train loss: 0.072, Global test loss: 1.224, Global test accuracy: 67.92 

Round  46, Train loss: 0.044, Test loss: 0.991, Test accuracy: 78.68 

Round  46, Global train loss: 0.044, Global test loss: 1.183, Global test accuracy: 69.00 

Round  47, Train loss: 0.041, Test loss: 1.148, Test accuracy: 77.56 

Round  47, Global train loss: 0.041, Global test loss: 1.239, Global test accuracy: 68.60 

Round  48, Train loss: 0.031, Test loss: 1.016, Test accuracy: 79.12 

Round  48, Global train loss: 0.031, Global test loss: 1.210, Global test accuracy: 69.20 

Round  49, Train loss: 0.055, Test loss: 1.088, Test accuracy: 78.56 

Round  49, Global train loss: 0.055, Global test loss: 1.202, Global test accuracy: 69.20 

Final Round, Train loss: 0.074, Test loss: 1.274, Test accuracy: 76.16 

Final Round, Global train loss: 0.074, Global test loss: 1.202, Global test accuracy: 69.20 

Average accuracy final 10 rounds: 77.832 

Average global accuracy final 10 rounds: 68.67999999999999 

2117.9627656936646
[13.004499197006226, 20.430302143096924, 27.531039237976074, 34.5691921710968, 41.79527711868286, 48.97555947303772, 56.00116205215454, 63.1304235458374, 70.32321429252625, 77.43990111351013, 84.66295790672302, 91.52877116203308, 98.72666716575623, 105.7279851436615, 112.68757176399231, 119.66033673286438, 126.64051485061646, 133.9510486125946, 141.27006196975708, 148.5718858242035, 155.90541100502014, 163.09742951393127, 169.9661829471588, 176.96602368354797, 184.0699188709259, 191.4846270084381, 198.33485984802246, 205.27393102645874, 212.2299222946167, 219.2915437221527, 226.69991612434387, 233.73102855682373, 240.6784164905548, 247.81520581245422, 254.83857107162476, 261.7275080680847, 268.80560851097107, 275.8118772506714, 282.65618348121643, 289.4682583808899, 296.3820662498474, 303.5974717140198, 310.74539828300476, 317.72207474708557, 324.8421587944031, 331.7904453277588, 338.8020830154419, 346.11260890960693, 353.14917063713074, 360.2673499584198, 374.1725125312805]
[50.2, 52.56, 53.88, 59.56, 62.4, 63.68, 64.44, 66.84, 65.36, 65.24, 69.04, 67.2, 73.08, 71.0, 70.84, 72.2, 71.28, 73.32, 73.32, 70.76, 75.04, 71.84, 74.84, 73.68, 72.96, 69.24, 76.68, 76.28, 73.96, 75.28, 74.48, 74.84, 76.4, 75.76, 75.52, 77.24, 76.0, 76.28, 76.0, 75.4, 78.2, 77.92, 77.68, 79.32, 77.64, 73.64, 78.68, 77.56, 79.12, 78.56, 76.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.538, Test loss: 1.795, Test accuracy: 24.80 

Round   1, Train loss: 1.334, Test loss: 1.595, Test accuracy: 34.60 

Round   2, Train loss: 1.205, Test loss: 1.335, Test accuracy: 43.96 

Round   3, Train loss: 1.095, Test loss: 1.143, Test accuracy: 53.84 

Round   4, Train loss: 1.010, Test loss: 1.115, Test accuracy: 54.88 

Round   5, Train loss: 0.948, Test loss: 1.119, Test accuracy: 55.08 

Round   6, Train loss: 0.902, Test loss: 0.987, Test accuracy: 62.04 

Round   7, Train loss: 0.835, Test loss: 0.915, Test accuracy: 64.80 

Round   8, Train loss: 0.786, Test loss: 0.915, Test accuracy: 65.72 

Round   9, Train loss: 0.739, Test loss: 0.889, Test accuracy: 65.40 

Round  10, Train loss: 0.689, Test loss: 0.789, Test accuracy: 70.00 

Round  11, Train loss: 0.631, Test loss: 0.733, Test accuracy: 72.16 

Round  12, Train loss: 0.601, Test loss: 0.732, Test accuracy: 73.60 

Round  13, Train loss: 0.560, Test loss: 0.776, Test accuracy: 72.64 

Round  14, Train loss: 0.523, Test loss: 0.706, Test accuracy: 73.16 

Round  15, Train loss: 0.497, Test loss: 0.703, Test accuracy: 74.36 

Round  16, Train loss: 0.462, Test loss: 0.703, Test accuracy: 75.28 

Round  17, Train loss: 0.428, Test loss: 0.669, Test accuracy: 76.36 

Round  18, Train loss: 0.407, Test loss: 0.687, Test accuracy: 76.64 

Round  19, Train loss: 0.385, Test loss: 0.665, Test accuracy: 77.04 

Round  20, Train loss: 0.366, Test loss: 0.658, Test accuracy: 77.04 

Round  21, Train loss: 0.343, Test loss: 0.702, Test accuracy: 76.56 

Round  22, Train loss: 0.307, Test loss: 0.655, Test accuracy: 77.40 

Round  23, Train loss: 0.299, Test loss: 0.654, Test accuracy: 77.72 

Round  24, Train loss: 0.276, Test loss: 0.633, Test accuracy: 78.36 

Round  25, Train loss: 0.254, Test loss: 0.695, Test accuracy: 76.84 

Round  26, Train loss: 0.244, Test loss: 0.681, Test accuracy: 78.52 

Round  27, Train loss: 0.233, Test loss: 0.645, Test accuracy: 79.08 

Round  28, Train loss: 0.206, Test loss: 0.643, Test accuracy: 79.60 

Round  29, Train loss: 0.199, Test loss: 0.708, Test accuracy: 78.32 

Round  30, Train loss: 0.205, Test loss: 0.696, Test accuracy: 78.20 

Round  31, Train loss: 0.175, Test loss: 0.648, Test accuracy: 79.16 

Round  32, Train loss: 0.163, Test loss: 0.729, Test accuracy: 77.56 

Round  33, Train loss: 0.160, Test loss: 0.664, Test accuracy: 79.48 

Round  34, Train loss: 0.141, Test loss: 0.703, Test accuracy: 78.48 

Round  35, Train loss: 0.140, Test loss: 0.680, Test accuracy: 79.76 

Round  36, Train loss: 0.127, Test loss: 0.663, Test accuracy: 80.00 

Round  37, Train loss: 0.127, Test loss: 0.663, Test accuracy: 80.36 

Round  38, Train loss: 0.111, Test loss: 0.689, Test accuracy: 80.08 

Round  39, Train loss: 0.115, Test loss: 0.723, Test accuracy: 79.12 

Round  40, Train loss: 0.106, Test loss: 0.665, Test accuracy: 80.44 

Round  41, Train loss: 0.103, Test loss: 0.658, Test accuracy: 80.12 

Round  42, Train loss: 0.091, Test loss: 0.690, Test accuracy: 80.24 

Round  43, Train loss: 0.092, Test loss: 0.715, Test accuracy: 80.28 

Round  44, Train loss: 0.082, Test loss: 0.679, Test accuracy: 80.84 

Round  45, Train loss: 0.065, Test loss: 0.691, Test accuracy: 80.72 

Round  46, Train loss: 0.066, Test loss: 0.684, Test accuracy: 80.72 

Round  47, Train loss: 0.071, Test loss: 0.708, Test accuracy: 79.84 

Round  48, Train loss: 0.070, Test loss: 0.720, Test accuracy: 79.96 

Round  49, Train loss: 0.063, Test loss: 0.757, Test accuracy: 79.76 

Final Round, Train loss: 0.035, Test loss: 0.744, Test accuracy: 80.24 

Average accuracy final 10 rounds: 80.29199999999999 

1488.5695934295654
[11.278446197509766, 16.590208292007446, 21.66517686843872, 27.134496688842773, 32.465306997299194, 37.59679985046387, 43.013561725616455, 48.31712508201599, 53.38344740867615, 58.45972681045532, 64.16616892814636, 69.23731184005737, 74.45034575462341, 80.1679196357727, 85.88024592399597, 91.28911566734314, 96.77577829360962, 102.12871527671814, 107.60270357131958, 112.8991162776947, 118.22676682472229, 123.62302494049072, 129.0824112892151, 134.6549084186554, 140.14037537574768, 145.61698484420776, 150.94305634498596, 156.41406655311584, 161.7669768333435, 167.08541679382324, 172.38344383239746, 177.730366230011, 183.0838179588318, 188.53823947906494, 193.92052102088928, 199.26666355133057, 204.68169927597046, 210.01381063461304, 215.31522464752197, 220.70998287200928, 226.00840735435486, 231.29125142097473, 236.61733102798462, 241.81774473190308, 247.32381796836853, 252.7294864654541, 258.2586851119995, 263.7553391456604, 269.1261405944824, 274.5286331176758, 280.09721755981445]
[24.8, 34.6, 43.96, 53.84, 54.88, 55.08, 62.04, 64.8, 65.72, 65.4, 70.0, 72.16, 73.6, 72.64, 73.16, 74.36, 75.28, 76.36, 76.64, 77.04, 77.04, 76.56, 77.4, 77.72, 78.36, 76.84, 78.52, 79.08, 79.6, 78.32, 78.2, 79.16, 77.56, 79.48, 78.48, 79.76, 80.0, 80.36, 80.08, 79.12, 80.44, 80.12, 80.24, 80.28, 80.84, 80.72, 80.72, 79.84, 79.96, 79.76, 80.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.553, Test loss: 1.815, Test accuracy: 27.40
Round   1, Train loss: 1.348, Test loss: 1.434, Test accuracy: 40.44
Round   2, Train loss: 1.191, Test loss: 1.240, Test accuracy: 51.08
Round   3, Train loss: 1.082, Test loss: 1.090, Test accuracy: 54.88
Round   4, Train loss: 0.981, Test loss: 1.050, Test accuracy: 61.40
Round   5, Train loss: 0.925, Test loss: 0.888, Test accuracy: 65.72
Round   6, Train loss: 0.863, Test loss: 0.875, Test accuracy: 65.12
Round   7, Train loss: 0.824, Test loss: 0.890, Test accuracy: 65.64
Round   8, Train loss: 0.759, Test loss: 0.924, Test accuracy: 65.48
Round   9, Train loss: 0.710, Test loss: 0.875, Test accuracy: 67.40
Round  10, Train loss: 0.673, Test loss: 0.865, Test accuracy: 67.56
Round  11, Train loss: 0.622, Test loss: 0.748, Test accuracy: 72.16
Round  12, Train loss: 0.588, Test loss: 0.709, Test accuracy: 74.28
Round  13, Train loss: 0.553, Test loss: 0.716, Test accuracy: 74.48
Round  14, Train loss: 0.493, Test loss: 0.676, Test accuracy: 75.44
Round  15, Train loss: 0.475, Test loss: 0.668, Test accuracy: 76.32
Round  16, Train loss: 0.449, Test loss: 0.674, Test accuracy: 76.44
Round  17, Train loss: 0.422, Test loss: 0.688, Test accuracy: 75.96
Round  18, Train loss: 0.388, Test loss: 0.655, Test accuracy: 77.00
Round  19, Train loss: 0.377, Test loss: 0.673, Test accuracy: 77.08
Round  20, Train loss: 0.351, Test loss: 0.637, Test accuracy: 77.84
Round  21, Train loss: 0.331, Test loss: 0.628, Test accuracy: 77.88
Round  22, Train loss: 0.310, Test loss: 0.635, Test accuracy: 78.12
Round  23, Train loss: 0.299, Test loss: 0.734, Test accuracy: 76.76
Round  24, Train loss: 0.270, Test loss: 0.637, Test accuracy: 78.84
Round  25, Train loss: 0.256, Test loss: 0.610, Test accuracy: 79.68
Round  26, Train loss: 0.229, Test loss: 0.639, Test accuracy: 79.56
Round  27, Train loss: 0.229, Test loss: 0.640, Test accuracy: 79.52
Round  28, Train loss: 0.216, Test loss: 0.625, Test accuracy: 80.20
Round  29, Train loss: 0.199, Test loss: 0.647, Test accuracy: 79.84
Round  30, Train loss: 0.179, Test loss: 0.622, Test accuracy: 80.16
Round  31, Train loss: 0.189, Test loss: 0.638, Test accuracy: 80.08
Round  32, Train loss: 0.163, Test loss: 0.639, Test accuracy: 79.56
Round  33, Train loss: 0.165, Test loss: 0.651, Test accuracy: 80.40
Round  34, Train loss: 0.155, Test loss: 0.635, Test accuracy: 81.32
Round  35, Train loss: 0.146, Test loss: 0.643, Test accuracy: 80.76
Round  36, Train loss: 0.130, Test loss: 0.619, Test accuracy: 81.28
Round  37, Train loss: 0.118, Test loss: 0.635, Test accuracy: 81.48
Round  38, Train loss: 0.134, Test loss: 0.640, Test accuracy: 81.52
Round  39, Train loss: 0.102, Test loss: 0.632, Test accuracy: 81.20
Round  40, Train loss: 0.113, Test loss: 0.661, Test accuracy: 81.20
Round  41, Train loss: 0.102, Test loss: 0.622, Test accuracy: 81.40
Round  42, Train loss: 0.085, Test loss: 0.671, Test accuracy: 80.56
Round  43, Train loss: 0.089, Test loss: 0.665, Test accuracy: 80.80
Round  44, Train loss: 0.083, Test loss: 0.672, Test accuracy: 80.72
Round  45, Train loss: 0.076, Test loss: 0.649, Test accuracy: 81.60
Round  46, Train loss: 0.077, Test loss: 0.658, Test accuracy: 81.28
Round  47, Train loss: 0.070, Test loss: 0.646, Test accuracy: 82.00
Round  48, Train loss: 0.059, Test loss: 0.662, Test accuracy: 81.16
Round  49, Train loss: 0.066, Test loss: 0.671, Test accuracy: 81.28
Final Round, Train loss: 0.036, Test loss: 0.663, Test accuracy: 81.56
Average accuracy final 10 rounds: 81.2
1762.8136253356934
[11.847084045410156, 18.166748046875, 24.499008655548096, 30.84909987449646, 37.667213678359985, 43.934205055236816, 50.22843098640442, 56.7845618724823, 63.42365336418152, 69.75770497322083, 76.15731954574585, 82.5282654762268, 88.74620985984802, 95.22606658935547, 101.6362817287445, 108.01311302185059, 114.5894422531128, 121.00811958312988, 127.36453485488892, 134.5376513004303, 141.03973531723022, 147.56875443458557, 154.1620228290558, 160.79071807861328, 167.09380316734314, 173.61665391921997, 179.9953281879425, 186.41188716888428, 193.1726508140564, 200.22859001159668, 206.9011516571045, 213.35394763946533, 220.07823371887207, 226.56041073799133, 232.74478101730347, 239.14170622825623, 245.7394745349884, 252.27152490615845, 258.72208881378174, 265.58477449417114, 271.95512771606445, 278.56051778793335, 285.14676237106323, 292.009818315506, 298.85745191574097, 305.4575500488281, 311.77633476257324, 318.6005733013153, 324.88528847694397, 331.5535373687744, 338.3518805503845]
[27.4, 40.44, 51.08, 54.88, 61.4, 65.72, 65.12, 65.64, 65.48, 67.4, 67.56, 72.16, 74.28, 74.48, 75.44, 76.32, 76.44, 75.96, 77.0, 77.08, 77.84, 77.88, 78.12, 76.76, 78.84, 79.68, 79.56, 79.52, 80.2, 79.84, 80.16, 80.08, 79.56, 80.4, 81.32, 80.76, 81.28, 81.48, 81.52, 81.2, 81.2, 81.4, 80.56, 80.8, 80.72, 81.6, 81.28, 82.0, 81.16, 81.28, 81.56]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.137, Train accuracy: 96.000, Test loss: 0.989, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.100, Train accuracy: 97.800, Test loss: 0.988, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.094, Train accuracy: 96.600, Test loss: 1.287, Test accuracy: 69.80 

Round   0, Train loss: 0.094, Test loss: 1.287, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.056, Train accuracy: 98.600, Test loss: 1.101, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.600, Test loss: 1.395, Test accuracy: 69.80 

Round   1, Train loss: 0.054, Test loss: 1.395, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.274, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.162, Train accuracy: 93.600, Test loss: 1.871, Test accuracy: 66.00 

Round   2, Train loss: 0.162, Test loss: 1.871, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.400, Test loss: 1.253, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.454, Test accuracy: 71.00 

Round   3, Train loss: 0.022, Test loss: 1.454, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.062, Train accuracy: 98.600, Test loss: 1.524, Test accuracy: 70.00 

Round   4, Train loss: 0.062, Test loss: 1.524, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.407, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.199, Test accuracy: 74.60 

Round   5, Train loss: 0.004, Test loss: 1.199, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.200, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.258, Test accuracy: 74.60 

Round   6, Train loss: 0.008, Test loss: 1.258, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.288, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.491, Test accuracy: 74.40 

Round   7, Train loss: 0.036, Test loss: 1.491, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 73.80 

Round   8, Train loss: 0.004, Test loss: 1.320, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.335, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 74.40 

Round   9, Train loss: 0.007, Test loss: 1.435, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.396, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 74.60 

Round  10, Train loss: 0.002, Test loss: 1.361, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.323, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.195, Test accuracy: 75.80 

Round  11, Train loss: 0.001, Test loss: 1.195, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.299, Test accuracy: 76.40 

Round  12, Train loss: 0.001, Test loss: 1.299, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 98.400, Test loss: 1.916, Test accuracy: 71.80 

Round  13, Train loss: 0.031, Test loss: 1.916, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.440, Test accuracy: 76.60 

Round  14, Train loss: 0.000, Test loss: 1.440, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.443, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.395, Test accuracy: 77.00 

Round  15, Train loss: 0.000, Test loss: 1.395, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 72.00 

Round  16, Train loss: 0.000, Test loss: 1.505, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.486, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 75.20 

Round  17, Train loss: 0.000, Test loss: 1.377, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 74.80 

Round  18, Train loss: 0.002, Test loss: 1.374, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 75.20 

Round  19, Train loss: 0.001, Test loss: 1.376, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.352, Test accuracy: 76.00 

Final Round, Train loss: 0.000, Test loss: 1.355, Test accuracy: 76.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.648, Train accuracy: 74.000, Test loss: 0.793, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.627, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.622, Train accuracy: 77.200, Test loss: 0.753, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.201, Train accuracy: 93.400, Test loss: 0.765, Test accuracy: 76.60 

Round   0, Train loss: 0.101, Test loss: 1.012, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.322, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.249, Train accuracy: 93.000, Test loss: 0.691, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.106, Train accuracy: 96.800, Test loss: 0.838, Test accuracy: 78.80 

Round   1, Train loss: 0.056, Test loss: 1.012, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.210, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.249, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.112, Train accuracy: 97.000, Test loss: 0.669, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.400, Test loss: 0.959, Test accuracy: 77.00 

Round   2, Train loss: 0.038, Test loss: 1.034, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.600, Test loss: 0.742, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 0.798, Test accuracy: 78.20 

Round   3, Train loss: 0.016, Test loss: 0.947, Test accuracy: 79.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.600, Test loss: 0.781, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 98.800, Test loss: 1.128, Test accuracy: 75.00 

Round   4, Train loss: 0.026, Test loss: 1.021, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.240, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.803, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 0.928, Test accuracy: 78.40 

Round   5, Train loss: 0.012, Test loss: 0.992, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 1.299, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.153, Train accuracy: 95.000, Test loss: 1.201, Test accuracy: 72.80 

Round   6, Train loss: 0.092, Test loss: 1.088, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.065, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 0.854, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.130, Test accuracy: 76.20 

Round   7, Train loss: 0.004, Test loss: 0.997, Test accuracy: 78.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.203, Test accuracy: 76.00 

Round   8, Train loss: 0.009, Test loss: 1.150, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 79.40 

Round   9, Train loss: 0.001, Test loss: 0.990, Test accuracy: 79.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 79.60 

Round  10, Train loss: 0.001, Test loss: 1.047, Test accuracy: 79.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.154, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.117, Train accuracy: 97.400, Test loss: 1.212, Test accuracy: 75.60 

Round  11, Train loss: 0.059, Test loss: 1.125, Test accuracy: 78.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.187, Test accuracy: 78.00 

Round  12, Train loss: 0.010, Test loss: 1.149, Test accuracy: 78.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.159, Train accuracy: 94.800, Test loss: 1.625, Test accuracy: 72.20 

Round  13, Train loss: 0.080, Test loss: 1.197, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.320, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 78.80 

Round  14, Train loss: 0.002, Test loss: 1.090, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.998, Test accuracy: 76.80 

Round  15, Train loss: 0.003, Test loss: 1.071, Test accuracy: 78.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.281, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 78.60 

Round  16, Train loss: 0.002, Test loss: 1.134, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.185, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 80.20 

Round  17, Train loss: 0.000, Test loss: 1.038, Test accuracy: 79.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 80.00 

Round  18, Train loss: 0.000, Test loss: 1.037, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.331, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 80.00 

Round  19, Train loss: 0.000, Test loss: 1.113, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 79.40 

Final Round, Train loss: 0.000, Test loss: 1.084, Test accuracy: 79.30 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.681, Train accuracy: 73.000, Test loss: 0.909, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.965, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.728, Train accuracy: 72.000, Test loss: 0.927, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.203, Train accuracy: 93.400, Test loss: 1.232, Test accuracy: 69.00 

Round   0, Train loss: 0.071, Test loss: 0.965, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.071, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.386, Train accuracy: 85.200, Test loss: 0.913, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.100, Train accuracy: 97.200, Test loss: 1.152, Test accuracy: 70.60 

Round   1, Train loss: 0.036, Test loss: 0.982, Test accuracy: 76.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 82.20 

        train local model (freeze embeding):client   2,  Train loss: 0.207, Train accuracy: 93.800, Test loss: 0.993, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.053, Train accuracy: 98.600, Test loss: 1.271, Test accuracy: 70.20 

Round   2, Train loss: 0.018, Test loss: 0.996, Test accuracy: 77.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.029, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.090, Train accuracy: 97.600, Test loss: 1.004, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.112, Train accuracy: 96.000, Test loss: 1.497, Test accuracy: 66.80 

Round   3, Train loss: 0.038, Test loss: 1.009, Test accuracy: 76.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 80.60 

        train local model (freeze embeding):client   2,  Train loss: 0.057, Train accuracy: 99.200, Test loss: 1.137, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 98.000, Test loss: 1.402, Test accuracy: 68.60 

Round   4, Train loss: 0.022, Test loss: 0.955, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.150, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 98.600, Test loss: 1.383, Test accuracy: 69.60 

Round   5, Train loss: 0.013, Test loss: 0.960, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.177, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.111, Train accuracy: 96.000, Test loss: 1.748, Test accuracy: 66.80 

Round   6, Train loss: 0.039, Test loss: 1.011, Test accuracy: 77.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.249, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.601, Test accuracy: 68.60 

Round   7, Train loss: 0.013, Test loss: 1.018, Test accuracy: 77.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.755, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.219, Train accuracy: 93.600, Test loss: 2.251, Test accuracy: 61.80 

Round   8, Train loss: 0.073, Test loss: 1.016, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.782, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 81.60 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.268, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.554, Test accuracy: 73.00 

Round   9, Train loss: 0.002, Test loss: 1.020, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.782, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.000, Test loss: 1.525, Test accuracy: 71.80 

Round  10, Train loss: 0.014, Test loss: 1.041, Test accuracy: 78.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.122, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.547, Test accuracy: 71.80 

Round  11, Train loss: 0.005, Test loss: 1.048, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.830, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.005, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 70.40 

Round  12, Train loss: 0.004, Test loss: 0.998, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.947, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.823, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.556, Test accuracy: 72.00 

Round  13, Train loss: 0.002, Test loss: 1.073, Test accuracy: 78.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.089, Train accuracy: 96.800, Test loss: 1.554, Test accuracy: 71.40 

Round  14, Train loss: 0.030, Test loss: 1.041, Test accuracy: 78.73 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.400, Test loss: 0.868, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 1.872, Test accuracy: 67.60 

Round  15, Train loss: 0.028, Test loss: 1.042, Test accuracy: 78.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.200, Test loss: 1.676, Test accuracy: 68.80 

Round  16, Train loss: 0.009, Test loss: 1.047, Test accuracy: 79.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.844, Test accuracy: 70.00 

Round  17, Train loss: 0.007, Test loss: 1.054, Test accuracy: 78.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.734, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.451, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.539, Test accuracy: 73.20 

Round  18, Train loss: 0.001, Test loss: 1.092, Test accuracy: 78.87 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.855, Test accuracy: 71.20 

Round  19, Train loss: 0.006, Test loss: 1.095, Test accuracy: 79.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.780, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 83.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 75.20 

Final Round, Train loss: 0.000, Test loss: 1.086, Test accuracy: 79.27 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.579, Train accuracy: 77.800, Test loss: 0.771, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.783, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.543, Train accuracy: 80.800, Test loss: 0.716, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.084, Train accuracy: 98.600, Test loss: 0.861, Test accuracy: 75.60 

Round   0, Train loss: 0.021, Test loss: 0.944, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.933, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.302, Train accuracy: 88.200, Test loss: 0.694, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.055, Train accuracy: 98.400, Test loss: 0.912, Test accuracy: 75.40 

Round   1, Train loss: 0.017, Test loss: 0.909, Test accuracy: 79.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.393, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.800, Test loss: 1.441, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.193, Train accuracy: 92.800, Test loss: 0.730, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.136, Train accuracy: 95.200, Test loss: 1.150, Test accuracy: 71.40 

Round   2, Train loss: 0.040, Test loss: 0.882, Test accuracy: 80.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.846, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.110, Train accuracy: 97.000, Test loss: 0.753, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 0.962, Test accuracy: 75.60 

Round   3, Train loss: 0.012, Test loss: 0.891, Test accuracy: 79.95 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.715, Test accuracy: 69.20 

        train local model (freeze embeding):client   3,  Train loss: 0.064, Train accuracy: 98.800, Test loss: 0.789, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 1.051, Test accuracy: 76.00 

Round   4, Train loss: 0.017, Test loss: 0.939, Test accuracy: 79.35 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.581, Test accuracy: 70.60 

        train local model (freeze embeding):client   3,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 0.809, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.107, Test accuracy: 75.60 

Round   5, Train loss: 0.008, Test loss: 0.957, Test accuracy: 79.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.240, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.706, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.540, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.836, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.321, Train accuracy: 87.800, Test loss: 1.637, Test accuracy: 66.20 

Round   6, Train loss: 0.085, Test loss: 0.941, Test accuracy: 79.05 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.090, Train accuracy: 97.600, Test loss: 1.257, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.267, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.843, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 0.875, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.191, Test accuracy: 75.20 

Round   7, Train loss: 0.041, Test loss: 0.985, Test accuracy: 79.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.171, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.588, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 0.885, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.111, Test accuracy: 76.00 

Round   8, Train loss: 0.008, Test loss: 0.937, Test accuracy: 79.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.671, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.726, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.041, Train accuracy: 98.400, Test loss: 1.347, Test accuracy: 72.40 

Round   9, Train loss: 0.011, Test loss: 0.939, Test accuracy: 79.85 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.764, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.691, Test accuracy: 72.20 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.064, Train accuracy: 97.800, Test loss: 1.347, Test accuracy: 72.20 

Round  10, Train loss: 0.022, Test loss: 0.945, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.495, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.168, Test accuracy: 77.60 

Round  11, Train loss: 0.002, Test loss: 0.923, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.724, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.400, Test loss: 1.272, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.104, Test accuracy: 78.20 

Round  12, Train loss: 0.015, Test loss: 0.907, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.655, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.785, Test accuracy: 84.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 78.60 

Round  13, Train loss: 0.002, Test loss: 0.903, Test accuracy: 81.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.226, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.074, Train accuracy: 97.200, Test loss: 1.634, Test accuracy: 69.80 

Round  14, Train loss: 0.025, Test loss: 0.974, Test accuracy: 80.15 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.721, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.258, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.317, Test accuracy: 76.60 

Round  15, Train loss: 0.002, Test loss: 0.936, Test accuracy: 80.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.081, Train accuracy: 98.200, Test loss: 1.140, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.785, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 76.60 

Round  16, Train loss: 0.023, Test loss: 0.941, Test accuracy: 80.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.600, Test loss: 1.604, Test accuracy: 71.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 78.60 

Round  17, Train loss: 0.009, Test loss: 0.959, Test accuracy: 80.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.694, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 84.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.570, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 78.00 

Round  18, Train loss: 0.004, Test loss: 0.952, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 81.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.207, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 78.00 

Round  19, Train loss: 0.001, Test loss: 0.956, Test accuracy: 80.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.696, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 76.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 79.60 

Final Round, Train loss: 0.000, Test loss: 0.944, Test accuracy: 80.70 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.599, Train accuracy: 77.800, Test loss: 0.693, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.788, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.011, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.180, Test accuracy: 75.20 

        train local model (freeze embeding):client   4,  Train loss: 0.544, Train accuracy: 80.600, Test loss: 0.665, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.087, Train accuracy: 97.200, Test loss: 0.930, Test accuracy: 75.60 

Round   0, Train loss: 0.023, Test loss: 0.889, Test accuracy: 80.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.750, Test accuracy: 84.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 76.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.319, Test accuracy: 76.00 

        train local model (freeze embeding):client   4,  Train loss: 0.348, Train accuracy: 87.800, Test loss: 0.720, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.800, Test loss: 0.993, Test accuracy: 76.60 

Round   1, Train loss: 0.011, Test loss: 0.903, Test accuracy: 80.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 82.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.064, Train accuracy: 97.200, Test loss: 2.079, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 79.20 

        train local model (freeze embeding):client   4,  Train loss: 0.209, Train accuracy: 93.400, Test loss: 0.768, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.057, Train accuracy: 98.400, Test loss: 0.972, Test accuracy: 75.20 

Round   2, Train loss: 0.025, Test loss: 0.895, Test accuracy: 80.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.697, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.482, Test accuracy: 74.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 99.400, Test loss: 1.289, Test accuracy: 75.60 

        train local model (freeze embeding):client   4,  Train loss: 0.149, Train accuracy: 95.000, Test loss: 0.707, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.005, Test accuracy: 77.40 

Round   3, Train loss: 0.017, Test loss: 0.853, Test accuracy: 81.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.340, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.213, Test accuracy: 79.60 

        train local model (freeze embeding):client   4,  Train loss: 0.100, Train accuracy: 97.200, Test loss: 0.748, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.132, Train accuracy: 95.600, Test loss: 1.396, Test accuracy: 72.40 

Round   4, Train loss: 0.028, Test loss: 0.892, Test accuracy: 80.64 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.086, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.753, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 77.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.197, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.087, Train accuracy: 97.400, Test loss: 0.782, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.800, Test loss: 0.889, Test accuracy: 75.20 

Round   5, Train loss: 0.008, Test loss: 0.864, Test accuracy: 80.76 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 78.20 

        train local model (freeze embeding):client   4,  Train loss: 0.042, Train accuracy: 99.800, Test loss: 0.769, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.083, Train accuracy: 97.200, Test loss: 1.446, Test accuracy: 72.00 

Round   6, Train loss: 0.018, Test loss: 0.890, Test accuracy: 80.64 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.746, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.446, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.512, Test accuracy: 74.40 

        train local model (freeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 0.857, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.121, Test accuracy: 75.20 

Round   7, Train loss: 0.019, Test loss: 0.892, Test accuracy: 80.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.936, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 75.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 78.20 

        train local model (freeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 0.837, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.200, Test loss: 1.112, Test accuracy: 75.40 

Round   8, Train loss: 0.012, Test loss: 0.889, Test accuracy: 81.04 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.733, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 77.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.306, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 0.925, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 1.138, Test accuracy: 74.60 

Round   9, Train loss: 0.011, Test loss: 0.875, Test accuracy: 81.28 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.742, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 83.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.702, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 1.903, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.284, Test accuracy: 78.60 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 0.903, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.091, Test accuracy: 76.20 

Round  10, Train loss: 0.012, Test loss: 0.912, Test accuracy: 80.32 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.364, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.025, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 78.80 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 98.600, Test loss: 1.195, Test accuracy: 76.40 

Round  11, Train loss: 0.009, Test loss: 0.875, Test accuracy: 81.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.726, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.674, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 83.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.145, Test accuracy: 78.60 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 1.165, Test accuracy: 74.60 

Round  12, Train loss: 0.010, Test loss: 0.866, Test accuracy: 82.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.751, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.736, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.402, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.192, Test accuracy: 77.40 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 74.20 

Round  13, Train loss: 0.005, Test loss: 0.886, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 84.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.724, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.148, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 78.80 

Round  14, Train loss: 0.002, Test loss: 0.872, Test accuracy: 81.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.734, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.717, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.242, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.446, Test accuracy: 74.60 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.309, Test accuracy: 74.60 

Round  15, Train loss: 0.015, Test loss: 0.892, Test accuracy: 81.44 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.018, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.623, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 79.80 

Round  16, Train loss: 0.006, Test loss: 0.917, Test accuracy: 81.68 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.054, Train accuracy: 98.400, Test loss: 1.291, Test accuracy: 72.00 

Round  17, Train loss: 0.012, Test loss: 0.907, Test accuracy: 81.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.729, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.216, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.142, Train accuracy: 95.000, Test loss: 1.844, Test accuracy: 70.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.199, Test accuracy: 78.40 

Round  18, Train loss: 0.029, Test loss: 0.920, Test accuracy: 81.36 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.742, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.372, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.422, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.141, Test accuracy: 75.80 

Round  19, Train loss: 0.008, Test loss: 0.893, Test accuracy: 81.52 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 80.80 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 78.60 

Final Round, Train loss: 0.001, Test loss: 0.896, Test accuracy: 81.84 

Average accuracy final 10 rounds: 394.5803333333334 

6138.9842364788055
[19.03223991394043, 37.87529754638672, 57.07682180404663, 76.37036347389221, 95.30226445198059, 113.94114565849304, 132.82001495361328, 151.40860438346863, 170.67686581611633, 188.9625277519226, 208.7376971244812, 227.58266234397888, 246.3534801006317, 264.9057631492615, 284.3083288669586, 303.4117867946625, 322.47232031822205, 341.650089263916, 361.3953595161438, 380.7166361808777, 391.1695101261139, 410.854371547699, 429.7949552536011, 449.04893040657043, 468.3358654975891, 487.6868050098419, 507.01521825790405, 526.121768951416, 545.5413157939911, 564.6023669242859, 583.6949443817139, 602.7543580532074, 621.9361510276794, 641.0041654109955, 660.1373648643494, 679.2832298278809, 698.3550989627838, 717.6214666366577, 737.302885055542, 756.8156154155731, 776.8080201148987, 787.4401803016663, 806.7758357524872, 826.36248254776, 845.4925105571747, 864.6151723861694, 883.7019834518433, 902.8181600570679, 922.0249683856964, 941.7731909751892, 961.1112945079803, 980.4942798614502, 999.4280426502228, 1018.9866318702698, 1038.5235686302185, 1057.8331727981567, 1077.8891191482544, 1096.8360967636108, 1116.418496131897, 1135.6885344982147, 1154.7136578559875, 1173.5686521530151, 1184.586805343628, 1203.2356431484222, 1222.1955406665802, 1241.619369983673, 1260.4925599098206, 1279.5328209400177, 1298.489908695221, 1317.876537322998, 1336.559496164322, 1355.618057012558, 1374.7158634662628, 1393.652313709259, 1412.5252130031586, 1431.2252941131592, 1450.18816781044, 1469.1791791915894, 1489.1065328121185, 1508.1445291042328, 1527.452208518982, 1546.3346252441406, 1565.5947661399841, 1576.1990451812744, 1595.5597071647644, 1614.5328845977783, 1633.547213792801, 1652.7204496860504, 1671.7977306842804, 1691.4490399360657, 1710.8878951072693, 1730.2605907917023, 1749.0832998752594, 1768.123458623886, 1788.059434890747, 1807.341679096222, 1827.2488372325897, 1846.3927764892578, 1865.6495106220245, 1884.734530210495, 1903.7602441310883, 1922.553995847702, 1941.7623362541199, 1960.7650020122528, 1972.9977233409882]
[69.8, 69.8, 66.0, 71.0, 70.0, 74.6, 74.6, 74.4, 73.8, 74.4, 74.6, 75.8, 76.4, 71.8, 76.6, 77.0, 72.0, 75.2, 74.8, 75.2, 76.4, 76.6, 76.4, 77.4, 79.1, 78.5, 78.5, 76.6, 78.6, 77.5, 79.1, 79.4, 78.4, 78.1, 77.4, 81.1, 78.8, 78.2, 79.3, 79.2, 79.2, 79.3, 76.4, 76.93333333333334, 77.13333333333334, 76.73333333333333, 77.8, 77.8, 77.66666666666667, 77.93333333333334, 78.0, 78.66666666666667, 78.33333333333333, 78.66666666666667, 78.66666666666667, 78.6, 78.73333333333333, 78.93333333333334, 79.06666666666666, 78.8, 78.86666666666666, 79.06666666666666, 79.26666666666667, 79.2, 79.65, 80.15, 79.95, 79.35, 79.2, 79.05, 79.1, 79.9, 79.85, 80.0, 80.25, 81.1, 81.1, 80.15, 80.4, 80.6, 80.1, 80.5, 80.65, 80.7, 80.2, 80.76, 80.76, 81.4, 80.64, 80.76, 80.64, 80.96, 81.04, 81.28, 80.32, 81.48, 82.12, 82.0, 81.6, 81.44, 81.68, 81.2, 81.36, 81.52, 81.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.501, Test loss: 1.302, Test accuracy: 47.24 

Round   0, Global train loss: 1.501, Global test loss: 2.330, Global test accuracy: 16.64 

Round   1, Train loss: 1.160, Test loss: 1.350, Test accuracy: 52.96 

Round   1, Global train loss: 1.160, Global test loss: 2.348, Global test accuracy: 16.00 

Round   2, Train loss: 1.004, Test loss: 1.324, Test accuracy: 53.40 

Round   2, Global train loss: 1.004, Global test loss: 2.453, Global test accuracy: 20.36 

Round   3, Train loss: 0.871, Test loss: 1.301, Test accuracy: 56.60 

Round   3, Global train loss: 0.871, Global test loss: 2.330, Global test accuracy: 19.88 

Round   4, Train loss: 0.757, Test loss: 1.477, Test accuracy: 56.08 

Round   4, Global train loss: 0.757, Global test loss: 2.347, Global test accuracy: 20.28 

Round   5, Train loss: 0.646, Test loss: 1.418, Test accuracy: 58.16 

Round   5, Global train loss: 0.646, Global test loss: 2.374, Global test accuracy: 16.08 

Round   6, Train loss: 0.551, Test loss: 1.593, Test accuracy: 56.04 

Round   6, Global train loss: 0.551, Global test loss: 2.394, Global test accuracy: 16.08 

Round   7, Train loss: 0.478, Test loss: 1.871, Test accuracy: 55.56 

Round   7, Global train loss: 0.478, Global test loss: 2.465, Global test accuracy: 16.04 

Round   8, Train loss: 0.397, Test loss: 1.710, Test accuracy: 57.44 

Round   8, Global train loss: 0.397, Global test loss: 2.394, Global test accuracy: 16.76 

Round   9, Train loss: 0.335, Test loss: 1.693, Test accuracy: 59.16 

Round   9, Global train loss: 0.335, Global test loss: 2.351, Global test accuracy: 16.00 

Round  10, Train loss: 0.302, Test loss: 1.821, Test accuracy: 59.88 

Round  10, Global train loss: 0.302, Global test loss: 2.361, Global test accuracy: 16.04 

Round  11, Train loss: 0.231, Test loss: 1.902, Test accuracy: 60.40 

Round  11, Global train loss: 0.231, Global test loss: 2.462, Global test accuracy: 16.04 

Round  12, Train loss: 0.225, Test loss: 1.866, Test accuracy: 59.84 

Round  12, Global train loss: 0.225, Global test loss: 2.421, Global test accuracy: 16.68 

Round  13, Train loss: 0.180, Test loss: 2.074, Test accuracy: 59.56 

Round  13, Global train loss: 0.180, Global test loss: 2.439, Global test accuracy: 16.00 

Round  14, Train loss: 0.170, Test loss: 2.045, Test accuracy: 60.64 

Round  14, Global train loss: 0.170, Global test loss: 2.379, Global test accuracy: 16.00 

Round  15, Train loss: 0.134, Test loss: 2.068, Test accuracy: 59.80 

Round  15, Global train loss: 0.134, Global test loss: 2.459, Global test accuracy: 16.00 

Round  16, Train loss: 0.126, Test loss: 1.970, Test accuracy: 62.40 

Round  16, Global train loss: 0.126, Global test loss: 2.454, Global test accuracy: 16.04 

Round  17, Train loss: 0.123, Test loss: 2.078, Test accuracy: 61.04 

Round  17, Global train loss: 0.123, Global test loss: 2.419, Global test accuracy: 16.04 

Round  18, Train loss: 0.080, Test loss: 2.163, Test accuracy: 61.44 

Round  18, Global train loss: 0.080, Global test loss: 2.480, Global test accuracy: 16.04 

Round  19, Train loss: 0.096, Test loss: 2.196, Test accuracy: 61.08 

Round  19, Global train loss: 0.096, Global test loss: 2.440, Global test accuracy: 16.04 

Round  20, Train loss: 0.077, Test loss: 2.170, Test accuracy: 61.60 

Round  20, Global train loss: 0.077, Global test loss: 2.436, Global test accuracy: 16.04 

Round  21, Train loss: 0.067, Test loss: 2.115, Test accuracy: 63.56 

Round  21, Global train loss: 0.067, Global test loss: 2.399, Global test accuracy: 16.04 

Round  22, Train loss: 0.062, Test loss: 2.139, Test accuracy: 61.52 

Round  22, Global train loss: 0.062, Global test loss: 2.434, Global test accuracy: 16.04 

Round  23, Train loss: 0.044, Test loss: 2.085, Test accuracy: 62.92 

Round  23, Global train loss: 0.044, Global test loss: 2.482, Global test accuracy: 16.00 

Round  24, Train loss: 0.051, Test loss: 2.262, Test accuracy: 62.00 

Round  24, Global train loss: 0.051, Global test loss: 2.440, Global test accuracy: 16.04 

Round  25, Train loss: 0.065, Test loss: 2.299, Test accuracy: 60.80 

Round  25, Global train loss: 0.065, Global test loss: 2.404, Global test accuracy: 16.04 

Round  26, Train loss: 0.044, Test loss: 2.351, Test accuracy: 61.64 

Round  26, Global train loss: 0.044, Global test loss: 2.420, Global test accuracy: 16.04 

Round  27, Train loss: 0.046, Test loss: 2.105, Test accuracy: 63.64 

Round  27, Global train loss: 0.046, Global test loss: 2.373, Global test accuracy: 16.04 

Round  28, Train loss: 0.046, Test loss: 2.204, Test accuracy: 62.44 

Round  28, Global train loss: 0.046, Global test loss: 2.386, Global test accuracy: 16.00 

Round  29, Train loss: 0.044, Test loss: 2.262, Test accuracy: 62.20 

Round  29, Global train loss: 0.044, Global test loss: 2.375, Global test accuracy: 16.20 

Round  30, Train loss: 0.034, Test loss: 2.222, Test accuracy: 62.84 

Round  30, Global train loss: 0.034, Global test loss: 2.355, Global test accuracy: 16.32 

Round  31, Train loss: 0.035, Test loss: 2.299, Test accuracy: 62.28 

Round  31, Global train loss: 0.035, Global test loss: 2.359, Global test accuracy: 16.04 

Round  32, Train loss: 0.029, Test loss: 2.398, Test accuracy: 63.08 

Round  32, Global train loss: 0.029, Global test loss: 2.363, Global test accuracy: 16.04 

Round  33, Train loss: 0.027, Test loss: 2.240, Test accuracy: 63.48 

Round  33, Global train loss: 0.027, Global test loss: 2.416, Global test accuracy: 16.04 

Round  34, Train loss: 0.030, Test loss: 2.241, Test accuracy: 63.72 

Round  34, Global train loss: 0.030, Global test loss: 2.377, Global test accuracy: 16.04 

Final Round, Train loss: 0.024, Test loss: 2.241, Test accuracy: 63.68 

Final Round, Global train loss: 0.024, Global test loss: 2.377, Global test accuracy: 16.04 

Average accuracy final 10 rounds: 62.612 

Average global accuracy final 10 rounds: 16.079999999999995 

1473.505716085434
[12.550217866897583, 19.356526136398315, 26.159385442733765, 33.033437967300415, 40.05532455444336, 46.93758487701416, 53.934365034103394, 60.70834708213806, 67.60444688796997, 74.68334603309631, 81.52463865280151, 88.3447036743164, 95.28086805343628, 102.36438870429993, 109.3120973110199, 116.3584258556366, 123.19761180877686, 130.09145307540894, 136.87697577476501, 143.67729878425598, 150.37341237068176, 157.36887383460999, 164.4505307674408, 171.48645210266113, 178.3182578086853, 185.20104908943176, 192.2765407562256, 199.2024097442627, 206.0641167163849, 212.93638253211975, 219.90007090568542, 226.97910714149475, 233.82810974121094, 240.73103022575378, 247.6269233226776, 261.0459837913513]
[47.24, 52.96, 53.4, 56.6, 56.08, 58.16, 56.04, 55.56, 57.44, 59.16, 59.88, 60.4, 59.84, 59.56, 60.64, 59.8, 62.4, 61.04, 61.44, 61.08, 61.6, 63.56, 61.52, 62.92, 62.0, 60.8, 61.64, 63.64, 62.44, 62.2, 62.84, 62.28, 63.08, 63.48, 63.72, 63.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.502, Test loss: 1.436, Test accuracy: 45.16 

Round   0, Global train loss: 1.502, Global test loss: 2.419, Global test accuracy: 17.88 

Round   1, Train loss: 1.357, Test loss: 1.360, Test accuracy: 48.28 

Round   1, Global train loss: 1.357, Global test loss: 2.115, Global test accuracy: 22.96 

Round   2, Train loss: 1.228, Test loss: 1.355, Test accuracy: 49.20 

Round   2, Global train loss: 1.228, Global test loss: 1.856, Global test accuracy: 34.48 

Round   3, Train loss: 1.114, Test loss: 1.224, Test accuracy: 54.12 

Round   3, Global train loss: 1.114, Global test loss: 1.750, Global test accuracy: 37.92 

Round   4, Train loss: 1.036, Test loss: 1.313, Test accuracy: 54.12 

Round   4, Global train loss: 1.036, Global test loss: 1.579, Global test accuracy: 44.12 

Round   5, Train loss: 0.950, Test loss: 1.313, Test accuracy: 54.84 

Round   5, Global train loss: 0.950, Global test loss: 1.646, Global test accuracy: 43.76 

Round   6, Train loss: 0.890, Test loss: 1.119, Test accuracy: 60.44 

Round   6, Global train loss: 0.890, Global test loss: 1.470, Global test accuracy: 48.16 

Round   7, Train loss: 0.824, Test loss: 1.356, Test accuracy: 56.88 

Round   7, Global train loss: 0.824, Global test loss: 1.452, Global test accuracy: 49.64 

Round   8, Train loss: 0.786, Test loss: 1.236, Test accuracy: 59.52 

Round   8, Global train loss: 0.786, Global test loss: 1.476, Global test accuracy: 49.72 

Round   9, Train loss: 0.726, Test loss: 1.264, Test accuracy: 60.12 

Round   9, Global train loss: 0.726, Global test loss: 1.309, Global test accuracy: 54.84 

Round  10, Train loss: 0.677, Test loss: 1.492, Test accuracy: 58.08 

Round  10, Global train loss: 0.677, Global test loss: 1.383, Global test accuracy: 52.76 

Round  11, Train loss: 0.637, Test loss: 1.286, Test accuracy: 61.36 

Round  11, Global train loss: 0.637, Global test loss: 1.329, Global test accuracy: 55.76 

Round  12, Train loss: 0.576, Test loss: 1.204, Test accuracy: 65.20 

Round  12, Global train loss: 0.576, Global test loss: 1.286, Global test accuracy: 56.92 

Round  13, Train loss: 0.558, Test loss: 1.657, Test accuracy: 59.00 

Round  13, Global train loss: 0.558, Global test loss: 1.279, Global test accuracy: 57.56 

Round  14, Train loss: 0.523, Test loss: 1.222, Test accuracy: 64.60 

Round  14, Global train loss: 0.523, Global test loss: 1.301, Global test accuracy: 57.96 

Round  15, Train loss: 0.488, Test loss: 1.206, Test accuracy: 66.16 

Round  15, Global train loss: 0.488, Global test loss: 1.452, Global test accuracy: 55.36 

Round  16, Train loss: 0.451, Test loss: 1.486, Test accuracy: 61.60 

Round  16, Global train loss: 0.451, Global test loss: 1.305, Global test accuracy: 59.28 

Round  17, Train loss: 0.428, Test loss: 1.651, Test accuracy: 63.36 

Round  17, Global train loss: 0.428, Global test loss: 1.265, Global test accuracy: 60.92 

Round  18, Train loss: 0.401, Test loss: 1.465, Test accuracy: 62.32 

Round  18, Global train loss: 0.401, Global test loss: 1.312, Global test accuracy: 59.20 

Round  19, Train loss: 0.370, Test loss: 1.425, Test accuracy: 64.80 

Round  19, Global train loss: 0.370, Global test loss: 1.367, Global test accuracy: 60.32 

Round  20, Train loss: 0.333, Test loss: 1.442, Test accuracy: 64.92 

Round  20, Global train loss: 0.333, Global test loss: 1.262, Global test accuracy: 61.60 

Round  21, Train loss: 0.336, Test loss: 1.372, Test accuracy: 65.60 

Round  21, Global train loss: 0.336, Global test loss: 1.276, Global test accuracy: 61.04 

Round  22, Train loss: 0.321, Test loss: 1.316, Test accuracy: 67.08 

Round  22, Global train loss: 0.321, Global test loss: 1.313, Global test accuracy: 60.92 

Round  23, Train loss: 0.291, Test loss: 1.345, Test accuracy: 66.80 

Round  23, Global train loss: 0.291, Global test loss: 1.266, Global test accuracy: 61.84 

Round  24, Train loss: 0.269, Test loss: 1.666, Test accuracy: 64.36 

Round  24, Global train loss: 0.269, Global test loss: 1.359, Global test accuracy: 61.12 

Round  25, Train loss: 0.242, Test loss: 1.491, Test accuracy: 65.64 

Round  25, Global train loss: 0.242, Global test loss: 1.366, Global test accuracy: 61.04 

Round  26, Train loss: 0.226, Test loss: 1.382, Test accuracy: 68.44 

Round  26, Global train loss: 0.226, Global test loss: 1.341, Global test accuracy: 62.92 

Round  27, Train loss: 0.227, Test loss: 1.460, Test accuracy: 66.32 

Round  27, Global train loss: 0.227, Global test loss: 1.310, Global test accuracy: 63.76 

Round  28, Train loss: 0.211, Test loss: 1.540, Test accuracy: 66.40 

Round  28, Global train loss: 0.211, Global test loss: 1.317, Global test accuracy: 62.60 

Round  29, Train loss: 0.198, Test loss: 1.458, Test accuracy: 69.04 

Round  29, Global train loss: 0.198, Global test loss: 1.338, Global test accuracy: 62.44 

Round  30, Train loss: 0.195, Test loss: 1.543, Test accuracy: 66.60 

Round  30, Global train loss: 0.195, Global test loss: 1.388, Global test accuracy: 62.32 

Round  31, Train loss: 0.179, Test loss: 1.373, Test accuracy: 68.72 

Round  31, Global train loss: 0.179, Global test loss: 1.369, Global test accuracy: 61.88 

Round  32, Train loss: 0.163, Test loss: 1.478, Test accuracy: 66.76 

Round  32, Global train loss: 0.163, Global test loss: 1.381, Global test accuracy: 62.72 

Round  33, Train loss: 0.174, Test loss: 1.594, Test accuracy: 67.68 

Round  33, Global train loss: 0.174, Global test loss: 1.363, Global test accuracy: 62.32 

Round  34, Train loss: 0.120, Test loss: 1.526, Test accuracy: 68.56 

Round  34, Global train loss: 0.120, Global test loss: 1.348, Global test accuracy: 63.12 

Round  35, Train loss: 0.135, Test loss: 1.485, Test accuracy: 69.56 

Round  35, Global train loss: 0.135, Global test loss: 1.426, Global test accuracy: 63.24 

Round  36, Train loss: 0.151, Test loss: 1.631, Test accuracy: 66.24 

Round  36, Global train loss: 0.151, Global test loss: 1.364, Global test accuracy: 63.24 

Round  37, Train loss: 0.113, Test loss: 1.470, Test accuracy: 69.52 

Round  37, Global train loss: 0.113, Global test loss: 1.342, Global test accuracy: 64.36 

Round  38, Train loss: 0.134, Test loss: 1.467, Test accuracy: 70.64 

Round  38, Global train loss: 0.134, Global test loss: 1.376, Global test accuracy: 63.44 

Round  39, Train loss: 0.123, Test loss: 1.431, Test accuracy: 69.96 

Round  39, Global train loss: 0.123, Global test loss: 1.365, Global test accuracy: 63.88 

Round  40, Train loss: 0.089, Test loss: 1.924, Test accuracy: 67.08 

Round  40, Global train loss: 0.089, Global test loss: 1.519, Global test accuracy: 61.68 

Round  41, Train loss: 0.130, Test loss: 1.403, Test accuracy: 70.12 

Round  41, Global train loss: 0.130, Global test loss: 1.370, Global test accuracy: 63.48 

Round  42, Train loss: 0.087, Test loss: 1.452, Test accuracy: 69.92 

Round  42, Global train loss: 0.087, Global test loss: 1.386, Global test accuracy: 63.84 

Round  43, Train loss: 0.074, Test loss: 1.535, Test accuracy: 68.32 

Round  43, Global train loss: 0.074, Global test loss: 1.470, Global test accuracy: 63.12 

Round  44, Train loss: 0.082, Test loss: 1.541, Test accuracy: 69.12 

Round  44, Global train loss: 0.082, Global test loss: 1.415, Global test accuracy: 63.48 

Round  45, Train loss: 0.075, Test loss: 1.563, Test accuracy: 69.64 

Round  45, Global train loss: 0.075, Global test loss: 1.419, Global test accuracy: 63.80 

Round  46, Train loss: 0.066, Test loss: 1.472, Test accuracy: 70.36 

Round  46, Global train loss: 0.066, Global test loss: 1.448, Global test accuracy: 63.44 

Round  47, Train loss: 0.079, Test loss: 1.750, Test accuracy: 67.40 

Round  47, Global train loss: 0.079, Global test loss: 1.436, Global test accuracy: 64.08 

Round  48, Train loss: 0.065, Test loss: 1.520, Test accuracy: 69.96 

Round  48, Global train loss: 0.065, Global test loss: 1.411, Global test accuracy: 64.40 

Round  49, Train loss: 0.073, Test loss: 1.671, Test accuracy: 68.16 

Round  49, Global train loss: 0.073, Global test loss: 1.463, Global test accuracy: 64.24 

Final Round, Train loss: 0.072, Test loss: 1.820, Test accuracy: 67.52 

Final Round, Global train loss: 0.072, Global test loss: 1.463, Global test accuracy: 64.24 

Average accuracy final 10 rounds: 69.008 

Average global accuracy final 10 rounds: 63.556 

2071.460197687149
[12.353539943695068, 19.51562762260437, 26.432470083236694, 33.464354038238525, 40.47102093696594, 47.479970932006836, 54.37922477722168, 61.347941398620605, 68.43834853172302, 75.37989473342896, 82.3877124786377, 89.24331164360046, 96.20689105987549, 102.98475480079651, 109.74843263626099, 116.6132378578186, 123.52834701538086, 130.40513157844543, 137.4397280216217, 144.524160861969, 151.57646369934082, 158.37794280052185, 165.28825330734253, 172.07610297203064, 178.84579873085022, 185.5573959350586, 192.1860008239746, 198.8677294254303, 205.66843795776367, 212.73444867134094, 219.80050659179688, 226.74341225624084, 233.60267639160156, 240.72365427017212, 247.6047327518463, 254.49461483955383, 261.63422679901123, 268.6083116531372, 275.8065388202667, 282.65378403663635, 289.3359398841858, 295.9680941104889, 302.8902518749237, 309.8840425014496, 316.6846787929535, 323.54744839668274, 330.2663764953613, 337.22879910469055, 344.07174468040466, 351.0343883037567, 364.49929022789]
[45.16, 48.28, 49.2, 54.12, 54.12, 54.84, 60.44, 56.88, 59.52, 60.12, 58.08, 61.36, 65.2, 59.0, 64.6, 66.16, 61.6, 63.36, 62.32, 64.8, 64.92, 65.6, 67.08, 66.8, 64.36, 65.64, 68.44, 66.32, 66.4, 69.04, 66.6, 68.72, 66.76, 67.68, 68.56, 69.56, 66.24, 69.52, 70.64, 69.96, 67.08, 70.12, 69.92, 68.32, 69.12, 69.64, 70.36, 67.4, 69.96, 68.16, 67.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.579, Test loss: 1.738, Test accuracy: 23.96 

Round   1, Train loss: 1.398, Test loss: 1.509, Test accuracy: 34.64 

Round   2, Train loss: 1.243, Test loss: 1.227, Test accuracy: 49.72 

Round   3, Train loss: 1.150, Test loss: 1.230, Test accuracy: 50.96 

Round   4, Train loss: 1.072, Test loss: 1.140, Test accuracy: 53.40 

Round   5, Train loss: 1.007, Test loss: 1.206, Test accuracy: 52.32 

Round   6, Train loss: 0.958, Test loss: 1.079, Test accuracy: 57.12 

Round   7, Train loss: 0.905, Test loss: 1.070, Test accuracy: 58.16 

Round   8, Train loss: 0.867, Test loss: 1.040, Test accuracy: 60.28 

Round   9, Train loss: 0.831, Test loss: 1.031, Test accuracy: 59.32 

Round  10, Train loss: 0.786, Test loss: 1.016, Test accuracy: 60.72 

Round  11, Train loss: 0.747, Test loss: 0.934, Test accuracy: 64.00 

Round  12, Train loss: 0.707, Test loss: 0.940, Test accuracy: 65.72 

Round  13, Train loss: 0.680, Test loss: 1.002, Test accuracy: 63.68 

Round  14, Train loss: 0.650, Test loss: 0.992, Test accuracy: 64.48 

Round  15, Train loss: 0.611, Test loss: 0.945, Test accuracy: 64.96 

Round  16, Train loss: 0.588, Test loss: 0.918, Test accuracy: 67.24 

Round  17, Train loss: 0.561, Test loss: 0.996, Test accuracy: 66.32 

Round  18, Train loss: 0.534, Test loss: 0.973, Test accuracy: 66.08 

Round  19, Train loss: 0.505, Test loss: 0.957, Test accuracy: 65.40 

Round  20, Train loss: 0.493, Test loss: 0.964, Test accuracy: 67.44 

Round  21, Train loss: 0.456, Test loss: 0.968, Test accuracy: 67.72 

Round  22, Train loss: 0.433, Test loss: 0.996, Test accuracy: 66.40 

Round  23, Train loss: 0.410, Test loss: 1.022, Test accuracy: 66.40 

Round  24, Train loss: 0.400, Test loss: 1.010, Test accuracy: 67.60 

Round  25, Train loss: 0.375, Test loss: 0.957, Test accuracy: 68.20 

Round  26, Train loss: 0.362, Test loss: 0.975, Test accuracy: 68.28 

Round  27, Train loss: 0.343, Test loss: 0.949, Test accuracy: 68.52 

Round  28, Train loss: 0.323, Test loss: 0.941, Test accuracy: 68.92 

Round  29, Train loss: 0.292, Test loss: 0.979, Test accuracy: 69.36 

Round  30, Train loss: 0.290, Test loss: 1.016, Test accuracy: 69.28 

Round  31, Train loss: 0.275, Test loss: 1.039, Test accuracy: 68.88 

Round  32, Train loss: 0.256, Test loss: 1.029, Test accuracy: 69.48 

Round  33, Train loss: 0.245, Test loss: 0.985, Test accuracy: 70.68 

Round  34, Train loss: 0.222, Test loss: 1.018, Test accuracy: 71.20 

Round  35, Train loss: 0.226, Test loss: 1.008, Test accuracy: 70.60 

Round  36, Train loss: 0.194, Test loss: 1.000, Test accuracy: 71.56 

Round  37, Train loss: 0.177, Test loss: 1.010, Test accuracy: 71.32 

Round  38, Train loss: 0.182, Test loss: 1.054, Test accuracy: 70.76 

Round  39, Train loss: 0.172, Test loss: 1.053, Test accuracy: 69.60 

Round  40, Train loss: 0.162, Test loss: 1.008, Test accuracy: 71.80 

Round  41, Train loss: 0.148, Test loss: 1.054, Test accuracy: 71.32 

Round  42, Train loss: 0.150, Test loss: 1.050, Test accuracy: 72.40 

Round  43, Train loss: 0.143, Test loss: 1.077, Test accuracy: 70.40 

Round  44, Train loss: 0.134, Test loss: 1.054, Test accuracy: 71.52 

Round  45, Train loss: 0.113, Test loss: 1.060, Test accuracy: 71.96 

Round  46, Train loss: 0.116, Test loss: 1.097, Test accuracy: 71.20 

Round  47, Train loss: 0.122, Test loss: 1.095, Test accuracy: 71.40 

Round  48, Train loss: 0.101, Test loss: 1.077, Test accuracy: 72.28 

Round  49, Train loss: 0.089, Test loss: 1.073, Test accuracy: 71.92 

Final Round, Train loss: 0.054, Test loss: 1.106, Test accuracy: 71.24 

Average accuracy final 10 rounds: 71.62 

1495.3012082576752
[11.095281600952148, 16.77990221977234, 22.07886791229248, 27.644471645355225, 33.131664514541626, 38.53679370880127, 44.021042585372925, 49.28788495063782, 54.55579900741577, 59.86500358581543, 65.38082075119019, 70.81962537765503, 76.32941699028015, 81.74391317367554, 86.88213396072388, 92.17770385742188, 97.59597086906433, 103.02668881416321, 108.24999523162842, 113.44154810905457, 118.90773892402649, 124.29557776451111, 129.5306842327118, 134.81286549568176, 140.38035798072815, 145.73049521446228, 151.20386147499084, 156.5780429840088, 162.09347414970398, 167.49376392364502, 172.67802953720093, 178.13652634620667, 183.25603413581848, 188.47507214546204, 193.9283845424652, 199.12682223320007, 204.4451401233673, 209.69585275650024, 215.10193872451782, 220.515056848526, 225.6883418560028, 231.08403158187866, 236.54729533195496, 242.17503929138184, 247.7271134853363, 252.94852876663208, 258.328782081604, 263.61051964759827, 269.07892417907715, 274.26637053489685, 280.6980013847351]
[23.96, 34.64, 49.72, 50.96, 53.4, 52.32, 57.12, 58.16, 60.28, 59.32, 60.72, 64.0, 65.72, 63.68, 64.48, 64.96, 67.24, 66.32, 66.08, 65.4, 67.44, 67.72, 66.4, 66.4, 67.6, 68.2, 68.28, 68.52, 68.92, 69.36, 69.28, 68.88, 69.48, 70.68, 71.2, 70.6, 71.56, 71.32, 70.76, 69.6, 71.8, 71.32, 72.4, 70.4, 71.52, 71.96, 71.2, 71.4, 72.28, 71.92, 71.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.583, Test loss: 1.808, Test accuracy: 23.72
Round   1, Train loss: 1.424, Test loss: 1.677, Test accuracy: 30.12
Round   2, Train loss: 1.276, Test loss: 1.389, Test accuracy: 43.20
Round   3, Train loss: 1.181, Test loss: 1.334, Test accuracy: 45.64
Round   4, Train loss: 1.090, Test loss: 1.337, Test accuracy: 49.32
Round   5, Train loss: 1.023, Test loss: 1.020, Test accuracy: 58.12
Round   6, Train loss: 0.976, Test loss: 1.141, Test accuracy: 54.52
Round   7, Train loss: 0.927, Test loss: 1.134, Test accuracy: 55.64
Round   8, Train loss: 0.869, Test loss: 1.022, Test accuracy: 59.68
Round   9, Train loss: 0.834, Test loss: 1.127, Test accuracy: 57.48
Round  10, Train loss: 0.781, Test loss: 0.928, Test accuracy: 64.00
Round  11, Train loss: 0.754, Test loss: 0.919, Test accuracy: 64.68
Round  12, Train loss: 0.713, Test loss: 1.007, Test accuracy: 63.00
Round  13, Train loss: 0.679, Test loss: 0.901, Test accuracy: 65.64
Round  14, Train loss: 0.639, Test loss: 0.903, Test accuracy: 66.24
Round  15, Train loss: 0.609, Test loss: 0.954, Test accuracy: 65.48
Round  16, Train loss: 0.592, Test loss: 0.978, Test accuracy: 65.44
Round  17, Train loss: 0.552, Test loss: 0.949, Test accuracy: 66.04
Round  18, Train loss: 0.544, Test loss: 0.952, Test accuracy: 66.28
Round  19, Train loss: 0.508, Test loss: 0.885, Test accuracy: 68.88
Round  20, Train loss: 0.471, Test loss: 0.902, Test accuracy: 68.36
Round  21, Train loss: 0.455, Test loss: 0.894, Test accuracy: 68.84
Round  22, Train loss: 0.443, Test loss: 0.931, Test accuracy: 67.28
Round  23, Train loss: 0.417, Test loss: 0.974, Test accuracy: 67.48
Round  24, Train loss: 0.380, Test loss: 0.901, Test accuracy: 69.16
Round  25, Train loss: 0.365, Test loss: 0.921, Test accuracy: 69.32
Round  26, Train loss: 0.347, Test loss: 0.927, Test accuracy: 69.88
Round  27, Train loss: 0.324, Test loss: 0.894, Test accuracy: 69.68
Round  28, Train loss: 0.318, Test loss: 0.891, Test accuracy: 70.24
Round  29, Train loss: 0.300, Test loss: 0.954, Test accuracy: 69.36
Round  30, Train loss: 0.278, Test loss: 0.943, Test accuracy: 70.64
Round  31, Train loss: 0.255, Test loss: 0.935, Test accuracy: 70.72
Round  32, Train loss: 0.238, Test loss: 0.952, Test accuracy: 70.84
Round  33, Train loss: 0.226, Test loss: 0.973, Test accuracy: 70.56
Round  34, Train loss: 0.228, Test loss: 0.968, Test accuracy: 70.80
Round  35, Train loss: 0.206, Test loss: 0.965, Test accuracy: 71.12
Round  36, Train loss: 0.215, Test loss: 0.988, Test accuracy: 71.00
Round  37, Train loss: 0.191, Test loss: 0.971, Test accuracy: 70.80
Round  38, Train loss: 0.172, Test loss: 0.981, Test accuracy: 71.36
Round  39, Train loss: 0.150, Test loss: 0.969, Test accuracy: 71.72
Round  40, Train loss: 0.150, Test loss: 0.966, Test accuracy: 72.68
Round  41, Train loss: 0.153, Test loss: 0.969, Test accuracy: 71.16
Round  42, Train loss: 0.121, Test loss: 0.998, Test accuracy: 72.40
Round  43, Train loss: 0.138, Test loss: 0.995, Test accuracy: 72.28
Round  44, Train loss: 0.129, Test loss: 1.051, Test accuracy: 70.80
Round  45, Train loss: 0.119, Test loss: 1.002, Test accuracy: 71.92
Round  46, Train loss: 0.105, Test loss: 1.004, Test accuracy: 72.56
Round  47, Train loss: 0.100, Test loss: 1.012, Test accuracy: 72.28
Round  48, Train loss: 0.106, Test loss: 1.004, Test accuracy: 72.28
Round  49, Train loss: 0.082, Test loss: 1.002, Test accuracy: 72.72
Final Round, Train loss: 0.053, Test loss: 1.029, Test accuracy: 72.92
Average accuracy final 10 rounds: 72.108
1762.617297410965
[12.319639682769775, 18.75814127922058, 25.413376331329346, 32.21787428855896, 38.7802312374115, 45.35074973106384, 51.6537606716156, 58.08143949508667, 64.54509782791138, 70.81387257575989, 77.11190104484558, 83.34748077392578, 90.0646641254425, 96.4388816356659, 102.91787052154541, 109.27890157699585, 116.03884601593018, 122.34125089645386, 129.10034465789795, 135.675950050354, 142.30787134170532, 148.79904294013977, 155.3248689174652, 161.95105600357056, 168.3626389503479, 174.87897658348083, 181.27703213691711, 187.67767667770386, 194.09340906143188, 200.65744042396545, 206.95137548446655, 213.65881156921387, 220.2885777950287, 226.7754566669464, 233.59285521507263, 240.36608219146729, 246.59307742118835, 252.9050886631012, 259.86649775505066, 266.3339207172394, 272.8034176826477, 279.3845431804657, 285.86717557907104, 292.42914938926697, 298.70364260673523, 305.56786918640137, 311.8334732055664, 318.09511828422546, 324.3370587825775, 330.91184163093567, 337.57213139533997]
[23.72, 30.12, 43.2, 45.64, 49.32, 58.12, 54.52, 55.64, 59.68, 57.48, 64.0, 64.68, 63.0, 65.64, 66.24, 65.48, 65.44, 66.04, 66.28, 68.88, 68.36, 68.84, 67.28, 67.48, 69.16, 69.32, 69.88, 69.68, 70.24, 69.36, 70.64, 70.72, 70.84, 70.56, 70.8, 71.12, 71.0, 70.8, 71.36, 71.72, 72.68, 71.16, 72.4, 72.28, 70.8, 71.92, 72.56, 72.28, 72.28, 72.72, 72.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.412, Train accuracy: 83.600, Test loss: 1.657, Test accuracy: 52.40 

        train local model (freeze embeding):client   0,  Train loss: 0.281, Train accuracy: 89.600, Test loss: 1.608, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.147, Train accuracy: 95.600, Test loss: 1.820, Test accuracy: 56.40 

Round   0, Train loss: 0.147, Test loss: 1.820, Test accuracy: 56.40 

        train local model (freeze embeding):client   0,  Train loss: 0.097, Train accuracy: 98.000, Test loss: 1.904, Test accuracy: 55.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.153, Train accuracy: 94.200, Test loss: 2.102, Test accuracy: 55.40 

Round   1, Train loss: 0.153, Test loss: 2.102, Test accuracy: 55.40 

        train local model (freeze embeding):client   0,  Train loss: 0.076, Train accuracy: 98.200, Test loss: 2.044, Test accuracy: 57.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.101, Train accuracy: 96.400, Test loss: 2.010, Test accuracy: 56.60 

Round   2, Train loss: 0.101, Test loss: 2.010, Test accuracy: 56.60 

        train local model (freeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.400, Test loss: 1.899, Test accuracy: 59.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.107, Train accuracy: 96.400, Test loss: 2.619, Test accuracy: 55.80 

Round   3, Train loss: 0.107, Test loss: 2.619, Test accuracy: 55.80 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 2.279, Test accuracy: 57.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.074, Train accuracy: 98.000, Test loss: 2.596, Test accuracy: 54.60 

Round   4, Train loss: 0.074, Test loss: 2.596, Test accuracy: 54.60 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 2.385, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.400, Test loss: 2.325, Test accuracy: 56.20 

Round   5, Train loss: 0.036, Test loss: 2.325, Test accuracy: 56.20 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 2.284, Test accuracy: 55.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.530, Test accuracy: 55.40 

Round   6, Train loss: 0.009, Test loss: 2.530, Test accuracy: 55.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.439, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 2.559, Test accuracy: 56.00 

Round   7, Train loss: 0.013, Test loss: 2.559, Test accuracy: 56.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.491, Test accuracy: 56.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.510, Test accuracy: 58.20 

Round   8, Train loss: 0.002, Test loss: 2.510, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.515, Test accuracy: 57.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 2.745, Test accuracy: 56.80 

Round   9, Train loss: 0.029, Test loss: 2.745, Test accuracy: 56.80 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 2.589, Test accuracy: 57.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.773, Test accuracy: 56.80 

Round  10, Train loss: 0.008, Test loss: 2.773, Test accuracy: 56.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.735, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.473, Test accuracy: 59.40 

Round  11, Train loss: 0.006, Test loss: 2.473, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.532, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.642, Test accuracy: 58.20 

Round  12, Train loss: 0.006, Test loss: 2.642, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.557, Test accuracy: 58.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.650, Test accuracy: 59.20 

Round  13, Train loss: 0.001, Test loss: 2.650, Test accuracy: 59.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.668, Test accuracy: 58.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 98.800, Test loss: 3.201, Test accuracy: 52.00 

Round  14, Train loss: 0.026, Test loss: 3.201, Test accuracy: 52.00 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 3.005, Test accuracy: 55.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.763, Test accuracy: 60.00 

Round  15, Train loss: 0.004, Test loss: 2.763, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.753, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 3.031, Test accuracy: 57.20 

Round  16, Train loss: 0.010, Test loss: 3.031, Test accuracy: 57.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.798, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 3.027, Test accuracy: 57.00 

Round  17, Train loss: 0.010, Test loss: 3.027, Test accuracy: 57.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 3.020, Test accuracy: 56.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.692, Test accuracy: 57.60 

Round  18, Train loss: 0.000, Test loss: 2.692, Test accuracy: 57.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.726, Test accuracy: 57.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.660, Test accuracy: 59.80 

Round  19, Train loss: 0.001, Test loss: 2.660, Test accuracy: 59.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.711, Test accuracy: 56.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.670, Test accuracy: 57.40 

Final Round, Train loss: 0.000, Test loss: 2.685, Test accuracy: 59.20 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.959, Train accuracy: 63.000, Test loss: 1.142, Test accuracy: 56.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.745, Test accuracy: 57.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.975, Test accuracy: 58.40 

        train local model (freeze embeding):client   1,  Train loss: 1.014, Train accuracy: 58.000, Test loss: 1.254, Test accuracy: 55.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.409, Train accuracy: 84.200, Test loss: 1.379, Test accuracy: 59.60 

Round   0, Train loss: 0.205, Test loss: 1.822, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.611, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.814, Test accuracy: 58.80 

        train local model (freeze embeding):client   1,  Train loss: 0.440, Train accuracy: 84.600, Test loss: 1.023, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.352, Train accuracy: 86.200, Test loss: 1.490, Test accuracy: 59.80 

Round   1, Train loss: 0.176, Test loss: 1.798, Test accuracy: 61.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.485, Test accuracy: 59.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.946, Test accuracy: 59.60 

        train local model (freeze embeding):client   1,  Train loss: 0.183, Train accuracy: 95.200, Test loss: 1.111, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.317, Train accuracy: 88.400, Test loss: 2.050, Test accuracy: 59.20 

Round   2, Train loss: 0.159, Test loss: 1.947, Test accuracy: 62.30 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.525, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.725, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.103, Train accuracy: 97.400, Test loss: 1.166, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.139, Train accuracy: 95.000, Test loss: 1.843, Test accuracy: 61.60 

Round   3, Train loss: 0.070, Test loss: 1.950, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.466, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.705, Test accuracy: 59.00 

        train local model (freeze embeding):client   1,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 1.366, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.800, Test loss: 1.665, Test accuracy: 64.40 

Round   4, Train loss: 0.022, Test loss: 1.885, Test accuracy: 63.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.488, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.771, Test accuracy: 58.20 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.099, Train accuracy: 96.800, Test loss: 1.689, Test accuracy: 62.60 

Round   5, Train loss: 0.050, Test loss: 1.946, Test accuracy: 63.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.523, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 2.696, Test accuracy: 57.40 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.360, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.800, Test loss: 1.811, Test accuracy: 63.00 

Round   6, Train loss: 0.028, Test loss: 1.916, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.372, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.705, Test accuracy: 57.80 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.481, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 1.976, Test accuracy: 60.80 

Round   7, Train loss: 0.026, Test loss: 2.004, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.516, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.732, Test accuracy: 57.80 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.602, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.144, Train accuracy: 95.200, Test loss: 2.114, Test accuracy: 63.20 

Round   8, Train loss: 0.074, Test loss: 2.044, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.499, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.610, Test accuracy: 59.00 

        train local model (freeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.600, Test loss: 1.606, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.861, Test accuracy: 61.80 

Round   9, Train loss: 0.009, Test loss: 1.853, Test accuracy: 63.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.311, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 2.653, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.856, Test accuracy: 65.40 

Round  10, Train loss: 0.015, Test loss: 2.032, Test accuracy: 62.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.484, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.696, Test accuracy: 58.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.625, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.114, Train accuracy: 95.600, Test loss: 2.297, Test accuracy: 60.80 

Round  11, Train loss: 0.060, Test loss: 2.099, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.428, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.590, Test accuracy: 59.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.555, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.728, Test accuracy: 68.20 

Round  12, Train loss: 0.001, Test loss: 1.971, Test accuracy: 65.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.402, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.587, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.628, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 2.012, Test accuracy: 66.00 

Round  13, Train loss: 0.011, Test loss: 1.962, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.276, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 2.781, Test accuracy: 57.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.642, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.804, Test accuracy: 67.80 

Round  14, Train loss: 0.007, Test loss: 2.063, Test accuracy: 64.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.367, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.577, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.672, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.910, Test accuracy: 62.20 

Round  15, Train loss: 0.005, Test loss: 2.053, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.370, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.439, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.788, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.082, Test accuracy: 67.20 

Round  16, Train loss: 0.005, Test loss: 2.036, Test accuracy: 65.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.279, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.549, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.855, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 2.143, Test accuracy: 62.20 

Round  17, Train loss: 0.005, Test loss: 2.065, Test accuracy: 63.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.417, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.563, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.792, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.003, Test accuracy: 63.00 

Round  18, Train loss: 0.005, Test loss: 2.116, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.386, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.600, Test loss: 2.953, Test accuracy: 60.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.819, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 2.329, Test accuracy: 59.60 

Round  19, Train loss: 0.009, Test loss: 2.208, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.555, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.547, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.836, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.784, Test accuracy: 65.80 

Final Round, Train loss: 0.001, Test loss: 2.187, Test accuracy: 63.70 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.803, Train accuracy: 66.800, Test loss: 1.025, Test accuracy: 57.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.584, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.750, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.775, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.816, Test accuracy: 64.40 

        train local model (freeze embeding):client   2,  Train loss: 0.720, Train accuracy: 72.800, Test loss: 0.922, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.127, Train accuracy: 96.600, Test loss: 1.417, Test accuracy: 62.20 

Round   0, Train loss: 0.045, Test loss: 1.726, Test accuracy: 65.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.479, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.537, Test accuracy: 63.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.732, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 2.268, Test accuracy: 64.20 

        train local model (freeze embeding):client   2,  Train loss: 0.379, Train accuracy: 86.400, Test loss: 0.976, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.083, Train accuracy: 97.800, Test loss: 1.311, Test accuracy: 63.00 

Round   1, Train loss: 0.033, Test loss: 1.717, Test accuracy: 64.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.328, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.394, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.719, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 2.053, Test accuracy: 63.20 

        train local model (freeze embeding):client   2,  Train loss: 0.226, Train accuracy: 92.000, Test loss: 1.068, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.087, Train accuracy: 97.800, Test loss: 1.886, Test accuracy: 59.20 

Round   2, Train loss: 0.033, Test loss: 1.773, Test accuracy: 64.53 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.426, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.628, Test accuracy: 59.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.752, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.830, Test accuracy: 64.20 

        train local model (freeze embeding):client   2,  Train loss: 0.092, Train accuracy: 96.800, Test loss: 1.124, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.133, Train accuracy: 96.400, Test loss: 1.692, Test accuracy: 63.20 

Round   3, Train loss: 0.048, Test loss: 1.729, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.293, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.585, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.654, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.791, Test accuracy: 65.80 

        train local model (freeze embeding):client   2,  Train loss: 0.068, Train accuracy: 98.600, Test loss: 1.183, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.800, Test loss: 1.658, Test accuracy: 63.60 

Round   4, Train loss: 0.009, Test loss: 1.719, Test accuracy: 65.73 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.352, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.677, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.613, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.913, Test accuracy: 67.00 

        train local model (freeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.400, Test loss: 1.258, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 97.000, Test loss: 1.908, Test accuracy: 65.60 

Round   5, Train loss: 0.028, Test loss: 1.771, Test accuracy: 66.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.353, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.438, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.689, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.878, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.024, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.545, Test accuracy: 65.60 

Round   6, Train loss: 0.007, Test loss: 1.706, Test accuracy: 66.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.238, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.059, Train accuracy: 98.600, Test loss: 2.855, Test accuracy: 61.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.686, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.864, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 1.281, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.816, Test accuracy: 63.40 

Round   7, Train loss: 0.023, Test loss: 1.754, Test accuracy: 65.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.204, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.729, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 2.445, Test accuracy: 62.60 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.394, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.680, Test accuracy: 65.60 

Round   8, Train loss: 0.018, Test loss: 1.845, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.235, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.603, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.794, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.006, Test accuracy: 61.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.881, Test accuracy: 62.00 

Round   9, Train loss: 0.011, Test loss: 1.769, Test accuracy: 65.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.287, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.511, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.716, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.669, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.102, Train accuracy: 96.200, Test loss: 2.382, Test accuracy: 59.00 

Round  10, Train loss: 0.035, Test loss: 1.848, Test accuracy: 65.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.311, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.539, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.101, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.401, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.577, Test accuracy: 69.00 

Round  11, Train loss: 0.005, Test loss: 1.773, Test accuracy: 65.53 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.271, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.535, Test accuracy: 63.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.720, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.832, Test accuracy: 64.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.817, Test accuracy: 67.00 

Round  12, Train loss: 0.011, Test loss: 1.812, Test accuracy: 65.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.317, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.415, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.675, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.706, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.464, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.632, Test accuracy: 66.00 

Round  13, Train loss: 0.003, Test loss: 1.864, Test accuracy: 65.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.319, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.500, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.882, Test accuracy: 64.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.530, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.666, Test accuracy: 65.20 

Round  14, Train loss: 0.014, Test loss: 1.821, Test accuracy: 65.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.305, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.586, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.675, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.820, Test accuracy: 68.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.601, Test accuracy: 66.40 

Round  15, Train loss: 0.002, Test loss: 1.837, Test accuracy: 66.13 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.338, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.598, Test accuracy: 63.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.613, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.830, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.456, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 2.084, Test accuracy: 64.80 

Round  16, Train loss: 0.007, Test loss: 1.915, Test accuracy: 67.13 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.330, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.459, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.771, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.870, Test accuracy: 65.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.525, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.801, Test accuracy: 63.40 

Round  17, Train loss: 0.000, Test loss: 1.905, Test accuracy: 65.27 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.323, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.815, Test accuracy: 59.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.755, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.899, Test accuracy: 63.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.546, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.673, Test accuracy: 66.40 

Round  18, Train loss: 0.001, Test loss: 1.903, Test accuracy: 65.93 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.345, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.685, Test accuracy: 61.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.793, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.958, Test accuracy: 65.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.465, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.681, Test accuracy: 65.60 

Round  19, Train loss: 0.002, Test loss: 1.911, Test accuracy: 66.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.422, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.426, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.773, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.755, Test accuracy: 65.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.474, Test accuracy: 69.60 

Final Round, Train loss: 0.000, Test loss: 1.916, Test accuracy: 65.93 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.663, Train accuracy: 74.400, Test loss: 0.886, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.411, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.602, Test accuracy: 60.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.771, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.901, Test accuracy: 64.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.472, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.669, Test accuracy: 68.20 

        train local model (freeze embeding):client   3,  Train loss: 0.682, Train accuracy: 74.000, Test loss: 0.918, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.170, Train accuracy: 93.200, Test loss: 1.157, Test accuracy: 68.60 

Round   0, Train loss: 0.045, Test loss: 1.584, Test accuracy: 67.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.221, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.449, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.752, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.822, Test accuracy: 65.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.504, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.803, Test accuracy: 67.80 

        train local model (freeze embeding):client   3,  Train loss: 0.417, Train accuracy: 83.800, Test loss: 0.926, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.165, Train accuracy: 93.800, Test loss: 1.248, Test accuracy: 70.80 

Round   1, Train loss: 0.044, Test loss: 1.618, Test accuracy: 67.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.262, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.389, Test accuracy: 61.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.790, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.826, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.874, Test accuracy: 66.80 

        train local model (freeze embeding):client   3,  Train loss: 0.237, Train accuracy: 92.200, Test loss: 0.943, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.115, Train accuracy: 96.000, Test loss: 1.527, Test accuracy: 66.20 

Round   2, Train loss: 0.030, Test loss: 1.546, Test accuracy: 68.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.164, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.437, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.675, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.847, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.502, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 2.051, Test accuracy: 62.40 

        train local model (freeze embeding):client   3,  Train loss: 0.135, Train accuracy: 95.800, Test loss: 1.041, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.047, Train accuracy: 98.600, Test loss: 1.449, Test accuracy: 67.80 

Round   3, Train loss: 0.021, Test loss: 1.542, Test accuracy: 68.05 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.295, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 2.510, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.596, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.976, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.642, Test accuracy: 67.20 

        train local model (freeze embeding):client   3,  Train loss: 0.090, Train accuracy: 98.200, Test loss: 1.059, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.180, Train accuracy: 91.800, Test loss: 2.065, Test accuracy: 63.00 

Round   4, Train loss: 0.050, Test loss: 1.596, Test accuracy: 67.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.217, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.679, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.533, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.055, Test accuracy: 65.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.836, Test accuracy: 64.00 

        train local model (freeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.600, Test loss: 1.083, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.089, Train accuracy: 97.400, Test loss: 1.356, Test accuracy: 70.20 

Round   5, Train loss: 0.026, Test loss: 1.552, Test accuracy: 68.95 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.110, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.347, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.587, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.595, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 68.20 

        train local model (freeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.099, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 70.00 

Round   6, Train loss: 0.003, Test loss: 1.585, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.136, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.913, Test accuracy: 59.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.609, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 98.800, Test loss: 2.295, Test accuracy: 63.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 2.122, Test accuracy: 63.00 

        train local model (freeze embeding):client   3,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 1.166, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 1.589, Test accuracy: 66.20 

Round   7, Train loss: 0.030, Test loss: 1.645, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.214, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.371, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.934, Test accuracy: 65.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.779, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.600, Test loss: 1.212, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 1.618, Test accuracy: 66.80 

Round   8, Train loss: 0.007, Test loss: 1.667, Test accuracy: 68.15 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.220, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.459, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.620, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.787, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.687, Test accuracy: 67.40 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.231, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.403, Test accuracy: 72.40 

Round   9, Train loss: 0.004, Test loss: 1.617, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.221, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.464, Test accuracy: 59.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.565, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.715, Test accuracy: 67.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.516, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.796, Test accuracy: 68.40 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.244, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.762, Test accuracy: 65.80 

Round  10, Train loss: 0.009, Test loss: 1.637, Test accuracy: 68.55 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.233, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 98.400, Test loss: 2.722, Test accuracy: 59.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.566, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.112, Train accuracy: 97.200, Test loss: 2.867, Test accuracy: 55.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.536, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.638, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.200, Test loss: 1.541, Test accuracy: 68.20 

Round  11, Train loss: 0.046, Test loss: 1.655, Test accuracy: 67.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.193, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.325, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.672, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.699, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.502, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.265, Train accuracy: 93.600, Test loss: 2.559, Test accuracy: 60.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.449, Test accuracy: 71.20 

Round  12, Train loss: 0.067, Test loss: 1.600, Test accuracy: 68.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.075, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.348, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.916, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.554, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.743, Test accuracy: 67.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.315, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.495, Test accuracy: 72.60 

Round  13, Train loss: 0.002, Test loss: 1.652, Test accuracy: 68.45 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.183, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.279, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.629, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.737, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.524, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.641, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.106, Train accuracy: 96.600, Test loss: 1.966, Test accuracy: 64.20 

Round  14, Train loss: 0.031, Test loss: 1.632, Test accuracy: 68.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.163, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.261, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.083, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.528, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.612, Test accuracy: 70.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.462, Test accuracy: 72.00 

Round  15, Train loss: 0.003, Test loss: 1.661, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.112, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.356, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.634, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.780, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.543, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.655, Test accuracy: 69.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.302, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.627, Test accuracy: 71.20 

Round  16, Train loss: 0.003, Test loss: 1.647, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.108, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.621, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.530, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.695, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.582, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.690, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 72.00 

Round  17, Train loss: 0.000, Test loss: 1.701, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.183, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.233, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.675, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.917, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.534, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.605, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.334, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.782, Test accuracy: 70.20 

Round  18, Train loss: 0.009, Test loss: 1.727, Test accuracy: 68.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.147, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.217, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.622, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.687, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.613, Test accuracy: 70.60 

Round  19, Train loss: 0.000, Test loss: 1.685, Test accuracy: 69.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.090, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.110, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.614, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.616, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.572, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.630, Test accuracy: 68.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.407, Test accuracy: 73.20 

Final Round, Train loss: 0.000, Test loss: 1.690, Test accuracy: 68.95 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.521, Train accuracy: 79.400, Test loss: 0.688, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.112, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.198, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.604, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.706, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.584, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.831, Test accuracy: 66.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.398, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.577, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.542, Train accuracy: 78.800, Test loss: 0.683, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.194, Train accuracy: 92.000, Test loss: 1.197, Test accuracy: 66.80 

Round   0, Train loss: 0.046, Test loss: 1.431, Test accuracy: 70.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.116, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.224, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.577, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.673, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.452, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.673, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.696, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.356, Train accuracy: 87.400, Test loss: 0.717, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.054, Train accuracy: 99.000, Test loss: 1.090, Test accuracy: 72.60 

Round   1, Train loss: 0.014, Test loss: 1.434, Test accuracy: 70.52 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.075, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.001, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.779, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.754, Test accuracy: 65.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.603, Test accuracy: 70.60 

        train local model (freeze embeding):client   4,  Train loss: 0.211, Train accuracy: 92.600, Test loss: 0.727, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.057, Test accuracy: 73.60 

Round   2, Train loss: 0.008, Test loss: 1.444, Test accuracy: 70.68 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.001, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 98.800, Test loss: 2.652, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.670, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.839, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.525, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.865, Test accuracy: 67.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.055, Train accuracy: 98.200, Test loss: 1.615, Test accuracy: 70.60 

        train local model (freeze embeding):client   4,  Train loss: 0.125, Train accuracy: 97.200, Test loss: 0.803, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.073, Train accuracy: 97.600, Test loss: 1.247, Test accuracy: 70.60 

Round   3, Train loss: 0.033, Test loss: 1.445, Test accuracy: 70.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.029, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 2.501, Test accuracy: 63.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.591, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.914, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.487, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.536, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.969, Test accuracy: 65.00 

        train local model (freeze embeding):client   4,  Train loss: 0.140, Train accuracy: 95.000, Test loss: 0.901, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 1.007, Test accuracy: 73.20 

Round   4, Train loss: 0.017, Test loss: 1.407, Test accuracy: 71.36 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.022, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.024, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.532, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 2.146, Test accuracy: 64.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 97.800, Test loss: 2.082, Test accuracy: 64.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.530, Test accuracy: 71.80 

        train local model (freeze embeding):client   4,  Train loss: 0.087, Train accuracy: 98.200, Test loss: 0.855, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.315, Test accuracy: 71.20 

Round   5, Train loss: 0.028, Test loss: 1.385, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.881, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.335, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.511, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.826, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.453, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.788, Test accuracy: 66.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.540, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.055, Train accuracy: 98.400, Test loss: 0.875, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.101, Train accuracy: 96.800, Test loss: 1.683, Test accuracy: 68.40 

Round   6, Train loss: 0.022, Test loss: 1.408, Test accuracy: 71.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.960, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.275, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.573, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 2.309, Test accuracy: 63.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 72.60 

        train local model (freeze embeding):client   4,  Train loss: 0.027, Train accuracy: 99.800, Test loss: 0.896, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.312, Test accuracy: 71.60 

Round   7, Train loss: 0.009, Test loss: 1.470, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.916, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.423, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.582, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.657, Test accuracy: 70.00 

        train local model (freeze embeding):client   4,  Train loss: 0.021, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.039, Train accuracy: 98.400, Test loss: 1.429, Test accuracy: 69.00 

Round   8, Train loss: 0.008, Test loss: 1.454, Test accuracy: 71.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.966, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.432, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.605, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.017, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.543, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.396, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.464, Test accuracy: 70.20 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.037, Train accuracy: 98.200, Test loss: 1.404, Test accuracy: 72.00 

Round   9, Train loss: 0.011, Test loss: 1.469, Test accuracy: 71.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.060, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 2.158, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.567, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.833, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.580, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 70.60 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.019, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.329, Test accuracy: 71.40 

Round  10, Train loss: 0.010, Test loss: 1.425, Test accuracy: 71.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.967, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.987, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.970, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.766, Test accuracy: 67.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 72.60 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.028, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 71.60 

Round  11, Train loss: 0.004, Test loss: 1.439, Test accuracy: 71.64 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.914, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.209, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.742, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.400, Test loss: 1.873, Test accuracy: 66.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 72.80 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.103, Train accuracy: 96.000, Test loss: 1.463, Test accuracy: 68.40 

Round  12, Train loss: 0.026, Test loss: 1.456, Test accuracy: 70.84 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.854, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.010, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.530, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.555, Test accuracy: 70.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.492, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.634, Test accuracy: 66.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.739, Test accuracy: 69.60 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 73.00 

Round  13, Train loss: 0.003, Test loss: 1.402, Test accuracy: 71.36 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.813, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.216, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.784, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 2.073, Test accuracy: 65.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.593, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.077, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.247, Test accuracy: 72.40 

Round  14, Train loss: 0.011, Test loss: 1.450, Test accuracy: 70.92 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.880, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.302, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.484, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.664, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.400, Test accuracy: 71.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.683, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.056, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.517, Test accuracy: 70.20 

Round  15, Train loss: 0.002, Test loss: 1.416, Test accuracy: 71.84 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.824, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.090, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.453, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.556, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.434, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.666, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 71.20 

Round  16, Train loss: 0.001, Test loss: 1.437, Test accuracy: 71.92 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.905, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.034, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.501, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.595, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.547, Test accuracy: 69.40 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.447, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 73.40 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 70.80 

Round  17, Train loss: 0.001, Test loss: 1.433, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.813, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.875, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.529, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 70.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 2.161, Test accuracy: 69.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.327, Train accuracy: 89.600, Test loss: 2.989, Test accuracy: 58.60 

Round  18, Train loss: 0.074, Test loss: 1.488, Test accuracy: 71.56 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.153, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.506, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.145, Train accuracy: 97.600, Test loss: 2.638, Test accuracy: 65.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.371, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 2.107, Test accuracy: 64.20 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.200, Test loss: 1.763, Test accuracy: 70.40 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 74.20 

Round  19, Train loss: 0.040, Test loss: 1.510, Test accuracy: 71.32 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.857, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.899, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.493, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.463, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.482, Test accuracy: 73.20 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.175, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 74.40 

Final Round, Train loss: 0.001, Test loss: 1.466, Test accuracy: 72.12 

Average accuracy final 10 rounds: 327.6740000000001 

5981.125423669815
[19.18414306640625, 37.69580578804016, 55.99110126495361, 74.42635893821716, 93.35887169837952, 111.60775876045227, 130.07615518569946, 148.16208386421204, 166.7534155845642, 185.9133038520813, 202.77337861061096, 219.66507291793823, 238.0832211971283, 256.3439795970917, 274.19079399108887, 291.6208882331848, 309.5976107120514, 327.9113600254059, 345.2556183338165, 363.55425119400024, 373.6248834133148, 391.870370388031, 410.1542332172394, 428.2612588405609, 446.62199091911316, 466.0588710308075, 484.40278720855713, 502.76226902008057, 521.60191655159, 540.5505609512329, 558.9428632259369, 577.7291784286499, 596.8403837680817, 615.5350432395935, 634.5143489837646, 652.9844489097595, 671.8085746765137, 690.1239638328552, 708.566499710083, 727.0648386478424, 745.2487988471985, 756.1299648284912, 774.8738777637482, 793.0747768878937, 812.0191237926483, 831.0864145755768, 849.9561567306519, 868.6170015335083, 887.110048532486, 905.7351276874542, 925.1229746341705, 944.2250430583954, 963.3849020004272, 981.9575393199921, 1000.7235798835754, 1018.8324952125549, 1037.4239263534546, 1055.9413993358612, 1074.3303785324097, 1093.6595482826233, 1112.336097240448, 1131.0993378162384, 1144.2138605117798, 1163.0442521572113, 1182.0198812484741, 1201.2547788619995, 1219.8748643398285, 1238.7906663417816, 1257.1532027721405, 1275.8002479076385, 1294.2358508110046, 1313.4767363071442, 1332.3555445671082, 1350.8452880382538, 1369.1384122371674, 1388.0311124324799, 1406.4908380508423, 1424.8200962543488, 1443.44016623497, 1462.006150007248, 1480.5105221271515, 1499.2147905826569, 1518.4651260375977, 1530.5764441490173, 1549.0564920902252, 1567.988269329071, 1586.8594932556152, 1605.3091323375702, 1623.6294357776642, 1642.4149160385132, 1661.3938617706299, 1680.2158150672913, 1699.5309493541718, 1718.3899092674255, 1737.0177257061005, 1756.0878388881683, 1775.1870474815369, 1793.6695637702942, 1812.3529169559479, 1831.0412147045135, 1849.8813915252686, 1868.3036963939667, 1887.5174598693848, 1906.176519870758, 1917.4103705883026]
[56.4, 55.4, 56.6, 55.8, 54.6, 56.2, 55.4, 56.0, 58.2, 56.8, 56.8, 59.4, 58.2, 59.2, 52.0, 60.0, 57.2, 57.0, 57.6, 59.8, 59.2, 62.8, 61.0, 62.3, 61.8, 63.9, 63.5, 62.2, 60.6, 62.6, 63.5, 62.9, 62.8, 65.3, 64.2, 64.3, 64.5, 65.8, 63.9, 63.4, 63.4, 63.7, 65.33333333333333, 64.06666666666666, 64.53333333333333, 64.8, 65.73333333333333, 66.13333333333334, 66.13333333333334, 65.73333333333333, 65.6, 65.66666666666667, 65.8, 65.53333333333333, 65.66666666666667, 65.06666666666666, 65.93333333333334, 66.13333333333334, 67.13333333333334, 65.26666666666667, 65.93333333333334, 66.33333333333333, 65.93333333333334, 67.15, 67.5, 68.9, 68.05, 67.7, 68.95, 69.2, 67.6, 68.15, 68.2, 68.55, 67.75, 68.65, 68.45, 68.9, 68.4, 69.2, 68.4, 68.85, 69.25, 68.95, 70.24, 70.52, 70.68, 70.44, 71.36, 71.8, 71.04, 70.8, 71.44, 71.44, 71.44, 71.64, 70.84, 71.36, 70.92, 71.84, 71.92, 71.0, 71.56, 71.32, 72.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.366, Test loss: 1.294, Test accuracy: 50.80 

Round   0, Global train loss: 1.366, Global test loss: 1.734, Global test accuracy: 23.20 

Round   1, Train loss: 1.036, Test loss: 1.576, Test accuracy: 50.70 

Round   1, Global train loss: 1.036, Global test loss: 1.853, Global test accuracy: 23.60 

Round   2, Train loss: 0.888, Test loss: 1.144, Test accuracy: 59.60 

Round   2, Global train loss: 0.888, Global test loss: 1.919, Global test accuracy: 28.50 

Round   3, Train loss: 0.766, Test loss: 1.224, Test accuracy: 59.00 

Round   3, Global train loss: 0.766, Global test loss: 2.305, Global test accuracy: 26.30 

Round   4, Train loss: 0.664, Test loss: 1.365, Test accuracy: 61.50 

Round   4, Global train loss: 0.664, Global test loss: 2.190, Global test accuracy: 25.70 

Round   5, Train loss: 0.560, Test loss: 1.381, Test accuracy: 60.10 

Round   5, Global train loss: 0.560, Global test loss: 1.982, Global test accuracy: 33.30 

Round   6, Train loss: 0.483, Test loss: 1.501, Test accuracy: 60.60 

Round   6, Global train loss: 0.483, Global test loss: 2.393, Global test accuracy: 26.20 

Round   7, Train loss: 0.432, Test loss: 1.439, Test accuracy: 61.30 

Round   7, Global train loss: 0.432, Global test loss: 2.323, Global test accuracy: 29.50 

Round   8, Train loss: 0.370, Test loss: 1.507, Test accuracy: 64.00 

Round   8, Global train loss: 0.370, Global test loss: 2.306, Global test accuracy: 30.90 

Round   9, Train loss: 0.286, Test loss: 1.566, Test accuracy: 65.00 

Round   9, Global train loss: 0.286, Global test loss: 2.564, Global test accuracy: 27.70 

Round  10, Train loss: 0.258, Test loss: 1.663, Test accuracy: 65.40 

Round  10, Global train loss: 0.258, Global test loss: 2.463, Global test accuracy: 29.40 

Round  11, Train loss: 0.230, Test loss: 1.787, Test accuracy: 62.60 

Round  11, Global train loss: 0.230, Global test loss: 2.522, Global test accuracy: 28.10 

Round  12, Train loss: 0.202, Test loss: 1.549, Test accuracy: 68.70 

Round  12, Global train loss: 0.202, Global test loss: 2.817, Global test accuracy: 27.20 

Round  13, Train loss: 0.178, Test loss: 1.678, Test accuracy: 63.50 

Round  13, Global train loss: 0.178, Global test loss: 2.640, Global test accuracy: 24.80 

Round  14, Train loss: 0.144, Test loss: 1.785, Test accuracy: 62.60 

Round  14, Global train loss: 0.144, Global test loss: 3.048, Global test accuracy: 26.70 

Round  15, Train loss: 0.130, Test loss: 1.705, Test accuracy: 67.50 

Round  15, Global train loss: 0.130, Global test loss: 2.803, Global test accuracy: 30.50 

Round  16, Train loss: 0.122, Test loss: 1.649, Test accuracy: 66.30 

Round  16, Global train loss: 0.122, Global test loss: 2.651, Global test accuracy: 30.80 

Round  17, Train loss: 0.072, Test loss: 1.880, Test accuracy: 65.80 

Round  17, Global train loss: 0.072, Global test loss: 3.134, Global test accuracy: 26.00 

Round  18, Train loss: 0.092, Test loss: 1.557, Test accuracy: 68.60 

Round  18, Global train loss: 0.092, Global test loss: 3.185, Global test accuracy: 25.80 

Round  19, Train loss: 0.092, Test loss: 1.641, Test accuracy: 67.80 

Round  19, Global train loss: 0.092, Global test loss: 2.888, Global test accuracy: 26.10 

Round  20, Train loss: 0.098, Test loss: 1.894, Test accuracy: 66.10 

Round  20, Global train loss: 0.098, Global test loss: 2.977, Global test accuracy: 25.90 

Round  21, Train loss: 0.078, Test loss: 1.760, Test accuracy: 66.90 

Round  21, Global train loss: 0.078, Global test loss: 3.753, Global test accuracy: 23.00 

Round  22, Train loss: 0.055, Test loss: 1.891, Test accuracy: 65.80 

Round  22, Global train loss: 0.055, Global test loss: 2.916, Global test accuracy: 27.40 

Round  23, Train loss: 0.045, Test loss: 1.680, Test accuracy: 69.00 

Round  23, Global train loss: 0.045, Global test loss: 3.580, Global test accuracy: 23.50 

Round  24, Train loss: 0.034, Test loss: 1.781, Test accuracy: 68.80 

Round  24, Global train loss: 0.034, Global test loss: 3.218, Global test accuracy: 27.60 

Round  25, Train loss: 0.085, Test loss: 1.516, Test accuracy: 70.20 

Round  25, Global train loss: 0.085, Global test loss: 3.030, Global test accuracy: 28.00 

Round  26, Train loss: 0.056, Test loss: 1.673, Test accuracy: 68.80 

Round  26, Global train loss: 0.056, Global test loss: 3.054, Global test accuracy: 30.20 

Round  27, Train loss: 0.032, Test loss: 1.696, Test accuracy: 68.00 

Round  27, Global train loss: 0.032, Global test loss: 2.972, Global test accuracy: 28.70 

Round  28, Train loss: 0.028, Test loss: 1.709, Test accuracy: 69.80 

Round  28, Global train loss: 0.028, Global test loss: 2.793, Global test accuracy: 31.10 

Round  29, Train loss: 0.026, Test loss: 1.710, Test accuracy: 69.50 

Round  29, Global train loss: 0.026, Global test loss: 3.082, Global test accuracy: 31.90 

Round  30, Train loss: 0.043, Test loss: 1.664, Test accuracy: 69.70 

Round  30, Global train loss: 0.043, Global test loss: 2.799, Global test accuracy: 31.40 

Round  31, Train loss: 0.019, Test loss: 1.702, Test accuracy: 71.00 

Round  31, Global train loss: 0.019, Global test loss: 2.992, Global test accuracy: 32.20 

Round  32, Train loss: 0.022, Test loss: 1.638, Test accuracy: 69.70 

Round  32, Global train loss: 0.022, Global test loss: 2.789, Global test accuracy: 29.80 

Round  33, Train loss: 0.028, Test loss: 1.762, Test accuracy: 68.40 

Round  33, Global train loss: 0.028, Global test loss: 3.182, Global test accuracy: 28.30 

Round  34, Train loss: 0.031, Test loss: 1.761, Test accuracy: 69.40 

Round  34, Global train loss: 0.031, Global test loss: 3.157, Global test accuracy: 29.20 

Final Round, Train loss: 0.018, Test loss: 1.722, Test accuracy: 69.30 

Final Round, Global train loss: 0.018, Global test loss: 3.157, Global test accuracy: 29.20 

Average accuracy final 10 rounds: 69.45 

Average global accuracy final 10 rounds: 30.08 

591.5311329364777
[12.707906007766724, 19.153055667877197, 25.73560333251953, 32.589250564575195, 39.191720485687256, 45.95559644699097, 52.67424941062927, 59.43906927108765, 66.17076373100281, 73.10949754714966, 79.79570603370667, 86.81719613075256, 93.46496725082397, 100.12465906143188, 106.79989123344421, 113.49121022224426, 120.12880563735962, 126.88698053359985, 133.49032592773438, 140.12147688865662, 146.8649401664734, 153.57466983795166, 160.1947362422943, 167.0763487815857, 173.7557692527771, 180.67017698287964, 187.43217515945435, 194.2154040336609, 200.92259693145752, 207.55432295799255, 214.4022867679596, 221.3717119693756, 228.46117067337036, 235.26595902442932, 242.0760133266449, 255.27220845222473]
[50.8, 50.7, 59.6, 59.0, 61.5, 60.1, 60.6, 61.3, 64.0, 65.0, 65.4, 62.6, 68.7, 63.5, 62.6, 67.5, 66.3, 65.8, 68.6, 67.8, 66.1, 66.9, 65.8, 69.0, 68.8, 70.2, 68.8, 68.0, 69.8, 69.5, 69.7, 71.0, 69.7, 68.4, 69.4, 69.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.394, Test loss: 1.654, Test accuracy: 50.50 

Round   0, Global train loss: 1.394, Global test loss: 1.869, Global test accuracy: 29.50 

Round   1, Train loss: 1.163, Test loss: 1.222, Test accuracy: 56.60 

Round   1, Global train loss: 1.163, Global test loss: 1.753, Global test accuracy: 34.30 

Round   2, Train loss: 1.020, Test loss: 1.496, Test accuracy: 51.30 

Round   2, Global train loss: 1.020, Global test loss: 1.631, Global test accuracy: 37.00 

Round   3, Train loss: 0.911, Test loss: 1.599, Test accuracy: 51.60 

Round   3, Global train loss: 0.911, Global test loss: 1.691, Global test accuracy: 41.40 

Round   4, Train loss: 0.811, Test loss: 1.386, Test accuracy: 57.40 

Round   4, Global train loss: 0.811, Global test loss: 1.528, Global test accuracy: 44.60 

Round   5, Train loss: 0.719, Test loss: 1.568, Test accuracy: 60.30 

Round   5, Global train loss: 0.719, Global test loss: 1.469, Global test accuracy: 47.10 

Round   6, Train loss: 0.655, Test loss: 1.256, Test accuracy: 62.20 

Round   6, Global train loss: 0.655, Global test loss: 1.418, Global test accuracy: 51.20 

Round   7, Train loss: 0.590, Test loss: 1.087, Test accuracy: 62.70 

Round   7, Global train loss: 0.590, Global test loss: 1.701, Global test accuracy: 46.20 

Round   8, Train loss: 0.518, Test loss: 1.499, Test accuracy: 58.00 

Round   8, Global train loss: 0.518, Global test loss: 1.838, Global test accuracy: 44.50 

Round   9, Train loss: 0.495, Test loss: 1.187, Test accuracy: 66.20 

Round   9, Global train loss: 0.495, Global test loss: 1.541, Global test accuracy: 50.40 

Round  10, Train loss: 0.437, Test loss: 1.286, Test accuracy: 63.00 

Round  10, Global train loss: 0.437, Global test loss: 1.596, Global test accuracy: 51.40 

Round  11, Train loss: 0.392, Test loss: 1.626, Test accuracy: 57.00 

Round  11, Global train loss: 0.392, Global test loss: 1.811, Global test accuracy: 47.90 

Round  12, Train loss: 0.340, Test loss: 1.374, Test accuracy: 62.00 

Round  12, Global train loss: 0.340, Global test loss: 1.806, Global test accuracy: 49.30 

Round  13, Train loss: 0.319, Test loss: 1.512, Test accuracy: 64.40 

Round  13, Global train loss: 0.319, Global test loss: 1.782, Global test accuracy: 51.20 

Round  14, Train loss: 0.269, Test loss: 1.446, Test accuracy: 63.60 

Round  14, Global train loss: 0.269, Global test loss: 1.974, Global test accuracy: 50.60 

Round  15, Train loss: 0.275, Test loss: 1.328, Test accuracy: 66.60 

Round  15, Global train loss: 0.275, Global test loss: 1.909, Global test accuracy: 49.50 

Round  16, Train loss: 0.210, Test loss: 2.001, Test accuracy: 60.90 

Round  16, Global train loss: 0.210, Global test loss: 2.178, Global test accuracy: 51.70 

Round  17, Train loss: 0.212, Test loss: 1.540, Test accuracy: 65.10 

Round  17, Global train loss: 0.212, Global test loss: 1.912, Global test accuracy: 53.30 

Round  18, Train loss: 0.169, Test loss: 1.358, Test accuracy: 66.50 

Round  18, Global train loss: 0.169, Global test loss: 1.897, Global test accuracy: 52.90 

Round  19, Train loss: 0.182, Test loss: 1.526, Test accuracy: 65.40 

Round  19, Global train loss: 0.182, Global test loss: 2.051, Global test accuracy: 50.30 

Round  20, Train loss: 0.157, Test loss: 1.425, Test accuracy: 69.20 

Round  20, Global train loss: 0.157, Global test loss: 2.100, Global test accuracy: 51.00 

Round  21, Train loss: 0.137, Test loss: 1.624, Test accuracy: 65.30 

Round  21, Global train loss: 0.137, Global test loss: 2.038, Global test accuracy: 53.50 

Round  22, Train loss: 0.109, Test loss: 1.719, Test accuracy: 66.60 

Round  22, Global train loss: 0.109, Global test loss: 2.354, Global test accuracy: 51.70 

Round  23, Train loss: 0.137, Test loss: 1.569, Test accuracy: 67.00 

Round  23, Global train loss: 0.137, Global test loss: 2.031, Global test accuracy: 53.60 

Round  24, Train loss: 0.098, Test loss: 1.501, Test accuracy: 68.60 

Round  24, Global train loss: 0.098, Global test loss: 2.132, Global test accuracy: 52.70 

Round  25, Train loss: 0.073, Test loss: 1.579, Test accuracy: 70.90 

Round  25, Global train loss: 0.073, Global test loss: 2.327, Global test accuracy: 53.40 

Round  26, Train loss: 0.087, Test loss: 1.537, Test accuracy: 69.90 

Round  26, Global train loss: 0.087, Global test loss: 2.199, Global test accuracy: 54.10 

Round  27, Train loss: 0.122, Test loss: 1.871, Test accuracy: 64.90 

Round  27, Global train loss: 0.122, Global test loss: 2.821, Global test accuracy: 49.90 

Round  28, Train loss: 0.079, Test loss: 1.610, Test accuracy: 67.20 

Round  28, Global train loss: 0.079, Global test loss: 2.260, Global test accuracy: 54.20 

Round  29, Train loss: 0.083, Test loss: 2.290, Test accuracy: 61.80 

Round  29, Global train loss: 0.083, Global test loss: 2.382, Global test accuracy: 54.00 

Round  30, Train loss: 0.052, Test loss: 1.500, Test accuracy: 70.20 

Round  30, Global train loss: 0.052, Global test loss: 2.412, Global test accuracy: 54.40 

Round  31, Train loss: 0.069, Test loss: 1.716, Test accuracy: 67.30 

Round  31, Global train loss: 0.069, Global test loss: 2.286, Global test accuracy: 54.80 

Round  32, Train loss: 0.067, Test loss: 1.615, Test accuracy: 69.40 

Round  32, Global train loss: 0.067, Global test loss: 2.400, Global test accuracy: 52.30 

Round  33, Train loss: 0.046, Test loss: 1.556, Test accuracy: 67.70 

Round  33, Global train loss: 0.046, Global test loss: 2.447, Global test accuracy: 52.40 

Round  34, Train loss: 0.045, Test loss: 1.702, Test accuracy: 65.80 

Round  34, Global train loss: 0.045, Global test loss: 2.352, Global test accuracy: 52.50 

Final Round, Train loss: 0.040, Test loss: 1.806, Test accuracy: 67.50 

Final Round, Global train loss: 0.040, Global test loss: 2.352, Global test accuracy: 52.50 

Average accuracy final 10 rounds: 67.51 

Average global accuracy final 10 rounds: 53.199999999999996 

587.0489768981934
[12.778480529785156, 19.43390679359436, 26.228256940841675, 32.88134789466858, 39.778855323791504, 46.40589427947998, 53.15812397003174, 59.49893832206726, 66.18510818481445, 72.74654650688171, 79.41547894477844, 86.08726501464844, 92.52911615371704, 99.29596328735352, 106.30298185348511, 113.11313152313232, 119.64726829528809, 126.59289956092834, 133.49774169921875, 140.06689953804016, 146.78863167762756, 153.47442650794983, 160.38654255867004, 167.1226942539215, 173.7902946472168, 180.58340167999268, 187.17143297195435, 193.64411616325378, 200.1970133781433, 206.81522035598755, 213.5254306793213, 219.99562859535217, 226.82570672035217, 233.59182786941528, 240.18590092658997, 253.68047761917114]
[50.5, 56.6, 51.3, 51.6, 57.4, 60.3, 62.2, 62.7, 58.0, 66.2, 63.0, 57.0, 62.0, 64.4, 63.6, 66.6, 60.9, 65.1, 66.5, 65.4, 69.2, 65.3, 66.6, 67.0, 68.6, 70.9, 69.9, 64.9, 67.2, 61.8, 70.2, 67.3, 69.4, 67.7, 65.8, 67.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.482, Test loss: 1.598, Test accuracy: 31.10 

Round   1, Train loss: 1.218, Test loss: 1.424, Test accuracy: 38.70 

Round   2, Train loss: 1.087, Test loss: 1.104, Test accuracy: 56.70 

Round   3, Train loss: 0.961, Test loss: 1.087, Test accuracy: 57.80 

Round   4, Train loss: 0.906, Test loss: 1.018, Test accuracy: 60.20 

Round   5, Train loss: 0.843, Test loss: 1.033, Test accuracy: 61.00 

Round   6, Train loss: 0.756, Test loss: 0.995, Test accuracy: 61.50 

Round   7, Train loss: 0.708, Test loss: 0.985, Test accuracy: 63.00 

Round   8, Train loss: 0.658, Test loss: 1.045, Test accuracy: 63.70 

Round   9, Train loss: 0.597, Test loss: 0.941, Test accuracy: 64.30 

Round  10, Train loss: 0.567, Test loss: 1.045, Test accuracy: 64.40 

Round  11, Train loss: 0.527, Test loss: 0.996, Test accuracy: 65.60 

Round  12, Train loss: 0.456, Test loss: 0.950, Test accuracy: 66.70 

Round  13, Train loss: 0.418, Test loss: 0.992, Test accuracy: 67.10 

Round  14, Train loss: 0.393, Test loss: 1.013, Test accuracy: 64.90 

Round  15, Train loss: 0.345, Test loss: 0.967, Test accuracy: 68.10 

Round  16, Train loss: 0.327, Test loss: 1.049, Test accuracy: 67.70 

Round  17, Train loss: 0.271, Test loss: 1.050, Test accuracy: 68.30 

Round  18, Train loss: 0.283, Test loss: 1.010, Test accuracy: 68.70 

Round  19, Train loss: 0.253, Test loss: 1.127, Test accuracy: 67.70 

Round  20, Train loss: 0.218, Test loss: 1.118, Test accuracy: 67.80 

Round  21, Train loss: 0.205, Test loss: 1.201, Test accuracy: 68.10 

Round  22, Train loss: 0.198, Test loss: 1.168, Test accuracy: 69.60 

Round  23, Train loss: 0.170, Test loss: 1.100, Test accuracy: 69.80 

Round  24, Train loss: 0.157, Test loss: 1.101, Test accuracy: 69.00 

Round  25, Train loss: 0.122, Test loss: 1.063, Test accuracy: 70.70 

Round  26, Train loss: 0.135, Test loss: 1.205, Test accuracy: 69.40 

Round  27, Train loss: 0.108, Test loss: 1.176, Test accuracy: 71.70 

Round  28, Train loss: 0.117, Test loss: 1.108, Test accuracy: 70.20 

Round  29, Train loss: 0.088, Test loss: 1.221, Test accuracy: 69.10 

Round  30, Train loss: 0.087, Test loss: 1.448, Test accuracy: 68.30 

Round  31, Train loss: 0.083, Test loss: 1.250, Test accuracy: 70.50 

Round  32, Train loss: 0.082, Test loss: 1.201, Test accuracy: 71.20 

Round  33, Train loss: 0.078, Test loss: 1.277, Test accuracy: 69.50 

Round  34, Train loss: 0.057, Test loss: 1.276, Test accuracy: 68.50 

Round  35, Train loss: 0.059, Test loss: 1.443, Test accuracy: 68.00 

Round  36, Train loss: 0.057, Test loss: 1.307, Test accuracy: 71.80 

Round  37, Train loss: 0.046, Test loss: 1.350, Test accuracy: 70.20 

Round  38, Train loss: 0.054, Test loss: 1.302, Test accuracy: 71.00 

Round  39, Train loss: 0.092, Test loss: 1.381, Test accuracy: 69.70 

Final Round, Train loss: 0.048, Test loss: 1.360, Test accuracy: 69.70 

Average accuracy final 10 rounds: 69.87 

481.4291045665741
[11.104880094528198, 16.413501739501953, 21.437784433364868, 26.799896001815796, 31.860480546951294, 37.36356163024902, 42.613887548446655, 47.85487484931946, 53.053805112838745, 58.34031581878662, 63.634268283843994, 68.8074049949646, 74.18086004257202, 79.24261784553528, 84.65771389007568, 89.69877171516418, 95.00615692138672, 100.1652204990387, 105.22173070907593, 110.34625148773193, 115.28687572479248, 120.32448983192444, 125.8714382648468, 131.08203411102295, 136.38304829597473, 141.72585535049438, 146.7158055305481, 152.11887526512146, 157.3344283103943, 162.76003122329712, 168.00538182258606, 173.23943734169006, 178.50019931793213, 183.70783400535583, 188.91568279266357, 193.95992875099182, 199.53627395629883, 204.55471301078796, 209.7475779056549, 215.32230615615845, 221.15244460105896]
[31.1, 38.7, 56.7, 57.8, 60.2, 61.0, 61.5, 63.0, 63.7, 64.3, 64.4, 65.6, 66.7, 67.1, 64.9, 68.1, 67.7, 68.3, 68.7, 67.7, 67.8, 68.1, 69.6, 69.8, 69.0, 70.7, 69.4, 71.7, 70.2, 69.1, 68.3, 70.5, 71.2, 69.5, 68.5, 68.0, 71.8, 70.2, 71.0, 69.7, 69.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.521, Test loss: 1.616, Test accuracy: 30.30
Round   1, Train loss: 1.255, Test loss: 1.319, Test accuracy: 43.70
Round   2, Train loss: 1.111, Test loss: 1.113, Test accuracy: 51.20
Round   3, Train loss: 0.977, Test loss: 1.059, Test accuracy: 57.60
Round   4, Train loss: 0.922, Test loss: 1.024, Test accuracy: 59.70
Round   5, Train loss: 0.837, Test loss: 0.953, Test accuracy: 63.40
Round   6, Train loss: 0.756, Test loss: 1.034, Test accuracy: 61.20
Round   7, Train loss: 0.688, Test loss: 0.970, Test accuracy: 63.00
Round   8, Train loss: 0.657, Test loss: 0.954, Test accuracy: 65.60
Round   9, Train loss: 0.584, Test loss: 0.955, Test accuracy: 65.60
Round  10, Train loss: 0.538, Test loss: 0.987, Test accuracy: 64.90
Round  11, Train loss: 0.507, Test loss: 0.911, Test accuracy: 67.30
Round  12, Train loss: 0.460, Test loss: 0.962, Test accuracy: 65.90
Round  13, Train loss: 0.445, Test loss: 0.926, Test accuracy: 67.50
Round  14, Train loss: 0.386, Test loss: 0.954, Test accuracy: 67.20
Round  15, Train loss: 0.347, Test loss: 0.987, Test accuracy: 67.20
Round  16, Train loss: 0.331, Test loss: 0.986, Test accuracy: 67.10
Round  17, Train loss: 0.314, Test loss: 0.965, Test accuracy: 69.60
Round  18, Train loss: 0.248, Test loss: 1.036, Test accuracy: 68.90
Round  19, Train loss: 0.263, Test loss: 0.999, Test accuracy: 69.50
Round  20, Train loss: 0.213, Test loss: 1.091, Test accuracy: 69.10
Round  21, Train loss: 0.198, Test loss: 1.063, Test accuracy: 69.60
Round  22, Train loss: 0.195, Test loss: 1.038, Test accuracy: 71.40
Round  23, Train loss: 0.188, Test loss: 1.000, Test accuracy: 71.80
Round  24, Train loss: 0.183, Test loss: 1.014, Test accuracy: 71.10
Round  25, Train loss: 0.143, Test loss: 1.051, Test accuracy: 71.20
Round  26, Train loss: 0.116, Test loss: 1.121, Test accuracy: 71.00
Round  27, Train loss: 0.140, Test loss: 1.078, Test accuracy: 71.70
Round  28, Train loss: 0.108, Test loss: 1.038, Test accuracy: 72.90
Round  29, Train loss: 0.123, Test loss: 1.111, Test accuracy: 69.80
Round  30, Train loss: 0.085, Test loss: 1.112, Test accuracy: 70.60
Round  31, Train loss: 0.095, Test loss: 1.060, Test accuracy: 71.90
Round  32, Train loss: 0.083, Test loss: 1.071, Test accuracy: 71.70
Round  33, Train loss: 0.064, Test loss: 1.157, Test accuracy: 71.20
Round  34, Train loss: 0.087, Test loss: 1.134, Test accuracy: 71.00
Round  35, Train loss: 0.050, Test loss: 1.133, Test accuracy: 72.60
Round  36, Train loss: 0.061, Test loss: 1.116, Test accuracy: 71.70
Round  37, Train loss: 0.077, Test loss: 1.188, Test accuracy: 70.80
Round  38, Train loss: 0.063, Test loss: 1.150, Test accuracy: 72.50
Round  39, Train loss: 0.054, Test loss: 1.168, Test accuracy: 71.60
Final Round, Train loss: 0.026, Test loss: 1.182, Test accuracy: 72.20
Average accuracy final 10 rounds: 71.56
570.0166037082672
[12.136536836624146, 18.259315490722656, 24.70016574859619, 31.084704160690308, 37.09766626358032, 43.371742486953735, 49.8912878036499, 56.40949988365173, 62.559768199920654, 68.73754644393921, 75.22711443901062, 81.85522079467773, 88.45861387252808, 95.2891914844513, 101.93902587890625, 108.29706192016602, 114.58961582183838, 120.79481935501099, 127.16807746887207, 133.61252760887146, 139.90052127838135, 145.87163186073303, 152.25576329231262, 158.5893943309784, 164.8827567100525, 171.12892270088196, 177.70473861694336, 184.0130593776703, 190.0262954235077, 196.33294010162354, 202.6232614517212, 208.87194085121155, 215.0236759185791, 221.1990909576416, 227.87050771713257, 234.25777983665466, 240.64920806884766, 246.96002435684204, 253.20462608337402, 259.3440990447998, 265.46262788772583]
[30.3, 43.7, 51.2, 57.6, 59.7, 63.4, 61.2, 63.0, 65.6, 65.6, 64.9, 67.3, 65.9, 67.5, 67.2, 67.2, 67.1, 69.6, 68.9, 69.5, 69.1, 69.6, 71.4, 71.8, 71.1, 71.2, 71.0, 71.7, 72.9, 69.8, 70.6, 71.9, 71.7, 71.2, 71.0, 72.6, 71.7, 70.8, 72.5, 71.6, 72.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.307, Train accuracy: 89.600, Test loss: 1.308, Test accuracy: 59.60 

        train local model (freeze embeding):client   0,  Train loss: 0.218, Train accuracy: 92.600, Test loss: 1.274, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.196, Train accuracy: 92.600, Test loss: 1.605, Test accuracy: 57.20 

Round   0, Train loss: 0.196, Test loss: 1.605, Test accuracy: 57.20 

        train local model (freeze embeding):client   0,  Train loss: 0.096, Train accuracy: 97.600, Test loss: 1.495, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.113, Train accuracy: 95.800, Test loss: 1.549, Test accuracy: 61.00 

Round   1, Train loss: 0.113, Test loss: 1.549, Test accuracy: 61.00 

        train local model (freeze embeding):client   0,  Train loss: 0.086, Train accuracy: 96.800, Test loss: 1.433, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.094, Train accuracy: 96.400, Test loss: 1.719, Test accuracy: 60.60 

Round   2, Train loss: 0.094, Test loss: 1.719, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.055, Train accuracy: 98.800, Test loss: 1.655, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.600, Test loss: 1.932, Test accuracy: 59.60 

Round   3, Train loss: 0.034, Test loss: 1.932, Test accuracy: 59.60 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.894, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.079, Train accuracy: 97.200, Test loss: 2.295, Test accuracy: 56.80 

Round   4, Train loss: 0.079, Test loss: 2.295, Test accuracy: 56.80 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.875, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 2.027, Test accuracy: 59.00 

Round   5, Train loss: 0.012, Test loss: 2.027, Test accuracy: 59.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 2.007, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 99.400, Test loss: 2.010, Test accuracy: 59.80 

Round   6, Train loss: 0.035, Test loss: 2.010, Test accuracy: 59.80 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.893, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.943, Test accuracy: 61.40 

Round   7, Train loss: 0.005, Test loss: 1.943, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.858, Test accuracy: 60.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 2.074, Test accuracy: 63.60 

Round   8, Train loss: 0.034, Test loss: 2.074, Test accuracy: 63.60 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 2.060, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.130, Test accuracy: 62.80 

Round   9, Train loss: 0.009, Test loss: 2.130, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.009, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.113, Test accuracy: 63.40 

Round  10, Train loss: 0.007, Test loss: 2.113, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.193, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.017, Test accuracy: 62.40 

Round  11, Train loss: 0.008, Test loss: 2.017, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.021, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.082, Test accuracy: 62.00 

Round  12, Train loss: 0.001, Test loss: 2.082, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.089, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.191, Test accuracy: 62.00 

Round  13, Train loss: 0.009, Test loss: 2.191, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.120, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.089, Test accuracy: 63.40 

Round  14, Train loss: 0.002, Test loss: 2.089, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.092, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 2.142, Test accuracy: 65.40 

Round  15, Train loss: 0.018, Test loss: 2.142, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.176, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.234, Test accuracy: 65.00 

Round  16, Train loss: 0.004, Test loss: 2.234, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.305, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.107, Test accuracy: 62.40 

Round  17, Train loss: 0.001, Test loss: 2.107, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.191, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.248, Test accuracy: 63.60 

Round  18, Train loss: 0.003, Test loss: 2.248, Test accuracy: 63.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.328, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.060, Test accuracy: 65.00 

Round  19, Train loss: 0.001, Test loss: 2.060, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.079, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.156, Test accuracy: 65.80 

Final Round, Train loss: 0.000, Test loss: 2.077, Test accuracy: 65.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.766, Train accuracy: 70.800, Test loss: 1.108, Test accuracy: 57.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.002, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.084, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.747, Train accuracy: 71.600, Test loss: 1.074, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.150, Train accuracy: 95.000, Test loss: 1.023, Test accuracy: 69.60 

Round   0, Train loss: 0.076, Test loss: 1.429, Test accuracy: 66.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.952, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.994, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.250, Train accuracy: 92.000, Test loss: 0.942, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.090, Train accuracy: 97.200, Test loss: 1.160, Test accuracy: 69.80 

Round   1, Train loss: 0.045, Test loss: 1.400, Test accuracy: 68.30 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.980, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.118, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.080, Train accuracy: 98.800, Test loss: 1.025, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.123, Train accuracy: 95.600, Test loss: 1.498, Test accuracy: 65.60 

Round   2, Train loss: 0.064, Test loss: 1.501, Test accuracy: 65.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.865, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.976, Test accuracy: 66.20 

        train local model (freeze embeding):client   1,  Train loss: 0.065, Train accuracy: 98.800, Test loss: 1.030, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.214, Test accuracy: 73.60 

Round   3, Train loss: 0.021, Test loss: 1.471, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.781, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.933, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.074, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.045, Train accuracy: 98.800, Test loss: 1.327, Test accuracy: 70.00 

Round   4, Train loss: 0.023, Test loss: 1.519, Test accuracy: 68.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.796, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.884, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.412, Test accuracy: 70.20 

Round   5, Train loss: 0.018, Test loss: 1.425, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.736, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 2.206, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.153, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.433, Test accuracy: 70.40 

Round   6, Train loss: 0.015, Test loss: 1.545, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.764, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.811, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.185, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.157, Train accuracy: 95.800, Test loss: 1.802, Test accuracy: 64.80 

Round   7, Train loss: 0.079, Test loss: 1.562, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.873, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.953, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 71.60 

Round   8, Train loss: 0.008, Test loss: 1.475, Test accuracy: 69.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.815, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.978, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.213, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.584, Test accuracy: 69.60 

Round   9, Train loss: 0.010, Test loss: 1.526, Test accuracy: 69.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.792, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.987, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.306, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.146, Train accuracy: 94.800, Test loss: 1.944, Test accuracy: 64.80 

Round  10, Train loss: 0.074, Test loss: 1.577, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.803, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.047, Test accuracy: 63.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.260, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.513, Test accuracy: 70.80 

Round  11, Train loss: 0.010, Test loss: 1.574, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.895, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.106, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 73.40 

Round  12, Train loss: 0.003, Test loss: 1.568, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.843, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.890, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 73.00 

Round  13, Train loss: 0.003, Test loss: 1.519, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.701, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.600, Test loss: 2.068, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.303, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.512, Test accuracy: 69.80 

Round  14, Train loss: 0.015, Test loss: 1.555, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.829, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.840, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 74.20 

Round  15, Train loss: 0.001, Test loss: 1.464, Test accuracy: 70.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.728, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.822, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 73.40 

Round  16, Train loss: 0.000, Test loss: 1.470, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.633, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.902, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.127, Train accuracy: 95.800, Test loss: 2.270, Test accuracy: 64.40 

Round  17, Train loss: 0.064, Test loss: 1.761, Test accuracy: 67.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.942, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 75.80 

Round  18, Train loss: 0.001, Test loss: 1.502, Test accuracy: 70.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.768, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.772, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.217, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 73.80 

Round  19, Train loss: 0.000, Test loss: 1.476, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.702, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.661, Test accuracy: 67.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.315, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 73.60 

Final Round, Train loss: 0.000, Test loss: 1.462, Test accuracy: 70.80 

Average accuracy final 10 rounds: 133.24 

1275.9781665802002
[19.066812992095947, 37.63530445098877, 55.90732979774475, 74.18998384475708, 92.78679943084717, 110.74441528320312, 129.03780579566956, 147.58338713645935, 166.15008807182312, 183.1263906955719, 200.45703411102295, 217.56875014305115, 235.8913700580597, 254.1964328289032, 272.34546661376953, 291.36536979675293, 310.3347945213318, 328.4588713645935, 346.71496987342834, 364.8484766483307, 376.6612739562988, 394.88553047180176, 413.6383686065674, 432.23511695861816, 451.3511142730713, 471.1122703552246, 490.8567204475403, 511.3457667827606, 531.3188869953156, 550.6760323047638, 570.5382628440857, 589.4413330554962, 609.0056312084198, 628.985036611557, 648.4857981204987, 668.2424304485321, 687.5679411888123, 707.1967911720276, 726.0234651565552, 745.6117103099823, 765.8961138725281, 778.3210473060608]
[57.2, 61.0, 60.6, 59.6, 56.8, 59.0, 59.8, 61.4, 63.6, 62.8, 63.4, 62.4, 62.0, 62.0, 63.4, 65.4, 65.0, 62.4, 63.6, 65.0, 65.4, 66.4, 68.3, 65.5, 69.2, 68.5, 69.8, 68.4, 69.6, 69.9, 69.9, 68.2, 68.6, 69.6, 69.2, 71.1, 70.3, 70.4, 67.9, 70.7, 71.8, 70.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.421, Test loss: 1.421, Test accuracy: 48.90 

Round   0, Global train loss: 1.421, Global test loss: 1.556, Global test accuracy: 31.00 

Round   1, Train loss: 1.089, Test loss: 1.736, Test accuracy: 45.50 

Round   1, Global train loss: 1.089, Global test loss: 1.589, Global test accuracy: 26.20 

Round   2, Train loss: 0.958, Test loss: 1.316, Test accuracy: 54.50 

Round   2, Global train loss: 0.958, Global test loss: 1.577, Global test accuracy: 25.60 

Round   3, Train loss: 0.851, Test loss: 1.484, Test accuracy: 57.20 

Round   3, Global train loss: 0.851, Global test loss: 1.608, Global test accuracy: 28.70 

Round   4, Train loss: 0.742, Test loss: 1.504, Test accuracy: 54.70 

Round   4, Global train loss: 0.742, Global test loss: 1.648, Global test accuracy: 29.40 

Round   5, Train loss: 0.620, Test loss: 1.424, Test accuracy: 59.60 

Round   5, Global train loss: 0.620, Global test loss: 1.709, Global test accuracy: 24.10 

Round   6, Train loss: 0.545, Test loss: 1.501, Test accuracy: 59.20 

Round   6, Global train loss: 0.545, Global test loss: 1.599, Global test accuracy: 31.10 

Round   7, Train loss: 0.451, Test loss: 1.583, Test accuracy: 60.90 

Round   7, Global train loss: 0.451, Global test loss: 1.661, Global test accuracy: 29.90 

Round   8, Train loss: 0.401, Test loss: 1.615, Test accuracy: 62.60 

Round   8, Global train loss: 0.401, Global test loss: 1.701, Global test accuracy: 28.80 

Round   9, Train loss: 0.353, Test loss: 1.604, Test accuracy: 63.00 

Round   9, Global train loss: 0.353, Global test loss: 1.689, Global test accuracy: 30.40 

Round  10, Train loss: 0.284, Test loss: 1.943, Test accuracy: 60.20 

Round  10, Global train loss: 0.284, Global test loss: 1.918, Global test accuracy: 30.20 

Round  11, Train loss: 0.266, Test loss: 1.857, Test accuracy: 61.50 

Round  11, Global train loss: 0.266, Global test loss: 1.780, Global test accuracy: 27.60 

Round  12, Train loss: 0.195, Test loss: 1.899, Test accuracy: 63.40 

Round  12, Global train loss: 0.195, Global test loss: 1.804, Global test accuracy: 30.00 

Round  13, Train loss: 0.191, Test loss: 1.950, Test accuracy: 62.90 

Round  13, Global train loss: 0.191, Global test loss: 1.772, Global test accuracy: 22.20 

Round  14, Train loss: 0.151, Test loss: 1.779, Test accuracy: 65.80 

Round  14, Global train loss: 0.151, Global test loss: 1.784, Global test accuracy: 28.20 

Round  15, Train loss: 0.164, Test loss: 2.334, Test accuracy: 61.40 

Round  15, Global train loss: 0.164, Global test loss: 1.783, Global test accuracy: 30.70 

Round  16, Train loss: 0.153, Test loss: 1.839, Test accuracy: 62.30 

Round  16, Global train loss: 0.153, Global test loss: 1.974, Global test accuracy: 27.00 

Round  17, Train loss: 0.086, Test loss: 1.869, Test accuracy: 64.50 

Round  17, Global train loss: 0.086, Global test loss: 1.966, Global test accuracy: 23.10 

Round  18, Train loss: 0.074, Test loss: 1.912, Test accuracy: 65.10 

Round  18, Global train loss: 0.074, Global test loss: 1.936, Global test accuracy: 24.50 

Round  19, Train loss: 0.113, Test loss: 1.929, Test accuracy: 64.70 

Round  19, Global train loss: 0.113, Global test loss: 1.962, Global test accuracy: 29.30 

Round  20, Train loss: 0.067, Test loss: 1.783, Test accuracy: 66.30 

Round  20, Global train loss: 0.067, Global test loss: 1.902, Global test accuracy: 30.50 

Round  21, Train loss: 0.068, Test loss: 1.975, Test accuracy: 65.40 

Round  21, Global train loss: 0.068, Global test loss: 2.019, Global test accuracy: 27.90 

Round  22, Train loss: 0.075, Test loss: 1.861, Test accuracy: 67.20 

Round  22, Global train loss: 0.075, Global test loss: 1.871, Global test accuracy: 24.20 

Round  23, Train loss: 0.085, Test loss: 2.115, Test accuracy: 62.60 

Round  23, Global train loss: 0.085, Global test loss: 1.831, Global test accuracy: 24.00 

Round  24, Train loss: 0.056, Test loss: 2.109, Test accuracy: 66.20 

Round  24, Global train loss: 0.056, Global test loss: 1.709, Global test accuracy: 28.90 

Round  25, Train loss: 0.045, Test loss: 2.102, Test accuracy: 64.50 

Round  25, Global train loss: 0.045, Global test loss: 1.898, Global test accuracy: 28.80 

Round  26, Train loss: 0.043, Test loss: 2.060, Test accuracy: 66.30 

Round  26, Global train loss: 0.043, Global test loss: 2.049, Global test accuracy: 28.00 

Round  27, Train loss: 0.046, Test loss: 2.064, Test accuracy: 66.50 

Round  27, Global train loss: 0.046, Global test loss: 1.922, Global test accuracy: 28.70 

Round  28, Train loss: 0.058, Test loss: 2.110, Test accuracy: 65.00 

Round  28, Global train loss: 0.058, Global test loss: 1.820, Global test accuracy: 31.90 

Round  29, Train loss: 0.038, Test loss: 2.044, Test accuracy: 66.80 

Round  29, Global train loss: 0.038, Global test loss: 2.043, Global test accuracy: 24.70 

Round  30, Train loss: 0.020, Test loss: 2.204, Test accuracy: 64.80 

Round  30, Global train loss: 0.020, Global test loss: 2.006, Global test accuracy: 29.20 

Round  31, Train loss: 0.037, Test loss: 2.088, Test accuracy: 65.60 

Round  31, Global train loss: 0.037, Global test loss: 1.924, Global test accuracy: 25.90 

Round  32, Train loss: 0.064, Test loss: 2.026, Test accuracy: 67.20 

Round  32, Global train loss: 0.064, Global test loss: 2.057, Global test accuracy: 31.30 

Round  33, Train loss: 0.027, Test loss: 2.244, Test accuracy: 66.70 

Round  33, Global train loss: 0.027, Global test loss: 1.996, Global test accuracy: 31.80 

Round  34, Train loss: 0.035, Test loss: 2.192, Test accuracy: 65.30 

Round  34, Global train loss: 0.035, Global test loss: 1.982, Global test accuracy: 26.70 

Final Round, Train loss: 0.018, Test loss: 2.204, Test accuracy: 66.50 

Final Round, Global train loss: 0.018, Global test loss: 1.982, Global test accuracy: 26.70 

Average accuracy final 10 rounds: 65.86999999999999 

Average global accuracy final 10 rounds: 28.700000000000003 

605.8600826263428
[13.010784149169922, 19.62085270881653, 26.307663679122925, 33.506553649902344, 40.38974690437317, 47.26542353630066, 54.166507720947266, 61.23698663711548, 68.3170096874237, 75.19797396659851, 82.07145881652832, 88.78959608078003, 95.55824995040894, 102.61767101287842, 109.29408884048462, 116.00374913215637, 122.78756475448608, 129.88849925994873, 137.10730457305908, 144.2321538925171, 151.12975120544434, 158.17361187934875, 164.97746562957764, 171.8988208770752, 178.69080471992493, 185.68604135513306, 192.60252451896667, 199.5748996734619, 206.4037365913391, 213.48466324806213, 220.4510715007782, 227.05023431777954, 233.99070286750793, 241.0559115409851, 247.72018790245056, 261.49912762641907]
[48.9, 45.5, 54.5, 57.2, 54.7, 59.6, 59.2, 60.9, 62.6, 63.0, 60.2, 61.5, 63.4, 62.9, 65.8, 61.4, 62.3, 64.5, 65.1, 64.7, 66.3, 65.4, 67.2, 62.6, 66.2, 64.5, 66.3, 66.5, 65.0, 66.8, 64.8, 65.6, 67.2, 66.7, 65.3, 66.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.411, Test loss: 1.910, Test accuracy: 43.80 

Round   0, Global train loss: 1.411, Global test loss: 1.674, Global test accuracy: 27.10 

Round   1, Train loss: 1.221, Test loss: 1.368, Test accuracy: 49.30 

Round   1, Global train loss: 1.221, Global test loss: 1.593, Global test accuracy: 29.10 

Round   2, Train loss: 1.078, Test loss: 1.319, Test accuracy: 57.90 

Round   2, Global train loss: 1.078, Global test loss: 1.476, Global test accuracy: 34.30 

Round   3, Train loss: 0.987, Test loss: 1.440, Test accuracy: 54.20 

Round   3, Global train loss: 0.987, Global test loss: 1.569, Global test accuracy: 35.20 

Round   4, Train loss: 0.881, Test loss: 1.789, Test accuracy: 49.00 

Round   4, Global train loss: 0.881, Global test loss: 1.692, Global test accuracy: 35.60 

Round   5, Train loss: 0.807, Test loss: 1.219, Test accuracy: 60.60 

Round   5, Global train loss: 0.807, Global test loss: 1.522, Global test accuracy: 39.00 

Round   6, Train loss: 0.738, Test loss: 1.517, Test accuracy: 58.70 

Round   6, Global train loss: 0.738, Global test loss: 1.573, Global test accuracy: 42.40 

Round   7, Train loss: 0.662, Test loss: 1.591, Test accuracy: 56.00 

Round   7, Global train loss: 0.662, Global test loss: 1.684, Global test accuracy: 42.50 

Round   8, Train loss: 0.615, Test loss: 1.376, Test accuracy: 61.40 

Round   8, Global train loss: 0.615, Global test loss: 1.679, Global test accuracy: 42.20 

Round   9, Train loss: 0.538, Test loss: 1.293, Test accuracy: 61.60 

Round   9, Global train loss: 0.538, Global test loss: 1.663, Global test accuracy: 45.70 

Round  10, Train loss: 0.512, Test loss: 1.385, Test accuracy: 65.30 

Round  10, Global train loss: 0.512, Global test loss: 1.638, Global test accuracy: 43.00 

Round  11, Train loss: 0.451, Test loss: 1.569, Test accuracy: 61.30 

Round  11, Global train loss: 0.451, Global test loss: 1.898, Global test accuracy: 42.90 

Round  12, Train loss: 0.399, Test loss: 1.514, Test accuracy: 64.30 

Round  12, Global train loss: 0.399, Global test loss: 1.881, Global test accuracy: 45.00 

Round  13, Train loss: 0.333, Test loss: 1.704, Test accuracy: 58.60 

Round  13, Global train loss: 0.333, Global test loss: 2.122, Global test accuracy: 43.50 

Round  14, Train loss: 0.346, Test loss: 1.769, Test accuracy: 61.90 

Round  14, Global train loss: 0.346, Global test loss: 1.964, Global test accuracy: 45.70 

Round  15, Train loss: 0.291, Test loss: 1.553, Test accuracy: 65.00 

Round  15, Global train loss: 0.291, Global test loss: 1.968, Global test accuracy: 46.30 

Round  16, Train loss: 0.268, Test loss: 2.114, Test accuracy: 62.00 

Round  16, Global train loss: 0.268, Global test loss: 2.109, Global test accuracy: 44.90 

Round  17, Train loss: 0.194, Test loss: 1.868, Test accuracy: 62.30 

Round  17, Global train loss: 0.194, Global test loss: 2.367, Global test accuracy: 42.40 

Round  18, Train loss: 0.221, Test loss: 1.728, Test accuracy: 64.60 

Round  18, Global train loss: 0.221, Global test loss: 2.278, Global test accuracy: 43.60 

Round  19, Train loss: 0.192, Test loss: 1.789, Test accuracy: 64.50 

Round  19, Global train loss: 0.192, Global test loss: 2.217, Global test accuracy: 44.50 

Round  20, Train loss: 0.176, Test loss: 1.756, Test accuracy: 67.30 

Round  20, Global train loss: 0.176, Global test loss: 2.242, Global test accuracy: 49.00 

Round  21, Train loss: 0.140, Test loss: 2.029, Test accuracy: 64.20 

Round  21, Global train loss: 0.140, Global test loss: 2.314, Global test accuracy: 46.60 

Round  22, Train loss: 0.162, Test loss: 1.999, Test accuracy: 63.60 

Round  22, Global train loss: 0.162, Global test loss: 2.296, Global test accuracy: 48.00 

Round  23, Train loss: 0.135, Test loss: 1.786, Test accuracy: 66.30 

Round  23, Global train loss: 0.135, Global test loss: 2.305, Global test accuracy: 46.50 

Round  24, Train loss: 0.121, Test loss: 1.863, Test accuracy: 64.70 

Round  24, Global train loss: 0.121, Global test loss: 2.399, Global test accuracy: 46.10 

Round  25, Train loss: 0.095, Test loss: 2.173, Test accuracy: 63.00 

Round  25, Global train loss: 0.095, Global test loss: 2.579, Global test accuracy: 45.50 

Round  26, Train loss: 0.159, Test loss: 1.670, Test accuracy: 66.90 

Round  26, Global train loss: 0.159, Global test loss: 2.304, Global test accuracy: 48.40 

Round  27, Train loss: 0.080, Test loss: 1.927, Test accuracy: 65.50 

Round  27, Global train loss: 0.080, Global test loss: 2.634, Global test accuracy: 47.70 

Round  28, Train loss: 0.080, Test loss: 1.938, Test accuracy: 64.90 

Round  28, Global train loss: 0.080, Global test loss: 2.556, Global test accuracy: 45.80 

Round  29, Train loss: 0.107, Test loss: 2.125, Test accuracy: 63.60 

Round  29, Global train loss: 0.107, Global test loss: 2.616, Global test accuracy: 45.30 

Round  30, Train loss: 0.076, Test loss: 2.016, Test accuracy: 64.40 

Round  30, Global train loss: 0.076, Global test loss: 2.521, Global test accuracy: 46.20 

Round  31, Train loss: 0.060, Test loss: 1.967, Test accuracy: 65.90 

Round  31, Global train loss: 0.060, Global test loss: 2.453, Global test accuracy: 49.20 

Round  32, Train loss: 0.054, Test loss: 1.819, Test accuracy: 68.70 

Round  32, Global train loss: 0.054, Global test loss: 2.541, Global test accuracy: 50.10 

Round  33, Train loss: 0.074, Test loss: 1.789, Test accuracy: 67.30 

Round  33, Global train loss: 0.074, Global test loss: 2.665, Global test accuracy: 46.80 

Round  34, Train loss: 0.059, Test loss: 1.847, Test accuracy: 68.20 

Round  34, Global train loss: 0.059, Global test loss: 2.581, Global test accuracy: 48.30 

Final Round, Train loss: 0.057, Test loss: 2.054, Test accuracy: 65.10 

Final Round, Global train loss: 0.057, Global test loss: 2.581, Global test accuracy: 48.30 

Average accuracy final 10 rounds: 65.84 

Average global accuracy final 10 rounds: 47.33 

606.8753099441528
[13.773269891738892, 20.734171390533447, 27.721970796585083, 34.69575047492981, 41.45215654373169, 48.37543749809265, 55.11259984970093, 61.68340754508972, 68.40449118614197, 75.61503028869629, 82.45368099212646, 89.29897212982178, 96.00583624839783, 103.10280561447144, 110.09658455848694, 117.29409742355347, 124.21164417266846, 131.21538639068604, 138.4207649230957, 145.23024368286133, 151.88790464401245, 158.55302929878235, 165.4249894618988, 172.22128415107727, 179.06872963905334, 185.89839386940002, 192.78318786621094, 199.58900141716003, 206.39088034629822, 213.03249621391296, 219.7673463821411, 226.91312861442566, 233.7749228477478, 241.0523660182953, 247.99357843399048, 262.02449226379395]
[43.8, 49.3, 57.9, 54.2, 49.0, 60.6, 58.7, 56.0, 61.4, 61.6, 65.3, 61.3, 64.3, 58.6, 61.9, 65.0, 62.0, 62.3, 64.6, 64.5, 67.3, 64.2, 63.6, 66.3, 64.7, 63.0, 66.9, 65.5, 64.9, 63.6, 64.4, 65.9, 68.7, 67.3, 68.2, 65.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.487, Test loss: 1.797, Test accuracy: 20.40 

Round   1, Train loss: 1.385, Test loss: 1.725, Test accuracy: 34.80 

Round   2, Train loss: 1.222, Test loss: 1.251, Test accuracy: 46.50 

Round   3, Train loss: 1.121, Test loss: 1.246, Test accuracy: 45.40 

Round   4, Train loss: 1.021, Test loss: 1.098, Test accuracy: 53.30 

Round   5, Train loss: 0.932, Test loss: 1.094, Test accuracy: 55.60 

Round   6, Train loss: 0.898, Test loss: 1.275, Test accuracy: 54.30 

Round   7, Train loss: 0.817, Test loss: 1.174, Test accuracy: 55.20 

Round   8, Train loss: 0.766, Test loss: 1.107, Test accuracy: 59.10 

Round   9, Train loss: 0.708, Test loss: 1.226, Test accuracy: 54.50 

Round  10, Train loss: 0.693, Test loss: 1.206, Test accuracy: 57.90 

Round  11, Train loss: 0.638, Test loss: 1.153, Test accuracy: 59.90 

Round  12, Train loss: 0.593, Test loss: 1.169, Test accuracy: 58.50 

Round  13, Train loss: 0.551, Test loss: 1.176, Test accuracy: 61.10 

Round  14, Train loss: 0.511, Test loss: 1.135, Test accuracy: 62.80 

Round  15, Train loss: 0.461, Test loss: 1.239, Test accuracy: 62.30 

Round  16, Train loss: 0.451, Test loss: 1.092, Test accuracy: 65.90 

Round  17, Train loss: 0.397, Test loss: 1.307, Test accuracy: 60.90 

Round  18, Train loss: 0.390, Test loss: 1.312, Test accuracy: 62.10 

Round  19, Train loss: 0.348, Test loss: 1.259, Test accuracy: 64.90 

Round  20, Train loss: 0.333, Test loss: 1.203, Test accuracy: 65.80 

Round  21, Train loss: 0.279, Test loss: 1.241, Test accuracy: 64.30 

Round  22, Train loss: 0.252, Test loss: 1.316, Test accuracy: 63.70 

Round  23, Train loss: 0.214, Test loss: 1.321, Test accuracy: 65.60 

Round  24, Train loss: 0.193, Test loss: 1.359, Test accuracy: 65.80 

Round  25, Train loss: 0.209, Test loss: 1.305, Test accuracy: 65.20 

Round  26, Train loss: 0.199, Test loss: 1.451, Test accuracy: 63.40 

Round  27, Train loss: 0.171, Test loss: 1.427, Test accuracy: 64.10 

Round  28, Train loss: 0.142, Test loss: 1.492, Test accuracy: 64.40 

Round  29, Train loss: 0.150, Test loss: 1.389, Test accuracy: 64.80 

Round  30, Train loss: 0.138, Test loss: 1.520, Test accuracy: 64.50 

Round  31, Train loss: 0.117, Test loss: 1.502, Test accuracy: 65.40 

Round  32, Train loss: 0.132, Test loss: 1.549, Test accuracy: 65.40 

Round  33, Train loss: 0.117, Test loss: 1.626, Test accuracy: 63.30 

Round  34, Train loss: 0.094, Test loss: 1.472, Test accuracy: 65.60 

Round  35, Train loss: 0.094, Test loss: 1.530, Test accuracy: 65.70 

Round  36, Train loss: 0.098, Test loss: 1.480, Test accuracy: 66.30 

Round  37, Train loss: 0.073, Test loss: 1.516, Test accuracy: 65.60 

Round  38, Train loss: 0.084, Test loss: 1.694, Test accuracy: 63.70 

Round  39, Train loss: 0.063, Test loss: 1.720, Test accuracy: 63.30 

Final Round, Train loss: 0.044, Test loss: 1.727, Test accuracy: 63.60 

Average accuracy final 10 rounds: 64.88000000000001 

505.88407373428345
[11.650751829147339, 17.212676763534546, 22.968082427978516, 28.329988718032837, 34.06675481796265, 39.43977928161621, 44.472004413604736, 50.04165744781494, 55.557947874069214, 60.96685338020325, 66.58510613441467, 72.40704727172852, 77.59701490402222, 83.06235313415527, 88.74960923194885, 94.33888792991638, 100.10521364212036, 105.73525023460388, 111.31788992881775, 116.82174682617188, 122.34522485733032, 127.53398323059082, 132.9804949760437, 138.43078517913818, 143.6428346633911, 148.82857704162598, 154.26281905174255, 159.7744278907776, 165.25640058517456, 170.6658535003662, 176.17266201972961, 181.72220396995544, 187.4242262840271, 192.86894583702087, 198.73216199874878, 204.30570816993713, 209.7917869091034, 215.37050700187683, 220.88197565078735, 226.31594061851501, 233.04291200637817]
[20.4, 34.8, 46.5, 45.4, 53.3, 55.6, 54.3, 55.2, 59.1, 54.5, 57.9, 59.9, 58.5, 61.1, 62.8, 62.3, 65.9, 60.9, 62.1, 64.9, 65.8, 64.3, 63.7, 65.6, 65.8, 65.2, 63.4, 64.1, 64.4, 64.8, 64.5, 65.4, 65.4, 63.3, 65.6, 65.7, 66.3, 65.6, 63.7, 63.3, 63.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.559, Test loss: 1.974, Test accuracy: 25.60
Round   1, Train loss: 1.357, Test loss: 1.563, Test accuracy: 29.30
Round   2, Train loss: 1.184, Test loss: 1.215, Test accuracy: 53.30
Round   3, Train loss: 1.055, Test loss: 1.155, Test accuracy: 52.90
Round   4, Train loss: 0.988, Test loss: 1.110, Test accuracy: 54.40
Round   5, Train loss: 0.922, Test loss: 1.080, Test accuracy: 58.20
Round   6, Train loss: 0.855, Test loss: 1.097, Test accuracy: 55.70
Round   7, Train loss: 0.795, Test loss: 1.013, Test accuracy: 60.50
Round   8, Train loss: 0.731, Test loss: 1.094, Test accuracy: 58.80
Round   9, Train loss: 0.684, Test loss: 0.980, Test accuracy: 63.50
Round  10, Train loss: 0.632, Test loss: 1.058, Test accuracy: 62.90
Round  11, Train loss: 0.609, Test loss: 0.988, Test accuracy: 64.50
Round  12, Train loss: 0.538, Test loss: 1.128, Test accuracy: 60.70
Round  13, Train loss: 0.495, Test loss: 1.276, Test accuracy: 59.60
Round  14, Train loss: 0.481, Test loss: 1.177, Test accuracy: 61.90
Round  15, Train loss: 0.423, Test loss: 1.283, Test accuracy: 61.80
Round  16, Train loss: 0.407, Test loss: 1.211, Test accuracy: 63.20
Round  17, Train loss: 0.366, Test loss: 1.116, Test accuracy: 64.00
Round  18, Train loss: 0.319, Test loss: 1.225, Test accuracy: 62.80
Round  19, Train loss: 0.295, Test loss: 1.262, Test accuracy: 63.40
Round  20, Train loss: 0.291, Test loss: 1.276, Test accuracy: 64.10
Round  21, Train loss: 0.236, Test loss: 1.234, Test accuracy: 64.20
Round  22, Train loss: 0.236, Test loss: 1.344, Test accuracy: 61.50
Round  23, Train loss: 0.214, Test loss: 1.332, Test accuracy: 64.60
Round  24, Train loss: 0.183, Test loss: 1.350, Test accuracy: 64.60
Round  25, Train loss: 0.199, Test loss: 1.388, Test accuracy: 64.50
Round  26, Train loss: 0.159, Test loss: 1.401, Test accuracy: 64.10
Round  27, Train loss: 0.168, Test loss: 1.403, Test accuracy: 64.20
Round  28, Train loss: 0.138, Test loss: 1.424, Test accuracy: 64.20
Round  29, Train loss: 0.143, Test loss: 1.404, Test accuracy: 63.40
Round  30, Train loss: 0.125, Test loss: 1.448, Test accuracy: 65.10
Round  31, Train loss: 0.111, Test loss: 1.429, Test accuracy: 64.80
Round  32, Train loss: 0.092, Test loss: 1.484, Test accuracy: 66.70
Round  33, Train loss: 0.099, Test loss: 1.580, Test accuracy: 64.70
Round  34, Train loss: 0.092, Test loss: 1.448, Test accuracy: 66.60
Round  35, Train loss: 0.082, Test loss: 1.491, Test accuracy: 65.10
Round  36, Train loss: 0.067, Test loss: 1.522, Test accuracy: 66.10
Round  37, Train loss: 0.072, Test loss: 1.581, Test accuracy: 64.50
Round  38, Train loss: 0.070, Test loss: 1.420, Test accuracy: 66.10
Round  39, Train loss: 0.068, Test loss: 1.530, Test accuracy: 65.80
Final Round, Train loss: 0.046, Test loss: 1.523, Test accuracy: 65.70
Average accuracy final 10 rounds: 65.55
609.5359425544739
[13.022621393203735, 19.985387802124023, 26.85785412788391, 33.731886863708496, 40.416534423828125, 47.120341539382935, 54.073517084121704, 61.18527889251709, 67.90177464485168, 74.96799206733704, 81.7104012966156, 88.34097170829773, 94.98478817939758, 101.72426509857178, 108.62379097938538, 115.28122425079346, 122.03865051269531, 129.08217215538025, 135.71097373962402, 142.5827121734619, 149.1428017616272, 155.7244155406952, 162.58714294433594, 169.30689477920532, 176.1793656349182, 183.02053260803223, 189.87545466423035, 196.52244973182678, 203.76218628883362, 210.6694836616516, 217.53871083259583, 224.43913006782532, 231.13532614707947, 238.04105043411255, 244.5952489376068, 250.99725079536438, 257.374618768692, 264.40410828590393, 271.09163093566895, 278.36898374557495, 285.69218373298645]
[25.6, 29.3, 53.3, 52.9, 54.4, 58.2, 55.7, 60.5, 58.8, 63.5, 62.9, 64.5, 60.7, 59.6, 61.9, 61.8, 63.2, 64.0, 62.8, 63.4, 64.1, 64.2, 61.5, 64.6, 64.6, 64.5, 64.1, 64.2, 64.2, 63.4, 65.1, 64.8, 66.7, 64.7, 66.6, 65.1, 66.1, 64.5, 66.1, 65.8, 65.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.557, Train accuracy: 81.000, Test loss: 1.602, Test accuracy: 57.20 

        train local model (freeze embeding):client   0,  Train loss: 0.285, Train accuracy: 89.600, Test loss: 1.378, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.392, Train accuracy: 86.800, Test loss: 1.651, Test accuracy: 54.60 

Round   0, Train loss: 0.392, Test loss: 1.651, Test accuracy: 54.60 

        train local model (freeze embeding):client   0,  Train loss: 0.210, Train accuracy: 92.800, Test loss: 1.450, Test accuracy: 58.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.201, Train accuracy: 93.600, Test loss: 1.704, Test accuracy: 55.40 

Round   1, Train loss: 0.201, Test loss: 1.704, Test accuracy: 55.40 

        train local model (freeze embeding):client   0,  Train loss: 0.073, Train accuracy: 97.200, Test loss: 1.576, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.083, Train accuracy: 98.200, Test loss: 1.642, Test accuracy: 59.40 

Round   2, Train loss: 0.083, Test loss: 1.642, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.800, Test loss: 1.743, Test accuracy: 58.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.600, Test loss: 1.666, Test accuracy: 62.20 

Round   3, Train loss: 0.051, Test loss: 1.666, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.732, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.090, Train accuracy: 97.000, Test loss: 2.231, Test accuracy: 57.20 

Round   4, Train loss: 0.090, Test loss: 2.231, Test accuracy: 57.20 

        train local model (freeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.923, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.063, Train accuracy: 98.000, Test loss: 1.835, Test accuracy: 66.20 

Round   5, Train loss: 0.063, Test loss: 1.835, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.835, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.120, Test accuracy: 61.80 

Round   6, Train loss: 0.011, Test loss: 2.120, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 2.012, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.951, Test accuracy: 60.20 

Round   7, Train loss: 0.010, Test loss: 1.951, Test accuracy: 60.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.936, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.912, Test accuracy: 64.20 

Round   8, Train loss: 0.007, Test loss: 1.912, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.928, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.065, Test accuracy: 62.00 

Round   9, Train loss: 0.004, Test loss: 2.065, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.029, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 2.156, Test accuracy: 61.80 

Round  10, Train loss: 0.014, Test loss: 2.156, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.105, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 98.000, Test loss: 2.399, Test accuracy: 62.80 

Round  11, Train loss: 0.057, Test loss: 2.399, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 2.021, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.010, Test accuracy: 65.00 

Round  12, Train loss: 0.001, Test loss: 2.010, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.000, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.139, Train accuracy: 96.600, Test loss: 2.426, Test accuracy: 59.60 

Round  13, Train loss: 0.139, Test loss: 2.426, Test accuracy: 59.60 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 2.241, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.212, Test accuracy: 59.80 

Round  14, Train loss: 0.005, Test loss: 2.212, Test accuracy: 59.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.222, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.025, Test accuracy: 63.20 

Round  15, Train loss: 0.002, Test loss: 2.025, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.077, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.413, Test accuracy: 61.40 

Round  16, Train loss: 0.004, Test loss: 2.413, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.183, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.269, Test accuracy: 61.00 

Round  17, Train loss: 0.001, Test loss: 2.269, Test accuracy: 61.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.283, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.040, Test accuracy: 64.20 

Round  18, Train loss: 0.000, Test loss: 2.040, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.081, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.070, Test accuracy: 64.80 

Round  19, Train loss: 0.003, Test loss: 2.070, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.104, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.141, Test accuracy: 64.80 

Final Round, Train loss: 0.001, Test loss: 2.085, Test accuracy: 65.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.846, Train accuracy: 65.800, Test loss: 1.097, Test accuracy: 56.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.080, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.219, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.884, Train accuracy: 62.400, Test loss: 1.184, Test accuracy: 53.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.292, Train accuracy: 89.000, Test loss: 1.415, Test accuracy: 58.60 

Round   0, Train loss: 0.146, Test loss: 1.600, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.060, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.148, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.356, Train accuracy: 89.200, Test loss: 1.056, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.144, Train accuracy: 94.400, Test loss: 1.508, Test accuracy: 66.80 

Round   1, Train loss: 0.073, Test loss: 1.599, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.125, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.103, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.176, Train accuracy: 95.000, Test loss: 1.189, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.049, Train accuracy: 98.800, Test loss: 1.517, Test accuracy: 63.20 

Round   2, Train loss: 0.025, Test loss: 1.610, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.104, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.167, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.070, Train accuracy: 98.800, Test loss: 1.250, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.055, Train accuracy: 97.600, Test loss: 1.722, Test accuracy: 63.80 

Round   3, Train loss: 0.028, Test loss: 1.716, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.073, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.238, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.600, Test loss: 1.265, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.153, Train accuracy: 93.600, Test loss: 2.262, Test accuracy: 58.00 

Round   4, Train loss: 0.077, Test loss: 1.831, Test accuracy: 63.70 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.104, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.549, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.041, Train accuracy: 99.400, Test loss: 1.506, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.088, Train accuracy: 96.000, Test loss: 2.018, Test accuracy: 67.20 

Round   5, Train loss: 0.048, Test loss: 1.822, Test accuracy: 65.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.971, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.209, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.462, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.149, Train accuracy: 94.800, Test loss: 2.317, Test accuracy: 64.20 

Round   6, Train loss: 0.075, Test loss: 1.899, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.134, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.182, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.520, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.608, Test accuracy: 68.00 

Round   7, Train loss: 0.008, Test loss: 1.733, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.025, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.344, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.794, Test accuracy: 66.40 

Round   8, Train loss: 0.010, Test loss: 1.799, Test accuracy: 66.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.069, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.400, Test loss: 2.327, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.561, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.730, Test accuracy: 70.00 

Round   9, Train loss: 0.008, Test loss: 1.858, Test accuracy: 65.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.040, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.157, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 98.800, Test loss: 2.101, Test accuracy: 62.80 

Round  10, Train loss: 0.020, Test loss: 1.822, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.966, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.405, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.680, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.135, Train accuracy: 95.600, Test loss: 1.878, Test accuracy: 65.00 

Round  11, Train loss: 0.069, Test loss: 1.864, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.208, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.106, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.589, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.773, Test accuracy: 68.80 

Round  12, Train loss: 0.002, Test loss: 1.779, Test accuracy: 67.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.055, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.377, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.590, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.924, Test accuracy: 69.40 

Round  13, Train loss: 0.012, Test loss: 1.849, Test accuracy: 66.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.139, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.322, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.600, Test loss: 1.701, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.937, Test accuracy: 67.40 

Round  14, Train loss: 0.002, Test loss: 1.872, Test accuracy: 66.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.111, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.288, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.743, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.944, Test accuracy: 68.40 

Round  15, Train loss: 0.002, Test loss: 1.970, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.098, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.204, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.748, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.782, Test accuracy: 70.20 

Round  16, Train loss: 0.001, Test loss: 1.814, Test accuracy: 67.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.006, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.176, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.907, Test accuracy: 67.80 

Round  17, Train loss: 0.002, Test loss: 1.916, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.115, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.184, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.751, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 1.904, Test accuracy: 64.20 

Round  18, Train loss: 0.006, Test loss: 1.934, Test accuracy: 66.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.071, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.207, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.797, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.931, Test accuracy: 69.20 

Round  19, Train loss: 0.001, Test loss: 1.967, Test accuracy: 65.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.091, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.079, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.747, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.807, Test accuracy: 68.40 

Final Round, Train loss: 0.001, Test loss: 1.973, Test accuracy: 66.10 

Average accuracy final 10 rounds: 128.67 

1319.642550945282
[19.31622862815857, 38.53197264671326, 57.70569396018982, 77.70898365974426, 97.01627135276794, 116.742107629776, 136.2461109161377, 156.2054362297058, 175.19385957717896, 194.47979831695557, 214.19961428642273, 234.1258578300476, 254.095787525177, 273.14316487312317, 293.2349419593811, 312.2999930381775, 331.03571701049805, 350.96201252937317, 370.76238918304443, 390.7866976261139, 403.94434690475464, 423.45874071121216, 442.6346650123596, 462.8425953388214, 482.1515965461731, 501.7327678203583, 521.4704971313477, 541.4318795204163, 561.0680167675018, 581.3208515644073, 600.9448087215424, 620.3630282878876, 640.5272781848907, 659.8239154815674, 679.5198616981506, 698.8730714321136, 718.6756861209869, 738.3668072223663, 758.7406010627747, 778.0002143383026, 798.1323366165161, 810.8435716629028]
[54.6, 55.4, 59.4, 62.2, 57.2, 66.2, 61.8, 60.2, 64.2, 62.0, 61.8, 62.8, 65.0, 59.6, 59.8, 63.2, 61.4, 61.0, 64.2, 64.8, 65.0, 59.4, 63.4, 63.4, 63.4, 63.7, 65.5, 65.0, 66.6, 66.7, 65.1, 64.6, 67.0, 67.3, 66.1, 66.5, 65.6, 67.4, 66.6, 66.1, 65.9, 66.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.664, Test loss: 0.984, Test accuracy: 67.50 

Round   0, Global train loss: 0.664, Global test loss: 0.719, Global test accuracy: 50.00 

Round   1, Train loss: 0.465, Test loss: 0.613, Test accuracy: 75.00 

Round   1, Global train loss: 0.465, Global test loss: 0.686, Global test accuracy: 54.40 

Round   2, Train loss: 0.370, Test loss: 0.722, Test accuracy: 77.60 

Round   2, Global train loss: 0.370, Global test loss: 0.686, Global test accuracy: 53.70 

Round   3, Train loss: 0.338, Test loss: 0.648, Test accuracy: 78.00 

Round   3, Global train loss: 0.338, Global test loss: 0.691, Global test accuracy: 51.40 

Round   4, Train loss: 0.275, Test loss: 0.516, Test accuracy: 82.60 

Round   4, Global train loss: 0.275, Global test loss: 0.689, Global test accuracy: 52.90 

Round   5, Train loss: 0.286, Test loss: 0.623, Test accuracy: 79.90 

Round   5, Global train loss: 0.286, Global test loss: 0.685, Global test accuracy: 54.80 

Round   6, Train loss: 0.226, Test loss: 0.516, Test accuracy: 81.80 

Round   6, Global train loss: 0.226, Global test loss: 0.685, Global test accuracy: 54.20 

Round   7, Train loss: 0.212, Test loss: 0.720, Test accuracy: 80.10 

Round   7, Global train loss: 0.212, Global test loss: 0.686, Global test accuracy: 55.20 

Round   8, Train loss: 0.177, Test loss: 0.711, Test accuracy: 80.60 

Round   8, Global train loss: 0.177, Global test loss: 0.687, Global test accuracy: 54.40 

Round   9, Train loss: 0.189, Test loss: 0.631, Test accuracy: 82.20 

Round   9, Global train loss: 0.189, Global test loss: 0.694, Global test accuracy: 51.10 

Round  10, Train loss: 0.123, Test loss: 0.718, Test accuracy: 81.80 

Round  10, Global train loss: 0.123, Global test loss: 0.707, Global test accuracy: 50.50 

Round  11, Train loss: 0.129, Test loss: 0.687, Test accuracy: 80.50 

Round  11, Global train loss: 0.129, Global test loss: 0.707, Global test accuracy: 50.20 

Round  12, Train loss: 0.082, Test loss: 0.686, Test accuracy: 81.90 

Round  12, Global train loss: 0.082, Global test loss: 0.690, Global test accuracy: 52.50 

Round  13, Train loss: 0.103, Test loss: 0.660, Test accuracy: 83.40 

Round  13, Global train loss: 0.103, Global test loss: 0.697, Global test accuracy: 51.10 

Round  14, Train loss: 0.107, Test loss: 0.673, Test accuracy: 82.10 

Round  14, Global train loss: 0.107, Global test loss: 0.698, Global test accuracy: 50.80 

Round  15, Train loss: 0.091, Test loss: 0.778, Test accuracy: 81.50 

Round  15, Global train loss: 0.091, Global test loss: 0.735, Global test accuracy: 50.00 

Round  16, Train loss: 0.058, Test loss: 0.875, Test accuracy: 80.10 

Round  16, Global train loss: 0.058, Global test loss: 0.694, Global test accuracy: 51.00 

Round  17, Train loss: 0.054, Test loss: 0.741, Test accuracy: 85.40 

Round  17, Global train loss: 0.054, Global test loss: 0.695, Global test accuracy: 51.00 

Round  18, Train loss: 0.050, Test loss: 0.737, Test accuracy: 84.50 

Round  18, Global train loss: 0.050, Global test loss: 0.694, Global test accuracy: 51.30 

Round  19, Train loss: 0.055, Test loss: 0.794, Test accuracy: 81.30 

Round  19, Global train loss: 0.055, Global test loss: 0.697, Global test accuracy: 50.70 

Round  20, Train loss: 0.041, Test loss: 0.718, Test accuracy: 84.10 

Round  20, Global train loss: 0.041, Global test loss: 0.725, Global test accuracy: 50.00 

Round  21, Train loss: 0.023, Test loss: 0.749, Test accuracy: 84.10 

Round  21, Global train loss: 0.023, Global test loss: 0.711, Global test accuracy: 50.30 

Round  22, Train loss: 0.033, Test loss: 0.759, Test accuracy: 83.70 

Round  22, Global train loss: 0.033, Global test loss: 0.706, Global test accuracy: 50.20 

Round  23, Train loss: 0.034, Test loss: 0.799, Test accuracy: 83.60 

Round  23, Global train loss: 0.034, Global test loss: 0.698, Global test accuracy: 51.10 

Round  24, Train loss: 0.045, Test loss: 0.799, Test accuracy: 79.20 

Round  24, Global train loss: 0.045, Global test loss: 0.703, Global test accuracy: 50.10 

Round  25, Train loss: 0.034, Test loss: 0.702, Test accuracy: 82.80 

Round  25, Global train loss: 0.034, Global test loss: 0.713, Global test accuracy: 50.00 

Round  26, Train loss: 0.021, Test loss: 0.665, Test accuracy: 85.00 

Round  26, Global train loss: 0.021, Global test loss: 0.711, Global test accuracy: 50.00 

Round  27, Train loss: 0.020, Test loss: 0.737, Test accuracy: 83.80 

Round  27, Global train loss: 0.020, Global test loss: 0.691, Global test accuracy: 52.80 

Round  28, Train loss: 0.026, Test loss: 0.695, Test accuracy: 84.40 

Round  28, Global train loss: 0.026, Global test loss: 0.709, Global test accuracy: 50.00 

Round  29, Train loss: 0.022, Test loss: 0.797, Test accuracy: 82.60 

Round  29, Global train loss: 0.022, Global test loss: 0.703, Global test accuracy: 50.10 

Round  30, Train loss: 0.019, Test loss: 0.754, Test accuracy: 83.90 

Round  30, Global train loss: 0.019, Global test loss: 0.695, Global test accuracy: 51.00 

Round  31, Train loss: 0.024, Test loss: 0.734, Test accuracy: 84.10 

Round  31, Global train loss: 0.024, Global test loss: 0.697, Global test accuracy: 50.50 

Round  32, Train loss: 0.021, Test loss: 0.917, Test accuracy: 80.70 

Round  32, Global train loss: 0.021, Global test loss: 0.688, Global test accuracy: 53.60 

Round  33, Train loss: 0.025, Test loss: 0.721, Test accuracy: 84.30 

Round  33, Global train loss: 0.025, Global test loss: 0.693, Global test accuracy: 51.70 

Round  34, Train loss: 0.014, Test loss: 0.821, Test accuracy: 83.30 

Round  34, Global train loss: 0.014, Global test loss: 0.699, Global test accuracy: 50.50 

Final Round, Train loss: 0.017, Test loss: 0.890, Test accuracy: 83.40 

Final Round, Global train loss: 0.017, Global test loss: 0.699, Global test accuracy: 50.50 

Average accuracy final 10 rounds: 83.49 

Average global accuracy final 10 rounds: 51.019999999999996 

615.665755033493
[8.914960861206055, 11.950907945632935, 14.85500168800354, 17.69876194000244, 20.506025552749634, 23.352607250213623, 26.167410612106323, 28.892424821853638, 31.75878620147705, 34.61694622039795, 37.497480154037476, 40.453004121780396, 43.217572927474976, 46.06055998802185, 48.8513617515564, 51.701231479644775, 54.69280815124512, 57.62201261520386, 60.55009341239929, 63.446115493774414, 66.2178966999054, 69.19904398918152, 71.9384229183197, 74.87442898750305, 77.78394818305969, 80.7714204788208, 83.57059240341187, 86.43182253837585, 89.22583436965942, 91.96697735786438, 94.78180813789368, 97.65872120857239, 100.49524927139282, 103.22252178192139, 106.079110622406, 111.93408536911011]
[67.5, 75.0, 77.6, 78.0, 82.6, 79.9, 81.8, 80.1, 80.6, 82.2, 81.8, 80.5, 81.9, 83.4, 82.1, 81.5, 80.1, 85.4, 84.5, 81.3, 84.1, 84.1, 83.7, 83.6, 79.2, 82.8, 85.0, 83.8, 84.4, 82.6, 83.9, 84.1, 80.7, 84.3, 83.3, 83.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.671, Test loss: 0.664, Test accuracy: 72.30 

Round   0, Global train loss: 0.671, Global test loss: 0.696, Global test accuracy: 50.50 

Round   1, Train loss: 0.597, Test loss: 0.717, Test accuracy: 77.70 

Round   1, Global train loss: 0.597, Global test loss: 0.692, Global test accuracy: 54.70 

Round   2, Train loss: 0.535, Test loss: 0.663, Test accuracy: 75.40 

Round   2, Global train loss: 0.535, Global test loss: 0.685, Global test accuracy: 54.50 

Round   3, Train loss: 0.480, Test loss: 0.633, Test accuracy: 77.10 

Round   3, Global train loss: 0.480, Global test loss: 0.679, Global test accuracy: 58.50 

Round   4, Train loss: 0.471, Test loss: 0.443, Test accuracy: 80.50 

Round   4, Global train loss: 0.471, Global test loss: 0.677, Global test accuracy: 60.80 

Round   5, Train loss: 0.416, Test loss: 0.499, Test accuracy: 79.30 

Round   5, Global train loss: 0.416, Global test loss: 0.655, Global test accuracy: 61.40 

Round   6, Train loss: 0.425, Test loss: 0.622, Test accuracy: 80.60 

Round   6, Global train loss: 0.425, Global test loss: 0.699, Global test accuracy: 61.30 

Round   7, Train loss: 0.387, Test loss: 0.541, Test accuracy: 81.20 

Round   7, Global train loss: 0.387, Global test loss: 0.677, Global test accuracy: 63.60 

Round   8, Train loss: 0.365, Test loss: 0.452, Test accuracy: 82.80 

Round   8, Global train loss: 0.365, Global test loss: 0.677, Global test accuracy: 62.70 

Round   9, Train loss: 0.342, Test loss: 0.615, Test accuracy: 79.90 

Round   9, Global train loss: 0.342, Global test loss: 0.688, Global test accuracy: 64.10 

Round  10, Train loss: 0.316, Test loss: 0.560, Test accuracy: 79.30 

Round  10, Global train loss: 0.316, Global test loss: 0.717, Global test accuracy: 63.40 

Round  11, Train loss: 0.299, Test loss: 0.675, Test accuracy: 79.00 

Round  11, Global train loss: 0.299, Global test loss: 0.750, Global test accuracy: 63.50 

Round  12, Train loss: 0.296, Test loss: 0.515, Test accuracy: 82.00 

Round  12, Global train loss: 0.296, Global test loss: 0.737, Global test accuracy: 63.30 

Round  13, Train loss: 0.290, Test loss: 0.541, Test accuracy: 83.20 

Round  13, Global train loss: 0.290, Global test loss: 0.808, Global test accuracy: 62.90 

Round  14, Train loss: 0.262, Test loss: 0.705, Test accuracy: 78.70 

Round  14, Global train loss: 0.262, Global test loss: 0.799, Global test accuracy: 63.30 

Round  15, Train loss: 0.245, Test loss: 0.652, Test accuracy: 80.90 

Round  15, Global train loss: 0.245, Global test loss: 0.821, Global test accuracy: 62.40 

Round  16, Train loss: 0.257, Test loss: 0.524, Test accuracy: 80.50 

Round  16, Global train loss: 0.257, Global test loss: 0.753, Global test accuracy: 62.10 

Round  17, Train loss: 0.222, Test loss: 0.548, Test accuracy: 82.90 

Round  17, Global train loss: 0.222, Global test loss: 0.802, Global test accuracy: 63.10 

Round  18, Train loss: 0.222, Test loss: 0.515, Test accuracy: 82.10 

Round  18, Global train loss: 0.222, Global test loss: 0.777, Global test accuracy: 62.60 

Round  19, Train loss: 0.217, Test loss: 0.546, Test accuracy: 83.20 

Round  19, Global train loss: 0.217, Global test loss: 0.874, Global test accuracy: 63.00 

Round  20, Train loss: 0.194, Test loss: 0.629, Test accuracy: 82.00 

Round  20, Global train loss: 0.194, Global test loss: 0.847, Global test accuracy: 62.70 

Round  21, Train loss: 0.164, Test loss: 1.024, Test accuracy: 77.00 

Round  21, Global train loss: 0.164, Global test loss: 0.832, Global test accuracy: 63.30 

Round  22, Train loss: 0.205, Test loss: 0.491, Test accuracy: 83.70 

Round  22, Global train loss: 0.205, Global test loss: 0.804, Global test accuracy: 62.10 

Round  23, Train loss: 0.189, Test loss: 0.558, Test accuracy: 81.60 

Round  23, Global train loss: 0.189, Global test loss: 0.804, Global test accuracy: 62.70 

Round  24, Train loss: 0.159, Test loss: 0.630, Test accuracy: 81.70 

Round  24, Global train loss: 0.159, Global test loss: 0.838, Global test accuracy: 60.80 

Round  25, Train loss: 0.130, Test loss: 0.649, Test accuracy: 82.00 

Round  25, Global train loss: 0.130, Global test loss: 0.941, Global test accuracy: 61.10 

Round  26, Train loss: 0.155, Test loss: 0.513, Test accuracy: 83.70 

Round  26, Global train loss: 0.155, Global test loss: 0.826, Global test accuracy: 62.50 

Round  27, Train loss: 0.121, Test loss: 0.578, Test accuracy: 83.40 

Round  27, Global train loss: 0.121, Global test loss: 0.954, Global test accuracy: 61.10 

Round  28, Train loss: 0.153, Test loss: 0.601, Test accuracy: 81.30 

Round  28, Global train loss: 0.153, Global test loss: 0.874, Global test accuracy: 61.80 

Round  29, Train loss: 0.124, Test loss: 0.491, Test accuracy: 83.90 

Round  29, Global train loss: 0.124, Global test loss: 0.907, Global test accuracy: 63.50 

Round  30, Train loss: 0.115, Test loss: 0.617, Test accuracy: 83.90 

Round  30, Global train loss: 0.115, Global test loss: 0.924, Global test accuracy: 62.10 

Round  31, Train loss: 0.116, Test loss: 0.567, Test accuracy: 84.50 

Round  31, Global train loss: 0.116, Global test loss: 0.924, Global test accuracy: 61.40 

Round  32, Train loss: 0.118, Test loss: 0.560, Test accuracy: 84.00 

Round  32, Global train loss: 0.118, Global test loss: 0.918, Global test accuracy: 61.80 

Round  33, Train loss: 0.122, Test loss: 0.591, Test accuracy: 83.40 

Round  33, Global train loss: 0.122, Global test loss: 0.952, Global test accuracy: 62.20 

Round  34, Train loss: 0.121, Test loss: 0.699, Test accuracy: 82.40 

Round  34, Global train loss: 0.121, Global test loss: 0.955, Global test accuracy: 64.40 

Final Round, Train loss: 0.068, Test loss: 0.761, Test accuracy: 82.70 

Final Round, Global train loss: 0.068, Global test loss: 0.955, Global test accuracy: 64.40 

Average accuracy final 10 rounds: 83.25 

Average global accuracy final 10 rounds: 62.19 

613.2680153846741
[8.990778684616089, 12.020057201385498, 14.865940570831299, 17.943448543548584, 20.782182693481445, 23.60675597190857, 26.405001640319824, 29.202152490615845, 31.998045921325684, 34.944804191589355, 37.814615964889526, 40.51661276817322, 43.51181936264038, 46.40945482254028, 49.22150373458862, 52.23867869377136, 55.13853573799133, 58.059427976608276, 60.99858784675598, 63.85876798629761, 66.57050704956055, 69.36838603019714, 72.20260953903198, 74.97617793083191, 77.79630327224731, 80.60987615585327, 83.39600014686584, 86.18054938316345, 89.03948545455933, 91.9563376903534, 94.81708860397339, 97.5147602558136, 100.37362504005432, 103.18447661399841, 106.13472628593445, 111.69926309585571]
[72.3, 77.7, 75.4, 77.1, 80.5, 79.3, 80.6, 81.2, 82.8, 79.9, 79.3, 79.0, 82.0, 83.2, 78.7, 80.9, 80.5, 82.9, 82.1, 83.2, 82.0, 77.0, 83.7, 81.6, 81.7, 82.0, 83.7, 83.4, 81.3, 83.9, 83.9, 84.5, 84.0, 83.4, 82.4, 82.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.739, Test loss: 0.973, Test accuracy: 50.20 

Round   1, Train loss: 0.658, Test loss: 1.237, Test accuracy: 52.70 

Round   2, Train loss: 0.612, Test loss: 1.013, Test accuracy: 58.70 

Round   3, Train loss: 0.559, Test loss: 0.620, Test accuracy: 66.60 

Round   4, Train loss: 0.537, Test loss: 0.762, Test accuracy: 62.00 

Round   5, Train loss: 0.490, Test loss: 0.718, Test accuracy: 68.90 

Round   6, Train loss: 0.464, Test loss: 0.516, Test accuracy: 74.00 

Round   7, Train loss: 0.456, Test loss: 0.404, Test accuracy: 80.90 

Round   8, Train loss: 0.411, Test loss: 0.550, Test accuracy: 75.70 

Round   9, Train loss: 0.423, Test loss: 0.563, Test accuracy: 75.00 

Round  10, Train loss: 0.372, Test loss: 0.420, Test accuracy: 80.00 

Round  11, Train loss: 0.355, Test loss: 0.409, Test accuracy: 81.60 

Round  12, Train loss: 0.366, Test loss: 0.510, Test accuracy: 79.90 

Round  13, Train loss: 0.327, Test loss: 0.437, Test accuracy: 79.40 

Round  14, Train loss: 0.320, Test loss: 0.591, Test accuracy: 77.20 

Round  15, Train loss: 0.292, Test loss: 0.445, Test accuracy: 81.10 

Round  16, Train loss: 0.289, Test loss: 0.505, Test accuracy: 78.90 

Round  17, Train loss: 0.261, Test loss: 0.410, Test accuracy: 83.00 

Round  18, Train loss: 0.259, Test loss: 0.412, Test accuracy: 82.70 

Round  19, Train loss: 0.236, Test loss: 0.432, Test accuracy: 83.00 

Round  20, Train loss: 0.246, Test loss: 0.465, Test accuracy: 81.70 

Round  21, Train loss: 0.222, Test loss: 0.501, Test accuracy: 80.60 

Round  22, Train loss: 0.215, Test loss: 0.423, Test accuracy: 83.10 

Round  23, Train loss: 0.204, Test loss: 0.429, Test accuracy: 82.60 

Round  24, Train loss: 0.194, Test loss: 0.465, Test accuracy: 82.50 

Round  25, Train loss: 0.189, Test loss: 0.477, Test accuracy: 81.90 

Round  26, Train loss: 0.179, Test loss: 0.423, Test accuracy: 83.70 

Round  27, Train loss: 0.163, Test loss: 0.452, Test accuracy: 83.80 

Round  28, Train loss: 0.144, Test loss: 0.429, Test accuracy: 83.40 

Round  29, Train loss: 0.159, Test loss: 0.486, Test accuracy: 82.90 

Round  30, Train loss: 0.132, Test loss: 0.452, Test accuracy: 83.00 

Round  31, Train loss: 0.125, Test loss: 0.466, Test accuracy: 84.50 

Round  32, Train loss: 0.112, Test loss: 0.458, Test accuracy: 84.50 

Round  33, Train loss: 0.111, Test loss: 0.438, Test accuracy: 85.00 

Round  34, Train loss: 0.109, Test loss: 0.485, Test accuracy: 84.90 

Round  35, Train loss: 0.105, Test loss: 0.533, Test accuracy: 85.40 

Round  36, Train loss: 0.113, Test loss: 0.475, Test accuracy: 85.80 

Round  37, Train loss: 0.092, Test loss: 0.454, Test accuracy: 85.20 

Round  38, Train loss: 0.083, Test loss: 0.456, Test accuracy: 85.00 

Round  39, Train loss: 0.086, Test loss: 0.490, Test accuracy: 84.40 

Round  40, Train loss: 0.095, Test loss: 0.466, Test accuracy: 84.90 

Round  41, Train loss: 0.065, Test loss: 0.489, Test accuracy: 85.20 

Round  42, Train loss: 0.067, Test loss: 0.495, Test accuracy: 85.60 

Round  43, Train loss: 0.066, Test loss: 0.475, Test accuracy: 85.00 

Round  44, Train loss: 0.048, Test loss: 0.522, Test accuracy: 84.80 

Round  45, Train loss: 0.082, Test loss: 0.499, Test accuracy: 84.40 

Round  46, Train loss: 0.048, Test loss: 0.528, Test accuracy: 83.70 

Round  47, Train loss: 0.069, Test loss: 0.542, Test accuracy: 83.90 

Round  48, Train loss: 0.068, Test loss: 0.527, Test accuracy: 84.60 

Round  49, Train loss: 0.048, Test loss: 0.519, Test accuracy: 86.00 

Final Round, Train loss: 0.034, Test loss: 0.533, Test accuracy: 85.20 

Average accuracy final 10 rounds: 84.80999999999999 

628.1907253265381
[8.452607870101929, 10.621964931488037, 12.814815044403076, 14.96785831451416, 17.141348361968994, 19.30876111984253, 21.49604630470276, 23.65067982673645, 25.856513261795044, 27.97615885734558, 30.117366552352905, 32.2501220703125, 34.413431882858276, 36.53317046165466, 38.726160526275635, 40.87629556655884, 42.99915099143982, 45.17440962791443, 47.34784483909607, 49.51532769203186, 51.681294441223145, 53.86917996406555, 56.13181257247925, 58.2852840423584, 60.522117376327515, 62.735055446624756, 64.94221305847168, 67.12450766563416, 69.30517196655273, 71.55743384361267, 73.81364488601685, 76.0509386062622, 78.26072311401367, 80.58314776420593, 82.86789727210999, 85.12712717056274, 87.44196033477783, 89.68843579292297, 91.89715552330017, 94.09832715988159, 96.35208249092102, 98.54293656349182, 100.82928347587585, 103.05699896812439, 105.3396966457367, 107.54914450645447, 109.8053879737854, 112.08503460884094, 114.36911082267761, 116.65163111686707, 119.60085773468018]
[50.2, 52.7, 58.7, 66.6, 62.0, 68.9, 74.0, 80.9, 75.7, 75.0, 80.0, 81.6, 79.9, 79.4, 77.2, 81.1, 78.9, 83.0, 82.7, 83.0, 81.7, 80.6, 83.1, 82.6, 82.5, 81.9, 83.7, 83.8, 83.4, 82.9, 83.0, 84.5, 84.5, 85.0, 84.9, 85.4, 85.8, 85.2, 85.0, 84.4, 84.9, 85.2, 85.6, 85.0, 84.8, 84.4, 83.7, 83.9, 84.6, 86.0, 85.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.724, Test loss: 0.689, Test accuracy: 52.60
Round   1, Train loss: 0.682, Test loss: 1.278, Test accuracy: 52.10
Round   2, Train loss: 0.589, Test loss: 0.733, Test accuracy: 64.90
Round   3, Train loss: 0.605, Test loss: 1.243, Test accuracy: 67.20
Round   4, Train loss: 0.531, Test loss: 0.788, Test accuracy: 68.20
Round   5, Train loss: 0.482, Test loss: 0.793, Test accuracy: 66.70
Round   6, Train loss: 0.472, Test loss: 0.632, Test accuracy: 70.60
Round   7, Train loss: 0.452, Test loss: 0.677, Test accuracy: 68.30
Round   8, Train loss: 0.402, Test loss: 0.508, Test accuracy: 75.80
Round   9, Train loss: 0.381, Test loss: 0.449, Test accuracy: 77.90
Round  10, Train loss: 0.389, Test loss: 0.577, Test accuracy: 74.70
Round  11, Train loss: 0.351, Test loss: 0.682, Test accuracy: 75.40
Round  12, Train loss: 0.335, Test loss: 0.463, Test accuracy: 79.50
Round  13, Train loss: 0.333, Test loss: 0.444, Test accuracy: 80.50
Round  14, Train loss: 0.318, Test loss: 0.416, Test accuracy: 82.50
Round  15, Train loss: 0.287, Test loss: 0.511, Test accuracy: 79.40
Round  16, Train loss: 0.276, Test loss: 0.441, Test accuracy: 81.50
Round  17, Train loss: 0.271, Test loss: 0.444, Test accuracy: 81.60
Round  18, Train loss: 0.242, Test loss: 0.450, Test accuracy: 81.50
Round  19, Train loss: 0.240, Test loss: 0.481, Test accuracy: 82.80
Round  20, Train loss: 0.221, Test loss: 0.451, Test accuracy: 83.00
Round  21, Train loss: 0.221, Test loss: 0.439, Test accuracy: 82.30
Round  22, Train loss: 0.201, Test loss: 0.463, Test accuracy: 82.80
Round  23, Train loss: 0.187, Test loss: 0.438, Test accuracy: 83.30
Round  24, Train loss: 0.190, Test loss: 0.453, Test accuracy: 82.20
Round  25, Train loss: 0.168, Test loss: 0.454, Test accuracy: 83.00
Round  26, Train loss: 0.177, Test loss: 0.429, Test accuracy: 84.60
Round  27, Train loss: 0.156, Test loss: 0.427, Test accuracy: 84.40
Round  28, Train loss: 0.155, Test loss: 0.452, Test accuracy: 84.00
Round  29, Train loss: 0.152, Test loss: 0.433, Test accuracy: 84.90
Round  30, Train loss: 0.134, Test loss: 0.506, Test accuracy: 82.80
Round  31, Train loss: 0.125, Test loss: 0.443, Test accuracy: 84.20
Round  32, Train loss: 0.118, Test loss: 0.518, Test accuracy: 82.70
Round  33, Train loss: 0.114, Test loss: 0.506, Test accuracy: 82.50
Round  34, Train loss: 0.107, Test loss: 0.458, Test accuracy: 84.10
Round  35, Train loss: 0.117, Test loss: 0.478, Test accuracy: 83.10
Round  36, Train loss: 0.110, Test loss: 0.493, Test accuracy: 83.40
Round  37, Train loss: 0.109, Test loss: 0.454, Test accuracy: 85.50
Round  38, Train loss: 0.084, Test loss: 0.475, Test accuracy: 83.80
Round  39, Train loss: 0.091, Test loss: 0.470, Test accuracy: 83.80
Round  40, Train loss: 0.092, Test loss: 0.453, Test accuracy: 85.70
Round  41, Train loss: 0.071, Test loss: 0.493, Test accuracy: 84.90
Round  42, Train loss: 0.079, Test loss: 0.488, Test accuracy: 83.50
Round  43, Train loss: 0.069, Test loss: 0.476, Test accuracy: 84.50
Round  44, Train loss: 0.061, Test loss: 0.483, Test accuracy: 84.40
Round  45, Train loss: 0.070, Test loss: 0.464, Test accuracy: 85.50
Round  46, Train loss: 0.063, Test loss: 0.498, Test accuracy: 84.90
Round  47, Train loss: 0.069, Test loss: 0.489, Test accuracy: 85.20
Round  48, Train loss: 0.052, Test loss: 0.518, Test accuracy: 84.80
Round  49, Train loss: 0.064, Test loss: 0.504, Test accuracy: 84.50
Final Round, Train loss: 0.033, Test loss: 0.499, Test accuracy: 84.90
Average accuracy final 10 rounds: 84.79
761.144122838974
[9.229625940322876, 11.951446056365967, 14.659335136413574, 17.467186212539673, 20.254775762557983, 22.975045204162598, 25.800150871276855, 28.537197589874268, 31.323071479797363, 34.117570638656616, 36.90403914451599, 39.74370884895325, 42.54257106781006, 45.329063415527344, 48.15427899360657, 50.97015357017517, 53.76105332374573, 56.53326392173767, 59.28471899032593, 62.07180857658386, 64.79771447181702, 67.5819902420044, 70.32066440582275, 73.13670992851257, 75.90796303749084, 78.65478014945984, 81.42199206352234, 84.14115786552429, 86.85661482810974, 89.64022183418274, 92.43491959571838, 95.11503481864929, 97.88925099372864, 100.6125807762146, 103.28556036949158, 105.98381471633911, 108.71999263763428, 111.48980951309204, 114.20754599571228, 116.94498777389526, 119.6383409500122, 122.33100461959839, 125.09534406661987, 127.89301371574402, 130.65916395187378, 133.4628701210022, 136.22793984413147, 138.95881247520447, 141.70876622200012, 144.4381809234619, 147.68293523788452]
[52.6, 52.1, 64.9, 67.2, 68.2, 66.7, 70.6, 68.3, 75.8, 77.9, 74.7, 75.4, 79.5, 80.5, 82.5, 79.4, 81.5, 81.6, 81.5, 82.8, 83.0, 82.3, 82.8, 83.3, 82.2, 83.0, 84.6, 84.4, 84.0, 84.9, 82.8, 84.2, 82.7, 82.5, 84.1, 83.1, 83.4, 85.5, 83.8, 83.8, 85.7, 84.9, 83.5, 84.5, 84.4, 85.5, 84.9, 85.2, 84.8, 84.5, 84.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 0.248, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 0.183, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.068, Train accuracy: 97.500, Test loss: 0.302, Test accuracy: 91.50 

Round   0, Train loss: 0.068, Test loss: 0.302, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.172, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.252, Test accuracy: 91.50 

Round   1, Train loss: 0.030, Test loss: 0.252, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.224, Test accuracy: 94.00 

Round   2, Train loss: 0.033, Test loss: 0.224, Test accuracy: 94.00 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.163, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.147, Test accuracy: 94.50 

Round   3, Train loss: 0.003, Test loss: 0.147, Test accuracy: 94.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.166, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.158, Test accuracy: 94.50 

Round   4, Train loss: 0.002, Test loss: 0.158, Test accuracy: 94.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.160, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 94.50 

Round   5, Train loss: 0.001, Test loss: 0.245, Test accuracy: 94.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 94.00 

Round   6, Train loss: 0.002, Test loss: 0.216, Test accuracy: 94.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 94.50 

Round   7, Train loss: 0.001, Test loss: 0.256, Test accuracy: 94.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.50 

Round   8, Train loss: 0.002, Test loss: 0.213, Test accuracy: 93.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 94.00 

Round   9, Train loss: 0.000, Test loss: 0.263, Test accuracy: 94.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 93.00 

Round  10, Train loss: 0.000, Test loss: 0.405, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 96.00 

Round  11, Train loss: 0.004, Test loss: 0.286, Test accuracy: 96.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.259, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 93.50 

Round  12, Train loss: 0.001, Test loss: 0.301, Test accuracy: 93.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 95.50 

Round  13, Train loss: 0.001, Test loss: 0.209, Test accuracy: 95.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.215, Test accuracy: 95.00 

Round  14, Train loss: 0.000, Test loss: 0.215, Test accuracy: 95.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.233, Test accuracy: 92.50 

Round  15, Train loss: 0.001, Test loss: 0.233, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.00 

Round  16, Train loss: 0.000, Test loss: 0.225, Test accuracy: 94.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 0.321, Test accuracy: 92.50 

Round  17, Train loss: 0.040, Test loss: 0.321, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 98.500, Test loss: 0.265, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 95.50 

Round  18, Train loss: 0.002, Test loss: 0.234, Test accuracy: 95.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.169, Test accuracy: 95.50 

Round  19, Train loss: 0.001, Test loss: 0.169, Test accuracy: 95.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.176, Test accuracy: 95.00 

Final Round, Train loss: 0.000, Test loss: 0.170, Test accuracy: 95.50 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.583, Train accuracy: 73.000, Test loss: 0.700, Test accuracy: 66.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.190, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.560, Train accuracy: 74.000, Test loss: 0.652, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.362, Train accuracy: 81.500, Test loss: 0.869, Test accuracy: 64.00 

Round   0, Train loss: 0.181, Test loss: 0.489, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.224, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.552, Train accuracy: 71.000, Test loss: 1.176, Test accuracy: 56.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.115, Train accuracy: 96.000, Test loss: 0.882, Test accuracy: 73.00 

Round   1, Train loss: 0.058, Test loss: 0.435, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 96.50 

        train local model (freeze embeding):client   1,  Train loss: 0.178, Train accuracy: 94.500, Test loss: 0.803, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.241, Train accuracy: 89.500, Test loss: 0.770, Test accuracy: 73.50 

Round   2, Train loss: 0.121, Test loss: 0.484, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.195, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.198, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.122, Train accuracy: 96.500, Test loss: 0.786, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.000, Test loss: 1.003, Test accuracy: 72.50 

Round   3, Train loss: 0.038, Test loss: 0.489, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.229, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.075, Train accuracy: 96.500, Test loss: 0.784, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 1.189, Test accuracy: 69.00 

Round   4, Train loss: 0.012, Test loss: 0.564, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.211, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.046, Train accuracy: 99.500, Test loss: 0.903, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 0.733, Test accuracy: 78.00 

Round   5, Train loss: 0.014, Test loss: 0.601, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 0.784, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.071, Train accuracy: 98.500, Test loss: 0.804, Test accuracy: 75.50 

Round   6, Train loss: 0.036, Test loss: 0.487, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 0.731, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.785, Test accuracy: 76.50 

Round   7, Train loss: 0.004, Test loss: 0.497, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.747, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 0.985, Test accuracy: 73.00 

Round   8, Train loss: 0.019, Test loss: 0.529, Test accuracy: 81.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.062, Train accuracy: 97.500, Test loss: 0.719, Test accuracy: 79.00 

Round   9, Train loss: 0.032, Test loss: 0.494, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.251, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 1.248, Test accuracy: 72.00 

Round  10, Train loss: 0.008, Test loss: 0.633, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.292, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 75.50 

Round  11, Train loss: 0.004, Test loss: 0.521, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 1.120, Test accuracy: 74.00 

Round  12, Train loss: 0.021, Test loss: 0.525, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.096, Test accuracy: 78.50 

Round  13, Train loss: 0.008, Test loss: 0.597, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.911, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 76.00 

Round  14, Train loss: 0.000, Test loss: 0.533, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.226, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 73.00 

Round  15, Train loss: 0.002, Test loss: 0.621, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.231, Test accuracy: 73.00 

Round  16, Train loss: 0.006, Test loss: 0.645, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 77.00 

Round  17, Train loss: 0.000, Test loss: 0.585, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.174, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.785, Test accuracy: 79.00 

Round  18, Train loss: 0.006, Test loss: 0.562, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.157, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.243, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 77.00 

Round  19, Train loss: 0.000, Test loss: 0.562, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.210, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 77.00 

Final Round, Train loss: 0.001, Test loss: 0.564, Test accuracy: 84.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.471, Train accuracy: 78.500, Test loss: 0.515, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.243, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.562, Train accuracy: 71.000, Test loss: 0.657, Test accuracy: 66.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.067, Train accuracy: 99.000, Test loss: 0.766, Test accuracy: 74.00 

Round   0, Train loss: 0.024, Test loss: 0.540, Test accuracy: 80.33 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.224, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.332, Train accuracy: 84.000, Test loss: 0.606, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.086, Train accuracy: 97.000, Test loss: 0.766, Test accuracy: 77.00 

Round   1, Train loss: 0.029, Test loss: 0.549, Test accuracy: 81.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.207, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.119, Train accuracy: 97.500, Test loss: 0.640, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.060, Train accuracy: 98.000, Test loss: 0.731, Test accuracy: 79.50 

Round   2, Train loss: 0.020, Test loss: 0.600, Test accuracy: 82.83 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.064, Train accuracy: 97.500, Test loss: 0.659, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.070, Train accuracy: 97.000, Test loss: 0.827, Test accuracy: 80.50 

Round   3, Train loss: 0.024, Test loss: 0.561, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.917, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 71.50 

        train local model (freeze embeding):client   2,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 0.714, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.103, Train accuracy: 97.000, Test loss: 1.160, Test accuracy: 75.50 

Round   4, Train loss: 0.035, Test loss: 0.617, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.186, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.193, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.925, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.045, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 0.796, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.691, Test accuracy: 81.50 

Round   5, Train loss: 0.014, Test loss: 0.619, Test accuracy: 82.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.755, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 96.000, Test loss: 1.060, Test accuracy: 74.00 

Round   6, Train loss: 0.028, Test loss: 0.639, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.198, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.259, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.177, Test accuracy: 69.50 

        train local model (freeze embeding):client   2,  Train loss: 0.055, Train accuracy: 98.000, Test loss: 0.844, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.058, Train accuracy: 98.000, Test loss: 0.830, Test accuracy: 77.50 

Round   7, Train loss: 0.024, Test loss: 0.581, Test accuracy: 83.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.195, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.814, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.099, Train accuracy: 96.000, Test loss: 0.941, Test accuracy: 79.00 

Round   8, Train loss: 0.033, Test loss: 0.697, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.821, Test accuracy: 77.00 

Round   9, Train loss: 0.011, Test loss: 0.697, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 0.895, Test accuracy: 77.50 

Round  10, Train loss: 0.015, Test loss: 0.671, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.230, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.50 

Round  11, Train loss: 0.002, Test loss: 0.678, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 1.032, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 1.060, Test accuracy: 79.00 

Round  12, Train loss: 0.018, Test loss: 0.659, Test accuracy: 82.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.257, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 97.500, Test loss: 0.949, Test accuracy: 79.00 

Round  13, Train loss: 0.021, Test loss: 0.639, Test accuracy: 84.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.198, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.784, Test accuracy: 79.00 

Round  14, Train loss: 0.009, Test loss: 0.641, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.207, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.747, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.056, Train accuracy: 97.000, Test loss: 0.801, Test accuracy: 81.50 

Round  15, Train loss: 0.019, Test loss: 0.641, Test accuracy: 83.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.230, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 99.500, Test loss: 1.553, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.014, Test accuracy: 80.50 

Round  16, Train loss: 0.023, Test loss: 0.781, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.230, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.229, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 84.50 

Round  17, Train loss: 0.002, Test loss: 0.783, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.261, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.097, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 79.00 

Round  18, Train loss: 0.000, Test loss: 0.766, Test accuracy: 83.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.217, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 97.000, Test loss: 1.049, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 81.00 

Round  19, Train loss: 0.024, Test loss: 0.704, Test accuracy: 84.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 81.50 

Final Round, Train loss: 0.001, Test loss: 0.668, Test accuracy: 84.50 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.236, Train accuracy: 91.500, Test loss: 0.347, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.213, Train accuracy: 91.000, Test loss: 0.420, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.471, Test accuracy: 85.50 

Round   0, Train loss: 0.010, Test loss: 0.634, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.274, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.215, Test accuracy: 96.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.814, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.104, Train accuracy: 96.000, Test loss: 0.454, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.00 

Round   1, Train loss: 0.007, Test loss: 0.627, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.243, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 0.360, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 88.50 

Round   2, Train loss: 0.007, Test loss: 0.620, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.237, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.823, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.494, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.511, Test accuracy: 87.50 

Round   3, Train loss: 0.003, Test loss: 0.642, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.495, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.422, Test accuracy: 88.50 

Round   4, Train loss: 0.003, Test loss: 0.626, Test accuracy: 84.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.543, Test accuracy: 90.00 

Round   5, Train loss: 0.001, Test loss: 0.636, Test accuracy: 84.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.187, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.481, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 88.50 

Round   6, Train loss: 0.002, Test loss: 0.622, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.226, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 83.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.471, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 88.50 

Round   7, Train loss: 0.001, Test loss: 0.595, Test accuracy: 85.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 0.897, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 88.00 

Round   8, Train loss: 0.011, Test loss: 0.609, Test accuracy: 85.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.107, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 89.00 

Round   9, Train loss: 0.004, Test loss: 0.636, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.235, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.180, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 91.00 

Round  10, Train loss: 0.000, Test loss: 0.614, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.241, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 70.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.111, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 91.00 

Round  11, Train loss: 0.003, Test loss: 0.647, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.189, Test accuracy: 96.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.154, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 90.00 

Round  12, Train loss: 0.002, Test loss: 0.631, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.144, Train accuracy: 94.500, Test loss: 1.250, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 89.50 

Round  13, Train loss: 0.037, Test loss: 0.633, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.190, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.584, Test accuracy: 90.50 

Round  14, Train loss: 0.000, Test loss: 0.647, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.169, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.519, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.025, Test accuracy: 84.00 

Round  15, Train loss: 0.005, Test loss: 0.634, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.249, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.510, Test accuracy: 90.50 

Round  16, Train loss: 0.001, Test loss: 0.610, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.674, Test accuracy: 88.00 

Round  17, Train loss: 0.001, Test loss: 0.627, Test accuracy: 85.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.217, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.542, Test accuracy: 90.00 

Round  18, Train loss: 0.001, Test loss: 0.625, Test accuracy: 86.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.232, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 73.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.067, Train accuracy: 97.500, Test loss: 1.142, Test accuracy: 84.50 

Round  19, Train loss: 0.017, Test loss: 0.696, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.230, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.967, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.541, Test accuracy: 89.50 

Final Round, Train loss: 0.000, Test loss: 0.663, Test accuracy: 85.25 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.421, Train accuracy: 81.500, Test loss: 0.535, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.226, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.183, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.541, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.398, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.575, Train accuracy: 69.000, Test loss: 0.869, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.114, Train accuracy: 96.000, Test loss: 0.804, Test accuracy: 79.00 

Round   0, Train loss: 0.025, Test loss: 0.581, Test accuracy: 83.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.207, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.180, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.480, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.320, Train accuracy: 87.500, Test loss: 0.550, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.500, Test loss: 0.800, Test accuracy: 81.50 

Round   1, Train loss: 0.008, Test loss: 0.610, Test accuracy: 84.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.172, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 97.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.587, Test accuracy: 89.50 

        train local model (freeze embeding):client   4,  Train loss: 0.235, Train accuracy: 89.000, Test loss: 0.623, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 0.878, Test accuracy: 75.50 

Round   2, Train loss: 0.008, Test loss: 0.608, Test accuracy: 85.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.182, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.096, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.155, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.049, Train accuracy: 98.500, Test loss: 1.484, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.480, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.196, Train accuracy: 93.000, Test loss: 1.051, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 98.500, Test loss: 1.001, Test accuracy: 75.50 

Round   3, Train loss: 0.021, Test loss: 0.665, Test accuracy: 84.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.232, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.182, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.133, Train accuracy: 96.000, Test loss: 0.924, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.140, Train accuracy: 93.500, Test loss: 1.635, Test accuracy: 68.50 

Round   4, Train loss: 0.029, Test loss: 0.689, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.043, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.042, Train accuracy: 99.500, Test loss: 0.781, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 0.842, Test accuracy: 78.00 

Round   5, Train loss: 0.010, Test loss: 0.623, Test accuracy: 84.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.136, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   1,  Train loss: 1.242, Train accuracy: 75.500, Test loss: 2.399, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.563, Test accuracy: 87.00 

        train local model (freeze embeding):client   4,  Train loss: 0.035, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 78.00 

Round   6, Train loss: 0.252, Test loss: 0.638, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.195, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.259, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 1.117, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.512, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.055, Train accuracy: 98.000, Test loss: 0.836, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.075, Train accuracy: 97.000, Test loss: 1.013, Test accuracy: 77.50 

Round   7, Train loss: 0.023, Test loss: 0.627, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.842, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.051, Train accuracy: 98.500, Test loss: 0.863, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.840, Test accuracy: 79.00 

Round   8, Train loss: 0.006, Test loss: 0.590, Test accuracy: 85.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.222, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.196, Test accuracy: 96.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.918, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.747, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.387, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.534, Test accuracy: 89.00 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 81.00 

Round   9, Train loss: 0.003, Test loss: 0.608, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.834, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 76.00 

Round  10, Train loss: 0.002, Test loss: 0.616, Test accuracy: 85.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.201, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.151, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.543, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.886, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.291, Train accuracy: 94.000, Test loss: 1.442, Test accuracy: 75.50 

Round  11, Train loss: 0.059, Test loss: 0.631, Test accuracy: 85.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.186, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.172, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 1.037, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.069, Train accuracy: 98.000, Test loss: 1.005, Test accuracy: 75.50 

Round  12, Train loss: 0.023, Test loss: 0.603, Test accuracy: 85.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.145, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.173, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.478, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 89.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.071, Test accuracy: 77.00 

Round  13, Train loss: 0.005, Test loss: 0.651, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.168, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.218, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.840, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.978, Test accuracy: 78.50 

Round  14, Train loss: 0.002, Test loss: 0.625, Test accuracy: 84.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.170, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 89.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 97.500, Test loss: 1.062, Test accuracy: 77.50 

Round  15, Train loss: 0.009, Test loss: 0.642, Test accuracy: 85.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.165, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.257, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.800, Test accuracy: 77.00 

Round  16, Train loss: 0.006, Test loss: 0.634, Test accuracy: 85.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.177, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.189, Test accuracy: 96.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.833, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 81.00 

Round  17, Train loss: 0.002, Test loss: 0.656, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.180, Test accuracy: 96.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.967, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 78.50 

Round  18, Train loss: 0.001, Test loss: 0.685, Test accuracy: 85.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.172, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 96.500, Test loss: 1.283, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 78.50 

Round  19, Train loss: 0.016, Test loss: 0.702, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.166, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.168, Test accuracy: 96.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 74.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.412, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 78.50 

Final Round, Train loss: 0.000, Test loss: 0.681, Test accuracy: 84.80 

Average accuracy final 10 rounds: 431.4041666666666 

2561.942773103714
[8.240462303161621, 16.303499937057495, 24.258551120758057, 32.09333610534668, 40.37061262130737, 49.22046709060669, 57.787076473236084, 66.58999752998352, 75.22740960121155, 84.25392389297485, 92.88243079185486, 101.38227725028992, 110.12585353851318, 118.24982500076294, 126.2703492641449, 134.45864486694336, 142.07526087760925, 149.78258514404297, 157.6750557422638, 165.65470170974731, 171.5214159488678, 179.9984679222107, 187.68921446800232, 195.7679295539856, 204.25963473320007, 212.51623129844666, 220.4254686832428, 229.10058307647705, 237.44660639762878, 244.8896141052246, 252.4004521369934, 260.12113070487976, 268.00922203063965, 276.21844244003296, 284.66163182258606, 292.7489800453186, 300.30289578437805, 307.73861742019653, 315.3725543022156, 322.866414308548, 330.4608678817749, 336.2277801036835, 344.49683809280396, 352.9140594005585, 361.04590344429016, 369.45711374282837, 377.86515855789185, 385.313472032547, 393.01926612854004, 401.15634751319885, 409.3175542354584, 417.1189298629761, 425.7031240463257, 433.3289008140564, 440.9773693084717, 449.3429157733917, 457.75629353523254, 465.6382484436035, 473.07272720336914, 480.9752802848816, 488.577805519104, 496.46809554100037, 501.8642768859863, 509.5087556838989, 517.3494737148285, 525.1023724079132, 532.9434623718262, 541.3627827167511, 548.862893819809, 556.7242240905762, 564.9133477210999, 572.2994747161865, 580.1498556137085, 588.5726878643036, 596.5168633460999, 604.1877422332764, 612.2525951862335, 620.3975598812103, 628.7138650417328, 636.5484108924866, 644.810685634613, 652.9903156757355, 660.8172767162323, 666.6517837047577, 674.3212473392487, 682.0492525100708, 690.2405230998993, 698.152999162674, 706.3486785888672, 714.3899590969086, 722.3737046718597, 730.4472875595093, 738.7357029914856, 747.0983934402466, 755.4837818145752, 763.435081243515, 771.3791229724884, 779.4589357376099, 787.3223803043365, 795.248297214508, 803.3091626167297, 811.1863186359406, 819.3966362476349, 827.4466269016266, 832.7185907363892]
[91.5, 91.5, 94.0, 94.5, 94.5, 94.5, 94.0, 94.5, 93.5, 94.0, 93.0, 96.0, 93.5, 95.5, 95.0, 92.5, 94.0, 92.5, 95.5, 95.5, 95.5, 78.75, 81.5, 81.75, 81.5, 81.0, 79.25, 83.75, 82.25, 81.25, 84.0, 83.25, 83.75, 83.75, 82.25, 85.0, 83.75, 83.0, 83.25, 82.75, 84.5, 84.0, 80.33333333333333, 81.16666666666667, 82.83333333333333, 83.33333333333333, 82.0, 82.33333333333333, 81.0, 83.66666666666667, 81.5, 80.16666666666667, 82.16666666666667, 82.0, 82.33333333333333, 84.16666666666667, 83.16666666666667, 83.66666666666667, 82.66666666666667, 83.16666666666667, 83.66666666666667, 84.16666666666667, 84.5, 84.75, 85.5, 84.75, 84.5, 84.625, 84.625, 84.75, 85.625, 85.375, 85.0, 85.25, 84.5, 85.0, 85.125, 85.5, 85.0, 86.0, 85.625, 86.125, 84.5, 85.25, 83.9, 84.3, 85.7, 84.8, 85.3, 84.2, 84.0, 84.7, 85.8, 85.5, 85.4, 85.2, 85.2, 85.0, 84.6, 85.1, 85.8, 85.5, 85.7, 84.5, 84.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.676, Test loss: 0.661, Test accuracy: 75.30 

Round   0, Global train loss: 0.676, Global test loss: 0.688, Global test accuracy: 53.10 

Round   1, Train loss: 0.540, Test loss: 0.581, Test accuracy: 79.80 

Round   1, Global train loss: 0.540, Global test loss: 0.674, Global test accuracy: 59.80 

Round   2, Train loss: 0.457, Test loss: 0.613, Test accuracy: 77.20 

Round   2, Global train loss: 0.457, Global test loss: 0.678, Global test accuracy: 61.00 

Round   3, Train loss: 0.385, Test loss: 0.628, Test accuracy: 78.50 

Round   3, Global train loss: 0.385, Global test loss: 0.690, Global test accuracy: 50.50 

Round   4, Train loss: 0.339, Test loss: 0.557, Test accuracy: 79.60 

Round   4, Global train loss: 0.339, Global test loss: 0.677, Global test accuracy: 60.30 

Round   5, Train loss: 0.316, Test loss: 0.652, Test accuracy: 76.50 

Round   5, Global train loss: 0.316, Global test loss: 0.680, Global test accuracy: 56.90 

Round   6, Train loss: 0.267, Test loss: 0.836, Test accuracy: 78.30 

Round   6, Global train loss: 0.267, Global test loss: 0.695, Global test accuracy: 51.00 

Round   7, Train loss: 0.235, Test loss: 0.659, Test accuracy: 81.60 

Round   7, Global train loss: 0.235, Global test loss: 0.678, Global test accuracy: 59.60 

Round   8, Train loss: 0.204, Test loss: 0.904, Test accuracy: 74.80 

Round   8, Global train loss: 0.204, Global test loss: 0.699, Global test accuracy: 49.60 

Round   9, Train loss: 0.183, Test loss: 0.696, Test accuracy: 79.50 

Round   9, Global train loss: 0.183, Global test loss: 0.715, Global test accuracy: 49.50 

Round  10, Train loss: 0.158, Test loss: 0.806, Test accuracy: 79.60 

Round  10, Global train loss: 0.158, Global test loss: 0.698, Global test accuracy: 51.70 

Round  11, Train loss: 0.132, Test loss: 0.933, Test accuracy: 78.20 

Round  11, Global train loss: 0.132, Global test loss: 0.719, Global test accuracy: 49.40 

Round  12, Train loss: 0.143, Test loss: 0.944, Test accuracy: 80.90 

Round  12, Global train loss: 0.143, Global test loss: 0.715, Global test accuracy: 49.80 

Round  13, Train loss: 0.099, Test loss: 0.800, Test accuracy: 81.00 

Round  13, Global train loss: 0.099, Global test loss: 0.725, Global test accuracy: 49.20 

Round  14, Train loss: 0.110, Test loss: 0.769, Test accuracy: 81.70 

Round  14, Global train loss: 0.110, Global test loss: 0.746, Global test accuracy: 48.90 

Round  15, Train loss: 0.089, Test loss: 1.021, Test accuracy: 80.10 

Round  15, Global train loss: 0.089, Global test loss: 0.692, Global test accuracy: 52.50 

Round  16, Train loss: 0.077, Test loss: 0.834, Test accuracy: 80.20 

Round  16, Global train loss: 0.077, Global test loss: 0.683, Global test accuracy: 57.30 

Round  17, Train loss: 0.061, Test loss: 0.835, Test accuracy: 81.00 

Round  17, Global train loss: 0.061, Global test loss: 0.683, Global test accuracy: 57.30 

Round  18, Train loss: 0.072, Test loss: 0.876, Test accuracy: 79.50 

Round  18, Global train loss: 0.072, Global test loss: 0.707, Global test accuracy: 49.40 

Round  19, Train loss: 0.059, Test loss: 0.873, Test accuracy: 80.40 

Round  19, Global train loss: 0.059, Global test loss: 0.689, Global test accuracy: 54.70 

Round  20, Train loss: 0.065, Test loss: 0.919, Test accuracy: 79.80 

Round  20, Global train loss: 0.065, Global test loss: 0.685, Global test accuracy: 56.40 

Round  21, Train loss: 0.059, Test loss: 0.847, Test accuracy: 82.20 

Round  21, Global train loss: 0.059, Global test loss: 0.702, Global test accuracy: 52.80 

Round  22, Train loss: 0.039, Test loss: 0.792, Test accuracy: 84.20 

Round  22, Global train loss: 0.039, Global test loss: 0.696, Global test accuracy: 53.80 

Round  23, Train loss: 0.022, Test loss: 0.975, Test accuracy: 82.60 

Round  23, Global train loss: 0.022, Global test loss: 0.685, Global test accuracy: 56.20 

Round  24, Train loss: 0.032, Test loss: 0.792, Test accuracy: 83.20 

Round  24, Global train loss: 0.032, Global test loss: 0.689, Global test accuracy: 56.30 

Round  25, Train loss: 0.045, Test loss: 0.892, Test accuracy: 81.40 

Round  25, Global train loss: 0.045, Global test loss: 0.689, Global test accuracy: 55.80 

Round  26, Train loss: 0.033, Test loss: 0.924, Test accuracy: 81.70 

Round  26, Global train loss: 0.033, Global test loss: 0.684, Global test accuracy: 56.50 

Round  27, Train loss: 0.030, Test loss: 0.853, Test accuracy: 82.50 

Round  27, Global train loss: 0.030, Global test loss: 0.696, Global test accuracy: 54.50 

Round  28, Train loss: 0.014, Test loss: 0.924, Test accuracy: 82.90 

Round  28, Global train loss: 0.014, Global test loss: 0.688, Global test accuracy: 56.10 

Round  29, Train loss: 0.015, Test loss: 0.936, Test accuracy: 81.30 

Round  29, Global train loss: 0.015, Global test loss: 0.682, Global test accuracy: 57.20 

Round  30, Train loss: 0.026, Test loss: 0.883, Test accuracy: 83.70 

Round  30, Global train loss: 0.026, Global test loss: 0.711, Global test accuracy: 52.00 

Round  31, Train loss: 0.025, Test loss: 0.826, Test accuracy: 84.40 

Round  31, Global train loss: 0.025, Global test loss: 0.720, Global test accuracy: 50.30 

Round  32, Train loss: 0.023, Test loss: 1.072, Test accuracy: 81.80 

Round  32, Global train loss: 0.023, Global test loss: 0.718, Global test accuracy: 51.30 

Round  33, Train loss: 0.024, Test loss: 0.817, Test accuracy: 84.90 

Round  33, Global train loss: 0.024, Global test loss: 0.695, Global test accuracy: 54.70 

Round  34, Train loss: 0.016, Test loss: 0.799, Test accuracy: 84.30 

Round  34, Global train loss: 0.016, Global test loss: 0.700, Global test accuracy: 53.50 

Final Round, Train loss: 0.012, Test loss: 0.814, Test accuracy: 85.00 

Final Round, Global train loss: 0.012, Global test loss: 0.700, Global test accuracy: 53.50 

Average accuracy final 10 rounds: 82.88999999999999 

Average global accuracy final 10 rounds: 54.190000000000005 

607.7846615314484
[9.183117866516113, 12.0795316696167, 14.983760595321655, 17.78947377204895, 20.527053833007812, 23.356441736221313, 26.17050313949585, 28.95457696914673, 31.89913773536682, 34.87744212150574, 37.61667037010193, 40.340667724609375, 43.1535530090332, 45.91353154182434, 48.703415870666504, 51.469608783721924, 54.22559213638306, 56.97463417053223, 59.748103618621826, 62.502450704574585, 65.21656346321106, 67.9260106086731, 70.68549036979675, 73.38283133506775, 76.1270694732666, 78.81469082832336, 81.52433133125305, 84.2704074382782, 87.05479025840759, 89.82602548599243, 92.64249396324158, 95.4152557849884, 98.20862483978271, 101.00721526145935, 103.79798078536987, 109.29838633537292]
[75.3, 79.8, 77.2, 78.5, 79.6, 76.5, 78.3, 81.6, 74.8, 79.5, 79.6, 78.2, 80.9, 81.0, 81.7, 80.1, 80.2, 81.0, 79.5, 80.4, 79.8, 82.2, 84.2, 82.6, 83.2, 81.4, 81.7, 82.5, 82.9, 81.3, 83.7, 84.4, 81.8, 84.9, 84.3, 85.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.724, Test loss: 0.650, Test accuracy: 74.50 

Round   0, Global train loss: 0.724, Global test loss: 0.690, Global test accuracy: 52.00 

Round   1, Train loss: 0.613, Test loss: 0.571, Test accuracy: 74.30 

Round   1, Global train loss: 0.613, Global test loss: 0.653, Global test accuracy: 60.60 

Round   2, Train loss: 0.567, Test loss: 0.611, Test accuracy: 71.20 

Round   2, Global train loss: 0.567, Global test loss: 0.630, Global test accuracy: 65.00 

Round   3, Train loss: 0.564, Test loss: 0.564, Test accuracy: 76.20 

Round   3, Global train loss: 0.564, Global test loss: 0.617, Global test accuracy: 66.70 

Round   4, Train loss: 0.509, Test loss: 0.690, Test accuracy: 74.90 

Round   4, Global train loss: 0.509, Global test loss: 0.666, Global test accuracy: 65.50 

Round   5, Train loss: 0.495, Test loss: 0.561, Test accuracy: 77.40 

Round   5, Global train loss: 0.495, Global test loss: 0.607, Global test accuracy: 67.00 

Round   6, Train loss: 0.458, Test loss: 0.659, Test accuracy: 77.40 

Round   6, Global train loss: 0.458, Global test loss: 0.687, Global test accuracy: 66.60 

Round   7, Train loss: 0.459, Test loss: 0.634, Test accuracy: 76.00 

Round   7, Global train loss: 0.459, Global test loss: 0.639, Global test accuracy: 66.70 

Round   8, Train loss: 0.405, Test loss: 0.925, Test accuracy: 74.30 

Round   8, Global train loss: 0.405, Global test loss: 0.777, Global test accuracy: 67.90 

Round   9, Train loss: 0.399, Test loss: 0.540, Test accuracy: 80.50 

Round   9, Global train loss: 0.399, Global test loss: 0.711, Global test accuracy: 67.90 

Round  10, Train loss: 0.376, Test loss: 0.711, Test accuracy: 77.50 

Round  10, Global train loss: 0.376, Global test loss: 0.806, Global test accuracy: 65.80 

Round  11, Train loss: 0.360, Test loss: 0.653, Test accuracy: 79.70 

Round  11, Global train loss: 0.360, Global test loss: 0.754, Global test accuracy: 67.30 

Round  12, Train loss: 0.343, Test loss: 0.586, Test accuracy: 78.80 

Round  12, Global train loss: 0.343, Global test loss: 0.720, Global test accuracy: 66.30 

Round  13, Train loss: 0.292, Test loss: 0.712, Test accuracy: 78.20 

Round  13, Global train loss: 0.292, Global test loss: 0.731, Global test accuracy: 66.90 

Round  14, Train loss: 0.320, Test loss: 0.645, Test accuracy: 78.80 

Round  14, Global train loss: 0.320, Global test loss: 0.713, Global test accuracy: 68.00 

Round  15, Train loss: 0.285, Test loss: 0.715, Test accuracy: 78.50 

Round  15, Global train loss: 0.285, Global test loss: 0.778, Global test accuracy: 66.50 

Round  16, Train loss: 0.277, Test loss: 0.611, Test accuracy: 79.20 

Round  16, Global train loss: 0.277, Global test loss: 0.900, Global test accuracy: 66.00 

Round  17, Train loss: 0.249, Test loss: 0.574, Test accuracy: 79.80 

Round  17, Global train loss: 0.249, Global test loss: 0.799, Global test accuracy: 66.60 

Round  18, Train loss: 0.268, Test loss: 0.584, Test accuracy: 79.40 

Round  18, Global train loss: 0.268, Global test loss: 0.828, Global test accuracy: 68.00 

Round  19, Train loss: 0.264, Test loss: 0.690, Test accuracy: 78.10 

Round  19, Global train loss: 0.264, Global test loss: 0.792, Global test accuracy: 68.20 

Round  20, Train loss: 0.239, Test loss: 0.698, Test accuracy: 80.50 

Round  20, Global train loss: 0.239, Global test loss: 0.792, Global test accuracy: 68.80 

Round  21, Train loss: 0.223, Test loss: 0.608, Test accuracy: 81.80 

Round  21, Global train loss: 0.223, Global test loss: 0.879, Global test accuracy: 68.80 

Round  22, Train loss: 0.211, Test loss: 0.895, Test accuracy: 78.20 

Round  22, Global train loss: 0.211, Global test loss: 0.820, Global test accuracy: 67.70 

Round  23, Train loss: 0.183, Test loss: 0.636, Test accuracy: 81.20 

Round  23, Global train loss: 0.183, Global test loss: 0.963, Global test accuracy: 67.10 

Round  24, Train loss: 0.196, Test loss: 0.729, Test accuracy: 79.90 

Round  24, Global train loss: 0.196, Global test loss: 0.937, Global test accuracy: 67.90 

Round  25, Train loss: 0.156, Test loss: 0.784, Test accuracy: 81.70 

Round  25, Global train loss: 0.156, Global test loss: 0.981, Global test accuracy: 68.00 

Round  26, Train loss: 0.179, Test loss: 0.659, Test accuracy: 82.60 

Round  26, Global train loss: 0.179, Global test loss: 0.862, Global test accuracy: 68.80 

Round  27, Train loss: 0.186, Test loss: 0.571, Test accuracy: 82.50 

Round  27, Global train loss: 0.186, Global test loss: 0.834, Global test accuracy: 69.70 

Round  28, Train loss: 0.152, Test loss: 0.625, Test accuracy: 79.50 

Round  28, Global train loss: 0.152, Global test loss: 0.896, Global test accuracy: 66.80 

Round  29, Train loss: 0.138, Test loss: 0.770, Test accuracy: 79.70 

Round  29, Global train loss: 0.138, Global test loss: 0.920, Global test accuracy: 70.00 

Round  30, Train loss: 0.136, Test loss: 0.816, Test accuracy: 80.80 

Round  30, Global train loss: 0.136, Global test loss: 0.937, Global test accuracy: 69.00 

Round  31, Train loss: 0.143, Test loss: 0.617, Test accuracy: 80.70 

Round  31, Global train loss: 0.143, Global test loss: 0.951, Global test accuracy: 69.00 

Round  32, Train loss: 0.132, Test loss: 1.059, Test accuracy: 79.00 

Round  32, Global train loss: 0.132, Global test loss: 1.060, Global test accuracy: 70.10 

Round  33, Train loss: 0.126, Test loss: 0.739, Test accuracy: 79.40 

Round  33, Global train loss: 0.126, Global test loss: 1.021, Global test accuracy: 68.40 

Round  34, Train loss: 0.107, Test loss: 0.705, Test accuracy: 79.40 

Round  34, Global train loss: 0.107, Global test loss: 0.991, Global test accuracy: 69.80 

Final Round, Train loss: 0.090, Test loss: 0.777, Test accuracy: 80.00 

Final Round, Global train loss: 0.090, Global test loss: 0.991, Global test accuracy: 69.80 

Average accuracy final 10 rounds: 80.53 

Average global accuracy final 10 rounds: 68.96 

596.6727492809296
[9.004419565200806, 11.688595533370972, 14.425997734069824, 17.13989806175232, 19.812737703323364, 22.533823490142822, 25.233418941497803, 27.910324096679688, 30.585864543914795, 33.3118679523468, 35.99583864212036, 38.736470460891724, 41.41420078277588, 44.13077139854431, 46.846983909606934, 49.55132794380188, 52.27268385887146, 54.95269703865051, 57.68176817893982, 60.4043755531311, 63.09127616882324, 65.78800463676453, 68.57320833206177, 71.31153631210327, 74.05271768569946, 76.78726053237915, 79.52685809135437, 82.24243927001953, 84.95453548431396, 87.70796155929565, 90.47412586212158, 93.22606682777405, 95.92955708503723, 98.67615795135498, 101.380038022995, 106.82595443725586]
[74.5, 74.3, 71.2, 76.2, 74.9, 77.4, 77.4, 76.0, 74.3, 80.5, 77.5, 79.7, 78.8, 78.2, 78.8, 78.5, 79.2, 79.8, 79.4, 78.1, 80.5, 81.8, 78.2, 81.2, 79.9, 81.7, 82.6, 82.5, 79.5, 79.7, 80.8, 80.7, 79.0, 79.4, 79.4, 80.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.855, Test loss: 1.060, Test accuracy: 50.00 

Round   1, Train loss: 0.710, Test loss: 0.775, Test accuracy: 54.20 

Round   2, Train loss: 0.617, Test loss: 0.616, Test accuracy: 63.60 

Round   3, Train loss: 0.583, Test loss: 0.759, Test accuracy: 59.00 

Round   4, Train loss: 0.564, Test loss: 0.771, Test accuracy: 63.00 

Round   5, Train loss: 0.537, Test loss: 0.484, Test accuracy: 75.50 

Round   6, Train loss: 0.499, Test loss: 0.646, Test accuracy: 71.10 

Round   7, Train loss: 0.516, Test loss: 0.749, Test accuracy: 69.00 

Round   8, Train loss: 0.486, Test loss: 0.699, Test accuracy: 67.80 

Round   9, Train loss: 0.450, Test loss: 0.503, Test accuracy: 76.00 

Round  10, Train loss: 0.422, Test loss: 0.494, Test accuracy: 77.30 

Round  11, Train loss: 0.413, Test loss: 0.493, Test accuracy: 76.20 

Round  12, Train loss: 0.399, Test loss: 0.667, Test accuracy: 71.00 

Round  13, Train loss: 0.387, Test loss: 0.547, Test accuracy: 75.60 

Round  14, Train loss: 0.372, Test loss: 0.534, Test accuracy: 76.50 

Round  15, Train loss: 0.363, Test loss: 0.556, Test accuracy: 76.00 

Round  16, Train loss: 0.348, Test loss: 0.501, Test accuracy: 77.50 

Round  17, Train loss: 0.344, Test loss: 0.563, Test accuracy: 76.50 

Round  18, Train loss: 0.321, Test loss: 0.463, Test accuracy: 80.20 

Round  19, Train loss: 0.303, Test loss: 0.524, Test accuracy: 77.90 

Round  20, Train loss: 0.318, Test loss: 0.575, Test accuracy: 77.20 

Round  21, Train loss: 0.305, Test loss: 0.754, Test accuracy: 72.20 

Round  22, Train loss: 0.278, Test loss: 0.510, Test accuracy: 78.30 

Round  23, Train loss: 0.282, Test loss: 0.572, Test accuracy: 77.90 

Round  24, Train loss: 0.267, Test loss: 0.638, Test accuracy: 76.50 

Round  25, Train loss: 0.252, Test loss: 0.535, Test accuracy: 79.70 

Round  26, Train loss: 0.246, Test loss: 0.571, Test accuracy: 79.10 

Round  27, Train loss: 0.237, Test loss: 0.510, Test accuracy: 79.50 

Round  28, Train loss: 0.236, Test loss: 0.544, Test accuracy: 79.20 

Round  29, Train loss: 0.205, Test loss: 0.526, Test accuracy: 80.50 

Round  30, Train loss: 0.182, Test loss: 0.526, Test accuracy: 80.90 

Round  31, Train loss: 0.193, Test loss: 0.621, Test accuracy: 79.60 

Round  32, Train loss: 0.200, Test loss: 0.538, Test accuracy: 80.10 

Round  33, Train loss: 0.182, Test loss: 0.518, Test accuracy: 80.50 

Round  34, Train loss: 0.168, Test loss: 0.565, Test accuracy: 80.00 

Round  35, Train loss: 0.164, Test loss: 0.521, Test accuracy: 81.30 

Round  36, Train loss: 0.151, Test loss: 0.531, Test accuracy: 80.20 

Round  37, Train loss: 0.140, Test loss: 0.554, Test accuracy: 81.20 

Round  38, Train loss: 0.149, Test loss: 0.565, Test accuracy: 79.70 

Round  39, Train loss: 0.127, Test loss: 0.555, Test accuracy: 81.30 

Round  40, Train loss: 0.148, Test loss: 0.550, Test accuracy: 81.90 

Round  41, Train loss: 0.118, Test loss: 0.566, Test accuracy: 82.00 

Round  42, Train loss: 0.126, Test loss: 0.599, Test accuracy: 79.90 

Round  43, Train loss: 0.116, Test loss: 0.603, Test accuracy: 80.40 

Round  44, Train loss: 0.126, Test loss: 0.652, Test accuracy: 79.70 

Round  45, Train loss: 0.119, Test loss: 0.594, Test accuracy: 81.70 

Round  46, Train loss: 0.102, Test loss: 0.559, Test accuracy: 82.80 

Round  47, Train loss: 0.100, Test loss: 0.576, Test accuracy: 81.60 

Round  48, Train loss: 0.092, Test loss: 0.658, Test accuracy: 79.70 

Round  49, Train loss: 0.109, Test loss: 0.560, Test accuracy: 81.50 

Final Round, Train loss: 0.059, Test loss: 0.582, Test accuracy: 81.30 

Average accuracy final 10 rounds: 81.12 

627.6909675598145
[8.46907663345337, 10.726170539855957, 12.954442024230957, 15.0890212059021, 17.439379692077637, 19.720229387283325, 22.020797729492188, 24.301517486572266, 26.461159229278564, 28.69127607345581, 30.982083082199097, 33.18063521385193, 35.454198360443115, 37.74645972251892, 39.95652914047241, 42.136744260787964, 44.352556228637695, 46.577412605285645, 48.86513018608093, 51.116835832595825, 53.412474155426025, 55.64601397514343, 57.896647214889526, 60.204835653305054, 62.456594705581665, 64.71514439582825, 66.97662711143494, 69.21295070648193, 71.39967799186707, 73.55127048492432, 75.82133889198303, 78.06843042373657, 80.27239847183228, 82.57702088356018, 84.84440851211548, 87.06289649009705, 89.25360417366028, 91.4797191619873, 93.68790316581726, 95.87321925163269, 98.12410855293274, 100.34193968772888, 102.54770469665527, 104.57912158966064, 106.8210060596466, 109.0821225643158, 111.34387278556824, 113.64075088500977, 115.95034575462341, 118.23080611228943, 121.17393946647644]
[50.0, 54.2, 63.6, 59.0, 63.0, 75.5, 71.1, 69.0, 67.8, 76.0, 77.3, 76.2, 71.0, 75.6, 76.5, 76.0, 77.5, 76.5, 80.2, 77.9, 77.2, 72.2, 78.3, 77.9, 76.5, 79.7, 79.1, 79.5, 79.2, 80.5, 80.9, 79.6, 80.1, 80.5, 80.0, 81.3, 80.2, 81.2, 79.7, 81.3, 81.9, 82.0, 79.9, 80.4, 79.7, 81.7, 82.8, 81.6, 79.7, 81.5, 81.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.835, Test loss: 1.159, Test accuracy: 50.00
Round   1, Train loss: 0.690, Test loss: 0.874, Test accuracy: 52.00
Round   2, Train loss: 0.645, Test loss: 1.049, Test accuracy: 53.00
Round   3, Train loss: 0.586, Test loss: 0.753, Test accuracy: 63.80
Round   4, Train loss: 0.546, Test loss: 0.581, Test accuracy: 70.80
Round   5, Train loss: 0.551, Test loss: 0.771, Test accuracy: 62.30
Round   6, Train loss: 0.530, Test loss: 0.617, Test accuracy: 68.50
Round   7, Train loss: 0.504, Test loss: 0.682, Test accuracy: 64.40
Round   8, Train loss: 0.460, Test loss: 0.577, Test accuracy: 71.10
Round   9, Train loss: 0.462, Test loss: 0.668, Test accuracy: 69.50
Round  10, Train loss: 0.456, Test loss: 0.501, Test accuracy: 74.40
Round  11, Train loss: 0.421, Test loss: 0.619, Test accuracy: 73.70
Round  12, Train loss: 0.386, Test loss: 0.568, Test accuracy: 73.10
Round  13, Train loss: 0.385, Test loss: 0.535, Test accuracy: 75.90
Round  14, Train loss: 0.363, Test loss: 0.438, Test accuracy: 78.40
Round  15, Train loss: 0.355, Test loss: 0.468, Test accuracy: 78.00
Round  16, Train loss: 0.342, Test loss: 0.514, Test accuracy: 76.90
Round  17, Train loss: 0.336, Test loss: 0.472, Test accuracy: 77.40
Round  18, Train loss: 0.327, Test loss: 0.587, Test accuracy: 77.20
Round  19, Train loss: 0.333, Test loss: 0.626, Test accuracy: 76.50
Round  20, Train loss: 0.310, Test loss: 0.492, Test accuracy: 77.40
Round  21, Train loss: 0.285, Test loss: 0.487, Test accuracy: 77.40
Round  22, Train loss: 0.271, Test loss: 0.481, Test accuracy: 79.90
Round  23, Train loss: 0.255, Test loss: 0.447, Test accuracy: 80.50
Round  24, Train loss: 0.246, Test loss: 0.461, Test accuracy: 80.40
Round  25, Train loss: 0.240, Test loss: 0.486, Test accuracy: 77.20
Round  26, Train loss: 0.208, Test loss: 0.444, Test accuracy: 79.60
Round  27, Train loss: 0.226, Test loss: 0.451, Test accuracy: 81.80
Round  28, Train loss: 0.203, Test loss: 0.507, Test accuracy: 79.00
Round  29, Train loss: 0.190, Test loss: 0.479, Test accuracy: 79.60
Round  30, Train loss: 0.203, Test loss: 0.498, Test accuracy: 80.50
Round  31, Train loss: 0.182, Test loss: 0.521, Test accuracy: 79.60
Round  32, Train loss: 0.174, Test loss: 0.485, Test accuracy: 81.30
Round  33, Train loss: 0.174, Test loss: 0.492, Test accuracy: 80.60
Round  34, Train loss: 0.147, Test loss: 0.517, Test accuracy: 81.40
Round  35, Train loss: 0.162, Test loss: 0.471, Test accuracy: 81.60
Round  36, Train loss: 0.144, Test loss: 0.465, Test accuracy: 80.60
Round  37, Train loss: 0.143, Test loss: 0.463, Test accuracy: 81.50
Round  38, Train loss: 0.119, Test loss: 0.593, Test accuracy: 78.30
Round  39, Train loss: 0.134, Test loss: 0.534, Test accuracy: 79.50
Round  40, Train loss: 0.115, Test loss: 0.533, Test accuracy: 81.10
Round  41, Train loss: 0.108, Test loss: 0.562, Test accuracy: 80.60
Round  42, Train loss: 0.106, Test loss: 0.529, Test accuracy: 81.70
Round  43, Train loss: 0.118, Test loss: 0.559, Test accuracy: 81.60
Round  44, Train loss: 0.093, Test loss: 0.509, Test accuracy: 82.20
Round  45, Train loss: 0.100, Test loss: 0.519, Test accuracy: 82.60
Round  46, Train loss: 0.089, Test loss: 0.530, Test accuracy: 81.60
Round  47, Train loss: 0.076, Test loss: 0.512, Test accuracy: 82.50
Round  48, Train loss: 0.097, Test loss: 0.527, Test accuracy: 82.00
Round  49, Train loss: 0.073, Test loss: 0.535, Test accuracy: 82.20
Final Round, Train loss: 0.047, Test loss: 0.512, Test accuracy: 82.30
Average accuracy final 10 rounds: 81.81
765.8801128864288
[9.402101755142212, 12.35162615776062, 15.090377569198608, 18.025204181671143, 20.693401336669922, 23.74978494644165, 26.7522292137146, 29.39838433265686, 32.19788718223572, 35.109747886657715, 37.77381610870361, 40.466500997543335, 43.44103789329529, 46.37697720527649, 49.06255102157593, 52.048553705215454, 55.09561610221863, 57.956154346466064, 60.913737297058105, 63.78009486198425, 66.52118015289307, 69.15905356407166, 71.78643655776978, 74.42465543746948, 77.02851247787476, 79.74670386314392, 82.60625147819519, 85.45633697509766, 88.34123873710632, 91.24246788024902, 94.06135559082031, 96.78209161758423, 99.4858512878418, 102.18556618690491, 104.97725749015808, 107.60189437866211, 110.23399090766907, 112.83343839645386, 115.64699006080627, 118.55007719993591, 121.54191589355469, 124.53550553321838, 127.4805076122284, 130.41757702827454, 133.1604871749878, 136.01182198524475, 138.87160515785217, 141.7310037612915, 144.41348004341125, 147.1356122493744, 150.337739944458]
[50.0, 52.0, 53.0, 63.8, 70.8, 62.3, 68.5, 64.4, 71.1, 69.5, 74.4, 73.7, 73.1, 75.9, 78.4, 78.0, 76.9, 77.4, 77.2, 76.5, 77.4, 77.4, 79.9, 80.5, 80.4, 77.2, 79.6, 81.8, 79.0, 79.6, 80.5, 79.6, 81.3, 80.6, 81.4, 81.6, 80.6, 81.5, 78.3, 79.5, 81.1, 80.6, 81.7, 81.6, 82.2, 82.6, 81.6, 82.5, 82.0, 82.2, 82.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.187, Train accuracy: 92.500, Test loss: 0.812, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.112, Train accuracy: 97.000, Test loss: 0.833, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.432, Train accuracy: 87.000, Test loss: 1.420, Test accuracy: 73.00 

Round   0, Train loss: 0.432, Test loss: 1.420, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.158, Train accuracy: 93.500, Test loss: 0.817, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.279, Train accuracy: 89.500, Test loss: 1.114, Test accuracy: 74.00 

Round   1, Train loss: 0.279, Test loss: 1.114, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.083, Train accuracy: 97.500, Test loss: 0.783, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 78.50 

Round   2, Train loss: 0.020, Test loss: 0.771, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.052, Train accuracy: 99.000, Test loss: 0.768, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.945, Test accuracy: 75.00 

Round   3, Train loss: 0.034, Test loss: 0.945, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.926, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 99.000, Test loss: 0.878, Test accuracy: 78.00 

Round   4, Train loss: 0.044, Test loss: 0.878, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 98.000, Test loss: 0.843, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 79.00 

Round   5, Train loss: 0.006, Test loss: 0.912, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.809, Test accuracy: 77.50 

Round   6, Train loss: 0.004, Test loss: 0.809, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 78.50 

Round   7, Train loss: 0.006, Test loss: 0.926, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 0.913, Test accuracy: 77.50 

Round   8, Train loss: 0.029, Test loss: 0.913, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 79.50 

Round   9, Train loss: 0.002, Test loss: 0.954, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 0.929, Test accuracy: 78.50 

Round  10, Train loss: 0.014, Test loss: 0.929, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.882, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 77.00 

Round  11, Train loss: 0.004, Test loss: 0.883, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 80.50 

Round  12, Train loss: 0.001, Test loss: 0.844, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 77.00 

Round  13, Train loss: 0.001, Test loss: 1.245, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 78.50 

Round  14, Train loss: 0.000, Test loss: 1.206, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 77.00 

Round  15, Train loss: 0.001, Test loss: 1.001, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 80.50 

Round  16, Train loss: 0.002, Test loss: 0.892, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 79.00 

Round  17, Train loss: 0.001, Test loss: 1.050, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.041, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.176, Test accuracy: 74.50 

Round  18, Train loss: 0.003, Test loss: 1.176, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.130, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 79.00 

Round  19, Train loss: 0.001, Test loss: 0.952, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 79.00 

Final Round, Train loss: 0.003, Test loss: 0.973, Test accuracy: 79.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.413, Train accuracy: 80.500, Test loss: 0.368, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.354, Train accuracy: 85.000, Test loss: 0.326, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.064, Train accuracy: 98.000, Test loss: 0.313, Test accuracy: 91.00 

Round   0, Train loss: 0.032, Test loss: 0.699, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.304, Train accuracy: 86.500, Test loss: 0.516, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.000, Test loss: 0.377, Test accuracy: 88.00 

Round   1, Train loss: 0.027, Test loss: 0.634, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.068, Train accuracy: 99.000, Test loss: 0.235, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.059, Train accuracy: 99.000, Test loss: 0.287, Test accuracy: 87.50 

Round   2, Train loss: 0.030, Test loss: 0.584, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.920, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 0.232, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 88.50 

Round   3, Train loss: 0.006, Test loss: 0.607, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.207, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.380, Test accuracy: 87.50 

Round   4, Train loss: 0.008, Test loss: 0.666, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 1.029, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.269, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

Round   5, Train loss: 0.002, Test loss: 0.628, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.138, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 89.00 

Round   6, Train loss: 0.005, Test loss: 0.666, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 89.50 

Round   7, Train loss: 0.001, Test loss: 0.624, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 91.50 

Round   8, Train loss: 0.001, Test loss: 0.690, Test accuracy: 85.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.933, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.235, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.329, Test accuracy: 89.00 

Round   9, Train loss: 0.003, Test loss: 0.667, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 89.00 

Round  10, Train loss: 0.003, Test loss: 0.697, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.247, Train accuracy: 90.000, Test loss: 1.486, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.241, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 91.00 

Round  11, Train loss: 0.124, Test loss: 0.584, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 91.50 

Round  12, Train loss: 0.002, Test loss: 0.692, Test accuracy: 85.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.242, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 89.50 

Round  13, Train loss: 0.001, Test loss: 0.649, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.025, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 88.00 

Round  14, Train loss: 0.001, Test loss: 0.696, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 90.50 

Round  15, Train loss: 0.001, Test loss: 0.681, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.061, Train accuracy: 97.000, Test loss: 1.217, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 92.50 

Round  16, Train loss: 0.031, Test loss: 0.683, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 91.50 

Round  17, Train loss: 0.000, Test loss: 0.615, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.497, Test accuracy: 87.50 

Round  18, Train loss: 0.009, Test loss: 0.693, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 91.50 

Round  19, Train loss: 0.000, Test loss: 0.641, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.283, Test accuracy: 91.50 

Final Round, Train loss: 0.000, Test loss: 0.636, Test accuracy: 86.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.634, Train accuracy: 66.000, Test loss: 0.812, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.551, Train accuracy: 73.000, Test loss: 0.680, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.250, Train accuracy: 89.500, Test loss: 0.831, Test accuracy: 76.00 

Round   0, Train loss: 0.083, Test loss: 0.695, Test accuracy: 79.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.295, Train accuracy: 91.000, Test loss: 0.640, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.307, Train accuracy: 87.500, Test loss: 1.047, Test accuracy: 75.50 

Round   1, Train loss: 0.102, Test loss: 0.708, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.933, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.195, Train accuracy: 95.000, Test loss: 0.691, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.086, Train accuracy: 96.500, Test loss: 0.891, Test accuracy: 75.50 

Round   2, Train loss: 0.031, Test loss: 0.691, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.131, Train accuracy: 95.500, Test loss: 0.706, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 0.942, Test accuracy: 73.00 

Round   3, Train loss: 0.018, Test loss: 0.726, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.111, Train accuracy: 96.500, Test loss: 0.780, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.091, Train accuracy: 95.500, Test loss: 0.837, Test accuracy: 74.00 

Round   4, Train loss: 0.031, Test loss: 0.721, Test accuracy: 79.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.049, Train accuracy: 98.500, Test loss: 0.763, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.087, Test accuracy: 72.50 

Round   5, Train loss: 0.009, Test loss: 0.726, Test accuracy: 80.33 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.890, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.084, Test accuracy: 72.50 

Round   6, Train loss: 0.011, Test loss: 0.718, Test accuracy: 81.83 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.986, Test accuracy: 76.00 

Round   7, Train loss: 0.008, Test loss: 0.778, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.107, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.179, Train accuracy: 95.500, Test loss: 2.201, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 1.045, Test accuracy: 73.50 

Round   8, Train loss: 0.071, Test loss: 0.938, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.961, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 1.145, Test accuracy: 74.00 

Round   9, Train loss: 0.017, Test loss: 0.749, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.700, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.678, Test accuracy: 70.50 

Round  10, Train loss: 0.014, Test loss: 0.830, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.446, Train accuracy: 85.000, Test loss: 1.800, Test accuracy: 69.00 

Round  11, Train loss: 0.149, Test loss: 0.762, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.292, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 75.00 

Round  12, Train loss: 0.001, Test loss: 0.809, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.521, Train accuracy: 84.500, Test loss: 1.714, Test accuracy: 63.50 

Round  13, Train loss: 0.174, Test loss: 0.829, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.202, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 1.048, Test accuracy: 74.50 

Round  14, Train loss: 0.012, Test loss: 0.759, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.284, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.956, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.156, Train accuracy: 94.500, Test loss: 1.322, Test accuracy: 71.50 

Round  15, Train loss: 0.052, Test loss: 0.766, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 77.50 

Round  16, Train loss: 0.002, Test loss: 0.772, Test accuracy: 81.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.155, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 76.00 

Round  17, Train loss: 0.001, Test loss: 0.800, Test accuracy: 81.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 75.00 

Round  18, Train loss: 0.000, Test loss: 0.777, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.290, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.309, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 76.50 

Round  19, Train loss: 0.003, Test loss: 0.791, Test accuracy: 81.17 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.977, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.186, Test accuracy: 76.00 

Final Round, Train loss: 0.001, Test loss: 0.793, Test accuracy: 81.17 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.552, Train accuracy: 76.500, Test loss: 0.596, Test accuracy: 68.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.298, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.027, Train accuracy: 98.500, Test loss: 1.781, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.614, Train accuracy: 67.500, Test loss: 0.658, Test accuracy: 65.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.190, Train accuracy: 91.500, Test loss: 0.558, Test accuracy: 79.00 

Round   0, Train loss: 0.054, Test loss: 0.773, Test accuracy: 80.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 98.500, Test loss: 0.542, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 1.061, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.343, Train accuracy: 85.000, Test loss: 0.507, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.108, Train accuracy: 95.500, Test loss: 0.818, Test accuracy: 74.50 

Round   1, Train loss: 0.037, Test loss: 0.811, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.186, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.223, Train accuracy: 92.500, Test loss: 0.541, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.079, Train accuracy: 97.000, Test loss: 0.892, Test accuracy: 77.00 

Round   2, Train loss: 0.020, Test loss: 0.812, Test accuracy: 80.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.129, Train accuracy: 97.500, Test loss: 0.569, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 0.848, Test accuracy: 77.00 

Round   3, Train loss: 0.010, Test loss: 0.803, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.107, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 1.260, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.109, Train accuracy: 97.000, Test loss: 0.664, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.119, Test accuracy: 73.50 

Round   4, Train loss: 0.020, Test loss: 0.810, Test accuracy: 81.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 1.377, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 0.696, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 0.764, Test accuracy: 76.50 

Round   5, Train loss: 0.020, Test loss: 0.808, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.143, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.121, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.035, Train accuracy: 99.500, Test loss: 0.745, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 71.50 

Round   6, Train loss: 0.012, Test loss: 0.824, Test accuracy: 79.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 1.757, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 72.50 

        train local model (freeze embeding):client   3,  Train loss: 0.042, Train accuracy: 99.500, Test loss: 0.749, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.985, Test accuracy: 72.50 

Round   7, Train loss: 0.018, Test loss: 0.868, Test accuracy: 79.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 1.474, Test accuracy: 68.00 

Round   8, Train loss: 0.013, Test loss: 0.889, Test accuracy: 80.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.231, Train accuracy: 95.000, Test loss: 0.790, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 1.172, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.853, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.043, Train accuracy: 99.500, Test loss: 0.985, Test accuracy: 73.50 

Round   9, Train loss: 0.075, Test loss: 0.878, Test accuracy: 77.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.097, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.138, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.131, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 76.00 

Round  10, Train loss: 0.003, Test loss: 0.934, Test accuracy: 78.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.123, Train accuracy: 93.500, Test loss: 1.324, Test accuracy: 75.00 

Round  11, Train loss: 0.032, Test loss: 0.889, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.246, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.210, Test accuracy: 68.00 

Round  12, Train loss: 0.005, Test loss: 0.919, Test accuracy: 79.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.500, Test loss: 1.530, Test accuracy: 72.00 

Round  13, Train loss: 0.020, Test loss: 0.885, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.127, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.037, Train accuracy: 99.500, Test loss: 1.149, Test accuracy: 73.50 

Round  14, Train loss: 0.014, Test loss: 0.897, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.151, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.194, Test accuracy: 73.00 

Round  15, Train loss: 0.009, Test loss: 0.890, Test accuracy: 80.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.096, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.315, Train accuracy: 87.500, Test loss: 2.123, Test accuracy: 68.50 

Round  16, Train loss: 0.079, Test loss: 0.867, Test accuracy: 80.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.189, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.967, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 71.50 

Round  17, Train loss: 0.001, Test loss: 0.893, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 79.50 

Round  18, Train loss: 0.002, Test loss: 0.895, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.029, Test accuracy: 75.00 

Round  19, Train loss: 0.010, Test loss: 0.874, Test accuracy: 81.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.091, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 79.50 

Final Round, Train loss: 0.001, Test loss: 0.876, Test accuracy: 81.25 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.209, Train accuracy: 92.500, Test loss: 0.261, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.387, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.933, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 72.50 

        train local model (freeze embeding):client   4,  Train loss: 0.187, Train accuracy: 93.500, Test loss: 0.227, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 92.50 

Round   0, Train loss: 0.003, Test loss: 0.733, Test accuracy: 82.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.029, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 76.00 

        train local model (freeze embeding):client   4,  Train loss: 0.100, Train accuracy: 96.500, Test loss: 0.234, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.257, Test accuracy: 94.00 

Round   1, Train loss: 0.007, Test loss: 0.712, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.051, Train accuracy: 98.000, Test loss: 1.015, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.096, Train accuracy: 96.500, Test loss: 0.179, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.199, Test accuracy: 94.00 

Round   2, Train loss: 0.012, Test loss: 0.710, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 74.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 73.50 

        train local model (freeze embeding):client   4,  Train loss: 0.040, Train accuracy: 99.500, Test loss: 0.167, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.240, Test accuracy: 91.50 

Round   3, Train loss: 0.002, Test loss: 0.737, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.467, Test accuracy: 73.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 1.267, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.158, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.146, Test accuracy: 94.50 

Round   4, Train loss: 0.011, Test loss: 0.743, Test accuracy: 82.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 72.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.060, Train accuracy: 98.500, Test loss: 1.019, Test accuracy: 76.50 

        train local model (freeze embeding):client   4,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.136, Test accuracy: 94.50 

Round   5, Train loss: 0.016, Test loss: 0.707, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.011, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 98.500, Test loss: 1.406, Test accuracy: 73.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.817, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 75.50 

        train local model (freeze embeding):client   4,  Train loss: 0.034, Train accuracy: 99.500, Test loss: 0.197, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.154, Test accuracy: 93.50 

Round   6, Train loss: 0.007, Test loss: 0.721, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.171, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.201, Train accuracy: 91.500, Test loss: 0.526, Test accuracy: 83.00 

Round   7, Train loss: 0.040, Test loss: 0.776, Test accuracy: 83.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.139, Test accuracy: 95.50 

Round   8, Train loss: 0.001, Test loss: 0.774, Test accuracy: 82.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.977, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.163, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.171, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.217, Test accuracy: 94.00 

Round   9, Train loss: 0.002, Test loss: 0.757, Test accuracy: 82.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.478, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.153, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.149, Train accuracy: 94.500, Test loss: 1.554, Test accuracy: 73.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.143, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.148, Test accuracy: 95.00 

Round  10, Train loss: 0.030, Test loss: 0.783, Test accuracy: 81.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.170, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.147, Test accuracy: 95.50 

Round  11, Train loss: 0.001, Test loss: 0.722, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.232, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.150, Train accuracy: 94.000, Test loss: 1.282, Test accuracy: 71.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.160, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.143, Test accuracy: 94.00 

Round  12, Train loss: 0.032, Test loss: 0.738, Test accuracy: 83.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.208, Train accuracy: 92.000, Test loss: 2.236, Test accuracy: 66.50 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.158, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.098, Test accuracy: 96.00 

Round  13, Train loss: 0.042, Test loss: 0.746, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.197, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.513, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 78.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.150, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.169, Test accuracy: 94.50 

Round  14, Train loss: 0.002, Test loss: 0.733, Test accuracy: 83.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.143, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 74.50 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.180, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 95.00 

Round  15, Train loss: 0.001, Test loss: 0.748, Test accuracy: 83.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.412, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.383, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.351, Test accuracy: 67.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.178, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.161, Test accuracy: 93.50 

Round  16, Train loss: 0.007, Test loss: 0.783, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.290, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.216, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.151, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.152, Test accuracy: 93.00 

Round  17, Train loss: 0.002, Test loss: 0.726, Test accuracy: 83.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 78.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.211, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.157, Test accuracy: 94.50 

Round  18, Train loss: 0.000, Test loss: 0.739, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.053, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.165, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.286, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.220, Test accuracy: 73.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.184, Test accuracy: 94.50 

Round  19, Train loss: 0.002, Test loss: 0.764, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 75.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.183, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.181, Test accuracy: 93.00 

Final Round, Train loss: 0.001, Test loss: 0.750, Test accuracy: 83.40 

Average accuracy final 10 rounds: 407.84250000000003 

2622.0326006412506
[8.009533643722534, 15.698614120483398, 22.994812488555908, 30.780160665512085, 38.72237682342529, 46.52616572380066, 54.266587257385254, 61.99502754211426, 69.89735245704651, 77.6119794845581, 86.03016901016235, 94.02314519882202, 102.04295825958252, 109.9786605834961, 118.05342507362366, 126.02348971366882, 134.2393090724945, 142.0973916053772, 150.0264377593994, 157.8766360282898, 163.2151484489441, 171.19130992889404, 179.06644439697266, 187.21706557273865, 195.39655375480652, 203.64633870124817, 211.6359384059906, 219.6464319229126, 227.5333616733551, 235.49764680862427, 243.5237112045288, 251.72592973709106, 260.0255768299103, 267.9918763637543, 275.98852610588074, 283.86202907562256, 292.00726199150085, 300.2917127609253, 308.47038197517395, 316.349933385849, 324.68888664245605, 330.1684010028839, 338.73655223846436, 347.07419085502625, 355.276912689209, 363.33913135528564, 371.76528668403625, 379.9883041381836, 388.14338278770447, 396.22266268730164, 404.5844087600708, 412.76532793045044, 421.0295555591583, 429.0777771472931, 437.35452604293823, 445.5040936470032, 453.7080588340759, 462.09309697151184, 470.0591974258423, 477.97215962409973, 486.32869815826416, 494.63365840911865, 500.0608968734741, 508.2528302669525, 516.4026913642883, 524.6270635128021, 532.7972247600555, 541.0812714099884, 549.2385323047638, 557.291412115097, 565.3687846660614, 573.531097650528, 581.7866539955139, 590.0018358230591, 598.2784404754639, 606.4161813259125, 614.6022324562073, 622.6738793849945, 631.0263929367065, 639.7416129112244, 648.0630207061768, 656.2998397350311, 664.7666344642639, 670.3372488021851, 678.4400885105133, 686.5813972949982, 694.7803583145142, 702.9389750957489, 711.0042970180511, 719.0741448402405, 727.2519359588623, 735.4946255683899, 743.6441299915314, 751.9842245578766, 760.2568154335022, 768.3444442749023, 776.5770635604858, 784.7352256774902, 792.8968629837036, 800.726203918457, 808.8410704135895, 817.2155075073242, 825.551908493042, 833.8952844142914, 839.380880355835]
[73.0, 74.0, 78.5, 75.0, 78.0, 79.0, 77.5, 78.5, 77.5, 79.5, 78.5, 77.0, 80.5, 77.0, 78.5, 77.0, 80.5, 79.0, 74.5, 79.0, 79.0, 83.25, 84.75, 83.75, 84.25, 84.5, 85.0, 86.25, 86.25, 85.75, 85.5, 86.5, 85.25, 85.75, 85.5, 85.5, 85.0, 84.5, 86.5, 85.0, 86.0, 86.0, 79.16666666666667, 80.16666666666667, 81.66666666666667, 80.0, 79.66666666666667, 80.33333333333333, 81.83333333333333, 80.66666666666667, 79.5, 80.5, 78.0, 80.66666666666667, 80.5, 80.16666666666667, 80.0, 81.5, 81.16666666666667, 81.83333333333333, 82.0, 81.16666666666667, 81.16666666666667, 80.875, 78.5, 80.375, 80.5, 81.125, 81.0, 79.875, 79.375, 80.125, 77.875, 78.375, 80.75, 79.625, 80.75, 80.25, 80.625, 80.375, 79.25, 80.25, 81.375, 81.25, 82.9, 83.6, 83.3, 83.5, 82.4, 83.3, 83.6, 83.1, 82.3, 82.3, 81.9, 83.0, 83.4, 83.3, 83.8, 83.7, 83.0, 83.7, 83.5, 83.5, 83.4]
