nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.574, Test loss: 1.503, Test accuracy: 28.42
Round   0, Global train loss: 1.574, Global test loss: 1.503, Global test accuracy: 28.04
Round   1, Train loss: 1.306, Test loss: 1.158, Test accuracy: 79.66
Round   1, Global train loss: 1.306, Global test loss: 1.071, Global test accuracy: 92.60
Round   2, Train loss: 1.109, Test loss: 1.074, Test accuracy: 87.06
Round   2, Global train loss: 1.109, Global test loss: 1.000, Global test accuracy: 94.62
Round   3, Train loss: 1.075, Test loss: 1.013, Test accuracy: 93.70
Round   3, Global train loss: 1.075, Global test loss: 0.987, Global test accuracy: 94.62
Round   4, Train loss: 0.976, Test loss: 0.989, Test accuracy: 94.76
Round   4, Global train loss: 0.976, Global test loss: 0.971, Global test accuracy: 95.40
Round   5, Train loss: 0.965, Test loss: 0.976, Test accuracy: 94.84
Round   5, Global train loss: 0.965, Global test loss: 0.965, Global test accuracy: 95.56
Round   6, Train loss: 0.932, Test loss: 0.972, Test accuracy: 94.98
Round   6, Global train loss: 0.932, Global test loss: 0.963, Global test accuracy: 95.34
Round   7, Train loss: 0.926, Test loss: 0.970, Test accuracy: 95.06
Round   7, Global train loss: 0.926, Global test loss: 0.953, Global test accuracy: 96.14
Round   8, Train loss: 0.938, Test loss: 0.968, Test accuracy: 95.06
Round   8, Global train loss: 0.938, Global test loss: 0.951, Global test accuracy: 96.16
Round   9, Train loss: 0.924, Test loss: 0.967, Test accuracy: 95.20
Round   9, Global train loss: 0.924, Global test loss: 0.952, Global test accuracy: 96.14
Round  10, Train loss: 0.932, Test loss: 0.965, Test accuracy: 95.24
Round  10, Global train loss: 0.932, Global test loss: 0.954, Global test accuracy: 96.04
Round  11, Train loss: 0.919, Test loss: 0.965, Test accuracy: 95.22
Round  11, Global train loss: 0.919, Global test loss: 0.950, Global test accuracy: 96.12
Round  12, Train loss: 0.921, Test loss: 0.964, Test accuracy: 95.24
Round  12, Global train loss: 0.921, Global test loss: 0.950, Global test accuracy: 96.24
Round  13, Train loss: 0.923, Test loss: 0.963, Test accuracy: 95.18
Round  13, Global train loss: 0.923, Global test loss: 0.952, Global test accuracy: 96.26
Round  14, Train loss: 0.916, Test loss: 0.963, Test accuracy: 95.18
Round  14, Global train loss: 0.916, Global test loss: 0.943, Global test accuracy: 96.82
Round  15, Train loss: 0.915, Test loss: 0.963, Test accuracy: 95.00
Round  15, Global train loss: 0.915, Global test loss: 0.949, Global test accuracy: 95.98
Round  16, Train loss: 0.919, Test loss: 0.962, Test accuracy: 95.04
Round  16, Global train loss: 0.919, Global test loss: 0.951, Global test accuracy: 95.94
Round  17, Train loss: 0.914, Test loss: 0.961, Test accuracy: 94.94
Round  17, Global train loss: 0.914, Global test loss: 0.949, Global test accuracy: 96.24
Round  18, Train loss: 0.919, Test loss: 0.961, Test accuracy: 95.02
Round  18, Global train loss: 0.919, Global test loss: 0.948, Global test accuracy: 96.16
Round  19, Train loss: 0.913, Test loss: 0.961, Test accuracy: 94.96
Round  19, Global train loss: 0.913, Global test loss: 0.947, Global test accuracy: 96.18
Round  20, Train loss: 0.922, Test loss: 0.960, Test accuracy: 94.96
Round  20, Global train loss: 0.922, Global test loss: 0.953, Global test accuracy: 95.70
Round  21, Train loss: 0.912, Test loss: 0.960, Test accuracy: 94.94
Round  21, Global train loss: 0.912, Global test loss: 0.948, Global test accuracy: 96.08
Round  22, Train loss: 0.916, Test loss: 0.960, Test accuracy: 94.94
Round  22, Global train loss: 0.916, Global test loss: 0.953, Global test accuracy: 95.56
Round  23, Train loss: 0.912, Test loss: 0.959, Test accuracy: 95.02
Round  23, Global train loss: 0.912, Global test loss: 0.949, Global test accuracy: 96.00
Round  24, Train loss: 0.914, Test loss: 0.959, Test accuracy: 95.02
Round  24, Global train loss: 0.914, Global test loss: 0.949, Global test accuracy: 96.12
Round  25, Train loss: 0.913, Test loss: 0.958, Test accuracy: 95.00
Round  25, Global train loss: 0.913, Global test loss: 0.946, Global test accuracy: 96.28
Round  26, Train loss: 0.914, Test loss: 0.958, Test accuracy: 95.02
Round  26, Global train loss: 0.914, Global test loss: 0.947, Global test accuracy: 96.10
Round  27, Train loss: 0.909, Test loss: 0.958, Test accuracy: 95.04
Round  27, Global train loss: 0.909, Global test loss: 0.948, Global test accuracy: 95.84
Round  28, Train loss: 0.909, Test loss: 0.958, Test accuracy: 95.08
Round  28, Global train loss: 0.909, Global test loss: 0.948, Global test accuracy: 96.02
Round  29, Train loss: 0.913, Test loss: 0.958, Test accuracy: 95.08
Round  29, Global train loss: 0.913, Global test loss: 0.945, Global test accuracy: 96.38
Round  30, Train loss: 0.916, Test loss: 0.958, Test accuracy: 95.06
Round  30, Global train loss: 0.916, Global test loss: 0.957, Global test accuracy: 95.46
Round  31, Train loss: 0.911, Test loss: 0.958, Test accuracy: 95.04
Round  31, Global train loss: 0.911, Global test loss: 0.950, Global test accuracy: 95.80
Round  32, Train loss: 0.907, Test loss: 0.958, Test accuracy: 95.04
Round  32, Global train loss: 0.907, Global test loss: 0.945, Global test accuracy: 96.26
Round  33, Train loss: 0.910, Test loss: 0.958, Test accuracy: 95.16
Round  33, Global train loss: 0.910, Global test loss: 0.943, Global test accuracy: 96.42
Round  34, Train loss: 0.913, Test loss: 0.957, Test accuracy: 95.22
Round  34, Global train loss: 0.913, Global test loss: 0.951, Global test accuracy: 95.98
Round  35, Train loss: 0.909, Test loss: 0.957, Test accuracy: 95.20
Round  35, Global train loss: 0.909, Global test loss: 0.944, Global test accuracy: 96.22
Round  36, Train loss: 0.913, Test loss: 0.957, Test accuracy: 95.20
Round  36, Global train loss: 0.913, Global test loss: 0.944, Global test accuracy: 96.52
Round  37, Train loss: 0.911, Test loss: 0.957, Test accuracy: 95.20
Round  37, Global train loss: 0.911, Global test loss: 0.948, Global test accuracy: 96.06
Round  38, Train loss: 0.911, Test loss: 0.957, Test accuracy: 95.20
Round  38, Global train loss: 0.911, Global test loss: 0.942, Global test accuracy: 96.64
Round  39, Train loss: 0.910, Test loss: 0.957, Test accuracy: 95.18
Round  39, Global train loss: 0.910, Global test loss: 0.944, Global test accuracy: 96.48
Round  40, Train loss: 0.911, Test loss: 0.956, Test accuracy: 95.20
Round  40, Global train loss: 0.911, Global test loss: 0.945, Global test accuracy: 96.50
Round  41, Train loss: 0.910, Test loss: 0.956, Test accuracy: 95.20
Round  41, Global train loss: 0.910, Global test loss: 0.946, Global test accuracy: 95.96
Round  42, Train loss: 0.913, Test loss: 0.956, Test accuracy: 95.24
Round  42, Global train loss: 0.913, Global test loss: 0.947, Global test accuracy: 96.00
Round  43, Train loss: 0.911, Test loss: 0.956, Test accuracy: 95.28
Round  43, Global train loss: 0.911, Global test loss: 0.950, Global test accuracy: 95.84
Round  44, Train loss: 0.908, Test loss: 0.956, Test accuracy: 95.28
Round  44, Global train loss: 0.908, Global test loss: 0.946, Global test accuracy: 96.12
Round  45, Train loss: 0.911, Test loss: 0.956, Test accuracy: 95.28
Round  45, Global train loss: 0.911, Global test loss: 0.948, Global test accuracy: 96.14
Round  46, Train loss: 0.911, Test loss: 0.956, Test accuracy: 95.28
Round  46, Global train loss: 0.911, Global test loss: 0.949, Global test accuracy: 95.74
Round  47, Train loss: 0.908, Test loss: 0.955, Test accuracy: 95.24
Round  47, Global train loss: 0.908, Global test loss: 0.951, Global test accuracy: 95.62
Round  48, Train loss: 0.910, Test loss: 0.955, Test accuracy: 95.24
Round  48, Global train loss: 0.910, Global test loss: 0.947, Global test accuracy: 96.44
Round  49, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.26
Round  49, Global train loss: 0.909, Global test loss: 0.946, Global test accuracy: 95.96
Round  50, Train loss: 0.910, Test loss: 0.955, Test accuracy: 95.26
Round  50, Global train loss: 0.910, Global test loss: 0.952, Global test accuracy: 95.52
Round  51, Train loss: 0.908, Test loss: 0.955, Test accuracy: 95.26
Round  51, Global train loss: 0.908, Global test loss: 0.946, Global test accuracy: 96.32
Round  52, Train loss: 0.910, Test loss: 0.955, Test accuracy: 95.30
Round  52, Global train loss: 0.910, Global test loss: 0.951, Global test accuracy: 95.64
Round  53, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.28
Round  53, Global train loss: 0.909, Global test loss: 0.946, Global test accuracy: 96.02
Round  54, Train loss: 0.910, Test loss: 0.955, Test accuracy: 95.26
Round  54, Global train loss: 0.910, Global test loss: 0.948, Global test accuracy: 96.14
Round  55, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.26
Round  55, Global train loss: 0.909, Global test loss: 0.945, Global test accuracy: 96.04
Round  56, Train loss: 0.911, Test loss: 0.955, Test accuracy: 95.26
Round  56, Global train loss: 0.911, Global test loss: 0.944, Global test accuracy: 96.24
Round  57, Train loss: 0.910, Test loss: 0.955, Test accuracy: 95.26
Round  57, Global train loss: 0.910, Global test loss: 0.947, Global test accuracy: 96.24
Round  58, Train loss: 0.910, Test loss: 0.955, Test accuracy: 95.28
Round  58, Global train loss: 0.910, Global test loss: 0.951, Global test accuracy: 95.64
Round  59, Train loss: 0.911, Test loss: 0.955, Test accuracy: 95.28
Round  59, Global train loss: 0.911, Global test loss: 0.947, Global test accuracy: 95.96
Round  60, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.28
Round  60, Global train loss: 0.909, Global test loss: 0.947, Global test accuracy: 96.02
Round  61, Train loss: 0.907, Test loss: 0.955, Test accuracy: 95.28
Round  61, Global train loss: 0.907, Global test loss: 0.945, Global test accuracy: 96.28
Round  62, Train loss: 0.908, Test loss: 0.955, Test accuracy: 95.28
Round  62, Global train loss: 0.908, Global test loss: 0.943, Global test accuracy: 96.30
Round  63, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.28
Round  63, Global train loss: 0.909, Global test loss: 0.948, Global test accuracy: 95.84
Round  64, Train loss: 0.908, Test loss: 0.955, Test accuracy: 95.28
Round  64, Global train loss: 0.908, Global test loss: 0.947, Global test accuracy: 96.10
Round  65, Train loss: 0.911, Test loss: 0.955, Test accuracy: 95.26
Round  65, Global train loss: 0.911, Global test loss: 0.945, Global test accuracy: 96.12
Round  66, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.26
Round  66, Global train loss: 0.909, Global test loss: 0.944, Global test accuracy: 96.48
Round  67, Train loss: 0.908, Test loss: 0.955, Test accuracy: 95.26
Round  67, Global train loss: 0.908, Global test loss: 0.948, Global test accuracy: 96.14
Round  68, Train loss: 0.907, Test loss: 0.955, Test accuracy: 95.22
Round  68, Global train loss: 0.907, Global test loss: 0.944, Global test accuracy: 96.24
Round  69, Train loss: 0.909, Test loss: 0.955, Test accuracy: 95.22
Round  69, Global train loss: 0.909, Global test loss: 0.950, Global test accuracy: 95.70
Round  70, Train loss: 0.911, Test loss: 0.954, Test accuracy: 95.22
Round  70, Global train loss: 0.911, Global test loss: 0.948, Global test accuracy: 95.98
Round  71, Train loss: 0.907, Test loss: 0.954, Test accuracy: 95.24
Round  71, Global train loss: 0.907, Global test loss: 0.943, Global test accuracy: 96.32
Round  72, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.26
Round  72, Global train loss: 0.909, Global test loss: 0.947, Global test accuracy: 95.98
Round  73, Train loss: 0.908, Test loss: 0.954, Test accuracy: 95.26
Round  73, Global train loss: 0.908, Global test loss: 0.946, Global test accuracy: 96.16
Round  74, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.26
Round  74, Global train loss: 0.910, Global test loss: 0.946, Global test accuracy: 96.42
Round  75, Train loss: 0.911, Test loss: 0.954, Test accuracy: 95.30
Round  75, Global train loss: 0.911, Global test loss: 0.946, Global test accuracy: 95.92
Round  76, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.32
Round  76, Global train loss: 0.909, Global test loss: 0.945, Global test accuracy: 96.30
Round  77, Train loss: 0.906, Test loss: 0.954, Test accuracy: 95.32
Round  77, Global train loss: 0.906, Global test loss: 0.944, Global test accuracy: 96.26
Round  78, Train loss: 0.907, Test loss: 0.954, Test accuracy: 95.32
Round  78, Global train loss: 0.907, Global test loss: 0.946, Global test accuracy: 96.16
Round  79, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.30
Round  79, Global train loss: 0.909, Global test loss: 0.950, Global test accuracy: 95.60
Round  80, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.32
Round  80, Global train loss: 0.909, Global test loss: 0.944, Global test accuracy: 96.22
Round  81, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.30
Round  81, Global train loss: 0.909, Global test loss: 0.946, Global test accuracy: 96.02
Round  82, Train loss: 0.908, Test loss: 0.954, Test accuracy: 95.30
Round  82, Global train loss: 0.908, Global test loss: 0.948, Global test accuracy: 96.10
Round  83, Train loss: 0.908, Test loss: 0.954, Test accuracy: 95.32
Round  83, Global train loss: 0.908, Global test loss: 0.950, Global test accuracy: 95.70
Round  84, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.32
Round  84, Global train loss: 0.910, Global test loss: 0.946, Global test accuracy: 96.20
Round  85, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.32
Round  85, Global train loss: 0.910, Global test loss: 0.948, Global test accuracy: 95.78
Round  86, Train loss: 0.906, Test loss: 0.954, Test accuracy: 95.32
Round  86, Global train loss: 0.906, Global test loss: 0.943, Global test accuracy: 96.24
Round  87, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.32
Round  87, Global train loss: 0.910, Global test loss: 0.943, Global test accuracy: 96.28
Round  88, Train loss: 0.911, Test loss: 0.954, Test accuracy: 95.34
Round  88, Global train loss: 0.911, Global test loss: 0.946, Global test accuracy: 96.12
Round  89, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.32
Round  89, Global train loss: 0.910, Global test loss: 0.942, Global test accuracy: 96.44
Round  90, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.30
Round  90, Global train loss: 0.910, Global test loss: 0.942, Global test accuracy: 96.60
Round  91, Train loss: 0.911, Test loss: 0.954, Test accuracy: 95.30
Round  91, Global train loss: 0.911, Global test loss: 0.945, Global test accuracy: 96.04
Round  92, Train loss: 0.908, Test loss: 0.954, Test accuracy: 95.30
Round  92, Global train loss: 0.908, Global test loss: 0.942, Global test accuracy: 96.40
Round  93, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.30
Round  93, Global train loss: 0.910, Global test loss: 0.943, Global test accuracy: 96.36
Round  94, Train loss: 0.911, Test loss: 0.954, Test accuracy: 95.30
Round  94, Global train loss: 0.911, Global test loss: 0.949, Global test accuracy: 95.90
Round  95, Train loss: 0.908, Test loss: 0.954, Test accuracy: 95.30
Round  95, Global train loss: 0.908, Global test loss: 0.946, Global test accuracy: 96.16/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 0.908, Test loss: 0.954, Test accuracy: 95.30
Round  96, Global train loss: 0.908, Global test loss: 0.946, Global test accuracy: 96.02
Round  97, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.30
Round  97, Global train loss: 0.909, Global test loss: 0.951, Global test accuracy: 95.78
Round  98, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.28
Round  98, Global train loss: 0.909, Global test loss: 0.947, Global test accuracy: 95.92
Round  99, Train loss: 0.910, Test loss: 0.954, Test accuracy: 95.30
Round  99, Global train loss: 0.910, Global test loss: 0.943, Global test accuracy: 96.30
Final Round, Train loss: 0.909, Test loss: 0.954, Test accuracy: 95.28
Final Round, Global train loss: 0.909, Global test loss: 0.943, Global test accuracy: 96.30
Average accuracy final 10 rounds: 95.298 

Average global accuracy final 10 rounds: 96.14800000000001 

788.1546106338501
[1.2176573276519775, 2.435314655303955, 3.4812426567077637, 4.527170658111572, 5.58990478515625, 6.652638912200928, 7.73614239692688, 8.819645881652832, 9.850271701812744, 10.880897521972656, 11.897695064544678, 12.9144926071167, 13.956018209457397, 14.997543811798096, 16.09721279144287, 17.196881771087646, 18.11241340637207, 19.027945041656494, 20.095216512680054, 21.162487983703613, 22.232149839401245, 23.301811695098877, 24.32476496696472, 25.347718238830566, 26.78685212135315, 28.225986003875732, 29.15622305870056, 30.08646011352539, 31.225346326828003, 32.364232540130615, 33.441620111465454, 34.51900768280029, 35.5826940536499, 36.64638042449951, 37.670395612716675, 38.69441080093384, 39.808534145355225, 40.92265748977661, 41.96502423286438, 43.00739097595215, 44.032421827316284, 45.05745267868042, 46.207008838653564, 47.35656499862671, 48.46122431755066, 49.56588363647461, 50.656442642211914, 51.74700164794922, 52.76524901390076, 53.783496379852295, 54.829911947250366, 55.87632751464844, 56.912444829940796, 57.948562145233154, 59.095059633255005, 60.241557121276855, 61.45440125465393, 62.667245388031006, 63.897812843322754, 65.1283802986145, 66.22887659072876, 67.32937288284302, 68.40250730514526, 69.47564172744751, 70.63383030891418, 71.79201889038086, 72.79708075523376, 73.80214262008667, 74.8452513217926, 75.88836002349854, 77.06692123413086, 78.24548244476318, 79.42272591590881, 80.59996938705444, 81.61055731773376, 82.62114524841309, 83.6443555355072, 84.66756582260132, 85.65922021865845, 86.65087461471558, 87.74268317222595, 88.83449172973633, 89.86890006065369, 90.90330839157104, 92.11674618721008, 93.33018398284912, 94.3747329711914, 95.41928195953369, 96.42080020904541, 97.42231845855713, 98.57430934906006, 99.72630023956299, 100.73600912094116, 101.74571800231934, 102.82283401489258, 103.89995002746582, 104.87481951713562, 105.84968900680542, 106.90225052833557, 107.95481204986572, 109.02578377723694, 110.09675550460815, 111.2020993232727, 112.30744314193726, 113.49835586547852, 114.68926858901978, 115.6453070640564, 116.60134553909302, 117.78534841537476, 118.9693512916565, 119.95826148986816, 120.94717168807983, 121.9194655418396, 122.89175939559937, 123.92829036712646, 124.96482133865356, 126.03341627120972, 127.10201120376587, 128.07321071624756, 129.04441022872925, 130.04189252853394, 131.03937482833862, 132.12221693992615, 133.20505905151367, 134.18524146080017, 135.16542387008667, 136.09697604179382, 137.02852821350098, 138.11345553398132, 139.19838285446167, 140.44584584236145, 141.69330883026123, 142.78304600715637, 143.8727831840515, 144.91408228874207, 145.95538139343262, 146.99302506446838, 148.03066873550415, 149.08183097839355, 150.13299322128296, 151.15983033180237, 152.18666744232178, 153.32946872711182, 154.47227001190186, 155.4820520877838, 156.49183416366577, 157.60619735717773, 158.7205605506897, 159.7476773262024, 160.7747941017151, 161.78884434700012, 162.80289459228516, 163.91205024719238, 165.0212059020996, 166.06975197792053, 167.11829805374146, 168.23846054077148, 169.3586230278015, 170.41617798805237, 171.47373294830322, 172.648530960083, 173.8233289718628, 174.9080843925476, 175.99283981323242, 177.04398679733276, 178.0951337814331, 179.0988540649414, 180.1025743484497, 181.1381688117981, 182.17376327514648, 183.19226694107056, 184.21077060699463, 185.22287487983704, 186.23497915267944, 187.2680447101593, 188.30111026763916, 189.40800213813782, 190.51489400863647, 191.57592368125916, 192.63695335388184, 193.59579133987427, 194.5546293258667, 195.61790084838867, 196.68117237091064, 197.773912191391, 198.86665201187134, 199.96011877059937, 201.0535855293274, 202.10381746292114, 203.1540493965149, 204.2744324207306, 205.3948154449463, 206.50386261940002, 207.61290979385376, 208.64038181304932, 209.66785383224487, 210.75032210350037, 211.83279037475586, 212.86198592185974, 213.89118146896362, 216.05975103378296, 218.2283205986023]
[28.42, 28.42, 79.66, 79.66, 87.06, 87.06, 93.7, 93.7, 94.76, 94.76, 94.84, 94.84, 94.98, 94.98, 95.06, 95.06, 95.06, 95.06, 95.2, 95.2, 95.24, 95.24, 95.22, 95.22, 95.24, 95.24, 95.18, 95.18, 95.18, 95.18, 95.0, 95.0, 95.04, 95.04, 94.94, 94.94, 95.02, 95.02, 94.96, 94.96, 94.96, 94.96, 94.94, 94.94, 94.94, 94.94, 95.02, 95.02, 95.02, 95.02, 95.0, 95.0, 95.02, 95.02, 95.04, 95.04, 95.08, 95.08, 95.08, 95.08, 95.06, 95.06, 95.04, 95.04, 95.04, 95.04, 95.16, 95.16, 95.22, 95.22, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 95.2, 95.18, 95.18, 95.2, 95.2, 95.2, 95.2, 95.24, 95.24, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.24, 95.24, 95.24, 95.24, 95.26, 95.26, 95.26, 95.26, 95.26, 95.26, 95.3, 95.3, 95.28, 95.28, 95.26, 95.26, 95.26, 95.26, 95.26, 95.26, 95.26, 95.26, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.28, 95.26, 95.26, 95.26, 95.26, 95.26, 95.26, 95.22, 95.22, 95.22, 95.22, 95.22, 95.22, 95.24, 95.24, 95.26, 95.26, 95.26, 95.26, 95.26, 95.26, 95.3, 95.3, 95.32, 95.32, 95.32, 95.32, 95.32, 95.32, 95.3, 95.3, 95.32, 95.32, 95.3, 95.3, 95.3, 95.3, 95.32, 95.32, 95.32, 95.32, 95.32, 95.32, 95.32, 95.32, 95.32, 95.32, 95.34, 95.34, 95.32, 95.32, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.3, 95.28, 95.28, 95.3, 95.3, 95.28, 95.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.563, Test loss: 1.478, Test accuracy: 57.04
Round   0, Global train loss: 1.563, Global test loss: 1.477, Global test accuracy: 57.50
Round   1, Train loss: 1.253, Test loss: 1.131, Test accuracy: 86.14
Round   1, Global train loss: 1.253, Global test loss: 1.040, Global test accuracy: 93.76
Round   2, Train loss: 0.974, Test loss: 1.093, Test accuracy: 86.98
Round   2, Global train loss: 0.974, Global test loss: 0.975, Global test accuracy: 95.00
Round   3, Train loss: 0.957, Test loss: 1.088, Test accuracy: 87.22
Round   3, Global train loss: 0.957, Global test loss: 0.960, Global test accuracy: 95.74
Round   4, Train loss: 0.948, Test loss: 1.013, Test accuracy: 90.88
Round   4, Global train loss: 0.948, Global test loss: 0.950, Global test accuracy: 96.48
Round   5, Train loss: 0.936, Test loss: 1.009, Test accuracy: 91.02
Round   5, Global train loss: 0.936, Global test loss: 0.947, Global test accuracy: 96.52
Round   6, Train loss: 0.930, Test loss: 1.004, Test accuracy: 91.12
Round   6, Global train loss: 0.930, Global test loss: 0.944, Global test accuracy: 96.74
Round   7, Train loss: 0.934, Test loss: 1.002, Test accuracy: 91.44
Round   7, Global train loss: 0.934, Global test loss: 0.944, Global test accuracy: 96.74
Round   8, Train loss: 0.943, Test loss: 1.000, Test accuracy: 91.56
Round   8, Global train loss: 0.943, Global test loss: 0.941, Global test accuracy: 96.84
Round   9, Train loss: 0.933, Test loss: 1.000, Test accuracy: 91.60
Round   9, Global train loss: 0.933, Global test loss: 0.941, Global test accuracy: 96.76
Round  10, Train loss: 0.923, Test loss: 0.945, Test accuracy: 96.36
Round  10, Global train loss: 0.923, Global test loss: 0.939, Global test accuracy: 96.88
Round  11, Train loss: 0.927, Test loss: 0.945, Test accuracy: 96.40
Round  11, Global train loss: 0.927, Global test loss: 0.940, Global test accuracy: 96.84
Round  12, Train loss: 0.925, Test loss: 0.945, Test accuracy: 96.40
Round  12, Global train loss: 0.925, Global test loss: 0.938, Global test accuracy: 96.94
Round  13, Train loss: 0.917, Test loss: 0.944, Test accuracy: 96.48
Round  13, Global train loss: 0.917, Global test loss: 0.937, Global test accuracy: 97.00
Round  14, Train loss: 0.925, Test loss: 0.941, Test accuracy: 96.72
Round  14, Global train loss: 0.925, Global test loss: 0.938, Global test accuracy: 97.06
Round  15, Train loss: 0.916, Test loss: 0.940, Test accuracy: 96.70
Round  15, Global train loss: 0.916, Global test loss: 0.937, Global test accuracy: 96.94
Round  16, Train loss: 0.918, Test loss: 0.940, Test accuracy: 96.70
Round  16, Global train loss: 0.918, Global test loss: 0.937, Global test accuracy: 97.02
Round  17, Train loss: 0.917, Test loss: 0.939, Test accuracy: 96.84
Round  17, Global train loss: 0.917, Global test loss: 0.936, Global test accuracy: 97.02
Round  18, Train loss: 0.922, Test loss: 0.939, Test accuracy: 96.94
Round  18, Global train loss: 0.922, Global test loss: 0.935, Global test accuracy: 97.10
Round  19, Train loss: 0.918, Test loss: 0.938, Test accuracy: 97.00
Round  19, Global train loss: 0.918, Global test loss: 0.936, Global test accuracy: 97.12
Round  20, Train loss: 0.925, Test loss: 0.937, Test accuracy: 97.08
Round  20, Global train loss: 0.925, Global test loss: 0.935, Global test accuracy: 97.20
Round  21, Train loss: 0.922, Test loss: 0.936, Test accuracy: 97.12
Round  21, Global train loss: 0.922, Global test loss: 0.935, Global test accuracy: 97.16
Round  22, Train loss: 0.920, Test loss: 0.936, Test accuracy: 97.04
Round  22, Global train loss: 0.920, Global test loss: 0.935, Global test accuracy: 97.02
Round  23, Train loss: 0.919, Test loss: 0.936, Test accuracy: 97.06
Round  23, Global train loss: 0.919, Global test loss: 0.935, Global test accuracy: 97.16
Round  24, Train loss: 0.912, Test loss: 0.936, Test accuracy: 96.98
Round  24, Global train loss: 0.912, Global test loss: 0.935, Global test accuracy: 97.06
Round  25, Train loss: 0.917, Test loss: 0.936, Test accuracy: 96.98
Round  25, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.16
Round  26, Train loss: 0.921, Test loss: 0.936, Test accuracy: 96.98
Round  26, Global train loss: 0.921, Global test loss: 0.934, Global test accuracy: 97.20
Round  27, Train loss: 0.913, Test loss: 0.936, Test accuracy: 97.00
Round  27, Global train loss: 0.913, Global test loss: 0.934, Global test accuracy: 97.18
Round  28, Train loss: 0.919, Test loss: 0.936, Test accuracy: 97.08
Round  28, Global train loss: 0.919, Global test loss: 0.933, Global test accuracy: 97.26
Round  29, Train loss: 0.914, Test loss: 0.936, Test accuracy: 97.12
Round  29, Global train loss: 0.914, Global test loss: 0.934, Global test accuracy: 97.40
Round  30, Train loss: 0.918, Test loss: 0.935, Test accuracy: 97.14
Round  30, Global train loss: 0.918, Global test loss: 0.934, Global test accuracy: 97.20
Round  31, Train loss: 0.917, Test loss: 0.935, Test accuracy: 97.08
Round  31, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.20
Round  32, Train loss: 0.917, Test loss: 0.934, Test accuracy: 97.20
Round  32, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.24
Round  33, Train loss: 0.916, Test loss: 0.935, Test accuracy: 97.20
Round  33, Global train loss: 0.916, Global test loss: 0.934, Global test accuracy: 97.30
Round  34, Train loss: 0.913, Test loss: 0.934, Test accuracy: 97.18
Round  34, Global train loss: 0.913, Global test loss: 0.933, Global test accuracy: 97.20
Round  35, Train loss: 0.911, Test loss: 0.934, Test accuracy: 97.18
Round  35, Global train loss: 0.911, Global test loss: 0.932, Global test accuracy: 97.38
Round  36, Train loss: 0.913, Test loss: 0.934, Test accuracy: 97.22
Round  36, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.46
Round  37, Train loss: 0.916, Test loss: 0.934, Test accuracy: 97.24
Round  37, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.42
Round  38, Train loss: 0.914, Test loss: 0.933, Test accuracy: 97.32
Round  38, Global train loss: 0.914, Global test loss: 0.932, Global test accuracy: 97.46
Round  39, Train loss: 0.917, Test loss: 0.933, Test accuracy: 97.38
Round  39, Global train loss: 0.917, Global test loss: 0.932, Global test accuracy: 97.50
Round  40, Train loss: 0.913, Test loss: 0.933, Test accuracy: 97.40
Round  40, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.42
Round  41, Train loss: 0.911, Test loss: 0.933, Test accuracy: 97.44
Round  41, Global train loss: 0.911, Global test loss: 0.933, Global test accuracy: 97.28
Round  42, Train loss: 0.911, Test loss: 0.933, Test accuracy: 97.40
Round  42, Global train loss: 0.911, Global test loss: 0.932, Global test accuracy: 97.28
Round  43, Train loss: 0.915, Test loss: 0.933, Test accuracy: 97.38
Round  43, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.30
Round  44, Train loss: 0.918, Test loss: 0.933, Test accuracy: 97.34
Round  44, Global train loss: 0.918, Global test loss: 0.933, Global test accuracy: 97.38
Round  45, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.42
Round  45, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.38
Round  46, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.42
Round  46, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.34
Round  47, Train loss: 0.910, Test loss: 0.933, Test accuracy: 97.44
Round  47, Global train loss: 0.910, Global test loss: 0.931, Global test accuracy: 97.68
Round  48, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.46
Round  48, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 97.58
Round  49, Train loss: 0.917, Test loss: 0.932, Test accuracy: 97.44
Round  49, Global train loss: 0.917, Global test loss: 0.932, Global test accuracy: 97.60
Round  50, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.48
Round  50, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 97.50
Round  51, Train loss: 0.916, Test loss: 0.932, Test accuracy: 97.52
Round  51, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.48
Round  52, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.46
Round  52, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.42
Round  53, Train loss: 0.912, Test loss: 0.932, Test accuracy: 97.42
Round  53, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 97.60
Round  54, Train loss: 0.917, Test loss: 0.932, Test accuracy: 97.46
Round  54, Global train loss: 0.917, Global test loss: 0.931, Global test accuracy: 97.54
Round  55, Train loss: 0.910, Test loss: 0.932, Test accuracy: 97.50
Round  55, Global train loss: 0.910, Global test loss: 0.931, Global test accuracy: 97.60
Round  56, Train loss: 0.916, Test loss: 0.931, Test accuracy: 97.56
Round  56, Global train loss: 0.916, Global test loss: 0.930, Global test accuracy: 97.58
Round  57, Train loss: 0.913, Test loss: 0.931, Test accuracy: 97.52
Round  57, Global train loss: 0.913, Global test loss: 0.931, Global test accuracy: 97.56
Round  58, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.56
Round  58, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 97.46
Round  59, Train loss: 0.911, Test loss: 0.931, Test accuracy: 97.50
Round  59, Global train loss: 0.911, Global test loss: 0.931, Global test accuracy: 97.42
Round  60, Train loss: 0.914, Test loss: 0.931, Test accuracy: 97.48
Round  60, Global train loss: 0.914, Global test loss: 0.931, Global test accuracy: 97.48
Round  61, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.50
Round  61, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 97.46
Round  62, Train loss: 0.915, Test loss: 0.931, Test accuracy: 97.46
Round  62, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 97.52
Round  63, Train loss: 0.910, Test loss: 0.931, Test accuracy: 97.50
Round  63, Global train loss: 0.910, Global test loss: 0.931, Global test accuracy: 97.46
Round  64, Train loss: 0.918, Test loss: 0.931, Test accuracy: 97.52
Round  64, Global train loss: 0.918, Global test loss: 0.931, Global test accuracy: 97.58
Round  65, Train loss: 0.914, Test loss: 0.931, Test accuracy: 97.56
Round  65, Global train loss: 0.914, Global test loss: 0.931, Global test accuracy: 97.56
Round  66, Train loss: 0.915, Test loss: 0.931, Test accuracy: 97.56
Round  66, Global train loss: 0.915, Global test loss: 0.930, Global test accuracy: 97.62
Round  67, Train loss: 0.917, Test loss: 0.931, Test accuracy: 97.58
Round  67, Global train loss: 0.917, Global test loss: 0.931, Global test accuracy: 97.52
Round  68, Train loss: 0.915, Test loss: 0.931, Test accuracy: 97.60
Round  68, Global train loss: 0.915, Global test loss: 0.930, Global test accuracy: 97.64
Round  69, Train loss: 0.910, Test loss: 0.931, Test accuracy: 97.64
Round  69, Global train loss: 0.910, Global test loss: 0.930, Global test accuracy: 97.62
Round  70, Train loss: 0.918, Test loss: 0.931, Test accuracy: 97.66
Round  70, Global train loss: 0.918, Global test loss: 0.930, Global test accuracy: 97.62
Round  71, Train loss: 0.911, Test loss: 0.931, Test accuracy: 97.68
Round  71, Global train loss: 0.911, Global test loss: 0.930, Global test accuracy: 97.62
Round  72, Train loss: 0.913, Test loss: 0.930, Test accuracy: 97.66
Round  72, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 97.60
Round  73, Train loss: 0.909, Test loss: 0.930, Test accuracy: 97.66
Round  73, Global train loss: 0.909, Global test loss: 0.930, Global test accuracy: 97.60
Round  74, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.62
Round  74, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.46
Round  75, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.64
Round  75, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 97.54
Round  76, Train loss: 0.917, Test loss: 0.930, Test accuracy: 97.62
Round  76, Global train loss: 0.917, Global test loss: 0.931, Global test accuracy: 97.54
Round  77, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.62
Round  77, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 97.62
Round  78, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.58
Round  78, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.64
Round  79, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.56
Round  79, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.56
Round  80, Train loss: 0.915, Test loss: 0.930, Test accuracy: 97.58
Round  80, Global train loss: 0.915, Global test loss: 0.930, Global test accuracy: 97.62
Round  81, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.60
Round  81, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 97.68
Round  82, Train loss: 0.909, Test loss: 0.930, Test accuracy: 97.64
Round  82, Global train loss: 0.909, Global test loss: 0.930, Global test accuracy: 97.52
Round  83, Train loss: 0.917, Test loss: 0.930, Test accuracy: 97.70
Round  83, Global train loss: 0.917, Global test loss: 0.930, Global test accuracy: 97.64
Round  84, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.70
Round  84, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.58
Round  85, Train loss: 0.911, Test loss: 0.930, Test accuracy: 97.66
Round  85, Global train loss: 0.911, Global test loss: 0.930, Global test accuracy: 97.52
Round  86, Train loss: 0.910, Test loss: 0.930, Test accuracy: 97.62
Round  86, Global train loss: 0.910, Global test loss: 0.930, Global test accuracy: 97.54
Round  87, Train loss: 0.913, Test loss: 0.930, Test accuracy: 97.68
Round  87, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 97.64
Round  88, Train loss: 0.916, Test loss: 0.930, Test accuracy: 97.66
Round  88, Global train loss: 0.916, Global test loss: 0.930, Global test accuracy: 97.56
Round  89, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.62
Round  89, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.62
Round  90, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.62
Round  90, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.58
Round  91, Train loss: 0.918, Test loss: 0.930, Test accuracy: 97.66
Round  91, Global train loss: 0.918, Global test loss: 0.930, Global test accuracy: 97.66
Round  92, Train loss: 0.915, Test loss: 0.930, Test accuracy: 97.66
Round  92, Global train loss: 0.915, Global test loss: 0.930, Global test accuracy: 97.58
Round  93, Train loss: 0.913, Test loss: 0.930, Test accuracy: 97.66
Round  93, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 97.62
Round  94, Train loss: 0.910, Test loss: 0.930, Test accuracy: 97.70
Round  94, Global train loss: 0.910, Global test loss: 0.930, Global test accuracy: 97.66
Round  95, Train loss: 0.914, Test loss: 0.930, Test accuracy: 97.70
Round  95, Global train loss: 0.914, Global test loss: 0.930, Global test accuracy: 97.66/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 0.914, Test loss: 0.930, Test accuracy: 97.68
Round  96, Global train loss: 0.914, Global test loss: 0.929, Global test accuracy: 97.66
Round  97, Train loss: 0.909, Test loss: 0.930, Test accuracy: 97.72
Round  97, Global train loss: 0.909, Global test loss: 0.930, Global test accuracy: 97.58
Round  98, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.72
Round  98, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 97.54
Round  99, Train loss: 0.913, Test loss: 0.930, Test accuracy: 97.72
Round  99, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 97.56
Final Round, Train loss: 0.913, Test loss: 0.930, Test accuracy: 97.64
Final Round, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 97.56
Average accuracy final 10 rounds: 97.68400000000001 

Average global accuracy final 10 rounds: 97.61 

796.3577725887299
[1.119948387145996, 2.239896774291992, 3.290008544921875, 4.340120315551758, 5.418022871017456, 6.495925426483154, 7.523101091384888, 8.550276756286621, 9.561966896057129, 10.573657035827637, 11.936010837554932, 13.298364639282227, 14.425205945968628, 15.55204725265503, 17.092106103897095, 18.63216495513916, 19.72563648223877, 20.81910800933838, 22.0123131275177, 23.20551824569702, 24.413934230804443, 25.622350215911865, 27.141627073287964, 28.660903930664062, 30.356855869293213, 32.05280780792236, 33.47698211669922, 34.901156425476074, 36.702571392059326, 38.50398635864258, 39.92724084854126, 41.35049533843994, 42.947335720062256, 44.54417610168457, 45.42982363700867, 46.315471172332764, 47.341299057006836, 48.36712694168091, 49.3462975025177, 50.32546806335449, 51.50669050216675, 52.687912940979004, 53.775561809539795, 54.863210678100586, 55.885456800460815, 56.907702922821045, 57.950706481933594, 58.99371004104614, 60.092233180999756, 61.19075632095337, 62.31031346321106, 63.42987060546875, 64.38706517219543, 65.34425973892212, 66.37723517417908, 67.41021060943604, 68.50221371650696, 69.59421682357788, 70.73742127418518, 71.88062572479248, 72.86027026176453, 73.83991479873657, 74.99499225616455, 76.15006971359253, 77.1522605419159, 78.15445137023926, 79.07936191558838, 80.0042724609375, 80.93334531784058, 81.86241817474365, 82.8285391330719, 83.79466009140015, 84.9373140335083, 86.07996797561646, 87.17598176002502, 88.2719955444336, 89.3321635723114, 90.39233160018921, 91.46253633499146, 92.5327410697937, 93.5488977432251, 94.5650544166565, 95.61493968963623, 96.66482496261597, 97.79197573661804, 98.91912651062012, 99.91906809806824, 100.91900968551636, 102.03951144218445, 103.16001319885254, 104.14384031295776, 105.12766742706299, 106.22118926048279, 107.31471109390259, 108.44277834892273, 109.57084560394287, 110.6535165309906, 111.73618745803833, 112.76136302947998, 113.78653860092163, 115.01153779029846, 116.2365369796753, 117.38366055488586, 118.53078413009644, 119.48424410820007, 120.43770408630371, 121.44073390960693, 122.44376373291016, 123.41945052146912, 124.39513731002808, 125.38873839378357, 126.38233947753906, 127.36674761772156, 128.35115575790405, 129.5669116973877, 130.78266763687134, 131.83870005607605, 132.89473247528076, 133.93025636672974, 134.9657802581787, 135.99462389945984, 137.02346754074097, 137.97322750091553, 138.9229874610901, 139.94483375549316, 140.96668004989624, 141.99794220924377, 143.0292043685913, 144.13644742965698, 145.24369049072266, 146.37418007850647, 147.50466966629028, 148.5536880493164, 149.60270643234253, 150.61585474014282, 151.62900304794312, 152.6951560974121, 153.7613091468811, 154.83772325515747, 155.91413736343384, 156.97110104560852, 158.0280647277832, 159.27242136001587, 160.51677799224854, 161.49658846855164, 162.47639894485474, 163.52137327194214, 164.56634759902954, 165.59972500801086, 166.6331024169922, 167.82838678359985, 169.02367115020752, 170.20163917541504, 171.37960720062256, 172.59749293327332, 173.81537866592407, 175.1728081703186, 176.53023767471313, 177.56898403167725, 178.60773038864136, 179.6425769329071, 180.67742347717285, 181.71003222465515, 182.74264097213745, 183.80778574943542, 184.8729305267334, 185.9177701473236, 186.96260976791382, 188.14217352867126, 189.3217372894287, 190.54592418670654, 191.77011108398438, 192.82248711585999, 193.8748631477356, 194.94716906547546, 196.01947498321533, 197.03282046318054, 198.04616594314575, 198.97080326080322, 199.8954405784607, 200.89052438735962, 201.88560819625854, 203.07083940505981, 204.25607061386108, 205.28374028205872, 206.31140995025635, 207.31164240837097, 208.3118748664856, 209.58660244941711, 210.86133003234863, 212.0324194431305, 213.20350885391235, 214.15128540992737, 215.09906196594238, 216.1212830543518, 217.14350414276123, 218.08793306350708, 219.03236198425293, 220.23110485076904, 221.42984771728516, 223.63106417655945, 225.83228063583374]
[57.04, 57.04, 86.14, 86.14, 86.98, 86.98, 87.22, 87.22, 90.88, 90.88, 91.02, 91.02, 91.12, 91.12, 91.44, 91.44, 91.56, 91.56, 91.6, 91.6, 96.36, 96.36, 96.4, 96.4, 96.4, 96.4, 96.48, 96.48, 96.72, 96.72, 96.7, 96.7, 96.7, 96.7, 96.84, 96.84, 96.94, 96.94, 97.0, 97.0, 97.08, 97.08, 97.12, 97.12, 97.04, 97.04, 97.06, 97.06, 96.98, 96.98, 96.98, 96.98, 96.98, 96.98, 97.0, 97.0, 97.08, 97.08, 97.12, 97.12, 97.14, 97.14, 97.08, 97.08, 97.2, 97.2, 97.2, 97.2, 97.18, 97.18, 97.18, 97.18, 97.22, 97.22, 97.24, 97.24, 97.32, 97.32, 97.38, 97.38, 97.4, 97.4, 97.44, 97.44, 97.4, 97.4, 97.38, 97.38, 97.34, 97.34, 97.42, 97.42, 97.42, 97.42, 97.44, 97.44, 97.46, 97.46, 97.44, 97.44, 97.48, 97.48, 97.52, 97.52, 97.46, 97.46, 97.42, 97.42, 97.46, 97.46, 97.5, 97.5, 97.56, 97.56, 97.52, 97.52, 97.56, 97.56, 97.5, 97.5, 97.48, 97.48, 97.5, 97.5, 97.46, 97.46, 97.5, 97.5, 97.52, 97.52, 97.56, 97.56, 97.56, 97.56, 97.58, 97.58, 97.6, 97.6, 97.64, 97.64, 97.66, 97.66, 97.68, 97.68, 97.66, 97.66, 97.66, 97.66, 97.62, 97.62, 97.64, 97.64, 97.62, 97.62, 97.62, 97.62, 97.58, 97.58, 97.56, 97.56, 97.58, 97.58, 97.6, 97.6, 97.64, 97.64, 97.7, 97.7, 97.7, 97.7, 97.66, 97.66, 97.62, 97.62, 97.68, 97.68, 97.66, 97.66, 97.62, 97.62, 97.62, 97.62, 97.66, 97.66, 97.66, 97.66, 97.66, 97.66, 97.7, 97.7, 97.7, 97.7, 97.68, 97.68, 97.72, 97.72, 97.72, 97.72, 97.72, 97.72, 97.64, 97.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.595, Test loss: 1.574, Test accuracy: 57.84
Round   0, Global train loss: 1.595, Global test loss: 1.575, Global test accuracy: 57.84
Round   1, Train loss: 1.453, Test loss: 1.329, Test accuracy: 83.82
Round   1, Global train loss: 1.453, Global test loss: 1.264, Global test accuracy: 91.48
Round   2, Train loss: 1.053, Test loss: 1.115, Test accuracy: 90.52
Round   2, Global train loss: 1.053, Global test loss: 1.002, Global test accuracy: 94.36
Round   3, Train loss: 0.968, Test loss: 1.100, Test accuracy: 90.86
Round   3, Global train loss: 0.968, Global test loss: 0.972, Global test accuracy: 95.04
Round   4, Train loss: 0.956, Test loss: 1.094, Test accuracy: 91.20
Round   4, Global train loss: 0.956, Global test loss: 0.959, Global test accuracy: 95.94
Round   5, Train loss: 0.939, Test loss: 1.028, Test accuracy: 94.64
Round   5, Global train loss: 0.939, Global test loss: 0.954, Global test accuracy: 96.16
Round   6, Train loss: 0.936, Test loss: 0.991, Test accuracy: 95.18
Round   6, Global train loss: 0.936, Global test loss: 0.949, Global test accuracy: 96.26
Round   7, Train loss: 0.933, Test loss: 0.984, Test accuracy: 95.44
Round   7, Global train loss: 0.933, Global test loss: 0.946, Global test accuracy: 96.42
Round   8, Train loss: 0.934, Test loss: 0.982, Test accuracy: 95.56
Round   8, Global train loss: 0.934, Global test loss: 0.945, Global test accuracy: 96.68
Round   9, Train loss: 0.929, Test loss: 0.980, Test accuracy: 95.70
Round   9, Global train loss: 0.929, Global test loss: 0.943, Global test accuracy: 96.68
Round  10, Train loss: 0.924, Test loss: 0.979, Test accuracy: 95.70
Round  10, Global train loss: 0.924, Global test loss: 0.942, Global test accuracy: 96.72
Round  11, Train loss: 0.932, Test loss: 0.979, Test accuracy: 95.66
Round  11, Global train loss: 0.932, Global test loss: 0.941, Global test accuracy: 96.78
Round  12, Train loss: 0.927, Test loss: 0.949, Test accuracy: 96.14
Round  12, Global train loss: 0.927, Global test loss: 0.941, Global test accuracy: 96.72
Round  13, Train loss: 0.928, Test loss: 0.943, Test accuracy: 96.42
Round  13, Global train loss: 0.928, Global test loss: 0.940, Global test accuracy: 96.90
Round  14, Train loss: 0.924, Test loss: 0.943, Test accuracy: 96.42
Round  14, Global train loss: 0.924, Global test loss: 0.941, Global test accuracy: 96.60
Round  15, Train loss: 0.923, Test loss: 0.943, Test accuracy: 96.44
Round  15, Global train loss: 0.923, Global test loss: 0.940, Global test accuracy: 96.74
Round  16, Train loss: 0.918, Test loss: 0.943, Test accuracy: 96.40
Round  16, Global train loss: 0.918, Global test loss: 0.940, Global test accuracy: 96.58
Round  17, Train loss: 0.925, Test loss: 0.942, Test accuracy: 96.54
Round  17, Global train loss: 0.925, Global test loss: 0.939, Global test accuracy: 96.70
Round  18, Train loss: 0.932, Test loss: 0.941, Test accuracy: 96.66
Round  18, Global train loss: 0.932, Global test loss: 0.939, Global test accuracy: 96.80
Round  19, Train loss: 0.920, Test loss: 0.940, Test accuracy: 96.70
Round  19, Global train loss: 0.920, Global test loss: 0.939, Global test accuracy: 96.70
Round  20, Train loss: 0.917, Test loss: 0.940, Test accuracy: 96.78
Round  20, Global train loss: 0.917, Global test loss: 0.939, Global test accuracy: 96.66
Round  21, Train loss: 0.918, Test loss: 0.939, Test accuracy: 96.74
Round  21, Global train loss: 0.918, Global test loss: 0.939, Global test accuracy: 96.64
Round  22, Train loss: 0.918, Test loss: 0.939, Test accuracy: 96.68
Round  22, Global train loss: 0.918, Global test loss: 0.940, Global test accuracy: 96.62
Round  23, Train loss: 0.915, Test loss: 0.940, Test accuracy: 96.66
Round  23, Global train loss: 0.915, Global test loss: 0.939, Global test accuracy: 96.56
Round  24, Train loss: 0.924, Test loss: 0.940, Test accuracy: 96.58
Round  24, Global train loss: 0.924, Global test loss: 0.937, Global test accuracy: 96.84
Round  25, Train loss: 0.919, Test loss: 0.940, Test accuracy: 96.62
Round  25, Global train loss: 0.919, Global test loss: 0.939, Global test accuracy: 96.60
Round  26, Train loss: 0.926, Test loss: 0.940, Test accuracy: 96.68
Round  26, Global train loss: 0.926, Global test loss: 0.940, Global test accuracy: 96.62
Round  27, Train loss: 0.913, Test loss: 0.940, Test accuracy: 96.68
Round  27, Global train loss: 0.913, Global test loss: 0.938, Global test accuracy: 96.78
Round  28, Train loss: 0.920, Test loss: 0.939, Test accuracy: 96.70
Round  28, Global train loss: 0.920, Global test loss: 0.938, Global test accuracy: 96.62
Round  29, Train loss: 0.917, Test loss: 0.939, Test accuracy: 96.80
Round  29, Global train loss: 0.917, Global test loss: 0.938, Global test accuracy: 96.68
Round  30, Train loss: 0.915, Test loss: 0.939, Test accuracy: 96.76
Round  30, Global train loss: 0.915, Global test loss: 0.937, Global test accuracy: 96.68
Round  31, Train loss: 0.920, Test loss: 0.938, Test accuracy: 96.82
Round  31, Global train loss: 0.920, Global test loss: 0.937, Global test accuracy: 96.76
Round  32, Train loss: 0.919, Test loss: 0.938, Test accuracy: 96.84
Round  32, Global train loss: 0.919, Global test loss: 0.937, Global test accuracy: 96.82
Round  33, Train loss: 0.919, Test loss: 0.938, Test accuracy: 96.86
Round  33, Global train loss: 0.919, Global test loss: 0.937, Global test accuracy: 96.84
Round  34, Train loss: 0.918, Test loss: 0.938, Test accuracy: 96.80
Round  34, Global train loss: 0.918, Global test loss: 0.938, Global test accuracy: 96.58
Round  35, Train loss: 0.918, Test loss: 0.938, Test accuracy: 96.88
Round  35, Global train loss: 0.918, Global test loss: 0.937, Global test accuracy: 96.88
Round  36, Train loss: 0.917, Test loss: 0.937, Test accuracy: 96.94
Round  36, Global train loss: 0.917, Global test loss: 0.936, Global test accuracy: 96.92
Round  37, Train loss: 0.915, Test loss: 0.937, Test accuracy: 96.94
Round  37, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 96.96
Round  38, Train loss: 0.915, Test loss: 0.937, Test accuracy: 96.98
Round  38, Global train loss: 0.915, Global test loss: 0.936, Global test accuracy: 96.86
Round  39, Train loss: 0.914, Test loss: 0.937, Test accuracy: 97.00
Round  39, Global train loss: 0.914, Global test loss: 0.935, Global test accuracy: 97.02
Round  40, Train loss: 0.918, Test loss: 0.936, Test accuracy: 97.00
Round  40, Global train loss: 0.918, Global test loss: 0.936, Global test accuracy: 96.96
Round  41, Train loss: 0.912, Test loss: 0.936, Test accuracy: 96.94
Round  41, Global train loss: 0.912, Global test loss: 0.936, Global test accuracy: 96.88
Round  42, Train loss: 0.914, Test loss: 0.936, Test accuracy: 96.88
Round  42, Global train loss: 0.914, Global test loss: 0.936, Global test accuracy: 96.90
Round  43, Train loss: 0.916, Test loss: 0.936, Test accuracy: 96.88
Round  43, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 97.00
Round  44, Train loss: 0.916, Test loss: 0.936, Test accuracy: 96.98
Round  44, Global train loss: 0.916, Global test loss: 0.934, Global test accuracy: 97.20
Round  45, Train loss: 0.915, Test loss: 0.936, Test accuracy: 97.00
Round  45, Global train loss: 0.915, Global test loss: 0.934, Global test accuracy: 97.00
Round  46, Train loss: 0.915, Test loss: 0.936, Test accuracy: 97.04
Round  46, Global train loss: 0.915, Global test loss: 0.934, Global test accuracy: 97.14
Round  47, Train loss: 0.917, Test loss: 0.935, Test accuracy: 97.04
Round  47, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.10
Round  48, Train loss: 0.913, Test loss: 0.935, Test accuracy: 97.02
Round  48, Global train loss: 0.913, Global test loss: 0.934, Global test accuracy: 96.96
Round  49, Train loss: 0.913, Test loss: 0.935, Test accuracy: 97.02
Round  49, Global train loss: 0.913, Global test loss: 0.935, Global test accuracy: 97.00
Round  50, Train loss: 0.909, Test loss: 0.935, Test accuracy: 97.04
Round  50, Global train loss: 0.909, Global test loss: 0.934, Global test accuracy: 97.08
Round  51, Train loss: 0.919, Test loss: 0.935, Test accuracy: 97.02
Round  51, Global train loss: 0.919, Global test loss: 0.934, Global test accuracy: 97.02
Round  52, Train loss: 0.911, Test loss: 0.935, Test accuracy: 97.12
Round  52, Global train loss: 0.911, Global test loss: 0.933, Global test accuracy: 97.22
Round  53, Train loss: 0.920, Test loss: 0.934, Test accuracy: 97.22
Round  53, Global train loss: 0.920, Global test loss: 0.934, Global test accuracy: 97.18
Round  54, Train loss: 0.917, Test loss: 0.934, Test accuracy: 97.20
Round  54, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.12
Round  55, Train loss: 0.917, Test loss: 0.934, Test accuracy: 97.26
Round  55, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.32
Round  56, Train loss: 0.918, Test loss: 0.934, Test accuracy: 97.22
Round  56, Global train loss: 0.918, Global test loss: 0.935, Global test accuracy: 97.20
Round  57, Train loss: 0.913, Test loss: 0.934, Test accuracy: 97.18
Round  57, Global train loss: 0.913, Global test loss: 0.933, Global test accuracy: 97.32
Round  58, Train loss: 0.911, Test loss: 0.934, Test accuracy: 97.22
Round  58, Global train loss: 0.911, Global test loss: 0.933, Global test accuracy: 97.26
Round  59, Train loss: 0.915, Test loss: 0.934, Test accuracy: 97.26
Round  59, Global train loss: 0.915, Global test loss: 0.933, Global test accuracy: 97.28
Round  60, Train loss: 0.910, Test loss: 0.934, Test accuracy: 97.24
Round  60, Global train loss: 0.910, Global test loss: 0.934, Global test accuracy: 97.08
Round  61, Train loss: 0.912, Test loss: 0.934, Test accuracy: 97.24
Round  61, Global train loss: 0.912, Global test loss: 0.934, Global test accuracy: 97.22
Round  62, Train loss: 0.911, Test loss: 0.934, Test accuracy: 97.22
Round  62, Global train loss: 0.911, Global test loss: 0.933, Global test accuracy: 97.30
Round  63, Train loss: 0.914, Test loss: 0.934, Test accuracy: 97.26
Round  63, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.32
Round  64, Train loss: 0.918, Test loss: 0.934, Test accuracy: 97.26
Round  64, Global train loss: 0.918, Global test loss: 0.933, Global test accuracy: 97.28
Round  65, Train loss: 0.916, Test loss: 0.933, Test accuracy: 97.26
Round  65, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.36
Round  66, Train loss: 0.914, Test loss: 0.933, Test accuracy: 97.26
Round  66, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.26
Round  67, Train loss: 0.912, Test loss: 0.933, Test accuracy: 97.32
Round  67, Global train loss: 0.912, Global test loss: 0.933, Global test accuracy: 97.24
Round  68, Train loss: 0.913, Test loss: 0.933, Test accuracy: 97.36
Round  68, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.36
Round  69, Train loss: 0.914, Test loss: 0.933, Test accuracy: 97.36
Round  69, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.26
Round  70, Train loss: 0.913, Test loss: 0.933, Test accuracy: 97.34
Round  70, Global train loss: 0.913, Global test loss: 0.933, Global test accuracy: 97.34
Round  71, Train loss: 0.916, Test loss: 0.933, Test accuracy: 97.34
Round  71, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.28
Round  72, Train loss: 0.911, Test loss: 0.933, Test accuracy: 97.36
Round  72, Global train loss: 0.911, Global test loss: 0.932, Global test accuracy: 97.38
Round  73, Train loss: 0.910, Test loss: 0.933, Test accuracy: 97.36
Round  73, Global train loss: 0.910, Global test loss: 0.932, Global test accuracy: 97.46
Round  74, Train loss: 0.915, Test loss: 0.933, Test accuracy: 97.36
Round  74, Global train loss: 0.915, Global test loss: 0.933, Global test accuracy: 97.34
Round  75, Train loss: 0.920, Test loss: 0.933, Test accuracy: 97.40
Round  75, Global train loss: 0.920, Global test loss: 0.932, Global test accuracy: 97.38
Round  76, Train loss: 0.913, Test loss: 0.933, Test accuracy: 97.40
Round  76, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.36
Round  77, Train loss: 0.913, Test loss: 0.933, Test accuracy: 97.38
Round  77, Global train loss: 0.913, Global test loss: 0.933, Global test accuracy: 97.34
Round  78, Train loss: 0.911, Test loss: 0.933, Test accuracy: 97.38
Round  78, Global train loss: 0.911, Global test loss: 0.932, Global test accuracy: 97.44
Round  79, Train loss: 0.918, Test loss: 0.933, Test accuracy: 97.38
Round  79, Global train loss: 0.918, Global test loss: 0.933, Global test accuracy: 97.36
Round  80, Train loss: 0.915, Test loss: 0.933, Test accuracy: 97.40
Round  80, Global train loss: 0.915, Global test loss: 0.933, Global test accuracy: 97.28
Round  81, Train loss: 0.915, Test loss: 0.933, Test accuracy: 97.40
Round  81, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.40
Round  82, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.38
Round  82, Global train loss: 0.913, Global test loss: 0.931, Global test accuracy: 97.50
Round  83, Train loss: 0.910, Test loss: 0.932, Test accuracy: 97.40
Round  83, Global train loss: 0.910, Global test loss: 0.931, Global test accuracy: 97.46
Round  84, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.40
Round  84, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.42
Round  85, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.40
Round  85, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 97.46
Round  86, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.40
Round  86, Global train loss: 0.913, Global test loss: 0.932, Global test accuracy: 97.32
Round  87, Train loss: 0.916, Test loss: 0.932, Test accuracy: 97.40
Round  87, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.34
Round  88, Train loss: 0.914, Test loss: 0.932, Test accuracy: 97.40
Round  88, Global train loss: 0.914, Global test loss: 0.932, Global test accuracy: 97.36
Round  89, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.42
Round  89, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.26
Round  90, Train loss: 0.911, Test loss: 0.932, Test accuracy: 97.44
Round  90, Global train loss: 0.911, Global test loss: 0.931, Global test accuracy: 97.44
Round  91, Train loss: 0.912, Test loss: 0.932, Test accuracy: 97.42
Round  91, Global train loss: 0.912, Global test loss: 0.932, Global test accuracy: 97.18
Round  92, Train loss: 0.912, Test loss: 0.932, Test accuracy: 97.42
Round  92, Global train loss: 0.912, Global test loss: 0.932, Global test accuracy: 97.42
Round  93, Train loss: 0.918, Test loss: 0.932, Test accuracy: 97.42
Round  93, Global train loss: 0.918, Global test loss: 0.932, Global test accuracy: 97.40
Round  94, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.44
Round  94, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.36
Round  95, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.44
Round  95, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.42/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.917, Test loss: 0.932, Test accuracy: 97.44
Round  96, Global train loss: 0.917, Global test loss: 0.932, Global test accuracy: 97.38
Round  97, Train loss: 0.911, Test loss: 0.932, Test accuracy: 97.44
Round  97, Global train loss: 0.911, Global test loss: 0.931, Global test accuracy: 97.38
Round  98, Train loss: 0.909, Test loss: 0.932, Test accuracy: 97.46
Round  98, Global train loss: 0.909, Global test loss: 0.932, Global test accuracy: 97.36
Round  99, Train loss: 0.917, Test loss: 0.932, Test accuracy: 97.44
Round  99, Global train loss: 0.917, Global test loss: 0.932, Global test accuracy: 97.34
Final Round, Train loss: 0.914, Test loss: 0.932, Test accuracy: 97.46
Final Round, Global train loss: 0.914, Global test loss: 0.932, Global test accuracy: 97.34
Average accuracy final 10 rounds: 97.43599999999999 

Average global accuracy final 10 rounds: 97.36800000000001 

831.3556373119354
[1.2978408336639404, 2.595681667327881, 3.888977527618408, 5.1822733879089355, 6.4891297817230225, 7.795986175537109, 8.934346199035645, 10.07270622253418, 11.213386297225952, 12.354066371917725, 13.626487255096436, 14.898908138275146, 16.21306300163269, 17.527217864990234, 18.756401777267456, 19.985585689544678, 21.129441261291504, 22.27329683303833, 23.418179750442505, 24.56306266784668, 25.734394311904907, 26.905725955963135, 28.058058261871338, 29.21039056777954, 30.439913988113403, 31.669437408447266, 32.79587244987488, 33.92230749130249, 35.166473150253296, 36.4106388092041, 37.60862064361572, 38.806602478027344, 39.907071113586426, 41.00753974914551, 42.8211088180542, 44.63467788696289, 45.765913248062134, 46.89714860916138, 48.01861381530762, 49.14007902145386, 50.36925792694092, 51.59843683242798, 52.799572467803955, 54.00070810317993, 55.16349673271179, 56.32628536224365, 57.41489243507385, 58.50349950790405, 59.6482093334198, 60.79291915893555, 61.913713216781616, 63.034507274627686, 64.17265367507935, 65.310800075531, 66.51239442825317, 67.71398878097534, 68.91707253456116, 70.12015628814697, 71.19597434997559, 72.2717924118042, 73.43632650375366, 74.60086059570312, 75.75256943702698, 76.90427827835083, 78.10704851150513, 79.30981874465942, 80.40911483764648, 81.50841093063354, 82.67815637588501, 83.84790182113647, 84.92569661140442, 86.00349140167236, 87.21579456329346, 88.42809772491455, 89.70560216903687, 90.98310661315918, 92.14281153678894, 93.3025164604187, 94.50257420539856, 95.70263195037842, 96.80675673484802, 97.91088151931763, 99.09537601470947, 100.27987051010132, 101.4941930770874, 102.70851564407349, 103.90434765815735, 105.10017967224121, 106.2301983833313, 107.36021709442139, 108.49980449676514, 109.63939189910889, 110.75462031364441, 111.86984872817993, 113.05826020240784, 114.24667167663574, 115.44276428222656, 116.63885688781738, 117.85163998603821, 119.06442308425903, 120.16347765922546, 121.2625322341919, 122.50222635269165, 123.7419204711914, 124.97319483757019, 126.20446920394897, 127.40510392189026, 128.60573863983154, 129.8077232837677, 131.00970792770386, 132.32137942314148, 133.6330509185791, 134.90653324127197, 136.18001556396484, 137.34181261062622, 138.5036096572876, 139.6034243106842, 140.7032389640808, 142.08357191085815, 143.4639048576355, 144.63729310035706, 145.8106813430786, 147.02973890304565, 148.2487964630127, 149.40500736236572, 150.56121826171875, 151.6687433719635, 152.77626848220825, 154.01384139060974, 155.25141429901123, 156.43775820732117, 157.6241021156311, 158.7879900932312, 159.9518780708313, 161.10744667053223, 162.26301527023315, 163.37724590301514, 164.49147653579712, 165.64436721801758, 166.79725790023804, 168.1175651550293, 169.43787240982056, 170.62513518333435, 171.81239795684814, 172.93801879882812, 174.0636396408081, 175.1622838973999, 176.2609281539917, 177.58919835090637, 178.91746854782104, 180.02637887001038, 181.1352891921997, 182.25626850128174, 183.37724781036377, 184.51582956314087, 185.65441131591797, 186.79645609855652, 187.93850088119507, 189.06063723564148, 190.1827735900879, 191.30772018432617, 192.43266677856445, 193.65171694755554, 194.87076711654663, 196.01438927650452, 197.1580114364624, 198.40027618408203, 199.64254093170166, 200.82716012001038, 202.0117793083191, 203.11667704582214, 204.2215747833252, 205.405344247818, 206.5891137123108, 207.7997968196869, 209.010479927063, 210.0897867679596, 211.1690936088562, 212.3250539302826, 213.48101425170898, 214.6211862564087, 215.7613582611084, 216.87499976158142, 217.98864126205444, 219.2013533115387, 220.41406536102295, 221.63039183616638, 222.84671831130981, 224.12542510032654, 225.40413188934326, 226.5456051826477, 227.68707847595215, 228.75861501693726, 229.83015155792236, 230.96739268302917, 232.104633808136, 233.3376500606537, 234.5706663131714, 235.89207673072815, 237.2134871482849, 239.78007411956787, 242.34666109085083]
[57.84, 57.84, 83.82, 83.82, 90.52, 90.52, 90.86, 90.86, 91.2, 91.2, 94.64, 94.64, 95.18, 95.18, 95.44, 95.44, 95.56, 95.56, 95.7, 95.7, 95.7, 95.7, 95.66, 95.66, 96.14, 96.14, 96.42, 96.42, 96.42, 96.42, 96.44, 96.44, 96.4, 96.4, 96.54, 96.54, 96.66, 96.66, 96.7, 96.7, 96.78, 96.78, 96.74, 96.74, 96.68, 96.68, 96.66, 96.66, 96.58, 96.58, 96.62, 96.62, 96.68, 96.68, 96.68, 96.68, 96.7, 96.7, 96.8, 96.8, 96.76, 96.76, 96.82, 96.82, 96.84, 96.84, 96.86, 96.86, 96.8, 96.8, 96.88, 96.88, 96.94, 96.94, 96.94, 96.94, 96.98, 96.98, 97.0, 97.0, 97.0, 97.0, 96.94, 96.94, 96.88, 96.88, 96.88, 96.88, 96.98, 96.98, 97.0, 97.0, 97.04, 97.04, 97.04, 97.04, 97.02, 97.02, 97.02, 97.02, 97.04, 97.04, 97.02, 97.02, 97.12, 97.12, 97.22, 97.22, 97.2, 97.2, 97.26, 97.26, 97.22, 97.22, 97.18, 97.18, 97.22, 97.22, 97.26, 97.26, 97.24, 97.24, 97.24, 97.24, 97.22, 97.22, 97.26, 97.26, 97.26, 97.26, 97.26, 97.26, 97.26, 97.26, 97.32, 97.32, 97.36, 97.36, 97.36, 97.36, 97.34, 97.34, 97.34, 97.34, 97.36, 97.36, 97.36, 97.36, 97.36, 97.36, 97.4, 97.4, 97.4, 97.4, 97.38, 97.38, 97.38, 97.38, 97.38, 97.38, 97.4, 97.4, 97.4, 97.4, 97.38, 97.38, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.4, 97.42, 97.42, 97.44, 97.44, 97.42, 97.42, 97.42, 97.42, 97.42, 97.42, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.44, 97.46, 97.46, 97.44, 97.44, 97.46, 97.46]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.620, Test loss: 1.581, Test accuracy: 72.22
Round   0, Global train loss: 1.620, Global test loss: 1.581, Global test accuracy: 72.14
Round   1, Train loss: 1.551, Test loss: 1.464, Test accuracy: 89.52
Round   1, Global train loss: 1.551, Global test loss: 1.459, Global test accuracy: 89.16
Round   2, Train loss: 1.323, Test loss: 1.156, Test accuracy: 92.22
Round   2, Global train loss: 1.323, Global test loss: 1.125, Global test accuracy: 91.68
Round   3, Train loss: 1.083, Test loss: 1.042, Test accuracy: 94.46
Round   3, Global train loss: 1.083, Global test loss: 1.021, Global test accuracy: 94.26
Round   4, Train loss: 1.009, Test loss: 1.011, Test accuracy: 95.24
Round   4, Global train loss: 1.009, Global test loss: 0.986, Global test accuracy: 95.46
Round   5, Train loss: 1.000, Test loss: 0.989, Test accuracy: 95.76
Round   5, Global train loss: 1.000, Global test loss: 0.974, Global test accuracy: 95.86
Round   6, Train loss: 0.984, Test loss: 0.980, Test accuracy: 95.88
Round   6, Global train loss: 0.984, Global test loss: 0.972, Global test accuracy: 95.86
Round   7, Train loss: 0.988, Test loss: 0.970, Test accuracy: 96.16
Round   7, Global train loss: 0.988, Global test loss: 0.967, Global test accuracy: 96.24
Round   8, Train loss: 0.971, Test loss: 0.966, Test accuracy: 96.22
Round   8, Global train loss: 0.971, Global test loss: 0.963, Global test accuracy: 96.38
Round   9, Train loss: 0.964, Test loss: 0.961, Test accuracy: 96.36
Round   9, Global train loss: 0.964, Global test loss: 0.958, Global test accuracy: 96.58
Round  10, Train loss: 0.966, Test loss: 0.958, Test accuracy: 96.72
Round  10, Global train loss: 0.966, Global test loss: 0.955, Global test accuracy: 96.82
Round  11, Train loss: 0.951, Test loss: 0.958, Test accuracy: 96.48
Round  11, Global train loss: 0.951, Global test loss: 0.952, Global test accuracy: 96.58
Round  12, Train loss: 0.959, Test loss: 0.955, Test accuracy: 96.56
Round  12, Global train loss: 0.959, Global test loss: 0.953, Global test accuracy: 96.78
Round  13, Train loss: 0.956, Test loss: 0.953, Test accuracy: 96.58
Round  13, Global train loss: 0.956, Global test loss: 0.952, Global test accuracy: 96.60
Round  14, Train loss: 0.943, Test loss: 0.952, Test accuracy: 96.86
Round  14, Global train loss: 0.943, Global test loss: 0.947, Global test accuracy: 96.94
Round  15, Train loss: 0.947, Test loss: 0.951, Test accuracy: 96.96
Round  15, Global train loss: 0.947, Global test loss: 0.948, Global test accuracy: 96.98
Round  16, Train loss: 0.942, Test loss: 0.950, Test accuracy: 97.10
Round  16, Global train loss: 0.942, Global test loss: 0.945, Global test accuracy: 97.12
Round  17, Train loss: 0.943, Test loss: 0.948, Test accuracy: 97.14
Round  17, Global train loss: 0.943, Global test loss: 0.946, Global test accuracy: 97.08
Round  18, Train loss: 0.946, Test loss: 0.947, Test accuracy: 97.06
Round  18, Global train loss: 0.946, Global test loss: 0.947, Global test accuracy: 97.10
Round  19, Train loss: 0.944, Test loss: 0.946, Test accuracy: 97.18
Round  19, Global train loss: 0.944, Global test loss: 0.944, Global test accuracy: 97.34
Round  20, Train loss: 0.943, Test loss: 0.945, Test accuracy: 97.24
Round  20, Global train loss: 0.943, Global test loss: 0.942, Global test accuracy: 97.28
Round  21, Train loss: 0.943, Test loss: 0.946, Test accuracy: 97.16
Round  21, Global train loss: 0.943, Global test loss: 0.944, Global test accuracy: 97.32
Round  22, Train loss: 0.938, Test loss: 0.944, Test accuracy: 97.28
Round  22, Global train loss: 0.938, Global test loss: 0.945, Global test accuracy: 97.34
Round  23, Train loss: 0.936, Test loss: 0.942, Test accuracy: 97.26
Round  23, Global train loss: 0.936, Global test loss: 0.941, Global test accuracy: 97.58
Round  24, Train loss: 0.931, Test loss: 0.942, Test accuracy: 97.22
Round  24, Global train loss: 0.931, Global test loss: 0.941, Global test accuracy: 97.24
Round  25, Train loss: 0.934, Test loss: 0.943, Test accuracy: 97.16
Round  25, Global train loss: 0.934, Global test loss: 0.941, Global test accuracy: 97.34
Round  26, Train loss: 0.934, Test loss: 0.942, Test accuracy: 97.18
Round  26, Global train loss: 0.934, Global test loss: 0.942, Global test accuracy: 97.30
Round  27, Train loss: 0.936, Test loss: 0.941, Test accuracy: 97.48
Round  27, Global train loss: 0.936, Global test loss: 0.939, Global test accuracy: 97.54
Round  28, Train loss: 0.932, Test loss: 0.940, Test accuracy: 97.46
Round  28, Global train loss: 0.932, Global test loss: 0.938, Global test accuracy: 97.56
Round  29, Train loss: 0.934, Test loss: 0.940, Test accuracy: 97.38
Round  29, Global train loss: 0.934, Global test loss: 0.939, Global test accuracy: 97.72
Round  30, Train loss: 0.927, Test loss: 0.940, Test accuracy: 97.40
Round  30, Global train loss: 0.927, Global test loss: 0.938, Global test accuracy: 97.50
Round  31, Train loss: 0.929, Test loss: 0.938, Test accuracy: 97.54
Round  31, Global train loss: 0.929, Global test loss: 0.937, Global test accuracy: 97.62
Round  32, Train loss: 0.923, Test loss: 0.938, Test accuracy: 97.46
Round  32, Global train loss: 0.923, Global test loss: 0.936, Global test accuracy: 97.70
Round  33, Train loss: 0.929, Test loss: 0.938, Test accuracy: 97.48
Round  33, Global train loss: 0.929, Global test loss: 0.936, Global test accuracy: 97.68
Round  34, Train loss: 0.926, Test loss: 0.939, Test accuracy: 97.42
Round  34, Global train loss: 0.926, Global test loss: 0.937, Global test accuracy: 97.50
Round  35, Train loss: 0.925, Test loss: 0.938, Test accuracy: 97.40
Round  35, Global train loss: 0.925, Global test loss: 0.937, Global test accuracy: 97.62
Round  36, Train loss: 0.924, Test loss: 0.938, Test accuracy: 97.42
Round  36, Global train loss: 0.924, Global test loss: 0.937, Global test accuracy: 97.42
Round  37, Train loss: 0.925, Test loss: 0.937, Test accuracy: 97.48
Round  37, Global train loss: 0.925, Global test loss: 0.935, Global test accuracy: 97.90
Round  38, Train loss: 0.928, Test loss: 0.936, Test accuracy: 97.58
Round  38, Global train loss: 0.928, Global test loss: 0.935, Global test accuracy: 97.72
Round  39, Train loss: 0.921, Test loss: 0.936, Test accuracy: 97.78
Round  39, Global train loss: 0.921, Global test loss: 0.933, Global test accuracy: 98.12
Round  40, Train loss: 0.923, Test loss: 0.936, Test accuracy: 97.56
Round  40, Global train loss: 0.923, Global test loss: 0.935, Global test accuracy: 97.78
Round  41, Train loss: 0.921, Test loss: 0.935, Test accuracy: 97.76
Round  41, Global train loss: 0.921, Global test loss: 0.935, Global test accuracy: 97.80
Round  42, Train loss: 0.921, Test loss: 0.935, Test accuracy: 97.74
Round  42, Global train loss: 0.921, Global test loss: 0.933, Global test accuracy: 97.96
Round  43, Train loss: 0.920, Test loss: 0.935, Test accuracy: 97.70
Round  43, Global train loss: 0.920, Global test loss: 0.933, Global test accuracy: 97.94
Round  44, Train loss: 0.920, Test loss: 0.935, Test accuracy: 97.72
Round  44, Global train loss: 0.920, Global test loss: 0.935, Global test accuracy: 97.68
Round  45, Train loss: 0.918, Test loss: 0.934, Test accuracy: 97.84
Round  45, Global train loss: 0.918, Global test loss: 0.933, Global test accuracy: 98.02
Round  46, Train loss: 0.918, Test loss: 0.934, Test accuracy: 97.86
Round  46, Global train loss: 0.918, Global test loss: 0.932, Global test accuracy: 97.98
Round  47, Train loss: 0.921, Test loss: 0.933, Test accuracy: 97.88
Round  47, Global train loss: 0.921, Global test loss: 0.932, Global test accuracy: 98.06
Round  48, Train loss: 0.921, Test loss: 0.933, Test accuracy: 97.82
Round  48, Global train loss: 0.921, Global test loss: 0.933, Global test accuracy: 97.80
Round  49, Train loss: 0.917, Test loss: 0.933, Test accuracy: 97.84
Round  49, Global train loss: 0.917, Global test loss: 0.931, Global test accuracy: 98.18
Round  50, Train loss: 0.917, Test loss: 0.932, Test accuracy: 97.86
Round  50, Global train loss: 0.917, Global test loss: 0.930, Global test accuracy: 97.98
Round  51, Train loss: 0.918, Test loss: 0.932, Test accuracy: 97.90
Round  51, Global train loss: 0.918, Global test loss: 0.931, Global test accuracy: 97.94
Round  52, Train loss: 0.917, Test loss: 0.932, Test accuracy: 97.90
Round  52, Global train loss: 0.917, Global test loss: 0.930, Global test accuracy: 97.98
Round  53, Train loss: 0.918, Test loss: 0.933, Test accuracy: 97.88
Round  53, Global train loss: 0.918, Global test loss: 0.931, Global test accuracy: 98.02
Round  54, Train loss: 0.916, Test loss: 0.932, Test accuracy: 97.86
Round  54, Global train loss: 0.916, Global test loss: 0.933, Global test accuracy: 97.82
Round  55, Train loss: 0.918, Test loss: 0.932, Test accuracy: 97.88
Round  55, Global train loss: 0.918, Global test loss: 0.931, Global test accuracy: 98.18
Round  56, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.96
Round  56, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 98.08
Round  57, Train loss: 0.915, Test loss: 0.931, Test accuracy: 97.98
Round  57, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 98.08
Round  58, Train loss: 0.914, Test loss: 0.931, Test accuracy: 97.98
Round  58, Global train loss: 0.914, Global test loss: 0.929, Global test accuracy: 98.16
Round  59, Train loss: 0.917, Test loss: 0.931, Test accuracy: 97.96
Round  59, Global train loss: 0.917, Global test loss: 0.930, Global test accuracy: 98.18
Round  60, Train loss: 0.916, Test loss: 0.932, Test accuracy: 97.94
Round  60, Global train loss: 0.916, Global test loss: 0.930, Global test accuracy: 98.18
Round  61, Train loss: 0.913, Test loss: 0.931, Test accuracy: 97.94
Round  61, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 98.24
Round  62, Train loss: 0.913, Test loss: 0.931, Test accuracy: 98.02
Round  62, Global train loss: 0.913, Global test loss: 0.928, Global test accuracy: 98.20
Round  63, Train loss: 0.914, Test loss: 0.930, Test accuracy: 98.06
Round  63, Global train loss: 0.914, Global test loss: 0.929, Global test accuracy: 98.22
Round  64, Train loss: 0.914, Test loss: 0.930, Test accuracy: 98.06
Round  64, Global train loss: 0.914, Global test loss: 0.928, Global test accuracy: 98.16
Round  65, Train loss: 0.913, Test loss: 0.931, Test accuracy: 98.04
Round  65, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 98.30
Round  66, Train loss: 0.913, Test loss: 0.930, Test accuracy: 97.96
Round  66, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 98.08
Round  67, Train loss: 0.912, Test loss: 0.930, Test accuracy: 98.14
Round  67, Global train loss: 0.912, Global test loss: 0.928, Global test accuracy: 98.26
Round  68, Train loss: 0.911, Test loss: 0.930, Test accuracy: 98.08
Round  68, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.24
Round  69, Train loss: 0.914, Test loss: 0.930, Test accuracy: 98.00
Round  69, Global train loss: 0.914, Global test loss: 0.928, Global test accuracy: 98.28
Round  70, Train loss: 0.914, Test loss: 0.930, Test accuracy: 98.04
Round  70, Global train loss: 0.914, Global test loss: 0.929, Global test accuracy: 98.06
Round  71, Train loss: 0.915, Test loss: 0.930, Test accuracy: 98.08
Round  71, Global train loss: 0.915, Global test loss: 0.928, Global test accuracy: 98.26
Round  72, Train loss: 0.915, Test loss: 0.931, Test accuracy: 98.02
Round  72, Global train loss: 0.915, Global test loss: 0.929, Global test accuracy: 98.26
Round  73, Train loss: 0.913, Test loss: 0.931, Test accuracy: 97.98
Round  73, Global train loss: 0.913, Global test loss: 0.928, Global test accuracy: 98.22
Round  74, Train loss: 0.914, Test loss: 0.931, Test accuracy: 98.00
Round  74, Global train loss: 0.914, Global test loss: 0.929, Global test accuracy: 98.24
Round  75, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.98
Round  75, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.24
Round  76, Train loss: 0.912, Test loss: 0.930, Test accuracy: 98.06
Round  76, Global train loss: 0.912, Global test loss: 0.928, Global test accuracy: 98.34
Round  77, Train loss: 0.913, Test loss: 0.930, Test accuracy: 98.08
Round  77, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 98.24
Round  78, Train loss: 0.913, Test loss: 0.930, Test accuracy: 98.10
Round  78, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 98.16
Round  79, Train loss: 0.911, Test loss: 0.929, Test accuracy: 98.14
Round  79, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.26
Round  80, Train loss: 0.912, Test loss: 0.929, Test accuracy: 98.18
Round  80, Global train loss: 0.912, Global test loss: 0.927, Global test accuracy: 98.46
Round  81, Train loss: 0.912, Test loss: 0.929, Test accuracy: 98.18
Round  81, Global train loss: 0.912, Global test loss: 0.927, Global test accuracy: 98.36
Round  82, Train loss: 0.913, Test loss: 0.929, Test accuracy: 98.18
Round  82, Global train loss: 0.913, Global test loss: 0.927, Global test accuracy: 98.32
Round  83, Train loss: 0.911, Test loss: 0.929, Test accuracy: 98.26
Round  83, Global train loss: 0.911, Global test loss: 0.926, Global test accuracy: 98.46
Round  84, Train loss: 0.911, Test loss: 0.929, Test accuracy: 98.18
Round  84, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.38
Round  85, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.26
Round  85, Global train loss: 0.911, Global test loss: 0.926, Global test accuracy: 98.44
Round  86, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.32
Round  86, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.28
Round  87, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.24
Round  87, Global train loss: 0.911, Global test loss: 0.926, Global test accuracy: 98.46
Round  88, Train loss: 0.910, Test loss: 0.928, Test accuracy: 98.28
Round  88, Global train loss: 0.910, Global test loss: 0.927, Global test accuracy: 98.38
Round  89, Train loss: 0.910, Test loss: 0.928, Test accuracy: 98.36
Round  89, Global train loss: 0.910, Global test loss: 0.926, Global test accuracy: 98.40
Round  90, Train loss: 0.913, Test loss: 0.928, Test accuracy: 98.32
Round  90, Global train loss: 0.913, Global test loss: 0.927, Global test accuracy: 98.46
Round  91, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.32
Round  91, Global train loss: 0.911, Global test loss: 0.927, Global test accuracy: 98.48
Round  92, Train loss: 0.910, Test loss: 0.928, Test accuracy: 98.32
Round  92, Global train loss: 0.910, Global test loss: 0.926, Global test accuracy: 98.42/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 0.912, Test loss: 0.928, Test accuracy: 98.32
Round  93, Global train loss: 0.912, Global test loss: 0.927, Global test accuracy: 98.38
Round  94, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.30
Round  94, Global train loss: 0.911, Global test loss: 0.926, Global test accuracy: 98.36
Round  95, Train loss: 0.910, Test loss: 0.928, Test accuracy: 98.30
Round  95, Global train loss: 0.910, Global test loss: 0.926, Global test accuracy: 98.42
Round  96, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.34
Round  96, Global train loss: 0.911, Global test loss: 0.926, Global test accuracy: 98.44
Round  97, Train loss: 0.910, Test loss: 0.928, Test accuracy: 98.38
Round  97, Global train loss: 0.910, Global test loss: 0.927, Global test accuracy: 98.38
Round  98, Train loss: 0.910, Test loss: 0.928, Test accuracy: 98.28
Round  98, Global train loss: 0.910, Global test loss: 0.926, Global test accuracy: 98.42
Round  99, Train loss: 0.911, Test loss: 0.928, Test accuracy: 98.26
Round  99, Global train loss: 0.911, Global test loss: 0.926, Global test accuracy: 98.44
Final Round, Train loss: 0.908, Test loss: 0.927, Test accuracy: 98.24
Final Round, Global train loss: 0.908, Global test loss: 0.926, Global test accuracy: 98.44
Average accuracy final 10 rounds: 98.314
714.2498772144318
[1.8398711681365967, 3.6134097576141357, 5.205051422119141, 6.845517873764038, 8.49933409690857, 9.928606033325195, 11.285088300704956, 12.506775856018066, 13.892703533172607, 15.280229091644287, 16.720461130142212, 17.964760780334473, 19.22781014442444, 20.4262592792511, 21.767170429229736, 23.079673767089844, 24.3561954498291, 25.644669771194458, 26.99191379547119, 28.214697122573853, 29.920409679412842, 31.153451204299927, 32.41465759277344, 33.72646450996399, 35.02879071235657, 36.390913009643555, 37.71198487281799, 39.03388953208923, 40.28335785865784, 41.54557228088379, 42.80846333503723, 44.10170030593872, 45.40447688102722, 46.63643550872803, 47.989787101745605, 49.443161964416504, 51.05455994606018, 52.312437534332275, 53.66102480888367, 54.9794716835022, 56.30312466621399, 57.650797605514526, 58.87997126579285, 60.11242628097534, 61.3786301612854, 62.53305149078369, 63.78341794013977, 65.02808952331543, 66.32833123207092, 67.61752486228943, 68.9116325378418, 70.21311402320862, 71.39168429374695, 72.6483473777771, 73.89359378814697, 75.1856906414032, 76.45665168762207, 77.71502685546875, 78.94932627677917, 80.17484331130981, 81.51562213897705, 82.77986097335815, 83.99861478805542, 85.28807544708252, 86.54621195793152, 87.86446833610535, 89.21601033210754, 90.50112199783325, 91.91700172424316, 93.26707220077515, 94.59835577011108, 95.94685673713684, 97.32142376899719, 98.56219577789307, 99.8700602054596, 101.15284323692322, 102.43657970428467, 103.71636986732483, 105.27739691734314, 106.84279465675354, 108.12480044364929, 109.42021703720093, 110.77151870727539, 112.00686192512512, 113.27023720741272, 114.54733371734619, 115.93680477142334, 117.31116271018982, 118.56233406066895, 119.86325097084045, 121.18422389030457, 122.52515029907227, 123.84180951118469, 124.99937796592712, 126.27481055259705, 127.5407497882843, 128.8784475326538, 130.34041285514832, 131.58220648765564, 132.88961720466614, 134.87682723999023]
[72.22, 89.52, 92.22, 94.46, 95.24, 95.76, 95.88, 96.16, 96.22, 96.36, 96.72, 96.48, 96.56, 96.58, 96.86, 96.96, 97.1, 97.14, 97.06, 97.18, 97.24, 97.16, 97.28, 97.26, 97.22, 97.16, 97.18, 97.48, 97.46, 97.38, 97.4, 97.54, 97.46, 97.48, 97.42, 97.4, 97.42, 97.48, 97.58, 97.78, 97.56, 97.76, 97.74, 97.7, 97.72, 97.84, 97.86, 97.88, 97.82, 97.84, 97.86, 97.9, 97.9, 97.88, 97.86, 97.88, 97.96, 97.98, 97.98, 97.96, 97.94, 97.94, 98.02, 98.06, 98.06, 98.04, 97.96, 98.14, 98.08, 98.0, 98.04, 98.08, 98.02, 97.98, 98.0, 97.98, 98.06, 98.08, 98.1, 98.14, 98.18, 98.18, 98.18, 98.26, 98.18, 98.26, 98.32, 98.24, 98.28, 98.36, 98.32, 98.32, 98.32, 98.32, 98.3, 98.3, 98.34, 98.38, 98.28, 98.26, 98.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.622, Test loss: 1.580, Test accuracy: 32.96
Round   0, Global train loss: 1.622, Global test loss: 1.580, Global test accuracy: 33.02
Round   1, Train loss: 1.542, Test loss: 1.459, Test accuracy: 71.66
Round   1, Global train loss: 1.542, Global test loss: 1.459, Global test accuracy: 71.52
Round   2, Train loss: 1.381, Test loss: 1.224, Test accuracy: 90.38
Round   2, Global train loss: 1.381, Global test loss: 1.224, Global test accuracy: 90.36
Round   3, Train loss: 1.119, Test loss: 1.028, Test accuracy: 94.36
Round   3, Global train loss: 1.119, Global test loss: 1.027, Global test accuracy: 94.40
Round   4, Train loss: 1.009, Test loss: 0.987, Test accuracy: 95.40
Round   4, Global train loss: 1.009, Global test loss: 0.986, Global test accuracy: 95.52
Round   5, Train loss: 0.985, Test loss: 0.972, Test accuracy: 95.74
Round   5, Global train loss: 0.985, Global test loss: 0.971, Global test accuracy: 95.84
Round   6, Train loss: 0.973, Test loss: 0.964, Test accuracy: 95.92
Round   6, Global train loss: 0.973, Global test loss: 0.963, Global test accuracy: 96.12
Round   7, Train loss: 0.966, Test loss: 0.959, Test accuracy: 96.14
Round   7, Global train loss: 0.966, Global test loss: 0.959, Global test accuracy: 96.34
Round   8, Train loss: 0.960, Test loss: 0.956, Test accuracy: 96.34
Round   8, Global train loss: 0.960, Global test loss: 0.955, Global test accuracy: 96.44
Round   9, Train loss: 0.956, Test loss: 0.953, Test accuracy: 96.46
Round   9, Global train loss: 0.956, Global test loss: 0.952, Global test accuracy: 96.62
Round  10, Train loss: 0.948, Test loss: 0.952, Test accuracy: 96.54
Round  10, Global train loss: 0.948, Global test loss: 0.951, Global test accuracy: 96.62
Round  11, Train loss: 0.948, Test loss: 0.950, Test accuracy: 96.72
Round  11, Global train loss: 0.948, Global test loss: 0.949, Global test accuracy: 96.96
Round  12, Train loss: 0.937, Test loss: 0.949, Test accuracy: 96.74
Round  12, Global train loss: 0.937, Global test loss: 0.949, Global test accuracy: 96.82
Round  13, Train loss: 0.934, Test loss: 0.948, Test accuracy: 96.76
Round  13, Global train loss: 0.934, Global test loss: 0.947, Global test accuracy: 96.76
Round  14, Train loss: 0.939, Test loss: 0.948, Test accuracy: 96.58
Round  14, Global train loss: 0.939, Global test loss: 0.947, Global test accuracy: 96.74
Round  15, Train loss: 0.936, Test loss: 0.947, Test accuracy: 96.66
Round  15, Global train loss: 0.936, Global test loss: 0.946, Global test accuracy: 96.84
Round  16, Train loss: 0.931, Test loss: 0.947, Test accuracy: 96.62
Round  16, Global train loss: 0.931, Global test loss: 0.946, Global test accuracy: 96.70
Round  17, Train loss: 0.930, Test loss: 0.947, Test accuracy: 96.64
Round  17, Global train loss: 0.930, Global test loss: 0.945, Global test accuracy: 96.74
Round  18, Train loss: 0.929, Test loss: 0.946, Test accuracy: 96.78
Round  18, Global train loss: 0.929, Global test loss: 0.945, Global test accuracy: 96.80
Round  19, Train loss: 0.930, Test loss: 0.945, Test accuracy: 96.76
Round  19, Global train loss: 0.930, Global test loss: 0.943, Global test accuracy: 96.78
Round  20, Train loss: 0.926, Test loss: 0.944, Test accuracy: 96.88
Round  20, Global train loss: 0.926, Global test loss: 0.943, Global test accuracy: 97.04
Round  21, Train loss: 0.925, Test loss: 0.944, Test accuracy: 96.80
Round  21, Global train loss: 0.925, Global test loss: 0.942, Global test accuracy: 97.14
Round  22, Train loss: 0.926, Test loss: 0.943, Test accuracy: 96.94
Round  22, Global train loss: 0.926, Global test loss: 0.942, Global test accuracy: 97.12
Round  23, Train loss: 0.924, Test loss: 0.943, Test accuracy: 96.92
Round  23, Global train loss: 0.924, Global test loss: 0.941, Global test accuracy: 97.04
Round  24, Train loss: 0.924, Test loss: 0.942, Test accuracy: 97.24
Round  24, Global train loss: 0.924, Global test loss: 0.941, Global test accuracy: 97.18
Round  25, Train loss: 0.925, Test loss: 0.941, Test accuracy: 97.24
Round  25, Global train loss: 0.925, Global test loss: 0.940, Global test accuracy: 97.32
Round  26, Train loss: 0.921, Test loss: 0.941, Test accuracy: 97.28
Round  26, Global train loss: 0.921, Global test loss: 0.940, Global test accuracy: 97.48
Round  27, Train loss: 0.919, Test loss: 0.941, Test accuracy: 97.24
Round  27, Global train loss: 0.919, Global test loss: 0.939, Global test accuracy: 97.36
Round  28, Train loss: 0.921, Test loss: 0.941, Test accuracy: 97.10
Round  28, Global train loss: 0.921, Global test loss: 0.940, Global test accuracy: 97.36
Round  29, Train loss: 0.922, Test loss: 0.941, Test accuracy: 97.22
Round  29, Global train loss: 0.922, Global test loss: 0.941, Global test accuracy: 97.18
Round  30, Train loss: 0.922, Test loss: 0.939, Test accuracy: 97.32
Round  30, Global train loss: 0.922, Global test loss: 0.938, Global test accuracy: 97.60
Round  31, Train loss: 0.918, Test loss: 0.939, Test accuracy: 97.38
Round  31, Global train loss: 0.918, Global test loss: 0.938, Global test accuracy: 97.46
Round  32, Train loss: 0.920, Test loss: 0.939, Test accuracy: 97.50
Round  32, Global train loss: 0.920, Global test loss: 0.938, Global test accuracy: 97.46
Round  33, Train loss: 0.921, Test loss: 0.939, Test accuracy: 97.46
Round  33, Global train loss: 0.921, Global test loss: 0.940, Global test accuracy: 97.24
Round  34, Train loss: 0.917, Test loss: 0.938, Test accuracy: 97.50
Round  34, Global train loss: 0.917, Global test loss: 0.936, Global test accuracy: 97.74
Round  35, Train loss: 0.915, Test loss: 0.938, Test accuracy: 97.44
Round  35, Global train loss: 0.915, Global test loss: 0.937, Global test accuracy: 97.48
Round  36, Train loss: 0.919, Test loss: 0.938, Test accuracy: 97.46
Round  36, Global train loss: 0.919, Global test loss: 0.936, Global test accuracy: 97.66
Round  37, Train loss: 0.921, Test loss: 0.937, Test accuracy: 97.54
Round  37, Global train loss: 0.921, Global test loss: 0.937, Global test accuracy: 97.70
Round  38, Train loss: 0.921, Test loss: 0.936, Test accuracy: 97.60
Round  38, Global train loss: 0.921, Global test loss: 0.935, Global test accuracy: 97.88
Round  39, Train loss: 0.919, Test loss: 0.936, Test accuracy: 97.66
Round  39, Global train loss: 0.919, Global test loss: 0.935, Global test accuracy: 97.72
Round  40, Train loss: 0.915, Test loss: 0.936, Test accuracy: 97.64
Round  40, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 97.80
Round  41, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.62
Round  41, Global train loss: 0.922, Global test loss: 0.934, Global test accuracy: 97.82
Round  42, Train loss: 0.917, Test loss: 0.935, Test accuracy: 97.70
Round  42, Global train loss: 0.917, Global test loss: 0.935, Global test accuracy: 97.74
Round  43, Train loss: 0.918, Test loss: 0.935, Test accuracy: 97.66
Round  43, Global train loss: 0.918, Global test loss: 0.934, Global test accuracy: 97.82
Round  44, Train loss: 0.915, Test loss: 0.935, Test accuracy: 97.66
Round  44, Global train loss: 0.915, Global test loss: 0.934, Global test accuracy: 97.84
Round  45, Train loss: 0.918, Test loss: 0.935, Test accuracy: 97.74
Round  45, Global train loss: 0.918, Global test loss: 0.934, Global test accuracy: 97.86
Round  46, Train loss: 0.916, Test loss: 0.934, Test accuracy: 97.82
Round  46, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 97.78
Round  47, Train loss: 0.917, Test loss: 0.934, Test accuracy: 97.90
Round  47, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.96
Round  48, Train loss: 0.917, Test loss: 0.934, Test accuracy: 97.94
Round  48, Global train loss: 0.917, Global test loss: 0.932, Global test accuracy: 97.92
Round  49, Train loss: 0.914, Test loss: 0.934, Test accuracy: 97.80
Round  49, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.96
Round  50, Train loss: 0.914, Test loss: 0.934, Test accuracy: 97.74
Round  50, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.84
Round  51, Train loss: 0.913, Test loss: 0.934, Test accuracy: 97.78
Round  51, Global train loss: 0.913, Global test loss: 0.933, Global test accuracy: 97.90
Round  52, Train loss: 0.918, Test loss: 0.933, Test accuracy: 97.80
Round  52, Global train loss: 0.918, Global test loss: 0.932, Global test accuracy: 97.92
Round  53, Train loss: 0.917, Test loss: 0.933, Test accuracy: 97.90
Round  53, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.82
Round  54, Train loss: 0.915, Test loss: 0.933, Test accuracy: 97.80
Round  54, Global train loss: 0.915, Global test loss: 0.933, Global test accuracy: 97.98
Round  55, Train loss: 0.914, Test loss: 0.933, Test accuracy: 97.76
Round  55, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.90
Round  56, Train loss: 0.915, Test loss: 0.933, Test accuracy: 97.82
Round  56, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.92
Round  57, Train loss: 0.912, Test loss: 0.933, Test accuracy: 97.78
Round  57, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 97.94
Round  58, Train loss: 0.912, Test loss: 0.933, Test accuracy: 97.78
Round  58, Global train loss: 0.912, Global test loss: 0.932, Global test accuracy: 97.98
Round  59, Train loss: 0.915, Test loss: 0.932, Test accuracy: 97.70
Round  59, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 97.82
Round  60, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.84
Round  60, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 97.98
Round  61, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.84
Round  61, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 98.10
Round  62, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.82
Round  62, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 98.22
Round  63, Train loss: 0.914, Test loss: 0.932, Test accuracy: 97.86
Round  63, Global train loss: 0.914, Global test loss: 0.930, Global test accuracy: 98.04
Round  64, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.84
Round  64, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 98.12
Round  65, Train loss: 0.911, Test loss: 0.931, Test accuracy: 97.80
Round  65, Global train loss: 0.911, Global test loss: 0.931, Global test accuracy: 98.06
Round  66, Train loss: 0.913, Test loss: 0.932, Test accuracy: 97.76
Round  66, Global train loss: 0.913, Global test loss: 0.931, Global test accuracy: 97.90
Round  67, Train loss: 0.913, Test loss: 0.931, Test accuracy: 97.90
Round  67, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 98.08
Round  68, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.90
Round  68, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 98.02
Round  69, Train loss: 0.913, Test loss: 0.931, Test accuracy: 97.88
Round  69, Global train loss: 0.913, Global test loss: 0.929, Global test accuracy: 98.06
Round  70, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.94
Round  70, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.10
Round  71, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.92
Round  71, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.16
Round  72, Train loss: 0.912, Test loss: 0.931, Test accuracy: 97.98
Round  72, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.10
Round  73, Train loss: 0.913, Test loss: 0.931, Test accuracy: 97.92
Round  73, Global train loss: 0.913, Global test loss: 0.930, Global test accuracy: 97.96
Round  74, Train loss: 0.912, Test loss: 0.931, Test accuracy: 98.04
Round  74, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.26
Round  75, Train loss: 0.912, Test loss: 0.931, Test accuracy: 98.00
Round  75, Global train loss: 0.912, Global test loss: 0.930, Global test accuracy: 98.18
Round  76, Train loss: 0.911, Test loss: 0.931, Test accuracy: 97.88
Round  76, Global train loss: 0.911, Global test loss: 0.930, Global test accuracy: 98.08
Round  77, Train loss: 0.911, Test loss: 0.930, Test accuracy: 97.96
Round  77, Global train loss: 0.911, Global test loss: 0.929, Global test accuracy: 98.34
Round  78, Train loss: 0.911, Test loss: 0.930, Test accuracy: 98.00
Round  78, Global train loss: 0.911, Global test loss: 0.929, Global test accuracy: 98.26
Round  79, Train loss: 0.911, Test loss: 0.930, Test accuracy: 98.02
Round  79, Global train loss: 0.911, Global test loss: 0.929, Global test accuracy: 98.24
Round  80, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.98
Round  80, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.18
Round  81, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.96
Round  81, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.26
Round  82, Train loss: 0.912, Test loss: 0.930, Test accuracy: 97.92
Round  82, Global train loss: 0.912, Global test loss: 0.929, Global test accuracy: 98.24
Round  83, Train loss: 0.911, Test loss: 0.930, Test accuracy: 97.92
Round  83, Global train loss: 0.911, Global test loss: 0.929, Global test accuracy: 98.24
Round  84, Train loss: 0.911, Test loss: 0.930, Test accuracy: 97.94
Round  84, Global train loss: 0.911, Global test loss: 0.929, Global test accuracy: 98.24
Round  85, Train loss: 0.911, Test loss: 0.930, Test accuracy: 97.96
Round  85, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.24
Round  86, Train loss: 0.911, Test loss: 0.930, Test accuracy: 97.98
Round  86, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.28
Round  87, Train loss: 0.911, Test loss: 0.930, Test accuracy: 98.00
Round  87, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.30
Round  88, Train loss: 0.911, Test loss: 0.930, Test accuracy: 98.02
Round  88, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.28
Round  89, Train loss: 0.911, Test loss: 0.929, Test accuracy: 98.00
Round  89, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.28
Round  90, Train loss: 0.911, Test loss: 0.929, Test accuracy: 97.98
Round  90, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.28
Round  91, Train loss: 0.911, Test loss: 0.929, Test accuracy: 97.98
Round  91, Global train loss: 0.911, Global test loss: 0.928, Global test accuracy: 98.26
Round  92, Train loss: 0.910, Test loss: 0.929, Test accuracy: 97.96
Round  92, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.26/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 0.910, Test loss: 0.929, Test accuracy: 97.96
Round  93, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.26
Round  94, Train loss: 0.910, Test loss: 0.929, Test accuracy: 98.00
Round  94, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.22
Round  95, Train loss: 0.910, Test loss: 0.929, Test accuracy: 97.98
Round  95, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.22
Round  96, Train loss: 0.910, Test loss: 0.929, Test accuracy: 98.00
Round  96, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.22
Round  97, Train loss: 0.910, Test loss: 0.929, Test accuracy: 98.02
Round  97, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.20
Round  98, Train loss: 0.910, Test loss: 0.929, Test accuracy: 98.00
Round  98, Global train loss: 0.910, Global test loss: 0.928, Global test accuracy: 98.20
Round  99, Train loss: 0.910, Test loss: 0.929, Test accuracy: 98.00
Round  99, Global train loss: 0.910, Global test loss: 0.927, Global test accuracy: 98.38
Final Round, Train loss: 0.910, Test loss: 0.929, Test accuracy: 97.94
Final Round, Global train loss: 0.910, Global test loss: 0.927, Global test accuracy: 98.38
Average accuracy final 10 rounds: 97.988
1714.5851793289185
[1.6943912506103516, 3.276880979537964, 4.833513259887695, 6.382340431213379, 7.876378297805786, 9.353358507156372, 10.948403358459473, 12.79131555557251, 14.453400373458862, 16.133836030960083, 21.241942882537842, 22.7367742061615, 30.976223468780518, 39.10850524902344, 47.94679522514343, 56.77263283729553, 65.47661638259888, 74.25611758232117, 84.76630997657776, 93.44366693496704, 102.2865731716156, 110.75385117530823, 120.34814047813416, 129.2959372997284, 138.1077184677124, 146.5571506023407, 155.3014612197876, 163.69383215904236, 172.2529640197754, 180.95812916755676, 189.41216897964478, 198.2247462272644, 206.66853737831116, 215.6785569190979, 224.48695158958435, 234.4616515636444, 244.27265214920044, 245.8666296005249, 254.5987105369568, 263.216189622879, 272.2568073272705, 273.7957944869995, 282.5005533695221, 291.0315110683441, 299.33130860328674, 300.88494777679443, 309.43746185302734, 318.11112451553345, 326.93086528778076, 335.4708547592163, 344.24075961112976, 353.06420063972473, 354.58792519569397, 362.7722520828247, 371.3367691040039, 379.9978003501892, 388.93424010276794, 397.60471296310425, 405.9896650314331, 407.5204830169678, 416.161993265152, 425.69697523117065, 434.1165955066681, 442.6649947166443, 444.14787197113037, 452.6075131893158, 461.1624827384949, 469.85399079322815, 479.8764672279358, 487.7708508968353, 496.704776763916, 505.3403329849243, 514.0439946651459, 522.6060020923615, 530.8930232524872, 539.5699994564056, 547.985641002655, 556.4981234073639, 565.1794216632843, 573.5921537876129, 575.1021211147308, 576.5515985488892, 578.0512473583221, 579.5737030506134, 581.109320640564, 582.5886001586914, 584.0266394615173, 585.5462493896484, 587.3267529010773, 588.787433385849, 590.632913351059, 592.2863450050354, 593.7394552230835, 595.3390021324158, 596.8164365291595, 598.4547502994537, 600.0162644386292, 601.5022749900818, 602.9973123073578, 612.0952293872833, 620.5026168823242]
[32.96, 71.66, 90.38, 94.36, 95.4, 95.74, 95.92, 96.14, 96.34, 96.46, 96.54, 96.72, 96.74, 96.76, 96.58, 96.66, 96.62, 96.64, 96.78, 96.76, 96.88, 96.8, 96.94, 96.92, 97.24, 97.24, 97.28, 97.24, 97.1, 97.22, 97.32, 97.38, 97.5, 97.46, 97.5, 97.44, 97.46, 97.54, 97.6, 97.66, 97.64, 97.62, 97.7, 97.66, 97.66, 97.74, 97.82, 97.9, 97.94, 97.8, 97.74, 97.78, 97.8, 97.9, 97.8, 97.76, 97.82, 97.78, 97.78, 97.7, 97.84, 97.84, 97.82, 97.86, 97.84, 97.8, 97.76, 97.9, 97.9, 97.88, 97.94, 97.92, 97.98, 97.92, 98.04, 98.0, 97.88, 97.96, 98.0, 98.02, 97.98, 97.96, 97.92, 97.92, 97.94, 97.96, 97.98, 98.0, 98.02, 98.0, 97.98, 97.98, 97.96, 97.96, 98.0, 97.98, 98.0, 98.02, 98.0, 98.0, 97.94]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.583, Test loss: 1.525, Test accuracy: 77.00
Round   0, Global train loss: 1.583, Global test loss: 1.525, Global test accuracy: 78.04
Round   1, Train loss: 1.352, Test loss: 1.220, Test accuracy: 87.78
Round   1, Global train loss: 1.352, Global test loss: 1.085, Global test accuracy: 93.66
Round   2, Train loss: 1.162, Test loss: 1.116, Test accuracy: 91.26
Round   2, Global train loss: 1.162, Global test loss: 1.003, Global test accuracy: 94.22
Round   3, Train loss: 1.115, Test loss: 1.054, Test accuracy: 92.42
Round   3, Global train loss: 1.115, Global test loss: 0.993, Global test accuracy: 94.64
Round   4, Train loss: 1.199, Test loss: 1.047, Test accuracy: 92.28
Round   4, Global train loss: 1.199, Global test loss: 0.977, Global test accuracy: 95.26
Round   5, Train loss: 1.081, Test loss: 0.997, Test accuracy: 94.06
Round   5, Global train loss: 1.081, Global test loss: 0.975, Global test accuracy: 95.54
Round   6, Train loss: 0.976, Test loss: 0.988, Test accuracy: 94.28
Round   6, Global train loss: 0.976, Global test loss: 0.970, Global test accuracy: 95.26
Round   7, Train loss: 1.063, Test loss: 0.978, Test accuracy: 94.34
Round   7, Global train loss: 1.063, Global test loss: 0.970, Global test accuracy: 95.42
Round   8, Train loss: 1.031, Test loss: 0.976, Test accuracy: 94.54
Round   8, Global train loss: 1.031, Global test loss: 0.962, Global test accuracy: 95.36
Round   9, Train loss: 0.971, Test loss: 0.974, Test accuracy: 94.62
Round   9, Global train loss: 0.971, Global test loss: 0.957, Global test accuracy: 95.86
Round  10, Train loss: 0.986, Test loss: 0.972, Test accuracy: 94.68
Round  10, Global train loss: 0.986, Global test loss: 0.957, Global test accuracy: 95.74
Round  11, Train loss: 0.961, Test loss: 0.970, Test accuracy: 94.74
Round  11, Global train loss: 0.961, Global test loss: 0.957, Global test accuracy: 95.58
Round  12, Train loss: 0.960, Test loss: 0.969, Test accuracy: 94.66
Round  12, Global train loss: 0.960, Global test loss: 0.960, Global test accuracy: 95.24
Round  13, Train loss: 1.052, Test loss: 0.968, Test accuracy: 94.86
Round  13, Global train loss: 1.052, Global test loss: 0.957, Global test accuracy: 95.82
Round  14, Train loss: 1.025, Test loss: 0.967, Test accuracy: 94.80
Round  14, Global train loss: 1.025, Global test loss: 0.962, Global test accuracy: 95.22
Round  15, Train loss: 1.050, Test loss: 0.968, Test accuracy: 94.74
Round  15, Global train loss: 1.050, Global test loss: 0.958, Global test accuracy: 95.52
Round  16, Train loss: 1.013, Test loss: 0.969, Test accuracy: 94.46
Round  16, Global train loss: 1.013, Global test loss: 0.956, Global test accuracy: 95.70
Round  17, Train loss: 1.020, Test loss: 0.968, Test accuracy: 94.34
Round  17, Global train loss: 1.020, Global test loss: 0.956, Global test accuracy: 95.60
Round  18, Train loss: 0.949, Test loss: 0.968, Test accuracy: 94.36
Round  18, Global train loss: 0.949, Global test loss: 0.950, Global test accuracy: 95.84
Round  19, Train loss: 1.112, Test loss: 0.968, Test accuracy: 94.44
Round  19, Global train loss: 1.112, Global test loss: 0.958, Global test accuracy: 95.34
Round  20, Train loss: 1.108, Test loss: 0.968, Test accuracy: 94.40
Round  20, Global train loss: 1.108, Global test loss: 0.961, Global test accuracy: 95.16
Round  21, Train loss: 0.913, Test loss: 0.968, Test accuracy: 94.36
Round  21, Global train loss: 0.913, Global test loss: 0.949, Global test accuracy: 95.88
Round  22, Train loss: 0.933, Test loss: 0.967, Test accuracy: 94.40
Round  22, Global train loss: 0.933, Global test loss: 0.950, Global test accuracy: 95.96
Round  23, Train loss: 0.916, Test loss: 0.967, Test accuracy: 94.36
Round  23, Global train loss: 0.916, Global test loss: 0.951, Global test accuracy: 95.78
Round  24, Train loss: 0.936, Test loss: 0.967, Test accuracy: 94.34
Round  24, Global train loss: 0.936, Global test loss: 0.952, Global test accuracy: 95.64
Round  25, Train loss: 0.967, Test loss: 0.967, Test accuracy: 94.44
Round  25, Global train loss: 0.967, Global test loss: 0.954, Global test accuracy: 95.50
Round  26, Train loss: 0.946, Test loss: 0.966, Test accuracy: 94.44
Round  26, Global train loss: 0.946, Global test loss: 0.948, Global test accuracy: 96.22
Round  27, Train loss: 1.037, Test loss: 0.967, Test accuracy: 94.34
Round  27, Global train loss: 1.037, Global test loss: 0.959, Global test accuracy: 94.94
Round  28, Train loss: 0.932, Test loss: 0.967, Test accuracy: 94.32
Round  28, Global train loss: 0.932, Global test loss: 0.944, Global test accuracy: 96.62
Round  29, Train loss: 0.946, Test loss: 0.966, Test accuracy: 94.36
Round  29, Global train loss: 0.946, Global test loss: 0.949, Global test accuracy: 95.92
Round  30, Train loss: 0.931, Test loss: 0.966, Test accuracy: 94.32
Round  30, Global train loss: 0.931, Global test loss: 0.951, Global test accuracy: 95.76
Round  31, Train loss: 0.931, Test loss: 0.966, Test accuracy: 94.30
Round  31, Global train loss: 0.931, Global test loss: 0.948, Global test accuracy: 96.02
Round  32, Train loss: 0.912, Test loss: 0.966, Test accuracy: 94.36
Round  32, Global train loss: 0.912, Global test loss: 0.950, Global test accuracy: 95.94
Round  33, Train loss: 0.944, Test loss: 0.966, Test accuracy: 94.36
Round  33, Global train loss: 0.944, Global test loss: 0.953, Global test accuracy: 95.54
Round  34, Train loss: 0.912, Test loss: 0.966, Test accuracy: 94.36
Round  34, Global train loss: 0.912, Global test loss: 0.948, Global test accuracy: 95.74
Round  35, Train loss: 1.001, Test loss: 0.966, Test accuracy: 94.36
Round  35, Global train loss: 1.001, Global test loss: 0.949, Global test accuracy: 95.94
Round  36, Train loss: 1.022, Test loss: 0.966, Test accuracy: 94.30
Round  36, Global train loss: 1.022, Global test loss: 0.955, Global test accuracy: 95.48
Round  37, Train loss: 1.000, Test loss: 0.966, Test accuracy: 94.26
Round  37, Global train loss: 1.000, Global test loss: 0.949, Global test accuracy: 95.92
Round  38, Train loss: 0.998, Test loss: 0.966, Test accuracy: 94.26
Round  38, Global train loss: 0.998, Global test loss: 0.949, Global test accuracy: 95.90
Round  39, Train loss: 0.933, Test loss: 0.966, Test accuracy: 94.34
Round  39, Global train loss: 0.933, Global test loss: 0.951, Global test accuracy: 95.78
Round  40, Train loss: 0.998, Test loss: 0.966, Test accuracy: 94.28
Round  40, Global train loss: 0.998, Global test loss: 0.951, Global test accuracy: 95.74
Round  41, Train loss: 1.031, Test loss: 0.966, Test accuracy: 94.26
Round  41, Global train loss: 1.031, Global test loss: 0.950, Global test accuracy: 96.34
Round  42, Train loss: 1.119, Test loss: 0.966, Test accuracy: 94.22
Round  42, Global train loss: 1.119, Global test loss: 0.960, Global test accuracy: 94.92
Round  43, Train loss: 1.098, Test loss: 0.966, Test accuracy: 94.20
Round  43, Global train loss: 1.098, Global test loss: 0.956, Global test accuracy: 95.34
Round  44, Train loss: 0.930, Test loss: 0.966, Test accuracy: 94.18
Round  44, Global train loss: 0.930, Global test loss: 0.947, Global test accuracy: 96.04
Round  45, Train loss: 1.037, Test loss: 0.966, Test accuracy: 94.14
Round  45, Global train loss: 1.037, Global test loss: 0.953, Global test accuracy: 95.68
Round  46, Train loss: 0.963, Test loss: 0.966, Test accuracy: 94.20
Round  46, Global train loss: 0.963, Global test loss: 0.949, Global test accuracy: 95.86
Round  47, Train loss: 0.945, Test loss: 0.966, Test accuracy: 94.18
Round  47, Global train loss: 0.945, Global test loss: 0.951, Global test accuracy: 95.82
Round  48, Train loss: 1.044, Test loss: 0.966, Test accuracy: 94.22
Round  48, Global train loss: 1.044, Global test loss: 0.953, Global test accuracy: 95.48
Round  49, Train loss: 0.910, Test loss: 0.966, Test accuracy: 94.22
Round  49, Global train loss: 0.910, Global test loss: 0.944, Global test accuracy: 96.52
Round  50, Train loss: 0.911, Test loss: 0.966, Test accuracy: 94.22
Round  50, Global train loss: 0.911, Global test loss: 0.948, Global test accuracy: 96.00
Round  51, Train loss: 1.096, Test loss: 0.966, Test accuracy: 94.22
Round  51, Global train loss: 1.096, Global test loss: 0.957, Global test accuracy: 95.34
Round  52, Train loss: 0.944, Test loss: 0.966, Test accuracy: 94.24
Round  52, Global train loss: 0.944, Global test loss: 0.946, Global test accuracy: 96.16
Round  53, Train loss: 1.029, Test loss: 0.966, Test accuracy: 94.22
Round  53, Global train loss: 1.029, Global test loss: 0.953, Global test accuracy: 95.60
Round  54, Train loss: 0.963, Test loss: 0.966, Test accuracy: 94.22
Round  54, Global train loss: 0.963, Global test loss: 0.954, Global test accuracy: 95.38
Round  55, Train loss: 0.945, Test loss: 0.966, Test accuracy: 94.22
Round  55, Global train loss: 0.945, Global test loss: 0.947, Global test accuracy: 95.94
Round  56, Train loss: 1.029, Test loss: 0.966, Test accuracy: 94.18
Round  56, Global train loss: 1.029, Global test loss: 0.950, Global test accuracy: 95.90
Round  57, Train loss: 1.095, Test loss: 0.966, Test accuracy: 94.18
Round  57, Global train loss: 1.095, Global test loss: 0.957, Global test accuracy: 95.32
Round  58, Train loss: 0.912, Test loss: 0.966, Test accuracy: 94.18
Round  58, Global train loss: 0.912, Global test loss: 0.943, Global test accuracy: 96.56
Round  59, Train loss: 0.943, Test loss: 0.966, Test accuracy: 94.16
Round  59, Global train loss: 0.943, Global test loss: 0.949, Global test accuracy: 95.92
Round  60, Train loss: 0.944, Test loss: 0.966, Test accuracy: 94.18
Round  60, Global train loss: 0.944, Global test loss: 0.955, Global test accuracy: 95.16
Round  61, Train loss: 1.031, Test loss: 0.966, Test accuracy: 94.18
Round  61, Global train loss: 1.031, Global test loss: 0.951, Global test accuracy: 95.56
Round  62, Train loss: 1.036, Test loss: 0.966, Test accuracy: 94.18
Round  62, Global train loss: 1.036, Global test loss: 0.952, Global test accuracy: 95.72
Round  63, Train loss: 1.047, Test loss: 0.966, Test accuracy: 94.18
Round  63, Global train loss: 1.047, Global test loss: 0.952, Global test accuracy: 95.52
Round  64, Train loss: 0.964, Test loss: 0.966, Test accuracy: 94.18
Round  64, Global train loss: 0.964, Global test loss: 0.950, Global test accuracy: 95.62
Round  65, Train loss: 1.042, Test loss: 0.966, Test accuracy: 94.18
Round  65, Global train loss: 1.042, Global test loss: 0.954, Global test accuracy: 95.32
Round  66, Train loss: 1.007, Test loss: 0.966, Test accuracy: 94.16
Round  66, Global train loss: 1.007, Global test loss: 0.950, Global test accuracy: 95.84
Round  67, Train loss: 0.982, Test loss: 0.966, Test accuracy: 94.18
Round  67, Global train loss: 0.982, Global test loss: 0.949, Global test accuracy: 96.04
Round  68, Train loss: 1.026, Test loss: 0.966, Test accuracy: 94.16
Round  68, Global train loss: 1.026, Global test loss: 0.951, Global test accuracy: 95.68
Round  69, Train loss: 1.007, Test loss: 0.966, Test accuracy: 94.16
Round  69, Global train loss: 1.007, Global test loss: 0.954, Global test accuracy: 95.20
Round  70, Train loss: 1.006, Test loss: 0.966, Test accuracy: 94.12
Round  70, Global train loss: 1.006, Global test loss: 0.947, Global test accuracy: 96.02
Round  71, Train loss: 0.928, Test loss: 0.966, Test accuracy: 94.14
Round  71, Global train loss: 0.928, Global test loss: 0.950, Global test accuracy: 95.82
Round  72, Train loss: 0.995, Test loss: 0.966, Test accuracy: 94.14
Round  72, Global train loss: 0.995, Global test loss: 0.951, Global test accuracy: 95.70
Round  73, Train loss: 1.015, Test loss: 0.966, Test accuracy: 94.16
Round  73, Global train loss: 1.015, Global test loss: 0.951, Global test accuracy: 95.70
Round  74, Train loss: 0.945, Test loss: 0.966, Test accuracy: 94.16
Round  74, Global train loss: 0.945, Global test loss: 0.947, Global test accuracy: 95.92
Round  75, Train loss: 1.006, Test loss: 0.966, Test accuracy: 94.16
Round  75, Global train loss: 1.006, Global test loss: 0.952, Global test accuracy: 95.84
Round  76, Train loss: 0.928, Test loss: 0.966, Test accuracy: 94.16
Round  76, Global train loss: 0.928, Global test loss: 0.950, Global test accuracy: 95.70
Round  77, Train loss: 0.929, Test loss: 0.966, Test accuracy: 94.18
Round  77, Global train loss: 0.929, Global test loss: 0.953, Global test accuracy: 95.52
Round  78, Train loss: 1.015, Test loss: 0.966, Test accuracy: 94.20
Round  78, Global train loss: 1.015, Global test loss: 0.953, Global test accuracy: 95.60
Round  79, Train loss: 1.059, Test loss: 0.966, Test accuracy: 94.12
Round  79, Global train loss: 1.059, Global test loss: 0.955, Global test accuracy: 95.32
Round  80, Train loss: 1.016, Test loss: 0.966, Test accuracy: 94.14
Round  80, Global train loss: 1.016, Global test loss: 0.950, Global test accuracy: 95.58
Round  81, Train loss: 1.093, Test loss: 0.966, Test accuracy: 94.06
Round  81, Global train loss: 1.093, Global test loss: 0.955, Global test accuracy: 95.36
Round  82, Train loss: 1.025, Test loss: 0.966, Test accuracy: 94.02
Round  82, Global train loss: 1.025, Global test loss: 0.953, Global test accuracy: 95.52
Round  83, Train loss: 1.090, Test loss: 0.966, Test accuracy: 94.08
Round  83, Global train loss: 1.090, Global test loss: 0.957, Global test accuracy: 95.10
Round  84, Train loss: 1.025, Test loss: 0.966, Test accuracy: 94.06
Round  84, Global train loss: 1.025, Global test loss: 0.953, Global test accuracy: 95.48
Round  85, Train loss: 1.005, Test loss: 0.966, Test accuracy: 94.02
Round  85, Global train loss: 1.005, Global test loss: 0.944, Global test accuracy: 96.48
Round  86, Train loss: 1.038, Test loss: 0.966, Test accuracy: 94.10
Round  86, Global train loss: 1.038, Global test loss: 0.951, Global test accuracy: 95.48
Round  87, Train loss: 1.041, Test loss: 0.966, Test accuracy: 94.12
Round  87, Global train loss: 1.041, Global test loss: 0.951, Global test accuracy: 95.48
Round  88, Train loss: 1.023, Test loss: 0.966, Test accuracy: 94.10
Round  88, Global train loss: 1.023, Global test loss: 0.949, Global test accuracy: 95.96
Round  89, Train loss: 1.003, Test loss: 0.966, Test accuracy: 94.10
Round  89, Global train loss: 1.003, Global test loss: 0.944, Global test accuracy: 96.50
Round  90, Train loss: 0.997, Test loss: 0.966, Test accuracy: 94.02
Round  90, Global train loss: 0.997, Global test loss: 0.950, Global test accuracy: 95.60
Round  91, Train loss: 0.930, Test loss: 0.966, Test accuracy: 94.04
Round  91, Global train loss: 0.930, Global test loss: 0.943, Global test accuracy: 96.42
Round  92, Train loss: 1.002, Test loss: 0.966, Test accuracy: 94.06
Round  92, Global train loss: 1.002, Global test loss: 0.951, Global test accuracy: 95.74
Round  93, Train loss: 0.995, Test loss: 0.967, Test accuracy: 94.04
Round  93, Global train loss: 0.995, Global test loss: 0.951, Global test accuracy: 95.62
Round  94, Train loss: 1.015, Test loss: 0.967, Test accuracy: 94.10
Round  94, Global train loss: 1.015, Global test loss: 0.947, Global test accuracy: 95.94
Round  95, Train loss: 1.023, Test loss: 0.967, Test accuracy: 94.06
Round  95, Global train loss: 1.023, Global test loss: 0.948, Global test accuracy: 95.98/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.022, Test loss: 0.967, Test accuracy: 94.08
Round  96, Global train loss: 1.022, Global test loss: 0.951, Global test accuracy: 95.54
Round  97, Train loss: 1.014, Test loss: 0.967, Test accuracy: 94.02
Round  97, Global train loss: 1.014, Global test loss: 0.952, Global test accuracy: 95.48
Round  98, Train loss: 1.014, Test loss: 0.967, Test accuracy: 94.02
Round  98, Global train loss: 1.014, Global test loss: 0.950, Global test accuracy: 95.70
Round  99, Train loss: 1.028, Test loss: 0.967, Test accuracy: 94.00
Round  99, Global train loss: 1.028, Global test loss: 0.953, Global test accuracy: 95.30
Final Round, Train loss: 0.984, Test loss: 0.968, Test accuracy: 93.98
Final Round, Global train loss: 0.984, Global test loss: 0.953, Global test accuracy: 95.30
Average accuracy final 10 rounds: 94.044 

Average global accuracy final 10 rounds: 95.732 

790.3748843669891
[1.629047155380249, 3.258094310760498, 4.344070672988892, 5.430047035217285, 6.489672899246216, 7.5492987632751465, 8.572723388671875, 9.596148014068604, 10.835047006607056, 12.073945999145508, 13.09169316291809, 14.109440326690674, 15.103363037109375, 16.097285747528076, 17.099356412887573, 18.10142707824707, 19.15639591217041, 20.21136474609375, 21.3072988986969, 22.40323305130005, 23.477083683013916, 24.550934314727783, 25.552096366882324, 26.553258419036865, 27.485057592391968, 28.41685676574707, 29.462689638137817, 30.508522510528564, 31.614006280899048, 32.71949005126953, 33.83390545845032, 34.9483208656311, 36.168840408325195, 37.38935995101929, 38.421016454696655, 39.45267295837402, 40.55613899230957, 41.65960502624512, 42.70629358291626, 43.7529821395874, 44.751253843307495, 45.74952554702759, 47.02264094352722, 48.295756340026855, 49.38073801994324, 50.46571969985962, 51.53465437889099, 52.60358905792236, 53.58292293548584, 54.562256813049316, 55.48410511016846, 56.4059534072876, 57.467880725860596, 58.529808044433594, 59.53142738342285, 60.53304672241211, 61.63933825492859, 62.74562978744507, 63.72983741760254, 64.71404504776001, 65.70423483848572, 66.69442462921143, 67.75245714187622, 68.81048965454102, 69.83013200759888, 70.84977436065674, 71.86170220375061, 72.87363004684448, 74.15769910812378, 75.44176816940308, 76.49224758148193, 77.54272699356079, 78.52261447906494, 79.50250196456909, 80.56036496162415, 81.6182279586792, 83.3565764427185, 85.09492492675781, 86.11814451217651, 87.14136409759521, 88.24627232551575, 89.35118055343628, 90.407222032547, 91.46326351165771, 92.45944881439209, 93.45563411712646, 94.51515913009644, 95.5746841430664, 96.86110949516296, 98.14753484725952, 99.14641070365906, 100.1452865600586, 101.16717648506165, 102.1890664100647, 103.21666026115417, 104.24425411224365, 105.25751328468323, 106.2707724571228, 107.39996552467346, 108.52915859222412, 109.55970191955566, 110.5902452468872, 111.68370223045349, 112.77715921401978, 113.9743423461914, 115.17152547836304, 116.23292779922485, 117.29433012008667, 118.317556142807, 119.34078216552734, 120.354487657547, 121.36819314956665, 122.41055226325989, 123.45291137695312, 124.53096675872803, 125.60902214050293, 126.62851405143738, 127.64800596237183, 128.68347716331482, 129.7189483642578, 130.7209551334381, 131.7229619026184, 132.77273797988892, 133.82251405715942, 134.79885053634644, 135.77518701553345, 136.75708556175232, 137.7389841079712, 138.70627164840698, 139.67355918884277, 140.6245095729828, 141.5754599571228, 142.60774612426758, 143.64003229141235, 145.03809523582458, 146.43615818023682, 147.59210801124573, 148.74805784225464, 149.8441605567932, 150.9402632713318, 152.0512592792511, 153.1622552871704, 154.25594210624695, 155.3496289253235, 156.40538668632507, 157.46114444732666, 158.44979524612427, 159.43844604492188, 160.48007726669312, 161.52170848846436, 162.51145839691162, 163.5012083053589, 164.6335380077362, 165.76586771011353, 166.78759288787842, 167.8093180656433, 168.93924355506897, 170.06916904449463, 171.01621317863464, 171.96325731277466, 172.90719938278198, 173.8511414527893, 174.8520941734314, 175.8530468940735, 176.95178413391113, 178.05052137374878, 179.39007592201233, 180.72963047027588, 181.82741236686707, 182.92519426345825, 183.99897289276123, 185.0727515220642, 186.08022809028625, 187.0877046585083, 188.21033453941345, 189.3329644203186, 190.47991967201233, 191.62687492370605, 192.72353529930115, 193.82019567489624, 194.97522902488708, 196.13026237487793, 197.1470901966095, 198.16391801834106, 199.11742615699768, 200.0709342956543, 201.0653166770935, 202.05969905853271, 203.13678359985352, 204.21386814117432, 205.26537656784058, 206.31688499450684, 207.41016149520874, 208.50343799591064, 209.74437999725342, 210.9853219985962, 212.0676052570343, 213.1498885154724, 214.39532446861267, 215.64076042175293, 217.93269038200378, 220.22462034225464]
[77.0, 77.0, 87.78, 87.78, 91.26, 91.26, 92.42, 92.42, 92.28, 92.28, 94.06, 94.06, 94.28, 94.28, 94.34, 94.34, 94.54, 94.54, 94.62, 94.62, 94.68, 94.68, 94.74, 94.74, 94.66, 94.66, 94.86, 94.86, 94.8, 94.8, 94.74, 94.74, 94.46, 94.46, 94.34, 94.34, 94.36, 94.36, 94.44, 94.44, 94.4, 94.4, 94.36, 94.36, 94.4, 94.4, 94.36, 94.36, 94.34, 94.34, 94.44, 94.44, 94.44, 94.44, 94.34, 94.34, 94.32, 94.32, 94.36, 94.36, 94.32, 94.32, 94.3, 94.3, 94.36, 94.36, 94.36, 94.36, 94.36, 94.36, 94.36, 94.36, 94.3, 94.3, 94.26, 94.26, 94.26, 94.26, 94.34, 94.34, 94.28, 94.28, 94.26, 94.26, 94.22, 94.22, 94.2, 94.2, 94.18, 94.18, 94.14, 94.14, 94.2, 94.2, 94.18, 94.18, 94.22, 94.22, 94.22, 94.22, 94.22, 94.22, 94.22, 94.22, 94.24, 94.24, 94.22, 94.22, 94.22, 94.22, 94.22, 94.22, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.16, 94.16, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.18, 94.16, 94.16, 94.18, 94.18, 94.16, 94.16, 94.16, 94.16, 94.12, 94.12, 94.14, 94.14, 94.14, 94.14, 94.16, 94.16, 94.16, 94.16, 94.16, 94.16, 94.16, 94.16, 94.18, 94.18, 94.2, 94.2, 94.12, 94.12, 94.14, 94.14, 94.06, 94.06, 94.02, 94.02, 94.08, 94.08, 94.06, 94.06, 94.02, 94.02, 94.1, 94.1, 94.12, 94.12, 94.1, 94.1, 94.1, 94.1, 94.02, 94.02, 94.04, 94.04, 94.06, 94.06, 94.04, 94.04, 94.1, 94.1, 94.06, 94.06, 94.08, 94.08, 94.02, 94.02, 94.02, 94.02, 94.0, 94.0, 93.98, 93.98]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.597, Test loss: 1.576, Test accuracy: 51.14
Round   0, Global train loss: 1.597, Global test loss: 1.577, Global test accuracy: 51.26
Round   1, Train loss: 1.405, Test loss: 1.280, Test accuracy: 76.08
Round   1, Global train loss: 1.405, Global test loss: 1.156, Global test accuracy: 87.74
Round   2, Train loss: 1.014, Test loss: 1.125, Test accuracy: 84.96
Round   2, Global train loss: 1.014, Global test loss: 0.985, Global test accuracy: 94.72
Round   3, Train loss: 1.066, Test loss: 1.036, Test accuracy: 90.30
Round   3, Global train loss: 1.066, Global test loss: 0.964, Global test accuracy: 95.76
Round   4, Train loss: 0.953, Test loss: 1.031, Test accuracy: 90.32
Round   4, Global train loss: 0.953, Global test loss: 0.953, Global test accuracy: 96.08
Round   5, Train loss: 1.055, Test loss: 0.967, Test accuracy: 95.08
Round   5, Global train loss: 1.055, Global test loss: 0.949, Global test accuracy: 96.44
Round   6, Train loss: 1.047, Test loss: 0.960, Test accuracy: 95.44
Round   6, Global train loss: 1.047, Global test loss: 0.948, Global test accuracy: 96.64
Round   7, Train loss: 1.162, Test loss: 0.958, Test accuracy: 95.48
Round   7, Global train loss: 1.162, Global test loss: 0.948, Global test accuracy: 96.16
Round   8, Train loss: 1.043, Test loss: 0.956, Test accuracy: 95.74
Round   8, Global train loss: 1.043, Global test loss: 0.943, Global test accuracy: 96.70
Round   9, Train loss: 1.040, Test loss: 0.954, Test accuracy: 95.96
Round   9, Global train loss: 1.040, Global test loss: 0.943, Global test accuracy: 96.56
Round  10, Train loss: 1.035, Test loss: 0.951, Test accuracy: 96.06
Round  10, Global train loss: 1.035, Global test loss: 0.942, Global test accuracy: 96.50
Round  11, Train loss: 0.930, Test loss: 0.950, Test accuracy: 96.14
Round  11, Global train loss: 0.930, Global test loss: 0.941, Global test accuracy: 96.76
Round  12, Train loss: 0.927, Test loss: 0.944, Test accuracy: 96.48
Round  12, Global train loss: 0.927, Global test loss: 0.941, Global test accuracy: 96.72
Round  13, Train loss: 0.930, Test loss: 0.943, Test accuracy: 96.48
Round  13, Global train loss: 0.930, Global test loss: 0.941, Global test accuracy: 96.72
Round  14, Train loss: 1.039, Test loss: 0.943, Test accuracy: 96.58
Round  14, Global train loss: 1.039, Global test loss: 0.941, Global test accuracy: 96.64
Round  15, Train loss: 1.030, Test loss: 0.942, Test accuracy: 96.72
Round  15, Global train loss: 1.030, Global test loss: 0.938, Global test accuracy: 96.88
Round  16, Train loss: 1.032, Test loss: 0.942, Test accuracy: 96.68
Round  16, Global train loss: 1.032, Global test loss: 0.938, Global test accuracy: 96.88
Round  17, Train loss: 1.145, Test loss: 0.942, Test accuracy: 96.72
Round  17, Global train loss: 1.145, Global test loss: 0.942, Global test accuracy: 96.38
Round  18, Train loss: 1.031, Test loss: 0.942, Test accuracy: 96.70
Round  18, Global train loss: 1.031, Global test loss: 0.939, Global test accuracy: 96.76
Round  19, Train loss: 0.924, Test loss: 0.941, Test accuracy: 96.70
Round  19, Global train loss: 0.924, Global test loss: 0.938, Global test accuracy: 96.74
Round  20, Train loss: 0.923, Test loss: 0.941, Test accuracy: 96.72
Round  20, Global train loss: 0.923, Global test loss: 0.938, Global test accuracy: 96.76
Round  21, Train loss: 1.140, Test loss: 0.940, Test accuracy: 96.68
Round  21, Global train loss: 1.140, Global test loss: 0.939, Global test accuracy: 96.60
Round  22, Train loss: 1.137, Test loss: 0.941, Test accuracy: 96.68
Round  22, Global train loss: 1.137, Global test loss: 0.942, Global test accuracy: 96.38
Round  23, Train loss: 0.921, Test loss: 0.940, Test accuracy: 96.68
Round  23, Global train loss: 0.921, Global test loss: 0.937, Global test accuracy: 96.96
Round  24, Train loss: 1.138, Test loss: 0.940, Test accuracy: 96.72
Round  24, Global train loss: 1.138, Global test loss: 0.941, Global test accuracy: 96.42
Round  25, Train loss: 0.916, Test loss: 0.939, Test accuracy: 96.76
Round  25, Global train loss: 0.916, Global test loss: 0.937, Global test accuracy: 96.88
Round  26, Train loss: 1.026, Test loss: 0.939, Test accuracy: 96.80
Round  26, Global train loss: 1.026, Global test loss: 0.938, Global test accuracy: 96.74
Round  27, Train loss: 0.915, Test loss: 0.939, Test accuracy: 96.82
Round  27, Global train loss: 0.915, Global test loss: 0.936, Global test accuracy: 97.00
Round  28, Train loss: 1.024, Test loss: 0.938, Test accuracy: 96.90
Round  28, Global train loss: 1.024, Global test loss: 0.939, Global test accuracy: 96.70
Round  29, Train loss: 1.024, Test loss: 0.938, Test accuracy: 96.86
Round  29, Global train loss: 1.024, Global test loss: 0.938, Global test accuracy: 96.72
Round  30, Train loss: 1.024, Test loss: 0.938, Test accuracy: 96.82
Round  30, Global train loss: 1.024, Global test loss: 0.938, Global test accuracy: 96.70
Round  31, Train loss: 1.133, Test loss: 0.938, Test accuracy: 96.82
Round  31, Global train loss: 1.133, Global test loss: 0.940, Global test accuracy: 96.56
Round  32, Train loss: 1.028, Test loss: 0.938, Test accuracy: 96.84
Round  32, Global train loss: 1.028, Global test loss: 0.937, Global test accuracy: 96.84
Round  33, Train loss: 1.025, Test loss: 0.938, Test accuracy: 96.84
Round  33, Global train loss: 1.025, Global test loss: 0.937, Global test accuracy: 96.84
Round  34, Train loss: 1.134, Test loss: 0.938, Test accuracy: 96.80
Round  34, Global train loss: 1.134, Global test loss: 0.940, Global test accuracy: 96.52
Round  35, Train loss: 1.025, Test loss: 0.938, Test accuracy: 96.80
Round  35, Global train loss: 1.025, Global test loss: 0.936, Global test accuracy: 96.96
Round  36, Train loss: 1.027, Test loss: 0.938, Test accuracy: 96.80
Round  36, Global train loss: 1.027, Global test loss: 0.936, Global test accuracy: 96.88
Round  37, Train loss: 1.024, Test loss: 0.938, Test accuracy: 96.84
Round  37, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.94
Round  38, Train loss: 1.133, Test loss: 0.938, Test accuracy: 96.84
Round  38, Global train loss: 1.133, Global test loss: 0.938, Global test accuracy: 96.62
Round  39, Train loss: 0.915, Test loss: 0.938, Test accuracy: 96.80
Round  39, Global train loss: 0.915, Global test loss: 0.936, Global test accuracy: 96.90
Round  40, Train loss: 1.024, Test loss: 0.938, Test accuracy: 96.80
Round  40, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.92
Round  41, Train loss: 0.916, Test loss: 0.939, Test accuracy: 96.64
Round  41, Global train loss: 0.916, Global test loss: 0.938, Global test accuracy: 96.86
Round  42, Train loss: 0.918, Test loss: 0.938, Test accuracy: 96.74
Round  42, Global train loss: 0.918, Global test loss: 0.936, Global test accuracy: 97.00
Round  43, Train loss: 0.918, Test loss: 0.938, Test accuracy: 96.74
Round  43, Global train loss: 0.918, Global test loss: 0.935, Global test accuracy: 97.02
Round  44, Train loss: 1.131, Test loss: 0.938, Test accuracy: 96.72
Round  44, Global train loss: 1.131, Global test loss: 0.939, Global test accuracy: 96.74
Round  45, Train loss: 0.911, Test loss: 0.938, Test accuracy: 96.68
Round  45, Global train loss: 0.911, Global test loss: 0.936, Global test accuracy: 96.88
Round  46, Train loss: 0.910, Test loss: 0.938, Test accuracy: 96.72
Round  46, Global train loss: 0.910, Global test loss: 0.935, Global test accuracy: 97.06
Round  47, Train loss: 0.913, Test loss: 0.938, Test accuracy: 96.72
Round  47, Global train loss: 0.913, Global test loss: 0.935, Global test accuracy: 97.10
Round  48, Train loss: 0.918, Test loss: 0.938, Test accuracy: 96.74
Round  48, Global train loss: 0.918, Global test loss: 0.934, Global test accuracy: 97.12
Round  49, Train loss: 1.133, Test loss: 0.937, Test accuracy: 96.78
Round  49, Global train loss: 1.133, Global test loss: 0.938, Global test accuracy: 96.78
Round  50, Train loss: 0.915, Test loss: 0.937, Test accuracy: 96.78
Round  50, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 97.16
Round  51, Train loss: 1.028, Test loss: 0.937, Test accuracy: 96.86
Round  51, Global train loss: 1.028, Global test loss: 0.935, Global test accuracy: 97.00
Round  52, Train loss: 1.023, Test loss: 0.937, Test accuracy: 96.84
Round  52, Global train loss: 1.023, Global test loss: 0.935, Global test accuracy: 97.00
Round  53, Train loss: 0.918, Test loss: 0.937, Test accuracy: 96.84
Round  53, Global train loss: 0.918, Global test loss: 0.935, Global test accuracy: 97.06
Round  54, Train loss: 1.024, Test loss: 0.937, Test accuracy: 96.90
Round  54, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.94
Round  55, Train loss: 1.021, Test loss: 0.937, Test accuracy: 96.88
Round  55, Global train loss: 1.021, Global test loss: 0.936, Global test accuracy: 97.04
Round  56, Train loss: 1.024, Test loss: 0.937, Test accuracy: 96.86
Round  56, Global train loss: 1.024, Global test loss: 0.938, Global test accuracy: 96.68
Round  57, Train loss: 1.027, Test loss: 0.937, Test accuracy: 96.86
Round  57, Global train loss: 1.027, Global test loss: 0.936, Global test accuracy: 96.90
Round  58, Train loss: 1.023, Test loss: 0.937, Test accuracy: 96.92
Round  58, Global train loss: 1.023, Global test loss: 0.936, Global test accuracy: 96.98
Round  59, Train loss: 1.132, Test loss: 0.937, Test accuracy: 96.94
Round  59, Global train loss: 1.132, Global test loss: 0.938, Global test accuracy: 96.72
Round  60, Train loss: 1.024, Test loss: 0.937, Test accuracy: 96.94
Round  60, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.98
Round  61, Train loss: 1.020, Test loss: 0.937, Test accuracy: 96.90
Round  61, Global train loss: 1.020, Global test loss: 0.935, Global test accuracy: 97.06
Round  62, Train loss: 0.911, Test loss: 0.937, Test accuracy: 96.90
Round  62, Global train loss: 0.911, Global test loss: 0.935, Global test accuracy: 97.10
Round  63, Train loss: 0.914, Test loss: 0.937, Test accuracy: 96.88
Round  63, Global train loss: 0.914, Global test loss: 0.936, Global test accuracy: 96.94
Round  64, Train loss: 0.910, Test loss: 0.937, Test accuracy: 96.90
Round  64, Global train loss: 0.910, Global test loss: 0.935, Global test accuracy: 97.10
Round  65, Train loss: 0.915, Test loss: 0.936, Test accuracy: 96.92
Round  65, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 97.06
Round  66, Train loss: 1.135, Test loss: 0.936, Test accuracy: 96.92
Round  66, Global train loss: 1.135, Global test loss: 0.939, Global test accuracy: 96.54
Round  67, Train loss: 0.910, Test loss: 0.936, Test accuracy: 96.94
Round  67, Global train loss: 0.910, Global test loss: 0.935, Global test accuracy: 97.08
Round  68, Train loss: 0.915, Test loss: 0.936, Test accuracy: 96.94
Round  68, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 97.04
Round  69, Train loss: 1.027, Test loss: 0.936, Test accuracy: 96.92
Round  69, Global train loss: 1.027, Global test loss: 0.937, Global test accuracy: 96.90
Round  70, Train loss: 0.917, Test loss: 0.936, Test accuracy: 96.90
Round  70, Global train loss: 0.917, Global test loss: 0.935, Global test accuracy: 97.16
Round  71, Train loss: 1.024, Test loss: 0.937, Test accuracy: 96.92
Round  71, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.92
Round  72, Train loss: 1.024, Test loss: 0.936, Test accuracy: 96.96
Round  72, Global train loss: 1.024, Global test loss: 0.935, Global test accuracy: 97.14
Round  73, Train loss: 1.022, Test loss: 0.936, Test accuracy: 96.92
Round  73, Global train loss: 1.022, Global test loss: 0.935, Global test accuracy: 97.08
Round  74, Train loss: 1.020, Test loss: 0.936, Test accuracy: 96.88
Round  74, Global train loss: 1.020, Global test loss: 0.935, Global test accuracy: 97.02
Round  75, Train loss: 1.028, Test loss: 0.936, Test accuracy: 96.92
Round  75, Global train loss: 1.028, Global test loss: 0.936, Global test accuracy: 97.00
Round  76, Train loss: 1.024, Test loss: 0.936, Test accuracy: 96.94
Round  76, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.90
Round  77, Train loss: 1.024, Test loss: 0.936, Test accuracy: 96.94
Round  77, Global train loss: 1.024, Global test loss: 0.937, Global test accuracy: 96.86
Round  78, Train loss: 1.024, Test loss: 0.936, Test accuracy: 96.96
Round  78, Global train loss: 1.024, Global test loss: 0.935, Global test accuracy: 97.06
Round  79, Train loss: 0.915, Test loss: 0.936, Test accuracy: 96.98
Round  79, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 97.02
Round  80, Train loss: 1.021, Test loss: 0.936, Test accuracy: 96.98
Round  80, Global train loss: 1.021, Global test loss: 0.935, Global test accuracy: 97.02
Round  81, Train loss: 0.917, Test loss: 0.936, Test accuracy: 96.96
Round  81, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.16
Round  82, Train loss: 0.916, Test loss: 0.936, Test accuracy: 96.96
Round  82, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 96.94
Round  83, Train loss: 1.027, Test loss: 0.936, Test accuracy: 96.98
Round  83, Global train loss: 1.027, Global test loss: 0.935, Global test accuracy: 97.02
Round  84, Train loss: 0.916, Test loss: 0.936, Test accuracy: 96.98
Round  84, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 96.92
Round  85, Train loss: 1.023, Test loss: 0.936, Test accuracy: 96.98
Round  85, Global train loss: 1.023, Global test loss: 0.936, Global test accuracy: 96.88
Round  86, Train loss: 0.917, Test loss: 0.936, Test accuracy: 96.96
Round  86, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.22
Round  87, Train loss: 0.913, Test loss: 0.936, Test accuracy: 96.98
Round  87, Global train loss: 0.913, Global test loss: 0.935, Global test accuracy: 97.00
Round  88, Train loss: 0.913, Test loss: 0.935, Test accuracy: 97.04
Round  88, Global train loss: 0.913, Global test loss: 0.935, Global test accuracy: 97.04
Round  89, Train loss: 1.023, Test loss: 0.936, Test accuracy: 96.94
Round  89, Global train loss: 1.023, Global test loss: 0.936, Global test accuracy: 97.00
Round  90, Train loss: 1.021, Test loss: 0.936, Test accuracy: 96.94
Round  90, Global train loss: 1.021, Global test loss: 0.935, Global test accuracy: 97.00
Round  91, Train loss: 1.018, Test loss: 0.936, Test accuracy: 96.94
Round  91, Global train loss: 1.018, Global test loss: 0.936, Global test accuracy: 96.98
Round  92, Train loss: 1.028, Test loss: 0.936, Test accuracy: 96.94
Round  92, Global train loss: 1.028, Global test loss: 0.936, Global test accuracy: 97.02
Round  93, Train loss: 1.024, Test loss: 0.936, Test accuracy: 96.88
Round  93, Global train loss: 1.024, Global test loss: 0.935, Global test accuracy: 97.02
Round  94, Train loss: 1.018, Test loss: 0.936, Test accuracy: 96.90
Round  94, Global train loss: 1.018, Global test loss: 0.935, Global test accuracy: 96.98
Round  95, Train loss: 0.913, Test loss: 0.936, Test accuracy: 96.90
Round  95, Global train loss: 0.913, Global test loss: 0.935, Global test accuracy: 97.04/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 0.915, Test loss: 0.936, Test accuracy: 96.92
Round  96, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 96.96
Round  97, Train loss: 0.910, Test loss: 0.936, Test accuracy: 96.92
Round  97, Global train loss: 0.910, Global test loss: 0.934, Global test accuracy: 97.12
Round  98, Train loss: 0.912, Test loss: 0.936, Test accuracy: 96.96
Round  98, Global train loss: 0.912, Global test loss: 0.934, Global test accuracy: 97.22
Round  99, Train loss: 0.914, Test loss: 0.935, Test accuracy: 96.96
Round  99, Global train loss: 0.914, Global test loss: 0.933, Global test accuracy: 97.24
Final Round, Train loss: 0.978, Test loss: 0.935, Test accuracy: 96.96
Final Round, Global train loss: 0.978, Global test loss: 0.933, Global test accuracy: 97.24
Average accuracy final 10 rounds: 96.92599999999999 

Average global accuracy final 10 rounds: 97.058 

811.6608390808105
[1.2740023136138916, 2.548004627227783, 3.8943607807159424, 5.240716934204102, 6.242609024047852, 7.244501113891602, 8.330510139465332, 9.416519165039062, 10.428302526473999, 11.440085887908936, 12.385225534439087, 13.330365180969238, 14.244260787963867, 15.158156394958496, 16.198808193206787, 17.239459991455078, 18.2564218044281, 19.273383617401123, 20.269218683242798, 21.265053749084473, 22.217035055160522, 23.169016361236572, 24.15431809425354, 25.139619827270508, 26.15881633758545, 27.17801284790039, 28.270896434783936, 29.36378002166748, 30.35874629020691, 31.353712558746338, 32.359596729278564, 33.36548089981079, 34.388203144073486, 35.41092538833618, 36.48102116584778, 37.551116943359375, 38.671794176101685, 39.792471408843994, 40.85587692260742, 41.91928243637085, 42.93669939041138, 43.954116344451904, 44.9781494140625, 46.002182483673096, 47.13402080535889, 48.26585912704468, 49.4052529335022, 50.54464673995972, 51.54252624511719, 52.54040575027466, 53.546473264694214, 54.55254077911377, 55.57985258102417, 56.60716438293457, 57.67515993118286, 58.74315547943115, 59.81923198699951, 60.89530849456787, 61.906044244766235, 62.9167799949646, 64.05882692337036, 65.20087385177612, 66.23110556602478, 67.26133728027344, 68.27665519714355, 69.29197311401367, 70.31480002403259, 71.33762693405151, 72.45042037963867, 73.56321382522583, 74.67389941215515, 75.78458499908447, 76.89569520950317, 78.00680541992188, 79.01738715171814, 80.0279688835144, 81.19324803352356, 82.35852718353271, 83.41301703453064, 84.46750688552856, 85.60360789299011, 86.73970890045166, 87.87591528892517, 89.01212167739868, 90.07392239570618, 91.13572311401367, 92.23165655136108, 93.3275899887085, 94.75402307510376, 96.18045616149902, 97.27618837356567, 98.37192058563232, 99.52361679077148, 100.67531299591064, 101.66839742660522, 102.6614818572998, 103.70143294334412, 104.74138402938843, 105.80533528327942, 106.86928653717041, 107.97544765472412, 109.08160877227783, 110.15877747535706, 111.23594617843628, 112.44268226623535, 113.64941835403442, 114.76754713058472, 115.88567590713501, 116.94676351547241, 118.00785112380981, 119.14538407325745, 120.28291702270508, 121.45408272743225, 122.62524843215942, 123.64129853248596, 124.6573486328125, 125.70162606239319, 126.74590349197388, 127.79791712760925, 128.84993076324463, 130.04108881950378, 131.23224687576294, 132.29431819915771, 133.3563895225525, 134.41349983215332, 135.47061014175415, 136.63409852981567, 137.7975869178772, 138.83980536460876, 139.88202381134033, 140.91822695732117, 141.954430103302, 143.019615650177, 144.084801197052, 145.18190598487854, 146.27901077270508, 147.34257125854492, 148.40613174438477, 149.49964451789856, 150.59315729141235, 151.61577129364014, 152.63838529586792, 153.64062118530273, 154.64285707473755, 155.66770696640015, 156.69255685806274, 157.85928511619568, 159.0260133743286, 160.04098653793335, 161.0559597015381, 162.17178559303284, 163.2876114845276, 164.3728530406952, 165.4580945968628, 166.5230131149292, 167.5879316329956, 168.68682861328125, 169.7857255935669, 170.8645577430725, 171.94338989257812, 172.975599527359, 174.0078091621399, 175.07812786102295, 176.148446559906, 177.3278386592865, 178.507230758667, 179.55919075012207, 180.61115074157715, 181.6798985004425, 182.74864625930786, 183.89331579208374, 185.03798532485962, 186.12825298309326, 187.2185206413269, 188.36803722381592, 189.51755380630493, 190.57255101203918, 191.62754821777344, 192.65494894981384, 193.68234968185425, 194.73402094841003, 195.78569221496582, 196.951397895813, 198.11710357666016, 199.05178999900818, 199.9864764213562, 201.02126216888428, 202.05604791641235, 203.1130769252777, 204.17010593414307, 205.3061821460724, 206.4422583580017, 207.46986985206604, 208.49748134613037, 209.76452350616455, 211.03156566619873, 212.2066035270691, 213.38164138793945, 214.51595735549927, 215.65027332305908, 217.7875714302063, 219.92486953735352]
[51.14, 51.14, 76.08, 76.08, 84.96, 84.96, 90.3, 90.3, 90.32, 90.32, 95.08, 95.08, 95.44, 95.44, 95.48, 95.48, 95.74, 95.74, 95.96, 95.96, 96.06, 96.06, 96.14, 96.14, 96.48, 96.48, 96.48, 96.48, 96.58, 96.58, 96.72, 96.72, 96.68, 96.68, 96.72, 96.72, 96.7, 96.7, 96.7, 96.7, 96.72, 96.72, 96.68, 96.68, 96.68, 96.68, 96.68, 96.68, 96.72, 96.72, 96.76, 96.76, 96.8, 96.8, 96.82, 96.82, 96.9, 96.9, 96.86, 96.86, 96.82, 96.82, 96.82, 96.82, 96.84, 96.84, 96.84, 96.84, 96.8, 96.8, 96.8, 96.8, 96.8, 96.8, 96.84, 96.84, 96.84, 96.84, 96.8, 96.8, 96.8, 96.8, 96.64, 96.64, 96.74, 96.74, 96.74, 96.74, 96.72, 96.72, 96.68, 96.68, 96.72, 96.72, 96.72, 96.72, 96.74, 96.74, 96.78, 96.78, 96.78, 96.78, 96.86, 96.86, 96.84, 96.84, 96.84, 96.84, 96.9, 96.9, 96.88, 96.88, 96.86, 96.86, 96.86, 96.86, 96.92, 96.92, 96.94, 96.94, 96.94, 96.94, 96.9, 96.9, 96.9, 96.9, 96.88, 96.88, 96.9, 96.9, 96.92, 96.92, 96.92, 96.92, 96.94, 96.94, 96.94, 96.94, 96.92, 96.92, 96.9, 96.9, 96.92, 96.92, 96.96, 96.96, 96.92, 96.92, 96.88, 96.88, 96.92, 96.92, 96.94, 96.94, 96.94, 96.94, 96.96, 96.96, 96.98, 96.98, 96.98, 96.98, 96.96, 96.96, 96.96, 96.96, 96.98, 96.98, 96.98, 96.98, 96.98, 96.98, 96.96, 96.96, 96.98, 96.98, 97.04, 97.04, 96.94, 96.94, 96.94, 96.94, 96.94, 96.94, 96.94, 96.94, 96.88, 96.88, 96.9, 96.9, 96.9, 96.9, 96.92, 96.92, 96.92, 96.92, 96.96, 96.96, 96.96, 96.96, 96.96, 96.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.597, Test loss: 1.580, Test accuracy: 45.72
Round   0, Global train loss: 1.597, Global test loss: 1.581, Global test accuracy: 44.02
Round   1, Train loss: 1.467, Test loss: 1.375, Test accuracy: 72.36
Round   1, Global train loss: 1.467, Global test loss: 1.292, Global test accuracy: 83.32
Round   2, Train loss: 1.065, Test loss: 1.153, Test accuracy: 82.18
Round   2, Global train loss: 1.065, Global test loss: 1.008, Global test accuracy: 94.36
Round   3, Train loss: 0.987, Test loss: 1.047, Test accuracy: 89.54
Round   3, Global train loss: 0.987, Global test loss: 0.971, Global test accuracy: 95.58
Round   4, Train loss: 0.958, Test loss: 1.039, Test accuracy: 89.62
Round   4, Global train loss: 0.958, Global test loss: 0.959, Global test accuracy: 95.76
Round   5, Train loss: 1.150, Test loss: 0.975, Test accuracy: 95.10
Round   5, Global train loss: 1.150, Global test loss: 0.955, Global test accuracy: 96.02
Round   6, Train loss: 0.957, Test loss: 0.965, Test accuracy: 95.32
Round   6, Global train loss: 0.957, Global test loss: 0.951, Global test accuracy: 96.20
Round   7, Train loss: 1.061, Test loss: 0.963, Test accuracy: 95.38
Round   7, Global train loss: 1.061, Global test loss: 0.948, Global test accuracy: 96.42
Round   8, Train loss: 1.053, Test loss: 0.961, Test accuracy: 95.52
Round   8, Global train loss: 1.053, Global test loss: 0.947, Global test accuracy: 96.30
Round   9, Train loss: 1.137, Test loss: 0.959, Test accuracy: 95.58
Round   9, Global train loss: 1.137, Global test loss: 0.946, Global test accuracy: 96.30
Round  10, Train loss: 1.029, Test loss: 0.955, Test accuracy: 95.88
Round  10, Global train loss: 1.029, Global test loss: 0.945, Global test accuracy: 96.20
Round  11, Train loss: 1.036, Test loss: 0.954, Test accuracy: 95.94
Round  11, Global train loss: 1.036, Global test loss: 0.945, Global test accuracy: 96.62
Round  12, Train loss: 0.928, Test loss: 0.947, Test accuracy: 96.24
Round  12, Global train loss: 0.928, Global test loss: 0.943, Global test accuracy: 96.64
Round  13, Train loss: 0.932, Test loss: 0.945, Test accuracy: 96.42
Round  13, Global train loss: 0.932, Global test loss: 0.942, Global test accuracy: 96.48
Round  14, Train loss: 0.945, Test loss: 0.945, Test accuracy: 96.40
Round  14, Global train loss: 0.945, Global test loss: 0.941, Global test accuracy: 96.52
Round  15, Train loss: 1.024, Test loss: 0.943, Test accuracy: 96.40
Round  15, Global train loss: 1.024, Global test loss: 0.940, Global test accuracy: 96.82
Round  16, Train loss: 1.025, Test loss: 0.943, Test accuracy: 96.48
Round  16, Global train loss: 1.025, Global test loss: 0.940, Global test accuracy: 96.88
Round  17, Train loss: 1.043, Test loss: 0.942, Test accuracy: 96.50
Round  17, Global train loss: 1.043, Global test loss: 0.939, Global test accuracy: 96.86
Round  18, Train loss: 1.126, Test loss: 0.941, Test accuracy: 96.58
Round  18, Global train loss: 1.126, Global test loss: 0.940, Global test accuracy: 96.78
Round  19, Train loss: 1.031, Test loss: 0.941, Test accuracy: 96.56
Round  19, Global train loss: 1.031, Global test loss: 0.939, Global test accuracy: 96.88
Round  20, Train loss: 0.927, Test loss: 0.941, Test accuracy: 96.58
Round  20, Global train loss: 0.927, Global test loss: 0.938, Global test accuracy: 96.94
Round  21, Train loss: 1.141, Test loss: 0.942, Test accuracy: 96.54
Round  21, Global train loss: 1.141, Global test loss: 0.940, Global test accuracy: 96.78
Round  22, Train loss: 1.031, Test loss: 0.941, Test accuracy: 96.54
Round  22, Global train loss: 1.031, Global test loss: 0.939, Global test accuracy: 96.86
Round  23, Train loss: 1.028, Test loss: 0.941, Test accuracy: 96.66
Round  23, Global train loss: 1.028, Global test loss: 0.937, Global test accuracy: 97.00
Round  24, Train loss: 1.032, Test loss: 0.939, Test accuracy: 96.84
Round  24, Global train loss: 1.032, Global test loss: 0.938, Global test accuracy: 96.94
Round  25, Train loss: 0.917, Test loss: 0.938, Test accuracy: 96.92
Round  25, Global train loss: 0.917, Global test loss: 0.937, Global test accuracy: 97.04
Round  26, Train loss: 1.017, Test loss: 0.938, Test accuracy: 96.92
Round  26, Global train loss: 1.017, Global test loss: 0.937, Global test accuracy: 97.02
Round  27, Train loss: 0.916, Test loss: 0.939, Test accuracy: 96.88
Round  27, Global train loss: 0.916, Global test loss: 0.936, Global test accuracy: 97.14
Round  28, Train loss: 1.015, Test loss: 0.939, Test accuracy: 96.84
Round  28, Global train loss: 1.015, Global test loss: 0.937, Global test accuracy: 97.12
Round  29, Train loss: 1.014, Test loss: 0.939, Test accuracy: 96.86
Round  29, Global train loss: 1.014, Global test loss: 0.938, Global test accuracy: 96.96
Round  30, Train loss: 0.930, Test loss: 0.939, Test accuracy: 96.84
Round  30, Global train loss: 0.930, Global test loss: 0.936, Global test accuracy: 97.16
Round  31, Train loss: 1.026, Test loss: 0.939, Test accuracy: 96.82
Round  31, Global train loss: 1.026, Global test loss: 0.937, Global test accuracy: 96.96
Round  32, Train loss: 1.037, Test loss: 0.938, Test accuracy: 96.82
Round  32, Global train loss: 1.037, Global test loss: 0.938, Global test accuracy: 96.84
Round  33, Train loss: 0.930, Test loss: 0.938, Test accuracy: 96.86
Round  33, Global train loss: 0.930, Global test loss: 0.936, Global test accuracy: 96.90
Round  34, Train loss: 1.028, Test loss: 0.938, Test accuracy: 96.94
Round  34, Global train loss: 1.028, Global test loss: 0.936, Global test accuracy: 97.08
Round  35, Train loss: 1.119, Test loss: 0.938, Test accuracy: 97.00
Round  35, Global train loss: 1.119, Global test loss: 0.936, Global test accuracy: 97.16
Round  36, Train loss: 0.930, Test loss: 0.938, Test accuracy: 97.02
Round  36, Global train loss: 0.930, Global test loss: 0.936, Global test accuracy: 97.06
Round  37, Train loss: 1.118, Test loss: 0.938, Test accuracy: 96.98
Round  37, Global train loss: 1.118, Global test loss: 0.936, Global test accuracy: 97.06
Round  38, Train loss: 1.025, Test loss: 0.938, Test accuracy: 97.02
Round  38, Global train loss: 1.025, Global test loss: 0.937, Global test accuracy: 97.08
Round  39, Train loss: 0.916, Test loss: 0.938, Test accuracy: 96.92
Round  39, Global train loss: 0.916, Global test loss: 0.936, Global test accuracy: 97.16
Round  40, Train loss: 0.927, Test loss: 0.938, Test accuracy: 97.00
Round  40, Global train loss: 0.927, Global test loss: 0.936, Global test accuracy: 97.10
Round  41, Train loss: 0.918, Test loss: 0.938, Test accuracy: 97.00
Round  41, Global train loss: 0.918, Global test loss: 0.936, Global test accuracy: 97.06
Round  42, Train loss: 0.920, Test loss: 0.937, Test accuracy: 97.10
Round  42, Global train loss: 0.920, Global test loss: 0.935, Global test accuracy: 97.16
Round  43, Train loss: 1.025, Test loss: 0.937, Test accuracy: 97.06
Round  43, Global train loss: 1.025, Global test loss: 0.935, Global test accuracy: 97.16
Round  44, Train loss: 1.024, Test loss: 0.937, Test accuracy: 96.96
Round  44, Global train loss: 1.024, Global test loss: 0.936, Global test accuracy: 96.96
Round  45, Train loss: 0.911, Test loss: 0.938, Test accuracy: 96.90
Round  45, Global train loss: 0.911, Global test loss: 0.935, Global test accuracy: 97.10
Round  46, Train loss: 0.912, Test loss: 0.937, Test accuracy: 96.96
Round  46, Global train loss: 0.912, Global test loss: 0.935, Global test accuracy: 97.28
Round  47, Train loss: 0.914, Test loss: 0.937, Test accuracy: 96.92
Round  47, Global train loss: 0.914, Global test loss: 0.935, Global test accuracy: 97.30
Round  48, Train loss: 1.026, Test loss: 0.937, Test accuracy: 96.90
Round  48, Global train loss: 1.026, Global test loss: 0.935, Global test accuracy: 97.14
Round  49, Train loss: 1.025, Test loss: 0.936, Test accuracy: 96.96
Round  49, Global train loss: 1.025, Global test loss: 0.935, Global test accuracy: 97.08
Round  50, Train loss: 1.019, Test loss: 0.936, Test accuracy: 96.96
Round  50, Global train loss: 1.019, Global test loss: 0.935, Global test accuracy: 97.18
Round  51, Train loss: 0.932, Test loss: 0.936, Test accuracy: 96.94
Round  51, Global train loss: 0.932, Global test loss: 0.934, Global test accuracy: 97.16
Round  52, Train loss: 1.117, Test loss: 0.936, Test accuracy: 96.98
Round  52, Global train loss: 1.117, Global test loss: 0.935, Global test accuracy: 97.24
Round  53, Train loss: 1.025, Test loss: 0.936, Test accuracy: 96.98
Round  53, Global train loss: 1.025, Global test loss: 0.935, Global test accuracy: 97.04
Round  54, Train loss: 0.929, Test loss: 0.936, Test accuracy: 96.94
Round  54, Global train loss: 0.929, Global test loss: 0.935, Global test accuracy: 97.10
Round  55, Train loss: 1.010, Test loss: 0.936, Test accuracy: 96.92
Round  55, Global train loss: 1.010, Global test loss: 0.935, Global test accuracy: 97.08
Round  56, Train loss: 1.015, Test loss: 0.936, Test accuracy: 96.94
Round  56, Global train loss: 1.015, Global test loss: 0.935, Global test accuracy: 97.06
Round  57, Train loss: 0.931, Test loss: 0.936, Test accuracy: 96.90
Round  57, Global train loss: 0.931, Global test loss: 0.934, Global test accuracy: 97.24
Round  58, Train loss: 1.116, Test loss: 0.936, Test accuracy: 96.94
Round  58, Global train loss: 1.116, Global test loss: 0.935, Global test accuracy: 97.06
Round  59, Train loss: 1.024, Test loss: 0.936, Test accuracy: 96.94
Round  59, Global train loss: 1.024, Global test loss: 0.935, Global test accuracy: 97.12
Round  60, Train loss: 0.928, Test loss: 0.936, Test accuracy: 96.92
Round  60, Global train loss: 0.928, Global test loss: 0.935, Global test accuracy: 97.08
Round  61, Train loss: 1.008, Test loss: 0.936, Test accuracy: 97.02
Round  61, Global train loss: 1.008, Global test loss: 0.933, Global test accuracy: 97.40
Round  62, Train loss: 0.911, Test loss: 0.936, Test accuracy: 97.04
Round  62, Global train loss: 0.911, Global test loss: 0.933, Global test accuracy: 97.26
Round  63, Train loss: 0.916, Test loss: 0.936, Test accuracy: 97.06
Round  63, Global train loss: 0.916, Global test loss: 0.934, Global test accuracy: 97.22
Round  64, Train loss: 0.911, Test loss: 0.936, Test accuracy: 97.06
Round  64, Global train loss: 0.911, Global test loss: 0.934, Global test accuracy: 97.30
Round  65, Train loss: 0.917, Test loss: 0.936, Test accuracy: 97.08
Round  65, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.18
Round  66, Train loss: 1.028, Test loss: 0.936, Test accuracy: 97.12
Round  66, Global train loss: 1.028, Global test loss: 0.935, Global test accuracy: 97.18
Round  67, Train loss: 0.911, Test loss: 0.936, Test accuracy: 97.10
Round  67, Global train loss: 0.911, Global test loss: 0.934, Global test accuracy: 97.30
Round  68, Train loss: 0.917, Test loss: 0.935, Test accuracy: 97.20
Round  68, Global train loss: 0.917, Global test loss: 0.934, Global test accuracy: 97.24
Round  69, Train loss: 0.931, Test loss: 0.936, Test accuracy: 97.16
Round  69, Global train loss: 0.931, Global test loss: 0.935, Global test accuracy: 97.10
Round  70, Train loss: 1.022, Test loss: 0.936, Test accuracy: 97.04
Round  70, Global train loss: 1.022, Global test loss: 0.935, Global test accuracy: 97.14
Round  71, Train loss: 0.927, Test loss: 0.936, Test accuracy: 96.96
Round  71, Global train loss: 0.927, Global test loss: 0.934, Global test accuracy: 97.14
Round  72, Train loss: 0.925, Test loss: 0.936, Test accuracy: 96.98
Round  72, Global train loss: 0.925, Global test loss: 0.933, Global test accuracy: 97.30
Round  73, Train loss: 0.923, Test loss: 0.936, Test accuracy: 96.98
Round  73, Global train loss: 0.923, Global test loss: 0.933, Global test accuracy: 97.34
Round  74, Train loss: 1.008, Test loss: 0.936, Test accuracy: 97.00
Round  74, Global train loss: 1.008, Global test loss: 0.933, Global test accuracy: 97.26
Round  75, Train loss: 1.037, Test loss: 0.935, Test accuracy: 97.16
Round  75, Global train loss: 1.037, Global test loss: 0.935, Global test accuracy: 97.28
Round  76, Train loss: 0.927, Test loss: 0.935, Test accuracy: 97.18
Round  76, Global train loss: 0.927, Global test loss: 0.934, Global test accuracy: 97.18
Round  77, Train loss: 0.927, Test loss: 0.935, Test accuracy: 97.20
Round  77, Global train loss: 0.927, Global test loss: 0.935, Global test accuracy: 97.16
Round  78, Train loss: 0.927, Test loss: 0.935, Test accuracy: 97.18
Round  78, Global train loss: 0.927, Global test loss: 0.933, Global test accuracy: 97.34
Round  79, Train loss: 0.917, Test loss: 0.935, Test accuracy: 97.16
Round  79, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.22
Round  80, Train loss: 1.008, Test loss: 0.935, Test accuracy: 97.18
Round  80, Global train loss: 1.008, Global test loss: 0.933, Global test accuracy: 97.40
Round  81, Train loss: 1.021, Test loss: 0.935, Test accuracy: 97.14
Round  81, Global train loss: 1.021, Global test loss: 0.933, Global test accuracy: 97.30
Round  82, Train loss: 0.916, Test loss: 0.935, Test accuracy: 97.12
Round  82, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 97.16
Round  83, Train loss: 0.929, Test loss: 0.935, Test accuracy: 97.16
Round  83, Global train loss: 0.929, Global test loss: 0.933, Global test accuracy: 97.42
Round  84, Train loss: 0.916, Test loss: 0.935, Test accuracy: 97.12
Round  84, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 97.04
Round  85, Train loss: 1.010, Test loss: 0.935, Test accuracy: 97.16
Round  85, Global train loss: 1.010, Global test loss: 0.934, Global test accuracy: 97.18
Round  86, Train loss: 1.022, Test loss: 0.935, Test accuracy: 97.14
Round  86, Global train loss: 1.022, Global test loss: 0.934, Global test accuracy: 97.12
Round  87, Train loss: 0.914, Test loss: 0.935, Test accuracy: 97.16
Round  87, Global train loss: 0.914, Global test loss: 0.934, Global test accuracy: 97.16
Round  88, Train loss: 0.913, Test loss: 0.935, Test accuracy: 97.18
Round  88, Global train loss: 0.913, Global test loss: 0.935, Global test accuracy: 97.16
Round  89, Train loss: 1.010, Test loss: 0.935, Test accuracy: 97.18
Round  89, Global train loss: 1.010, Global test loss: 0.934, Global test accuracy: 97.14
Round  90, Train loss: 1.007, Test loss: 0.935, Test accuracy: 97.18
Round  90, Global train loss: 1.007, Global test loss: 0.933, Global test accuracy: 97.32
Round  91, Train loss: 1.005, Test loss: 0.935, Test accuracy: 97.14
Round  91, Global train loss: 1.005, Global test loss: 0.934, Global test accuracy: 97.22
Round  92, Train loss: 1.036, Test loss: 0.934, Test accuracy: 97.14
Round  92, Global train loss: 1.036, Global test loss: 0.935, Global test accuracy: 97.18
Round  93, Train loss: 0.925, Test loss: 0.934, Test accuracy: 97.12
Round  93, Global train loss: 0.925, Global test loss: 0.932, Global test accuracy: 97.36
Round  94, Train loss: 1.005, Test loss: 0.934, Test accuracy: 97.14
Round  94, Global train loss: 1.005, Global test loss: 0.933, Global test accuracy: 97.36
Round  95, Train loss: 0.913, Test loss: 0.935, Test accuracy: 97.14
Round  95, Global train loss: 0.913, Global test loss: 0.934, Global test accuracy: 97.22/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.916, Test loss: 0.935, Test accuracy: 97.14
Round  96, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 97.10
Round  97, Train loss: 0.908, Test loss: 0.935, Test accuracy: 97.18
Round  97, Global train loss: 0.908, Global test loss: 0.932, Global test accuracy: 97.26
Round  98, Train loss: 1.015, Test loss: 0.934, Test accuracy: 97.18
Round  98, Global train loss: 1.015, Global test loss: 0.933, Global test accuracy: 97.18
Round  99, Train loss: 1.017, Test loss: 0.934, Test accuracy: 97.18
Round  99, Global train loss: 1.017, Global test loss: 0.933, Global test accuracy: 97.26
Final Round, Train loss: 0.977, Test loss: 0.934, Test accuracy: 97.32
Final Round, Global train loss: 0.977, Global test loss: 0.933, Global test accuracy: 97.26
Average accuracy final 10 rounds: 97.15400000000001 

Average global accuracy final 10 rounds: 97.24600000000001 

848.1574561595917
[1.4069561958312988, 2.8139123916625977, 4.009430646896362, 5.204948902130127, 6.405954599380493, 7.606960296630859, 8.818520307540894, 10.030080318450928, 11.488088607788086, 12.946096897125244, 14.115959882736206, 15.285822868347168, 16.493393898010254, 17.70096492767334, 18.98107647895813, 20.26118803024292, 21.530166149139404, 22.79914426803589, 23.96845316886902, 25.13776206970215, 26.355376720428467, 27.572991371154785, 28.76779055595398, 29.962589740753174, 31.195169687271118, 32.42774963378906, 33.64883899688721, 34.86992835998535, 36.0148708820343, 37.15981340408325, 38.37891745567322, 39.598021507263184, 40.84541082382202, 42.09280014038086, 43.16173052787781, 44.230660915374756, 45.521075963974, 46.81149101257324, 48.1275680065155, 49.443645000457764, 50.64222574234009, 51.84080648422241, 52.983590602874756, 54.1263747215271, 55.29463481903076, 56.462894916534424, 57.673426389694214, 58.883957862854004, 60.18466830253601, 61.48537874221802, 62.678091049194336, 63.870803356170654, 65.1344165802002, 66.39802980422974, 67.52784323692322, 68.6576566696167, 69.79604363441467, 70.93443059921265, 71.97845101356506, 73.02247142791748, 74.35265302658081, 75.68283462524414, 76.97697377204895, 78.27111291885376, 79.35771751403809, 80.44432210922241, 81.7053542137146, 82.96638631820679, 84.05281138420105, 85.13923645019531, 86.52167749404907, 87.90411853790283, 89.12948942184448, 90.35486030578613, 91.46490740776062, 92.57495450973511, 93.77072477340698, 94.96649503707886, 96.1330406665802, 97.29958629608154, 98.59648489952087, 99.8933835029602, 100.96346545219421, 102.03354740142822, 103.27221155166626, 104.5108757019043, 105.68874788284302, 106.86662006378174, 108.12872052192688, 109.39082098007202, 110.6489725112915, 111.90712404251099, 113.02872204780579, 114.15032005310059, 115.35867238044739, 116.56702470779419, 117.698171377182, 118.82931804656982, 120.07326483726501, 121.3172116279602, 122.4409453868866, 123.56467914581299, 124.93320512771606, 126.30173110961914, 128.18503165245056, 130.06833219528198, 131.33401560783386, 132.59969902038574, 133.98558163642883, 135.37146425247192, 136.5107545852661, 137.6500449180603, 138.7709083557129, 139.89177179336548, 141.01777338981628, 142.1437749862671, 143.32108616828918, 144.49839735031128, 145.69273900985718, 146.88708066940308, 147.94577860832214, 149.0044765472412, 150.20256185531616, 151.4006471633911, 152.50356006622314, 153.60647296905518, 154.9266881942749, 156.24690341949463, 157.58437871932983, 158.92185401916504, 159.9769685268402, 161.03208303451538, 162.23020195960999, 163.4283208847046, 164.50078201293945, 165.57324314117432, 166.87544202804565, 168.177640914917, 169.30770611763, 170.43777132034302, 171.61318039894104, 172.78858947753906, 174.11782932281494, 175.44706916809082, 176.59923338890076, 177.7513976097107, 178.95814514160156, 180.16489267349243, 181.51058983802795, 182.85628700256348, 184.17019653320312, 185.48410606384277, 186.8024618625641, 188.1208176612854, 189.3068356513977, 190.49285364151, 191.59797430038452, 192.70309495925903, 193.96378922462463, 195.22448348999023, 196.43770384788513, 197.65092420578003, 198.89368104934692, 200.13643789291382, 201.3199474811554, 202.50345706939697, 203.68529200553894, 204.8671269416809, 206.03607630729675, 207.2050256729126, 208.3615005016327, 209.51797533035278, 210.687664270401, 211.85735321044922, 213.0116617679596, 214.16597032546997, 215.6914665699005, 217.21696281433105, 218.4732735157013, 219.72958421707153, 220.945965051651, 222.16234588623047, 223.3529314994812, 224.54351711273193, 225.70668053627014, 226.86984395980835, 228.02516198158264, 229.18048000335693, 230.46088433265686, 231.7412886619568, 233.0018241405487, 234.26235961914062, 235.30517530441284, 236.34799098968506, 237.52268409729004, 238.69737720489502, 239.8293526172638, 240.96132802963257, 242.1332347393036, 243.3051414489746, 245.89262914657593, 248.48011684417725]
[45.72, 45.72, 72.36, 72.36, 82.18, 82.18, 89.54, 89.54, 89.62, 89.62, 95.1, 95.1, 95.32, 95.32, 95.38, 95.38, 95.52, 95.52, 95.58, 95.58, 95.88, 95.88, 95.94, 95.94, 96.24, 96.24, 96.42, 96.42, 96.4, 96.4, 96.4, 96.4, 96.48, 96.48, 96.5, 96.5, 96.58, 96.58, 96.56, 96.56, 96.58, 96.58, 96.54, 96.54, 96.54, 96.54, 96.66, 96.66, 96.84, 96.84, 96.92, 96.92, 96.92, 96.92, 96.88, 96.88, 96.84, 96.84, 96.86, 96.86, 96.84, 96.84, 96.82, 96.82, 96.82, 96.82, 96.86, 96.86, 96.94, 96.94, 97.0, 97.0, 97.02, 97.02, 96.98, 96.98, 97.02, 97.02, 96.92, 96.92, 97.0, 97.0, 97.0, 97.0, 97.1, 97.1, 97.06, 97.06, 96.96, 96.96, 96.9, 96.9, 96.96, 96.96, 96.92, 96.92, 96.9, 96.9, 96.96, 96.96, 96.96, 96.96, 96.94, 96.94, 96.98, 96.98, 96.98, 96.98, 96.94, 96.94, 96.92, 96.92, 96.94, 96.94, 96.9, 96.9, 96.94, 96.94, 96.94, 96.94, 96.92, 96.92, 97.02, 97.02, 97.04, 97.04, 97.06, 97.06, 97.06, 97.06, 97.08, 97.08, 97.12, 97.12, 97.1, 97.1, 97.2, 97.2, 97.16, 97.16, 97.04, 97.04, 96.96, 96.96, 96.98, 96.98, 96.98, 96.98, 97.0, 97.0, 97.16, 97.16, 97.18, 97.18, 97.2, 97.2, 97.18, 97.18, 97.16, 97.16, 97.18, 97.18, 97.14, 97.14, 97.12, 97.12, 97.16, 97.16, 97.12, 97.12, 97.16, 97.16, 97.14, 97.14, 97.16, 97.16, 97.18, 97.18, 97.18, 97.18, 97.18, 97.18, 97.14, 97.14, 97.14, 97.14, 97.12, 97.12, 97.14, 97.14, 97.14, 97.14, 97.14, 97.14, 97.18, 97.18, 97.18, 97.18, 97.18, 97.18, 97.32, 97.32]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.624, Test loss: 1.589, Test accuracy: 31.82
Round   0, Global train loss: 1.624, Global test loss: 1.589, Global test accuracy: 31.78
Round   1, Train loss: 1.566, Test loss: 1.497, Test accuracy: 76.58
Round   1, Global train loss: 1.566, Global test loss: 1.494, Global test accuracy: 75.98
Round   2, Train loss: 1.405, Test loss: 1.259, Test accuracy: 91.62
Round   2, Global train loss: 1.405, Global test loss: 1.244, Global test accuracy: 91.40
Round   3, Train loss: 1.237, Test loss: 1.088, Test accuracy: 94.04
Round   3, Global train loss: 1.237, Global test loss: 1.061, Global test accuracy: 94.30
Round   4, Train loss: 1.076, Test loss: 1.032, Test accuracy: 95.16
Round   4, Global train loss: 1.076, Global test loss: 1.003, Global test accuracy: 95.02
Round   5, Train loss: 1.115, Test loss: 1.008, Test accuracy: 95.60
Round   5, Global train loss: 1.115, Global test loss: 0.989, Global test accuracy: 95.94
Round   6, Train loss: 1.093, Test loss: 0.994, Test accuracy: 96.02
Round   6, Global train loss: 1.093, Global test loss: 0.983, Global test accuracy: 96.10
Round   7, Train loss: 1.020, Test loss: 0.984, Test accuracy: 96.14
Round   7, Global train loss: 1.020, Global test loss: 0.975, Global test accuracy: 96.26
Round   8, Train loss: 0.987, Test loss: 0.977, Test accuracy: 96.12
Round   8, Global train loss: 0.987, Global test loss: 0.964, Global test accuracy: 96.36
Round   9, Train loss: 0.972, Test loss: 0.971, Test accuracy: 96.40
Round   9, Global train loss: 0.972, Global test loss: 0.959, Global test accuracy: 96.60
Round  10, Train loss: 1.083, Test loss: 0.970, Test accuracy: 96.46
Round  10, Global train loss: 1.083, Global test loss: 0.963, Global test accuracy: 96.70
Round  11, Train loss: 0.965, Test loss: 0.967, Test accuracy: 96.58
Round  11, Global train loss: 0.965, Global test loss: 0.957, Global test accuracy: 96.72
Round  12, Train loss: 0.964, Test loss: 0.959, Test accuracy: 96.46
Round  12, Global train loss: 0.964, Global test loss: 0.957, Global test accuracy: 96.52
Round  13, Train loss: 1.099, Test loss: 0.959, Test accuracy: 96.50
Round  13, Global train loss: 1.099, Global test loss: 0.960, Global test accuracy: 96.64
Round  14, Train loss: 0.987, Test loss: 0.958, Test accuracy: 96.48
Round  14, Global train loss: 0.987, Global test loss: 0.956, Global test accuracy: 96.68
Round  15, Train loss: 0.967, Test loss: 0.954, Test accuracy: 96.74
Round  15, Global train loss: 0.967, Global test loss: 0.950, Global test accuracy: 96.96
Round  16, Train loss: 0.967, Test loss: 0.952, Test accuracy: 96.72
Round  16, Global train loss: 0.967, Global test loss: 0.950, Global test accuracy: 96.88
Round  17, Train loss: 0.978, Test loss: 0.952, Test accuracy: 96.84
Round  17, Global train loss: 0.978, Global test loss: 0.949, Global test accuracy: 96.82
Round  18, Train loss: 0.943, Test loss: 0.950, Test accuracy: 96.84
Round  18, Global train loss: 0.943, Global test loss: 0.944, Global test accuracy: 97.02
Round  19, Train loss: 0.991, Test loss: 0.950, Test accuracy: 97.04
Round  19, Global train loss: 0.991, Global test loss: 0.946, Global test accuracy: 97.16
Round  20, Train loss: 0.989, Test loss: 0.950, Test accuracy: 97.04
Round  20, Global train loss: 0.989, Global test loss: 0.948, Global test accuracy: 97.08
Round  21, Train loss: 0.939, Test loss: 0.949, Test accuracy: 97.08
Round  21, Global train loss: 0.939, Global test loss: 0.943, Global test accuracy: 97.24
Round  22, Train loss: 1.042, Test loss: 0.949, Test accuracy: 97.28
Round  22, Global train loss: 1.042, Global test loss: 0.945, Global test accuracy: 97.24
Round  23, Train loss: 0.946, Test loss: 0.947, Test accuracy: 97.20
Round  23, Global train loss: 0.946, Global test loss: 0.945, Global test accuracy: 97.32
Round  24, Train loss: 1.056, Test loss: 0.948, Test accuracy: 97.20
Round  24, Global train loss: 1.056, Global test loss: 0.946, Global test accuracy: 97.32
Round  25, Train loss: 1.045, Test loss: 0.948, Test accuracy: 97.38
Round  25, Global train loss: 1.045, Global test loss: 0.946, Global test accuracy: 97.42
Round  26, Train loss: 0.935, Test loss: 0.947, Test accuracy: 97.28
Round  26, Global train loss: 0.935, Global test loss: 0.942, Global test accuracy: 97.42
Round  27, Train loss: 0.948, Test loss: 0.945, Test accuracy: 97.30
Round  27, Global train loss: 0.948, Global test loss: 0.941, Global test accuracy: 97.44
Round  28, Train loss: 1.039, Test loss: 0.945, Test accuracy: 97.44
Round  28, Global train loss: 1.039, Global test loss: 0.943, Global test accuracy: 97.44
Round  29, Train loss: 0.929, Test loss: 0.945, Test accuracy: 97.44
Round  29, Global train loss: 0.929, Global test loss: 0.940, Global test accuracy: 97.44
Round  30, Train loss: 1.037, Test loss: 0.944, Test accuracy: 97.44
Round  30, Global train loss: 1.037, Global test loss: 0.942, Global test accuracy: 97.50
Round  31, Train loss: 1.032, Test loss: 0.946, Test accuracy: 97.56
Round  31, Global train loss: 1.032, Global test loss: 0.942, Global test accuracy: 97.62
Round  32, Train loss: 0.931, Test loss: 0.944, Test accuracy: 97.52
Round  32, Global train loss: 0.931, Global test loss: 0.939, Global test accuracy: 97.76
Round  33, Train loss: 0.924, Test loss: 0.942, Test accuracy: 97.56
Round  33, Global train loss: 0.924, Global test loss: 0.937, Global test accuracy: 97.76
Round  34, Train loss: 0.925, Test loss: 0.941, Test accuracy: 97.52
Round  34, Global train loss: 0.925, Global test loss: 0.938, Global test accuracy: 97.60
Round  35, Train loss: 0.942, Test loss: 0.941, Test accuracy: 97.54
Round  35, Global train loss: 0.942, Global test loss: 0.936, Global test accuracy: 97.82
Round  36, Train loss: 1.063, Test loss: 0.942, Test accuracy: 97.58
Round  36, Global train loss: 1.063, Global test loss: 0.942, Global test accuracy: 97.76
Round  37, Train loss: 0.939, Test loss: 0.942, Test accuracy: 97.66
Round  37, Global train loss: 0.939, Global test loss: 0.937, Global test accuracy: 97.82
Round  38, Train loss: 0.934, Test loss: 0.941, Test accuracy: 97.62
Round  38, Global train loss: 0.934, Global test loss: 0.936, Global test accuracy: 97.92
Round  39, Train loss: 1.050, Test loss: 0.942, Test accuracy: 97.60
Round  39, Global train loss: 1.050, Global test loss: 0.944, Global test accuracy: 97.82
Round  40, Train loss: 0.935, Test loss: 0.942, Test accuracy: 97.68
Round  40, Global train loss: 0.935, Global test loss: 0.937, Global test accuracy: 97.90
Round  41, Train loss: 1.064, Test loss: 0.942, Test accuracy: 97.70
Round  41, Global train loss: 1.064, Global test loss: 0.942, Global test accuracy: 97.60
Round  42, Train loss: 1.089, Test loss: 0.945, Test accuracy: 97.64
Round  42, Global train loss: 1.089, Global test loss: 0.946, Global test accuracy: 97.74
Round  43, Train loss: 0.968, Test loss: 0.945, Test accuracy: 97.64
Round  43, Global train loss: 0.968, Global test loss: 0.940, Global test accuracy: 97.90
Round  44, Train loss: 1.027, Test loss: 0.944, Test accuracy: 97.76
Round  44, Global train loss: 1.027, Global test loss: 0.940, Global test accuracy: 97.76
Round  45, Train loss: 1.158, Test loss: 0.947, Test accuracy: 97.66
Round  45, Global train loss: 1.158, Global test loss: 0.949, Global test accuracy: 97.90
Round  46, Train loss: 1.028, Test loss: 0.946, Test accuracy: 97.80
Round  46, Global train loss: 1.028, Global test loss: 0.942, Global test accuracy: 97.86
Round  47, Train loss: 0.926, Test loss: 0.941, Test accuracy: 97.74
Round  47, Global train loss: 0.926, Global test loss: 0.937, Global test accuracy: 97.90
Round  48, Train loss: 0.951, Test loss: 0.940, Test accuracy: 97.86
Round  48, Global train loss: 0.951, Global test loss: 0.937, Global test accuracy: 97.76
Round  49, Train loss: 0.918, Test loss: 0.939, Test accuracy: 97.86
Round  49, Global train loss: 0.918, Global test loss: 0.935, Global test accuracy: 97.82
Round  50, Train loss: 0.921, Test loss: 0.938, Test accuracy: 97.72
Round  50, Global train loss: 0.921, Global test loss: 0.934, Global test accuracy: 97.90
Round  51, Train loss: 0.960, Test loss: 0.938, Test accuracy: 97.62
Round  51, Global train loss: 0.960, Global test loss: 0.935, Global test accuracy: 97.86
Round  52, Train loss: 0.919, Test loss: 0.937, Test accuracy: 97.86
Round  52, Global train loss: 0.919, Global test loss: 0.932, Global test accuracy: 98.12
Round  53, Train loss: 1.067, Test loss: 0.940, Test accuracy: 97.70
Round  53, Global train loss: 1.067, Global test loss: 0.941, Global test accuracy: 97.76
Round  54, Train loss: 1.033, Test loss: 0.942, Test accuracy: 97.68
Round  54, Global train loss: 1.033, Global test loss: 0.940, Global test accuracy: 97.86
Round  55, Train loss: 0.920, Test loss: 0.940, Test accuracy: 97.80
Round  55, Global train loss: 0.920, Global test loss: 0.935, Global test accuracy: 97.94
Round  56, Train loss: 1.061, Test loss: 0.941, Test accuracy: 97.78
Round  56, Global train loss: 1.061, Global test loss: 0.946, Global test accuracy: 97.34
Round  57, Train loss: 0.956, Test loss: 0.941, Test accuracy: 97.70
Round  57, Global train loss: 0.956, Global test loss: 0.938, Global test accuracy: 97.94
Round  58, Train loss: 0.920, Test loss: 0.939, Test accuracy: 97.72
Round  58, Global train loss: 0.920, Global test loss: 0.934, Global test accuracy: 98.04
Round  59, Train loss: 0.914, Test loss: 0.937, Test accuracy: 97.82
Round  59, Global train loss: 0.914, Global test loss: 0.932, Global test accuracy: 97.96
Round  60, Train loss: 0.915, Test loss: 0.936, Test accuracy: 97.82
Round  60, Global train loss: 0.915, Global test loss: 0.932, Global test accuracy: 98.10
Round  61, Train loss: 0.928, Test loss: 0.936, Test accuracy: 97.82
Round  61, Global train loss: 0.928, Global test loss: 0.931, Global test accuracy: 98.20
Round  62, Train loss: 1.155, Test loss: 0.941, Test accuracy: 97.78
Round  62, Global train loss: 1.155, Global test loss: 0.942, Global test accuracy: 98.10
Round  63, Train loss: 1.159, Test loss: 0.948, Test accuracy: 97.72
Round  63, Global train loss: 1.159, Global test loss: 0.957, Global test accuracy: 97.34
Round  64, Train loss: 1.022, Test loss: 0.947, Test accuracy: 97.66
Round  64, Global train loss: 1.022, Global test loss: 0.942, Global test accuracy: 98.00
Round  65, Train loss: 0.941, Test loss: 0.942, Test accuracy: 97.82
Round  65, Global train loss: 0.941, Global test loss: 0.939, Global test accuracy: 97.86
Round  66, Train loss: 0.938, Test loss: 0.941, Test accuracy: 97.76
Round  66, Global train loss: 0.938, Global test loss: 0.941, Global test accuracy: 97.34
Round  67, Train loss: 1.132, Test loss: 0.944, Test accuracy: 97.82
Round  67, Global train loss: 1.132, Global test loss: 0.943, Global test accuracy: 98.06
Round  68, Train loss: 1.051, Test loss: 0.946, Test accuracy: 97.68
Round  68, Global train loss: 1.051, Global test loss: 0.950, Global test accuracy: 97.58
Round  69, Train loss: 0.938, Test loss: 0.943, Test accuracy: 97.64
Round  69, Global train loss: 0.938, Global test loss: 0.942, Global test accuracy: 97.76
Round  70, Train loss: 0.938, Test loss: 0.940, Test accuracy: 97.58
Round  70, Global train loss: 0.938, Global test loss: 0.937, Global test accuracy: 97.90
Round  71, Train loss: 1.026, Test loss: 0.942, Test accuracy: 97.48
Round  71, Global train loss: 1.026, Global test loss: 0.941, Global test accuracy: 97.90
Round  72, Train loss: 0.928, Test loss: 0.940, Test accuracy: 97.56
Round  72, Global train loss: 0.928, Global test loss: 0.934, Global test accuracy: 98.10
Round  73, Train loss: 1.031, Test loss: 0.941, Test accuracy: 97.68
Round  73, Global train loss: 1.031, Global test loss: 0.935, Global test accuracy: 98.10
Round  74, Train loss: 0.916, Test loss: 0.940, Test accuracy: 97.50
Round  74, Global train loss: 0.916, Global test loss: 0.934, Global test accuracy: 98.06
Round  75, Train loss: 0.934, Test loss: 0.940, Test accuracy: 97.36
Round  75, Global train loss: 0.934, Global test loss: 0.937, Global test accuracy: 97.92
Round  76, Train loss: 1.024, Test loss: 0.941, Test accuracy: 97.54
Round  76, Global train loss: 1.024, Global test loss: 0.939, Global test accuracy: 97.92
Round  77, Train loss: 1.024, Test loss: 0.944, Test accuracy: 97.52
Round  77, Global train loss: 1.024, Global test loss: 0.943, Global test accuracy: 97.92
Round  78, Train loss: 1.035, Test loss: 0.946, Test accuracy: 97.54
Round  78, Global train loss: 1.035, Global test loss: 0.942, Global test accuracy: 98.10
Round  79, Train loss: 1.036, Test loss: 0.947, Test accuracy: 97.46
Round  79, Global train loss: 1.036, Global test loss: 0.949, Global test accuracy: 97.36
Round  80, Train loss: 1.032, Test loss: 0.948, Test accuracy: 97.46
Round  80, Global train loss: 1.032, Global test loss: 0.946, Global test accuracy: 97.80
Round  81, Train loss: 0.945, Test loss: 0.944, Test accuracy: 97.40
Round  81, Global train loss: 0.945, Global test loss: 0.938, Global test accuracy: 97.88
Round  82, Train loss: 1.033, Test loss: 0.948, Test accuracy: 97.42
Round  82, Global train loss: 1.033, Global test loss: 0.959, Global test accuracy: 96.30
Round  83, Train loss: 0.941, Test loss: 0.945, Test accuracy: 97.40
Round  83, Global train loss: 0.941, Global test loss: 0.940, Global test accuracy: 97.74
Round  84, Train loss: 1.028, Test loss: 0.951, Test accuracy: 97.32
Round  84, Global train loss: 1.028, Global test loss: 0.963, Global test accuracy: 95.92
Round  85, Train loss: 0.927, Test loss: 0.944, Test accuracy: 97.36
Round  85, Global train loss: 0.927, Global test loss: 0.943, Global test accuracy: 97.04
Round  86, Train loss: 0.925, Test loss: 0.941, Test accuracy: 97.42
Round  86, Global train loss: 0.925, Global test loss: 0.935, Global test accuracy: 97.92
Round  87, Train loss: 1.127, Test loss: 0.952, Test accuracy: 97.12
Round  87, Global train loss: 1.127, Global test loss: 0.966, Global test accuracy: 96.06
Round  88, Train loss: 1.026, Test loss: 0.950, Test accuracy: 97.24
Round  88, Global train loss: 1.026, Global test loss: 0.947, Global test accuracy: 97.68
Round  89, Train loss: 0.925, Test loss: 0.944, Test accuracy: 97.46
Round  89, Global train loss: 0.925, Global test loss: 0.942, Global test accuracy: 97.26
Round  90, Train loss: 0.928, Test loss: 0.941, Test accuracy: 97.40
Round  90, Global train loss: 0.928, Global test loss: 0.933, Global test accuracy: 98.12
Round  91, Train loss: 1.016, Test loss: 0.943, Test accuracy: 97.38
Round  91, Global train loss: 1.016, Global test loss: 0.937, Global test accuracy: 98.02
Round  92, Train loss: 0.923, Test loss: 0.944, Test accuracy: 97.28
Round  92, Global train loss: 0.923, Global test loss: 0.939, Global test accuracy: 97.52/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 0.926, Test loss: 0.940, Test accuracy: 97.42
Round  93, Global train loss: 0.926, Global test loss: 0.931, Global test accuracy: 98.18
Round  94, Train loss: 1.028, Test loss: 0.942, Test accuracy: 97.34
Round  94, Global train loss: 1.028, Global test loss: 0.934, Global test accuracy: 98.10
Round  95, Train loss: 1.022, Test loss: 0.947, Test accuracy: 97.28
Round  95, Global train loss: 1.022, Global test loss: 0.946, Global test accuracy: 97.32
Round  96, Train loss: 1.019, Test loss: 0.952, Test accuracy: 97.00
Round  96, Global train loss: 1.019, Global test loss: 0.966, Global test accuracy: 95.76
Round  97, Train loss: 1.027, Test loss: 0.948, Test accuracy: 97.40
Round  97, Global train loss: 1.027, Global test loss: 0.939, Global test accuracy: 98.18
Round  98, Train loss: 1.025, Test loss: 0.949, Test accuracy: 97.18
Round  98, Global train loss: 1.025, Global test loss: 0.941, Global test accuracy: 97.86
Round  99, Train loss: 0.928, Test loss: 0.943, Test accuracy: 97.42
Round  99, Global train loss: 0.928, Global test loss: 0.933, Global test accuracy: 98.32
Final Round, Train loss: 0.973, Test loss: 0.943, Test accuracy: 97.32
Final Round, Global train loss: 0.973, Global test loss: 0.933, Global test accuracy: 98.32
Average accuracy final 10 rounds: 97.31000000000002
692.3619940280914
[1.360231876373291, 2.689636707305908, 4.112720489501953, 5.436906337738037, 6.723833084106445, 8.018025875091553, 9.297951936721802, 10.680591106414795, 11.930824995040894, 13.258103370666504, 14.502389430999756, 15.909614086151123, 17.19354248046875, 18.588155269622803, 19.84609580039978, 21.196569681167603, 22.457805156707764, 23.700711727142334, 24.936405420303345, 26.251741886138916, 27.589531898498535, 28.762221097946167, 30.105188846588135, 31.449363470077515, 32.69366478919983, 33.813652753829956, 35.20623230934143, 36.336671113967896, 37.574323654174805, 38.995343923568726, 40.378018856048584, 41.60824108123779, 42.88843750953674, 44.267061948776245, 45.47799801826477, 46.68052911758423, 48.05020523071289, 49.218828201293945, 50.5895791053772, 51.81806540489197, 52.95410919189453, 54.22516369819641, 55.37678933143616, 56.60919451713562, 57.93225955963135, 59.179067611694336, 60.43815064430237, 61.6817901134491, 62.99549198150635, 64.29829812049866, 65.44537830352783, 66.67843580245972, 67.97026801109314, 69.27029204368591, 70.64678597450256, 71.99227404594421, 73.32173824310303, 74.58466076850891, 75.92745018005371, 77.12609338760376, 78.46506953239441, 79.72591757774353, 81.06076717376709, 82.35712957382202, 83.68085074424744, 84.97423696517944, 86.17102837562561, 87.54117488861084, 88.79999613761902, 90.09553265571594, 91.4540057182312, 92.68369793891907, 93.98113751411438, 95.2982075214386, 96.62331104278564, 97.88411474227905, 99.1305034160614, 100.58271765708923, 101.83784055709839, 103.01362586021423, 104.32806515693665, 105.45999264717102, 106.60331201553345, 107.75962543487549, 109.02213335037231, 110.47086977958679, 111.76293349266052, 113.11694502830505, 114.34622120857239, 115.56171822547913, 116.83118939399719, 118.08383178710938, 119.32485055923462, 120.60044717788696, 121.79324412345886, 123.07204341888428, 124.3946008682251, 125.60370779037476, 126.97193503379822, 128.31849336624146, 130.5878779888153]
[31.82, 76.58, 91.62, 94.04, 95.16, 95.6, 96.02, 96.14, 96.12, 96.4, 96.46, 96.58, 96.46, 96.5, 96.48, 96.74, 96.72, 96.84, 96.84, 97.04, 97.04, 97.08, 97.28, 97.2, 97.2, 97.38, 97.28, 97.3, 97.44, 97.44, 97.44, 97.56, 97.52, 97.56, 97.52, 97.54, 97.58, 97.66, 97.62, 97.6, 97.68, 97.7, 97.64, 97.64, 97.76, 97.66, 97.8, 97.74, 97.86, 97.86, 97.72, 97.62, 97.86, 97.7, 97.68, 97.8, 97.78, 97.7, 97.72, 97.82, 97.82, 97.82, 97.78, 97.72, 97.66, 97.82, 97.76, 97.82, 97.68, 97.64, 97.58, 97.48, 97.56, 97.68, 97.5, 97.36, 97.54, 97.52, 97.54, 97.46, 97.46, 97.4, 97.42, 97.4, 97.32, 97.36, 97.42, 97.12, 97.24, 97.46, 97.4, 97.38, 97.28, 97.42, 97.34, 97.28, 97.0, 97.4, 97.18, 97.42, 97.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.626, Test loss: 1.595, Test accuracy: 37.50
Round   0, Global train loss: 1.626, Global test loss: 1.595, Global test accuracy: 37.42
Round   1, Train loss: 1.584, Test loss: 1.552, Test accuracy: 69.86
Round   1, Global train loss: 1.584, Global test loss: 1.552, Global test accuracy: 70.30
Round   2, Train loss: 1.500, Test loss: 1.362, Test accuracy: 85.44
Round   2, Global train loss: 1.500, Global test loss: 1.361, Global test accuracy: 86.18
Round   3, Train loss: 1.264, Test loss: 1.089, Test accuracy: 93.68
Round   3, Global train loss: 1.264, Global test loss: 1.084, Global test accuracy: 93.94
Round   4, Train loss: 1.104, Test loss: 1.012, Test accuracy: 94.82
Round   4, Global train loss: 1.104, Global test loss: 1.009, Global test accuracy: 95.14
Round   5, Train loss: 1.069, Test loss: 0.990, Test accuracy: 95.46
Round   5, Global train loss: 1.069, Global test loss: 0.987, Global test accuracy: 95.88
Round   6, Train loss: 1.056, Test loss: 0.978, Test accuracy: 95.90
Round   6, Global train loss: 1.056, Global test loss: 0.976, Global test accuracy: 96.12
Round   7, Train loss: 1.047, Test loss: 0.971, Test accuracy: 96.06
Round   7, Global train loss: 1.047, Global test loss: 0.969, Global test accuracy: 96.18
Round   8, Train loss: 1.041, Test loss: 0.967, Test accuracy: 96.24
Round   8, Global train loss: 1.041, Global test loss: 0.965, Global test accuracy: 96.46
Round   9, Train loss: 1.036, Test loss: 0.963, Test accuracy: 96.40
Round   9, Global train loss: 1.036, Global test loss: 0.961, Global test accuracy: 96.64
Round  10, Train loss: 1.059, Test loss: 0.962, Test accuracy: 96.52
Round  10, Global train loss: 1.059, Global test loss: 0.959, Global test accuracy: 96.48
Round  11, Train loss: 0.959, Test loss: 0.959, Test accuracy: 96.64
Round  11, Global train loss: 0.959, Global test loss: 0.954, Global test accuracy: 96.72
Round  12, Train loss: 0.948, Test loss: 0.957, Test accuracy: 96.54
Round  12, Global train loss: 0.948, Global test loss: 0.952, Global test accuracy: 96.68
Round  13, Train loss: 0.980, Test loss: 0.954, Test accuracy: 96.66
Round  13, Global train loss: 0.980, Global test loss: 0.953, Global test accuracy: 96.68
Round  14, Train loss: 0.968, Test loss: 0.954, Test accuracy: 96.64
Round  14, Global train loss: 0.968, Global test loss: 0.952, Global test accuracy: 96.66
Round  15, Train loss: 0.994, Test loss: 0.951, Test accuracy: 96.74
Round  15, Global train loss: 0.994, Global test loss: 0.949, Global test accuracy: 97.00
Round  16, Train loss: 0.994, Test loss: 0.951, Test accuracy: 96.82
Round  16, Global train loss: 0.994, Global test loss: 0.950, Global test accuracy: 97.06
Round  17, Train loss: 0.994, Test loss: 0.951, Test accuracy: 96.82
Round  17, Global train loss: 0.994, Global test loss: 0.951, Global test accuracy: 96.82
Round  18, Train loss: 0.972, Test loss: 0.950, Test accuracy: 97.04
Round  18, Global train loss: 0.972, Global test loss: 0.946, Global test accuracy: 97.12
Round  19, Train loss: 0.966, Test loss: 0.949, Test accuracy: 97.02
Round  19, Global train loss: 0.966, Global test loss: 0.946, Global test accuracy: 96.98
Round  20, Train loss: 0.962, Test loss: 0.947, Test accuracy: 97.10
Round  20, Global train loss: 0.962, Global test loss: 0.945, Global test accuracy: 97.36
Round  21, Train loss: 0.983, Test loss: 0.947, Test accuracy: 97.06
Round  21, Global train loss: 0.983, Global test loss: 0.945, Global test accuracy: 97.24
Round  22, Train loss: 1.007, Test loss: 0.947, Test accuracy: 97.12
Round  22, Global train loss: 1.007, Global test loss: 0.948, Global test accuracy: 97.32
Round  23, Train loss: 0.940, Test loss: 0.947, Test accuracy: 97.26
Round  23, Global train loss: 0.940, Global test loss: 0.944, Global test accuracy: 97.54
Round  24, Train loss: 0.978, Test loss: 0.945, Test accuracy: 97.40
Round  24, Global train loss: 0.978, Global test loss: 0.944, Global test accuracy: 97.40
Round  25, Train loss: 0.960, Test loss: 0.943, Test accuracy: 97.52
Round  25, Global train loss: 0.960, Global test loss: 0.942, Global test accuracy: 97.72
Round  26, Train loss: 0.960, Test loss: 0.944, Test accuracy: 97.52
Round  26, Global train loss: 0.960, Global test loss: 0.940, Global test accuracy: 97.62
Round  27, Train loss: 0.948, Test loss: 0.944, Test accuracy: 97.42
Round  27, Global train loss: 0.948, Global test loss: 0.940, Global test accuracy: 97.58
Round  28, Train loss: 0.985, Test loss: 0.943, Test accuracy: 97.54
Round  28, Global train loss: 0.985, Global test loss: 0.942, Global test accuracy: 97.46
Round  29, Train loss: 0.956, Test loss: 0.944, Test accuracy: 97.50
Round  29, Global train loss: 0.956, Global test loss: 0.941, Global test accuracy: 97.54
Round  30, Train loss: 0.971, Test loss: 0.943, Test accuracy: 97.62
Round  30, Global train loss: 0.971, Global test loss: 0.943, Global test accuracy: 97.66
Round  31, Train loss: 0.997, Test loss: 0.943, Test accuracy: 97.64
Round  31, Global train loss: 0.997, Global test loss: 0.943, Global test accuracy: 97.64
Round  32, Train loss: 0.945, Test loss: 0.943, Test accuracy: 97.72
Round  32, Global train loss: 0.945, Global test loss: 0.941, Global test accuracy: 97.78
Round  33, Train loss: 0.938, Test loss: 0.942, Test accuracy: 97.66
Round  33, Global train loss: 0.938, Global test loss: 0.939, Global test accuracy: 97.68
Round  34, Train loss: 0.965, Test loss: 0.943, Test accuracy: 97.44
Round  34, Global train loss: 0.965, Global test loss: 0.944, Global test accuracy: 97.30
Round  35, Train loss: 0.975, Test loss: 0.942, Test accuracy: 97.56
Round  35, Global train loss: 0.975, Global test loss: 0.939, Global test accuracy: 97.66
Round  36, Train loss: 0.959, Test loss: 0.942, Test accuracy: 97.64
Round  36, Global train loss: 0.959, Global test loss: 0.940, Global test accuracy: 97.70
Round  37, Train loss: 0.970, Test loss: 0.941, Test accuracy: 97.56
Round  37, Global train loss: 0.970, Global test loss: 0.937, Global test accuracy: 97.64
Round  38, Train loss: 0.979, Test loss: 0.944, Test accuracy: 97.38
Round  38, Global train loss: 0.979, Global test loss: 0.943, Global test accuracy: 97.40
Round  39, Train loss: 0.927, Test loss: 0.942, Test accuracy: 97.44
Round  39, Global train loss: 0.927, Global test loss: 0.939, Global test accuracy: 97.74
Round  40, Train loss: 0.951, Test loss: 0.941, Test accuracy: 97.48
Round  40, Global train loss: 0.951, Global test loss: 0.938, Global test accuracy: 97.74
Round  41, Train loss: 0.956, Test loss: 0.939, Test accuracy: 97.52
Round  41, Global train loss: 0.956, Global test loss: 0.937, Global test accuracy: 97.74
Round  42, Train loss: 0.948, Test loss: 0.939, Test accuracy: 97.48
Round  42, Global train loss: 0.948, Global test loss: 0.937, Global test accuracy: 97.80
Round  43, Train loss: 0.946, Test loss: 0.938, Test accuracy: 97.44
Round  43, Global train loss: 0.946, Global test loss: 0.935, Global test accuracy: 97.82
Round  44, Train loss: 0.986, Test loss: 0.941, Test accuracy: 97.36
Round  44, Global train loss: 0.986, Global test loss: 0.944, Global test accuracy: 97.04
Round  45, Train loss: 0.969, Test loss: 0.941, Test accuracy: 97.50
Round  45, Global train loss: 0.969, Global test loss: 0.939, Global test accuracy: 97.96
Round  46, Train loss: 0.948, Test loss: 0.940, Test accuracy: 97.62
Round  46, Global train loss: 0.948, Global test loss: 0.936, Global test accuracy: 97.98
Round  47, Train loss: 0.920, Test loss: 0.939, Test accuracy: 97.66
Round  47, Global train loss: 0.920, Global test loss: 0.935, Global test accuracy: 97.86
Round  48, Train loss: 0.924, Test loss: 0.937, Test accuracy: 97.78
Round  48, Global train loss: 0.924, Global test loss: 0.933, Global test accuracy: 98.08
Round  49, Train loss: 0.956, Test loss: 0.938, Test accuracy: 97.60
Round  49, Global train loss: 0.956, Global test loss: 0.939, Global test accuracy: 97.54
Round  50, Train loss: 0.919, Test loss: 0.938, Test accuracy: 97.66
Round  50, Global train loss: 0.919, Global test loss: 0.934, Global test accuracy: 97.80
Round  51, Train loss: 0.952, Test loss: 0.938, Test accuracy: 97.46
Round  51, Global train loss: 0.952, Global test loss: 0.936, Global test accuracy: 98.02
Round  52, Train loss: 0.944, Test loss: 0.938, Test accuracy: 97.56
Round  52, Global train loss: 0.944, Global test loss: 0.933, Global test accuracy: 98.00
Round  53, Train loss: 0.923, Test loss: 0.938, Test accuracy: 97.62
Round  53, Global train loss: 0.923, Global test loss: 0.934, Global test accuracy: 97.96
Round  54, Train loss: 0.926, Test loss: 0.939, Test accuracy: 97.44
Round  54, Global train loss: 0.926, Global test loss: 0.937, Global test accuracy: 97.64
Round  55, Train loss: 0.943, Test loss: 0.938, Test accuracy: 97.52
Round  55, Global train loss: 0.943, Global test loss: 0.935, Global test accuracy: 97.80
Round  56, Train loss: 0.945, Test loss: 0.938, Test accuracy: 97.50
Round  56, Global train loss: 0.945, Global test loss: 0.938, Global test accuracy: 97.62
Round  57, Train loss: 0.947, Test loss: 0.939, Test accuracy: 97.60
Round  57, Global train loss: 0.947, Global test loss: 0.936, Global test accuracy: 97.86
Round  58, Train loss: 0.944, Test loss: 0.938, Test accuracy: 97.50
Round  58, Global train loss: 0.944, Global test loss: 0.936, Global test accuracy: 97.86
Round  59, Train loss: 0.950, Test loss: 0.940, Test accuracy: 97.42
Round  59, Global train loss: 0.950, Global test loss: 0.941, Global test accuracy: 97.08
Round  60, Train loss: 0.924, Test loss: 0.940, Test accuracy: 97.40
Round  60, Global train loss: 0.924, Global test loss: 0.938, Global test accuracy: 97.52
Round  61, Train loss: 0.960, Test loss: 0.938, Test accuracy: 97.44
Round  61, Global train loss: 0.960, Global test loss: 0.933, Global test accuracy: 98.14
Round  62, Train loss: 0.965, Test loss: 0.938, Test accuracy: 97.54
Round  62, Global train loss: 0.965, Global test loss: 0.936, Global test accuracy: 97.96
Round  63, Train loss: 0.946, Test loss: 0.938, Test accuracy: 97.52
Round  63, Global train loss: 0.946, Global test loss: 0.936, Global test accuracy: 98.18
Round  64, Train loss: 0.944, Test loss: 0.938, Test accuracy: 97.62
Round  64, Global train loss: 0.944, Global test loss: 0.934, Global test accuracy: 98.34
Round  65, Train loss: 0.916, Test loss: 0.937, Test accuracy: 97.62
Round  65, Global train loss: 0.916, Global test loss: 0.933, Global test accuracy: 98.14
Round  66, Train loss: 0.950, Test loss: 0.938, Test accuracy: 97.46
Round  66, Global train loss: 0.950, Global test loss: 0.943, Global test accuracy: 97.02
Round  67, Train loss: 0.942, Test loss: 0.938, Test accuracy: 97.58
Round  67, Global train loss: 0.942, Global test loss: 0.933, Global test accuracy: 98.10
Round  68, Train loss: 0.915, Test loss: 0.937, Test accuracy: 97.56
Round  68, Global train loss: 0.915, Global test loss: 0.934, Global test accuracy: 98.16
Round  69, Train loss: 0.924, Test loss: 0.937, Test accuracy: 97.56
Round  69, Global train loss: 0.924, Global test loss: 0.938, Global test accuracy: 97.44
Round  70, Train loss: 0.915, Test loss: 0.935, Test accuracy: 97.62
Round  70, Global train loss: 0.915, Global test loss: 0.931, Global test accuracy: 98.18
Round  71, Train loss: 0.922, Test loss: 0.936, Test accuracy: 97.62
Round  71, Global train loss: 0.922, Global test loss: 0.936, Global test accuracy: 97.80
Round  72, Train loss: 0.942, Test loss: 0.936, Test accuracy: 97.66
Round  72, Global train loss: 0.942, Global test loss: 0.933, Global test accuracy: 97.96
Round  73, Train loss: 0.970, Test loss: 0.936, Test accuracy: 97.60
Round  73, Global train loss: 0.970, Global test loss: 0.934, Global test accuracy: 98.10
Round  74, Train loss: 0.940, Test loss: 0.937, Test accuracy: 97.56
Round  74, Global train loss: 0.940, Global test loss: 0.935, Global test accuracy: 97.72
Round  75, Train loss: 0.922, Test loss: 0.938, Test accuracy: 97.56
Round  75, Global train loss: 0.922, Global test loss: 0.935, Global test accuracy: 97.88
Round  76, Train loss: 0.920, Test loss: 0.937, Test accuracy: 97.54
Round  76, Global train loss: 0.920, Global test loss: 0.936, Global test accuracy: 97.68
Round  77, Train loss: 0.921, Test loss: 0.937, Test accuracy: 97.52
Round  77, Global train loss: 0.921, Global test loss: 0.937, Global test accuracy: 97.48
Round  78, Train loss: 0.939, Test loss: 0.936, Test accuracy: 97.66
Round  78, Global train loss: 0.939, Global test loss: 0.933, Global test accuracy: 97.94
Round  79, Train loss: 0.912, Test loss: 0.935, Test accuracy: 97.56
Round  79, Global train loss: 0.912, Global test loss: 0.931, Global test accuracy: 98.00
Round  80, Train loss: 0.923, Test loss: 0.935, Test accuracy: 97.66
Round  80, Global train loss: 0.923, Global test loss: 0.931, Global test accuracy: 98.00
Round  81, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.68
Round  81, Global train loss: 0.922, Global test loss: 0.931, Global test accuracy: 98.00
Round  82, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.68
Round  82, Global train loss: 0.922, Global test loss: 0.931, Global test accuracy: 97.98
Round  83, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.68
Round  83, Global train loss: 0.922, Global test loss: 0.930, Global test accuracy: 97.96
Round  84, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.66
Round  84, Global train loss: 0.922, Global test loss: 0.930, Global test accuracy: 97.92
Round  85, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.66
Round  85, Global train loss: 0.922, Global test loss: 0.930, Global test accuracy: 97.92
Round  86, Train loss: 0.922, Test loss: 0.935, Test accuracy: 97.70
Round  86, Global train loss: 0.922, Global test loss: 0.930, Global test accuracy: 97.96
Round  87, Train loss: 0.921, Test loss: 0.935, Test accuracy: 97.68
Round  87, Global train loss: 0.921, Global test loss: 0.930, Global test accuracy: 97.92
Round  88, Train loss: 0.921, Test loss: 0.935, Test accuracy: 97.72
Round  88, Global train loss: 0.921, Global test loss: 0.930, Global test accuracy: 97.96
Round  89, Train loss: 0.921, Test loss: 0.934, Test accuracy: 97.68
Round  89, Global train loss: 0.921, Global test loss: 0.930, Global test accuracy: 97.92
Round  90, Train loss: 0.921, Test loss: 0.934, Test accuracy: 97.68
Round  90, Global train loss: 0.921, Global test loss: 0.930, Global test accuracy: 97.96
Round  91, Train loss: 0.921, Test loss: 0.934, Test accuracy: 97.68
Round  91, Global train loss: 0.921, Global test loss: 0.930, Global test accuracy: 97.92/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 0.921, Test loss: 0.934, Test accuracy: 97.66
Round  92, Global train loss: 0.921, Global test loss: 0.929, Global test accuracy: 97.94
Round  93, Train loss: 0.921, Test loss: 0.934, Test accuracy: 97.74
Round  93, Global train loss: 0.921, Global test loss: 0.930, Global test accuracy: 98.00
Round  94, Train loss: 0.920, Test loss: 0.934, Test accuracy: 97.70
Round  94, Global train loss: 0.920, Global test loss: 0.930, Global test accuracy: 98.00
Round  95, Train loss: 0.920, Test loss: 0.934, Test accuracy: 97.74
Round  95, Global train loss: 0.920, Global test loss: 0.930, Global test accuracy: 98.00
Round  96, Train loss: 0.920, Test loss: 0.934, Test accuracy: 97.76
Round  96, Global train loss: 0.920, Global test loss: 0.929, Global test accuracy: 98.02
Round  97, Train loss: 0.920, Test loss: 0.934, Test accuracy: 97.76
Round  97, Global train loss: 0.920, Global test loss: 0.929, Global test accuracy: 98.06
Round  98, Train loss: 0.920, Test loss: 0.934, Test accuracy: 97.76
Round  98, Global train loss: 0.920, Global test loss: 0.929, Global test accuracy: 97.98
Round  99, Train loss: 0.935, Test loss: 0.934, Test accuracy: 97.76
Round  99, Global train loss: 0.935, Global test loss: 0.930, Global test accuracy: 98.08
Final Round, Train loss: 0.973, Test loss: 0.935, Test accuracy: 97.76
Final Round, Global train loss: 0.973, Global test loss: 0.930, Global test accuracy: 98.08
Average accuracy final 10 rounds: 97.72399999999999
1263.6557993888855
[1.5438385009765625, 3.1442930698394775, 5.5043580532073975, 7.211243152618408, 8.715539455413818, 10.147632837295532, 11.545777559280396, 12.974042654037476, 14.380281686782837, 15.852940320968628, 20.843409776687622, 22.249327898025513, 23.682329416275024, 31.56227707862854, 32.934330463409424, 40.768972396850586, 48.62017297744751, 56.87668442726135, 65.1986346244812, 66.5280270576477, 68.00409412384033, 76.10265326499939, 84.26517963409424, 85.75102853775024, 93.81160688400269, 101.5663914680481, 109.84966135025024, 111.23158001899719, 119.53061985969543, 127.78349542617798, 135.60556507110596, 143.70033764839172, 145.08410167694092, 146.52597665786743, 154.33291339874268, 162.0631618499756, 163.6791262626648, 172.4769687652588, 180.36635637283325, 181.80392909049988, 183.10502243041992, 190.76748776435852, 192.13481664657593, 193.66029524803162, 201.66518306732178, 210.17369985580444, 218.308438539505, 219.67267227172852, 221.03521847724915, 228.57636833190918, 229.9422264099121, 231.44066858291626, 239.82557201385498, 241.1856129169464, 242.52407693862915, 250.81633877754211, 258.9876718521118, 260.46864771842957, 268.4813585281372, 276.16578674316406, 277.57442903518677, 285.1400525569916, 292.8941538333893, 300.81979632377625, 308.64814257621765, 310.037269115448, 317.9564514160156, 326.0389292240143, 327.52543902397156, 328.90830278396606, 330.1923043727875, 331.6000134944916, 333.02326703071594, 340.8766236305237, 348.5240306854248, 349.96787452697754, 351.2489972114563, 352.5841872692108, 354.01033186912537, 355.28187680244446, 356.92587065696716, 358.4325454235077, 360.00052762031555, 361.4108352661133, 362.8988676071167, 364.3146913051605, 365.68693566322327, 367.1929364204407, 368.70774579048157, 370.0723557472229, 371.49624490737915, 373.06232047080994, 374.58755469322205, 376.0120840072632, 377.55263471603394, 379.0276713371277, 380.47653675079346, 381.85135865211487, 383.3149480819702, 391.0830430984497, 399.9903881549835]
[37.5, 69.86, 85.44, 93.68, 94.82, 95.46, 95.9, 96.06, 96.24, 96.4, 96.52, 96.64, 96.54, 96.66, 96.64, 96.74, 96.82, 96.82, 97.04, 97.02, 97.1, 97.06, 97.12, 97.26, 97.4, 97.52, 97.52, 97.42, 97.54, 97.5, 97.62, 97.64, 97.72, 97.66, 97.44, 97.56, 97.64, 97.56, 97.38, 97.44, 97.48, 97.52, 97.48, 97.44, 97.36, 97.5, 97.62, 97.66, 97.78, 97.6, 97.66, 97.46, 97.56, 97.62, 97.44, 97.52, 97.5, 97.6, 97.5, 97.42, 97.4, 97.44, 97.54, 97.52, 97.62, 97.62, 97.46, 97.58, 97.56, 97.56, 97.62, 97.62, 97.66, 97.6, 97.56, 97.56, 97.54, 97.52, 97.66, 97.56, 97.66, 97.68, 97.68, 97.68, 97.66, 97.66, 97.7, 97.68, 97.72, 97.68, 97.68, 97.68, 97.66, 97.74, 97.7, 97.74, 97.76, 97.76, 97.76, 97.76, 97.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.597, Test loss: 1.582, Test accuracy: 48.30
Round   0, Global train loss: 1.597, Global test loss: 1.586, Global test accuracy: 53.68
Round   1, Train loss: 1.423, Test loss: 1.337, Test accuracy: 64.08
Round   1, Global train loss: 1.423, Global test loss: 1.234, Global test accuracy: 76.02
Round   2, Train loss: 1.242, Test loss: 1.269, Test accuracy: 70.62
Round   2, Global train loss: 1.242, Global test loss: 1.147, Global test accuracy: 94.76
Round   3, Train loss: 1.239, Test loss: 1.220, Test accuracy: 74.90
Round   3, Global train loss: 1.239, Global test loss: 1.146, Global test accuracy: 94.06
Round   4, Train loss: 1.076, Test loss: 1.122, Test accuracy: 80.06
Round   4, Global train loss: 1.076, Global test loss: 0.995, Global test accuracy: 94.70
Round   5, Train loss: 0.943, Test loss: 1.110, Test accuracy: 80.82
Round   5, Global train loss: 0.943, Global test loss: 0.961, Global test accuracy: 95.90
Round   6, Train loss: 1.156, Test loss: 1.129, Test accuracy: 80.56
Round   6, Global train loss: 1.156, Global test loss: 1.076, Global test accuracy: 94.38
Round   7, Train loss: 1.372, Test loss: 1.191, Test accuracy: 80.42
Round   7, Global train loss: 1.372, Global test loss: 1.398, Global test accuracy: 87.02
Round   8, Train loss: 0.926, Test loss: 1.101, Test accuracy: 81.92
Round   8, Global train loss: 0.926, Global test loss: 0.960, Global test accuracy: 95.50
Round   9, Train loss: 1.143, Test loss: 1.111, Test accuracy: 82.20
Round   9, Global train loss: 1.143, Global test loss: 1.032, Global test accuracy: 94.28
Round  10, Train loss: 1.160, Test loss: 1.101, Test accuracy: 82.82
Round  10, Global train loss: 1.160, Global test loss: 1.065, Global test accuracy: 92.66
Round  11, Train loss: 1.139, Test loss: 1.091, Test accuracy: 83.04
Round  11, Global train loss: 1.139, Global test loss: 1.026, Global test accuracy: 94.24
Round  12, Train loss: 1.364, Test loss: 1.109, Test accuracy: 82.26
Round  12, Global train loss: 1.364, Global test loss: 1.325, Global test accuracy: 76.60
Round  13, Train loss: 1.120, Test loss: 1.077, Test accuracy: 83.50
Round  13, Global train loss: 1.120, Global test loss: 1.030, Global test accuracy: 92.66
Round  14, Train loss: 1.129, Test loss: 1.075, Test accuracy: 82.92
Round  14, Global train loss: 1.129, Global test loss: 1.040, Global test accuracy: 91.70
Round  15, Train loss: 1.138, Test loss: 1.071, Test accuracy: 83.60
Round  15, Global train loss: 1.138, Global test loss: 1.046, Global test accuracy: 93.30
Round  16, Train loss: 0.918, Test loss: 1.070, Test accuracy: 83.66
Round  16, Global train loss: 0.918, Global test loss: 0.955, Global test accuracy: 95.78
Round  17, Train loss: 0.913, Test loss: 1.070, Test accuracy: 83.62
Round  17, Global train loss: 0.913, Global test loss: 0.957, Global test accuracy: 95.46
Round  18, Train loss: 0.917, Test loss: 1.069, Test accuracy: 83.70
Round  18, Global train loss: 0.917, Global test loss: 0.950, Global test accuracy: 96.10
Round  19, Train loss: 1.089, Test loss: 1.069, Test accuracy: 83.54
Round  19, Global train loss: 1.089, Global test loss: 1.023, Global test accuracy: 91.32
Round  20, Train loss: 1.124, Test loss: 1.067, Test accuracy: 83.92
Round  20, Global train loss: 1.124, Global test loss: 1.019, Global test accuracy: 93.50
Round  21, Train loss: 1.114, Test loss: 1.065, Test accuracy: 84.52
Round  21, Global train loss: 1.114, Global test loss: 1.011, Global test accuracy: 93.16
Round  22, Train loss: 1.100, Test loss: 1.063, Test accuracy: 84.72
Round  22, Global train loss: 1.100, Global test loss: 1.005, Global test accuracy: 93.26
Round  23, Train loss: 1.233, Test loss: 1.066, Test accuracy: 84.30
Round  23, Global train loss: 1.233, Global test loss: 1.164, Global test accuracy: 76.56
Round  24, Train loss: 1.065, Test loss: 1.067, Test accuracy: 83.96
Round  24, Global train loss: 1.065, Global test loss: 1.003, Global test accuracy: 92.28
Round  25, Train loss: 1.047, Test loss: 1.066, Test accuracy: 84.06
Round  25, Global train loss: 1.047, Global test loss: 1.004, Global test accuracy: 91.82
Round  26, Train loss: 1.164, Test loss: 1.071, Test accuracy: 83.48
Round  26, Global train loss: 1.164, Global test loss: 1.153, Global test accuracy: 76.08
Round  27, Train loss: 1.010, Test loss: 1.072, Test accuracy: 83.44
Round  27, Global train loss: 1.010, Global test loss: 0.997, Global test accuracy: 92.34
Round  28, Train loss: 1.118, Test loss: 1.072, Test accuracy: 82.92
Round  28, Global train loss: 1.118, Global test loss: 1.131, Global test accuracy: 78.90
Round  29, Train loss: 0.995, Test loss: 1.071, Test accuracy: 83.22
Round  29, Global train loss: 0.995, Global test loss: 0.988, Global test accuracy: 93.64
Round  30, Train loss: 0.988, Test loss: 1.070, Test accuracy: 83.08
Round  30, Global train loss: 0.988, Global test loss: 0.973, Global test accuracy: 94.92
Round  31, Train loss: 1.073, Test loss: 1.074, Test accuracy: 82.96
Round  31, Global train loss: 1.073, Global test loss: 1.073, Global test accuracy: 87.58
Round  32, Train loss: 0.960, Test loss: 1.073, Test accuracy: 82.96
Round  32, Global train loss: 0.960, Global test loss: 0.973, Global test accuracy: 94.28
Round  33, Train loss: 0.950, Test loss: 1.076, Test accuracy: 82.62
Round  33, Global train loss: 0.950, Global test loss: 0.961, Global test accuracy: 95.74
Round  34, Train loss: 0.911, Test loss: 1.076, Test accuracy: 82.64
Round  34, Global train loss: 0.911, Global test loss: 0.947, Global test accuracy: 96.30
Round  35, Train loss: 0.911, Test loss: 1.076, Test accuracy: 82.64
Round  35, Global train loss: 0.911, Global test loss: 0.947, Global test accuracy: 96.26
Round  36, Train loss: 0.944, Test loss: 1.076, Test accuracy: 82.72
Round  36, Global train loss: 0.944, Global test loss: 0.972, Global test accuracy: 94.48
Round  37, Train loss: 0.909, Test loss: 1.076, Test accuracy: 82.80
Round  37, Global train loss: 0.909, Global test loss: 0.949, Global test accuracy: 95.90
Round  38, Train loss: 0.909, Test loss: 1.076, Test accuracy: 82.80
Round  38, Global train loss: 0.909, Global test loss: 0.947, Global test accuracy: 96.20
Round  39, Train loss: 0.939, Test loss: 1.076, Test accuracy: 82.76
Round  39, Global train loss: 0.939, Global test loss: 0.970, Global test accuracy: 94.18
Round  40, Train loss: 1.018, Test loss: 1.080, Test accuracy: 82.30
Round  40, Global train loss: 1.018, Global test loss: 1.043, Global test accuracy: 89.10
Round  41, Train loss: 0.908, Test loss: 1.080, Test accuracy: 82.32
Round  41, Global train loss: 0.908, Global test loss: 0.949, Global test accuracy: 95.98
Round  42, Train loss: 0.909, Test loss: 1.080, Test accuracy: 82.32
Round  42, Global train loss: 0.909, Global test loss: 0.949, Global test accuracy: 95.96
Round  43, Train loss: 0.910, Test loss: 1.080, Test accuracy: 82.36
Round  43, Global train loss: 0.910, Global test loss: 0.948, Global test accuracy: 96.00
Round  44, Train loss: 0.980, Test loss: 1.081, Test accuracy: 82.16
Round  44, Global train loss: 0.980, Global test loss: 0.971, Global test accuracy: 94.70
Round  45, Train loss: 0.969, Test loss: 1.081, Test accuracy: 82.24
Round  45, Global train loss: 0.969, Global test loss: 0.966, Global test accuracy: 94.80
Round  46, Train loss: 0.909, Test loss: 1.081, Test accuracy: 82.16
Round  46, Global train loss: 0.909, Global test loss: 0.950, Global test accuracy: 95.86
Round  47, Train loss: 0.932, Test loss: 1.082, Test accuracy: 82.12
Round  47, Global train loss: 0.932, Global test loss: 0.963, Global test accuracy: 95.20
Round  48, Train loss: 0.960, Test loss: 1.082, Test accuracy: 82.02
Round  48, Global train loss: 0.960, Global test loss: 0.970, Global test accuracy: 94.44
Round  49, Train loss: 0.909, Test loss: 1.082, Test accuracy: 82.02
Round  49, Global train loss: 0.909, Global test loss: 0.950, Global test accuracy: 95.88
Round  50, Train loss: 0.908, Test loss: 1.082, Test accuracy: 82.02
Round  50, Global train loss: 0.908, Global test loss: 0.950, Global test accuracy: 95.90
Round  51, Train loss: 0.959, Test loss: 1.083, Test accuracy: 81.84
Round  51, Global train loss: 0.959, Global test loss: 0.970, Global test accuracy: 94.44
Round  52, Train loss: 0.976, Test loss: 1.082, Test accuracy: 81.94
Round  52, Global train loss: 0.976, Global test loss: 1.054, Global test accuracy: 87.38
Round  53, Train loss: 0.930, Test loss: 1.082, Test accuracy: 81.94
Round  53, Global train loss: 0.930, Global test loss: 0.958, Global test accuracy: 95.80
Round  54, Train loss: 0.911, Test loss: 1.082, Test accuracy: 81.94
Round  54, Global train loss: 0.911, Global test loss: 0.946, Global test accuracy: 96.14
Round  55, Train loss: 0.911, Test loss: 1.082, Test accuracy: 81.94
Round  55, Global train loss: 0.911, Global test loss: 0.943, Global test accuracy: 96.20
Round  56, Train loss: 0.910, Test loss: 1.082, Test accuracy: 81.96
Round  56, Global train loss: 0.910, Global test loss: 0.943, Global test accuracy: 96.44
Round  57, Train loss: 0.972, Test loss: 1.082, Test accuracy: 81.96
Round  57, Global train loss: 0.972, Global test loss: 1.049, Global test accuracy: 87.74
Round  58, Train loss: 0.928, Test loss: 1.081, Test accuracy: 81.94
Round  58, Global train loss: 0.928, Global test loss: 0.963, Global test accuracy: 94.76
Round  59, Train loss: 0.911, Test loss: 1.081, Test accuracy: 81.94
Round  59, Global train loss: 0.911, Global test loss: 0.943, Global test accuracy: 96.38
Round  60, Train loss: 0.950, Test loss: 1.081, Test accuracy: 82.06
Round  60, Global train loss: 0.950, Global test loss: 0.974, Global test accuracy: 93.64
Round  61, Train loss: 0.927, Test loss: 1.080, Test accuracy: 82.18
Round  61, Global train loss: 0.927, Global test loss: 0.962, Global test accuracy: 95.10
Round  62, Train loss: 0.912, Test loss: 1.080, Test accuracy: 82.18
Round  62, Global train loss: 0.912, Global test loss: 0.943, Global test accuracy: 96.52
Round  63, Train loss: 0.908, Test loss: 1.080, Test accuracy: 82.18
Round  63, Global train loss: 0.908, Global test loss: 0.947, Global test accuracy: 95.98
Round  64, Train loss: 0.951, Test loss: 1.081, Test accuracy: 82.00
Round  64, Global train loss: 0.951, Global test loss: 0.977, Global test accuracy: 93.50
Round  65, Train loss: 0.910, Test loss: 1.081, Test accuracy: 81.98
Round  65, Global train loss: 0.910, Global test loss: 0.945, Global test accuracy: 96.20
Round  66, Train loss: 0.969, Test loss: 1.083, Test accuracy: 81.88
Round  66, Global train loss: 0.969, Global test loss: 1.037, Global test accuracy: 88.60
Round  67, Train loss: 0.909, Test loss: 1.083, Test accuracy: 81.90
Round  67, Global train loss: 0.909, Global test loss: 0.945, Global test accuracy: 96.24
Round  68, Train loss: 0.909, Test loss: 1.082, Test accuracy: 81.88
Round  68, Global train loss: 0.909, Global test loss: 0.950, Global test accuracy: 95.54
Round  69, Train loss: 0.927, Test loss: 1.082, Test accuracy: 82.00
Round  69, Global train loss: 0.927, Global test loss: 0.965, Global test accuracy: 94.74
Round  70, Train loss: 0.929, Test loss: 1.082, Test accuracy: 81.82
Round  70, Global train loss: 0.929, Global test loss: 0.965, Global test accuracy: 94.52
Round  71, Train loss: 0.951, Test loss: 1.082, Test accuracy: 81.84
Round  71, Global train loss: 0.951, Global test loss: 0.972, Global test accuracy: 93.90
Round  72, Train loss: 0.951, Test loss: 1.081, Test accuracy: 81.90
Round  72, Global train loss: 0.951, Global test loss: 0.966, Global test accuracy: 94.54
Round  73, Train loss: 0.928, Test loss: 1.082, Test accuracy: 81.94
Round  73, Global train loss: 0.928, Global test loss: 0.956, Global test accuracy: 95.56
Round  74, Train loss: 0.909, Test loss: 1.082, Test accuracy: 81.94
Round  74, Global train loss: 0.909, Global test loss: 0.945, Global test accuracy: 96.28
Round  75, Train loss: 0.910, Test loss: 1.082, Test accuracy: 81.94
Round  75, Global train loss: 0.910, Global test loss: 0.948, Global test accuracy: 95.76
Round  76, Train loss: 0.951, Test loss: 1.083, Test accuracy: 81.88
Round  76, Global train loss: 0.951, Global test loss: 0.964, Global test accuracy: 94.50
Round  77, Train loss: 0.910, Test loss: 1.083, Test accuracy: 81.88
Round  77, Global train loss: 0.910, Global test loss: 0.945, Global test accuracy: 96.20
Round  78, Train loss: 0.909, Test loss: 1.083, Test accuracy: 81.88
Round  78, Global train loss: 0.909, Global test loss: 0.949, Global test accuracy: 95.72
Round  79, Train loss: 0.950, Test loss: 1.082, Test accuracy: 81.88
Round  79, Global train loss: 0.950, Global test loss: 0.972, Global test accuracy: 93.76
Round  80, Train loss: 0.907, Test loss: 1.082, Test accuracy: 81.88
Round  80, Global train loss: 0.907, Global test loss: 0.947, Global test accuracy: 96.10
Round  81, Train loss: 0.908, Test loss: 1.082, Test accuracy: 81.88
Round  81, Global train loss: 0.908, Global test loss: 0.948, Global test accuracy: 95.88
Round  82, Train loss: 0.910, Test loss: 1.082, Test accuracy: 81.88
Round  82, Global train loss: 0.910, Global test loss: 0.948, Global test accuracy: 95.90
Round  83, Train loss: 0.928, Test loss: 1.081, Test accuracy: 82.06
Round  83, Global train loss: 0.928, Global test loss: 0.967, Global test accuracy: 94.00
Round  84, Train loss: 0.925, Test loss: 1.082, Test accuracy: 81.94
Round  84, Global train loss: 0.925, Global test loss: 0.963, Global test accuracy: 94.68
Round  85, Train loss: 0.911, Test loss: 1.082, Test accuracy: 81.94
Round  85, Global train loss: 0.911, Global test loss: 0.944, Global test accuracy: 96.26
Round  86, Train loss: 0.909, Test loss: 1.081, Test accuracy: 81.94
Round  86, Global train loss: 0.909, Global test loss: 0.941, Global test accuracy: 96.74
Round  87, Train loss: 0.926, Test loss: 1.081, Test accuracy: 82.06
Round  87, Global train loss: 0.926, Global test loss: 0.969, Global test accuracy: 94.14
Round  88, Train loss: 0.925, Test loss: 1.081, Test accuracy: 81.98
Round  88, Global train loss: 0.925, Global test loss: 0.965, Global test accuracy: 94.62
Round  89, Train loss: 0.909, Test loss: 1.081, Test accuracy: 81.98
Round  89, Global train loss: 0.909, Global test loss: 0.941, Global test accuracy: 96.68
Round  90, Train loss: 0.968, Test loss: 1.082, Test accuracy: 81.80
Round  90, Global train loss: 0.968, Global test loss: 1.027, Global test accuracy: 88.82
Round  91, Train loss: 0.967, Test loss: 1.083, Test accuracy: 81.90
Round  91, Global train loss: 0.967, Global test loss: 1.026, Global test accuracy: 88.84
Round  92, Train loss: 0.927, Test loss: 1.082, Test accuracy: 81.86
Round  92, Global train loss: 0.927, Global test loss: 0.968, Global test accuracy: 94.34
Round  93, Train loss: 0.926, Test loss: 1.082, Test accuracy: 81.88
Round  93, Global train loss: 0.926, Global test loss: 0.956, Global test accuracy: 95.32
Round  94, Train loss: 0.908, Test loss: 1.082, Test accuracy: 81.88
Round  94, Global train loss: 0.908, Global test loss: 0.942, Global test accuracy: 96.42
Round  95, Train loss: 0.908, Test loss: 1.082, Test accuracy: 81.92
Round  95, Global train loss: 0.908, Global test loss: 0.947, Global test accuracy: 96.02/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 0.908, Test loss: 1.082, Test accuracy: 81.94
Round  96, Global train loss: 0.908, Global test loss: 0.947, Global test accuracy: 96.10
Round  97, Train loss: 0.947, Test loss: 1.082, Test accuracy: 81.96
Round  97, Global train loss: 0.947, Global test loss: 0.970, Global test accuracy: 94.00
Round  98, Train loss: 0.950, Test loss: 1.082, Test accuracy: 81.94
Round  98, Global train loss: 0.950, Global test loss: 0.972, Global test accuracy: 94.00
Round  99, Train loss: 0.924, Test loss: 1.082, Test accuracy: 81.86
Round  99, Global train loss: 0.924, Global test loss: 0.964, Global test accuracy: 94.74
Final Round, Train loss: 0.926, Test loss: 1.083, Test accuracy: 81.80
Final Round, Global train loss: 0.926, Global test loss: 0.964, Global test accuracy: 94.74
Average accuracy final 10 rounds: 81.894 

Average global accuracy final 10 rounds: 93.86000000000001 

784.0029571056366
[1.0639946460723877, 2.1279892921447754, 3.091954231262207, 4.055919170379639, 5.115623235702515, 6.175327301025391, 7.2616002559661865, 8.347873210906982, 9.36054801940918, 10.373222827911377, 11.523342847824097, 12.673462867736816, 13.819472074508667, 14.965481281280518, 16.01964235305786, 17.073803424835205, 18.214001178741455, 19.354198932647705, 20.339874982833862, 21.32555103302002, 22.386093616485596, 23.446636199951172, 24.53495502471924, 25.623273849487305, 26.64325189590454, 27.663229942321777, 28.73176145553589, 29.80029296875, 30.916132926940918, 32.031972885131836, 33.0131471157074, 33.99432134628296, 34.9624388217926, 35.930556297302246, 36.96296405792236, 37.99537181854248, 39.087634563446045, 40.17989730834961, 41.371158599853516, 42.56241989135742, 43.68996572494507, 44.817511558532715, 45.89978814125061, 46.982064723968506, 48.23358726501465, 49.48510980606079, 50.58661770820618, 51.68812561035156, 52.64651846885681, 53.60491132736206, 54.587316274642944, 55.56972122192383, 56.51453757286072, 57.45935392379761, 58.47423028945923, 59.48910665512085, 60.63627576828003, 61.78344488143921, 62.81127047538757, 63.83909606933594, 64.94169092178345, 66.04428577423096, 67.06416177749634, 68.08403778076172, 69.09388399124146, 70.10373020172119, 71.06615042686462, 72.02857065200806, 73.0453553199768, 74.06213998794556, 75.06336975097656, 76.06459951400757, 77.02415108680725, 77.98370265960693, 79.2330231666565, 80.48234367370605, 81.61890053749084, 82.75545740127563, 83.86473107337952, 84.9740047454834, 86.2949903011322, 87.615975856781, 88.82772517204285, 90.03947448730469, 90.99039053916931, 91.94130659103394, 93.03344249725342, 94.1255784034729, 95.09420084953308, 96.06282329559326, 97.18649077415466, 98.31015825271606, 99.41382169723511, 100.51748514175415, 101.6222198009491, 102.72695446014404, 103.71728777885437, 104.7076210975647, 105.79638576507568, 106.88515043258667, 107.87458896636963, 108.86402750015259, 110.0501139163971, 111.2362003326416, 112.2486457824707, 113.2610912322998, 114.20207166671753, 115.14305210113525, 116.1635229587555, 117.18399381637573, 118.26673865318298, 119.34948348999023, 120.3566882610321, 121.36389303207397, 122.38164734840393, 123.39940166473389, 124.3667950630188, 125.33418846130371, 126.52496862411499, 127.71574878692627, 128.83733749389648, 129.9589262008667, 131.01905131340027, 132.07917642593384, 133.18961572647095, 134.30005502700806, 135.40034747123718, 136.5006399154663, 137.58419585227966, 138.66775178909302, 139.62157154083252, 140.57539129257202, 141.56631922721863, 142.55724716186523, 143.55360889434814, 144.54997062683105, 145.52679204940796, 146.50361347198486, 147.54703330993652, 148.59045314788818, 149.53210973739624, 150.4737663269043, 151.56568884849548, 152.65761137008667, 153.75988817214966, 154.86216497421265, 155.904381275177, 156.94659757614136, 157.9907250404358, 159.03485250473022, 160.12745022773743, 161.22004795074463, 162.21470284461975, 163.20935773849487, 164.25675511360168, 165.3041524887085, 166.27264046669006, 167.24112844467163, 168.42639684677124, 169.61166524887085, 170.70507073402405, 171.79847621917725, 172.78721451759338, 173.77595281600952, 174.72207045555115, 175.66818809509277, 176.73904156684875, 177.80989503860474, 178.8625009059906, 179.91510677337646, 180.84480142593384, 181.7744960784912, 182.7973620891571, 183.820228099823, 184.8271415233612, 185.8340549468994, 186.85771942138672, 187.88138389587402, 188.90707969665527, 189.93277549743652, 190.83333230018616, 191.7338891029358, 192.84936499595642, 193.96484088897705, 195.03098583221436, 196.09713077545166, 197.275536775589, 198.45394277572632, 199.47581553459167, 200.49768829345703, 201.51863765716553, 202.53958702087402, 203.56327986717224, 204.58697271347046, 205.70543146133423, 206.823890209198, 207.80117917060852, 208.77846813201904, 209.88445258140564, 210.99043703079224, 213.1427845954895, 215.29513216018677]
[48.3, 48.3, 64.08, 64.08, 70.62, 70.62, 74.9, 74.9, 80.06, 80.06, 80.82, 80.82, 80.56, 80.56, 80.42, 80.42, 81.92, 81.92, 82.2, 82.2, 82.82, 82.82, 83.04, 83.04, 82.26, 82.26, 83.5, 83.5, 82.92, 82.92, 83.6, 83.6, 83.66, 83.66, 83.62, 83.62, 83.7, 83.7, 83.54, 83.54, 83.92, 83.92, 84.52, 84.52, 84.72, 84.72, 84.3, 84.3, 83.96, 83.96, 84.06, 84.06, 83.48, 83.48, 83.44, 83.44, 82.92, 82.92, 83.22, 83.22, 83.08, 83.08, 82.96, 82.96, 82.96, 82.96, 82.62, 82.62, 82.64, 82.64, 82.64, 82.64, 82.72, 82.72, 82.8, 82.8, 82.8, 82.8, 82.76, 82.76, 82.3, 82.3, 82.32, 82.32, 82.32, 82.32, 82.36, 82.36, 82.16, 82.16, 82.24, 82.24, 82.16, 82.16, 82.12, 82.12, 82.02, 82.02, 82.02, 82.02, 82.02, 82.02, 81.84, 81.84, 81.94, 81.94, 81.94, 81.94, 81.94, 81.94, 81.94, 81.94, 81.96, 81.96, 81.96, 81.96, 81.94, 81.94, 81.94, 81.94, 82.06, 82.06, 82.18, 82.18, 82.18, 82.18, 82.18, 82.18, 82.0, 82.0, 81.98, 81.98, 81.88, 81.88, 81.9, 81.9, 81.88, 81.88, 82.0, 82.0, 81.82, 81.82, 81.84, 81.84, 81.9, 81.9, 81.94, 81.94, 81.94, 81.94, 81.94, 81.94, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 81.88, 82.06, 82.06, 81.94, 81.94, 81.94, 81.94, 81.94, 81.94, 82.06, 82.06, 81.98, 81.98, 81.98, 81.98, 81.8, 81.8, 81.9, 81.9, 81.86, 81.86, 81.88, 81.88, 81.88, 81.88, 81.92, 81.92, 81.94, 81.94, 81.96, 81.96, 81.94, 81.94, 81.86, 81.86, 81.8, 81.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.575, Test loss: 1.510, Test accuracy: 78.14
Round   0, Global train loss: 1.575, Global test loss: 1.511, Global test accuracy: 82.50
Round   1, Train loss: 1.189, Test loss: 1.158, Test accuracy: 85.94
Round   1, Global train loss: 1.189, Global test loss: 1.005, Global test accuracy: 94.58
Round   2, Train loss: 1.169, Test loss: 1.109, Test accuracy: 87.96
Round   2, Global train loss: 1.169, Global test loss: 0.987, Global test accuracy: 94.64
Round   3, Train loss: 0.958, Test loss: 1.091, Test accuracy: 88.88
Round   3, Global train loss: 0.958, Global test loss: 0.958, Global test accuracy: 96.04
Round   4, Train loss: 0.981, Test loss: 1.031, Test accuracy: 92.18
Round   4, Global train loss: 0.981, Global test loss: 0.955, Global test accuracy: 96.06
Round   5, Train loss: 1.137, Test loss: 1.027, Test accuracy: 92.14
Round   5, Global train loss: 1.137, Global test loss: 0.960, Global test accuracy: 95.70
Round   6, Train loss: 0.929, Test loss: 0.967, Test accuracy: 94.92
Round   6, Global train loss: 0.929, Global test loss: 0.948, Global test accuracy: 96.56
Round   7, Train loss: 0.933, Test loss: 0.965, Test accuracy: 94.88
Round   7, Global train loss: 0.933, Global test loss: 0.948, Global test accuracy: 96.38
Round   8, Train loss: 0.924, Test loss: 0.964, Test accuracy: 94.90
Round   8, Global train loss: 0.924, Global test loss: 0.945, Global test accuracy: 96.34
Round   9, Train loss: 0.928, Test loss: 0.963, Test accuracy: 94.98
Round   9, Global train loss: 0.928, Global test loss: 0.944, Global test accuracy: 96.50
Round  10, Train loss: 1.180, Test loss: 0.961, Test accuracy: 95.02
Round  10, Global train loss: 1.180, Global test loss: 0.955, Global test accuracy: 95.52
Round  11, Train loss: 0.918, Test loss: 0.958, Test accuracy: 95.22
Round  11, Global train loss: 0.918, Global test loss: 0.944, Global test accuracy: 96.56
Round  12, Train loss: 1.122, Test loss: 0.960, Test accuracy: 94.96
Round  12, Global train loss: 1.122, Global test loss: 0.948, Global test accuracy: 96.26
Round  13, Train loss: 0.966, Test loss: 0.960, Test accuracy: 94.82
Round  13, Global train loss: 0.966, Global test loss: 0.947, Global test accuracy: 96.02
Round  14, Train loss: 1.129, Test loss: 0.960, Test accuracy: 94.96
Round  14, Global train loss: 1.129, Global test loss: 0.945, Global test accuracy: 96.48
Round  15, Train loss: 1.158, Test loss: 0.963, Test accuracy: 94.70
Round  15, Global train loss: 1.158, Global test loss: 0.952, Global test accuracy: 95.48
Round  16, Train loss: 1.160, Test loss: 0.963, Test accuracy: 94.60
Round  16, Global train loss: 1.160, Global test loss: 0.948, Global test accuracy: 95.94
Round  17, Train loss: 0.957, Test loss: 0.966, Test accuracy: 94.18
Round  17, Global train loss: 0.957, Global test loss: 0.947, Global test accuracy: 96.04
Round  18, Train loss: 1.135, Test loss: 0.956, Test accuracy: 95.10
Round  18, Global train loss: 1.135, Global test loss: 0.944, Global test accuracy: 96.36
Round  19, Train loss: 0.966, Test loss: 0.954, Test accuracy: 95.26
Round  19, Global train loss: 0.966, Global test loss: 0.946, Global test accuracy: 96.16
Round  20, Train loss: 1.153, Test loss: 0.957, Test accuracy: 94.92
Round  20, Global train loss: 1.153, Global test loss: 0.956, Global test accuracy: 95.16
Round  21, Train loss: 0.953, Test loss: 0.959, Test accuracy: 94.80
Round  21, Global train loss: 0.953, Global test loss: 0.953, Global test accuracy: 95.36
Round  22, Train loss: 0.951, Test loss: 0.955, Test accuracy: 95.24
Round  22, Global train loss: 0.951, Global test loss: 0.946, Global test accuracy: 96.06
Round  23, Train loss: 0.916, Test loss: 0.955, Test accuracy: 95.28
Round  23, Global train loss: 0.916, Global test loss: 0.941, Global test accuracy: 96.70
Round  24, Train loss: 1.123, Test loss: 0.955, Test accuracy: 95.30
Round  24, Global train loss: 1.123, Global test loss: 0.945, Global test accuracy: 96.24
Round  25, Train loss: 0.921, Test loss: 0.955, Test accuracy: 95.34
Round  25, Global train loss: 0.921, Global test loss: 0.940, Global test accuracy: 96.60
Round  26, Train loss: 0.915, Test loss: 0.955, Test accuracy: 95.38
Round  26, Global train loss: 0.915, Global test loss: 0.941, Global test accuracy: 96.66
Round  27, Train loss: 0.951, Test loss: 0.955, Test accuracy: 95.32
Round  27, Global train loss: 0.951, Global test loss: 0.945, Global test accuracy: 96.22
Round  28, Train loss: 0.915, Test loss: 0.955, Test accuracy: 95.38
Round  28, Global train loss: 0.915, Global test loss: 0.941, Global test accuracy: 96.60
Round  29, Train loss: 1.325, Test loss: 0.954, Test accuracy: 95.30
Round  29, Global train loss: 1.325, Global test loss: 0.953, Global test accuracy: 95.40
Round  30, Train loss: 0.922, Test loss: 0.954, Test accuracy: 95.26
Round  30, Global train loss: 0.922, Global test loss: 0.940, Global test accuracy: 96.62
Round  31, Train loss: 0.912, Test loss: 0.954, Test accuracy: 95.24
Round  31, Global train loss: 0.912, Global test loss: 0.941, Global test accuracy: 96.66
Round  32, Train loss: 0.914, Test loss: 0.954, Test accuracy: 95.20
Round  32, Global train loss: 0.914, Global test loss: 0.940, Global test accuracy: 96.68
Round  33, Train loss: 1.324, Test loss: 0.953, Test accuracy: 95.40
Round  33, Global train loss: 1.324, Global test loss: 0.952, Global test accuracy: 95.48
Round  34, Train loss: 1.120, Test loss: 0.965, Test accuracy: 94.12
Round  34, Global train loss: 1.120, Global test loss: 0.953, Global test accuracy: 95.42
Round  35, Train loss: 1.113, Test loss: 0.959, Test accuracy: 94.70
Round  35, Global train loss: 1.113, Global test loss: 0.952, Global test accuracy: 95.64
Round  36, Train loss: 0.954, Test loss: 0.961, Test accuracy: 94.46
Round  36, Global train loss: 0.954, Global test loss: 0.949, Global test accuracy: 95.96
Round  37, Train loss: 1.145, Test loss: 0.961, Test accuracy: 94.50
Round  37, Global train loss: 1.145, Global test loss: 0.953, Global test accuracy: 95.28
Round  38, Train loss: 1.106, Test loss: 0.963, Test accuracy: 94.20
Round  38, Global train loss: 1.106, Global test loss: 0.953, Global test accuracy: 95.72
Round  39, Train loss: 0.913, Test loss: 0.963, Test accuracy: 94.14
Round  39, Global train loss: 0.913, Global test loss: 0.943, Global test accuracy: 96.24
Round  40, Train loss: 0.913, Test loss: 0.964, Test accuracy: 94.08
Round  40, Global train loss: 0.913, Global test loss: 0.944, Global test accuracy: 96.36
Round  41, Train loss: 1.107, Test loss: 0.963, Test accuracy: 94.18
Round  41, Global train loss: 1.107, Global test loss: 0.944, Global test accuracy: 96.22
Round  42, Train loss: 0.913, Test loss: 0.963, Test accuracy: 94.18
Round  42, Global train loss: 0.913, Global test loss: 0.941, Global test accuracy: 96.56
Round  43, Train loss: 0.916, Test loss: 0.963, Test accuracy: 94.08
Round  43, Global train loss: 0.916, Global test loss: 0.940, Global test accuracy: 96.62
Round  44, Train loss: 1.110, Test loss: 0.964, Test accuracy: 94.04
Round  44, Global train loss: 1.110, Global test loss: 0.947, Global test accuracy: 95.96
Round  45, Train loss: 1.107, Test loss: 0.969, Test accuracy: 93.56
Round  45, Global train loss: 1.107, Global test loss: 0.961, Global test accuracy: 94.70
Round  46, Train loss: 0.948, Test loss: 0.969, Test accuracy: 93.60
Round  46, Global train loss: 0.948, Global test loss: 0.946, Global test accuracy: 96.02
Round  47, Train loss: 1.107, Test loss: 0.970, Test accuracy: 93.50
Round  47, Global train loss: 1.107, Global test loss: 0.945, Global test accuracy: 96.30
Round  48, Train loss: 0.911, Test loss: 0.970, Test accuracy: 93.52
Round  48, Global train loss: 0.911, Global test loss: 0.940, Global test accuracy: 96.78
Round  49, Train loss: 0.947, Test loss: 0.970, Test accuracy: 93.52
Round  49, Global train loss: 0.947, Global test loss: 0.945, Global test accuracy: 96.00
Round  50, Train loss: 0.946, Test loss: 0.970, Test accuracy: 93.54
Round  50, Global train loss: 0.946, Global test loss: 0.946, Global test accuracy: 96.00
Round  51, Train loss: 0.913, Test loss: 0.969, Test accuracy: 93.56
Round  51, Global train loss: 0.913, Global test loss: 0.940, Global test accuracy: 96.58
Round  52, Train loss: 0.945, Test loss: 0.969, Test accuracy: 93.58
Round  52, Global train loss: 0.945, Global test loss: 0.949, Global test accuracy: 95.76
Round  53, Train loss: 1.112, Test loss: 0.965, Test accuracy: 93.88
Round  53, Global train loss: 1.112, Global test loss: 0.952, Global test accuracy: 95.28
Round  54, Train loss: 1.111, Test loss: 0.965, Test accuracy: 93.88
Round  54, Global train loss: 1.111, Global test loss: 0.947, Global test accuracy: 95.94
Round  55, Train loss: 1.296, Test loss: 0.968, Test accuracy: 93.68
Round  55, Global train loss: 1.296, Global test loss: 0.978, Global test accuracy: 92.90
Round  56, Train loss: 1.291, Test loss: 0.967, Test accuracy: 93.80
Round  56, Global train loss: 1.291, Global test loss: 0.972, Global test accuracy: 93.56
Round  57, Train loss: 1.103, Test loss: 0.968, Test accuracy: 93.70
Round  57, Global train loss: 1.103, Global test loss: 0.950, Global test accuracy: 95.66
Round  58, Train loss: 0.914, Test loss: 0.968, Test accuracy: 93.72
Round  58, Global train loss: 0.914, Global test loss: 0.941, Global test accuracy: 96.62
Round  59, Train loss: 1.106, Test loss: 0.967, Test accuracy: 93.84
Round  59, Global train loss: 1.106, Global test loss: 0.952, Global test accuracy: 95.38
Round  60, Train loss: 0.908, Test loss: 0.967, Test accuracy: 93.88
Round  60, Global train loss: 0.908, Global test loss: 0.941, Global test accuracy: 96.48
Round  61, Train loss: 1.107, Test loss: 0.965, Test accuracy: 93.98
Round  61, Global train loss: 1.107, Global test loss: 0.946, Global test accuracy: 95.96
Round  62, Train loss: 1.103, Test loss: 0.966, Test accuracy: 93.94
Round  62, Global train loss: 1.103, Global test loss: 0.955, Global test accuracy: 95.08
Round  63, Train loss: 1.103, Test loss: 0.967, Test accuracy: 93.86
Round  63, Global train loss: 1.103, Global test loss: 0.947, Global test accuracy: 96.02
Round  64, Train loss: 0.942, Test loss: 0.967, Test accuracy: 93.92
Round  64, Global train loss: 0.942, Global test loss: 0.947, Global test accuracy: 95.90
Round  65, Train loss: 1.099, Test loss: 0.967, Test accuracy: 93.76
Round  65, Global train loss: 1.099, Global test loss: 0.956, Global test accuracy: 95.22
Round  66, Train loss: 0.910, Test loss: 0.967, Test accuracy: 93.74
Round  66, Global train loss: 0.910, Global test loss: 0.943, Global test accuracy: 96.14
Round  67, Train loss: 1.095, Test loss: 0.967, Test accuracy: 93.82
Round  67, Global train loss: 1.095, Global test loss: 0.956, Global test accuracy: 95.32
Round  68, Train loss: 0.943, Test loss: 0.967, Test accuracy: 93.90
Round  68, Global train loss: 0.943, Global test loss: 0.948, Global test accuracy: 95.92
Round  69, Train loss: 0.945, Test loss: 0.967, Test accuracy: 93.96
Round  69, Global train loss: 0.945, Global test loss: 0.948, Global test accuracy: 95.94
Round  70, Train loss: 0.913, Test loss: 0.966, Test accuracy: 93.96
Round  70, Global train loss: 0.913, Global test loss: 0.942, Global test accuracy: 96.48
Round  71, Train loss: 0.911, Test loss: 0.966, Test accuracy: 94.02
Round  71, Global train loss: 0.911, Global test loss: 0.940, Global test accuracy: 96.64
Round  72, Train loss: 0.913, Test loss: 0.965, Test accuracy: 94.04
Round  72, Global train loss: 0.913, Global test loss: 0.939, Global test accuracy: 96.70
Round  73, Train loss: 1.099, Test loss: 0.970, Test accuracy: 93.50
Round  73, Global train loss: 1.099, Global test loss: 0.958, Global test accuracy: 94.96
Round  74, Train loss: 1.090, Test loss: 0.968, Test accuracy: 93.62
Round  74, Global train loss: 1.090, Global test loss: 0.956, Global test accuracy: 95.06
Round  75, Train loss: 0.912, Test loss: 0.968, Test accuracy: 93.62
Round  75, Global train loss: 0.912, Global test loss: 0.942, Global test accuracy: 96.32
Round  76, Train loss: 1.122, Test loss: 0.968, Test accuracy: 93.80
Round  76, Global train loss: 1.122, Global test loss: 0.971, Global test accuracy: 93.48
Round  77, Train loss: 1.088, Test loss: 0.969, Test accuracy: 93.64
Round  77, Global train loss: 1.088, Global test loss: 0.962, Global test accuracy: 94.46
Round  78, Train loss: 0.911, Test loss: 0.969, Test accuracy: 93.70
Round  78, Global train loss: 0.911, Global test loss: 0.943, Global test accuracy: 96.12
Round  79, Train loss: 0.910, Test loss: 0.969, Test accuracy: 93.70
Round  79, Global train loss: 0.910, Global test loss: 0.942, Global test accuracy: 96.30
Round  80, Train loss: 1.138, Test loss: 0.966, Test accuracy: 94.02
Round  80, Global train loss: 1.138, Global test loss: 0.951, Global test accuracy: 95.58
Round  81, Train loss: 0.908, Test loss: 0.966, Test accuracy: 94.02
Round  81, Global train loss: 0.908, Global test loss: 0.942, Global test accuracy: 96.32
Round  82, Train loss: 0.913, Test loss: 0.966, Test accuracy: 94.02
Round  82, Global train loss: 0.913, Global test loss: 0.941, Global test accuracy: 96.16
Round  83, Train loss: 0.909, Test loss: 0.965, Test accuracy: 94.10
Round  83, Global train loss: 0.909, Global test loss: 0.942, Global test accuracy: 96.28
Round  84, Train loss: 1.103, Test loss: 0.968, Test accuracy: 93.76
Round  84, Global train loss: 1.103, Global test loss: 0.946, Global test accuracy: 96.00
Round  85, Train loss: 1.091, Test loss: 0.969, Test accuracy: 93.62
Round  85, Global train loss: 1.091, Global test loss: 0.961, Global test accuracy: 94.44
Round  86, Train loss: 1.282, Test loss: 0.965, Test accuracy: 94.08
Round  86, Global train loss: 1.282, Global test loss: 0.974, Global test accuracy: 93.36
Round  87, Train loss: 0.941, Test loss: 0.967, Test accuracy: 93.94
Round  87, Global train loss: 0.941, Global test loss: 0.950, Global test accuracy: 95.56
Round  88, Train loss: 0.908, Test loss: 0.967, Test accuracy: 93.94
Round  88, Global train loss: 0.908, Global test loss: 0.943, Global test accuracy: 96.28
Round  89, Train loss: 1.283, Test loss: 0.967, Test accuracy: 93.96
Round  89, Global train loss: 1.283, Global test loss: 0.970, Global test accuracy: 93.68
Round  90, Train loss: 0.912, Test loss: 0.968, Test accuracy: 93.88
Round  90, Global train loss: 0.912, Global test loss: 0.944, Global test accuracy: 96.14
Round  91, Train loss: 0.911, Test loss: 0.967, Test accuracy: 93.90
Round  91, Global train loss: 0.911, Global test loss: 0.944, Global test accuracy: 96.18
Round  92, Train loss: 0.942, Test loss: 0.966, Test accuracy: 94.02
Round  92, Global train loss: 0.942, Global test loss: 0.950, Global test accuracy: 95.68
Round  93, Train loss: 1.088, Test loss: 0.968, Test accuracy: 93.74
Round  93, Global train loss: 1.088, Global test loss: 0.961, Global test accuracy: 94.46
Round  94, Train loss: 1.276, Test loss: 0.970, Test accuracy: 93.48
Round  94, Global train loss: 1.276, Global test loss: 0.981, Global test accuracy: 92.66
Round  95, Train loss: 0.913, Test loss: 0.970, Test accuracy: 93.36
Round  95, Global train loss: 0.913, Global test loss: 0.944, Global test accuracy: 96.14/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 0.911, Test loss: 0.970, Test accuracy: 93.48
Round  96, Global train loss: 0.911, Global test loss: 0.943, Global test accuracy: 96.24
Round  97, Train loss: 0.907, Test loss: 0.970, Test accuracy: 93.46
Round  97, Global train loss: 0.907, Global test loss: 0.942, Global test accuracy: 96.24
Round  98, Train loss: 0.940, Test loss: 0.970, Test accuracy: 93.54
Round  98, Global train loss: 0.940, Global test loss: 0.948, Global test accuracy: 96.00
Round  99, Train loss: 0.940, Test loss: 0.970, Test accuracy: 93.48
Round  99, Global train loss: 0.940, Global test loss: 0.947, Global test accuracy: 95.92
Final Round, Train loss: 1.028, Test loss: 0.970, Test accuracy: 93.52
Final Round, Global train loss: 1.028, Global test loss: 0.947, Global test accuracy: 95.92
Average accuracy final 10 rounds: 93.634 

Average global accuracy final 10 rounds: 95.56599999999999 

789.0884952545166
[1.107579231262207, 2.215158462524414, 3.304001569747925, 4.3928446769714355, 5.424504518508911, 6.456164360046387, 7.4358227252960205, 8.415481090545654, 9.38490104675293, 10.354321002960205, 11.300500392913818, 12.246679782867432, 13.238699197769165, 14.230718612670898, 15.256308794021606, 16.281898975372314, 17.297694206237793, 18.31348943710327, 19.42639136314392, 20.53929328918457, 21.570467948913574, 22.601642608642578, 23.63203763961792, 24.66243267059326, 25.653581142425537, 26.644729614257812, 27.658426761627197, 28.672123908996582, 29.666024923324585, 30.659925937652588, 31.669116258621216, 32.678306579589844, 33.695488929748535, 34.71267127990723, 35.79778861999512, 36.88290596008301, 38.017178535461426, 39.151451110839844, 40.10539698600769, 41.05934286117554, 42.175352334976196, 43.291361808776855, 44.3007926940918, 45.31022357940674, 46.537869691848755, 47.76551580429077, 48.76793932914734, 49.770362854003906, 50.75354528427124, 51.736727714538574, 53.019402503967285, 54.302077293395996, 55.30663251876831, 56.311187744140625, 57.38277506828308, 58.45436239242554, 59.60181021690369, 60.749258041381836, 61.804184675216675, 62.859111309051514, 63.83920407295227, 64.81929683685303, 65.78120255470276, 66.74310827255249, 67.85624027252197, 68.96937227249146, 70.07367324829102, 71.17797422409058, 72.465580701828, 73.75318717956543, 74.78023886680603, 75.80729055404663, 76.83083486557007, 77.8543791770935, 78.88014364242554, 79.90590810775757, 80.97606492042542, 82.04622173309326, 83.10565114021301, 84.16508054733276, 85.28018498420715, 86.39528942108154, 87.47128534317017, 88.54728126525879, 89.59773683547974, 90.64819240570068, 92.20263385772705, 93.75707530975342, 94.88195204734802, 96.00682878494263, 97.05508685112, 98.10334491729736, 99.13257360458374, 100.16180229187012, 101.23644828796387, 102.31109428405762, 103.37304902076721, 104.4350037574768, 105.61443781852722, 106.79387187957764, 107.80423665046692, 108.8146014213562, 109.88590264320374, 110.95720386505127, 112.01004695892334, 113.06289005279541, 114.14200329780579, 115.22111654281616, 116.20027732849121, 117.17943811416626, 118.23511481285095, 119.29079151153564, 120.34348797798157, 121.39618444442749, 122.3119490146637, 123.2277135848999, 124.26195549964905, 125.2961974143982, 126.36525297164917, 127.43430852890015, 128.6011664867401, 129.76802444458008, 130.70595860481262, 131.64389276504517, 132.68759417533875, 133.73129558563232, 134.82688975334167, 135.92248392105103, 136.96537375450134, 138.00826358795166, 139.13007426261902, 140.25188493728638, 141.30217051506042, 142.35245609283447, 143.5758707523346, 144.79928541183472, 145.91534399986267, 147.03140258789062, 148.13174605369568, 149.23208951950073, 150.34602284431458, 151.45995616912842, 152.583477973938, 153.70699977874756, 154.63744449615479, 155.567889213562, 156.61225771903992, 157.65662622451782, 158.74103212356567, 159.82543802261353, 160.89566493034363, 161.96589183807373, 162.93359470367432, 163.9012975692749, 165.10610008239746, 166.31090259552002, 167.39796781539917, 168.48503303527832, 169.8093400001526, 171.13364696502686, 172.1842918395996, 173.23493671417236, 174.4623703956604, 175.68980407714844, 176.8327968120575, 177.97578954696655, 179.12500309944153, 180.2742166519165, 181.35402941703796, 182.43384218215942, 183.4700744152069, 184.5063066482544, 185.59982323646545, 186.6933398246765, 187.78200244903564, 188.87066507339478, 189.92186737060547, 190.97306966781616, 191.92344117164612, 192.87381267547607, 193.8319616317749, 194.79011058807373, 195.89018201828003, 196.99025344848633, 198.01253819465637, 199.03482294082642, 200.12696862220764, 201.21911430358887, 202.36266350746155, 203.50621271133423, 204.52926397323608, 205.55231523513794, 206.55067992210388, 207.54904460906982, 208.59049582481384, 209.63194704055786, 210.58168053627014, 211.53141403198242, 212.71406841278076, 213.8967227935791, 216.03842878341675, 218.1801347732544]
[78.14, 78.14, 85.94, 85.94, 87.96, 87.96, 88.88, 88.88, 92.18, 92.18, 92.14, 92.14, 94.92, 94.92, 94.88, 94.88, 94.9, 94.9, 94.98, 94.98, 95.02, 95.02, 95.22, 95.22, 94.96, 94.96, 94.82, 94.82, 94.96, 94.96, 94.7, 94.7, 94.6, 94.6, 94.18, 94.18, 95.1, 95.1, 95.26, 95.26, 94.92, 94.92, 94.8, 94.8, 95.24, 95.24, 95.28, 95.28, 95.3, 95.3, 95.34, 95.34, 95.38, 95.38, 95.32, 95.32, 95.38, 95.38, 95.3, 95.3, 95.26, 95.26, 95.24, 95.24, 95.2, 95.2, 95.4, 95.4, 94.12, 94.12, 94.7, 94.7, 94.46, 94.46, 94.5, 94.5, 94.2, 94.2, 94.14, 94.14, 94.08, 94.08, 94.18, 94.18, 94.18, 94.18, 94.08, 94.08, 94.04, 94.04, 93.56, 93.56, 93.6, 93.6, 93.5, 93.5, 93.52, 93.52, 93.52, 93.52, 93.54, 93.54, 93.56, 93.56, 93.58, 93.58, 93.88, 93.88, 93.88, 93.88, 93.68, 93.68, 93.8, 93.8, 93.7, 93.7, 93.72, 93.72, 93.84, 93.84, 93.88, 93.88, 93.98, 93.98, 93.94, 93.94, 93.86, 93.86, 93.92, 93.92, 93.76, 93.76, 93.74, 93.74, 93.82, 93.82, 93.9, 93.9, 93.96, 93.96, 93.96, 93.96, 94.02, 94.02, 94.04, 94.04, 93.5, 93.5, 93.62, 93.62, 93.62, 93.62, 93.8, 93.8, 93.64, 93.64, 93.7, 93.7, 93.7, 93.7, 94.02, 94.02, 94.02, 94.02, 94.02, 94.02, 94.1, 94.1, 93.76, 93.76, 93.62, 93.62, 94.08, 94.08, 93.94, 93.94, 93.94, 93.94, 93.96, 93.96, 93.88, 93.88, 93.9, 93.9, 94.02, 94.02, 93.74, 93.74, 93.48, 93.48, 93.36, 93.36, 93.48, 93.48, 93.46, 93.46, 93.54, 93.54, 93.48, 93.48, 93.52, 93.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.574, Test loss: 1.504, Test accuracy: 54.24
Round   0, Global train loss: 1.574, Global test loss: 1.505, Global test accuracy: 53.78
Round   1, Train loss: 1.458, Test loss: 1.358, Test accuracy: 74.12
Round   1, Global train loss: 1.458, Global test loss: 1.296, Global test accuracy: 90.26
Round   2, Train loss: 1.243, Test loss: 1.233, Test accuracy: 77.82
Round   2, Global train loss: 1.243, Global test loss: 1.063, Global test accuracy: 93.96
Round   3, Train loss: 1.255, Test loss: 1.160, Test accuracy: 83.02
Round   3, Global train loss: 1.255, Global test loss: 1.015, Global test accuracy: 94.50
Round   4, Train loss: 1.038, Test loss: 1.089, Test accuracy: 87.60
Round   4, Global train loss: 1.038, Global test loss: 0.980, Global test accuracy: 94.94
Round   5, Train loss: 1.229, Test loss: 1.064, Test accuracy: 89.36
Round   5, Global train loss: 1.229, Global test loss: 0.974, Global test accuracy: 95.12
Round   6, Train loss: 1.354, Test loss: 0.998, Test accuracy: 92.84
Round   6, Global train loss: 1.354, Global test loss: 0.985, Global test accuracy: 94.22
Round   7, Train loss: 1.154, Test loss: 0.986, Test accuracy: 93.56
Round   7, Global train loss: 1.154, Global test loss: 0.963, Global test accuracy: 95.32
Round   8, Train loss: 1.214, Test loss: 0.988, Test accuracy: 93.16
Round   8, Global train loss: 1.214, Global test loss: 0.969, Global test accuracy: 95.34
Round   9, Train loss: 1.008, Test loss: 0.983, Test accuracy: 93.46
Round   9, Global train loss: 1.008, Global test loss: 0.958, Global test accuracy: 95.70
Round  10, Train loss: 0.942, Test loss: 0.979, Test accuracy: 93.74
Round  10, Global train loss: 0.942, Global test loss: 0.951, Global test accuracy: 96.18
Round  11, Train loss: 1.207, Test loss: 0.975, Test accuracy: 94.06
Round  11, Global train loss: 1.207, Global test loss: 0.959, Global test accuracy: 95.66
Round  12, Train loss: 0.937, Test loss: 0.973, Test accuracy: 94.18
Round  12, Global train loss: 0.937, Global test loss: 0.950, Global test accuracy: 95.86
Round  13, Train loss: 0.928, Test loss: 0.972, Test accuracy: 94.20
Round  13, Global train loss: 0.928, Global test loss: 0.947, Global test accuracy: 96.10
Round  14, Train loss: 0.941, Test loss: 0.971, Test accuracy: 94.24
Round  14, Global train loss: 0.941, Global test loss: 0.947, Global test accuracy: 95.98
Round  15, Train loss: 0.925, Test loss: 0.970, Test accuracy: 94.22
Round  15, Global train loss: 0.925, Global test loss: 0.945, Global test accuracy: 96.10
Round  16, Train loss: 1.138, Test loss: 0.961, Test accuracy: 95.04
Round  16, Global train loss: 1.138, Global test loss: 0.946, Global test accuracy: 96.44
Round  17, Train loss: 1.344, Test loss: 0.962, Test accuracy: 94.78
Round  17, Global train loss: 1.344, Global test loss: 0.955, Global test accuracy: 95.42
Round  18, Train loss: 0.999, Test loss: 0.964, Test accuracy: 94.48
Round  18, Global train loss: 0.999, Global test loss: 0.946, Global test accuracy: 96.30
Round  19, Train loss: 0.929, Test loss: 0.962, Test accuracy: 94.58
Round  19, Global train loss: 0.929, Global test loss: 0.942, Global test accuracy: 96.56
Round  20, Train loss: 0.921, Test loss: 0.961, Test accuracy: 94.58
Round  20, Global train loss: 0.921, Global test loss: 0.943, Global test accuracy: 96.40
Round  21, Train loss: 0.916, Test loss: 0.961, Test accuracy: 94.60
Round  21, Global train loss: 0.916, Global test loss: 0.942, Global test accuracy: 96.62
Round  22, Train loss: 1.127, Test loss: 0.956, Test accuracy: 95.06
Round  22, Global train loss: 1.127, Global test loss: 0.942, Global test accuracy: 96.38
Round  23, Train loss: 0.991, Test loss: 0.952, Test accuracy: 95.68
Round  23, Global train loss: 0.991, Global test loss: 0.942, Global test accuracy: 96.40
Round  24, Train loss: 1.128, Test loss: 0.961, Test accuracy: 94.82
Round  24, Global train loss: 1.128, Global test loss: 0.944, Global test accuracy: 96.26
Round  25, Train loss: 1.129, Test loss: 0.962, Test accuracy: 94.78
Round  25, Global train loss: 1.129, Global test loss: 0.946, Global test accuracy: 96.30
Round  26, Train loss: 0.918, Test loss: 0.962, Test accuracy: 94.74
Round  26, Global train loss: 0.918, Global test loss: 0.943, Global test accuracy: 96.46
Round  27, Train loss: 1.121, Test loss: 0.962, Test accuracy: 94.86
Round  27, Global train loss: 1.121, Global test loss: 0.946, Global test accuracy: 96.06
Round  28, Train loss: 0.916, Test loss: 0.963, Test accuracy: 94.82
Round  28, Global train loss: 0.916, Global test loss: 0.943, Global test accuracy: 96.46
Round  29, Train loss: 0.926, Test loss: 0.962, Test accuracy: 94.88
Round  29, Global train loss: 0.926, Global test loss: 0.941, Global test accuracy: 96.68
Round  30, Train loss: 0.992, Test loss: 0.961, Test accuracy: 94.92
Round  30, Global train loss: 0.992, Global test loss: 0.942, Global test accuracy: 96.62
Round  31, Train loss: 1.127, Test loss: 0.961, Test accuracy: 94.98
Round  31, Global train loss: 1.127, Global test loss: 0.944, Global test accuracy: 96.44
Round  32, Train loss: 1.127, Test loss: 0.962, Test accuracy: 94.86
Round  32, Global train loss: 1.127, Global test loss: 0.946, Global test accuracy: 96.22
Round  33, Train loss: 0.923, Test loss: 0.962, Test accuracy: 94.80
Round  33, Global train loss: 0.923, Global test loss: 0.942, Global test accuracy: 96.62
Round  34, Train loss: 1.124, Test loss: 0.957, Test accuracy: 95.34
Round  34, Global train loss: 1.124, Global test loss: 0.943, Global test accuracy: 96.34
Round  35, Train loss: 1.128, Test loss: 0.959, Test accuracy: 95.10
Round  35, Global train loss: 1.128, Global test loss: 0.944, Global test accuracy: 96.24
Round  36, Train loss: 0.920, Test loss: 0.958, Test accuracy: 95.18
Round  36, Global train loss: 0.920, Global test loss: 0.941, Global test accuracy: 96.60
Round  37, Train loss: 1.121, Test loss: 0.966, Test accuracy: 94.42
Round  37, Global train loss: 1.121, Global test loss: 0.945, Global test accuracy: 96.22
Round  38, Train loss: 1.322, Test loss: 0.959, Test accuracy: 94.96
Round  38, Global train loss: 1.322, Global test loss: 0.958, Global test accuracy: 95.24
Round  39, Train loss: 1.123, Test loss: 0.971, Test accuracy: 93.72
Round  39, Global train loss: 1.123, Global test loss: 0.949, Global test accuracy: 96.24
Round  40, Train loss: 0.914, Test loss: 0.971, Test accuracy: 93.78
Round  40, Global train loss: 0.914, Global test loss: 0.943, Global test accuracy: 96.40
Round  41, Train loss: 1.322, Test loss: 0.963, Test accuracy: 94.50
Round  41, Global train loss: 1.322, Global test loss: 0.965, Global test accuracy: 94.70
Round  42, Train loss: 1.314, Test loss: 0.966, Test accuracy: 94.32
Round  42, Global train loss: 1.314, Global test loss: 0.967, Global test accuracy: 94.52
Round  43, Train loss: 1.177, Test loss: 0.968, Test accuracy: 93.94
Round  43, Global train loss: 1.177, Global test loss: 0.970, Global test accuracy: 93.98
Round  44, Train loss: 0.919, Test loss: 0.968, Test accuracy: 94.00
Round  44, Global train loss: 0.919, Global test loss: 0.941, Global test accuracy: 96.74
Round  45, Train loss: 0.916, Test loss: 0.968, Test accuracy: 94.04
Round  45, Global train loss: 0.916, Global test loss: 0.940, Global test accuracy: 96.76
Round  46, Train loss: 1.110, Test loss: 0.973, Test accuracy: 93.40
Round  46, Global train loss: 1.110, Global test loss: 0.947, Global test accuracy: 96.24
Round  47, Train loss: 1.106, Test loss: 0.965, Test accuracy: 94.26
Round  47, Global train loss: 1.106, Global test loss: 0.945, Global test accuracy: 96.42
Round  48, Train loss: 1.165, Test loss: 0.966, Test accuracy: 94.26
Round  48, Global train loss: 1.165, Global test loss: 0.957, Global test accuracy: 95.14
Round  49, Train loss: 1.104, Test loss: 0.967, Test accuracy: 93.94
Round  49, Global train loss: 1.104, Global test loss: 0.948, Global test accuracy: 96.18
Round  50, Train loss: 1.103, Test loss: 0.964, Test accuracy: 94.32
Round  50, Global train loss: 1.103, Global test loss: 0.947, Global test accuracy: 96.24
Round  51, Train loss: 0.979, Test loss: 0.966, Test accuracy: 94.14
Round  51, Global train loss: 0.979, Global test loss: 0.942, Global test accuracy: 96.56
Round  52, Train loss: 0.911, Test loss: 0.966, Test accuracy: 94.06
Round  52, Global train loss: 0.911, Global test loss: 0.940, Global test accuracy: 96.54
Round  53, Train loss: 0.981, Test loss: 0.966, Test accuracy: 94.06
Round  53, Global train loss: 0.981, Global test loss: 0.941, Global test accuracy: 96.76
Round  54, Train loss: 0.922, Test loss: 0.965, Test accuracy: 94.12
Round  54, Global train loss: 0.922, Global test loss: 0.938, Global test accuracy: 96.76
Round  55, Train loss: 0.919, Test loss: 0.966, Test accuracy: 94.00
Round  55, Global train loss: 0.919, Global test loss: 0.940, Global test accuracy: 96.60
Round  56, Train loss: 0.982, Test loss: 0.965, Test accuracy: 94.10
Round  56, Global train loss: 0.982, Global test loss: 0.940, Global test accuracy: 96.62
Round  57, Train loss: 0.914, Test loss: 0.964, Test accuracy: 94.20
Round  57, Global train loss: 0.914, Global test loss: 0.937, Global test accuracy: 96.86
Round  58, Train loss: 1.108, Test loss: 0.965, Test accuracy: 94.12
Round  58, Global train loss: 1.108, Global test loss: 0.942, Global test accuracy: 96.44
Round  59, Train loss: 0.981, Test loss: 0.963, Test accuracy: 94.34
Round  59, Global train loss: 0.981, Global test loss: 0.940, Global test accuracy: 96.74
Round  60, Train loss: 1.301, Test loss: 0.962, Test accuracy: 94.56
Round  60, Global train loss: 1.301, Global test loss: 0.961, Global test accuracy: 94.64
Round  61, Train loss: 0.979, Test loss: 0.964, Test accuracy: 94.38
Round  61, Global train loss: 0.979, Global test loss: 0.939, Global test accuracy: 96.86
Round  62, Train loss: 0.918, Test loss: 0.964, Test accuracy: 94.36
Round  62, Global train loss: 0.918, Global test loss: 0.937, Global test accuracy: 97.04
Round  63, Train loss: 1.102, Test loss: 0.965, Test accuracy: 94.30
Round  63, Global train loss: 1.102, Global test loss: 0.942, Global test accuracy: 96.64
Round  64, Train loss: 1.113, Test loss: 0.970, Test accuracy: 93.70
Round  64, Global train loss: 1.113, Global test loss: 0.942, Global test accuracy: 96.72
Round  65, Train loss: 1.100, Test loss: 0.970, Test accuracy: 93.74
Round  65, Global train loss: 1.100, Global test loss: 0.946, Global test accuracy: 96.22
Round  66, Train loss: 1.095, Test loss: 0.970, Test accuracy: 93.70
Round  66, Global train loss: 1.095, Global test loss: 0.943, Global test accuracy: 96.56
Round  67, Train loss: 1.177, Test loss: 0.969, Test accuracy: 93.62
Round  67, Global train loss: 1.177, Global test loss: 0.962, Global test accuracy: 94.44
Round  68, Train loss: 1.098, Test loss: 0.968, Test accuracy: 93.62
Round  68, Global train loss: 1.098, Global test loss: 0.944, Global test accuracy: 96.40
Round  69, Train loss: 0.975, Test loss: 0.969, Test accuracy: 93.64
Round  69, Global train loss: 0.975, Global test loss: 0.939, Global test accuracy: 96.94
Round  70, Train loss: 0.976, Test loss: 0.969, Test accuracy: 93.60
Round  70, Global train loss: 0.976, Global test loss: 0.940, Global test accuracy: 96.62
Round  71, Train loss: 1.115, Test loss: 0.973, Test accuracy: 93.16
Round  71, Global train loss: 1.115, Global test loss: 0.945, Global test accuracy: 96.28
Round  72, Train loss: 0.976, Test loss: 0.971, Test accuracy: 93.42
Round  72, Global train loss: 0.976, Global test loss: 0.939, Global test accuracy: 96.92
Round  73, Train loss: 0.916, Test loss: 0.971, Test accuracy: 93.52
Round  73, Global train loss: 0.916, Global test loss: 0.937, Global test accuracy: 97.14
Round  74, Train loss: 1.177, Test loss: 0.973, Test accuracy: 93.16
Round  74, Global train loss: 1.177, Global test loss: 0.960, Global test accuracy: 94.68
Round  75, Train loss: 1.114, Test loss: 0.963, Test accuracy: 94.24
Round  75, Global train loss: 1.114, Global test loss: 0.943, Global test accuracy: 96.30
Round  76, Train loss: 0.911, Test loss: 0.963, Test accuracy: 94.28
Round  76, Global train loss: 0.911, Global test loss: 0.937, Global test accuracy: 97.08
Round  77, Train loss: 1.099, Test loss: 0.962, Test accuracy: 94.30
Round  77, Global train loss: 1.099, Global test loss: 0.943, Global test accuracy: 96.54
Round  78, Train loss: 1.158, Test loss: 0.963, Test accuracy: 94.30
Round  78, Global train loss: 1.158, Global test loss: 0.960, Global test accuracy: 94.76
Round  79, Train loss: 1.110, Test loss: 0.967, Test accuracy: 93.88
Round  79, Global train loss: 1.110, Global test loss: 0.946, Global test accuracy: 96.46
Round  80, Train loss: 0.978, Test loss: 0.968, Test accuracy: 93.78
Round  80, Global train loss: 0.978, Global test loss: 0.939, Global test accuracy: 96.96
Round  81, Train loss: 1.295, Test loss: 0.966, Test accuracy: 94.00
Round  81, Global train loss: 1.295, Global test loss: 0.969, Global test accuracy: 93.72
Round  82, Train loss: 0.978, Test loss: 0.966, Test accuracy: 94.08
Round  82, Global train loss: 0.978, Global test loss: 0.941, Global test accuracy: 96.76
Round  83, Train loss: 1.109, Test loss: 0.966, Test accuracy: 94.02
Round  83, Global train loss: 1.109, Global test loss: 0.942, Global test accuracy: 96.60
Round  84, Train loss: 1.109, Test loss: 0.968, Test accuracy: 93.76
Round  84, Global train loss: 1.109, Global test loss: 0.942, Global test accuracy: 96.48
Round  85, Train loss: 0.976, Test loss: 0.968, Test accuracy: 93.72
Round  85, Global train loss: 0.976, Global test loss: 0.942, Global test accuracy: 96.62
Round  86, Train loss: 0.918, Test loss: 0.968, Test accuracy: 93.72
Round  86, Global train loss: 0.918, Global test loss: 0.936, Global test accuracy: 97.16
Round  87, Train loss: 1.107, Test loss: 0.966, Test accuracy: 93.92
Round  87, Global train loss: 1.107, Global test loss: 0.938, Global test accuracy: 96.76
Round  88, Train loss: 1.289, Test loss: 0.974, Test accuracy: 93.24
Round  88, Global train loss: 1.289, Global test loss: 0.981, Global test accuracy: 92.42
Round  89, Train loss: 0.919, Test loss: 0.974, Test accuracy: 93.28
Round  89, Global train loss: 0.919, Global test loss: 0.936, Global test accuracy: 96.98
Round  90, Train loss: 0.972, Test loss: 0.974, Test accuracy: 93.18
Round  90, Global train loss: 0.972, Global test loss: 0.937, Global test accuracy: 97.06
Round  91, Train loss: 0.971, Test loss: 0.973, Test accuracy: 93.32
Round  91, Global train loss: 0.971, Global test loss: 0.938, Global test accuracy: 97.02
Round  92, Train loss: 0.913, Test loss: 0.973, Test accuracy: 93.32
Round  92, Global train loss: 0.913, Global test loss: 0.936, Global test accuracy: 97.04
Round  93, Train loss: 1.096, Test loss: 0.974, Test accuracy: 93.20
Round  93, Global train loss: 1.096, Global test loss: 0.941, Global test accuracy: 96.74
Round  94, Train loss: 0.977, Test loss: 0.975, Test accuracy: 93.10
Round  94, Global train loss: 0.977, Global test loss: 0.940, Global test accuracy: 96.84
Round  95, Train loss: 1.169, Test loss: 0.967, Test accuracy: 93.82
Round  95, Global train loss: 1.169, Global test loss: 0.956, Global test accuracy: 95.12/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 1.166, Test loss: 0.969, Test accuracy: 93.66
Round  96, Global train loss: 1.166, Global test loss: 0.960, Global test accuracy: 94.80
Round  97, Train loss: 1.284, Test loss: 0.973, Test accuracy: 93.32
Round  97, Global train loss: 1.284, Global test loss: 0.985, Global test accuracy: 92.04
Round  98, Train loss: 0.913, Test loss: 0.973, Test accuracy: 93.30
Round  98, Global train loss: 0.913, Global test loss: 0.937, Global test accuracy: 96.86
Round  99, Train loss: 1.093, Test loss: 0.973, Test accuracy: 93.30
Round  99, Global train loss: 1.093, Global test loss: 0.940, Global test accuracy: 96.76
Final Round, Train loss: 1.043, Test loss: 0.967, Test accuracy: 93.96
Final Round, Global train loss: 1.043, Global test loss: 0.940, Global test accuracy: 96.76
Average accuracy final 10 rounds: 93.35199999999998 

Average global accuracy final 10 rounds: 96.028 

831.8092777729034
[1.4036672115325928, 2.8073344230651855, 3.9654273986816406, 5.123520374298096, 6.274399042129517, 7.4252777099609375, 8.708764553070068, 9.9922513961792, 11.052555799484253, 12.112860202789307, 13.264194965362549, 14.415529727935791, 15.62035846710205, 16.82518720626831, 17.923370838165283, 19.021554470062256, 20.150951623916626, 21.280348777770996, 22.35072422027588, 23.42109966278076, 24.47214365005493, 25.5231876373291, 26.62927794456482, 27.735368251800537, 28.777151823043823, 29.81893539428711, 30.935710668563843, 32.052485942840576, 33.31015920639038, 34.567832469940186, 35.75299000740051, 36.93814754486084, 38.06266140937805, 39.187175273895264, 40.522353172302246, 41.85753107070923, 43.02762317657471, 44.197715282440186, 45.35097146034241, 46.50422763824463, 47.62303304672241, 48.741838455200195, 49.928595542907715, 51.115352630615234, 52.16637420654297, 53.2173957824707, 54.38020706176758, 55.54301834106445, 56.645694971084595, 57.748371601104736, 58.9544415473938, 60.16051149368286, 61.349419832229614, 62.53832817077637, 64.06049489974976, 65.58266162872314, 66.71432328224182, 67.8459849357605, 68.94936513900757, 70.05274534225464, 71.23352432250977, 72.41430330276489, 73.56472539901733, 74.71514749526978, 75.99835348129272, 77.28155946731567, 78.48804473876953, 79.69453001022339, 80.78612637519836, 81.87772274017334, 82.99914264678955, 84.12056255340576, 85.38003063201904, 86.63949871063232, 87.86955618858337, 89.09961366653442, 90.27906727790833, 91.45852088928223, 92.54041481018066, 93.6223087310791, 94.71036791801453, 95.79842710494995, 96.94524836540222, 98.09206962585449, 99.25517559051514, 100.41828155517578, 101.57932615280151, 102.74037075042725, 103.99447798728943, 105.24858522415161, 106.43933701515198, 107.63008880615234, 108.94552421569824, 110.26095962524414, 111.45766520500183, 112.65437078475952, 113.72891640663147, 114.80346202850342, 115.95646142959595, 117.10946083068848, 118.31848073005676, 119.52750062942505, 120.6548228263855, 121.78214502334595, 122.91764903068542, 124.0531530380249, 125.19388747215271, 126.33462190628052, 127.41052889823914, 128.48643589019775, 129.6672501564026, 130.84806442260742, 131.9326696395874, 133.01727485656738, 134.14195322990417, 135.26663160324097, 136.52728843688965, 137.78794527053833, 138.89139986038208, 139.99485445022583, 141.28894591331482, 142.5830373764038, 143.64730286598206, 144.7115683555603, 145.8416075706482, 146.97164678573608, 148.13093972206116, 149.29023265838623, 150.49621534347534, 151.70219802856445, 152.78827023506165, 153.87434244155884, 155.09524273872375, 156.31614303588867, 157.40358328819275, 158.49102354049683, 159.5801408290863, 160.66925811767578, 161.92178225517273, 163.17430639266968, 164.27861738204956, 165.38292837142944, 166.61493301391602, 167.8469376564026, 169.06280303001404, 170.2786684036255, 171.5636031627655, 172.84853792190552, 174.00536179542542, 175.1621856689453, 176.33331060409546, 177.5044355392456, 178.67047691345215, 179.8365182876587, 180.97096395492554, 182.10540962219238, 183.45427250862122, 184.80313539505005, 185.93215990066528, 187.06118440628052, 188.27328944206238, 189.48539447784424, 191.0618498325348, 192.63830518722534, 193.80331993103027, 194.9683346748352, 196.100355386734, 197.2323760986328, 198.41171193122864, 199.59104776382446, 200.79938077926636, 202.00771379470825, 203.22277665138245, 204.43783950805664, 205.63022327423096, 206.82260704040527, 208.08840155601501, 209.35419607162476, 210.5015754699707, 211.64895486831665, 212.77540397644043, 213.9018530845642, 215.0827443599701, 216.26363563537598, 217.49028325080872, 218.71693086624146, 219.81577348709106, 220.91461610794067, 222.1811444759369, 223.4476728439331, 224.90583848953247, 226.36400413513184, 227.48439526557922, 228.6047863960266, 229.69322872161865, 230.7816710472107, 231.96966910362244, 233.15766716003418, 234.31944227218628, 235.48121738433838, 237.83724641799927, 240.19327545166016]
[54.24, 54.24, 74.12, 74.12, 77.82, 77.82, 83.02, 83.02, 87.6, 87.6, 89.36, 89.36, 92.84, 92.84, 93.56, 93.56, 93.16, 93.16, 93.46, 93.46, 93.74, 93.74, 94.06, 94.06, 94.18, 94.18, 94.2, 94.2, 94.24, 94.24, 94.22, 94.22, 95.04, 95.04, 94.78, 94.78, 94.48, 94.48, 94.58, 94.58, 94.58, 94.58, 94.6, 94.6, 95.06, 95.06, 95.68, 95.68, 94.82, 94.82, 94.78, 94.78, 94.74, 94.74, 94.86, 94.86, 94.82, 94.82, 94.88, 94.88, 94.92, 94.92, 94.98, 94.98, 94.86, 94.86, 94.8, 94.8, 95.34, 95.34, 95.1, 95.1, 95.18, 95.18, 94.42, 94.42, 94.96, 94.96, 93.72, 93.72, 93.78, 93.78, 94.5, 94.5, 94.32, 94.32, 93.94, 93.94, 94.0, 94.0, 94.04, 94.04, 93.4, 93.4, 94.26, 94.26, 94.26, 94.26, 93.94, 93.94, 94.32, 94.32, 94.14, 94.14, 94.06, 94.06, 94.06, 94.06, 94.12, 94.12, 94.0, 94.0, 94.1, 94.1, 94.2, 94.2, 94.12, 94.12, 94.34, 94.34, 94.56, 94.56, 94.38, 94.38, 94.36, 94.36, 94.3, 94.3, 93.7, 93.7, 93.74, 93.74, 93.7, 93.7, 93.62, 93.62, 93.62, 93.62, 93.64, 93.64, 93.6, 93.6, 93.16, 93.16, 93.42, 93.42, 93.52, 93.52, 93.16, 93.16, 94.24, 94.24, 94.28, 94.28, 94.3, 94.3, 94.3, 94.3, 93.88, 93.88, 93.78, 93.78, 94.0, 94.0, 94.08, 94.08, 94.02, 94.02, 93.76, 93.76, 93.72, 93.72, 93.72, 93.72, 93.92, 93.92, 93.24, 93.24, 93.28, 93.28, 93.18, 93.18, 93.32, 93.32, 93.32, 93.32, 93.2, 93.2, 93.1, 93.1, 93.82, 93.82, 93.66, 93.66, 93.32, 93.32, 93.3, 93.3, 93.3, 93.3, 93.96, 93.96]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.622, Test loss: 1.587, Test accuracy: 30.18
Round   0, Global train loss: 1.622, Global test loss: 1.587, Global test accuracy: 30.22
Round   1, Train loss: 1.578, Test loss: 1.529, Test accuracy: 70.34
Round   1, Global train loss: 1.578, Global test loss: 1.528, Global test accuracy: 70.46
Round   2, Train loss: 1.448, Test loss: 1.294, Test accuracy: 85.74
Round   2, Global train loss: 1.448, Global test loss: 1.274, Global test accuracy: 85.52
Round   3, Train loss: 1.174, Test loss: 1.087, Test accuracy: 93.94
Round   3, Global train loss: 1.174, Global test loss: 1.047, Global test accuracy: 94.30
Round   4, Train loss: 1.225, Test loss: 1.056, Test accuracy: 94.66
Round   4, Global train loss: 1.225, Global test loss: 1.040, Global test accuracy: 95.06
Round   5, Train loss: 1.013, Test loss: 1.015, Test accuracy: 95.48
Round   5, Global train loss: 1.013, Global test loss: 0.987, Global test accuracy: 95.74
Round   6, Train loss: 0.995, Test loss: 0.989, Test accuracy: 95.80
Round   6, Global train loss: 0.995, Global test loss: 0.981, Global test accuracy: 96.10
Round   7, Train loss: 0.985, Test loss: 0.979, Test accuracy: 96.10
Round   7, Global train loss: 0.985, Global test loss: 0.972, Global test accuracy: 96.40
Round   8, Train loss: 1.181, Test loss: 0.988, Test accuracy: 96.08
Round   8, Global train loss: 1.181, Global test loss: 0.984, Global test accuracy: 96.26
Round   9, Train loss: 1.183, Test loss: 0.997, Test accuracy: 96.20
Round   9, Global train loss: 1.183, Global test loss: 0.991, Global test accuracy: 96.24
Round  10, Train loss: 0.991, Test loss: 0.979, Test accuracy: 96.62
Round  10, Global train loss: 0.991, Global test loss: 0.969, Global test accuracy: 96.60
Round  11, Train loss: 0.954, Test loss: 0.970, Test accuracy: 96.54
Round  11, Global train loss: 0.954, Global test loss: 0.959, Global test accuracy: 96.68
Round  12, Train loss: 0.964, Test loss: 0.966, Test accuracy: 96.60
Round  12, Global train loss: 0.964, Global test loss: 0.956, Global test accuracy: 96.64
Round  13, Train loss: 1.179, Test loss: 0.974, Test accuracy: 96.58
Round  13, Global train loss: 1.179, Global test loss: 0.977, Global test accuracy: 96.64
Round  14, Train loss: 1.179, Test loss: 0.988, Test accuracy: 96.78
Round  14, Global train loss: 1.179, Global test loss: 0.971, Global test accuracy: 96.80
Round  15, Train loss: 0.960, Test loss: 0.974, Test accuracy: 96.68
Round  15, Global train loss: 0.960, Global test loss: 0.958, Global test accuracy: 96.78
Round  16, Train loss: 0.951, Test loss: 0.967, Test accuracy: 96.80
Round  16, Global train loss: 0.951, Global test loss: 0.952, Global test accuracy: 97.22
Round  17, Train loss: 0.940, Test loss: 0.962, Test accuracy: 96.88
Round  17, Global train loss: 0.940, Global test loss: 0.949, Global test accuracy: 97.08
Round  18, Train loss: 1.171, Test loss: 0.967, Test accuracy: 97.02
Round  18, Global train loss: 1.171, Global test loss: 0.967, Global test accuracy: 97.02
Round  19, Train loss: 1.166, Test loss: 0.980, Test accuracy: 97.04
Round  19, Global train loss: 1.166, Global test loss: 0.967, Global test accuracy: 97.22
Round  20, Train loss: 0.945, Test loss: 0.972, Test accuracy: 97.14
Round  20, Global train loss: 0.945, Global test loss: 0.951, Global test accuracy: 97.28
Round  21, Train loss: 1.152, Test loss: 0.977, Test accuracy: 97.08
Round  21, Global train loss: 1.152, Global test loss: 0.969, Global test accuracy: 97.24
Round  22, Train loss: 0.935, Test loss: 0.970, Test accuracy: 96.96
Round  22, Global train loss: 0.935, Global test loss: 0.949, Global test accuracy: 97.16
Round  23, Train loss: 0.937, Test loss: 0.964, Test accuracy: 97.08
Round  23, Global train loss: 0.937, Global test loss: 0.945, Global test accuracy: 97.06
Round  24, Train loss: 0.935, Test loss: 0.961, Test accuracy: 97.06
Round  24, Global train loss: 0.935, Global test loss: 0.946, Global test accuracy: 97.20
Round  25, Train loss: 1.160, Test loss: 0.973, Test accuracy: 97.06
Round  25, Global train loss: 1.160, Global test loss: 0.957, Global test accuracy: 97.36
Round  26, Train loss: 1.147, Test loss: 0.983, Test accuracy: 96.86
Round  26, Global train loss: 1.147, Global test loss: 0.969, Global test accuracy: 97.10
Round  27, Train loss: 0.934, Test loss: 0.975, Test accuracy: 97.04
Round  27, Global train loss: 0.934, Global test loss: 0.946, Global test accuracy: 97.30
Round  28, Train loss: 1.145, Test loss: 0.982, Test accuracy: 96.80
Round  28, Global train loss: 1.145, Global test loss: 0.964, Global test accuracy: 97.12
Round  29, Train loss: 0.944, Test loss: 0.974, Test accuracy: 96.96
Round  29, Global train loss: 0.944, Global test loss: 0.947, Global test accuracy: 97.30
Round  30, Train loss: 1.153, Test loss: 0.980, Test accuracy: 96.98
Round  30, Global train loss: 1.153, Global test loss: 0.957, Global test accuracy: 97.52
Round  31, Train loss: 0.929, Test loss: 0.973, Test accuracy: 97.12
Round  31, Global train loss: 0.929, Global test loss: 0.945, Global test accuracy: 97.32
Round  32, Train loss: 1.144, Test loss: 0.978, Test accuracy: 96.78
Round  32, Global train loss: 1.144, Global test loss: 0.964, Global test accuracy: 97.34
Round  33, Train loss: 0.937, Test loss: 0.972, Test accuracy: 97.06
Round  33, Global train loss: 0.937, Global test loss: 0.943, Global test accuracy: 97.64
Round  34, Train loss: 1.146, Test loss: 0.976, Test accuracy: 96.82
Round  34, Global train loss: 1.146, Global test loss: 0.963, Global test accuracy: 97.58
Round  35, Train loss: 1.141, Test loss: 0.981, Test accuracy: 96.70
Round  35, Global train loss: 1.141, Global test loss: 0.971, Global test accuracy: 97.52
Round  36, Train loss: 1.144, Test loss: 0.989, Test accuracy: 96.90
Round  36, Global train loss: 1.144, Global test loss: 0.960, Global test accuracy: 97.86
Round  37, Train loss: 0.933, Test loss: 0.975, Test accuracy: 97.10
Round  37, Global train loss: 0.933, Global test loss: 0.943, Global test accuracy: 97.60
Round  38, Train loss: 0.924, Test loss: 0.967, Test accuracy: 97.26
Round  38, Global train loss: 0.924, Global test loss: 0.941, Global test accuracy: 97.68
Round  39, Train loss: 1.138, Test loss: 0.974, Test accuracy: 96.90
Round  39, Global train loss: 1.138, Global test loss: 0.956, Global test accuracy: 97.52
Round  40, Train loss: 1.133, Test loss: 0.984, Test accuracy: 96.72
Round  40, Global train loss: 1.133, Global test loss: 0.961, Global test accuracy: 97.56
Round  41, Train loss: 0.927, Test loss: 0.974, Test accuracy: 97.00
Round  41, Global train loss: 0.927, Global test loss: 0.942, Global test accuracy: 97.62
Round  42, Train loss: 1.138, Test loss: 0.984, Test accuracy: 96.76
Round  42, Global train loss: 1.138, Global test loss: 0.955, Global test accuracy: 97.80
Round  43, Train loss: 1.139, Test loss: 0.993, Test accuracy: 96.18
Round  43, Global train loss: 1.139, Global test loss: 0.966, Global test accuracy: 97.54
Round  44, Train loss: 1.135, Test loss: 0.989, Test accuracy: 96.24
Round  44, Global train loss: 1.135, Global test loss: 0.964, Global test accuracy: 97.76
Round  45, Train loss: 1.133, Test loss: 0.988, Test accuracy: 96.20
Round  45, Global train loss: 1.133, Global test loss: 0.966, Global test accuracy: 97.82
Round  46, Train loss: 1.134, Test loss: 0.993, Test accuracy: 96.28
Round  46, Global train loss: 1.134, Global test loss: 0.966, Global test accuracy: 97.76
Round  47, Train loss: 0.926, Test loss: 0.979, Test accuracy: 96.90
Round  47, Global train loss: 0.926, Global test loss: 0.939, Global test accuracy: 97.82
Round  48, Train loss: 0.920, Test loss: 0.971, Test accuracy: 97.18
Round  48, Global train loss: 0.920, Global test loss: 0.936, Global test accuracy: 97.94
Round  49, Train loss: 1.133, Test loss: 0.983, Test accuracy: 96.62
Round  49, Global train loss: 1.133, Global test loss: 0.953, Global test accuracy: 97.78
Round  50, Train loss: 1.127, Test loss: 0.994, Test accuracy: 95.50
Round  50, Global train loss: 1.127, Global test loss: 0.963, Global test accuracy: 97.70
Round  51, Train loss: 1.131, Test loss: 0.989, Test accuracy: 95.92
Round  51, Global train loss: 1.131, Global test loss: 0.963, Global test accuracy: 97.90
Round  52, Train loss: 0.921, Test loss: 0.979, Test accuracy: 96.40
Round  52, Global train loss: 0.921, Global test loss: 0.939, Global test accuracy: 97.92
Round  53, Train loss: 0.923, Test loss: 0.971, Test accuracy: 96.80
Round  53, Global train loss: 0.923, Global test loss: 0.936, Global test accuracy: 98.04
Round  54, Train loss: 1.345, Test loss: 0.999, Test accuracy: 94.76
Round  54, Global train loss: 1.345, Global test loss: 1.014, Global test accuracy: 97.68
Round  55, Train loss: 1.130, Test loss: 0.996, Test accuracy: 94.70
Round  55, Global train loss: 1.130, Global test loss: 0.968, Global test accuracy: 98.02
Round  56, Train loss: 0.927, Test loss: 0.980, Test accuracy: 95.86
Round  56, Global train loss: 0.927, Global test loss: 0.939, Global test accuracy: 98.14
Round  57, Train loss: 0.918, Test loss: 0.974, Test accuracy: 96.32
Round  57, Global train loss: 0.918, Global test loss: 0.936, Global test accuracy: 98.02
Round  58, Train loss: 1.127, Test loss: 0.983, Test accuracy: 95.68
Round  58, Global train loss: 1.127, Global test loss: 0.950, Global test accuracy: 98.02
Round  59, Train loss: 1.124, Test loss: 0.992, Test accuracy: 95.50
Round  59, Global train loss: 1.124, Global test loss: 0.966, Global test accuracy: 97.88
Round  60, Train loss: 0.920, Test loss: 0.979, Test accuracy: 96.08
Round  60, Global train loss: 0.920, Global test loss: 0.939, Global test accuracy: 98.24
Round  61, Train loss: 0.917, Test loss: 0.973, Test accuracy: 96.52
Round  61, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 98.24
Round  62, Train loss: 1.332, Test loss: 1.004, Test accuracy: 93.60
Round  62, Global train loss: 1.332, Global test loss: 1.035, Global test accuracy: 96.62
Round  63, Train loss: 1.119, Test loss: 1.003, Test accuracy: 94.06
Round  63, Global train loss: 1.119, Global test loss: 0.967, Global test accuracy: 97.66
Round  64, Train loss: 0.924, Test loss: 0.981, Test accuracy: 95.48
Round  64, Global train loss: 0.924, Global test loss: 0.941, Global test accuracy: 97.88
Round  65, Train loss: 1.116, Test loss: 0.988, Test accuracy: 94.92
Round  65, Global train loss: 1.116, Global test loss: 0.955, Global test accuracy: 97.84
Round  66, Train loss: 0.915, Test loss: 0.981, Test accuracy: 95.32
Round  66, Global train loss: 0.915, Global test loss: 0.936, Global test accuracy: 97.98
Round  67, Train loss: 0.916, Test loss: 0.974, Test accuracy: 95.98
Round  67, Global train loss: 0.916, Global test loss: 0.936, Global test accuracy: 98.00
Round  68, Train loss: 1.114, Test loss: 0.984, Test accuracy: 95.00
Round  68, Global train loss: 1.114, Global test loss: 0.950, Global test accuracy: 97.92
Round  69, Train loss: 0.916, Test loss: 0.979, Test accuracy: 95.32
Round  69, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 97.90
Round  70, Train loss: 1.111, Test loss: 0.987, Test accuracy: 94.20
Round  70, Global train loss: 1.111, Global test loss: 0.951, Global test accuracy: 97.82
Round  71, Train loss: 1.119, Test loss: 0.996, Test accuracy: 93.70
Round  71, Global train loss: 1.119, Global test loss: 0.962, Global test accuracy: 97.62
Round  72, Train loss: 1.112, Test loss: 1.003, Test accuracy: 92.98
Round  72, Global train loss: 1.112, Global test loss: 0.969, Global test accuracy: 97.38
Round  73, Train loss: 1.110, Test loss: 1.004, Test accuracy: 93.26
Round  73, Global train loss: 1.110, Global test loss: 0.966, Global test accuracy: 97.34
Round  74, Train loss: 0.920, Test loss: 0.984, Test accuracy: 95.08
Round  74, Global train loss: 0.920, Global test loss: 0.940, Global test accuracy: 97.76
Round  75, Train loss: 1.302, Test loss: 1.015, Test accuracy: 92.08
Round  75, Global train loss: 1.302, Global test loss: 1.047, Global test accuracy: 95.58
Round  76, Train loss: 0.925, Test loss: 0.991, Test accuracy: 94.24
Round  76, Global train loss: 0.925, Global test loss: 0.943, Global test accuracy: 97.76
Round  77, Train loss: 1.103, Test loss: 0.992, Test accuracy: 94.02
Round  77, Global train loss: 1.103, Global test loss: 0.958, Global test accuracy: 97.50
Round  78, Train loss: 1.098, Test loss: 0.998, Test accuracy: 93.44
Round  78, Global train loss: 1.098, Global test loss: 0.962, Global test accuracy: 97.68
Round  79, Train loss: 1.104, Test loss: 1.005, Test accuracy: 92.90
Round  79, Global train loss: 1.104, Global test loss: 0.970, Global test accuracy: 96.98
Round  80, Train loss: 0.922, Test loss: 0.983, Test accuracy: 94.48
Round  80, Global train loss: 0.922, Global test loss: 0.940, Global test accuracy: 97.82
Round  81, Train loss: 1.097, Test loss: 0.991, Test accuracy: 93.76
Round  81, Global train loss: 1.097, Global test loss: 0.956, Global test accuracy: 97.62
Round  82, Train loss: 1.276, Test loss: 1.045, Test accuracy: 89.74
Round  82, Global train loss: 1.276, Global test loss: 1.073, Global test accuracy: 93.08
Round  83, Train loss: 1.095, Test loss: 1.011, Test accuracy: 92.12
Round  83, Global train loss: 1.095, Global test loss: 0.975, Global test accuracy: 96.82
Round  84, Train loss: 0.921, Test loss: 0.983, Test accuracy: 94.18
Round  84, Global train loss: 0.921, Global test loss: 0.942, Global test accuracy: 97.54
Round  85, Train loss: 1.087, Test loss: 0.996, Test accuracy: 93.24
Round  85, Global train loss: 1.087, Global test loss: 0.963, Global test accuracy: 96.92
Round  86, Train loss: 1.099, Test loss: 1.003, Test accuracy: 92.78
Round  86, Global train loss: 1.099, Global test loss: 0.968, Global test accuracy: 96.70
Round  87, Train loss: 0.918, Test loss: 0.984, Test accuracy: 94.18
Round  87, Global train loss: 0.918, Global test loss: 0.941, Global test accuracy: 97.52
Round  88, Train loss: 0.911, Test loss: 0.977, Test accuracy: 94.82
Round  88, Global train loss: 0.911, Global test loss: 0.936, Global test accuracy: 97.82
Round  89, Train loss: 1.097, Test loss: 0.993, Test accuracy: 93.18
Round  89, Global train loss: 1.097, Global test loss: 0.959, Global test accuracy: 97.08
Round  90, Train loss: 0.915, Test loss: 0.983, Test accuracy: 94.00
Round  90, Global train loss: 0.915, Global test loss: 0.938, Global test accuracy: 97.78
Round  91, Train loss: 0.911, Test loss: 0.978, Test accuracy: 94.30
Round  91, Global train loss: 0.911, Global test loss: 0.935, Global test accuracy: 97.74
Round  92, Train loss: 1.089, Test loss: 0.990, Test accuracy: 93.44
Round  92, Global train loss: 1.089, Global test loss: 0.955, Global test accuracy: 97.16/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 0.913, Test loss: 0.983, Test accuracy: 93.84
Round  93, Global train loss: 0.913, Global test loss: 0.938, Global test accuracy: 97.84
Round  94, Train loss: 0.911, Test loss: 0.978, Test accuracy: 94.42
Round  94, Global train loss: 0.911, Global test loss: 0.935, Global test accuracy: 97.90
Round  95, Train loss: 1.093, Test loss: 0.993, Test accuracy: 93.14
Round  95, Global train loss: 1.093, Global test loss: 0.958, Global test accuracy: 97.30
Round  96, Train loss: 1.083, Test loss: 1.006, Test accuracy: 92.70
Round  96, Global train loss: 1.083, Global test loss: 0.971, Global test accuracy: 96.66
Round  97, Train loss: 0.916, Test loss: 0.986, Test accuracy: 93.60
Round  97, Global train loss: 0.916, Global test loss: 0.941, Global test accuracy: 97.60
Round  98, Train loss: 1.086, Test loss: 0.997, Test accuracy: 92.76
Round  98, Global train loss: 1.086, Global test loss: 0.965, Global test accuracy: 96.70
Round  99, Train loss: 0.914, Test loss: 0.984, Test accuracy: 93.90
Round  99, Global train loss: 0.914, Global test loss: 0.939, Global test accuracy: 97.76
Final Round, Train loss: 1.011, Test loss: 0.986, Test accuracy: 93.50
Final Round, Global train loss: 1.011, Global test loss: 0.939, Global test accuracy: 97.76
Average accuracy final 10 rounds: 93.61
697.6613364219666
[1.4410605430603027, 2.671499490737915, 3.9756057262420654, 5.3781280517578125, 6.641669750213623, 7.951228380203247, 9.333054065704346, 10.714772462844849, 11.904993772506714, 13.081105947494507, 14.343030452728271, 15.600624322891235, 16.896533727645874, 18.045830965042114, 19.395484685897827, 20.594104051589966, 21.874211072921753, 23.2145037651062, 24.434446334838867, 25.713559865951538, 26.94901466369629, 28.271435737609863, 29.66801357269287, 30.922024726867676, 32.07276463508606, 33.32797574996948, 34.561712980270386, 35.961987257003784, 37.2432062625885, 38.51127600669861, 39.745827198028564, 40.945801973342896, 42.16294288635254, 43.47757029533386, 44.7275767326355, 46.01948690414429, 47.24914860725403, 48.47890663146973, 49.6784245967865, 50.91957759857178, 52.19499087333679, 53.43234205245972, 54.67309069633484, 55.99506616592407, 57.15886664390564, 58.41908526420593, 59.64220094680786, 60.926549196243286, 62.08887696266174, 63.2919282913208, 64.83674645423889, 66.14555382728577, 67.43169927597046, 68.68957924842834, 70.1738965511322, 71.60706901550293, 72.83317399024963, 74.04822015762329, 75.36274766921997, 76.57932639122009, 77.92316007614136, 79.13183116912842, 80.40623474121094, 81.73598098754883, 83.1147768497467, 84.44399309158325, 85.64245009422302, 86.90213179588318, 88.13566279411316, 89.52817869186401, 90.82842803001404, 92.02298498153687, 93.19830441474915, 94.51482605934143, 95.84032797813416, 97.05082678794861, 98.51568627357483, 100.12845182418823, 101.3923807144165, 102.8204174041748, 104.10351514816284, 105.37822484970093, 106.69389867782593, 107.89823532104492, 109.18834376335144, 110.43924236297607, 111.76146006584167, 113.14401507377625, 114.5333902835846, 115.78629684448242, 117.04763674736023, 118.31466484069824, 119.61220264434814, 120.94397354125977, 122.2245180606842, 123.54670763015747, 124.8445360660553, 126.08822703361511, 127.43234038352966, 128.62234902381897, 130.65714120864868]
[30.18, 70.34, 85.74, 93.94, 94.66, 95.48, 95.8, 96.1, 96.08, 96.2, 96.62, 96.54, 96.6, 96.58, 96.78, 96.68, 96.8, 96.88, 97.02, 97.04, 97.14, 97.08, 96.96, 97.08, 97.06, 97.06, 96.86, 97.04, 96.8, 96.96, 96.98, 97.12, 96.78, 97.06, 96.82, 96.7, 96.9, 97.1, 97.26, 96.9, 96.72, 97.0, 96.76, 96.18, 96.24, 96.2, 96.28, 96.9, 97.18, 96.62, 95.5, 95.92, 96.4, 96.8, 94.76, 94.7, 95.86, 96.32, 95.68, 95.5, 96.08, 96.52, 93.6, 94.06, 95.48, 94.92, 95.32, 95.98, 95.0, 95.32, 94.2, 93.7, 92.98, 93.26, 95.08, 92.08, 94.24, 94.02, 93.44, 92.9, 94.48, 93.76, 89.74, 92.12, 94.18, 93.24, 92.78, 94.18, 94.82, 93.18, 94.0, 94.3, 93.44, 93.84, 94.42, 93.14, 92.7, 93.6, 92.76, 93.9, 93.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.619, Test loss: 1.588, Test accuracy: 31.92
Round   0, Global train loss: 1.619, Global test loss: 1.588, Global test accuracy: 31.86
Round   1, Train loss: 1.567, Test loss: 1.507, Test accuracy: 45.44
Round   1, Global train loss: 1.567, Global test loss: 1.507, Global test accuracy: 44.88
Round   2, Train loss: 1.455, Test loss: 1.350, Test accuracy: 69.98
Round   2, Global train loss: 1.455, Global test loss: 1.347, Global test accuracy: 69.24
Round   3, Train loss: 1.311, Test loss: 1.179, Test accuracy: 88.20
Round   3, Global train loss: 1.311, Global test loss: 1.171, Global test accuracy: 89.36
Round   4, Train loss: 1.189, Test loss: 1.074, Test accuracy: 92.20
Round   4, Global train loss: 1.189, Global test loss: 1.053, Global test accuracy: 93.92
Round   5, Train loss: 1.145, Test loss: 1.042, Test accuracy: 93.40
Round   5, Global train loss: 1.145, Global test loss: 1.016, Global test accuracy: 95.10
Round   6, Train loss: 1.129, Test loss: 1.028, Test accuracy: 93.74
Round   6, Global train loss: 1.129, Global test loss: 1.000, Global test accuracy: 95.62
Round   7, Train loss: 1.121, Test loss: 1.021, Test accuracy: 94.04
Round   7, Global train loss: 1.121, Global test loss: 0.991, Global test accuracy: 95.98
Round   8, Train loss: 1.115, Test loss: 1.017, Test accuracy: 94.22
Round   8, Global train loss: 1.115, Global test loss: 0.985, Global test accuracy: 96.32
Round   9, Train loss: 1.110, Test loss: 1.014, Test accuracy: 94.38
Round   9, Global train loss: 1.110, Global test loss: 0.980, Global test accuracy: 96.60
Round  10, Train loss: 1.208, Test loss: 1.025, Test accuracy: 93.82
Round  10, Global train loss: 1.208, Global test loss: 1.038, Global test accuracy: 93.02
Round  11, Train loss: 1.076, Test loss: 1.006, Test accuracy: 94.44
Round  11, Global train loss: 1.076, Global test loss: 0.973, Global test accuracy: 96.86
Round  12, Train loss: 0.961, Test loss: 1.003, Test accuracy: 94.30
Round  12, Global train loss: 0.961, Global test loss: 0.960, Global test accuracy: 96.48
Round  13, Train loss: 0.994, Test loss: 0.998, Test accuracy: 94.38
Round  13, Global train loss: 0.994, Global test loss: 0.973, Global test accuracy: 95.20
Round  14, Train loss: 0.957, Test loss: 0.992, Test accuracy: 94.98
Round  14, Global train loss: 0.957, Global test loss: 0.953, Global test accuracy: 96.90
Round  15, Train loss: 0.983, Test loss: 0.991, Test accuracy: 94.82
Round  15, Global train loss: 0.983, Global test loss: 0.966, Global test accuracy: 95.56
Round  16, Train loss: 1.026, Test loss: 0.992, Test accuracy: 94.94
Round  16, Global train loss: 1.026, Global test loss: 0.969, Global test accuracy: 95.76
Round  17, Train loss: 1.140, Test loss: 0.992, Test accuracy: 94.80
Round  17, Global train loss: 1.140, Global test loss: 0.981, Global test accuracy: 96.30
Round  18, Train loss: 1.093, Test loss: 1.003, Test accuracy: 94.20
Round  18, Global train loss: 1.093, Global test loss: 0.984, Global test accuracy: 95.90
Round  19, Train loss: 0.987, Test loss: 0.995, Test accuracy: 94.76
Round  19, Global train loss: 0.987, Global test loss: 0.965, Global test accuracy: 96.08
Round  20, Train loss: 0.974, Test loss: 0.990, Test accuracy: 95.18
Round  20, Global train loss: 0.974, Global test loss: 0.960, Global test accuracy: 96.18
Round  21, Train loss: 0.970, Test loss: 0.986, Test accuracy: 95.36
Round  21, Global train loss: 0.970, Global test loss: 0.959, Global test accuracy: 96.22
Round  22, Train loss: 1.007, Test loss: 0.989, Test accuracy: 95.26
Round  22, Global train loss: 1.007, Global test loss: 0.960, Global test accuracy: 96.36
Round  23, Train loss: 0.934, Test loss: 0.983, Test accuracy: 95.88
Round  23, Global train loss: 0.934, Global test loss: 0.944, Global test accuracy: 97.32
Round  24, Train loss: 1.113, Test loss: 0.994, Test accuracy: 94.56
Round  24, Global train loss: 1.113, Global test loss: 0.980, Global test accuracy: 96.60
Round  25, Train loss: 0.976, Test loss: 0.991, Test accuracy: 95.24
Round  25, Global train loss: 0.976, Global test loss: 0.952, Global test accuracy: 97.28
Round  26, Train loss: 0.929, Test loss: 0.984, Test accuracy: 95.62
Round  26, Global train loss: 0.929, Global test loss: 0.944, Global test accuracy: 97.20
Round  27, Train loss: 1.003, Test loss: 0.987, Test accuracy: 95.30
Round  27, Global train loss: 1.003, Global test loss: 0.956, Global test accuracy: 96.68
Round  28, Train loss: 0.926, Test loss: 0.983, Test accuracy: 95.72
Round  28, Global train loss: 0.926, Global test loss: 0.943, Global test accuracy: 97.26
Round  29, Train loss: 1.070, Test loss: 0.991, Test accuracy: 94.92
Round  29, Global train loss: 1.070, Global test loss: 0.968, Global test accuracy: 96.34
Round  30, Train loss: 0.935, Test loss: 0.982, Test accuracy: 95.68
Round  30, Global train loss: 0.935, Global test loss: 0.941, Global test accuracy: 97.72
Round  31, Train loss: 1.042, Test loss: 0.982, Test accuracy: 95.66
Round  31, Global train loss: 1.042, Global test loss: 0.947, Global test accuracy: 97.40
Round  32, Train loss: 1.043, Test loss: 0.986, Test accuracy: 95.48
Round  32, Global train loss: 1.043, Global test loss: 0.949, Global test accuracy: 97.56
Round  33, Train loss: 1.062, Test loss: 0.996, Test accuracy: 94.34
Round  33, Global train loss: 1.062, Global test loss: 0.972, Global test accuracy: 96.16
Round  34, Train loss: 1.093, Test loss: 1.003, Test accuracy: 93.76
Round  34, Global train loss: 1.093, Global test loss: 0.995, Global test accuracy: 95.14
Round  35, Train loss: 1.169, Test loss: 1.013, Test accuracy: 92.80
Round  35, Global train loss: 1.169, Global test loss: 1.009, Global test accuracy: 95.58
Round  36, Train loss: 0.969, Test loss: 0.991, Test accuracy: 95.02
Round  36, Global train loss: 0.969, Global test loss: 0.955, Global test accuracy: 96.94
Round  37, Train loss: 0.993, Test loss: 0.985, Test accuracy: 95.14
Round  37, Global train loss: 0.993, Global test loss: 0.960, Global test accuracy: 96.68
Round  38, Train loss: 1.192, Test loss: 1.011, Test accuracy: 92.34
Round  38, Global train loss: 1.192, Global test loss: 1.042, Global test accuracy: 90.68
Round  39, Train loss: 1.043, Test loss: 1.010, Test accuracy: 92.76
Round  39, Global train loss: 1.043, Global test loss: 0.967, Global test accuracy: 96.64
Round  40, Train loss: 0.927, Test loss: 0.986, Test accuracy: 94.94
Round  40, Global train loss: 0.927, Global test loss: 0.942, Global test accuracy: 97.60
Round  41, Train loss: 1.064, Test loss: 0.994, Test accuracy: 93.36
Round  41, Global train loss: 1.064, Global test loss: 0.990, Global test accuracy: 93.96
Round  42, Train loss: 1.059, Test loss: 1.002, Test accuracy: 92.50
Round  42, Global train loss: 1.059, Global test loss: 0.990, Global test accuracy: 94.06
Round  43, Train loss: 0.956, Test loss: 0.986, Test accuracy: 94.24
Round  43, Global train loss: 0.956, Global test loss: 0.952, Global test accuracy: 97.16
Round  44, Train loss: 0.923, Test loss: 0.976, Test accuracy: 95.28
Round  44, Global train loss: 0.923, Global test loss: 0.939, Global test accuracy: 97.56
Round  45, Train loss: 1.040, Test loss: 0.986, Test accuracy: 94.12
Round  45, Global train loss: 1.040, Global test loss: 0.963, Global test accuracy: 96.62
Round  46, Train loss: 0.976, Test loss: 0.989, Test accuracy: 93.96
Round  46, Global train loss: 0.976, Global test loss: 0.953, Global test accuracy: 97.00
Round  47, Train loss: 0.944, Test loss: 0.985, Test accuracy: 94.70
Round  47, Global train loss: 0.944, Global test loss: 0.951, Global test accuracy: 96.82
Round  48, Train loss: 0.941, Test loss: 0.980, Test accuracy: 94.88
Round  48, Global train loss: 0.941, Global test loss: 0.946, Global test accuracy: 97.54
Round  49, Train loss: 0.969, Test loss: 0.983, Test accuracy: 94.24
Round  49, Global train loss: 0.969, Global test loss: 0.949, Global test accuracy: 97.12
Round  50, Train loss: 0.964, Test loss: 0.985, Test accuracy: 93.90
Round  50, Global train loss: 0.964, Global test loss: 0.950, Global test accuracy: 96.94
Round  51, Train loss: 0.919, Test loss: 0.975, Test accuracy: 94.96
Round  51, Global train loss: 0.919, Global test loss: 0.937, Global test accuracy: 97.60
Round  52, Train loss: 0.941, Test loss: 0.975, Test accuracy: 94.96
Round  52, Global train loss: 0.941, Global test loss: 0.947, Global test accuracy: 96.92
Round  53, Train loss: 1.034, Test loss: 0.984, Test accuracy: 94.22
Round  53, Global train loss: 1.034, Global test loss: 0.953, Global test accuracy: 97.32
Round  54, Train loss: 0.921, Test loss: 0.980, Test accuracy: 94.66
Round  54, Global train loss: 0.921, Global test loss: 0.937, Global test accuracy: 97.94
Round  55, Train loss: 1.027, Test loss: 0.990, Test accuracy: 93.48
Round  55, Global train loss: 1.027, Global test loss: 0.964, Global test accuracy: 96.30
Round  56, Train loss: 1.023, Test loss: 0.994, Test accuracy: 93.08
Round  56, Global train loss: 1.023, Global test loss: 0.966, Global test accuracy: 96.26
Round  57, Train loss: 0.918, Test loss: 0.981, Test accuracy: 94.56
Round  57, Global train loss: 0.918, Global test loss: 0.938, Global test accuracy: 97.80
Round  58, Train loss: 0.938, Test loss: 0.979, Test accuracy: 94.58
Round  58, Global train loss: 0.938, Global test loss: 0.944, Global test accuracy: 97.34
Round  59, Train loss: 1.020, Test loss: 0.988, Test accuracy: 93.32
Round  59, Global train loss: 1.020, Global test loss: 0.955, Global test accuracy: 97.16
Round  60, Train loss: 1.037, Test loss: 1.008, Test accuracy: 91.50
Round  60, Global train loss: 1.037, Global test loss: 0.992, Global test accuracy: 93.24
Round  61, Train loss: 0.921, Test loss: 0.990, Test accuracy: 93.16
Round  61, Global train loss: 0.921, Global test loss: 0.937, Global test accuracy: 97.90
Round  62, Train loss: 1.018, Test loss: 0.992, Test accuracy: 93.14
Round  62, Global train loss: 1.018, Global test loss: 0.959, Global test accuracy: 96.64
Round  63, Train loss: 0.933, Test loss: 0.991, Test accuracy: 93.18
Round  63, Global train loss: 0.933, Global test loss: 0.953, Global test accuracy: 96.54
Round  64, Train loss: 1.030, Test loss: 0.998, Test accuracy: 92.50
Round  64, Global train loss: 1.030, Global test loss: 0.968, Global test accuracy: 96.26
Round  65, Train loss: 1.027, Test loss: 1.013, Test accuracy: 90.88
Round  65, Global train loss: 1.027, Global test loss: 1.010, Global test accuracy: 91.48
Round  66, Train loss: 0.932, Test loss: 0.993, Test accuracy: 93.00
Round  66, Global train loss: 0.932, Global test loss: 0.951, Global test accuracy: 96.66
Round  67, Train loss: 1.101, Test loss: 1.016, Test accuracy: 90.76
Round  67, Global train loss: 1.101, Global test loss: 1.012, Global test accuracy: 92.98
Round  68, Train loss: 0.951, Test loss: 0.998, Test accuracy: 92.84
Round  68, Global train loss: 0.951, Global test loss: 0.964, Global test accuracy: 96.30
Round  69, Train loss: 0.932, Test loss: 0.980, Test accuracy: 94.06
Round  69, Global train loss: 0.932, Global test loss: 0.950, Global test accuracy: 96.92
Round  70, Train loss: 0.915, Test loss: 0.970, Test accuracy: 95.26
Round  70, Global train loss: 0.915, Global test loss: 0.935, Global test accuracy: 97.78
Round  71, Train loss: 1.003, Test loss: 0.983, Test accuracy: 93.84
Round  71, Global train loss: 1.003, Global test loss: 0.949, Global test accuracy: 97.12
Round  72, Train loss: 0.916, Test loss: 0.975, Test accuracy: 94.66
Round  72, Global train loss: 0.916, Global test loss: 0.937, Global test accuracy: 97.66
Round  73, Train loss: 1.007, Test loss: 0.987, Test accuracy: 93.36
Round  73, Global train loss: 1.007, Global test loss: 0.956, Global test accuracy: 96.60
Round  74, Train loss: 1.083, Test loss: 1.022, Test accuracy: 89.90
Round  74, Global train loss: 1.083, Global test loss: 1.025, Global test accuracy: 90.94
Round  75, Train loss: 1.001, Test loss: 1.010, Test accuracy: 91.40
Round  75, Global train loss: 1.001, Global test loss: 0.971, Global test accuracy: 95.82
Round  76, Train loss: 1.016, Test loss: 1.014, Test accuracy: 91.26
Round  76, Global train loss: 1.016, Global test loss: 1.028, Global test accuracy: 90.06
Round  77, Train loss: 1.008, Test loss: 1.012, Test accuracy: 91.48
Round  77, Global train loss: 1.008, Global test loss: 1.005, Global test accuracy: 92.12
Round  78, Train loss: 0.930, Test loss: 0.985, Test accuracy: 93.84
Round  78, Global train loss: 0.930, Global test loss: 0.956, Global test accuracy: 96.42
Round  79, Train loss: 0.993, Test loss: 0.985, Test accuracy: 93.70
Round  79, Global train loss: 0.993, Global test loss: 0.957, Global test accuracy: 96.76
Round  80, Train loss: 0.924, Test loss: 0.978, Test accuracy: 94.34
Round  80, Global train loss: 0.924, Global test loss: 0.944, Global test accuracy: 97.12
Round  81, Train loss: 0.922, Test loss: 0.972, Test accuracy: 94.82
Round  81, Global train loss: 0.922, Global test loss: 0.940, Global test accuracy: 97.34
Round  82, Train loss: 0.921, Test loss: 0.969, Test accuracy: 94.88
Round  82, Global train loss: 0.921, Global test loss: 0.938, Global test accuracy: 97.52
Round  83, Train loss: 0.920, Test loss: 0.968, Test accuracy: 94.98
Round  83, Global train loss: 0.920, Global test loss: 0.937, Global test accuracy: 97.56
Round  84, Train loss: 0.920, Test loss: 0.968, Test accuracy: 94.90
Round  84, Global train loss: 0.920, Global test loss: 0.936, Global test accuracy: 97.62
Round  85, Train loss: 0.919, Test loss: 0.967, Test accuracy: 94.94
Round  85, Global train loss: 0.919, Global test loss: 0.935, Global test accuracy: 97.70
Round  86, Train loss: 0.919, Test loss: 0.966, Test accuracy: 95.02
Round  86, Global train loss: 0.919, Global test loss: 0.935, Global test accuracy: 97.68
Round  87, Train loss: 0.919, Test loss: 0.965, Test accuracy: 95.02
Round  87, Global train loss: 0.919, Global test loss: 0.934, Global test accuracy: 97.68
Round  88, Train loss: 0.918, Test loss: 0.964, Test accuracy: 95.16
Round  88, Global train loss: 0.918, Global test loss: 0.934, Global test accuracy: 97.78
Round  89, Train loss: 0.918, Test loss: 0.965, Test accuracy: 95.16
Round  89, Global train loss: 0.918, Global test loss: 0.934, Global test accuracy: 97.74
Round  90, Train loss: 0.918, Test loss: 0.964, Test accuracy: 95.12
Round  90, Global train loss: 0.918, Global test loss: 0.933, Global test accuracy: 97.74
Round  91, Train loss: 0.917, Test loss: 0.964, Test accuracy: 95.14
Round  91, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.78/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 0.917, Test loss: 0.964, Test accuracy: 95.16
Round  92, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.80
Round  93, Train loss: 0.917, Test loss: 0.963, Test accuracy: 95.24
Round  93, Global train loss: 0.917, Global test loss: 0.933, Global test accuracy: 97.84
Round  94, Train loss: 0.917, Test loss: 0.963, Test accuracy: 95.24
Round  94, Global train loss: 0.917, Global test loss: 0.932, Global test accuracy: 97.84
Round  95, Train loss: 0.916, Test loss: 0.963, Test accuracy: 95.36
Round  95, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.82
Round  96, Train loss: 0.916, Test loss: 0.963, Test accuracy: 95.36
Round  96, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.86
Round  97, Train loss: 0.916, Test loss: 0.963, Test accuracy: 95.28
Round  97, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.82
Round  98, Train loss: 0.916, Test loss: 0.962, Test accuracy: 95.46
Round  98, Global train loss: 0.916, Global test loss: 0.932, Global test accuracy: 97.92
Round  99, Train loss: 0.964, Test loss: 0.980, Test accuracy: 93.64
Round  99, Global train loss: 0.964, Global test loss: 0.941, Global test accuracy: 97.42
Final Round, Train loss: 0.991, Test loss: 0.985, Test accuracy: 93.16
Final Round, Global train loss: 0.991, Global test loss: 0.941, Global test accuracy: 97.42
Average accuracy final 10 rounds: 95.10000000000002
1240.0760617256165
[1.8973042964935303, 3.385051727294922, 5.292749404907227, 7.173843145370483, 8.644528150558472, 10.108769416809082, 11.593563318252563, 13.134508848190308, 14.834061861038208, 16.419047117233276, 21.52222728729248, 29.497788429260254, 30.808919191360474, 32.25754261016846, 33.679271936416626, 35.137149810791016, 36.53852319717407, 44.42415189743042, 53.16138768196106, 54.56628346443176, 56.00189924240112, 57.48402690887451, 58.89971899986267, 60.267492055892944, 68.30060958862305, 69.60925221443176, 71.87019848823547, 73.37929940223694, 74.86163568496704, 82.94375801086426, 84.48492765426636, 92.47042489051819, 100.84414649009705, 108.55630445480347, 116.40984344482422, 124.63595080375671, 126.05350613594055, 127.46552348136902, 135.61709785461426, 143.59685635566711, 145.08392095565796, 153.0970675945282, 160.63053631782532, 162.12710309028625, 163.59051132202148, 171.4528591632843, 172.8162944316864, 174.25766777992249, 175.81781363487244, 177.2159194946289, 178.61356115341187, 180.02700662612915, 181.4102602005005, 189.14937496185303, 190.55095958709717, 198.89918422698975, 207.3396966457367, 208.82262420654297, 210.27231740951538, 218.59644317626953, 226.95431542396545, 228.33779978752136, 236.29969596862793, 237.7078115940094, 245.56148958206177, 253.50588750839233, 255.02323937416077, 263.2453942298889, 264.6234972476959, 265.96441555023193, 267.3751952648163, 275.2846128940582, 276.69112062454224, 284.18634581565857, 292.2234899997711, 300.04018688201904, 307.86376547813416, 315.9175636768341, 317.32353496551514, 325.06858229637146, 326.59440565109253, 328.0060305595398, 329.4247136116028, 330.8516972064972, 332.3923923969269, 333.7448811531067, 335.2025969028473, 336.6640431880951, 338.07203102111816, 339.48186016082764, 340.8998169898987, 342.3705461025238, 343.8093454837799, 345.2270522117615, 346.63493728637695, 348.311386346817, 349.7494776248932, 351.3841505050659, 352.90111565589905, 361.2157917022705, 369.13606357574463]
[31.92, 45.44, 69.98, 88.2, 92.2, 93.4, 93.74, 94.04, 94.22, 94.38, 93.82, 94.44, 94.3, 94.38, 94.98, 94.82, 94.94, 94.8, 94.2, 94.76, 95.18, 95.36, 95.26, 95.88, 94.56, 95.24, 95.62, 95.3, 95.72, 94.92, 95.68, 95.66, 95.48, 94.34, 93.76, 92.8, 95.02, 95.14, 92.34, 92.76, 94.94, 93.36, 92.5, 94.24, 95.28, 94.12, 93.96, 94.7, 94.88, 94.24, 93.9, 94.96, 94.96, 94.22, 94.66, 93.48, 93.08, 94.56, 94.58, 93.32, 91.5, 93.16, 93.14, 93.18, 92.5, 90.88, 93.0, 90.76, 92.84, 94.06, 95.26, 93.84, 94.66, 93.36, 89.9, 91.4, 91.26, 91.48, 93.84, 93.7, 94.34, 94.82, 94.88, 94.98, 94.9, 94.94, 95.02, 95.02, 95.16, 95.16, 95.12, 95.14, 95.16, 95.24, 95.24, 95.36, 95.36, 95.28, 95.46, 93.64, 93.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.585, Test loss: 1.536, Test accuracy: 40.50
Round   0, Global train loss: 1.585, Global test loss: 1.537, Global test accuracy: 39.14
Round   1, Train loss: 1.500, Test loss: 1.404, Test accuracy: 68.52
Round   1, Global train loss: 1.500, Global test loss: 1.352, Global test accuracy: 83.44
Round   2, Train loss: 1.343, Test loss: 1.295, Test accuracy: 71.50
Round   2, Global train loss: 1.343, Global test loss: 1.179, Global test accuracy: 90.64
Round   3, Train loss: 1.341, Test loss: 1.214, Test accuracy: 78.74
Round   3, Global train loss: 1.341, Global test loss: 1.126, Global test accuracy: 91.82
Round   4, Train loss: 1.319, Test loss: 1.142, Test accuracy: 82.14
Round   4, Global train loss: 1.319, Global test loss: 1.110, Global test accuracy: 82.66
Round   5, Train loss: 1.193, Test loss: 1.103, Test accuracy: 85.02
Round   5, Global train loss: 1.193, Global test loss: 0.991, Global test accuracy: 94.06
Round   6, Train loss: 1.101, Test loss: 1.070, Test accuracy: 88.78
Round   6, Global train loss: 1.101, Global test loss: 1.018, Global test accuracy: 91.42
Round   7, Train loss: 1.104, Test loss: 1.036, Test accuracy: 90.86
Round   7, Global train loss: 1.104, Global test loss: 1.006, Global test accuracy: 93.48
Round   8, Train loss: 1.132, Test loss: 1.023, Test accuracy: 90.96
Round   8, Global train loss: 1.132, Global test loss: 0.980, Global test accuracy: 94.32
Round   9, Train loss: 1.227, Test loss: 1.023, Test accuracy: 90.60
Round   9, Global train loss: 1.227, Global test loss: 0.994, Global test accuracy: 93.44
Round  10, Train loss: 1.192, Test loss: 1.024, Test accuracy: 90.14
Round  10, Global train loss: 1.192, Global test loss: 1.048, Global test accuracy: 88.40
Round  11, Train loss: 1.037, Test loss: 1.006, Test accuracy: 91.40
Round  11, Global train loss: 1.037, Global test loss: 0.972, Global test accuracy: 94.52
Round  12, Train loss: 1.051, Test loss: 1.005, Test accuracy: 91.36
Round  12, Global train loss: 1.051, Global test loss: 0.976, Global test accuracy: 94.32
Round  13, Train loss: 1.162, Test loss: 1.005, Test accuracy: 91.40
Round  13, Global train loss: 1.162, Global test loss: 1.022, Global test accuracy: 90.84
Round  14, Train loss: 1.036, Test loss: 1.001, Test accuracy: 91.60
Round  14, Global train loss: 1.036, Global test loss: 0.968, Global test accuracy: 94.74
Round  15, Train loss: 0.978, Test loss: 0.996, Test accuracy: 92.38
Round  15, Global train loss: 0.978, Global test loss: 0.984, Global test accuracy: 93.32
Round  16, Train loss: 0.982, Test loss: 0.994, Test accuracy: 92.48
Round  16, Global train loss: 0.982, Global test loss: 0.965, Global test accuracy: 95.02
Round  17, Train loss: 0.969, Test loss: 0.993, Test accuracy: 92.58
Round  17, Global train loss: 0.969, Global test loss: 0.967, Global test accuracy: 94.84
Round  18, Train loss: 1.204, Test loss: 0.993, Test accuracy: 92.42
Round  18, Global train loss: 1.204, Global test loss: 0.980, Global test accuracy: 93.54
Round  19, Train loss: 1.031, Test loss: 0.992, Test accuracy: 92.46
Round  19, Global train loss: 1.031, Global test loss: 0.979, Global test accuracy: 93.84
Round  20, Train loss: 0.950, Test loss: 0.991, Test accuracy: 92.48
Round  20, Global train loss: 0.950, Global test loss: 0.972, Global test accuracy: 94.10
Round  21, Train loss: 1.036, Test loss: 0.992, Test accuracy: 92.26
Round  21, Global train loss: 1.036, Global test loss: 0.995, Global test accuracy: 91.50
Round  22, Train loss: 0.974, Test loss: 0.993, Test accuracy: 92.22
Round  22, Global train loss: 0.974, Global test loss: 0.973, Global test accuracy: 93.86
Round  23, Train loss: 1.100, Test loss: 0.993, Test accuracy: 92.24
Round  23, Global train loss: 1.100, Global test loss: 0.977, Global test accuracy: 93.70
Round  24, Train loss: 1.061, Test loss: 0.993, Test accuracy: 92.24
Round  24, Global train loss: 1.061, Global test loss: 0.962, Global test accuracy: 95.12
Round  25, Train loss: 1.037, Test loss: 0.993, Test accuracy: 92.20
Round  25, Global train loss: 1.037, Global test loss: 0.962, Global test accuracy: 95.26
Round  26, Train loss: 1.101, Test loss: 0.994, Test accuracy: 92.14
Round  26, Global train loss: 1.101, Global test loss: 0.990, Global test accuracy: 92.02
Round  27, Train loss: 1.039, Test loss: 0.994, Test accuracy: 92.04
Round  27, Global train loss: 1.039, Global test loss: 0.969, Global test accuracy: 94.28
Round  28, Train loss: 1.095, Test loss: 0.995, Test accuracy: 91.88
Round  28, Global train loss: 1.095, Global test loss: 0.989, Global test accuracy: 92.08
Round  29, Train loss: 1.095, Test loss: 0.995, Test accuracy: 91.76
Round  29, Global train loss: 1.095, Global test loss: 0.961, Global test accuracy: 95.42
Round  30, Train loss: 1.082, Test loss: 0.995, Test accuracy: 91.60
Round  30, Global train loss: 1.082, Global test loss: 0.966, Global test accuracy: 94.58
Round  31, Train loss: 1.004, Test loss: 0.996, Test accuracy: 91.46
Round  31, Global train loss: 1.004, Global test loss: 0.967, Global test accuracy: 94.52
Round  32, Train loss: 1.078, Test loss: 0.996, Test accuracy: 91.48
Round  32, Global train loss: 1.078, Global test loss: 0.975, Global test accuracy: 93.32
Round  33, Train loss: 1.091, Test loss: 0.998, Test accuracy: 91.30
Round  33, Global train loss: 1.091, Global test loss: 0.960, Global test accuracy: 95.26
Round  34, Train loss: 1.126, Test loss: 0.998, Test accuracy: 91.26
Round  34, Global train loss: 1.126, Global test loss: 0.971, Global test accuracy: 94.14
Round  35, Train loss: 1.090, Test loss: 0.998, Test accuracy: 91.24
Round  35, Global train loss: 1.090, Global test loss: 0.968, Global test accuracy: 94.30
Round  36, Train loss: 1.006, Test loss: 0.997, Test accuracy: 91.40
Round  36, Global train loss: 1.006, Global test loss: 0.970, Global test accuracy: 94.12
Round  37, Train loss: 0.957, Test loss: 0.997, Test accuracy: 91.36
Round  37, Global train loss: 0.957, Global test loss: 0.956, Global test accuracy: 95.44
Round  38, Train loss: 1.035, Test loss: 0.997, Test accuracy: 91.36
Round  38, Global train loss: 1.035, Global test loss: 0.955, Global test accuracy: 95.52
Round  39, Train loss: 1.074, Test loss: 0.998, Test accuracy: 91.26
Round  39, Global train loss: 1.074, Global test loss: 0.974, Global test accuracy: 93.42
Round  40, Train loss: 1.087, Test loss: 0.997, Test accuracy: 91.26
Round  40, Global train loss: 1.087, Global test loss: 0.986, Global test accuracy: 92.30
Round  41, Train loss: 0.943, Test loss: 0.998, Test accuracy: 91.28
Round  41, Global train loss: 0.943, Global test loss: 0.949, Global test accuracy: 96.18
Round  42, Train loss: 0.945, Test loss: 0.997, Test accuracy: 91.30
Round  42, Global train loss: 0.945, Global test loss: 0.952, Global test accuracy: 95.76
Round  43, Train loss: 1.028, Test loss: 0.997, Test accuracy: 91.26
Round  43, Global train loss: 1.028, Global test loss: 0.961, Global test accuracy: 95.12
Round  44, Train loss: 1.010, Test loss: 0.998, Test accuracy: 91.22
Round  44, Global train loss: 1.010, Global test loss: 0.969, Global test accuracy: 93.88
Round  45, Train loss: 1.101, Test loss: 0.998, Test accuracy: 91.16
Round  45, Global train loss: 1.101, Global test loss: 0.980, Global test accuracy: 92.52
Round  46, Train loss: 0.956, Test loss: 0.998, Test accuracy: 91.16
Round  46, Global train loss: 0.956, Global test loss: 0.958, Global test accuracy: 95.02
Round  47, Train loss: 1.020, Test loss: 0.997, Test accuracy: 91.24
Round  47, Global train loss: 1.020, Global test loss: 0.955, Global test accuracy: 95.30
Round  48, Train loss: 1.035, Test loss: 0.997, Test accuracy: 91.22
Round  48, Global train loss: 1.035, Global test loss: 0.966, Global test accuracy: 94.10
Round  49, Train loss: 0.955, Test loss: 0.997, Test accuracy: 91.06
Round  49, Global train loss: 0.955, Global test loss: 0.958, Global test accuracy: 95.04
Round  50, Train loss: 0.954, Test loss: 0.997, Test accuracy: 91.16
Round  50, Global train loss: 0.954, Global test loss: 0.957, Global test accuracy: 95.14
Round  51, Train loss: 1.088, Test loss: 0.997, Test accuracy: 91.26
Round  51, Global train loss: 1.088, Global test loss: 0.980, Global test accuracy: 92.86
Round  52, Train loss: 1.010, Test loss: 0.997, Test accuracy: 91.24
Round  52, Global train loss: 1.010, Global test loss: 0.990, Global test accuracy: 91.82
Round  53, Train loss: 1.160, Test loss: 0.998, Test accuracy: 91.16
Round  53, Global train loss: 1.160, Global test loss: 0.966, Global test accuracy: 94.42
Round  54, Train loss: 0.998, Test loss: 0.998, Test accuracy: 91.02
Round  54, Global train loss: 0.998, Global test loss: 0.960, Global test accuracy: 94.86
Round  55, Train loss: 1.088, Test loss: 0.998, Test accuracy: 91.16
Round  55, Global train loss: 1.088, Global test loss: 0.966, Global test accuracy: 94.12
Round  56, Train loss: 1.083, Test loss: 0.998, Test accuracy: 91.10
Round  56, Global train loss: 1.083, Global test loss: 0.956, Global test accuracy: 95.04
Round  57, Train loss: 0.999, Test loss: 0.998, Test accuracy: 91.12
Round  57, Global train loss: 0.999, Global test loss: 0.963, Global test accuracy: 94.28
Round  58, Train loss: 1.018, Test loss: 0.998, Test accuracy: 91.14
Round  58, Global train loss: 1.018, Global test loss: 0.955, Global test accuracy: 95.28
Round  59, Train loss: 1.082, Test loss: 0.998, Test accuracy: 91.06
Round  59, Global train loss: 1.082, Global test loss: 0.956, Global test accuracy: 95.16
Round  60, Train loss: 0.951, Test loss: 0.998, Test accuracy: 91.06
Round  60, Global train loss: 0.951, Global test loss: 0.955, Global test accuracy: 94.92
Round  61, Train loss: 1.065, Test loss: 0.999, Test accuracy: 91.06
Round  61, Global train loss: 1.065, Global test loss: 0.961, Global test accuracy: 94.66
Round  62, Train loss: 1.086, Test loss: 0.999, Test accuracy: 90.94
Round  62, Global train loss: 1.086, Global test loss: 0.963, Global test accuracy: 94.58
Round  63, Train loss: 1.025, Test loss: 0.999, Test accuracy: 91.00
Round  63, Global train loss: 1.025, Global test loss: 0.964, Global test accuracy: 94.16
Round  64, Train loss: 0.932, Test loss: 0.999, Test accuracy: 91.00
Round  64, Global train loss: 0.932, Global test loss: 0.971, Global test accuracy: 93.52
Round  65, Train loss: 1.114, Test loss: 0.999, Test accuracy: 90.98
Round  65, Global train loss: 1.114, Global test loss: 0.968, Global test accuracy: 94.00
Round  66, Train loss: 1.028, Test loss: 0.999, Test accuracy: 90.98
Round  66, Global train loss: 1.028, Global test loss: 0.963, Global test accuracy: 94.64
Round  67, Train loss: 1.076, Test loss: 1.000, Test accuracy: 90.82
Round  67, Global train loss: 1.076, Global test loss: 0.958, Global test accuracy: 95.10
Round  68, Train loss: 1.035, Test loss: 0.999, Test accuracy: 90.80
Round  68, Global train loss: 1.035, Global test loss: 0.976, Global test accuracy: 92.94
Round  69, Train loss: 1.075, Test loss: 0.999, Test accuracy: 90.80
Round  69, Global train loss: 1.075, Global test loss: 0.974, Global test accuracy: 93.60
Round  70, Train loss: 1.146, Test loss: 0.999, Test accuracy: 90.82
Round  70, Global train loss: 1.146, Global test loss: 0.983, Global test accuracy: 92.54
Round  71, Train loss: 0.921, Test loss: 0.999, Test accuracy: 90.78
Round  71, Global train loss: 0.921, Global test loss: 0.954, Global test accuracy: 95.42
Round  72, Train loss: 0.999, Test loss: 0.999, Test accuracy: 90.80
Round  72, Global train loss: 0.999, Global test loss: 0.959, Global test accuracy: 95.00
Round  73, Train loss: 1.076, Test loss: 0.999, Test accuracy: 90.92
Round  73, Global train loss: 1.076, Global test loss: 0.955, Global test accuracy: 95.52
Round  74, Train loss: 1.074, Test loss: 0.999, Test accuracy: 90.96
Round  74, Global train loss: 1.074, Global test loss: 0.957, Global test accuracy: 95.20
Round  75, Train loss: 0.993, Test loss: 0.999, Test accuracy: 90.94
Round  75, Global train loss: 0.993, Global test loss: 0.961, Global test accuracy: 94.54
Round  76, Train loss: 1.021, Test loss: 0.999, Test accuracy: 90.96
Round  76, Global train loss: 1.021, Global test loss: 0.980, Global test accuracy: 92.84
Round  77, Train loss: 1.112, Test loss: 0.999, Test accuracy: 90.98
Round  77, Global train loss: 1.112, Global test loss: 0.968, Global test accuracy: 93.98
Round  78, Train loss: 1.100, Test loss: 0.999, Test accuracy: 90.98
Round  78, Global train loss: 1.100, Global test loss: 0.981, Global test accuracy: 92.36
Round  79, Train loss: 0.921, Test loss: 0.999, Test accuracy: 91.02
Round  79, Global train loss: 0.921, Global test loss: 0.954, Global test accuracy: 95.40
Round  80, Train loss: 0.999, Test loss: 0.999, Test accuracy: 90.96
Round  80, Global train loss: 0.999, Global test loss: 0.959, Global test accuracy: 94.92
Round  81, Train loss: 1.022, Test loss: 0.999, Test accuracy: 90.98
Round  81, Global train loss: 1.022, Global test loss: 0.966, Global test accuracy: 93.82
Round  82, Train loss: 1.071, Test loss: 0.999, Test accuracy: 91.04
Round  82, Global train loss: 1.071, Global test loss: 0.967, Global test accuracy: 94.14
Round  83, Train loss: 1.067, Test loss: 1.000, Test accuracy: 90.94
Round  83, Global train loss: 1.067, Global test loss: 0.973, Global test accuracy: 93.38
Round  84, Train loss: 0.985, Test loss: 1.000, Test accuracy: 90.92
Round  84, Global train loss: 0.985, Global test loss: 0.953, Global test accuracy: 95.38
Round  85, Train loss: 1.157, Test loss: 1.000, Test accuracy: 90.92
Round  85, Global train loss: 1.157, Global test loss: 0.975, Global test accuracy: 93.56
Round  86, Train loss: 1.000, Test loss: 0.999, Test accuracy: 90.94
Round  86, Global train loss: 1.000, Global test loss: 0.948, Global test accuracy: 96.10
Round  87, Train loss: 0.995, Test loss: 1.000, Test accuracy: 90.90
Round  87, Global train loss: 0.995, Global test loss: 0.967, Global test accuracy: 94.04
Round  88, Train loss: 1.013, Test loss: 1.000, Test accuracy: 90.90
Round  88, Global train loss: 1.013, Global test loss: 0.956, Global test accuracy: 94.82
Round  89, Train loss: 1.000, Test loss: 1.000, Test accuracy: 90.90
Round  89, Global train loss: 1.000, Global test loss: 0.948, Global test accuracy: 96.04
Round  90, Train loss: 1.072, Test loss: 1.000, Test accuracy: 90.92
Round  90, Global train loss: 1.072, Global test loss: 0.973, Global test accuracy: 93.44
Round  91, Train loss: 1.072, Test loss: 1.000, Test accuracy: 90.86
Round  91, Global train loss: 1.072, Global test loss: 0.973, Global test accuracy: 93.34
Round  92, Train loss: 1.079, Test loss: 1.000, Test accuracy: 90.88
Round  92, Global train loss: 1.079, Global test loss: 0.991, Global test accuracy: 91.64
Round  93, Train loss: 1.102, Test loss: 1.000, Test accuracy: 90.86
Round  93, Global train loss: 1.102, Global test loss: 0.957, Global test accuracy: 95.20
Round  94, Train loss: 1.074, Test loss: 1.000, Test accuracy: 90.92
Round  94, Global train loss: 1.074, Global test loss: 0.956, Global test accuracy: 94.98/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 0.985, Test loss: 0.999, Test accuracy: 90.92
Round  95, Global train loss: 0.985, Global test loss: 0.951, Global test accuracy: 95.54
Round  96, Train loss: 0.985, Test loss: 0.999, Test accuracy: 90.92
Round  96, Global train loss: 0.985, Global test loss: 0.951, Global test accuracy: 95.50
Round  97, Train loss: 0.950, Test loss: 0.999, Test accuracy: 90.92
Round  97, Global train loss: 0.950, Global test loss: 0.954, Global test accuracy: 94.90
Round  98, Train loss: 1.016, Test loss: 0.999, Test accuracy: 90.92
Round  98, Global train loss: 1.016, Global test loss: 0.991, Global test accuracy: 91.50
Round  99, Train loss: 1.026, Test loss: 1.000, Test accuracy: 90.80
Round  99, Global train loss: 1.026, Global test loss: 0.965, Global test accuracy: 94.20
Final Round, Train loss: 1.022, Test loss: 1.000, Test accuracy: 90.76
Final Round, Global train loss: 1.022, Global test loss: 0.965, Global test accuracy: 94.20
Average accuracy final 10 rounds: 90.892 

Average global accuracy final 10 rounds: 94.024 

815.4196255207062
[1.1442222595214844, 2.2884445190429688, 3.364061117172241, 4.439677715301514, 5.664437294006348, 6.889196872711182, 8.089784145355225, 9.290371417999268, 10.443395853042603, 11.596420288085938, 12.723354816436768, 13.850289344787598, 15.042613983154297, 16.234938621520996, 17.281399250030518, 18.32785987854004, 19.375272750854492, 20.422685623168945, 21.51828384399414, 22.613882064819336, 23.708415985107422, 24.802949905395508, 25.99753427505493, 27.192118644714355, 28.223859786987305, 29.255600929260254, 30.381917476654053, 31.50823402404785, 32.63876175880432, 33.76928949356079, 34.780935287475586, 35.79258108139038, 36.87507939338684, 37.9575777053833, 39.01022553443909, 40.06287336349487, 41.268866777420044, 42.474860191345215, 43.60549068450928, 44.73612117767334, 45.858816385269165, 46.98151159286499, 48.08651900291443, 49.19152641296387, 50.261221170425415, 51.33091592788696, 52.41530990600586, 53.499703884124756, 54.519150257110596, 55.538596630096436, 56.82766819000244, 58.11673974990845, 59.207054138183594, 60.29736852645874, 61.25650429725647, 62.2156400680542, 63.34794473648071, 64.48024940490723, 65.60821461677551, 66.7361798286438, 67.78334617614746, 68.83051252365112, 69.84577631950378, 70.86104011535645, 71.96326947212219, 73.06549882888794, 74.11529779434204, 75.16509675979614, 76.24700379371643, 77.32891082763672, 78.31671118736267, 79.30451154708862, 80.31334280967712, 81.32217407226562, 82.79767656326294, 84.27317905426025, 85.39546823501587, 86.51775741577148, 87.52107739448547, 88.52439737319946, 89.66922044754028, 90.8140435218811, 92.01065731048584, 93.20727109909058, 94.3901116847992, 95.57295227050781, 96.69394063949585, 97.81492900848389, 98.8473129272461, 99.8796968460083, 100.92903423309326, 101.97837162017822, 103.08342170715332, 104.18847179412842, 105.2011365890503, 106.21380138397217, 107.277592420578, 108.34138345718384, 109.36500573158264, 110.38862800598145, 111.49713945388794, 112.60565090179443, 113.79530143737793, 114.98495197296143, 116.39930820465088, 117.81366443634033, 119.035391330719, 120.25711822509766, 121.57126140594482, 122.88540458679199, 124.0057384967804, 125.1260724067688, 126.45998859405518, 127.79390478134155, 128.84850668907166, 129.90310859680176, 130.99342250823975, 132.08373641967773, 133.12170934677124, 134.15968227386475, 135.32288432121277, 136.4860863685608, 137.5385227203369, 138.59095907211304, 139.7010419368744, 140.81112480163574, 141.96071696281433, 143.11030912399292, 144.0550079345703, 144.9997067451477, 146.0735149383545, 147.14732313156128, 148.1241660118103, 149.10100889205933, 150.17599964141846, 151.2509903907776, 152.29560685157776, 153.34022331237793, 154.44883966445923, 155.55745601654053, 156.6505525112152, 157.7436490058899, 158.8310832977295, 159.9185175895691, 161.0735788345337, 162.2286400794983, 163.30521368980408, 164.38178730010986, 165.55241417884827, 166.72304105758667, 167.88907265663147, 169.05510425567627, 170.19376754760742, 171.33243083953857, 172.47103834152222, 173.60964584350586, 174.61929488182068, 175.6289439201355, 176.70219922065735, 177.7754545211792, 178.8155677318573, 179.8556809425354, 181.02645301818848, 182.19722509384155, 183.1137592792511, 184.03029346466064, 184.98920559883118, 185.9481177330017, 186.9389147758484, 187.92971181869507, 189.0234022140503, 190.11709260940552, 191.276460647583, 192.4358286857605, 193.5528600215912, 194.66989135742188, 195.7827172279358, 196.8955430984497, 197.9395408630371, 198.9835386276245, 200.07780599594116, 201.1720733642578, 202.17473554611206, 203.1773977279663, 204.3633120059967, 205.5492262840271, 206.71345257759094, 207.87767887115479, 208.88287925720215, 209.8880796432495, 210.97277808189392, 212.05747652053833, 213.1317789554596, 214.20608139038086, 215.24080300331116, 216.27552461624146, 217.27269005775452, 218.26985549926758, 219.7258174419403, 221.18177938461304, 223.7817258834839, 226.38167238235474]
[40.5, 40.5, 68.52, 68.52, 71.5, 71.5, 78.74, 78.74, 82.14, 82.14, 85.02, 85.02, 88.78, 88.78, 90.86, 90.86, 90.96, 90.96, 90.6, 90.6, 90.14, 90.14, 91.4, 91.4, 91.36, 91.36, 91.4, 91.4, 91.6, 91.6, 92.38, 92.38, 92.48, 92.48, 92.58, 92.58, 92.42, 92.42, 92.46, 92.46, 92.48, 92.48, 92.26, 92.26, 92.22, 92.22, 92.24, 92.24, 92.24, 92.24, 92.2, 92.2, 92.14, 92.14, 92.04, 92.04, 91.88, 91.88, 91.76, 91.76, 91.6, 91.6, 91.46, 91.46, 91.48, 91.48, 91.3, 91.3, 91.26, 91.26, 91.24, 91.24, 91.4, 91.4, 91.36, 91.36, 91.36, 91.36, 91.26, 91.26, 91.26, 91.26, 91.28, 91.28, 91.3, 91.3, 91.26, 91.26, 91.22, 91.22, 91.16, 91.16, 91.16, 91.16, 91.24, 91.24, 91.22, 91.22, 91.06, 91.06, 91.16, 91.16, 91.26, 91.26, 91.24, 91.24, 91.16, 91.16, 91.02, 91.02, 91.16, 91.16, 91.1, 91.1, 91.12, 91.12, 91.14, 91.14, 91.06, 91.06, 91.06, 91.06, 91.06, 91.06, 90.94, 90.94, 91.0, 91.0, 91.0, 91.0, 90.98, 90.98, 90.98, 90.98, 90.82, 90.82, 90.8, 90.8, 90.8, 90.8, 90.82, 90.82, 90.78, 90.78, 90.8, 90.8, 90.92, 90.92, 90.96, 90.96, 90.94, 90.94, 90.96, 90.96, 90.98, 90.98, 90.98, 90.98, 91.02, 91.02, 90.96, 90.96, 90.98, 90.98, 91.04, 91.04, 90.94, 90.94, 90.92, 90.92, 90.92, 90.92, 90.94, 90.94, 90.9, 90.9, 90.9, 90.9, 90.9, 90.9, 90.92, 90.92, 90.86, 90.86, 90.88, 90.88, 90.86, 90.86, 90.92, 90.92, 90.92, 90.92, 90.92, 90.92, 90.92, 90.92, 90.92, 90.92, 90.8, 90.8, 90.76, 90.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.590, Test loss: 1.544, Test accuracy: 35.88
Round   0, Global train loss: 1.590, Global test loss: 1.545, Global test accuracy: 35.74
Round   1, Train loss: 1.429, Test loss: 1.338, Test accuracy: 62.24
Round   1, Global train loss: 1.429, Global test loss: 1.249, Global test accuracy: 74.98
Round   2, Train loss: 1.263, Test loss: 1.215, Test accuracy: 72.78
Round   2, Global train loss: 1.263, Global test loss: 1.064, Global test accuracy: 88.16
Round   3, Train loss: 1.008, Test loss: 1.148, Test accuracy: 78.52
Round   3, Global train loss: 1.008, Global test loss: 0.973, Global test accuracy: 95.36
Round   4, Train loss: 1.158, Test loss: 1.050, Test accuracy: 88.06
Round   4, Global train loss: 1.158, Global test loss: 0.965, Global test accuracy: 95.16
Round   5, Train loss: 1.077, Test loss: 1.031, Test accuracy: 89.68
Round   5, Global train loss: 1.077, Global test loss: 0.955, Global test accuracy: 95.96
Round   6, Train loss: 1.059, Test loss: 0.965, Test accuracy: 94.96
Round   6, Global train loss: 1.059, Global test loss: 0.951, Global test accuracy: 96.12
Round   7, Train loss: 1.041, Test loss: 0.960, Test accuracy: 95.20
Round   7, Global train loss: 1.041, Global test loss: 0.950, Global test accuracy: 96.08
Round   8, Train loss: 1.128, Test loss: 0.958, Test accuracy: 95.36
Round   8, Global train loss: 1.128, Global test loss: 0.950, Global test accuracy: 95.98
Round   9, Train loss: 1.028, Test loss: 0.960, Test accuracy: 95.18
Round   9, Global train loss: 1.028, Global test loss: 0.951, Global test accuracy: 95.54
Round  10, Train loss: 1.168, Test loss: 0.954, Test accuracy: 95.46
Round  10, Global train loss: 1.168, Global test loss: 0.949, Global test accuracy: 95.86
Round  11, Train loss: 1.026, Test loss: 0.953, Test accuracy: 95.56
Round  11, Global train loss: 1.026, Global test loss: 0.946, Global test accuracy: 96.18
Round  12, Train loss: 0.934, Test loss: 0.952, Test accuracy: 95.54
Round  12, Global train loss: 0.934, Global test loss: 0.945, Global test accuracy: 96.14
Round  13, Train loss: 1.139, Test loss: 0.951, Test accuracy: 95.60
Round  13, Global train loss: 1.139, Global test loss: 0.949, Global test accuracy: 95.78
Round  14, Train loss: 0.939, Test loss: 0.950, Test accuracy: 95.76
Round  14, Global train loss: 0.939, Global test loss: 0.944, Global test accuracy: 96.16
Round  15, Train loss: 1.040, Test loss: 0.949, Test accuracy: 95.88
Round  15, Global train loss: 1.040, Global test loss: 0.945, Global test accuracy: 96.02
Round  16, Train loss: 1.062, Test loss: 0.948, Test accuracy: 95.98
Round  16, Global train loss: 1.062, Global test loss: 0.944, Global test accuracy: 96.28
Round  17, Train loss: 1.159, Test loss: 0.948, Test accuracy: 95.98
Round  17, Global train loss: 1.159, Global test loss: 0.943, Global test accuracy: 96.36
Round  18, Train loss: 1.135, Test loss: 0.949, Test accuracy: 95.82
Round  18, Global train loss: 1.135, Global test loss: 0.947, Global test accuracy: 95.96
Round  19, Train loss: 1.044, Test loss: 0.947, Test accuracy: 95.90
Round  19, Global train loss: 1.044, Global test loss: 0.942, Global test accuracy: 96.38
Round  20, Train loss: 1.035, Test loss: 0.947, Test accuracy: 95.86
Round  20, Global train loss: 1.035, Global test loss: 0.943, Global test accuracy: 96.18
Round  21, Train loss: 1.127, Test loss: 0.947, Test accuracy: 95.94
Round  21, Global train loss: 1.127, Global test loss: 0.947, Global test accuracy: 96.02
Round  22, Train loss: 1.050, Test loss: 0.947, Test accuracy: 95.98
Round  22, Global train loss: 1.050, Global test loss: 0.945, Global test accuracy: 96.26
Round  23, Train loss: 0.919, Test loss: 0.946, Test accuracy: 96.04
Round  23, Global train loss: 0.919, Global test loss: 0.942, Global test accuracy: 96.32
Round  24, Train loss: 1.051, Test loss: 0.946, Test accuracy: 96.14
Round  24, Global train loss: 1.051, Global test loss: 0.944, Global test accuracy: 96.04
Round  25, Train loss: 0.945, Test loss: 0.946, Test accuracy: 96.12
Round  25, Global train loss: 0.945, Global test loss: 0.941, Global test accuracy: 96.28
Round  26, Train loss: 1.013, Test loss: 0.946, Test accuracy: 96.18
Round  26, Global train loss: 1.013, Global test loss: 0.944, Global test accuracy: 96.30
Round  27, Train loss: 1.051, Test loss: 0.946, Test accuracy: 96.18
Round  27, Global train loss: 1.051, Global test loss: 0.944, Global test accuracy: 96.24
Round  28, Train loss: 1.010, Test loss: 0.946, Test accuracy: 96.06
Round  28, Global train loss: 1.010, Global test loss: 0.944, Global test accuracy: 96.26
Round  29, Train loss: 1.035, Test loss: 0.947, Test accuracy: 95.90
Round  29, Global train loss: 1.035, Global test loss: 0.944, Global test accuracy: 96.24
Round  30, Train loss: 0.923, Test loss: 0.947, Test accuracy: 95.96
Round  30, Global train loss: 0.923, Global test loss: 0.939, Global test accuracy: 96.62
Round  31, Train loss: 1.017, Test loss: 0.946, Test accuracy: 95.96
Round  31, Global train loss: 1.017, Global test loss: 0.942, Global test accuracy: 96.34
Round  32, Train loss: 1.113, Test loss: 0.947, Test accuracy: 95.96
Round  32, Global train loss: 1.113, Global test loss: 0.945, Global test accuracy: 96.16
Round  33, Train loss: 1.032, Test loss: 0.947, Test accuracy: 95.96
Round  33, Global train loss: 1.032, Global test loss: 0.944, Global test accuracy: 96.22
Round  34, Train loss: 1.142, Test loss: 0.946, Test accuracy: 96.00
Round  34, Global train loss: 1.142, Global test loss: 0.947, Global test accuracy: 95.96
Round  35, Train loss: 1.222, Test loss: 0.947, Test accuracy: 96.02
Round  35, Global train loss: 1.222, Global test loss: 0.950, Global test accuracy: 95.74
Round  36, Train loss: 1.033, Test loss: 0.947, Test accuracy: 95.96
Round  36, Global train loss: 1.033, Global test loss: 0.944, Global test accuracy: 96.36
Round  37, Train loss: 1.048, Test loss: 0.947, Test accuracy: 96.02
Round  37, Global train loss: 1.048, Global test loss: 0.945, Global test accuracy: 96.20
Round  38, Train loss: 1.144, Test loss: 0.947, Test accuracy: 96.00
Round  38, Global train loss: 1.144, Global test loss: 0.948, Global test accuracy: 95.96
Round  39, Train loss: 1.111, Test loss: 0.947, Test accuracy: 95.96
Round  39, Global train loss: 1.111, Global test loss: 0.945, Global test accuracy: 96.26
Round  40, Train loss: 1.008, Test loss: 0.947, Test accuracy: 95.94
Round  40, Global train loss: 1.008, Global test loss: 0.943, Global test accuracy: 96.40
Round  41, Train loss: 1.035, Test loss: 0.947, Test accuracy: 95.90
Round  41, Global train loss: 1.035, Global test loss: 0.944, Global test accuracy: 96.16
Round  42, Train loss: 1.038, Test loss: 0.947, Test accuracy: 95.92
Round  42, Global train loss: 1.038, Global test loss: 0.943, Global test accuracy: 96.40
Round  43, Train loss: 0.939, Test loss: 0.947, Test accuracy: 95.94
Round  43, Global train loss: 0.939, Global test loss: 0.939, Global test accuracy: 96.64
Round  44, Train loss: 1.009, Test loss: 0.946, Test accuracy: 95.98
Round  44, Global train loss: 1.009, Global test loss: 0.941, Global test accuracy: 96.50
Round  45, Train loss: 1.119, Test loss: 0.946, Test accuracy: 96.00
Round  45, Global train loss: 1.119, Global test loss: 0.946, Global test accuracy: 96.02
Round  46, Train loss: 1.048, Test loss: 0.946, Test accuracy: 96.00
Round  46, Global train loss: 1.048, Global test loss: 0.944, Global test accuracy: 96.14
Round  47, Train loss: 0.934, Test loss: 0.946, Test accuracy: 96.08
Round  47, Global train loss: 0.934, Global test loss: 0.942, Global test accuracy: 96.44
Round  48, Train loss: 0.933, Test loss: 0.946, Test accuracy: 96.10
Round  48, Global train loss: 0.933, Global test loss: 0.940, Global test accuracy: 96.60
Round  49, Train loss: 1.048, Test loss: 0.945, Test accuracy: 96.16
Round  49, Global train loss: 1.048, Global test loss: 0.943, Global test accuracy: 96.24
Round  50, Train loss: 1.047, Test loss: 0.945, Test accuracy: 96.12
Round  50, Global train loss: 1.047, Global test loss: 0.944, Global test accuracy: 96.14
Round  51, Train loss: 1.009, Test loss: 0.945, Test accuracy: 96.12
Round  51, Global train loss: 1.009, Global test loss: 0.940, Global test accuracy: 96.52
Round  52, Train loss: 1.023, Test loss: 0.945, Test accuracy: 96.22
Round  52, Global train loss: 1.023, Global test loss: 0.944, Global test accuracy: 96.10
Round  53, Train loss: 1.025, Test loss: 0.945, Test accuracy: 96.16
Round  53, Global train loss: 1.025, Global test loss: 0.942, Global test accuracy: 96.18
Round  54, Train loss: 1.015, Test loss: 0.946, Test accuracy: 96.12
Round  54, Global train loss: 1.015, Global test loss: 0.940, Global test accuracy: 96.56
Round  55, Train loss: 1.119, Test loss: 0.945, Test accuracy: 96.18
Round  55, Global train loss: 1.119, Global test loss: 0.945, Global test accuracy: 96.10
Round  56, Train loss: 1.025, Test loss: 0.946, Test accuracy: 96.16
Round  56, Global train loss: 1.025, Global test loss: 0.942, Global test accuracy: 96.34
Round  57, Train loss: 0.912, Test loss: 0.945, Test accuracy: 96.16
Round  57, Global train loss: 0.912, Global test loss: 0.940, Global test accuracy: 96.60
Round  58, Train loss: 0.936, Test loss: 0.945, Test accuracy: 96.18
Round  58, Global train loss: 0.936, Global test loss: 0.939, Global test accuracy: 96.78
Round  59, Train loss: 1.027, Test loss: 0.945, Test accuracy: 96.24
Round  59, Global train loss: 1.027, Global test loss: 0.941, Global test accuracy: 96.34
Round  60, Train loss: 1.031, Test loss: 0.945, Test accuracy: 96.18
Round  60, Global train loss: 1.031, Global test loss: 0.942, Global test accuracy: 96.40
Round  61, Train loss: 0.915, Test loss: 0.945, Test accuracy: 96.18
Round  61, Global train loss: 0.915, Global test loss: 0.938, Global test accuracy: 96.88
Round  62, Train loss: 1.121, Test loss: 0.945, Test accuracy: 96.24
Round  62, Global train loss: 1.121, Global test loss: 0.944, Global test accuracy: 96.16
Round  63, Train loss: 1.028, Test loss: 0.946, Test accuracy: 96.08
Round  63, Global train loss: 1.028, Global test loss: 0.943, Global test accuracy: 96.48
Round  64, Train loss: 1.122, Test loss: 0.946, Test accuracy: 96.06
Round  64, Global train loss: 1.122, Global test loss: 0.945, Global test accuracy: 96.14
Round  65, Train loss: 1.135, Test loss: 0.945, Test accuracy: 96.16
Round  65, Global train loss: 1.135, Global test loss: 0.947, Global test accuracy: 95.84
Round  66, Train loss: 0.930, Test loss: 0.945, Test accuracy: 96.16
Round  66, Global train loss: 0.930, Global test loss: 0.941, Global test accuracy: 96.60
Round  67, Train loss: 1.123, Test loss: 0.945, Test accuracy: 96.16
Round  67, Global train loss: 1.123, Global test loss: 0.943, Global test accuracy: 96.28
Round  68, Train loss: 1.136, Test loss: 0.945, Test accuracy: 96.22
Round  68, Global train loss: 1.136, Global test loss: 0.947, Global test accuracy: 95.98
Round  69, Train loss: 1.023, Test loss: 0.945, Test accuracy: 96.14
Round  69, Global train loss: 1.023, Global test loss: 0.943, Global test accuracy: 96.34
Round  70, Train loss: 1.008, Test loss: 0.945, Test accuracy: 96.16
Round  70, Global train loss: 1.008, Global test loss: 0.940, Global test accuracy: 96.68
Round  71, Train loss: 1.015, Test loss: 0.945, Test accuracy: 96.24
Round  71, Global train loss: 1.015, Global test loss: 0.940, Global test accuracy: 96.50
Round  72, Train loss: 0.915, Test loss: 0.945, Test accuracy: 96.24
Round  72, Global train loss: 0.915, Global test loss: 0.938, Global test accuracy: 96.76
Round  73, Train loss: 1.025, Test loss: 0.945, Test accuracy: 96.24
Round  73, Global train loss: 1.025, Global test loss: 0.943, Global test accuracy: 96.26
Round  74, Train loss: 1.122, Test loss: 0.945, Test accuracy: 96.18
Round  74, Global train loss: 1.122, Global test loss: 0.943, Global test accuracy: 96.18
Round  75, Train loss: 1.111, Test loss: 0.945, Test accuracy: 96.12
Round  75, Global train loss: 1.111, Global test loss: 0.943, Global test accuracy: 96.34
Round  76, Train loss: 1.129, Test loss: 0.946, Test accuracy: 96.10
Round  76, Global train loss: 1.129, Global test loss: 0.950, Global test accuracy: 95.76
Round  77, Train loss: 1.135, Test loss: 0.946, Test accuracy: 96.14
Round  77, Global train loss: 1.135, Global test loss: 0.947, Global test accuracy: 95.80
Round  78, Train loss: 1.026, Test loss: 0.946, Test accuracy: 96.10
Round  78, Global train loss: 1.026, Global test loss: 0.942, Global test accuracy: 96.58
Round  79, Train loss: 1.014, Test loss: 0.946, Test accuracy: 96.06
Round  79, Global train loss: 1.014, Global test loss: 0.941, Global test accuracy: 96.46
Round  80, Train loss: 1.023, Test loss: 0.946, Test accuracy: 96.08
Round  80, Global train loss: 1.023, Global test loss: 0.941, Global test accuracy: 96.42
Round  81, Train loss: 1.125, Test loss: 0.945, Test accuracy: 96.18
Round  81, Global train loss: 1.125, Global test loss: 0.945, Global test accuracy: 96.10
Round  82, Train loss: 1.011, Test loss: 0.945, Test accuracy: 96.20
Round  82, Global train loss: 1.011, Global test loss: 0.940, Global test accuracy: 96.66
Round  83, Train loss: 1.107, Test loss: 0.945, Test accuracy: 96.18
Round  83, Global train loss: 1.107, Global test loss: 0.943, Global test accuracy: 96.34
Round  84, Train loss: 1.012, Test loss: 0.945, Test accuracy: 96.18
Round  84, Global train loss: 1.012, Global test loss: 0.940, Global test accuracy: 96.52
Round  85, Train loss: 1.116, Test loss: 0.945, Test accuracy: 96.16
Round  85, Global train loss: 1.116, Global test loss: 0.945, Global test accuracy: 96.14
Round  86, Train loss: 1.024, Test loss: 0.945, Test accuracy: 96.20
Round  86, Global train loss: 1.024, Global test loss: 0.942, Global test accuracy: 96.26
Round  87, Train loss: 1.122, Test loss: 0.946, Test accuracy: 96.04
Round  87, Global train loss: 1.122, Global test loss: 0.945, Global test accuracy: 96.04
Round  88, Train loss: 1.030, Test loss: 0.946, Test accuracy: 96.02
Round  88, Global train loss: 1.030, Global test loss: 0.941, Global test accuracy: 96.50
Round  89, Train loss: 1.024, Test loss: 0.946, Test accuracy: 96.02
Round  89, Global train loss: 1.024, Global test loss: 0.943, Global test accuracy: 96.22
Round  90, Train loss: 0.911, Test loss: 0.946, Test accuracy: 96.02
Round  90, Global train loss: 0.911, Global test loss: 0.939, Global test accuracy: 96.74
Round  91, Train loss: 0.911, Test loss: 0.945, Test accuracy: 96.06
Round  91, Global train loss: 0.911, Global test loss: 0.938, Global test accuracy: 96.78
Round  92, Train loss: 1.117, Test loss: 0.945, Test accuracy: 96.14
Round  92, Global train loss: 1.117, Global test loss: 0.944, Global test accuracy: 96.18
Round  93, Train loss: 1.039, Test loss: 0.945, Test accuracy: 96.10
Round  93, Global train loss: 1.039, Global test loss: 0.943, Global test accuracy: 96.24
Round  94, Train loss: 1.021, Test loss: 0.945, Test accuracy: 96.12
Round  94, Global train loss: 1.021, Global test loss: 0.941, Global test accuracy: 96.40/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.014, Test loss: 0.945, Test accuracy: 96.10
Round  95, Global train loss: 1.014, Global test loss: 0.940, Global test accuracy: 96.64
Round  96, Train loss: 1.014, Test loss: 0.945, Test accuracy: 96.10
Round  96, Global train loss: 1.014, Global test loss: 0.940, Global test accuracy: 96.62
Round  97, Train loss: 1.028, Test loss: 0.945, Test accuracy: 96.08
Round  97, Global train loss: 1.028, Global test loss: 0.941, Global test accuracy: 96.46
Round  98, Train loss: 1.115, Test loss: 0.945, Test accuracy: 96.12
Round  98, Global train loss: 1.115, Global test loss: 0.945, Global test accuracy: 96.02
Round  99, Train loss: 1.040, Test loss: 0.945, Test accuracy: 96.08
Round  99, Global train loss: 1.040, Global test loss: 0.944, Global test accuracy: 96.22
Final Round, Train loss: 1.041, Test loss: 0.945, Test accuracy: 96.20
Final Round, Global train loss: 1.041, Global test loss: 0.944, Global test accuracy: 96.22
Average accuracy final 10 rounds: 96.09200000000001 

Average global accuracy final 10 rounds: 96.43 

807.0586342811584
[1.2376935482025146, 2.4753870964050293, 3.5098378658294678, 4.544288635253906, 5.610173940658569, 6.676059246063232, 7.7200682163238525, 8.764077186584473, 9.921369075775146, 11.07866096496582, 12.034342765808105, 12.99002456665039, 14.129447221755981, 15.268869876861572, 16.207395315170288, 17.145920753479004, 18.17246675491333, 19.199012756347656, 20.192320823669434, 21.18562889099121, 22.22866654396057, 23.27170419692993, 24.255972623825073, 25.240241050720215, 26.318265914916992, 27.39629077911377, 28.508266925811768, 29.620243072509766, 30.748664140701294, 31.877085208892822, 33.025054693222046, 34.17302417755127, 35.7550630569458, 37.33710193634033, 38.673632860183716, 40.0101637840271, 41.31712222099304, 42.624080657958984, 43.93846821784973, 45.25285577774048, 46.34969162940979, 47.4465274810791, 48.4967679977417, 49.5470085144043, 50.62347364425659, 51.69993877410889, 52.70041799545288, 53.700897216796875, 54.80366921424866, 55.90644121170044, 57.259647846221924, 58.61285448074341, 59.83495259284973, 61.057050704956055, 62.34457731246948, 63.63210391998291, 64.87609720230103, 66.12009048461914, 67.39550280570984, 68.67091512680054, 70.00189781188965, 71.33288049697876, 72.28205394744873, 73.2312273979187, 74.2848973274231, 75.33856725692749, 76.35026168823242, 77.36195611953735, 78.4390037059784, 79.51605129241943, 80.58214044570923, 81.64822959899902, 82.81608057022095, 83.98393154144287, 85.14168500900269, 86.2994384765625, 87.40426683425903, 88.50909519195557, 89.76582765579224, 91.0225601196289, 92.12969326972961, 93.23682641983032, 94.31696939468384, 95.39711236953735, 96.42170739173889, 97.44630241394043, 98.5398941040039, 99.63348579406738, 100.64560914039612, 101.65773248672485, 102.65749406814575, 103.65725564956665, 104.61969780921936, 105.58213996887207, 106.53950214385986, 107.49686431884766, 108.52815103530884, 109.55943775177002, 110.66046500205994, 111.76149225234985, 112.75107026100159, 113.74064826965332, 114.7961094379425, 115.85157060623169, 116.87001419067383, 117.88845777511597, 118.93530893325806, 119.98216009140015, 121.12627029418945, 122.27038049697876, 123.42267775535583, 124.57497501373291, 125.64551544189453, 126.71605587005615, 127.83371472358704, 128.95137357711792, 129.92679929733276, 130.9022250175476, 132.0205364227295, 133.13884782791138, 134.19047784805298, 135.24210786819458, 136.29335236549377, 137.34459686279297, 138.539053440094, 139.73351001739502, 140.7645399570465, 141.795569896698, 142.84137105941772, 143.88717222213745, 144.84836983680725, 145.80956745147705, 146.9651861190796, 148.12080478668213, 149.1533555984497, 150.18590641021729, 151.24877786636353, 152.31164932250977, 153.36272549629211, 154.41380167007446, 155.4474802017212, 156.48115873336792, 157.4956772327423, 158.5101957321167, 159.5291121006012, 160.5480284690857, 161.5954463481903, 162.64286422729492, 163.67637634277344, 164.70988845825195, 165.64659476280212, 166.5833010673523, 167.5873041152954, 168.59130716323853, 170.03589177131653, 171.48047637939453, 172.80709552764893, 174.13371467590332, 175.14876770973206, 176.1638207435608, 177.4463014602661, 178.72878217697144, 180.32920265197754, 181.92962312698364, 183.33615493774414, 184.74268674850464, 185.91095328330994, 187.07921981811523, 188.63818430900574, 190.19714879989624, 191.22344827651978, 192.2497477531433, 193.3128731250763, 194.37599849700928, 195.5163209438324, 196.65664339065552, 197.82658004760742, 198.99651670455933, 200.08571219444275, 201.17490768432617, 202.26461100578308, 203.35431432724, 204.57777333259583, 205.80123233795166, 206.99443364143372, 208.18763494491577, 209.17982625961304, 210.1720175743103, 211.1451370716095, 212.1182565689087, 213.03991150856018, 213.96156644821167, 215.11672616004944, 216.2718858718872, 217.24254751205444, 218.21320915222168, 219.22179055213928, 220.23037195205688, 221.29314947128296, 222.35592699050903, 224.6358277797699, 226.91572856903076]
[35.88, 35.88, 62.24, 62.24, 72.78, 72.78, 78.52, 78.52, 88.06, 88.06, 89.68, 89.68, 94.96, 94.96, 95.2, 95.2, 95.36, 95.36, 95.18, 95.18, 95.46, 95.46, 95.56, 95.56, 95.54, 95.54, 95.6, 95.6, 95.76, 95.76, 95.88, 95.88, 95.98, 95.98, 95.98, 95.98, 95.82, 95.82, 95.9, 95.9, 95.86, 95.86, 95.94, 95.94, 95.98, 95.98, 96.04, 96.04, 96.14, 96.14, 96.12, 96.12, 96.18, 96.18, 96.18, 96.18, 96.06, 96.06, 95.9, 95.9, 95.96, 95.96, 95.96, 95.96, 95.96, 95.96, 95.96, 95.96, 96.0, 96.0, 96.02, 96.02, 95.96, 95.96, 96.02, 96.02, 96.0, 96.0, 95.96, 95.96, 95.94, 95.94, 95.9, 95.9, 95.92, 95.92, 95.94, 95.94, 95.98, 95.98, 96.0, 96.0, 96.0, 96.0, 96.08, 96.08, 96.1, 96.1, 96.16, 96.16, 96.12, 96.12, 96.12, 96.12, 96.22, 96.22, 96.16, 96.16, 96.12, 96.12, 96.18, 96.18, 96.16, 96.16, 96.16, 96.16, 96.18, 96.18, 96.24, 96.24, 96.18, 96.18, 96.18, 96.18, 96.24, 96.24, 96.08, 96.08, 96.06, 96.06, 96.16, 96.16, 96.16, 96.16, 96.16, 96.16, 96.22, 96.22, 96.14, 96.14, 96.16, 96.16, 96.24, 96.24, 96.24, 96.24, 96.24, 96.24, 96.18, 96.18, 96.12, 96.12, 96.1, 96.1, 96.14, 96.14, 96.1, 96.1, 96.06, 96.06, 96.08, 96.08, 96.18, 96.18, 96.2, 96.2, 96.18, 96.18, 96.18, 96.18, 96.16, 96.16, 96.2, 96.2, 96.04, 96.04, 96.02, 96.02, 96.02, 96.02, 96.02, 96.02, 96.06, 96.06, 96.14, 96.14, 96.1, 96.1, 96.12, 96.12, 96.1, 96.1, 96.1, 96.1, 96.08, 96.08, 96.12, 96.12, 96.08, 96.08, 96.2, 96.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.593, Test loss: 1.568, Test accuracy: 57.10
Round   0, Global train loss: 1.593, Global test loss: 1.568, Global test accuracy: 56.96
Round   1, Train loss: 1.519, Test loss: 1.445, Test accuracy: 70.50
Round   1, Global train loss: 1.519, Global test loss: 1.395, Global test accuracy: 83.00
Round   2, Train loss: 1.234, Test loss: 1.256, Test accuracy: 78.50
Round   2, Global train loss: 1.234, Global test loss: 1.051, Global test accuracy: 93.82
Round   3, Train loss: 1.243, Test loss: 1.147, Test accuracy: 86.48
Round   3, Global train loss: 1.243, Global test loss: 0.998, Global test accuracy: 95.16
Round   4, Train loss: 1.086, Test loss: 1.061, Test accuracy: 91.30
Round   4, Global train loss: 1.086, Global test loss: 0.975, Global test accuracy: 95.36
Round   5, Train loss: 1.208, Test loss: 1.044, Test accuracy: 91.58
Round   5, Global train loss: 1.208, Global test loss: 0.963, Global test accuracy: 95.84
Round   6, Train loss: 1.184, Test loss: 0.966, Test accuracy: 95.42
Round   6, Global train loss: 1.184, Global test loss: 0.958, Global test accuracy: 95.84
Round   7, Train loss: 1.054, Test loss: 0.962, Test accuracy: 95.60
Round   7, Global train loss: 1.054, Global test loss: 0.956, Global test accuracy: 96.08
Round   8, Train loss: 1.168, Test loss: 0.959, Test accuracy: 95.74
Round   8, Global train loss: 1.168, Global test loss: 0.954, Global test accuracy: 96.22
Round   9, Train loss: 1.060, Test loss: 0.958, Test accuracy: 95.70
Round   9, Global train loss: 1.060, Global test loss: 0.952, Global test accuracy: 96.08
Round  10, Train loss: 0.942, Test loss: 0.954, Test accuracy: 95.94
Round  10, Global train loss: 0.942, Global test loss: 0.948, Global test accuracy: 96.40
Round  11, Train loss: 1.160, Test loss: 0.952, Test accuracy: 95.98
Round  11, Global train loss: 1.160, Global test loss: 0.949, Global test accuracy: 96.20
Round  12, Train loss: 0.935, Test loss: 0.951, Test accuracy: 96.16
Round  12, Global train loss: 0.935, Global test loss: 0.948, Global test accuracy: 96.30
Round  13, Train loss: 0.928, Test loss: 0.950, Test accuracy: 96.18
Round  13, Global train loss: 0.928, Global test loss: 0.946, Global test accuracy: 96.34
Round  14, Train loss: 1.039, Test loss: 0.950, Test accuracy: 96.18
Round  14, Global train loss: 1.039, Global test loss: 0.947, Global test accuracy: 96.08
Round  15, Train loss: 0.926, Test loss: 0.950, Test accuracy: 96.04
Round  15, Global train loss: 0.926, Global test loss: 0.945, Global test accuracy: 96.42
Round  16, Train loss: 1.062, Test loss: 0.949, Test accuracy: 96.12
Round  16, Global train loss: 1.062, Global test loss: 0.946, Global test accuracy: 96.20
Round  17, Train loss: 1.166, Test loss: 0.949, Test accuracy: 96.24
Round  17, Global train loss: 1.166, Global test loss: 0.946, Global test accuracy: 96.06
Round  18, Train loss: 1.051, Test loss: 0.949, Test accuracy: 96.00
Round  18, Global train loss: 1.051, Global test loss: 0.944, Global test accuracy: 96.46
Round  19, Train loss: 1.029, Test loss: 0.947, Test accuracy: 96.06
Round  19, Global train loss: 1.029, Global test loss: 0.943, Global test accuracy: 96.48
Round  20, Train loss: 0.919, Test loss: 0.947, Test accuracy: 96.14
Round  20, Global train loss: 0.919, Global test loss: 0.943, Global test accuracy: 96.46
Round  21, Train loss: 0.915, Test loss: 0.947, Test accuracy: 96.08
Round  21, Global train loss: 0.915, Global test loss: 0.943, Global test accuracy: 96.42
Round  22, Train loss: 1.050, Test loss: 0.947, Test accuracy: 96.02
Round  22, Global train loss: 1.050, Global test loss: 0.944, Global test accuracy: 96.14
Round  23, Train loss: 1.042, Test loss: 0.945, Test accuracy: 96.22
Round  23, Global train loss: 1.042, Global test loss: 0.942, Global test accuracy: 96.58
Round  24, Train loss: 1.052, Test loss: 0.945, Test accuracy: 96.30
Round  24, Global train loss: 1.052, Global test loss: 0.943, Global test accuracy: 96.32
Round  25, Train loss: 1.160, Test loss: 0.944, Test accuracy: 96.36
Round  25, Global train loss: 1.160, Global test loss: 0.945, Global test accuracy: 95.88
Round  26, Train loss: 0.916, Test loss: 0.944, Test accuracy: 96.36
Round  26, Global train loss: 0.916, Global test loss: 0.943, Global test accuracy: 96.38
Round  27, Train loss: 1.050, Test loss: 0.944, Test accuracy: 96.34
Round  27, Global train loss: 1.050, Global test loss: 0.944, Global test accuracy: 96.14
Round  28, Train loss: 0.915, Test loss: 0.944, Test accuracy: 96.38
Round  28, Global train loss: 0.915, Global test loss: 0.942, Global test accuracy: 96.44
Round  29, Train loss: 0.924, Test loss: 0.944, Test accuracy: 96.34
Round  29, Global train loss: 0.924, Global test loss: 0.942, Global test accuracy: 96.44
Round  30, Train loss: 1.150, Test loss: 0.944, Test accuracy: 96.44
Round  30, Global train loss: 1.150, Global test loss: 0.942, Global test accuracy: 96.54
Round  31, Train loss: 1.026, Test loss: 0.944, Test accuracy: 96.40
Round  31, Global train loss: 1.026, Global test loss: 0.943, Global test accuracy: 96.44
Round  32, Train loss: 1.027, Test loss: 0.944, Test accuracy: 96.38
Round  32, Global train loss: 1.027, Global test loss: 0.943, Global test accuracy: 96.60
Round  33, Train loss: 0.922, Test loss: 0.944, Test accuracy: 96.36
Round  33, Global train loss: 0.922, Global test loss: 0.941, Global test accuracy: 96.56
Round  34, Train loss: 1.052, Test loss: 0.944, Test accuracy: 96.32
Round  34, Global train loss: 1.052, Global test loss: 0.941, Global test accuracy: 96.66
Round  35, Train loss: 1.027, Test loss: 0.944, Test accuracy: 96.46
Round  35, Global train loss: 1.027, Global test loss: 0.942, Global test accuracy: 96.62
Round  36, Train loss: 1.022, Test loss: 0.943, Test accuracy: 96.58
Round  36, Global train loss: 1.022, Global test loss: 0.941, Global test accuracy: 96.66
Round  37, Train loss: 1.051, Test loss: 0.942, Test accuracy: 96.68
Round  37, Global train loss: 1.051, Global test loss: 0.942, Global test accuracy: 96.36
Round  38, Train loss: 1.159, Test loss: 0.942, Test accuracy: 96.66
Round  38, Global train loss: 1.159, Global test loss: 0.944, Global test accuracy: 96.20
Round  39, Train loss: 1.026, Test loss: 0.942, Test accuracy: 96.60
Round  39, Global train loss: 1.026, Global test loss: 0.942, Global test accuracy: 96.60
Round  40, Train loss: 0.914, Test loss: 0.942, Test accuracy: 96.60
Round  40, Global train loss: 0.914, Global test loss: 0.941, Global test accuracy: 96.56
Round  41, Train loss: 1.159, Test loss: 0.943, Test accuracy: 96.60
Round  41, Global train loss: 1.159, Global test loss: 0.945, Global test accuracy: 96.12
Round  42, Train loss: 1.262, Test loss: 0.943, Test accuracy: 96.58
Round  42, Global train loss: 1.262, Global test loss: 0.946, Global test accuracy: 95.90
Round  43, Train loss: 1.278, Test loss: 0.943, Test accuracy: 96.54
Round  43, Global train loss: 1.278, Global test loss: 0.946, Global test accuracy: 96.12
Round  44, Train loss: 0.915, Test loss: 0.943, Test accuracy: 96.52
Round  44, Global train loss: 0.915, Global test loss: 0.942, Global test accuracy: 96.44
Round  45, Train loss: 0.914, Test loss: 0.943, Test accuracy: 96.48
Round  45, Global train loss: 0.914, Global test loss: 0.941, Global test accuracy: 96.64
Round  46, Train loss: 1.151, Test loss: 0.943, Test accuracy: 96.48
Round  46, Global train loss: 1.151, Global test loss: 0.943, Global test accuracy: 96.42
Round  47, Train loss: 1.049, Test loss: 0.943, Test accuracy: 96.54
Round  47, Global train loss: 1.049, Global test loss: 0.943, Global test accuracy: 96.20
Round  48, Train loss: 1.168, Test loss: 0.945, Test accuracy: 96.38
Round  48, Global train loss: 1.168, Global test loss: 0.947, Global test accuracy: 95.98
Round  49, Train loss: 1.150, Test loss: 0.943, Test accuracy: 96.54
Round  49, Global train loss: 1.150, Global test loss: 0.944, Global test accuracy: 96.24
Round  50, Train loss: 1.150, Test loss: 0.943, Test accuracy: 96.52
Round  50, Global train loss: 1.150, Global test loss: 0.944, Global test accuracy: 96.20
Round  51, Train loss: 1.036, Test loss: 0.943, Test accuracy: 96.40
Round  51, Global train loss: 1.036, Global test loss: 0.942, Global test accuracy: 96.50
Round  52, Train loss: 0.913, Test loss: 0.943, Test accuracy: 96.52
Round  52, Global train loss: 0.913, Global test loss: 0.941, Global test accuracy: 96.52
Round  53, Train loss: 1.040, Test loss: 0.943, Test accuracy: 96.46
Round  53, Global train loss: 1.040, Global test loss: 0.941, Global test accuracy: 96.44
Round  54, Train loss: 1.022, Test loss: 0.942, Test accuracy: 96.48
Round  54, Global train loss: 1.022, Global test loss: 0.941, Global test accuracy: 96.54
Round  55, Train loss: 0.917, Test loss: 0.942, Test accuracy: 96.54
Round  55, Global train loss: 0.917, Global test loss: 0.940, Global test accuracy: 96.68
Round  56, Train loss: 1.040, Test loss: 0.942, Test accuracy: 96.64
Round  56, Global train loss: 1.040, Global test loss: 0.940, Global test accuracy: 96.74
Round  57, Train loss: 0.915, Test loss: 0.942, Test accuracy: 96.60
Round  57, Global train loss: 0.915, Global test loss: 0.940, Global test accuracy: 96.66
Round  58, Train loss: 1.152, Test loss: 0.942, Test accuracy: 96.62
Round  58, Global train loss: 1.152, Global test loss: 0.942, Global test accuracy: 96.32
Round  59, Train loss: 1.143, Test loss: 0.942, Test accuracy: 96.50
Round  59, Global train loss: 1.143, Global test loss: 0.943, Global test accuracy: 96.42
Round  60, Train loss: 1.151, Test loss: 0.944, Test accuracy: 96.38
Round  60, Global train loss: 1.151, Global test loss: 0.945, Global test accuracy: 96.04
Round  61, Train loss: 1.039, Test loss: 0.944, Test accuracy: 96.42
Round  61, Global train loss: 1.039, Global test loss: 0.942, Global test accuracy: 96.46
Round  62, Train loss: 1.021, Test loss: 0.944, Test accuracy: 96.42
Round  62, Global train loss: 1.021, Global test loss: 0.942, Global test accuracy: 96.40
Round  63, Train loss: 1.046, Test loss: 0.943, Test accuracy: 96.54
Round  63, Global train loss: 1.046, Global test loss: 0.943, Global test accuracy: 96.24
Round  64, Train loss: 1.020, Test loss: 0.943, Test accuracy: 96.52
Round  64, Global train loss: 1.020, Global test loss: 0.942, Global test accuracy: 96.32
Round  65, Train loss: 1.045, Test loss: 0.943, Test accuracy: 96.44
Round  65, Global train loss: 1.045, Global test loss: 0.942, Global test accuracy: 96.44
Round  66, Train loss: 1.043, Test loss: 0.943, Test accuracy: 96.58
Round  66, Global train loss: 1.043, Global test loss: 0.942, Global test accuracy: 96.34
Round  67, Train loss: 1.145, Test loss: 0.943, Test accuracy: 96.48
Round  67, Global train loss: 1.145, Global test loss: 0.944, Global test accuracy: 96.30
Round  68, Train loss: 1.043, Test loss: 0.945, Test accuracy: 96.18
Round  68, Global train loss: 1.043, Global test loss: 0.943, Global test accuracy: 96.28
Round  69, Train loss: 1.036, Test loss: 0.946, Test accuracy: 96.18
Round  69, Global train loss: 1.036, Global test loss: 0.942, Global test accuracy: 96.32
Round  70, Train loss: 1.037, Test loss: 0.945, Test accuracy: 96.28
Round  70, Global train loss: 1.037, Global test loss: 0.942, Global test accuracy: 96.46
Round  71, Train loss: 1.126, Test loss: 0.945, Test accuracy: 96.22
Round  71, Global train loss: 1.126, Global test loss: 0.944, Global test accuracy: 96.12
Round  72, Train loss: 1.138, Test loss: 0.946, Test accuracy: 96.12
Round  72, Global train loss: 1.138, Global test loss: 0.944, Global test accuracy: 96.20
Round  73, Train loss: 1.021, Test loss: 0.946, Test accuracy: 96.18
Round  73, Global train loss: 1.021, Global test loss: 0.943, Global test accuracy: 96.28
Round  74, Train loss: 1.144, Test loss: 0.945, Test accuracy: 96.24
Round  74, Global train loss: 1.144, Global test loss: 0.943, Global test accuracy: 96.32
Round  75, Train loss: 1.128, Test loss: 0.945, Test accuracy: 96.22
Round  75, Global train loss: 1.128, Global test loss: 0.944, Global test accuracy: 96.06
Round  76, Train loss: 0.912, Test loss: 0.945, Test accuracy: 96.16
Round  76, Global train loss: 0.912, Global test loss: 0.942, Global test accuracy: 96.38
Round  77, Train loss: 1.043, Test loss: 0.943, Test accuracy: 96.46
Round  77, Global train loss: 1.043, Global test loss: 0.942, Global test accuracy: 96.44
Round  78, Train loss: 1.163, Test loss: 0.943, Test accuracy: 96.40
Round  78, Global train loss: 1.163, Global test loss: 0.946, Global test accuracy: 96.20
Round  79, Train loss: 1.125, Test loss: 0.943, Test accuracy: 96.38
Round  79, Global train loss: 1.125, Global test loss: 0.945, Global test accuracy: 96.00
Round  80, Train loss: 1.035, Test loss: 0.943, Test accuracy: 96.40
Round  80, Global train loss: 1.035, Global test loss: 0.942, Global test accuracy: 96.34
Round  81, Train loss: 1.150, Test loss: 0.943, Test accuracy: 96.42
Round  81, Global train loss: 1.150, Global test loss: 0.944, Global test accuracy: 96.20
Round  82, Train loss: 1.140, Test loss: 0.943, Test accuracy: 96.38
Round  82, Global train loss: 1.140, Global test loss: 0.945, Global test accuracy: 96.16
Round  83, Train loss: 1.024, Test loss: 0.943, Test accuracy: 96.32
Round  83, Global train loss: 1.024, Global test loss: 0.943, Global test accuracy: 96.18
Round  84, Train loss: 1.025, Test loss: 0.943, Test accuracy: 96.36
Round  84, Global train loss: 1.025, Global test loss: 0.943, Global test accuracy: 96.24
Round  85, Train loss: 1.035, Test loss: 0.943, Test accuracy: 96.40
Round  85, Global train loss: 1.035, Global test loss: 0.942, Global test accuracy: 96.40
Round  86, Train loss: 1.021, Test loss: 0.943, Test accuracy: 96.44
Round  86, Global train loss: 1.021, Global test loss: 0.943, Global test accuracy: 96.26
Round  87, Train loss: 1.023, Test loss: 0.943, Test accuracy: 96.40
Round  87, Global train loss: 1.023, Global test loss: 0.942, Global test accuracy: 96.34
Round  88, Train loss: 1.151, Test loss: 0.943, Test accuracy: 96.34
Round  88, Global train loss: 1.151, Global test loss: 0.943, Global test accuracy: 96.28
Round  89, Train loss: 1.021, Test loss: 0.943, Test accuracy: 96.30
Round  89, Global train loss: 1.021, Global test loss: 0.943, Global test accuracy: 96.20
Round  90, Train loss: 1.033, Test loss: 0.943, Test accuracy: 96.28
Round  90, Global train loss: 1.033, Global test loss: 0.942, Global test accuracy: 96.40
Round  91, Train loss: 1.033, Test loss: 0.943, Test accuracy: 96.36
Round  91, Global train loss: 1.033, Global test loss: 0.942, Global test accuracy: 96.34
Round  92, Train loss: 0.914, Test loss: 0.942, Test accuracy: 96.38
Round  92, Global train loss: 0.914, Global test loss: 0.941, Global test accuracy: 96.34
Round  93, Train loss: 1.042, Test loss: 0.942, Test accuracy: 96.44
Round  93, Global train loss: 1.042, Global test loss: 0.941, Global test accuracy: 96.54
Round  94, Train loss: 1.036, Test loss: 0.942, Test accuracy: 96.36
Round  94, Global train loss: 1.036, Global test loss: 0.941, Global test accuracy: 96.48/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.247, Test loss: 0.942, Test accuracy: 96.40
Round  95, Global train loss: 1.247, Global test loss: 0.944, Global test accuracy: 96.26
Round  96, Train loss: 1.246, Test loss: 0.942, Test accuracy: 96.46
Round  96, Global train loss: 1.246, Global test loss: 0.945, Global test accuracy: 96.06
Round  97, Train loss: 1.147, Test loss: 0.942, Test accuracy: 96.42
Round  97, Global train loss: 1.147, Global test loss: 0.944, Global test accuracy: 96.02
Round  98, Train loss: 0.911, Test loss: 0.942, Test accuracy: 96.44
Round  98, Global train loss: 0.911, Global test loss: 0.942, Global test accuracy: 96.08
Round  99, Train loss: 1.041, Test loss: 0.942, Test accuracy: 96.46
Round  99, Global train loss: 1.041, Global test loss: 0.941, Global test accuracy: 96.22
Final Round, Train loss: 1.051, Test loss: 0.942, Test accuracy: 96.38
Final Round, Global train loss: 1.051, Global test loss: 0.941, Global test accuracy: 96.22
Average accuracy final 10 rounds: 96.4 

Average global accuracy final 10 rounds: 96.274 

800.3563446998596
[1.1462326049804688, 2.2924652099609375, 3.568756580352783, 4.845047950744629, 6.051686763763428, 7.258325576782227, 8.394812822341919, 9.531300067901611, 10.702573537826538, 11.873847007751465, 12.951244354248047, 14.028641700744629, 15.21341061592102, 16.398179531097412, 17.433603763580322, 18.469027996063232, 19.616831302642822, 20.764634609222412, 22.02685570716858, 23.289076805114746, 24.404008388519287, 25.518939971923828, 26.65172839164734, 27.78451681137085, 28.875919342041016, 29.96732187271118, 31.15964126586914, 32.3519606590271, 33.382810831069946, 34.41366100311279, 35.50382685661316, 36.593992710113525, 37.63591384887695, 38.67783498764038, 39.817084312438965, 40.95633363723755, 42.15031814575195, 43.34430265426636, 44.458001136779785, 45.57169961929321, 46.66377258300781, 47.75584554672241, 48.88231658935547, 50.008787631988525, 51.11715531349182, 52.22552299499512, 53.346346616744995, 54.46717023849487, 55.63945460319519, 56.81173896789551, 57.95610761642456, 59.10047626495361, 60.173420906066895, 61.246365547180176, 62.33352971076965, 63.42069387435913, 64.50472640991211, 65.58875894546509, 66.6390495300293, 67.6893401145935, 68.72374320030212, 69.75814628601074, 70.81117749214172, 71.8642086982727, 72.98787498474121, 74.11154127120972, 75.28857326507568, 76.46560525894165, 77.5471441745758, 78.62868309020996, 79.70896744728088, 80.7892518043518, 81.90982580184937, 83.03039979934692, 84.08274960517883, 85.13509941101074, 86.30376362800598, 87.47242784500122, 88.53148245811462, 89.59053707122803, 90.92625570297241, 92.2619743347168, 93.35524106025696, 94.44850778579712, 95.61788487434387, 96.78726196289062, 97.92620062828064, 99.06513929367065, 100.17220497131348, 101.2792706489563, 102.3586905002594, 103.4381103515625, 104.5070071220398, 105.57590389251709, 106.65254521369934, 107.72918653488159, 108.87713313102722, 110.02507972717285, 111.14630079269409, 112.26752185821533, 113.43744826316833, 114.60737466812134, 115.69436192512512, 116.7813491821289, 117.89316749572754, 119.00498580932617, 120.07063364982605, 121.13628149032593, 122.23981237411499, 123.34334325790405, 124.47829079627991, 125.61323833465576, 126.82394051551819, 128.03464269638062, 129.20822763442993, 130.38181257247925, 131.56631231307983, 132.75081205368042, 133.80192804336548, 134.85304403305054, 136.25304174423218, 137.65303945541382, 138.83689761161804, 140.02075576782227, 141.15459156036377, 142.28842735290527, 143.49524021148682, 144.70205307006836, 145.86316752433777, 147.02428197860718, 148.14145255088806, 149.25862312316895, 150.5621178150177, 151.86561250686646, 153.01342725753784, 154.16124200820923, 155.19653940200806, 156.23183679580688, 157.43805956840515, 158.64428234100342, 159.74572825431824, 160.84717416763306, 161.9175763130188, 162.98797845840454, 164.19387984275818, 165.39978122711182, 166.6278214454651, 167.85586166381836, 168.8531334400177, 169.85040521621704, 171.01359486579895, 172.17678451538086, 173.280357837677, 174.38393115997314, 175.47906947135925, 176.57420778274536, 177.65775799751282, 178.74130821228027, 179.8578279018402, 180.97434759140015, 182.087655544281, 183.20096349716187, 184.26010990142822, 185.31925630569458, 186.38005757331848, 187.44085884094238, 188.46030616760254, 189.4797534942627, 190.57670140266418, 191.67364931106567, 192.73709154129028, 193.8005337715149, 194.93120574951172, 196.06187772750854, 197.19663429260254, 198.33139085769653, 199.42479133605957, 200.5181918144226, 201.71094346046448, 202.90369510650635, 204.07804775238037, 205.2524003982544, 206.33013558387756, 207.40787076950073, 208.68489623069763, 209.96192169189453, 211.171080827713, 212.3802399635315, 213.73427081108093, 215.08830165863037, 216.2655806541443, 217.4428596496582, 218.48351621627808, 219.52417278289795, 220.66514348983765, 221.80611419677734, 222.92371153831482, 224.0413088798523, 225.1230344772339, 226.20476007461548, 228.55853247642517, 230.91230487823486]
[57.1, 57.1, 70.5, 70.5, 78.5, 78.5, 86.48, 86.48, 91.3, 91.3, 91.58, 91.58, 95.42, 95.42, 95.6, 95.6, 95.74, 95.74, 95.7, 95.7, 95.94, 95.94, 95.98, 95.98, 96.16, 96.16, 96.18, 96.18, 96.18, 96.18, 96.04, 96.04, 96.12, 96.12, 96.24, 96.24, 96.0, 96.0, 96.06, 96.06, 96.14, 96.14, 96.08, 96.08, 96.02, 96.02, 96.22, 96.22, 96.3, 96.3, 96.36, 96.36, 96.36, 96.36, 96.34, 96.34, 96.38, 96.38, 96.34, 96.34, 96.44, 96.44, 96.4, 96.4, 96.38, 96.38, 96.36, 96.36, 96.32, 96.32, 96.46, 96.46, 96.58, 96.58, 96.68, 96.68, 96.66, 96.66, 96.6, 96.6, 96.6, 96.6, 96.6, 96.6, 96.58, 96.58, 96.54, 96.54, 96.52, 96.52, 96.48, 96.48, 96.48, 96.48, 96.54, 96.54, 96.38, 96.38, 96.54, 96.54, 96.52, 96.52, 96.4, 96.4, 96.52, 96.52, 96.46, 96.46, 96.48, 96.48, 96.54, 96.54, 96.64, 96.64, 96.6, 96.6, 96.62, 96.62, 96.5, 96.5, 96.38, 96.38, 96.42, 96.42, 96.42, 96.42, 96.54, 96.54, 96.52, 96.52, 96.44, 96.44, 96.58, 96.58, 96.48, 96.48, 96.18, 96.18, 96.18, 96.18, 96.28, 96.28, 96.22, 96.22, 96.12, 96.12, 96.18, 96.18, 96.24, 96.24, 96.22, 96.22, 96.16, 96.16, 96.46, 96.46, 96.4, 96.4, 96.38, 96.38, 96.4, 96.4, 96.42, 96.42, 96.38, 96.38, 96.32, 96.32, 96.36, 96.36, 96.4, 96.4, 96.44, 96.44, 96.4, 96.4, 96.34, 96.34, 96.3, 96.3, 96.28, 96.28, 96.36, 96.36, 96.38, 96.38, 96.44, 96.44, 96.36, 96.36, 96.4, 96.4, 96.46, 96.46, 96.42, 96.42, 96.44, 96.44, 96.46, 96.46, 96.38, 96.38]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.625, Test loss: 1.590, Test accuracy: 50.04
Round   0, Global train loss: 1.625, Global test loss: 1.590, Global test accuracy: 50.38
Round   1, Train loss: 1.574, Test loss: 1.517, Test accuracy: 56.88
Round   1, Global train loss: 1.574, Global test loss: 1.515, Global test accuracy: 55.66
Round   2, Train loss: 1.499, Test loss: 1.379, Test accuracy: 73.94
Round   2, Global train loss: 1.499, Global test loss: 1.365, Global test accuracy: 70.10
Round   3, Train loss: 1.349, Test loss: 1.204, Test accuracy: 90.66
Round   3, Global train loss: 1.349, Global test loss: 1.177, Global test accuracy: 90.92
Round   4, Train loss: 1.192, Test loss: 1.078, Test accuracy: 93.44
Round   4, Global train loss: 1.192, Global test loss: 1.047, Global test accuracy: 94.20
Round   5, Train loss: 1.051, Test loss: 1.024, Test accuracy: 95.16
Round   5, Global train loss: 1.051, Global test loss: 0.996, Global test accuracy: 95.80
Round   6, Train loss: 1.151, Test loss: 1.005, Test accuracy: 95.48
Round   6, Global train loss: 1.151, Global test loss: 1.002, Global test accuracy: 95.70
Round   7, Train loss: 1.227, Test loss: 1.003, Test accuracy: 95.46
Round   7, Global train loss: 1.227, Global test loss: 1.007, Global test accuracy: 95.62
Round   8, Train loss: 1.188, Test loss: 0.999, Test accuracy: 95.76
Round   8, Global train loss: 1.188, Global test loss: 0.991, Global test accuracy: 95.82
Round   9, Train loss: 1.187, Test loss: 0.996, Test accuracy: 95.98
Round   9, Global train loss: 1.187, Global test loss: 0.989, Global test accuracy: 96.16
Round  10, Train loss: 1.099, Test loss: 0.983, Test accuracy: 96.32
Round  10, Global train loss: 1.099, Global test loss: 0.981, Global test accuracy: 96.44
Round  11, Train loss: 1.091, Test loss: 0.979, Test accuracy: 96.26
Round  11, Global train loss: 1.091, Global test loss: 0.973, Global test accuracy: 96.24
Round  12, Train loss: 1.099, Test loss: 0.976, Test accuracy: 96.44
Round  12, Global train loss: 1.099, Global test loss: 0.973, Global test accuracy: 96.28
Round  13, Train loss: 1.180, Test loss: 0.975, Test accuracy: 96.56
Round  13, Global train loss: 1.180, Global test loss: 0.977, Global test accuracy: 96.58
Round  14, Train loss: 1.176, Test loss: 0.977, Test accuracy: 96.58
Round  14, Global train loss: 1.176, Global test loss: 0.971, Global test accuracy: 96.68
Round  15, Train loss: 0.983, Test loss: 0.969, Test accuracy: 96.52
Round  15, Global train loss: 0.983, Global test loss: 0.960, Global test accuracy: 96.70
Round  16, Train loss: 0.976, Test loss: 0.963, Test accuracy: 96.62
Round  16, Global train loss: 0.976, Global test loss: 0.956, Global test accuracy: 96.92
Round  17, Train loss: 1.079, Test loss: 0.961, Test accuracy: 96.68
Round  17, Global train loss: 1.079, Global test loss: 0.957, Global test accuracy: 97.04
Round  18, Train loss: 1.064, Test loss: 0.960, Test accuracy: 96.80
Round  18, Global train loss: 1.064, Global test loss: 0.957, Global test accuracy: 96.90
Round  19, Train loss: 1.163, Test loss: 0.961, Test accuracy: 96.94
Round  19, Global train loss: 1.163, Global test loss: 0.957, Global test accuracy: 97.06
Round  20, Train loss: 0.968, Test loss: 0.961, Test accuracy: 96.88
Round  20, Global train loss: 0.968, Global test loss: 0.952, Global test accuracy: 97.04
Round  21, Train loss: 1.071, Test loss: 0.959, Test accuracy: 96.90
Round  21, Global train loss: 1.071, Global test loss: 0.955, Global test accuracy: 97.14
Round  22, Train loss: 0.980, Test loss: 0.957, Test accuracy: 96.96
Round  22, Global train loss: 0.980, Global test loss: 0.949, Global test accuracy: 97.06
Round  23, Train loss: 1.071, Test loss: 0.958, Test accuracy: 96.92
Round  23, Global train loss: 1.071, Global test loss: 0.952, Global test accuracy: 96.90
Round  24, Train loss: 0.985, Test loss: 0.957, Test accuracy: 96.92
Round  24, Global train loss: 0.985, Global test loss: 0.951, Global test accuracy: 97.02
Round  25, Train loss: 1.176, Test loss: 0.959, Test accuracy: 97.00
Round  25, Global train loss: 1.176, Global test loss: 0.955, Global test accuracy: 97.38
Round  26, Train loss: 1.174, Test loss: 0.966, Test accuracy: 96.86
Round  26, Global train loss: 1.174, Global test loss: 0.971, Global test accuracy: 96.24
Round  27, Train loss: 1.064, Test loss: 0.962, Test accuracy: 97.02
Round  27, Global train loss: 1.064, Global test loss: 0.953, Global test accuracy: 97.50
Round  28, Train loss: 1.171, Test loss: 0.965, Test accuracy: 96.88
Round  28, Global train loss: 1.171, Global test loss: 0.967, Global test accuracy: 96.54
Round  29, Train loss: 1.054, Test loss: 0.961, Test accuracy: 96.94
Round  29, Global train loss: 1.054, Global test loss: 0.955, Global test accuracy: 97.28
Round  30, Train loss: 1.149, Test loss: 0.960, Test accuracy: 97.04
Round  30, Global train loss: 1.149, Global test loss: 0.954, Global test accuracy: 97.26
Round  31, Train loss: 1.168, Test loss: 0.966, Test accuracy: 96.94
Round  31, Global train loss: 1.168, Global test loss: 0.967, Global test accuracy: 96.38
Round  32, Train loss: 1.256, Test loss: 0.968, Test accuracy: 97.04
Round  32, Global train loss: 1.256, Global test loss: 0.973, Global test accuracy: 96.82
Round  33, Train loss: 1.049, Test loss: 0.960, Test accuracy: 97.22
Round  33, Global train loss: 1.049, Global test loss: 0.953, Global test accuracy: 97.44
Round  34, Train loss: 1.064, Test loss: 0.954, Test accuracy: 97.32
Round  34, Global train loss: 1.064, Global test loss: 0.951, Global test accuracy: 97.56
Round  35, Train loss: 1.151, Test loss: 0.957, Test accuracy: 97.18
Round  35, Global train loss: 1.151, Global test loss: 0.959, Global test accuracy: 97.24
Round  36, Train loss: 1.141, Test loss: 0.958, Test accuracy: 97.28
Round  36, Global train loss: 1.141, Global test loss: 0.954, Global test accuracy: 97.34
Round  37, Train loss: 0.954, Test loss: 0.953, Test accuracy: 97.36
Round  37, Global train loss: 0.954, Global test loss: 0.945, Global test accuracy: 97.78
Round  38, Train loss: 1.059, Test loss: 0.951, Test accuracy: 97.36
Round  38, Global train loss: 1.059, Global test loss: 0.948, Global test accuracy: 97.56
Round  39, Train loss: 1.250, Test loss: 0.960, Test accuracy: 97.26
Round  39, Global train loss: 1.250, Global test loss: 0.964, Global test accuracy: 97.32
Round  40, Train loss: 1.156, Test loss: 0.966, Test accuracy: 96.90
Round  40, Global train loss: 1.156, Global test loss: 0.971, Global test accuracy: 96.12
Round  41, Train loss: 1.059, Test loss: 0.959, Test accuracy: 97.20
Round  41, Global train loss: 1.059, Global test loss: 0.954, Global test accuracy: 97.60
Round  42, Train loss: 1.159, Test loss: 0.959, Test accuracy: 97.26
Round  42, Global train loss: 1.159, Global test loss: 0.957, Global test accuracy: 97.56
Round  43, Train loss: 1.054, Test loss: 0.956, Test accuracy: 97.08
Round  43, Global train loss: 1.054, Global test loss: 0.949, Global test accuracy: 97.64
Round  44, Train loss: 1.053, Test loss: 0.954, Test accuracy: 97.20
Round  44, Global train loss: 1.053, Global test loss: 0.953, Global test accuracy: 97.34
Round  45, Train loss: 1.051, Test loss: 0.953, Test accuracy: 97.22
Round  45, Global train loss: 1.051, Global test loss: 0.954, Global test accuracy: 97.28
Round  46, Train loss: 1.048, Test loss: 0.950, Test accuracy: 97.44
Round  46, Global train loss: 1.048, Global test loss: 0.944, Global test accuracy: 97.88
Round  47, Train loss: 1.046, Test loss: 0.951, Test accuracy: 97.38
Round  47, Global train loss: 1.046, Global test loss: 0.944, Global test accuracy: 97.82
Round  48, Train loss: 0.961, Test loss: 0.949, Test accuracy: 97.36
Round  48, Global train loss: 0.961, Global test loss: 0.941, Global test accuracy: 97.86
Round  49, Train loss: 1.045, Test loss: 0.948, Test accuracy: 97.52
Round  49, Global train loss: 1.045, Global test loss: 0.941, Global test accuracy: 97.96
Round  50, Train loss: 1.043, Test loss: 0.949, Test accuracy: 97.40
Round  50, Global train loss: 1.043, Global test loss: 0.941, Global test accuracy: 97.96
Round  51, Train loss: 1.048, Test loss: 0.950, Test accuracy: 97.32
Round  51, Global train loss: 1.048, Global test loss: 0.949, Global test accuracy: 97.42
Round  52, Train loss: 1.041, Test loss: 0.953, Test accuracy: 97.18
Round  52, Global train loss: 1.041, Global test loss: 0.952, Global test accuracy: 96.64
Round  53, Train loss: 1.027, Test loss: 0.949, Test accuracy: 97.36
Round  53, Global train loss: 1.027, Global test loss: 0.943, Global test accuracy: 97.78
Round  54, Train loss: 1.132, Test loss: 0.951, Test accuracy: 97.40
Round  54, Global train loss: 1.132, Global test loss: 0.948, Global test accuracy: 97.86
Round  55, Train loss: 1.028, Test loss: 0.949, Test accuracy: 97.48
Round  55, Global train loss: 1.028, Global test loss: 0.944, Global test accuracy: 97.84
Round  56, Train loss: 0.922, Test loss: 0.945, Test accuracy: 97.38
Round  56, Global train loss: 0.922, Global test loss: 0.937, Global test accuracy: 98.00
Round  57, Train loss: 1.040, Test loss: 0.949, Test accuracy: 97.14
Round  57, Global train loss: 1.040, Global test loss: 0.947, Global test accuracy: 97.10
Round  58, Train loss: 1.143, Test loss: 0.954, Test accuracy: 97.22
Round  58, Global train loss: 1.143, Global test loss: 0.947, Global test accuracy: 97.88
Round  59, Train loss: 1.026, Test loss: 0.950, Test accuracy: 97.24
Round  59, Global train loss: 1.026, Global test loss: 0.943, Global test accuracy: 97.86
Round  60, Train loss: 1.065, Test loss: 0.954, Test accuracy: 96.86
Round  60, Global train loss: 1.065, Global test loss: 0.948, Global test accuracy: 97.78
Round  61, Train loss: 1.018, Test loss: 0.951, Test accuracy: 97.18
Round  61, Global train loss: 1.018, Global test loss: 0.942, Global test accuracy: 97.74
Round  62, Train loss: 1.128, Test loss: 0.951, Test accuracy: 97.18
Round  62, Global train loss: 1.128, Global test loss: 0.949, Global test accuracy: 97.66
Round  63, Train loss: 1.040, Test loss: 0.952, Test accuracy: 97.36
Round  63, Global train loss: 1.040, Global test loss: 0.945, Global test accuracy: 97.70
Round  64, Train loss: 1.044, Test loss: 0.951, Test accuracy: 97.24
Round  64, Global train loss: 1.044, Global test loss: 0.947, Global test accuracy: 97.84
Round  65, Train loss: 1.040, Test loss: 0.950, Test accuracy: 97.30
Round  65, Global train loss: 1.040, Global test loss: 0.944, Global test accuracy: 97.84
Round  66, Train loss: 1.051, Test loss: 0.955, Test accuracy: 96.98
Round  66, Global train loss: 1.051, Global test loss: 0.950, Global test accuracy: 97.30
Round  67, Train loss: 1.028, Test loss: 0.951, Test accuracy: 97.12
Round  67, Global train loss: 1.028, Global test loss: 0.943, Global test accuracy: 97.96
Round  68, Train loss: 1.037, Test loss: 0.952, Test accuracy: 97.06
Round  68, Global train loss: 1.037, Global test loss: 0.945, Global test accuracy: 97.96
Round  69, Train loss: 1.015, Test loss: 0.950, Test accuracy: 97.12
Round  69, Global train loss: 1.015, Global test loss: 0.942, Global test accuracy: 97.90
Round  70, Train loss: 1.113, Test loss: 0.955, Test accuracy: 97.00
Round  70, Global train loss: 1.113, Global test loss: 0.952, Global test accuracy: 97.26
Round  71, Train loss: 1.141, Test loss: 0.961, Test accuracy: 96.68
Round  71, Global train loss: 1.141, Global test loss: 0.960, Global test accuracy: 97.18
Round  72, Train loss: 1.033, Test loss: 0.958, Test accuracy: 96.86
Round  72, Global train loss: 1.033, Global test loss: 0.950, Global test accuracy: 97.08
Round  73, Train loss: 1.114, Test loss: 0.956, Test accuracy: 97.02
Round  73, Global train loss: 1.114, Global test loss: 0.952, Global test accuracy: 97.12
Round  74, Train loss: 1.025, Test loss: 0.953, Test accuracy: 97.16
Round  74, Global train loss: 1.025, Global test loss: 0.945, Global test accuracy: 97.84
Round  75, Train loss: 1.222, Test loss: 0.962, Test accuracy: 96.76
Round  75, Global train loss: 1.222, Global test loss: 0.967, Global test accuracy: 96.96
Round  76, Train loss: 0.936, Test loss: 0.954, Test accuracy: 97.06
Round  76, Global train loss: 0.936, Global test loss: 0.947, Global test accuracy: 97.36
Round  77, Train loss: 1.035, Test loss: 0.951, Test accuracy: 97.14
Round  77, Global train loss: 1.035, Global test loss: 0.944, Global test accuracy: 97.62
Round  78, Train loss: 1.031, Test loss: 0.952, Test accuracy: 97.18
Round  78, Global train loss: 1.031, Global test loss: 0.945, Global test accuracy: 97.68
Round  79, Train loss: 1.134, Test loss: 0.960, Test accuracy: 96.58
Round  79, Global train loss: 1.134, Global test loss: 0.958, Global test accuracy: 97.26
Round  80, Train loss: 0.920, Test loss: 0.950, Test accuracy: 97.24
Round  80, Global train loss: 0.920, Global test loss: 0.938, Global test accuracy: 98.12
Round  81, Train loss: 1.135, Test loss: 0.957, Test accuracy: 96.92
Round  81, Global train loss: 1.135, Global test loss: 0.960, Global test accuracy: 96.84
Round  82, Train loss: 1.109, Test loss: 0.960, Test accuracy: 96.94
Round  82, Global train loss: 1.109, Global test loss: 0.954, Global test accuracy: 97.48
Round  83, Train loss: 1.205, Test loss: 0.975, Test accuracy: 95.98
Round  83, Global train loss: 1.205, Global test loss: 0.983, Global test accuracy: 95.96
Round  84, Train loss: 1.112, Test loss: 0.968, Test accuracy: 96.28
Round  84, Global train loss: 1.112, Global test loss: 0.961, Global test accuracy: 96.94
Round  85, Train loss: 1.012, Test loss: 0.957, Test accuracy: 96.90
Round  85, Global train loss: 1.012, Global test loss: 0.948, Global test accuracy: 97.46
Round  86, Train loss: 1.017, Test loss: 0.951, Test accuracy: 97.16
Round  86, Global train loss: 1.017, Global test loss: 0.942, Global test accuracy: 97.90
Round  87, Train loss: 1.109, Test loss: 0.963, Test accuracy: 96.40
Round  87, Global train loss: 1.109, Global test loss: 0.958, Global test accuracy: 97.28
Round  88, Train loss: 1.121, Test loss: 0.969, Test accuracy: 95.96
Round  88, Global train loss: 1.121, Global test loss: 0.965, Global test accuracy: 96.74
Round  89, Train loss: 1.019, Test loss: 0.954, Test accuracy: 97.06
Round  89, Global train loss: 1.019, Global test loss: 0.944, Global test accuracy: 97.74
Round  90, Train loss: 1.016, Test loss: 0.958, Test accuracy: 96.68
Round  90, Global train loss: 1.016, Global test loss: 0.953, Global test accuracy: 96.98
Round  91, Train loss: 1.011, Test loss: 0.959, Test accuracy: 96.60
Round  91, Global train loss: 1.011, Global test loss: 0.951, Global test accuracy: 97.24/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.094, Test loss: 0.963, Test accuracy: 96.52
Round  92, Global train loss: 1.094, Global test loss: 0.959, Global test accuracy: 97.12
Round  93, Train loss: 1.017, Test loss: 0.959, Test accuracy: 96.58
Round  93, Global train loss: 1.017, Global test loss: 0.949, Global test accuracy: 97.56
Round  94, Train loss: 0.916, Test loss: 0.947, Test accuracy: 97.38
Round  94, Global train loss: 0.916, Global test loss: 0.935, Global test accuracy: 98.08
Round  95, Train loss: 1.113, Test loss: 0.958, Test accuracy: 96.52
Round  95, Global train loss: 1.113, Global test loss: 0.950, Global test accuracy: 97.48
Round  96, Train loss: 1.105, Test loss: 0.968, Test accuracy: 95.82
Round  96, Global train loss: 1.105, Global test loss: 0.959, Global test accuracy: 96.98
Round  97, Train loss: 1.035, Test loss: 0.971, Test accuracy: 95.60
Round  97, Global train loss: 1.035, Global test loss: 0.964, Global test accuracy: 96.30
Round  98, Train loss: 1.019, Test loss: 0.960, Test accuracy: 96.44
Round  98, Global train loss: 1.019, Global test loss: 0.959, Global test accuracy: 96.26
Round  99, Train loss: 1.013, Test loss: 0.959, Test accuracy: 96.56
Round  99, Global train loss: 1.013, Global test loss: 0.949, Global test accuracy: 97.56
Final Round, Train loss: 1.026, Test loss: 0.960, Test accuracy: 96.44
Final Round, Global train loss: 1.026, Global test loss: 0.949, Global test accuracy: 97.56
Average accuracy final 10 rounds: 96.47000000000001
699.8475439548492
[1.4364476203918457, 2.7440826892852783, 4.0807578563690186, 5.520175218582153, 6.79796290397644, 8.131437301635742, 9.386440515518188, 10.711072206497192, 11.934227228164673, 13.312031745910645, 14.471372127532959, 15.717216491699219, 16.989047050476074, 18.202850341796875, 19.42599630355835, 20.888845443725586, 22.09327983856201, 23.449344873428345, 24.687001943588257, 26.00197434425354, 27.314006805419922, 28.67264723777771, 30.4259672164917, 31.71203088760376, 32.94881296157837, 34.308043241500854, 35.667150020599365, 36.87166976928711, 38.29773664474487, 39.5809063911438, 40.76560878753662, 42.0691876411438, 43.26913499832153, 44.45829486846924, 45.66547203063965, 47.120603799819946, 48.547149419784546, 49.83766269683838, 51.20248889923096, 52.3824360370636, 53.754313707351685, 55.130581855773926, 56.30197620391846, 57.47707986831665, 58.84693360328674, 60.04738974571228, 61.31402111053467, 62.6712543964386, 64.00939869880676, 65.31441926956177, 66.47788596153259, 67.9164490699768, 69.14844560623169, 70.40519213676453, 71.68625068664551, 72.89765548706055, 74.09454846382141, 75.33393979072571, 76.55304598808289, 77.84732437133789, 79.2081229686737, 80.35246396064758, 81.94494676589966, 83.17394256591797, 84.44318437576294, 85.72885489463806, 87.04053926467896, 88.39132976531982, 89.70921158790588, 91.08739495277405, 92.34669470787048, 93.6619610786438, 94.95827078819275, 96.21300268173218, 97.64490962028503, 98.86762285232544, 100.3015787601471, 101.76526927947998, 103.03697681427002, 104.32574987411499, 105.68030524253845, 106.97941040992737, 108.34761357307434, 109.60476803779602, 110.83324790000916, 112.06954622268677, 113.3114709854126, 114.7518572807312, 116.02221035957336, 117.36784219741821, 118.60381531715393, 119.92013430595398, 121.12088751792908, 122.43681025505066, 123.71039533615112, 124.99050617218018, 126.20213842391968, 127.52708721160889, 128.80606412887573, 130.06567001342773, 132.3505675792694]
[50.04, 56.88, 73.94, 90.66, 93.44, 95.16, 95.48, 95.46, 95.76, 95.98, 96.32, 96.26, 96.44, 96.56, 96.58, 96.52, 96.62, 96.68, 96.8, 96.94, 96.88, 96.9, 96.96, 96.92, 96.92, 97.0, 96.86, 97.02, 96.88, 96.94, 97.04, 96.94, 97.04, 97.22, 97.32, 97.18, 97.28, 97.36, 97.36, 97.26, 96.9, 97.2, 97.26, 97.08, 97.2, 97.22, 97.44, 97.38, 97.36, 97.52, 97.4, 97.32, 97.18, 97.36, 97.4, 97.48, 97.38, 97.14, 97.22, 97.24, 96.86, 97.18, 97.18, 97.36, 97.24, 97.3, 96.98, 97.12, 97.06, 97.12, 97.0, 96.68, 96.86, 97.02, 97.16, 96.76, 97.06, 97.14, 97.18, 96.58, 97.24, 96.92, 96.94, 95.98, 96.28, 96.9, 97.16, 96.4, 95.96, 97.06, 96.68, 96.6, 96.52, 96.58, 97.38, 96.52, 95.82, 95.6, 96.44, 96.56, 96.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.625, Test loss: 1.593, Test accuracy: 61.90
Round   0, Global train loss: 1.625, Global test loss: 1.593, Global test accuracy: 62.78
Round   1, Train loss: 1.585, Test loss: 1.549, Test accuracy: 75.70
Round   1, Global train loss: 1.585, Global test loss: 1.549, Global test accuracy: 76.90
Round   2, Train loss: 1.507, Test loss: 1.357, Test accuracy: 84.30
Round   2, Global train loss: 1.507, Global test loss: 1.356, Global test accuracy: 85.14
Round   3, Train loss: 1.311, Test loss: 1.124, Test accuracy: 90.96
Round   3, Global train loss: 1.311, Global test loss: 1.114, Global test accuracy: 91.66
Round   4, Train loss: 1.192, Test loss: 1.036, Test accuracy: 94.54
Round   4, Global train loss: 1.192, Global test loss: 1.030, Global test accuracy: 94.72
Round   5, Train loss: 1.158, Test loss: 1.006, Test accuracy: 95.36
Round   5, Global train loss: 1.158, Global test loss: 1.002, Global test accuracy: 95.54
Round   6, Train loss: 1.144, Test loss: 0.992, Test accuracy: 95.66
Round   6, Global train loss: 1.144, Global test loss: 0.989, Global test accuracy: 95.78
Round   7, Train loss: 1.136, Test loss: 0.983, Test accuracy: 95.96
Round   7, Global train loss: 1.136, Global test loss: 0.980, Global test accuracy: 95.98
Round   8, Train loss: 1.130, Test loss: 0.977, Test accuracy: 96.14
Round   8, Global train loss: 1.130, Global test loss: 0.975, Global test accuracy: 96.18
Round   9, Train loss: 1.126, Test loss: 0.973, Test accuracy: 96.38
Round   9, Global train loss: 1.126, Global test loss: 0.970, Global test accuracy: 96.44
Round  10, Train loss: 1.184, Test loss: 0.973, Test accuracy: 96.48
Round  10, Global train loss: 1.184, Global test loss: 0.972, Global test accuracy: 96.42
Round  11, Train loss: 1.061, Test loss: 0.969, Test accuracy: 96.50
Round  11, Global train loss: 1.061, Global test loss: 0.968, Global test accuracy: 96.14
Round  12, Train loss: 1.003, Test loss: 0.965, Test accuracy: 96.46
Round  12, Global train loss: 1.003, Global test loss: 0.961, Global test accuracy: 96.42
Round  13, Train loss: 1.005, Test loss: 0.962, Test accuracy: 96.34
Round  13, Global train loss: 1.005, Global test loss: 0.959, Global test accuracy: 96.38
Round  14, Train loss: 0.983, Test loss: 0.960, Test accuracy: 96.40
Round  14, Global train loss: 0.983, Global test loss: 0.955, Global test accuracy: 96.72
Round  15, Train loss: 0.989, Test loss: 0.958, Test accuracy: 96.50
Round  15, Global train loss: 0.989, Global test loss: 0.954, Global test accuracy: 96.50
Round  16, Train loss: 1.017, Test loss: 0.954, Test accuracy: 96.72
Round  16, Global train loss: 1.017, Global test loss: 0.954, Global test accuracy: 97.04
Round  17, Train loss: 1.053, Test loss: 0.953, Test accuracy: 96.74
Round  17, Global train loss: 1.053, Global test loss: 0.955, Global test accuracy: 96.94
Round  18, Train loss: 1.018, Test loss: 0.955, Test accuracy: 96.86
Round  18, Global train loss: 1.018, Global test loss: 0.953, Global test accuracy: 96.78
Round  19, Train loss: 0.998, Test loss: 0.952, Test accuracy: 96.84
Round  19, Global train loss: 0.998, Global test loss: 0.949, Global test accuracy: 97.16
Round  20, Train loss: 0.983, Test loss: 0.954, Test accuracy: 96.86
Round  20, Global train loss: 0.983, Global test loss: 0.949, Global test accuracy: 96.98
Round  21, Train loss: 0.979, Test loss: 0.953, Test accuracy: 96.86
Round  21, Global train loss: 0.979, Global test loss: 0.949, Global test accuracy: 96.84
Round  22, Train loss: 1.022, Test loss: 0.951, Test accuracy: 96.94
Round  22, Global train loss: 1.022, Global test loss: 0.948, Global test accuracy: 97.10
Round  23, Train loss: 1.028, Test loss: 0.953, Test accuracy: 96.88
Round  23, Global train loss: 1.028, Global test loss: 0.951, Global test accuracy: 96.96
Round  24, Train loss: 1.020, Test loss: 0.952, Test accuracy: 96.92
Round  24, Global train loss: 1.020, Global test loss: 0.951, Global test accuracy: 96.82
Round  25, Train loss: 1.009, Test loss: 0.950, Test accuracy: 97.02
Round  25, Global train loss: 1.009, Global test loss: 0.947, Global test accuracy: 97.44
Round  26, Train loss: 0.977, Test loss: 0.952, Test accuracy: 97.12
Round  26, Global train loss: 0.977, Global test loss: 0.948, Global test accuracy: 97.14
Round  27, Train loss: 1.028, Test loss: 0.950, Test accuracy: 97.28
Round  27, Global train loss: 1.028, Global test loss: 0.946, Global test accuracy: 97.48
Round  28, Train loss: 0.976, Test loss: 0.952, Test accuracy: 97.28
Round  28, Global train loss: 0.976, Global test loss: 0.949, Global test accuracy: 97.34
Round  29, Train loss: 0.985, Test loss: 0.950, Test accuracy: 97.34
Round  29, Global train loss: 0.985, Global test loss: 0.946, Global test accuracy: 97.26
Round  30, Train loss: 1.007, Test loss: 0.948, Test accuracy: 97.32
Round  30, Global train loss: 1.007, Global test loss: 0.944, Global test accuracy: 97.38
Round  31, Train loss: 1.013, Test loss: 0.949, Test accuracy: 97.20
Round  31, Global train loss: 1.013, Global test loss: 0.949, Global test accuracy: 97.14
Round  32, Train loss: 0.997, Test loss: 0.948, Test accuracy: 97.40
Round  32, Global train loss: 0.997, Global test loss: 0.946, Global test accuracy: 97.26
Round  33, Train loss: 0.981, Test loss: 0.948, Test accuracy: 97.42
Round  33, Global train loss: 0.981, Global test loss: 0.945, Global test accuracy: 97.40
Round  34, Train loss: 0.995, Test loss: 0.947, Test accuracy: 97.54
Round  34, Global train loss: 0.995, Global test loss: 0.945, Global test accuracy: 97.72
Round  35, Train loss: 0.990, Test loss: 0.946, Test accuracy: 97.34
Round  35, Global train loss: 0.990, Global test loss: 0.948, Global test accuracy: 97.12
Round  36, Train loss: 0.982, Test loss: 0.945, Test accuracy: 97.46
Round  36, Global train loss: 0.982, Global test loss: 0.940, Global test accuracy: 97.86
Round  37, Train loss: 0.998, Test loss: 0.948, Test accuracy: 97.30
Round  37, Global train loss: 0.998, Global test loss: 0.943, Global test accuracy: 97.68
Round  38, Train loss: 1.032, Test loss: 0.947, Test accuracy: 97.42
Round  38, Global train loss: 1.032, Global test loss: 0.948, Global test accuracy: 97.58
Round  39, Train loss: 0.993, Test loss: 0.946, Test accuracy: 97.54
Round  39, Global train loss: 0.993, Global test loss: 0.943, Global test accuracy: 97.62
Round  40, Train loss: 0.967, Test loss: 0.947, Test accuracy: 97.54
Round  40, Global train loss: 0.967, Global test loss: 0.942, Global test accuracy: 97.64
Round  41, Train loss: 1.010, Test loss: 0.944, Test accuracy: 97.54
Round  41, Global train loss: 1.010, Global test loss: 0.943, Global test accuracy: 97.78
Round  42, Train loss: 1.011, Test loss: 0.944, Test accuracy: 97.72
Round  42, Global train loss: 1.011, Global test loss: 0.942, Global test accuracy: 97.94
Round  43, Train loss: 1.017, Test loss: 0.944, Test accuracy: 97.68
Round  43, Global train loss: 1.017, Global test loss: 0.941, Global test accuracy: 97.88
Round  44, Train loss: 0.942, Test loss: 0.945, Test accuracy: 97.54
Round  44, Global train loss: 0.942, Global test loss: 0.941, Global test accuracy: 97.86
Round  45, Train loss: 0.960, Test loss: 0.944, Test accuracy: 97.48
Round  45, Global train loss: 0.960, Global test loss: 0.945, Global test accuracy: 97.30
Round  46, Train loss: 0.991, Test loss: 0.942, Test accuracy: 97.48
Round  46, Global train loss: 0.991, Global test loss: 0.937, Global test accuracy: 98.16
Round  47, Train loss: 0.991, Test loss: 0.943, Test accuracy: 97.58
Round  47, Global train loss: 0.991, Global test loss: 0.938, Global test accuracy: 98.00
Round  48, Train loss: 1.028, Test loss: 0.945, Test accuracy: 97.56
Round  48, Global train loss: 1.028, Global test loss: 0.941, Global test accuracy: 97.84
Round  49, Train loss: 0.991, Test loss: 0.945, Test accuracy: 97.58
Round  49, Global train loss: 0.991, Global test loss: 0.939, Global test accuracy: 98.04
Round  50, Train loss: 0.988, Test loss: 0.947, Test accuracy: 97.50
Round  50, Global train loss: 0.988, Global test loss: 0.940, Global test accuracy: 97.88
Round  51, Train loss: 0.985, Test loss: 0.944, Test accuracy: 97.62
Round  51, Global train loss: 0.985, Global test loss: 0.940, Global test accuracy: 97.80
Round  52, Train loss: 0.986, Test loss: 0.946, Test accuracy: 97.42
Round  52, Global train loss: 0.986, Global test loss: 0.947, Global test accuracy: 97.02
Round  53, Train loss: 1.010, Test loss: 0.946, Test accuracy: 97.32
Round  53, Global train loss: 1.010, Global test loss: 0.945, Global test accuracy: 97.42
Round  54, Train loss: 0.923, Test loss: 0.944, Test accuracy: 97.34
Round  54, Global train loss: 0.923, Global test loss: 0.936, Global test accuracy: 98.02
Round  55, Train loss: 0.937, Test loss: 0.942, Test accuracy: 97.40
Round  55, Global train loss: 0.937, Global test loss: 0.939, Global test accuracy: 97.66
Round  56, Train loss: 0.981, Test loss: 0.940, Test accuracy: 97.38
Round  56, Global train loss: 0.981, Global test loss: 0.935, Global test accuracy: 98.04
Round  57, Train loss: 0.960, Test loss: 0.942, Test accuracy: 97.40
Round  57, Global train loss: 0.960, Global test loss: 0.939, Global test accuracy: 97.62
Round  58, Train loss: 0.986, Test loss: 0.942, Test accuracy: 97.56
Round  58, Global train loss: 0.986, Global test loss: 0.935, Global test accuracy: 98.08
Round  59, Train loss: 0.981, Test loss: 0.943, Test accuracy: 97.56
Round  59, Global train loss: 0.981, Global test loss: 0.938, Global test accuracy: 97.92
Round  60, Train loss: 1.019, Test loss: 0.944, Test accuracy: 97.58
Round  60, Global train loss: 1.019, Global test loss: 0.942, Global test accuracy: 97.80
Round  61, Train loss: 0.987, Test loss: 0.944, Test accuracy: 97.56
Round  61, Global train loss: 0.987, Global test loss: 0.937, Global test accuracy: 97.94
Round  62, Train loss: 0.936, Test loss: 0.944, Test accuracy: 97.50
Round  62, Global train loss: 0.936, Global test loss: 0.939, Global test accuracy: 97.72
Round  63, Train loss: 0.958, Test loss: 0.940, Test accuracy: 97.70
Round  63, Global train loss: 0.958, Global test loss: 0.933, Global test accuracy: 98.08
Round  64, Train loss: 0.999, Test loss: 0.945, Test accuracy: 97.28
Round  64, Global train loss: 0.999, Global test loss: 0.949, Global test accuracy: 97.08
Round  65, Train loss: 0.975, Test loss: 0.946, Test accuracy: 97.56
Round  65, Global train loss: 0.975, Global test loss: 0.940, Global test accuracy: 97.90
Round  66, Train loss: 0.998, Test loss: 0.950, Test accuracy: 97.30
Round  66, Global train loss: 0.998, Global test loss: 0.943, Global test accuracy: 97.64
Round  67, Train loss: 1.018, Test loss: 0.948, Test accuracy: 97.30
Round  67, Global train loss: 1.018, Global test loss: 0.947, Global test accuracy: 97.68
Round  68, Train loss: 0.980, Test loss: 0.951, Test accuracy: 96.96
Round  68, Global train loss: 0.980, Global test loss: 0.941, Global test accuracy: 97.90
Round  69, Train loss: 1.006, Test loss: 0.950, Test accuracy: 97.12
Round  69, Global train loss: 1.006, Global test loss: 0.946, Global test accuracy: 97.44
Round  70, Train loss: 0.982, Test loss: 0.948, Test accuracy: 97.34
Round  70, Global train loss: 0.982, Global test loss: 0.941, Global test accuracy: 97.68
Round  71, Train loss: 0.973, Test loss: 0.947, Test accuracy: 97.32
Round  71, Global train loss: 0.973, Global test loss: 0.943, Global test accuracy: 97.74
Round  72, Train loss: 0.972, Test loss: 0.946, Test accuracy: 97.34
Round  72, Global train loss: 0.972, Global test loss: 0.938, Global test accuracy: 97.74
Round  73, Train loss: 0.953, Test loss: 0.946, Test accuracy: 97.04
Round  73, Global train loss: 0.953, Global test loss: 0.943, Global test accuracy: 97.34
Round  74, Train loss: 1.011, Test loss: 0.946, Test accuracy: 97.22
Round  74, Global train loss: 1.011, Global test loss: 0.942, Global test accuracy: 97.60
Round  75, Train loss: 0.957, Test loss: 0.945, Test accuracy: 97.26
Round  75, Global train loss: 0.957, Global test loss: 0.939, Global test accuracy: 97.86
Round  76, Train loss: 0.965, Test loss: 0.953, Test accuracy: 96.52
Round  76, Global train loss: 0.965, Global test loss: 0.968, Global test accuracy: 95.12
Round  77, Train loss: 0.968, Test loss: 0.949, Test accuracy: 97.08
Round  77, Global train loss: 0.968, Global test loss: 0.939, Global test accuracy: 97.72
Round  78, Train loss: 0.995, Test loss: 0.946, Test accuracy: 97.26
Round  78, Global train loss: 0.995, Global test loss: 0.939, Global test accuracy: 97.90
Round  79, Train loss: 0.970, Test loss: 0.949, Test accuracy: 97.02
Round  79, Global train loss: 0.970, Global test loss: 0.943, Global test accuracy: 97.74
Round  80, Train loss: 0.949, Test loss: 0.945, Test accuracy: 97.26
Round  80, Global train loss: 0.949, Global test loss: 0.937, Global test accuracy: 97.78
Round  81, Train loss: 0.948, Test loss: 0.944, Test accuracy: 97.14
Round  81, Global train loss: 0.948, Global test loss: 0.936, Global test accuracy: 97.86
Round  82, Train loss: 0.947, Test loss: 0.943, Test accuracy: 97.16
Round  82, Global train loss: 0.947, Global test loss: 0.935, Global test accuracy: 97.80
Round  83, Train loss: 0.946, Test loss: 0.943, Test accuracy: 97.12
Round  83, Global train loss: 0.946, Global test loss: 0.935, Global test accuracy: 97.92
Round  84, Train loss: 0.945, Test loss: 0.943, Test accuracy: 97.10
Round  84, Global train loss: 0.945, Global test loss: 0.935, Global test accuracy: 97.92
Round  85, Train loss: 0.945, Test loss: 0.944, Test accuracy: 97.04
Round  85, Global train loss: 0.945, Global test loss: 0.935, Global test accuracy: 97.76
Round  86, Train loss: 0.944, Test loss: 0.945, Test accuracy: 96.96
Round  86, Global train loss: 0.944, Global test loss: 0.935, Global test accuracy: 97.76
Round  87, Train loss: 0.944, Test loss: 0.945, Test accuracy: 96.96
Round  87, Global train loss: 0.944, Global test loss: 0.936, Global test accuracy: 97.72
Round  88, Train loss: 0.944, Test loss: 0.944, Test accuracy: 97.04
Round  88, Global train loss: 0.944, Global test loss: 0.934, Global test accuracy: 97.78
Round  89, Train loss: 0.943, Test loss: 0.945, Test accuracy: 96.92
Round  89, Global train loss: 0.943, Global test loss: 0.935, Global test accuracy: 97.70
Round  90, Train loss: 0.942, Test loss: 0.945, Test accuracy: 97.04
Round  90, Global train loss: 0.942, Global test loss: 0.934, Global test accuracy: 97.68
Round  91, Train loss: 0.942, Test loss: 0.945, Test accuracy: 97.02
Round  91, Global train loss: 0.942, Global test loss: 0.934, Global test accuracy: 97.68/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 0.941, Test loss: 0.945, Test accuracy: 97.04
Round  92, Global train loss: 0.941, Global test loss: 0.934, Global test accuracy: 97.74
Round  93, Train loss: 0.941, Test loss: 0.945, Test accuracy: 97.00
Round  93, Global train loss: 0.941, Global test loss: 0.934, Global test accuracy: 97.70
Round  94, Train loss: 0.940, Test loss: 0.944, Test accuracy: 97.06
Round  94, Global train loss: 0.940, Global test loss: 0.933, Global test accuracy: 97.80
Round  95, Train loss: 0.940, Test loss: 0.946, Test accuracy: 96.82
Round  95, Global train loss: 0.940, Global test loss: 0.935, Global test accuracy: 97.60
Round  96, Train loss: 0.939, Test loss: 0.945, Test accuracy: 96.98
Round  96, Global train loss: 0.939, Global test loss: 0.934, Global test accuracy: 97.78
Round  97, Train loss: 0.939, Test loss: 0.946, Test accuracy: 96.88
Round  97, Global train loss: 0.939, Global test loss: 0.935, Global test accuracy: 97.60
Round  98, Train loss: 0.938, Test loss: 0.946, Test accuracy: 96.92
Round  98, Global train loss: 0.938, Global test loss: 0.934, Global test accuracy: 97.56
Round  99, Train loss: 0.965, Test loss: 0.951, Test accuracy: 96.62
Round  99, Global train loss: 0.965, Global test loss: 0.937, Global test accuracy: 97.42
Final Round, Train loss: 1.038, Test loss: 0.959, Test accuracy: 95.86
Final Round, Global train loss: 1.038, Global test loss: 0.937, Global test accuracy: 97.42
Average accuracy final 10 rounds: 96.93800000000002
1562.8980300426483
[1.5849733352661133, 3.159273386001587, 4.670977830886841, 6.217014789581299, 7.66912841796875, 9.112497568130493, 10.618265867233276, 12.0923330783844, 13.571958541870117, 15.079272031784058, 19.75165557861328, 27.723841667175293, 35.45799255371094, 43.223695278167725, 51.03608536720276, 59.06626081466675, 67.15754914283752, 75.52956295013428, 76.92402386665344, 85.20587730407715, 93.2850329875946, 101.13373374938965, 109.23534893989563, 117.26680040359497, 125.16034126281738, 133.66223311424255, 141.5373237133026, 149.77288484573364, 158.81431007385254, 167.82810974121094, 176.33731627464294, 184.44124794006348, 192.70291876792908, 201.0369007587433, 209.0334987640381, 216.97961115837097, 224.8777413368225, 232.72605419158936, 240.88352990150452, 249.96396040916443, 257.82622361183167, 266.1120443344116, 274.55906081199646, 282.9312722682953, 284.33155846595764, 285.7085509300232, 294.0611069202423, 302.27042031288147, 310.39668226242065, 318.6199586391449, 327.5754542350769, 329.1242401599884, 337.1657016277313, 345.0184726715088, 346.4230258464813, 347.81870102882385, 349.14949131011963, 357.40278601646423, 365.38497519493103, 366.8247649669647, 374.89525604248047, 382.85648941993713, 384.38641476631165, 392.3230814933777, 400.712598323822, 408.7484459877014, 416.70962285995483, 424.52879643440247, 432.6131410598755, 440.5694122314453, 448.33853578567505, 456.1227204799652, 457.4991948604584, 465.3823471069336, 473.4993200302124, 481.28533411026, 488.9992747306824, 496.96545124053955, 504.8204519748688, 512.7764368057251, 514.2623386383057, 515.8414957523346, 517.3703711032867, 518.7834589481354, 520.3364067077637, 522.0734646320343, 523.4316973686218, 524.8618547916412, 526.2191503047943, 527.6600131988525, 529.00905418396, 530.4295616149902, 531.9027757644653, 533.4932706356049, 534.9084012508392, 536.3168179988861, 537.7393538951874, 539.1924970149994, 540.6278166770935, 548.5366101264954, 556.4192056655884]
[61.9, 75.7, 84.3, 90.96, 94.54, 95.36, 95.66, 95.96, 96.14, 96.38, 96.48, 96.5, 96.46, 96.34, 96.4, 96.5, 96.72, 96.74, 96.86, 96.84, 96.86, 96.86, 96.94, 96.88, 96.92, 97.02, 97.12, 97.28, 97.28, 97.34, 97.32, 97.2, 97.4, 97.42, 97.54, 97.34, 97.46, 97.3, 97.42, 97.54, 97.54, 97.54, 97.72, 97.68, 97.54, 97.48, 97.48, 97.58, 97.56, 97.58, 97.5, 97.62, 97.42, 97.32, 97.34, 97.4, 97.38, 97.4, 97.56, 97.56, 97.58, 97.56, 97.5, 97.7, 97.28, 97.56, 97.3, 97.3, 96.96, 97.12, 97.34, 97.32, 97.34, 97.04, 97.22, 97.26, 96.52, 97.08, 97.26, 97.02, 97.26, 97.14, 97.16, 97.12, 97.1, 97.04, 96.96, 96.96, 97.04, 96.92, 97.04, 97.02, 97.04, 97.0, 97.06, 96.82, 96.98, 96.88, 96.92, 96.62, 95.86]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.588, Test loss: 1.559, Test accuracy: 43.76
Round   0, Global train loss: 1.588, Global test loss: 1.567, Global test accuracy: 45.26
Round   1, Train loss: 1.597, Test loss: 1.552, Test accuracy: 41.68
Round   1, Global train loss: 1.597, Global test loss: 1.569, Global test accuracy: 39.36
Round   2, Train loss: 1.400, Test loss: 1.344, Test accuracy: 65.34
Round   2, Global train loss: 1.400, Global test loss: 1.236, Global test accuracy: 82.56
Round   3, Train loss: 1.567, Test loss: 1.369, Test accuracy: 63.34
Round   3, Global train loss: 1.567, Global test loss: 1.431, Global test accuracy: 65.62
Round   4, Train loss: 1.399, Test loss: 1.326, Test accuracy: 66.30
Round   4, Global train loss: 1.399, Global test loss: 1.262, Global test accuracy: 82.26
Round   5, Train loss: 1.254, Test loss: 1.286, Test accuracy: 67.96
Round   5, Global train loss: 1.254, Global test loss: 1.184, Global test accuracy: 80.92
Round   6, Train loss: 1.549, Test loss: 1.322, Test accuracy: 67.58
Round   6, Global train loss: 1.549, Global test loss: 1.450, Global test accuracy: 64.70
Round   7, Train loss: 1.227, Test loss: 1.246, Test accuracy: 72.34
Round   7, Global train loss: 1.227, Global test loss: 1.100, Global test accuracy: 91.36
Round   8, Train loss: 1.188, Test loss: 1.191, Test accuracy: 75.54
Round   8, Global train loss: 1.188, Global test loss: 1.007, Global test accuracy: 93.54
Round   9, Train loss: 1.322, Test loss: 1.200, Test accuracy: 74.76
Round   9, Global train loss: 1.322, Global test loss: 1.161, Global test accuracy: 87.56
Round  10, Train loss: 1.341, Test loss: 1.177, Test accuracy: 75.94
Round  10, Global train loss: 1.341, Global test loss: 1.253, Global test accuracy: 82.64
Round  11, Train loss: 1.233, Test loss: 1.176, Test accuracy: 75.66
Round  11, Global train loss: 1.233, Global test loss: 1.166, Global test accuracy: 82.26
Round  12, Train loss: 1.139, Test loss: 1.164, Test accuracy: 76.92
Round  12, Global train loss: 1.139, Global test loss: 1.031, Global test accuracy: 93.12
Round  13, Train loss: 1.169, Test loss: 1.159, Test accuracy: 77.40
Round  13, Global train loss: 1.169, Global test loss: 1.068, Global test accuracy: 89.62
Round  14, Train loss: 1.267, Test loss: 1.167, Test accuracy: 76.48
Round  14, Global train loss: 1.267, Global test loss: 1.074, Global test accuracy: 91.28
Round  15, Train loss: 1.312, Test loss: 1.166, Test accuracy: 76.44
Round  15, Global train loss: 1.312, Global test loss: 1.153, Global test accuracy: 82.92
Round  16, Train loss: 1.152, Test loss: 1.166, Test accuracy: 76.20
Round  16, Global train loss: 1.152, Global test loss: 1.080, Global test accuracy: 86.70
Round  17, Train loss: 1.171, Test loss: 1.168, Test accuracy: 76.08
Round  17, Global train loss: 1.171, Global test loss: 1.115, Global test accuracy: 84.60
Round  18, Train loss: 1.258, Test loss: 1.171, Test accuracy: 75.48
Round  18, Global train loss: 1.258, Global test loss: 1.068, Global test accuracy: 90.10
Round  19, Train loss: 1.249, Test loss: 1.167, Test accuracy: 75.36
Round  19, Global train loss: 1.249, Global test loss: 1.090, Global test accuracy: 91.12
Round  20, Train loss: 1.026, Test loss: 1.168, Test accuracy: 75.44
Round  20, Global train loss: 1.026, Global test loss: 1.043, Global test accuracy: 89.52
Round  21, Train loss: 1.085, Test loss: 1.160, Test accuracy: 75.92
Round  21, Global train loss: 1.085, Global test loss: 1.001, Global test accuracy: 94.28
Round  22, Train loss: 1.046, Test loss: 1.160, Test accuracy: 75.74
Round  22, Global train loss: 1.046, Global test loss: 0.975, Global test accuracy: 94.80
Round  23, Train loss: 1.153, Test loss: 1.163, Test accuracy: 74.94
Round  23, Global train loss: 1.153, Global test loss: 1.020, Global test accuracy: 91.66
Round  24, Train loss: 1.094, Test loss: 1.161, Test accuracy: 74.88
Round  24, Global train loss: 1.094, Global test loss: 1.102, Global test accuracy: 85.76
Round  25, Train loss: 1.016, Test loss: 1.160, Test accuracy: 74.90
Round  25, Global train loss: 1.016, Global test loss: 1.042, Global test accuracy: 89.52
Round  26, Train loss: 1.172, Test loss: 1.168, Test accuracy: 73.76
Round  26, Global train loss: 1.172, Global test loss: 1.033, Global test accuracy: 90.94
Round  27, Train loss: 1.028, Test loss: 1.167, Test accuracy: 73.92
Round  27, Global train loss: 1.028, Global test loss: 0.973, Global test accuracy: 94.50
Round  28, Train loss: 1.044, Test loss: 1.164, Test accuracy: 74.40
Round  28, Global train loss: 1.044, Global test loss: 1.028, Global test accuracy: 89.00
Round  29, Train loss: 0.914, Test loss: 1.163, Test accuracy: 74.38
Round  29, Global train loss: 0.914, Global test loss: 0.952, Global test accuracy: 95.80
Round  30, Train loss: 1.202, Test loss: 1.166, Test accuracy: 73.92
Round  30, Global train loss: 1.202, Global test loss: 1.115, Global test accuracy: 79.60
Round  31, Train loss: 0.950, Test loss: 1.165, Test accuracy: 74.02
Round  31, Global train loss: 0.950, Global test loss: 0.978, Global test accuracy: 93.10
Round  32, Train loss: 1.095, Test loss: 1.168, Test accuracy: 73.50
Round  32, Global train loss: 1.095, Global test loss: 1.069, Global test accuracy: 86.00
Round  33, Train loss: 0.997, Test loss: 1.164, Test accuracy: 74.16
Round  33, Global train loss: 0.997, Global test loss: 0.990, Global test accuracy: 93.32
Round  34, Train loss: 0.933, Test loss: 1.164, Test accuracy: 74.08
Round  34, Global train loss: 0.933, Global test loss: 0.957, Global test accuracy: 95.42
Round  35, Train loss: 1.126, Test loss: 1.164, Test accuracy: 73.62
Round  35, Global train loss: 1.126, Global test loss: 1.059, Global test accuracy: 86.90
Round  36, Train loss: 1.017, Test loss: 1.164, Test accuracy: 73.76
Round  36, Global train loss: 1.017, Global test loss: 0.974, Global test accuracy: 93.84
Round  37, Train loss: 1.060, Test loss: 1.165, Test accuracy: 73.76
Round  37, Global train loss: 1.060, Global test loss: 1.053, Global test accuracy: 86.58
Round  38, Train loss: 1.024, Test loss: 1.165, Test accuracy: 73.82
Round  38, Global train loss: 1.024, Global test loss: 0.976, Global test accuracy: 93.88
Round  39, Train loss: 1.009, Test loss: 1.168, Test accuracy: 73.50
Round  39, Global train loss: 1.009, Global test loss: 0.975, Global test accuracy: 93.72
Round  40, Train loss: 0.993, Test loss: 1.172, Test accuracy: 73.20
Round  40, Global train loss: 0.993, Global test loss: 0.974, Global test accuracy: 94.16
Round  41, Train loss: 0.954, Test loss: 1.171, Test accuracy: 73.22
Round  41, Global train loss: 0.954, Global test loss: 0.979, Global test accuracy: 93.82
Round  42, Train loss: 1.067, Test loss: 1.170, Test accuracy: 73.24
Round  42, Global train loss: 1.067, Global test loss: 1.018, Global test accuracy: 89.94
Round  43, Train loss: 1.066, Test loss: 1.174, Test accuracy: 72.90
Round  43, Global train loss: 1.066, Global test loss: 1.016, Global test accuracy: 90.70
Round  44, Train loss: 1.109, Test loss: 1.176, Test accuracy: 71.98
Round  44, Global train loss: 1.109, Global test loss: 1.092, Global test accuracy: 85.50
Round  45, Train loss: 0.999, Test loss: 1.177, Test accuracy: 71.82
Round  45, Global train loss: 0.999, Global test loss: 0.966, Global test accuracy: 94.22
Round  46, Train loss: 0.946, Test loss: 1.177, Test accuracy: 71.70
Round  46, Global train loss: 0.946, Global test loss: 0.982, Global test accuracy: 92.70
Round  47, Train loss: 0.957, Test loss: 1.177, Test accuracy: 71.92
Round  47, Global train loss: 0.957, Global test loss: 0.970, Global test accuracy: 94.92
Round  48, Train loss: 0.927, Test loss: 1.177, Test accuracy: 71.90
Round  48, Global train loss: 0.927, Global test loss: 0.966, Global test accuracy: 94.14
Round  49, Train loss: 0.951, Test loss: 1.178, Test accuracy: 71.92
Round  49, Global train loss: 0.951, Global test loss: 0.962, Global test accuracy: 94.72
Round  50, Train loss: 1.020, Test loss: 1.183, Test accuracy: 71.22
Round  50, Global train loss: 1.020, Global test loss: 1.050, Global test accuracy: 86.24
Round  51, Train loss: 1.060, Test loss: 1.187, Test accuracy: 70.86
Round  51, Global train loss: 1.060, Global test loss: 1.010, Global test accuracy: 91.00
Round  52, Train loss: 1.054, Test loss: 1.182, Test accuracy: 71.58
Round  52, Global train loss: 1.054, Global test loss: 1.002, Global test accuracy: 91.32
Round  53, Train loss: 0.989, Test loss: 1.180, Test accuracy: 71.80
Round  53, Global train loss: 0.989, Global test loss: 1.007, Global test accuracy: 91.66
Round  54, Train loss: 0.965, Test loss: 1.178, Test accuracy: 72.14
Round  54, Global train loss: 0.965, Global test loss: 0.984, Global test accuracy: 92.84
Round  55, Train loss: 1.120, Test loss: 1.184, Test accuracy: 71.40
Round  55, Global train loss: 1.120, Global test loss: 1.132, Global test accuracy: 79.30
Round  56, Train loss: 0.941, Test loss: 1.182, Test accuracy: 71.52
Round  56, Global train loss: 0.941, Global test loss: 0.974, Global test accuracy: 93.28
Round  57, Train loss: 0.982, Test loss: 1.182, Test accuracy: 71.60
Round  57, Global train loss: 0.982, Global test loss: 0.991, Global test accuracy: 93.08
Round  58, Train loss: 1.023, Test loss: 1.181, Test accuracy: 71.70
Round  58, Global train loss: 1.023, Global test loss: 1.000, Global test accuracy: 91.38
Round  59, Train loss: 0.986, Test loss: 1.181, Test accuracy: 71.74
Round  59, Global train loss: 0.986, Global test loss: 0.965, Global test accuracy: 94.52
Round  60, Train loss: 1.009, Test loss: 1.185, Test accuracy: 71.20
Round  60, Global train loss: 1.009, Global test loss: 1.125, Global test accuracy: 81.20
Round  61, Train loss: 1.012, Test loss: 1.181, Test accuracy: 71.60
Round  61, Global train loss: 1.012, Global test loss: 1.014, Global test accuracy: 89.48
Round  62, Train loss: 0.928, Test loss: 1.180, Test accuracy: 71.72
Round  62, Global train loss: 0.928, Global test loss: 0.973, Global test accuracy: 93.94
Round  63, Train loss: 0.957, Test loss: 1.177, Test accuracy: 72.08
Round  63, Global train loss: 0.957, Global test loss: 0.969, Global test accuracy: 94.04
Round  64, Train loss: 0.983, Test loss: 1.177, Test accuracy: 72.12
Round  64, Global train loss: 0.983, Global test loss: 0.999, Global test accuracy: 91.76
Round  65, Train loss: 0.910, Test loss: 1.177, Test accuracy: 72.12
Round  65, Global train loss: 0.910, Global test loss: 0.949, Global test accuracy: 95.74
Round  66, Train loss: 1.027, Test loss: 1.176, Test accuracy: 72.30
Round  66, Global train loss: 1.027, Global test loss: 0.994, Global test accuracy: 92.00
Round  67, Train loss: 1.018, Test loss: 1.181, Test accuracy: 71.74
Round  67, Global train loss: 1.018, Global test loss: 0.999, Global test accuracy: 91.28
Round  68, Train loss: 0.935, Test loss: 1.182, Test accuracy: 71.64
Round  68, Global train loss: 0.935, Global test loss: 0.976, Global test accuracy: 93.14
Round  69, Train loss: 0.980, Test loss: 1.184, Test accuracy: 71.28
Round  69, Global train loss: 0.980, Global test loss: 0.994, Global test accuracy: 92.24
Round  70, Train loss: 1.057, Test loss: 1.186, Test accuracy: 71.06
Round  70, Global train loss: 1.057, Global test loss: 1.004, Global test accuracy: 90.90
Round  71, Train loss: 0.928, Test loss: 1.187, Test accuracy: 71.00
Round  71, Global train loss: 0.928, Global test loss: 0.967, Global test accuracy: 94.34
Round  72, Train loss: 0.948, Test loss: 1.186, Test accuracy: 71.18
Round  72, Global train loss: 0.948, Global test loss: 0.962, Global test accuracy: 94.56
Round  73, Train loss: 0.923, Test loss: 1.186, Test accuracy: 71.20
Round  73, Global train loss: 0.923, Global test loss: 0.963, Global test accuracy: 94.24
Round  74, Train loss: 0.977, Test loss: 1.185, Test accuracy: 71.14
Round  74, Global train loss: 0.977, Global test loss: 1.019, Global test accuracy: 90.18
Round  75, Train loss: 0.935, Test loss: 1.185, Test accuracy: 71.22
Round  75, Global train loss: 0.935, Global test loss: 0.976, Global test accuracy: 93.18
Round  76, Train loss: 0.960, Test loss: 1.185, Test accuracy: 71.30
Round  76, Global train loss: 0.960, Global test loss: 0.981, Global test accuracy: 92.64
Round  77, Train loss: 0.964, Test loss: 1.186, Test accuracy: 71.18
Round  77, Global train loss: 0.964, Global test loss: 0.989, Global test accuracy: 92.26
Round  78, Train loss: 0.977, Test loss: 1.183, Test accuracy: 71.66
Round  78, Global train loss: 0.977, Global test loss: 0.998, Global test accuracy: 91.58
Round  79, Train loss: 0.948, Test loss: 1.183, Test accuracy: 71.56
Round  79, Global train loss: 0.948, Global test loss: 0.962, Global test accuracy: 94.56
Round  80, Train loss: 0.955, Test loss: 1.182, Test accuracy: 71.60
Round  80, Global train loss: 0.955, Global test loss: 0.960, Global test accuracy: 94.72
Round  81, Train loss: 0.993, Test loss: 1.181, Test accuracy: 71.72
Round  81, Global train loss: 0.993, Global test loss: 0.980, Global test accuracy: 92.82
Round  82, Train loss: 0.937, Test loss: 1.183, Test accuracy: 71.42
Round  82, Global train loss: 0.937, Global test loss: 0.970, Global test accuracy: 93.82
Round  83, Train loss: 0.934, Test loss: 1.183, Test accuracy: 71.40
Round  83, Global train loss: 0.934, Global test loss: 0.976, Global test accuracy: 93.08
Round  84, Train loss: 1.008, Test loss: 1.187, Test accuracy: 71.12
Round  84, Global train loss: 1.008, Global test loss: 0.990, Global test accuracy: 92.12
Round  85, Train loss: 1.061, Test loss: 1.187, Test accuracy: 71.26
Round  85, Global train loss: 1.061, Global test loss: 1.176, Global test accuracy: 72.72
Round  86, Train loss: 1.054, Test loss: 1.185, Test accuracy: 71.54
Round  86, Global train loss: 1.054, Global test loss: 1.041, Global test accuracy: 86.82
Round  87, Train loss: 1.008, Test loss: 1.184, Test accuracy: 71.62
Round  87, Global train loss: 1.008, Global test loss: 1.001, Global test accuracy: 90.78
Round  88, Train loss: 1.018, Test loss: 1.185, Test accuracy: 71.46
Round  88, Global train loss: 1.018, Global test loss: 1.024, Global test accuracy: 88.46
Round  89, Train loss: 0.937, Test loss: 1.184, Test accuracy: 71.44
Round  89, Global train loss: 0.937, Global test loss: 0.969, Global test accuracy: 93.82
Round  90, Train loss: 0.920, Test loss: 1.184, Test accuracy: 71.44
Round  90, Global train loss: 0.920, Global test loss: 0.963, Global test accuracy: 94.14
Round  91, Train loss: 0.945, Test loss: 1.186, Test accuracy: 71.28
Round  91, Global train loss: 0.945, Global test loss: 0.966, Global test accuracy: 94.44
Round  92, Train loss: 0.974, Test loss: 1.185, Test accuracy: 71.40
Round  92, Global train loss: 0.974, Global test loss: 0.992, Global test accuracy: 91.96
Round  93, Train loss: 0.962, Test loss: 1.186, Test accuracy: 71.38
Round  93, Global train loss: 0.962, Global test loss: 1.002, Global test accuracy: 91.00
Round  94, Train loss: 0.956, Test loss: 1.186, Test accuracy: 71.38
Round  94, Global train loss: 0.956, Global test loss: 0.983, Global test accuracy: 92.44/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 0.940, Test loss: 1.186, Test accuracy: 71.24
Round  95, Global train loss: 0.940, Global test loss: 0.964, Global test accuracy: 94.58
Round  96, Train loss: 0.991, Test loss: 1.187, Test accuracy: 71.18
Round  96, Global train loss: 0.991, Global test loss: 1.033, Global test accuracy: 87.74
Round  97, Train loss: 0.956, Test loss: 1.186, Test accuracy: 71.24
Round  97, Global train loss: 0.956, Global test loss: 0.983, Global test accuracy: 92.44
Round  98, Train loss: 0.939, Test loss: 1.186, Test accuracy: 71.22
Round  98, Global train loss: 0.939, Global test loss: 0.964, Global test accuracy: 94.66
Round  99, Train loss: 0.984, Test loss: 1.185, Test accuracy: 71.38
Round  99, Global train loss: 0.984, Global test loss: 0.985, Global test accuracy: 91.82
Final Round, Train loss: 0.978, Test loss: 1.186, Test accuracy: 71.30
Final Round, Global train loss: 0.978, Global test loss: 0.985, Global test accuracy: 91.82
Average accuracy final 10 rounds: 71.31400000000001 

Average global accuracy final 10 rounds: 92.52199999999999 

797.7791392803192
[1.2967798709869385, 2.593559741973877, 3.7215094566345215, 4.849459171295166, 5.910945892333984, 6.972432613372803, 8.075764179229736, 9.17909574508667, 10.19757628440857, 11.216056823730469, 12.207533121109009, 13.199009418487549, 14.22829532623291, 15.257581233978271, 16.25885796546936, 17.26013469696045, 18.542284965515137, 19.824435234069824, 20.883071184158325, 21.941707134246826, 23.062908411026, 24.184109687805176, 25.211856603622437, 26.239603519439697, 27.25442600250244, 28.269248485565186, 29.246718645095825, 30.224188804626465, 31.22083854675293, 32.217488288879395, 33.280399799346924, 34.34331130981445, 35.263041734695435, 36.182772159576416, 37.18783926963806, 38.19290637969971, 39.49718141555786, 40.801456451416016, 41.968173027038574, 43.13488960266113, 44.24811553955078, 45.36134147644043, 46.366976737976074, 47.37261199951172, 48.443960428237915, 49.51530885696411, 50.66595983505249, 51.81661081314087, 52.908777475357056, 54.00094413757324, 55.05002951622009, 56.09911489486694, 57.08930063247681, 58.07948637008667, 59.10455656051636, 60.129626750946045, 61.239500999450684, 62.34937524795532, 63.375791788101196, 64.40220832824707, 65.41115832328796, 66.42010831832886, 67.88962531089783, 69.3591423034668, 70.48185729980469, 71.60457229614258, 72.58768677711487, 73.57080125808716, 74.61677241325378, 75.66274356842041, 76.68947219848633, 77.71620082855225, 78.86894202232361, 80.02168321609497, 81.06767416000366, 82.11366510391235, 83.24753332138062, 84.38140153884888, 85.51092743873596, 86.64045333862305, 87.70476627349854, 88.76907920837402, 89.80505132675171, 90.8410234451294, 91.81827998161316, 92.79553651809692, 93.7822482585907, 94.76895999908447, 95.76743721961975, 96.76591444015503, 97.88870120048523, 99.01148796081543, 100.00008034706116, 100.98867273330688, 101.96959066390991, 102.95050859451294, 103.96921491622925, 104.98792123794556, 106.0956404209137, 107.20335960388184, 108.35771703720093, 109.51207447052002, 110.73193454742432, 111.95179462432861, 112.99456262588501, 114.0373306274414, 115.18771362304688, 116.33809661865234, 117.83780980110168, 119.33752298355103, 120.53474378585815, 121.73196458816528, 123.10234570503235, 124.47272682189941, 125.70010662078857, 126.92748641967773, 128.12078285217285, 129.31407928466797, 130.27667665481567, 131.23927402496338, 132.2752287387848, 133.3111834526062, 134.28096437454224, 135.25074529647827, 136.30940747261047, 137.36806964874268, 138.48439025878906, 139.60071086883545, 140.6780982017517, 141.75548553466797, 142.8739309310913, 143.99237632751465, 145.05985832214355, 146.12734031677246, 147.19859504699707, 148.26984977722168, 149.38796615600586, 150.50608253479004, 151.60263299942017, 152.6991834640503, 153.74662852287292, 154.79407358169556, 155.91215419769287, 157.03023481369019, 158.0060293674469, 158.9818239212036, 160.1014986038208, 161.221173286438, 162.36816096305847, 163.51514863967896, 164.57758498191833, 165.64002132415771, 166.60791659355164, 167.57581186294556, 168.7250566482544, 169.87430143356323, 170.9343876838684, 171.99447393417358, 173.08352828025818, 174.17258262634277, 175.24931836128235, 176.32605409622192, 177.33389163017273, 178.34172916412354, 179.41385793685913, 180.48598670959473, 181.57419538497925, 182.66240406036377, 183.72149777412415, 184.78059148788452, 185.88553309440613, 186.99047470092773, 188.09600353240967, 189.2015323638916, 190.31858849525452, 191.43564462661743, 192.55780601501465, 193.67996740341187, 194.8048074245453, 195.9296474456787, 196.87381291389465, 197.8179783821106, 198.916606426239, 200.01523447036743, 200.99668192863464, 201.97812938690186, 202.97297310829163, 203.9678168296814, 205.07327151298523, 206.17872619628906, 207.14326167106628, 208.1077971458435, 209.19776487350464, 210.28773260116577, 211.24647617340088, 212.205219745636, 213.33125257492065, 214.45728540420532, 215.61844205856323, 216.77959871292114, 219.00297832489014, 221.22635793685913]
[43.76, 43.76, 41.68, 41.68, 65.34, 65.34, 63.34, 63.34, 66.3, 66.3, 67.96, 67.96, 67.58, 67.58, 72.34, 72.34, 75.54, 75.54, 74.76, 74.76, 75.94, 75.94, 75.66, 75.66, 76.92, 76.92, 77.4, 77.4, 76.48, 76.48, 76.44, 76.44, 76.2, 76.2, 76.08, 76.08, 75.48, 75.48, 75.36, 75.36, 75.44, 75.44, 75.92, 75.92, 75.74, 75.74, 74.94, 74.94, 74.88, 74.88, 74.9, 74.9, 73.76, 73.76, 73.92, 73.92, 74.4, 74.4, 74.38, 74.38, 73.92, 73.92, 74.02, 74.02, 73.5, 73.5, 74.16, 74.16, 74.08, 74.08, 73.62, 73.62, 73.76, 73.76, 73.76, 73.76, 73.82, 73.82, 73.5, 73.5, 73.2, 73.2, 73.22, 73.22, 73.24, 73.24, 72.9, 72.9, 71.98, 71.98, 71.82, 71.82, 71.7, 71.7, 71.92, 71.92, 71.9, 71.9, 71.92, 71.92, 71.22, 71.22, 70.86, 70.86, 71.58, 71.58, 71.8, 71.8, 72.14, 72.14, 71.4, 71.4, 71.52, 71.52, 71.6, 71.6, 71.7, 71.7, 71.74, 71.74, 71.2, 71.2, 71.6, 71.6, 71.72, 71.72, 72.08, 72.08, 72.12, 72.12, 72.12, 72.12, 72.3, 72.3, 71.74, 71.74, 71.64, 71.64, 71.28, 71.28, 71.06, 71.06, 71.0, 71.0, 71.18, 71.18, 71.2, 71.2, 71.14, 71.14, 71.22, 71.22, 71.3, 71.3, 71.18, 71.18, 71.66, 71.66, 71.56, 71.56, 71.6, 71.6, 71.72, 71.72, 71.42, 71.42, 71.4, 71.4, 71.12, 71.12, 71.26, 71.26, 71.54, 71.54, 71.62, 71.62, 71.46, 71.46, 71.44, 71.44, 71.44, 71.44, 71.28, 71.28, 71.4, 71.4, 71.38, 71.38, 71.38, 71.38, 71.24, 71.24, 71.18, 71.18, 71.24, 71.24, 71.22, 71.22, 71.38, 71.38, 71.3, 71.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.596, Test loss: 1.578, Test accuracy: 47.94
Round   0, Global train loss: 1.596, Global test loss: 1.582, Global test accuracy: 51.58
Round   1, Train loss: 1.545, Test loss: 1.484, Test accuracy: 56.18
Round   1, Global train loss: 1.545, Global test loss: 1.475, Global test accuracy: 61.78
Round   2, Train loss: 1.222, Test loss: 1.249, Test accuracy: 71.24
Round   2, Global train loss: 1.222, Global test loss: 1.089, Global test accuracy: 87.56
Round   3, Train loss: 1.353, Test loss: 1.134, Test accuracy: 81.94
Round   3, Global train loss: 1.353, Global test loss: 1.014, Global test accuracy: 94.22
Round   4, Train loss: 0.971, Test loss: 1.086, Test accuracy: 84.68
Round   4, Global train loss: 0.971, Global test loss: 0.967, Global test accuracy: 95.46
Round   5, Train loss: 1.185, Test loss: 1.060, Test accuracy: 86.52
Round   5, Global train loss: 1.185, Global test loss: 0.977, Global test accuracy: 94.36
Round   6, Train loss: 1.340, Test loss: 1.054, Test accuracy: 86.28
Round   6, Global train loss: 1.340, Global test loss: 0.970, Global test accuracy: 94.62
Round   7, Train loss: 0.983, Test loss: 1.060, Test accuracy: 85.50
Round   7, Global train loss: 0.983, Global test loss: 0.966, Global test accuracy: 94.88
Round   8, Train loss: 1.150, Test loss: 0.995, Test accuracy: 91.72
Round   8, Global train loss: 1.150, Global test loss: 0.956, Global test accuracy: 95.70
Round   9, Train loss: 1.328, Test loss: 0.992, Test accuracy: 92.00
Round   9, Global train loss: 1.328, Global test loss: 0.961, Global test accuracy: 95.10
Round  10, Train loss: 1.333, Test loss: 0.998, Test accuracy: 91.46
Round  10, Global train loss: 1.333, Global test loss: 0.967, Global test accuracy: 94.54
Round  11, Train loss: 1.166, Test loss: 0.990, Test accuracy: 92.24
Round  11, Global train loss: 1.166, Global test loss: 0.966, Global test accuracy: 94.96
Round  12, Train loss: 0.967, Test loss: 0.986, Test accuracy: 92.72
Round  12, Global train loss: 0.967, Global test loss: 0.958, Global test accuracy: 95.40
Round  13, Train loss: 1.318, Test loss: 0.983, Test accuracy: 92.86
Round  13, Global train loss: 1.318, Global test loss: 0.964, Global test accuracy: 94.64
Round  14, Train loss: 1.126, Test loss: 0.984, Test accuracy: 92.76
Round  14, Global train loss: 1.126, Global test loss: 0.956, Global test accuracy: 95.36
Round  15, Train loss: 1.310, Test loss: 0.994, Test accuracy: 91.68
Round  15, Global train loss: 1.310, Global test loss: 0.962, Global test accuracy: 94.76
Round  16, Train loss: 1.353, Test loss: 0.990, Test accuracy: 91.94
Round  16, Global train loss: 1.353, Global test loss: 0.965, Global test accuracy: 94.56
Round  17, Train loss: 1.146, Test loss: 0.992, Test accuracy: 91.84
Round  17, Global train loss: 1.146, Global test loss: 0.972, Global test accuracy: 93.88
Round  18, Train loss: 1.117, Test loss: 0.991, Test accuracy: 91.86
Round  18, Global train loss: 1.117, Global test loss: 0.960, Global test accuracy: 94.64
Round  19, Train loss: 1.144, Test loss: 0.990, Test accuracy: 92.00
Round  19, Global train loss: 1.144, Global test loss: 0.968, Global test accuracy: 94.02
Round  20, Train loss: 0.960, Test loss: 0.988, Test accuracy: 92.12
Round  20, Global train loss: 0.960, Global test loss: 0.955, Global test accuracy: 95.38
Round  21, Train loss: 1.167, Test loss: 0.987, Test accuracy: 92.16
Round  21, Global train loss: 1.167, Global test loss: 0.958, Global test accuracy: 94.96
Round  22, Train loss: 1.305, Test loss: 0.987, Test accuracy: 92.14
Round  22, Global train loss: 1.305, Global test loss: 0.967, Global test accuracy: 93.90
Round  23, Train loss: 1.306, Test loss: 0.987, Test accuracy: 92.08
Round  23, Global train loss: 1.306, Global test loss: 0.961, Global test accuracy: 94.74
Round  24, Train loss: 1.359, Test loss: 0.990, Test accuracy: 91.94
Round  24, Global train loss: 1.359, Global test loss: 0.980, Global test accuracy: 92.92
Round  25, Train loss: 1.164, Test loss: 0.993, Test accuracy: 91.52
Round  25, Global train loss: 1.164, Global test loss: 0.976, Global test accuracy: 93.42
Round  26, Train loss: 0.922, Test loss: 0.994, Test accuracy: 91.42
Round  26, Global train loss: 0.922, Global test loss: 0.950, Global test accuracy: 95.96
Round  27, Train loss: 1.328, Test loss: 0.995, Test accuracy: 91.24
Round  27, Global train loss: 1.328, Global test loss: 0.983, Global test accuracy: 92.46
Round  28, Train loss: 1.109, Test loss: 0.994, Test accuracy: 91.30
Round  28, Global train loss: 1.109, Global test loss: 0.964, Global test accuracy: 94.50
Round  29, Train loss: 1.322, Test loss: 0.992, Test accuracy: 91.64
Round  29, Global train loss: 1.322, Global test loss: 0.965, Global test accuracy: 94.46
Round  30, Train loss: 1.104, Test loss: 0.996, Test accuracy: 91.10
Round  30, Global train loss: 1.104, Global test loss: 0.958, Global test accuracy: 95.16
Round  31, Train loss: 1.106, Test loss: 0.995, Test accuracy: 91.14
Round  31, Global train loss: 1.106, Global test loss: 0.959, Global test accuracy: 94.88
Round  32, Train loss: 1.145, Test loss: 0.997, Test accuracy: 90.94
Round  32, Global train loss: 1.145, Global test loss: 0.959, Global test accuracy: 94.92
Round  33, Train loss: 0.948, Test loss: 0.997, Test accuracy: 90.90
Round  33, Global train loss: 0.948, Global test loss: 0.956, Global test accuracy: 95.06
Round  34, Train loss: 1.153, Test loss: 1.000, Test accuracy: 90.64
Round  34, Global train loss: 1.153, Global test loss: 0.959, Global test accuracy: 94.82
Round  35, Train loss: 1.099, Test loss: 1.001, Test accuracy: 90.52
Round  35, Global train loss: 1.099, Global test loss: 0.961, Global test accuracy: 94.94
Round  36, Train loss: 1.312, Test loss: 0.999, Test accuracy: 90.78
Round  36, Global train loss: 1.312, Global test loss: 0.962, Global test accuracy: 94.78
Round  37, Train loss: 1.139, Test loss: 1.000, Test accuracy: 90.68
Round  37, Global train loss: 1.139, Global test loss: 0.959, Global test accuracy: 94.74
Round  38, Train loss: 1.146, Test loss: 0.999, Test accuracy: 90.74
Round  38, Global train loss: 1.146, Global test loss: 0.961, Global test accuracy: 94.70
Round  39, Train loss: 0.942, Test loss: 0.999, Test accuracy: 90.64
Round  39, Global train loss: 0.942, Global test loss: 0.956, Global test accuracy: 95.02
Round  40, Train loss: 1.092, Test loss: 0.999, Test accuracy: 90.72
Round  40, Global train loss: 1.092, Global test loss: 0.961, Global test accuracy: 94.72
Round  41, Train loss: 1.341, Test loss: 0.995, Test accuracy: 91.00
Round  41, Global train loss: 1.341, Global test loss: 0.976, Global test accuracy: 93.20
Round  42, Train loss: 1.118, Test loss: 0.994, Test accuracy: 91.04
Round  42, Global train loss: 1.118, Global test loss: 0.974, Global test accuracy: 93.22
Round  43, Train loss: 1.159, Test loss: 0.996, Test accuracy: 90.88
Round  43, Global train loss: 1.159, Global test loss: 0.968, Global test accuracy: 93.90
Round  44, Train loss: 1.126, Test loss: 0.992, Test accuracy: 91.36
Round  44, Global train loss: 1.126, Global test loss: 0.970, Global test accuracy: 93.72
Round  45, Train loss: 1.106, Test loss: 0.992, Test accuracy: 91.42
Round  45, Global train loss: 1.106, Global test loss: 0.957, Global test accuracy: 95.08
Round  46, Train loss: 1.138, Test loss: 0.995, Test accuracy: 91.14
Round  46, Global train loss: 1.138, Global test loss: 0.964, Global test accuracy: 94.28
Round  47, Train loss: 1.161, Test loss: 0.997, Test accuracy: 90.86
Round  47, Global train loss: 1.161, Global test loss: 0.987, Global test accuracy: 92.14
Round  48, Train loss: 1.106, Test loss: 0.996, Test accuracy: 90.86
Round  48, Global train loss: 1.106, Global test loss: 0.958, Global test accuracy: 95.04
Round  49, Train loss: 1.283, Test loss: 0.995, Test accuracy: 91.06
Round  49, Global train loss: 1.283, Global test loss: 0.982, Global test accuracy: 92.26
Round  50, Train loss: 1.131, Test loss: 0.996, Test accuracy: 91.14
Round  50, Global train loss: 1.131, Global test loss: 0.981, Global test accuracy: 92.80
Round  51, Train loss: 1.290, Test loss: 0.995, Test accuracy: 91.26
Round  51, Global train loss: 1.290, Global test loss: 0.973, Global test accuracy: 93.60
Round  52, Train loss: 1.282, Test loss: 1.003, Test accuracy: 90.50
Round  52, Global train loss: 1.282, Global test loss: 0.966, Global test accuracy: 94.22
Round  53, Train loss: 0.939, Test loss: 1.004, Test accuracy: 90.30
Round  53, Global train loss: 0.939, Global test loss: 0.959, Global test accuracy: 94.92
Round  54, Train loss: 0.961, Test loss: 1.003, Test accuracy: 90.28
Round  54, Global train loss: 0.961, Global test loss: 0.962, Global test accuracy: 94.38
Round  55, Train loss: 1.092, Test loss: 1.001, Test accuracy: 90.60
Round  55, Global train loss: 1.092, Global test loss: 0.956, Global test accuracy: 95.02
Round  56, Train loss: 1.127, Test loss: 1.000, Test accuracy: 90.64
Round  56, Global train loss: 1.127, Global test loss: 0.968, Global test accuracy: 93.62
Round  57, Train loss: 1.128, Test loss: 1.001, Test accuracy: 90.68
Round  57, Global train loss: 1.128, Global test loss: 0.963, Global test accuracy: 94.28
Round  58, Train loss: 1.457, Test loss: 1.004, Test accuracy: 90.16
Round  58, Global train loss: 1.457, Global test loss: 0.998, Global test accuracy: 91.02
Round  59, Train loss: 1.102, Test loss: 1.005, Test accuracy: 90.08
Round  59, Global train loss: 1.102, Global test loss: 0.961, Global test accuracy: 94.46
Round  60, Train loss: 1.115, Test loss: 1.004, Test accuracy: 90.10
Round  60, Global train loss: 1.115, Global test loss: 0.974, Global test accuracy: 93.02
Round  61, Train loss: 1.105, Test loss: 1.003, Test accuracy: 90.16
Round  61, Global train loss: 1.105, Global test loss: 0.964, Global test accuracy: 94.42
Round  62, Train loss: 1.317, Test loss: 1.004, Test accuracy: 90.06
Round  62, Global train loss: 1.317, Global test loss: 0.990, Global test accuracy: 91.70
Round  63, Train loss: 1.086, Test loss: 1.005, Test accuracy: 90.06
Round  63, Global train loss: 1.086, Global test loss: 0.969, Global test accuracy: 93.52
Round  64, Train loss: 0.960, Test loss: 1.005, Test accuracy: 90.12
Round  64, Global train loss: 0.960, Global test loss: 0.965, Global test accuracy: 94.24
Round  65, Train loss: 1.288, Test loss: 1.006, Test accuracy: 89.90
Round  65, Global train loss: 1.288, Global test loss: 0.973, Global test accuracy: 93.72
Round  66, Train loss: 1.100, Test loss: 1.006, Test accuracy: 89.92
Round  66, Global train loss: 1.100, Global test loss: 0.964, Global test accuracy: 94.14
Round  67, Train loss: 1.084, Test loss: 1.006, Test accuracy: 89.88
Round  67, Global train loss: 1.084, Global test loss: 0.967, Global test accuracy: 93.94
Round  68, Train loss: 1.121, Test loss: 1.009, Test accuracy: 89.62
Round  68, Global train loss: 1.121, Global test loss: 0.972, Global test accuracy: 93.44
Round  69, Train loss: 1.081, Test loss: 1.009, Test accuracy: 89.74
Round  69, Global train loss: 1.081, Global test loss: 0.969, Global test accuracy: 93.60
Round  70, Train loss: 1.272, Test loss: 1.006, Test accuracy: 89.92
Round  70, Global train loss: 1.272, Global test loss: 0.964, Global test accuracy: 94.34
Round  71, Train loss: 1.118, Test loss: 1.007, Test accuracy: 89.80
Round  71, Global train loss: 1.118, Global test loss: 0.970, Global test accuracy: 93.60
Round  72, Train loss: 1.281, Test loss: 1.014, Test accuracy: 88.96
Round  72, Global train loss: 1.281, Global test loss: 0.977, Global test accuracy: 93.04
Round  73, Train loss: 1.089, Test loss: 1.017, Test accuracy: 88.62
Round  73, Global train loss: 1.089, Global test loss: 0.963, Global test accuracy: 94.40
Round  74, Train loss: 0.935, Test loss: 1.017, Test accuracy: 88.64
Round  74, Global train loss: 0.935, Global test loss: 0.960, Global test accuracy: 94.74
Round  75, Train loss: 1.120, Test loss: 1.014, Test accuracy: 88.88
Round  75, Global train loss: 1.120, Global test loss: 0.967, Global test accuracy: 93.90
Round  76, Train loss: 1.090, Test loss: 1.013, Test accuracy: 89.02
Round  76, Global train loss: 1.090, Global test loss: 0.964, Global test accuracy: 94.36
Round  77, Train loss: 1.113, Test loss: 1.014, Test accuracy: 89.02
Round  77, Global train loss: 1.113, Global test loss: 0.975, Global test accuracy: 93.06
Round  78, Train loss: 0.957, Test loss: 1.013, Test accuracy: 89.20
Round  78, Global train loss: 0.957, Global test loss: 0.971, Global test accuracy: 93.36
Round  79, Train loss: 1.089, Test loss: 1.015, Test accuracy: 88.86
Round  79, Global train loss: 1.089, Global test loss: 0.963, Global test accuracy: 94.30
Round  80, Train loss: 1.102, Test loss: 1.016, Test accuracy: 88.84
Round  80, Global train loss: 1.102, Global test loss: 0.978, Global test accuracy: 92.84
Round  81, Train loss: 1.108, Test loss: 1.016, Test accuracy: 88.78
Round  81, Global train loss: 1.108, Global test loss: 0.960, Global test accuracy: 94.60
Round  82, Train loss: 1.112, Test loss: 1.016, Test accuracy: 88.70
Round  82, Global train loss: 1.112, Global test loss: 0.973, Global test accuracy: 93.34
Round  83, Train loss: 1.116, Test loss: 1.016, Test accuracy: 88.92
Round  83, Global train loss: 1.116, Global test loss: 0.971, Global test accuracy: 93.34
Round  84, Train loss: 1.426, Test loss: 1.024, Test accuracy: 88.02
Round  84, Global train loss: 1.426, Global test loss: 1.003, Global test accuracy: 90.40
Round  85, Train loss: 1.100, Test loss: 1.028, Test accuracy: 87.66
Round  85, Global train loss: 1.100, Global test loss: 0.984, Global test accuracy: 92.40
Round  86, Train loss: 1.072, Test loss: 1.018, Test accuracy: 88.66
Round  86, Global train loss: 1.072, Global test loss: 0.967, Global test accuracy: 94.40
Round  87, Train loss: 1.265, Test loss: 1.023, Test accuracy: 88.22
Round  87, Global train loss: 1.265, Global test loss: 0.992, Global test accuracy: 91.50
Round  88, Train loss: 1.077, Test loss: 1.021, Test accuracy: 88.26
Round  88, Global train loss: 1.077, Global test loss: 0.970, Global test accuracy: 93.46
Round  89, Train loss: 1.107, Test loss: 1.019, Test accuracy: 88.48
Round  89, Global train loss: 1.107, Global test loss: 0.978, Global test accuracy: 92.72
Round  90, Train loss: 1.091, Test loss: 1.011, Test accuracy: 89.48
Round  90, Global train loss: 1.091, Global test loss: 0.966, Global test accuracy: 93.96
Round  91, Train loss: 1.089, Test loss: 1.012, Test accuracy: 89.28
Round  91, Global train loss: 1.089, Global test loss: 0.965, Global test accuracy: 94.00
Round  92, Train loss: 1.078, Test loss: 1.014, Test accuracy: 89.04
Round  92, Global train loss: 1.078, Global test loss: 0.970, Global test accuracy: 93.34
Round  93, Train loss: 1.095, Test loss: 1.013, Test accuracy: 89.16
Round  93, Global train loss: 1.095, Global test loss: 0.983, Global test accuracy: 92.14
Round  94, Train loss: 1.087, Test loss: 1.027, Test accuracy: 87.66
Round  94, Global train loss: 1.087, Global test loss: 0.971, Global test accuracy: 94.08/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.126, Test loss: 1.029, Test accuracy: 87.22
Round  95, Global train loss: 1.126, Global test loss: 0.991, Global test accuracy: 91.54
Round  96, Train loss: 1.103, Test loss: 1.030, Test accuracy: 87.20
Round  96, Global train loss: 1.103, Global test loss: 0.981, Global test accuracy: 92.46
Round  97, Train loss: 1.086, Test loss: 1.017, Test accuracy: 88.62
Round  97, Global train loss: 1.086, Global test loss: 0.969, Global test accuracy: 93.66
Round  98, Train loss: 1.121, Test loss: 1.017, Test accuracy: 88.56
Round  98, Global train loss: 1.121, Global test loss: 0.991, Global test accuracy: 91.46
Round  99, Train loss: 1.247, Test loss: 1.021, Test accuracy: 88.10
Round  99, Global train loss: 1.247, Global test loss: 0.984, Global test accuracy: 92.72
Final Round, Train loss: 1.118, Test loss: 1.023, Test accuracy: 88.08
Final Round, Global train loss: 1.118, Global test loss: 0.984, Global test accuracy: 92.72
Average accuracy final 10 rounds: 88.43199999999999 

Average global accuracy final 10 rounds: 92.936 

804.3267319202423
[1.216782569885254, 2.433565139770508, 3.861941337585449, 5.290317535400391, 6.508783578872681, 7.727249622344971, 8.811691284179688, 9.896132946014404, 10.920939445495605, 11.945745944976807, 13.049793004989624, 14.153840065002441, 15.206083536148071, 16.2583270072937, 17.324115753173828, 18.389904499053955, 19.424081563949585, 20.458258628845215, 21.507163286209106, 22.556067943572998, 23.530691862106323, 24.50531578063965, 25.551879167556763, 26.598442554473877, 27.576613187789917, 28.554783821105957, 29.480112075805664, 30.40544033050537, 31.48554491996765, 32.56564950942993, 33.65789175033569, 34.750133991241455, 35.908058404922485, 37.065982818603516, 38.05339074134827, 39.04079866409302, 40.073752641677856, 41.106706619262695, 42.04811477661133, 42.98952293395996, 44.000203371047974, 45.010883808135986, 46.154027223587036, 47.297170639038086, 48.52915906906128, 49.76114749908447, 50.865771532058716, 51.97039556503296, 53.05460977554321, 54.13882398605347, 55.26693272590637, 56.39504146575928, 57.42600345611572, 58.45696544647217, 59.57762432098389, 60.698283195495605, 61.73555612564087, 62.77282905578613, 63.85007357597351, 64.92731809616089, 66.16639995574951, 67.40548181533813, 68.4930055141449, 69.58052921295166, 70.66740274429321, 71.75427627563477, 72.92524194717407, 74.09620761871338, 75.14425587654114, 76.1923041343689, 77.24199390411377, 78.29168367385864, 79.38235235214233, 80.47302103042603, 81.53442573547363, 82.59583044052124, 83.68690872192383, 84.77798700332642, 85.8724262714386, 86.96686553955078, 88.07466864585876, 89.18247175216675, 90.15413165092468, 91.12579154968262, 92.17532348632812, 93.22485542297363, 94.2599093914032, 95.29496335983276, 96.24956393241882, 97.20416450500488, 98.26979422569275, 99.33542394638062, 100.47221493721008, 101.60900592803955, 102.61208653450012, 103.6151671409607, 104.66265439987183, 105.71014165878296, 106.84601545333862, 107.98188924789429, 108.97141456604004, 109.96093988418579, 111.10705804824829, 112.25317621231079, 113.42704820632935, 114.6009202003479, 115.84979939460754, 117.09867858886719, 118.17682814598083, 119.25497770309448, 120.32821869850159, 121.40145969390869, 122.44055843353271, 123.47965717315674, 124.53799295425415, 125.59632873535156, 126.72880911827087, 127.86128950119019, 128.9642059803009, 130.06712245941162, 131.62124490737915, 133.17536735534668, 134.3071050643921, 135.4388427734375, 136.57955479621887, 137.72026681900024, 138.7407672405243, 139.76126766204834, 140.82395339012146, 141.88663911819458, 143.00360250473022, 144.12056589126587, 145.15196633338928, 146.1833667755127, 147.22244358062744, 148.2615203857422, 149.2827126979828, 150.3039050102234, 151.37871408462524, 152.4535231590271, 153.52565264701843, 154.59778213500977, 155.61047554016113, 156.6231689453125, 157.6643364429474, 158.70550394058228, 159.66131687164307, 160.61712980270386, 161.7843894958496, 162.95164918899536, 163.83457231521606, 164.71749544143677, 165.92828631401062, 167.13907718658447, 168.31050634384155, 169.48193550109863, 170.68958044052124, 171.89722537994385, 172.96824741363525, 174.03926944732666, 175.11125373840332, 176.18323802947998, 177.24585485458374, 178.3084716796875, 179.39786052703857, 180.48724937438965, 181.60786604881287, 182.72848272323608, 183.8476438522339, 184.9668049812317, 186.1234850883484, 187.2801651954651, 188.45932054519653, 189.63847589492798, 190.89031624794006, 192.14215660095215, 193.17929530143738, 194.2164340019226, 195.26040124893188, 196.30436849594116, 197.31830620765686, 198.33224391937256, 199.4257845878601, 200.51932525634766, 201.6399884223938, 202.76065158843994, 203.80644536018372, 204.8522391319275, 205.8627631664276, 206.87328720092773, 207.86794233322144, 208.86259746551514, 209.87678956985474, 210.89098167419434, 211.9021077156067, 212.91323375701904, 214.10326623916626, 215.29329872131348, 216.3840970993042, 217.47489547729492, 219.60759854316711, 221.7403016090393]
[47.94, 47.94, 56.18, 56.18, 71.24, 71.24, 81.94, 81.94, 84.68, 84.68, 86.52, 86.52, 86.28, 86.28, 85.5, 85.5, 91.72, 91.72, 92.0, 92.0, 91.46, 91.46, 92.24, 92.24, 92.72, 92.72, 92.86, 92.86, 92.76, 92.76, 91.68, 91.68, 91.94, 91.94, 91.84, 91.84, 91.86, 91.86, 92.0, 92.0, 92.12, 92.12, 92.16, 92.16, 92.14, 92.14, 92.08, 92.08, 91.94, 91.94, 91.52, 91.52, 91.42, 91.42, 91.24, 91.24, 91.3, 91.3, 91.64, 91.64, 91.1, 91.1, 91.14, 91.14, 90.94, 90.94, 90.9, 90.9, 90.64, 90.64, 90.52, 90.52, 90.78, 90.78, 90.68, 90.68, 90.74, 90.74, 90.64, 90.64, 90.72, 90.72, 91.0, 91.0, 91.04, 91.04, 90.88, 90.88, 91.36, 91.36, 91.42, 91.42, 91.14, 91.14, 90.86, 90.86, 90.86, 90.86, 91.06, 91.06, 91.14, 91.14, 91.26, 91.26, 90.5, 90.5, 90.3, 90.3, 90.28, 90.28, 90.6, 90.6, 90.64, 90.64, 90.68, 90.68, 90.16, 90.16, 90.08, 90.08, 90.1, 90.1, 90.16, 90.16, 90.06, 90.06, 90.06, 90.06, 90.12, 90.12, 89.9, 89.9, 89.92, 89.92, 89.88, 89.88, 89.62, 89.62, 89.74, 89.74, 89.92, 89.92, 89.8, 89.8, 88.96, 88.96, 88.62, 88.62, 88.64, 88.64, 88.88, 88.88, 89.02, 89.02, 89.02, 89.02, 89.2, 89.2, 88.86, 88.86, 88.84, 88.84, 88.78, 88.78, 88.7, 88.7, 88.92, 88.92, 88.02, 88.02, 87.66, 87.66, 88.66, 88.66, 88.22, 88.22, 88.26, 88.26, 88.48, 88.48, 89.48, 89.48, 89.28, 89.28, 89.04, 89.04, 89.16, 89.16, 87.66, 87.66, 87.22, 87.22, 87.2, 87.2, 88.62, 88.62, 88.56, 88.56, 88.1, 88.1, 88.08, 88.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.598, Test loss: 1.589, Test accuracy: 55.00
Round   0, Global train loss: 1.598, Global test loss: 1.590, Global test accuracy: 54.96
Round   1, Train loss: 1.567, Test loss: 1.528, Test accuracy: 63.16
Round   1, Global train loss: 1.567, Global test loss: 1.531, Global test accuracy: 62.58
Round   2, Train loss: 1.399, Test loss: 1.359, Test accuracy: 75.16
Round   2, Global train loss: 1.399, Global test loss: 1.246, Global test accuracy: 85.24
Round   3, Train loss: 1.389, Test loss: 1.247, Test accuracy: 81.48
Round   3, Global train loss: 1.389, Global test loss: 1.128, Global test accuracy: 89.30
Round   4, Train loss: 1.231, Test loss: 1.165, Test accuracy: 86.60
Round   4, Global train loss: 1.231, Global test loss: 1.044, Global test accuracy: 91.92
Round   5, Train loss: 1.165, Test loss: 1.114, Test accuracy: 88.36
Round   5, Global train loss: 1.165, Global test loss: 0.997, Global test accuracy: 94.76
Round   6, Train loss: 1.387, Test loss: 1.087, Test accuracy: 90.00
Round   6, Global train loss: 1.387, Global test loss: 1.002, Global test accuracy: 94.40
Round   7, Train loss: 1.202, Test loss: 1.101, Test accuracy: 87.78
Round   7, Global train loss: 1.202, Global test loss: 1.013, Global test accuracy: 91.02
Round   8, Train loss: 0.950, Test loss: 1.030, Test accuracy: 90.72
Round   8, Global train loss: 0.950, Global test loss: 0.963, Global test accuracy: 95.50
Round   9, Train loss: 1.341, Test loss: 1.024, Test accuracy: 91.06
Round   9, Global train loss: 1.341, Global test loss: 0.966, Global test accuracy: 95.38
Round  10, Train loss: 1.187, Test loss: 1.017, Test accuracy: 91.78
Round  10, Global train loss: 1.187, Global test loss: 0.967, Global test accuracy: 95.14
Round  11, Train loss: 1.340, Test loss: 0.995, Test accuracy: 92.40
Round  11, Global train loss: 1.340, Global test loss: 0.961, Global test accuracy: 95.84
Round  12, Train loss: 1.189, Test loss: 0.986, Test accuracy: 93.24
Round  12, Global train loss: 1.189, Global test loss: 0.977, Global test accuracy: 93.94
Round  13, Train loss: 1.349, Test loss: 0.987, Test accuracy: 92.96
Round  13, Global train loss: 1.349, Global test loss: 0.968, Global test accuracy: 94.66
Round  14, Train loss: 0.972, Test loss: 0.989, Test accuracy: 92.58
Round  14, Global train loss: 0.972, Global test loss: 0.962, Global test accuracy: 95.20
Round  15, Train loss: 1.537, Test loss: 0.990, Test accuracy: 92.46
Round  15, Global train loss: 1.537, Global test loss: 0.958, Global test accuracy: 95.66
Round  16, Train loss: 1.119, Test loss: 0.986, Test accuracy: 92.66
Round  16, Global train loss: 1.119, Global test loss: 0.955, Global test accuracy: 96.16
Round  17, Train loss: 1.321, Test loss: 0.997, Test accuracy: 91.68
Round  17, Global train loss: 1.321, Global test loss: 0.960, Global test accuracy: 95.70
Round  18, Train loss: 1.138, Test loss: 0.996, Test accuracy: 91.62
Round  18, Global train loss: 1.138, Global test loss: 0.953, Global test accuracy: 95.90
Round  19, Train loss: 1.380, Test loss: 0.993, Test accuracy: 91.92
Round  19, Global train loss: 1.380, Global test loss: 0.995, Global test accuracy: 91.72
Round  20, Train loss: 1.134, Test loss: 0.994, Test accuracy: 91.82
Round  20, Global train loss: 1.134, Global test loss: 0.956, Global test accuracy: 95.38
Round  21, Train loss: 1.169, Test loss: 0.990, Test accuracy: 92.18
Round  21, Global train loss: 1.169, Global test loss: 0.970, Global test accuracy: 94.18
Round  22, Train loss: 1.127, Test loss: 0.992, Test accuracy: 91.74
Round  22, Global train loss: 1.127, Global test loss: 0.956, Global test accuracy: 95.54
Round  23, Train loss: 1.147, Test loss: 1.005, Test accuracy: 90.10
Round  23, Global train loss: 1.147, Global test loss: 0.959, Global test accuracy: 95.40
Round  24, Train loss: 1.122, Test loss: 1.003, Test accuracy: 90.44
Round  24, Global train loss: 1.122, Global test loss: 0.953, Global test accuracy: 95.54
Round  25, Train loss: 1.124, Test loss: 1.004, Test accuracy: 90.32
Round  25, Global train loss: 1.124, Global test loss: 0.956, Global test accuracy: 95.34
Round  26, Train loss: 0.958, Test loss: 1.003, Test accuracy: 90.42
Round  26, Global train loss: 0.958, Global test loss: 0.950, Global test accuracy: 95.90
Round  27, Train loss: 1.329, Test loss: 1.001, Test accuracy: 90.52
Round  27, Global train loss: 1.329, Global test loss: 0.966, Global test accuracy: 94.60
Round  28, Train loss: 1.157, Test loss: 1.000, Test accuracy: 90.58
Round  28, Global train loss: 1.157, Global test loss: 0.968, Global test accuracy: 94.26
Round  29, Train loss: 0.919, Test loss: 1.000, Test accuracy: 90.54
Round  29, Global train loss: 0.919, Global test loss: 0.948, Global test accuracy: 96.04
Round  30, Train loss: 1.310, Test loss: 0.993, Test accuracy: 91.44
Round  30, Global train loss: 1.310, Global test loss: 0.951, Global test accuracy: 95.78
Round  31, Train loss: 1.119, Test loss: 0.994, Test accuracy: 91.32
Round  31, Global train loss: 1.119, Global test loss: 0.954, Global test accuracy: 95.12
Round  32, Train loss: 0.917, Test loss: 0.994, Test accuracy: 91.24
Round  32, Global train loss: 0.917, Global test loss: 0.947, Global test accuracy: 95.94
Round  33, Train loss: 1.116, Test loss: 0.994, Test accuracy: 91.22
Round  33, Global train loss: 1.116, Global test loss: 0.955, Global test accuracy: 95.14
Round  34, Train loss: 1.122, Test loss: 0.994, Test accuracy: 91.10
Round  34, Global train loss: 1.122, Global test loss: 0.953, Global test accuracy: 95.28
Round  35, Train loss: 1.314, Test loss: 0.996, Test accuracy: 90.92
Round  35, Global train loss: 1.314, Global test loss: 0.967, Global test accuracy: 94.24
Round  36, Train loss: 0.914, Test loss: 0.996, Test accuracy: 90.88
Round  36, Global train loss: 0.914, Global test loss: 0.948, Global test accuracy: 95.72
Round  37, Train loss: 0.912, Test loss: 0.996, Test accuracy: 90.92
Round  37, Global train loss: 0.912, Global test loss: 0.946, Global test accuracy: 96.14
Round  38, Train loss: 1.117, Test loss: 0.998, Test accuracy: 90.58
Round  38, Global train loss: 1.117, Global test loss: 0.953, Global test accuracy: 95.38
Round  39, Train loss: 1.148, Test loss: 1.001, Test accuracy: 90.28
Round  39, Global train loss: 1.148, Global test loss: 0.969, Global test accuracy: 94.02
Round  40, Train loss: 1.308, Test loss: 1.003, Test accuracy: 90.02
Round  40, Global train loss: 1.308, Global test loss: 0.969, Global test accuracy: 94.10
Round  41, Train loss: 0.912, Test loss: 1.003, Test accuracy: 89.98
Round  41, Global train loss: 0.912, Global test loss: 0.948, Global test accuracy: 95.84
Round  42, Train loss: 1.309, Test loss: 1.006, Test accuracy: 89.70
Round  42, Global train loss: 1.309, Global test loss: 0.974, Global test accuracy: 93.44
Round  43, Train loss: 1.303, Test loss: 1.000, Test accuracy: 90.32
Round  43, Global train loss: 1.303, Global test loss: 0.954, Global test accuracy: 95.44
Round  44, Train loss: 1.126, Test loss: 1.003, Test accuracy: 90.04
Round  44, Global train loss: 1.126, Global test loss: 0.955, Global test accuracy: 95.46
Round  45, Train loss: 0.914, Test loss: 1.003, Test accuracy: 90.06
Round  45, Global train loss: 0.914, Global test loss: 0.947, Global test accuracy: 95.84
Round  46, Train loss: 1.307, Test loss: 1.004, Test accuracy: 89.82
Round  46, Global train loss: 1.307, Global test loss: 0.977, Global test accuracy: 93.36
Round  47, Train loss: 1.106, Test loss: 1.006, Test accuracy: 89.62
Round  47, Global train loss: 1.106, Global test loss: 0.958, Global test accuracy: 94.92
Round  48, Train loss: 1.109, Test loss: 1.006, Test accuracy: 89.58
Round  48, Global train loss: 1.109, Global test loss: 0.955, Global test accuracy: 95.12
Round  49, Train loss: 1.105, Test loss: 1.008, Test accuracy: 89.50
Round  49, Global train loss: 1.105, Global test loss: 0.954, Global test accuracy: 95.12
Round  50, Train loss: 0.909, Test loss: 1.008, Test accuracy: 89.62
Round  50, Global train loss: 0.909, Global test loss: 0.948, Global test accuracy: 95.74
Round  51, Train loss: 1.123, Test loss: 1.002, Test accuracy: 90.14
Round  51, Global train loss: 1.123, Global test loss: 0.951, Global test accuracy: 95.72
Round  52, Train loss: 1.118, Test loss: 1.001, Test accuracy: 90.36
Round  52, Global train loss: 1.118, Global test loss: 0.956, Global test accuracy: 95.16
Round  53, Train loss: 0.939, Test loss: 1.001, Test accuracy: 90.32
Round  53, Global train loss: 0.939, Global test loss: 0.951, Global test accuracy: 95.54
Round  54, Train loss: 1.303, Test loss: 0.999, Test accuracy: 90.68
Round  54, Global train loss: 1.303, Global test loss: 0.975, Global test accuracy: 93.34
Round  55, Train loss: 1.116, Test loss: 1.006, Test accuracy: 89.80
Round  55, Global train loss: 1.116, Global test loss: 0.961, Global test accuracy: 94.84
Round  56, Train loss: 1.304, Test loss: 1.006, Test accuracy: 89.84
Round  56, Global train loss: 1.304, Global test loss: 0.978, Global test accuracy: 92.84
Round  57, Train loss: 0.938, Test loss: 1.006, Test accuracy: 89.90
Round  57, Global train loss: 0.938, Global test loss: 0.956, Global test accuracy: 95.08
Round  58, Train loss: 1.276, Test loss: 1.002, Test accuracy: 90.22
Round  58, Global train loss: 1.276, Global test loss: 0.957, Global test accuracy: 95.10
Round  59, Train loss: 0.911, Test loss: 1.003, Test accuracy: 90.14
Round  59, Global train loss: 0.911, Global test loss: 0.949, Global test accuracy: 95.52
Round  60, Train loss: 1.130, Test loss: 1.006, Test accuracy: 89.78
Round  60, Global train loss: 1.130, Global test loss: 0.972, Global test accuracy: 93.36
Round  61, Train loss: 1.474, Test loss: 1.012, Test accuracy: 89.32
Round  61, Global train loss: 1.474, Global test loss: 0.965, Global test accuracy: 94.34
Round  62, Train loss: 0.910, Test loss: 1.013, Test accuracy: 89.22
Round  62, Global train loss: 0.910, Global test loss: 0.952, Global test accuracy: 95.34
Round  63, Train loss: 1.298, Test loss: 1.011, Test accuracy: 89.22
Round  63, Global train loss: 1.298, Global test loss: 0.972, Global test accuracy: 93.58
Round  64, Train loss: 1.129, Test loss: 1.010, Test accuracy: 89.40
Round  64, Global train loss: 1.129, Global test loss: 0.978, Global test accuracy: 93.04
Round  65, Train loss: 0.911, Test loss: 1.010, Test accuracy: 89.42
Round  65, Global train loss: 0.911, Global test loss: 0.950, Global test accuracy: 95.52
Round  66, Train loss: 0.937, Test loss: 1.010, Test accuracy: 89.50
Round  66, Global train loss: 0.937, Global test loss: 0.953, Global test accuracy: 95.34
Round  67, Train loss: 1.101, Test loss: 1.010, Test accuracy: 89.48
Round  67, Global train loss: 1.101, Global test loss: 0.953, Global test accuracy: 95.40
Round  68, Train loss: 1.296, Test loss: 1.011, Test accuracy: 89.40
Round  68, Global train loss: 1.296, Global test loss: 0.984, Global test accuracy: 92.14
Round  69, Train loss: 1.124, Test loss: 1.011, Test accuracy: 89.38
Round  69, Global train loss: 1.124, Global test loss: 0.973, Global test accuracy: 93.50
Round  70, Train loss: 1.082, Test loss: 1.004, Test accuracy: 89.90
Round  70, Global train loss: 1.082, Global test loss: 0.954, Global test accuracy: 95.44
Round  71, Train loss: 0.911, Test loss: 1.003, Test accuracy: 89.96
Round  71, Global train loss: 0.911, Global test loss: 0.948, Global test accuracy: 95.86
Round  72, Train loss: 0.935, Test loss: 1.003, Test accuracy: 89.94
Round  72, Global train loss: 0.935, Global test loss: 0.954, Global test accuracy: 95.42
Round  73, Train loss: 1.106, Test loss: 1.002, Test accuracy: 90.04
Round  73, Global train loss: 1.106, Global test loss: 0.954, Global test accuracy: 95.30
Round  74, Train loss: 1.130, Test loss: 1.002, Test accuracy: 90.08
Round  74, Global train loss: 1.130, Global test loss: 0.967, Global test accuracy: 93.98
Round  75, Train loss: 1.295, Test loss: 1.000, Test accuracy: 90.36
Round  75, Global train loss: 1.295, Global test loss: 0.980, Global test accuracy: 92.48
Round  76, Train loss: 1.130, Test loss: 1.001, Test accuracy: 90.30
Round  76, Global train loss: 1.130, Global test loss: 0.976, Global test accuracy: 92.92
Round  77, Train loss: 0.935, Test loss: 1.001, Test accuracy: 90.30
Round  77, Global train loss: 0.935, Global test loss: 0.957, Global test accuracy: 95.16
Round  78, Train loss: 1.127, Test loss: 1.001, Test accuracy: 90.22
Round  78, Global train loss: 1.127, Global test loss: 0.975, Global test accuracy: 93.08
Round  79, Train loss: 0.937, Test loss: 1.003, Test accuracy: 90.06
Round  79, Global train loss: 0.937, Global test loss: 0.957, Global test accuracy: 95.00
Round  80, Train loss: 1.290, Test loss: 1.002, Test accuracy: 90.08
Round  80, Global train loss: 1.290, Global test loss: 0.985, Global test accuracy: 92.34
Round  81, Train loss: 1.273, Test loss: 0.998, Test accuracy: 90.50
Round  81, Global train loss: 1.273, Global test loss: 0.958, Global test accuracy: 94.86
Round  82, Train loss: 1.104, Test loss: 0.997, Test accuracy: 90.52
Round  82, Global train loss: 1.104, Global test loss: 0.959, Global test accuracy: 94.72
Round  83, Train loss: 1.293, Test loss: 0.996, Test accuracy: 90.62
Round  83, Global train loss: 1.293, Global test loss: 0.985, Global test accuracy: 91.98
Round  84, Train loss: 1.265, Test loss: 1.008, Test accuracy: 89.42
Round  84, Global train loss: 1.265, Global test loss: 0.962, Global test accuracy: 94.38
Round  85, Train loss: 1.075, Test loss: 1.006, Test accuracy: 89.60
Round  85, Global train loss: 1.075, Global test loss: 0.963, Global test accuracy: 94.60
Round  86, Train loss: 1.264, Test loss: 1.001, Test accuracy: 90.14
Round  86, Global train loss: 1.264, Global test loss: 0.964, Global test accuracy: 94.46
Round  87, Train loss: 1.096, Test loss: 1.000, Test accuracy: 90.16
Round  87, Global train loss: 1.096, Global test loss: 0.961, Global test accuracy: 94.66
Round  88, Train loss: 1.285, Test loss: 1.002, Test accuracy: 90.14
Round  88, Global train loss: 1.285, Global test loss: 0.979, Global test accuracy: 92.88
Round  89, Train loss: 1.098, Test loss: 1.004, Test accuracy: 89.94
Round  89, Global train loss: 1.098, Global test loss: 0.965, Global test accuracy: 94.10
Round  90, Train loss: 1.097, Test loss: 1.002, Test accuracy: 90.14
Round  90, Global train loss: 1.097, Global test loss: 0.958, Global test accuracy: 95.00
Round  91, Train loss: 0.935, Test loss: 1.002, Test accuracy: 90.26
Round  91, Global train loss: 0.935, Global test loss: 0.956, Global test accuracy: 95.12
Round  92, Train loss: 1.122, Test loss: 1.004, Test accuracy: 90.08
Round  92, Global train loss: 1.122, Global test loss: 0.973, Global test accuracy: 93.56
Round  93, Train loss: 1.282, Test loss: 1.000, Test accuracy: 90.52
Round  93, Global train loss: 1.282, Global test loss: 0.977, Global test accuracy: 92.98
Round  94, Train loss: 1.120, Test loss: 1.000, Test accuracy: 90.48
Round  94, Global train loss: 1.120, Global test loss: 0.974, Global test accuracy: 93.16/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.101, Test loss: 1.000, Test accuracy: 90.56
Round  95, Global train loss: 1.101, Global test loss: 0.967, Global test accuracy: 94.20
Round  96, Train loss: 0.908, Test loss: 1.001, Test accuracy: 90.44
Round  96, Global train loss: 0.908, Global test loss: 0.952, Global test accuracy: 95.38
Round  97, Train loss: 1.120, Test loss: 0.999, Test accuracy: 90.70
Round  97, Global train loss: 1.120, Global test loss: 0.969, Global test accuracy: 93.66
Round  98, Train loss: 1.100, Test loss: 0.999, Test accuracy: 90.60
Round  98, Global train loss: 1.100, Global test loss: 0.967, Global test accuracy: 94.04
Round  99, Train loss: 1.260, Test loss: 0.996, Test accuracy: 90.98
Round  99, Global train loss: 1.260, Global test loss: 0.964, Global test accuracy: 94.12
Final Round, Train loss: 1.131, Test loss: 1.013, Test accuracy: 88.84
Final Round, Global train loss: 1.131, Global test loss: 0.964, Global test accuracy: 94.12
Average accuracy final 10 rounds: 90.47599999999998 

Average global accuracy final 10 rounds: 94.122 

829.3082368373871
[1.176307201385498, 2.352614402770996, 3.4544262886047363, 4.556238174438477, 5.961434841156006, 7.366631507873535, 8.582963228225708, 9.79929494857788, 11.046772956848145, 12.294250965118408, 13.513612747192383, 14.732974529266357, 15.970959901809692, 17.208945274353027, 18.389315843582153, 19.56968641281128, 20.67008686065674, 21.770487308502197, 22.88333749771118, 23.996187686920166, 25.22360110282898, 26.451014518737793, 27.633358240127563, 28.815701961517334, 29.906066179275513, 30.99643039703369, 32.197015047073364, 33.39759969711304, 34.567930936813354, 35.73826217651367, 36.99070858955383, 38.243155002593994, 39.45231294631958, 40.661470890045166, 41.785229444503784, 42.9089879989624, 44.62915015220642, 46.34931230545044, 47.49143409729004, 48.63355588912964, 49.897608518600464, 51.16166114807129, 52.32555818557739, 53.489455223083496, 54.70488691329956, 55.920318603515625, 57.13368082046509, 58.34704303741455, 59.55661392211914, 60.76618480682373, 61.98546385765076, 63.20474290847778, 64.23717522621155, 65.26960754394531, 66.43363833427429, 67.59766912460327, 68.89892530441284, 70.20018148422241, 71.40877223014832, 72.61736297607422, 73.71550822257996, 74.8136534690857, 75.95255184173584, 77.09145021438599, 78.30648350715637, 79.52151679992676, 80.77375984191895, 82.02600288391113, 83.29948616027832, 84.57296943664551, 85.74735593795776, 86.92174243927002, 88.0668044090271, 89.21186637878418, 90.38215255737305, 91.55243873596191, 92.77737188339233, 94.00230503082275, 95.07988810539246, 96.15747117996216, 97.42013478279114, 98.68279838562012, 99.72224164009094, 100.76168489456177, 101.9741108417511, 103.18653678894043, 104.33369898796082, 105.4808611869812, 106.6325933933258, 107.78432559967041, 108.8825626373291, 109.9807996749878, 111.13753342628479, 112.29426717758179, 113.52246737480164, 114.75066757202148, 115.83586716651917, 116.92106676101685, 117.98973631858826, 119.05840587615967, 120.34161901473999, 121.62483215332031, 122.73129296302795, 123.8377537727356, 124.98546838760376, 126.13318300247192, 127.28820729255676, 128.4432315826416, 129.58312916755676, 130.72302675247192, 131.79242706298828, 132.86182737350464, 134.08640265464783, 135.31097793579102, 136.63637804985046, 137.9617781639099, 139.07774758338928, 140.19371700286865, 141.40390872955322, 142.6141004562378, 143.77590608596802, 144.93771171569824, 146.18710947036743, 147.43650722503662, 148.53042936325073, 149.62435150146484, 150.7418384552002, 151.85932540893555, 152.94456267356873, 154.0297999382019, 155.1068902015686, 156.1839804649353, 157.35712146759033, 158.53026247024536, 159.74217247962952, 160.95408248901367, 162.082622051239, 163.21116161346436, 164.39289712905884, 165.57463264465332, 166.7457790374756, 167.91692543029785, 169.0250208377838, 170.13311624526978, 171.26512217521667, 172.39712810516357, 173.54269790649414, 174.6882677078247, 175.79963636398315, 176.9110050201416, 177.94001054763794, 178.96901607513428, 180.01390266418457, 181.05878925323486, 182.22962975502014, 183.40047025680542, 185.08129930496216, 186.7621283531189, 188.05828213691711, 189.35443592071533, 190.5273118019104, 191.70018768310547, 192.81387066841125, 193.92755365371704, 195.1400113105774, 196.35246896743774, 197.41588854789734, 198.47930812835693, 199.57867527008057, 200.6780424118042, 201.7584047317505, 202.83876705169678, 203.97502422332764, 205.1112813949585, 206.29186987876892, 207.47245836257935, 208.61768198013306, 209.76290559768677, 211.00872540473938, 212.254545211792, 213.34232783317566, 214.43011045455933, 215.92615866661072, 217.4222068786621, 218.54421949386597, 219.66623210906982, 220.78110313415527, 221.89597415924072, 223.03174424171448, 224.16751432418823, 225.28817081451416, 226.4088273048401, 227.55371022224426, 228.69859313964844, 229.87138414382935, 231.04417514801025, 232.34732055664062, 233.650465965271, 234.91864347457886, 236.18682098388672, 238.5966546535492, 241.00648832321167]
[55.0, 55.0, 63.16, 63.16, 75.16, 75.16, 81.48, 81.48, 86.6, 86.6, 88.36, 88.36, 90.0, 90.0, 87.78, 87.78, 90.72, 90.72, 91.06, 91.06, 91.78, 91.78, 92.4, 92.4, 93.24, 93.24, 92.96, 92.96, 92.58, 92.58, 92.46, 92.46, 92.66, 92.66, 91.68, 91.68, 91.62, 91.62, 91.92, 91.92, 91.82, 91.82, 92.18, 92.18, 91.74, 91.74, 90.1, 90.1, 90.44, 90.44, 90.32, 90.32, 90.42, 90.42, 90.52, 90.52, 90.58, 90.58, 90.54, 90.54, 91.44, 91.44, 91.32, 91.32, 91.24, 91.24, 91.22, 91.22, 91.1, 91.1, 90.92, 90.92, 90.88, 90.88, 90.92, 90.92, 90.58, 90.58, 90.28, 90.28, 90.02, 90.02, 89.98, 89.98, 89.7, 89.7, 90.32, 90.32, 90.04, 90.04, 90.06, 90.06, 89.82, 89.82, 89.62, 89.62, 89.58, 89.58, 89.5, 89.5, 89.62, 89.62, 90.14, 90.14, 90.36, 90.36, 90.32, 90.32, 90.68, 90.68, 89.8, 89.8, 89.84, 89.84, 89.9, 89.9, 90.22, 90.22, 90.14, 90.14, 89.78, 89.78, 89.32, 89.32, 89.22, 89.22, 89.22, 89.22, 89.4, 89.4, 89.42, 89.42, 89.5, 89.5, 89.48, 89.48, 89.4, 89.4, 89.38, 89.38, 89.9, 89.9, 89.96, 89.96, 89.94, 89.94, 90.04, 90.04, 90.08, 90.08, 90.36, 90.36, 90.3, 90.3, 90.3, 90.3, 90.22, 90.22, 90.06, 90.06, 90.08, 90.08, 90.5, 90.5, 90.52, 90.52, 90.62, 90.62, 89.42, 89.42, 89.6, 89.6, 90.14, 90.14, 90.16, 90.16, 90.14, 90.14, 89.94, 89.94, 90.14, 90.14, 90.26, 90.26, 90.08, 90.08, 90.52, 90.52, 90.48, 90.48, 90.56, 90.56, 90.44, 90.44, 90.7, 90.7, 90.6, 90.6, 90.98, 90.98, 88.84, 88.84]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 4, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.620, Test loss: 1.590, Test accuracy: 42.40
Round   0, Global train loss: 1.620, Global test loss: 1.590, Global test accuracy: 42.34
Round   1, Train loss: 1.554, Test loss: 1.464, Test accuracy: 62.22
Round   1, Global train loss: 1.554, Global test loss: 1.463, Global test accuracy: 62.46
Round   2, Train loss: 1.591, Test loss: 1.455, Test accuracy: 69.72
Round   2, Global train loss: 1.591, Global test loss: 1.453, Global test accuracy: 70.36
Round   3, Train loss: 1.402, Test loss: 1.269, Test accuracy: 80.56
Round   3, Global train loss: 1.402, Global test loss: 1.243, Global test accuracy: 79.60
Round   4, Train loss: 1.377, Test loss: 1.210, Test accuracy: 82.14
Round   4, Global train loss: 1.377, Global test loss: 1.193, Global test accuracy: 80.90
Round   5, Train loss: 1.420, Test loss: 1.187, Test accuracy: 89.08
Round   5, Global train loss: 1.420, Global test loss: 1.167, Global test accuracy: 92.64
Round   6, Train loss: 1.091, Test loss: 1.093, Test accuracy: 90.96
Round   6, Global train loss: 1.091, Global test loss: 1.045, Global test accuracy: 91.26
Round   7, Train loss: 1.236, Test loss: 1.085, Test accuracy: 91.88
Round   7, Global train loss: 1.236, Global test loss: 1.059, Global test accuracy: 91.16
Round   8, Train loss: 1.471, Test loss: 1.129, Test accuracy: 92.44
Round   8, Global train loss: 1.471, Global test loss: 1.155, Global test accuracy: 94.26
Round   9, Train loss: 1.190, Test loss: 1.088, Test accuracy: 93.64
Round   9, Global train loss: 1.190, Global test loss: 1.029, Global test accuracy: 95.78
Round  10, Train loss: 1.030, Test loss: 1.053, Test accuracy: 93.92
Round  10, Global train loss: 1.030, Global test loss: 1.000, Global test accuracy: 94.44
Round  11, Train loss: 1.388, Test loss: 1.086, Test accuracy: 93.28
Round  11, Global train loss: 1.388, Global test loss: 1.069, Global test accuracy: 95.50
Round  12, Train loss: 1.214, Test loss: 1.084, Test accuracy: 93.46
Round  12, Global train loss: 1.214, Global test loss: 1.048, Global test accuracy: 93.08
Round  13, Train loss: 1.171, Test loss: 1.070, Test accuracy: 93.52
Round  13, Global train loss: 1.171, Global test loss: 1.005, Global test accuracy: 96.40
Round  14, Train loss: 1.095, Test loss: 1.059, Test accuracy: 93.58
Round  14, Global train loss: 1.095, Global test loss: 1.005, Global test accuracy: 95.00
Round  15, Train loss: 1.163, Test loss: 1.058, Test accuracy: 93.72
Round  15, Global train loss: 1.163, Global test loss: 0.991, Global test accuracy: 96.38
Round  16, Train loss: 1.168, Test loss: 1.066, Test accuracy: 93.50
Round  16, Global train loss: 1.168, Global test loss: 0.990, Global test accuracy: 96.80
Round  17, Train loss: 1.367, Test loss: 1.095, Test accuracy: 91.94
Round  17, Global train loss: 1.367, Global test loss: 1.071, Global test accuracy: 95.96
Round  18, Train loss: 1.239, Test loss: 1.084, Test accuracy: 92.26
Round  18, Global train loss: 1.239, Global test loss: 1.031, Global test accuracy: 96.32
Round  19, Train loss: 1.006, Test loss: 1.058, Test accuracy: 93.70
Round  19, Global train loss: 1.006, Global test loss: 0.981, Global test accuracy: 95.58
Round  20, Train loss: 1.564, Test loss: 1.111, Test accuracy: 89.98
Round  20, Global train loss: 1.564, Global test loss: 1.176, Global test accuracy: 96.02
Round  21, Train loss: 1.215, Test loss: 1.101, Test accuracy: 90.70
Round  21, Global train loss: 1.215, Global test loss: 1.055, Global test accuracy: 92.78
Round  22, Train loss: 1.146, Test loss: 1.074, Test accuracy: 93.14
Round  22, Global train loss: 1.146, Global test loss: 0.985, Global test accuracy: 97.02
Round  23, Train loss: 0.989, Test loss: 1.056, Test accuracy: 93.38
Round  23, Global train loss: 0.989, Global test loss: 0.978, Global test accuracy: 95.64
Round  24, Train loss: 1.371, Test loss: 1.090, Test accuracy: 91.22
Round  24, Global train loss: 1.371, Global test loss: 1.063, Global test accuracy: 96.80
Round  25, Train loss: 1.560, Test loss: 1.140, Test accuracy: 86.90
Round  25, Global train loss: 1.560, Global test loss: 1.265, Global test accuracy: 85.86
Round  26, Train loss: 1.271, Test loss: 1.109, Test accuracy: 89.74
Round  26, Global train loss: 1.271, Global test loss: 1.068, Global test accuracy: 94.66
Round  27, Train loss: 0.957, Test loss: 1.058, Test accuracy: 93.06
Round  27, Global train loss: 0.957, Global test loss: 0.953, Global test accuracy: 97.22
Round  28, Train loss: 1.179, Test loss: 1.065, Test accuracy: 92.48
Round  28, Global train loss: 1.179, Global test loss: 1.030, Global test accuracy: 91.94
Round  29, Train loss: 1.345, Test loss: 1.090, Test accuracy: 90.84
Round  29, Global train loss: 1.345, Global test loss: 1.048, Global test accuracy: 96.96
Round  30, Train loss: 1.227, Test loss: 1.083, Test accuracy: 90.96
Round  30, Global train loss: 1.227, Global test loss: 1.019, Global test accuracy: 96.96
Round  31, Train loss: 1.325, Test loss: 1.097, Test accuracy: 89.78
Round  31, Global train loss: 1.325, Global test loss: 1.050, Global test accuracy: 96.06
Round  32, Train loss: 1.227, Test loss: 1.095, Test accuracy: 89.30
Round  32, Global train loss: 1.227, Global test loss: 1.044, Global test accuracy: 96.16
Round  33, Train loss: 1.524, Test loss: 1.144, Test accuracy: 85.22
Round  33, Global train loss: 1.524, Global test loss: 1.210, Global test accuracy: 93.24
Round  34, Train loss: 1.345, Test loss: 1.119, Test accuracy: 87.72
Round  34, Global train loss: 1.345, Global test loss: 1.087, Global test accuracy: 96.00
Round  35, Train loss: 1.212, Test loss: 1.094, Test accuracy: 89.80
Round  35, Global train loss: 1.212, Global test loss: 1.023, Global test accuracy: 96.54
Round  36, Train loss: 1.220, Test loss: 1.091, Test accuracy: 89.68
Round  36, Global train loss: 1.220, Global test loss: 1.031, Global test accuracy: 96.22
Round  37, Train loss: 1.208, Test loss: 1.097, Test accuracy: 89.12
Round  37, Global train loss: 1.208, Global test loss: 1.051, Global test accuracy: 94.94
Round  38, Train loss: 1.215, Test loss: 1.087, Test accuracy: 89.72
Round  38, Global train loss: 1.215, Global test loss: 1.033, Global test accuracy: 96.16
Round  39, Train loss: 1.163, Test loss: 1.076, Test accuracy: 90.76
Round  39, Global train loss: 1.163, Global test loss: 1.014, Global test accuracy: 94.32
Round  40, Train loss: 1.309, Test loss: 1.099, Test accuracy: 88.30
Round  40, Global train loss: 1.309, Global test loss: 1.050, Global test accuracy: 95.54
Round  41, Train loss: 1.338, Test loss: 1.125, Test accuracy: 85.94
Round  41, Global train loss: 1.338, Global test loss: 1.104, Global test accuracy: 94.82
Round  42, Train loss: 1.012, Test loss: 1.067, Test accuracy: 91.44
Round  42, Global train loss: 1.012, Global test loss: 0.967, Global test accuracy: 97.06
Round  43, Train loss: 1.133, Test loss: 1.064, Test accuracy: 90.98
Round  43, Global train loss: 1.133, Global test loss: 0.978, Global test accuracy: 97.00
Round  44, Train loss: 1.161, Test loss: 1.076, Test accuracy: 89.18
Round  44, Global train loss: 1.161, Global test loss: 1.018, Global test accuracy: 94.82
Round  45, Train loss: 1.180, Test loss: 1.080, Test accuracy: 89.20
Round  45, Global train loss: 1.180, Global test loss: 0.993, Global test accuracy: 96.94
Round  46, Train loss: 1.325, Test loss: 1.116, Test accuracy: 84.98
Round  46, Global train loss: 1.325, Global test loss: 1.091, Global test accuracy: 92.82
Round  47, Train loss: 1.319, Test loss: 1.145, Test accuracy: 82.54
Round  47, Global train loss: 1.319, Global test loss: 1.120, Global test accuracy: 92.48
Round  48, Train loss: 1.486, Test loss: 1.196, Test accuracy: 78.68
Round  48, Global train loss: 1.486, Global test loss: 1.260, Global test accuracy: 81.00
Round  49, Train loss: 1.306, Test loss: 1.149, Test accuracy: 83.12
Round  49, Global train loss: 1.306, Global test loss: 1.107, Global test accuracy: 91.88
Round  50, Train loss: 1.363, Test loss: 1.183, Test accuracy: 78.96
Round  50, Global train loss: 1.363, Global test loss: 1.225, Global test accuracy: 78.70
Round  51, Train loss: 1.169, Test loss: 1.091, Test accuracy: 87.34
Round  51, Global train loss: 1.169, Global test loss: 1.047, Global test accuracy: 92.10
Round  52, Train loss: 0.966, Test loss: 1.033, Test accuracy: 92.80
Round  52, Global train loss: 0.966, Global test loss: 0.964, Global test accuracy: 96.24
Round  53, Train loss: 1.317, Test loss: 1.113, Test accuracy: 84.10
Round  53, Global train loss: 1.317, Global test loss: 1.088, Global test accuracy: 91.24
Round  54, Train loss: 1.281, Test loss: 1.124, Test accuracy: 83.08
Round  54, Global train loss: 1.281, Global test loss: 1.093, Global test accuracy: 91.70
Round  55, Train loss: 1.019, Test loss: 1.060, Test accuracy: 89.86
Round  55, Global train loss: 1.019, Global test loss: 0.984, Global test accuracy: 95.86
Round  56, Train loss: 1.102, Test loss: 1.053, Test accuracy: 89.96
Round  56, Global train loss: 1.102, Global test loss: 0.979, Global test accuracy: 95.82
Round  57, Train loss: 1.116, Test loss: 1.075, Test accuracy: 88.06
Round  57, Global train loss: 1.116, Global test loss: 1.003, Global test accuracy: 95.32
Round  58, Train loss: 1.113, Test loss: 1.074, Test accuracy: 88.06
Round  58, Global train loss: 1.113, Global test loss: 0.992, Global test accuracy: 95.82
Round  59, Train loss: 1.337, Test loss: 1.148, Test accuracy: 79.84
Round  59, Global train loss: 1.337, Global test loss: 1.118, Global test accuracy: 90.80
Round  60, Train loss: 1.115, Test loss: 1.103, Test accuracy: 85.20
Round  60, Global train loss: 1.115, Global test loss: 1.024, Global test accuracy: 93.64
Round  61, Train loss: 1.099, Test loss: 1.072, Test accuracy: 87.48
Round  61, Global train loss: 1.099, Global test loss: 0.987, Global test accuracy: 95.80
Round  62, Train loss: 1.258, Test loss: 1.166, Test accuracy: 78.44
Round  62, Global train loss: 1.258, Global test loss: 1.129, Global test accuracy: 87.48
Round  63, Train loss: 1.261, Test loss: 1.127, Test accuracy: 82.54
Round  63, Global train loss: 1.261, Global test loss: 1.081, Global test accuracy: 90.40
Round  64, Train loss: 1.096, Test loss: 1.100, Test accuracy: 84.90
Round  64, Global train loss: 1.096, Global test loss: 1.029, Global test accuracy: 92.52
Round  65, Train loss: 1.258, Test loss: 1.130, Test accuracy: 83.10
Round  65, Global train loss: 1.258, Global test loss: 1.084, Global test accuracy: 90.44
Round  66, Train loss: 1.004, Test loss: 1.053, Test accuracy: 89.94
Round  66, Global train loss: 1.004, Global test loss: 0.982, Global test accuracy: 95.58
Round  67, Train loss: 1.136, Test loss: 1.085, Test accuracy: 86.66
Round  67, Global train loss: 1.136, Global test loss: 1.016, Global test accuracy: 94.02
Round  68, Train loss: 1.247, Test loss: 1.157, Test accuracy: 79.70
Round  68, Global train loss: 1.247, Global test loss: 1.126, Global test accuracy: 85.80
Round  69, Train loss: 1.097, Test loss: 1.091, Test accuracy: 86.36
Round  69, Global train loss: 1.097, Global test loss: 1.027, Global test accuracy: 91.90
Round  70, Train loss: 0.985, Test loss: 1.036, Test accuracy: 91.24
Round  70, Global train loss: 0.985, Global test loss: 0.967, Global test accuracy: 96.22
Round  71, Train loss: 1.228, Test loss: 1.129, Test accuracy: 81.32
Round  71, Global train loss: 1.228, Global test loss: 1.066, Global test accuracy: 91.30
Round  72, Train loss: 1.095, Test loss: 1.116, Test accuracy: 83.16
Round  72, Global train loss: 1.095, Global test loss: 1.049, Global test accuracy: 89.80
Round  73, Train loss: 1.216, Test loss: 1.149, Test accuracy: 80.06
Round  73, Global train loss: 1.216, Global test loss: 1.107, Global test accuracy: 86.46
Round  74, Train loss: 1.202, Test loss: 1.228, Test accuracy: 70.70
Round  74, Global train loss: 1.202, Global test loss: 1.196, Global test accuracy: 77.60
Round  75, Train loss: 1.212, Test loss: 1.179, Test accuracy: 76.32
Round  75, Global train loss: 1.212, Global test loss: 1.147, Global test accuracy: 82.20
Round  76, Train loss: 1.059, Test loss: 1.106, Test accuracy: 83.82
Round  76, Global train loss: 1.059, Global test loss: 1.049, Global test accuracy: 88.64
Round  77, Train loss: 1.062, Test loss: 1.113, Test accuracy: 82.94
Round  77, Global train loss: 1.062, Global test loss: 1.046, Global test accuracy: 89.36
Round  78, Train loss: 1.050, Test loss: 1.106, Test accuracy: 83.22
Round  78, Global train loss: 1.050, Global test loss: 1.036, Global test accuracy: 90.46
Round  79, Train loss: 1.071, Test loss: 1.088, Test accuracy: 85.24
Round  79, Global train loss: 1.071, Global test loss: 1.034, Global test accuracy: 89.92
Round  80, Train loss: 1.062, Test loss: 1.070, Test accuracy: 87.00
Round  80, Global train loss: 1.062, Global test loss: 1.000, Global test accuracy: 93.42
Round  81, Train loss: 1.053, Test loss: 1.063, Test accuracy: 87.60
Round  81, Global train loss: 1.053, Global test loss: 0.998, Global test accuracy: 93.40
Round  82, Train loss: 1.178, Test loss: 1.175, Test accuracy: 76.42
Round  82, Global train loss: 1.178, Global test loss: 1.129, Global test accuracy: 83.70
Round  83, Train loss: 1.180, Test loss: 1.231, Test accuracy: 70.64
Round  83, Global train loss: 1.180, Global test loss: 1.193, Global test accuracy: 76.90
Round  84, Train loss: 0.980, Test loss: 1.034, Test accuracy: 90.70
Round  84, Global train loss: 0.980, Global test loss: 0.965, Global test accuracy: 95.42
Round  85, Train loss: 1.101, Test loss: 1.096, Test accuracy: 84.18
Round  85, Global train loss: 1.101, Global test loss: 1.063, Global test accuracy: 89.02
Round  86, Train loss: 1.077, Test loss: 1.112, Test accuracy: 83.08
Round  86, Global train loss: 1.077, Global test loss: 1.043, Global test accuracy: 90.92
Round  87, Train loss: 1.108, Test loss: 1.120, Test accuracy: 81.80
Round  87, Global train loss: 1.108, Global test loss: 1.048, Global test accuracy: 90.36
Round  88, Train loss: 1.065, Test loss: 1.156, Test accuracy: 78.02
Round  88, Global train loss: 1.065, Global test loss: 1.081, Global test accuracy: 86.62
Round  89, Train loss: 1.124, Test loss: 1.213, Test accuracy: 71.50
Round  89, Global train loss: 1.124, Global test loss: 1.161, Global test accuracy: 79.34
Round  90, Train loss: 1.269, Test loss: 1.318, Test accuracy: 59.64
Round  90, Global train loss: 1.269, Global test loss: 1.333, Global test accuracy: 59.76
Round  91, Train loss: 1.172, Test loss: 1.238, Test accuracy: 69.20
Round  91, Global train loss: 1.172, Global test loss: 1.207, Global test accuracy: 73.48/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.058, Test loss: 1.126, Test accuracy: 81.34
Round  92, Global train loss: 1.058, Global test loss: 1.080, Global test accuracy: 85.34
Round  93, Train loss: 1.120, Test loss: 1.221, Test accuracy: 71.04
Round  93, Global train loss: 1.120, Global test loss: 1.189, Global test accuracy: 75.40
Round  94, Train loss: 1.118, Test loss: 1.220, Test accuracy: 70.56
Round  94, Global train loss: 1.118, Global test loss: 1.200, Global test accuracy: 72.82
Round  95, Train loss: 1.050, Test loss: 1.087, Test accuracy: 85.28
Round  95, Global train loss: 1.050, Global test loss: 1.038, Global test accuracy: 89.80
Round  96, Train loss: 1.047, Test loss: 1.117, Test accuracy: 81.66
Round  96, Global train loss: 1.047, Global test loss: 1.095, Global test accuracy: 83.98
Round  97, Train loss: 1.130, Test loss: 1.252, Test accuracy: 67.10
Round  97, Global train loss: 1.130, Global test loss: 1.245, Global test accuracy: 67.36
Round  98, Train loss: 1.032, Test loss: 1.103, Test accuracy: 82.90
Round  98, Global train loss: 1.032, Global test loss: 1.041, Global test accuracy: 88.82
Round  99, Train loss: 1.014, Test loss: 1.064, Test accuracy: 86.80
Round  99, Global train loss: 1.014, Global test loss: 1.015, Global test accuracy: 91.26
Final Round, Train loss: 1.071, Test loss: 1.076, Test accuracy: 85.10
Final Round, Global train loss: 1.071, Global test loss: 1.015, Global test accuracy: 91.26
Average accuracy final 10 rounds: 75.55199999999999
708.0612967014313
[1.4944274425506592, 2.795254945755005, 4.1043407917022705, 5.3031182289123535, 6.574322462081909, 7.953263282775879, 9.318893432617188, 10.535439014434814, 11.757160425186157, 13.125718116760254, 14.349820852279663, 15.66317343711853, 17.021385431289673, 18.348472595214844, 19.618746995925903, 21.008190631866455, 22.246222257614136, 23.5502507686615, 24.730570554733276, 25.94583225250244, 27.21043300628662, 28.507091760635376, 29.72491216659546, 30.918448209762573, 32.25131320953369, 33.55880403518677, 34.83829092979431, 36.073036432266235, 37.427356243133545, 38.6508002281189, 39.89683532714844, 41.10806703567505, 42.29254198074341, 43.641971588134766, 44.89061713218689, 46.19060468673706, 47.48743295669556, 48.67569327354431, 49.90992712974548, 51.15440559387207, 52.412286043167114, 53.64388465881348, 54.87038612365723, 56.22019839286804, 57.49215221405029, 58.97794842720032, 60.26852750778198, 61.4994900226593, 62.73312258720398, 64.03682088851929, 65.26762127876282, 66.57106637954712, 67.83346557617188, 69.18998146057129, 70.4587652683258, 71.83405804634094, 73.16538786888123, 74.51628279685974, 75.86709713935852, 77.21889781951904, 78.42348790168762, 79.71494269371033, 80.98728203773499, 82.23421812057495, 83.5147294998169, 84.81715846061707, 86.14088606834412, 87.67743873596191, 88.94556617736816, 90.13799858093262, 91.36149382591248, 92.78487157821655, 94.03386116027832, 95.21936559677124, 96.86256742477417, 98.27826690673828, 99.5968668460846, 101.16287064552307, 102.61404323577881, 104.29651618003845, 105.98084139823914, 107.41668128967285, 109.12759184837341, 110.40267753601074, 111.75568962097168, 113.12922072410583, 114.4884660243988, 115.82171940803528, 117.29134964942932, 118.70030212402344, 120.05899357795715, 121.32794117927551, 122.62600016593933, 123.92664074897766, 125.2974705696106, 126.75832891464233, 128.04952311515808, 129.37152314186096, 130.76742124557495, 132.95025634765625, 135.42860627174377]
[42.4, 62.22, 69.72, 80.56, 82.14, 89.08, 90.96, 91.88, 92.44, 93.64, 93.92, 93.28, 93.46, 93.52, 93.58, 93.72, 93.5, 91.94, 92.26, 93.7, 89.98, 90.7, 93.14, 93.38, 91.22, 86.9, 89.74, 93.06, 92.48, 90.84, 90.96, 89.78, 89.3, 85.22, 87.72, 89.8, 89.68, 89.12, 89.72, 90.76, 88.3, 85.94, 91.44, 90.98, 89.18, 89.2, 84.98, 82.54, 78.68, 83.12, 78.96, 87.34, 92.8, 84.1, 83.08, 89.86, 89.96, 88.06, 88.06, 79.84, 85.2, 87.48, 78.44, 82.54, 84.9, 83.1, 89.94, 86.66, 79.7, 86.36, 91.24, 81.32, 83.16, 80.06, 70.7, 76.32, 83.82, 82.94, 83.22, 85.24, 87.0, 87.6, 76.42, 70.64, 90.7, 84.18, 83.08, 81.8, 78.02, 71.5, 59.64, 69.2, 81.34, 71.04, 70.56, 85.28, 81.66, 67.1, 82.9, 86.8, 85.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.621, Test loss: 1.584, Test accuracy: 39.06
Round   0, Global train loss: 1.621, Global test loss: 1.584, Global test accuracy: 38.72
Round   1, Train loss: 1.568, Test loss: 1.503, Test accuracy: 62.32
Round   1, Global train loss: 1.568, Global test loss: 1.503, Global test accuracy: 61.76
Round   2, Train loss: 1.477, Test loss: 1.335, Test accuracy: 77.72
Round   2, Global train loss: 1.477, Global test loss: 1.331, Global test accuracy: 77.56
Round   3, Train loss: 1.359, Test loss: 1.190, Test accuracy: 86.02
Round   3, Global train loss: 1.359, Global test loss: 1.181, Global test accuracy: 85.42
Round   4, Train loss: 1.286, Test loss: 1.115, Test accuracy: 90.68
Round   4, Global train loss: 1.286, Global test loss: 1.098, Global test accuracy: 91.70
Round   5, Train loss: 1.254, Test loss: 1.085, Test accuracy: 92.08
Round   5, Global train loss: 1.254, Global test loss: 1.058, Global test accuracy: 94.36
Round   6, Train loss: 1.240, Test loss: 1.071, Test accuracy: 92.60
Round   6, Global train loss: 1.240, Global test loss: 1.038, Global test accuracy: 95.30
Round   7, Train loss: 1.232, Test loss: 1.064, Test accuracy: 92.98
Round   7, Global train loss: 1.232, Global test loss: 1.026, Global test accuracy: 95.68
Round   8, Train loss: 1.226, Test loss: 1.060, Test accuracy: 93.08
Round   8, Global train loss: 1.226, Global test loss: 1.019, Global test accuracy: 95.70
Round   9, Train loss: 1.222, Test loss: 1.058, Test accuracy: 93.08
Round   9, Global train loss: 1.222, Global test loss: 1.013, Global test accuracy: 95.84
Round  10, Train loss: 1.196, Test loss: 1.061, Test accuracy: 92.62
Round  10, Global train loss: 1.196, Global test loss: 1.033, Global test accuracy: 93.38
Round  11, Train loss: 1.232, Test loss: 1.033, Test accuracy: 93.30
Round  11, Global train loss: 1.232, Global test loss: 1.009, Global test accuracy: 96.34
Round  12, Train loss: 1.153, Test loss: 1.030, Test accuracy: 93.86
Round  12, Global train loss: 1.153, Global test loss: 1.003, Global test accuracy: 94.92
Round  13, Train loss: 1.207, Test loss: 1.029, Test accuracy: 92.92
Round  13, Global train loss: 1.207, Global test loss: 1.009, Global test accuracy: 95.48
Round  14, Train loss: 0.996, Test loss: 1.026, Test accuracy: 93.98
Round  14, Global train loss: 0.996, Global test loss: 0.968, Global test accuracy: 96.00
Round  15, Train loss: 1.344, Test loss: 1.023, Test accuracy: 92.90
Round  15, Global train loss: 1.344, Global test loss: 1.053, Global test accuracy: 95.00
Round  16, Train loss: 1.095, Test loss: 1.027, Test accuracy: 93.54
Round  16, Global train loss: 1.095, Global test loss: 0.977, Global test accuracy: 96.36
Round  17, Train loss: 1.205, Test loss: 1.020, Test accuracy: 93.70
Round  17, Global train loss: 1.205, Global test loss: 0.992, Global test accuracy: 96.38
Round  18, Train loss: 1.081, Test loss: 1.024, Test accuracy: 92.82
Round  18, Global train loss: 1.081, Global test loss: 0.980, Global test accuracy: 95.68
Round  19, Train loss: 1.254, Test loss: 1.029, Test accuracy: 91.94
Round  19, Global train loss: 1.254, Global test loss: 1.080, Global test accuracy: 84.80
Round  20, Train loss: 1.071, Test loss: 1.022, Test accuracy: 92.84
Round  20, Global train loss: 1.071, Global test loss: 0.968, Global test accuracy: 96.44
Round  21, Train loss: 1.125, Test loss: 1.015, Test accuracy: 93.62
Round  21, Global train loss: 1.125, Global test loss: 0.993, Global test accuracy: 94.76
Round  22, Train loss: 1.066, Test loss: 1.018, Test accuracy: 93.12
Round  22, Global train loss: 1.066, Global test loss: 0.974, Global test accuracy: 95.90
Round  23, Train loss: 1.114, Test loss: 1.015, Test accuracy: 93.50
Round  23, Global train loss: 1.114, Global test loss: 0.977, Global test accuracy: 95.72
Round  24, Train loss: 1.056, Test loss: 1.017, Test accuracy: 93.02
Round  24, Global train loss: 1.056, Global test loss: 0.973, Global test accuracy: 96.18
Round  25, Train loss: 1.051, Test loss: 1.013, Test accuracy: 93.32
Round  25, Global train loss: 1.051, Global test loss: 0.960, Global test accuracy: 97.00
Round  26, Train loss: 0.976, Test loss: 1.007, Test accuracy: 93.72
Round  26, Global train loss: 0.976, Global test loss: 0.953, Global test accuracy: 96.62
Round  27, Train loss: 1.196, Test loss: 1.012, Test accuracy: 93.28
Round  27, Global train loss: 1.196, Global test loss: 1.005, Global test accuracy: 94.22
Round  28, Train loss: 1.086, Test loss: 1.021, Test accuracy: 92.80
Round  28, Global train loss: 1.086, Global test loss: 0.979, Global test accuracy: 95.30
Round  29, Train loss: 0.937, Test loss: 1.010, Test accuracy: 93.50
Round  29, Global train loss: 0.937, Global test loss: 0.948, Global test accuracy: 97.30
Round  30, Train loss: 1.189, Test loss: 1.010, Test accuracy: 93.54
Round  30, Global train loss: 1.189, Global test loss: 0.982, Global test accuracy: 96.28
Round  31, Train loss: 1.048, Test loss: 1.024, Test accuracy: 92.64
Round  31, Global train loss: 1.048, Global test loss: 0.964, Global test accuracy: 96.32
Round  32, Train loss: 0.933, Test loss: 1.010, Test accuracy: 93.44
Round  32, Global train loss: 0.933, Global test loss: 0.946, Global test accuracy: 97.26
Round  33, Train loss: 1.038, Test loss: 1.012, Test accuracy: 93.16
Round  33, Global train loss: 1.038, Global test loss: 0.957, Global test accuracy: 96.58
Round  34, Train loss: 1.068, Test loss: 1.006, Test accuracy: 93.92
Round  34, Global train loss: 1.068, Global test loss: 0.958, Global test accuracy: 96.96
Round  35, Train loss: 1.161, Test loss: 1.022, Test accuracy: 92.60
Round  35, Global train loss: 1.161, Global test loss: 0.990, Global test accuracy: 95.40
Round  36, Train loss: 0.933, Test loss: 1.013, Test accuracy: 93.56
Round  36, Global train loss: 0.933, Global test loss: 0.948, Global test accuracy: 97.18
Round  37, Train loss: 0.922, Test loss: 1.002, Test accuracy: 94.06
Round  37, Global train loss: 0.922, Global test loss: 0.942, Global test accuracy: 97.36
Round  38, Train loss: 1.058, Test loss: 0.999, Test accuracy: 94.16
Round  38, Global train loss: 1.058, Global test loss: 0.954, Global test accuracy: 96.98
Round  39, Train loss: 1.089, Test loss: 1.007, Test accuracy: 93.68
Round  39, Global train loss: 1.089, Global test loss: 0.979, Global test accuracy: 95.42
Round  40, Train loss: 1.152, Test loss: 1.027, Test accuracy: 91.98
Round  40, Global train loss: 1.152, Global test loss: 0.991, Global test accuracy: 95.64
Round  41, Train loss: 0.930, Test loss: 1.010, Test accuracy: 93.70
Round  41, Global train loss: 0.930, Global test loss: 0.946, Global test accuracy: 97.32
Round  42, Train loss: 1.159, Test loss: 1.022, Test accuracy: 92.22
Round  42, Global train loss: 1.159, Global test loss: 1.008, Global test accuracy: 94.46
Round  43, Train loss: 1.181, Test loss: 1.033, Test accuracy: 91.80
Round  43, Global train loss: 1.181, Global test loss: 1.006, Global test accuracy: 95.06
Round  44, Train loss: 1.101, Test loss: 1.025, Test accuracy: 92.40
Round  44, Global train loss: 1.101, Global test loss: 0.985, Global test accuracy: 95.24
Round  45, Train loss: 0.929, Test loss: 1.005, Test accuracy: 93.98
Round  45, Global train loss: 0.929, Global test loss: 0.945, Global test accuracy: 97.12
Round  46, Train loss: 1.141, Test loss: 1.032, Test accuracy: 90.72
Round  46, Global train loss: 1.141, Global test loss: 1.002, Global test accuracy: 94.58
Round  47, Train loss: 1.024, Test loss: 1.033, Test accuracy: 91.48
Round  47, Global train loss: 1.024, Global test loss: 0.973, Global test accuracy: 96.04
Round  48, Train loss: 1.031, Test loss: 1.027, Test accuracy: 91.80
Round  48, Global train loss: 1.031, Global test loss: 0.966, Global test accuracy: 96.54
Round  49, Train loss: 1.024, Test loss: 1.023, Test accuracy: 91.78
Round  49, Global train loss: 1.024, Global test loss: 0.971, Global test accuracy: 95.86
Round  50, Train loss: 0.920, Test loss: 1.005, Test accuracy: 93.46
Round  50, Global train loss: 0.920, Global test loss: 0.943, Global test accuracy: 97.42
Round  51, Train loss: 1.087, Test loss: 1.009, Test accuracy: 93.12
Round  51, Global train loss: 1.087, Global test loss: 0.977, Global test accuracy: 95.42
Round  52, Train loss: 1.080, Test loss: 1.020, Test accuracy: 92.24
Round  52, Global train loss: 1.080, Global test loss: 0.983, Global test accuracy: 95.12
Round  53, Train loss: 0.947, Test loss: 1.006, Test accuracy: 93.54
Round  53, Global train loss: 0.947, Global test loss: 0.954, Global test accuracy: 96.44
Round  54, Train loss: 1.122, Test loss: 1.042, Test accuracy: 90.24
Round  54, Global train loss: 1.122, Global test loss: 1.015, Global test accuracy: 93.48
Round  55, Train loss: 1.076, Test loss: 1.028, Test accuracy: 91.62
Round  55, Global train loss: 1.076, Global test loss: 0.995, Global test accuracy: 94.40
Round  56, Train loss: 1.111, Test loss: 1.081, Test accuracy: 86.18
Round  56, Global train loss: 1.111, Global test loss: 1.057, Global test accuracy: 89.58
Round  57, Train loss: 0.955, Test loss: 1.019, Test accuracy: 91.84
Round  57, Global train loss: 0.955, Global test loss: 0.966, Global test accuracy: 95.32
Round  58, Train loss: 1.137, Test loss: 1.053, Test accuracy: 87.88
Round  58, Global train loss: 1.137, Global test loss: 1.022, Global test accuracy: 93.00
Round  59, Train loss: 0.930, Test loss: 1.016, Test accuracy: 92.16
Round  59, Global train loss: 0.930, Global test loss: 0.951, Global test accuracy: 96.78
Round  60, Train loss: 1.028, Test loss: 1.029, Test accuracy: 89.94
Round  60, Global train loss: 1.028, Global test loss: 0.999, Global test accuracy: 92.46
Round  61, Train loss: 1.214, Test loss: 1.147, Test accuracy: 78.50
Round  61, Global train loss: 1.214, Global test loss: 1.162, Global test accuracy: 81.30
Round  62, Train loss: 0.962, Test loss: 1.028, Test accuracy: 91.16
Round  62, Global train loss: 0.962, Global test loss: 0.959, Global test accuracy: 95.94
Round  63, Train loss: 1.099, Test loss: 1.080, Test accuracy: 85.60
Round  63, Global train loss: 1.099, Global test loss: 1.043, Global test accuracy: 91.20
Round  64, Train loss: 1.026, Test loss: 1.075, Test accuracy: 85.96
Round  64, Global train loss: 1.026, Global test loss: 1.029, Global test accuracy: 90.54
Round  65, Train loss: 0.929, Test loss: 1.015, Test accuracy: 91.80
Round  65, Global train loss: 0.929, Global test loss: 0.952, Global test accuracy: 96.54
Round  66, Train loss: 0.933, Test loss: 1.001, Test accuracy: 92.84
Round  66, Global train loss: 0.933, Global test loss: 0.954, Global test accuracy: 95.86
Round  67, Train loss: 1.001, Test loss: 1.016, Test accuracy: 91.66
Round  67, Global train loss: 1.001, Global test loss: 0.962, Global test accuracy: 96.12
Round  68, Train loss: 1.083, Test loss: 1.108, Test accuracy: 82.46
Round  68, Global train loss: 1.083, Global test loss: 1.071, Global test accuracy: 87.68
Round  69, Train loss: 1.022, Test loss: 1.063, Test accuracy: 87.26
Round  69, Global train loss: 1.022, Global test loss: 1.025, Global test accuracy: 90.46
Round  70, Train loss: 1.038, Test loss: 1.029, Test accuracy: 90.60
Round  70, Global train loss: 1.038, Global test loss: 0.985, Global test accuracy: 94.58
Round  71, Train loss: 0.918, Test loss: 1.004, Test accuracy: 92.86
Round  71, Global train loss: 0.918, Global test loss: 0.949, Global test accuracy: 96.68
Round  72, Train loss: 0.927, Test loss: 0.999, Test accuracy: 93.00
Round  72, Global train loss: 0.927, Global test loss: 0.961, Global test accuracy: 95.34
Round  73, Train loss: 0.995, Test loss: 1.019, Test accuracy: 91.58
Round  73, Global train loss: 0.995, Global test loss: 0.970, Global test accuracy: 95.26
Round  74, Train loss: 1.002, Test loss: 1.039, Test accuracy: 89.84
Round  74, Global train loss: 1.002, Global test loss: 1.003, Global test accuracy: 92.06
Round  75, Train loss: 1.064, Test loss: 1.126, Test accuracy: 81.68
Round  75, Global train loss: 1.064, Global test loss: 1.095, Global test accuracy: 85.54
Round  76, Train loss: 1.011, Test loss: 1.061, Test accuracy: 87.86
Round  76, Global train loss: 1.011, Global test loss: 1.026, Global test accuracy: 90.56
Round  77, Train loss: 0.931, Test loss: 1.005, Test accuracy: 92.90
Round  77, Global train loss: 0.931, Global test loss: 0.963, Global test accuracy: 95.26
Round  78, Train loss: 0.996, Test loss: 1.048, Test accuracy: 88.86
Round  78, Global train loss: 0.996, Global test loss: 1.008, Global test accuracy: 91.76
Round  79, Train loss: 0.927, Test loss: 1.004, Test accuracy: 92.74
Round  79, Global train loss: 0.927, Global test loss: 0.962, Global test accuracy: 95.08
Round  80, Train loss: 0.917, Test loss: 0.987, Test accuracy: 94.06
Round  80, Global train loss: 0.917, Global test loss: 0.945, Global test accuracy: 96.80
Round  81, Train loss: 0.915, Test loss: 0.983, Test accuracy: 94.32
Round  81, Global train loss: 0.915, Global test loss: 0.942, Global test accuracy: 96.94
Round  82, Train loss: 0.914, Test loss: 0.981, Test accuracy: 94.56
Round  82, Global train loss: 0.914, Global test loss: 0.941, Global test accuracy: 96.94
Round  83, Train loss: 0.914, Test loss: 0.980, Test accuracy: 94.52
Round  83, Global train loss: 0.914, Global test loss: 0.941, Global test accuracy: 96.92
Round  84, Train loss: 0.913, Test loss: 0.979, Test accuracy: 94.72
Round  84, Global train loss: 0.913, Global test loss: 0.940, Global test accuracy: 96.94
Round  85, Train loss: 0.913, Test loss: 0.978, Test accuracy: 94.82
Round  85, Global train loss: 0.913, Global test loss: 0.939, Global test accuracy: 96.98
Round  86, Train loss: 0.913, Test loss: 0.978, Test accuracy: 94.88
Round  86, Global train loss: 0.913, Global test loss: 0.939, Global test accuracy: 96.98
Round  87, Train loss: 0.912, Test loss: 0.978, Test accuracy: 94.86
Round  87, Global train loss: 0.912, Global test loss: 0.939, Global test accuracy: 96.96
Round  88, Train loss: 0.912, Test loss: 0.978, Test accuracy: 94.88
Round  88, Global train loss: 0.912, Global test loss: 0.939, Global test accuracy: 97.02
Round  89, Train loss: 0.912, Test loss: 0.977, Test accuracy: 94.90
Round  89, Global train loss: 0.912, Global test loss: 0.939, Global test accuracy: 97.00
Round  90, Train loss: 0.912, Test loss: 0.977, Test accuracy: 94.96
Round  90, Global train loss: 0.912, Global test loss: 0.938, Global test accuracy: 97.04
Round  91, Train loss: 0.912, Test loss: 0.976, Test accuracy: 95.04
Round  91, Global train loss: 0.912, Global test loss: 0.938, Global test accuracy: 97.04/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 0.911, Test loss: 0.976, Test accuracy: 95.08
Round  92, Global train loss: 0.911, Global test loss: 0.938, Global test accuracy: 97.04
Round  93, Train loss: 0.911, Test loss: 0.976, Test accuracy: 95.06
Round  93, Global train loss: 0.911, Global test loss: 0.938, Global test accuracy: 97.04
Round  94, Train loss: 0.911, Test loss: 0.976, Test accuracy: 95.06
Round  94, Global train loss: 0.911, Global test loss: 0.937, Global test accuracy: 97.04
Round  95, Train loss: 0.911, Test loss: 0.976, Test accuracy: 95.02
Round  95, Global train loss: 0.911, Global test loss: 0.937, Global test accuracy: 97.08
Round  96, Train loss: 0.911, Test loss: 0.975, Test accuracy: 95.08
Round  96, Global train loss: 0.911, Global test loss: 0.937, Global test accuracy: 97.10
Round  97, Train loss: 0.911, Test loss: 0.975, Test accuracy: 95.12
Round  97, Global train loss: 0.911, Global test loss: 0.937, Global test accuracy: 97.18
Round  98, Train loss: 0.910, Test loss: 0.975, Test accuracy: 95.16
Round  98, Global train loss: 0.910, Global test loss: 0.937, Global test accuracy: 97.12
Round  99, Train loss: 1.017, Test loss: 1.013, Test accuracy: 91.68
Round  99, Global train loss: 1.017, Global test loss: 0.963, Global test accuracy: 95.78
Final Round, Train loss: 1.070, Test loss: 1.027, Test accuracy: 90.46
Final Round, Global train loss: 1.070, Global test loss: 0.963, Global test accuracy: 95.78
Average accuracy final 10 rounds: 94.726
1529.883419752121
[1.511808156967163, 3.0265560150146484, 4.6783928871154785, 6.198452949523926, 7.856417179107666, 9.531677007675171, 11.22919225692749, 13.028091192245483, 14.493641138076782, 16.026674509048462, 21.178664445877075, 29.774014711380005, 38.757352352142334, 47.65625858306885, 49.12625432014465, 58.161412954330444, 67.08050870895386, 76.0004653930664, 85.676114320755, 94.57649564743042, 103.17386865615845, 111.3913836479187, 119.67240476608276, 128.47814416885376, 137.09738159179688, 145.5051610469818, 147.00291895866394, 156.18939518928528, 164.9876527786255, 166.49393677711487, 175.10369682312012, 183.74435901641846, 185.17309474945068, 193.86591982841492, 202.71796941757202, 211.73875546455383, 213.2517113685608, 214.7167673110962, 223.2637529373169, 231.94372367858887, 241.2085828781128, 242.62884187698364, 251.40090203285217, 260.32351541519165, 268.6725826263428, 270.1877439022064, 279.2244222164154, 287.95541620254517, 296.8437342643738, 305.6761031150818, 307.1442015171051, 316.120751619339, 325.16018295288086, 326.60825204849243, 335.24433732032776, 343.7211022377014, 354.319256067276, 355.76114988327026, 364.695613861084, 366.07278180122375, 374.2414412498474, 383.0071156024933, 384.66733145713806, 393.3521053791046, 401.9339847564697, 403.28782296180725, 404.637446641922, 413.0497786998749, 421.71809792518616, 430.1139802932739, 438.52851271629333, 439.99700927734375, 441.4852018356323, 450.21336126327515, 458.76202940940857, 467.60991048812866, 476.24116230010986, 477.72711277008057, 486.22110772132874, 487.64232182502747, 489.1994423866272, 490.7589886188507, 492.18624997138977, 493.7008934020996, 495.03823590278625, 496.51049304008484, 497.9293854236603, 499.3831400871277, 500.8779950141907, 502.30089139938354, 503.67432618141174, 505.1118628978729, 506.52631998062134, 507.93007612228394, 509.4206109046936, 510.8044490814209, 512.3172149658203, 513.7469274997711, 515.1400933265686, 523.549831867218, 531.7628872394562]
[39.06, 62.32, 77.72, 86.02, 90.68, 92.08, 92.6, 92.98, 93.08, 93.08, 92.62, 93.3, 93.86, 92.92, 93.98, 92.9, 93.54, 93.7, 92.82, 91.94, 92.84, 93.62, 93.12, 93.5, 93.02, 93.32, 93.72, 93.28, 92.8, 93.5, 93.54, 92.64, 93.44, 93.16, 93.92, 92.6, 93.56, 94.06, 94.16, 93.68, 91.98, 93.7, 92.22, 91.8, 92.4, 93.98, 90.72, 91.48, 91.8, 91.78, 93.46, 93.12, 92.24, 93.54, 90.24, 91.62, 86.18, 91.84, 87.88, 92.16, 89.94, 78.5, 91.16, 85.6, 85.96, 91.8, 92.84, 91.66, 82.46, 87.26, 90.6, 92.86, 93.0, 91.58, 89.84, 81.68, 87.86, 92.9, 88.86, 92.74, 94.06, 94.32, 94.56, 94.52, 94.72, 94.82, 94.88, 94.86, 94.88, 94.9, 94.96, 95.04, 95.08, 95.06, 95.06, 95.02, 95.08, 95.12, 95.16, 91.68, 90.46]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 3, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.596, Test loss: 1.575, Test accuracy: 49.02
Round   0, Global train loss: 1.596, Global test loss: 1.576, Global test accuracy: 49.56
Round   1, Train loss: 1.445, Test loss: 1.295, Test accuracy: 80.06
Round   1, Global train loss: 1.445, Global test loss: 1.226, Global test accuracy: 89.86
Round   2, Train loss: 1.104, Test loss: 1.154, Test accuracy: 82.86
Round   2, Global train loss: 1.104, Global test loss: 0.990, Global test accuracy: 94.94
Round   3, Train loss: 1.264, Test loss: 1.192, Test accuracy: 81.56
Round   3, Global train loss: 1.264, Global test loss: 1.109, Global test accuracy: 91.50
Round   4, Train loss: 1.058, Test loss: 1.091, Test accuracy: 86.06
Round   4, Global train loss: 1.058, Global test loss: 0.980, Global test accuracy: 94.84
Round   5, Train loss: 1.248, Test loss: 1.057, Test accuracy: 88.18
Round   5, Global train loss: 1.248, Global test loss: 0.988, Global test accuracy: 95.26
Round   6, Train loss: 1.337, Test loss: 1.060, Test accuracy: 89.06
Round   6, Global train loss: 1.337, Global test loss: 1.111, Global test accuracy: 90.44
Round   7, Train loss: 1.214, Test loss: 1.031, Test accuracy: 89.84
Round   7, Global train loss: 1.214, Global test loss: 0.980, Global test accuracy: 94.66
Round   8, Train loss: 1.089, Test loss: 1.022, Test accuracy: 91.02
Round   8, Global train loss: 1.089, Global test loss: 1.023, Global test accuracy: 92.20
Round   9, Train loss: 1.135, Test loss: 1.015, Test accuracy: 91.38
Round   9, Global train loss: 1.135, Global test loss: 0.974, Global test accuracy: 95.26
Round  10, Train loss: 1.070, Test loss: 1.014, Test accuracy: 91.16
Round  10, Global train loss: 1.070, Global test loss: 0.960, Global test accuracy: 95.34
Round  11, Train loss: 1.160, Test loss: 1.013, Test accuracy: 91.10
Round  11, Global train loss: 1.160, Global test loss: 0.967, Global test accuracy: 95.26
Round  12, Train loss: 1.164, Test loss: 1.015, Test accuracy: 90.82
Round  12, Global train loss: 1.164, Global test loss: 0.961, Global test accuracy: 95.54
Round  13, Train loss: 1.062, Test loss: 1.017, Test accuracy: 90.46
Round  13, Global train loss: 1.062, Global test loss: 0.966, Global test accuracy: 94.90
Round  14, Train loss: 1.277, Test loss: 1.013, Test accuracy: 90.90
Round  14, Global train loss: 1.277, Global test loss: 1.036, Global test accuracy: 91.96
Round  15, Train loss: 1.165, Test loss: 1.013, Test accuracy: 90.70
Round  15, Global train loss: 1.165, Global test loss: 0.961, Global test accuracy: 95.48
Round  16, Train loss: 1.164, Test loss: 1.010, Test accuracy: 90.76
Round  16, Global train loss: 1.164, Global test loss: 0.994, Global test accuracy: 94.20
Round  17, Train loss: 1.048, Test loss: 1.008, Test accuracy: 90.96
Round  17, Global train loss: 1.048, Global test loss: 0.976, Global test accuracy: 95.00
Round  18, Train loss: 1.128, Test loss: 1.008, Test accuracy: 91.00
Round  18, Global train loss: 1.128, Global test loss: 0.976, Global test accuracy: 94.34
Round  19, Train loss: 1.136, Test loss: 1.002, Test accuracy: 92.22
Round  19, Global train loss: 1.136, Global test loss: 0.983, Global test accuracy: 94.62
Round  20, Train loss: 1.105, Test loss: 1.000, Test accuracy: 92.30
Round  20, Global train loss: 1.105, Global test loss: 0.960, Global test accuracy: 95.28
Round  21, Train loss: 1.230, Test loss: 1.002, Test accuracy: 91.84
Round  21, Global train loss: 1.230, Global test loss: 0.989, Global test accuracy: 93.46
Round  22, Train loss: 1.107, Test loss: 1.004, Test accuracy: 91.54
Round  22, Global train loss: 1.107, Global test loss: 0.966, Global test accuracy: 94.82
Round  23, Train loss: 1.113, Test loss: 1.005, Test accuracy: 91.26
Round  23, Global train loss: 1.113, Global test loss: 0.956, Global test accuracy: 95.64
Round  24, Train loss: 1.141, Test loss: 1.005, Test accuracy: 91.22
Round  24, Global train loss: 1.141, Global test loss: 0.956, Global test accuracy: 95.60
Round  25, Train loss: 1.155, Test loss: 1.003, Test accuracy: 91.26
Round  25, Global train loss: 1.155, Global test loss: 0.977, Global test accuracy: 94.34
Round  26, Train loss: 1.099, Test loss: 1.005, Test accuracy: 90.82
Round  26, Global train loss: 1.099, Global test loss: 0.971, Global test accuracy: 94.14
Round  27, Train loss: 1.123, Test loss: 1.006, Test accuracy: 90.52
Round  27, Global train loss: 1.123, Global test loss: 0.969, Global test accuracy: 94.58
Round  28, Train loss: 1.138, Test loss: 1.009, Test accuracy: 90.32
Round  28, Global train loss: 1.138, Global test loss: 0.972, Global test accuracy: 94.42
Round  29, Train loss: 1.097, Test loss: 1.009, Test accuracy: 90.20
Round  29, Global train loss: 1.097, Global test loss: 0.968, Global test accuracy: 94.98
Round  30, Train loss: 1.006, Test loss: 1.010, Test accuracy: 90.16
Round  30, Global train loss: 1.006, Global test loss: 0.954, Global test accuracy: 95.50
Round  31, Train loss: 1.005, Test loss: 1.010, Test accuracy: 90.22
Round  31, Global train loss: 1.005, Global test loss: 0.958, Global test accuracy: 95.20
Round  32, Train loss: 1.099, Test loss: 1.009, Test accuracy: 90.28
Round  32, Global train loss: 1.099, Global test loss: 0.964, Global test accuracy: 94.62
Round  33, Train loss: 1.086, Test loss: 1.010, Test accuracy: 90.16
Round  33, Global train loss: 1.086, Global test loss: 0.958, Global test accuracy: 95.34
Round  34, Train loss: 1.107, Test loss: 1.010, Test accuracy: 90.16
Round  34, Global train loss: 1.107, Global test loss: 0.955, Global test accuracy: 95.56
Round  35, Train loss: 1.129, Test loss: 1.013, Test accuracy: 89.76
Round  35, Global train loss: 1.129, Global test loss: 0.981, Global test accuracy: 92.76
Round  36, Train loss: 1.082, Test loss: 1.014, Test accuracy: 89.60
Round  36, Global train loss: 1.082, Global test loss: 0.958, Global test accuracy: 95.30
Round  37, Train loss: 1.005, Test loss: 1.015, Test accuracy: 89.56
Round  37, Global train loss: 1.005, Global test loss: 0.963, Global test accuracy: 94.92
Round  38, Train loss: 1.001, Test loss: 1.019, Test accuracy: 89.12
Round  38, Global train loss: 1.001, Global test loss: 0.964, Global test accuracy: 94.58
Round  39, Train loss: 1.017, Test loss: 1.020, Test accuracy: 89.08
Round  39, Global train loss: 1.017, Global test loss: 0.948, Global test accuracy: 95.94
Round  40, Train loss: 1.125, Test loss: 1.019, Test accuracy: 89.06
Round  40, Global train loss: 1.125, Global test loss: 0.960, Global test accuracy: 95.04
Round  41, Train loss: 1.087, Test loss: 1.016, Test accuracy: 89.40
Round  41, Global train loss: 1.087, Global test loss: 0.964, Global test accuracy: 94.80
Round  42, Train loss: 1.162, Test loss: 1.020, Test accuracy: 89.06
Round  42, Global train loss: 1.162, Global test loss: 0.988, Global test accuracy: 92.44
Round  43, Train loss: 1.157, Test loss: 1.020, Test accuracy: 88.94
Round  43, Global train loss: 1.157, Global test loss: 0.991, Global test accuracy: 92.20
Round  44, Train loss: 1.119, Test loss: 1.019, Test accuracy: 89.00
Round  44, Global train loss: 1.119, Global test loss: 0.980, Global test accuracy: 93.08
Round  45, Train loss: 1.015, Test loss: 1.019, Test accuracy: 89.00
Round  45, Global train loss: 1.015, Global test loss: 0.951, Global test accuracy: 95.66
Round  46, Train loss: 1.136, Test loss: 1.022, Test accuracy: 88.70
Round  46, Global train loss: 1.136, Global test loss: 0.961, Global test accuracy: 94.76
Round  47, Train loss: 1.134, Test loss: 1.021, Test accuracy: 88.74
Round  47, Global train loss: 1.134, Global test loss: 0.961, Global test accuracy: 94.84
Round  48, Train loss: 1.115, Test loss: 1.020, Test accuracy: 88.80
Round  48, Global train loss: 1.115, Global test loss: 0.961, Global test accuracy: 94.68
Round  49, Train loss: 1.113, Test loss: 1.022, Test accuracy: 88.62
Round  49, Global train loss: 1.113, Global test loss: 0.986, Global test accuracy: 92.32
Round  50, Train loss: 1.092, Test loss: 1.023, Test accuracy: 88.44
Round  50, Global train loss: 1.092, Global test loss: 0.951, Global test accuracy: 95.68
Round  51, Train loss: 1.074, Test loss: 1.022, Test accuracy: 88.66
Round  51, Global train loss: 1.074, Global test loss: 0.959, Global test accuracy: 95.18
Round  52, Train loss: 1.015, Test loss: 1.022, Test accuracy: 88.70
Round  52, Global train loss: 1.015, Global test loss: 0.947, Global test accuracy: 95.96
Round  53, Train loss: 1.100, Test loss: 1.021, Test accuracy: 88.68
Round  53, Global train loss: 1.100, Global test loss: 0.951, Global test accuracy: 95.62
Round  54, Train loss: 1.102, Test loss: 1.020, Test accuracy: 88.68
Round  54, Global train loss: 1.102, Global test loss: 0.970, Global test accuracy: 93.72
Round  55, Train loss: 1.093, Test loss: 1.020, Test accuracy: 88.62
Round  55, Global train loss: 1.093, Global test loss: 0.968, Global test accuracy: 94.30
Round  56, Train loss: 0.988, Test loss: 1.021, Test accuracy: 88.54
Round  56, Global train loss: 0.988, Global test loss: 0.960, Global test accuracy: 94.78
Round  57, Train loss: 1.102, Test loss: 1.026, Test accuracy: 88.04
Round  57, Global train loss: 1.102, Global test loss: 0.970, Global test accuracy: 93.86
Round  58, Train loss: 1.014, Test loss: 1.026, Test accuracy: 88.00
Round  58, Global train loss: 1.014, Global test loss: 0.949, Global test accuracy: 95.96
Round  59, Train loss: 1.072, Test loss: 1.026, Test accuracy: 88.02
Round  59, Global train loss: 1.072, Global test loss: 0.956, Global test accuracy: 95.14
Round  60, Train loss: 1.145, Test loss: 1.025, Test accuracy: 88.16
Round  60, Global train loss: 1.145, Global test loss: 0.989, Global test accuracy: 92.24
Round  61, Train loss: 1.086, Test loss: 1.025, Test accuracy: 88.12
Round  61, Global train loss: 1.086, Global test loss: 0.956, Global test accuracy: 95.44
Round  62, Train loss: 1.014, Test loss: 1.025, Test accuracy: 88.14
Round  62, Global train loss: 1.014, Global test loss: 0.947, Global test accuracy: 95.96
Round  63, Train loss: 1.025, Test loss: 1.023, Test accuracy: 88.34
Round  63, Global train loss: 1.025, Global test loss: 0.962, Global test accuracy: 94.64
Round  64, Train loss: 1.069, Test loss: 1.024, Test accuracy: 88.20
Round  64, Global train loss: 1.069, Global test loss: 0.956, Global test accuracy: 95.10
Round  65, Train loss: 1.013, Test loss: 1.024, Test accuracy: 88.14
Round  65, Global train loss: 1.013, Global test loss: 0.951, Global test accuracy: 95.60
Round  66, Train loss: 0.987, Test loss: 1.024, Test accuracy: 88.18
Round  66, Global train loss: 0.987, Global test loss: 0.956, Global test accuracy: 95.22
Round  67, Train loss: 1.011, Test loss: 1.024, Test accuracy: 88.18
Round  67, Global train loss: 1.011, Global test loss: 0.950, Global test accuracy: 95.88
Round  68, Train loss: 1.024, Test loss: 1.023, Test accuracy: 88.42
Round  68, Global train loss: 1.024, Global test loss: 0.957, Global test accuracy: 95.06
Round  69, Train loss: 1.021, Test loss: 1.025, Test accuracy: 88.24
Round  69, Global train loss: 1.021, Global test loss: 0.961, Global test accuracy: 94.74
Round  70, Train loss: 1.157, Test loss: 1.025, Test accuracy: 88.20
Round  70, Global train loss: 1.157, Global test loss: 0.970, Global test accuracy: 93.96
Round  71, Train loss: 1.097, Test loss: 1.025, Test accuracy: 88.26
Round  71, Global train loss: 1.097, Global test loss: 0.950, Global test accuracy: 95.86
Round  72, Train loss: 1.090, Test loss: 1.025, Test accuracy: 88.08
Round  72, Global train loss: 1.090, Global test loss: 0.971, Global test accuracy: 93.38
Round  73, Train loss: 1.081, Test loss: 1.025, Test accuracy: 88.16
Round  73, Global train loss: 1.081, Global test loss: 0.960, Global test accuracy: 94.66
Round  74, Train loss: 1.082, Test loss: 1.025, Test accuracy: 88.14
Round  74, Global train loss: 1.082, Global test loss: 0.953, Global test accuracy: 95.66
Round  75, Train loss: 0.912, Test loss: 1.025, Test accuracy: 88.16
Round  75, Global train loss: 0.912, Global test loss: 0.948, Global test accuracy: 95.92
Round  76, Train loss: 1.201, Test loss: 1.024, Test accuracy: 88.38
Round  76, Global train loss: 1.201, Global test loss: 0.988, Global test accuracy: 92.44
Round  77, Train loss: 1.097, Test loss: 1.025, Test accuracy: 88.20
Round  77, Global train loss: 1.097, Global test loss: 0.981, Global test accuracy: 92.56
Round  78, Train loss: 1.055, Test loss: 1.025, Test accuracy: 88.16
Round  78, Global train loss: 1.055, Global test loss: 0.960, Global test accuracy: 95.04
Round  79, Train loss: 1.096, Test loss: 1.026, Test accuracy: 87.96
Round  79, Global train loss: 1.096, Global test loss: 0.951, Global test accuracy: 95.50
Round  80, Train loss: 0.911, Test loss: 1.026, Test accuracy: 87.98
Round  80, Global train loss: 0.911, Global test loss: 0.951, Global test accuracy: 95.64
Round  81, Train loss: 1.064, Test loss: 1.025, Test accuracy: 88.24
Round  81, Global train loss: 1.064, Global test loss: 0.962, Global test accuracy: 94.64
Round  82, Train loss: 0.983, Test loss: 1.024, Test accuracy: 88.20
Round  82, Global train loss: 0.983, Global test loss: 0.959, Global test accuracy: 95.04
Round  83, Train loss: 0.980, Test loss: 1.024, Test accuracy: 88.18
Round  83, Global train loss: 0.980, Global test loss: 0.955, Global test accuracy: 95.50
Round  84, Train loss: 1.087, Test loss: 1.028, Test accuracy: 87.80
Round  84, Global train loss: 1.087, Global test loss: 0.983, Global test accuracy: 92.88
Round  85, Train loss: 1.082, Test loss: 1.028, Test accuracy: 87.86
Round  85, Global train loss: 1.082, Global test loss: 0.968, Global test accuracy: 93.68
Round  86, Train loss: 1.147, Test loss: 1.028, Test accuracy: 87.88
Round  86, Global train loss: 1.147, Global test loss: 0.974, Global test accuracy: 93.48
Round  87, Train loss: 1.082, Test loss: 1.028, Test accuracy: 87.90
Round  87, Global train loss: 1.082, Global test loss: 0.962, Global test accuracy: 94.60
Round  88, Train loss: 1.066, Test loss: 1.028, Test accuracy: 87.84
Round  88, Global train loss: 1.066, Global test loss: 0.970, Global test accuracy: 94.00
Round  89, Train loss: 1.086, Test loss: 1.028, Test accuracy: 87.88
Round  89, Global train loss: 1.086, Global test loss: 0.981, Global test accuracy: 92.92
Round  90, Train loss: 1.149, Test loss: 1.027, Test accuracy: 87.88
Round  90, Global train loss: 1.149, Global test loss: 0.985, Global test accuracy: 92.56
Round  91, Train loss: 1.064, Test loss: 1.028, Test accuracy: 87.88
Round  91, Global train loss: 1.064, Global test loss: 0.957, Global test accuracy: 95.16
Round  92, Train loss: 1.075, Test loss: 1.028, Test accuracy: 87.84
Round  92, Global train loss: 1.075, Global test loss: 0.956, Global test accuracy: 95.14
Round  93, Train loss: 1.095, Test loss: 1.028, Test accuracy: 87.92
Round  93, Global train loss: 1.095, Global test loss: 0.972, Global test accuracy: 93.60
Round  94, Train loss: 1.167, Test loss: 1.027, Test accuracy: 88.00
Round  94, Global train loss: 1.167, Global test loss: 0.968, Global test accuracy: 93.92/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.095, Test loss: 1.025, Test accuracy: 88.14
Round  95, Global train loss: 1.095, Global test loss: 0.961, Global test accuracy: 94.70
Round  96, Train loss: 1.012, Test loss: 1.028, Test accuracy: 87.90
Round  96, Global train loss: 1.012, Global test loss: 0.958, Global test accuracy: 94.94
Round  97, Train loss: 1.049, Test loss: 1.029, Test accuracy: 87.88
Round  97, Global train loss: 1.049, Global test loss: 0.963, Global test accuracy: 94.56
Round  98, Train loss: 1.074, Test loss: 1.029, Test accuracy: 87.80
Round  98, Global train loss: 1.074, Global test loss: 0.960, Global test accuracy: 94.78
Round  99, Train loss: 1.175, Test loss: 1.031, Test accuracy: 87.52
Round  99, Global train loss: 1.175, Global test loss: 0.994, Global test accuracy: 91.34
Final Round, Train loss: 1.060, Test loss: 1.031, Test accuracy: 87.48
Final Round, Global train loss: 1.060, Global test loss: 0.994, Global test accuracy: 91.34
Average accuracy final 10 rounds: 87.87599999999999 

Average global accuracy final 10 rounds: 94.07 

795.0553064346313
[1.1977512836456299, 2.3955025672912598, 3.5015439987182617, 4.607585430145264, 5.6619179248809814, 6.716250419616699, 7.768468379974365, 8.820686340332031, 10.002416849136353, 11.184147357940674, 12.272143363952637, 13.3601393699646, 14.444809436798096, 15.529479503631592, 16.51700234413147, 17.504525184631348, 18.584911584854126, 19.665297985076904, 20.768240451812744, 21.871182918548584, 23.108336210250854, 24.345489501953125, 25.34811282157898, 26.350736141204834, 27.50833249092102, 28.665928840637207, 29.76074481010437, 30.855560779571533, 31.967447996139526, 33.07933521270752, 34.15585899353027, 35.23238277435303, 36.30656170845032, 37.38074064254761, 38.47384428977966, 39.56694793701172, 40.91619372367859, 42.26543951034546, 43.23491406440735, 44.20438861846924, 45.25484371185303, 46.305298805236816, 47.42521548271179, 48.54513216018677, 49.49270534515381, 50.44027853012085, 51.528804063797, 52.617329597473145, 53.81288552284241, 55.00844144821167, 56.118816614151, 57.22919178009033, 58.489317655563354, 59.74944353103638, 60.794745445251465, 61.84004735946655, 62.89343047142029, 63.94681358337402, 64.99740934371948, 66.04800510406494, 67.22867345809937, 68.40934181213379, 69.56326150894165, 70.71718120574951, 71.80971670150757, 72.90225219726562, 74.03184986114502, 75.16144752502441, 76.26880717277527, 77.37616682052612, 78.4523856639862, 79.52860450744629, 80.71800065040588, 81.90739679336548, 83.28273177146912, 84.65806674957275, 85.9148919582367, 87.17171716690063, 88.52487683296204, 89.87803649902344, 90.95018005371094, 92.02232360839844, 93.11203408241272, 94.201744556427, 95.27214479446411, 96.34254503250122, 97.44238233566284, 98.54221963882446, 99.59796643257141, 100.65371322631836, 101.74983239173889, 102.84595155715942, 103.8961238861084, 104.94629621505737, 105.93359732627869, 106.9208984375, 107.89278364181519, 108.86466884613037, 109.898362159729, 110.93205547332764, 111.94430303573608, 112.95655059814453, 113.89236164093018, 114.82817268371582, 115.77116441726685, 116.71415615081787, 117.79475259780884, 118.8753490447998, 119.92925381660461, 120.98315858840942, 122.19219756126404, 123.40123653411865, 124.38613438606262, 125.37103223800659, 126.42349028587341, 127.47594833374023, 128.45359992980957, 129.4312515258789, 130.77778673171997, 132.12432193756104, 133.265522480011, 134.40672302246094, 135.49560642242432, 136.5844898223877, 137.64400386810303, 138.70351791381836, 139.74358320236206, 140.78364849090576, 141.95104146003723, 143.1184344291687, 144.10716581344604, 145.0958971977234, 146.1484088897705, 147.20092058181763, 148.3466031551361, 149.4922857284546, 150.5813868045807, 151.6704878807068, 152.68320202827454, 153.69591617584229, 154.69143509864807, 155.68695402145386, 156.7133617401123, 157.73976945877075, 158.71740245819092, 159.69503545761108, 160.69403862953186, 161.69304180145264, 162.77436709403992, 163.8556923866272, 164.87851762771606, 165.90134286880493, 166.84651350975037, 167.7916841506958, 168.8274862766266, 169.86328840255737, 170.9763035774231, 172.08931875228882, 173.18521761894226, 174.2811164855957, 175.3712818622589, 176.46144723892212, 177.42020082473755, 178.37895441055298, 179.34641456604004, 180.3138747215271, 181.36750054359436, 182.42112636566162, 183.43994188308716, 184.4587574005127, 185.48647332191467, 186.51418924331665, 187.5468418598175, 188.57949447631836, 189.70871233940125, 190.83793020248413, 191.9175169467926, 192.99710369110107, 194.10612320899963, 195.2151427268982, 196.32180905342102, 197.42847537994385, 198.43413400650024, 199.43979263305664, 200.43000030517578, 201.42020797729492, 202.6477496623993, 203.87529134750366, 204.93288207054138, 205.9904727935791, 207.01067209243774, 208.0308713912964, 209.1335632801056, 210.2362551689148, 211.29247045516968, 212.34868574142456, 213.40067982673645, 214.45267391204834, 215.5367875099182, 216.6209011077881, 218.70147275924683, 220.78204441070557]
[49.02, 49.02, 80.06, 80.06, 82.86, 82.86, 81.56, 81.56, 86.06, 86.06, 88.18, 88.18, 89.06, 89.06, 89.84, 89.84, 91.02, 91.02, 91.38, 91.38, 91.16, 91.16, 91.1, 91.1, 90.82, 90.82, 90.46, 90.46, 90.9, 90.9, 90.7, 90.7, 90.76, 90.76, 90.96, 90.96, 91.0, 91.0, 92.22, 92.22, 92.3, 92.3, 91.84, 91.84, 91.54, 91.54, 91.26, 91.26, 91.22, 91.22, 91.26, 91.26, 90.82, 90.82, 90.52, 90.52, 90.32, 90.32, 90.2, 90.2, 90.16, 90.16, 90.22, 90.22, 90.28, 90.28, 90.16, 90.16, 90.16, 90.16, 89.76, 89.76, 89.6, 89.6, 89.56, 89.56, 89.12, 89.12, 89.08, 89.08, 89.06, 89.06, 89.4, 89.4, 89.06, 89.06, 88.94, 88.94, 89.0, 89.0, 89.0, 89.0, 88.7, 88.7, 88.74, 88.74, 88.8, 88.8, 88.62, 88.62, 88.44, 88.44, 88.66, 88.66, 88.7, 88.7, 88.68, 88.68, 88.68, 88.68, 88.62, 88.62, 88.54, 88.54, 88.04, 88.04, 88.0, 88.0, 88.02, 88.02, 88.16, 88.16, 88.12, 88.12, 88.14, 88.14, 88.34, 88.34, 88.2, 88.2, 88.14, 88.14, 88.18, 88.18, 88.18, 88.18, 88.42, 88.42, 88.24, 88.24, 88.2, 88.2, 88.26, 88.26, 88.08, 88.08, 88.16, 88.16, 88.14, 88.14, 88.16, 88.16, 88.38, 88.38, 88.2, 88.2, 88.16, 88.16, 87.96, 87.96, 87.98, 87.98, 88.24, 88.24, 88.2, 88.2, 88.18, 88.18, 87.8, 87.8, 87.86, 87.86, 87.88, 87.88, 87.9, 87.9, 87.84, 87.84, 87.88, 87.88, 87.88, 87.88, 87.88, 87.88, 87.84, 87.84, 87.92, 87.92, 88.0, 88.0, 88.14, 88.14, 87.9, 87.9, 87.88, 87.88, 87.8, 87.8, 87.52, 87.52, 87.48, 87.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 1, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.602, Test loss: 1.581, Test accuracy: 37.46
Round   0, Global train loss: 1.602, Global test loss: 1.581, Global test accuracy: 36.58
Round   1, Train loss: 1.470, Test loss: 1.320, Test accuracy: 76.30
Round   1, Global train loss: 1.470, Global test loss: 1.249, Global test accuracy: 86.94
Round   2, Train loss: 1.056, Test loss: 1.154, Test accuracy: 80.86
Round   2, Global train loss: 1.056, Global test loss: 0.990, Global test accuracy: 94.18
Round   3, Train loss: 1.099, Test loss: 1.078, Test accuracy: 85.98
Round   3, Global train loss: 1.099, Global test loss: 0.968, Global test accuracy: 95.00
Round   4, Train loss: 1.179, Test loss: 1.017, Test accuracy: 92.58
Round   4, Global train loss: 1.179, Global test loss: 0.964, Global test accuracy: 95.32
Round   5, Train loss: 1.282, Test loss: 0.974, Test accuracy: 94.46
Round   5, Global train loss: 1.282, Global test loss: 0.961, Global test accuracy: 95.54
Round   6, Train loss: 1.173, Test loss: 0.968, Test accuracy: 95.00
Round   6, Global train loss: 1.173, Global test loss: 0.952, Global test accuracy: 96.24
Round   7, Train loss: 1.193, Test loss: 0.968, Test accuracy: 94.98
Round   7, Global train loss: 1.193, Global test loss: 0.951, Global test accuracy: 96.24
Round   8, Train loss: 1.173, Test loss: 0.966, Test accuracy: 95.12
Round   8, Global train loss: 1.173, Global test loss: 0.952, Global test accuracy: 95.82
Round   9, Train loss: 1.045, Test loss: 0.960, Test accuracy: 95.38
Round   9, Global train loss: 1.045, Global test loss: 0.948, Global test accuracy: 96.14
Round  10, Train loss: 1.055, Test loss: 0.958, Test accuracy: 95.50
Round  10, Global train loss: 1.055, Global test loss: 0.944, Global test accuracy: 96.50
Round  11, Train loss: 1.164, Test loss: 0.957, Test accuracy: 95.44
Round  11, Global train loss: 1.164, Global test loss: 0.947, Global test accuracy: 96.12
Round  12, Train loss: 1.069, Test loss: 0.955, Test accuracy: 95.56
Round  12, Global train loss: 1.069, Global test loss: 0.942, Global test accuracy: 96.58
Round  13, Train loss: 1.279, Test loss: 0.953, Test accuracy: 95.60
Round  13, Global train loss: 1.279, Global test loss: 0.947, Global test accuracy: 96.28
Round  14, Train loss: 1.082, Test loss: 0.953, Test accuracy: 95.60
Round  14, Global train loss: 1.082, Global test loss: 0.942, Global test accuracy: 96.80
Round  15, Train loss: 1.150, Test loss: 0.952, Test accuracy: 95.72
Round  15, Global train loss: 1.150, Global test loss: 0.943, Global test accuracy: 96.60
Round  16, Train loss: 1.261, Test loss: 0.952, Test accuracy: 95.68
Round  16, Global train loss: 1.261, Global test loss: 0.949, Global test accuracy: 96.16
Round  17, Train loss: 1.156, Test loss: 0.953, Test accuracy: 95.72
Round  17, Global train loss: 1.156, Global test loss: 0.944, Global test accuracy: 96.36
Round  18, Train loss: 1.147, Test loss: 0.950, Test accuracy: 95.92
Round  18, Global train loss: 1.147, Global test loss: 0.946, Global test accuracy: 96.26
Round  19, Train loss: 1.242, Test loss: 0.950, Test accuracy: 95.94
Round  19, Global train loss: 1.242, Global test loss: 0.945, Global test accuracy: 96.30
Round  20, Train loss: 1.147, Test loss: 0.950, Test accuracy: 95.88
Round  20, Global train loss: 1.147, Global test loss: 0.948, Global test accuracy: 95.84
Round  21, Train loss: 1.073, Test loss: 0.950, Test accuracy: 95.86
Round  21, Global train loss: 1.073, Global test loss: 0.942, Global test accuracy: 96.62
Round  22, Train loss: 1.035, Test loss: 0.950, Test accuracy: 95.86
Round  22, Global train loss: 1.035, Global test loss: 0.940, Global test accuracy: 96.82
Round  23, Train loss: 1.145, Test loss: 0.949, Test accuracy: 95.96
Round  23, Global train loss: 1.145, Global test loss: 0.949, Global test accuracy: 95.88
Round  24, Train loss: 1.059, Test loss: 0.949, Test accuracy: 95.86
Round  24, Global train loss: 1.059, Global test loss: 0.941, Global test accuracy: 96.50
Round  25, Train loss: 1.159, Test loss: 0.949, Test accuracy: 95.86
Round  25, Global train loss: 1.159, Global test loss: 0.941, Global test accuracy: 96.64
Round  26, Train loss: 1.143, Test loss: 0.949, Test accuracy: 95.92
Round  26, Global train loss: 1.143, Global test loss: 0.943, Global test accuracy: 96.36
Round  27, Train loss: 1.137, Test loss: 0.948, Test accuracy: 95.96
Round  27, Global train loss: 1.137, Global test loss: 0.940, Global test accuracy: 96.64
Round  28, Train loss: 1.062, Test loss: 0.947, Test accuracy: 96.06
Round  28, Global train loss: 1.062, Global test loss: 0.939, Global test accuracy: 96.76
Round  29, Train loss: 1.128, Test loss: 0.947, Test accuracy: 96.06
Round  29, Global train loss: 1.128, Global test loss: 0.940, Global test accuracy: 96.72
Round  30, Train loss: 1.055, Test loss: 0.947, Test accuracy: 95.98
Round  30, Global train loss: 1.055, Global test loss: 0.944, Global test accuracy: 96.34
Round  31, Train loss: 1.055, Test loss: 0.947, Test accuracy: 96.04
Round  31, Global train loss: 1.055, Global test loss: 0.941, Global test accuracy: 96.58
Round  32, Train loss: 1.047, Test loss: 0.946, Test accuracy: 96.04
Round  32, Global train loss: 1.047, Global test loss: 0.939, Global test accuracy: 96.70
Round  33, Train loss: 1.026, Test loss: 0.946, Test accuracy: 96.04
Round  33, Global train loss: 1.026, Global test loss: 0.940, Global test accuracy: 96.54
Round  34, Train loss: 1.152, Test loss: 0.946, Test accuracy: 96.10
Round  34, Global train loss: 1.152, Global test loss: 0.943, Global test accuracy: 96.48
Round  35, Train loss: 1.175, Test loss: 0.946, Test accuracy: 96.02
Round  35, Global train loss: 1.175, Global test loss: 0.938, Global test accuracy: 96.82
Round  36, Train loss: 1.025, Test loss: 0.946, Test accuracy: 96.02
Round  36, Global train loss: 1.025, Global test loss: 0.941, Global test accuracy: 96.56
Round  37, Train loss: 1.256, Test loss: 0.946, Test accuracy: 95.94
Round  37, Global train loss: 1.256, Global test loss: 0.944, Global test accuracy: 96.16
Round  38, Train loss: 1.254, Test loss: 0.946, Test accuracy: 95.98
Round  38, Global train loss: 1.254, Global test loss: 0.946, Global test accuracy: 95.98
Round  39, Train loss: 1.130, Test loss: 0.946, Test accuracy: 95.96
Round  39, Global train loss: 1.130, Global test loss: 0.946, Global test accuracy: 96.18
Round  40, Train loss: 1.167, Test loss: 0.946, Test accuracy: 96.00
Round  40, Global train loss: 1.167, Global test loss: 0.942, Global test accuracy: 96.36
Round  41, Train loss: 1.045, Test loss: 0.946, Test accuracy: 96.04
Round  41, Global train loss: 1.045, Global test loss: 0.939, Global test accuracy: 96.66
Round  42, Train loss: 1.145, Test loss: 0.946, Test accuracy: 96.10
Round  42, Global train loss: 1.145, Global test loss: 0.939, Global test accuracy: 96.62
Round  43, Train loss: 1.144, Test loss: 0.946, Test accuracy: 96.10
Round  43, Global train loss: 1.144, Global test loss: 0.939, Global test accuracy: 96.70
Round  44, Train loss: 1.168, Test loss: 0.948, Test accuracy: 95.78
Round  44, Global train loss: 1.168, Global test loss: 0.939, Global test accuracy: 96.66
Round  45, Train loss: 1.125, Test loss: 0.948, Test accuracy: 95.74
Round  45, Global train loss: 1.125, Global test loss: 0.947, Global test accuracy: 95.94
Round  46, Train loss: 1.251, Test loss: 0.947, Test accuracy: 95.90
Round  46, Global train loss: 1.251, Global test loss: 0.943, Global test accuracy: 96.40
Round  47, Train loss: 1.248, Test loss: 0.947, Test accuracy: 95.92
Round  47, Global train loss: 1.248, Global test loss: 0.943, Global test accuracy: 96.28
Round  48, Train loss: 1.158, Test loss: 0.947, Test accuracy: 95.90
Round  48, Global train loss: 1.158, Global test loss: 0.944, Global test accuracy: 96.20
Round  49, Train loss: 1.056, Test loss: 0.948, Test accuracy: 95.84
Round  49, Global train loss: 1.056, Global test loss: 0.938, Global test accuracy: 96.92
Round  50, Train loss: 1.221, Test loss: 0.948, Test accuracy: 95.76
Round  50, Global train loss: 1.221, Global test loss: 0.944, Global test accuracy: 96.12
Round  51, Train loss: 1.130, Test loss: 0.948, Test accuracy: 95.76
Round  51, Global train loss: 1.130, Global test loss: 0.947, Global test accuracy: 95.88
Round  52, Train loss: 1.127, Test loss: 0.947, Test accuracy: 95.86
Round  52, Global train loss: 1.127, Global test loss: 0.947, Global test accuracy: 95.88
Round  53, Train loss: 1.026, Test loss: 0.948, Test accuracy: 95.82
Round  53, Global train loss: 1.026, Global test loss: 0.944, Global test accuracy: 96.30
Round  54, Train loss: 1.237, Test loss: 0.947, Test accuracy: 95.80
Round  54, Global train loss: 1.237, Global test loss: 0.940, Global test accuracy: 96.52
Round  55, Train loss: 1.126, Test loss: 0.947, Test accuracy: 95.82
Round  55, Global train loss: 1.126, Global test loss: 0.939, Global test accuracy: 96.72
Round  56, Train loss: 1.248, Test loss: 0.947, Test accuracy: 95.70
Round  56, Global train loss: 1.248, Global test loss: 0.945, Global test accuracy: 96.02
Round  57, Train loss: 1.128, Test loss: 0.947, Test accuracy: 95.68
Round  57, Global train loss: 1.128, Global test loss: 0.939, Global test accuracy: 96.78
Round  58, Train loss: 1.125, Test loss: 0.947, Test accuracy: 95.78
Round  58, Global train loss: 1.125, Global test loss: 0.944, Global test accuracy: 96.02
Round  59, Train loss: 1.134, Test loss: 0.947, Test accuracy: 95.80
Round  59, Global train loss: 1.134, Global test loss: 0.946, Global test accuracy: 95.92
Round  60, Train loss: 1.143, Test loss: 0.947, Test accuracy: 95.80
Round  60, Global train loss: 1.143, Global test loss: 0.940, Global test accuracy: 96.58
Round  61, Train loss: 1.105, Test loss: 0.947, Test accuracy: 95.78
Round  61, Global train loss: 1.105, Global test loss: 0.942, Global test accuracy: 96.46
Round  62, Train loss: 1.125, Test loss: 0.947, Test accuracy: 95.74
Round  62, Global train loss: 1.125, Global test loss: 0.946, Global test accuracy: 95.92
Round  63, Train loss: 1.142, Test loss: 0.947, Test accuracy: 95.84
Round  63, Global train loss: 1.142, Global test loss: 0.940, Global test accuracy: 96.60
Round  64, Train loss: 1.134, Test loss: 0.947, Test accuracy: 95.82
Round  64, Global train loss: 1.134, Global test loss: 0.945, Global test accuracy: 95.98
Round  65, Train loss: 1.121, Test loss: 0.947, Test accuracy: 95.78
Round  65, Global train loss: 1.121, Global test loss: 0.946, Global test accuracy: 95.92
Round  66, Train loss: 1.140, Test loss: 0.946, Test accuracy: 95.84
Round  66, Global train loss: 1.140, Global test loss: 0.942, Global test accuracy: 96.20
Round  67, Train loss: 1.119, Test loss: 0.946, Test accuracy: 95.92
Round  67, Global train loss: 1.119, Global test loss: 0.945, Global test accuracy: 95.84
Round  68, Train loss: 1.034, Test loss: 0.946, Test accuracy: 95.86
Round  68, Global train loss: 1.034, Global test loss: 0.939, Global test accuracy: 96.64
Round  69, Train loss: 1.140, Test loss: 0.946, Test accuracy: 95.84
Round  69, Global train loss: 1.140, Global test loss: 0.940, Global test accuracy: 96.56
Round  70, Train loss: 1.219, Test loss: 0.946, Test accuracy: 95.84
Round  70, Global train loss: 1.219, Global test loss: 0.941, Global test accuracy: 96.44
Round  71, Train loss: 1.138, Test loss: 0.946, Test accuracy: 95.82
Round  71, Global train loss: 1.138, Global test loss: 0.948, Global test accuracy: 95.72
Round  72, Train loss: 1.235, Test loss: 0.947, Test accuracy: 95.80
Round  72, Global train loss: 1.235, Global test loss: 0.942, Global test accuracy: 96.24
Round  73, Train loss: 1.061, Test loss: 0.947, Test accuracy: 95.80
Round  73, Global train loss: 1.061, Global test loss: 0.946, Global test accuracy: 95.82
Round  74, Train loss: 1.105, Test loss: 0.947, Test accuracy: 95.84
Round  74, Global train loss: 1.105, Global test loss: 0.943, Global test accuracy: 96.16
Round  75, Train loss: 1.025, Test loss: 0.946, Test accuracy: 95.86
Round  75, Global train loss: 1.025, Global test loss: 0.943, Global test accuracy: 96.14
Round  76, Train loss: 1.152, Test loss: 0.946, Test accuracy: 95.84
Round  76, Global train loss: 1.152, Global test loss: 0.941, Global test accuracy: 96.56
Round  77, Train loss: 1.162, Test loss: 0.946, Test accuracy: 95.78
Round  77, Global train loss: 1.162, Global test loss: 0.942, Global test accuracy: 96.38
Round  78, Train loss: 1.232, Test loss: 0.946, Test accuracy: 95.70
Round  78, Global train loss: 1.232, Global test loss: 0.942, Global test accuracy: 96.32
Round  79, Train loss: 1.025, Test loss: 0.946, Test accuracy: 95.74
Round  79, Global train loss: 1.025, Global test loss: 0.946, Global test accuracy: 95.84
Round  80, Train loss: 1.132, Test loss: 0.946, Test accuracy: 95.76
Round  80, Global train loss: 1.132, Global test loss: 0.949, Global test accuracy: 95.62
Round  81, Train loss: 1.029, Test loss: 0.946, Test accuracy: 95.80
Round  81, Global train loss: 1.029, Global test loss: 0.942, Global test accuracy: 96.46
Round  82, Train loss: 1.132, Test loss: 0.946, Test accuracy: 95.84
Round  82, Global train loss: 1.132, Global test loss: 0.941, Global test accuracy: 96.58
Round  83, Train loss: 1.114, Test loss: 0.946, Test accuracy: 95.86
Round  83, Global train loss: 1.114, Global test loss: 0.944, Global test accuracy: 96.04
Round  84, Train loss: 1.147, Test loss: 0.946, Test accuracy: 95.86
Round  84, Global train loss: 1.147, Global test loss: 0.940, Global test accuracy: 96.72
Round  85, Train loss: 1.233, Test loss: 0.946, Test accuracy: 95.86
Round  85, Global train loss: 1.233, Global test loss: 0.941, Global test accuracy: 96.40
Round  86, Train loss: 1.042, Test loss: 0.946, Test accuracy: 95.96
Round  86, Global train loss: 1.042, Global test loss: 0.942, Global test accuracy: 96.26
Round  87, Train loss: 1.230, Test loss: 0.946, Test accuracy: 95.96
Round  87, Global train loss: 1.230, Global test loss: 0.943, Global test accuracy: 96.18
Round  88, Train loss: 1.048, Test loss: 0.946, Test accuracy: 95.94
Round  88, Global train loss: 1.048, Global test loss: 0.941, Global test accuracy: 96.46
Round  89, Train loss: 1.145, Test loss: 0.946, Test accuracy: 96.00
Round  89, Global train loss: 1.145, Global test loss: 0.941, Global test accuracy: 96.52
Round  90, Train loss: 1.061, Test loss: 0.946, Test accuracy: 95.98
Round  90, Global train loss: 1.061, Global test loss: 0.941, Global test accuracy: 96.58
Round  91, Train loss: 1.132, Test loss: 0.946, Test accuracy: 96.04
Round  91, Global train loss: 1.132, Global test loss: 0.946, Global test accuracy: 95.90
Round  92, Train loss: 1.211, Test loss: 0.946, Test accuracy: 96.04
Round  92, Global train loss: 1.211, Global test loss: 0.946, Global test accuracy: 95.82
Round  93, Train loss: 1.054, Test loss: 0.947, Test accuracy: 95.96
Round  93, Global train loss: 1.054, Global test loss: 0.941, Global test accuracy: 96.48
Round  94, Train loss: 1.137, Test loss: 0.947, Test accuracy: 95.96
Round  94, Global train loss: 1.137, Global test loss: 0.945, Global test accuracy: 96.00/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.045, Test loss: 0.947, Test accuracy: 95.88
Round  95, Global train loss: 1.045, Global test loss: 0.941, Global test accuracy: 96.56
Round  96, Train loss: 1.143, Test loss: 0.946, Test accuracy: 95.88
Round  96, Global train loss: 1.143, Global test loss: 0.942, Global test accuracy: 96.46
Round  97, Train loss: 1.120, Test loss: 0.947, Test accuracy: 95.82
Round  97, Global train loss: 1.120, Global test loss: 0.942, Global test accuracy: 96.38
Round  98, Train loss: 1.054, Test loss: 0.947, Test accuracy: 95.80
Round  98, Global train loss: 1.054, Global test loss: 0.947, Global test accuracy: 95.78
Round  99, Train loss: 1.067, Test loss: 0.947, Test accuracy: 95.82
Round  99, Global train loss: 1.067, Global test loss: 0.942, Global test accuracy: 96.52
Final Round, Train loss: 1.115, Test loss: 0.947, Test accuracy: 95.86
Final Round, Global train loss: 1.115, Global test loss: 0.942, Global test accuracy: 96.52
Average accuracy final 10 rounds: 95.91799999999999 

Average global accuracy final 10 rounds: 96.248 

795.4059405326843
[1.248218059539795, 2.49643611907959, 3.6267876625061035, 4.757139205932617, 5.851449966430664, 6.945760726928711, 8.053931713104248, 9.162102699279785, 10.147107124328613, 11.132111549377441, 12.170694351196289, 13.209277153015137, 14.211655139923096, 15.214033126831055, 16.2146053314209, 17.215177536010742, 18.159184455871582, 19.103191375732422, 20.167858839035034, 21.232526302337646, 22.268344402313232, 23.30416250228882, 24.348755598068237, 25.393348693847656, 26.633026123046875, 27.872703552246094, 28.999191522598267, 30.12567949295044, 31.279776573181152, 32.433873653411865, 33.4705011844635, 34.50712871551514, 35.48992300033569, 36.47271728515625, 37.42680382728577, 38.38089036941528, 39.41001915931702, 40.43914794921875, 41.50093626976013, 42.562724590301514, 44.09287977218628, 45.623034954071045, 47.030930042266846, 48.43882513046265, 49.7331383228302, 51.027451515197754, 52.34750962257385, 53.66756772994995, 55.15127158164978, 56.63497543334961, 58.06899619102478, 59.50301694869995, 60.66550087928772, 61.82798480987549, 63.02737498283386, 64.22676515579224, 65.24718356132507, 66.26760196685791, 67.34017539024353, 68.41274881362915, 69.40945219993591, 70.40615558624268, 71.64112949371338, 72.87610340118408, 73.92476320266724, 74.97342300415039, 76.18128848075867, 77.38915395736694, 78.4398124217987, 79.49047088623047, 80.51490044593811, 81.53933000564575, 82.8626937866211, 84.18605756759644, 85.27253985404968, 86.35902214050293, 87.39486718177795, 88.43071222305298, 89.61908268928528, 90.80745315551758, 91.82865238189697, 92.84985160827637, 93.91358613967896, 94.97732067108154, 95.99635744094849, 97.01539421081543, 98.02395725250244, 99.03252029418945, 100.03686261177063, 101.0412049293518, 102.06622290611267, 103.09124088287354, 104.15059661865234, 105.20995235443115, 106.17689752578735, 107.14384269714355, 108.26815366744995, 109.39246463775635, 110.40627932548523, 111.42009401321411, 112.47148060798645, 113.52286720275879, 114.64081907272339, 115.75877094268799, 116.74343347549438, 117.72809600830078, 119.25350666046143, 120.77891731262207, 121.74407887458801, 122.70924043655396, 123.74778079986572, 124.78632116317749, 125.81256818771362, 126.83881521224976, 127.81534790992737, 128.79188060760498, 129.93177485466003, 131.0716691017151, 132.05627870559692, 133.04088830947876, 134.0495138168335, 135.05813932418823, 136.10475659370422, 137.15137386322021, 138.21735405921936, 139.2833342552185, 140.3832151889801, 141.4830961227417, 142.58225774765015, 143.6814193725586, 144.61324000358582, 145.54506063461304, 146.61492490768433, 147.68478918075562, 148.6708812713623, 149.656973361969, 150.63351845741272, 151.61006355285645, 152.6100208759308, 153.60997819900513, 154.61372423171997, 155.61747026443481, 156.72391986846924, 157.83036947250366, 158.9615957736969, 160.09282207489014, 161.15467166900635, 162.21652126312256, 163.32788109779358, 164.4392409324646, 165.44206428527832, 166.44488763809204, 167.51602029800415, 168.58715295791626, 169.67594361305237, 170.76473426818848, 171.8727469444275, 172.9807596206665, 174.10647535324097, 175.23219108581543, 176.38432502746582, 177.5364589691162, 178.59629774093628, 179.65613651275635, 180.92456340789795, 182.19299030303955, 183.3236985206604, 184.45440673828125, 185.51796746253967, 186.5815281867981, 187.77365827560425, 188.9657883644104, 189.98466229438782, 191.00353622436523, 192.11589670181274, 193.22825717926025, 194.25698471069336, 195.28571224212646, 196.44693875312805, 197.60816526412964, 198.6262903213501, 199.64441537857056, 200.6922390460968, 201.74006271362305, 202.85774445533752, 203.975426197052, 205.02514839172363, 206.07487058639526, 207.2638909816742, 208.45291137695312, 209.54413151741028, 210.63535165786743, 211.85477137565613, 213.07419109344482, 214.14525985717773, 215.21632862091064, 216.21584129333496, 217.21535396575928, 218.40987730026245, 219.60440063476562, 221.73163723945618, 223.85887384414673]
[37.46, 37.46, 76.3, 76.3, 80.86, 80.86, 85.98, 85.98, 92.58, 92.58, 94.46, 94.46, 95.0, 95.0, 94.98, 94.98, 95.12, 95.12, 95.38, 95.38, 95.5, 95.5, 95.44, 95.44, 95.56, 95.56, 95.6, 95.6, 95.6, 95.6, 95.72, 95.72, 95.68, 95.68, 95.72, 95.72, 95.92, 95.92, 95.94, 95.94, 95.88, 95.88, 95.86, 95.86, 95.86, 95.86, 95.96, 95.96, 95.86, 95.86, 95.86, 95.86, 95.92, 95.92, 95.96, 95.96, 96.06, 96.06, 96.06, 96.06, 95.98, 95.98, 96.04, 96.04, 96.04, 96.04, 96.04, 96.04, 96.1, 96.1, 96.02, 96.02, 96.02, 96.02, 95.94, 95.94, 95.98, 95.98, 95.96, 95.96, 96.0, 96.0, 96.04, 96.04, 96.1, 96.1, 96.1, 96.1, 95.78, 95.78, 95.74, 95.74, 95.9, 95.9, 95.92, 95.92, 95.9, 95.9, 95.84, 95.84, 95.76, 95.76, 95.76, 95.76, 95.86, 95.86, 95.82, 95.82, 95.8, 95.8, 95.82, 95.82, 95.7, 95.7, 95.68, 95.68, 95.78, 95.78, 95.8, 95.8, 95.8, 95.8, 95.78, 95.78, 95.74, 95.74, 95.84, 95.84, 95.82, 95.82, 95.78, 95.78, 95.84, 95.84, 95.92, 95.92, 95.86, 95.86, 95.84, 95.84, 95.84, 95.84, 95.82, 95.82, 95.8, 95.8, 95.8, 95.8, 95.84, 95.84, 95.86, 95.86, 95.84, 95.84, 95.78, 95.78, 95.7, 95.7, 95.74, 95.74, 95.76, 95.76, 95.8, 95.8, 95.84, 95.84, 95.86, 95.86, 95.86, 95.86, 95.86, 95.86, 95.96, 95.96, 95.96, 95.96, 95.94, 95.94, 96.0, 96.0, 95.98, 95.98, 96.04, 96.04, 96.04, 96.04, 95.96, 95.96, 95.96, 95.96, 95.88, 95.88, 95.88, 95.88, 95.82, 95.82, 95.8, 95.8, 95.82, 95.82, 95.86, 95.86]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.595, Test loss: 1.571, Test accuracy: 53.18
Round   0, Global train loss: 1.595, Global test loss: 1.573, Global test accuracy: 54.68
Round   1, Train loss: 1.487, Test loss: 1.404, Test accuracy: 68.94
Round   1, Global train loss: 1.487, Global test loss: 1.356, Global test accuracy: 75.26
Round   2, Train loss: 1.229, Test loss: 1.205, Test accuracy: 80.38
Round   2, Global train loss: 1.229, Global test loss: 1.074, Global test accuracy: 90.52
Round   3, Train loss: 1.120, Test loss: 1.099, Test accuracy: 88.32
Round   3, Global train loss: 1.120, Global test loss: 0.993, Global test accuracy: 94.80
Round   4, Train loss: 1.180, Test loss: 1.034, Test accuracy: 91.50
Round   4, Global train loss: 1.180, Global test loss: 0.980, Global test accuracy: 94.72
Round   5, Train loss: 1.194, Test loss: 0.995, Test accuracy: 94.40
Round   5, Global train loss: 1.194, Global test loss: 0.967, Global test accuracy: 95.62
Round   6, Train loss: 1.083, Test loss: 0.984, Test accuracy: 94.84
Round   6, Global train loss: 1.083, Global test loss: 0.959, Global test accuracy: 96.08
Round   7, Train loss: 1.188, Test loss: 0.980, Test accuracy: 94.98
Round   7, Global train loss: 1.188, Global test loss: 0.956, Global test accuracy: 96.00
Round   8, Train loss: 1.166, Test loss: 0.976, Test accuracy: 95.16
Round   8, Global train loss: 1.166, Global test loss: 0.957, Global test accuracy: 95.78
Round   9, Train loss: 1.060, Test loss: 0.959, Test accuracy: 95.70
Round   9, Global train loss: 1.060, Global test loss: 0.953, Global test accuracy: 95.88
Round  10, Train loss: 1.159, Test loss: 0.960, Test accuracy: 95.40
Round  10, Global train loss: 1.159, Global test loss: 0.952, Global test accuracy: 95.86
Round  11, Train loss: 1.158, Test loss: 0.958, Test accuracy: 95.44
Round  11, Global train loss: 1.158, Global test loss: 0.950, Global test accuracy: 96.16
Round  12, Train loss: 1.172, Test loss: 0.956, Test accuracy: 95.58
Round  12, Global train loss: 1.172, Global test loss: 0.945, Global test accuracy: 96.52
Round  13, Train loss: 1.275, Test loss: 0.953, Test accuracy: 95.90
Round  13, Global train loss: 1.275, Global test loss: 0.946, Global test accuracy: 96.34
Round  14, Train loss: 1.076, Test loss: 0.951, Test accuracy: 95.94
Round  14, Global train loss: 1.076, Global test loss: 0.944, Global test accuracy: 96.50
Round  15, Train loss: 1.249, Test loss: 0.950, Test accuracy: 96.12
Round  15, Global train loss: 1.249, Global test loss: 0.946, Global test accuracy: 96.32
Round  16, Train loss: 1.251, Test loss: 0.951, Test accuracy: 96.02
Round  16, Global train loss: 1.251, Global test loss: 0.946, Global test accuracy: 96.40
Round  17, Train loss: 1.250, Test loss: 0.953, Test accuracy: 95.58
Round  17, Global train loss: 1.250, Global test loss: 0.948, Global test accuracy: 96.10
Round  18, Train loss: 1.054, Test loss: 0.952, Test accuracy: 95.70
Round  18, Global train loss: 1.054, Global test loss: 0.945, Global test accuracy: 96.42
Round  19, Train loss: 1.147, Test loss: 0.952, Test accuracy: 95.76
Round  19, Global train loss: 1.147, Global test loss: 0.944, Global test accuracy: 96.42
Round  20, Train loss: 1.054, Test loss: 0.949, Test accuracy: 96.06
Round  20, Global train loss: 1.054, Global test loss: 0.947, Global test accuracy: 96.10
Round  21, Train loss: 1.066, Test loss: 0.951, Test accuracy: 95.80
Round  21, Global train loss: 1.066, Global test loss: 0.943, Global test accuracy: 96.60
Round  22, Train loss: 1.038, Test loss: 0.951, Test accuracy: 95.88
Round  22, Global train loss: 1.038, Global test loss: 0.941, Global test accuracy: 96.64
Round  23, Train loss: 1.146, Test loss: 0.950, Test accuracy: 95.96
Round  23, Global train loss: 1.146, Global test loss: 0.947, Global test accuracy: 96.14
Round  24, Train loss: 1.160, Test loss: 0.950, Test accuracy: 95.94
Round  24, Global train loss: 1.160, Global test loss: 0.941, Global test accuracy: 96.82
Round  25, Train loss: 1.254, Test loss: 0.949, Test accuracy: 96.04
Round  25, Global train loss: 1.254, Global test loss: 0.944, Global test accuracy: 96.52
Round  26, Train loss: 1.045, Test loss: 0.948, Test accuracy: 96.10
Round  26, Global train loss: 1.045, Global test loss: 0.943, Global test accuracy: 96.60
Round  27, Train loss: 1.133, Test loss: 0.949, Test accuracy: 96.06
Round  27, Global train loss: 1.133, Global test loss: 0.942, Global test accuracy: 96.62
Round  28, Train loss: 1.155, Test loss: 0.950, Test accuracy: 95.90
Round  28, Global train loss: 1.155, Global test loss: 0.942, Global test accuracy: 96.68
Round  29, Train loss: 1.129, Test loss: 0.950, Test accuracy: 95.92
Round  29, Global train loss: 1.129, Global test loss: 0.943, Global test accuracy: 96.60
Round  30, Train loss: 1.143, Test loss: 0.951, Test accuracy: 95.70
Round  30, Global train loss: 1.143, Global test loss: 0.944, Global test accuracy: 96.42
Round  31, Train loss: 1.046, Test loss: 0.951, Test accuracy: 95.78
Round  31, Global train loss: 1.046, Global test loss: 0.943, Global test accuracy: 96.56
Round  32, Train loss: 1.143, Test loss: 0.950, Test accuracy: 95.86
Round  32, Global train loss: 1.143, Global test loss: 0.943, Global test accuracy: 96.82
Round  33, Train loss: 0.937, Test loss: 0.950, Test accuracy: 95.82
Round  33, Global train loss: 0.937, Global test loss: 0.945, Global test accuracy: 96.16
Round  34, Train loss: 1.141, Test loss: 0.949, Test accuracy: 95.96
Round  34, Global train loss: 1.141, Global test loss: 0.944, Global test accuracy: 96.20
Round  35, Train loss: 1.164, Test loss: 0.951, Test accuracy: 95.70
Round  35, Global train loss: 1.164, Global test loss: 0.941, Global test accuracy: 96.74
Round  36, Train loss: 0.935, Test loss: 0.950, Test accuracy: 95.76
Round  36, Global train loss: 0.935, Global test loss: 0.941, Global test accuracy: 96.68
Round  37, Train loss: 1.246, Test loss: 0.951, Test accuracy: 95.66
Round  37, Global train loss: 1.246, Global test loss: 0.944, Global test accuracy: 96.34
Round  38, Train loss: 1.244, Test loss: 0.954, Test accuracy: 95.38
Round  38, Global train loss: 1.244, Global test loss: 0.946, Global test accuracy: 96.12
Round  39, Train loss: 1.222, Test loss: 0.954, Test accuracy: 95.36
Round  39, Global train loss: 1.222, Global test loss: 0.948, Global test accuracy: 95.80
Round  40, Train loss: 1.162, Test loss: 0.951, Test accuracy: 95.68
Round  40, Global train loss: 1.162, Global test loss: 0.942, Global test accuracy: 96.56
Round  41, Train loss: 1.041, Test loss: 0.951, Test accuracy: 95.74
Round  41, Global train loss: 1.041, Global test loss: 0.942, Global test accuracy: 96.84
Round  42, Train loss: 1.039, Test loss: 0.951, Test accuracy: 95.74
Round  42, Global train loss: 1.039, Global test loss: 0.942, Global test accuracy: 96.74
Round  43, Train loss: 1.037, Test loss: 0.953, Test accuracy: 95.52
Round  43, Global train loss: 1.037, Global test loss: 0.943, Global test accuracy: 96.62
Round  44, Train loss: 1.157, Test loss: 0.955, Test accuracy: 95.22
Round  44, Global train loss: 1.157, Global test loss: 0.943, Global test accuracy: 96.64
Round  45, Train loss: 1.221, Test loss: 0.955, Test accuracy: 95.16
Round  45, Global train loss: 1.221, Global test loss: 0.946, Global test accuracy: 96.12
Round  46, Train loss: 1.239, Test loss: 0.953, Test accuracy: 95.42
Round  46, Global train loss: 1.239, Global test loss: 0.946, Global test accuracy: 96.08
Round  47, Train loss: 1.237, Test loss: 0.953, Test accuracy: 95.32
Round  47, Global train loss: 1.237, Global test loss: 0.947, Global test accuracy: 96.00
Round  48, Train loss: 1.154, Test loss: 0.954, Test accuracy: 95.16
Round  48, Global train loss: 1.154, Global test loss: 0.949, Global test accuracy: 95.86
Round  49, Train loss: 1.045, Test loss: 0.954, Test accuracy: 95.24
Round  49, Global train loss: 1.045, Global test loss: 0.944, Global test accuracy: 96.34
Round  50, Train loss: 1.122, Test loss: 0.954, Test accuracy: 95.20
Round  50, Global train loss: 1.122, Global test loss: 0.947, Global test accuracy: 96.16
Round  51, Train loss: 1.039, Test loss: 0.954, Test accuracy: 95.36
Round  51, Global train loss: 1.039, Global test loss: 0.948, Global test accuracy: 95.84
Round  52, Train loss: 1.218, Test loss: 0.954, Test accuracy: 95.38
Round  52, Global train loss: 1.218, Global test loss: 0.946, Global test accuracy: 96.02
Round  53, Train loss: 1.025, Test loss: 0.953, Test accuracy: 95.44
Round  53, Global train loss: 1.025, Global test loss: 0.946, Global test accuracy: 96.02
Round  54, Train loss: 1.139, Test loss: 0.953, Test accuracy: 95.50
Round  54, Global train loss: 1.139, Global test loss: 0.942, Global test accuracy: 96.64
Round  55, Train loss: 1.116, Test loss: 0.952, Test accuracy: 95.44
Round  55, Global train loss: 1.116, Global test loss: 0.941, Global test accuracy: 96.68
Round  56, Train loss: 1.238, Test loss: 0.952, Test accuracy: 95.36
Round  56, Global train loss: 1.238, Global test loss: 0.944, Global test accuracy: 96.36
Round  57, Train loss: 1.029, Test loss: 0.954, Test accuracy: 95.22
Round  57, Global train loss: 1.029, Global test loss: 0.942, Global test accuracy: 96.58
Round  58, Train loss: 1.118, Test loss: 0.954, Test accuracy: 95.24
Round  58, Global train loss: 1.118, Global test loss: 0.945, Global test accuracy: 96.08
Round  59, Train loss: 1.039, Test loss: 0.953, Test accuracy: 95.34
Round  59, Global train loss: 1.039, Global test loss: 0.947, Global test accuracy: 96.02
Round  60, Train loss: 1.036, Test loss: 0.951, Test accuracy: 95.58
Round  60, Global train loss: 1.036, Global test loss: 0.942, Global test accuracy: 96.48
Round  61, Train loss: 1.008, Test loss: 0.951, Test accuracy: 95.56
Round  61, Global train loss: 1.008, Global test loss: 0.943, Global test accuracy: 96.28
Round  62, Train loss: 1.217, Test loss: 0.951, Test accuracy: 95.56
Round  62, Global train loss: 1.217, Global test loss: 0.945, Global test accuracy: 96.26
Round  63, Train loss: 1.136, Test loss: 0.950, Test accuracy: 95.70
Round  63, Global train loss: 1.136, Global test loss: 0.942, Global test accuracy: 96.46
Round  64, Train loss: 1.038, Test loss: 0.950, Test accuracy: 95.68
Round  64, Global train loss: 1.038, Global test loss: 0.948, Global test accuracy: 95.86
Round  65, Train loss: 1.215, Test loss: 0.950, Test accuracy: 95.62
Round  65, Global train loss: 1.215, Global test loss: 0.946, Global test accuracy: 96.20
Round  66, Train loss: 1.225, Test loss: 0.951, Test accuracy: 95.64
Round  66, Global train loss: 1.225, Global test loss: 0.943, Global test accuracy: 96.28
Round  67, Train loss: 1.115, Test loss: 0.950, Test accuracy: 95.68
Round  67, Global train loss: 1.115, Global test loss: 0.945, Global test accuracy: 96.24
Round  68, Train loss: 1.123, Test loss: 0.949, Test accuracy: 95.78
Round  68, Global train loss: 1.123, Global test loss: 0.944, Global test accuracy: 96.32
Round  69, Train loss: 1.132, Test loss: 0.951, Test accuracy: 95.52
Round  69, Global train loss: 1.132, Global test loss: 0.944, Global test accuracy: 96.26
Round  70, Train loss: 1.114, Test loss: 0.953, Test accuracy: 95.38
Round  70, Global train loss: 1.114, Global test loss: 0.944, Global test accuracy: 96.38
Round  71, Train loss: 1.133, Test loss: 0.953, Test accuracy: 95.32
Round  71, Global train loss: 1.133, Global test loss: 0.950, Global test accuracy: 95.62
Round  72, Train loss: 1.134, Test loss: 0.955, Test accuracy: 95.04
Round  72, Global train loss: 1.134, Global test loss: 0.946, Global test accuracy: 96.26
Round  73, Train loss: 1.052, Test loss: 0.956, Test accuracy: 95.08
Round  73, Global train loss: 1.052, Global test loss: 0.950, Global test accuracy: 95.62
Round  74, Train loss: 1.106, Test loss: 0.956, Test accuracy: 95.12
Round  74, Global train loss: 1.106, Global test loss: 0.945, Global test accuracy: 96.08
Round  75, Train loss: 1.117, Test loss: 0.956, Test accuracy: 95.04
Round  75, Global train loss: 1.117, Global test loss: 0.944, Global test accuracy: 96.20
Round  76, Train loss: 1.135, Test loss: 0.953, Test accuracy: 95.38
Round  76, Global train loss: 1.135, Global test loss: 0.945, Global test accuracy: 96.24
Round  77, Train loss: 1.148, Test loss: 0.953, Test accuracy: 95.42
Round  77, Global train loss: 1.148, Global test loss: 0.945, Global test accuracy: 96.22
Round  78, Train loss: 1.126, Test loss: 0.953, Test accuracy: 95.44
Round  78, Global train loss: 1.126, Global test loss: 0.945, Global test accuracy: 96.16
Round  79, Train loss: 1.120, Test loss: 0.953, Test accuracy: 95.42
Round  79, Global train loss: 1.120, Global test loss: 0.950, Global test accuracy: 95.72
Round  80, Train loss: 1.226, Test loss: 0.953, Test accuracy: 95.38
Round  80, Global train loss: 1.226, Global test loss: 0.949, Global test accuracy: 95.54
Round  81, Train loss: 1.025, Test loss: 0.954, Test accuracy: 95.34
Round  81, Global train loss: 1.025, Global test loss: 0.944, Global test accuracy: 96.22
Round  82, Train loss: 1.123, Test loss: 0.954, Test accuracy: 95.32
Round  82, Global train loss: 1.123, Global test loss: 0.944, Global test accuracy: 96.34
Round  83, Train loss: 1.118, Test loss: 0.954, Test accuracy: 95.36
Round  83, Global train loss: 1.118, Global test loss: 0.945, Global test accuracy: 96.10
Round  84, Train loss: 1.224, Test loss: 0.951, Test accuracy: 95.60
Round  84, Global train loss: 1.224, Global test loss: 0.950, Global test accuracy: 95.64
Round  85, Train loss: 1.132, Test loss: 0.953, Test accuracy: 95.44
Round  85, Global train loss: 1.132, Global test loss: 0.948, Global test accuracy: 95.90
Round  86, Train loss: 0.943, Test loss: 0.953, Test accuracy: 95.38
Round  86, Global train loss: 0.943, Global test loss: 0.948, Global test accuracy: 95.86
Round  87, Train loss: 1.219, Test loss: 0.953, Test accuracy: 95.36
Round  87, Global train loss: 1.219, Global test loss: 0.948, Global test accuracy: 95.84
Round  88, Train loss: 1.127, Test loss: 0.956, Test accuracy: 95.10
Round  88, Global train loss: 1.127, Global test loss: 0.946, Global test accuracy: 96.00
Round  89, Train loss: 1.221, Test loss: 0.952, Test accuracy: 95.48
Round  89, Global train loss: 1.221, Global test loss: 0.951, Global test accuracy: 95.54
Round  90, Train loss: 1.044, Test loss: 0.954, Test accuracy: 95.24
Round  90, Global train loss: 1.044, Global test loss: 0.948, Global test accuracy: 95.80
Round  91, Train loss: 1.036, Test loss: 0.954, Test accuracy: 95.30
Round  91, Global train loss: 1.036, Global test loss: 0.950, Global test accuracy: 95.86
Round  92, Train loss: 1.116, Test loss: 0.954, Test accuracy: 95.18
Round  92, Global train loss: 1.116, Global test loss: 0.951, Global test accuracy: 95.64
Round  93, Train loss: 1.135, Test loss: 0.955, Test accuracy: 95.16
Round  93, Global train loss: 1.135, Global test loss: 0.946, Global test accuracy: 96.00
Round  94, Train loss: 1.123, Test loss: 0.953, Test accuracy: 95.42
Round  94, Global train loss: 1.123, Global test loss: 0.951, Global test accuracy: 95.50/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.034, Test loss: 0.954, Test accuracy: 95.28
Round  95, Global train loss: 1.034, Global test loss: 0.948, Global test accuracy: 95.94
Round  96, Train loss: 1.128, Test loss: 0.955, Test accuracy: 95.08
Round  96, Global train loss: 1.128, Global test loss: 0.946, Global test accuracy: 96.06
Round  97, Train loss: 1.110, Test loss: 0.955, Test accuracy: 95.04
Round  97, Global train loss: 1.110, Global test loss: 0.945, Global test accuracy: 96.06
Round  98, Train loss: 1.050, Test loss: 0.955, Test accuracy: 95.08
Round  98, Global train loss: 1.050, Global test loss: 0.950, Global test accuracy: 95.82
Round  99, Train loss: 1.050, Test loss: 0.953, Test accuracy: 95.32
Round  99, Global train loss: 1.050, Global test loss: 0.947, Global test accuracy: 95.94
Final Round, Train loss: 1.105, Test loss: 0.954, Test accuracy: 95.22
Final Round, Global train loss: 1.105, Global test loss: 0.947, Global test accuracy: 95.94
Average accuracy final 10 rounds: 95.21 

Average global accuracy final 10 rounds: 95.86199999999998 

820.9090325832367
[1.317737102508545, 2.63547420501709, 3.7157087326049805, 4.795943260192871, 5.871917963027954, 6.947892665863037, 8.132041215896606, 9.316189765930176, 10.443130493164062, 11.57007122039795, 12.743594884872437, 13.917118549346924, 15.116554498672485, 16.315990447998047, 17.4065043926239, 18.497018337249756, 19.614666223526, 20.732314109802246, 21.896886825561523, 23.0614595413208, 24.301278591156006, 25.54109764099121, 26.6367769241333, 27.73245620727539, 28.877317190170288, 30.022178173065186, 31.23987364768982, 32.45756912231445, 33.52719211578369, 34.59681510925293, 35.718549728393555, 36.84028434753418, 37.91452646255493, 38.988768577575684, 40.093191385269165, 41.19761419296265, 42.27530097961426, 43.35298776626587, 44.52121329307556, 45.689438819885254, 46.84604525566101, 48.00265169143677, 49.12369513511658, 50.24473857879639, 51.35750675201416, 52.470274925231934, 53.567519187927246, 54.66476345062256, 55.77575993537903, 56.8867564201355, 58.069424629211426, 59.25209283828735, 60.31784272193909, 61.38359260559082, 62.50289726257324, 63.622201919555664, 64.99620246887207, 66.37020301818848, 67.58156490325928, 68.79292678833008, 69.95069622993469, 71.1084656715393, 72.2313072681427, 73.3541488647461, 74.38833951950073, 75.42253017425537, 76.53685545921326, 77.65118074417114, 78.87180519104004, 80.09242963790894, 81.34389400482178, 82.59535837173462, 83.84348130226135, 85.09160423278809, 86.19696521759033, 87.30232620239258, 88.5013382434845, 89.70035028457642, 90.80848169326782, 91.91661310195923, 92.98536229133606, 94.05411148071289, 95.36751055717468, 96.68090963363647, 97.73840761184692, 98.79590559005737, 99.98708200454712, 101.17825841903687, 102.38000559806824, 103.58175277709961, 104.65297675132751, 105.72420072555542, 107.01034164428711, 108.2964825630188, 109.57491683959961, 110.85335111618042, 111.97795009613037, 113.10254907608032, 114.34554314613342, 115.58853721618652, 116.72191405296326, 117.85529088973999, 119.08973360061646, 120.32417631149292, 121.41686129570007, 122.50954627990723, 123.66303157806396, 124.8165168762207, 125.86424350738525, 126.9119701385498, 128.09449648857117, 129.27702283859253, 130.40030932426453, 131.52359580993652, 132.75414323806763, 133.98469066619873, 135.0822789669037, 136.17986726760864, 137.39300537109375, 138.60614347457886, 139.7410876750946, 140.87603187561035, 142.05159997940063, 143.22716808319092, 144.3333694934845, 145.43957090377808, 146.56180119514465, 147.68403148651123, 148.83719205856323, 149.99035263061523, 151.06652164459229, 152.14269065856934, 153.30138611793518, 154.46008157730103, 155.58513045310974, 156.71017932891846, 157.90424299240112, 159.0983066558838, 160.26435470581055, 161.4304027557373, 162.5001609325409, 163.56991910934448, 164.7286274433136, 165.88733577728271, 167.18558502197266, 168.4838342666626, 169.6495451927185, 170.8152561187744, 171.98333644866943, 173.15141677856445, 174.22835612297058, 175.3052954673767, 176.41423392295837, 177.52317237854004, 178.61453914642334, 179.70590591430664, 180.84356904029846, 181.98123216629028, 183.12114071846008, 184.26104927062988, 185.53968834877014, 186.8183274269104, 188.0012571811676, 189.1841869354248, 190.33706521987915, 191.4899435043335, 192.69177150726318, 193.89359951019287, 195.0990731716156, 196.30454683303833, 197.40078997612, 198.49703311920166, 199.55162024497986, 200.60620737075806, 201.69212651252747, 202.77804565429688, 203.88550686836243, 204.99296808242798, 206.18875122070312, 207.38453435897827, 208.6456298828125, 209.90672540664673, 211.0226113796234, 212.1384973526001, 213.23857712745667, 214.33865690231323, 215.51266813278198, 216.68667936325073, 217.79759883880615, 218.90851831436157, 220.03206753730774, 221.1556167602539, 222.27373719215393, 223.39185762405396, 224.52918410301208, 225.66651058197021, 226.77295398712158, 227.87939739227295, 229.07485604286194, 230.27031469345093, 232.5549440383911, 234.8395733833313]
[53.18, 53.18, 68.94, 68.94, 80.38, 80.38, 88.32, 88.32, 91.5, 91.5, 94.4, 94.4, 94.84, 94.84, 94.98, 94.98, 95.16, 95.16, 95.7, 95.7, 95.4, 95.4, 95.44, 95.44, 95.58, 95.58, 95.9, 95.9, 95.94, 95.94, 96.12, 96.12, 96.02, 96.02, 95.58, 95.58, 95.7, 95.7, 95.76, 95.76, 96.06, 96.06, 95.8, 95.8, 95.88, 95.88, 95.96, 95.96, 95.94, 95.94, 96.04, 96.04, 96.1, 96.1, 96.06, 96.06, 95.9, 95.9, 95.92, 95.92, 95.7, 95.7, 95.78, 95.78, 95.86, 95.86, 95.82, 95.82, 95.96, 95.96, 95.7, 95.7, 95.76, 95.76, 95.66, 95.66, 95.38, 95.38, 95.36, 95.36, 95.68, 95.68, 95.74, 95.74, 95.74, 95.74, 95.52, 95.52, 95.22, 95.22, 95.16, 95.16, 95.42, 95.42, 95.32, 95.32, 95.16, 95.16, 95.24, 95.24, 95.2, 95.2, 95.36, 95.36, 95.38, 95.38, 95.44, 95.44, 95.5, 95.5, 95.44, 95.44, 95.36, 95.36, 95.22, 95.22, 95.24, 95.24, 95.34, 95.34, 95.58, 95.58, 95.56, 95.56, 95.56, 95.56, 95.7, 95.7, 95.68, 95.68, 95.62, 95.62, 95.64, 95.64, 95.68, 95.68, 95.78, 95.78, 95.52, 95.52, 95.38, 95.38, 95.32, 95.32, 95.04, 95.04, 95.08, 95.08, 95.12, 95.12, 95.04, 95.04, 95.38, 95.38, 95.42, 95.42, 95.44, 95.44, 95.42, 95.42, 95.38, 95.38, 95.34, 95.34, 95.32, 95.32, 95.36, 95.36, 95.6, 95.6, 95.44, 95.44, 95.38, 95.38, 95.36, 95.36, 95.1, 95.1, 95.48, 95.48, 95.24, 95.24, 95.3, 95.3, 95.18, 95.18, 95.16, 95.16, 95.42, 95.42, 95.28, 95.28, 95.08, 95.08, 95.04, 95.04, 95.08, 95.08, 95.32, 95.32, 95.22, 95.22]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 0, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.624, Test loss: 1.599, Test accuracy: 35.74
Round   0, Global train loss: 1.624, Global test loss: 1.599, Global test accuracy: 36.20
Round   1, Train loss: 1.596, Test loss: 1.577, Test accuracy: 68.60
Round   1, Global train loss: 1.596, Global test loss: 1.577, Global test accuracy: 69.24
Round   2, Train loss: 1.573, Test loss: 1.522, Test accuracy: 80.74
Round   2, Global train loss: 1.573, Global test loss: 1.519, Global test accuracy: 80.56
Round   3, Train loss: 1.503, Test loss: 1.371, Test accuracy: 86.66
Round   3, Global train loss: 1.503, Global test loss: 1.358, Global test accuracy: 86.02
Round   4, Train loss: 1.222, Test loss: 1.116, Test accuracy: 93.46
Round   4, Global train loss: 1.222, Global test loss: 1.073, Global test accuracy: 92.96
Round   5, Train loss: 1.276, Test loss: 1.068, Test accuracy: 94.48
Round   5, Global train loss: 1.276, Global test loss: 1.037, Global test accuracy: 94.58
Round   6, Train loss: 1.354, Test loss: 1.051, Test accuracy: 95.16
Round   6, Global train loss: 1.354, Global test loss: 1.053, Global test accuracy: 95.30
Round   7, Train loss: 1.252, Test loss: 1.043, Test accuracy: 95.08
Round   7, Global train loss: 1.252, Global test loss: 1.022, Global test accuracy: 94.92
Round   8, Train loss: 1.133, Test loss: 1.023, Test accuracy: 95.46
Round   8, Global train loss: 1.133, Global test loss: 0.998, Global test accuracy: 95.62
Round   9, Train loss: 1.318, Test loss: 1.010, Test accuracy: 95.54
Round   9, Global train loss: 1.318, Global test loss: 1.018, Global test accuracy: 95.68
Round  10, Train loss: 1.229, Test loss: 1.010, Test accuracy: 95.72
Round  10, Global train loss: 1.229, Global test loss: 0.999, Global test accuracy: 96.04
Round  11, Train loss: 1.120, Test loss: 0.999, Test accuracy: 95.60
Round  11, Global train loss: 1.120, Global test loss: 0.988, Global test accuracy: 95.76
Round  12, Train loss: 1.335, Test loss: 1.000, Test accuracy: 95.84
Round  12, Global train loss: 1.335, Global test loss: 0.999, Global test accuracy: 96.38
Round  13, Train loss: 1.116, Test loss: 0.999, Test accuracy: 96.04
Round  13, Global train loss: 1.116, Global test loss: 0.980, Global test accuracy: 96.28
Round  14, Train loss: 1.331, Test loss: 0.996, Test accuracy: 96.04
Round  14, Global train loss: 1.331, Global test loss: 1.003, Global test accuracy: 96.26
Round  15, Train loss: 1.235, Test loss: 0.998, Test accuracy: 95.94
Round  15, Global train loss: 1.235, Global test loss: 0.990, Global test accuracy: 96.22
Round  16, Train loss: 1.123, Test loss: 0.989, Test accuracy: 96.20
Round  16, Global train loss: 1.123, Global test loss: 0.978, Global test accuracy: 96.30
Round  17, Train loss: 1.201, Test loss: 0.986, Test accuracy: 96.26
Round  17, Global train loss: 1.201, Global test loss: 0.979, Global test accuracy: 96.52
Round  18, Train loss: 1.180, Test loss: 0.982, Test accuracy: 96.18
Round  18, Global train loss: 1.180, Global test loss: 0.981, Global test accuracy: 96.26
Round  19, Train loss: 1.185, Test loss: 0.982, Test accuracy: 96.22
Round  19, Global train loss: 1.185, Global test loss: 0.977, Global test accuracy: 96.48
Round  20, Train loss: 1.173, Test loss: 0.980, Test accuracy: 96.22
Round  20, Global train loss: 1.173, Global test loss: 0.973, Global test accuracy: 96.32
Round  21, Train loss: 1.312, Test loss: 0.984, Test accuracy: 96.22
Round  21, Global train loss: 1.312, Global test loss: 0.987, Global test accuracy: 96.40
Round  22, Train loss: 1.280, Test loss: 0.986, Test accuracy: 96.22
Round  22, Global train loss: 1.280, Global test loss: 0.987, Global test accuracy: 96.30
Round  23, Train loss: 1.085, Test loss: 0.977, Test accuracy: 96.28
Round  23, Global train loss: 1.085, Global test loss: 0.967, Global test accuracy: 96.54
Round  24, Train loss: 1.309, Test loss: 0.982, Test accuracy: 96.20
Round  24, Global train loss: 1.309, Global test loss: 0.980, Global test accuracy: 96.46
Round  25, Train loss: 1.322, Test loss: 0.990, Test accuracy: 96.18
Round  25, Global train loss: 1.322, Global test loss: 0.995, Global test accuracy: 96.48
Round  26, Train loss: 1.166, Test loss: 0.983, Test accuracy: 96.24
Round  26, Global train loss: 1.166, Global test loss: 0.975, Global test accuracy: 96.40
Round  27, Train loss: 1.105, Test loss: 0.972, Test accuracy: 96.32
Round  27, Global train loss: 1.105, Global test loss: 0.967, Global test accuracy: 96.66
Round  28, Train loss: 1.308, Test loss: 0.980, Test accuracy: 96.32
Round  28, Global train loss: 1.308, Global test loss: 0.980, Global test accuracy: 96.72
Round  29, Train loss: 1.278, Test loss: 0.986, Test accuracy: 96.18
Round  29, Global train loss: 1.278, Global test loss: 0.982, Global test accuracy: 96.88
Round  30, Train loss: 1.172, Test loss: 0.980, Test accuracy: 96.36
Round  30, Global train loss: 1.172, Global test loss: 0.972, Global test accuracy: 96.70
Round  31, Train loss: 1.067, Test loss: 0.970, Test accuracy: 96.58
Round  31, Global train loss: 1.067, Global test loss: 0.961, Global test accuracy: 96.70
Round  32, Train loss: 1.287, Test loss: 0.976, Test accuracy: 96.50
Round  32, Global train loss: 1.287, Global test loss: 0.973, Global test accuracy: 96.94
Round  33, Train loss: 1.158, Test loss: 0.975, Test accuracy: 96.76
Round  33, Global train loss: 1.158, Global test loss: 0.968, Global test accuracy: 96.92
Round  34, Train loss: 1.079, Test loss: 0.969, Test accuracy: 96.60
Round  34, Global train loss: 1.079, Global test loss: 0.960, Global test accuracy: 96.64
Round  35, Train loss: 1.191, Test loss: 0.973, Test accuracy: 96.58
Round  35, Global train loss: 1.191, Global test loss: 0.966, Global test accuracy: 96.86
Round  36, Train loss: 1.152, Test loss: 0.971, Test accuracy: 96.56
Round  36, Global train loss: 1.152, Global test loss: 0.964, Global test accuracy: 96.92
Round  37, Train loss: 1.061, Test loss: 0.966, Test accuracy: 96.80
Round  37, Global train loss: 1.061, Global test loss: 0.955, Global test accuracy: 97.38
Round  38, Train loss: 1.055, Test loss: 0.965, Test accuracy: 96.72
Round  38, Global train loss: 1.055, Global test loss: 0.953, Global test accuracy: 97.26
Round  39, Train loss: 1.063, Test loss: 0.963, Test accuracy: 96.88
Round  39, Global train loss: 1.063, Global test loss: 0.952, Global test accuracy: 97.10
Round  40, Train loss: 1.178, Test loss: 0.971, Test accuracy: 96.64
Round  40, Global train loss: 1.178, Global test loss: 0.960, Global test accuracy: 97.20
Round  41, Train loss: 1.168, Test loss: 0.973, Test accuracy: 96.64
Round  41, Global train loss: 1.168, Global test loss: 0.964, Global test accuracy: 97.32
Round  42, Train loss: 1.272, Test loss: 0.979, Test accuracy: 96.24
Round  42, Global train loss: 1.272, Global test loss: 0.974, Global test accuracy: 97.00
Round  43, Train loss: 1.265, Test loss: 0.988, Test accuracy: 96.04
Round  43, Global train loss: 1.265, Global test loss: 0.981, Global test accuracy: 96.82
Round  44, Train loss: 1.176, Test loss: 0.982, Test accuracy: 96.06
Round  44, Global train loss: 1.176, Global test loss: 0.974, Global test accuracy: 96.58
Round  45, Train loss: 1.063, Test loss: 0.969, Test accuracy: 96.58
Round  45, Global train loss: 1.063, Global test loss: 0.958, Global test accuracy: 97.06
Round  46, Train loss: 1.082, Test loss: 0.970, Test accuracy: 96.26
Round  46, Global train loss: 1.082, Global test loss: 0.958, Global test accuracy: 97.00
Round  47, Train loss: 1.077, Test loss: 0.970, Test accuracy: 96.24
Round  47, Global train loss: 1.077, Global test loss: 0.957, Global test accuracy: 97.08
Round  48, Train loss: 1.163, Test loss: 0.975, Test accuracy: 96.14
Round  48, Global train loss: 1.163, Global test loss: 0.965, Global test accuracy: 96.92
Round  49, Train loss: 1.172, Test loss: 0.978, Test accuracy: 96.04
Round  49, Global train loss: 1.172, Global test loss: 0.972, Global test accuracy: 96.38
Round  50, Train loss: 1.049, Test loss: 0.969, Test accuracy: 96.50
Round  50, Global train loss: 1.049, Global test loss: 0.955, Global test accuracy: 97.06
Round  51, Train loss: 1.131, Test loss: 0.969, Test accuracy: 96.54
Round  51, Global train loss: 1.131, Global test loss: 0.959, Global test accuracy: 96.82
Round  52, Train loss: 1.054, Test loss: 0.966, Test accuracy: 96.72
Round  52, Global train loss: 1.054, Global test loss: 0.953, Global test accuracy: 97.04
Round  53, Train loss: 1.052, Test loss: 0.964, Test accuracy: 96.82
Round  53, Global train loss: 1.052, Global test loss: 0.953, Global test accuracy: 97.40
Round  54, Train loss: 1.152, Test loss: 0.971, Test accuracy: 96.40
Round  54, Global train loss: 1.152, Global test loss: 0.959, Global test accuracy: 97.34
Round  55, Train loss: 1.065, Test loss: 0.970, Test accuracy: 96.48
Round  55, Global train loss: 1.065, Global test loss: 0.956, Global test accuracy: 97.44
Round  56, Train loss: 1.038, Test loss: 0.967, Test accuracy: 96.60
Round  56, Global train loss: 1.038, Global test loss: 0.949, Global test accuracy: 97.62
Round  57, Train loss: 1.149, Test loss: 0.971, Test accuracy: 96.32
Round  57, Global train loss: 1.149, Global test loss: 0.959, Global test accuracy: 97.10
Round  58, Train loss: 0.943, Test loss: 0.963, Test accuracy: 96.92
Round  58, Global train loss: 0.943, Global test loss: 0.946, Global test accuracy: 97.42
Round  59, Train loss: 1.126, Test loss: 0.967, Test accuracy: 96.72
Round  59, Global train loss: 1.126, Global test loss: 0.954, Global test accuracy: 97.22
Round  60, Train loss: 1.249, Test loss: 0.984, Test accuracy: 95.62
Round  60, Global train loss: 1.249, Global test loss: 0.972, Global test accuracy: 96.92
Round  61, Train loss: 1.039, Test loss: 0.975, Test accuracy: 96.28
Round  61, Global train loss: 1.039, Global test loss: 0.955, Global test accuracy: 97.02
Round  62, Train loss: 1.050, Test loss: 0.968, Test accuracy: 96.76
Round  62, Global train loss: 1.050, Global test loss: 0.952, Global test accuracy: 97.08
Round  63, Train loss: 1.046, Test loss: 0.969, Test accuracy: 96.64
Round  63, Global train loss: 1.046, Global test loss: 0.951, Global test accuracy: 97.26
Round  64, Train loss: 1.120, Test loss: 0.973, Test accuracy: 96.46
Round  64, Global train loss: 1.120, Global test loss: 0.957, Global test accuracy: 96.96
Round  65, Train loss: 1.047, Test loss: 0.972, Test accuracy: 96.62
Round  65, Global train loss: 1.047, Global test loss: 0.956, Global test accuracy: 97.04
Round  66, Train loss: 1.143, Test loss: 0.975, Test accuracy: 96.42
Round  66, Global train loss: 1.143, Global test loss: 0.956, Global test accuracy: 97.66
Round  67, Train loss: 0.938, Test loss: 0.966, Test accuracy: 96.72
Round  67, Global train loss: 0.938, Global test loss: 0.946, Global test accuracy: 97.54
Round  68, Train loss: 1.152, Test loss: 0.977, Test accuracy: 96.10
Round  68, Global train loss: 1.152, Global test loss: 0.961, Global test accuracy: 97.26
Round  69, Train loss: 1.038, Test loss: 0.977, Test accuracy: 96.12
Round  69, Global train loss: 1.038, Global test loss: 0.954, Global test accuracy: 97.44
Round  70, Train loss: 1.143, Test loss: 0.983, Test accuracy: 95.68
Round  70, Global train loss: 1.143, Global test loss: 0.960, Global test accuracy: 97.34
Round  71, Train loss: 1.039, Test loss: 0.977, Test accuracy: 95.96
Round  71, Global train loss: 1.039, Global test loss: 0.960, Global test accuracy: 96.70
Round  72, Train loss: 1.131, Test loss: 0.984, Test accuracy: 95.70
Round  72, Global train loss: 1.131, Global test loss: 0.963, Global test accuracy: 97.10
Round  73, Train loss: 1.132, Test loss: 0.982, Test accuracy: 95.80
Round  73, Global train loss: 1.132, Global test loss: 0.967, Global test accuracy: 96.44
Round  74, Train loss: 1.135, Test loss: 0.987, Test accuracy: 95.68
Round  74, Global train loss: 1.135, Global test loss: 0.965, Global test accuracy: 96.76
Round  75, Train loss: 1.026, Test loss: 0.976, Test accuracy: 96.14
Round  75, Global train loss: 1.026, Global test loss: 0.949, Global test accuracy: 97.26
Round  76, Train loss: 1.160, Test loss: 0.990, Test accuracy: 95.14
Round  76, Global train loss: 1.160, Global test loss: 0.972, Global test accuracy: 96.44
Round  77, Train loss: 1.136, Test loss: 0.993, Test accuracy: 94.74
Round  77, Global train loss: 1.136, Global test loss: 0.973, Global test accuracy: 96.40
Round  78, Train loss: 1.119, Test loss: 0.990, Test accuracy: 94.96
Round  78, Global train loss: 1.119, Global test loss: 0.966, Global test accuracy: 96.64
Round  79, Train loss: 1.138, Test loss: 0.993, Test accuracy: 95.10
Round  79, Global train loss: 1.138, Global test loss: 0.986, Global test accuracy: 95.46
Round  80, Train loss: 1.022, Test loss: 0.977, Test accuracy: 96.08
Round  80, Global train loss: 1.022, Global test loss: 0.954, Global test accuracy: 96.84
Round  81, Train loss: 1.218, Test loss: 1.000, Test accuracy: 94.34
Round  81, Global train loss: 1.218, Global test loss: 0.982, Global test accuracy: 95.72
Round  82, Train loss: 1.029, Test loss: 0.978, Test accuracy: 95.70
Round  82, Global train loss: 1.029, Global test loss: 0.956, Global test accuracy: 96.88
Round  83, Train loss: 1.108, Test loss: 0.983, Test accuracy: 95.42
Round  83, Global train loss: 1.108, Global test loss: 0.961, Global test accuracy: 96.74
Round  84, Train loss: 1.228, Test loss: 1.014, Test accuracy: 93.04
Round  84, Global train loss: 1.228, Global test loss: 1.032, Global test accuracy: 92.64
Round  85, Train loss: 1.111, Test loss: 1.011, Test accuracy: 93.18
Round  85, Global train loss: 1.111, Global test loss: 0.986, Global test accuracy: 95.30
Round  86, Train loss: 1.206, Test loss: 1.007, Test accuracy: 93.50
Round  86, Global train loss: 1.206, Global test loss: 0.991, Global test accuracy: 95.40
Round  87, Train loss: 1.032, Test loss: 0.990, Test accuracy: 94.64
Round  87, Global train loss: 1.032, Global test loss: 0.967, Global test accuracy: 96.16
Round  88, Train loss: 1.214, Test loss: 1.009, Test accuracy: 93.40
Round  88, Global train loss: 1.214, Global test loss: 0.994, Global test accuracy: 94.90
Round  89, Train loss: 1.207, Test loss: 1.032, Test accuracy: 91.94
Round  89, Global train loss: 1.207, Global test loss: 1.039, Global test accuracy: 91.96
Round  90, Train loss: 1.201, Test loss: 1.023, Test accuracy: 92.26
Round  90, Global train loss: 1.201, Global test loss: 1.002, Global test accuracy: 94.40
Round  91, Train loss: 1.101, Test loss: 1.002, Test accuracy: 93.64
Round  91, Global train loss: 1.101, Global test loss: 0.976, Global test accuracy: 95.56/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.016, Test loss: 0.990, Test accuracy: 94.54
Round  92, Global train loss: 1.016, Global test loss: 0.969, Global test accuracy: 95.82
Round  93, Train loss: 1.209, Test loss: 1.033, Test accuracy: 91.02
Round  93, Global train loss: 1.209, Global test loss: 1.018, Global test accuracy: 93.12
Round  94, Train loss: 1.109, Test loss: 1.018, Test accuracy: 91.90
Round  94, Global train loss: 1.109, Global test loss: 0.992, Global test accuracy: 94.80
Round  95, Train loss: 1.099, Test loss: 1.009, Test accuracy: 92.60
Round  95, Global train loss: 1.099, Global test loss: 0.984, Global test accuracy: 95.38
Round  96, Train loss: 1.014, Test loss: 0.992, Test accuracy: 94.38
Round  96, Global train loss: 1.014, Global test loss: 0.963, Global test accuracy: 96.60
Round  97, Train loss: 1.188, Test loss: 1.026, Test accuracy: 91.92
Round  97, Global train loss: 1.188, Global test loss: 1.003, Global test accuracy: 94.38
Round  98, Train loss: 1.095, Test loss: 1.009, Test accuracy: 92.82
Round  98, Global train loss: 1.095, Global test loss: 0.987, Global test accuracy: 94.98
Round  99, Train loss: 1.172, Test loss: 1.055, Test accuracy: 88.70
Round  99, Global train loss: 1.172, Global test loss: 1.025, Global test accuracy: 92.66
Final Round, Train loss: 1.078, Test loss: 1.037, Test accuracy: 89.72
Final Round, Global train loss: 1.078, Global test loss: 1.025, Global test accuracy: 92.66
Average accuracy final 10 rounds: 92.378
659.1774079799652
[1.633847713470459, 3.017033576965332, 4.267202615737915, 5.526061534881592, 6.915602684020996, 8.243737697601318, 9.57797384262085, 10.865330457687378, 12.200756788253784, 13.48011326789856, 14.823528051376343, 16.163861513137817, 17.366015434265137, 18.62930965423584, 19.899765491485596, 21.141048192977905, 22.446478366851807, 23.874988079071045, 25.32141089439392, 26.517505645751953, 27.9338219165802, 29.246394157409668, 30.68784761428833, 32.003937005996704, 33.31874680519104, 34.61280632019043, 35.90581679344177, 37.164132833480835, 38.35547471046448, 39.56208944320679, 40.77500104904175, 42.01306128501892, 43.213462829589844, 44.36300230026245, 45.578009366989136, 46.77074384689331, 47.942291021347046, 49.20949387550354, 50.453115701675415, 51.75878095626831, 52.94214940071106, 54.16276264190674, 55.37265110015869, 56.624836683273315, 57.80441927909851, 59.01774740219116, 60.252421617507935, 61.48834276199341, 62.65926790237427, 63.92169666290283, 65.12397956848145, 66.3518533706665, 67.52662205696106, 68.83644247055054, 70.12499690055847, 71.33869457244873, 72.49694395065308, 73.67954707145691, 74.90158653259277, 76.08595037460327, 77.2113847732544, 79.80761194229126, 80.91766834259033, 82.00067210197449, 83.04222416877747, 84.11929416656494, 85.22420978546143, 86.29117393493652, 87.30049443244934, 88.39259696006775, 89.46524381637573, 90.51486086845398, 91.4505090713501, 92.431405544281, 93.40795302391052, 94.35261225700378, 95.31921100616455, 96.31954717636108, 97.33719301223755, 98.31477665901184, 99.35807180404663, 100.38151574134827, 101.356529712677, 102.34455251693726, 103.37519240379333, 104.36626958847046, 105.3231828212738, 106.35738515853882, 107.43945646286011, 108.41979789733887, 109.39354729652405, 110.42925953865051, 111.44182205200195, 112.39401268959045, 113.37965202331543, 114.38402843475342, 115.35205745697021, 116.30236744880676, 117.2910361289978, 118.253582239151, 119.86847829818726]
[35.74, 68.6, 80.74, 86.66, 93.46, 94.48, 95.16, 95.08, 95.46, 95.54, 95.72, 95.6, 95.84, 96.04, 96.04, 95.94, 96.2, 96.26, 96.18, 96.22, 96.22, 96.22, 96.22, 96.28, 96.2, 96.18, 96.24, 96.32, 96.32, 96.18, 96.36, 96.58, 96.5, 96.76, 96.6, 96.58, 96.56, 96.8, 96.72, 96.88, 96.64, 96.64, 96.24, 96.04, 96.06, 96.58, 96.26, 96.24, 96.14, 96.04, 96.5, 96.54, 96.72, 96.82, 96.4, 96.48, 96.6, 96.32, 96.92, 96.72, 95.62, 96.28, 96.76, 96.64, 96.46, 96.62, 96.42, 96.72, 96.1, 96.12, 95.68, 95.96, 95.7, 95.8, 95.68, 96.14, 95.14, 94.74, 94.96, 95.1, 96.08, 94.34, 95.7, 95.42, 93.04, 93.18, 93.5, 94.64, 93.4, 91.94, 92.26, 93.64, 94.54, 91.02, 91.9, 92.6, 94.38, 91.92, 92.82, 88.7, 89.72]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.622, Test loss: 1.585, Test accuracy: 34.44
Round   0, Global train loss: 1.622, Global test loss: 1.585, Global test accuracy: 34.52
Round   1, Train loss: 1.574, Test loss: 1.514, Test accuracy: 40.64
Round   1, Global train loss: 1.574, Global test loss: 1.514, Global test accuracy: 40.10
Round   2, Train loss: 1.507, Test loss: 1.397, Test accuracy: 68.04
Round   2, Global train loss: 1.507, Global test loss: 1.395, Global test accuracy: 68.28
Round   3, Train loss: 1.409, Test loss: 1.231, Test accuracy: 86.02
Round   3, Global train loss: 1.409, Global test loss: 1.228, Global test accuracy: 86.22
Round   4, Train loss: 1.291, Test loss: 1.085, Test accuracy: 93.02
Round   4, Global train loss: 1.291, Global test loss: 1.075, Global test accuracy: 93.96
Round   5, Train loss: 1.228, Test loss: 1.031, Test accuracy: 95.08
Round   5, Global train loss: 1.228, Global test loss: 1.023, Global test accuracy: 95.66
Round   6, Train loss: 1.207, Test loss: 1.009, Test accuracy: 95.48
Round   6, Global train loss: 1.207, Global test loss: 1.002, Global test accuracy: 96.06
Round   7, Train loss: 1.197, Test loss: 0.998, Test accuracy: 95.66
Round   7, Global train loss: 1.197, Global test loss: 0.991, Global test accuracy: 96.08
Round   8, Train loss: 1.190, Test loss: 0.991, Test accuracy: 95.92
Round   8, Global train loss: 1.190, Global test loss: 0.984, Global test accuracy: 96.46
Round   9, Train loss: 1.185, Test loss: 0.986, Test accuracy: 96.02
Round   9, Global train loss: 1.185, Global test loss: 0.979, Global test accuracy: 96.46
Round  10, Train loss: 1.298, Test loss: 0.992, Test accuracy: 96.12
Round  10, Global train loss: 1.298, Global test loss: 0.992, Global test accuracy: 96.54
Round  11, Train loss: 1.038, Test loss: 0.979, Test accuracy: 96.18
Round  11, Global train loss: 1.038, Global test loss: 0.973, Global test accuracy: 96.34
Round  12, Train loss: 1.050, Test loss: 0.971, Test accuracy: 96.44
Round  12, Global train loss: 1.050, Global test loss: 0.965, Global test accuracy: 96.78
Round  13, Train loss: 1.069, Test loss: 0.971, Test accuracy: 96.24
Round  13, Global train loss: 1.069, Global test loss: 0.966, Global test accuracy: 96.42
Round  14, Train loss: 1.045, Test loss: 0.968, Test accuracy: 96.42
Round  14, Global train loss: 1.045, Global test loss: 0.965, Global test accuracy: 96.68
Round  15, Train loss: 1.038, Test loss: 0.967, Test accuracy: 96.36
Round  15, Global train loss: 1.038, Global test loss: 0.959, Global test accuracy: 96.62
Round  16, Train loss: 1.020, Test loss: 0.966, Test accuracy: 96.36
Round  16, Global train loss: 1.020, Global test loss: 0.958, Global test accuracy: 96.64
Round  17, Train loss: 1.048, Test loss: 0.964, Test accuracy: 96.42
Round  17, Global train loss: 1.048, Global test loss: 0.959, Global test accuracy: 96.62
Round  18, Train loss: 1.024, Test loss: 0.962, Test accuracy: 96.30
Round  18, Global train loss: 1.024, Global test loss: 0.958, Global test accuracy: 96.54
Round  19, Train loss: 1.021, Test loss: 0.963, Test accuracy: 96.22
Round  19, Global train loss: 1.021, Global test loss: 0.958, Global test accuracy: 96.40
Round  20, Train loss: 0.971, Test loss: 0.960, Test accuracy: 96.56
Round  20, Global train loss: 0.971, Global test loss: 0.952, Global test accuracy: 96.62
Round  21, Train loss: 1.025, Test loss: 0.957, Test accuracy: 96.62
Round  21, Global train loss: 1.025, Global test loss: 0.953, Global test accuracy: 96.90
Round  22, Train loss: 1.014, Test loss: 0.958, Test accuracy: 96.60
Round  22, Global train loss: 1.014, Global test loss: 0.953, Global test accuracy: 96.74
Round  23, Train loss: 0.968, Test loss: 0.957, Test accuracy: 96.86
Round  23, Global train loss: 0.968, Global test loss: 0.948, Global test accuracy: 97.22
Round  24, Train loss: 1.027, Test loss: 0.956, Test accuracy: 96.70
Round  24, Global train loss: 1.027, Global test loss: 0.950, Global test accuracy: 97.02
Round  25, Train loss: 1.073, Test loss: 0.962, Test accuracy: 96.40
Round  25, Global train loss: 1.073, Global test loss: 0.957, Global test accuracy: 96.60
Round  26, Train loss: 1.010, Test loss: 0.962, Test accuracy: 96.36
Round  26, Global train loss: 1.010, Global test loss: 0.955, Global test accuracy: 96.84
Round  27, Train loss: 1.007, Test loss: 0.957, Test accuracy: 96.68
Round  27, Global train loss: 1.007, Global test loss: 0.952, Global test accuracy: 96.94
Round  28, Train loss: 1.063, Test loss: 0.958, Test accuracy: 96.54
Round  28, Global train loss: 1.063, Global test loss: 0.960, Global test accuracy: 96.60
Round  29, Train loss: 1.013, Test loss: 0.961, Test accuracy: 96.32
Round  29, Global train loss: 1.013, Global test loss: 0.952, Global test accuracy: 96.70
Round  30, Train loss: 1.030, Test loss: 0.959, Test accuracy: 96.46
Round  30, Global train loss: 1.030, Global test loss: 0.955, Global test accuracy: 96.66
Round  31, Train loss: 1.021, Test loss: 0.956, Test accuracy: 96.80
Round  31, Global train loss: 1.021, Global test loss: 0.952, Global test accuracy: 97.16
Round  32, Train loss: 1.009, Test loss: 0.955, Test accuracy: 96.86
Round  32, Global train loss: 1.009, Global test loss: 0.947, Global test accuracy: 97.24
Round  33, Train loss: 0.957, Test loss: 0.952, Test accuracy: 96.94
Round  33, Global train loss: 0.957, Global test loss: 0.945, Global test accuracy: 97.52
Round  34, Train loss: 0.991, Test loss: 0.951, Test accuracy: 97.12
Round  34, Global train loss: 0.991, Global test loss: 0.946, Global test accuracy: 97.42
Round  35, Train loss: 1.046, Test loss: 0.952, Test accuracy: 96.94
Round  35, Global train loss: 1.046, Global test loss: 0.953, Global test accuracy: 96.76
Round  36, Train loss: 0.956, Test loss: 0.951, Test accuracy: 97.14
Round  36, Global train loss: 0.956, Global test loss: 0.943, Global test accuracy: 97.70
Round  37, Train loss: 1.023, Test loss: 0.954, Test accuracy: 96.80
Round  37, Global train loss: 1.023, Global test loss: 0.947, Global test accuracy: 97.42
Round  38, Train loss: 1.021, Test loss: 0.956, Test accuracy: 96.74
Round  38, Global train loss: 1.021, Global test loss: 0.948, Global test accuracy: 97.38
Round  39, Train loss: 0.981, Test loss: 0.956, Test accuracy: 96.78
Round  39, Global train loss: 0.981, Global test loss: 0.947, Global test accuracy: 97.34
Round  40, Train loss: 1.002, Test loss: 0.951, Test accuracy: 97.06
Round  40, Global train loss: 1.002, Global test loss: 0.945, Global test accuracy: 97.36
Round  41, Train loss: 0.994, Test loss: 0.950, Test accuracy: 97.20
Round  41, Global train loss: 0.994, Global test loss: 0.942, Global test accuracy: 97.80
Round  42, Train loss: 1.009, Test loss: 0.951, Test accuracy: 97.16
Round  42, Global train loss: 1.009, Global test loss: 0.945, Global test accuracy: 97.62
Round  43, Train loss: 1.008, Test loss: 0.952, Test accuracy: 97.08
Round  43, Global train loss: 1.008, Global test loss: 0.946, Global test accuracy: 97.44
Round  44, Train loss: 1.052, Test loss: 0.953, Test accuracy: 96.86
Round  44, Global train loss: 1.052, Global test loss: 0.956, Global test accuracy: 96.66
Round  45, Train loss: 0.992, Test loss: 0.958, Test accuracy: 96.74
Round  45, Global train loss: 0.992, Global test loss: 0.948, Global test accuracy: 97.46
Round  46, Train loss: 1.000, Test loss: 0.954, Test accuracy: 96.80
Round  46, Global train loss: 1.000, Global test loss: 0.948, Global test accuracy: 97.30
Round  47, Train loss: 0.997, Test loss: 0.953, Test accuracy: 96.78
Round  47, Global train loss: 0.997, Global test loss: 0.946, Global test accuracy: 97.44
Round  48, Train loss: 1.007, Test loss: 0.953, Test accuracy: 96.86
Round  48, Global train loss: 1.007, Global test loss: 0.947, Global test accuracy: 97.14
Round  49, Train loss: 1.044, Test loss: 0.952, Test accuracy: 97.00
Round  49, Global train loss: 1.044, Global test loss: 0.956, Global test accuracy: 96.44
Round  50, Train loss: 0.945, Test loss: 0.954, Test accuracy: 96.90
Round  50, Global train loss: 0.945, Global test loss: 0.945, Global test accuracy: 97.58
Round  51, Train loss: 0.952, Test loss: 0.951, Test accuracy: 96.90
Round  51, Global train loss: 0.952, Global test loss: 0.941, Global test accuracy: 97.56
Round  52, Train loss: 0.973, Test loss: 0.951, Test accuracy: 96.82
Round  52, Global train loss: 0.973, Global test loss: 0.946, Global test accuracy: 97.20
Round  53, Train loss: 0.944, Test loss: 0.948, Test accuracy: 97.10
Round  53, Global train loss: 0.944, Global test loss: 0.939, Global test accuracy: 97.66
Round  54, Train loss: 1.007, Test loss: 0.952, Test accuracy: 96.78
Round  54, Global train loss: 1.007, Global test loss: 0.946, Global test accuracy: 97.00
Round  55, Train loss: 0.989, Test loss: 0.954, Test accuracy: 96.76
Round  55, Global train loss: 0.989, Global test loss: 0.943, Global test accuracy: 97.44
Round  56, Train loss: 1.013, Test loss: 0.958, Test accuracy: 96.46
Round  56, Global train loss: 1.013, Global test loss: 0.951, Global test accuracy: 96.94
Round  57, Train loss: 1.003, Test loss: 0.956, Test accuracy: 96.58
Round  57, Global train loss: 1.003, Global test loss: 0.950, Global test accuracy: 96.96
Round  58, Train loss: 0.962, Test loss: 0.956, Test accuracy: 96.56
Round  58, Global train loss: 0.962, Global test loss: 0.944, Global test accuracy: 97.50
Round  59, Train loss: 0.937, Test loss: 0.954, Test accuracy: 96.78
Round  59, Global train loss: 0.937, Global test loss: 0.942, Global test accuracy: 97.56
Round  60, Train loss: 1.003, Test loss: 0.951, Test accuracy: 96.56
Round  60, Global train loss: 1.003, Global test loss: 0.943, Global test accuracy: 97.24
Round  61, Train loss: 0.943, Test loss: 0.953, Test accuracy: 96.72
Round  61, Global train loss: 0.943, Global test loss: 0.940, Global test accuracy: 97.52
Round  62, Train loss: 0.970, Test loss: 0.953, Test accuracy: 96.68
Round  62, Global train loss: 0.970, Global test loss: 0.946, Global test accuracy: 97.02
Round  63, Train loss: 1.028, Test loss: 0.952, Test accuracy: 96.64
Round  63, Global train loss: 1.028, Global test loss: 0.946, Global test accuracy: 97.12
Round  64, Train loss: 0.937, Test loss: 0.956, Test accuracy: 96.72
Round  64, Global train loss: 0.937, Global test loss: 0.944, Global test accuracy: 97.44
Round  65, Train loss: 0.980, Test loss: 0.953, Test accuracy: 96.62
Round  65, Global train loss: 0.980, Global test loss: 0.944, Global test accuracy: 97.54
Round  66, Train loss: 1.012, Test loss: 0.957, Test accuracy: 96.32
Round  66, Global train loss: 1.012, Global test loss: 0.948, Global test accuracy: 96.92
Round  67, Train loss: 0.971, Test loss: 0.957, Test accuracy: 96.44
Round  67, Global train loss: 0.971, Global test loss: 0.944, Global test accuracy: 97.40
Round  68, Train loss: 1.033, Test loss: 0.955, Test accuracy: 96.46
Round  68, Global train loss: 1.033, Global test loss: 0.948, Global test accuracy: 97.20
Round  69, Train loss: 1.027, Test loss: 0.960, Test accuracy: 96.12
Round  69, Global train loss: 1.027, Global test loss: 0.952, Global test accuracy: 97.08
Round  70, Train loss: 0.964, Test loss: 0.959, Test accuracy: 96.18
Round  70, Global train loss: 0.964, Global test loss: 0.946, Global test accuracy: 97.12
Round  71, Train loss: 0.933, Test loss: 0.954, Test accuracy: 96.64
Round  71, Global train loss: 0.933, Global test loss: 0.944, Global test accuracy: 97.40
Round  72, Train loss: 0.998, Test loss: 0.953, Test accuracy: 96.48
Round  72, Global train loss: 0.998, Global test loss: 0.945, Global test accuracy: 97.16
Round  73, Train loss: 0.973, Test loss: 0.954, Test accuracy: 96.60
Round  73, Global train loss: 0.973, Global test loss: 0.949, Global test accuracy: 97.02
Round  74, Train loss: 0.950, Test loss: 0.953, Test accuracy: 96.56
Round  74, Global train loss: 0.950, Global test loss: 0.941, Global test accuracy: 97.36
Round  75, Train loss: 0.991, Test loss: 0.952, Test accuracy: 96.66
Round  75, Global train loss: 0.991, Global test loss: 0.943, Global test accuracy: 97.50
Round  76, Train loss: 1.012, Test loss: 0.959, Test accuracy: 96.04
Round  76, Global train loss: 1.012, Global test loss: 0.961, Global test accuracy: 96.14
Round  77, Train loss: 1.038, Test loss: 0.964, Test accuracy: 95.78
Round  77, Global train loss: 1.038, Global test loss: 0.965, Global test accuracy: 95.48
Round  78, Train loss: 0.978, Test loss: 0.963, Test accuracy: 95.94
Round  78, Global train loss: 0.978, Global test loss: 0.950, Global test accuracy: 96.66
Round  79, Train loss: 0.951, Test loss: 0.955, Test accuracy: 96.46
Round  79, Global train loss: 0.951, Global test loss: 0.945, Global test accuracy: 97.08
Round  80, Train loss: 0.926, Test loss: 0.953, Test accuracy: 96.60
Round  80, Global train loss: 0.926, Global test loss: 0.941, Global test accuracy: 97.42
Round  81, Train loss: 0.924, Test loss: 0.951, Test accuracy: 96.66
Round  81, Global train loss: 0.924, Global test loss: 0.941, Global test accuracy: 97.32
Round  82, Train loss: 0.923, Test loss: 0.950, Test accuracy: 96.72
Round  82, Global train loss: 0.923, Global test loss: 0.940, Global test accuracy: 97.30
Round  83, Train loss: 0.923, Test loss: 0.950, Test accuracy: 96.60
Round  83, Global train loss: 0.923, Global test loss: 0.940, Global test accuracy: 97.30
Round  84, Train loss: 0.922, Test loss: 0.949, Test accuracy: 96.68
Round  84, Global train loss: 0.922, Global test loss: 0.939, Global test accuracy: 97.32
Round  85, Train loss: 0.921, Test loss: 0.949, Test accuracy: 96.68
Round  85, Global train loss: 0.921, Global test loss: 0.939, Global test accuracy: 97.36
Round  86, Train loss: 0.921, Test loss: 0.949, Test accuracy: 96.60
Round  86, Global train loss: 0.921, Global test loss: 0.939, Global test accuracy: 97.36
Round  87, Train loss: 0.921, Test loss: 0.949, Test accuracy: 96.60
Round  87, Global train loss: 0.921, Global test loss: 0.939, Global test accuracy: 97.36
Round  88, Train loss: 0.920, Test loss: 0.950, Test accuracy: 96.48
Round  88, Global train loss: 0.920, Global test loss: 0.939, Global test accuracy: 97.28
Round  89, Train loss: 0.920, Test loss: 0.949, Test accuracy: 96.56
Round  89, Global train loss: 0.920, Global test loss: 0.938, Global test accuracy: 97.40
Round  90, Train loss: 0.919, Test loss: 0.949, Test accuracy: 96.56
Round  90, Global train loss: 0.919, Global test loss: 0.938, Global test accuracy: 97.48/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 0.919, Test loss: 0.949, Test accuracy: 96.60
Round  91, Global train loss: 0.919, Global test loss: 0.938, Global test accuracy: 97.48
Round  92, Train loss: 0.918, Test loss: 0.949, Test accuracy: 96.60
Round  92, Global train loss: 0.918, Global test loss: 0.938, Global test accuracy: 97.48
Round  93, Train loss: 0.918, Test loss: 0.949, Test accuracy: 96.62
Round  93, Global train loss: 0.918, Global test loss: 0.938, Global test accuracy: 97.50
Round  94, Train loss: 0.918, Test loss: 0.949, Test accuracy: 96.58
Round  94, Global train loss: 0.918, Global test loss: 0.938, Global test accuracy: 97.52
Round  95, Train loss: 0.917, Test loss: 0.949, Test accuracy: 96.62
Round  95, Global train loss: 0.917, Global test loss: 0.937, Global test accuracy: 97.48
Round  96, Train loss: 0.917, Test loss: 0.949, Test accuracy: 96.64
Round  96, Global train loss: 0.917, Global test loss: 0.937, Global test accuracy: 97.52
Round  97, Train loss: 0.917, Test loss: 0.949, Test accuracy: 96.68
Round  97, Global train loss: 0.917, Global test loss: 0.937, Global test accuracy: 97.52
Round  98, Train loss: 0.916, Test loss: 0.949, Test accuracy: 96.66
Round  98, Global train loss: 0.916, Global test loss: 0.937, Global test accuracy: 97.52
Round  99, Train loss: 0.984, Test loss: 0.952, Test accuracy: 96.40
Round  99, Global train loss: 0.984, Global test loss: 0.939, Global test accuracy: 97.52
Final Round, Train loss: 1.100, Test loss: 0.957, Test accuracy: 95.96
Final Round, Global train loss: 1.100, Global test loss: 0.939, Global test accuracy: 97.52
Average accuracy final 10 rounds: 96.596
1494.1319348812103
[1.3857941627502441, 2.539316177368164, 3.6884918212890625, 4.829620599746704, 6.028043270111084, 7.183826446533203, 8.343833446502686, 9.523792743682861, 10.652121305465698, 11.795811653137207, 15.816679000854492, 23.07570743560791, 30.13014793395996, 37.24599027633667, 44.453463077545166, 51.59683299064636, 58.617372035980225, 65.63462162017822, 72.60073256492615, 79.60289573669434, 80.72092533111572, 87.9275529384613, 95.12267684936523, 102.08966302871704, 109.09755969047546, 116.27074456214905, 123.48592972755432, 130.53926301002502, 137.61029362678528, 144.62724328041077, 151.73872661590576, 158.8382706642151, 165.87323117256165, 172.7997133731842, 179.92394828796387, 186.8705189228058, 193.594557762146, 200.87973165512085, 208.2294762134552, 215.11350917816162, 222.12912321090698, 229.1611132621765, 236.7594301700592, 244.45844841003418, 251.5598509311676, 258.8397777080536, 265.8892683982849, 273.01461720466614, 280.1573028564453, 287.39616084098816, 288.58496928215027, 295.46418619155884, 302.63838505744934, 309.6642608642578, 316.7497355937958, 323.8818202018738, 331.0748624801636, 338.19853019714355, 345.2428505420685, 346.3943781852722, 353.50722789764404, 360.5028409957886, 367.5997438430786, 374.62530612945557, 375.75796914100647, 382.9887499809265, 390.28278255462646, 397.23658776283264, 404.3302946090698, 411.46056175231934, 418.48240876197815, 419.6496329307556, 426.55486822128296, 434.3156442642212, 442.02077770233154, 449.0104308128357, 456.11234951019287, 463.22569131851196, 470.23268699645996, 477.07993626594543, 478.19201850891113, 479.31503081321716, 480.56778502464294, 481.7220149040222, 482.84387969970703, 483.9875955581665, 485.1240818500519, 486.29461908340454, 487.45881605148315, 488.5888683795929, 489.7091097831726, 490.8312373161316, 491.9506974220276, 493.0798988342285, 494.2031614780426, 495.3190643787384, 496.3978409767151, 497.5017635822296, 498.6439480781555, 505.3444607257843, 511.6082866191864]
[34.44, 40.64, 68.04, 86.02, 93.02, 95.08, 95.48, 95.66, 95.92, 96.02, 96.12, 96.18, 96.44, 96.24, 96.42, 96.36, 96.36, 96.42, 96.3, 96.22, 96.56, 96.62, 96.6, 96.86, 96.7, 96.4, 96.36, 96.68, 96.54, 96.32, 96.46, 96.8, 96.86, 96.94, 97.12, 96.94, 97.14, 96.8, 96.74, 96.78, 97.06, 97.2, 97.16, 97.08, 96.86, 96.74, 96.8, 96.78, 96.86, 97.0, 96.9, 96.9, 96.82, 97.1, 96.78, 96.76, 96.46, 96.58, 96.56, 96.78, 96.56, 96.72, 96.68, 96.64, 96.72, 96.62, 96.32, 96.44, 96.46, 96.12, 96.18, 96.64, 96.48, 96.6, 96.56, 96.66, 96.04, 95.78, 95.94, 96.46, 96.6, 96.66, 96.72, 96.6, 96.68, 96.68, 96.6, 96.6, 96.48, 96.56, 96.56, 96.6, 96.6, 96.62, 96.58, 96.62, 96.64, 96.68, 96.66, 96.4, 95.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.605, Test loss: 1.599, Test accuracy: 37.48
Round   0, Global train loss: 1.605, Global test loss: 1.599, Global test accuracy: 39.96
Round   1, Train loss: 1.511, Test loss: 1.439, Test accuracy: 64.66
Round   1, Global train loss: 1.511, Global test loss: 1.408, Global test accuracy: 77.04
Round   2, Train loss: 1.418, Test loss: 1.365, Test accuracy: 71.58
Round   2, Global train loss: 1.418, Global test loss: 1.341, Global test accuracy: 88.90
Round   3, Train loss: 1.471, Test loss: 1.326, Test accuracy: 68.98
Round   3, Global train loss: 1.471, Global test loss: 1.313, Global test accuracy: 91.96
Round   4, Train loss: 1.260, Test loss: 1.274, Test accuracy: 67.78
Round   4, Global train loss: 1.260, Global test loss: 1.117, Global test accuracy: 81.16
Round   5, Train loss: 1.044, Test loss: 1.258, Test accuracy: 68.96
Round   5, Global train loss: 1.044, Global test loss: 1.055, Global test accuracy: 85.86
Round   6, Train loss: 1.177, Test loss: 1.247, Test accuracy: 70.30
Round   6, Global train loss: 1.177, Global test loss: 1.081, Global test accuracy: 81.26
Round   7, Train loss: 1.174, Test loss: 1.250, Test accuracy: 69.84
Round   7, Global train loss: 1.174, Global test loss: 0.980, Global test accuracy: 94.68
Round   8, Train loss: 1.426, Test loss: 1.247, Test accuracy: 71.10
Round   8, Global train loss: 1.426, Global test loss: 1.394, Global test accuracy: 91.42
Round   9, Train loss: 1.355, Test loss: 1.242, Test accuracy: 73.30
Round   9, Global train loss: 1.355, Global test loss: 1.210, Global test accuracy: 92.86
Round  10, Train loss: 1.525, Test loss: 1.238, Test accuracy: 74.32
Round  10, Global train loss: 1.525, Global test loss: 1.290, Global test accuracy: 86.58
Round  11, Train loss: 1.199, Test loss: 1.236, Test accuracy: 73.74
Round  11, Global train loss: 1.199, Global test loss: 1.077, Global test accuracy: 83.84
Round  12, Train loss: 1.149, Test loss: 1.232, Test accuracy: 72.48
Round  12, Global train loss: 1.149, Global test loss: 1.039, Global test accuracy: 93.82
Round  13, Train loss: 1.410, Test loss: 1.220, Test accuracy: 71.66
Round  13, Global train loss: 1.410, Global test loss: 1.336, Global test accuracy: 84.54
Round  14, Train loss: 1.093, Test loss: 1.221, Test accuracy: 71.44
Round  14, Global train loss: 1.093, Global test loss: 0.962, Global test accuracy: 95.42
Round  15, Train loss: 1.365, Test loss: 1.217, Test accuracy: 72.24
Round  15, Global train loss: 1.365, Global test loss: 1.208, Global test accuracy: 76.22
Round  16, Train loss: 1.153, Test loss: 1.220, Test accuracy: 71.04
Round  16, Global train loss: 1.153, Global test loss: 0.989, Global test accuracy: 93.98
Round  17, Train loss: 1.299, Test loss: 1.219, Test accuracy: 71.40
Round  17, Global train loss: 1.299, Global test loss: 1.055, Global test accuracy: 91.32
Round  18, Train loss: 1.251, Test loss: 1.224, Test accuracy: 70.32
Round  18, Global train loss: 1.251, Global test loss: 0.998, Global test accuracy: 93.46
Round  19, Train loss: 1.128, Test loss: 1.222, Test accuracy: 70.18
Round  19, Global train loss: 1.128, Global test loss: 1.086, Global test accuracy: 81.14
Round  20, Train loss: 1.316, Test loss: 1.219, Test accuracy: 70.54
Round  20, Global train loss: 1.316, Global test loss: 1.166, Global test accuracy: 76.58
Round  21, Train loss: 1.326, Test loss: 1.217, Test accuracy: 71.28
Round  21, Global train loss: 1.326, Global test loss: 1.103, Global test accuracy: 89.56
Round  22, Train loss: 1.261, Test loss: 1.224, Test accuracy: 70.06
Round  22, Global train loss: 1.261, Global test loss: 1.016, Global test accuracy: 92.38
Round  23, Train loss: 1.199, Test loss: 1.226, Test accuracy: 69.78
Round  23, Global train loss: 1.199, Global test loss: 0.996, Global test accuracy: 93.36
Round  24, Train loss: 1.272, Test loss: 1.222, Test accuracy: 70.72
Round  24, Global train loss: 1.272, Global test loss: 1.069, Global test accuracy: 90.94
Round  25, Train loss: 1.284, Test loss: 1.218, Test accuracy: 70.58
Round  25, Global train loss: 1.284, Global test loss: 1.025, Global test accuracy: 92.16
Round  26, Train loss: 1.259, Test loss: 1.215, Test accuracy: 70.42
Round  26, Global train loss: 1.259, Global test loss: 1.104, Global test accuracy: 86.96
Round  27, Train loss: 1.123, Test loss: 1.217, Test accuracy: 70.38
Round  27, Global train loss: 1.123, Global test loss: 1.073, Global test accuracy: 83.04
Round  28, Train loss: 1.168, Test loss: 1.224, Test accuracy: 69.64
Round  28, Global train loss: 1.168, Global test loss: 1.002, Global test accuracy: 92.54
Round  29, Train loss: 1.263, Test loss: 1.222, Test accuracy: 69.16
Round  29, Global train loss: 1.263, Global test loss: 1.150, Global test accuracy: 76.94
Round  30, Train loss: 1.070, Test loss: 1.222, Test accuracy: 69.24
Round  30, Global train loss: 1.070, Global test loss: 0.962, Global test accuracy: 95.14
Round  31, Train loss: 0.986, Test loss: 1.224, Test accuracy: 69.06
Round  31, Global train loss: 0.986, Global test loss: 1.018, Global test accuracy: 89.12
Round  32, Train loss: 1.401, Test loss: 1.219, Test accuracy: 70.42
Round  32, Global train loss: 1.401, Global test loss: 1.277, Global test accuracy: 70.66
Round  33, Train loss: 1.183, Test loss: 1.219, Test accuracy: 70.20
Round  33, Global train loss: 1.183, Global test loss: 1.010, Global test accuracy: 91.74
Round  34, Train loss: 1.290, Test loss: 1.219, Test accuracy: 70.06
Round  34, Global train loss: 1.290, Global test loss: 1.111, Global test accuracy: 82.58
Round  35, Train loss: 1.231, Test loss: 1.221, Test accuracy: 69.32
Round  35, Global train loss: 1.231, Global test loss: 1.068, Global test accuracy: 89.48
Round  36, Train loss: 1.157, Test loss: 1.225, Test accuracy: 68.68
Round  36, Global train loss: 1.157, Global test loss: 1.022, Global test accuracy: 91.54
Round  37, Train loss: 1.172, Test loss: 1.225, Test accuracy: 68.70
Round  37, Global train loss: 1.172, Global test loss: 1.002, Global test accuracy: 92.18
Round  38, Train loss: 1.182, Test loss: 1.227, Test accuracy: 68.48
Round  38, Global train loss: 1.182, Global test loss: 1.046, Global test accuracy: 88.90
Round  39, Train loss: 1.195, Test loss: 1.234, Test accuracy: 67.52
Round  39, Global train loss: 1.195, Global test loss: 1.074, Global test accuracy: 87.94
Round  40, Train loss: 1.212, Test loss: 1.233, Test accuracy: 67.76
Round  40, Global train loss: 1.212, Global test loss: 1.137, Global test accuracy: 81.26
Round  41, Train loss: 1.197, Test loss: 1.233, Test accuracy: 67.80
Round  41, Global train loss: 1.197, Global test loss: 1.058, Global test accuracy: 89.64
Round  42, Train loss: 1.132, Test loss: 1.230, Test accuracy: 67.88
Round  42, Global train loss: 1.132, Global test loss: 1.018, Global test accuracy: 90.32
Round  43, Train loss: 1.113, Test loss: 1.229, Test accuracy: 68.14
Round  43, Global train loss: 1.113, Global test loss: 1.133, Global test accuracy: 76.32
Round  44, Train loss: 1.073, Test loss: 1.230, Test accuracy: 68.02
Round  44, Global train loss: 1.073, Global test loss: 0.994, Global test accuracy: 91.76
Round  45, Train loss: 1.058, Test loss: 1.239, Test accuracy: 67.16
Round  45, Global train loss: 1.058, Global test loss: 1.019, Global test accuracy: 89.32
Round  46, Train loss: 1.095, Test loss: 1.245, Test accuracy: 66.58
Round  46, Global train loss: 1.095, Global test loss: 1.042, Global test accuracy: 87.74
Round  47, Train loss: 1.040, Test loss: 1.242, Test accuracy: 66.82
Round  47, Global train loss: 1.040, Global test loss: 1.007, Global test accuracy: 91.80
Round  48, Train loss: 1.216, Test loss: 1.244, Test accuracy: 66.16
Round  48, Global train loss: 1.216, Global test loss: 1.142, Global test accuracy: 75.92
Round  49, Train loss: 1.152, Test loss: 1.248, Test accuracy: 65.32
Round  49, Global train loss: 1.152, Global test loss: 1.043, Global test accuracy: 88.20
Round  50, Train loss: 1.053, Test loss: 1.246, Test accuracy: 65.22
Round  50, Global train loss: 1.053, Global test loss: 1.003, Global test accuracy: 90.90
Round  51, Train loss: 0.998, Test loss: 1.244, Test accuracy: 65.46
Round  51, Global train loss: 0.998, Global test loss: 0.968, Global test accuracy: 94.38
Round  52, Train loss: 1.164, Test loss: 1.247, Test accuracy: 65.06
Round  52, Global train loss: 1.164, Global test loss: 1.142, Global test accuracy: 75.28
Round  53, Train loss: 1.068, Test loss: 1.249, Test accuracy: 64.84
Round  53, Global train loss: 1.068, Global test loss: 1.125, Global test accuracy: 77.24
Round  54, Train loss: 1.142, Test loss: 1.250, Test accuracy: 64.74
Round  54, Global train loss: 1.142, Global test loss: 1.121, Global test accuracy: 79.72
Round  55, Train loss: 1.012, Test loss: 1.249, Test accuracy: 64.88
Round  55, Global train loss: 1.012, Global test loss: 1.064, Global test accuracy: 83.32
Round  56, Train loss: 1.084, Test loss: 1.249, Test accuracy: 64.92
Round  56, Global train loss: 1.084, Global test loss: 1.012, Global test accuracy: 91.50
Round  57, Train loss: 1.053, Test loss: 1.247, Test accuracy: 65.10
Round  57, Global train loss: 1.053, Global test loss: 1.022, Global test accuracy: 88.74
Round  58, Train loss: 1.220, Test loss: 1.247, Test accuracy: 64.90
Round  58, Global train loss: 1.220, Global test loss: 1.092, Global test accuracy: 82.66
Round  59, Train loss: 1.060, Test loss: 1.251, Test accuracy: 64.42
Round  59, Global train loss: 1.060, Global test loss: 1.029, Global test accuracy: 89.40
Round  60, Train loss: 1.062, Test loss: 1.248, Test accuracy: 64.66
Round  60, Global train loss: 1.062, Global test loss: 1.016, Global test accuracy: 89.02
Round  61, Train loss: 1.113, Test loss: 1.247, Test accuracy: 65.00
Round  61, Global train loss: 1.113, Global test loss: 1.056, Global test accuracy: 86.06
Round  62, Train loss: 1.084, Test loss: 1.246, Test accuracy: 65.16
Round  62, Global train loss: 1.084, Global test loss: 0.998, Global test accuracy: 91.62
Round  63, Train loss: 1.008, Test loss: 1.246, Test accuracy: 65.04
Round  63, Global train loss: 1.008, Global test loss: 0.969, Global test accuracy: 94.10
Round  64, Train loss: 1.040, Test loss: 1.238, Test accuracy: 65.74
Round  64, Global train loss: 1.040, Global test loss: 0.992, Global test accuracy: 92.72
Round  65, Train loss: 1.058, Test loss: 1.240, Test accuracy: 65.68
Round  65, Global train loss: 1.058, Global test loss: 1.044, Global test accuracy: 87.02
Round  66, Train loss: 0.975, Test loss: 1.239, Test accuracy: 65.62
Round  66, Global train loss: 0.975, Global test loss: 0.990, Global test accuracy: 92.88
Round  67, Train loss: 1.085, Test loss: 1.240, Test accuracy: 65.52
Round  67, Global train loss: 1.085, Global test loss: 1.149, Global test accuracy: 76.74
Round  68, Train loss: 1.062, Test loss: 1.240, Test accuracy: 65.60
Round  68, Global train loss: 1.062, Global test loss: 1.047, Global test accuracy: 86.20
Round  69, Train loss: 1.135, Test loss: 1.242, Test accuracy: 65.60
Round  69, Global train loss: 1.135, Global test loss: 1.091, Global test accuracy: 82.48
Round  70, Train loss: 1.040, Test loss: 1.250, Test accuracy: 64.82
Round  70, Global train loss: 1.040, Global test loss: 1.001, Global test accuracy: 91.34
Round  71, Train loss: 1.016, Test loss: 1.251, Test accuracy: 64.58
Round  71, Global train loss: 1.016, Global test loss: 0.959, Global test accuracy: 94.72
Round  72, Train loss: 1.016, Test loss: 1.249, Test accuracy: 64.72
Round  72, Global train loss: 1.016, Global test loss: 0.989, Global test accuracy: 92.12
Round  73, Train loss: 0.983, Test loss: 1.250, Test accuracy: 64.70
Round  73, Global train loss: 0.983, Global test loss: 0.987, Global test accuracy: 93.02
Round  74, Train loss: 1.105, Test loss: 1.252, Test accuracy: 64.64
Round  74, Global train loss: 1.105, Global test loss: 1.012, Global test accuracy: 90.50
Round  75, Train loss: 1.037, Test loss: 1.248, Test accuracy: 64.90
Round  75, Global train loss: 1.037, Global test loss: 1.050, Global test accuracy: 86.38
Round  76, Train loss: 1.075, Test loss: 1.248, Test accuracy: 65.12
Round  76, Global train loss: 1.075, Global test loss: 1.030, Global test accuracy: 87.76
Round  77, Train loss: 1.016, Test loss: 1.249, Test accuracy: 64.76
Round  77, Global train loss: 1.016, Global test loss: 1.055, Global test accuracy: 86.00
Round  78, Train loss: 1.145, Test loss: 1.250, Test accuracy: 64.48
Round  78, Global train loss: 1.145, Global test loss: 1.096, Global test accuracy: 81.12
Round  79, Train loss: 0.967, Test loss: 1.251, Test accuracy: 64.42
Round  79, Global train loss: 0.967, Global test loss: 0.989, Global test accuracy: 92.46
Round  80, Train loss: 1.012, Test loss: 1.252, Test accuracy: 64.32
Round  80, Global train loss: 1.012, Global test loss: 0.960, Global test accuracy: 94.64
Round  81, Train loss: 1.122, Test loss: 1.250, Test accuracy: 64.52
Round  81, Global train loss: 1.122, Global test loss: 1.010, Global test accuracy: 90.10
Round  82, Train loss: 1.081, Test loss: 1.250, Test accuracy: 64.60
Round  82, Global train loss: 1.081, Global test loss: 1.142, Global test accuracy: 77.34
Round  83, Train loss: 1.085, Test loss: 1.251, Test accuracy: 64.78
Round  83, Global train loss: 1.085, Global test loss: 1.044, Global test accuracy: 86.10
Round  84, Train loss: 0.955, Test loss: 1.251, Test accuracy: 64.72
Round  84, Global train loss: 0.955, Global test loss: 0.958, Global test accuracy: 94.92
Round  85, Train loss: 0.952, Test loss: 1.251, Test accuracy: 64.76
Round  85, Global train loss: 0.952, Global test loss: 0.960, Global test accuracy: 94.88
Round  86, Train loss: 1.030, Test loss: 1.251, Test accuracy: 64.78
Round  86, Global train loss: 1.030, Global test loss: 0.991, Global test accuracy: 91.68
Round  87, Train loss: 1.000, Test loss: 1.251, Test accuracy: 64.68
Round  87, Global train loss: 1.000, Global test loss: 1.046, Global test accuracy: 87.64
Round  88, Train loss: 1.075, Test loss: 1.254, Test accuracy: 64.38
Round  88, Global train loss: 1.075, Global test loss: 0.985, Global test accuracy: 92.54
Round  89, Train loss: 1.047, Test loss: 1.252, Test accuracy: 64.50
Round  89, Global train loss: 1.047, Global test loss: 1.041, Global test accuracy: 86.58
Round  90, Train loss: 1.005, Test loss: 1.250, Test accuracy: 64.74
Round  90, Global train loss: 1.005, Global test loss: 1.007, Global test accuracy: 90.36
Round  91, Train loss: 0.999, Test loss: 1.250, Test accuracy: 64.68
Round  91, Global train loss: 0.999, Global test loss: 0.981, Global test accuracy: 93.10
Round  92, Train loss: 0.995, Test loss: 1.252, Test accuracy: 64.58
Round  92, Global train loss: 0.995, Global test loss: 1.017, Global test accuracy: 90.44
Round  93, Train loss: 1.034, Test loss: 1.254, Test accuracy: 64.42
Round  93, Global train loss: 1.034, Global test loss: 0.986, Global test accuracy: 92.44
Round  94, Train loss: 0.984, Test loss: 1.253, Test accuracy: 64.38
Round  94, Global train loss: 0.984, Global test loss: 0.989, Global test accuracy: 92.00/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 0.941, Test loss: 1.253, Test accuracy: 64.40
Round  95, Global train loss: 0.941, Global test loss: 0.952, Global test accuracy: 95.28
Round  96, Train loss: 0.980, Test loss: 1.253, Test accuracy: 64.24
Round  96, Global train loss: 0.980, Global test loss: 0.964, Global test accuracy: 94.48
Round  97, Train loss: 0.964, Test loss: 1.253, Test accuracy: 64.28
Round  97, Global train loss: 0.964, Global test loss: 0.986, Global test accuracy: 92.38
Round  98, Train loss: 1.087, Test loss: 1.252, Test accuracy: 64.34
Round  98, Global train loss: 1.087, Global test loss: 1.028, Global test accuracy: 88.44
Round  99, Train loss: 0.986, Test loss: 1.253, Test accuracy: 64.32
Round  99, Global train loss: 0.986, Global test loss: 0.998, Global test accuracy: 91.76
Final Round, Train loss: 1.025, Test loss: 1.258, Test accuracy: 63.88
Final Round, Global train loss: 1.025, Global test loss: 0.998, Global test accuracy: 91.76
Average accuracy final 10 rounds: 64.43799999999999 

Average global accuracy final 10 rounds: 92.068 

659.6948585510254
[0.8993189334869385, 1.798637866973877, 2.575626850128174, 3.3526158332824707, 4.167172908782959, 4.981729984283447, 5.759732723236084, 6.537735462188721, 7.3484508991241455, 8.15916633605957, 8.946491479873657, 9.733816623687744, 10.48636794090271, 11.238919258117676, 12.014623641967773, 12.790328025817871, 13.564734697341919, 14.339141368865967, 15.171391725540161, 16.003642082214355, 16.786391496658325, 17.569140911102295, 18.370078325271606, 19.171015739440918, 19.978607892990112, 20.786200046539307, 21.639889240264893, 22.49357843399048, 23.32447862625122, 24.155378818511963, 24.945972204208374, 25.736565589904785, 26.513432502746582, 27.29029941558838, 28.074760913848877, 28.859222412109375, 29.646063804626465, 30.432905197143555, 31.21973943710327, 32.00657367706299, 32.78950095176697, 33.57242822647095, 34.3782160282135, 35.184003829956055, 35.96785378456116, 36.75170373916626, 37.52336645126343, 38.295029163360596, 39.082918882369995, 39.870808601379395, 40.74833607673645, 41.625863552093506, 42.39139771461487, 43.15693187713623, 43.9261794090271, 44.69542694091797, 45.46134829521179, 46.227269649505615, 47.030208110809326, 47.83314657211304, 48.620516538619995, 49.40788650512695, 50.19106125831604, 50.97423601150513, 51.76507544517517, 52.555914878845215, 53.340317487716675, 54.124720096588135, 54.89574193954468, 55.66676378250122, 56.42701721191406, 57.187270641326904, 57.949925661087036, 58.71258068084717, 59.48057746887207, 60.24857425689697, 61.00871181488037, 61.76884937286377, 62.53174686431885, 63.294644355773926, 64.0770697593689, 64.85949516296387, 65.63102316856384, 66.40255117416382, 67.17735004425049, 67.95214891433716, 68.74694013595581, 69.54173135757446, 70.35558915138245, 71.16944694519043, 71.97675156593323, 72.78405618667603, 73.55815815925598, 74.33226013183594, 75.12374830245972, 75.9152364730835, 76.70271134376526, 77.49018621444702, 78.28345131874084, 79.07671642303467, 79.8540141582489, 80.63131189346313, 81.4293098449707, 82.22730779647827, 83.02738547325134, 83.82746315002441, 84.6281087398529, 85.4287543296814, 86.21773052215576, 87.00670671463013, 87.77071523666382, 88.53472375869751, 89.33230948448181, 90.12989521026611, 90.90536570549011, 91.68083620071411, 92.49718737602234, 93.31353855133057, 94.11814641952515, 94.92275428771973, 95.79520297050476, 96.6676516532898, 97.46260166168213, 98.25755167007446, 99.05455231666565, 99.85155296325684, 100.70142865180969, 101.55130434036255, 102.35144543647766, 103.15158653259277, 103.95695948600769, 104.76233243942261, 105.53025484085083, 106.29817724227905, 107.11567997932434, 107.93318271636963, 108.74572443962097, 109.55826616287231, 110.32070255279541, 111.0831389427185, 111.85638046264648, 112.62962198257446, 113.39989042282104, 114.17015886306763, 115.00632691383362, 115.84249496459961, 116.65169787406921, 117.46090078353882, 118.24101734161377, 119.02113389968872, 119.79853916168213, 120.57594442367554, 121.3420639038086, 122.10818338394165, 122.98746061325073, 123.86673784255981, 124.74325037002563, 125.61976289749146, 126.431875705719, 127.24398851394653, 128.0777130126953, 128.9114375114441, 129.72433710098267, 130.53723669052124, 131.31025862693787, 132.0832805633545, 132.89275121688843, 133.70222187042236, 134.4957573413849, 135.2892928123474, 136.0668807029724, 136.8444685935974, 137.65001034736633, 138.45555210113525, 139.2595522403717, 140.06355237960815, 140.88684225082397, 141.7101321220398, 142.5178508758545, 143.3255696296692, 144.1186649799347, 144.9117603302002, 145.71746277809143, 146.52316522598267, 147.35764145851135, 148.19211769104004, 148.99974846839905, 149.80737924575806, 150.6368477344513, 151.46631622314453, 152.25334692001343, 153.04037761688232, 153.86129641532898, 154.68221521377563, 155.5421290397644, 156.40204286575317, 157.26024532318115, 158.11844778060913, 158.9683861732483, 159.81832456588745, 161.4360785484314, 163.05383253097534]
[37.48, 37.48, 64.66, 64.66, 71.58, 71.58, 68.98, 68.98, 67.78, 67.78, 68.96, 68.96, 70.3, 70.3, 69.84, 69.84, 71.1, 71.1, 73.3, 73.3, 74.32, 74.32, 73.74, 73.74, 72.48, 72.48, 71.66, 71.66, 71.44, 71.44, 72.24, 72.24, 71.04, 71.04, 71.4, 71.4, 70.32, 70.32, 70.18, 70.18, 70.54, 70.54, 71.28, 71.28, 70.06, 70.06, 69.78, 69.78, 70.72, 70.72, 70.58, 70.58, 70.42, 70.42, 70.38, 70.38, 69.64, 69.64, 69.16, 69.16, 69.24, 69.24, 69.06, 69.06, 70.42, 70.42, 70.2, 70.2, 70.06, 70.06, 69.32, 69.32, 68.68, 68.68, 68.7, 68.7, 68.48, 68.48, 67.52, 67.52, 67.76, 67.76, 67.8, 67.8, 67.88, 67.88, 68.14, 68.14, 68.02, 68.02, 67.16, 67.16, 66.58, 66.58, 66.82, 66.82, 66.16, 66.16, 65.32, 65.32, 65.22, 65.22, 65.46, 65.46, 65.06, 65.06, 64.84, 64.84, 64.74, 64.74, 64.88, 64.88, 64.92, 64.92, 65.1, 65.1, 64.9, 64.9, 64.42, 64.42, 64.66, 64.66, 65.0, 65.0, 65.16, 65.16, 65.04, 65.04, 65.74, 65.74, 65.68, 65.68, 65.62, 65.62, 65.52, 65.52, 65.6, 65.6, 65.6, 65.6, 64.82, 64.82, 64.58, 64.58, 64.72, 64.72, 64.7, 64.7, 64.64, 64.64, 64.9, 64.9, 65.12, 65.12, 64.76, 64.76, 64.48, 64.48, 64.42, 64.42, 64.32, 64.32, 64.52, 64.52, 64.6, 64.6, 64.78, 64.78, 64.72, 64.72, 64.76, 64.76, 64.78, 64.78, 64.68, 64.68, 64.38, 64.38, 64.5, 64.5, 64.74, 64.74, 64.68, 64.68, 64.58, 64.58, 64.42, 64.42, 64.38, 64.38, 64.4, 64.4, 64.24, 64.24, 64.28, 64.28, 64.34, 64.34, 64.32, 64.32, 63.88, 63.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.595, Test loss: 1.577, Test accuracy: 46.36
Round   0, Global train loss: 1.595, Global test loss: 1.581, Global test accuracy: 48.02
Round   1, Train loss: 1.557, Test loss: 1.515, Test accuracy: 65.64
Round   1, Global train loss: 1.557, Global test loss: 1.501, Global test accuracy: 78.60
Round   2, Train loss: 1.471, Test loss: 1.364, Test accuracy: 77.24
Round   2, Global train loss: 1.471, Global test loss: 1.305, Global test accuracy: 90.14
Round   3, Train loss: 1.487, Test loss: 1.297, Test accuracy: 79.38
Round   3, Global train loss: 1.487, Global test loss: 1.186, Global test accuracy: 91.40
Round   4, Train loss: 1.121, Test loss: 1.224, Test accuracy: 81.38
Round   4, Global train loss: 1.121, Global test loss: 1.003, Global test accuracy: 94.34
Round   5, Train loss: 1.270, Test loss: 1.175, Test accuracy: 82.94
Round   5, Global train loss: 1.270, Global test loss: 0.995, Global test accuracy: 94.34
Round   6, Train loss: 1.146, Test loss: 1.181, Test accuracy: 82.10
Round   6, Global train loss: 1.146, Global test loss: 0.978, Global test accuracy: 94.22
Round   7, Train loss: 1.249, Test loss: 1.178, Test accuracy: 81.86
Round   7, Global train loss: 1.249, Global test loss: 0.988, Global test accuracy: 93.50
Round   8, Train loss: 1.444, Test loss: 1.096, Test accuracy: 88.18
Round   8, Global train loss: 1.444, Global test loss: 1.003, Global test accuracy: 92.62
Round   9, Train loss: 1.513, Test loss: 1.079, Test accuracy: 87.66
Round   9, Global train loss: 1.513, Global test loss: 1.005, Global test accuracy: 92.34
Round  10, Train loss: 1.153, Test loss: 1.035, Test accuracy: 88.60
Round  10, Global train loss: 1.153, Global test loss: 0.972, Global test accuracy: 94.98
Round  11, Train loss: 1.043, Test loss: 1.035, Test accuracy: 88.56
Round  11, Global train loss: 1.043, Global test loss: 0.972, Global test accuracy: 94.46
Round  12, Train loss: 1.504, Test loss: 1.025, Test accuracy: 89.28
Round  12, Global train loss: 1.504, Global test loss: 0.988, Global test accuracy: 92.80
Round  13, Train loss: 1.421, Test loss: 1.019, Test accuracy: 89.90
Round  13, Global train loss: 1.421, Global test loss: 1.030, Global test accuracy: 89.16
Round  14, Train loss: 1.316, Test loss: 1.019, Test accuracy: 89.80
Round  14, Global train loss: 1.316, Global test loss: 0.990, Global test accuracy: 92.16
Round  15, Train loss: 1.309, Test loss: 1.024, Test accuracy: 89.34
Round  15, Global train loss: 1.309, Global test loss: 0.982, Global test accuracy: 93.78
Round  16, Train loss: 1.416, Test loss: 1.028, Test accuracy: 88.98
Round  16, Global train loss: 1.416, Global test loss: 1.026, Global test accuracy: 89.20
Round  17, Train loss: 1.324, Test loss: 1.037, Test accuracy: 88.04
Round  17, Global train loss: 1.324, Global test loss: 0.996, Global test accuracy: 91.62
Round  18, Train loss: 1.305, Test loss: 1.038, Test accuracy: 87.98
Round  18, Global train loss: 1.305, Global test loss: 1.000, Global test accuracy: 91.70
Round  19, Train loss: 1.124, Test loss: 1.042, Test accuracy: 87.28
Round  19, Global train loss: 1.124, Global test loss: 0.970, Global test accuracy: 94.52
Round  20, Train loss: 1.102, Test loss: 1.042, Test accuracy: 87.30
Round  20, Global train loss: 1.102, Global test loss: 0.967, Global test accuracy: 94.52
Round  21, Train loss: 1.425, Test loss: 1.041, Test accuracy: 87.36
Round  21, Global train loss: 1.425, Global test loss: 1.007, Global test accuracy: 91.36
Round  22, Train loss: 1.018, Test loss: 1.048, Test accuracy: 86.46
Round  22, Global train loss: 1.018, Global test loss: 0.970, Global test accuracy: 94.26
Round  23, Train loss: 1.302, Test loss: 1.042, Test accuracy: 86.94
Round  23, Global train loss: 1.302, Global test loss: 0.981, Global test accuracy: 93.34
Round  24, Train loss: 1.319, Test loss: 1.047, Test accuracy: 86.38
Round  24, Global train loss: 1.319, Global test loss: 0.985, Global test accuracy: 92.98
Round  25, Train loss: 1.216, Test loss: 1.045, Test accuracy: 86.54
Round  25, Global train loss: 1.216, Global test loss: 0.982, Global test accuracy: 93.52
Round  26, Train loss: 1.503, Test loss: 1.055, Test accuracy: 85.34
Round  26, Global train loss: 1.503, Global test loss: 1.033, Global test accuracy: 88.06
Round  27, Train loss: 1.013, Test loss: 1.051, Test accuracy: 85.86
Round  27, Global train loss: 1.013, Global test loss: 0.968, Global test accuracy: 94.36
Round  28, Train loss: 1.295, Test loss: 1.047, Test accuracy: 86.44
Round  28, Global train loss: 1.295, Global test loss: 0.995, Global test accuracy: 91.76
Round  29, Train loss: 1.096, Test loss: 1.046, Test accuracy: 86.46
Round  29, Global train loss: 1.096, Global test loss: 0.968, Global test accuracy: 94.14
Round  30, Train loss: 1.197, Test loss: 1.051, Test accuracy: 85.72
Round  30, Global train loss: 1.197, Global test loss: 0.993, Global test accuracy: 91.54
Round  31, Train loss: 1.199, Test loss: 1.055, Test accuracy: 84.94
Round  31, Global train loss: 1.199, Global test loss: 0.998, Global test accuracy: 91.08
Round  32, Train loss: 1.511, Test loss: 1.058, Test accuracy: 84.44
Round  32, Global train loss: 1.511, Global test loss: 1.021, Global test accuracy: 89.26
Round  33, Train loss: 1.010, Test loss: 1.062, Test accuracy: 84.10
Round  33, Global train loss: 1.010, Global test loss: 0.974, Global test accuracy: 93.56
Round  34, Train loss: 1.295, Test loss: 1.059, Test accuracy: 84.40
Round  34, Global train loss: 1.295, Global test loss: 0.997, Global test accuracy: 91.60
Round  35, Train loss: 1.458, Test loss: 1.058, Test accuracy: 84.70
Round  35, Global train loss: 1.458, Global test loss: 1.017, Global test accuracy: 89.36
Round  36, Train loss: 1.436, Test loss: 1.064, Test accuracy: 84.00
Round  36, Global train loss: 1.436, Global test loss: 1.060, Global test accuracy: 85.26
Round  37, Train loss: 1.007, Test loss: 1.065, Test accuracy: 83.86
Round  37, Global train loss: 1.007, Global test loss: 0.976, Global test accuracy: 93.38
Round  38, Train loss: 1.167, Test loss: 1.064, Test accuracy: 83.76
Round  38, Global train loss: 1.167, Global test loss: 1.021, Global test accuracy: 89.02
Round  39, Train loss: 1.351, Test loss: 1.063, Test accuracy: 84.02
Round  39, Global train loss: 1.351, Global test loss: 1.030, Global test accuracy: 88.24
Round  40, Train loss: 1.255, Test loss: 1.068, Test accuracy: 83.54
Round  40, Global train loss: 1.255, Global test loss: 1.007, Global test accuracy: 90.78
Round  41, Train loss: 1.444, Test loss: 1.076, Test accuracy: 82.70
Round  41, Global train loss: 1.444, Global test loss: 1.062, Global test accuracy: 84.94
Round  42, Train loss: 1.181, Test loss: 1.075, Test accuracy: 83.06
Round  42, Global train loss: 1.181, Global test loss: 1.009, Global test accuracy: 90.70
Round  43, Train loss: 1.269, Test loss: 1.081, Test accuracy: 82.20
Round  43, Global train loss: 1.269, Global test loss: 1.029, Global test accuracy: 88.80
Round  44, Train loss: 1.260, Test loss: 1.081, Test accuracy: 82.28
Round  44, Global train loss: 1.260, Global test loss: 1.035, Global test accuracy: 87.94
Round  45, Train loss: 1.442, Test loss: 1.088, Test accuracy: 81.94
Round  45, Global train loss: 1.442, Global test loss: 1.119, Global test accuracy: 78.86
Round  46, Train loss: 1.160, Test loss: 1.093, Test accuracy: 81.44
Round  46, Global train loss: 1.160, Global test loss: 1.026, Global test accuracy: 88.12
Round  47, Train loss: 1.404, Test loss: 1.098, Test accuracy: 80.94
Round  47, Global train loss: 1.404, Global test loss: 1.096, Global test accuracy: 81.66
Round  48, Train loss: 1.113, Test loss: 1.103, Test accuracy: 80.46
Round  48, Global train loss: 1.113, Global test loss: 1.000, Global test accuracy: 91.20
Round  49, Train loss: 1.456, Test loss: 1.107, Test accuracy: 79.82
Round  49, Global train loss: 1.456, Global test loss: 1.105, Global test accuracy: 80.04
Round  50, Train loss: 1.259, Test loss: 1.117, Test accuracy: 78.78
Round  50, Global train loss: 1.259, Global test loss: 1.066, Global test accuracy: 84.28
Round  51, Train loss: 1.321, Test loss: 1.121, Test accuracy: 78.26
Round  51, Global train loss: 1.321, Global test loss: 1.112, Global test accuracy: 79.58
Round  52, Train loss: 1.261, Test loss: 1.123, Test accuracy: 78.06
Round  52, Global train loss: 1.261, Global test loss: 1.048, Global test accuracy: 86.02
Round  53, Train loss: 1.063, Test loss: 1.122, Test accuracy: 78.30
Round  53, Global train loss: 1.063, Global test loss: 0.991, Global test accuracy: 91.86
Round  54, Train loss: 1.226, Test loss: 1.115, Test accuracy: 78.88
Round  54, Global train loss: 1.226, Global test loss: 1.021, Global test accuracy: 88.80
Round  55, Train loss: 1.242, Test loss: 1.129, Test accuracy: 77.24
Round  55, Global train loss: 1.242, Global test loss: 1.051, Global test accuracy: 85.78
Round  56, Train loss: 1.392, Test loss: 1.118, Test accuracy: 78.58
Round  56, Global train loss: 1.392, Global test loss: 1.097, Global test accuracy: 81.50
Round  57, Train loss: 1.001, Test loss: 1.121, Test accuracy: 78.44
Round  57, Global train loss: 1.001, Global test loss: 0.991, Global test accuracy: 91.84
Round  58, Train loss: 1.088, Test loss: 1.123, Test accuracy: 78.02
Round  58, Global train loss: 1.088, Global test loss: 0.996, Global test accuracy: 91.10
Round  59, Train loss: 1.428, Test loss: 1.121, Test accuracy: 78.26
Round  59, Global train loss: 1.428, Global test loss: 1.136, Global test accuracy: 77.24
Round  60, Train loss: 1.085, Test loss: 1.131, Test accuracy: 77.38
Round  60, Global train loss: 1.085, Global test loss: 1.003, Global test accuracy: 90.56
Round  61, Train loss: 1.072, Test loss: 1.130, Test accuracy: 77.32
Round  61, Global train loss: 1.072, Global test loss: 1.002, Global test accuracy: 90.70
Round  62, Train loss: 0.994, Test loss: 1.127, Test accuracy: 77.62
Round  62, Global train loss: 0.994, Global test loss: 0.985, Global test accuracy: 92.22
Round  63, Train loss: 1.319, Test loss: 1.127, Test accuracy: 77.54
Round  63, Global train loss: 1.319, Global test loss: 1.118, Global test accuracy: 79.00
Round  64, Train loss: 1.152, Test loss: 1.129, Test accuracy: 77.24
Round  64, Global train loss: 1.152, Global test loss: 1.039, Global test accuracy: 87.38
Round  65, Train loss: 1.296, Test loss: 1.127, Test accuracy: 77.66
Round  65, Global train loss: 1.296, Global test loss: 1.141, Global test accuracy: 76.60
Round  66, Train loss: 1.222, Test loss: 1.123, Test accuracy: 77.92
Round  66, Global train loss: 1.222, Global test loss: 1.074, Global test accuracy: 83.26
Round  67, Train loss: 1.213, Test loss: 1.128, Test accuracy: 77.32
Round  67, Global train loss: 1.213, Global test loss: 1.054, Global test accuracy: 85.60
Round  68, Train loss: 1.063, Test loss: 1.129, Test accuracy: 77.32
Round  68, Global train loss: 1.063, Global test loss: 1.006, Global test accuracy: 90.36
Round  69, Train loss: 1.054, Test loss: 1.130, Test accuracy: 77.08
Round  69, Global train loss: 1.054, Global test loss: 0.994, Global test accuracy: 91.32
Round  70, Train loss: 1.398, Test loss: 1.126, Test accuracy: 77.70
Round  70, Global train loss: 1.398, Global test loss: 1.124, Global test accuracy: 78.54
Round  71, Train loss: 1.139, Test loss: 1.131, Test accuracy: 77.18
Round  71, Global train loss: 1.139, Global test loss: 1.049, Global test accuracy: 86.04
Round  72, Train loss: 1.210, Test loss: 1.130, Test accuracy: 77.32
Round  72, Global train loss: 1.210, Global test loss: 1.056, Global test accuracy: 85.52
Round  73, Train loss: 1.232, Test loss: 1.130, Test accuracy: 77.30
Round  73, Global train loss: 1.232, Global test loss: 1.045, Global test accuracy: 86.86
Round  74, Train loss: 1.133, Test loss: 1.127, Test accuracy: 77.64
Round  74, Global train loss: 1.133, Global test loss: 1.028, Global test accuracy: 88.00
Round  75, Train loss: 1.222, Test loss: 1.127, Test accuracy: 77.70
Round  75, Global train loss: 1.222, Global test loss: 1.061, Global test accuracy: 84.88
Round  76, Train loss: 1.118, Test loss: 1.124, Test accuracy: 77.74
Round  76, Global train loss: 1.118, Global test loss: 1.059, Global test accuracy: 85.14
Round  77, Train loss: 1.183, Test loss: 1.131, Test accuracy: 77.18
Round  77, Global train loss: 1.183, Global test loss: 1.062, Global test accuracy: 84.48
Round  78, Train loss: 1.074, Test loss: 1.126, Test accuracy: 77.90
Round  78, Global train loss: 1.074, Global test loss: 1.005, Global test accuracy: 90.20
Round  79, Train loss: 1.226, Test loss: 1.129, Test accuracy: 77.38
Round  79, Global train loss: 1.226, Global test loss: 1.073, Global test accuracy: 83.38
Round  80, Train loss: 1.137, Test loss: 1.131, Test accuracy: 77.06
Round  80, Global train loss: 1.137, Global test loss: 1.040, Global test accuracy: 87.02
Round  81, Train loss: 0.975, Test loss: 1.129, Test accuracy: 77.30
Round  81, Global train loss: 0.975, Global test loss: 0.998, Global test accuracy: 91.14
Round  82, Train loss: 1.213, Test loss: 1.128, Test accuracy: 77.38
Round  82, Global train loss: 1.213, Global test loss: 1.070, Global test accuracy: 84.02
Round  83, Train loss: 1.104, Test loss: 1.138, Test accuracy: 76.30
Round  83, Global train loss: 1.104, Global test loss: 1.046, Global test accuracy: 86.56
Round  84, Train loss: 1.129, Test loss: 1.139, Test accuracy: 76.20
Round  84, Global train loss: 1.129, Global test loss: 1.043, Global test accuracy: 86.64
Round  85, Train loss: 1.114, Test loss: 1.139, Test accuracy: 76.34
Round  85, Global train loss: 1.114, Global test loss: 1.051, Global test accuracy: 85.20
Round  86, Train loss: 1.046, Test loss: 1.141, Test accuracy: 76.18
Round  86, Global train loss: 1.046, Global test loss: 1.021, Global test accuracy: 88.72
Round  87, Train loss: 1.198, Test loss: 1.139, Test accuracy: 76.44
Round  87, Global train loss: 1.198, Global test loss: 1.059, Global test accuracy: 85.12
Round  88, Train loss: 1.183, Test loss: 1.141, Test accuracy: 76.18
Round  88, Global train loss: 1.183, Global test loss: 1.085, Global test accuracy: 82.18
Round  89, Train loss: 1.050, Test loss: 1.143, Test accuracy: 75.92
Round  89, Global train loss: 1.050, Global test loss: 1.016, Global test accuracy: 89.30
Round  90, Train loss: 1.337, Test loss: 1.140, Test accuracy: 76.10
Round  90, Global train loss: 1.337, Global test loss: 1.185, Global test accuracy: 71.64
Round  91, Train loss: 1.121, Test loss: 1.147, Test accuracy: 75.14
Round  91, Global train loss: 1.121, Global test loss: 1.055, Global test accuracy: 85.36
Round  92, Train loss: 1.365, Test loss: 1.160, Test accuracy: 73.76
Round  92, Global train loss: 1.365, Global test loss: 1.182, Global test accuracy: 72.08
Round  93, Train loss: 1.201, Test loss: 1.160, Test accuracy: 73.96
Round  93, Global train loss: 1.201, Global test loss: 1.061, Global test accuracy: 84.58
Round  94, Train loss: 1.096, Test loss: 1.163, Test accuracy: 73.58
Round  94, Global train loss: 1.096, Global test loss: 1.061, Global test accuracy: 84.78/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.240, Test loss: 1.162, Test accuracy: 73.72
Round  95, Global train loss: 1.240, Global test loss: 1.174, Global test accuracy: 72.72
Round  96, Train loss: 1.252, Test loss: 1.169, Test accuracy: 73.28
Round  96, Global train loss: 1.252, Global test loss: 1.191, Global test accuracy: 71.14
Round  97, Train loss: 1.178, Test loss: 1.166, Test accuracy: 73.66
Round  97, Global train loss: 1.178, Global test loss: 1.089, Global test accuracy: 82.14
Round  98, Train loss: 1.114, Test loss: 1.169, Test accuracy: 73.20
Round  98, Global train loss: 1.114, Global test loss: 1.066, Global test accuracy: 83.98
Round  99, Train loss: 1.312, Test loss: 1.171, Test accuracy: 72.94
Round  99, Global train loss: 1.312, Global test loss: 1.204, Global test accuracy: 69.66
Final Round, Train loss: 1.148, Test loss: 1.195, Test accuracy: 70.24
Final Round, Global train loss: 1.148, Global test loss: 1.204, Global test accuracy: 69.66
Average accuracy final 10 rounds: 73.934 

Average global accuracy final 10 rounds: 77.80799999999999 

680.2128684520721
[0.9808199405670166, 1.9616398811340332, 2.8003411293029785, 3.639042377471924, 4.478955268859863, 5.318868160247803, 6.120701789855957, 6.922535419464111, 7.726315498352051, 8.53009557723999, 9.312287330627441, 10.094479084014893, 10.873480319976807, 11.65248155593872, 12.474493026733398, 13.296504497528076, 14.1398184299469, 14.983132362365723, 15.81740427017212, 16.651676177978516, 17.479146718978882, 18.306617259979248, 19.166767835617065, 20.026918411254883, 20.87435221672058, 21.72178602218628, 22.57890224456787, 23.436018466949463, 24.228219985961914, 25.020421504974365, 25.88342022895813, 26.746418952941895, 27.616578340530396, 28.486737728118896, 29.29557704925537, 30.104416370391846, 30.89716625213623, 31.689916133880615, 32.51200580596924, 33.33409547805786, 34.16552495956421, 34.99695444107056, 35.845152139663696, 36.693349838256836, 37.51603603363037, 38.338722229003906, 39.14047384262085, 39.94222545623779, 40.78844404220581, 41.63466262817383, 42.47517490386963, 43.31568717956543, 44.13563776016235, 44.95558834075928, 45.7850456237793, 46.614502906799316, 47.48789644241333, 48.361289978027344, 49.19057774543762, 50.0198655128479, 50.8364143371582, 51.652963161468506, 52.49100041389465, 53.3290376663208, 54.11284065246582, 54.89664363861084, 55.75544714927673, 56.61425065994263, 57.43812084197998, 58.261991024017334, 59.07956838607788, 59.89714574813843, 60.77101492881775, 61.64488410949707, 62.44067740440369, 63.2364706993103, 64.02067565917969, 64.80488061904907, 65.60053873062134, 66.3961968421936, 67.2187328338623, 68.041268825531, 68.89292287826538, 69.74457693099976, 70.5630054473877, 71.38143396377563, 72.20427203178406, 73.02711009979248, 73.82141828536987, 74.61572647094727, 75.45245575904846, 76.28918504714966, 77.11290860176086, 77.93663215637207, 78.77618455886841, 79.61573696136475, 80.4381787776947, 81.26062059402466, 82.06251358985901, 82.86440658569336, 83.66448450088501, 84.46456241607666, 85.28779578208923, 86.1110291481018, 86.99303913116455, 87.8750491142273, 88.68679475784302, 89.49854040145874, 90.32177639007568, 91.14501237869263, 91.94081330299377, 92.73661422729492, 93.55389714241028, 94.37118005752563, 95.24567532539368, 96.12017059326172, 96.95195937156677, 97.78374814987183, 98.61810445785522, 99.45246076583862, 100.25842428207397, 101.06438779830933, 101.87877988815308, 102.69317197799683, 103.5092658996582, 104.32535982131958, 105.16531562805176, 106.00527143478394, 106.88064479827881, 107.75601816177368, 108.55907440185547, 109.36213064193726, 110.19883823394775, 111.03554582595825, 111.87395024299622, 112.71235466003418, 113.54550218582153, 114.37864971160889, 115.21496844291687, 116.05128717422485, 116.86965465545654, 117.68802213668823, 118.48172736167908, 119.27543258666992, 120.16821479797363, 121.06099700927734, 121.92727947235107, 122.7935619354248, 123.64763879776001, 124.50171566009521, 125.3186502456665, 126.1355848312378, 126.95311284065247, 127.77064085006714, 128.72142624855042, 129.6722116470337, 130.53682708740234, 131.401442527771, 132.18185830116272, 132.96227407455444, 133.80063223838806, 134.63899040222168, 135.4634759426117, 136.2879614830017, 137.13761115074158, 137.98726081848145, 138.81543850898743, 139.6436161994934, 140.50967025756836, 141.3757243156433, 142.166907787323, 142.95809125900269, 143.768896818161, 144.57970237731934, 145.42718243598938, 146.27466249465942, 147.1443169116974, 148.01397132873535, 148.85000085830688, 149.68603038787842, 150.50950837135315, 151.33298635482788, 152.18062496185303, 153.02826356887817, 153.8626127243042, 154.69696187973022, 155.54597544670105, 156.39498901367188, 157.2388207912445, 158.08265256881714, 158.90631246566772, 159.7299723625183, 160.62271332740784, 161.51545429229736, 162.3483555316925, 163.18125677108765, 164.01450371742249, 164.84775066375732, 165.70634365081787, 166.56493663787842, 168.28566527366638, 170.00639390945435]
[46.36, 46.36, 65.64, 65.64, 77.24, 77.24, 79.38, 79.38, 81.38, 81.38, 82.94, 82.94, 82.1, 82.1, 81.86, 81.86, 88.18, 88.18, 87.66, 87.66, 88.6, 88.6, 88.56, 88.56, 89.28, 89.28, 89.9, 89.9, 89.8, 89.8, 89.34, 89.34, 88.98, 88.98, 88.04, 88.04, 87.98, 87.98, 87.28, 87.28, 87.3, 87.3, 87.36, 87.36, 86.46, 86.46, 86.94, 86.94, 86.38, 86.38, 86.54, 86.54, 85.34, 85.34, 85.86, 85.86, 86.44, 86.44, 86.46, 86.46, 85.72, 85.72, 84.94, 84.94, 84.44, 84.44, 84.1, 84.1, 84.4, 84.4, 84.7, 84.7, 84.0, 84.0, 83.86, 83.86, 83.76, 83.76, 84.02, 84.02, 83.54, 83.54, 82.7, 82.7, 83.06, 83.06, 82.2, 82.2, 82.28, 82.28, 81.94, 81.94, 81.44, 81.44, 80.94, 80.94, 80.46, 80.46, 79.82, 79.82, 78.78, 78.78, 78.26, 78.26, 78.06, 78.06, 78.3, 78.3, 78.88, 78.88, 77.24, 77.24, 78.58, 78.58, 78.44, 78.44, 78.02, 78.02, 78.26, 78.26, 77.38, 77.38, 77.32, 77.32, 77.62, 77.62, 77.54, 77.54, 77.24, 77.24, 77.66, 77.66, 77.92, 77.92, 77.32, 77.32, 77.32, 77.32, 77.08, 77.08, 77.7, 77.7, 77.18, 77.18, 77.32, 77.32, 77.3, 77.3, 77.64, 77.64, 77.7, 77.7, 77.74, 77.74, 77.18, 77.18, 77.9, 77.9, 77.38, 77.38, 77.06, 77.06, 77.3, 77.3, 77.38, 77.38, 76.3, 76.3, 76.2, 76.2, 76.34, 76.34, 76.18, 76.18, 76.44, 76.44, 76.18, 76.18, 75.92, 75.92, 76.1, 76.1, 75.14, 75.14, 73.76, 73.76, 73.96, 73.96, 73.58, 73.58, 73.72, 73.72, 73.28, 73.28, 73.66, 73.66, 73.2, 73.2, 72.94, 72.94, 70.24, 70.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 4, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.595, Test loss: 1.583, Test accuracy: 57.88
Round   0, Global train loss: 1.595, Global test loss: 1.587, Global test accuracy: 65.92
Round   1, Train loss: 1.602, Test loss: 1.569, Test accuracy: 59.30
Round   1, Global train loss: 1.602, Global test loss: 1.572, Global test accuracy: 65.72
Round   2, Train loss: 1.458, Test loss: 1.402, Test accuracy: 67.60
Round   2, Global train loss: 1.458, Global test loss: 1.328, Global test accuracy: 75.86
Round   3, Train loss: 1.441, Test loss: 1.336, Test accuracy: 68.54
Round   3, Global train loss: 1.441, Global test loss: 1.227, Global test accuracy: 76.52
Round   4, Train loss: 1.402, Test loss: 1.261, Test accuracy: 73.98
Round   4, Global train loss: 1.402, Global test loss: 1.150, Global test accuracy: 84.98
Round   5, Train loss: 1.550, Test loss: 1.219, Test accuracy: 78.30
Round   5, Global train loss: 1.550, Global test loss: 1.168, Global test accuracy: 85.84
Round   6, Train loss: 1.546, Test loss: 1.233, Test accuracy: 75.02
Round   6, Global train loss: 1.546, Global test loss: 1.161, Global test accuracy: 82.56
Round   7, Train loss: 1.553, Test loss: 1.235, Test accuracy: 74.74
Round   7, Global train loss: 1.553, Global test loss: 1.166, Global test accuracy: 87.44
Round   8, Train loss: 1.441, Test loss: 1.159, Test accuracy: 81.90
Round   8, Global train loss: 1.441, Global test loss: 1.091, Global test accuracy: 92.32
Round   9, Train loss: 1.245, Test loss: 1.141, Test accuracy: 83.10
Round   9, Global train loss: 1.245, Global test loss: 1.028, Global test accuracy: 93.82
Round  10, Train loss: 1.201, Test loss: 1.114, Test accuracy: 84.76
Round  10, Global train loss: 1.201, Global test loss: 1.013, Global test accuracy: 91.68
Round  11, Train loss: 1.346, Test loss: 1.089, Test accuracy: 86.74
Round  11, Global train loss: 1.346, Global test loss: 1.012, Global test accuracy: 91.58
Round  12, Train loss: 1.419, Test loss: 1.072, Test accuracy: 86.40
Round  12, Global train loss: 1.419, Global test loss: 1.012, Global test accuracy: 93.52
Round  13, Train loss: 1.249, Test loss: 1.074, Test accuracy: 85.74
Round  13, Global train loss: 1.249, Global test loss: 1.000, Global test accuracy: 93.90
Round  14, Train loss: 1.538, Test loss: 1.068, Test accuracy: 86.10
Round  14, Global train loss: 1.538, Global test loss: 1.030, Global test accuracy: 90.68
Round  15, Train loss: 1.211, Test loss: 1.065, Test accuracy: 86.22
Round  15, Global train loss: 1.211, Global test loss: 0.987, Global test accuracy: 93.90
Round  16, Train loss: 1.334, Test loss: 1.060, Test accuracy: 86.98
Round  16, Global train loss: 1.334, Global test loss: 1.014, Global test accuracy: 91.74
Round  17, Train loss: 1.527, Test loss: 1.050, Test accuracy: 86.90
Round  17, Global train loss: 1.527, Global test loss: 1.003, Global test accuracy: 92.78
Round  18, Train loss: 1.326, Test loss: 1.059, Test accuracy: 85.96
Round  18, Global train loss: 1.326, Global test loss: 1.004, Global test accuracy: 92.54
Round  19, Train loss: 1.330, Test loss: 1.059, Test accuracy: 85.88
Round  19, Global train loss: 1.330, Global test loss: 1.007, Global test accuracy: 91.96
Round  20, Train loss: 1.198, Test loss: 1.063, Test accuracy: 85.42
Round  20, Global train loss: 1.198, Global test loss: 0.978, Global test accuracy: 94.18
Round  21, Train loss: 1.322, Test loss: 1.067, Test accuracy: 84.96
Round  21, Global train loss: 1.322, Global test loss: 0.996, Global test accuracy: 92.48
Round  22, Train loss: 1.319, Test loss: 1.066, Test accuracy: 84.76
Round  22, Global train loss: 1.319, Global test loss: 0.998, Global test accuracy: 92.46
Round  23, Train loss: 1.315, Test loss: 1.067, Test accuracy: 84.46
Round  23, Global train loss: 1.315, Global test loss: 0.999, Global test accuracy: 92.24
Round  24, Train loss: 1.340, Test loss: 1.071, Test accuracy: 84.06
Round  24, Global train loss: 1.340, Global test loss: 1.045, Global test accuracy: 87.38
Round  25, Train loss: 1.489, Test loss: 1.069, Test accuracy: 84.38
Round  25, Global train loss: 1.489, Global test loss: 1.074, Global test accuracy: 84.60
Round  26, Train loss: 1.153, Test loss: 1.061, Test accuracy: 85.24
Round  26, Global train loss: 1.153, Global test loss: 0.979, Global test accuracy: 94.04
Round  27, Train loss: 1.480, Test loss: 1.061, Test accuracy: 85.08
Round  27, Global train loss: 1.480, Global test loss: 1.086, Global test accuracy: 83.08
Round  28, Train loss: 1.127, Test loss: 1.066, Test accuracy: 84.70
Round  28, Global train loss: 1.127, Global test loss: 0.975, Global test accuracy: 94.24
Round  29, Train loss: 1.176, Test loss: 1.078, Test accuracy: 83.28
Round  29, Global train loss: 1.176, Global test loss: 0.972, Global test accuracy: 94.72
Round  30, Train loss: 1.300, Test loss: 1.085, Test accuracy: 82.60
Round  30, Global train loss: 1.300, Global test loss: 1.006, Global test accuracy: 91.78
Round  31, Train loss: 1.460, Test loss: 1.084, Test accuracy: 82.74
Round  31, Global train loss: 1.460, Global test loss: 1.091, Global test accuracy: 83.28
Round  32, Train loss: 1.140, Test loss: 1.089, Test accuracy: 81.98
Round  32, Global train loss: 1.140, Global test loss: 0.997, Global test accuracy: 92.30
Round  33, Train loss: 1.279, Test loss: 1.092, Test accuracy: 81.40
Round  33, Global train loss: 1.279, Global test loss: 1.016, Global test accuracy: 90.26
Round  34, Train loss: 1.280, Test loss: 1.092, Test accuracy: 81.42
Round  34, Global train loss: 1.280, Global test loss: 1.005, Global test accuracy: 91.36
Round  35, Train loss: 1.356, Test loss: 1.086, Test accuracy: 82.34
Round  35, Global train loss: 1.356, Global test loss: 1.018, Global test accuracy: 89.92
Round  36, Train loss: 1.171, Test loss: 1.101, Test accuracy: 80.82
Round  36, Global train loss: 1.171, Global test loss: 1.049, Global test accuracy: 85.90
Round  37, Train loss: 1.280, Test loss: 1.099, Test accuracy: 80.78
Round  37, Global train loss: 1.280, Global test loss: 1.020, Global test accuracy: 89.76
Round  38, Train loss: 1.147, Test loss: 1.094, Test accuracy: 81.50
Round  38, Global train loss: 1.147, Global test loss: 1.032, Global test accuracy: 88.46
Round  39, Train loss: 1.312, Test loss: 1.088, Test accuracy: 82.30
Round  39, Global train loss: 1.312, Global test loss: 1.057, Global test accuracy: 86.02
Round  40, Train loss: 1.152, Test loss: 1.100, Test accuracy: 80.90
Round  40, Global train loss: 1.152, Global test loss: 1.003, Global test accuracy: 91.22
Round  41, Train loss: 1.182, Test loss: 1.101, Test accuracy: 80.60
Round  41, Global train loss: 1.182, Global test loss: 1.014, Global test accuracy: 90.36
Round  42, Train loss: 1.242, Test loss: 1.106, Test accuracy: 79.90
Round  42, Global train loss: 1.242, Global test loss: 1.040, Global test accuracy: 87.86
Round  43, Train loss: 1.253, Test loss: 1.116, Test accuracy: 78.80
Round  43, Global train loss: 1.253, Global test loss: 1.027, Global test accuracy: 88.98
Round  44, Train loss: 1.101, Test loss: 1.111, Test accuracy: 79.20
Round  44, Global train loss: 1.101, Global test loss: 0.981, Global test accuracy: 93.44
Round  45, Train loss: 1.266, Test loss: 1.115, Test accuracy: 78.44
Round  45, Global train loss: 1.266, Global test loss: 1.022, Global test accuracy: 89.08
Round  46, Train loss: 1.132, Test loss: 1.115, Test accuracy: 78.56
Round  46, Global train loss: 1.132, Global test loss: 1.053, Global test accuracy: 86.00
Round  47, Train loss: 1.308, Test loss: 1.106, Test accuracy: 79.48
Round  47, Global train loss: 1.308, Global test loss: 1.043, Global test accuracy: 87.12
Round  48, Train loss: 1.104, Test loss: 1.100, Test accuracy: 80.28
Round  48, Global train loss: 1.104, Global test loss: 0.996, Global test accuracy: 91.64
Round  49, Train loss: 1.112, Test loss: 1.101, Test accuracy: 80.30
Round  49, Global train loss: 1.112, Global test loss: 0.998, Global test accuracy: 91.46
Round  50, Train loss: 1.242, Test loss: 1.098, Test accuracy: 80.52
Round  50, Global train loss: 1.242, Global test loss: 1.028, Global test accuracy: 88.62
Round  51, Train loss: 1.294, Test loss: 1.104, Test accuracy: 80.04
Round  51, Global train loss: 1.294, Global test loss: 1.098, Global test accuracy: 81.40
Round  52, Train loss: 1.252, Test loss: 1.110, Test accuracy: 79.42
Round  52, Global train loss: 1.252, Global test loss: 1.059, Global test accuracy: 85.44
Round  53, Train loss: 1.130, Test loss: 1.121, Test accuracy: 78.40
Round  53, Global train loss: 1.130, Global test loss: 1.012, Global test accuracy: 90.20
Round  54, Train loss: 1.151, Test loss: 1.116, Test accuracy: 78.94
Round  54, Global train loss: 1.151, Global test loss: 0.998, Global test accuracy: 91.54
Round  55, Train loss: 1.242, Test loss: 1.115, Test accuracy: 78.84
Round  55, Global train loss: 1.242, Global test loss: 1.018, Global test accuracy: 89.86
Round  56, Train loss: 1.153, Test loss: 1.113, Test accuracy: 79.40
Round  56, Global train loss: 1.153, Global test loss: 1.024, Global test accuracy: 88.94
Round  57, Train loss: 1.211, Test loss: 1.115, Test accuracy: 79.10
Round  57, Global train loss: 1.211, Global test loss: 1.044, Global test accuracy: 86.80
Round  58, Train loss: 1.105, Test loss: 1.117, Test accuracy: 78.78
Round  58, Global train loss: 1.105, Global test loss: 1.005, Global test accuracy: 90.76
Round  59, Train loss: 1.256, Test loss: 1.123, Test accuracy: 78.02
Round  59, Global train loss: 1.256, Global test loss: 1.054, Global test accuracy: 86.16
Round  60, Train loss: 1.387, Test loss: 1.131, Test accuracy: 77.24
Round  60, Global train loss: 1.387, Global test loss: 1.135, Global test accuracy: 77.54
Round  61, Train loss: 1.370, Test loss: 1.133, Test accuracy: 77.02
Round  61, Global train loss: 1.370, Global test loss: 1.141, Global test accuracy: 76.76
Round  62, Train loss: 1.347, Test loss: 1.144, Test accuracy: 75.74
Round  62, Global train loss: 1.347, Global test loss: 1.188, Global test accuracy: 71.30
Round  63, Train loss: 1.215, Test loss: 1.151, Test accuracy: 75.10
Round  63, Global train loss: 1.215, Global test loss: 1.070, Global test accuracy: 84.30
Round  64, Train loss: 1.182, Test loss: 1.144, Test accuracy: 75.62
Round  64, Global train loss: 1.182, Global test loss: 1.109, Global test accuracy: 80.28
Round  65, Train loss: 1.182, Test loss: 1.156, Test accuracy: 74.16
Round  65, Global train loss: 1.182, Global test loss: 1.082, Global test accuracy: 83.06
Round  66, Train loss: 1.345, Test loss: 1.176, Test accuracy: 71.90
Round  66, Global train loss: 1.345, Global test loss: 1.164, Global test accuracy: 74.04
Round  67, Train loss: 0.978, Test loss: 1.180, Test accuracy: 71.58
Round  67, Global train loss: 0.978, Global test loss: 0.992, Global test accuracy: 92.00
Round  68, Train loss: 1.042, Test loss: 1.173, Test accuracy: 72.26
Round  68, Global train loss: 1.042, Global test loss: 0.994, Global test accuracy: 91.92
Round  69, Train loss: 1.126, Test loss: 1.165, Test accuracy: 73.08
Round  69, Global train loss: 1.126, Global test loss: 1.013, Global test accuracy: 89.94
Round  70, Train loss: 1.096, Test loss: 1.167, Test accuracy: 72.92
Round  70, Global train loss: 1.096, Global test loss: 0.999, Global test accuracy: 91.44
Round  71, Train loss: 1.196, Test loss: 1.168, Test accuracy: 73.06
Round  71, Global train loss: 1.196, Global test loss: 1.081, Global test accuracy: 83.22
Round  72, Train loss: 1.120, Test loss: 1.161, Test accuracy: 73.96
Round  72, Global train loss: 1.120, Global test loss: 1.024, Global test accuracy: 89.18
Round  73, Train loss: 1.210, Test loss: 1.157, Test accuracy: 74.46
Round  73, Global train loss: 1.210, Global test loss: 1.082, Global test accuracy: 82.26
Round  74, Train loss: 1.329, Test loss: 1.160, Test accuracy: 74.36
Round  74, Global train loss: 1.329, Global test loss: 1.184, Global test accuracy: 72.10
Round  75, Train loss: 1.049, Test loss: 1.169, Test accuracy: 73.26
Round  75, Global train loss: 1.049, Global test loss: 1.042, Global test accuracy: 86.76
Round  76, Train loss: 1.027, Test loss: 1.175, Test accuracy: 72.62
Round  76, Global train loss: 1.027, Global test loss: 1.010, Global test accuracy: 90.28
Round  77, Train loss: 1.079, Test loss: 1.170, Test accuracy: 73.08
Round  77, Global train loss: 1.079, Global test loss: 1.021, Global test accuracy: 88.96
Round  78, Train loss: 1.077, Test loss: 1.167, Test accuracy: 73.32
Round  78, Global train loss: 1.077, Global test loss: 1.015, Global test accuracy: 89.36
Round  79, Train loss: 1.194, Test loss: 1.162, Test accuracy: 73.82
Round  79, Global train loss: 1.194, Global test loss: 1.083, Global test accuracy: 82.90
Round  80, Train loss: 1.188, Test loss: 1.149, Test accuracy: 75.16
Round  80, Global train loss: 1.188, Global test loss: 1.060, Global test accuracy: 85.38
Round  81, Train loss: 1.164, Test loss: 1.146, Test accuracy: 75.40
Round  81, Global train loss: 1.164, Global test loss: 1.098, Global test accuracy: 81.30
Round  82, Train loss: 0.927, Test loss: 1.147, Test accuracy: 75.28
Round  82, Global train loss: 0.927, Global test loss: 0.985, Global test accuracy: 92.38
Round  83, Train loss: 1.212, Test loss: 1.137, Test accuracy: 76.64
Round  83, Global train loss: 1.212, Global test loss: 1.102, Global test accuracy: 80.34
Round  84, Train loss: 1.283, Test loss: 1.151, Test accuracy: 75.30
Round  84, Global train loss: 1.283, Global test loss: 1.189, Global test accuracy: 71.88
Round  85, Train loss: 1.275, Test loss: 1.175, Test accuracy: 72.66
Round  85, Global train loss: 1.275, Global test loss: 1.252, Global test accuracy: 65.24
Round  86, Train loss: 1.305, Test loss: 1.175, Test accuracy: 72.52
Round  86, Global train loss: 1.305, Global test loss: 1.205, Global test accuracy: 69.94
Round  87, Train loss: 1.220, Test loss: 1.176, Test accuracy: 72.28
Round  87, Global train loss: 1.220, Global test loss: 1.120, Global test accuracy: 78.74
Round  88, Train loss: 1.185, Test loss: 1.188, Test accuracy: 71.24
Round  88, Global train loss: 1.185, Global test loss: 1.132, Global test accuracy: 78.42
Round  89, Train loss: 1.023, Test loss: 1.188, Test accuracy: 71.24
Round  89, Global train loss: 1.023, Global test loss: 1.013, Global test accuracy: 89.76
Round  90, Train loss: 1.059, Test loss: 1.189, Test accuracy: 71.12
Round  90, Global train loss: 1.059, Global test loss: 1.019, Global test accuracy: 89.46
Round  91, Train loss: 1.270, Test loss: 1.178, Test accuracy: 72.46
Round  91, Global train loss: 1.270, Global test loss: 1.183, Global test accuracy: 72.28
Round  92, Train loss: 1.227, Test loss: 1.184, Test accuracy: 71.88
Round  92, Global train loss: 1.227, Global test loss: 1.069, Global test accuracy: 84.18
Round  93, Train loss: 1.060, Test loss: 1.180, Test accuracy: 72.38
Round  93, Global train loss: 1.060, Global test loss: 1.003, Global test accuracy: 90.64
Round  94, Train loss: 1.165, Test loss: 1.173, Test accuracy: 72.98
Round  94, Global train loss: 1.165, Global test loss: 1.134, Global test accuracy: 77.50/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.280, Test loss: 1.176, Test accuracy: 72.52
Round  95, Global train loss: 1.280, Global test loss: 1.265, Global test accuracy: 62.88
Round  96, Train loss: 1.147, Test loss: 1.180, Test accuracy: 71.90
Round  96, Global train loss: 1.147, Global test loss: 1.154, Global test accuracy: 75.50
Round  97, Train loss: 1.282, Test loss: 1.201, Test accuracy: 69.64
Round  97, Global train loss: 1.282, Global test loss: 1.209, Global test accuracy: 69.38
Round  98, Train loss: 1.146, Test loss: 1.189, Test accuracy: 70.90
Round  98, Global train loss: 1.146, Global test loss: 1.159, Global test accuracy: 74.84
Round  99, Train loss: 1.222, Test loss: 1.209, Test accuracy: 68.76
Round  99, Global train loss: 1.222, Global test loss: 1.223, Global test accuracy: 67.76
Final Round, Train loss: 1.121, Test loss: 1.207, Test accuracy: 69.20
Final Round, Global train loss: 1.121, Global test loss: 1.223, Global test accuracy: 67.76
Average accuracy final 10 rounds: 71.45400000000001 

Average global accuracy final 10 rounds: 76.442 

703.7767148017883
[1.0157389640808105, 2.031477928161621, 2.9452462196350098, 3.8590145111083984, 4.729001522064209, 5.5989885330200195, 6.508008718490601, 7.417028903961182, 8.31252121925354, 9.208013534545898, 10.062528610229492, 10.917043685913086, 11.8247971534729, 12.732550621032715, 13.652239322662354, 14.571928024291992, 15.465651512145996, 16.359375, 17.24414587020874, 18.12891674041748, 19.01898169517517, 19.90904664993286, 20.838677167892456, 21.76830768585205, 22.67594838142395, 23.58358907699585, 24.54809284210205, 25.512596607208252, 26.38235569000244, 27.25211477279663, 28.143652200698853, 29.035189628601074, 29.914679765701294, 30.794169902801514, 31.70959734916687, 32.62502479553223, 33.474175691604614, 34.323326587677, 35.28499245643616, 36.24665832519531, 37.12101888656616, 37.99537944793701, 38.88588833808899, 39.77639722824097, 40.662273645401, 41.548150062561035, 42.440797567367554, 43.33344507217407, 44.25636911392212, 45.179293155670166, 46.096598863601685, 47.0139045715332, 47.90124559402466, 48.78858661651611, 49.67310643196106, 50.557626247406006, 51.513322591781616, 52.46901893615723, 53.366450786590576, 54.263882637023926, 55.148027181625366, 56.03217172622681, 56.899683713912964, 57.76719570159912, 58.66681098937988, 59.566426277160645, 60.42933630943298, 61.29224634170532, 62.20058560371399, 63.108924865722656, 64.00377631187439, 64.89862775802612, 65.77713370323181, 66.6556396484375, 67.54110956192017, 68.42657947540283, 69.32577586174011, 70.22497224807739, 71.14392161369324, 72.06287097930908, 72.99857473373413, 73.93427848815918, 74.84648513793945, 75.75869178771973, 76.68008756637573, 77.60148334503174, 78.63897943496704, 79.67647552490234, 80.57487344741821, 81.47327136993408, 82.44023513793945, 83.40719890594482, 84.26707696914673, 85.12695503234863, 86.01773142814636, 86.90850782394409, 87.87951636314392, 88.85052490234375, 89.78158211708069, 90.71263933181763, 91.63447976112366, 92.55632019042969, 93.49506878852844, 94.4338173866272, 95.39329028129578, 96.35276317596436, 97.20307683944702, 98.05339050292969, 98.95815420150757, 99.86291790008545, 100.76374173164368, 101.6645655632019, 102.56425309181213, 103.46394062042236, 104.3564465045929, 105.24895238876343, 106.1614260673523, 107.07389974594116, 107.95683670043945, 108.83977365493774, 109.69773721694946, 110.55570077896118, 111.521484375, 112.48726797103882, 113.40132784843445, 114.31538772583008, 115.29019498825073, 116.26500225067139, 117.14003705978394, 118.01507186889648, 118.92546892166138, 119.83586597442627, 120.75272154808044, 121.66957712173462, 122.5724585056305, 123.47533988952637, 124.41199088096619, 125.348641872406, 126.22973108291626, 127.11082029342651, 128.02563881874084, 128.94045734405518, 129.84768652915955, 130.75491571426392, 131.65213704109192, 132.54935836791992, 133.42973971366882, 134.31012105941772, 135.2012369632721, 136.09235286712646, 137.08778548240662, 138.08321809768677, 139.07156014442444, 140.0599021911621, 140.96924018859863, 141.87857818603516, 142.80622005462646, 143.73386192321777, 144.74761199951172, 145.76136207580566, 146.65290427207947, 147.54444646835327, 148.48922967910767, 149.43401288986206, 150.33459329605103, 151.23517370224, 152.13569378852844, 153.0362138748169, 153.94219827651978, 154.84818267822266, 155.7206928730011, 156.59320306777954, 157.42080235481262, 158.2484016418457, 159.1239264011383, 159.9994511604309, 160.8471212387085, 161.69479131698608, 162.64953017234802, 163.60426902770996, 164.45075750350952, 165.29724597930908, 166.1960666179657, 167.09488725662231, 167.97738337516785, 168.85987949371338, 169.73914122581482, 170.61840295791626, 171.47634291648865, 172.33428287506104, 173.2162733078003, 174.09826374053955, 174.97732090950012, 175.8563780784607, 176.73962569236755, 177.6228733062744, 178.5590181350708, 179.4951629638672, 180.42862176895142, 181.36208057403564, 183.09024119377136, 184.81840181350708]
[57.88, 57.88, 59.3, 59.3, 67.6, 67.6, 68.54, 68.54, 73.98, 73.98, 78.3, 78.3, 75.02, 75.02, 74.74, 74.74, 81.9, 81.9, 83.1, 83.1, 84.76, 84.76, 86.74, 86.74, 86.4, 86.4, 85.74, 85.74, 86.1, 86.1, 86.22, 86.22, 86.98, 86.98, 86.9, 86.9, 85.96, 85.96, 85.88, 85.88, 85.42, 85.42, 84.96, 84.96, 84.76, 84.76, 84.46, 84.46, 84.06, 84.06, 84.38, 84.38, 85.24, 85.24, 85.08, 85.08, 84.7, 84.7, 83.28, 83.28, 82.6, 82.6, 82.74, 82.74, 81.98, 81.98, 81.4, 81.4, 81.42, 81.42, 82.34, 82.34, 80.82, 80.82, 80.78, 80.78, 81.5, 81.5, 82.3, 82.3, 80.9, 80.9, 80.6, 80.6, 79.9, 79.9, 78.8, 78.8, 79.2, 79.2, 78.44, 78.44, 78.56, 78.56, 79.48, 79.48, 80.28, 80.28, 80.3, 80.3, 80.52, 80.52, 80.04, 80.04, 79.42, 79.42, 78.4, 78.4, 78.94, 78.94, 78.84, 78.84, 79.4, 79.4, 79.1, 79.1, 78.78, 78.78, 78.02, 78.02, 77.24, 77.24, 77.02, 77.02, 75.74, 75.74, 75.1, 75.1, 75.62, 75.62, 74.16, 74.16, 71.9, 71.9, 71.58, 71.58, 72.26, 72.26, 73.08, 73.08, 72.92, 72.92, 73.06, 73.06, 73.96, 73.96, 74.46, 74.46, 74.36, 74.36, 73.26, 73.26, 72.62, 72.62, 73.08, 73.08, 73.32, 73.32, 73.82, 73.82, 75.16, 75.16, 75.4, 75.4, 75.28, 75.28, 76.64, 76.64, 75.3, 75.3, 72.66, 72.66, 72.52, 72.52, 72.28, 72.28, 71.24, 71.24, 71.24, 71.24, 71.12, 71.12, 72.46, 72.46, 71.88, 71.88, 72.38, 72.38, 72.98, 72.98, 72.52, 72.52, 71.9, 71.9, 69.64, 69.64, 70.9, 70.9, 68.76, 68.76, 69.2, 69.2]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 5, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.622, Test loss: 1.587, Test accuracy: 61.10
Round   0, Global train loss: 1.622, Global test loss: 1.587, Global test accuracy: 60.94
Round   1, Train loss: 1.592, Test loss: 1.558, Test accuracy: 89.66
Round   1, Global train loss: 1.592, Global test loss: 1.558, Global test accuracy: 89.66
Round   2, Train loss: 1.598, Test loss: 1.543, Test accuracy: 87.96
Round   2, Global train loss: 1.598, Global test loss: 1.543, Global test accuracy: 87.68
Round   3, Train loss: 1.551, Test loss: 1.466, Test accuracy: 85.50
Round   3, Global train loss: 1.551, Global test loss: 1.460, Global test accuracy: 84.20
Round   4, Train loss: 1.413, Test loss: 1.297, Test accuracy: 88.42
Round   4, Global train loss: 1.413, Global test loss: 1.259, Global test accuracy: 83.00
Round   5, Train loss: 1.295, Test loss: 1.195, Test accuracy: 92.36
Round   5, Global train loss: 1.295, Global test loss: 1.139, Global test accuracy: 91.94
Round   6, Train loss: 1.226, Test loss: 1.136, Test accuracy: 94.16
Round   6, Global train loss: 1.226, Global test loss: 1.043, Global test accuracy: 94.96
Round   7, Train loss: 1.223, Test loss: 1.117, Test accuracy: 94.52
Round   7, Global train loss: 1.223, Global test loss: 1.049, Global test accuracy: 94.52
Round   8, Train loss: 1.243, Test loss: 1.083, Test accuracy: 94.76
Round   8, Global train loss: 1.243, Global test loss: 1.048, Global test accuracy: 94.98
Round   9, Train loss: 1.382, Test loss: 1.095, Test accuracy: 94.80
Round   9, Global train loss: 1.382, Global test loss: 1.088, Global test accuracy: 95.90
Round  10, Train loss: 1.369, Test loss: 1.108, Test accuracy: 94.70
Round  10, Global train loss: 1.369, Global test loss: 1.085, Global test accuracy: 95.78
Round  11, Train loss: 1.213, Test loss: 1.093, Test accuracy: 95.00
Round  11, Global train loss: 1.213, Global test loss: 1.033, Global test accuracy: 95.44
Round  12, Train loss: 1.364, Test loss: 1.100, Test accuracy: 94.92
Round  12, Global train loss: 1.364, Global test loss: 1.061, Global test accuracy: 95.86
Round  13, Train loss: 1.207, Test loss: 1.087, Test accuracy: 94.84
Round  13, Global train loss: 1.207, Global test loss: 1.024, Global test accuracy: 95.98
Round  14, Train loss: 1.353, Test loss: 1.103, Test accuracy: 94.64
Round  14, Global train loss: 1.353, Global test loss: 1.055, Global test accuracy: 95.56
Round  15, Train loss: 1.179, Test loss: 1.082, Test accuracy: 94.88
Round  15, Global train loss: 1.179, Global test loss: 1.011, Global test accuracy: 96.30
Round  16, Train loss: 1.390, Test loss: 1.104, Test accuracy: 94.44
Round  16, Global train loss: 1.390, Global test loss: 1.097, Global test accuracy: 94.38
Round  17, Train loss: 1.352, Test loss: 1.113, Test accuracy: 94.46
Round  17, Global train loss: 1.352, Global test loss: 1.068, Global test accuracy: 95.98
Round  18, Train loss: 1.348, Test loss: 1.122, Test accuracy: 94.42
Round  18, Global train loss: 1.348, Global test loss: 1.072, Global test accuracy: 95.70
Round  19, Train loss: 1.355, Test loss: 1.106, Test accuracy: 94.60
Round  19, Global train loss: 1.355, Global test loss: 1.068, Global test accuracy: 96.26
Round  20, Train loss: 1.161, Test loss: 1.076, Test accuracy: 95.02
Round  20, Global train loss: 1.161, Global test loss: 0.995, Global test accuracy: 96.60
Round  21, Train loss: 1.390, Test loss: 1.100, Test accuracy: 94.58
Round  21, Global train loss: 1.390, Global test loss: 1.100, Global test accuracy: 95.02
Round  22, Train loss: 1.179, Test loss: 1.084, Test accuracy: 94.86
Round  22, Global train loss: 1.179, Global test loss: 1.008, Global test accuracy: 96.14
Round  23, Train loss: 1.341, Test loss: 1.101, Test accuracy: 94.76
Round  23, Global train loss: 1.341, Global test loss: 1.057, Global test accuracy: 96.30
Round  24, Train loss: 1.340, Test loss: 1.110, Test accuracy: 94.02
Round  24, Global train loss: 1.340, Global test loss: 1.069, Global test accuracy: 95.56
Round  25, Train loss: 1.176, Test loss: 1.091, Test accuracy: 94.44
Round  25, Global train loss: 1.176, Global test loss: 1.009, Global test accuracy: 95.94
Round  26, Train loss: 1.545, Test loss: 1.143, Test accuracy: 91.80
Round  26, Global train loss: 1.545, Global test loss: 1.202, Global test accuracy: 92.56
Round  27, Train loss: 0.994, Test loss: 1.081, Test accuracy: 94.24
Round  27, Global train loss: 0.994, Global test loss: 0.974, Global test accuracy: 96.40
Round  28, Train loss: 1.539, Test loss: 1.125, Test accuracy: 93.28
Round  28, Global train loss: 1.539, Global test loss: 1.159, Global test accuracy: 95.56
Round  29, Train loss: 1.156, Test loss: 1.084, Test accuracy: 94.78
Round  29, Global train loss: 1.156, Global test loss: 0.994, Global test accuracy: 96.92
Round  30, Train loss: 1.358, Test loss: 1.109, Test accuracy: 93.44
Round  30, Global train loss: 1.358, Global test loss: 1.071, Global test accuracy: 94.74
Round  31, Train loss: 1.165, Test loss: 1.095, Test accuracy: 93.52
Round  31, Global train loss: 1.165, Global test loss: 1.012, Global test accuracy: 95.52
Round  32, Train loss: 1.545, Test loss: 1.137, Test accuracy: 90.60
Round  32, Global train loss: 1.545, Global test loss: 1.226, Global test accuracy: 93.08
Round  33, Train loss: 1.162, Test loss: 1.103, Test accuracy: 92.88
Round  33, Global train loss: 1.162, Global test loss: 1.005, Global test accuracy: 96.00
Round  34, Train loss: 1.331, Test loss: 1.112, Test accuracy: 92.08
Round  34, Global train loss: 1.331, Global test loss: 1.066, Global test accuracy: 95.58
Round  35, Train loss: 1.330, Test loss: 1.107, Test accuracy: 92.66
Round  35, Global train loss: 1.330, Global test loss: 1.068, Global test accuracy: 94.74
Round  36, Train loss: 1.326, Test loss: 1.115, Test accuracy: 92.00
Round  36, Global train loss: 1.326, Global test loss: 1.073, Global test accuracy: 95.18
Round  37, Train loss: 1.154, Test loss: 1.091, Test accuracy: 92.96
Round  37, Global train loss: 1.154, Global test loss: 0.998, Global test accuracy: 96.16
Round  38, Train loss: 1.150, Test loss: 1.081, Test accuracy: 92.98
Round  38, Global train loss: 1.150, Global test loss: 0.994, Global test accuracy: 96.22
Round  39, Train loss: 1.150, Test loss: 1.080, Test accuracy: 92.72
Round  39, Global train loss: 1.150, Global test loss: 0.994, Global test accuracy: 96.32
Round  40, Train loss: 1.314, Test loss: 1.106, Test accuracy: 90.52
Round  40, Global train loss: 1.314, Global test loss: 1.042, Global test accuracy: 95.40
Round  41, Train loss: 1.324, Test loss: 1.116, Test accuracy: 91.08
Round  41, Global train loss: 1.324, Global test loss: 1.063, Global test accuracy: 94.48
Round  42, Train loss: 1.327, Test loss: 1.125, Test accuracy: 89.74
Round  42, Global train loss: 1.327, Global test loss: 1.075, Global test accuracy: 94.16
Round  43, Train loss: 1.319, Test loss: 1.121, Test accuracy: 89.10
Round  43, Global train loss: 1.319, Global test loss: 1.086, Global test accuracy: 93.60
Round  44, Train loss: 1.490, Test loss: 1.172, Test accuracy: 84.62
Round  44, Global train loss: 1.490, Global test loss: 1.202, Global test accuracy: 87.62
Round  45, Train loss: 1.486, Test loss: 1.191, Test accuracy: 81.54
Round  45, Global train loss: 1.486, Global test loss: 1.236, Global test accuracy: 85.24
Round  46, Train loss: 1.151, Test loss: 1.099, Test accuracy: 90.52
Round  46, Global train loss: 1.151, Global test loss: 1.012, Global test accuracy: 94.60
Round  47, Train loss: 1.289, Test loss: 1.122, Test accuracy: 88.00
Round  47, Global train loss: 1.289, Global test loss: 1.071, Global test accuracy: 91.76
Round  48, Train loss: 1.314, Test loss: 1.121, Test accuracy: 87.66
Round  48, Global train loss: 1.314, Global test loss: 1.076, Global test accuracy: 93.68
Round  49, Train loss: 1.494, Test loss: 1.176, Test accuracy: 83.16
Round  49, Global train loss: 1.494, Global test loss: 1.229, Global test accuracy: 89.10
Round  50, Train loss: 1.448, Test loss: 1.204, Test accuracy: 79.28
Round  50, Global train loss: 1.448, Global test loss: 1.214, Global test accuracy: 85.82
Round  51, Train loss: 1.144, Test loss: 1.109, Test accuracy: 88.16
Round  51, Global train loss: 1.144, Global test loss: 1.032, Global test accuracy: 92.36
Round  52, Train loss: 1.292, Test loss: 1.113, Test accuracy: 87.48
Round  52, Global train loss: 1.292, Global test loss: 1.096, Global test accuracy: 90.46
Round  53, Train loss: 1.108, Test loss: 1.083, Test accuracy: 89.98
Round  53, Global train loss: 1.108, Global test loss: 1.000, Global test accuracy: 94.40
Round  54, Train loss: 1.112, Test loss: 1.069, Test accuracy: 90.40
Round  54, Global train loss: 1.112, Global test loss: 0.990, Global test accuracy: 95.10
Round  55, Train loss: 1.282, Test loss: 1.119, Test accuracy: 86.22
Round  55, Global train loss: 1.282, Global test loss: 1.079, Global test accuracy: 90.70
Round  56, Train loss: 1.276, Test loss: 1.143, Test accuracy: 84.36
Round  56, Global train loss: 1.276, Global test loss: 1.091, Global test accuracy: 90.78
Round  57, Train loss: 1.123, Test loss: 1.093, Test accuracy: 88.40
Round  57, Global train loss: 1.123, Global test loss: 1.022, Global test accuracy: 92.84
Round  58, Train loss: 1.271, Test loss: 1.142, Test accuracy: 83.60
Round  58, Global train loss: 1.271, Global test loss: 1.084, Global test accuracy: 91.84
Round  59, Train loss: 1.435, Test loss: 1.219, Test accuracy: 74.46
Round  59, Global train loss: 1.435, Global test loss: 1.260, Global test accuracy: 75.10
Round  60, Train loss: 1.126, Test loss: 1.102, Test accuracy: 86.22
Round  60, Global train loss: 1.126, Global test loss: 1.020, Global test accuracy: 93.04
Round  61, Train loss: 1.080, Test loss: 1.084, Test accuracy: 87.84
Round  61, Global train loss: 1.080, Global test loss: 1.013, Global test accuracy: 92.82
Round  62, Train loss: 0.938, Test loss: 1.048, Test accuracy: 90.96
Round  62, Global train loss: 0.938, Global test loss: 0.972, Global test accuracy: 94.54
Round  63, Train loss: 1.290, Test loss: 1.131, Test accuracy: 83.14
Round  63, Global train loss: 1.290, Global test loss: 1.127, Global test accuracy: 83.60
Round  64, Train loss: 1.108, Test loss: 1.114, Test accuracy: 85.54
Round  64, Global train loss: 1.108, Global test loss: 1.028, Global test accuracy: 92.44
Round  65, Train loss: 1.250, Test loss: 1.145, Test accuracy: 82.00
Round  65, Global train loss: 1.250, Global test loss: 1.118, Global test accuracy: 86.56
Round  66, Train loss: 1.223, Test loss: 1.157, Test accuracy: 80.34
Round  66, Global train loss: 1.223, Global test loss: 1.099, Global test accuracy: 87.64
Round  67, Train loss: 1.257, Test loss: 1.142, Test accuracy: 82.08
Round  67, Global train loss: 1.257, Global test loss: 1.089, Global test accuracy: 88.98
Round  68, Train loss: 1.226, Test loss: 1.167, Test accuracy: 79.30
Round  68, Global train loss: 1.226, Global test loss: 1.122, Global test accuracy: 85.44
Round  69, Train loss: 1.080, Test loss: 1.098, Test accuracy: 85.90
Round  69, Global train loss: 1.080, Global test loss: 1.020, Global test accuracy: 91.60
Round  70, Train loss: 1.405, Test loss: 1.220, Test accuracy: 73.46
Round  70, Global train loss: 1.405, Global test loss: 1.261, Global test accuracy: 73.08
Round  71, Train loss: 1.224, Test loss: 1.197, Test accuracy: 75.08
Round  71, Global train loss: 1.224, Global test loss: 1.163, Global test accuracy: 80.24
Round  72, Train loss: 1.214, Test loss: 1.175, Test accuracy: 77.30
Round  72, Global train loss: 1.214, Global test loss: 1.113, Global test accuracy: 86.00
Round  73, Train loss: 1.232, Test loss: 1.173, Test accuracy: 77.94
Round  73, Global train loss: 1.232, Global test loss: 1.139, Global test accuracy: 82.84
Round  74, Train loss: 1.085, Test loss: 1.104, Test accuracy: 85.12
Round  74, Global train loss: 1.085, Global test loss: 1.037, Global test accuracy: 90.28
Round  75, Train loss: 1.220, Test loss: 1.158, Test accuracy: 79.72
Round  75, Global train loss: 1.220, Global test loss: 1.133, Global test accuracy: 84.56
Round  76, Train loss: 1.192, Test loss: 1.199, Test accuracy: 75.48
Round  76, Global train loss: 1.192, Global test loss: 1.165, Global test accuracy: 79.16
Round  77, Train loss: 1.063, Test loss: 1.109, Test accuracy: 84.50
Round  77, Global train loss: 1.063, Global test loss: 1.037, Global test accuracy: 90.06
Round  78, Train loss: 1.194, Test loss: 1.151, Test accuracy: 79.92
Round  78, Global train loss: 1.194, Global test loss: 1.102, Global test accuracy: 86.24
Round  79, Train loss: 1.208, Test loss: 1.200, Test accuracy: 74.32
Round  79, Global train loss: 1.208, Global test loss: 1.158, Global test accuracy: 81.26
Round  80, Train loss: 1.191, Test loss: 1.213, Test accuracy: 72.86
Round  80, Global train loss: 1.191, Global test loss: 1.192, Global test accuracy: 74.70
Round  81, Train loss: 1.049, Test loss: 1.123, Test accuracy: 82.22
Round  81, Global train loss: 1.049, Global test loss: 1.061, Global test accuracy: 87.16
Round  82, Train loss: 1.273, Test loss: 1.315, Test accuracy: 60.52
Round  82, Global train loss: 1.273, Global test loss: 1.314, Global test accuracy: 63.38
Round  83, Train loss: 1.015, Test loss: 1.060, Test accuracy: 88.28
Round  83, Global train loss: 1.015, Global test loss: 0.993, Global test accuracy: 92.54
Round  84, Train loss: 1.067, Test loss: 1.107, Test accuracy: 83.58
Round  84, Global train loss: 1.067, Global test loss: 1.037, Global test accuracy: 89.60
Round  85, Train loss: 1.073, Test loss: 1.107, Test accuracy: 83.18
Round  85, Global train loss: 1.073, Global test loss: 1.040, Global test accuracy: 89.58
Round  86, Train loss: 1.053, Test loss: 1.101, Test accuracy: 83.74
Round  86, Global train loss: 1.053, Global test loss: 1.029, Global test accuracy: 90.42
Round  87, Train loss: 1.062, Test loss: 1.078, Test accuracy: 86.18
Round  87, Global train loss: 1.062, Global test loss: 1.012, Global test accuracy: 91.72
Round  88, Train loss: 1.172, Test loss: 1.170, Test accuracy: 77.10
Round  88, Global train loss: 1.172, Global test loss: 1.122, Global test accuracy: 83.40
Round  89, Train loss: 1.133, Test loss: 1.189, Test accuracy: 75.02
Round  89, Global train loss: 1.133, Global test loss: 1.132, Global test accuracy: 81.60
Round  90, Train loss: 1.254, Test loss: 1.331, Test accuracy: 58.60
Round  90, Global train loss: 1.254, Global test loss: 1.340, Global test accuracy: 60.20
Round  91, Train loss: 1.098, Test loss: 1.119, Test accuracy: 82.28
Round  91, Global train loss: 1.098, Global test loss: 1.073, Global test accuracy: 86.14/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.281, Test loss: 1.354, Test accuracy: 55.52
Round  92, Global train loss: 1.281, Global test loss: 1.366, Global test accuracy: 55.58
Round  93, Train loss: 1.235, Test loss: 1.340, Test accuracy: 57.52
Round  93, Global train loss: 1.235, Global test loss: 1.332, Global test accuracy: 60.36
Round  94, Train loss: 1.019, Test loss: 1.048, Test accuracy: 89.02
Round  94, Global train loss: 1.019, Global test loss: 1.000, Global test accuracy: 91.68
Round  95, Train loss: 1.167, Test loss: 1.203, Test accuracy: 73.30
Round  95, Global train loss: 1.167, Global test loss: 1.189, Global test accuracy: 74.94
Round  96, Train loss: 1.128, Test loss: 1.223, Test accuracy: 70.32
Round  96, Global train loss: 1.128, Global test loss: 1.202, Global test accuracy: 74.08
Round  97, Train loss: 1.157, Test loss: 1.181, Test accuracy: 75.68
Round  97, Global train loss: 1.157, Global test loss: 1.162, Global test accuracy: 77.84
Round  98, Train loss: 1.041, Test loss: 1.123, Test accuracy: 81.22
Round  98, Global train loss: 1.041, Global test loss: 1.076, Global test accuracy: 85.82
Round  99, Train loss: 1.129, Test loss: 1.175, Test accuracy: 75.90
Round  99, Global train loss: 1.129, Global test loss: 1.150, Global test accuracy: 79.16
Final Round, Train loss: 1.124, Test loss: 1.163, Test accuracy: 76.70
Final Round, Global train loss: 1.124, Global test loss: 1.150, Global test accuracy: 79.16
Average accuracy final 10 rounds: 71.936
579.3601040840149
[1.1668152809143066, 2.1441423892974854, 3.134284734725952, 4.112274408340454, 5.125266790390015, 6.1019580364227295, 7.129172086715698, 8.124321699142456, 9.149547576904297, 10.155054092407227, 11.128949403762817, 12.108932971954346, 13.058920621871948, 14.04541277885437, 15.015731573104858, 16.057523012161255, 17.12103247642517, 18.118542432785034, 19.15275287628174, 20.167449235916138, 21.178961515426636, 22.202179431915283, 23.240309715270996, 24.259798765182495, 25.28715991973877, 26.24362325668335, 27.289605140686035, 28.3229022026062, 29.323939085006714, 30.38320827484131, 31.37635612487793, 32.35094404220581, 33.32234573364258, 34.34104108810425, 35.32092070579529, 36.29075241088867, 37.26996827125549, 38.24789476394653, 39.233896017074585, 40.17876195907593, 41.13943958282471, 42.155163049697876, 43.11595940589905, 44.11268663406372, 45.158865213394165, 46.09421992301941, 47.08089089393616, 48.091548204422, 49.08487296104431, 50.07888102531433, 51.07801866531372, 52.08934020996094, 53.07175016403198, 54.058406591415405, 55.03304982185364, 56.05651783943176, 57.026527643203735, 57.98389911651611, 58.97217655181885, 59.973262786865234, 60.96023344993591, 61.96041941642761, 62.98557925224304, 64.00802063941956, 65.00495862960815, 65.99452066421509, 67.00456428527832, 68.00957250595093, 69.02343463897705, 70.02836799621582, 71.04074239730835, 72.04543471336365, 73.02208709716797, 74.05055499076843, 75.04806876182556, 76.01587271690369, 77.0292067527771, 78.04729461669922, 79.05170440673828, 80.03310441970825, 81.03976106643677, 82.05589842796326, 82.9872100353241, 83.97156047821045, 85.09595561027527, 86.14472365379333, 87.15311980247498, 88.16996574401855, 89.19859170913696, 90.23405241966248, 91.23236131668091, 92.2459774017334, 93.25207138061523, 94.2135283946991, 95.19614052772522, 96.21035957336426, 97.21644377708435, 98.19537329673767, 99.1981372833252, 100.18105149269104, 101.7605676651001]
[61.1, 89.66, 87.96, 85.5, 88.42, 92.36, 94.16, 94.52, 94.76, 94.8, 94.7, 95.0, 94.92, 94.84, 94.64, 94.88, 94.44, 94.46, 94.42, 94.6, 95.02, 94.58, 94.86, 94.76, 94.02, 94.44, 91.8, 94.24, 93.28, 94.78, 93.44, 93.52, 90.6, 92.88, 92.08, 92.66, 92.0, 92.96, 92.98, 92.72, 90.52, 91.08, 89.74, 89.1, 84.62, 81.54, 90.52, 88.0, 87.66, 83.16, 79.28, 88.16, 87.48, 89.98, 90.4, 86.22, 84.36, 88.4, 83.6, 74.46, 86.22, 87.84, 90.96, 83.14, 85.54, 82.0, 80.34, 82.08, 79.3, 85.9, 73.46, 75.08, 77.3, 77.94, 85.12, 79.72, 75.48, 84.5, 79.92, 74.32, 72.86, 82.22, 60.52, 88.28, 83.58, 83.18, 83.74, 86.18, 77.1, 75.02, 58.6, 82.28, 55.52, 57.52, 89.02, 73.3, 70.32, 75.68, 81.22, 75.9, 76.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 2, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.622, Test loss: 1.591, Test accuracy: 42.10
Round   0, Global train loss: 1.622, Global test loss: 1.591, Global test accuracy: 41.94
Round   1, Train loss: 1.586, Test loss: 1.547, Test accuracy: 64.22
Round   1, Global train loss: 1.586, Global test loss: 1.547, Global test accuracy: 64.42
Round   2, Train loss: 1.543, Test loss: 1.451, Test accuracy: 74.36
Round   2, Global train loss: 1.543, Global test loss: 1.450, Global test accuracy: 75.38
Round   3, Train loss: 1.476, Test loss: 1.338, Test accuracy: 77.06
Round   3, Global train loss: 1.476, Global test loss: 1.327, Global test accuracy: 77.68
Round   4, Train loss: 1.427, Test loss: 1.279, Test accuracy: 78.10
Round   4, Global train loss: 1.427, Global test loss: 1.253, Global test accuracy: 77.96
Round   5, Train loss: 1.404, Test loss: 1.254, Test accuracy: 80.04
Round   5, Global train loss: 1.404, Global test loss: 1.213, Global test accuracy: 81.74
Round   6, Train loss: 1.387, Test loss: 1.230, Test accuracy: 81.52
Round   6, Global train loss: 1.387, Global test loss: 1.181, Global test accuracy: 87.54
Round   7, Train loss: 1.374, Test loss: 1.210, Test accuracy: 82.48
Round   7, Global train loss: 1.374, Global test loss: 1.155, Global test accuracy: 90.44
Round   8, Train loss: 1.366, Test loss: 1.198, Test accuracy: 82.72
Round   8, Global train loss: 1.366, Global test loss: 1.136, Global test accuracy: 91.92
Round   9, Train loss: 1.361, Test loss: 1.189, Test accuracy: 83.08
Round   9, Global train loss: 1.361, Global test loss: 1.121, Global test accuracy: 92.96
Round  10, Train loss: 1.058, Test loss: 1.157, Test accuracy: 83.78
Round  10, Global train loss: 1.058, Global test loss: 1.075, Global test accuracy: 84.90
Round  11, Train loss: 1.264, Test loss: 1.152, Test accuracy: 82.32
Round  11, Global train loss: 1.264, Global test loss: 1.124, Global test accuracy: 90.00
Round  12, Train loss: 1.396, Test loss: 1.146, Test accuracy: 82.24
Round  12, Global train loss: 1.396, Global test loss: 1.183, Global test accuracy: 88.74
Round  13, Train loss: 1.280, Test loss: 1.183, Test accuracy: 79.36
Round  13, Global train loss: 1.280, Global test loss: 1.210, Global test accuracy: 77.70
Round  14, Train loss: 1.286, Test loss: 1.138, Test accuracy: 82.88
Round  14, Global train loss: 1.286, Global test loss: 1.058, Global test accuracy: 95.16
Round  15, Train loss: 1.238, Test loss: 1.143, Test accuracy: 83.28
Round  15, Global train loss: 1.238, Global test loss: 1.110, Global test accuracy: 89.46
Round  16, Train loss: 1.248, Test loss: 1.140, Test accuracy: 83.36
Round  16, Global train loss: 1.248, Global test loss: 1.088, Global test accuracy: 91.98
Round  17, Train loss: 1.255, Test loss: 1.115, Test accuracy: 84.38
Round  17, Global train loss: 1.255, Global test loss: 1.035, Global test accuracy: 94.70
Round  18, Train loss: 1.124, Test loss: 1.111, Test accuracy: 85.02
Round  18, Global train loss: 1.124, Global test loss: 0.995, Global test accuracy: 95.70
Round  19, Train loss: 1.240, Test loss: 1.110, Test accuracy: 84.44
Round  19, Global train loss: 1.240, Global test loss: 1.040, Global test accuracy: 93.34
Round  20, Train loss: 1.221, Test loss: 1.129, Test accuracy: 83.22
Round  20, Global train loss: 1.221, Global test loss: 1.107, Global test accuracy: 88.32
Round  21, Train loss: 1.216, Test loss: 1.126, Test accuracy: 84.06
Round  21, Global train loss: 1.216, Global test loss: 1.057, Global test accuracy: 93.58
Round  22, Train loss: 1.124, Test loss: 1.130, Test accuracy: 83.84
Round  22, Global train loss: 1.124, Global test loss: 1.020, Global test accuracy: 94.78
Round  23, Train loss: 1.124, Test loss: 1.111, Test accuracy: 84.66
Round  23, Global train loss: 1.124, Global test loss: 0.992, Global test accuracy: 95.76
Round  24, Train loss: 1.151, Test loss: 1.110, Test accuracy: 84.54
Round  24, Global train loss: 1.151, Global test loss: 1.022, Global test accuracy: 93.72
Round  25, Train loss: 1.223, Test loss: 1.130, Test accuracy: 82.88
Round  25, Global train loss: 1.223, Global test loss: 1.056, Global test accuracy: 93.92
Round  26, Train loss: 1.118, Test loss: 1.110, Test accuracy: 84.56
Round  26, Global train loss: 1.118, Global test loss: 0.993, Global test accuracy: 95.76
Round  27, Train loss: 1.234, Test loss: 1.131, Test accuracy: 83.36
Round  27, Global train loss: 1.234, Global test loss: 1.089, Global test accuracy: 91.44
Round  28, Train loss: 1.088, Test loss: 1.111, Test accuracy: 84.56
Round  28, Global train loss: 1.088, Global test loss: 0.980, Global test accuracy: 96.10
Round  29, Train loss: 1.200, Test loss: 1.118, Test accuracy: 83.76
Round  29, Global train loss: 1.200, Global test loss: 1.096, Global test accuracy: 88.24
Round  30, Train loss: 1.193, Test loss: 1.140, Test accuracy: 81.64
Round  30, Global train loss: 1.193, Global test loss: 1.119, Global test accuracy: 84.50
Round  31, Train loss: 1.318, Test loss: 1.146, Test accuracy: 81.32
Round  31, Global train loss: 1.318, Global test loss: 1.237, Global test accuracy: 72.10
Round  32, Train loss: 1.108, Test loss: 1.115, Test accuracy: 83.82
Round  32, Global train loss: 1.108, Global test loss: 1.007, Global test accuracy: 94.20
Round  33, Train loss: 1.078, Test loss: 1.126, Test accuracy: 83.48
Round  33, Global train loss: 1.078, Global test loss: 1.030, Global test accuracy: 93.44
Round  34, Train loss: 1.077, Test loss: 1.108, Test accuracy: 84.14
Round  34, Global train loss: 1.077, Global test loss: 0.995, Global test accuracy: 94.56
Round  35, Train loss: 1.280, Test loss: 1.144, Test accuracy: 80.52
Round  35, Global train loss: 1.280, Global test loss: 1.196, Global test accuracy: 74.32
Round  36, Train loss: 1.163, Test loss: 1.159, Test accuracy: 78.88
Round  36, Global train loss: 1.163, Global test loss: 1.131, Global test accuracy: 83.02
Round  37, Train loss: 1.072, Test loss: 1.150, Test accuracy: 80.28
Round  37, Global train loss: 1.072, Global test loss: 1.044, Global test accuracy: 92.24
Round  38, Train loss: 1.124, Test loss: 1.186, Test accuracy: 75.60
Round  38, Global train loss: 1.124, Global test loss: 1.290, Global test accuracy: 56.54
Round  39, Train loss: 1.213, Test loss: 1.213, Test accuracy: 72.58
Round  39, Global train loss: 1.213, Global test loss: 1.323, Global test accuracy: 55.32
Round  40, Train loss: 1.123, Test loss: 1.183, Test accuracy: 75.06
Round  40, Global train loss: 1.123, Global test loss: 1.110, Global test accuracy: 85.36
Round  41, Train loss: 1.167, Test loss: 1.194, Test accuracy: 73.72
Round  41, Global train loss: 1.167, Global test loss: 1.178, Global test accuracy: 75.94
Round  42, Train loss: 1.114, Test loss: 1.175, Test accuracy: 75.74
Round  42, Global train loss: 1.114, Global test loss: 1.094, Global test accuracy: 86.72
Round  43, Train loss: 1.154, Test loss: 1.135, Test accuracy: 80.16
Round  43, Global train loss: 1.154, Global test loss: 1.019, Global test accuracy: 93.26
Round  44, Train loss: 1.051, Test loss: 1.128, Test accuracy: 80.78
Round  44, Global train loss: 1.051, Global test loss: 0.984, Global test accuracy: 95.06
Round  45, Train loss: 1.146, Test loss: 1.112, Test accuracy: 82.56
Round  45, Global train loss: 1.146, Global test loss: 1.007, Global test accuracy: 93.52
Round  46, Train loss: 1.099, Test loss: 1.165, Test accuracy: 79.14
Round  46, Global train loss: 1.099, Global test loss: 1.291, Global test accuracy: 56.46
Round  47, Train loss: 1.200, Test loss: 1.194, Test accuracy: 75.06
Round  47, Global train loss: 1.200, Global test loss: 1.231, Global test accuracy: 69.60
Round  48, Train loss: 1.090, Test loss: 1.134, Test accuracy: 80.56
Round  48, Global train loss: 1.090, Global test loss: 1.016, Global test accuracy: 93.38
Round  49, Train loss: 1.073, Test loss: 1.111, Test accuracy: 82.52
Round  49, Global train loss: 1.073, Global test loss: 0.999, Global test accuracy: 94.40
Round  50, Train loss: 1.115, Test loss: 1.132, Test accuracy: 80.12
Round  50, Global train loss: 1.115, Global test loss: 1.022, Global test accuracy: 92.34
Round  51, Train loss: 1.201, Test loss: 1.218, Test accuracy: 72.96
Round  51, Global train loss: 1.201, Global test loss: 1.361, Global test accuracy: 51.90
Round  52, Train loss: 1.149, Test loss: 1.186, Test accuracy: 74.58
Round  52, Global train loss: 1.149, Global test loss: 1.093, Global test accuracy: 85.70
Round  53, Train loss: 1.114, Test loss: 1.187, Test accuracy: 74.94
Round  53, Global train loss: 1.114, Global test loss: 1.204, Global test accuracy: 71.56
Round  54, Train loss: 1.046, Test loss: 1.128, Test accuracy: 81.28
Round  54, Global train loss: 1.046, Global test loss: 1.055, Global test accuracy: 89.88
Round  55, Train loss: 1.130, Test loss: 1.156, Test accuracy: 77.74
Round  55, Global train loss: 1.130, Global test loss: 1.061, Global test accuracy: 89.10
Round  56, Train loss: 1.119, Test loss: 1.183, Test accuracy: 75.60
Round  56, Global train loss: 1.119, Global test loss: 1.195, Global test accuracy: 73.88
Round  57, Train loss: 1.103, Test loss: 1.211, Test accuracy: 73.34
Round  57, Global train loss: 1.103, Global test loss: 1.207, Global test accuracy: 72.88
Round  58, Train loss: 0.987, Test loss: 1.112, Test accuracy: 82.02
Round  58, Global train loss: 0.987, Global test loss: 1.018, Global test accuracy: 91.20
Round  59, Train loss: 1.122, Test loss: 1.141, Test accuracy: 78.52
Round  59, Global train loss: 1.122, Global test loss: 1.059, Global test accuracy: 88.84
Round  60, Train loss: 1.132, Test loss: 1.176, Test accuracy: 75.18
Round  60, Global train loss: 1.132, Global test loss: 1.091, Global test accuracy: 86.58
Round  61, Train loss: 1.088, Test loss: 1.208, Test accuracy: 72.00
Round  61, Global train loss: 1.088, Global test loss: 1.118, Global test accuracy: 82.16
Round  62, Train loss: 1.088, Test loss: 1.239, Test accuracy: 69.50
Round  62, Global train loss: 1.088, Global test loss: 1.229, Global test accuracy: 71.82
Round  63, Train loss: 1.121, Test loss: 1.201, Test accuracy: 73.48
Round  63, Global train loss: 1.121, Global test loss: 1.203, Global test accuracy: 72.80
Round  64, Train loss: 1.072, Test loss: 1.245, Test accuracy: 69.28
Round  64, Global train loss: 1.072, Global test loss: 1.240, Global test accuracy: 70.36
Round  65, Train loss: 1.074, Test loss: 1.208, Test accuracy: 72.54
Round  65, Global train loss: 1.074, Global test loss: 1.175, Global test accuracy: 76.48
Round  66, Train loss: 1.133, Test loss: 1.272, Test accuracy: 64.66
Round  66, Global train loss: 1.133, Global test loss: 1.236, Global test accuracy: 69.78
Round  67, Train loss: 1.057, Test loss: 1.128, Test accuracy: 81.12
Round  67, Global train loss: 1.057, Global test loss: 1.111, Global test accuracy: 81.96
Round  68, Train loss: 0.982, Test loss: 1.124, Test accuracy: 80.70
Round  68, Global train loss: 0.982, Global test loss: 1.018, Global test accuracy: 91.50
Round  69, Train loss: 1.008, Test loss: 1.115, Test accuracy: 81.78
Round  69, Global train loss: 1.008, Global test loss: 1.069, Global test accuracy: 87.34
Round  70, Train loss: 1.038, Test loss: 1.131, Test accuracy: 79.44
Round  70, Global train loss: 1.038, Global test loss: 1.027, Global test accuracy: 91.02
Round  71, Train loss: 1.079, Test loss: 1.196, Test accuracy: 73.78
Round  71, Global train loss: 1.079, Global test loss: 1.193, Global test accuracy: 73.30
Round  72, Train loss: 1.088, Test loss: 1.211, Test accuracy: 71.92
Round  72, Global train loss: 1.088, Global test loss: 1.250, Global test accuracy: 65.60
Round  73, Train loss: 1.083, Test loss: 1.234, Test accuracy: 68.86
Round  73, Global train loss: 1.083, Global test loss: 1.160, Global test accuracy: 78.48
Round  74, Train loss: 1.061, Test loss: 1.237, Test accuracy: 68.72
Round  74, Global train loss: 1.061, Global test loss: 1.194, Global test accuracy: 74.86
Round  75, Train loss: 1.006, Test loss: 1.152, Test accuracy: 77.34
Round  75, Global train loss: 1.006, Global test loss: 1.055, Global test accuracy: 87.70
Round  76, Train loss: 0.989, Test loss: 1.134, Test accuracy: 80.00
Round  76, Global train loss: 0.989, Global test loss: 1.061, Global test accuracy: 87.70
Round  77, Train loss: 1.036, Test loss: 1.188, Test accuracy: 74.18
Round  77, Global train loss: 1.036, Global test loss: 1.212, Global test accuracy: 70.78
Round  78, Train loss: 0.954, Test loss: 1.108, Test accuracy: 81.38
Round  78, Global train loss: 0.954, Global test loss: 1.020, Global test accuracy: 90.20
Round  79, Train loss: 1.060, Test loss: 1.206, Test accuracy: 70.80
Round  79, Global train loss: 1.060, Global test loss: 1.135, Global test accuracy: 80.88
Round  80, Train loss: 0.948, Test loss: 1.113, Test accuracy: 80.66
Round  80, Global train loss: 0.948, Global test loss: 1.005, Global test accuracy: 91.46
Round  81, Train loss: 0.924, Test loss: 1.096, Test accuracy: 82.26
Round  81, Global train loss: 0.924, Global test loss: 0.996, Global test accuracy: 92.18
Round  82, Train loss: 0.922, Test loss: 1.087, Test accuracy: 82.94
Round  82, Global train loss: 0.922, Global test loss: 0.987, Global test accuracy: 92.74
Round  83, Train loss: 0.921, Test loss: 1.085, Test accuracy: 83.14
Round  83, Global train loss: 0.921, Global test loss: 0.984, Global test accuracy: 92.94
Round  84, Train loss: 0.920, Test loss: 1.083, Test accuracy: 83.24
Round  84, Global train loss: 0.920, Global test loss: 0.981, Global test accuracy: 93.26
Round  85, Train loss: 0.919, Test loss: 1.083, Test accuracy: 83.28
Round  85, Global train loss: 0.919, Global test loss: 0.981, Global test accuracy: 93.20
Round  86, Train loss: 0.918, Test loss: 1.082, Test accuracy: 83.46
Round  86, Global train loss: 0.918, Global test loss: 0.981, Global test accuracy: 93.26
Round  87, Train loss: 0.917, Test loss: 1.082, Test accuracy: 83.54
Round  87, Global train loss: 0.917, Global test loss: 0.979, Global test accuracy: 93.36
Round  88, Train loss: 0.917, Test loss: 1.082, Test accuracy: 83.50
Round  88, Global train loss: 0.917, Global test loss: 0.979, Global test accuracy: 93.34
Round  89, Train loss: 0.916, Test loss: 1.081, Test accuracy: 83.70
Round  89, Global train loss: 0.916, Global test loss: 0.978, Global test accuracy: 93.36
Round  90, Train loss: 0.915, Test loss: 1.081, Test accuracy: 83.62
Round  90, Global train loss: 0.915, Global test loss: 0.978, Global test accuracy: 93.50/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 0.915, Test loss: 1.081, Test accuracy: 83.84
Round  91, Global train loss: 0.915, Global test loss: 0.979, Global test accuracy: 93.44
Round  92, Train loss: 0.915, Test loss: 1.080, Test accuracy: 84.08
Round  92, Global train loss: 0.915, Global test loss: 0.977, Global test accuracy: 93.50
Round  93, Train loss: 0.914, Test loss: 1.080, Test accuracy: 84.00
Round  93, Global train loss: 0.914, Global test loss: 0.977, Global test accuracy: 93.56
Round  94, Train loss: 0.914, Test loss: 1.080, Test accuracy: 83.96
Round  94, Global train loss: 0.914, Global test loss: 0.976, Global test accuracy: 93.62
Round  95, Train loss: 0.914, Test loss: 1.080, Test accuracy: 83.88
Round  95, Global train loss: 0.914, Global test loss: 0.976, Global test accuracy: 93.72
Round  96, Train loss: 0.913, Test loss: 1.079, Test accuracy: 83.94
Round  96, Global train loss: 0.913, Global test loss: 0.975, Global test accuracy: 93.76
Round  97, Train loss: 0.913, Test loss: 1.080, Test accuracy: 83.86
Round  97, Global train loss: 0.913, Global test loss: 0.975, Global test accuracy: 93.74
Round  98, Train loss: 0.913, Test loss: 1.080, Test accuracy: 83.88
Round  98, Global train loss: 0.913, Global test loss: 0.975, Global test accuracy: 93.80
Round  99, Train loss: 1.052, Test loss: 1.151, Test accuracy: 77.12
Round  99, Global train loss: 1.052, Global test loss: 1.052, Global test accuracy: 89.10
Final Round, Train loss: 1.132, Test loss: 1.136, Test accuracy: 78.48
Final Round, Global train loss: 1.132, Global test loss: 1.052, Global test accuracy: 89.10
Average accuracy final 10 rounds: 83.218
1492.195298910141
[1.3513062000274658, 2.490229606628418, 3.6703574657440186, 4.816659927368164, 5.985449552536011, 7.154325723648071, 8.33147120475769, 9.533836126327515, 10.818803548812866, 11.982106447219849, 13.124977111816406, 19.99993324279785, 26.963347673416138, 34.06940221786499, 41.11061716079712, 48.100250482559204, 55.02863168716431, 62.10916757583618, 69.09026646614075, 76.20895433425903, 83.24661326408386, 90.25579810142517, 97.04635739326477, 104.02160048484802, 110.7888536453247, 117.74420762062073, 124.66515851020813, 131.635107755661, 138.60479998588562, 145.53133606910706, 152.47611737251282, 159.4744746685028, 166.24546360969543, 173.0909345149994, 179.82363963127136, 186.91748881340027, 193.83178043365479, 200.56996369361877, 207.45890593528748, 214.5064001083374, 221.444917678833, 228.400310754776, 235.51634430885315, 242.46334266662598, 249.36577320098877, 256.2546739578247, 263.1277279853821, 270.1712455749512, 277.09616231918335, 283.86376905441284, 290.80184507369995, 297.7943911552429, 304.6361310482025, 311.76532912254333, 318.57858300209045, 325.43359208106995, 332.4781415462494, 339.5867991447449, 340.74391412734985, 347.6346628665924, 354.7065842151642, 361.8364543914795, 368.7409977912903, 375.85854482650757, 382.89918661117554, 389.9590241909027, 396.80393242836, 403.7533016204834, 410.43760204315186, 417.0485017299652, 424.0142903327942, 430.7498290538788, 437.40251660346985, 444.0836329460144, 450.69625329971313, 457.49407148361206, 464.29005098342896, 471.0280706882477, 472.12200140953064, 478.82013511657715, 480.0167021751404, 481.1324055194855, 482.28566241264343, 483.4727759361267, 484.63957357406616, 485.8342342376709, 487.0148959159851, 488.19476342201233, 489.38998913764954, 490.50665974617004, 491.6801245212555, 492.81489753723145, 493.96562480926514, 495.07761096954346, 496.2334291934967, 497.36165833473206, 498.50794315338135, 499.65167260169983, 500.8055114746094, 507.56276655197144, 514.2320239543915]
[42.1, 64.22, 74.36, 77.06, 78.1, 80.04, 81.52, 82.48, 82.72, 83.08, 83.78, 82.32, 82.24, 79.36, 82.88, 83.28, 83.36, 84.38, 85.02, 84.44, 83.22, 84.06, 83.84, 84.66, 84.54, 82.88, 84.56, 83.36, 84.56, 83.76, 81.64, 81.32, 83.82, 83.48, 84.14, 80.52, 78.88, 80.28, 75.6, 72.58, 75.06, 73.72, 75.74, 80.16, 80.78, 82.56, 79.14, 75.06, 80.56, 82.52, 80.12, 72.96, 74.58, 74.94, 81.28, 77.74, 75.6, 73.34, 82.02, 78.52, 75.18, 72.0, 69.5, 73.48, 69.28, 72.54, 64.66, 81.12, 80.7, 81.78, 79.44, 73.78, 71.92, 68.86, 68.72, 77.34, 80.0, 74.18, 81.38, 70.8, 80.66, 82.26, 82.94, 83.14, 83.24, 83.28, 83.46, 83.54, 83.5, 83.7, 83.62, 83.84, 84.08, 84.0, 83.96, 83.88, 83.94, 83.86, 83.88, 77.12, 78.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.593, Test loss: 1.567, Test accuracy: 38.64
Round   0, Global train loss: 1.593, Global test loss: 1.569, Global test accuracy: 38.02
Round   1, Train loss: 1.503, Test loss: 1.423, Test accuracy: 67.18
Round   1, Global train loss: 1.503, Global test loss: 1.414, Global test accuracy: 69.72
Round   2, Train loss: 1.376, Test loss: 1.238, Test accuracy: 77.80
Round   2, Global train loss: 1.376, Global test loss: 1.102, Global test accuracy: 89.32
Round   3, Train loss: 1.398, Test loss: 1.187, Test accuracy: 82.90
Round   3, Global train loss: 1.398, Global test loss: 1.131, Global test accuracy: 89.46
Round   4, Train loss: 1.220, Test loss: 1.152, Test accuracy: 82.34
Round   4, Global train loss: 1.220, Global test loss: 1.057, Global test accuracy: 86.56
Round   5, Train loss: 1.228, Test loss: 1.115, Test accuracy: 85.28
Round   5, Global train loss: 1.228, Global test loss: 1.008, Global test accuracy: 94.34
Round   6, Train loss: 1.230, Test loss: 1.105, Test accuracy: 84.82
Round   6, Global train loss: 1.230, Global test loss: 1.067, Global test accuracy: 88.30
Round   7, Train loss: 1.193, Test loss: 1.085, Test accuracy: 86.58
Round   7, Global train loss: 1.193, Global test loss: 1.005, Global test accuracy: 92.86
Round   8, Train loss: 1.339, Test loss: 1.079, Test accuracy: 87.46
Round   8, Global train loss: 1.339, Global test loss: 1.069, Global test accuracy: 93.08
Round   9, Train loss: 1.245, Test loss: 1.063, Test accuracy: 88.38
Round   9, Global train loss: 1.245, Global test loss: 1.000, Global test accuracy: 93.22
Round  10, Train loss: 1.185, Test loss: 1.057, Test accuracy: 88.80
Round  10, Global train loss: 1.185, Global test loss: 0.996, Global test accuracy: 93.30
Round  11, Train loss: 1.181, Test loss: 1.053, Test accuracy: 89.02
Round  11, Global train loss: 1.181, Global test loss: 0.980, Global test accuracy: 94.58
Round  12, Train loss: 1.154, Test loss: 1.051, Test accuracy: 88.92
Round  12, Global train loss: 1.154, Global test loss: 0.986, Global test accuracy: 93.36
Round  13, Train loss: 1.250, Test loss: 1.048, Test accuracy: 88.94
Round  13, Global train loss: 1.250, Global test loss: 0.988, Global test accuracy: 93.92
Round  14, Train loss: 1.141, Test loss: 1.049, Test accuracy: 88.64
Round  14, Global train loss: 1.141, Global test loss: 0.969, Global test accuracy: 94.78
Round  15, Train loss: 1.219, Test loss: 1.050, Test accuracy: 88.44
Round  15, Global train loss: 1.219, Global test loss: 0.988, Global test accuracy: 93.72
Round  16, Train loss: 1.159, Test loss: 1.049, Test accuracy: 88.62
Round  16, Global train loss: 1.159, Global test loss: 0.969, Global test accuracy: 94.58
Round  17, Train loss: 1.151, Test loss: 1.050, Test accuracy: 88.38
Round  17, Global train loss: 1.151, Global test loss: 0.971, Global test accuracy: 94.50
Round  18, Train loss: 1.208, Test loss: 1.050, Test accuracy: 88.24
Round  18, Global train loss: 1.208, Global test loss: 0.976, Global test accuracy: 94.18
Round  19, Train loss: 1.145, Test loss: 1.049, Test accuracy: 88.38
Round  19, Global train loss: 1.145, Global test loss: 0.984, Global test accuracy: 93.64
Round  20, Train loss: 1.154, Test loss: 1.049, Test accuracy: 88.34
Round  20, Global train loss: 1.154, Global test loss: 0.967, Global test accuracy: 94.92
Round  21, Train loss: 1.208, Test loss: 1.018, Test accuracy: 91.02
Round  21, Global train loss: 1.208, Global test loss: 1.008, Global test accuracy: 93.00
Round  22, Train loss: 1.205, Test loss: 1.018, Test accuracy: 90.84
Round  22, Global train loss: 1.205, Global test loss: 0.984, Global test accuracy: 92.88
Round  23, Train loss: 1.110, Test loss: 1.018, Test accuracy: 90.84
Round  23, Global train loss: 1.110, Global test loss: 0.969, Global test accuracy: 94.36
Round  24, Train loss: 1.179, Test loss: 1.004, Test accuracy: 91.60
Round  24, Global train loss: 1.179, Global test loss: 0.985, Global test accuracy: 93.96
Round  25, Train loss: 1.164, Test loss: 0.999, Test accuracy: 91.76
Round  25, Global train loss: 1.164, Global test loss: 0.973, Global test accuracy: 94.70
Round  26, Train loss: 1.108, Test loss: 0.999, Test accuracy: 91.86
Round  26, Global train loss: 1.108, Global test loss: 0.969, Global test accuracy: 94.10
Round  27, Train loss: 1.208, Test loss: 1.003, Test accuracy: 91.22
Round  27, Global train loss: 1.208, Global test loss: 0.985, Global test accuracy: 92.82
Round  28, Train loss: 1.120, Test loss: 1.003, Test accuracy: 91.10
Round  28, Global train loss: 1.120, Global test loss: 0.972, Global test accuracy: 94.04
Round  29, Train loss: 1.202, Test loss: 1.003, Test accuracy: 90.98
Round  29, Global train loss: 1.202, Global test loss: 0.978, Global test accuracy: 93.62
Round  30, Train loss: 1.176, Test loss: 1.004, Test accuracy: 90.90
Round  30, Global train loss: 1.176, Global test loss: 0.973, Global test accuracy: 94.10
Round  31, Train loss: 1.188, Test loss: 1.005, Test accuracy: 90.80
Round  31, Global train loss: 1.188, Global test loss: 0.970, Global test accuracy: 94.32
Round  32, Train loss: 1.142, Test loss: 1.005, Test accuracy: 90.74
Round  32, Global train loss: 1.142, Global test loss: 0.963, Global test accuracy: 94.62
Round  33, Train loss: 1.133, Test loss: 1.004, Test accuracy: 90.78
Round  33, Global train loss: 1.133, Global test loss: 0.964, Global test accuracy: 94.82
Round  34, Train loss: 1.195, Test loss: 1.006, Test accuracy: 90.64
Round  34, Global train loss: 1.195, Global test loss: 0.980, Global test accuracy: 93.60
Round  35, Train loss: 1.182, Test loss: 1.006, Test accuracy: 90.54
Round  35, Global train loss: 1.182, Global test loss: 0.972, Global test accuracy: 94.36
Round  36, Train loss: 1.190, Test loss: 1.006, Test accuracy: 90.48
Round  36, Global train loss: 1.190, Global test loss: 0.970, Global test accuracy: 94.62
Round  37, Train loss: 1.135, Test loss: 1.006, Test accuracy: 90.40
Round  37, Global train loss: 1.135, Global test loss: 0.963, Global test accuracy: 94.50
Round  38, Train loss: 1.184, Test loss: 1.007, Test accuracy: 90.40
Round  38, Global train loss: 1.184, Global test loss: 0.974, Global test accuracy: 94.24
Round  39, Train loss: 1.101, Test loss: 1.007, Test accuracy: 90.32
Round  39, Global train loss: 1.101, Global test loss: 0.969, Global test accuracy: 94.30
Round  40, Train loss: 1.178, Test loss: 1.007, Test accuracy: 90.36
Round  40, Global train loss: 1.178, Global test loss: 0.980, Global test accuracy: 92.92
Round  41, Train loss: 1.141, Test loss: 1.006, Test accuracy: 90.40
Round  41, Global train loss: 1.141, Global test loss: 0.967, Global test accuracy: 94.64
Round  42, Train loss: 1.173, Test loss: 1.007, Test accuracy: 90.20
Round  42, Global train loss: 1.173, Global test loss: 0.975, Global test accuracy: 93.80
Round  43, Train loss: 1.118, Test loss: 1.009, Test accuracy: 89.92
Round  43, Global train loss: 1.118, Global test loss: 0.970, Global test accuracy: 94.24
Round  44, Train loss: 1.044, Test loss: 1.009, Test accuracy: 89.96
Round  44, Global train loss: 1.044, Global test loss: 0.961, Global test accuracy: 94.92
Round  45, Train loss: 1.176, Test loss: 1.010, Test accuracy: 89.90
Round  45, Global train loss: 1.176, Global test loss: 0.964, Global test accuracy: 94.48
Round  46, Train loss: 1.175, Test loss: 1.009, Test accuracy: 90.04
Round  46, Global train loss: 1.175, Global test loss: 0.980, Global test accuracy: 92.98
Round  47, Train loss: 1.125, Test loss: 1.009, Test accuracy: 89.90
Round  47, Global train loss: 1.125, Global test loss: 0.967, Global test accuracy: 94.36
Round  48, Train loss: 1.175, Test loss: 1.009, Test accuracy: 89.88
Round  48, Global train loss: 1.175, Global test loss: 0.974, Global test accuracy: 93.60
Round  49, Train loss: 1.175, Test loss: 1.009, Test accuracy: 89.96
Round  49, Global train loss: 1.175, Global test loss: 0.987, Global test accuracy: 92.46
Round  50, Train loss: 1.123, Test loss: 1.009, Test accuracy: 90.02
Round  50, Global train loss: 1.123, Global test loss: 0.963, Global test accuracy: 94.56
Round  51, Train loss: 1.089, Test loss: 1.008, Test accuracy: 89.98
Round  51, Global train loss: 1.089, Global test loss: 0.971, Global test accuracy: 94.30
Round  52, Train loss: 1.095, Test loss: 1.009, Test accuracy: 89.96
Round  52, Global train loss: 1.095, Global test loss: 0.968, Global test accuracy: 93.82
Round  53, Train loss: 1.050, Test loss: 1.009, Test accuracy: 89.98
Round  53, Global train loss: 1.050, Global test loss: 0.960, Global test accuracy: 94.88
Round  54, Train loss: 1.121, Test loss: 1.008, Test accuracy: 89.92
Round  54, Global train loss: 1.121, Global test loss: 0.961, Global test accuracy: 94.94
Round  55, Train loss: 1.082, Test loss: 1.010, Test accuracy: 89.76
Round  55, Global train loss: 1.082, Global test loss: 0.963, Global test accuracy: 94.76
Round  56, Train loss: 1.175, Test loss: 1.010, Test accuracy: 89.90
Round  56, Global train loss: 1.175, Global test loss: 0.968, Global test accuracy: 93.94
Round  57, Train loss: 1.057, Test loss: 1.010, Test accuracy: 89.84
Round  57, Global train loss: 1.057, Global test loss: 0.960, Global test accuracy: 94.58
Round  58, Train loss: 1.163, Test loss: 1.010, Test accuracy: 89.84
Round  58, Global train loss: 1.163, Global test loss: 0.984, Global test accuracy: 92.74
Round  59, Train loss: 1.167, Test loss: 1.010, Test accuracy: 89.86
Round  59, Global train loss: 1.167, Global test loss: 0.967, Global test accuracy: 94.28
Round  60, Train loss: 1.050, Test loss: 1.010, Test accuracy: 89.88
Round  60, Global train loss: 1.050, Global test loss: 0.962, Global test accuracy: 94.80
Round  61, Train loss: 1.154, Test loss: 1.009, Test accuracy: 90.02
Round  61, Global train loss: 1.154, Global test loss: 0.978, Global test accuracy: 93.22
Round  62, Train loss: 1.133, Test loss: 1.009, Test accuracy: 90.02
Round  62, Global train loss: 1.133, Global test loss: 0.966, Global test accuracy: 94.28
Round  63, Train loss: 1.173, Test loss: 1.009, Test accuracy: 90.08
Round  63, Global train loss: 1.173, Global test loss: 0.976, Global test accuracy: 93.36
Round  64, Train loss: 1.042, Test loss: 1.008, Test accuracy: 90.00
Round  64, Global train loss: 1.042, Global test loss: 0.957, Global test accuracy: 95.10
Round  65, Train loss: 1.179, Test loss: 1.008, Test accuracy: 89.96
Round  65, Global train loss: 1.179, Global test loss: 0.973, Global test accuracy: 93.60
Round  66, Train loss: 1.099, Test loss: 1.009, Test accuracy: 89.94
Round  66, Global train loss: 1.099, Global test loss: 0.962, Global test accuracy: 94.76
Round  67, Train loss: 1.166, Test loss: 1.010, Test accuracy: 89.74
Round  67, Global train loss: 1.166, Global test loss: 0.968, Global test accuracy: 94.14
Round  68, Train loss: 1.165, Test loss: 1.011, Test accuracy: 89.70
Round  68, Global train loss: 1.165, Global test loss: 0.976, Global test accuracy: 93.38
Round  69, Train loss: 1.093, Test loss: 1.011, Test accuracy: 89.72
Round  69, Global train loss: 1.093, Global test loss: 0.976, Global test accuracy: 93.06
Round  70, Train loss: 1.161, Test loss: 1.011, Test accuracy: 89.74
Round  70, Global train loss: 1.161, Global test loss: 0.967, Global test accuracy: 93.92
Round  71, Train loss: 1.130, Test loss: 1.011, Test accuracy: 89.76
Round  71, Global train loss: 1.130, Global test loss: 0.961, Global test accuracy: 94.56
Round  72, Train loss: 1.103, Test loss: 1.011, Test accuracy: 89.66
Round  72, Global train loss: 1.103, Global test loss: 0.976, Global test accuracy: 93.38
Round  73, Train loss: 1.176, Test loss: 1.011, Test accuracy: 89.66
Round  73, Global train loss: 1.176, Global test loss: 0.968, Global test accuracy: 94.06
Round  74, Train loss: 1.048, Test loss: 1.011, Test accuracy: 89.64
Round  74, Global train loss: 1.048, Global test loss: 0.964, Global test accuracy: 93.98
Round  75, Train loss: 1.163, Test loss: 1.011, Test accuracy: 89.76
Round  75, Global train loss: 1.163, Global test loss: 0.975, Global test accuracy: 93.34
Round  76, Train loss: 1.100, Test loss: 1.011, Test accuracy: 89.78
Round  76, Global train loss: 1.100, Global test loss: 0.974, Global test accuracy: 93.22
Round  77, Train loss: 1.054, Test loss: 1.011, Test accuracy: 89.76
Round  77, Global train loss: 1.054, Global test loss: 0.959, Global test accuracy: 94.42
Round  78, Train loss: 1.040, Test loss: 1.011, Test accuracy: 89.68
Round  78, Global train loss: 1.040, Global test loss: 0.957, Global test accuracy: 95.00
Round  79, Train loss: 1.100, Test loss: 1.011, Test accuracy: 89.68
Round  79, Global train loss: 1.100, Global test loss: 0.968, Global test accuracy: 93.70
Round  80, Train loss: 1.160, Test loss: 1.011, Test accuracy: 89.62
Round  80, Global train loss: 1.160, Global test loss: 0.985, Global test accuracy: 92.30
Round  81, Train loss: 1.148, Test loss: 1.011, Test accuracy: 89.62
Round  81, Global train loss: 1.148, Global test loss: 0.978, Global test accuracy: 93.04
Round  82, Train loss: 1.128, Test loss: 1.012, Test accuracy: 89.54
Round  82, Global train loss: 1.128, Global test loss: 0.961, Global test accuracy: 94.60
Round  83, Train loss: 1.161, Test loss: 1.012, Test accuracy: 89.54
Round  83, Global train loss: 1.161, Global test loss: 0.976, Global test accuracy: 93.04
Round  84, Train loss: 1.160, Test loss: 1.012, Test accuracy: 89.54
Round  84, Global train loss: 1.160, Global test loss: 0.977, Global test accuracy: 93.26
Round  85, Train loss: 1.104, Test loss: 1.012, Test accuracy: 89.58
Round  85, Global train loss: 1.104, Global test loss: 0.965, Global test accuracy: 94.26
Round  86, Train loss: 1.150, Test loss: 1.013, Test accuracy: 89.44
Round  86, Global train loss: 1.150, Global test loss: 0.971, Global test accuracy: 93.64
Round  87, Train loss: 1.164, Test loss: 1.012, Test accuracy: 89.50
Round  87, Global train loss: 1.164, Global test loss: 0.971, Global test accuracy: 93.82
Round  88, Train loss: 1.162, Test loss: 1.013, Test accuracy: 89.50
Round  88, Global train loss: 1.162, Global test loss: 0.968, Global test accuracy: 94.28
Round  89, Train loss: 1.126, Test loss: 1.013, Test accuracy: 89.48
Round  89, Global train loss: 1.126, Global test loss: 0.961, Global test accuracy: 94.58
Round  90, Train loss: 1.168, Test loss: 1.013, Test accuracy: 89.50
Round  90, Global train loss: 1.168, Global test loss: 0.970, Global test accuracy: 93.96
Round  91, Train loss: 1.094, Test loss: 1.013, Test accuracy: 89.44
Round  91, Global train loss: 1.094, Global test loss: 0.974, Global test accuracy: 93.50
Round  92, Train loss: 1.090, Test loss: 1.013, Test accuracy: 89.42
Round  92, Global train loss: 1.090, Global test loss: 0.976, Global test accuracy: 93.06
Round  93, Train loss: 1.119, Test loss: 1.013, Test accuracy: 89.42
Round  93, Global train loss: 1.119, Global test loss: 0.964, Global test accuracy: 94.36/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.093, Test loss: 1.013, Test accuracy: 89.48
Round  94, Global train loss: 1.093, Global test loss: 0.976, Global test accuracy: 93.04
Round  95, Train loss: 1.119, Test loss: 1.013, Test accuracy: 89.46
Round  95, Global train loss: 1.119, Global test loss: 0.960, Global test accuracy: 94.60
Round  96, Train loss: 1.122, Test loss: 1.013, Test accuracy: 89.44
Round  96, Global train loss: 1.122, Global test loss: 0.963, Global test accuracy: 94.46
Round  97, Train loss: 1.093, Test loss: 1.013, Test accuracy: 89.44
Round  97, Global train loss: 1.093, Global test loss: 0.977, Global test accuracy: 93.06
Round  98, Train loss: 1.118, Test loss: 1.013, Test accuracy: 89.42
Round  98, Global train loss: 1.118, Global test loss: 0.960, Global test accuracy: 94.64
Round  99, Train loss: 1.156, Test loss: 1.013, Test accuracy: 89.44
Round  99, Global train loss: 1.156, Global test loss: 0.971, Global test accuracy: 93.78
Final Round, Train loss: 1.124, Test loss: 1.014, Test accuracy: 89.24
Final Round, Global train loss: 1.124, Global test loss: 0.971, Global test accuracy: 93.78
Average accuracy final 10 rounds: 89.44600000000001 

Average global accuracy final 10 rounds: 93.846 

660.0181722640991
[0.9028768539428711, 1.8057537078857422, 2.6181838512420654, 3.4306139945983887, 4.21550178527832, 5.000389575958252, 5.784307241439819, 6.568224906921387, 7.355671167373657, 8.143117427825928, 8.956210613250732, 9.769303798675537, 10.492552280426025, 11.215800762176514, 11.973720788955688, 12.731640815734863, 13.516412019729614, 14.301183223724365, 15.12476634979248, 15.948349475860596, 16.723052740097046, 17.497756004333496, 18.30527377128601, 19.112791538238525, 19.94692039489746, 20.781049251556396, 21.578912496566772, 22.37677574157715, 23.207335710525513, 24.037895679473877, 24.83143162727356, 25.624967575073242, 26.51244616508484, 27.399924755096436, 28.28664755821228, 29.173370361328125, 30.00952982902527, 30.845689296722412, 31.717117309570312, 32.58854532241821, 33.381962299346924, 34.175379276275635, 34.95798063278198, 35.74058198928833, 36.49123549461365, 37.241888999938965, 38.06704378128052, 38.89219856262207, 39.66453194618225, 40.43686532974243, 41.26165747642517, 42.08644962310791, 42.91199207305908, 43.737534523010254, 44.5659236907959, 45.39431285858154, 46.25425696372986, 47.114201068878174, 47.98813080787659, 48.862060546875, 49.6413254737854, 50.4205904006958, 51.23027849197388, 52.03996658325195, 52.86088800430298, 53.681809425354004, 54.50598430633545, 55.330159187316895, 56.16824698448181, 57.00633478164673, 57.8261284828186, 58.64592218399048, 59.468751668930054, 60.29158115386963, 61.10854625701904, 61.92551136016846, 62.76376485824585, 63.60201835632324, 64.44233083724976, 65.28264331817627, 66.06448793411255, 66.84633255004883, 67.62360763549805, 68.40088272094727, 69.14508295059204, 69.88928318023682, 70.651700258255, 71.4141173362732, 72.20601058006287, 72.99790382385254, 73.80596375465393, 74.61402368545532, 75.38827919960022, 76.16253471374512, 76.96259784698486, 77.76266098022461, 78.55334520339966, 79.3440294265747, 80.1119077205658, 80.87978601455688, 81.72295832633972, 82.56613063812256, 83.31553673744202, 84.06494283676147, 84.82150983810425, 85.57807683944702, 86.41873550415039, 87.25939416885376, 88.08426070213318, 88.9091272354126, 89.66026067733765, 90.4113941192627, 91.161945104599, 91.9124960899353, 92.64953756332397, 93.38657903671265, 94.16108179092407, 94.9355845451355, 95.74321794509888, 96.55085134506226, 97.34426856040955, 98.13768577575684, 98.89979958534241, 99.66191339492798, 100.44103980064392, 101.22016620635986, 101.99951457977295, 102.77886295318604, 103.55461692810059, 104.33037090301514, 105.10671496391296, 105.88305902481079, 106.64364290237427, 107.40422677993774, 108.21521592140198, 109.02620506286621, 109.84195065498352, 110.65769624710083, 111.41363549232483, 112.16957473754883, 112.92531085014343, 113.68104696273804, 114.45566892623901, 115.23029088973999, 116.0057327747345, 116.781174659729, 117.57016372680664, 118.35915279388428, 119.13840460777283, 119.91765642166138, 120.7060751914978, 121.49449396133423, 122.32045102119446, 123.14640808105469, 123.93343925476074, 124.7204704284668, 125.57614231109619, 126.43181419372559, 127.2667875289917, 128.1017608642578, 128.93990230560303, 129.77804374694824, 130.59906435012817, 131.4200849533081, 132.20272970199585, 132.9853744506836, 133.8068037033081, 134.62823295593262, 135.40195488929749, 136.17567682266235, 136.9400656223297, 137.70445442199707, 138.50561690330505, 139.30677938461304, 140.11112427711487, 140.9154691696167, 141.69915437698364, 142.4828395843506, 143.25356435775757, 144.02428913116455, 144.79210305213928, 145.559916973114, 146.36567902565002, 147.17144107818604, 147.96921682357788, 148.76699256896973, 149.53364825248718, 150.30030393600464, 151.06465935707092, 151.8290147781372, 152.66046595573425, 153.4919171333313, 154.2849817276001, 155.0780463218689, 155.9144525527954, 156.75085878372192, 157.59173607826233, 158.43261337280273, 159.1869444847107, 159.94127559661865, 161.52668356895447, 163.11209154129028]
[38.64, 38.64, 67.18, 67.18, 77.8, 77.8, 82.9, 82.9, 82.34, 82.34, 85.28, 85.28, 84.82, 84.82, 86.58, 86.58, 87.46, 87.46, 88.38, 88.38, 88.8, 88.8, 89.02, 89.02, 88.92, 88.92, 88.94, 88.94, 88.64, 88.64, 88.44, 88.44, 88.62, 88.62, 88.38, 88.38, 88.24, 88.24, 88.38, 88.38, 88.34, 88.34, 91.02, 91.02, 90.84, 90.84, 90.84, 90.84, 91.6, 91.6, 91.76, 91.76, 91.86, 91.86, 91.22, 91.22, 91.1, 91.1, 90.98, 90.98, 90.9, 90.9, 90.8, 90.8, 90.74, 90.74, 90.78, 90.78, 90.64, 90.64, 90.54, 90.54, 90.48, 90.48, 90.4, 90.4, 90.4, 90.4, 90.32, 90.32, 90.36, 90.36, 90.4, 90.4, 90.2, 90.2, 89.92, 89.92, 89.96, 89.96, 89.9, 89.9, 90.04, 90.04, 89.9, 89.9, 89.88, 89.88, 89.96, 89.96, 90.02, 90.02, 89.98, 89.98, 89.96, 89.96, 89.98, 89.98, 89.92, 89.92, 89.76, 89.76, 89.9, 89.9, 89.84, 89.84, 89.84, 89.84, 89.86, 89.86, 89.88, 89.88, 90.02, 90.02, 90.02, 90.02, 90.08, 90.08, 90.0, 90.0, 89.96, 89.96, 89.94, 89.94, 89.74, 89.74, 89.7, 89.7, 89.72, 89.72, 89.74, 89.74, 89.76, 89.76, 89.66, 89.66, 89.66, 89.66, 89.64, 89.64, 89.76, 89.76, 89.78, 89.78, 89.76, 89.76, 89.68, 89.68, 89.68, 89.68, 89.62, 89.62, 89.62, 89.62, 89.54, 89.54, 89.54, 89.54, 89.54, 89.54, 89.58, 89.58, 89.44, 89.44, 89.5, 89.5, 89.5, 89.5, 89.48, 89.48, 89.5, 89.5, 89.44, 89.44, 89.42, 89.42, 89.42, 89.42, 89.48, 89.48, 89.46, 89.46, 89.44, 89.44, 89.44, 89.44, 89.42, 89.42, 89.44, 89.44, 89.24, 89.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.594, Test loss: 1.562, Test accuracy: 43.88
Round   0, Global train loss: 1.594, Global test loss: 1.564, Global test accuracy: 41.90
Round   1, Train loss: 1.534, Test loss: 1.413, Test accuracy: 67.86
Round   1, Global train loss: 1.534, Global test loss: 1.403, Global test accuracy: 69.34
Round   2, Train loss: 1.378, Test loss: 1.247, Test accuracy: 77.60
Round   2, Global train loss: 1.378, Global test loss: 1.125, Global test accuracy: 86.80
Round   3, Train loss: 1.300, Test loss: 1.143, Test accuracy: 84.52
Round   3, Global train loss: 1.300, Global test loss: 1.020, Global test accuracy: 92.42
Round   4, Train loss: 1.290, Test loss: 1.074, Test accuracy: 89.00
Round   4, Global train loss: 1.290, Global test loss: 0.987, Global test accuracy: 94.66
Round   5, Train loss: 1.196, Test loss: 1.041, Test accuracy: 90.18
Round   5, Global train loss: 1.196, Global test loss: 0.970, Global test accuracy: 95.52
Round   6, Train loss: 1.276, Test loss: 1.031, Test accuracy: 90.44
Round   6, Global train loss: 1.276, Global test loss: 0.969, Global test accuracy: 94.76
Round   7, Train loss: 1.276, Test loss: 1.030, Test accuracy: 90.38
Round   7, Global train loss: 1.276, Global test loss: 0.967, Global test accuracy: 94.98
Round   8, Train loss: 1.139, Test loss: 0.970, Test accuracy: 94.86
Round   8, Global train loss: 1.139, Global test loss: 0.958, Global test accuracy: 95.86
Round   9, Train loss: 1.249, Test loss: 0.967, Test accuracy: 94.84
Round   9, Global train loss: 1.249, Global test loss: 0.958, Global test accuracy: 95.54
Round  10, Train loss: 1.266, Test loss: 0.967, Test accuracy: 94.88
Round  10, Global train loss: 1.266, Global test loss: 0.958, Global test accuracy: 95.44
Round  11, Train loss: 1.188, Test loss: 0.963, Test accuracy: 95.02
Round  11, Global train loss: 1.188, Global test loss: 0.957, Global test accuracy: 95.40
Round  12, Train loss: 1.261, Test loss: 0.961, Test accuracy: 95.22
Round  12, Global train loss: 1.261, Global test loss: 0.958, Global test accuracy: 95.14
Round  13, Train loss: 1.253, Test loss: 0.959, Test accuracy: 95.16
Round  13, Global train loss: 1.253, Global test loss: 0.958, Global test accuracy: 95.32
Round  14, Train loss: 1.245, Test loss: 0.958, Test accuracy: 95.24
Round  14, Global train loss: 1.245, Global test loss: 0.954, Global test accuracy: 95.82
Round  15, Train loss: 1.252, Test loss: 0.957, Test accuracy: 95.30
Round  15, Global train loss: 1.252, Global test loss: 0.956, Global test accuracy: 95.28
Round  16, Train loss: 1.168, Test loss: 0.956, Test accuracy: 95.34
Round  16, Global train loss: 1.168, Global test loss: 0.953, Global test accuracy: 95.70
Round  17, Train loss: 1.178, Test loss: 0.958, Test accuracy: 95.18
Round  17, Global train loss: 1.178, Global test loss: 0.954, Global test accuracy: 95.56
Round  18, Train loss: 1.240, Test loss: 0.958, Test accuracy: 95.10
Round  18, Global train loss: 1.240, Global test loss: 0.952, Global test accuracy: 95.80
Round  19, Train loss: 1.266, Test loss: 0.958, Test accuracy: 95.12
Round  19, Global train loss: 1.266, Global test loss: 0.959, Global test accuracy: 94.92
Round  20, Train loss: 1.176, Test loss: 0.957, Test accuracy: 95.20
Round  20, Global train loss: 1.176, Global test loss: 0.951, Global test accuracy: 95.78
Round  21, Train loss: 1.149, Test loss: 0.957, Test accuracy: 95.20
Round  21, Global train loss: 1.149, Global test loss: 0.953, Global test accuracy: 95.66
Round  22, Train loss: 1.230, Test loss: 0.956, Test accuracy: 95.24
Round  22, Global train loss: 1.230, Global test loss: 0.951, Global test accuracy: 95.90
Round  23, Train loss: 1.232, Test loss: 0.956, Test accuracy: 95.22
Round  23, Global train loss: 1.232, Global test loss: 0.956, Global test accuracy: 95.10
Round  24, Train loss: 1.074, Test loss: 0.957, Test accuracy: 95.06
Round  24, Global train loss: 1.074, Global test loss: 0.950, Global test accuracy: 95.70
Round  25, Train loss: 1.072, Test loss: 0.956, Test accuracy: 95.16
Round  25, Global train loss: 1.072, Global test loss: 0.951, Global test accuracy: 95.68
Round  26, Train loss: 1.234, Test loss: 0.956, Test accuracy: 95.06
Round  26, Global train loss: 1.234, Global test loss: 0.950, Global test accuracy: 95.78
Round  27, Train loss: 1.243, Test loss: 0.956, Test accuracy: 95.08
Round  27, Global train loss: 1.243, Global test loss: 0.955, Global test accuracy: 95.26
Round  28, Train loss: 1.242, Test loss: 0.956, Test accuracy: 94.94
Round  28, Global train loss: 1.242, Global test loss: 0.957, Global test accuracy: 95.22
Round  29, Train loss: 1.112, Test loss: 0.956, Test accuracy: 94.92
Round  29, Global train loss: 1.112, Global test loss: 0.951, Global test accuracy: 95.64
Round  30, Train loss: 1.231, Test loss: 0.956, Test accuracy: 94.94
Round  30, Global train loss: 1.231, Global test loss: 0.953, Global test accuracy: 95.38
Round  31, Train loss: 1.225, Test loss: 0.956, Test accuracy: 94.84
Round  31, Global train loss: 1.225, Global test loss: 0.953, Global test accuracy: 95.34
Round  32, Train loss: 1.158, Test loss: 0.957, Test accuracy: 94.80
Round  32, Global train loss: 1.158, Global test loss: 0.953, Global test accuracy: 95.36
Round  33, Train loss: 1.169, Test loss: 0.957, Test accuracy: 94.84
Round  33, Global train loss: 1.169, Global test loss: 0.951, Global test accuracy: 95.58
Round  34, Train loss: 1.126, Test loss: 0.956, Test accuracy: 94.86
Round  34, Global train loss: 1.126, Global test loss: 0.952, Global test accuracy: 95.50
Round  35, Train loss: 1.241, Test loss: 0.956, Test accuracy: 95.02
Round  35, Global train loss: 1.241, Global test loss: 0.953, Global test accuracy: 95.58
Round  36, Train loss: 1.112, Test loss: 0.956, Test accuracy: 94.90
Round  36, Global train loss: 1.112, Global test loss: 0.950, Global test accuracy: 95.80
Round  37, Train loss: 1.155, Test loss: 0.956, Test accuracy: 95.00
Round  37, Global train loss: 1.155, Global test loss: 0.951, Global test accuracy: 95.60
Round  38, Train loss: 1.126, Test loss: 0.957, Test accuracy: 94.86
Round  38, Global train loss: 1.126, Global test loss: 0.953, Global test accuracy: 95.20
Round  39, Train loss: 1.241, Test loss: 0.957, Test accuracy: 94.84
Round  39, Global train loss: 1.241, Global test loss: 0.955, Global test accuracy: 94.94
Round  40, Train loss: 1.237, Test loss: 0.957, Test accuracy: 94.74
Round  40, Global train loss: 1.237, Global test loss: 0.955, Global test accuracy: 95.22
Round  41, Train loss: 1.053, Test loss: 0.958, Test accuracy: 94.70
Round  41, Global train loss: 1.053, Global test loss: 0.950, Global test accuracy: 95.60
Round  42, Train loss: 1.239, Test loss: 0.957, Test accuracy: 94.80
Round  42, Global train loss: 1.239, Global test loss: 0.955, Global test accuracy: 95.18
Round  43, Train loss: 1.169, Test loss: 0.958, Test accuracy: 94.74
Round  43, Global train loss: 1.169, Global test loss: 0.953, Global test accuracy: 95.30
Round  44, Train loss: 1.170, Test loss: 0.957, Test accuracy: 94.74
Round  44, Global train loss: 1.170, Global test loss: 0.953, Global test accuracy: 95.26
Round  45, Train loss: 1.210, Test loss: 0.957, Test accuracy: 94.72
Round  45, Global train loss: 1.210, Global test loss: 0.950, Global test accuracy: 95.56
Round  46, Train loss: 1.136, Test loss: 0.957, Test accuracy: 94.84
Round  46, Global train loss: 1.136, Global test loss: 0.958, Global test accuracy: 94.90
Round  47, Train loss: 1.066, Test loss: 0.958, Test accuracy: 94.68
Round  47, Global train loss: 1.066, Global test loss: 0.952, Global test accuracy: 95.42
Round  48, Train loss: 1.121, Test loss: 0.958, Test accuracy: 94.62
Round  48, Global train loss: 1.121, Global test loss: 0.953, Global test accuracy: 95.44
Round  49, Train loss: 1.121, Test loss: 0.959, Test accuracy: 94.58
Round  49, Global train loss: 1.121, Global test loss: 0.954, Global test accuracy: 95.04
Round  50, Train loss: 1.054, Test loss: 0.959, Test accuracy: 94.64
Round  50, Global train loss: 1.054, Global test loss: 0.952, Global test accuracy: 95.42
Round  51, Train loss: 1.125, Test loss: 0.959, Test accuracy: 94.62
Round  51, Global train loss: 1.125, Global test loss: 0.956, Global test accuracy: 94.88
Round  52, Train loss: 1.224, Test loss: 0.959, Test accuracy: 94.66
Round  52, Global train loss: 1.224, Global test loss: 0.957, Global test accuracy: 94.76
Round  53, Train loss: 1.166, Test loss: 0.958, Test accuracy: 94.64
Round  53, Global train loss: 1.166, Global test loss: 0.952, Global test accuracy: 95.44
Round  54, Train loss: 1.180, Test loss: 0.959, Test accuracy: 94.66
Round  54, Global train loss: 1.180, Global test loss: 0.956, Global test accuracy: 94.78
Round  55, Train loss: 1.224, Test loss: 0.959, Test accuracy: 94.66
Round  55, Global train loss: 1.224, Global test loss: 0.955, Global test accuracy: 95.24
Round  56, Train loss: 1.235, Test loss: 0.959, Test accuracy: 94.54
Round  56, Global train loss: 1.235, Global test loss: 0.961, Global test accuracy: 94.32
Round  57, Train loss: 1.166, Test loss: 0.959, Test accuracy: 94.62
Round  57, Global train loss: 1.166, Global test loss: 0.952, Global test accuracy: 95.40
Round  58, Train loss: 1.121, Test loss: 0.959, Test accuracy: 94.62
Round  58, Global train loss: 1.121, Global test loss: 0.957, Global test accuracy: 94.88
Round  59, Train loss: 1.108, Test loss: 0.960, Test accuracy: 94.62
Round  59, Global train loss: 1.108, Global test loss: 0.952, Global test accuracy: 95.36
Round  60, Train loss: 1.181, Test loss: 0.960, Test accuracy: 94.58
Round  60, Global train loss: 1.181, Global test loss: 0.955, Global test accuracy: 95.06
Round  61, Train loss: 1.234, Test loss: 0.959, Test accuracy: 94.70
Round  61, Global train loss: 1.234, Global test loss: 0.963, Global test accuracy: 94.08
Round  62, Train loss: 1.052, Test loss: 0.959, Test accuracy: 94.70
Round  62, Global train loss: 1.052, Global test loss: 0.951, Global test accuracy: 95.44
Round  63, Train loss: 1.233, Test loss: 0.959, Test accuracy: 94.68
Round  63, Global train loss: 1.233, Global test loss: 0.957, Global test accuracy: 94.88
Round  64, Train loss: 1.179, Test loss: 0.959, Test accuracy: 94.62
Round  64, Global train loss: 1.179, Global test loss: 0.956, Global test accuracy: 94.80
Round  65, Train loss: 1.105, Test loss: 0.959, Test accuracy: 94.60
Round  65, Global train loss: 1.105, Global test loss: 0.953, Global test accuracy: 95.20
Round  66, Train loss: 1.223, Test loss: 0.959, Test accuracy: 94.60
Round  66, Global train loss: 1.223, Global test loss: 0.953, Global test accuracy: 95.16
Round  67, Train loss: 1.221, Test loss: 0.959, Test accuracy: 94.60
Round  67, Global train loss: 1.221, Global test loss: 0.953, Global test accuracy: 95.08
Round  68, Train loss: 1.133, Test loss: 0.959, Test accuracy: 94.66
Round  68, Global train loss: 1.133, Global test loss: 0.959, Global test accuracy: 94.44
Round  69, Train loss: 1.232, Test loss: 0.959, Test accuracy: 94.62
Round  69, Global train loss: 1.232, Global test loss: 0.958, Global test accuracy: 94.66
Round  70, Train loss: 1.209, Test loss: 0.960, Test accuracy: 94.46
Round  70, Global train loss: 1.209, Global test loss: 0.955, Global test accuracy: 95.02
Round  71, Train loss: 1.149, Test loss: 0.960, Test accuracy: 94.48
Round  71, Global train loss: 1.149, Global test loss: 0.953, Global test accuracy: 95.22
Round  72, Train loss: 1.120, Test loss: 0.960, Test accuracy: 94.48
Round  72, Global train loss: 1.120, Global test loss: 0.956, Global test accuracy: 95.10
Round  73, Train loss: 1.218, Test loss: 0.960, Test accuracy: 94.48
Round  73, Global train loss: 1.218, Global test loss: 0.955, Global test accuracy: 95.10
Round  74, Train loss: 1.179, Test loss: 0.960, Test accuracy: 94.46
Round  74, Global train loss: 1.179, Global test loss: 0.956, Global test accuracy: 94.84
Round  75, Train loss: 1.133, Test loss: 0.961, Test accuracy: 94.38
Round  75, Global train loss: 1.133, Global test loss: 0.961, Global test accuracy: 94.36
Round  76, Train loss: 1.234, Test loss: 0.961, Test accuracy: 94.42
Round  76, Global train loss: 1.234, Global test loss: 0.960, Global test accuracy: 94.44
Round  77, Train loss: 1.165, Test loss: 0.961, Test accuracy: 94.36
Round  77, Global train loss: 1.165, Global test loss: 0.954, Global test accuracy: 95.08
Round  78, Train loss: 1.178, Test loss: 0.960, Test accuracy: 94.36
Round  78, Global train loss: 1.178, Global test loss: 0.956, Global test accuracy: 94.70
Round  79, Train loss: 1.218, Test loss: 0.960, Test accuracy: 94.40
Round  79, Global train loss: 1.218, Global test loss: 0.955, Global test accuracy: 94.96
Round  80, Train loss: 1.231, Test loss: 0.960, Test accuracy: 94.42
Round  80, Global train loss: 1.231, Global test loss: 0.960, Global test accuracy: 94.32
Round  81, Train loss: 1.217, Test loss: 0.961, Test accuracy: 94.44
Round  81, Global train loss: 1.217, Global test loss: 0.959, Global test accuracy: 94.40
Round  82, Train loss: 1.165, Test loss: 0.961, Test accuracy: 94.36
Round  82, Global train loss: 1.165, Global test loss: 0.955, Global test accuracy: 95.04
Round  83, Train loss: 1.132, Test loss: 0.961, Test accuracy: 94.38
Round  83, Global train loss: 1.132, Global test loss: 0.961, Global test accuracy: 94.34
Round  84, Train loss: 1.219, Test loss: 0.961, Test accuracy: 94.40
Round  84, Global train loss: 1.219, Global test loss: 0.961, Global test accuracy: 94.30
Round  85, Train loss: 1.153, Test loss: 0.961, Test accuracy: 94.30
Round  85, Global train loss: 1.153, Global test loss: 0.956, Global test accuracy: 94.86
Round  86, Train loss: 1.221, Test loss: 0.961, Test accuracy: 94.40
Round  86, Global train loss: 1.221, Global test loss: 0.957, Global test accuracy: 95.04
Round  87, Train loss: 1.122, Test loss: 0.961, Test accuracy: 94.46
Round  87, Global train loss: 1.122, Global test loss: 0.957, Global test accuracy: 94.90
Round  88, Train loss: 1.235, Test loss: 0.961, Test accuracy: 94.46
Round  88, Global train loss: 1.235, Global test loss: 0.959, Global test accuracy: 94.42
Round  89, Train loss: 1.165, Test loss: 0.961, Test accuracy: 94.34
Round  89, Global train loss: 1.165, Global test loss: 0.955, Global test accuracy: 95.08
Round  90, Train loss: 1.117, Test loss: 0.961, Test accuracy: 94.34
Round  90, Global train loss: 1.117, Global test loss: 0.956, Global test accuracy: 95.02
Round  91, Train loss: 1.117, Test loss: 0.961, Test accuracy: 94.24
Round  91, Global train loss: 1.117, Global test loss: 0.956, Global test accuracy: 95.06
Round  92, Train loss: 1.231, Test loss: 0.961, Test accuracy: 94.30
Round  92, Global train loss: 1.231, Global test loss: 0.959, Global test accuracy: 94.60
Round  93, Train loss: 1.178, Test loss: 0.961, Test accuracy: 94.38
Round  93, Global train loss: 1.178, Global test loss: 0.958, Global test accuracy: 94.72/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.133, Test loss: 0.961, Test accuracy: 94.30
Round  94, Global train loss: 1.133, Global test loss: 0.959, Global test accuracy: 94.64
Round  95, Train loss: 1.164, Test loss: 0.961, Test accuracy: 94.30
Round  95, Global train loss: 1.164, Global test loss: 0.957, Global test accuracy: 94.84
Round  96, Train loss: 1.153, Test loss: 0.961, Test accuracy: 94.38
Round  96, Global train loss: 1.153, Global test loss: 0.955, Global test accuracy: 94.88
Round  97, Train loss: 1.133, Test loss: 0.960, Test accuracy: 94.46
Round  97, Global train loss: 1.133, Global test loss: 0.958, Global test accuracy: 94.74
Round  98, Train loss: 1.163, Test loss: 0.960, Test accuracy: 94.42
Round  98, Global train loss: 1.163, Global test loss: 0.956, Global test accuracy: 94.88
Round  99, Train loss: 1.218, Test loss: 0.960, Test accuracy: 94.48
Round  99, Global train loss: 1.218, Global test loss: 0.959, Global test accuracy: 94.60
Final Round, Train loss: 1.174, Test loss: 0.961, Test accuracy: 94.36
Final Round, Global train loss: 1.174, Global test loss: 0.959, Global test accuracy: 94.60
Average accuracy final 10 rounds: 94.36000000000001 

Average global accuracy final 10 rounds: 94.798 

679.6054179668427
[1.0185463428497314, 2.037092685699463, 2.8510937690734863, 3.6650948524475098, 4.462148427963257, 5.259202003479004, 6.082262992858887, 6.9053239822387695, 7.708879232406616, 8.512434482574463, 9.363914966583252, 10.215395450592041, 11.016036748886108, 11.816678047180176, 12.626190900802612, 13.435703754425049, 14.281914472579956, 15.128125190734863, 15.963580131530762, 16.79903507232666, 17.61062216758728, 18.4222092628479, 19.242135047912598, 20.062060832977295, 20.892273902893066, 21.722486972808838, 22.530092000961304, 23.33769702911377, 24.164240837097168, 24.990784645080566, 25.798126935958862, 26.605469226837158, 27.468247413635254, 28.33102560043335, 29.177284002304077, 30.023542404174805, 30.825294256210327, 31.62704610824585, 32.45794749259949, 33.288848876953125, 34.17185115814209, 35.054853439331055, 35.864173889160156, 36.67349433898926, 37.46911263465881, 38.26473093032837, 39.08825325965881, 39.91177558898926, 40.711010456085205, 41.51024532318115, 42.33855390548706, 43.16686248779297, 43.99070596694946, 44.81454944610596, 45.608160972595215, 46.40177249908447, 47.22973823547363, 48.05770397186279, 48.860315561294556, 49.66292715072632, 50.48092031478882, 51.29891347885132, 52.112841844558716, 52.92677021026611, 53.74064326286316, 54.554516315460205, 55.38090491294861, 56.20729351043701, 57.000930309295654, 57.7945671081543, 58.60051727294922, 59.40646743774414, 60.24193739891052, 61.077407360076904, 61.903239011764526, 62.72907066345215, 63.52544569969177, 64.3218207359314, 65.14207696914673, 65.96233320236206, 66.77912521362305, 67.59591722488403, 68.39008522033691, 69.1842532157898, 70.02277135848999, 70.86128950119019, 71.62528610229492, 72.38928270339966, 73.19393515586853, 73.9985876083374, 74.80470871925354, 75.61082983016968, 76.43537425994873, 77.25991868972778, 78.06571936607361, 78.87152004241943, 79.6649067401886, 80.45829343795776, 81.26085186004639, 82.06341028213501, 82.8481388092041, 83.6328673362732, 84.48249888420105, 85.3321304321289, 86.11422514915466, 86.89631986618042, 87.71984720230103, 88.54337453842163, 89.32291173934937, 90.1024489402771, 90.93650937080383, 91.77056980133057, 92.58566212654114, 93.40075445175171, 94.23106241226196, 95.06137037277222, 95.89286065101624, 96.72435092926025, 97.58470582962036, 98.44506072998047, 99.24507641792297, 100.04509210586548, 100.84828162193298, 101.65147113800049, 102.46911025047302, 103.28674936294556, 104.09741926193237, 104.90808916091919, 105.72340273857117, 106.53871631622314, 107.37143540382385, 108.20415449142456, 108.9842586517334, 109.76436281204224, 110.6444764137268, 111.52459001541138, 112.39010763168335, 113.25562524795532, 114.08620977401733, 114.91679430007935, 115.8127384185791, 116.70868253707886, 117.59135460853577, 118.47402667999268, 119.33876705169678, 120.20350742340088, 121.0069682598114, 121.81042909622192, 122.62665557861328, 123.44288206100464, 124.24212145805359, 125.04136085510254, 125.91014909744263, 126.77893733978271, 127.61519360542297, 128.45144987106323, 129.27332210540771, 130.0951943397522, 130.95896077156067, 131.82272720336914, 132.60975813865662, 133.3967890739441, 134.2290894985199, 135.0613899230957, 135.83028984069824, 136.59918975830078, 137.44391655921936, 138.28864336013794, 139.09051775932312, 139.8923921585083, 140.7101125717163, 141.52783298492432, 142.39627718925476, 143.2647213935852, 144.1326198577881, 145.00051832199097, 145.84697437286377, 146.69343042373657, 147.49020195007324, 148.2869734764099, 149.13153433799744, 149.97609519958496, 150.8195240497589, 151.66295289993286, 152.46025919914246, 153.25756549835205, 154.08269453048706, 154.90782356262207, 155.72555899620056, 156.54329442977905, 157.42926502227783, 158.3152356147766, 159.18873715400696, 160.0622386932373, 160.95142483711243, 161.84061098098755, 162.68938899040222, 163.5381669998169, 164.33391451835632, 165.12966203689575, 166.79074335098267, 168.45182466506958]
[43.88, 43.88, 67.86, 67.86, 77.6, 77.6, 84.52, 84.52, 89.0, 89.0, 90.18, 90.18, 90.44, 90.44, 90.38, 90.38, 94.86, 94.86, 94.84, 94.84, 94.88, 94.88, 95.02, 95.02, 95.22, 95.22, 95.16, 95.16, 95.24, 95.24, 95.3, 95.3, 95.34, 95.34, 95.18, 95.18, 95.1, 95.1, 95.12, 95.12, 95.2, 95.2, 95.2, 95.2, 95.24, 95.24, 95.22, 95.22, 95.06, 95.06, 95.16, 95.16, 95.06, 95.06, 95.08, 95.08, 94.94, 94.94, 94.92, 94.92, 94.94, 94.94, 94.84, 94.84, 94.8, 94.8, 94.84, 94.84, 94.86, 94.86, 95.02, 95.02, 94.9, 94.9, 95.0, 95.0, 94.86, 94.86, 94.84, 94.84, 94.74, 94.74, 94.7, 94.7, 94.8, 94.8, 94.74, 94.74, 94.74, 94.74, 94.72, 94.72, 94.84, 94.84, 94.68, 94.68, 94.62, 94.62, 94.58, 94.58, 94.64, 94.64, 94.62, 94.62, 94.66, 94.66, 94.64, 94.64, 94.66, 94.66, 94.66, 94.66, 94.54, 94.54, 94.62, 94.62, 94.62, 94.62, 94.62, 94.62, 94.58, 94.58, 94.7, 94.7, 94.7, 94.7, 94.68, 94.68, 94.62, 94.62, 94.6, 94.6, 94.6, 94.6, 94.6, 94.6, 94.66, 94.66, 94.62, 94.62, 94.46, 94.46, 94.48, 94.48, 94.48, 94.48, 94.48, 94.48, 94.46, 94.46, 94.38, 94.38, 94.42, 94.42, 94.36, 94.36, 94.36, 94.36, 94.4, 94.4, 94.42, 94.42, 94.44, 94.44, 94.36, 94.36, 94.38, 94.38, 94.4, 94.4, 94.3, 94.3, 94.4, 94.4, 94.46, 94.46, 94.46, 94.46, 94.34, 94.34, 94.34, 94.34, 94.24, 94.24, 94.3, 94.3, 94.38, 94.38, 94.3, 94.3, 94.3, 94.3, 94.38, 94.38, 94.46, 94.46, 94.42, 94.42, 94.48, 94.48, 94.36, 94.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.603, Test loss: 1.591, Test accuracy: 72.80
Round   0, Global train loss: 1.603, Global test loss: 1.591, Global test accuracy: 76.64
Round   1, Train loss: 1.576, Test loss: 1.514, Test accuracy: 63.38
Round   1, Global train loss: 1.576, Global test loss: 1.507, Global test accuracy: 68.70
Round   2, Train loss: 1.390, Test loss: 1.314, Test accuracy: 76.00
Round   2, Global train loss: 1.390, Global test loss: 1.166, Global test accuracy: 92.26
Round   3, Train loss: 1.302, Test loss: 1.178, Test accuracy: 84.60
Round   3, Global train loss: 1.302, Global test loss: 1.023, Global test accuracy: 94.58
Round   4, Train loss: 1.188, Test loss: 1.109, Test accuracy: 88.76
Round   4, Global train loss: 1.188, Global test loss: 0.987, Global test accuracy: 94.96
Round   5, Train loss: 1.222, Test loss: 1.048, Test accuracy: 91.08
Round   5, Global train loss: 1.222, Global test loss: 0.971, Global test accuracy: 95.44
Round   6, Train loss: 1.259, Test loss: 1.037, Test accuracy: 91.42
Round   6, Global train loss: 1.259, Global test loss: 0.966, Global test accuracy: 95.74
Round   7, Train loss: 1.260, Test loss: 1.035, Test accuracy: 91.48
Round   7, Global train loss: 1.260, Global test loss: 0.961, Global test accuracy: 95.68
Round   8, Train loss: 1.236, Test loss: 0.967, Test accuracy: 95.56
Round   8, Global train loss: 1.236, Global test loss: 0.959, Global test accuracy: 95.80
Round   9, Train loss: 1.246, Test loss: 0.964, Test accuracy: 95.62
Round   9, Global train loss: 1.246, Global test loss: 0.957, Global test accuracy: 95.74
Round  10, Train loss: 1.248, Test loss: 0.965, Test accuracy: 95.40
Round  10, Global train loss: 1.248, Global test loss: 0.957, Global test accuracy: 95.68
Round  11, Train loss: 1.118, Test loss: 0.959, Test accuracy: 95.72
Round  11, Global train loss: 1.118, Global test loss: 0.950, Global test accuracy: 96.10
Round  12, Train loss: 1.245, Test loss: 0.957, Test accuracy: 95.78
Round  12, Global train loss: 1.245, Global test loss: 0.951, Global test accuracy: 95.96
Round  13, Train loss: 1.155, Test loss: 0.954, Test accuracy: 96.04
Round  13, Global train loss: 1.155, Global test loss: 0.952, Global test accuracy: 95.82
Round  14, Train loss: 1.234, Test loss: 0.954, Test accuracy: 95.92
Round  14, Global train loss: 1.234, Global test loss: 0.951, Global test accuracy: 95.98
Round  15, Train loss: 1.155, Test loss: 0.953, Test accuracy: 95.86
Round  15, Global train loss: 1.155, Global test loss: 0.948, Global test accuracy: 96.10
Round  16, Train loss: 1.197, Test loss: 0.953, Test accuracy: 95.92
Round  16, Global train loss: 1.197, Global test loss: 0.948, Global test accuracy: 96.28
Round  17, Train loss: 1.110, Test loss: 0.953, Test accuracy: 95.80
Round  17, Global train loss: 1.110, Global test loss: 0.947, Global test accuracy: 96.42
Round  18, Train loss: 1.233, Test loss: 0.953, Test accuracy: 95.84
Round  18, Global train loss: 1.233, Global test loss: 0.948, Global test accuracy: 96.06
Round  19, Train loss: 1.242, Test loss: 0.953, Test accuracy: 95.70
Round  19, Global train loss: 1.242, Global test loss: 0.951, Global test accuracy: 95.96
Round  20, Train loss: 1.108, Test loss: 0.952, Test accuracy: 95.88
Round  20, Global train loss: 1.108, Global test loss: 0.945, Global test accuracy: 96.46
Round  21, Train loss: 1.233, Test loss: 0.952, Test accuracy: 95.84
Round  21, Global train loss: 1.233, Global test loss: 0.945, Global test accuracy: 96.26
Round  22, Train loss: 1.231, Test loss: 0.952, Test accuracy: 95.70
Round  22, Global train loss: 1.231, Global test loss: 0.951, Global test accuracy: 95.62
Round  23, Train loss: 1.234, Test loss: 0.950, Test accuracy: 95.90
Round  23, Global train loss: 1.234, Global test loss: 0.947, Global test accuracy: 96.02
Round  24, Train loss: 1.189, Test loss: 0.950, Test accuracy: 95.78
Round  24, Global train loss: 1.189, Global test loss: 0.945, Global test accuracy: 96.36
Round  25, Train loss: 1.101, Test loss: 0.950, Test accuracy: 95.86
Round  25, Global train loss: 1.101, Global test loss: 0.944, Global test accuracy: 96.46
Round  26, Train loss: 1.227, Test loss: 0.949, Test accuracy: 95.92
Round  26, Global train loss: 1.227, Global test loss: 0.945, Global test accuracy: 96.44
Round  27, Train loss: 1.232, Test loss: 0.949, Test accuracy: 95.98
Round  27, Global train loss: 1.232, Global test loss: 0.948, Global test accuracy: 96.02
Round  28, Train loss: 1.144, Test loss: 0.949, Test accuracy: 95.90
Round  28, Global train loss: 1.144, Global test loss: 0.948, Global test accuracy: 95.96
Round  29, Train loss: 1.220, Test loss: 0.949, Test accuracy: 95.86
Round  29, Global train loss: 1.220, Global test loss: 0.947, Global test accuracy: 96.14
Round  30, Train loss: 1.142, Test loss: 0.950, Test accuracy: 95.70
Round  30, Global train loss: 1.142, Global test loss: 0.945, Global test accuracy: 96.36
Round  31, Train loss: 1.139, Test loss: 0.949, Test accuracy: 95.92
Round  31, Global train loss: 1.139, Global test loss: 0.948, Global test accuracy: 95.82
Round  32, Train loss: 1.181, Test loss: 0.949, Test accuracy: 95.92
Round  32, Global train loss: 1.181, Global test loss: 0.946, Global test accuracy: 96.10
Round  33, Train loss: 1.102, Test loss: 0.949, Test accuracy: 95.84
Round  33, Global train loss: 1.102, Global test loss: 0.945, Global test accuracy: 96.20
Round  34, Train loss: 1.223, Test loss: 0.949, Test accuracy: 95.76
Round  34, Global train loss: 1.223, Global test loss: 0.945, Global test accuracy: 96.26
Round  35, Train loss: 1.140, Test loss: 0.949, Test accuracy: 95.84
Round  35, Global train loss: 1.140, Global test loss: 0.945, Global test accuracy: 96.14
Round  36, Train loss: 1.213, Test loss: 0.949, Test accuracy: 95.84
Round  36, Global train loss: 1.213, Global test loss: 0.946, Global test accuracy: 96.12
Round  37, Train loss: 1.178, Test loss: 0.949, Test accuracy: 95.80
Round  37, Global train loss: 1.178, Global test loss: 0.947, Global test accuracy: 96.08
Round  38, Train loss: 1.217, Test loss: 0.950, Test accuracy: 95.74
Round  38, Global train loss: 1.217, Global test loss: 0.945, Global test accuracy: 96.34
Round  39, Train loss: 1.229, Test loss: 0.949, Test accuracy: 95.82
Round  39, Global train loss: 1.229, Global test loss: 0.946, Global test accuracy: 95.98
Round  40, Train loss: 1.141, Test loss: 0.949, Test accuracy: 95.80
Round  40, Global train loss: 1.141, Global test loss: 0.946, Global test accuracy: 95.98
Round  41, Train loss: 1.178, Test loss: 0.949, Test accuracy: 95.84
Round  41, Global train loss: 1.178, Global test loss: 0.946, Global test accuracy: 96.26
Round  42, Train loss: 1.223, Test loss: 0.948, Test accuracy: 95.92
Round  42, Global train loss: 1.223, Global test loss: 0.945, Global test accuracy: 96.00
Round  43, Train loss: 1.190, Test loss: 0.949, Test accuracy: 95.86
Round  43, Global train loss: 1.190, Global test loss: 0.942, Global test accuracy: 96.42
Round  44, Train loss: 1.189, Test loss: 0.948, Test accuracy: 95.82
Round  44, Global train loss: 1.189, Global test loss: 0.942, Global test accuracy: 96.54
Round  45, Train loss: 1.214, Test loss: 0.947, Test accuracy: 95.92
Round  45, Global train loss: 1.214, Global test loss: 0.947, Global test accuracy: 95.82
Round  46, Train loss: 1.137, Test loss: 0.947, Test accuracy: 95.96
Round  46, Global train loss: 1.137, Global test loss: 0.945, Global test accuracy: 96.10
Round  47, Train loss: 1.181, Test loss: 0.947, Test accuracy: 95.98
Round  47, Global train loss: 1.181, Global test loss: 0.942, Global test accuracy: 96.38
Round  48, Train loss: 1.133, Test loss: 0.947, Test accuracy: 95.92
Round  48, Global train loss: 1.133, Global test loss: 0.943, Global test accuracy: 96.40
Round  49, Train loss: 1.217, Test loss: 0.946, Test accuracy: 95.98
Round  49, Global train loss: 1.217, Global test loss: 0.943, Global test accuracy: 96.42
Round  50, Train loss: 1.172, Test loss: 0.946, Test accuracy: 96.00
Round  50, Global train loss: 1.172, Global test loss: 0.943, Global test accuracy: 96.40
Round  51, Train loss: 1.221, Test loss: 0.946, Test accuracy: 95.98
Round  51, Global train loss: 1.221, Global test loss: 0.943, Global test accuracy: 96.42
Round  52, Train loss: 1.223, Test loss: 0.947, Test accuracy: 95.96
Round  52, Global train loss: 1.223, Global test loss: 0.945, Global test accuracy: 96.14
Round  53, Train loss: 1.184, Test loss: 0.947, Test accuracy: 96.02
Round  53, Global train loss: 1.184, Global test loss: 0.944, Global test accuracy: 96.26
Round  54, Train loss: 1.102, Test loss: 0.947, Test accuracy: 95.96
Round  54, Global train loss: 1.102, Global test loss: 0.942, Global test accuracy: 96.46
Round  55, Train loss: 1.219, Test loss: 0.947, Test accuracy: 95.90
Round  55, Global train loss: 1.219, Global test loss: 0.942, Global test accuracy: 96.20
Round  56, Train loss: 1.138, Test loss: 0.947, Test accuracy: 95.86
Round  56, Global train loss: 1.138, Global test loss: 0.946, Global test accuracy: 96.22
Round  57, Train loss: 1.181, Test loss: 0.947, Test accuracy: 95.90
Round  57, Global train loss: 1.181, Global test loss: 0.945, Global test accuracy: 96.04
Round  58, Train loss: 1.218, Test loss: 0.947, Test accuracy: 95.88
Round  58, Global train loss: 1.218, Global test loss: 0.944, Global test accuracy: 96.20
Round  59, Train loss: 1.210, Test loss: 0.947, Test accuracy: 95.84
Round  59, Global train loss: 1.210, Global test loss: 0.944, Global test accuracy: 96.14
Round  60, Train loss: 1.186, Test loss: 0.947, Test accuracy: 95.80
Round  60, Global train loss: 1.186, Global test loss: 0.943, Global test accuracy: 96.28
Round  61, Train loss: 1.140, Test loss: 0.947, Test accuracy: 95.74
Round  61, Global train loss: 1.140, Global test loss: 0.943, Global test accuracy: 96.20
Round  62, Train loss: 1.173, Test loss: 0.947, Test accuracy: 95.80
Round  62, Global train loss: 1.173, Global test loss: 0.945, Global test accuracy: 96.12
Round  63, Train loss: 1.138, Test loss: 0.947, Test accuracy: 95.78
Round  63, Global train loss: 1.138, Global test loss: 0.945, Global test accuracy: 96.30
Round  64, Train loss: 1.185, Test loss: 0.947, Test accuracy: 95.78
Round  64, Global train loss: 1.185, Global test loss: 0.943, Global test accuracy: 96.32
Round  65, Train loss: 1.211, Test loss: 0.947, Test accuracy: 95.88
Round  65, Global train loss: 1.211, Global test loss: 0.946, Global test accuracy: 96.04
Round  66, Train loss: 1.213, Test loss: 0.947, Test accuracy: 95.82
Round  66, Global train loss: 1.213, Global test loss: 0.947, Global test accuracy: 95.84
Round  67, Train loss: 1.215, Test loss: 0.947, Test accuracy: 95.80
Round  67, Global train loss: 1.215, Global test loss: 0.946, Global test accuracy: 95.92
Round  68, Train loss: 1.134, Test loss: 0.947, Test accuracy: 95.76
Round  68, Global train loss: 1.134, Global test loss: 0.945, Global test accuracy: 96.10
Round  69, Train loss: 1.221, Test loss: 0.947, Test accuracy: 95.84
Round  69, Global train loss: 1.221, Global test loss: 0.946, Global test accuracy: 96.20
Round  70, Train loss: 1.212, Test loss: 0.947, Test accuracy: 95.84
Round  70, Global train loss: 1.212, Global test loss: 0.946, Global test accuracy: 95.94
Round  71, Train loss: 1.176, Test loss: 0.947, Test accuracy: 95.82
Round  71, Global train loss: 1.176, Global test loss: 0.946, Global test accuracy: 96.14
Round  72, Train loss: 1.213, Test loss: 0.947, Test accuracy: 95.86
Round  72, Global train loss: 1.213, Global test loss: 0.947, Global test accuracy: 95.88
Round  73, Train loss: 1.132, Test loss: 0.947, Test accuracy: 95.94
Round  73, Global train loss: 1.132, Global test loss: 0.949, Global test accuracy: 95.86
Round  74, Train loss: 1.099, Test loss: 0.948, Test accuracy: 95.76
Round  74, Global train loss: 1.099, Global test loss: 0.946, Global test accuracy: 95.88
Round  75, Train loss: 1.134, Test loss: 0.948, Test accuracy: 95.74
Round  75, Global train loss: 1.134, Global test loss: 0.947, Global test accuracy: 96.02
Round  76, Train loss: 1.135, Test loss: 0.948, Test accuracy: 95.78
Round  76, Global train loss: 1.135, Global test loss: 0.948, Global test accuracy: 95.86
Round  77, Train loss: 1.178, Test loss: 0.948, Test accuracy: 95.68
Round  77, Global train loss: 1.178, Global test loss: 0.947, Global test accuracy: 95.90
Round  78, Train loss: 1.183, Test loss: 0.948, Test accuracy: 95.64
Round  78, Global train loss: 1.183, Global test loss: 0.947, Global test accuracy: 95.88
Round  79, Train loss: 1.216, Test loss: 0.948, Test accuracy: 95.66
Round  79, Global train loss: 1.216, Global test loss: 0.950, Global test accuracy: 95.70
Round  80, Train loss: 1.221, Test loss: 0.949, Test accuracy: 95.64
Round  80, Global train loss: 1.221, Global test loss: 0.950, Global test accuracy: 95.76
Round  81, Train loss: 1.219, Test loss: 0.949, Test accuracy: 95.62
Round  81, Global train loss: 1.219, Global test loss: 0.946, Global test accuracy: 96.06
Round  82, Train loss: 1.094, Test loss: 0.949, Test accuracy: 95.66
Round  82, Global train loss: 1.094, Global test loss: 0.947, Global test accuracy: 95.90
Round  83, Train loss: 1.132, Test loss: 0.949, Test accuracy: 95.76
Round  83, Global train loss: 1.132, Global test loss: 0.948, Global test accuracy: 95.92
Round  84, Train loss: 1.218, Test loss: 0.949, Test accuracy: 95.72
Round  84, Global train loss: 1.218, Global test loss: 0.948, Global test accuracy: 95.80
Round  85, Train loss: 1.176, Test loss: 0.949, Test accuracy: 95.64
Round  85, Global train loss: 1.176, Global test loss: 0.946, Global test accuracy: 95.82
Round  86, Train loss: 1.131, Test loss: 0.949, Test accuracy: 95.72
Round  86, Global train loss: 1.131, Global test loss: 0.945, Global test accuracy: 95.98
Round  87, Train loss: 1.210, Test loss: 0.949, Test accuracy: 95.72
Round  87, Global train loss: 1.210, Global test loss: 0.945, Global test accuracy: 96.02
Round  88, Train loss: 1.133, Test loss: 0.949, Test accuracy: 95.68
Round  88, Global train loss: 1.133, Global test loss: 0.946, Global test accuracy: 96.22
Round  89, Train loss: 1.094, Test loss: 0.949, Test accuracy: 95.66
Round  89, Global train loss: 1.094, Global test loss: 0.946, Global test accuracy: 95.94
Round  90, Train loss: 1.128, Test loss: 0.949, Test accuracy: 95.68
Round  90, Global train loss: 1.128, Global test loss: 0.947, Global test accuracy: 95.84
Round  91, Train loss: 1.212, Test loss: 0.950, Test accuracy: 95.62
Round  91, Global train loss: 1.212, Global test loss: 0.948, Global test accuracy: 95.74
Round  92, Train loss: 1.219, Test loss: 0.950, Test accuracy: 95.62
Round  92, Global train loss: 1.219, Global test loss: 0.949, Global test accuracy: 95.84
Round  93, Train loss: 1.098, Test loss: 0.950, Test accuracy: 95.58
Round  93, Global train loss: 1.098, Global test loss: 0.947, Global test accuracy: 95.92
Round  94, Train loss: 1.131, Test loss: 0.950, Test accuracy: 95.58
Round  94, Global train loss: 1.131, Global test loss: 0.948, Global test accuracy: 95.82/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.178, Test loss: 0.950, Test accuracy: 95.48
Round  95, Global train loss: 1.178, Global test loss: 0.947, Global test accuracy: 95.60
Round  96, Train loss: 1.171, Test loss: 0.950, Test accuracy: 95.56
Round  96, Global train loss: 1.171, Global test loss: 0.948, Global test accuracy: 95.64
Round  97, Train loss: 1.131, Test loss: 0.950, Test accuracy: 95.52
Round  97, Global train loss: 1.131, Global test loss: 0.948, Global test accuracy: 95.80
Round  98, Train loss: 1.177, Test loss: 0.950, Test accuracy: 95.50
Round  98, Global train loss: 1.177, Global test loss: 0.948, Global test accuracy: 95.62
Round  99, Train loss: 1.133, Test loss: 0.950, Test accuracy: 95.50
Round  99, Global train loss: 1.133, Global test loss: 0.948, Global test accuracy: 95.64
Final Round, Train loss: 1.177, Test loss: 0.952, Test accuracy: 95.50
Final Round, Global train loss: 1.177, Global test loss: 0.948, Global test accuracy: 95.64
Average accuracy final 10 rounds: 95.564 

Average global accuracy final 10 rounds: 95.74599999999998 

694.8287994861603
[1.0044519901275635, 2.008903980255127, 2.9200313091278076, 3.8311586380004883, 4.775437831878662, 5.719717025756836, 6.617408752441406, 7.515100479125977, 8.418119192123413, 9.32113790512085, 10.273156642913818, 11.225175380706787, 12.159478187561035, 13.093780994415283, 14.013741970062256, 14.933702945709229, 15.814815759658813, 16.6959285736084, 17.58636498451233, 18.47680139541626, 19.399829149246216, 20.322856903076172, 21.284746408462524, 22.246635913848877, 23.13020348548889, 24.013771057128906, 24.877419471740723, 25.74106788635254, 26.64042067527771, 27.53977346420288, 28.460917949676514, 29.382062435150146, 30.257194995880127, 31.132327556610107, 32.022143840789795, 32.91196012496948, 33.78092122077942, 34.649882316589355, 35.52355718612671, 36.39723205566406, 37.28057408332825, 38.16391611099243, 39.02099680900574, 39.87807750701904, 40.732380390167236, 41.58668327331543, 42.431979179382324, 43.27727508544922, 44.15829420089722, 45.039313316345215, 45.92591834068298, 46.81252336502075, 47.71529245376587, 48.618061542510986, 49.51162624359131, 50.40519094467163, 51.30476951599121, 52.20434808731079, 53.14161562919617, 54.07888317108154, 54.95631384849548, 55.833744525909424, 56.72212219238281, 57.6104998588562, 58.48923468589783, 59.36796951293945, 60.23378014564514, 61.09959077835083, 61.96859264373779, 62.837594509124756, 63.70317578315735, 64.56875705718994, 65.47765922546387, 66.3865613937378, 67.3047103881836, 68.2228593826294, 69.09278631210327, 69.96271324157715, 70.8053548336029, 71.64799642562866, 72.5070469379425, 73.36609745025635, 74.24895858764648, 75.13181972503662, 76.0417902469635, 76.95176076889038, 77.90306162834167, 78.85436248779297, 79.81982803344727, 80.78529357910156, 81.72727179527283, 82.66925001144409, 83.53368139266968, 84.39811277389526, 85.2887351512909, 86.17935752868652, 87.08452844619751, 87.9896993637085, 88.89848017692566, 89.80726099014282, 90.69168782234192, 91.57611465454102, 92.45617914199829, 93.33624362945557, 94.22884464263916, 95.12144565582275, 96.01601529121399, 96.91058492660522, 97.77751159667969, 98.64443826675415, 99.60921335220337, 100.57398843765259, 101.50856709480286, 102.44314575195312, 103.40458965301514, 104.36603355407715, 105.28096342086792, 106.19589328765869, 107.14423489570618, 108.09257650375366, 109.0388810634613, 109.98518562316895, 110.88560891151428, 111.78603219985962, 112.70396137237549, 113.62189054489136, 114.62934064865112, 115.63679075241089, 116.52957344055176, 117.42235612869263, 118.33399438858032, 119.24563264846802, 120.08552026748657, 120.92540788650513, 121.89489722251892, 122.86438655853271, 123.78291726112366, 124.7014479637146, 125.63848447799683, 126.57552099227905, 127.46686434745789, 128.35820770263672, 129.24235558509827, 130.12650346755981, 131.03253984451294, 131.93857622146606, 132.79562377929688, 133.65267133712769, 134.52331113815308, 135.39395093917847, 136.33334112167358, 137.2727313041687, 138.19951677322388, 139.12630224227905, 140.00156426429749, 140.87682628631592, 141.77313566207886, 142.6694450378418, 143.5395016670227, 144.4095582962036, 145.29550290107727, 146.18144750595093, 147.0334870815277, 147.8855266571045, 148.81402492523193, 149.74252319335938, 150.67598271369934, 151.6094422340393, 152.51606822013855, 153.4226942062378, 154.3078737258911, 155.19305324554443, 156.05079531669617, 156.9085373878479, 157.76121401786804, 158.61389064788818, 159.49069356918335, 160.36749649047852, 161.22896242141724, 162.09042835235596, 162.9473180770874, 163.80420780181885, 164.68966460227966, 165.57512140274048, 166.417165517807, 167.25920963287354, 168.12120246887207, 168.9831953048706, 169.86796307563782, 170.75273084640503, 171.5878405570984, 172.42295026779175, 173.27225995063782, 174.1215696334839, 174.97462821006775, 175.8276867866516, 176.67827224731445, 177.5288577079773, 178.47540283203125, 179.4219479560852, 181.1853997707367, 182.94885158538818]
[72.8, 72.8, 63.38, 63.38, 76.0, 76.0, 84.6, 84.6, 88.76, 88.76, 91.08, 91.08, 91.42, 91.42, 91.48, 91.48, 95.56, 95.56, 95.62, 95.62, 95.4, 95.4, 95.72, 95.72, 95.78, 95.78, 96.04, 96.04, 95.92, 95.92, 95.86, 95.86, 95.92, 95.92, 95.8, 95.8, 95.84, 95.84, 95.7, 95.7, 95.88, 95.88, 95.84, 95.84, 95.7, 95.7, 95.9, 95.9, 95.78, 95.78, 95.86, 95.86, 95.92, 95.92, 95.98, 95.98, 95.9, 95.9, 95.86, 95.86, 95.7, 95.7, 95.92, 95.92, 95.92, 95.92, 95.84, 95.84, 95.76, 95.76, 95.84, 95.84, 95.84, 95.84, 95.8, 95.8, 95.74, 95.74, 95.82, 95.82, 95.8, 95.8, 95.84, 95.84, 95.92, 95.92, 95.86, 95.86, 95.82, 95.82, 95.92, 95.92, 95.96, 95.96, 95.98, 95.98, 95.92, 95.92, 95.98, 95.98, 96.0, 96.0, 95.98, 95.98, 95.96, 95.96, 96.02, 96.02, 95.96, 95.96, 95.9, 95.9, 95.86, 95.86, 95.9, 95.9, 95.88, 95.88, 95.84, 95.84, 95.8, 95.8, 95.74, 95.74, 95.8, 95.8, 95.78, 95.78, 95.78, 95.78, 95.88, 95.88, 95.82, 95.82, 95.8, 95.8, 95.76, 95.76, 95.84, 95.84, 95.84, 95.84, 95.82, 95.82, 95.86, 95.86, 95.94, 95.94, 95.76, 95.76, 95.74, 95.74, 95.78, 95.78, 95.68, 95.68, 95.64, 95.64, 95.66, 95.66, 95.64, 95.64, 95.62, 95.62, 95.66, 95.66, 95.76, 95.76, 95.72, 95.72, 95.64, 95.64, 95.72, 95.72, 95.72, 95.72, 95.68, 95.68, 95.66, 95.66, 95.68, 95.68, 95.62, 95.62, 95.62, 95.62, 95.58, 95.58, 95.58, 95.58, 95.48, 95.48, 95.56, 95.56, 95.52, 95.52, 95.5, 95.5, 95.5, 95.5, 95.5, 95.5]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 6, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.627, Test loss: 1.597, Test accuracy: 37.10
Round   0, Global train loss: 1.627, Global test loss: 1.597, Global test accuracy: 37.16
Round   1, Train loss: 1.593, Test loss: 1.562, Test accuracy: 72.84
Round   1, Global train loss: 1.593, Global test loss: 1.562, Global test accuracy: 72.62
Round   2, Train loss: 1.569, Test loss: 1.485, Test accuracy: 76.98
Round   2, Global train loss: 1.569, Global test loss: 1.481, Global test accuracy: 74.96
Round   3, Train loss: 1.447, Test loss: 1.267, Test accuracy: 88.62
Round   3, Global train loss: 1.447, Global test loss: 1.244, Global test accuracy: 88.34
Round   4, Train loss: 1.351, Test loss: 1.149, Test accuracy: 90.60
Round   4, Global train loss: 1.351, Global test loss: 1.119, Global test accuracy: 90.94
Round   5, Train loss: 1.260, Test loss: 1.073, Test accuracy: 93.36
Round   5, Global train loss: 1.260, Global test loss: 1.053, Global test accuracy: 94.16
Round   6, Train loss: 1.247, Test loss: 1.048, Test accuracy: 94.34
Round   6, Global train loss: 1.247, Global test loss: 1.029, Global test accuracy: 94.66
Round   7, Train loss: 1.327, Test loss: 1.042, Test accuracy: 94.48
Round   7, Global train loss: 1.327, Global test loss: 1.026, Global test accuracy: 94.94
Round   8, Train loss: 1.251, Test loss: 1.025, Test accuracy: 95.24
Round   8, Global train loss: 1.251, Global test loss: 1.015, Global test accuracy: 95.86
Round   9, Train loss: 1.203, Test loss: 1.016, Test accuracy: 95.50
Round   9, Global train loss: 1.203, Global test loss: 0.997, Global test accuracy: 96.00
Round  10, Train loss: 1.323, Test loss: 1.020, Test accuracy: 95.68
Round  10, Global train loss: 1.323, Global test loss: 1.009, Global test accuracy: 95.92
Round  11, Train loss: 1.209, Test loss: 1.011, Test accuracy: 95.90
Round  11, Global train loss: 1.209, Global test loss: 1.001, Global test accuracy: 96.22
Round  12, Train loss: 1.305, Test loss: 1.013, Test accuracy: 95.60
Round  12, Global train loss: 1.305, Global test loss: 1.003, Global test accuracy: 95.34
Round  13, Train loss: 1.311, Test loss: 1.014, Test accuracy: 95.84
Round  13, Global train loss: 1.311, Global test loss: 1.008, Global test accuracy: 96.20
Round  14, Train loss: 1.238, Test loss: 1.008, Test accuracy: 96.04
Round  14, Global train loss: 1.238, Global test loss: 0.990, Global test accuracy: 96.34
Round  15, Train loss: 1.200, Test loss: 1.003, Test accuracy: 96.08
Round  15, Global train loss: 1.200, Global test loss: 0.989, Global test accuracy: 96.44
Round  16, Train loss: 1.184, Test loss: 0.997, Test accuracy: 96.30
Round  16, Global train loss: 1.184, Global test loss: 0.979, Global test accuracy: 96.86
Round  17, Train loss: 1.185, Test loss: 0.995, Test accuracy: 96.24
Round  17, Global train loss: 1.185, Global test loss: 0.978, Global test accuracy: 96.76
Round  18, Train loss: 1.224, Test loss: 0.990, Test accuracy: 96.58
Round  18, Global train loss: 1.224, Global test loss: 0.976, Global test accuracy: 97.06
Round  19, Train loss: 1.309, Test loss: 0.998, Test accuracy: 96.28
Round  19, Global train loss: 1.309, Global test loss: 0.995, Global test accuracy: 95.96
Round  20, Train loss: 1.283, Test loss: 0.997, Test accuracy: 96.40
Round  20, Global train loss: 1.283, Global test loss: 0.985, Global test accuracy: 97.00
Round  21, Train loss: 1.306, Test loss: 0.993, Test accuracy: 96.12
Round  21, Global train loss: 1.306, Global test loss: 1.002, Global test accuracy: 96.18
Round  22, Train loss: 1.280, Test loss: 0.995, Test accuracy: 96.32
Round  22, Global train loss: 1.280, Global test loss: 0.978, Global test accuracy: 97.06
Round  23, Train loss: 1.177, Test loss: 0.992, Test accuracy: 96.28
Round  23, Global train loss: 1.177, Global test loss: 0.973, Global test accuracy: 96.94
Round  24, Train loss: 1.299, Test loss: 0.986, Test accuracy: 96.40
Round  24, Global train loss: 1.299, Global test loss: 0.990, Global test accuracy: 96.90
Round  25, Train loss: 1.289, Test loss: 0.987, Test accuracy: 96.40
Round  25, Global train loss: 1.289, Global test loss: 0.991, Global test accuracy: 96.94
Round  26, Train loss: 1.211, Test loss: 0.983, Test accuracy: 96.52
Round  26, Global train loss: 1.211, Global test loss: 0.973, Global test accuracy: 96.96
Round  27, Train loss: 1.288, Test loss: 0.989, Test accuracy: 96.44
Round  27, Global train loss: 1.288, Global test loss: 0.982, Global test accuracy: 97.02
Round  28, Train loss: 1.281, Test loss: 0.995, Test accuracy: 96.20
Round  28, Global train loss: 1.281, Global test loss: 0.998, Global test accuracy: 95.50
Round  29, Train loss: 1.270, Test loss: 0.989, Test accuracy: 96.24
Round  29, Global train loss: 1.270, Global test loss: 0.977, Global test accuracy: 97.12
Round  30, Train loss: 1.102, Test loss: 0.980, Test accuracy: 96.38
Round  30, Global train loss: 1.102, Global test loss: 0.964, Global test accuracy: 97.04
Round  31, Train loss: 1.262, Test loss: 0.986, Test accuracy: 96.24
Round  31, Global train loss: 1.262, Global test loss: 0.974, Global test accuracy: 96.84
Round  32, Train loss: 1.203, Test loss: 0.983, Test accuracy: 96.44
Round  32, Global train loss: 1.203, Global test loss: 0.971, Global test accuracy: 97.06
Round  33, Train loss: 1.261, Test loss: 0.987, Test accuracy: 96.06
Round  33, Global train loss: 1.261, Global test loss: 0.974, Global test accuracy: 96.86
Round  34, Train loss: 1.270, Test loss: 0.983, Test accuracy: 96.16
Round  34, Global train loss: 1.270, Global test loss: 0.975, Global test accuracy: 97.16
Round  35, Train loss: 1.209, Test loss: 0.986, Test accuracy: 96.26
Round  35, Global train loss: 1.209, Global test loss: 0.976, Global test accuracy: 96.94
Round  36, Train loss: 1.201, Test loss: 0.980, Test accuracy: 96.44
Round  36, Global train loss: 1.201, Global test loss: 0.968, Global test accuracy: 97.00
Round  37, Train loss: 1.191, Test loss: 0.982, Test accuracy: 96.48
Round  37, Global train loss: 1.191, Global test loss: 0.969, Global test accuracy: 97.08
Round  38, Train loss: 1.202, Test loss: 0.979, Test accuracy: 96.48
Round  38, Global train loss: 1.202, Global test loss: 0.968, Global test accuracy: 96.98
Round  39, Train loss: 1.264, Test loss: 0.987, Test accuracy: 95.74
Round  39, Global train loss: 1.264, Global test loss: 0.986, Global test accuracy: 95.38
Round  40, Train loss: 1.260, Test loss: 0.995, Test accuracy: 95.38
Round  40, Global train loss: 1.260, Global test loss: 0.988, Global test accuracy: 95.80
Round  41, Train loss: 1.263, Test loss: 0.992, Test accuracy: 95.70
Round  41, Global train loss: 1.263, Global test loss: 0.980, Global test accuracy: 96.92
Round  42, Train loss: 1.200, Test loss: 0.989, Test accuracy: 95.70
Round  42, Global train loss: 1.200, Global test loss: 0.974, Global test accuracy: 96.72
Round  43, Train loss: 1.152, Test loss: 0.987, Test accuracy: 95.32
Round  43, Global train loss: 1.152, Global test loss: 0.968, Global test accuracy: 96.92
Round  44, Train loss: 1.151, Test loss: 0.985, Test accuracy: 95.48
Round  44, Global train loss: 1.151, Global test loss: 0.967, Global test accuracy: 96.90
Round  45, Train loss: 1.176, Test loss: 0.983, Test accuracy: 95.68
Round  45, Global train loss: 1.176, Global test loss: 0.961, Global test accuracy: 96.82
Round  46, Train loss: 1.262, Test loss: 0.992, Test accuracy: 95.00
Round  46, Global train loss: 1.262, Global test loss: 0.997, Global test accuracy: 95.52
Round  47, Train loss: 1.249, Test loss: 0.994, Test accuracy: 95.10
Round  47, Global train loss: 1.249, Global test loss: 0.982, Global test accuracy: 96.62
Round  48, Train loss: 1.245, Test loss: 0.995, Test accuracy: 95.02
Round  48, Global train loss: 1.245, Global test loss: 0.984, Global test accuracy: 96.46
Round  49, Train loss: 1.248, Test loss: 0.997, Test accuracy: 94.72
Round  49, Global train loss: 1.248, Global test loss: 0.981, Global test accuracy: 96.50
Round  50, Train loss: 1.170, Test loss: 0.994, Test accuracy: 94.90
Round  50, Global train loss: 1.170, Global test loss: 0.983, Global test accuracy: 96.20
Round  51, Train loss: 1.145, Test loss: 0.987, Test accuracy: 95.12
Round  51, Global train loss: 1.145, Global test loss: 0.974, Global test accuracy: 96.42
Round  52, Train loss: 1.146, Test loss: 0.984, Test accuracy: 95.12
Round  52, Global train loss: 1.146, Global test loss: 0.971, Global test accuracy: 96.22
Round  53, Train loss: 1.229, Test loss: 0.997, Test accuracy: 94.36
Round  53, Global train loss: 1.229, Global test loss: 0.979, Global test accuracy: 96.14
Round  54, Train loss: 1.234, Test loss: 1.003, Test accuracy: 94.00
Round  54, Global train loss: 1.234, Global test loss: 0.994, Global test accuracy: 95.40
Round  55, Train loss: 1.068, Test loss: 0.985, Test accuracy: 95.00
Round  55, Global train loss: 1.068, Global test loss: 0.964, Global test accuracy: 96.52
Round  56, Train loss: 1.241, Test loss: 0.995, Test accuracy: 94.52
Round  56, Global train loss: 1.241, Global test loss: 0.997, Global test accuracy: 94.66
Round  57, Train loss: 1.225, Test loss: 1.010, Test accuracy: 93.40
Round  57, Global train loss: 1.225, Global test loss: 0.992, Global test accuracy: 95.38
Round  58, Train loss: 1.143, Test loss: 0.993, Test accuracy: 94.44
Round  58, Global train loss: 1.143, Global test loss: 0.973, Global test accuracy: 96.24
Round  59, Train loss: 1.157, Test loss: 0.992, Test accuracy: 94.20
Round  59, Global train loss: 1.157, Global test loss: 0.967, Global test accuracy: 96.48
Round  60, Train loss: 1.227, Test loss: 1.013, Test accuracy: 92.92
Round  60, Global train loss: 1.227, Global test loss: 1.000, Global test accuracy: 94.42
Round  61, Train loss: 1.128, Test loss: 0.996, Test accuracy: 94.02
Round  61, Global train loss: 1.128, Global test loss: 0.983, Global test accuracy: 95.24
Round  62, Train loss: 1.217, Test loss: 1.002, Test accuracy: 93.78
Round  62, Global train loss: 1.217, Global test loss: 0.984, Global test accuracy: 95.80
Round  63, Train loss: 1.229, Test loss: 1.011, Test accuracy: 93.14
Round  63, Global train loss: 1.229, Global test loss: 1.005, Global test accuracy: 94.12
Round  64, Train loss: 1.206, Test loss: 1.017, Test accuracy: 92.70
Round  64, Global train loss: 1.206, Global test loss: 0.998, Global test accuracy: 94.68
Round  65, Train loss: 1.220, Test loss: 1.008, Test accuracy: 93.24
Round  65, Global train loss: 1.220, Global test loss: 0.984, Global test accuracy: 95.52
Round  66, Train loss: 1.151, Test loss: 1.009, Test accuracy: 92.96
Round  66, Global train loss: 1.151, Global test loss: 0.994, Global test accuracy: 94.40
Round  67, Train loss: 1.159, Test loss: 1.006, Test accuracy: 92.88
Round  67, Global train loss: 1.159, Global test loss: 0.981, Global test accuracy: 95.62
Round  68, Train loss: 1.210, Test loss: 1.024, Test accuracy: 91.58
Round  68, Global train loss: 1.210, Global test loss: 1.031, Global test accuracy: 90.94
Round  69, Train loss: 1.209, Test loss: 1.024, Test accuracy: 91.42
Round  69, Global train loss: 1.209, Global test loss: 1.014, Global test accuracy: 92.58
Round  70, Train loss: 1.063, Test loss: 0.997, Test accuracy: 93.40
Round  70, Global train loss: 1.063, Global test loss: 0.968, Global test accuracy: 96.06
Round  71, Train loss: 1.199, Test loss: 1.006, Test accuracy: 93.08
Round  71, Global train loss: 1.199, Global test loss: 0.981, Global test accuracy: 95.50
Round  72, Train loss: 1.197, Test loss: 1.028, Test accuracy: 91.44
Round  72, Global train loss: 1.197, Global test loss: 1.018, Global test accuracy: 92.18
Round  73, Train loss: 1.196, Test loss: 1.035, Test accuracy: 90.56
Round  73, Global train loss: 1.196, Global test loss: 1.023, Global test accuracy: 91.62
Round  74, Train loss: 1.174, Test loss: 1.039, Test accuracy: 90.22
Round  74, Global train loss: 1.174, Global test loss: 1.038, Global test accuracy: 90.16
Round  75, Train loss: 1.192, Test loss: 1.038, Test accuracy: 90.34
Round  75, Global train loss: 1.192, Global test loss: 1.047, Global test accuracy: 89.52
Round  76, Train loss: 1.170, Test loss: 1.054, Test accuracy: 88.84
Round  76, Global train loss: 1.170, Global test loss: 1.075, Global test accuracy: 85.76
Round  77, Train loss: 1.166, Test loss: 1.049, Test accuracy: 89.28
Round  77, Global train loss: 1.166, Global test loss: 1.027, Global test accuracy: 91.36
Round  78, Train loss: 1.166, Test loss: 1.039, Test accuracy: 89.72
Round  78, Global train loss: 1.166, Global test loss: 1.023, Global test accuracy: 91.10
Round  79, Train loss: 1.170, Test loss: 1.042, Test accuracy: 89.82
Round  79, Global train loss: 1.170, Global test loss: 1.029, Global test accuracy: 90.48
Round  80, Train loss: 1.209, Test loss: 1.033, Test accuracy: 90.14
Round  80, Global train loss: 1.209, Global test loss: 1.019, Global test accuracy: 91.28
Round  81, Train loss: 1.102, Test loss: 1.004, Test accuracy: 92.38
Round  81, Global train loss: 1.102, Global test loss: 0.981, Global test accuracy: 94.52
Round  82, Train loss: 1.167, Test loss: 1.047, Test accuracy: 89.36
Round  82, Global train loss: 1.167, Global test loss: 1.031, Global test accuracy: 91.12
Round  83, Train loss: 1.171, Test loss: 1.032, Test accuracy: 90.68
Round  83, Global train loss: 1.171, Global test loss: 1.036, Global test accuracy: 89.70
Round  84, Train loss: 1.107, Test loss: 1.018, Test accuracy: 91.40
Round  84, Global train loss: 1.107, Global test loss: 0.999, Global test accuracy: 93.72
Round  85, Train loss: 1.030, Test loss: 0.994, Test accuracy: 93.24
Round  85, Global train loss: 1.030, Global test loss: 0.972, Global test accuracy: 95.42
Round  86, Train loss: 1.023, Test loss: 0.989, Test accuracy: 93.62
Round  86, Global train loss: 1.023, Global test loss: 0.971, Global test accuracy: 95.42
Round  87, Train loss: 1.130, Test loss: 1.010, Test accuracy: 92.30
Round  87, Global train loss: 1.130, Global test loss: 0.994, Global test accuracy: 94.52
Round  88, Train loss: 1.108, Test loss: 1.024, Test accuracy: 91.08
Round  88, Global train loss: 1.108, Global test loss: 1.008, Global test accuracy: 92.84
Round  89, Train loss: 1.143, Test loss: 1.052, Test accuracy: 88.94
Round  89, Global train loss: 1.143, Global test loss: 1.023, Global test accuracy: 91.94
Round  90, Train loss: 1.159, Test loss: 1.029, Test accuracy: 91.30
Round  90, Global train loss: 1.159, Global test loss: 1.014, Global test accuracy: 92.44/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.153, Test loss: 1.041, Test accuracy: 89.94
Round  91, Global train loss: 1.153, Global test loss: 1.026, Global test accuracy: 91.12
Round  92, Train loss: 1.155, Test loss: 1.046, Test accuracy: 89.08
Round  92, Global train loss: 1.155, Global test loss: 1.030, Global test accuracy: 90.70
Round  93, Train loss: 1.136, Test loss: 1.067, Test accuracy: 87.48
Round  93, Global train loss: 1.136, Global test loss: 1.050, Global test accuracy: 89.44
Round  94, Train loss: 1.123, Test loss: 1.077, Test accuracy: 87.16
Round  94, Global train loss: 1.123, Global test loss: 1.069, Global test accuracy: 86.92
Round  95, Train loss: 1.158, Test loss: 1.051, Test accuracy: 88.52
Round  95, Global train loss: 1.158, Global test loss: 1.025, Global test accuracy: 91.54
Round  96, Train loss: 1.084, Test loss: 1.037, Test accuracy: 89.66
Round  96, Global train loss: 1.084, Global test loss: 1.017, Global test accuracy: 91.96
Round  97, Train loss: 1.121, Test loss: 1.057, Test accuracy: 88.24
Round  97, Global train loss: 1.121, Global test loss: 1.063, Global test accuracy: 87.06
Round  98, Train loss: 1.136, Test loss: 1.047, Test accuracy: 89.06
Round  98, Global train loss: 1.136, Global test loss: 1.024, Global test accuracy: 91.34
Round  99, Train loss: 1.059, Test loss: 1.025, Test accuracy: 90.50
Round  99, Global train loss: 1.059, Global test loss: 1.016, Global test accuracy: 91.32
Final Round, Train loss: 1.097, Test loss: 1.026, Test accuracy: 90.08
Final Round, Global train loss: 1.097, Global test loss: 1.016, Global test accuracy: 91.32
Average accuracy final 10 rounds: 89.09400000000001
567.9089615345001
[1.160353422164917, 2.212409734725952, 3.2014808654785156, 4.208051443099976, 5.242439270019531, 6.241159677505493, 7.207604885101318, 8.165608167648315, 9.159248352050781, 10.150993824005127, 11.143661260604858, 12.116153478622437, 13.114433765411377, 14.11616849899292, 15.11528992652893, 16.10738968849182, 17.15637469291687, 18.16621971130371, 19.184805631637573, 20.222736835479736, 21.214407444000244, 22.263402462005615, 23.281978130340576, 24.325273513793945, 25.33302903175354, 26.32715129852295, 27.293726682662964, 28.2549786567688, 29.217295169830322, 30.14773917198181, 31.155016899108887, 32.16405940055847, 33.13263130187988, 34.10897612571716, 35.145044565200806, 36.09700345993042, 37.11267161369324, 38.1294686794281, 39.16662240028381, 40.18960523605347, 41.24344563484192, 42.205026626586914, 43.15886449813843, 44.102460622787476, 45.09130001068115, 46.03055930137634, 46.994744062423706, 47.939825773239136, 48.87469553947449, 49.797619104385376, 50.7300124168396, 51.690290212631226, 52.63555836677551, 53.59068465232849, 54.534419298172, 55.47430062294006, 56.4711480140686, 57.43632245063782, 58.37265586853027, 59.31553602218628, 60.277145862579346, 61.265460729599, 62.21702003479004, 63.15891242027283, 64.12978911399841, 65.14027667045593, 66.10296583175659, 67.06895565986633, 68.05277562141418, 69.03183054924011, 70.00018525123596, 70.95521402359009, 71.89216828346252, 72.85527610778809, 73.83737087249756, 74.80523705482483, 75.76997876167297, 76.77949929237366, 77.77936339378357, 78.74410939216614, 79.76564526557922, 80.7835807800293, 81.8068642616272, 82.7715802192688, 83.86617612838745, 84.79659056663513, 85.71801233291626, 86.64749073982239, 87.6281521320343, 88.62881636619568, 89.59865355491638, 90.59159350395203, 91.626131772995, 92.6343834400177, 93.64314889907837, 94.62152647972107, 95.58274936676025, 96.5334312915802, 97.47881293296814, 98.43053364753723, 99.99251389503479]
[37.1, 72.84, 76.98, 88.62, 90.6, 93.36, 94.34, 94.48, 95.24, 95.5, 95.68, 95.9, 95.6, 95.84, 96.04, 96.08, 96.3, 96.24, 96.58, 96.28, 96.4, 96.12, 96.32, 96.28, 96.4, 96.4, 96.52, 96.44, 96.2, 96.24, 96.38, 96.24, 96.44, 96.06, 96.16, 96.26, 96.44, 96.48, 96.48, 95.74, 95.38, 95.7, 95.7, 95.32, 95.48, 95.68, 95.0, 95.1, 95.02, 94.72, 94.9, 95.12, 95.12, 94.36, 94.0, 95.0, 94.52, 93.4, 94.44, 94.2, 92.92, 94.02, 93.78, 93.14, 92.7, 93.24, 92.96, 92.88, 91.58, 91.42, 93.4, 93.08, 91.44, 90.56, 90.22, 90.34, 88.84, 89.28, 89.72, 89.82, 90.14, 92.38, 89.36, 90.68, 91.4, 93.24, 93.62, 92.3, 91.08, 88.94, 91.3, 89.94, 89.08, 87.48, 87.16, 88.52, 89.66, 88.24, 89.06, 90.5, 90.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.625, Test loss: 1.599, Test accuracy: 20.12
Round   0, Global train loss: 1.625, Global test loss: 1.599, Global test accuracy: 20.04
Round   1, Train loss: 1.599, Test loss: 1.580, Test accuracy: 41.86
Round   1, Global train loss: 1.599, Global test loss: 1.580, Global test accuracy: 40.46
Round   2, Train loss: 1.580, Test loss: 1.532, Test accuracy: 71.00
Round   2, Global train loss: 1.580, Global test loss: 1.532, Global test accuracy: 72.48
Round   3, Train loss: 1.529, Test loss: 1.398, Test accuracy: 78.32
Round   3, Global train loss: 1.529, Global test loss: 1.396, Global test accuracy: 78.38
Round   4, Train loss: 1.432, Test loss: 1.220, Test accuracy: 88.64
Round   4, Global train loss: 1.432, Global test loss: 1.213, Global test accuracy: 89.72
Round   5, Train loss: 1.337, Test loss: 1.093, Test accuracy: 93.72
Round   5, Global train loss: 1.337, Global test loss: 1.086, Global test accuracy: 93.78
Round   6, Train loss: 1.291, Test loss: 1.044, Test accuracy: 94.76
Round   6, Global train loss: 1.291, Global test loss: 1.039, Global test accuracy: 95.06
Round   7, Train loss: 1.273, Test loss: 1.023, Test accuracy: 95.14
Round   7, Global train loss: 1.273, Global test loss: 1.019, Global test accuracy: 95.56
Round   8, Train loss: 1.264, Test loss: 1.012, Test accuracy: 95.52
Round   8, Global train loss: 1.264, Global test loss: 1.007, Global test accuracy: 95.80
Round   9, Train loss: 1.257, Test loss: 1.005, Test accuracy: 95.74
Round   9, Global train loss: 1.257, Global test loss: 1.000, Global test accuracy: 95.94
Round  10, Train loss: 1.274, Test loss: 1.003, Test accuracy: 95.84
Round  10, Global train loss: 1.274, Global test loss: 0.994, Global test accuracy: 96.02
Round  11, Train loss: 1.096, Test loss: 0.983, Test accuracy: 96.16
Round  11, Global train loss: 1.096, Global test loss: 0.982, Global test accuracy: 96.34
Round  12, Train loss: 1.028, Test loss: 0.980, Test accuracy: 96.44
Round  12, Global train loss: 1.028, Global test loss: 0.969, Global test accuracy: 96.28
Round  13, Train loss: 1.040, Test loss: 0.972, Test accuracy: 96.54
Round  13, Global train loss: 1.040, Global test loss: 0.965, Global test accuracy: 96.68
Round  14, Train loss: 1.069, Test loss: 0.970, Test accuracy: 96.44
Round  14, Global train loss: 1.069, Global test loss: 0.967, Global test accuracy: 96.62
Round  15, Train loss: 1.048, Test loss: 0.971, Test accuracy: 96.50
Round  15, Global train loss: 1.048, Global test loss: 0.965, Global test accuracy: 96.60
Round  16, Train loss: 1.075, Test loss: 0.968, Test accuracy: 96.58
Round  16, Global train loss: 1.075, Global test loss: 0.966, Global test accuracy: 96.64
Round  17, Train loss: 1.074, Test loss: 0.968, Test accuracy: 96.50
Round  17, Global train loss: 1.074, Global test loss: 0.965, Global test accuracy: 96.68
Round  18, Train loss: 1.031, Test loss: 0.965, Test accuracy: 96.68
Round  18, Global train loss: 1.031, Global test loss: 0.961, Global test accuracy: 96.86
Round  19, Train loss: 1.032, Test loss: 0.965, Test accuracy: 96.66
Round  19, Global train loss: 1.032, Global test loss: 0.959, Global test accuracy: 96.72
Round  20, Train loss: 1.038, Test loss: 0.963, Test accuracy: 96.82
Round  20, Global train loss: 1.038, Global test loss: 0.958, Global test accuracy: 96.88
Round  21, Train loss: 1.042, Test loss: 0.961, Test accuracy: 96.72
Round  21, Global train loss: 1.042, Global test loss: 0.962, Global test accuracy: 96.58
Round  22, Train loss: 1.000, Test loss: 0.960, Test accuracy: 96.72
Round  22, Global train loss: 1.000, Global test loss: 0.952, Global test accuracy: 96.92
Round  23, Train loss: 1.038, Test loss: 0.960, Test accuracy: 96.78
Round  23, Global train loss: 1.038, Global test loss: 0.956, Global test accuracy: 96.78
Round  24, Train loss: 1.068, Test loss: 0.960, Test accuracy: 96.78
Round  24, Global train loss: 1.068, Global test loss: 0.960, Global test accuracy: 96.74
Round  25, Train loss: 1.070, Test loss: 0.960, Test accuracy: 96.74
Round  25, Global train loss: 1.070, Global test loss: 0.960, Global test accuracy: 96.90
Round  26, Train loss: 1.027, Test loss: 0.959, Test accuracy: 96.86
Round  26, Global train loss: 1.027, Global test loss: 0.955, Global test accuracy: 97.08
Round  27, Train loss: 1.014, Test loss: 0.958, Test accuracy: 96.76
Round  27, Global train loss: 1.014, Global test loss: 0.952, Global test accuracy: 96.74
Round  28, Train loss: 1.028, Test loss: 0.958, Test accuracy: 96.62
Round  28, Global train loss: 1.028, Global test loss: 0.953, Global test accuracy: 96.72
Round  29, Train loss: 1.006, Test loss: 0.957, Test accuracy: 96.82
Round  29, Global train loss: 1.006, Global test loss: 0.951, Global test accuracy: 97.00
Round  30, Train loss: 1.048, Test loss: 0.955, Test accuracy: 96.94
Round  30, Global train loss: 1.048, Global test loss: 0.952, Global test accuracy: 96.94
Round  31, Train loss: 0.994, Test loss: 0.957, Test accuracy: 96.98
Round  31, Global train loss: 0.994, Global test loss: 0.949, Global test accuracy: 96.86
Round  32, Train loss: 1.065, Test loss: 0.956, Test accuracy: 96.72
Round  32, Global train loss: 1.065, Global test loss: 0.955, Global test accuracy: 96.86
Round  33, Train loss: 1.024, Test loss: 0.957, Test accuracy: 96.70
Round  33, Global train loss: 1.024, Global test loss: 0.952, Global test accuracy: 97.00
Round  34, Train loss: 0.993, Test loss: 0.955, Test accuracy: 96.74
Round  34, Global train loss: 0.993, Global test loss: 0.951, Global test accuracy: 97.10
Round  35, Train loss: 1.034, Test loss: 0.954, Test accuracy: 96.88
Round  35, Global train loss: 1.034, Global test loss: 0.950, Global test accuracy: 96.86
Round  36, Train loss: 1.043, Test loss: 0.954, Test accuracy: 96.84
Round  36, Global train loss: 1.043, Global test loss: 0.951, Global test accuracy: 96.94
Round  37, Train loss: 1.060, Test loss: 0.957, Test accuracy: 96.72
Round  37, Global train loss: 1.060, Global test loss: 0.954, Global test accuracy: 96.86
Round  38, Train loss: 1.035, Test loss: 0.957, Test accuracy: 96.66
Round  38, Global train loss: 1.035, Global test loss: 0.954, Global test accuracy: 96.80
Round  39, Train loss: 0.984, Test loss: 0.955, Test accuracy: 96.66
Round  39, Global train loss: 0.984, Global test loss: 0.951, Global test accuracy: 96.82
Round  40, Train loss: 0.985, Test loss: 0.953, Test accuracy: 96.84
Round  40, Global train loss: 0.985, Global test loss: 0.948, Global test accuracy: 96.92
Round  41, Train loss: 1.052, Test loss: 0.953, Test accuracy: 96.70
Round  41, Global train loss: 1.052, Global test loss: 0.951, Global test accuracy: 96.86
Round  42, Train loss: 1.019, Test loss: 0.955, Test accuracy: 96.58
Round  42, Global train loss: 1.019, Global test loss: 0.951, Global test accuracy: 96.68
Round  43, Train loss: 1.039, Test loss: 0.954, Test accuracy: 96.66
Round  43, Global train loss: 1.039, Global test loss: 0.952, Global test accuracy: 96.80
Round  44, Train loss: 1.057, Test loss: 0.955, Test accuracy: 96.66
Round  44, Global train loss: 1.057, Global test loss: 0.953, Global test accuracy: 96.72
Round  45, Train loss: 0.999, Test loss: 0.955, Test accuracy: 96.70
Round  45, Global train loss: 0.999, Global test loss: 0.947, Global test accuracy: 97.08
Round  46, Train loss: 1.013, Test loss: 0.953, Test accuracy: 96.64
Round  46, Global train loss: 1.013, Global test loss: 0.953, Global test accuracy: 96.66
Round  47, Train loss: 1.038, Test loss: 0.955, Test accuracy: 96.56
Round  47, Global train loss: 1.038, Global test loss: 0.952, Global test accuracy: 96.98
Round  48, Train loss: 0.995, Test loss: 0.953, Test accuracy: 96.82
Round  48, Global train loss: 0.995, Global test loss: 0.948, Global test accuracy: 97.18
Round  49, Train loss: 0.991, Test loss: 0.953, Test accuracy: 96.74
Round  49, Global train loss: 0.991, Global test loss: 0.947, Global test accuracy: 97.24
Round  50, Train loss: 1.066, Test loss: 0.953, Test accuracy: 96.68
Round  50, Global train loss: 1.066, Global test loss: 0.951, Global test accuracy: 96.98
Round  51, Train loss: 1.040, Test loss: 0.953, Test accuracy: 96.90
Round  51, Global train loss: 1.040, Global test loss: 0.952, Global test accuracy: 97.02
Round  52, Train loss: 1.024, Test loss: 0.955, Test accuracy: 96.66
Round  52, Global train loss: 1.024, Global test loss: 0.952, Global test accuracy: 96.64
Round  53, Train loss: 1.016, Test loss: 0.955, Test accuracy: 96.74
Round  53, Global train loss: 1.016, Global test loss: 0.949, Global test accuracy: 97.26
Round  54, Train loss: 1.029, Test loss: 0.956, Test accuracy: 96.44
Round  54, Global train loss: 1.029, Global test loss: 0.955, Global test accuracy: 96.56
Round  55, Train loss: 1.036, Test loss: 0.953, Test accuracy: 96.66
Round  55, Global train loss: 1.036, Global test loss: 0.950, Global test accuracy: 96.80
Round  56, Train loss: 0.997, Test loss: 0.956, Test accuracy: 96.36
Round  56, Global train loss: 0.997, Global test loss: 0.957, Global test accuracy: 96.08
Round  57, Train loss: 1.041, Test loss: 0.958, Test accuracy: 96.28
Round  57, Global train loss: 1.041, Global test loss: 0.954, Global test accuracy: 96.28
Round  58, Train loss: 1.026, Test loss: 0.956, Test accuracy: 96.36
Round  58, Global train loss: 1.026, Global test loss: 0.952, Global test accuracy: 97.02
Round  59, Train loss: 1.007, Test loss: 0.955, Test accuracy: 96.52
Round  59, Global train loss: 1.007, Global test loss: 0.949, Global test accuracy: 97.14
Round  60, Train loss: 1.040, Test loss: 0.957, Test accuracy: 96.34
Round  60, Global train loss: 1.040, Global test loss: 0.953, Global test accuracy: 96.70
Round  61, Train loss: 1.001, Test loss: 0.956, Test accuracy: 96.46
Round  61, Global train loss: 1.001, Global test loss: 0.957, Global test accuracy: 96.18
Round  62, Train loss: 1.046, Test loss: 0.960, Test accuracy: 96.20
Round  62, Global train loss: 1.046, Global test loss: 0.956, Global test accuracy: 96.86
Round  63, Train loss: 0.979, Test loss: 0.957, Test accuracy: 96.46
Round  63, Global train loss: 0.979, Global test loss: 0.951, Global test accuracy: 96.70
Round  64, Train loss: 1.024, Test loss: 0.960, Test accuracy: 96.28
Round  64, Global train loss: 1.024, Global test loss: 0.958, Global test accuracy: 96.12
Round  65, Train loss: 0.987, Test loss: 0.957, Test accuracy: 96.38
Round  65, Global train loss: 0.987, Global test loss: 0.948, Global test accuracy: 97.26
Round  66, Train loss: 1.024, Test loss: 0.955, Test accuracy: 96.38
Round  66, Global train loss: 1.024, Global test loss: 0.951, Global test accuracy: 96.50
Round  67, Train loss: 0.992, Test loss: 0.956, Test accuracy: 96.48
Round  67, Global train loss: 0.992, Global test loss: 0.948, Global test accuracy: 97.08
Round  68, Train loss: 0.999, Test loss: 0.959, Test accuracy: 96.14
Round  68, Global train loss: 0.999, Global test loss: 0.959, Global test accuracy: 95.98
Round  69, Train loss: 0.977, Test loss: 0.956, Test accuracy: 96.42
Round  69, Global train loss: 0.977, Global test loss: 0.951, Global test accuracy: 96.60
Round  70, Train loss: 1.026, Test loss: 0.954, Test accuracy: 96.44
Round  70, Global train loss: 1.026, Global test loss: 0.948, Global test accuracy: 97.16
Round  71, Train loss: 1.005, Test loss: 0.961, Test accuracy: 96.12
Round  71, Global train loss: 1.005, Global test loss: 0.952, Global test accuracy: 96.82
Round  72, Train loss: 1.015, Test loss: 0.961, Test accuracy: 95.98
Round  72, Global train loss: 1.015, Global test loss: 0.956, Global test accuracy: 96.06
Round  73, Train loss: 0.975, Test loss: 0.958, Test accuracy: 96.20
Round  73, Global train loss: 0.975, Global test loss: 0.951, Global test accuracy: 96.68
Round  74, Train loss: 1.034, Test loss: 0.965, Test accuracy: 95.92
Round  74, Global train loss: 1.034, Global test loss: 0.960, Global test accuracy: 96.06
Round  75, Train loss: 0.998, Test loss: 0.963, Test accuracy: 96.02
Round  75, Global train loss: 0.998, Global test loss: 0.961, Global test accuracy: 95.98
Round  76, Train loss: 1.003, Test loss: 0.962, Test accuracy: 96.02
Round  76, Global train loss: 1.003, Global test loss: 0.960, Global test accuracy: 95.60
Round  77, Train loss: 1.037, Test loss: 0.968, Test accuracy: 95.82
Round  77, Global train loss: 1.037, Global test loss: 0.960, Global test accuracy: 96.14
Round  78, Train loss: 1.026, Test loss: 0.971, Test accuracy: 95.44
Round  78, Global train loss: 1.026, Global test loss: 0.966, Global test accuracy: 95.66
Round  79, Train loss: 0.977, Test loss: 0.961, Test accuracy: 96.00
Round  79, Global train loss: 0.977, Global test loss: 0.953, Global test accuracy: 96.34
Round  80, Train loss: 0.937, Test loss: 0.959, Test accuracy: 96.00
Round  80, Global train loss: 0.937, Global test loss: 0.954, Global test accuracy: 96.28
Round  81, Train loss: 0.931, Test loss: 0.954, Test accuracy: 96.26
Round  81, Global train loss: 0.931, Global test loss: 0.949, Global test accuracy: 96.48
Round  82, Train loss: 0.929, Test loss: 0.952, Test accuracy: 96.30
Round  82, Global train loss: 0.929, Global test loss: 0.947, Global test accuracy: 96.52
Round  83, Train loss: 0.927, Test loss: 0.952, Test accuracy: 96.28
Round  83, Global train loss: 0.927, Global test loss: 0.947, Global test accuracy: 96.52
Round  84, Train loss: 0.925, Test loss: 0.950, Test accuracy: 96.42
Round  84, Global train loss: 0.925, Global test loss: 0.945, Global test accuracy: 96.66
Round  85, Train loss: 0.924, Test loss: 0.950, Test accuracy: 96.44
Round  85, Global train loss: 0.924, Global test loss: 0.946, Global test accuracy: 96.64
Round  86, Train loss: 0.923, Test loss: 0.950, Test accuracy: 96.46
Round  86, Global train loss: 0.923, Global test loss: 0.946, Global test accuracy: 96.52
Round  87, Train loss: 0.922, Test loss: 0.949, Test accuracy: 96.60
Round  87, Global train loss: 0.922, Global test loss: 0.944, Global test accuracy: 96.80
Round  88, Train loss: 0.921, Test loss: 0.948, Test accuracy: 96.76
Round  88, Global train loss: 0.921, Global test loss: 0.944, Global test accuracy: 96.84
Round  89, Train loss: 0.920, Test loss: 0.948, Test accuracy: 96.82
Round  89, Global train loss: 0.920, Global test loss: 0.944, Global test accuracy: 96.78
Round  90, Train loss: 0.920, Test loss: 0.948, Test accuracy: 96.86
Round  90, Global train loss: 0.920, Global test loss: 0.943, Global test accuracy: 97.00/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 0.919, Test loss: 0.948, Test accuracy: 96.76
Round  91, Global train loss: 0.919, Global test loss: 0.943, Global test accuracy: 96.98
Round  92, Train loss: 0.918, Test loss: 0.948, Test accuracy: 96.78
Round  92, Global train loss: 0.918, Global test loss: 0.944, Global test accuracy: 96.88
Round  93, Train loss: 0.917, Test loss: 0.947, Test accuracy: 96.94
Round  93, Global train loss: 0.917, Global test loss: 0.943, Global test accuracy: 96.98
Round  94, Train loss: 0.917, Test loss: 0.947, Test accuracy: 96.88
Round  94, Global train loss: 0.917, Global test loss: 0.943, Global test accuracy: 97.12
Round  95, Train loss: 0.916, Test loss: 0.947, Test accuracy: 96.86
Round  95, Global train loss: 0.916, Global test loss: 0.943, Global test accuracy: 97.02
Round  96, Train loss: 0.916, Test loss: 0.947, Test accuracy: 96.96
Round  96, Global train loss: 0.916, Global test loss: 0.942, Global test accuracy: 97.20
Round  97, Train loss: 0.915, Test loss: 0.947, Test accuracy: 96.94
Round  97, Global train loss: 0.915, Global test loss: 0.942, Global test accuracy: 97.16
Round  98, Train loss: 0.915, Test loss: 0.947, Test accuracy: 96.84
Round  98, Global train loss: 0.915, Global test loss: 0.943, Global test accuracy: 97.04
Round  99, Train loss: 1.003, Test loss: 0.949, Test accuracy: 96.72
Round  99, Global train loss: 1.003, Global test loss: 0.942, Global test accuracy: 97.30
Final Round, Train loss: 1.159, Test loss: 0.957, Test accuracy: 96.14
Final Round, Global train loss: 1.159, Global test loss: 0.942, Global test accuracy: 97.30
Average accuracy final 10 rounds: 96.854
1806.228101491928
[1.2988336086273193, 2.461510419845581, 3.7250924110412598, 4.847908020019531, 6.075969457626343, 7.304618835449219, 8.454396963119507, 9.631195783615112, 10.841752529144287, 12.104927778244019, 16.127950429916382, 23.377708673477173, 30.42569065093994, 37.536301136016846, 44.803292989730835, 52.393386125564575, 59.81764888763428, 67.24151372909546, 74.61161470413208, 81.8834400177002, 89.17639970779419, 96.836989402771, 103.94482898712158, 111.40924191474915, 118.7190294265747, 126.00893902778625, 133.3189685344696, 140.83319187164307, 148.26198840141296, 155.86516404151917, 163.4213228225708, 171.2763707637787, 178.75631260871887, 186.1265778541565, 193.4214060306549, 200.88650488853455, 208.3015217781067, 215.6199860572815, 223.0615837574005, 230.26165914535522, 237.73256731033325, 245.4939272403717, 252.98316955566406, 260.2866551876068, 267.58729910850525, 275.14173436164856, 282.5504803657532, 289.8492488861084, 297.640100479126, 304.9679307937622, 312.3870542049408, 319.7215008735657, 327.4853756427765, 334.8989336490631, 342.42200994491577, 349.99775767326355, 357.6679515838623, 365.20511269569397, 372.6814811229706, 380.1833758354187, 387.778382062912, 394.7495319843292, 402.2720913887024, 409.6721315383911, 417.0759997367859, 424.57946705818176, 432.04227566719055, 439.3287763595581, 446.7300248146057, 453.9806020259857, 461.4571886062622, 468.6153733730316, 475.4951732158661, 482.2550837993622, 488.97835326194763, 495.5409736633301, 502.3323247432709, 509.22502851486206, 516.1832513809204, 523.0879800319672, 524.3446133136749, 525.5209250450134, 526.6510438919067, 527.8413343429565, 529.0310430526733, 530.1146442890167, 531.257984161377, 532.3656141757965, 533.4476366043091, 534.5314619541168, 535.5664043426514, 536.6825919151306, 537.8536992073059, 538.977924823761, 540.0988276004791, 541.223158121109, 542.3119325637817, 543.4218292236328, 544.5245788097382, 551.7698047161102, 558.5268604755402]
[20.12, 41.86, 71.0, 78.32, 88.64, 93.72, 94.76, 95.14, 95.52, 95.74, 95.84, 96.16, 96.44, 96.54, 96.44, 96.5, 96.58, 96.5, 96.68, 96.66, 96.82, 96.72, 96.72, 96.78, 96.78, 96.74, 96.86, 96.76, 96.62, 96.82, 96.94, 96.98, 96.72, 96.7, 96.74, 96.88, 96.84, 96.72, 96.66, 96.66, 96.84, 96.7, 96.58, 96.66, 96.66, 96.7, 96.64, 96.56, 96.82, 96.74, 96.68, 96.9, 96.66, 96.74, 96.44, 96.66, 96.36, 96.28, 96.36, 96.52, 96.34, 96.46, 96.2, 96.46, 96.28, 96.38, 96.38, 96.48, 96.14, 96.42, 96.44, 96.12, 95.98, 96.2, 95.92, 96.02, 96.02, 95.82, 95.44, 96.0, 96.0, 96.26, 96.3, 96.28, 96.42, 96.44, 96.46, 96.6, 96.76, 96.82, 96.86, 96.76, 96.78, 96.94, 96.88, 96.86, 96.96, 96.94, 96.84, 96.72, 96.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 5, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.600, Test loss: 1.585, Test accuracy: 36.84
Round   0, Global train loss: 1.600, Global test loss: 1.588, Global test accuracy: 38.86
Round   1, Train loss: 1.545, Test loss: 1.512, Test accuracy: 54.58
Round   1, Global train loss: 1.545, Global test loss: 1.494, Global test accuracy: 70.38
Round   2, Train loss: 1.440, Test loss: 1.489, Test accuracy: 54.22
Round   2, Global train loss: 1.440, Global test loss: 1.468, Global test accuracy: 70.12
Round   3, Train loss: 1.577, Test loss: 1.464, Test accuracy: 56.06
Round   3, Global train loss: 1.577, Global test loss: 1.441, Global test accuracy: 79.80
Round   4, Train loss: 1.425, Test loss: 1.463, Test accuracy: 55.22
Round   4, Global train loss: 1.425, Global test loss: 1.462, Global test accuracy: 74.72
Round   5, Train loss: 1.404, Test loss: 1.427, Test accuracy: 59.06
Round   5, Global train loss: 1.404, Global test loss: 1.318, Global test accuracy: 86.94
Round   6, Train loss: 1.469, Test loss: 1.360, Test accuracy: 63.92
Round   6, Global train loss: 1.469, Global test loss: 1.283, Global test accuracy: 87.90
Round   7, Train loss: 1.393, Test loss: 1.340, Test accuracy: 66.62
Round   7, Global train loss: 1.393, Global test loss: 1.272, Global test accuracy: 91.52
Round   8, Train loss: 1.355, Test loss: 1.311, Test accuracy: 64.34
Round   8, Global train loss: 1.355, Global test loss: 1.168, Global test accuracy: 81.64
Round   9, Train loss: 1.349, Test loss: 1.304, Test accuracy: 64.20
Round   9, Global train loss: 1.349, Global test loss: 1.121, Global test accuracy: 84.52
Round  10, Train loss: 1.533, Test loss: 1.305, Test accuracy: 67.44
Round  10, Global train loss: 1.533, Global test loss: 1.278, Global test accuracy: 91.50
Round  11, Train loss: 1.337, Test loss: 1.293, Test accuracy: 66.40
Round  11, Global train loss: 1.337, Global test loss: 1.110, Global test accuracy: 88.56
Round  12, Train loss: 1.540, Test loss: 1.286, Test accuracy: 66.94
Round  12, Global train loss: 1.540, Global test loss: 1.390, Global test accuracy: 73.34
Round  13, Train loss: 1.523, Test loss: 1.273, Test accuracy: 67.12
Round  13, Global train loss: 1.523, Global test loss: 1.363, Global test accuracy: 81.80
Round  14, Train loss: 1.504, Test loss: 1.274, Test accuracy: 66.18
Round  14, Global train loss: 1.504, Global test loss: 1.357, Global test accuracy: 71.28
Round  15, Train loss: 1.310, Test loss: 1.270, Test accuracy: 65.36
Round  15, Global train loss: 1.310, Global test loss: 1.094, Global test accuracy: 92.64
Round  16, Train loss: 1.453, Test loss: 1.273, Test accuracy: 64.80
Round  16, Global train loss: 1.453, Global test loss: 1.145, Global test accuracy: 88.90
Round  17, Train loss: 1.488, Test loss: 1.275, Test accuracy: 64.78
Round  17, Global train loss: 1.488, Global test loss: 1.269, Global test accuracy: 76.32
Round  18, Train loss: 1.444, Test loss: 1.277, Test accuracy: 64.10
Round  18, Global train loss: 1.444, Global test loss: 1.237, Global test accuracy: 79.80
Round  19, Train loss: 1.413, Test loss: 1.279, Test accuracy: 63.20
Round  19, Global train loss: 1.413, Global test loss: 1.259, Global test accuracy: 82.30
Round  20, Train loss: 1.396, Test loss: 1.290, Test accuracy: 61.22
Round  20, Global train loss: 1.396, Global test loss: 1.239, Global test accuracy: 81.32
Round  21, Train loss: 1.387, Test loss: 1.290, Test accuracy: 61.30
Round  21, Global train loss: 1.387, Global test loss: 1.200, Global test accuracy: 84.88
Round  22, Train loss: 1.168, Test loss: 1.290, Test accuracy: 61.38
Round  22, Global train loss: 1.168, Global test loss: 1.048, Global test accuracy: 88.32
Round  23, Train loss: 1.227, Test loss: 1.298, Test accuracy: 60.46
Round  23, Global train loss: 1.227, Global test loss: 1.036, Global test accuracy: 91.56
Round  24, Train loss: 1.308, Test loss: 1.304, Test accuracy: 59.56
Round  24, Global train loss: 1.308, Global test loss: 1.198, Global test accuracy: 75.40
Round  25, Train loss: 1.189, Test loss: 1.303, Test accuracy: 59.96
Round  25, Global train loss: 1.189, Global test loss: 1.074, Global test accuracy: 88.20
Round  26, Train loss: 1.313, Test loss: 1.303, Test accuracy: 59.44
Round  26, Global train loss: 1.313, Global test loss: 1.132, Global test accuracy: 83.22
Round  27, Train loss: 1.209, Test loss: 1.299, Test accuracy: 62.38
Round  27, Global train loss: 1.209, Global test loss: 1.082, Global test accuracy: 87.90
Round  28, Train loss: 1.277, Test loss: 1.308, Test accuracy: 61.38
Round  28, Global train loss: 1.277, Global test loss: 1.142, Global test accuracy: 80.68
Round  29, Train loss: 1.321, Test loss: 1.302, Test accuracy: 61.18
Round  29, Global train loss: 1.321, Global test loss: 1.277, Global test accuracy: 71.26
Round  30, Train loss: 1.354, Test loss: 1.303, Test accuracy: 60.46
Round  30, Global train loss: 1.354, Global test loss: 1.179, Global test accuracy: 76.70
Round  31, Train loss: 1.348, Test loss: 1.307, Test accuracy: 59.84
Round  31, Global train loss: 1.348, Global test loss: 1.214, Global test accuracy: 75.04
Round  32, Train loss: 1.157, Test loss: 1.309, Test accuracy: 59.36
Round  32, Global train loss: 1.157, Global test loss: 1.178, Global test accuracy: 75.32
Round  33, Train loss: 1.083, Test loss: 1.312, Test accuracy: 59.26
Round  33, Global train loss: 1.083, Global test loss: 1.026, Global test accuracy: 89.96
Round  34, Train loss: 1.190, Test loss: 1.314, Test accuracy: 59.02
Round  34, Global train loss: 1.190, Global test loss: 1.052, Global test accuracy: 87.70
Round  35, Train loss: 1.258, Test loss: 1.320, Test accuracy: 57.86
Round  35, Global train loss: 1.258, Global test loss: 1.217, Global test accuracy: 70.10
Round  36, Train loss: 1.104, Test loss: 1.325, Test accuracy: 57.32
Round  36, Global train loss: 1.104, Global test loss: 0.994, Global test accuracy: 93.74
Round  37, Train loss: 1.199, Test loss: 1.322, Test accuracy: 57.50
Round  37, Global train loss: 1.199, Global test loss: 1.249, Global test accuracy: 66.14
Round  38, Train loss: 1.188, Test loss: 1.324, Test accuracy: 57.18
Round  38, Global train loss: 1.188, Global test loss: 1.149, Global test accuracy: 81.46
Round  39, Train loss: 1.156, Test loss: 1.321, Test accuracy: 57.62
Round  39, Global train loss: 1.156, Global test loss: 1.049, Global test accuracy: 87.04
Round  40, Train loss: 1.213, Test loss: 1.327, Test accuracy: 56.86
Round  40, Global train loss: 1.213, Global test loss: 1.187, Global test accuracy: 75.60
Round  41, Train loss: 1.221, Test loss: 1.334, Test accuracy: 56.22
Round  41, Global train loss: 1.221, Global test loss: 1.196, Global test accuracy: 75.48
Round  42, Train loss: 1.161, Test loss: 1.330, Test accuracy: 56.64
Round  42, Global train loss: 1.161, Global test loss: 1.141, Global test accuracy: 78.54
Round  43, Train loss: 1.158, Test loss: 1.334, Test accuracy: 56.02
Round  43, Global train loss: 1.158, Global test loss: 1.135, Global test accuracy: 78.12
Round  44, Train loss: 1.078, Test loss: 1.335, Test accuracy: 55.98
Round  44, Global train loss: 1.078, Global test loss: 1.010, Global test accuracy: 92.22
Round  45, Train loss: 1.056, Test loss: 1.333, Test accuracy: 56.14
Round  45, Global train loss: 1.056, Global test loss: 0.995, Global test accuracy: 92.82
Round  46, Train loss: 1.091, Test loss: 1.334, Test accuracy: 55.82
Round  46, Global train loss: 1.091, Global test loss: 1.018, Global test accuracy: 90.66
Round  47, Train loss: 1.115, Test loss: 1.336, Test accuracy: 55.58
Round  47, Global train loss: 1.115, Global test loss: 1.177, Global test accuracy: 75.10
Round  48, Train loss: 1.172, Test loss: 1.340, Test accuracy: 54.92
Round  48, Global train loss: 1.172, Global test loss: 1.207, Global test accuracy: 71.90
Round  49, Train loss: 1.155, Test loss: 1.338, Test accuracy: 55.40
Round  49, Global train loss: 1.155, Global test loss: 1.225, Global test accuracy: 71.06
Round  50, Train loss: 1.123, Test loss: 1.337, Test accuracy: 55.62
Round  50, Global train loss: 1.123, Global test loss: 1.150, Global test accuracy: 76.90
Round  51, Train loss: 0.971, Test loss: 1.334, Test accuracy: 55.78
Round  51, Global train loss: 0.971, Global test loss: 0.973, Global test accuracy: 94.18
Round  52, Train loss: 1.049, Test loss: 1.331, Test accuracy: 56.00
Round  52, Global train loss: 1.049, Global test loss: 1.023, Global test accuracy: 90.20
Round  53, Train loss: 1.073, Test loss: 1.336, Test accuracy: 55.50
Round  53, Global train loss: 1.073, Global test loss: 1.041, Global test accuracy: 87.26
Round  54, Train loss: 1.031, Test loss: 1.338, Test accuracy: 55.02
Round  54, Global train loss: 1.031, Global test loss: 0.984, Global test accuracy: 93.24
Round  55, Train loss: 1.042, Test loss: 1.337, Test accuracy: 55.00
Round  55, Global train loss: 1.042, Global test loss: 1.002, Global test accuracy: 91.60
Round  56, Train loss: 1.128, Test loss: 1.345, Test accuracy: 54.20
Round  56, Global train loss: 1.128, Global test loss: 1.206, Global test accuracy: 71.00
Round  57, Train loss: 1.072, Test loss: 1.355, Test accuracy: 53.02
Round  57, Global train loss: 1.072, Global test loss: 1.020, Global test accuracy: 89.50
Round  58, Train loss: 1.081, Test loss: 1.349, Test accuracy: 53.90
Round  58, Global train loss: 1.081, Global test loss: 1.043, Global test accuracy: 87.40
Round  59, Train loss: 0.971, Test loss: 1.349, Test accuracy: 53.64
Round  59, Global train loss: 0.971, Global test loss: 0.976, Global test accuracy: 93.76
Round  60, Train loss: 0.988, Test loss: 1.355, Test accuracy: 53.16
Round  60, Global train loss: 0.988, Global test loss: 0.995, Global test accuracy: 92.48
Round  61, Train loss: 1.018, Test loss: 1.359, Test accuracy: 52.92
Round  61, Global train loss: 1.018, Global test loss: 0.994, Global test accuracy: 91.78
Round  62, Train loss: 1.113, Test loss: 1.359, Test accuracy: 52.74
Round  62, Global train loss: 1.113, Global test loss: 1.128, Global test accuracy: 78.70
Round  63, Train loss: 1.020, Test loss: 1.355, Test accuracy: 53.16
Round  63, Global train loss: 1.020, Global test loss: 1.197, Global test accuracy: 73.12
Round  64, Train loss: 1.104, Test loss: 1.354, Test accuracy: 53.08
Round  64, Global train loss: 1.104, Global test loss: 1.153, Global test accuracy: 76.46
Round  65, Train loss: 1.083, Test loss: 1.356, Test accuracy: 52.84
Round  65, Global train loss: 1.083, Global test loss: 1.144, Global test accuracy: 78.54
Round  66, Train loss: 0.993, Test loss: 1.357, Test accuracy: 52.66
Round  66, Global train loss: 0.993, Global test loss: 1.012, Global test accuracy: 90.18
Round  67, Train loss: 1.033, Test loss: 1.359, Test accuracy: 52.52
Round  67, Global train loss: 1.033, Global test loss: 1.182, Global test accuracy: 73.56
Round  68, Train loss: 1.073, Test loss: 1.359, Test accuracy: 52.50
Round  68, Global train loss: 1.073, Global test loss: 1.102, Global test accuracy: 82.50
Round  69, Train loss: 1.023, Test loss: 1.362, Test accuracy: 52.50
Round  69, Global train loss: 1.023, Global test loss: 1.021, Global test accuracy: 89.68
Round  70, Train loss: 0.998, Test loss: 1.361, Test accuracy: 52.84
Round  70, Global train loss: 0.998, Global test loss: 0.983, Global test accuracy: 93.30
Round  71, Train loss: 1.017, Test loss: 1.357, Test accuracy: 52.98
Round  71, Global train loss: 1.017, Global test loss: 1.018, Global test accuracy: 89.96
Round  72, Train loss: 0.989, Test loss: 1.357, Test accuracy: 53.06
Round  72, Global train loss: 0.989, Global test loss: 1.011, Global test accuracy: 90.46
Round  73, Train loss: 1.064, Test loss: 1.352, Test accuracy: 53.80
Round  73, Global train loss: 1.064, Global test loss: 1.147, Global test accuracy: 77.24
Round  74, Train loss: 1.065, Test loss: 1.354, Test accuracy: 53.60
Round  74, Global train loss: 1.065, Global test loss: 1.206, Global test accuracy: 70.82
Round  75, Train loss: 1.023, Test loss: 1.355, Test accuracy: 53.42
Round  75, Global train loss: 1.023, Global test loss: 1.041, Global test accuracy: 87.78
Round  76, Train loss: 1.050, Test loss: 1.357, Test accuracy: 53.10
Round  76, Global train loss: 1.050, Global test loss: 1.178, Global test accuracy: 74.24
Round  77, Train loss: 0.975, Test loss: 1.357, Test accuracy: 53.06
Round  77, Global train loss: 0.975, Global test loss: 0.981, Global test accuracy: 93.16
Round  78, Train loss: 1.046, Test loss: 1.359, Test accuracy: 52.86
Round  78, Global train loss: 1.046, Global test loss: 1.001, Global test accuracy: 91.20
Round  79, Train loss: 0.977, Test loss: 1.360, Test accuracy: 52.90
Round  79, Global train loss: 0.977, Global test loss: 0.992, Global test accuracy: 92.02
Round  80, Train loss: 1.054, Test loss: 1.358, Test accuracy: 52.90
Round  80, Global train loss: 1.054, Global test loss: 1.177, Global test accuracy: 73.76
Round  81, Train loss: 1.041, Test loss: 1.358, Test accuracy: 52.90
Round  81, Global train loss: 1.041, Global test loss: 1.172, Global test accuracy: 74.54
Round  82, Train loss: 0.995, Test loss: 1.358, Test accuracy: 53.02
Round  82, Global train loss: 0.995, Global test loss: 0.981, Global test accuracy: 93.48
Round  83, Train loss: 1.103, Test loss: 1.358, Test accuracy: 52.98
Round  83, Global train loss: 1.103, Global test loss: 1.161, Global test accuracy: 75.26
Round  84, Train loss: 1.003, Test loss: 1.358, Test accuracy: 52.96
Round  84, Global train loss: 1.003, Global test loss: 1.214, Global test accuracy: 70.08
Round  85, Train loss: 1.070, Test loss: 1.360, Test accuracy: 52.82
Round  85, Global train loss: 1.070, Global test loss: 1.183, Global test accuracy: 72.68
Round  86, Train loss: 1.088, Test loss: 1.361, Test accuracy: 52.76
Round  86, Global train loss: 1.088, Global test loss: 1.137, Global test accuracy: 77.12
Round  87, Train loss: 1.074, Test loss: 1.361, Test accuracy: 52.92
Round  87, Global train loss: 1.074, Global test loss: 1.133, Global test accuracy: 78.58
Round  88, Train loss: 1.071, Test loss: 1.362, Test accuracy: 52.74
Round  88, Global train loss: 1.071, Global test loss: 1.159, Global test accuracy: 75.26
Round  89, Train loss: 1.096, Test loss: 1.360, Test accuracy: 52.96
Round  89, Global train loss: 1.096, Global test loss: 1.157, Global test accuracy: 75.74
Round  90, Train loss: 1.088, Test loss: 1.362, Test accuracy: 52.80
Round  90, Global train loss: 1.088, Global test loss: 1.189, Global test accuracy: 71.82
Round  91, Train loss: 1.065, Test loss: 1.362, Test accuracy: 52.74
Round  91, Global train loss: 1.065, Global test loss: 1.200, Global test accuracy: 70.64
Round  92, Train loss: 0.984, Test loss: 1.364, Test accuracy: 52.46
Round  92, Global train loss: 0.984, Global test loss: 0.988, Global test accuracy: 92.22
Round  93, Train loss: 1.039, Test loss: 1.363, Test accuracy: 52.62
Round  93, Global train loss: 1.039, Global test loss: 1.158, Global test accuracy: 76.10/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.006, Test loss: 1.360, Test accuracy: 52.86
Round  94, Global train loss: 1.006, Global test loss: 0.961, Global test accuracy: 94.84
Round  95, Train loss: 0.978, Test loss: 1.362, Test accuracy: 52.76
Round  95, Global train loss: 0.978, Global test loss: 1.022, Global test accuracy: 89.02
Round  96, Train loss: 1.009, Test loss: 1.363, Test accuracy: 52.62
Round  96, Global train loss: 1.009, Global test loss: 1.125, Global test accuracy: 79.92
Round  97, Train loss: 1.014, Test loss: 1.364, Test accuracy: 52.44
Round  97, Global train loss: 1.014, Global test loss: 1.012, Global test accuracy: 90.38
Round  98, Train loss: 1.041, Test loss: 1.363, Test accuracy: 52.66
Round  98, Global train loss: 1.041, Global test loss: 1.210, Global test accuracy: 69.68
Round  99, Train loss: 0.972, Test loss: 1.364, Test accuracy: 52.50
Round  99, Global train loss: 0.972, Global test loss: 0.991, Global test accuracy: 92.14
Final Round, Train loss: 1.021, Test loss: 1.363, Test accuracy: 52.44
Final Round, Global train loss: 1.021, Global test loss: 0.991, Global test accuracy: 92.14
Average accuracy final 10 rounds: 52.645999999999994 

Average global accuracy final 10 rounds: 82.676 

652.3422558307648
[0.9656939506530762, 1.9313879013061523, 2.700361490249634, 3.4693350791931152, 4.215700626373291, 4.962066173553467, 5.675648212432861, 6.389230251312256, 7.11122727394104, 7.833224296569824, 8.572562217712402, 9.31190013885498, 10.030340909957886, 10.748781681060791, 11.568754434585571, 12.388727188110352, 13.208019495010376, 14.0273118019104, 14.852302074432373, 15.677292346954346, 16.501139163970947, 17.32498598098755, 18.178988218307495, 19.03299045562744, 19.852559089660645, 20.672127723693848, 21.477943420410156, 22.283759117126465, 23.156944036483765, 24.030128955841064, 24.874061584472656, 25.717994213104248, 26.479843139648438, 27.241692066192627, 28.00348401069641, 28.765275955200195, 29.598669052124023, 30.43206214904785, 31.25213599205017, 32.07220983505249, 32.800671339035034, 33.52913284301758, 34.275635957717896, 35.02213907241821, 35.80012035369873, 36.57810163497925, 37.34380102157593, 38.10950040817261, 38.925307512283325, 39.74111461639404, 40.60879445075989, 41.47647428512573, 42.27197051048279, 43.067466735839844, 43.83984088897705, 44.61221504211426, 45.42092680931091, 46.22963857650757, 47.056740283966064, 47.88384199142456, 48.70528817176819, 49.526734352111816, 50.36714005470276, 51.2075457572937, 52.05359864234924, 52.899651527404785, 53.65013360977173, 54.40061569213867, 55.24248480796814, 56.08435392379761, 56.88800311088562, 57.69165229797363, 58.530089139938354, 59.368525981903076, 60.19157671928406, 61.01462745666504, 61.84837460517883, 62.68212175369263, 63.51120209693909, 64.34028244018555, 65.18619227409363, 66.03210210800171, 66.80195927619934, 67.57181644439697, 68.4358766078949, 69.29993677139282, 70.06220507621765, 70.82447338104248, 71.57908940315247, 72.33370542526245, 73.09174466133118, 73.8497838973999, 74.6870322227478, 75.5242805480957, 76.34372472763062, 77.16316890716553, 77.92422771453857, 78.68528652191162, 79.45312356948853, 80.22096061706543, 80.9688732624054, 81.71678590774536, 82.46890759468079, 83.22102928161621, 83.96558022499084, 84.71013116836548, 85.48707604408264, 86.2640209197998, 87.0693769454956, 87.8747329711914, 88.63428449630737, 89.39383602142334, 90.17215895652771, 90.95048189163208, 91.71292662620544, 92.47537136077881, 93.27168130874634, 94.06799125671387, 94.86682915687561, 95.66566705703735, 96.47922921180725, 97.29279136657715, 98.23821067810059, 99.18362998962402, 99.930823802948, 100.67801761627197, 101.44571304321289, 102.21340847015381, 102.98370504379272, 103.75400161743164, 104.54386472702026, 105.33372783660889, 106.14963674545288, 106.96554565429688, 107.74214315414429, 108.5187406539917, 109.33435130119324, 110.14996194839478, 110.93814778327942, 111.72633361816406, 112.5446126461029, 113.36289167404175, 114.20441317558289, 115.04593467712402, 115.79441428184509, 116.54289388656616, 117.35462713241577, 118.16636037826538, 118.88864421844482, 119.61092805862427, 120.3414511680603, 121.07197427749634, 121.89373731613159, 122.71550035476685, 123.50463199615479, 124.29376363754272, 125.12172532081604, 125.94968700408936, 126.78159832954407, 127.61350965499878, 128.44840836524963, 129.2833070755005, 130.06269884109497, 130.84209060668945, 131.61008191108704, 132.37807321548462, 133.16710996627808, 133.95614671707153, 134.71616077423096, 135.47617483139038, 136.22671270370483, 136.9772505760193, 137.74975562095642, 138.52226066589355, 139.3824782371521, 140.24269580841064, 141.0308814048767, 141.81906700134277, 142.571430683136, 143.3237943649292, 144.0378544330597, 144.75191450119019, 145.48194074630737, 146.21196699142456, 146.96917605400085, 147.72638511657715, 148.50226378440857, 149.27814245224, 150.12640357017517, 150.97466468811035, 151.7838225364685, 152.59298038482666, 153.63697385787964, 154.68096733093262, 155.76700639724731, 156.853045463562, 157.80123019218445, 158.74941492080688, 159.63663864135742, 160.52386236190796, 162.29652643203735, 164.06919050216675]
[36.84, 36.84, 54.58, 54.58, 54.22, 54.22, 56.06, 56.06, 55.22, 55.22, 59.06, 59.06, 63.92, 63.92, 66.62, 66.62, 64.34, 64.34, 64.2, 64.2, 67.44, 67.44, 66.4, 66.4, 66.94, 66.94, 67.12, 67.12, 66.18, 66.18, 65.36, 65.36, 64.8, 64.8, 64.78, 64.78, 64.1, 64.1, 63.2, 63.2, 61.22, 61.22, 61.3, 61.3, 61.38, 61.38, 60.46, 60.46, 59.56, 59.56, 59.96, 59.96, 59.44, 59.44, 62.38, 62.38, 61.38, 61.38, 61.18, 61.18, 60.46, 60.46, 59.84, 59.84, 59.36, 59.36, 59.26, 59.26, 59.02, 59.02, 57.86, 57.86, 57.32, 57.32, 57.5, 57.5, 57.18, 57.18, 57.62, 57.62, 56.86, 56.86, 56.22, 56.22, 56.64, 56.64, 56.02, 56.02, 55.98, 55.98, 56.14, 56.14, 55.82, 55.82, 55.58, 55.58, 54.92, 54.92, 55.4, 55.4, 55.62, 55.62, 55.78, 55.78, 56.0, 56.0, 55.5, 55.5, 55.02, 55.02, 55.0, 55.0, 54.2, 54.2, 53.02, 53.02, 53.9, 53.9, 53.64, 53.64, 53.16, 53.16, 52.92, 52.92, 52.74, 52.74, 53.16, 53.16, 53.08, 53.08, 52.84, 52.84, 52.66, 52.66, 52.52, 52.52, 52.5, 52.5, 52.5, 52.5, 52.84, 52.84, 52.98, 52.98, 53.06, 53.06, 53.8, 53.8, 53.6, 53.6, 53.42, 53.42, 53.1, 53.1, 53.06, 53.06, 52.86, 52.86, 52.9, 52.9, 52.9, 52.9, 52.9, 52.9, 53.02, 53.02, 52.98, 52.98, 52.96, 52.96, 52.82, 52.82, 52.76, 52.76, 52.92, 52.92, 52.74, 52.74, 52.96, 52.96, 52.8, 52.8, 52.74, 52.74, 52.46, 52.46, 52.62, 52.62, 52.86, 52.86, 52.76, 52.76, 52.62, 52.62, 52.44, 52.44, 52.66, 52.66, 52.5, 52.5, 52.44, 52.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.608, Test loss: 1.607, Test accuracy: 22.20
Round   0, Global train loss: 1.608, Global test loss: 1.607, Global test accuracy: 20.00
Round   1, Train loss: 1.606, Test loss: 1.604, Test accuracy: 23.62
Round   1, Global train loss: 1.606, Global test loss: 1.603, Global test accuracy: 20.00
Round   2, Train loss: 1.603, Test loss: 1.601, Test accuracy: 23.44
Round   2, Global train loss: 1.603, Global test loss: 1.599, Global test accuracy: 20.00
Round   3, Train loss: 1.585, Test loss: 1.571, Test accuracy: 34.42
Round   3, Global train loss: 1.585, Global test loss: 1.558, Global test accuracy: 53.36
Round   4, Train loss: 1.591, Test loss: 1.541, Test accuracy: 40.88
Round   4, Global train loss: 1.591, Global test loss: 1.522, Global test accuracy: 58.06
Round   5, Train loss: 1.479, Test loss: 1.480, Test accuracy: 47.18
Round   5, Global train loss: 1.479, Global test loss: 1.367, Global test accuracy: 69.42
Round   6, Train loss: 1.546, Test loss: 1.363, Test accuracy: 66.54
Round   6, Global train loss: 1.546, Global test loss: 1.267, Global test accuracy: 84.52
Round   7, Train loss: 1.563, Test loss: 1.323, Test accuracy: 71.62
Round   7, Global train loss: 1.563, Global test loss: 1.280, Global test accuracy: 84.26
Round   8, Train loss: 1.404, Test loss: 1.283, Test accuracy: 73.42
Round   8, Global train loss: 1.404, Global test loss: 1.153, Global test accuracy: 86.62
Round   9, Train loss: 1.388, Test loss: 1.278, Test accuracy: 72.88
Round   9, Global train loss: 1.388, Global test loss: 1.117, Global test accuracy: 84.94
Round  10, Train loss: 1.541, Test loss: 1.271, Test accuracy: 72.90
Round  10, Global train loss: 1.541, Global test loss: 1.162, Global test accuracy: 82.98
Round  11, Train loss: 1.186, Test loss: 1.238, Test accuracy: 74.28
Round  11, Global train loss: 1.186, Global test loss: 1.010, Global test accuracy: 92.56
Round  12, Train loss: 1.377, Test loss: 1.196, Test accuracy: 78.08
Round  12, Global train loss: 1.377, Global test loss: 1.043, Global test accuracy: 92.40
Round  13, Train loss: 1.530, Test loss: 1.189, Test accuracy: 76.86
Round  13, Global train loss: 1.530, Global test loss: 1.072, Global test accuracy: 87.90
Round  14, Train loss: 1.179, Test loss: 1.139, Test accuracy: 79.32
Round  14, Global train loss: 1.179, Global test loss: 0.999, Global test accuracy: 92.44
Round  15, Train loss: 1.527, Test loss: 1.135, Test accuracy: 79.46
Round  15, Global train loss: 1.527, Global test loss: 1.077, Global test accuracy: 88.16
Round  16, Train loss: 1.337, Test loss: 1.145, Test accuracy: 78.00
Round  16, Global train loss: 1.337, Global test loss: 1.032, Global test accuracy: 90.36
Round  17, Train loss: 1.497, Test loss: 1.150, Test accuracy: 77.40
Round  17, Global train loss: 1.497, Global test loss: 1.066, Global test accuracy: 87.00
Round  18, Train loss: 1.322, Test loss: 1.154, Test accuracy: 77.10
Round  18, Global train loss: 1.322, Global test loss: 1.015, Global test accuracy: 92.22
Round  19, Train loss: 1.167, Test loss: 1.155, Test accuracy: 77.00
Round  19, Global train loss: 1.167, Global test loss: 0.983, Global test accuracy: 94.18
Round  20, Train loss: 1.311, Test loss: 1.145, Test accuracy: 78.12
Round  20, Global train loss: 1.311, Global test loss: 1.021, Global test accuracy: 91.18
Round  21, Train loss: 1.477, Test loss: 1.154, Test accuracy: 76.90
Round  21, Global train loss: 1.477, Global test loss: 1.087, Global test accuracy: 84.42
Round  22, Train loss: 1.147, Test loss: 1.155, Test accuracy: 76.84
Round  22, Global train loss: 1.147, Global test loss: 0.989, Global test accuracy: 93.12
Round  23, Train loss: 1.467, Test loss: 1.154, Test accuracy: 76.66
Round  23, Global train loss: 1.467, Global test loss: 1.082, Global test accuracy: 83.76
Round  24, Train loss: 1.305, Test loss: 1.158, Test accuracy: 76.16
Round  24, Global train loss: 1.305, Global test loss: 1.058, Global test accuracy: 86.82
Round  25, Train loss: 1.481, Test loss: 1.174, Test accuracy: 73.46
Round  25, Global train loss: 1.481, Global test loss: 1.151, Global test accuracy: 77.10
Round  26, Train loss: 1.291, Test loss: 1.179, Test accuracy: 73.00
Round  26, Global train loss: 1.291, Global test loss: 1.043, Global test accuracy: 88.68
Round  27, Train loss: 1.443, Test loss: 1.169, Test accuracy: 74.30
Round  27, Global train loss: 1.443, Global test loss: 1.044, Global test accuracy: 87.70
Round  28, Train loss: 1.277, Test loss: 1.167, Test accuracy: 74.48
Round  28, Global train loss: 1.277, Global test loss: 1.059, Global test accuracy: 86.80
Round  29, Train loss: 1.444, Test loss: 1.179, Test accuracy: 72.88
Round  29, Global train loss: 1.444, Global test loss: 1.113, Global test accuracy: 81.24
Round  30, Train loss: 1.434, Test loss: 1.179, Test accuracy: 72.84
Round  30, Global train loss: 1.434, Global test loss: 1.174, Global test accuracy: 74.34
Round  31, Train loss: 1.427, Test loss: 1.184, Test accuracy: 72.30
Round  31, Global train loss: 1.427, Global test loss: 1.195, Global test accuracy: 73.14
Round  32, Train loss: 1.237, Test loss: 1.180, Test accuracy: 72.78
Round  32, Global train loss: 1.237, Global test loss: 1.065, Global test accuracy: 85.88
Round  33, Train loss: 1.398, Test loss: 1.196, Test accuracy: 71.10
Round  33, Global train loss: 1.398, Global test loss: 1.247, Global test accuracy: 66.66
Round  34, Train loss: 1.419, Test loss: 1.215, Test accuracy: 68.96
Round  34, Global train loss: 1.419, Global test loss: 1.264, Global test accuracy: 64.06
Round  35, Train loss: 1.397, Test loss: 1.227, Test accuracy: 67.44
Round  35, Global train loss: 1.397, Global test loss: 1.199, Global test accuracy: 71.94
Round  36, Train loss: 1.392, Test loss: 1.233, Test accuracy: 66.70
Round  36, Global train loss: 1.392, Global test loss: 1.183, Global test accuracy: 74.00
Round  37, Train loss: 1.224, Test loss: 1.236, Test accuracy: 66.42
Round  37, Global train loss: 1.224, Global test loss: 1.046, Global test accuracy: 87.58
Round  38, Train loss: 1.377, Test loss: 1.255, Test accuracy: 64.06
Round  38, Global train loss: 1.377, Global test loss: 1.205, Global test accuracy: 71.64
Round  39, Train loss: 1.379, Test loss: 1.250, Test accuracy: 64.70
Round  39, Global train loss: 1.379, Global test loss: 1.245, Global test accuracy: 66.42
Round  40, Train loss: 1.364, Test loss: 1.246, Test accuracy: 65.50
Round  40, Global train loss: 1.364, Global test loss: 1.235, Global test accuracy: 67.28
Round  41, Train loss: 1.355, Test loss: 1.254, Test accuracy: 64.36
Round  41, Global train loss: 1.355, Global test loss: 1.209, Global test accuracy: 70.42
Round  42, Train loss: 1.333, Test loss: 1.260, Test accuracy: 63.84
Round  42, Global train loss: 1.333, Global test loss: 1.271, Global test accuracy: 63.30
Round  43, Train loss: 1.189, Test loss: 1.266, Test accuracy: 63.00
Round  43, Global train loss: 1.189, Global test loss: 1.099, Global test accuracy: 82.00
Round  44, Train loss: 1.251, Test loss: 1.268, Test accuracy: 62.80
Round  44, Global train loss: 1.251, Global test loss: 1.070, Global test accuracy: 84.34
Round  45, Train loss: 1.347, Test loss: 1.268, Test accuracy: 62.74
Round  45, Global train loss: 1.347, Global test loss: 1.206, Global test accuracy: 70.86
Round  46, Train loss: 1.222, Test loss: 1.279, Test accuracy: 61.64
Round  46, Global train loss: 1.222, Global test loss: 1.123, Global test accuracy: 78.90
Round  47, Train loss: 1.175, Test loss: 1.278, Test accuracy: 61.68
Round  47, Global train loss: 1.175, Global test loss: 1.099, Global test accuracy: 81.08
Round  48, Train loss: 1.327, Test loss: 1.275, Test accuracy: 62.06
Round  48, Global train loss: 1.327, Global test loss: 1.276, Global test accuracy: 62.96
Round  49, Train loss: 1.195, Test loss: 1.286, Test accuracy: 60.94
Round  49, Global train loss: 1.195, Global test loss: 1.137, Global test accuracy: 78.10
Round  50, Train loss: 1.168, Test loss: 1.274, Test accuracy: 62.34
Round  50, Global train loss: 1.168, Global test loss: 1.079, Global test accuracy: 83.34
Round  51, Train loss: 1.331, Test loss: 1.276, Test accuracy: 62.16
Round  51, Global train loss: 1.331, Global test loss: 1.219, Global test accuracy: 68.74
Round  52, Train loss: 1.336, Test loss: 1.283, Test accuracy: 61.46
Round  52, Global train loss: 1.336, Global test loss: 1.181, Global test accuracy: 72.88
Round  53, Train loss: 1.076, Test loss: 1.294, Test accuracy: 60.38
Round  53, Global train loss: 1.076, Global test loss: 1.029, Global test accuracy: 88.00
Round  54, Train loss: 1.309, Test loss: 1.303, Test accuracy: 59.24
Round  54, Global train loss: 1.309, Global test loss: 1.275, Global test accuracy: 63.44
Round  55, Train loss: 1.181, Test loss: 1.297, Test accuracy: 59.98
Round  55, Global train loss: 1.181, Global test loss: 1.136, Global test accuracy: 77.34
Round  56, Train loss: 1.155, Test loss: 1.293, Test accuracy: 60.26
Round  56, Global train loss: 1.155, Global test loss: 1.110, Global test accuracy: 80.40
Round  57, Train loss: 1.282, Test loss: 1.287, Test accuracy: 61.08
Round  57, Global train loss: 1.282, Global test loss: 1.210, Global test accuracy: 69.92
Round  58, Train loss: 1.266, Test loss: 1.286, Test accuracy: 61.00
Round  58, Global train loss: 1.266, Global test loss: 1.280, Global test accuracy: 62.28
Round  59, Train loss: 1.299, Test loss: 1.294, Test accuracy: 60.02
Round  59, Global train loss: 1.299, Global test loss: 1.261, Global test accuracy: 62.96
Round  60, Train loss: 1.274, Test loss: 1.295, Test accuracy: 59.88
Round  60, Global train loss: 1.274, Global test loss: 1.329, Global test accuracy: 56.16
Round  61, Train loss: 1.280, Test loss: 1.298, Test accuracy: 59.68
Round  61, Global train loss: 1.280, Global test loss: 1.250, Global test accuracy: 64.90
Round  62, Train loss: 1.138, Test loss: 1.300, Test accuracy: 59.38
Round  62, Global train loss: 1.138, Global test loss: 1.114, Global test accuracy: 79.38
Round  63, Train loss: 1.243, Test loss: 1.295, Test accuracy: 59.88
Round  63, Global train loss: 1.243, Global test loss: 1.328, Global test accuracy: 57.20
Round  64, Train loss: 1.213, Test loss: 1.312, Test accuracy: 57.86
Round  64, Global train loss: 1.213, Global test loss: 1.372, Global test accuracy: 52.46
Round  65, Train loss: 1.229, Test loss: 1.320, Test accuracy: 57.08
Round  65, Global train loss: 1.229, Global test loss: 1.306, Global test accuracy: 59.64
Round  66, Train loss: 1.263, Test loss: 1.326, Test accuracy: 56.34
Round  66, Global train loss: 1.263, Global test loss: 1.254, Global test accuracy: 64.44
Round  67, Train loss: 1.194, Test loss: 1.321, Test accuracy: 56.84
Round  67, Global train loss: 1.194, Global test loss: 1.403, Global test accuracy: 48.48
Round  68, Train loss: 1.217, Test loss: 1.324, Test accuracy: 56.50
Round  68, Global train loss: 1.217, Global test loss: 1.377, Global test accuracy: 51.64
Round  69, Train loss: 1.168, Test loss: 1.316, Test accuracy: 57.66
Round  69, Global train loss: 1.168, Global test loss: 1.146, Global test accuracy: 75.94
Round  70, Train loss: 1.234, Test loss: 1.321, Test accuracy: 56.88
Round  70, Global train loss: 1.234, Global test loss: 1.297, Global test accuracy: 60.50
Round  71, Train loss: 1.153, Test loss: 1.325, Test accuracy: 56.66
Round  71, Global train loss: 1.153, Global test loss: 1.181, Global test accuracy: 72.16
Round  72, Train loss: 1.236, Test loss: 1.321, Test accuracy: 57.24
Round  72, Global train loss: 1.236, Global test loss: 1.251, Global test accuracy: 65.30
Round  73, Train loss: 1.104, Test loss: 1.312, Test accuracy: 58.50
Round  73, Global train loss: 1.104, Global test loss: 1.129, Global test accuracy: 77.96
Round  74, Train loss: 1.027, Test loss: 1.313, Test accuracy: 58.24
Round  74, Global train loss: 1.027, Global test loss: 1.038, Global test accuracy: 86.80
Round  75, Train loss: 1.219, Test loss: 1.320, Test accuracy: 57.42
Round  75, Global train loss: 1.219, Global test loss: 1.359, Global test accuracy: 53.40
Round  76, Train loss: 1.024, Test loss: 1.315, Test accuracy: 58.08
Round  76, Global train loss: 1.024, Global test loss: 1.025, Global test accuracy: 88.20
Round  77, Train loss: 1.222, Test loss: 1.310, Test accuracy: 58.54
Round  77, Global train loss: 1.222, Global test loss: 1.294, Global test accuracy: 59.94
Round  78, Train loss: 1.197, Test loss: 1.305, Test accuracy: 59.06
Round  78, Global train loss: 1.197, Global test loss: 1.382, Global test accuracy: 50.72
Round  79, Train loss: 1.183, Test loss: 1.306, Test accuracy: 58.98
Round  79, Global train loss: 1.183, Global test loss: 1.308, Global test accuracy: 59.40
Round  80, Train loss: 1.035, Test loss: 1.308, Test accuracy: 58.76
Round  80, Global train loss: 1.035, Global test loss: 1.041, Global test accuracy: 86.60
Round  81, Train loss: 1.077, Test loss: 1.309, Test accuracy: 58.78
Round  81, Global train loss: 1.077, Global test loss: 1.138, Global test accuracy: 77.00
Round  82, Train loss: 1.205, Test loss: 1.314, Test accuracy: 58.10
Round  82, Global train loss: 1.205, Global test loss: 1.309, Global test accuracy: 59.02
Round  83, Train loss: 1.108, Test loss: 1.321, Test accuracy: 57.38
Round  83, Global train loss: 1.108, Global test loss: 1.103, Global test accuracy: 80.56
Round  84, Train loss: 1.132, Test loss: 1.319, Test accuracy: 57.54
Round  84, Global train loss: 1.132, Global test loss: 1.406, Global test accuracy: 48.36
Round  85, Train loss: 1.018, Test loss: 1.317, Test accuracy: 57.80
Round  85, Global train loss: 1.018, Global test loss: 1.058, Global test accuracy: 84.78
Round  86, Train loss: 1.079, Test loss: 1.320, Test accuracy: 57.42
Round  86, Global train loss: 1.079, Global test loss: 1.160, Global test accuracy: 74.60
Round  87, Train loss: 1.125, Test loss: 1.336, Test accuracy: 55.74
Round  87, Global train loss: 1.125, Global test loss: 1.179, Global test accuracy: 72.10
Round  88, Train loss: 1.183, Test loss: 1.304, Test accuracy: 59.14
Round  88, Global train loss: 1.183, Global test loss: 1.247, Global test accuracy: 65.76
Round  89, Train loss: 1.077, Test loss: 1.311, Test accuracy: 58.22
Round  89, Global train loss: 1.077, Global test loss: 1.105, Global test accuracy: 80.22
Round  90, Train loss: 1.156, Test loss: 1.311, Test accuracy: 58.08
Round  90, Global train loss: 1.156, Global test loss: 1.321, Global test accuracy: 57.54
Round  91, Train loss: 1.065, Test loss: 1.313, Test accuracy: 57.86
Round  91, Global train loss: 1.065, Global test loss: 1.145, Global test accuracy: 75.84
Round  92, Train loss: 1.143, Test loss: 1.315, Test accuracy: 57.82
Round  92, Global train loss: 1.143, Global test loss: 1.129, Global test accuracy: 77.90
Round  93, Train loss: 1.084, Test loss: 1.317, Test accuracy: 57.34
Round  93, Global train loss: 1.084, Global test loss: 1.197, Global test accuracy: 70.38/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.218, Test loss: 1.323, Test accuracy: 56.30
Round  94, Global train loss: 1.218, Global test loss: 1.287, Global test accuracy: 61.00
Round  95, Train loss: 1.166, Test loss: 1.328, Test accuracy: 55.80
Round  95, Global train loss: 1.166, Global test loss: 1.450, Global test accuracy: 43.90
Round  96, Train loss: 1.077, Test loss: 1.327, Test accuracy: 56.04
Round  96, Global train loss: 1.077, Global test loss: 1.212, Global test accuracy: 68.54
Round  97, Train loss: 1.158, Test loss: 1.320, Test accuracy: 57.12
Round  97, Global train loss: 1.158, Global test loss: 1.351, Global test accuracy: 54.60
Round  98, Train loss: 1.076, Test loss: 1.322, Test accuracy: 56.76
Round  98, Global train loss: 1.076, Global test loss: 1.192, Global test accuracy: 71.12
Round  99, Train loss: 1.168, Test loss: 1.322, Test accuracy: 56.80
Round  99, Global train loss: 1.168, Global test loss: 1.312, Global test accuracy: 58.40
Final Round, Train loss: 1.091, Test loss: 1.330, Test accuracy: 55.98
Final Round, Global train loss: 1.091, Global test loss: 1.312, Global test accuracy: 58.40
Average accuracy final 10 rounds: 56.992 

Average global accuracy final 10 rounds: 63.922 

654.3475377559662
[0.9195363521575928, 1.8390727043151855, 2.638547420501709, 3.4380221366882324, 4.207563161849976, 4.977104187011719, 5.807013750076294, 6.636923313140869, 7.387105226516724, 8.137287139892578, 8.94968843460083, 9.762089729309082, 10.572483539581299, 11.382877349853516, 12.174610137939453, 12.96634292602539, 13.730803728103638, 14.495264530181885, 15.267691850662231, 16.040119171142578, 16.85934019088745, 17.678561210632324, 18.53994393348694, 19.401326656341553, 20.155415058135986, 20.90950345993042, 21.664122343063354, 22.41874122619629, 23.189650774002075, 23.96056032180786, 24.717494010925293, 25.474427700042725, 26.234270095825195, 26.994112491607666, 27.7983078956604, 28.602503299713135, 29.463379383087158, 30.32425546646118, 31.21767234802246, 32.11108922958374, 32.94031739234924, 33.769545555114746, 34.55789613723755, 35.34624671936035, 36.13252353668213, 36.918800354003906, 37.778552293777466, 38.638304233551025, 39.47884154319763, 40.31937885284424, 41.19212031364441, 42.06486177444458, 42.87391757965088, 43.68297338485718, 44.47033905982971, 45.257704734802246, 46.007845640182495, 46.757986545562744, 47.4929940700531, 48.22800159454346, 48.976189374923706, 49.724377155303955, 50.47753381729126, 51.230690479278564, 52.00105118751526, 52.77141189575195, 53.62527370452881, 54.479135513305664, 55.388103008270264, 56.29707050323486, 57.11388635635376, 57.930702209472656, 58.742100954055786, 59.553499698638916, 60.37359929084778, 61.19369888305664, 62.03644418716431, 62.87918949127197, 63.651775598526, 64.42436170578003, 65.22406148910522, 66.02376127243042, 66.87493848800659, 67.72611570358276, 68.5250289440155, 69.32394218444824, 70.11090350151062, 70.897864818573, 71.71893334388733, 72.54000186920166, 73.34542274475098, 74.1508436203003, 74.89958596229553, 75.64832830429077, 76.49522709846497, 77.34212589263916, 78.1051390171051, 78.86815214157104, 79.65542483329773, 80.44269752502441, 81.22012591362, 81.99755430221558, 82.80059576034546, 83.60363721847534, 84.37997174263, 85.15630626678467, 85.94387578964233, 86.7314453125, 87.49440503120422, 88.25736474990845, 89.0288405418396, 89.80031633377075, 90.55737733840942, 91.3144383430481, 92.04571390151978, 92.77698945999146, 93.49045896530151, 94.20392847061157, 94.96826100349426, 95.73259353637695, 96.54560732841492, 97.35862112045288, 98.17164254188538, 98.98466396331787, 99.77166724205017, 100.55867052078247, 101.32702326774597, 102.09537601470947, 102.91169619560242, 103.72801637649536, 104.51402354240417, 105.30003070831299, 106.16822743415833, 107.03642416000366, 107.89412450790405, 108.75182485580444, 109.59347629547119, 110.43512773513794, 111.25646901130676, 112.07781028747559, 112.91336941719055, 113.74892854690552, 114.61074900627136, 115.4725694656372, 116.32032060623169, 117.16807174682617, 118.04036474227905, 118.91265773773193, 119.78033924102783, 120.64802074432373, 121.49627304077148, 122.34452533721924, 123.19311952590942, 124.04171371459961, 124.89035272598267, 125.73899173736572, 126.5698893070221, 127.40078687667847, 128.23168683052063, 129.0625867843628, 129.9256808757782, 130.7887749671936, 131.5528473854065, 132.31691980361938, 133.08609461784363, 133.85526943206787, 134.62271451950073, 135.3901596069336, 136.14999651908875, 136.9098334312439, 137.67311000823975, 138.4363865852356, 139.21396040916443, 139.99153423309326, 140.7811176776886, 141.57070112228394, 142.37325382232666, 143.17580652236938, 143.95395755767822, 144.73210859298706, 145.48388671875, 146.23566484451294, 146.9921109676361, 147.74855709075928, 148.50918459892273, 149.26981210708618, 150.0361454486847, 150.8024787902832, 151.57790851593018, 152.35333824157715, 153.09740138053894, 153.84146451950073, 154.588219165802, 155.33497381210327, 156.10193252563477, 156.86889123916626, 157.6262035369873, 158.38351583480835, 159.12390303611755, 159.86429023742676, 161.42522192001343, 162.9861536026001]
[22.2, 22.2, 23.62, 23.62, 23.44, 23.44, 34.42, 34.42, 40.88, 40.88, 47.18, 47.18, 66.54, 66.54, 71.62, 71.62, 73.42, 73.42, 72.88, 72.88, 72.9, 72.9, 74.28, 74.28, 78.08, 78.08, 76.86, 76.86, 79.32, 79.32, 79.46, 79.46, 78.0, 78.0, 77.4, 77.4, 77.1, 77.1, 77.0, 77.0, 78.12, 78.12, 76.9, 76.9, 76.84, 76.84, 76.66, 76.66, 76.16, 76.16, 73.46, 73.46, 73.0, 73.0, 74.3, 74.3, 74.48, 74.48, 72.88, 72.88, 72.84, 72.84, 72.3, 72.3, 72.78, 72.78, 71.1, 71.1, 68.96, 68.96, 67.44, 67.44, 66.7, 66.7, 66.42, 66.42, 64.06, 64.06, 64.7, 64.7, 65.5, 65.5, 64.36, 64.36, 63.84, 63.84, 63.0, 63.0, 62.8, 62.8, 62.74, 62.74, 61.64, 61.64, 61.68, 61.68, 62.06, 62.06, 60.94, 60.94, 62.34, 62.34, 62.16, 62.16, 61.46, 61.46, 60.38, 60.38, 59.24, 59.24, 59.98, 59.98, 60.26, 60.26, 61.08, 61.08, 61.0, 61.0, 60.02, 60.02, 59.88, 59.88, 59.68, 59.68, 59.38, 59.38, 59.88, 59.88, 57.86, 57.86, 57.08, 57.08, 56.34, 56.34, 56.84, 56.84, 56.5, 56.5, 57.66, 57.66, 56.88, 56.88, 56.66, 56.66, 57.24, 57.24, 58.5, 58.5, 58.24, 58.24, 57.42, 57.42, 58.08, 58.08, 58.54, 58.54, 59.06, 59.06, 58.98, 58.98, 58.76, 58.76, 58.78, 58.78, 58.1, 58.1, 57.38, 57.38, 57.54, 57.54, 57.8, 57.8, 57.42, 57.42, 55.74, 55.74, 59.14, 59.14, 58.22, 58.22, 58.08, 58.08, 57.86, 57.86, 57.82, 57.82, 57.34, 57.34, 56.3, 56.3, 55.8, 55.8, 56.04, 56.04, 57.12, 57.12, 56.76, 56.76, 56.8, 56.8, 55.98, 55.98]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 4, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.603, Test loss: 1.600, Test accuracy: 34.84
Round   0, Global train loss: 1.603, Global test loss: 1.600, Global test accuracy: 36.68
Round   1, Train loss: 1.605, Test loss: 1.594, Test accuracy: 27.52
Round   1, Global train loss: 1.605, Global test loss: 1.592, Global test accuracy: 23.04
Round   2, Train loss: 1.574, Test loss: 1.564, Test accuracy: 32.98
Round   2, Global train loss: 1.574, Global test loss: 1.551, Global test accuracy: 30.60
Round   3, Train loss: 1.534, Test loss: 1.502, Test accuracy: 52.36
Round   3, Global train loss: 1.534, Global test loss: 1.444, Global test accuracy: 83.72
Round   4, Train loss: 1.472, Test loss: 1.401, Test accuracy: 66.90
Round   4, Global train loss: 1.472, Global test loss: 1.292, Global test accuracy: 84.28
Round   5, Train loss: 1.307, Test loss: 1.334, Test accuracy: 70.96
Round   5, Global train loss: 1.307, Global test loss: 1.110, Global test accuracy: 92.30
Round   6, Train loss: 1.558, Test loss: 1.194, Test accuracy: 83.34
Round   6, Global train loss: 1.558, Global test loss: 1.101, Global test accuracy: 94.02
Round   7, Train loss: 1.539, Test loss: 1.168, Test accuracy: 86.26
Round   7, Global train loss: 1.539, Global test loss: 1.155, Global test accuracy: 88.76
Round   8, Train loss: 1.397, Test loss: 1.144, Test accuracy: 88.04
Round   8, Global train loss: 1.397, Global test loss: 1.063, Global test accuracy: 94.06
Round   9, Train loss: 1.382, Test loss: 1.152, Test accuracy: 85.80
Round   9, Global train loss: 1.382, Global test loss: 1.058, Global test accuracy: 91.76
Round  10, Train loss: 1.530, Test loss: 1.143, Test accuracy: 86.04
Round  10, Global train loss: 1.530, Global test loss: 1.077, Global test accuracy: 91.54
Round  11, Train loss: 1.367, Test loss: 1.138, Test accuracy: 86.08
Round  11, Global train loss: 1.367, Global test loss: 1.031, Global test accuracy: 91.56
Round  12, Train loss: 1.390, Test loss: 1.126, Test accuracy: 87.30
Round  12, Global train loss: 1.390, Global test loss: 1.024, Global test accuracy: 94.68
Round  13, Train loss: 1.423, Test loss: 1.119, Test accuracy: 86.54
Round  13, Global train loss: 1.423, Global test loss: 1.019, Global test accuracy: 94.36
Round  14, Train loss: 1.351, Test loss: 1.089, Test accuracy: 86.48
Round  14, Global train loss: 1.351, Global test loss: 1.023, Global test accuracy: 91.28
Round  15, Train loss: 1.510, Test loss: 1.090, Test accuracy: 86.04
Round  15, Global train loss: 1.510, Global test loss: 1.059, Global test accuracy: 90.22
Round  16, Train loss: 1.493, Test loss: 1.095, Test accuracy: 85.52
Round  16, Global train loss: 1.493, Global test loss: 1.064, Global test accuracy: 89.68
Round  17, Train loss: 1.506, Test loss: 1.110, Test accuracy: 83.66
Round  17, Global train loss: 1.506, Global test loss: 1.099, Global test accuracy: 85.76
Round  18, Train loss: 1.374, Test loss: 1.110, Test accuracy: 83.36
Round  18, Global train loss: 1.374, Global test loss: 1.037, Global test accuracy: 90.88
Round  19, Train loss: 1.209, Test loss: 1.110, Test accuracy: 83.12
Round  19, Global train loss: 1.209, Global test loss: 1.002, Global test accuracy: 93.02
Round  20, Train loss: 1.363, Test loss: 1.114, Test accuracy: 82.38
Round  20, Global train loss: 1.363, Global test loss: 1.032, Global test accuracy: 90.14
Round  21, Train loss: 1.363, Test loss: 1.118, Test accuracy: 81.74
Round  21, Global train loss: 1.363, Global test loss: 1.053, Global test accuracy: 88.52
Round  22, Train loss: 1.323, Test loss: 1.113, Test accuracy: 81.94
Round  22, Global train loss: 1.323, Global test loss: 1.013, Global test accuracy: 90.80
Round  23, Train loss: 1.497, Test loss: 1.116, Test accuracy: 81.16
Round  23, Global train loss: 1.497, Global test loss: 1.049, Global test accuracy: 88.64
Round  24, Train loss: 1.325, Test loss: 1.127, Test accuracy: 79.88
Round  24, Global train loss: 1.325, Global test loss: 1.058, Global test accuracy: 87.00
Round  25, Train loss: 1.353, Test loss: 1.121, Test accuracy: 80.02
Round  25, Global train loss: 1.353, Global test loss: 1.074, Global test accuracy: 86.42
Round  26, Train loss: 1.443, Test loss: 1.124, Test accuracy: 79.66
Round  26, Global train loss: 1.443, Global test loss: 1.079, Global test accuracy: 86.00
Round  27, Train loss: 1.456, Test loss: 1.129, Test accuracy: 79.40
Round  27, Global train loss: 1.456, Global test loss: 1.117, Global test accuracy: 81.60
Round  28, Train loss: 1.425, Test loss: 1.137, Test accuracy: 78.56
Round  28, Global train loss: 1.425, Global test loss: 1.121, Global test accuracy: 80.30
Round  29, Train loss: 1.318, Test loss: 1.142, Test accuracy: 77.66
Round  29, Global train loss: 1.318, Global test loss: 1.079, Global test accuracy: 85.38
Round  30, Train loss: 1.406, Test loss: 1.139, Test accuracy: 77.88
Round  30, Global train loss: 1.406, Global test loss: 1.117, Global test accuracy: 80.82
Round  31, Train loss: 1.410, Test loss: 1.150, Test accuracy: 76.38
Round  31, Global train loss: 1.410, Global test loss: 1.142, Global test accuracy: 77.96
Round  32, Train loss: 1.391, Test loss: 1.165, Test accuracy: 74.74
Round  32, Global train loss: 1.391, Global test loss: 1.146, Global test accuracy: 77.90
Round  33, Train loss: 1.382, Test loss: 1.163, Test accuracy: 74.98
Round  33, Global train loss: 1.382, Global test loss: 1.201, Global test accuracy: 71.66
Round  34, Train loss: 1.442, Test loss: 1.168, Test accuracy: 74.14
Round  34, Global train loss: 1.442, Global test loss: 1.135, Global test accuracy: 78.40
Round  35, Train loss: 1.405, Test loss: 1.171, Test accuracy: 73.96
Round  35, Global train loss: 1.405, Global test loss: 1.174, Global test accuracy: 74.54
Round  36, Train loss: 1.392, Test loss: 1.168, Test accuracy: 74.38
Round  36, Global train loss: 1.392, Global test loss: 1.150, Global test accuracy: 76.22
Round  37, Train loss: 1.388, Test loss: 1.160, Test accuracy: 75.28
Round  37, Global train loss: 1.388, Global test loss: 1.156, Global test accuracy: 76.10
Round  38, Train loss: 1.264, Test loss: 1.164, Test accuracy: 74.92
Round  38, Global train loss: 1.264, Global test loss: 1.121, Global test accuracy: 79.48
Round  39, Train loss: 1.401, Test loss: 1.169, Test accuracy: 74.30
Round  39, Global train loss: 1.401, Global test loss: 1.151, Global test accuracy: 76.04
Round  40, Train loss: 1.267, Test loss: 1.168, Test accuracy: 74.40
Round  40, Global train loss: 1.267, Global test loss: 1.091, Global test accuracy: 82.62
Round  41, Train loss: 1.243, Test loss: 1.171, Test accuracy: 73.94
Round  41, Global train loss: 1.243, Global test loss: 1.092, Global test accuracy: 82.64
Round  42, Train loss: 1.341, Test loss: 1.181, Test accuracy: 72.62
Round  42, Global train loss: 1.341, Global test loss: 1.203, Global test accuracy: 70.50
Round  43, Train loss: 1.334, Test loss: 1.184, Test accuracy: 72.08
Round  43, Global train loss: 1.334, Global test loss: 1.141, Global test accuracy: 77.30
Round  44, Train loss: 1.176, Test loss: 1.183, Test accuracy: 72.00
Round  44, Global train loss: 1.176, Global test loss: 1.029, Global test accuracy: 88.86
Round  45, Train loss: 1.301, Test loss: 1.181, Test accuracy: 72.36
Round  45, Global train loss: 1.301, Global test loss: 1.087, Global test accuracy: 82.64
Round  46, Train loss: 1.255, Test loss: 1.181, Test accuracy: 72.46
Round  46, Global train loss: 1.255, Global test loss: 1.054, Global test accuracy: 86.28
Round  47, Train loss: 1.266, Test loss: 1.194, Test accuracy: 70.74
Round  47, Global train loss: 1.266, Global test loss: 1.072, Global test accuracy: 84.32
Round  48, Train loss: 1.324, Test loss: 1.198, Test accuracy: 70.52
Round  48, Global train loss: 1.324, Global test loss: 1.180, Global test accuracy: 72.78
Round  49, Train loss: 1.184, Test loss: 1.205, Test accuracy: 69.54
Round  49, Global train loss: 1.184, Global test loss: 1.091, Global test accuracy: 83.24
Round  50, Train loss: 1.240, Test loss: 1.196, Test accuracy: 70.48
Round  50, Global train loss: 1.240, Global test loss: 1.091, Global test accuracy: 82.22
Round  51, Train loss: 1.296, Test loss: 1.200, Test accuracy: 70.02
Round  51, Global train loss: 1.296, Global test loss: 1.105, Global test accuracy: 80.64
Round  52, Train loss: 1.363, Test loss: 1.196, Test accuracy: 70.56
Round  52, Global train loss: 1.363, Global test loss: 1.157, Global test accuracy: 75.76
Round  53, Train loss: 1.246, Test loss: 1.194, Test accuracy: 70.86
Round  53, Global train loss: 1.246, Global test loss: 1.078, Global test accuracy: 83.68
Round  54, Train loss: 1.322, Test loss: 1.185, Test accuracy: 71.92
Round  54, Global train loss: 1.322, Global test loss: 1.164, Global test accuracy: 74.80
Round  55, Train loss: 1.211, Test loss: 1.202, Test accuracy: 69.78
Round  55, Global train loss: 1.211, Global test loss: 1.108, Global test accuracy: 80.86
Round  56, Train loss: 1.325, Test loss: 1.204, Test accuracy: 69.60
Round  56, Global train loss: 1.325, Global test loss: 1.178, Global test accuracy: 73.30
Round  57, Train loss: 1.309, Test loss: 1.213, Test accuracy: 68.84
Round  57, Global train loss: 1.309, Global test loss: 1.204, Global test accuracy: 70.68
Round  58, Train loss: 1.306, Test loss: 1.216, Test accuracy: 68.58
Round  58, Global train loss: 1.306, Global test loss: 1.206, Global test accuracy: 70.54
Round  59, Train loss: 1.352, Test loss: 1.221, Test accuracy: 68.18
Round  59, Global train loss: 1.352, Global test loss: 1.214, Global test accuracy: 68.98
Round  60, Train loss: 1.203, Test loss: 1.231, Test accuracy: 67.02
Round  60, Global train loss: 1.203, Global test loss: 1.189, Global test accuracy: 71.92
Round  61, Train loss: 1.312, Test loss: 1.228, Test accuracy: 67.14
Round  61, Global train loss: 1.312, Global test loss: 1.217, Global test accuracy: 69.44
Round  62, Train loss: 1.278, Test loss: 1.231, Test accuracy: 67.06
Round  62, Global train loss: 1.278, Global test loss: 1.212, Global test accuracy: 70.02
Round  63, Train loss: 1.179, Test loss: 1.233, Test accuracy: 66.66
Round  63, Global train loss: 1.179, Global test loss: 1.184, Global test accuracy: 72.60
Round  64, Train loss: 1.233, Test loss: 1.240, Test accuracy: 65.96
Round  64, Global train loss: 1.233, Global test loss: 1.260, Global test accuracy: 63.60
Round  65, Train loss: 1.180, Test loss: 1.242, Test accuracy: 65.62
Round  65, Global train loss: 1.180, Global test loss: 1.160, Global test accuracy: 74.74
Round  66, Train loss: 1.302, Test loss: 1.247, Test accuracy: 65.28
Round  66, Global train loss: 1.302, Global test loss: 1.235, Global test accuracy: 66.78
Round  67, Train loss: 1.159, Test loss: 1.240, Test accuracy: 66.04
Round  67, Global train loss: 1.159, Global test loss: 1.173, Global test accuracy: 73.52
Round  68, Train loss: 1.213, Test loss: 1.241, Test accuracy: 66.10
Round  68, Global train loss: 1.213, Global test loss: 1.297, Global test accuracy: 60.24
Round  69, Train loss: 1.192, Test loss: 1.241, Test accuracy: 66.12
Round  69, Global train loss: 1.192, Global test loss: 1.134, Global test accuracy: 77.46
Round  70, Train loss: 1.202, Test loss: 1.240, Test accuracy: 66.32
Round  70, Global train loss: 1.202, Global test loss: 1.167, Global test accuracy: 73.48
Round  71, Train loss: 1.181, Test loss: 1.236, Test accuracy: 66.48
Round  71, Global train loss: 1.181, Global test loss: 1.111, Global test accuracy: 79.94
Round  72, Train loss: 1.273, Test loss: 1.242, Test accuracy: 65.98
Round  72, Global train loss: 1.273, Global test loss: 1.224, Global test accuracy: 67.76
Round  73, Train loss: 1.269, Test loss: 1.246, Test accuracy: 65.34
Round  73, Global train loss: 1.269, Global test loss: 1.234, Global test accuracy: 66.64
Round  74, Train loss: 1.182, Test loss: 1.247, Test accuracy: 65.18
Round  74, Global train loss: 1.182, Global test loss: 1.128, Global test accuracy: 78.36
Round  75, Train loss: 1.289, Test loss: 1.258, Test accuracy: 64.04
Round  75, Global train loss: 1.289, Global test loss: 1.239, Global test accuracy: 66.52
Round  76, Train loss: 1.096, Test loss: 1.260, Test accuracy: 63.70
Round  76, Global train loss: 1.096, Global test loss: 1.073, Global test accuracy: 84.12
Round  77, Train loss: 1.238, Test loss: 1.254, Test accuracy: 64.22
Round  77, Global train loss: 1.238, Global test loss: 1.256, Global test accuracy: 63.98
Round  78, Train loss: 1.224, Test loss: 1.258, Test accuracy: 63.86
Round  78, Global train loss: 1.224, Global test loss: 1.297, Global test accuracy: 60.42
Round  79, Train loss: 1.217, Test loss: 1.280, Test accuracy: 61.40
Round  79, Global train loss: 1.217, Global test loss: 1.311, Global test accuracy: 58.50
Round  80, Train loss: 1.165, Test loss: 1.281, Test accuracy: 61.30
Round  80, Global train loss: 1.165, Global test loss: 1.148, Global test accuracy: 75.78
Round  81, Train loss: 1.213, Test loss: 1.281, Test accuracy: 61.30
Round  81, Global train loss: 1.213, Global test loss: 1.256, Global test accuracy: 64.62
Round  82, Train loss: 1.179, Test loss: 1.281, Test accuracy: 61.22
Round  82, Global train loss: 1.179, Global test loss: 1.196, Global test accuracy: 70.48
Round  83, Train loss: 1.241, Test loss: 1.271, Test accuracy: 62.44
Round  83, Global train loss: 1.241, Global test loss: 1.233, Global test accuracy: 67.26
Round  84, Train loss: 1.119, Test loss: 1.274, Test accuracy: 62.14
Round  84, Global train loss: 1.119, Global test loss: 1.215, Global test accuracy: 68.00
Round  85, Train loss: 1.160, Test loss: 1.278, Test accuracy: 61.82
Round  85, Global train loss: 1.160, Global test loss: 1.144, Global test accuracy: 76.26
Round  86, Train loss: 1.182, Test loss: 1.278, Test accuracy: 61.38
Round  86, Global train loss: 1.182, Global test loss: 1.265, Global test accuracy: 63.54
Round  87, Train loss: 1.130, Test loss: 1.283, Test accuracy: 61.12
Round  87, Global train loss: 1.130, Global test loss: 1.153, Global test accuracy: 75.32
Round  88, Train loss: 1.203, Test loss: 1.279, Test accuracy: 61.32
Round  88, Global train loss: 1.203, Global test loss: 1.285, Global test accuracy: 60.36
Round  89, Train loss: 1.206, Test loss: 1.294, Test accuracy: 59.66
Round  89, Global train loss: 1.206, Global test loss: 1.297, Global test accuracy: 59.86
Round  90, Train loss: 1.201, Test loss: 1.296, Test accuracy: 59.42
Round  90, Global train loss: 1.201, Global test loss: 1.300, Global test accuracy: 59.82
Round  91, Train loss: 1.207, Test loss: 1.290, Test accuracy: 60.16
Round  91, Global train loss: 1.207, Global test loss: 1.288, Global test accuracy: 60.60
Round  92, Train loss: 1.151, Test loss: 1.291, Test accuracy: 60.06
Round  92, Global train loss: 1.151, Global test loss: 1.166, Global test accuracy: 74.44
Round  93, Train loss: 1.120, Test loss: 1.295, Test accuracy: 59.78
Round  93, Global train loss: 1.120, Global test loss: 1.159, Global test accuracy: 74.90
Round  94, Train loss: 1.256, Test loss: 1.293, Test accuracy: 59.94
Round  94, Global train loss: 1.256, Global test loss: 1.272, Global test accuracy: 63.34/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.147, Test loss: 1.294, Test accuracy: 60.00
Round  95, Global train loss: 1.147, Global test loss: 1.224, Global test accuracy: 67.78
Round  96, Train loss: 1.082, Test loss: 1.294, Test accuracy: 60.20
Round  96, Global train loss: 1.082, Global test loss: 1.165, Global test accuracy: 74.20
Round  97, Train loss: 1.217, Test loss: 1.290, Test accuracy: 60.54
Round  97, Global train loss: 1.217, Global test loss: 1.285, Global test accuracy: 61.26
Round  98, Train loss: 1.121, Test loss: 1.284, Test accuracy: 61.32
Round  98, Global train loss: 1.121, Global test loss: 1.171, Global test accuracy: 73.30
Round  99, Train loss: 1.185, Test loss: 1.280, Test accuracy: 61.84
Round  99, Global train loss: 1.185, Global test loss: 1.273, Global test accuracy: 62.24
Final Round, Train loss: 1.133, Test loss: 1.301, Test accuracy: 59.82
Final Round, Global train loss: 1.133, Global test loss: 1.273, Global test accuracy: 62.24
Average accuracy final 10 rounds: 60.326 

Average global accuracy final 10 rounds: 67.188 

676.0629951953888
[0.9959840774536133, 1.9919681549072266, 2.8946478366851807, 3.7973275184631348, 4.707136631011963, 5.616945743560791, 6.523174047470093, 7.4294023513793945, 8.306396961212158, 9.183391571044922, 10.070390462875366, 10.95738935470581, 11.850916147232056, 12.7444429397583, 13.65690803527832, 14.56937313079834, 15.483537435531616, 16.397701740264893, 17.301116228103638, 18.204530715942383, 19.089104413986206, 19.97367811203003, 20.850454092025757, 21.727230072021484, 22.622122049331665, 23.517014026641846, 24.460311889648438, 25.40360975265503, 26.35532855987549, 27.307047367095947, 28.195533752441406, 29.084020137786865, 29.986974477767944, 30.889928817749023, 31.77981448173523, 32.669700145721436, 33.49966216087341, 34.32962417602539, 35.14502215385437, 35.96042013168335, 36.773751735687256, 37.58708333969116, 38.40038323402405, 39.213683128356934, 40.044463872909546, 40.87524461746216, 41.71178674697876, 42.54832887649536, 43.38369679450989, 44.219064712524414, 45.04477310180664, 45.87048149108887, 46.67742729187012, 47.48437309265137, 48.34764838218689, 49.21092367172241, 50.083075284957886, 50.95522689819336, 51.82215762138367, 52.689088344573975, 53.51915788650513, 54.34922742843628, 55.16923117637634, 55.989234924316406, 56.808199405670166, 57.627163887023926, 58.45063400268555, 59.27410411834717, 60.0816113948822, 60.889118671417236, 61.6861367225647, 62.48315477371216, 63.303351163864136, 64.12354755401611, 64.96349310874939, 65.80343866348267, 66.65065670013428, 67.49787473678589, 68.33647775650024, 69.1750807762146, 69.97065329551697, 70.76622581481934, 71.58205509185791, 72.39788436889648, 73.20765686035156, 74.01742935180664, 74.8371741771698, 75.65691900253296, 76.46417689323425, 77.27143478393555, 78.08104276657104, 78.89065074920654, 79.72287821769714, 80.55510568618774, 81.39812445640564, 82.24114322662354, 83.0485565662384, 83.85596990585327, 84.67773246765137, 85.49949502944946, 86.32415270805359, 87.14881038665771, 87.96677136421204, 88.78473234176636, 89.60425233840942, 90.42377233505249, 91.24402856826782, 92.06428480148315, 92.88622665405273, 93.70816850662231, 94.5221586227417, 95.33614873886108, 96.1479024887085, 96.95965623855591, 97.77661943435669, 98.59358263015747, 99.42343401908875, 100.25328540802002, 101.10934329032898, 101.96540117263794, 102.83176136016846, 103.69812154769897, 104.52414536476135, 105.35016918182373, 106.16205024719238, 106.97393131256104, 107.79421544075012, 108.61449956893921, 109.4600305557251, 110.30556154251099, 111.18059492111206, 112.05562829971313, 112.89068841934204, 113.72574853897095, 114.54307007789612, 115.36039161682129, 116.15435123443604, 116.94831085205078, 117.74433207511902, 118.54035329818726, 119.36907601356506, 120.19779872894287, 121.04271292686462, 121.88762712478638, 122.7260091304779, 123.56439113616943, 124.39046621322632, 125.2165412902832, 126.00719952583313, 126.79785776138306, 127.59464001655579, 128.39142227172852, 129.213476896286, 130.0355315208435, 130.86835360527039, 131.70117568969727, 132.554594039917, 133.40801239013672, 134.2501997947693, 135.09238719940186, 135.90373587608337, 136.7150845527649, 137.50914335250854, 138.3032021522522, 139.10654973983765, 139.9098973274231, 140.76250004768372, 141.61510276794434, 142.49342489242554, 143.37174701690674, 144.20418405532837, 145.03662109375, 145.85247421264648, 146.66832733154297, 147.4925181865692, 148.31670904159546, 149.17187309265137, 150.02703714370728, 150.88459491729736, 151.74215269088745, 152.5940408706665, 153.44592905044556, 154.4191176891327, 155.39230632781982, 156.43129229545593, 157.47027826309204, 158.4073884487152, 159.34449863433838, 160.41890048980713, 161.49330234527588, 162.4225137233734, 163.35172510147095, 164.34056639671326, 165.32940769195557, 166.26481366157532, 167.20021963119507, 168.05985116958618, 168.9194827079773, 169.85214281082153, 170.78480291366577, 172.68231892585754, 174.57983493804932]
[34.84, 34.84, 27.52, 27.52, 32.98, 32.98, 52.36, 52.36, 66.9, 66.9, 70.96, 70.96, 83.34, 83.34, 86.26, 86.26, 88.04, 88.04, 85.8, 85.8, 86.04, 86.04, 86.08, 86.08, 87.3, 87.3, 86.54, 86.54, 86.48, 86.48, 86.04, 86.04, 85.52, 85.52, 83.66, 83.66, 83.36, 83.36, 83.12, 83.12, 82.38, 82.38, 81.74, 81.74, 81.94, 81.94, 81.16, 81.16, 79.88, 79.88, 80.02, 80.02, 79.66, 79.66, 79.4, 79.4, 78.56, 78.56, 77.66, 77.66, 77.88, 77.88, 76.38, 76.38, 74.74, 74.74, 74.98, 74.98, 74.14, 74.14, 73.96, 73.96, 74.38, 74.38, 75.28, 75.28, 74.92, 74.92, 74.3, 74.3, 74.4, 74.4, 73.94, 73.94, 72.62, 72.62, 72.08, 72.08, 72.0, 72.0, 72.36, 72.36, 72.46, 72.46, 70.74, 70.74, 70.52, 70.52, 69.54, 69.54, 70.48, 70.48, 70.02, 70.02, 70.56, 70.56, 70.86, 70.86, 71.92, 71.92, 69.78, 69.78, 69.6, 69.6, 68.84, 68.84, 68.58, 68.58, 68.18, 68.18, 67.02, 67.02, 67.14, 67.14, 67.06, 67.06, 66.66, 66.66, 65.96, 65.96, 65.62, 65.62, 65.28, 65.28, 66.04, 66.04, 66.1, 66.1, 66.12, 66.12, 66.32, 66.32, 66.48, 66.48, 65.98, 65.98, 65.34, 65.34, 65.18, 65.18, 64.04, 64.04, 63.7, 63.7, 64.22, 64.22, 63.86, 63.86, 61.4, 61.4, 61.3, 61.3, 61.3, 61.3, 61.22, 61.22, 62.44, 62.44, 62.14, 62.14, 61.82, 61.82, 61.38, 61.38, 61.12, 61.12, 61.32, 61.32, 59.66, 59.66, 59.42, 59.42, 60.16, 60.16, 60.06, 60.06, 59.78, 59.78, 59.94, 59.94, 60.0, 60.0, 60.2, 60.2, 60.54, 60.54, 61.32, 61.32, 61.84, 61.84, 59.82, 59.82]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 1, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.628, Test loss: 1.605, Test accuracy: 37.38
Round   0, Global train loss: 1.628, Global test loss: 1.605, Global test accuracy: 37.60
Round   1, Train loss: 1.600, Test loss: 1.583, Test accuracy: 69.38
Round   1, Global train loss: 1.600, Global test loss: 1.583, Global test accuracy: 69.38
Round   2, Train loss: 1.571, Test loss: 1.528, Test accuracy: 72.10
Round   2, Global train loss: 1.571, Global test loss: 1.527, Global test accuracy: 70.98
Round   3, Train loss: 1.553, Test loss: 1.473, Test accuracy: 72.56
Round   3, Global train loss: 1.553, Global test loss: 1.466, Global test accuracy: 67.62
Round   4, Train loss: 1.500, Test loss: 1.372, Test accuracy: 84.66
Round   4, Global train loss: 1.500, Global test loss: 1.360, Global test accuracy: 86.90
Round   5, Train loss: 1.446, Test loss: 1.295, Test accuracy: 92.16
Round   5, Global train loss: 1.446, Global test loss: 1.260, Global test accuracy: 93.82
Round   6, Train loss: 1.575, Test loss: 1.305, Test accuracy: 91.56
Round   6, Global train loss: 1.575, Global test loss: 1.317, Global test accuracy: 93.06
Round   7, Train loss: 1.311, Test loss: 1.207, Test accuracy: 92.10
Round   7, Global train loss: 1.311, Global test loss: 1.152, Global test accuracy: 93.88
Round   8, Train loss: 1.385, Test loss: 1.199, Test accuracy: 90.58
Round   8, Global train loss: 1.385, Global test loss: 1.147, Global test accuracy: 91.80
Round   9, Train loss: 1.370, Test loss: 1.201, Test accuracy: 88.40
Round   9, Global train loss: 1.370, Global test loss: 1.133, Global test accuracy: 88.74
Round  10, Train loss: 1.450, Test loss: 1.206, Test accuracy: 88.20
Round  10, Global train loss: 1.450, Global test loss: 1.162, Global test accuracy: 93.10
Round  11, Train loss: 1.558, Test loss: 1.225, Test accuracy: 87.84
Round  11, Global train loss: 1.558, Global test loss: 1.222, Global test accuracy: 91.14
Round  12, Train loss: 1.446, Test loss: 1.214, Test accuracy: 88.12
Round  12, Global train loss: 1.446, Global test loss: 1.169, Global test accuracy: 94.98
Round  13, Train loss: 1.558, Test loss: 1.233, Test accuracy: 87.40
Round  13, Global train loss: 1.558, Global test loss: 1.253, Global test accuracy: 94.12
Round  14, Train loss: 1.554, Test loss: 1.247, Test accuracy: 85.44
Round  14, Global train loss: 1.554, Global test loss: 1.262, Global test accuracy: 83.32
Round  15, Train loss: 1.441, Test loss: 1.211, Test accuracy: 87.06
Round  15, Global train loss: 1.441, Global test loss: 1.185, Global test accuracy: 94.12
Round  16, Train loss: 1.428, Test loss: 1.213, Test accuracy: 85.74
Round  16, Global train loss: 1.428, Global test loss: 1.140, Global test accuracy: 92.80
Round  17, Train loss: 1.545, Test loss: 1.232, Test accuracy: 83.56
Round  17, Global train loss: 1.545, Global test loss: 1.252, Global test accuracy: 79.70
Round  18, Train loss: 1.537, Test loss: 1.245, Test accuracy: 82.62
Round  18, Global train loss: 1.537, Global test loss: 1.233, Global test accuracy: 83.88
Round  19, Train loss: 1.540, Test loss: 1.252, Test accuracy: 82.92
Round  19, Global train loss: 1.540, Global test loss: 1.244, Global test accuracy: 89.58
Round  20, Train loss: 1.536, Test loss: 1.256, Test accuracy: 82.58
Round  20, Global train loss: 1.536, Global test loss: 1.243, Global test accuracy: 92.24
Round  21, Train loss: 1.526, Test loss: 1.256, Test accuracy: 81.90
Round  21, Global train loss: 1.526, Global test loss: 1.230, Global test accuracy: 89.84
Round  22, Train loss: 1.543, Test loss: 1.252, Test accuracy: 82.68
Round  22, Global train loss: 1.543, Global test loss: 1.248, Global test accuracy: 86.56
Round  23, Train loss: 1.546, Test loss: 1.246, Test accuracy: 82.34
Round  23, Global train loss: 1.546, Global test loss: 1.255, Global test accuracy: 91.76
Round  24, Train loss: 1.539, Test loss: 1.261, Test accuracy: 81.00
Round  24, Global train loss: 1.539, Global test loss: 1.273, Global test accuracy: 80.90
Round  25, Train loss: 1.350, Test loss: 1.207, Test accuracy: 83.12
Round  25, Global train loss: 1.350, Global test loss: 1.123, Global test accuracy: 93.84
Round  26, Train loss: 1.410, Test loss: 1.206, Test accuracy: 83.22
Round  26, Global train loss: 1.410, Global test loss: 1.133, Global test accuracy: 90.92
Round  27, Train loss: 1.533, Test loss: 1.216, Test accuracy: 82.26
Round  27, Global train loss: 1.533, Global test loss: 1.221, Global test accuracy: 91.34
Round  28, Train loss: 1.401, Test loss: 1.217, Test accuracy: 82.04
Round  28, Global train loss: 1.401, Global test loss: 1.139, Global test accuracy: 90.06
Round  29, Train loss: 1.515, Test loss: 1.244, Test accuracy: 79.26
Round  29, Global train loss: 1.515, Global test loss: 1.244, Global test accuracy: 86.82
Round  30, Train loss: 1.394, Test loss: 1.221, Test accuracy: 79.90
Round  30, Global train loss: 1.394, Global test loss: 1.163, Global test accuracy: 86.78
Round  31, Train loss: 1.399, Test loss: 1.220, Test accuracy: 79.72
Round  31, Global train loss: 1.399, Global test loss: 1.175, Global test accuracy: 88.26
Round  32, Train loss: 1.392, Test loss: 1.230, Test accuracy: 79.72
Round  32, Global train loss: 1.392, Global test loss: 1.155, Global test accuracy: 91.12
Round  33, Train loss: 1.207, Test loss: 1.177, Test accuracy: 82.76
Round  33, Global train loss: 1.207, Global test loss: 1.063, Global test accuracy: 93.22
Round  34, Train loss: 1.327, Test loss: 1.181, Test accuracy: 82.20
Round  34, Global train loss: 1.327, Global test loss: 1.128, Global test accuracy: 85.46
Round  35, Train loss: 1.507, Test loss: 1.245, Test accuracy: 76.12
Round  35, Global train loss: 1.507, Global test loss: 1.264, Global test accuracy: 75.28
Round  36, Train loss: 1.382, Test loss: 1.216, Test accuracy: 78.90
Round  36, Global train loss: 1.382, Global test loss: 1.123, Global test accuracy: 91.24
Round  37, Train loss: 1.499, Test loss: 1.263, Test accuracy: 74.68
Round  37, Global train loss: 1.499, Global test loss: 1.263, Global test accuracy: 76.94
Round  38, Train loss: 1.467, Test loss: 1.280, Test accuracy: 71.82
Round  38, Global train loss: 1.467, Global test loss: 1.246, Global test accuracy: 80.16
Round  39, Train loss: 1.316, Test loss: 1.223, Test accuracy: 77.36
Round  39, Global train loss: 1.316, Global test loss: 1.166, Global test accuracy: 81.26
Round  40, Train loss: 1.458, Test loss: 1.294, Test accuracy: 68.38
Round  40, Global train loss: 1.458, Global test loss: 1.277, Global test accuracy: 73.48
Round  41, Train loss: 1.445, Test loss: 1.294, Test accuracy: 69.16
Round  41, Global train loss: 1.445, Global test loss: 1.283, Global test accuracy: 71.04
Round  42, Train loss: 1.440, Test loss: 1.313, Test accuracy: 67.22
Round  42, Global train loss: 1.440, Global test loss: 1.298, Global test accuracy: 67.90
Round  43, Train loss: 1.345, Test loss: 1.262, Test accuracy: 73.46
Round  43, Global train loss: 1.345, Global test loss: 1.182, Global test accuracy: 82.60
Round  44, Train loss: 1.495, Test loss: 1.258, Test accuracy: 73.40
Round  44, Global train loss: 1.495, Global test loss: 1.255, Global test accuracy: 81.58
Round  45, Train loss: 1.458, Test loss: 1.304, Test accuracy: 66.50
Round  45, Global train loss: 1.458, Global test loss: 1.281, Global test accuracy: 76.18
Round  46, Train loss: 1.478, Test loss: 1.299, Test accuracy: 68.06
Round  46, Global train loss: 1.478, Global test loss: 1.308, Global test accuracy: 71.24
Round  47, Train loss: 1.436, Test loss: 1.333, Test accuracy: 63.78
Round  47, Global train loss: 1.436, Global test loss: 1.313, Global test accuracy: 69.04
Round  48, Train loss: 1.336, Test loss: 1.257, Test accuracy: 71.20
Round  48, Global train loss: 1.336, Global test loss: 1.210, Global test accuracy: 77.64
Round  49, Train loss: 1.344, Test loss: 1.256, Test accuracy: 71.16
Round  49, Global train loss: 1.344, Global test loss: 1.223, Global test accuracy: 76.16
Round  50, Train loss: 1.413, Test loss: 1.308, Test accuracy: 66.38
Round  50, Global train loss: 1.413, Global test loss: 1.280, Global test accuracy: 70.58
Round  51, Train loss: 1.288, Test loss: 1.211, Test accuracy: 75.70
Round  51, Global train loss: 1.288, Global test loss: 1.133, Global test accuracy: 85.50
Round  52, Train loss: 1.455, Test loss: 1.275, Test accuracy: 68.22
Round  52, Global train loss: 1.455, Global test loss: 1.289, Global test accuracy: 69.86
Round  53, Train loss: 1.310, Test loss: 1.208, Test accuracy: 76.60
Round  53, Global train loss: 1.310, Global test loss: 1.164, Global test accuracy: 81.08
Round  54, Train loss: 1.318, Test loss: 1.248, Test accuracy: 72.28
Round  54, Global train loss: 1.318, Global test loss: 1.196, Global test accuracy: 80.60
Round  55, Train loss: 1.408, Test loss: 1.350, Test accuracy: 59.38
Round  55, Global train loss: 1.408, Global test loss: 1.351, Global test accuracy: 62.14
Round  56, Train loss: 1.401, Test loss: 1.331, Test accuracy: 61.34
Round  56, Global train loss: 1.401, Global test loss: 1.335, Global test accuracy: 62.06
Round  57, Train loss: 1.379, Test loss: 1.325, Test accuracy: 61.66
Round  57, Global train loss: 1.379, Global test loss: 1.309, Global test accuracy: 64.42
Round  58, Train loss: 1.234, Test loss: 1.231, Test accuracy: 71.98
Round  58, Global train loss: 1.234, Global test loss: 1.184, Global test accuracy: 76.28
Round  59, Train loss: 1.271, Test loss: 1.202, Test accuracy: 75.14
Round  59, Global train loss: 1.271, Global test loss: 1.138, Global test accuracy: 83.12
Round  60, Train loss: 1.275, Test loss: 1.258, Test accuracy: 68.84
Round  60, Global train loss: 1.275, Global test loss: 1.221, Global test accuracy: 74.22
Round  61, Train loss: 1.365, Test loss: 1.337, Test accuracy: 59.36
Round  61, Global train loss: 1.365, Global test loss: 1.314, Global test accuracy: 65.28
Round  62, Train loss: 1.288, Test loss: 1.289, Test accuracy: 65.54
Round  62, Global train loss: 1.288, Global test loss: 1.227, Global test accuracy: 73.74
Round  63, Train loss: 1.253, Test loss: 1.314, Test accuracy: 62.18
Round  63, Global train loss: 1.253, Global test loss: 1.268, Global test accuracy: 68.34
Round  64, Train loss: 1.222, Test loss: 1.314, Test accuracy: 62.80
Round  64, Global train loss: 1.222, Global test loss: 1.255, Global test accuracy: 69.24
Round  65, Train loss: 1.300, Test loss: 1.389, Test accuracy: 52.88
Round  65, Global train loss: 1.300, Global test loss: 1.386, Global test accuracy: 52.72
Round  66, Train loss: 1.351, Test loss: 1.334, Test accuracy: 59.46
Round  66, Global train loss: 1.351, Global test loss: 1.335, Global test accuracy: 61.32
Round  67, Train loss: 1.219, Test loss: 1.343, Test accuracy: 57.70
Round  67, Global train loss: 1.219, Global test loss: 1.293, Global test accuracy: 64.26
Round  68, Train loss: 1.209, Test loss: 1.336, Test accuracy: 58.82
Round  68, Global train loss: 1.209, Global test loss: 1.285, Global test accuracy: 65.54
Round  69, Train loss: 1.255, Test loss: 1.235, Test accuracy: 70.48
Round  69, Global train loss: 1.255, Global test loss: 1.199, Global test accuracy: 76.32
Round  70, Train loss: 1.291, Test loss: 1.386, Test accuracy: 53.40
Round  70, Global train loss: 1.291, Global test loss: 1.362, Global test accuracy: 56.58
Round  71, Train loss: 1.250, Test loss: 1.223, Test accuracy: 71.14
Round  71, Global train loss: 1.250, Global test loss: 1.186, Global test accuracy: 76.32
Round  72, Train loss: 1.300, Test loss: 1.324, Test accuracy: 60.36
Round  72, Global train loss: 1.300, Global test loss: 1.310, Global test accuracy: 62.74
Round  73, Train loss: 1.266, Test loss: 1.319, Test accuracy: 60.62
Round  73, Global train loss: 1.266, Global test loss: 1.279, Global test accuracy: 67.22
Round  74, Train loss: 1.355, Test loss: 1.367, Test accuracy: 54.16
Round  74, Global train loss: 1.355, Global test loss: 1.367, Global test accuracy: 55.92
Round  75, Train loss: 1.191, Test loss: 1.257, Test accuracy: 67.40
Round  75, Global train loss: 1.191, Global test loss: 1.207, Global test accuracy: 73.12
Round  76, Train loss: 1.320, Test loss: 1.397, Test accuracy: 51.16
Round  76, Global train loss: 1.320, Global test loss: 1.378, Global test accuracy: 55.52
Round  77, Train loss: 1.217, Test loss: 1.299, Test accuracy: 62.16
Round  77, Global train loss: 1.217, Global test loss: 1.247, Global test accuracy: 69.42
Round  78, Train loss: 1.104, Test loss: 1.191, Test accuracy: 74.62
Round  78, Global train loss: 1.104, Global test loss: 1.112, Global test accuracy: 82.32
Round  79, Train loss: 1.185, Test loss: 1.273, Test accuracy: 65.46
Round  79, Global train loss: 1.185, Global test loss: 1.235, Global test accuracy: 70.26
Round  80, Train loss: 1.318, Test loss: 1.381, Test accuracy: 52.74
Round  80, Global train loss: 1.318, Global test loss: 1.366, Global test accuracy: 55.72
Round  81, Train loss: 1.208, Test loss: 1.332, Test accuracy: 59.22
Round  81, Global train loss: 1.208, Global test loss: 1.290, Global test accuracy: 63.80
Round  82, Train loss: 1.241, Test loss: 1.410, Test accuracy: 49.62
Round  82, Global train loss: 1.241, Global test loss: 1.388, Global test accuracy: 53.20
Round  83, Train loss: 1.263, Test loss: 1.415, Test accuracy: 48.70
Round  83, Global train loss: 1.263, Global test loss: 1.398, Global test accuracy: 50.60
Round  84, Train loss: 1.143, Test loss: 1.361, Test accuracy: 54.98
Round  84, Global train loss: 1.143, Global test loss: 1.331, Global test accuracy: 58.22
Round  85, Train loss: 1.279, Test loss: 1.450, Test accuracy: 44.24
Round  85, Global train loss: 1.279, Global test loss: 1.434, Global test accuracy: 47.26
Round  86, Train loss: 1.177, Test loss: 1.347, Test accuracy: 57.26
Round  86, Global train loss: 1.177, Global test loss: 1.301, Global test accuracy: 62.06
Round  87, Train loss: 1.251, Test loss: 1.441, Test accuracy: 45.36
Round  87, Global train loss: 1.251, Global test loss: 1.430, Global test accuracy: 47.14
Round  88, Train loss: 1.201, Test loss: 1.460, Test accuracy: 43.46
Round  88, Global train loss: 1.201, Global test loss: 1.440, Global test accuracy: 46.52
Round  89, Train loss: 1.187, Test loss: 1.404, Test accuracy: 49.64
Round  89, Global train loss: 1.187, Global test loss: 1.390, Global test accuracy: 50.84
Round  90, Train loss: 1.171, Test loss: 1.444, Test accuracy: 44.78
Round  90, Global train loss: 1.171, Global test loss: 1.431, Global test accuracy: 45.84/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.178, Test loss: 1.437, Test accuracy: 45.58
Round  91, Global train loss: 1.178, Global test loss: 1.420, Global test accuracy: 47.86
Round  92, Train loss: 1.262, Test loss: 1.402, Test accuracy: 49.78
Round  92, Global train loss: 1.262, Global test loss: 1.392, Global test accuracy: 52.10
Round  93, Train loss: 1.188, Test loss: 1.444, Test accuracy: 44.72
Round  93, Global train loss: 1.188, Global test loss: 1.432, Global test accuracy: 46.60
Round  94, Train loss: 1.168, Test loss: 1.258, Test accuracy: 65.76
Round  94, Global train loss: 1.168, Global test loss: 1.238, Global test accuracy: 67.94
Round  95, Train loss: 1.095, Test loss: 1.155, Test accuracy: 77.52
Round  95, Global train loss: 1.095, Global test loss: 1.117, Global test accuracy: 80.46
Round  96, Train loss: 1.147, Test loss: 1.328, Test accuracy: 58.82
Round  96, Global train loss: 1.147, Global test loss: 1.298, Global test accuracy: 62.52
Round  97, Train loss: 1.121, Test loss: 1.277, Test accuracy: 64.16
Round  97, Global train loss: 1.121, Global test loss: 1.254, Global test accuracy: 67.00
Round  98, Train loss: 1.174, Test loss: 1.430, Test accuracy: 46.56
Round  98, Global train loss: 1.174, Global test loss: 1.423, Global test accuracy: 47.54
Round  99, Train loss: 1.142, Test loss: 1.340, Test accuracy: 56.72
Round  99, Global train loss: 1.142, Global test loss: 1.324, Global test accuracy: 58.80
Final Round, Train loss: 1.164, Test loss: 1.328, Test accuracy: 58.02
Final Round, Global train loss: 1.164, Global test loss: 1.324, Global test accuracy: 58.80
Average accuracy final 10 rounds: 55.43999999999999
647.4132564067841
[1.1572093963623047, 2.236023426055908, 3.3255271911621094, 4.3029632568359375, 5.361868143081665, 6.43536639213562, 7.53064489364624, 8.612130880355835, 9.670543670654297, 10.789823293685913, 11.770699977874756, 12.786288499832153, 13.83627462387085, 14.775992393493652, 15.766680479049683, 16.79704976081848, 17.769264936447144, 18.827647924423218, 19.931509256362915, 21.0311336517334, 22.0310275554657, 23.089539051055908, 24.184122800827026, 25.239822387695312, 26.306538820266724, 27.3300883769989, 28.340556621551514, 29.3215389251709, 30.42999529838562, 31.46541953086853, 32.48159694671631, 33.566797494888306, 34.613561153411865, 35.666173696517944, 36.733702182769775, 37.90071511268616, 38.944921016693115, 39.95979690551758, 41.044599294662476, 42.121570110321045, 43.15696859359741, 44.24104332923889, 45.33029770851135, 46.426143646240234, 47.504793643951416, 48.610870122909546, 49.822611808776855, 51.205599546432495, 52.62103724479675, 54.002923250198364, 55.26290965080261, 56.42566394805908, 57.58849620819092, 58.874027729034424, 60.219966888427734, 61.46515512466431, 62.66591715812683, 64.28723883628845, 65.9965238571167, 67.6192455291748, 69.30221271514893, 70.77390384674072, 72.28757834434509, 73.9630274772644, 75.44987106323242, 76.92309021949768, 78.62989640235901, 80.24820351600647, 81.4453558921814, 82.61483836174011, 83.73607301712036, 84.94358539581299, 86.1208381652832, 87.29439234733582, 88.4904100894928, 89.67287683486938, 90.89812874794006, 92.02887678146362, 93.21162581443787, 94.39304852485657, 95.67992520332336, 96.88707661628723, 98.16920638084412, 99.43511986732483, 100.897305727005, 102.02806544303894, 103.17419195175171, 104.40535044670105, 105.54824304580688, 106.68252778053284, 107.90125250816345, 109.13597702980042, 110.43550610542297, 111.6634931564331, 112.8001799583435, 114.06132864952087, 115.28918123245239, 116.43483209609985, 117.58745789527893, 118.72898578643799, 120.68090033531189]
[37.38, 69.38, 72.1, 72.56, 84.66, 92.16, 91.56, 92.1, 90.58, 88.4, 88.2, 87.84, 88.12, 87.4, 85.44, 87.06, 85.74, 83.56, 82.62, 82.92, 82.58, 81.9, 82.68, 82.34, 81.0, 83.12, 83.22, 82.26, 82.04, 79.26, 79.9, 79.72, 79.72, 82.76, 82.2, 76.12, 78.9, 74.68, 71.82, 77.36, 68.38, 69.16, 67.22, 73.46, 73.4, 66.5, 68.06, 63.78, 71.2, 71.16, 66.38, 75.7, 68.22, 76.6, 72.28, 59.38, 61.34, 61.66, 71.98, 75.14, 68.84, 59.36, 65.54, 62.18, 62.8, 52.88, 59.46, 57.7, 58.82, 70.48, 53.4, 71.14, 60.36, 60.62, 54.16, 67.4, 51.16, 62.16, 74.62, 65.46, 52.74, 59.22, 49.62, 48.7, 54.98, 44.24, 57.26, 45.36, 43.46, 49.64, 44.78, 45.58, 49.78, 44.72, 65.76, 77.52, 58.82, 64.16, 46.56, 56.72, 58.02]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550021 (local), 549696 (global); Percentage 99.94 (549696/550021)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=5, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 1.625, Test loss: 1.605, Test accuracy: 31.30
Round   0, Global train loss: 1.625, Global test loss: 1.605, Global test accuracy: 29.42
Round   1, Train loss: 1.605, Test loss: 1.598, Test accuracy: 44.44
Round   1, Global train loss: 1.605, Global test loss: 1.598, Global test accuracy: 37.00
Round   2, Train loss: 1.600, Test loss: 1.587, Test accuracy: 53.16
Round   2, Global train loss: 1.600, Global test loss: 1.587, Global test accuracy: 44.70
Round   3, Train loss: 1.593, Test loss: 1.570, Test accuracy: 60.80
Round   3, Global train loss: 1.593, Global test loss: 1.569, Global test accuracy: 56.20
Round   4, Train loss: 1.580, Test loss: 1.540, Test accuracy: 68.54
Round   4, Global train loss: 1.580, Global test loss: 1.539, Global test accuracy: 69.64
Round   5, Train loss: 1.563, Test loss: 1.495, Test accuracy: 74.54
Round   5, Global train loss: 1.563, Global test loss: 1.493, Global test accuracy: 79.42
Round   6, Train loss: 1.543, Test loss: 1.439, Test accuracy: 77.42
Round   6, Global train loss: 1.543, Global test loss: 1.433, Global test accuracy: 84.60
Round   7, Train loss: 1.525, Test loss: 1.382, Test accuracy: 79.84
Round   7, Global train loss: 1.525, Global test loss: 1.370, Global test accuracy: 86.96
Round   8, Train loss: 1.511, Test loss: 1.336, Test accuracy: 81.62
Round   8, Global train loss: 1.511, Global test loss: 1.316, Global test accuracy: 88.86
Round   9, Train loss: 1.501, Test loss: 1.300, Test accuracy: 83.44
Round   9, Global train loss: 1.501, Global test loss: 1.275, Global test accuracy: 89.62
Round  10, Train loss: 1.465, Test loss: 1.258, Test accuracy: 86.24
Round  10, Global train loss: 1.465, Global test loss: 1.217, Global test accuracy: 90.06
Round  11, Train loss: 1.394, Test loss: 1.168, Test accuracy: 86.54
Round  11, Global train loss: 1.394, Global test loss: 1.157, Global test accuracy: 89.50
Round  12, Train loss: 1.284, Test loss: 1.157, Test accuracy: 83.94
Round  12, Global train loss: 1.284, Global test loss: 1.132, Global test accuracy: 85.12
Round  13, Train loss: 1.262, Test loss: 1.145, Test accuracy: 85.22
Round  13, Global train loss: 1.262, Global test loss: 1.078, Global test accuracy: 90.26
Round  14, Train loss: 1.369, Test loss: 1.151, Test accuracy: 83.66
Round  14, Global train loss: 1.369, Global test loss: 1.170, Global test accuracy: 79.86
Round  15, Train loss: 1.335, Test loss: 1.133, Test accuracy: 85.94
Round  15, Global train loss: 1.335, Global test loss: 1.073, Global test accuracy: 92.10
Round  16, Train loss: 1.336, Test loss: 1.146, Test accuracy: 83.86
Round  16, Global train loss: 1.336, Global test loss: 1.118, Global test accuracy: 85.38
Round  17, Train loss: 1.347, Test loss: 1.146, Test accuracy: 83.48
Round  17, Global train loss: 1.347, Global test loss: 1.120, Global test accuracy: 90.40
Round  18, Train loss: 1.328, Test loss: 1.152, Test accuracy: 81.46
Round  18, Global train loss: 1.328, Global test loss: 1.131, Global test accuracy: 83.98
Round  19, Train loss: 1.326, Test loss: 1.153, Test accuracy: 81.12
Round  19, Global train loss: 1.326, Global test loss: 1.125, Global test accuracy: 85.48
Round  20, Train loss: 1.315, Test loss: 1.164, Test accuracy: 80.12
Round  20, Global train loss: 1.315, Global test loss: 1.121, Global test accuracy: 84.44
Round  21, Train loss: 1.305, Test loss: 1.162, Test accuracy: 80.48
Round  21, Global train loss: 1.305, Global test loss: 1.113, Global test accuracy: 85.16
Round  22, Train loss: 1.334, Test loss: 1.152, Test accuracy: 81.36
Round  22, Global train loss: 1.334, Global test loss: 1.129, Global test accuracy: 85.84
Round  23, Train loss: 1.248, Test loss: 1.140, Test accuracy: 82.52
Round  23, Global train loss: 1.248, Global test loss: 1.073, Global test accuracy: 90.52
Round  24, Train loss: 1.227, Test loss: 1.134, Test accuracy: 83.42
Round  24, Global train loss: 1.227, Global test loss: 1.085, Global test accuracy: 87.70
Round  25, Train loss: 1.317, Test loss: 1.133, Test accuracy: 82.48
Round  25, Global train loss: 1.317, Global test loss: 1.094, Global test accuracy: 87.54
Round  26, Train loss: 1.295, Test loss: 1.148, Test accuracy: 81.44
Round  26, Global train loss: 1.295, Global test loss: 1.122, Global test accuracy: 83.72
Round  27, Train loss: 1.324, Test loss: 1.150, Test accuracy: 81.48
Round  27, Global train loss: 1.324, Global test loss: 1.123, Global test accuracy: 87.56
Round  28, Train loss: 1.285, Test loss: 1.157, Test accuracy: 80.98
Round  28, Global train loss: 1.285, Global test loss: 1.127, Global test accuracy: 82.68
Round  29, Train loss: 1.284, Test loss: 1.156, Test accuracy: 80.20
Round  29, Global train loss: 1.284, Global test loss: 1.117, Global test accuracy: 87.00
Round  30, Train loss: 1.280, Test loss: 1.161, Test accuracy: 79.52
Round  30, Global train loss: 1.280, Global test loss: 1.121, Global test accuracy: 85.68
Round  31, Train loss: 1.200, Test loss: 1.132, Test accuracy: 83.22
Round  31, Global train loss: 1.200, Global test loss: 1.082, Global test accuracy: 87.24
Round  32, Train loss: 1.260, Test loss: 1.155, Test accuracy: 80.40
Round  32, Global train loss: 1.260, Global test loss: 1.112, Global test accuracy: 83.22
Round  33, Train loss: 1.286, Test loss: 1.158, Test accuracy: 79.96
Round  33, Global train loss: 1.286, Global test loss: 1.120, Global test accuracy: 84.54
Round  34, Train loss: 1.220, Test loss: 1.150, Test accuracy: 80.20
Round  34, Global train loss: 1.220, Global test loss: 1.095, Global test accuracy: 87.26
Round  35, Train loss: 1.183, Test loss: 1.131, Test accuracy: 82.86
Round  35, Global train loss: 1.183, Global test loss: 1.097, Global test accuracy: 84.74
Round  36, Train loss: 1.267, Test loss: 1.147, Test accuracy: 81.06
Round  36, Global train loss: 1.267, Global test loss: 1.113, Global test accuracy: 84.50
Round  37, Train loss: 1.246, Test loss: 1.179, Test accuracy: 77.68
Round  37, Global train loss: 1.246, Global test loss: 1.155, Global test accuracy: 80.98
Round  38, Train loss: 1.224, Test loss: 1.192, Test accuracy: 76.28
Round  38, Global train loss: 1.224, Global test loss: 1.168, Global test accuracy: 78.44
Round  39, Train loss: 1.199, Test loss: 1.185, Test accuracy: 76.22
Round  39, Global train loss: 1.199, Global test loss: 1.128, Global test accuracy: 83.18
Round  40, Train loss: 1.145, Test loss: 1.169, Test accuracy: 77.64
Round  40, Global train loss: 1.145, Global test loss: 1.100, Global test accuracy: 84.04
Round  41, Train loss: 1.207, Test loss: 1.219, Test accuracy: 72.26
Round  41, Global train loss: 1.207, Global test loss: 1.184, Global test accuracy: 77.32
Round  42, Train loss: 1.133, Test loss: 1.193, Test accuracy: 75.60
Round  42, Global train loss: 1.133, Global test loss: 1.122, Global test accuracy: 81.96
Round  43, Train loss: 1.208, Test loss: 1.222, Test accuracy: 72.20
Round  43, Global train loss: 1.208, Global test loss: 1.197, Global test accuracy: 73.98
Round  44, Train loss: 1.270, Test loss: 1.190, Test accuracy: 74.82
Round  44, Global train loss: 1.270, Global test loss: 1.169, Global test accuracy: 79.50
Round  45, Train loss: 1.150, Test loss: 1.177, Test accuracy: 77.06
Round  45, Global train loss: 1.150, Global test loss: 1.118, Global test accuracy: 82.74
Round  46, Train loss: 1.170, Test loss: 1.162, Test accuracy: 78.42
Round  46, Global train loss: 1.170, Global test loss: 1.137, Global test accuracy: 80.30
Round  47, Train loss: 1.127, Test loss: 1.184, Test accuracy: 75.76
Round  47, Global train loss: 1.127, Global test loss: 1.134, Global test accuracy: 79.66
Round  48, Train loss: 1.156, Test loss: 1.138, Test accuracy: 81.92
Round  48, Global train loss: 1.156, Global test loss: 1.114, Global test accuracy: 82.46
Round  49, Train loss: 1.222, Test loss: 1.183, Test accuracy: 76.50
Round  49, Global train loss: 1.222, Global test loss: 1.211, Global test accuracy: 70.22
Round  50, Train loss: 1.178, Test loss: 1.264, Test accuracy: 66.52
Round  50, Global train loss: 1.178, Global test loss: 1.243, Global test accuracy: 69.10
Round  51, Train loss: 1.230, Test loss: 1.247, Test accuracy: 67.88
Round  51, Global train loss: 1.230, Global test loss: 1.229, Global test accuracy: 71.92
Round  52, Train loss: 1.207, Test loss: 1.262, Test accuracy: 66.74
Round  52, Global train loss: 1.207, Global test loss: 1.237, Global test accuracy: 71.10
Round  53, Train loss: 1.242, Test loss: 1.287, Test accuracy: 63.06
Round  53, Global train loss: 1.242, Global test loss: 1.280, Global test accuracy: 65.60
Round  54, Train loss: 1.153, Test loss: 1.170, Test accuracy: 76.94
Round  54, Global train loss: 1.153, Global test loss: 1.109, Global test accuracy: 83.04
Round  55, Train loss: 1.114, Test loss: 1.187, Test accuracy: 75.64
Round  55, Global train loss: 1.114, Global test loss: 1.176, Global test accuracy: 75.06
Round  56, Train loss: 1.125, Test loss: 1.201, Test accuracy: 74.32
Round  56, Global train loss: 1.125, Global test loss: 1.196, Global test accuracy: 72.66
Round  57, Train loss: 1.166, Test loss: 1.318, Test accuracy: 60.76
Round  57, Global train loss: 1.166, Global test loss: 1.307, Global test accuracy: 62.36
Round  58, Train loss: 1.191, Test loss: 1.317, Test accuracy: 60.84
Round  58, Global train loss: 1.191, Global test loss: 1.309, Global test accuracy: 63.86
Round  59, Train loss: 1.196, Test loss: 1.329, Test accuracy: 59.32
Round  59, Global train loss: 1.196, Global test loss: 1.308, Global test accuracy: 63.26
Round  60, Train loss: 1.108, Test loss: 1.271, Test accuracy: 65.56
Round  60, Global train loss: 1.108, Global test loss: 1.243, Global test accuracy: 68.04
Round  61, Train loss: 1.104, Test loss: 1.218, Test accuracy: 71.30
Round  61, Global train loss: 1.104, Global test loss: 1.168, Global test accuracy: 76.24
Round  62, Train loss: 1.167, Test loss: 1.285, Test accuracy: 64.40
Round  62, Global train loss: 1.167, Global test loss: 1.272, Global test accuracy: 65.94
Round  63, Train loss: 1.148, Test loss: 1.242, Test accuracy: 68.92
Round  63, Global train loss: 1.148, Global test loss: 1.200, Global test accuracy: 73.50
Round  64, Train loss: 1.081, Test loss: 1.216, Test accuracy: 72.06
Round  64, Global train loss: 1.081, Global test loss: 1.163, Global test accuracy: 77.20
Round  65, Train loss: 1.131, Test loss: 1.328, Test accuracy: 59.36
Round  65, Global train loss: 1.131, Global test loss: 1.306, Global test accuracy: 62.86
Round  66, Train loss: 1.147, Test loss: 1.350, Test accuracy: 56.14
Round  66, Global train loss: 1.147, Global test loss: 1.351, Global test accuracy: 55.08
Round  67, Train loss: 1.103, Test loss: 1.214, Test accuracy: 71.22
Round  67, Global train loss: 1.103, Global test loss: 1.155, Global test accuracy: 77.38
Round  68, Train loss: 1.185, Test loss: 1.282, Test accuracy: 64.64
Round  68, Global train loss: 1.185, Global test loss: 1.240, Global test accuracy: 68.80
Round  69, Train loss: 1.182, Test loss: 1.305, Test accuracy: 61.60
Round  69, Global train loss: 1.182, Global test loss: 1.295, Global test accuracy: 63.58
Round  70, Train loss: 1.077, Test loss: 1.254, Test accuracy: 66.94
Round  70, Global train loss: 1.077, Global test loss: 1.204, Global test accuracy: 71.84
Round  71, Train loss: 1.153, Test loss: 1.317, Test accuracy: 60.56
Round  71, Global train loss: 1.153, Global test loss: 1.301, Global test accuracy: 63.26
Round  72, Train loss: 1.123, Test loss: 1.374, Test accuracy: 53.46
Round  72, Global train loss: 1.123, Global test loss: 1.381, Global test accuracy: 51.40
Round  73, Train loss: 1.131, Test loss: 1.229, Test accuracy: 70.10
Round  73, Global train loss: 1.131, Global test loss: 1.177, Global test accuracy: 75.10
Round  74, Train loss: 1.149, Test loss: 1.351, Test accuracy: 54.86
Round  74, Global train loss: 1.149, Global test loss: 1.354, Global test accuracy: 55.08
Round  75, Train loss: 1.100, Test loss: 1.291, Test accuracy: 63.16
Round  75, Global train loss: 1.100, Global test loss: 1.274, Global test accuracy: 64.04
Round  76, Train loss: 1.129, Test loss: 1.351, Test accuracy: 55.72
Round  76, Global train loss: 1.129, Global test loss: 1.323, Global test accuracy: 59.36
Round  77, Train loss: 1.114, Test loss: 1.314, Test accuracy: 59.96
Round  77, Global train loss: 1.114, Global test loss: 1.280, Global test accuracy: 64.26
Round  78, Train loss: 1.105, Test loss: 1.350, Test accuracy: 55.90
Round  78, Global train loss: 1.105, Global test loss: 1.324, Global test accuracy: 59.44
Round  79, Train loss: 1.094, Test loss: 1.335, Test accuracy: 57.58
Round  79, Global train loss: 1.094, Global test loss: 1.323, Global test accuracy: 58.42
Round  80, Train loss: 1.037, Test loss: 1.197, Test accuracy: 72.44
Round  80, Global train loss: 1.037, Global test loss: 1.119, Global test accuracy: 80.56
Round  81, Train loss: 0.991, Test loss: 1.188, Test accuracy: 73.40
Round  81, Global train loss: 0.991, Global test loss: 1.106, Global test accuracy: 81.90
Round  82, Train loss: 0.983, Test loss: 1.196, Test accuracy: 72.60
Round  82, Global train loss: 0.983, Global test loss: 1.117, Global test accuracy: 80.24
Round  83, Train loss: 0.976, Test loss: 1.187, Test accuracy: 73.72
Round  83, Global train loss: 0.976, Global test loss: 1.106, Global test accuracy: 81.44
Round  84, Train loss: 0.972, Test loss: 1.195, Test accuracy: 72.48
Round  84, Global train loss: 0.972, Global test loss: 1.106, Global test accuracy: 81.64
Round  85, Train loss: 0.968, Test loss: 1.202, Test accuracy: 71.50
Round  85, Global train loss: 0.968, Global test loss: 1.107, Global test accuracy: 81.58
Round  86, Train loss: 0.965, Test loss: 1.207, Test accuracy: 71.08
Round  86, Global train loss: 0.965, Global test loss: 1.102, Global test accuracy: 81.92
Round  87, Train loss: 0.961, Test loss: 1.205, Test accuracy: 71.24
Round  87, Global train loss: 0.961, Global test loss: 1.096, Global test accuracy: 82.88
Round  88, Train loss: 0.958, Test loss: 1.216, Test accuracy: 70.06
Round  88, Global train loss: 0.958, Global test loss: 1.115, Global test accuracy: 80.34
Round  89, Train loss: 0.954, Test loss: 1.232, Test accuracy: 68.42
Round  89, Global train loss: 0.954, Global test loss: 1.131, Global test accuracy: 78.50
Round  90, Train loss: 0.952, Test loss: 1.215, Test accuracy: 70.14
Round  90, Global train loss: 0.952, Global test loss: 1.106, Global test accuracy: 81.42/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 0.951, Test loss: 1.229, Test accuracy: 68.46
Round  91, Global train loss: 0.951, Global test loss: 1.113, Global test accuracy: 80.30
Round  92, Train loss: 0.946, Test loss: 1.219, Test accuracy: 69.66
Round  92, Global train loss: 0.946, Global test loss: 1.105, Global test accuracy: 81.62
Round  93, Train loss: 0.944, Test loss: 1.233, Test accuracy: 67.88
Round  93, Global train loss: 0.944, Global test loss: 1.116, Global test accuracy: 80.10
Round  94, Train loss: 0.942, Test loss: 1.230, Test accuracy: 68.24
Round  94, Global train loss: 0.942, Global test loss: 1.112, Global test accuracy: 80.40
Round  95, Train loss: 0.939, Test loss: 1.224, Test accuracy: 69.28
Round  95, Global train loss: 0.939, Global test loss: 1.108, Global test accuracy: 81.16
Round  96, Train loss: 0.938, Test loss: 1.230, Test accuracy: 68.50
Round  96, Global train loss: 0.938, Global test loss: 1.113, Global test accuracy: 80.32
Round  97, Train loss: 0.937, Test loss: 1.230, Test accuracy: 68.44
Round  97, Global train loss: 0.937, Global test loss: 1.109, Global test accuracy: 81.00
Round  98, Train loss: 0.933, Test loss: 1.243, Test accuracy: 66.70
Round  98, Global train loss: 0.933, Global test loss: 1.116, Global test accuracy: 79.80
Round  99, Train loss: 1.093, Test loss: 1.297, Test accuracy: 61.90
Round  99, Global train loss: 1.093, Global test loss: 1.256, Global test accuracy: 66.48
Final Round, Train loss: 1.181, Test loss: 1.273, Test accuracy: 64.26
Final Round, Global train loss: 1.181, Global test loss: 1.256, Global test accuracy: 66.48
Average accuracy final 10 rounds: 67.92
1947.9605104923248
[1.7521169185638428, 3.160820245742798, 4.655822992324829, 6.068074941635132, 7.546373128890991, 9.02999758720398, 10.570904970169067, 12.01973032951355, 13.460876941680908, 14.91083312034607, 19.89306664466858, 28.05485773086548, 36.11196541786194, 44.36201214790344, 52.51183891296387, 60.30377459526062, 68.30502462387085, 76.35537600517273, 84.60899615287781, 92.72794032096863, 100.72484755516052, 108.78846430778503, 117.12230038642883, 124.91812658309937, 133.06165194511414, 141.12177634239197, 149.1965160369873, 157.0409655570984, 164.94827389717102, 173.02121257781982, 180.9948353767395, 188.92959117889404, 197.0017614364624, 204.96322321891785, 213.10951375961304, 221.27360248565674, 229.13096022605896, 237.03555154800415, 245.0317680835724, 252.9692406654358, 260.9213774204254, 269.1179287433624, 277.1652433872223, 285.41169571876526, 293.3067042827606, 301.297443151474, 309.1113793849945, 316.9848532676697, 325.0108003616333, 332.9043216705322, 341.3758113384247, 349.87219738960266, 357.8257246017456, 365.84252977371216, 373.64111971855164, 381.50886964797974, 389.7577369213104, 397.6822760105133, 405.56535935401917, 413.50207352638245, 421.6910743713379, 429.69597125053406, 437.519412279129, 445.1532688140869, 452.7536473274231, 460.46833419799805, 468.28889179229736, 475.815048456192, 483.29510259628296, 490.7686426639557, 498.4299759864807, 506.09584617614746, 513.697457075119, 520.9456691741943, 528.6407370567322, 535.9413437843323, 543.3535060882568, 551.0277724266052, 558.6531817913055, 566.4796924591064, 567.7387182712555, 569.0480394363403, 570.3331916332245, 571.6328222751617, 573.0536603927612, 574.3564529418945, 575.5951280593872, 576.8360743522644, 578.2020800113678, 579.5805747509003, 580.9142804145813, 582.3793017864227, 583.8460175991058, 585.2449595928192, 586.5580065250397, 587.8530249595642, 589.2071759700775, 590.5916874408722, 591.9161705970764, 598.892058134079, 606.6228935718536]
[31.3, 44.44, 53.16, 60.8, 68.54, 74.54, 77.42, 79.84, 81.62, 83.44, 86.24, 86.54, 83.94, 85.22, 83.66, 85.94, 83.86, 83.48, 81.46, 81.12, 80.12, 80.48, 81.36, 82.52, 83.42, 82.48, 81.44, 81.48, 80.98, 80.2, 79.52, 83.22, 80.4, 79.96, 80.2, 82.86, 81.06, 77.68, 76.28, 76.22, 77.64, 72.26, 75.6, 72.2, 74.82, 77.06, 78.42, 75.76, 81.92, 76.5, 66.52, 67.88, 66.74, 63.06, 76.94, 75.64, 74.32, 60.76, 60.84, 59.32, 65.56, 71.3, 64.4, 68.92, 72.06, 59.36, 56.14, 71.22, 64.64, 61.6, 66.94, 60.56, 53.46, 70.1, 54.86, 63.16, 55.72, 59.96, 55.9, 57.58, 72.44, 73.4, 72.6, 73.72, 72.48, 71.5, 71.08, 71.24, 70.06, 68.42, 70.14, 68.46, 69.66, 67.88, 68.24, 69.28, 68.5, 68.44, 66.7, 61.9, 64.26]
