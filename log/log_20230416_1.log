nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.451, Test loss: 1.307, Test accuracy: 50.52 

Round   0, Global train loss: 1.451, Global test loss: 2.139, Global test accuracy: 23.44 

Round   1, Train loss: 1.133, Test loss: 1.137, Test accuracy: 58.52 

Round   1, Global train loss: 1.133, Global test loss: 2.159, Global test accuracy: 23.04 

Round   2, Train loss: 0.957, Test loss: 1.223, Test accuracy: 56.56 

Round   2, Global train loss: 0.957, Global test loss: 2.217, Global test accuracy: 22.88 

Round   3, Train loss: 0.830, Test loss: 1.434, Test accuracy: 56.84 

Round   3, Global train loss: 0.830, Global test loss: 2.174, Global test accuracy: 22.52 

Round   4, Train loss: 0.701, Test loss: 1.181, Test accuracy: 61.20 

Round   4, Global train loss: 0.701, Global test loss: 2.200, Global test accuracy: 23.16 

Round   5, Train loss: 0.594, Test loss: 1.331, Test accuracy: 60.96 

Round   5, Global train loss: 0.594, Global test loss: 2.191, Global test accuracy: 23.64 

Round   6, Train loss: 0.521, Test loss: 1.386, Test accuracy: 62.84 

Round   6, Global train loss: 0.521, Global test loss: 2.210, Global test accuracy: 23.08 

Round   7, Train loss: 0.439, Test loss: 1.499, Test accuracy: 61.08 

Round   7, Global train loss: 0.439, Global test loss: 2.228, Global test accuracy: 22.96 

Round   8, Train loss: 0.369, Test loss: 1.287, Test accuracy: 64.92 

Round   8, Global train loss: 0.369, Global test loss: 2.223, Global test accuracy: 24.32 

Round   9, Train loss: 0.304, Test loss: 1.391, Test accuracy: 64.40 

Round   9, Global train loss: 0.304, Global test loss: 2.270, Global test accuracy: 22.80 

Round  10, Train loss: 0.259, Test loss: 1.516, Test accuracy: 63.88 

Round  10, Global train loss: 0.259, Global test loss: 2.240, Global test accuracy: 23.60 

Round  11, Train loss: 0.229, Test loss: 1.451, Test accuracy: 66.80 

Round  11, Global train loss: 0.229, Global test loss: 2.256, Global test accuracy: 23.80 

Round  12, Train loss: 0.193, Test loss: 1.602, Test accuracy: 64.88 

Round  12, Global train loss: 0.193, Global test loss: 2.262, Global test accuracy: 23.44 

Round  13, Train loss: 0.164, Test loss: 1.648, Test accuracy: 66.16 

Round  13, Global train loss: 0.164, Global test loss: 2.216, Global test accuracy: 23.76 

Round  14, Train loss: 0.154, Test loss: 1.910, Test accuracy: 63.52 

Round  14, Global train loss: 0.154, Global test loss: 2.239, Global test accuracy: 25.52 

Round  15, Train loss: 0.143, Test loss: 1.576, Test accuracy: 67.28 

Round  15, Global train loss: 0.143, Global test loss: 2.269, Global test accuracy: 23.32 

Round  16, Train loss: 0.108, Test loss: 1.553, Test accuracy: 66.28 

Round  16, Global train loss: 0.108, Global test loss: 2.285, Global test accuracy: 25.44 

Round  17, Train loss: 0.093, Test loss: 1.522, Test accuracy: 68.44 

Round  17, Global train loss: 0.093, Global test loss: 2.291, Global test accuracy: 23.48 

Round  18, Train loss: 0.076, Test loss: 1.610, Test accuracy: 69.04 

Round  18, Global train loss: 0.076, Global test loss: 2.315, Global test accuracy: 24.08 

Round  19, Train loss: 0.076, Test loss: 1.781, Test accuracy: 67.16 

Round  19, Global train loss: 0.076, Global test loss: 2.290, Global test accuracy: 25.08 

Round  20, Train loss: 0.075, Test loss: 1.548, Test accuracy: 69.20 

Round  20, Global train loss: 0.075, Global test loss: 2.287, Global test accuracy: 21.84 

Round  21, Train loss: 0.080, Test loss: 1.671, Test accuracy: 66.72 

Round  21, Global train loss: 0.080, Global test loss: 2.298, Global test accuracy: 26.40 

Round  22, Train loss: 0.063, Test loss: 1.797, Test accuracy: 67.76 

Round  22, Global train loss: 0.063, Global test loss: 2.306, Global test accuracy: 19.96 

Round  23, Train loss: 0.063, Test loss: 1.614, Test accuracy: 69.24 

Round  23, Global train loss: 0.063, Global test loss: 2.325, Global test accuracy: 23.80 

Round  24, Train loss: 0.055, Test loss: 1.671, Test accuracy: 68.60 

Round  24, Global train loss: 0.055, Global test loss: 2.326, Global test accuracy: 19.32 

Round  25, Train loss: 0.044, Test loss: 1.661, Test accuracy: 69.72 

Round  25, Global train loss: 0.044, Global test loss: 2.324, Global test accuracy: 21.60 

Round  26, Train loss: 0.040, Test loss: 1.669, Test accuracy: 69.20 

Round  26, Global train loss: 0.040, Global test loss: 2.282, Global test accuracy: 20.80 

Round  27, Train loss: 0.045, Test loss: 1.709, Test accuracy: 68.76 

Round  27, Global train loss: 0.045, Global test loss: 2.314, Global test accuracy: 20.76 

Round  28, Train loss: 0.043, Test loss: 1.697, Test accuracy: 68.56 

Round  28, Global train loss: 0.043, Global test loss: 2.301, Global test accuracy: 22.08 

Round  29, Train loss: 0.036, Test loss: 1.573, Test accuracy: 69.88 

Round  29, Global train loss: 0.036, Global test loss: 2.300, Global test accuracy: 20.12 

Round  30, Train loss: 0.027, Test loss: 1.626, Test accuracy: 70.36 

Round  30, Global train loss: 0.027, Global test loss: 2.311, Global test accuracy: 22.76 

Round  31, Train loss: 0.026, Test loss: 1.707, Test accuracy: 69.72 

Round  31, Global train loss: 0.026, Global test loss: 2.290, Global test accuracy: 20.24 

Round  32, Train loss: 0.023, Test loss: 1.635, Test accuracy: 70.12 

Round  32, Global train loss: 0.023, Global test loss: 2.291, Global test accuracy: 19.76 

Round  33, Train loss: 0.021, Test loss: 1.630, Test accuracy: 70.88 

Round  33, Global train loss: 0.021, Global test loss: 2.276, Global test accuracy: 20.24 

Round  34, Train loss: 0.018, Test loss: 1.650, Test accuracy: 69.76 

Round  34, Global train loss: 0.018, Global test loss: 2.269, Global test accuracy: 19.84 

Final Round, Train loss: 0.020, Test loss: 1.834, Test accuracy: 69.28 

Final Round, Global train loss: 0.020, Global test loss: 2.269, Global test accuracy: 19.84 

Average accuracy final 10 rounds: 69.69600000000001 

Average global accuracy final 10 rounds: 20.82 

1462.514188528061
[13.530373573303223, 20.705769300460815, 27.86262607574463, 34.881657123565674, 41.47211289405823, 48.341142892837524, 55.2778856754303, 62.56492614746094, 69.69754433631897, 77.05666375160217, 84.09490418434143, 90.48206615447998, 96.79033899307251, 103.66906476020813, 110.6250216960907, 117.47023677825928, 124.70581102371216, 131.1099135875702, 138.29110145568848, 144.49257802963257, 151.67183542251587, 158.94423365592957, 165.54385089874268, 172.320321559906, 178.61380004882812, 185.29583144187927, 192.15851044654846, 199.48771119117737, 206.81142210960388, 213.57950019836426, 220.13376474380493, 227.29766368865967, 234.42103147506714, 241.0742154121399, 248.30054330825806, 262.02475476264954]
[50.52, 58.52, 56.56, 56.84, 61.2, 60.96, 62.84, 61.08, 64.92, 64.4, 63.88, 66.8, 64.88, 66.16, 63.52, 67.28, 66.28, 68.44, 69.04, 67.16, 69.2, 66.72, 67.76, 69.24, 68.6, 69.72, 69.2, 68.76, 68.56, 69.88, 70.36, 69.72, 70.12, 70.88, 69.76, 69.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.464, Test loss: 1.288, Test accuracy: 51.96 

Round   0, Global train loss: 1.464, Global test loss: 2.137, Global test accuracy: 25.80 

Round   1, Train loss: 1.333, Test loss: 1.208, Test accuracy: 55.88 

Round   1, Global train loss: 1.333, Global test loss: 1.875, Global test accuracy: 33.36 

Round   2, Train loss: 1.171, Test loss: 1.175, Test accuracy: 57.60 

Round   2, Global train loss: 1.171, Global test loss: 1.734, Global test accuracy: 40.20 

Round   3, Train loss: 1.060, Test loss: 1.175, Test accuracy: 56.64 

Round   3, Global train loss: 1.060, Global test loss: 1.632, Global test accuracy: 43.92 

Round   4, Train loss: 0.972, Test loss: 1.114, Test accuracy: 60.28 

Round   4, Global train loss: 0.972, Global test loss: 1.550, Global test accuracy: 46.28 

Round   5, Train loss: 0.898, Test loss: 1.123, Test accuracy: 62.80 

Round   5, Global train loss: 0.898, Global test loss: 1.624, Global test accuracy: 46.92 

Round   6, Train loss: 0.842, Test loss: 0.993, Test accuracy: 65.44 

Round   6, Global train loss: 0.842, Global test loss: 1.486, Global test accuracy: 51.08 

Round   7, Train loss: 0.781, Test loss: 1.085, Test accuracy: 64.00 

Round   7, Global train loss: 0.781, Global test loss: 1.466, Global test accuracy: 52.36 

Round   8, Train loss: 0.726, Test loss: 1.176, Test accuracy: 63.00 

Round   8, Global train loss: 0.726, Global test loss: 1.525, Global test accuracy: 51.20 

Round   9, Train loss: 0.674, Test loss: 1.066, Test accuracy: 65.60 

Round   9, Global train loss: 0.674, Global test loss: 1.380, Global test accuracy: 54.76 

Round  10, Train loss: 0.653, Test loss: 1.112, Test accuracy: 65.44 

Round  10, Global train loss: 0.653, Global test loss: 1.472, Global test accuracy: 54.24 

Round  11, Train loss: 0.591, Test loss: 0.983, Test accuracy: 69.08 

Round  11, Global train loss: 0.591, Global test loss: 1.331, Global test accuracy: 57.48 

Round  12, Train loss: 0.539, Test loss: 1.135, Test accuracy: 67.92 

Round  12, Global train loss: 0.539, Global test loss: 1.433, Global test accuracy: 56.60 

Round  13, Train loss: 0.516, Test loss: 0.976, Test accuracy: 71.52 

Round  13, Global train loss: 0.516, Global test loss: 1.296, Global test accuracy: 59.40 

Round  14, Train loss: 0.466, Test loss: 1.009, Test accuracy: 70.52 

Round  14, Global train loss: 0.466, Global test loss: 1.389, Global test accuracy: 59.96 

Round  15, Train loss: 0.450, Test loss: 1.054, Test accuracy: 70.40 

Round  15, Global train loss: 0.450, Global test loss: 1.381, Global test accuracy: 58.64 

Round  16, Train loss: 0.419, Test loss: 1.095, Test accuracy: 70.36 

Round  16, Global train loss: 0.419, Global test loss: 1.345, Global test accuracy: 61.28 

Round  17, Train loss: 0.385, Test loss: 1.023, Test accuracy: 71.96 

Round  17, Global train loss: 0.385, Global test loss: 1.328, Global test accuracy: 61.16 

Round  18, Train loss: 0.362, Test loss: 0.987, Test accuracy: 73.04 

Round  18, Global train loss: 0.362, Global test loss: 1.276, Global test accuracy: 62.52 

Round  19, Train loss: 0.335, Test loss: 1.144, Test accuracy: 70.40 

Round  19, Global train loss: 0.335, Global test loss: 1.289, Global test accuracy: 62.12 

Round  20, Train loss: 0.321, Test loss: 1.130, Test accuracy: 71.12 

Round  20, Global train loss: 0.321, Global test loss: 1.343, Global test accuracy: 61.80 

Round  21, Train loss: 0.287, Test loss: 1.183, Test accuracy: 70.40 

Round  21, Global train loss: 0.287, Global test loss: 1.220, Global test accuracy: 64.68 

Round  22, Train loss: 0.276, Test loss: 1.049, Test accuracy: 73.20 

Round  22, Global train loss: 0.276, Global test loss: 1.261, Global test accuracy: 63.68 

Round  23, Train loss: 0.268, Test loss: 1.103, Test accuracy: 71.84 

Round  23, Global train loss: 0.268, Global test loss: 1.285, Global test accuracy: 63.80 

Round  24, Train loss: 0.239, Test loss: 1.024, Test accuracy: 74.20 

Round  24, Global train loss: 0.239, Global test loss: 1.317, Global test accuracy: 63.88 

Round  25, Train loss: 0.240, Test loss: 1.080, Test accuracy: 72.28 

Round  25, Global train loss: 0.240, Global test loss: 1.235, Global test accuracy: 64.32 

Round  26, Train loss: 0.210, Test loss: 1.119, Test accuracy: 74.28 

Round  26, Global train loss: 0.210, Global test loss: 1.266, Global test accuracy: 65.68 

Round  27, Train loss: 0.208, Test loss: 1.050, Test accuracy: 73.64 

Round  27, Global train loss: 0.208, Global test loss: 1.234, Global test accuracy: 65.12 

Round  28, Train loss: 0.201, Test loss: 1.102, Test accuracy: 73.48 

Round  28, Global train loss: 0.201, Global test loss: 1.228, Global test accuracy: 65.72 

Round  29, Train loss: 0.170, Test loss: 1.144, Test accuracy: 73.88 

Round  29, Global train loss: 0.170, Global test loss: 1.218, Global test accuracy: 65.92 

Round  30, Train loss: 0.168, Test loss: 1.125, Test accuracy: 74.84 

Round  30, Global train loss: 0.168, Global test loss: 1.250, Global test accuracy: 65.68 

Round  31, Train loss: 0.180, Test loss: 1.168, Test accuracy: 73.52 

Round  31, Global train loss: 0.180, Global test loss: 1.219, Global test accuracy: 65.40 

Round  32, Train loss: 0.155, Test loss: 1.129, Test accuracy: 73.56 

Round  32, Global train loss: 0.155, Global test loss: 1.269, Global test accuracy: 65.40 

Round  33, Train loss: 0.123, Test loss: 1.289, Test accuracy: 72.52 

Round  33, Global train loss: 0.123, Global test loss: 1.292, Global test accuracy: 64.28 

Round  34, Train loss: 0.125, Test loss: 1.075, Test accuracy: 76.76 

Round  34, Global train loss: 0.125, Global test loss: 1.215, Global test accuracy: 66.68 

Round  35, Train loss: 0.133, Test loss: 1.334, Test accuracy: 70.72 

Round  35, Global train loss: 0.133, Global test loss: 1.295, Global test accuracy: 65.56 

Round  36, Train loss: 0.128, Test loss: 1.043, Test accuracy: 76.20 

Round  36, Global train loss: 0.128, Global test loss: 1.218, Global test accuracy: 66.72 

Round  37, Train loss: 0.082, Test loss: 1.186, Test accuracy: 74.80 

Round  37, Global train loss: 0.082, Global test loss: 1.265, Global test accuracy: 65.64 

Round  38, Train loss: 0.105, Test loss: 1.126, Test accuracy: 75.96 

Round  38, Global train loss: 0.105, Global test loss: 1.266, Global test accuracy: 67.04 

Round  39, Train loss: 0.086, Test loss: 1.144, Test accuracy: 75.84 

Round  39, Global train loss: 0.086, Global test loss: 1.226, Global test accuracy: 66.24 

Round  40, Train loss: 0.077, Test loss: 1.229, Test accuracy: 74.84 

Round  40, Global train loss: 0.077, Global test loss: 1.285, Global test accuracy: 66.88 

Round  41, Train loss: 0.114, Test loss: 1.333, Test accuracy: 73.40 

Round  41, Global train loss: 0.114, Global test loss: 1.273, Global test accuracy: 66.96 

Round  42, Train loss: 0.095, Test loss: 1.025, Test accuracy: 77.24 

Round  42, Global train loss: 0.095, Global test loss: 1.241, Global test accuracy: 66.32 

Round  43, Train loss: 0.081, Test loss: 1.534, Test accuracy: 72.44 

Round  43, Global train loss: 0.081, Global test loss: 1.332, Global test accuracy: 66.32 

Round  44, Train loss: 0.067, Test loss: 1.154, Test accuracy: 76.92 

Round  44, Global train loss: 0.067, Global test loss: 1.242, Global test accuracy: 66.00 

Round  45, Train loss: 0.060, Test loss: 1.266, Test accuracy: 75.32 

Round  45, Global train loss: 0.060, Global test loss: 1.323, Global test accuracy: 65.88 

Round  46, Train loss: 0.083, Test loss: 1.325, Test accuracy: 74.64 

Round  46, Global train loss: 0.083, Global test loss: 1.295, Global test accuracy: 67.04 

Round  47, Train loss: 0.061, Test loss: 1.114, Test accuracy: 77.64 

Round  47, Global train loss: 0.061, Global test loss: 1.296, Global test accuracy: 66.12 

Round  48, Train loss: 0.060, Test loss: 1.136, Test accuracy: 77.56 

Round  48, Global train loss: 0.060, Global test loss: 1.267, Global test accuracy: 67.72 

Round  49, Train loss: 0.048, Test loss: 1.090, Test accuracy: 77.20 

Round  49, Global train loss: 0.048, Global test loss: 1.246, Global test accuracy: 68.08 

Final Round, Train loss: 0.068, Test loss: 1.243, Test accuracy: 74.44 

Final Round, Global train loss: 0.068, Global test loss: 1.246, Global test accuracy: 68.08 

Average accuracy final 10 rounds: 75.72 

Average global accuracy final 10 rounds: 66.732 

2099.20724773407
[13.06505298614502, 20.50612998008728, 27.684523820877075, 35.00109124183655, 42.13036513328552, 49.44077658653259, 56.56949210166931, 63.129745960235596, 70.38617086410522, 77.36706686019897, 83.75243330001831, 90.8264229297638, 98.0588321685791, 105.36028742790222, 112.241459608078, 119.22247838973999, 126.34775471687317, 133.30553340911865, 140.6161150932312, 147.9561743736267, 154.86247873306274, 161.70641112327576, 168.3583378791809, 175.66913437843323, 183.01798582077026, 190.30170893669128, 197.64479684829712, 204.96542191505432, 212.59117889404297, 220.03864812850952, 227.39578199386597, 234.4362506866455, 241.60523962974548, 248.77421760559082, 256.11250162124634, 263.2175681591034, 270.27106761932373, 277.610196352005, 284.6890699863434, 291.38026237487793, 297.9274706840515, 305.2131724357605, 312.6027150154114, 318.8364477157593, 325.9491288661957, 333.19624423980713, 340.4017581939697, 347.4234836101532, 354.02447962760925, 360.9506404399872, 374.3768198490143]
[51.96, 55.88, 57.6, 56.64, 60.28, 62.8, 65.44, 64.0, 63.0, 65.6, 65.44, 69.08, 67.92, 71.52, 70.52, 70.4, 70.36, 71.96, 73.04, 70.4, 71.12, 70.4, 73.2, 71.84, 74.2, 72.28, 74.28, 73.64, 73.48, 73.88, 74.84, 73.52, 73.56, 72.52, 76.76, 70.72, 76.2, 74.8, 75.96, 75.84, 74.84, 73.4, 77.24, 72.44, 76.92, 75.32, 74.64, 77.64, 77.56, 77.2, 74.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.542, Test loss: 1.863, Test accuracy: 24.44 

Round   1, Train loss: 1.333, Test loss: 1.522, Test accuracy: 38.48 

Round   2, Train loss: 1.229, Test loss: 1.260, Test accuracy: 48.44 

Round   3, Train loss: 1.123, Test loss: 1.151, Test accuracy: 53.52 

Round   4, Train loss: 1.034, Test loss: 1.084, Test accuracy: 57.12 

Round   5, Train loss: 0.977, Test loss: 1.088, Test accuracy: 57.36 

Round   6, Train loss: 0.912, Test loss: 0.964, Test accuracy: 63.24 

Round   7, Train loss: 0.859, Test loss: 0.964, Test accuracy: 63.20 

Round   8, Train loss: 0.817, Test loss: 0.908, Test accuracy: 64.68 

Round   9, Train loss: 0.769, Test loss: 0.860, Test accuracy: 67.04 

Round  10, Train loss: 0.724, Test loss: 0.869, Test accuracy: 67.00 

Round  11, Train loss: 0.683, Test loss: 0.789, Test accuracy: 71.60 

Round  12, Train loss: 0.645, Test loss: 0.753, Test accuracy: 72.40 

Round  13, Train loss: 0.609, Test loss: 0.758, Test accuracy: 71.68 

Round  14, Train loss: 0.583, Test loss: 0.777, Test accuracy: 71.20 

Round  15, Train loss: 0.544, Test loss: 0.733, Test accuracy: 73.52 

Round  16, Train loss: 0.517, Test loss: 0.813, Test accuracy: 71.56 

Round  17, Train loss: 0.495, Test loss: 0.735, Test accuracy: 74.36 

Round  18, Train loss: 0.453, Test loss: 0.722, Test accuracy: 74.84 

Round  19, Train loss: 0.443, Test loss: 0.833, Test accuracy: 72.44 

Round  20, Train loss: 0.414, Test loss: 0.701, Test accuracy: 75.40 

Round  21, Train loss: 0.390, Test loss: 0.700, Test accuracy: 75.56 

Round  22, Train loss: 0.370, Test loss: 0.731, Test accuracy: 75.00 

Round  23, Train loss: 0.348, Test loss: 0.727, Test accuracy: 74.60 

Round  24, Train loss: 0.329, Test loss: 0.692, Test accuracy: 77.20 

Round  25, Train loss: 0.317, Test loss: 0.717, Test accuracy: 75.68 

Round  26, Train loss: 0.284, Test loss: 0.688, Test accuracy: 77.68 

Round  27, Train loss: 0.269, Test loss: 0.719, Test accuracy: 77.68 

Round  28, Train loss: 0.266, Test loss: 0.758, Test accuracy: 76.16 

Round  29, Train loss: 0.244, Test loss: 0.688, Test accuracy: 77.32 

Round  30, Train loss: 0.231, Test loss: 0.713, Test accuracy: 76.80 

Round  31, Train loss: 0.205, Test loss: 0.730, Test accuracy: 77.84 

Round  32, Train loss: 0.210, Test loss: 0.746, Test accuracy: 77.40 

Round  33, Train loss: 0.189, Test loss: 0.758, Test accuracy: 77.76 

Round  34, Train loss: 0.175, Test loss: 0.772, Test accuracy: 76.84 

Round  35, Train loss: 0.165, Test loss: 0.754, Test accuracy: 77.60 

Round  36, Train loss: 0.164, Test loss: 0.737, Test accuracy: 78.04 

Round  37, Train loss: 0.155, Test loss: 0.794, Test accuracy: 77.08 

Round  38, Train loss: 0.136, Test loss: 0.750, Test accuracy: 78.16 

Round  39, Train loss: 0.124, Test loss: 0.754, Test accuracy: 78.92 

Round  40, Train loss: 0.131, Test loss: 0.762, Test accuracy: 78.28 

Round  41, Train loss: 0.124, Test loss: 0.746, Test accuracy: 78.48 

Round  42, Train loss: 0.097, Test loss: 0.775, Test accuracy: 78.20 

Round  43, Train loss: 0.103, Test loss: 0.821, Test accuracy: 77.12 

Round  44, Train loss: 0.099, Test loss: 0.796, Test accuracy: 78.16 

Round  45, Train loss: 0.087, Test loss: 0.765, Test accuracy: 78.56 

Round  46, Train loss: 0.096, Test loss: 0.777, Test accuracy: 78.80 

Round  47, Train loss: 0.092, Test loss: 0.810, Test accuracy: 77.68 

Round  48, Train loss: 0.074, Test loss: 0.799, Test accuracy: 79.48 

Round  49, Train loss: 0.074, Test loss: 0.792, Test accuracy: 78.68 

Final Round, Train loss: 0.037, Test loss: 0.799, Test accuracy: 78.80 

Average accuracy final 10 rounds: 78.344 

1557.2022802829742
[11.402496576309204, 16.996978044509888, 22.353970050811768, 28.167377948760986, 34.0685658454895, 39.47012972831726, 45.45858120918274, 51.30507254600525, 57.03151845932007, 62.659480810165405, 68.29194235801697, 73.96459865570068, 79.7466173171997, 85.19630980491638, 91.13295459747314, 96.93073964118958, 102.75877380371094, 108.33003735542297, 113.476567029953, 119.09539413452148, 124.46562790870667, 129.9603819847107, 135.37059569358826, 141.06816935539246, 146.55632734298706, 152.08163833618164, 157.62521362304688, 163.11908602714539, 168.57250261306763, 174.2543008327484, 179.75447249412537, 185.16182661056519, 190.74000930786133, 196.22067260742188, 201.81535172462463, 207.41261291503906, 212.98121762275696, 218.5040545463562, 223.90348720550537, 229.30730628967285, 234.8391375541687, 240.62671566009521, 246.6074411869049, 252.09765481948853, 257.74970269203186, 263.4060068130493, 269.0644028186798, 274.6891176700592, 280.35497212409973, 285.92569494247437, 292.93869972229004]
[24.44, 38.48, 48.44, 53.52, 57.12, 57.36, 63.24, 63.2, 64.68, 67.04, 67.0, 71.6, 72.4, 71.68, 71.2, 73.52, 71.56, 74.36, 74.84, 72.44, 75.4, 75.56, 75.0, 74.6, 77.2, 75.68, 77.68, 77.68, 76.16, 77.32, 76.8, 77.84, 77.4, 77.76, 76.84, 77.6, 78.04, 77.08, 78.16, 78.92, 78.28, 78.48, 78.2, 77.12, 78.16, 78.56, 78.8, 77.68, 79.48, 78.68, 78.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.550, Test loss: 1.697, Test accuracy: 30.96
Round   1, Train loss: 1.333, Test loss: 1.481, Test accuracy: 37.40
Round   2, Train loss: 1.225, Test loss: 1.313, Test accuracy: 45.92
Round   3, Train loss: 1.104, Test loss: 1.066, Test accuracy: 55.32
Round   4, Train loss: 1.024, Test loss: 1.069, Test accuracy: 57.88
Round   5, Train loss: 0.955, Test loss: 0.936, Test accuracy: 61.20
Round   6, Train loss: 0.903, Test loss: 1.000, Test accuracy: 61.96
Round   7, Train loss: 0.866, Test loss: 0.956, Test accuracy: 64.64
Round   8, Train loss: 0.797, Test loss: 0.836, Test accuracy: 67.08
Round   9, Train loss: 0.756, Test loss: 0.822, Test accuracy: 68.60
Round  10, Train loss: 0.731, Test loss: 0.870, Test accuracy: 67.28
Round  11, Train loss: 0.699, Test loss: 0.866, Test accuracy: 67.08
Round  12, Train loss: 0.660, Test loss: 0.840, Test accuracy: 69.24
Round  13, Train loss: 0.614, Test loss: 0.774, Test accuracy: 71.52
Round  14, Train loss: 0.579, Test loss: 0.818, Test accuracy: 70.12
Round  15, Train loss: 0.552, Test loss: 0.796, Test accuracy: 70.88
Round  16, Train loss: 0.518, Test loss: 0.791, Test accuracy: 72.04
Round  17, Train loss: 0.492, Test loss: 0.713, Test accuracy: 73.88
Round  18, Train loss: 0.454, Test loss: 0.726, Test accuracy: 73.76
Round  19, Train loss: 0.438, Test loss: 0.718, Test accuracy: 74.56
Round  20, Train loss: 0.426, Test loss: 0.731, Test accuracy: 74.00
Round  21, Train loss: 0.393, Test loss: 0.722, Test accuracy: 75.00
Round  22, Train loss: 0.371, Test loss: 0.741, Test accuracy: 75.36
Round  23, Train loss: 0.350, Test loss: 0.730, Test accuracy: 75.44
Round  24, Train loss: 0.329, Test loss: 0.705, Test accuracy: 75.40
Round  25, Train loss: 0.299, Test loss: 0.742, Test accuracy: 75.88
Round  26, Train loss: 0.282, Test loss: 0.690, Test accuracy: 77.60
Round  27, Train loss: 0.268, Test loss: 0.667, Test accuracy: 77.52
Round  28, Train loss: 0.245, Test loss: 0.673, Test accuracy: 78.20
Round  29, Train loss: 0.236, Test loss: 0.703, Test accuracy: 77.08
Round  30, Train loss: 0.218, Test loss: 0.676, Test accuracy: 78.36
Round  31, Train loss: 0.215, Test loss: 0.685, Test accuracy: 77.88
Round  32, Train loss: 0.193, Test loss: 0.701, Test accuracy: 77.88
Round  33, Train loss: 0.186, Test loss: 0.708, Test accuracy: 78.32
Round  34, Train loss: 0.173, Test loss: 0.702, Test accuracy: 78.16
Round  35, Train loss: 0.163, Test loss: 0.733, Test accuracy: 77.08
Round  36, Train loss: 0.169, Test loss: 0.699, Test accuracy: 77.84
Round  37, Train loss: 0.143, Test loss: 0.714, Test accuracy: 78.72
Round  38, Train loss: 0.139, Test loss: 0.715, Test accuracy: 78.80
Round  39, Train loss: 0.135, Test loss: 0.736, Test accuracy: 78.44
Round  40, Train loss: 0.124, Test loss: 0.729, Test accuracy: 78.24
Round  41, Train loss: 0.110, Test loss: 0.731, Test accuracy: 79.28
Round  42, Train loss: 0.107, Test loss: 0.766, Test accuracy: 78.88
Round  43, Train loss: 0.123, Test loss: 0.745, Test accuracy: 78.60
Round  44, Train loss: 0.102, Test loss: 0.723, Test accuracy: 80.12
Round  45, Train loss: 0.085, Test loss: 0.780, Test accuracy: 78.16
Round  46, Train loss: 0.080, Test loss: 0.752, Test accuracy: 79.16
Round  47, Train loss: 0.080, Test loss: 0.771, Test accuracy: 78.76
Round  48, Train loss: 0.086, Test loss: 0.744, Test accuracy: 79.00
Round  49, Train loss: 0.078, Test loss: 0.773, Test accuracy: 79.40
Final Round, Train loss: 0.045, Test loss: 0.775, Test accuracy: 79.40
Average accuracy final 10 rounds: 78.96
1820.47163772583
[13.053866863250732, 19.753934383392334, 26.80952024459839, 33.70088744163513, 40.75575137138367, 47.53350877761841, 54.33811593055725, 61.10746216773987, 68.11963939666748, 75.08190202713013, 81.82490587234497, 87.99052953720093, 94.27595615386963, 100.72259092330933, 106.93653917312622, 112.92989611625671, 118.8385238647461, 125.15555477142334, 130.98068046569824, 137.17899417877197, 143.23789024353027, 149.28443503379822, 156.04189920425415, 162.79590702056885, 169.58197617530823, 176.60043096542358, 183.31986570358276, 190.22950434684753, 197.06485605239868, 203.9728708267212, 210.99592328071594, 218.00927734375, 224.84812712669373, 231.75288558006287, 238.70309138298035, 245.57451343536377, 252.2704541683197, 259.4574065208435, 266.34753608703613, 273.03942608833313, 279.88372921943665, 286.6722116470337, 293.3088366985321, 299.7335216999054, 306.4986090660095, 313.5260181427002, 320.41729068756104, 327.07308435440063, 333.63119983673096, 340.540650844574, 348.6746304035187]
[30.96, 37.4, 45.92, 55.32, 57.88, 61.2, 61.96, 64.64, 67.08, 68.6, 67.28, 67.08, 69.24, 71.52, 70.12, 70.88, 72.04, 73.88, 73.76, 74.56, 74.0, 75.0, 75.36, 75.44, 75.4, 75.88, 77.6, 77.52, 78.2, 77.08, 78.36, 77.88, 77.88, 78.32, 78.16, 77.08, 77.84, 78.72, 78.8, 78.44, 78.24, 79.28, 78.88, 78.6, 80.12, 78.16, 79.16, 78.76, 79.0, 79.4, 79.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.460, Train accuracy: 83.800, Test loss: 1.421, Test accuracy: 60.80 

        train local model (freeze embeding):client   0,  Train loss: 0.230, Train accuracy: 90.800, Test loss: 1.092, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.701, Train accuracy: 82.400, Test loss: 2.084, Test accuracy: 63.00 

Round   0, Train loss: 0.701, Test loss: 2.084, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.147, Train accuracy: 94.800, Test loss: 1.046, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.074, Train accuracy: 97.800, Test loss: 1.068, Test accuracy: 72.20 

Round   1, Train loss: 0.074, Test loss: 1.068, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.055, Train accuracy: 99.000, Test loss: 1.065, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.096, Test accuracy: 74.00 

Round   2, Train loss: 0.041, Test loss: 1.096, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.073, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.087, Train accuracy: 97.200, Test loss: 1.505, Test accuracy: 69.40 

Round   3, Train loss: 0.087, Test loss: 1.505, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.302, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.440, Test accuracy: 70.20 

Round   4, Train loss: 0.026, Test loss: 1.440, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.414, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.086, Train accuracy: 96.800, Test loss: 1.722, Test accuracy: 65.20 

Round   5, Train loss: 0.086, Test loss: 1.722, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.499, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.464, Test accuracy: 67.80 

Round   6, Train loss: 0.035, Test loss: 1.464, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.441, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.406, Test accuracy: 72.20 

Round   7, Train loss: 0.006, Test loss: 1.406, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.463, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.667, Test accuracy: 72.40 

Round   8, Train loss: 0.018, Test loss: 1.667, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.433, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.668, Test accuracy: 70.60 

Round   9, Train loss: 0.003, Test loss: 1.668, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.652, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 1.838, Test accuracy: 66.00 

Round  10, Train loss: 0.042, Test loss: 1.838, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.667, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.840, Test accuracy: 67.80 

Round  11, Train loss: 0.017, Test loss: 1.840, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.732, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.504, Test accuracy: 73.00 

Round  12, Train loss: 0.001, Test loss: 1.504, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.630, Test accuracy: 70.80 

Round  13, Train loss: 0.005, Test loss: 1.630, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.637, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.528, Test accuracy: 73.00 

Round  14, Train loss: 0.006, Test loss: 1.528, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.670, Test accuracy: 73.00 

Round  15, Train loss: 0.021, Test loss: 1.670, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.425, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 72.00 

Round  16, Train loss: 0.001, Test loss: 1.570, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.558, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 73.60 

Round  17, Train loss: 0.000, Test loss: 1.510, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 73.60 

Round  18, Train loss: 0.000, Test loss: 1.521, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.535, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 98.800, Test loss: 2.130, Test accuracy: 68.60 

Round  19, Train loss: 0.034, Test loss: 2.130, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.713, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.647, Test accuracy: 70.40 

Final Round, Train loss: 0.007, Test loss: 1.830, Test accuracy: 69.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 1.027, Train accuracy: 60.600, Test loss: 1.309, Test accuracy: 49.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.580, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.856, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.961, Train accuracy: 63.400, Test loss: 1.259, Test accuracy: 49.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.388, Train accuracy: 85.000, Test loss: 1.621, Test accuracy: 57.80 

Round   0, Train loss: 0.195, Test loss: 1.452, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.528, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 74.20 

        train local model (freeze embeding):client   1,  Train loss: 0.597, Train accuracy: 78.600, Test loss: 1.446, Test accuracy: 53.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.418, Train accuracy: 83.600, Test loss: 1.949, Test accuracy: 51.80 

Round   1, Train loss: 0.209, Test loss: 1.441, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.309, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.239, Train accuracy: 91.400, Test loss: 1.325, Test accuracy: 58.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.112, Train accuracy: 97.600, Test loss: 1.499, Test accuracy: 59.80 

Round   2, Train loss: 0.059, Test loss: 1.298, Test accuracy: 66.40 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.157, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 98.800, Test loss: 1.814, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.121, Train accuracy: 97.000, Test loss: 1.455, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.192, Train accuracy: 92.400, Test loss: 2.067, Test accuracy: 51.60 

Round   3, Train loss: 0.108, Test loss: 1.601, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.243, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.509, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.086, Train accuracy: 97.000, Test loss: 1.646, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.125, Train accuracy: 95.800, Test loss: 1.809, Test accuracy: 58.20 

Round   4, Train loss: 0.065, Test loss: 1.395, Test accuracy: 66.90 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.217, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.069, Train accuracy: 98.200, Test loss: 1.646, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.067, Train accuracy: 98.400, Test loss: 1.867, Test accuracy: 61.40 

Round   5, Train loss: 0.034, Test loss: 1.430, Test accuracy: 67.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.663, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 2.186, Test accuracy: 56.40 

Round   6, Train loss: 0.038, Test loss: 1.529, Test accuracy: 65.30 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.208, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.266, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.800, Test loss: 1.829, Test accuracy: 57.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.999, Test accuracy: 58.60 

Round   7, Train loss: 0.011, Test loss: 1.549, Test accuracy: 65.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 74.60 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 1.842, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.170, Train accuracy: 92.600, Test loss: 2.628, Test accuracy: 54.20 

Round   8, Train loss: 0.086, Test loss: 1.711, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.181, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.893, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.402, Train accuracy: 89.000, Test loss: 2.803, Test accuracy: 55.40 

Round   9, Train loss: 0.201, Test loss: 1.693, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.242, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 74.40 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.943, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 98.600, Test loss: 2.477, Test accuracy: 55.40 

Round  10, Train loss: 0.019, Test loss: 1.653, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 2.048, Test accuracy: 58.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 2.128, Test accuracy: 58.00 

Round  11, Train loss: 0.009, Test loss: 1.664, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.900, Test accuracy: 59.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 2.373, Test accuracy: 59.00 

Round  12, Train loss: 0.015, Test loss: 1.585, Test accuracy: 68.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.471, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.916, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.437, Test accuracy: 58.80 

Round  13, Train loss: 0.006, Test loss: 1.642, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.315, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.319, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.133, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.400, Test loss: 2.394, Test accuracy: 61.20 

Round  14, Train loss: 0.016, Test loss: 1.682, Test accuracy: 66.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.119, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 2.276, Test accuracy: 59.00 

Round  15, Train loss: 0.004, Test loss: 1.718, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.141, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 97.800, Test loss: 2.560, Test accuracy: 58.60 

Round  16, Train loss: 0.024, Test loss: 1.700, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.134, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.120, Test accuracy: 61.20 

Round  17, Train loss: 0.001, Test loss: 1.682, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.042, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 2.143, Test accuracy: 62.20 

Round  18, Train loss: 0.006, Test loss: 1.773, Test accuracy: 68.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 74.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.045, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.103, Test accuracy: 61.20 

Round  19, Train loss: 0.001, Test loss: 1.737, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.078, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.107, Test accuracy: 61.40 

Final Round, Train loss: 0.000, Test loss: 1.727, Test accuracy: 67.80 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.621, Train accuracy: 77.800, Test loss: 0.813, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.604, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.075, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.339, Test accuracy: 61.60 

        train local model (freeze embeding):client   2,  Train loss: 0.633, Train accuracy: 76.600, Test loss: 0.851, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.233, Train accuracy: 91.400, Test loss: 1.193, Test accuracy: 70.40 

Round   0, Train loss: 0.082, Test loss: 1.337, Test accuracy: 70.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.216, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.426, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.993, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 2.539, Test accuracy: 58.00 

        train local model (freeze embeding):client   2,  Train loss: 0.358, Train accuracy: 87.600, Test loss: 0.778, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.072, Train accuracy: 97.600, Test loss: 1.193, Test accuracy: 70.20 

Round   1, Train loss: 0.034, Test loss: 1.342, Test accuracy: 71.27 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.220, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.041, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.217, Test accuracy: 62.20 

        train local model (freeze embeding):client   2,  Train loss: 0.156, Train accuracy: 94.800, Test loss: 0.819, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.145, Train accuracy: 93.800, Test loss: 1.155, Test accuracy: 72.40 

Round   2, Train loss: 0.049, Test loss: 1.274, Test accuracy: 73.87 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.279, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.030, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.187, Test accuracy: 58.80 

        train local model (freeze embeding):client   2,  Train loss: 0.074, Train accuracy: 98.000, Test loss: 0.851, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 1.242, Test accuracy: 72.60 

Round   3, Train loss: 0.018, Test loss: 1.307, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.674, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.974, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.124, Test accuracy: 61.80 

        train local model (freeze embeding):client   2,  Train loss: 0.051, Train accuracy: 99.200, Test loss: 0.904, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.458, Train accuracy: 88.400, Test loss: 1.806, Test accuracy: 67.40 

Round   4, Train loss: 0.156, Test loss: 1.300, Test accuracy: 72.73 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.337, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.135, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 98.800, Test loss: 2.475, Test accuracy: 57.20 

        train local model (freeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.600, Test loss: 0.929, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.400, Test loss: 1.229, Test accuracy: 77.80 

Round   5, Train loss: 0.026, Test loss: 1.281, Test accuracy: 73.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.092, Train accuracy: 97.600, Test loss: 1.566, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.030, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.195, Test accuracy: 63.00 

        train local model (freeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.400, Test loss: 0.923, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.115, Test accuracy: 76.00 

Round   6, Train loss: 0.033, Test loss: 1.270, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.027, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.056, Test accuracy: 58.40 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 0.949, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 99.200, Test loss: 1.463, Test accuracy: 72.60 

Round   7, Train loss: 0.016, Test loss: 1.290, Test accuracy: 73.27 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.976, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.106, Train accuracy: 97.800, Test loss: 2.626, Test accuracy: 54.40 

        train local model (freeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 0.918, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.125, Train accuracy: 95.600, Test loss: 1.412, Test accuracy: 72.20 

Round   8, Train loss: 0.077, Test loss: 1.360, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.301, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.965, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.045, Train accuracy: 98.600, Test loss: 2.512, Test accuracy: 57.20 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 1.080, Test accuracy: 74.20 

Round   9, Train loss: 0.024, Test loss: 1.318, Test accuracy: 73.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.027, Test accuracy: 59.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.187, Test accuracy: 61.20 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.074, Test accuracy: 78.00 

Round  10, Train loss: 0.002, Test loss: 1.324, Test accuracy: 74.87 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.972, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.121, Train accuracy: 97.000, Test loss: 3.222, Test accuracy: 60.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 78.20 

Round  11, Train loss: 0.041, Test loss: 1.418, Test accuracy: 74.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.124, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.143, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.093, Train accuracy: 97.400, Test loss: 2.564, Test accuracy: 58.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.969, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 75.00 

Round  12, Train loss: 0.032, Test loss: 1.346, Test accuracy: 73.93 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.207, Test accuracy: 60.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 2.266, Test accuracy: 61.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.173, Test accuracy: 77.00 

Round  13, Train loss: 0.009, Test loss: 1.304, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.095, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 2.525, Test accuracy: 57.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 1.066, Test accuracy: 78.60 

Round  14, Train loss: 0.012, Test loss: 1.322, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.179, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.185, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.182, Test accuracy: 60.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 78.80 

Round  15, Train loss: 0.001, Test loss: 1.304, Test accuracy: 74.13 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.050, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.220, Test accuracy: 62.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 98.200, Test loss: 1.443, Test accuracy: 72.80 

Round  16, Train loss: 0.017, Test loss: 1.338, Test accuracy: 74.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.161, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 2.682, Test accuracy: 56.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 80.20 

Round  17, Train loss: 0.007, Test loss: 1.328, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.123, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.257, Test accuracy: 60.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 81.40 

Round  18, Train loss: 0.000, Test loss: 1.315, Test accuracy: 73.53 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.105, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.126, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.306, Test accuracy: 60.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 78.40 

Round  19, Train loss: 0.001, Test loss: 1.307, Test accuracy: 74.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.121, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.118, Test accuracy: 60.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 80.00 

Final Round, Train loss: 0.000, Test loss: 1.297, Test accuracy: 74.00 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.662, Train accuracy: 74.400, Test loss: 0.903, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.105, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.658, Test accuracy: 58.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.627, Train accuracy: 75.800, Test loss: 0.854, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.125, Train accuracy: 95.600, Test loss: 1.208, Test accuracy: 64.80 

Round   0, Train loss: 0.032, Test loss: 1.199, Test accuracy: 73.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.148, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 2.339, Test accuracy: 61.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.189, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.358, Train accuracy: 87.600, Test loss: 0.904, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.124, Train accuracy: 95.400, Test loss: 1.255, Test accuracy: 67.00 

Round   1, Train loss: 0.035, Test loss: 1.190, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.230, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.054, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.550, Test accuracy: 59.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 75.40 

        train local model (freeze embeding):client   3,  Train loss: 0.243, Train accuracy: 91.800, Test loss: 0.975, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.054, Train accuracy: 99.000, Test loss: 1.349, Test accuracy: 67.80 

Round   2, Train loss: 0.016, Test loss: 1.218, Test accuracy: 73.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.600, Test loss: 1.004, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.124, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.251, Test accuracy: 61.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.271, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.132, Train accuracy: 96.000, Test loss: 0.999, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.103, Train accuracy: 96.200, Test loss: 1.349, Test accuracy: 70.00 

Round   3, Train loss: 0.032, Test loss: 1.154, Test accuracy: 74.45 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.948, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 2.373, Test accuracy: 58.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.003, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.274, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.077, Train accuracy: 98.200, Test loss: 1.071, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.400, Test loss: 1.504, Test accuracy: 65.20 

Round   4, Train loss: 0.022, Test loss: 1.211, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.914, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.184, Test accuracy: 63.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.328, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.068, Train accuracy: 98.200, Test loss: 1.124, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.106, Train accuracy: 96.400, Test loss: 1.511, Test accuracy: 68.20 

Round   5, Train loss: 0.033, Test loss: 1.201, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 81.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.980, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.333, Test accuracy: 58.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.043, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.800, Test loss: 1.157, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.060, Train accuracy: 98.000, Test loss: 1.484, Test accuracy: 68.60 

Round   6, Train loss: 0.017, Test loss: 1.210, Test accuracy: 73.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.902, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.134, Test accuracy: 63.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.027, Test accuracy: 81.40 

        train local model (freeze embeding):client   3,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.504, Test accuracy: 69.00 

Round   7, Train loss: 0.004, Test loss: 1.195, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.931, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 2.358, Test accuracy: 60.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 98.400, Test loss: 1.758, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.690, Test accuracy: 68.60 

Round   8, Train loss: 0.030, Test loss: 1.234, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.009, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.064, Test accuracy: 61.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.077, Train accuracy: 98.200, Test loss: 1.658, Test accuracy: 65.40 

Round   9, Train loss: 0.021, Test loss: 1.221, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.939, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.376, Test accuracy: 62.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 78.40 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.767, Test accuracy: 65.40 

Round  10, Train loss: 0.007, Test loss: 1.317, Test accuracy: 73.45 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.025, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.027, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.086, Test accuracy: 61.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.174, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.322, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.660, Test accuracy: 68.80 

Round  11, Train loss: 0.003, Test loss: 1.230, Test accuracy: 73.85 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.991, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.310, Test accuracy: 60.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 1.210, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.512, Test accuracy: 70.20 

Round  12, Train loss: 0.011, Test loss: 1.264, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.085, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.020, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.275, Test accuracy: 60.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 79.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.626, Test accuracy: 68.80 

Round  13, Train loss: 0.005, Test loss: 1.245, Test accuracy: 74.95 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.959, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.153, Test accuracy: 61.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 79.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.923, Test accuracy: 65.00 

Round  14, Train loss: 0.009, Test loss: 1.264, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.890, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.952, Test accuracy: 64.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.607, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 70.80 

Round  15, Train loss: 0.004, Test loss: 1.281, Test accuracy: 73.85 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.944, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.134, Test accuracy: 65.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.041, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.400, Test loss: 1.746, Test accuracy: 69.00 

Round  16, Train loss: 0.003, Test loss: 1.291, Test accuracy: 74.05 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.975, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.071, Test accuracy: 65.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 79.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.516, Test accuracy: 70.00 

Round  17, Train loss: 0.000, Test loss: 1.304, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.960, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.097, Test accuracy: 64.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.025, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.619, Test accuracy: 69.40 

Round  18, Train loss: 0.001, Test loss: 1.287, Test accuracy: 74.05 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.971, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.228, Test accuracy: 62.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.177, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.475, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.453, Test accuracy: 71.40 

Round  19, Train loss: 0.001, Test loss: 1.287, Test accuracy: 74.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.954, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.003, Test accuracy: 66.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.448, Test accuracy: 70.20 

Final Round, Train loss: 0.000, Test loss: 1.281, Test accuracy: 74.85 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.481, Train accuracy: 80.600, Test loss: 0.529, Test accuracy: 82.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 82.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.979, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.453, Test accuracy: 61.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.466, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.685, Test accuracy: 70.40 

        train local model (freeze embeding):client   4,  Train loss: 0.451, Train accuracy: 84.000, Test loss: 0.534, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.051, Train accuracy: 99.200, Test loss: 0.815, Test accuracy: 78.60 

Round   0, Train loss: 0.012, Test loss: 1.117, Test accuracy: 76.52 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 83.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.923, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.126, Test accuracy: 63.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 78.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.609, Test accuracy: 72.00 

        train local model (freeze embeding):client   4,  Train loss: 0.311, Train accuracy: 89.800, Test loss: 0.641, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 0.655, Test accuracy: 79.60 

Round   1, Train loss: 0.010, Test loss: 1.089, Test accuracy: 76.48 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 1.388, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.975, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.081, Test accuracy: 63.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 79.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.550, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.172, Train accuracy: 94.800, Test loss: 0.601, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.060, Train accuracy: 98.600, Test loss: 0.747, Test accuracy: 80.20 

Round   2, Train loss: 0.022, Test loss: 1.114, Test accuracy: 75.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.097, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.002, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.074, Train accuracy: 97.600, Test loss: 2.629, Test accuracy: 57.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.061, Train accuracy: 98.000, Test loss: 2.530, Test accuracy: 62.80 

        train local model (freeze embeding):client   4,  Train loss: 0.099, Train accuracy: 97.200, Test loss: 0.566, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.051, Train accuracy: 98.600, Test loss: 0.818, Test accuracy: 78.40 

Round   3, Train loss: 0.042, Test loss: 1.161, Test accuracy: 75.64 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.885, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.978, Test accuracy: 64.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.396, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.797, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.069, Train accuracy: 98.600, Test loss: 0.559, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 0.807, Test accuracy: 78.20 

Round   4, Train loss: 0.008, Test loss: 1.093, Test accuracy: 77.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.790, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 2.706, Test accuracy: 61.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 97.200, Test loss: 1.549, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.140, Train accuracy: 96.200, Test loss: 2.301, Test accuracy: 62.20 

        train local model (freeze embeding):client   4,  Train loss: 0.059, Train accuracy: 98.800, Test loss: 0.550, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.064, Train accuracy: 98.000, Test loss: 0.905, Test accuracy: 76.40 

Round   5, Train loss: 0.057, Test loss: 1.117, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.839, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.021, Test accuracy: 63.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 78.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.438, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 71.80 

        train local model (freeze embeding):client   4,  Train loss: 0.034, Train accuracy: 99.400, Test loss: 0.544, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 98.000, Test loss: 0.841, Test accuracy: 81.00 

Round   6, Train loss: 0.010, Test loss: 1.143, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.837, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.294, Test accuracy: 63.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.114, Train accuracy: 95.400, Test loss: 2.279, Test accuracy: 66.60 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 0.578, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.105, Train accuracy: 96.000, Test loss: 1.093, Test accuracy: 76.20 

Round   7, Train loss: 0.045, Test loss: 1.130, Test accuracy: 76.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.807, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.462, Test accuracy: 62.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.426, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 0.555, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 0.748, Test accuracy: 80.60 

Round   8, Train loss: 0.005, Test loss: 1.100, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.100, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.922, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.166, Test accuracy: 63.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 80.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 69.40 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 0.793, Test accuracy: 80.60 

Round   9, Train loss: 0.008, Test loss: 1.101, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.200, Test loss: 1.211, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.813, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.165, Test accuracy: 61.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.620, Test accuracy: 70.00 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 0.588, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 1.047, Test accuracy: 79.00 

Round  10, Train loss: 0.018, Test loss: 1.086, Test accuracy: 78.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.208, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.813, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.843, Test accuracy: 65.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 80.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.424, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.631, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 80.60 

Round  11, Train loss: 0.005, Test loss: 1.131, Test accuracy: 77.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.896, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.360, Test accuracy: 62.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.476, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.694, Test accuracy: 68.80 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 81.40 

Round  12, Train loss: 0.003, Test loss: 1.132, Test accuracy: 76.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.933, Test accuracy: 83.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.917, Test accuracy: 65.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.284, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 72.40 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.719, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 79.20 

Round  13, Train loss: 0.004, Test loss: 1.138, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 83.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.838, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.973, Test accuracy: 64.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.023, Test accuracy: 78.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.999, Test accuracy: 67.80 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.883, Test accuracy: 82.00 

Round  14, Train loss: 0.007, Test loss: 1.112, Test accuracy: 77.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.764, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.824, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 72.20 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.080, Train accuracy: 97.000, Test loss: 1.171, Test accuracy: 75.60 

Round  15, Train loss: 0.017, Test loss: 1.105, Test accuracy: 77.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.795, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.110, Test accuracy: 63.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.131, Test accuracy: 78.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.120, Train accuracy: 96.600, Test loss: 1.942, Test accuracy: 67.80 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.672, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 83.80 

Round  16, Train loss: 0.025, Test loss: 1.072, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.767, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.145, Test accuracy: 62.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.670, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.667, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.748, Test accuracy: 84.00 

Round  17, Train loss: 0.001, Test loss: 1.090, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.766, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.919, Test accuracy: 65.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.552, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.721, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 81.80 

Round  18, Train loss: 0.001, Test loss: 1.080, Test accuracy: 77.64 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 82.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.762, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.773, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 81.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.499, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.703, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 0.798, Test accuracy: 81.60 

Round  19, Train loss: 0.002, Test loss: 1.064, Test accuracy: 77.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.823, Test accuracy: 83.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.731, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 74.20 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 83.60 

Final Round, Train loss: 0.000, Test loss: 1.072, Test accuracy: 77.96 

Average accuracy final 10 rounds: 364.3473333333333 

6224.807573318481
[19.288302183151245, 39.17168140411377, 58.949791431427, 78.2998309135437, 97.88852047920227, 117.10883593559265, 136.41392755508423, 155.70485877990723, 174.82979083061218, 194.07944226264954, 213.68509674072266, 232.5062141418457, 251.9781198501587, 271.3573844432831, 290.76584124565125, 310.0003960132599, 329.3560767173767, 349.21733689308167, 368.6687273979187, 387.8246283531189, 399.7246558666229, 419.9365918636322, 439.51354241371155, 458.8299946784973, 478.7945144176483, 498.6615903377533, 518.3558654785156, 537.5091598033905, 556.8204185962677, 576.3807253837585, 596.145587682724, 616.1142246723175, 635.9784579277039, 655.2976369857788, 674.9197738170624, 694.4436731338501, 714.6908209323883, 734.5657076835632, 754.3108947277069, 773.7758066654205, 792.5596482753754, 804.7843210697174, 824.9431247711182, 844.7346510887146, 864.2891547679901, 883.832596540451, 903.412743806839, 923.1037089824677, 942.4213733673096, 962.5650382041931, 982.1912314891815, 1001.4722394943237, 1020.8310730457306, 1039.7797660827637, 1059.5131027698517, 1078.8271324634552, 1097.9309017658234, 1117.7979011535645, 1137.0466809272766, 1156.4867510795593, 1175.6905961036682, 1195.0568370819092, 1206.5145812034607, 1226.045393705368, 1245.411281824112, 1264.620572090149, 1283.7277562618256, 1303.1061661243439, 1322.7108886241913, 1341.961881160736, 1361.0798621177673, 1380.0790195465088, 1399.1102430820465, 1418.8240249156952, 1438.5428221225739, 1458.0220429897308, 1477.148401260376, 1496.6807992458344, 1516.817188501358, 1536.0823774337769, 1555.6827685832977, 1575.1332094669342, 1594.3409535884857, 1606.1708755493164, 1625.3972012996674, 1644.3389465808868, 1664.0114858150482, 1683.7024099826813, 1702.7939128875732, 1722.281438112259, 1741.6251804828644, 1760.867588043213, 1780.3628118038177, 1799.4023060798645, 1819.042888879776, 1838.0447261333466, 1857.3551042079926, 1876.872002363205, 1896.6254251003265, 1915.6484153270721, 1934.7664592266083, 1954.4621233940125, 1973.5131657123566, 1992.9281334877014, 2004.7706007957458]
[63.0, 72.2, 74.0, 69.4, 70.2, 65.2, 67.8, 72.2, 72.4, 70.6, 66.0, 67.8, 73.0, 70.8, 73.0, 73.0, 72.0, 73.6, 73.6, 68.6, 69.6, 63.0, 62.8, 66.4, 63.8, 66.9, 67.5, 65.3, 65.5, 65.0, 65.0, 66.0, 65.6, 68.7, 67.0, 66.7, 67.8, 67.8, 67.8, 68.1, 67.8, 67.8, 70.93333333333334, 71.26666666666667, 73.86666666666666, 72.2, 72.73333333333333, 73.66666666666667, 73.4, 73.26666666666667, 72.6, 73.06666666666666, 74.86666666666666, 74.06666666666666, 73.93333333333334, 74.4, 74.2, 74.13333333333334, 74.66666666666667, 74.6, 73.53333333333333, 74.33333333333333, 74.0, 73.3, 73.6, 73.5, 74.45, 73.6, 73.0, 73.7, 74.8, 74.0, 73.8, 73.45, 73.85, 74.3, 74.95, 74.3, 73.85, 74.05, 74.3, 74.05, 74.7, 74.85, 76.52, 76.48, 75.88, 75.64, 77.48, 76.6, 76.8, 76.24, 76.8, 76.96, 78.24, 77.24, 76.88, 77.0, 77.24, 77.48, 76.96, 77.8, 77.64, 77.76, 77.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.499, Test loss: 1.266, Test accuracy: 48.24 

Round   0, Global train loss: 1.499, Global test loss: 2.460, Global test accuracy: 20.00 

Round   1, Train loss: 1.166, Test loss: 1.468, Test accuracy: 50.00 

Round   1, Global train loss: 1.166, Global test loss: 2.415, Global test accuracy: 20.00 

Round   2, Train loss: 1.004, Test loss: 1.307, Test accuracy: 53.96 

Round   2, Global train loss: 1.004, Global test loss: 2.372, Global test accuracy: 20.04 

Round   3, Train loss: 0.856, Test loss: 1.489, Test accuracy: 54.08 

Round   3, Global train loss: 0.856, Global test loss: 2.311, Global test accuracy: 17.76 

Round   4, Train loss: 0.753, Test loss: 1.389, Test accuracy: 57.04 

Round   4, Global train loss: 0.753, Global test loss: 2.312, Global test accuracy: 24.80 

Round   5, Train loss: 0.657, Test loss: 1.358, Test accuracy: 59.60 

Round   5, Global train loss: 0.657, Global test loss: 2.267, Global test accuracy: 17.24 

Round   6, Train loss: 0.555, Test loss: 1.606, Test accuracy: 57.40 

Round   6, Global train loss: 0.555, Global test loss: 2.245, Global test accuracy: 16.00 

Round   7, Train loss: 0.470, Test loss: 1.604, Test accuracy: 59.72 

Round   7, Global train loss: 0.470, Global test loss: 2.275, Global test accuracy: 16.08 

Round   8, Train loss: 0.411, Test loss: 1.684, Test accuracy: 58.76 

Round   8, Global train loss: 0.411, Global test loss: 2.212, Global test accuracy: 18.56 

Round   9, Train loss: 0.335, Test loss: 1.741, Test accuracy: 61.24 

Round   9, Global train loss: 0.335, Global test loss: 2.205, Global test accuracy: 17.72 

Round  10, Train loss: 0.296, Test loss: 1.709, Test accuracy: 62.28 

Round  10, Global train loss: 0.296, Global test loss: 2.194, Global test accuracy: 16.28 

Round  11, Train loss: 0.258, Test loss: 1.999, Test accuracy: 57.28 

Round  11, Global train loss: 0.258, Global test loss: 2.178, Global test accuracy: 17.40 

Round  12, Train loss: 0.218, Test loss: 1.852, Test accuracy: 62.16 

Round  12, Global train loss: 0.218, Global test loss: 2.197, Global test accuracy: 20.68 

Round  13, Train loss: 0.182, Test loss: 1.801, Test accuracy: 63.32 

Round  13, Global train loss: 0.182, Global test loss: 2.193, Global test accuracy: 17.12 

Round  14, Train loss: 0.152, Test loss: 1.896, Test accuracy: 62.68 

Round  14, Global train loss: 0.152, Global test loss: 2.172, Global test accuracy: 17.24 

Round  15, Train loss: 0.147, Test loss: 1.823, Test accuracy: 62.68 

Round  15, Global train loss: 0.147, Global test loss: 2.215, Global test accuracy: 16.04 

Round  16, Train loss: 0.128, Test loss: 1.983, Test accuracy: 63.72 

Round  16, Global train loss: 0.128, Global test loss: 2.192, Global test accuracy: 16.08 

Round  17, Train loss: 0.108, Test loss: 1.970, Test accuracy: 63.92 

Round  17, Global train loss: 0.108, Global test loss: 2.224, Global test accuracy: 16.00 

Round  18, Train loss: 0.089, Test loss: 2.079, Test accuracy: 62.52 

Round  18, Global train loss: 0.089, Global test loss: 2.196, Global test accuracy: 17.48 

Round  19, Train loss: 0.081, Test loss: 1.950, Test accuracy: 63.68 

Round  19, Global train loss: 0.081, Global test loss: 2.222, Global test accuracy: 16.28 

Round  20, Train loss: 0.082, Test loss: 2.041, Test accuracy: 64.44 

Round  20, Global train loss: 0.082, Global test loss: 2.181, Global test accuracy: 16.60 

Round  21, Train loss: 0.075, Test loss: 2.122, Test accuracy: 63.48 

Round  21, Global train loss: 0.075, Global test loss: 2.234, Global test accuracy: 16.00 

Round  22, Train loss: 0.072, Test loss: 2.023, Test accuracy: 64.36 

Round  22, Global train loss: 0.072, Global test loss: 2.248, Global test accuracy: 16.00 

Round  23, Train loss: 0.054, Test loss: 2.074, Test accuracy: 63.96 

Round  23, Global train loss: 0.054, Global test loss: 2.250, Global test accuracy: 16.08 

Round  24, Train loss: 0.058, Test loss: 2.071, Test accuracy: 64.04 

Round  24, Global train loss: 0.058, Global test loss: 2.264, Global test accuracy: 16.04 

Round  25, Train loss: 0.044, Test loss: 2.104, Test accuracy: 64.12 

Round  25, Global train loss: 0.044, Global test loss: 2.264, Global test accuracy: 16.00 

Round  26, Train loss: 0.050, Test loss: 2.003, Test accuracy: 64.92 

Round  26, Global train loss: 0.050, Global test loss: 2.277, Global test accuracy: 16.00 

Round  27, Train loss: 0.040, Test loss: 2.058, Test accuracy: 65.52 

Round  27, Global train loss: 0.040, Global test loss: 2.223, Global test accuracy: 16.04 

Round  28, Train loss: 0.038, Test loss: 2.174, Test accuracy: 64.72 

Round  28, Global train loss: 0.038, Global test loss: 2.278, Global test accuracy: 16.00 

Round  29, Train loss: 0.032, Test loss: 2.122, Test accuracy: 63.96 

Round  29, Global train loss: 0.032, Global test loss: 2.243, Global test accuracy: 16.04 

Round  30, Train loss: 0.045, Test loss: 2.326, Test accuracy: 63.76 

Round  30, Global train loss: 0.045, Global test loss: 2.227, Global test accuracy: 16.04 

Round  31, Train loss: 0.033, Test loss: 2.353, Test accuracy: 62.96 

Round  31, Global train loss: 0.033, Global test loss: 2.248, Global test accuracy: 16.00 

Round  32, Train loss: 0.033, Test loss: 2.084, Test accuracy: 65.24 

Round  32, Global train loss: 0.033, Global test loss: 2.263, Global test accuracy: 16.00 

Round  33, Train loss: 0.032, Test loss: 2.105, Test accuracy: 65.68 

Round  33, Global train loss: 0.032, Global test loss: 2.273, Global test accuracy: 16.00 

Round  34, Train loss: 0.025, Test loss: 2.108, Test accuracy: 64.96 

Round  34, Global train loss: 0.025, Global test loss: 2.289, Global test accuracy: 16.00 

Final Round, Train loss: 0.019, Test loss: 2.153, Test accuracy: 66.44 

Final Round, Global train loss: 0.019, Global test loss: 2.289, Global test accuracy: 16.00 

Average accuracy final 10 rounds: 64.58399999999999 

Average global accuracy final 10 rounds: 16.011999999999997 

1452.040387392044
[12.705241680145264, 19.42298436164856, 26.212915658950806, 33.01697659492493, 39.71532845497131, 46.478580474853516, 53.22637486457825, 60.151618003845215, 66.89984703063965, 73.44439148902893, 80.32455372810364, 86.98584699630737, 93.84521079063416, 100.4882230758667, 107.62530660629272, 114.47526025772095, 121.26009702682495, 128.2653992176056, 134.9961895942688, 141.7563498020172, 148.45682048797607, 155.0911831855774, 162.01900029182434, 168.75703191757202, 175.47729516029358, 182.40857768058777, 188.9802439212799, 195.7318730354309, 202.49939441680908, 209.3843343257904, 216.05794072151184, 222.73710131645203, 229.51632523536682, 236.24295735359192, 243.21753430366516, 256.9455282688141]
[48.24, 50.0, 53.96, 54.08, 57.04, 59.6, 57.4, 59.72, 58.76, 61.24, 62.28, 57.28, 62.16, 63.32, 62.68, 62.68, 63.72, 63.92, 62.52, 63.68, 64.44, 63.48, 64.36, 63.96, 64.04, 64.12, 64.92, 65.52, 64.72, 63.96, 63.76, 62.96, 65.24, 65.68, 64.96, 66.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.492, Test loss: 1.284, Test accuracy: 49.64 

Round   0, Global train loss: 1.492, Global test loss: 2.283, Global test accuracy: 20.00 

Round   1, Train loss: 1.369, Test loss: 1.558, Test accuracy: 47.08 

Round   1, Global train loss: 1.369, Global test loss: 2.103, Global test accuracy: 25.40 

Round   2, Train loss: 1.240, Test loss: 1.278, Test accuracy: 53.52 

Round   2, Global train loss: 1.240, Global test loss: 1.635, Global test accuracy: 42.16 

Round   3, Train loss: 1.112, Test loss: 1.341, Test accuracy: 53.44 

Round   3, Global train loss: 1.112, Global test loss: 1.662, Global test accuracy: 44.28 

Round   4, Train loss: 1.008, Test loss: 1.183, Test accuracy: 57.60 

Round   4, Global train loss: 1.008, Global test loss: 1.544, Global test accuracy: 49.92 

Round   5, Train loss: 0.938, Test loss: 1.082, Test accuracy: 63.00 

Round   5, Global train loss: 0.938, Global test loss: 1.435, Global test accuracy: 54.20 

Round   6, Train loss: 0.858, Test loss: 1.318, Test accuracy: 60.20 

Round   6, Global train loss: 0.858, Global test loss: 1.396, Global test accuracy: 56.12 

Round   7, Train loss: 0.806, Test loss: 1.249, Test accuracy: 60.84 

Round   7, Global train loss: 0.806, Global test loss: 1.286, Global test accuracy: 58.44 

Round   8, Train loss: 0.758, Test loss: 1.388, Test accuracy: 61.08 

Round   8, Global train loss: 0.758, Global test loss: 1.644, Global test accuracy: 52.44 

Round   9, Train loss: 0.699, Test loss: 1.115, Test accuracy: 63.00 

Round   9, Global train loss: 0.699, Global test loss: 1.404, Global test accuracy: 56.64 

Round  10, Train loss: 0.643, Test loss: 1.175, Test accuracy: 62.64 

Round  10, Global train loss: 0.643, Global test loss: 1.314, Global test accuracy: 60.64 

Round  11, Train loss: 0.599, Test loss: 1.106, Test accuracy: 67.16 

Round  11, Global train loss: 0.599, Global test loss: 1.326, Global test accuracy: 60.68 

Round  12, Train loss: 0.564, Test loss: 1.270, Test accuracy: 65.80 

Round  12, Global train loss: 0.564, Global test loss: 1.316, Global test accuracy: 60.80 

Round  13, Train loss: 0.506, Test loss: 1.211, Test accuracy: 64.32 

Round  13, Global train loss: 0.506, Global test loss: 1.306, Global test accuracy: 61.28 

Round  14, Train loss: 0.494, Test loss: 1.191, Test accuracy: 66.76 

Round  14, Global train loss: 0.494, Global test loss: 1.207, Global test accuracy: 63.56 

Round  15, Train loss: 0.456, Test loss: 1.278, Test accuracy: 66.08 

Round  15, Global train loss: 0.456, Global test loss: 1.213, Global test accuracy: 64.36 

Round  16, Train loss: 0.448, Test loss: 1.083, Test accuracy: 69.96 

Round  16, Global train loss: 0.448, Global test loss: 1.276, Global test accuracy: 63.68 

Round  17, Train loss: 0.394, Test loss: 1.236, Test accuracy: 69.44 

Round  17, Global train loss: 0.394, Global test loss: 1.289, Global test accuracy: 63.56 

Round  18, Train loss: 0.356, Test loss: 1.254, Test accuracy: 68.48 

Round  18, Global train loss: 0.356, Global test loss: 1.214, Global test accuracy: 65.48 

Round  19, Train loss: 0.354, Test loss: 1.125, Test accuracy: 71.00 

Round  19, Global train loss: 0.354, Global test loss: 1.284, Global test accuracy: 64.84 

Round  20, Train loss: 0.336, Test loss: 1.226, Test accuracy: 68.48 

Round  20, Global train loss: 0.336, Global test loss: 1.260, Global test accuracy: 65.56 

Round  21, Train loss: 0.298, Test loss: 1.296, Test accuracy: 70.08 

Round  21, Global train loss: 0.298, Global test loss: 1.227, Global test accuracy: 66.32 

Round  22, Train loss: 0.282, Test loss: 1.227, Test accuracy: 70.52 

Round  22, Global train loss: 0.282, Global test loss: 1.338, Global test accuracy: 65.44 

Round  23, Train loss: 0.265, Test loss: 1.384, Test accuracy: 68.44 

Round  23, Global train loss: 0.265, Global test loss: 1.247, Global test accuracy: 66.44 

Round  24, Train loss: 0.256, Test loss: 1.203, Test accuracy: 71.36 

Round  24, Global train loss: 0.256, Global test loss: 1.287, Global test accuracy: 66.16 

Round  25, Train loss: 0.221, Test loss: 1.223, Test accuracy: 71.96 

Round  25, Global train loss: 0.221, Global test loss: 1.257, Global test accuracy: 66.72 

Round  26, Train loss: 0.211, Test loss: 1.185, Test accuracy: 73.08 

Round  26, Global train loss: 0.211, Global test loss: 1.360, Global test accuracy: 66.32 

Round  27, Train loss: 0.218, Test loss: 1.232, Test accuracy: 71.44 

Round  27, Global train loss: 0.218, Global test loss: 1.304, Global test accuracy: 66.44 

Round  28, Train loss: 0.211, Test loss: 1.525, Test accuracy: 68.24 

Round  28, Global train loss: 0.211, Global test loss: 1.195, Global test accuracy: 67.36 

Round  29, Train loss: 0.165, Test loss: 1.275, Test accuracy: 72.16 

Round  29, Global train loss: 0.165, Global test loss: 1.222, Global test accuracy: 66.76 

Round  30, Train loss: 0.176, Test loss: 1.360, Test accuracy: 71.96 

Round  30, Global train loss: 0.176, Global test loss: 1.244, Global test accuracy: 67.64 

Round  31, Train loss: 0.161, Test loss: 1.182, Test accuracy: 72.72 

Round  31, Global train loss: 0.161, Global test loss: 1.251, Global test accuracy: 67.96 

Round  32, Train loss: 0.136, Test loss: 1.494, Test accuracy: 70.92 

Round  32, Global train loss: 0.136, Global test loss: 1.287, Global test accuracy: 68.56 

Round  33, Train loss: 0.157, Test loss: 1.209, Test accuracy: 73.00 

Round  33, Global train loss: 0.157, Global test loss: 1.191, Global test accuracy: 68.40 

Round  34, Train loss: 0.138, Test loss: 1.381, Test accuracy: 72.44 

Round  34, Global train loss: 0.138, Global test loss: 1.228, Global test accuracy: 68.76 

Round  35, Train loss: 0.120, Test loss: 1.251, Test accuracy: 74.64 

Round  35, Global train loss: 0.120, Global test loss: 1.291, Global test accuracy: 68.12 

Round  36, Train loss: 0.109, Test loss: 1.213, Test accuracy: 74.44 

Round  36, Global train loss: 0.109, Global test loss: 1.284, Global test accuracy: 68.60 

Round  37, Train loss: 0.125, Test loss: 1.322, Test accuracy: 71.12 

Round  37, Global train loss: 0.125, Global test loss: 1.259, Global test accuracy: 68.12 

Round  38, Train loss: 0.115, Test loss: 1.470, Test accuracy: 72.04 

Round  38, Global train loss: 0.115, Global test loss: 1.224, Global test accuracy: 69.28 

Round  39, Train loss: 0.104, Test loss: 1.361, Test accuracy: 73.00 

Round  39, Global train loss: 0.104, Global test loss: 1.264, Global test accuracy: 68.64 

Round  40, Train loss: 0.084, Test loss: 1.270, Test accuracy: 74.28 

Round  40, Global train loss: 0.084, Global test loss: 1.264, Global test accuracy: 69.12 

Round  41, Train loss: 0.065, Test loss: 1.294, Test accuracy: 75.24 

Round  41, Global train loss: 0.065, Global test loss: 1.453, Global test accuracy: 67.72 

Round  42, Train loss: 0.105, Test loss: 1.155, Test accuracy: 75.68 

Round  42, Global train loss: 0.105, Global test loss: 1.309, Global test accuracy: 69.52 

Round  43, Train loss: 0.079, Test loss: 1.279, Test accuracy: 74.88 

Round  43, Global train loss: 0.079, Global test loss: 1.360, Global test accuracy: 68.76 

Round  44, Train loss: 0.089, Test loss: 1.234, Test accuracy: 74.40 

Round  44, Global train loss: 0.089, Global test loss: 1.234, Global test accuracy: 69.52 

Round  45, Train loss: 0.071, Test loss: 1.246, Test accuracy: 74.48 

Round  45, Global train loss: 0.071, Global test loss: 1.340, Global test accuracy: 68.88 

Round  46, Train loss: 0.063, Test loss: 1.574, Test accuracy: 71.76 

Round  46, Global train loss: 0.063, Global test loss: 1.308, Global test accuracy: 69.56 

Round  47, Train loss: 0.103, Test loss: 1.306, Test accuracy: 72.72 

Round  47, Global train loss: 0.103, Global test loss: 1.306, Global test accuracy: 68.96 

Round  48, Train loss: 0.069, Test loss: 1.261, Test accuracy: 74.44 

Round  48, Global train loss: 0.069, Global test loss: 1.344, Global test accuracy: 69.08 

Round  49, Train loss: 0.047, Test loss: 1.247, Test accuracy: 75.92 

Round  49, Global train loss: 0.047, Global test loss: 1.359, Global test accuracy: 68.68 

Final Round, Train loss: 0.054, Test loss: 1.543, Test accuracy: 72.52 

Final Round, Global train loss: 0.054, Global test loss: 1.359, Global test accuracy: 68.68 

Average accuracy final 10 rounds: 74.38 

Average global accuracy final 10 rounds: 68.98 

2062.3787343502045
[12.631099700927734, 19.413791179656982, 26.34862995147705, 33.3744695186615, 40.267234802246094, 46.952913761138916, 53.81957221031189, 60.77973532676697, 67.52777409553528, 74.39678430557251, 81.11109900474548, 88.02124905586243, 94.78420233726501, 101.70905065536499, 108.56690907478333, 115.47331309318542, 122.18914413452148, 129.01489400863647, 135.76653027534485, 142.94266057014465, 149.7304482460022, 156.7825105190277, 163.43600487709045, 170.19653415679932, 176.98119616508484, 183.6494438648224, 190.42335081100464, 197.47448682785034, 204.4652762413025, 211.4424135684967, 218.07148504257202, 225.237713098526, 232.27240920066833, 239.0417194366455, 245.81459093093872, 252.55852723121643, 259.20654797554016, 265.81549072265625, 272.7372443675995, 279.4995903968811, 286.34274911880493, 293.34224224090576, 300.3378071784973, 307.1475603580475, 314.0120589733124, 320.8014805316925, 327.52312874794006, 334.2548155784607, 341.0066571235657, 348.0925221443176, 361.78823041915894]
[49.64, 47.08, 53.52, 53.44, 57.6, 63.0, 60.2, 60.84, 61.08, 63.0, 62.64, 67.16, 65.8, 64.32, 66.76, 66.08, 69.96, 69.44, 68.48, 71.0, 68.48, 70.08, 70.52, 68.44, 71.36, 71.96, 73.08, 71.44, 68.24, 72.16, 71.96, 72.72, 70.92, 73.0, 72.44, 74.64, 74.44, 71.12, 72.04, 73.0, 74.28, 75.24, 75.68, 74.88, 74.4, 74.48, 71.76, 72.72, 74.44, 75.92, 72.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.575, Test loss: 1.966, Test accuracy: 20.96 

Round   1, Train loss: 1.423, Test loss: 1.772, Test accuracy: 29.80 

Round   2, Train loss: 1.289, Test loss: 1.263, Test accuracy: 48.44 

Round   3, Train loss: 1.177, Test loss: 1.224, Test accuracy: 53.12 

Round   4, Train loss: 1.080, Test loss: 1.150, Test accuracy: 54.92 

Round   5, Train loss: 1.021, Test loss: 0.984, Test accuracy: 60.44 

Round   6, Train loss: 0.954, Test loss: 1.087, Test accuracy: 57.84 

Round   7, Train loss: 0.913, Test loss: 1.065, Test accuracy: 60.00 

Round   8, Train loss: 0.859, Test loss: 0.911, Test accuracy: 64.56 

Round   9, Train loss: 0.821, Test loss: 0.946, Test accuracy: 64.04 

Round  10, Train loss: 0.762, Test loss: 0.928, Test accuracy: 64.92 

Round  11, Train loss: 0.737, Test loss: 0.961, Test accuracy: 63.40 

Round  12, Train loss: 0.696, Test loss: 0.858, Test accuracy: 67.72 

Round  13, Train loss: 0.658, Test loss: 0.867, Test accuracy: 68.88 

Round  14, Train loss: 0.626, Test loss: 0.835, Test accuracy: 69.08 

Round  15, Train loss: 0.586, Test loss: 0.879, Test accuracy: 68.44 

Round  16, Train loss: 0.568, Test loss: 0.840, Test accuracy: 70.56 

Round  17, Train loss: 0.524, Test loss: 0.750, Test accuracy: 73.60 

Round  18, Train loss: 0.500, Test loss: 0.802, Test accuracy: 71.52 

Round  19, Train loss: 0.471, Test loss: 0.806, Test accuracy: 72.80 

Round  20, Train loss: 0.444, Test loss: 0.810, Test accuracy: 72.48 

Round  21, Train loss: 0.426, Test loss: 0.771, Test accuracy: 73.96 

Round  22, Train loss: 0.406, Test loss: 0.776, Test accuracy: 74.80 

Round  23, Train loss: 0.378, Test loss: 0.805, Test accuracy: 74.92 

Round  24, Train loss: 0.362, Test loss: 0.789, Test accuracy: 73.76 

Round  25, Train loss: 0.344, Test loss: 0.805, Test accuracy: 74.76 

Round  26, Train loss: 0.322, Test loss: 0.832, Test accuracy: 74.48 

Round  27, Train loss: 0.309, Test loss: 0.823, Test accuracy: 74.52 

Round  28, Train loss: 0.283, Test loss: 0.800, Test accuracy: 74.84 

Round  29, Train loss: 0.291, Test loss: 0.784, Test accuracy: 74.84 

Round  30, Train loss: 0.243, Test loss: 0.828, Test accuracy: 75.84 

Round  31, Train loss: 0.239, Test loss: 0.857, Test accuracy: 74.44 

Round  32, Train loss: 0.220, Test loss: 0.809, Test accuracy: 76.16 

Round  33, Train loss: 0.218, Test loss: 0.815, Test accuracy: 75.96 

Round  34, Train loss: 0.194, Test loss: 0.836, Test accuracy: 75.76 

Round  35, Train loss: 0.187, Test loss: 0.854, Test accuracy: 75.32 

Round  36, Train loss: 0.165, Test loss: 0.809, Test accuracy: 76.40 

Round  37, Train loss: 0.167, Test loss: 0.829, Test accuracy: 76.48 

Round  38, Train loss: 0.161, Test loss: 0.862, Test accuracy: 75.44 

Round  39, Train loss: 0.159, Test loss: 0.845, Test accuracy: 75.92 

Round  40, Train loss: 0.133, Test loss: 0.824, Test accuracy: 76.40 

Round  41, Train loss: 0.130, Test loss: 0.836, Test accuracy: 76.68 

Round  42, Train loss: 0.124, Test loss: 0.865, Test accuracy: 76.24 

Round  43, Train loss: 0.118, Test loss: 0.861, Test accuracy: 76.28 

Round  44, Train loss: 0.124, Test loss: 0.999, Test accuracy: 74.16 

Round  45, Train loss: 0.111, Test loss: 0.851, Test accuracy: 76.60 

Round  46, Train loss: 0.103, Test loss: 0.845, Test accuracy: 76.80 

Round  47, Train loss: 0.084, Test loss: 0.879, Test accuracy: 77.24 

Round  48, Train loss: 0.084, Test loss: 0.895, Test accuracy: 75.92 

Round  49, Train loss: 0.087, Test loss: 0.890, Test accuracy: 76.28 

Final Round, Train loss: 0.044, Test loss: 0.909, Test accuracy: 75.76 

Average accuracy final 10 rounds: 76.25999999999999 

1483.1705424785614
[11.183220863342285, 16.435312271118164, 21.828274488449097, 27.202569484710693, 32.40985989570618, 37.77096486091614, 43.328927755355835, 48.696080684661865, 53.99689984321594, 59.512792110443115, 64.82060933113098, 70.10489463806152, 75.28749299049377, 80.83782434463501, 86.44060778617859, 91.71591544151306, 97.01048183441162, 102.15514135360718, 107.45512890815735, 112.72176194190979, 118.06843495368958, 123.3476209640503, 128.9113667011261, 134.43501448631287, 139.73844456672668, 145.03751373291016, 150.34071946144104, 155.60445952415466, 161.02224731445312, 166.31714844703674, 171.81441044807434, 176.8442506790161, 182.37554264068604, 188.08088445663452, 193.53006672859192, 198.55550503730774, 203.8657898902893, 209.36676573753357, 214.8728506565094, 220.17272329330444, 225.59153151512146, 230.96941566467285, 236.38887310028076, 241.82017374038696, 247.05301570892334, 252.28127789497375, 257.5576467514038, 262.90199041366577, 268.4586486816406, 273.63702416419983, 279.50370931625366]
[20.96, 29.8, 48.44, 53.12, 54.92, 60.44, 57.84, 60.0, 64.56, 64.04, 64.92, 63.4, 67.72, 68.88, 69.08, 68.44, 70.56, 73.6, 71.52, 72.8, 72.48, 73.96, 74.8, 74.92, 73.76, 74.76, 74.48, 74.52, 74.84, 74.84, 75.84, 74.44, 76.16, 75.96, 75.76, 75.32, 76.4, 76.48, 75.44, 75.92, 76.4, 76.68, 76.24, 76.28, 74.16, 76.6, 76.8, 77.24, 75.92, 76.28, 75.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.603, Test loss: 1.773, Test accuracy: 20.88
Round   1, Train loss: 1.419, Test loss: 1.664, Test accuracy: 31.96
Round   2, Train loss: 1.298, Test loss: 1.478, Test accuracy: 39.04
Round   3, Train loss: 1.176, Test loss: 1.131, Test accuracy: 51.48
Round   4, Train loss: 1.089, Test loss: 0.983, Test accuracy: 59.64
Round   5, Train loss: 1.020, Test loss: 0.933, Test accuracy: 61.60
Round   6, Train loss: 0.977, Test loss: 0.939, Test accuracy: 61.84
Round   7, Train loss: 0.921, Test loss: 0.969, Test accuracy: 62.68
Round   8, Train loss: 0.876, Test loss: 0.932, Test accuracy: 63.64
Round   9, Train loss: 0.822, Test loss: 0.948, Test accuracy: 63.32
Round  10, Train loss: 0.794, Test loss: 0.902, Test accuracy: 64.96
Round  11, Train loss: 0.751, Test loss: 0.962, Test accuracy: 63.60
Round  12, Train loss: 0.734, Test loss: 0.863, Test accuracy: 67.04
Round  13, Train loss: 0.669, Test loss: 0.800, Test accuracy: 69.84
Round  14, Train loss: 0.632, Test loss: 0.865, Test accuracy: 69.44
Round  15, Train loss: 0.607, Test loss: 0.817, Test accuracy: 69.64
Round  16, Train loss: 0.571, Test loss: 0.769, Test accuracy: 71.60
Round  17, Train loss: 0.544, Test loss: 0.829, Test accuracy: 70.36
Round  18, Train loss: 0.506, Test loss: 0.768, Test accuracy: 72.36
Round  19, Train loss: 0.489, Test loss: 0.730, Test accuracy: 73.48
Round  20, Train loss: 0.464, Test loss: 0.802, Test accuracy: 72.36
Round  21, Train loss: 0.444, Test loss: 0.740, Test accuracy: 74.24
Round  22, Train loss: 0.413, Test loss: 0.794, Test accuracy: 72.72
Round  23, Train loss: 0.396, Test loss: 0.721, Test accuracy: 75.04
Round  24, Train loss: 0.373, Test loss: 0.747, Test accuracy: 75.04
Round  25, Train loss: 0.342, Test loss: 0.739, Test accuracy: 75.32
Round  26, Train loss: 0.341, Test loss: 0.801, Test accuracy: 74.52
Round  27, Train loss: 0.314, Test loss: 0.744, Test accuracy: 75.56
Round  28, Train loss: 0.285, Test loss: 0.779, Test accuracy: 75.60
Round  29, Train loss: 0.286, Test loss: 0.771, Test accuracy: 75.80
Round  30, Train loss: 0.273, Test loss: 0.763, Test accuracy: 76.44
Round  31, Train loss: 0.247, Test loss: 0.768, Test accuracy: 76.00
Round  32, Train loss: 0.241, Test loss: 0.761, Test accuracy: 76.68
Round  33, Train loss: 0.215, Test loss: 0.776, Test accuracy: 76.16
Round  34, Train loss: 0.211, Test loss: 0.782, Test accuracy: 75.48
Round  35, Train loss: 0.191, Test loss: 0.781, Test accuracy: 75.84
Round  36, Train loss: 0.188, Test loss: 0.783, Test accuracy: 76.36
Round  37, Train loss: 0.178, Test loss: 0.770, Test accuracy: 77.00
Round  38, Train loss: 0.164, Test loss: 0.762, Test accuracy: 77.88
Round  39, Train loss: 0.143, Test loss: 0.783, Test accuracy: 78.00
Round  40, Train loss: 0.140, Test loss: 0.809, Test accuracy: 76.96
Round  41, Train loss: 0.153, Test loss: 0.801, Test accuracy: 76.64
Round  42, Train loss: 0.147, Test loss: 0.818, Test accuracy: 76.60
Round  43, Train loss: 0.118, Test loss: 0.802, Test accuracy: 77.96
Round  44, Train loss: 0.114, Test loss: 0.796, Test accuracy: 78.40
Round  45, Train loss: 0.117, Test loss: 0.822, Test accuracy: 77.12
Round  46, Train loss: 0.113, Test loss: 0.813, Test accuracy: 77.28
Round  47, Train loss: 0.105, Test loss: 0.814, Test accuracy: 77.68
Round  48, Train loss: 0.083, Test loss: 0.835, Test accuracy: 77.72
Round  49, Train loss: 0.075, Test loss: 0.824, Test accuracy: 78.28
Final Round, Train loss: 0.047, Test loss: 0.830, Test accuracy: 78.08
Average accuracy final 10 rounds: 77.46400000000001
1753.6004276275635
[12.466283321380615, 18.897916316986084, 25.316805124282837, 31.766536951065063, 38.01964807510376, 44.48541808128357, 51.02151393890381, 57.663020849227905, 63.995174169540405, 70.2645971775055, 76.84186267852783, 83.2488112449646, 89.68596982955933, 96.04381155967712, 102.36612629890442, 108.81058263778687, 115.44709157943726, 122.00302529335022, 128.29049348831177, 134.80878114700317, 141.17494750022888, 147.6823127269745, 153.90505361557007, 160.33631038665771, 166.96221160888672, 173.5992932319641, 180.29323315620422, 186.7747254371643, 193.08191657066345, 199.5626096725464, 205.93891954421997, 212.35250616073608, 218.87805724143982, 225.23636960983276, 231.53290033340454, 237.90963435173035, 244.36302018165588, 250.72334361076355, 256.95868706703186, 263.55008459091187, 269.8512876033783, 276.4441430568695, 282.7856538295746, 289.13095927238464, 295.63712763786316, 301.81768465042114, 308.1679108142853, 314.57209515571594, 320.9212408065796, 327.58738231658936, 334.2092795372009]
[20.88, 31.96, 39.04, 51.48, 59.64, 61.6, 61.84, 62.68, 63.64, 63.32, 64.96, 63.6, 67.04, 69.84, 69.44, 69.64, 71.6, 70.36, 72.36, 73.48, 72.36, 74.24, 72.72, 75.04, 75.04, 75.32, 74.52, 75.56, 75.6, 75.8, 76.44, 76.0, 76.68, 76.16, 75.48, 75.84, 76.36, 77.0, 77.88, 78.0, 76.96, 76.64, 76.6, 77.96, 78.4, 77.12, 77.28, 77.68, 77.72, 78.28, 78.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.453, Train accuracy: 82.600, Test loss: 1.502, Test accuracy: 55.40 

        train local model (freeze embeding):client   0,  Train loss: 0.332, Train accuracy: 88.200, Test loss: 1.578, Test accuracy: 56.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.438, Train accuracy: 83.000, Test loss: 2.378, Test accuracy: 47.60 

Round   0, Train loss: 0.438, Test loss: 2.378, Test accuracy: 47.60 

        train local model (freeze embeding):client   0,  Train loss: 0.216, Train accuracy: 93.400, Test loss: 2.026, Test accuracy: 51.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.220, Train accuracy: 92.400, Test loss: 2.225, Test accuracy: 53.00 

Round   1, Train loss: 0.220, Test loss: 2.225, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.144, Train accuracy: 96.600, Test loss: 2.077, Test accuracy: 53.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.127, Train accuracy: 95.200, Test loss: 2.351, Test accuracy: 53.00 

Round   2, Train loss: 0.127, Test loss: 2.351, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.063, Train accuracy: 98.400, Test loss: 2.161, Test accuracy: 53.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.074, Train accuracy: 97.200, Test loss: 2.547, Test accuracy: 53.80 

Round   3, Train loss: 0.074, Test loss: 2.547, Test accuracy: 53.80 

        train local model (freeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 2.335, Test accuracy: 56.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.086, Train accuracy: 97.000, Test loss: 2.653, Test accuracy: 55.40 

Round   4, Train loss: 0.086, Test loss: 2.653, Test accuracy: 55.40 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.400, Test loss: 2.379, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.056, Train accuracy: 97.000, Test loss: 2.764, Test accuracy: 56.20 

Round   5, Train loss: 0.056, Test loss: 2.764, Test accuracy: 56.20 

        train local model (freeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 2.654, Test accuracy: 56.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.800, Test loss: 2.671, Test accuracy: 55.00 

Round   6, Train loss: 0.024, Test loss: 2.671, Test accuracy: 55.00 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 2.714, Test accuracy: 55.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 2.910, Test accuracy: 56.20 

Round   7, Train loss: 0.020, Test loss: 2.910, Test accuracy: 56.20 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.728, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.788, Test accuracy: 59.40 

Round   8, Train loss: 0.006, Test loss: 2.788, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 2.799, Test accuracy: 59.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.633, Test accuracy: 58.20 

Round   9, Train loss: 0.004, Test loss: 2.633, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.729, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.902, Test accuracy: 57.80 

Round  10, Train loss: 0.010, Test loss: 2.902, Test accuracy: 57.80 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.941, Test accuracy: 57.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 2.854, Test accuracy: 55.80 

Round  11, Train loss: 0.010, Test loss: 2.854, Test accuracy: 55.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.798, Test accuracy: 55.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 3.031, Test accuracy: 54.60 

Round  12, Train loss: 0.005, Test loss: 3.031, Test accuracy: 54.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.893, Test accuracy: 56.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.814, Test accuracy: 57.00 

Round  13, Train loss: 0.004, Test loss: 2.814, Test accuracy: 57.00 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.600, Test loss: 2.811, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.523, Test accuracy: 59.80 

Round  14, Train loss: 0.004, Test loss: 2.523, Test accuracy: 59.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.556, Test accuracy: 59.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.611, Test accuracy: 60.80 

Round  15, Train loss: 0.001, Test loss: 2.611, Test accuracy: 60.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.720, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.951, Test accuracy: 55.20 

Round  16, Train loss: 0.002, Test loss: 2.951, Test accuracy: 55.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.736, Test accuracy: 57.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.658, Test accuracy: 60.00 

Round  17, Train loss: 0.001, Test loss: 2.658, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.649, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.744, Test accuracy: 60.80 

Round  18, Train loss: 0.000, Test loss: 2.744, Test accuracy: 60.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.687, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 3.033, Test accuracy: 57.00 

Round  19, Train loss: 0.007, Test loss: 3.033, Test accuracy: 57.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.997, Test accuracy: 57.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.888, Test accuracy: 59.20 

Final Round, Train loss: 0.004, Test loss: 2.916, Test accuracy: 58.20 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 1.005, Train accuracy: 57.800, Test loss: 1.226, Test accuracy: 55.80 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.921, Test accuracy: 57.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.932, Test accuracy: 59.80 

        train local model (freeze embeding):client   1,  Train loss: 0.973, Train accuracy: 58.800, Test loss: 1.213, Test accuracy: 56.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.300, Train accuracy: 90.000, Test loss: 1.163, Test accuracy: 67.80 

Round   0, Train loss: 0.151, Test loss: 1.728, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.523, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.661, Test accuracy: 60.20 

        train local model (freeze embeding):client   1,  Train loss: 0.294, Train accuracy: 90.000, Test loss: 0.902, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.316, Train accuracy: 87.600, Test loss: 1.456, Test accuracy: 61.40 

Round   1, Train loss: 0.158, Test loss: 1.726, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.317, Test accuracy: 61.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.465, Test accuracy: 58.20 

        train local model (freeze embeding):client   1,  Train loss: 0.134, Train accuracy: 97.000, Test loss: 1.015, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.209, Train accuracy: 92.600, Test loss: 1.603, Test accuracy: 66.40 

Round   2, Train loss: 0.106, Test loss: 1.787, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 2.421, Test accuracy: 57.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.066, Train accuracy: 98.000, Test loss: 2.737, Test accuracy: 58.20 

        train local model (freeze embeding):client   1,  Train loss: 0.061, Train accuracy: 98.800, Test loss: 1.136, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.097, Train accuracy: 96.800, Test loss: 1.425, Test accuracy: 69.20 

Round   3, Train loss: 0.081, Test loss: 1.891, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 2.210, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.530, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.054, Train accuracy: 99.400, Test loss: 1.129, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.098, Train accuracy: 96.800, Test loss: 1.713, Test accuracy: 69.00 

Round   4, Train loss: 0.050, Test loss: 1.837, Test accuracy: 66.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.236, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.290, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.247, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.055, Train accuracy: 98.600, Test loss: 1.735, Test accuracy: 69.80 

Round   5, Train loss: 0.031, Test loss: 1.894, Test accuracy: 66.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.333, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.708, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.427, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.056, Train accuracy: 98.400, Test loss: 1.782, Test accuracy: 68.20 

Round   6, Train loss: 0.030, Test loss: 1.984, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.448, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.615, Test accuracy: 60.80 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.053, Train accuracy: 97.400, Test loss: 1.564, Test accuracy: 71.80 

Round   7, Train loss: 0.027, Test loss: 1.834, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.398, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.690, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.333, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 96.800, Test loss: 1.801, Test accuracy: 69.20 

Round   8, Train loss: 0.035, Test loss: 1.955, Test accuracy: 66.10 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.541, Test accuracy: 59.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.524, Test accuracy: 58.80 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.520, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.759, Test accuracy: 70.40 

Round   9, Train loss: 0.006, Test loss: 1.927, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.396, Test accuracy: 60.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.521, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.916, Test accuracy: 66.00 

Round  10, Train loss: 0.012, Test loss: 1.973, Test accuracy: 66.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.365, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.549, Test accuracy: 59.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 73.60 

Round  11, Train loss: 0.002, Test loss: 1.851, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.328, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.583, Test accuracy: 60.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.684, Test accuracy: 70.00 

Round  12, Train loss: 0.010, Test loss: 1.855, Test accuracy: 68.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.384, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.361, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 71.60 

Round  13, Train loss: 0.003, Test loss: 1.831, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.230, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.537, Test accuracy: 60.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.593, Test accuracy: 71.00 

Round  14, Train loss: 0.007, Test loss: 1.917, Test accuracy: 66.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.419, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.394, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.766, Test accuracy: 70.60 

Round  15, Train loss: 0.002, Test loss: 1.972, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.395, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.393, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.573, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.464, Test accuracy: 73.20 

Round  16, Train loss: 0.001, Test loss: 1.889, Test accuracy: 67.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.305, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.767, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.427, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.491, Test accuracy: 73.40 

Round  17, Train loss: 0.003, Test loss: 1.985, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.464, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.466, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.489, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.791, Test accuracy: 69.20 

Round  18, Train loss: 0.007, Test loss: 1.938, Test accuracy: 68.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.375, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.525, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 73.20 

Round  19, Train loss: 0.000, Test loss: 1.939, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.347, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.344, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.486, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.534, Test accuracy: 74.60 

Final Round, Train loss: 0.000, Test loss: 1.948, Test accuracy: 69.10 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.707, Train accuracy: 71.800, Test loss: 0.883, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.378, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.527, Test accuracy: 60.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.758, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.685, Train accuracy: 73.200, Test loss: 0.835, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.130, Train accuracy: 95.400, Test loss: 1.023, Test accuracy: 68.20 

Round   0, Train loss: 0.044, Test loss: 1.513, Test accuracy: 68.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.400, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.364, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.399, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.773, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.402, Train accuracy: 84.000, Test loss: 0.970, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.209, Train accuracy: 92.600, Test loss: 1.244, Test accuracy: 68.40 

Round   1, Train loss: 0.076, Test loss: 1.499, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.279, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.424, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.142, Train accuracy: 96.200, Test loss: 0.929, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.074, Train accuracy: 97.200, Test loss: 1.197, Test accuracy: 71.80 

Round   2, Train loss: 0.025, Test loss: 1.457, Test accuracy: 71.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.221, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.438, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 97.800, Test loss: 1.953, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.070, Train accuracy: 98.800, Test loss: 0.942, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.126, Train accuracy: 95.400, Test loss: 1.582, Test accuracy: 68.60 

Round   3, Train loss: 0.059, Test loss: 1.502, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.169, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.452, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.203, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.066, Train accuracy: 97.600, Test loss: 2.048, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.072, Train accuracy: 98.000, Test loss: 1.044, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.118, Train accuracy: 96.200, Test loss: 1.537, Test accuracy: 65.00 

Round   4, Train loss: 0.062, Test loss: 1.512, Test accuracy: 70.27 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.247, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.256, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.510, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.469, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.048, Train accuracy: 99.200, Test loss: 1.119, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.112, Train accuracy: 96.800, Test loss: 2.044, Test accuracy: 63.40 

Round   5, Train loss: 0.039, Test loss: 1.553, Test accuracy: 70.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.090, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.464, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 77.60 

        train local model (freeze embeding):client   2,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.117, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.073, Train accuracy: 97.000, Test loss: 1.494, Test accuracy: 66.60 

Round   6, Train loss: 0.025, Test loss: 1.514, Test accuracy: 70.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.116, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.477, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.813, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.302, Train accuracy: 92.200, Test loss: 2.350, Test accuracy: 63.60 

Round   7, Train loss: 0.105, Test loss: 1.598, Test accuracy: 70.47 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.164, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 2.591, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 75.80 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.086, Train accuracy: 97.400, Test loss: 1.990, Test accuracy: 65.20 

Round   8, Train loss: 0.034, Test loss: 1.673, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.177, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.324, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.297, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.564, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.281, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.663, Test accuracy: 71.80 

Round   9, Train loss: 0.014, Test loss: 1.579, Test accuracy: 71.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.239, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 2.422, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.338, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.048, Train accuracy: 98.600, Test loss: 1.782, Test accuracy: 63.60 

Round  10, Train loss: 0.019, Test loss: 1.542, Test accuracy: 70.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.115, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.293, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.594, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.328, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.493, Test accuracy: 70.40 

Round  11, Train loss: 0.003, Test loss: 1.549, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.118, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.508, Test accuracy: 58.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.592, Test accuracy: 70.80 

Round  12, Train loss: 0.004, Test loss: 1.573, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.195, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.398, Test accuracy: 61.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.724, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.715, Test accuracy: 70.00 

Round  13, Train loss: 0.003, Test loss: 1.670, Test accuracy: 70.73 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.200, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.529, Test accuracy: 59.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.633, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.200, Test loss: 1.762, Test accuracy: 71.40 

Round  14, Train loss: 0.016, Test loss: 1.594, Test accuracy: 71.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.230, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.358, Test accuracy: 63.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.506, Test accuracy: 75.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.279, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 72.00 

Round  15, Train loss: 0.001, Test loss: 1.613, Test accuracy: 71.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.306, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.249, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.693, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 72.00 

Round  16, Train loss: 0.004, Test loss: 1.656, Test accuracy: 71.27 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.293, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.509, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.156, Train accuracy: 93.800, Test loss: 1.990, Test accuracy: 63.00 

Round  17, Train loss: 0.052, Test loss: 1.642, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.325, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.291, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 77.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.329, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.680, Test accuracy: 69.20 

Round  18, Train loss: 0.008, Test loss: 1.586, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.282, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.250, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.465, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.514, Test accuracy: 73.00 

Round  19, Train loss: 0.000, Test loss: 1.632, Test accuracy: 70.87 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.190, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.179, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.278, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.251, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.448, Test accuracy: 72.60 

Final Round, Train loss: 0.000, Test loss: 1.627, Test accuracy: 71.20 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.752, Train accuracy: 71.600, Test loss: 0.936, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.229, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.370, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.343, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.578, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.756, Train accuracy: 70.400, Test loss: 0.946, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.258, Train accuracy: 90.800, Test loss: 1.392, Test accuracy: 62.80 

Round   0, Train loss: 0.065, Test loss: 1.385, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 2.079, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.299, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.614, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.439, Train accuracy: 82.400, Test loss: 0.865, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.128, Train accuracy: 95.600, Test loss: 1.327, Test accuracy: 68.80 

Round   1, Train loss: 0.038, Test loss: 1.327, Test accuracy: 72.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.005, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.150, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.303, Test accuracy: 77.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.456, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.258, Train accuracy: 91.800, Test loss: 0.920, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.110, Train accuracy: 97.000, Test loss: 1.374, Test accuracy: 67.00 

Round   2, Train loss: 0.030, Test loss: 1.305, Test accuracy: 72.55 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.059, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 2.443, Test accuracy: 60.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.345, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.471, Test accuracy: 71.60 

        train local model (freeze embeding):client   3,  Train loss: 0.159, Train accuracy: 94.600, Test loss: 1.025, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.094, Train accuracy: 97.200, Test loss: 1.356, Test accuracy: 65.60 

Round   3, Train loss: 0.028, Test loss: 1.292, Test accuracy: 72.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.967, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.251, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.165, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.695, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.485, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.114, Train accuracy: 97.200, Test loss: 1.030, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.082, Train accuracy: 97.400, Test loss: 1.449, Test accuracy: 66.60 

Round   4, Train loss: 0.022, Test loss: 1.372, Test accuracy: 72.05 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.951, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.215, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.295, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.638, Test accuracy: 68.00 

        train local model (freeze embeding):client   3,  Train loss: 0.062, Train accuracy: 99.200, Test loss: 1.111, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.079, Train accuracy: 97.000, Test loss: 1.666, Test accuracy: 66.20 

Round   5, Train loss: 0.028, Test loss: 1.323, Test accuracy: 72.45 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.898, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 2.416, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.600, Test loss: 1.164, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.578, Test accuracy: 68.00 

Round   6, Train loss: 0.016, Test loss: 1.364, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.933, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.095, Train accuracy: 98.000, Test loss: 2.530, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.800, Test loss: 1.292, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.232, Train accuracy: 93.000, Test loss: 2.247, Test accuracy: 62.60 

Round   7, Train loss: 0.082, Test loss: 1.457, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.953, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.166, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.322, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.606, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.316, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.047, Train accuracy: 98.600, Test loss: 1.729, Test accuracy: 68.80 

Round   8, Train loss: 0.013, Test loss: 1.394, Test accuracy: 72.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.914, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 2.539, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.370, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.556, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.081, Train accuracy: 97.000, Test loss: 1.855, Test accuracy: 63.20 

Round   9, Train loss: 0.024, Test loss: 1.489, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.968, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 2.416, Test accuracy: 61.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.630, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.407, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.607, Test accuracy: 69.60 

Round  10, Train loss: 0.016, Test loss: 1.409, Test accuracy: 72.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.925, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.974, Test accuracy: 66.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 77.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.039, Train accuracy: 98.000, Test loss: 1.823, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.182, Train accuracy: 94.000, Test loss: 2.182, Test accuracy: 65.00 

Round  11, Train loss: 0.056, Test loss: 1.432, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.927, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.134, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.621, Test accuracy: 66.20 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.638, Test accuracy: 70.60 

Round  12, Train loss: 0.013, Test loss: 1.410, Test accuracy: 72.95 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.939, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.281, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.309, Train accuracy: 93.200, Test loss: 2.791, Test accuracy: 62.60 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.049, Train accuracy: 98.400, Test loss: 2.079, Test accuracy: 66.60 

Round  13, Train loss: 0.090, Test loss: 1.534, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.943, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.084, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 77.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.448, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.536, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.640, Test accuracy: 68.60 

Round  14, Train loss: 0.003, Test loss: 1.436, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.951, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.490, Test accuracy: 60.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 77.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.469, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 1.815, Test accuracy: 68.00 

Round  15, Train loss: 0.012, Test loss: 1.456, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.087, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.178, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 79.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.484, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.075, Train accuracy: 97.000, Test loss: 1.771, Test accuracy: 67.40 

Round  16, Train loss: 0.020, Test loss: 1.445, Test accuracy: 73.45 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.993, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.952, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.105, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.080, Train accuracy: 96.800, Test loss: 1.833, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.500, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 72.60 

Round  17, Train loss: 0.021, Test loss: 1.443, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.038, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.333, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 77.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.297, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.235, Train accuracy: 91.600, Test loss: 2.570, Test accuracy: 61.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.465, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.640, Test accuracy: 74.00 

Round  18, Train loss: 0.062, Test loss: 1.548, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.136, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.217, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 77.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.562, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.045, Train accuracy: 98.400, Test loss: 1.806, Test accuracy: 70.60 

Round  19, Train loss: 0.012, Test loss: 1.472, Test accuracy: 73.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.959, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.022, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.293, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.497, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.525, Test accuracy: 73.60 

Final Round, Train loss: 0.001, Test loss: 1.466, Test accuracy: 73.60 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.494, Train accuracy: 82.200, Test loss: 0.602, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.003, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.103, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.090, Train accuracy: 96.000, Test loss: 2.466, Test accuracy: 62.80 

        train local model (freeze embeding):client   4,  Train loss: 0.482, Train accuracy: 81.600, Test loss: 0.579, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.077, Train accuracy: 97.600, Test loss: 0.905, Test accuracy: 76.40 

Round   0, Train loss: 0.034, Test loss: 1.273, Test accuracy: 74.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.980, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.520, Test accuracy: 59.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 80.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.498, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.652, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.300, Train accuracy: 89.200, Test loss: 0.573, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.056, Train accuracy: 98.200, Test loss: 1.101, Test accuracy: 72.80 

Round   1, Train loss: 0.012, Test loss: 1.304, Test accuracy: 74.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.986, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.045, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.325, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.131, Train accuracy: 96.200, Test loss: 2.327, Test accuracy: 65.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.546, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.400, Test loss: 1.688, Test accuracy: 69.40 

        train local model (freeze embeding):client   4,  Train loss: 0.181, Train accuracy: 93.200, Test loss: 0.639, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 0.850, Test accuracy: 79.20 

Round   2, Train loss: 0.041, Test loss: 1.265, Test accuracy: 74.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.826, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.359, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 77.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.658, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.128, Train accuracy: 95.400, Test loss: 0.642, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.046, Train accuracy: 98.200, Test loss: 0.949, Test accuracy: 77.00 

Round   3, Train loss: 0.010, Test loss: 1.266, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.020, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.159, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.280, Test accuracy: 79.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.052, Train accuracy: 97.600, Test loss: 1.622, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.787, Test accuracy: 70.60 

        train local model (freeze embeding):client   4,  Train loss: 0.065, Train accuracy: 98.600, Test loss: 0.610, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 0.897, Test accuracy: 78.80 

Round   4, Train loss: 0.017, Test loss: 1.277, Test accuracy: 75.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.941, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.082, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.579, Test accuracy: 69.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.482, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.892, Test accuracy: 68.40 

        train local model (freeze embeding):client   4,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 0.638, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 78.00 

Round   5, Train loss: 0.009, Test loss: 1.242, Test accuracy: 75.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.931, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.930, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 76.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.653, Test accuracy: 71.60 

        train local model (freeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.200, Test loss: 0.654, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 0.907, Test accuracy: 79.60 

Round   6, Train loss: 0.004, Test loss: 1.253, Test accuracy: 76.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.860, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.355, Test accuracy: 63.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.054, Train accuracy: 98.200, Test loss: 1.521, Test accuracy: 77.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 98.200, Test loss: 1.717, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.533, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.658, Test accuracy: 70.00 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 0.669, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.983, Test accuracy: 77.00 

Round   7, Train loss: 0.032, Test loss: 1.223, Test accuracy: 75.72 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.925, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.246, Test accuracy: 63.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.119, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 75.40 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.527, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.827, Test accuracy: 69.00 

        train local model (freeze embeding):client   4,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.123, Test accuracy: 78.00 

Round   8, Train loss: 0.009, Test loss: 1.300, Test accuracy: 75.32 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.951, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.003, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.099, Train accuracy: 96.000, Test loss: 1.679, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.112, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.747, Test accuracy: 72.40 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.770, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.400, Test loss: 1.322, Test accuracy: 75.00 

Round   9, Train loss: 0.030, Test loss: 1.279, Test accuracy: 75.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.909, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.131, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.053, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 2.117, Test accuracy: 69.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.638, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.064, Train accuracy: 97.600, Test loss: 2.030, Test accuracy: 66.80 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 0.736, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 79.80 

Round  10, Train loss: 0.022, Test loss: 1.256, Test accuracy: 76.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.863, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.898, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.538, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.694, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.715, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.111, Train accuracy: 97.000, Test loss: 1.440, Test accuracy: 73.80 

Round  11, Train loss: 0.023, Test loss: 1.281, Test accuracy: 75.72 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.835, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.011, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 71.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 80.00 

Round  12, Train loss: 0.001, Test loss: 1.279, Test accuracy: 75.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.887, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.951, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.166, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 79.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.498, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 73.20 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.779, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 79.00 

Round  13, Train loss: 0.001, Test loss: 1.265, Test accuracy: 76.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.806, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.943, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.503, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.659, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.562, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 72.60 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.976, Test accuracy: 79.00 

Round  14, Train loss: 0.006, Test loss: 1.267, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.845, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.949, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.285, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.494, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.673, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.058, Train accuracy: 98.200, Test loss: 1.440, Test accuracy: 74.40 

Round  15, Train loss: 0.015, Test loss: 1.294, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.879, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.961, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 76.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.514, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.679, Test accuracy: 72.40 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.052, Train accuracy: 98.200, Test loss: 1.046, Test accuracy: 77.60 

Round  16, Train loss: 0.011, Test loss: 1.281, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.813, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 2.191, Test accuracy: 66.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.592, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.660, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.048, Test accuracy: 79.20 

Round  17, Train loss: 0.007, Test loss: 1.297, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.911, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.419, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.169, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.610, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.680, Test accuracy: 69.80 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.812, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 78.40 

Round  18, Train loss: 0.002, Test loss: 1.305, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.985, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.992, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.928, Test accuracy: 68.80 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 80.00 

Round  19, Train loss: 0.001, Test loss: 1.299, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.929, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.900, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.196, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.213, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.610, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.598, Test accuracy: 71.20 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 81.20 

Final Round, Train loss: 0.000, Test loss: 1.290, Test accuracy: 75.88 

Average accuracy final 10 rounds: 345.2759999999999 

6088.162339925766
[19.552125453948975, 37.930864095687866, 56.51750826835632, 74.77601742744446, 93.70822072029114, 112.37642526626587, 131.15407586097717, 150.04738998413086, 168.53380155563354, 187.46101713180542, 206.2805519104004, 224.68555974960327, 243.94708681106567, 262.33842515945435, 281.0812487602234, 300.0370936393738, 318.4851830005646, 336.77020168304443, 355.00256299972534, 373.52746415138245, 384.14197182655334, 402.57305574417114, 420.863397359848, 439.3954608440399, 458.339519739151, 477.3132538795471, 495.8699760437012, 514.8662838935852, 533.5587069988251, 552.3236520290375, 571.7334196567535, 590.8798077106476, 609.6718227863312, 628.2486643791199, 647.8537020683289, 666.7835910320282, 685.6312274932861, 704.128331899643, 723.071456193924, 742.0045669078827, 760.7225580215454, 771.2608053684235, 790.0462620258331, 809.1406319141388, 828.7291820049286, 847.4954288005829, 866.3003671169281, 885.5475795269012, 904.3532183170319, 922.8958277702332, 942.166741847992, 961.1817874908447, 980.0753383636475, 999.0069262981415, 1017.790212392807, 1036.027568101883, 1054.2854614257812, 1073.2664487361908, 1091.48961019516, 1109.8227863311768, 1128.179898738861, 1147.2338511943817, 1159.3897111415863, 1178.2728443145752, 1197.6911520957947, 1216.9926030635834, 1236.5264291763306, 1255.1941809654236, 1273.9181101322174, 1292.7998032569885, 1311.8263552188873, 1330.6733372211456, 1350.0905392169952, 1369.0318038463593, 1387.8543815612793, 1407.0360932350159, 1425.7607114315033, 1444.7112174034119, 1463.6933040618896, 1482.6625006198883, 1502.3548564910889, 1521.7023437023163, 1540.853760957718, 1552.4324083328247, 1571.6022465229034, 1590.4475345611572, 1609.3426630496979, 1628.4295427799225, 1647.4460756778717, 1666.7703347206116, 1685.1981391906738, 1704.2926542758942, 1723.3543725013733, 1742.7057437896729, 1761.7084617614746, 1780.9810180664062, 1800.1143975257874, 1819.0854403972626, 1837.9192881584167, 1857.0914378166199, 1876.6771104335785, 1895.7514684200287, 1914.7702145576477, 1934.1487896442413, 1946.081465959549]
[47.6, 53.0, 53.0, 53.8, 55.4, 56.2, 55.0, 56.2, 59.4, 58.2, 57.8, 55.8, 54.6, 57.0, 59.8, 60.8, 55.2, 60.0, 60.8, 57.0, 58.2, 64.8, 61.4, 64.8, 65.4, 66.3, 66.1, 65.0, 67.8, 66.1, 66.2, 66.1, 66.6, 68.1, 68.0, 66.3, 67.6, 67.3, 68.6, 68.9, 69.0, 69.1, 68.26666666666667, 69.6, 71.13333333333334, 70.8, 70.26666666666667, 70.13333333333334, 70.66666666666667, 70.46666666666667, 70.2, 71.26666666666667, 70.93333333333334, 71.4, 71.4, 70.73333333333333, 71.13333333333334, 71.66666666666667, 71.26666666666667, 70.8, 71.6, 70.86666666666666, 71.2, 70.4, 72.85, 72.55, 72.35, 72.05, 72.45, 73.0, 72.6, 72.75, 71.5, 72.65, 72.2, 72.95, 71.9, 72.5, 72.2, 73.45, 73.6, 72.0, 73.25, 73.6, 74.24, 74.44, 74.52, 74.8, 75.52, 75.32, 76.12, 75.72, 75.32, 75.76, 76.2, 75.72, 75.24, 76.2, 75.8, 75.8, 75.8, 76.0, 76.4, 75.8, 75.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.442, Test loss: 1.294, Test accuracy: 51.30 

Round   0, Global train loss: 1.442, Global test loss: 1.796, Global test accuracy: 21.30 

Round   1, Train loss: 1.143, Test loss: 1.293, Test accuracy: 55.50 

Round   1, Global train loss: 1.143, Global test loss: 1.784, Global test accuracy: 22.60 

Round   2, Train loss: 0.962, Test loss: 1.354, Test accuracy: 52.90 

Round   2, Global train loss: 0.962, Global test loss: 1.800, Global test accuracy: 26.60 

Round   3, Train loss: 0.819, Test loss: 1.601, Test accuracy: 54.50 

Round   3, Global train loss: 0.819, Global test loss: 1.972, Global test accuracy: 25.00 

Round   4, Train loss: 0.714, Test loss: 1.308, Test accuracy: 59.30 

Round   4, Global train loss: 0.714, Global test loss: 1.632, Global test accuracy: 30.40 

Round   5, Train loss: 0.612, Test loss: 1.579, Test accuracy: 59.20 

Round   5, Global train loss: 0.612, Global test loss: 2.465, Global test accuracy: 20.10 

Round   6, Train loss: 0.513, Test loss: 1.419, Test accuracy: 59.10 

Round   6, Global train loss: 0.513, Global test loss: 2.098, Global test accuracy: 20.20 

Round   7, Train loss: 0.451, Test loss: 1.890, Test accuracy: 57.30 

Round   7, Global train loss: 0.451, Global test loss: 2.021, Global test accuracy: 25.90 

Round   8, Train loss: 0.399, Test loss: 1.593, Test accuracy: 61.00 

Round   8, Global train loss: 0.399, Global test loss: 1.944, Global test accuracy: 25.20 

Round   9, Train loss: 0.337, Test loss: 1.321, Test accuracy: 62.90 

Round   9, Global train loss: 0.337, Global test loss: 2.018, Global test accuracy: 24.30 

Round  10, Train loss: 0.252, Test loss: 1.554, Test accuracy: 62.70 

Round  10, Global train loss: 0.252, Global test loss: 2.074, Global test accuracy: 24.10 

Round  11, Train loss: 0.222, Test loss: 1.830, Test accuracy: 60.70 

Round  11, Global train loss: 0.222, Global test loss: 2.131, Global test accuracy: 24.10 

Round  12, Train loss: 0.208, Test loss: 1.528, Test accuracy: 66.00 

Round  12, Global train loss: 0.208, Global test loss: 1.935, Global test accuracy: 24.50 

Round  13, Train loss: 0.148, Test loss: 1.563, Test accuracy: 65.90 

Round  13, Global train loss: 0.148, Global test loss: 2.250, Global test accuracy: 20.70 

Round  14, Train loss: 0.132, Test loss: 1.682, Test accuracy: 62.80 

Round  14, Global train loss: 0.132, Global test loss: 2.473, Global test accuracy: 19.90 

Round  15, Train loss: 0.145, Test loss: 1.629, Test accuracy: 65.80 

Round  15, Global train loss: 0.145, Global test loss: 2.373, Global test accuracy: 20.30 

Round  16, Train loss: 0.087, Test loss: 1.972, Test accuracy: 61.80 

Round  16, Global train loss: 0.087, Global test loss: 2.298, Global test accuracy: 20.00 

Round  17, Train loss: 0.088, Test loss: 1.766, Test accuracy: 67.20 

Round  17, Global train loss: 0.088, Global test loss: 2.570, Global test accuracy: 20.00 

Round  18, Train loss: 0.105, Test loss: 1.687, Test accuracy: 65.70 

Round  18, Global train loss: 0.105, Global test loss: 2.208, Global test accuracy: 26.60 

Round  19, Train loss: 0.065, Test loss: 1.683, Test accuracy: 64.40 

Round  19, Global train loss: 0.065, Global test loss: 2.510, Global test accuracy: 20.10 

Round  20, Train loss: 0.060, Test loss: 2.034, Test accuracy: 63.90 

Round  20, Global train loss: 0.060, Global test loss: 2.563, Global test accuracy: 20.80 

Round  21, Train loss: 0.082, Test loss: 2.227, Test accuracy: 61.20 

Round  21, Global train loss: 0.082, Global test loss: 2.084, Global test accuracy: 24.60 

Round  22, Train loss: 0.057, Test loss: 1.807, Test accuracy: 64.20 

Round  22, Global train loss: 0.057, Global test loss: 2.426, Global test accuracy: 20.20 

Round  23, Train loss: 0.059, Test loss: 1.770, Test accuracy: 67.50 

Round  23, Global train loss: 0.059, Global test loss: 2.129, Global test accuracy: 22.00 

Round  24, Train loss: 0.037, Test loss: 1.957, Test accuracy: 64.40 

Round  24, Global train loss: 0.037, Global test loss: 2.303, Global test accuracy: 21.70 

Round  25, Train loss: 0.073, Test loss: 1.897, Test accuracy: 64.90 

Round  25, Global train loss: 0.073, Global test loss: 2.059, Global test accuracy: 25.40 

Round  26, Train loss: 0.042, Test loss: 1.803, Test accuracy: 66.60 

Round  26, Global train loss: 0.042, Global test loss: 2.190, Global test accuracy: 22.70 

Round  27, Train loss: 0.047, Test loss: 1.907, Test accuracy: 66.30 

Round  27, Global train loss: 0.047, Global test loss: 2.579, Global test accuracy: 20.10 

Round  28, Train loss: 0.037, Test loss: 1.719, Test accuracy: 68.40 

Round  28, Global train loss: 0.037, Global test loss: 2.314, Global test accuracy: 21.30 

Round  29, Train loss: 0.033, Test loss: 1.818, Test accuracy: 66.60 

Round  29, Global train loss: 0.033, Global test loss: 2.462, Global test accuracy: 25.60 

Round  30, Train loss: 0.025, Test loss: 1.770, Test accuracy: 67.10 

Round  30, Global train loss: 0.025, Global test loss: 2.332, Global test accuracy: 21.30 

Round  31, Train loss: 0.022, Test loss: 1.680, Test accuracy: 66.70 

Round  31, Global train loss: 0.022, Global test loss: 2.519, Global test accuracy: 20.10 

Round  32, Train loss: 0.024, Test loss: 1.838, Test accuracy: 68.00 

Round  32, Global train loss: 0.024, Global test loss: 2.528, Global test accuracy: 20.00 

Round  33, Train loss: 0.019, Test loss: 2.308, Test accuracy: 63.80 

Round  33, Global train loss: 0.019, Global test loss: 2.255, Global test accuracy: 22.70 

Round  34, Train loss: 0.020, Test loss: 1.958, Test accuracy: 65.50 

Round  34, Global train loss: 0.020, Global test loss: 2.319, Global test accuracy: 21.00 

Final Round, Train loss: 0.012, Test loss: 1.922, Test accuracy: 66.90 

Final Round, Global train loss: 0.012, Global test loss: 2.319, Global test accuracy: 21.00 

Average accuracy final 10 rounds: 66.39 

Average global accuracy final 10 rounds: 22.02 

597.9399635791779
[12.699552059173584, 19.408172130584717, 26.294479370117188, 33.14858818054199, 40.05731964111328, 46.68590593338013, 53.65231728553772, 60.4485924243927, 67.35255122184753, 74.449049949646, 81.31171679496765, 88.31767392158508, 95.02220416069031, 101.80853199958801, 108.84563398361206, 115.44315981864929, 122.44116544723511, 129.15183281898499, 135.95384979248047, 142.67822122573853, 150.08234429359436, 156.8715100288391, 163.43047523498535, 170.12378430366516, 176.96028852462769, 183.6592469215393, 190.40885210037231, 197.3835964202881, 204.29708433151245, 211.03716826438904, 217.8268220424652, 224.54606103897095, 231.2167148590088, 238.10255479812622, 245.0863802433014, 258.4712631702423]
[51.3, 55.5, 52.9, 54.5, 59.3, 59.2, 59.1, 57.3, 61.0, 62.9, 62.7, 60.7, 66.0, 65.9, 62.8, 65.8, 61.8, 67.2, 65.7, 64.4, 63.9, 61.2, 64.2, 67.5, 64.4, 64.9, 66.6, 66.3, 68.4, 66.6, 67.1, 66.7, 68.0, 63.8, 65.5, 66.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.449, Test loss: 1.428, Test accuracy: 42.00 

Round   0, Global train loss: 1.449, Global test loss: 1.637, Global test accuracy: 27.80 

Round   1, Train loss: 1.245, Test loss: 1.075, Test accuracy: 57.10 

Round   1, Global train loss: 1.245, Global test loss: 1.515, Global test accuracy: 30.80 

Round   2, Train loss: 1.103, Test loss: 1.191, Test accuracy: 56.40 

Round   2, Global train loss: 1.103, Global test loss: 1.464, Global test accuracy: 40.40 

Round   3, Train loss: 1.008, Test loss: 1.282, Test accuracy: 55.90 

Round   3, Global train loss: 1.008, Global test loss: 1.432, Global test accuracy: 42.90 

Round   4, Train loss: 0.902, Test loss: 1.332, Test accuracy: 56.80 

Round   4, Global train loss: 0.902, Global test loss: 1.499, Global test accuracy: 43.90 

Round   5, Train loss: 0.801, Test loss: 1.305, Test accuracy: 60.40 

Round   5, Global train loss: 0.801, Global test loss: 1.368, Global test accuracy: 49.50 

Round   6, Train loss: 0.704, Test loss: 1.387, Test accuracy: 59.90 

Round   6, Global train loss: 0.704, Global test loss: 1.482, Global test accuracy: 51.10 

Round   7, Train loss: 0.656, Test loss: 1.208, Test accuracy: 61.30 

Round   7, Global train loss: 0.656, Global test loss: 1.637, Global test accuracy: 46.60 

Round   8, Train loss: 0.601, Test loss: 1.208, Test accuracy: 63.90 

Round   8, Global train loss: 0.601, Global test loss: 1.649, Global test accuracy: 50.00 

Round   9, Train loss: 0.516, Test loss: 1.407, Test accuracy: 61.20 

Round   9, Global train loss: 0.516, Global test loss: 1.796, Global test accuracy: 45.00 

Round  10, Train loss: 0.485, Test loss: 1.211, Test accuracy: 65.00 

Round  10, Global train loss: 0.485, Global test loss: 1.601, Global test accuracy: 52.60 

Round  11, Train loss: 0.416, Test loss: 1.545, Test accuracy: 60.80 

Round  11, Global train loss: 0.416, Global test loss: 1.679, Global test accuracy: 50.70 

Round  12, Train loss: 0.383, Test loss: 1.292, Test accuracy: 65.50 

Round  12, Global train loss: 0.383, Global test loss: 1.648, Global test accuracy: 53.90 

Round  13, Train loss: 0.325, Test loss: 1.351, Test accuracy: 66.20 

Round  13, Global train loss: 0.325, Global test loss: 1.859, Global test accuracy: 52.50 

Round  14, Train loss: 0.318, Test loss: 1.760, Test accuracy: 63.90 

Round  14, Global train loss: 0.318, Global test loss: 1.926, Global test accuracy: 53.00 

Round  15, Train loss: 0.275, Test loss: 1.534, Test accuracy: 64.70 

Round  15, Global train loss: 0.275, Global test loss: 1.991, Global test accuracy: 50.20 

Round  16, Train loss: 0.237, Test loss: 1.733, Test accuracy: 59.80 

Round  16, Global train loss: 0.237, Global test loss: 2.307, Global test accuracy: 49.70 

Round  17, Train loss: 0.236, Test loss: 1.427, Test accuracy: 67.10 

Round  17, Global train loss: 0.236, Global test loss: 1.900, Global test accuracy: 53.80 

Round  18, Train loss: 0.189, Test loss: 1.368, Test accuracy: 68.30 

Round  18, Global train loss: 0.189, Global test loss: 1.836, Global test accuracy: 54.10 

Round  19, Train loss: 0.182, Test loss: 1.467, Test accuracy: 66.60 

Round  19, Global train loss: 0.182, Global test loss: 2.190, Global test accuracy: 52.90 

Round  20, Train loss: 0.167, Test loss: 1.589, Test accuracy: 65.10 

Round  20, Global train loss: 0.167, Global test loss: 2.074, Global test accuracy: 52.30 

Round  21, Train loss: 0.150, Test loss: 1.552, Test accuracy: 65.50 

Round  21, Global train loss: 0.150, Global test loss: 2.000, Global test accuracy: 53.70 

Round  22, Train loss: 0.111, Test loss: 1.472, Test accuracy: 69.10 

Round  22, Global train loss: 0.111, Global test loss: 2.034, Global test accuracy: 54.20 

Round  23, Train loss: 0.117, Test loss: 1.598, Test accuracy: 66.30 

Round  23, Global train loss: 0.117, Global test loss: 2.071, Global test accuracy: 54.60 

Round  24, Train loss: 0.161, Test loss: 1.781, Test accuracy: 64.00 

Round  24, Global train loss: 0.161, Global test loss: 2.023, Global test accuracy: 54.90 

Round  25, Train loss: 0.096, Test loss: 1.394, Test accuracy: 69.70 

Round  25, Global train loss: 0.096, Global test loss: 2.079, Global test accuracy: 54.40 

Round  26, Train loss: 0.079, Test loss: 1.705, Test accuracy: 66.20 

Round  26, Global train loss: 0.079, Global test loss: 2.158, Global test accuracy: 55.00 

Round  27, Train loss: 0.089, Test loss: 1.662, Test accuracy: 69.20 

Round  27, Global train loss: 0.089, Global test loss: 2.316, Global test accuracy: 55.20 

Round  28, Train loss: 0.052, Test loss: 1.622, Test accuracy: 70.10 

Round  28, Global train loss: 0.052, Global test loss: 2.239, Global test accuracy: 54.10 

Round  29, Train loss: 0.089, Test loss: 1.755, Test accuracy: 65.70 

Round  29, Global train loss: 0.089, Global test loss: 2.277, Global test accuracy: 53.30 

Round  30, Train loss: 0.068, Test loss: 1.733, Test accuracy: 66.40 

Round  30, Global train loss: 0.068, Global test loss: 2.144, Global test accuracy: 55.30 

Round  31, Train loss: 0.051, Test loss: 1.860, Test accuracy: 69.90 

Round  31, Global train loss: 0.051, Global test loss: 2.351, Global test accuracy: 56.40 

Round  32, Train loss: 0.097, Test loss: 1.850, Test accuracy: 66.30 

Round  32, Global train loss: 0.097, Global test loss: 2.251, Global test accuracy: 53.70 

Round  33, Train loss: 0.044, Test loss: 1.652, Test accuracy: 67.80 

Round  33, Global train loss: 0.044, Global test loss: 2.116, Global test accuracy: 55.90 

Round  34, Train loss: 0.072, Test loss: 1.572, Test accuracy: 68.90 

Round  34, Global train loss: 0.072, Global test loss: 2.189, Global test accuracy: 54.60 

Final Round, Train loss: 0.035, Test loss: 1.701, Test accuracy: 69.10 

Final Round, Global train loss: 0.035, Global test loss: 2.189, Global test accuracy: 54.60 

Average accuracy final 10 rounds: 68.02000000000001 

Average global accuracy final 10 rounds: 54.79 

596.1531431674957
[12.475778341293335, 19.27975058555603, 25.999584674835205, 32.95294690132141, 39.94673705101013, 46.65108036994934, 53.799638986587524, 60.71733999252319, 67.64000582695007, 74.15654969215393, 80.87433075904846, 87.75737500190735, 94.47755670547485, 101.21068406105042, 108.1827130317688, 115.0118055343628, 121.6625440120697, 128.2912039756775, 135.154367685318, 142.02708840370178, 148.68497729301453, 155.50278544425964, 162.50821733474731, 169.06630539894104, 175.84004998207092, 182.7658839225769, 189.84565377235413, 196.63462138175964, 203.51393747329712, 210.38781714439392, 217.14604330062866, 223.8830268383026, 230.81186056137085, 237.57189965248108, 244.29214906692505, 257.74846363067627]
[42.0, 57.1, 56.4, 55.9, 56.8, 60.4, 59.9, 61.3, 63.9, 61.2, 65.0, 60.8, 65.5, 66.2, 63.9, 64.7, 59.8, 67.1, 68.3, 66.6, 65.1, 65.5, 69.1, 66.3, 64.0, 69.7, 66.2, 69.2, 70.1, 65.7, 66.4, 69.9, 66.3, 67.8, 68.9, 69.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.518, Test loss: 1.666, Test accuracy: 29.50 

Round   1, Train loss: 1.332, Test loss: 1.457, Test accuracy: 37.50 

Round   2, Train loss: 1.214, Test loss: 1.148, Test accuracy: 50.80 

Round   3, Train loss: 1.082, Test loss: 1.053, Test accuracy: 55.50 

Round   4, Train loss: 1.021, Test loss: 1.069, Test accuracy: 57.40 

Round   5, Train loss: 0.889, Test loss: 1.084, Test accuracy: 55.60 

Round   6, Train loss: 0.859, Test loss: 0.974, Test accuracy: 59.30 

Round   7, Train loss: 0.786, Test loss: 0.973, Test accuracy: 62.70 

Round   8, Train loss: 0.725, Test loss: 0.977, Test accuracy: 63.80 

Round   9, Train loss: 0.655, Test loss: 1.024, Test accuracy: 65.90 

Round  10, Train loss: 0.596, Test loss: 1.011, Test accuracy: 64.80 

Round  11, Train loss: 0.553, Test loss: 1.021, Test accuracy: 63.00 

Round  12, Train loss: 0.495, Test loss: 1.009, Test accuracy: 65.90 

Round  13, Train loss: 0.456, Test loss: 1.034, Test accuracy: 65.20 

Round  14, Train loss: 0.431, Test loss: 1.013, Test accuracy: 65.60 

Round  15, Train loss: 0.376, Test loss: 1.189, Test accuracy: 63.90 

Round  16, Train loss: 0.351, Test loss: 1.148, Test accuracy: 66.00 

Round  17, Train loss: 0.324, Test loss: 1.061, Test accuracy: 66.60 

Round  18, Train loss: 0.286, Test loss: 1.063, Test accuracy: 66.40 

Round  19, Train loss: 0.255, Test loss: 1.199, Test accuracy: 65.20 

Round  20, Train loss: 0.246, Test loss: 1.155, Test accuracy: 65.80 

Round  21, Train loss: 0.222, Test loss: 1.320, Test accuracy: 65.20 

Round  22, Train loss: 0.229, Test loss: 1.080, Test accuracy: 67.50 

Round  23, Train loss: 0.157, Test loss: 1.172, Test accuracy: 66.90 

Round  24, Train loss: 0.184, Test loss: 1.243, Test accuracy: 66.00 

Round  25, Train loss: 0.177, Test loss: 1.141, Test accuracy: 66.10 

Round  26, Train loss: 0.151, Test loss: 1.241, Test accuracy: 66.30 

Round  27, Train loss: 0.130, Test loss: 1.191, Test accuracy: 67.30 

Round  28, Train loss: 0.134, Test loss: 1.251, Test accuracy: 67.40 

Round  29, Train loss: 0.121, Test loss: 1.200, Test accuracy: 67.80 

Round  30, Train loss: 0.123, Test loss: 1.116, Test accuracy: 68.90 

Round  31, Train loss: 0.080, Test loss: 1.294, Test accuracy: 68.40 

Round  32, Train loss: 0.095, Test loss: 1.286, Test accuracy: 69.50 

Round  33, Train loss: 0.073, Test loss: 1.221, Test accuracy: 69.70 

Round  34, Train loss: 0.064, Test loss: 1.257, Test accuracy: 68.40 

Round  35, Train loss: 0.067, Test loss: 1.311, Test accuracy: 70.20 

Round  36, Train loss: 0.087, Test loss: 1.383, Test accuracy: 67.10 

Round  37, Train loss: 0.068, Test loss: 1.437, Test accuracy: 67.80 

Round  38, Train loss: 0.060, Test loss: 1.458, Test accuracy: 68.30 

Round  39, Train loss: 0.062, Test loss: 1.397, Test accuracy: 67.10 

Final Round, Train loss: 0.041, Test loss: 1.429, Test accuracy: 68.60 

Average accuracy final 10 rounds: 68.54 

481.4647307395935
[10.985107898712158, 16.57442879676819, 21.82295823097229, 26.900827407836914, 32.07823920249939, 37.391900300979614, 42.64226460456848, 47.82003045082092, 53.441643714904785, 58.52746653556824, 63.76138710975647, 68.94026374816895, 74.3227002620697, 79.64650225639343, 85.005624294281, 90.28307461738586, 95.31741714477539, 100.59542751312256, 105.80649971961975, 110.82918500900269, 116.24793696403503, 121.5246741771698, 126.94875001907349, 132.0490734577179, 137.33084559440613, 142.53659892082214, 147.65853452682495, 153.2013783454895, 158.26379251480103, 163.28350830078125, 168.3068835735321, 173.409104347229, 178.72542214393616, 184.3039050102234, 189.39946174621582, 194.67355227470398, 200.00886964797974, 205.16688632965088, 210.2939157485962, 215.6025586128235, 221.06844210624695]
[29.5, 37.5, 50.8, 55.5, 57.4, 55.6, 59.3, 62.7, 63.8, 65.9, 64.8, 63.0, 65.9, 65.2, 65.6, 63.9, 66.0, 66.6, 66.4, 65.2, 65.8, 65.2, 67.5, 66.9, 66.0, 66.1, 66.3, 67.3, 67.4, 67.8, 68.9, 68.4, 69.5, 69.7, 68.4, 70.2, 67.1, 67.8, 68.3, 67.1, 68.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.555, Test loss: 1.708, Test accuracy: 28.00
Round   1, Train loss: 1.335, Test loss: 1.250, Test accuracy: 46.50
Round   2, Train loss: 1.176, Test loss: 1.141, Test accuracy: 50.10
Round   3, Train loss: 1.113, Test loss: 1.020, Test accuracy: 57.40
Round   4, Train loss: 0.979, Test loss: 1.026, Test accuracy: 57.20
Round   5, Train loss: 0.927, Test loss: 1.040, Test accuracy: 58.20
Round   6, Train loss: 0.832, Test loss: 0.978, Test accuracy: 61.00
Round   7, Train loss: 0.790, Test loss: 0.962, Test accuracy: 61.40
Round   8, Train loss: 0.708, Test loss: 0.905, Test accuracy: 65.80
Round   9, Train loss: 0.644, Test loss: 1.009, Test accuracy: 63.90
Round  10, Train loss: 0.629, Test loss: 0.906, Test accuracy: 65.90
Round  11, Train loss: 0.554, Test loss: 0.985, Test accuracy: 66.50
Round  12, Train loss: 0.505, Test loss: 0.995, Test accuracy: 65.80
Round  13, Train loss: 0.478, Test loss: 0.905, Test accuracy: 66.20
Round  14, Train loss: 0.430, Test loss: 0.989, Test accuracy: 66.10
Round  15, Train loss: 0.406, Test loss: 0.931, Test accuracy: 68.70
Round  16, Train loss: 0.354, Test loss: 1.011, Test accuracy: 67.60
Round  17, Train loss: 0.339, Test loss: 1.019, Test accuracy: 67.40
Round  18, Train loss: 0.322, Test loss: 1.026, Test accuracy: 68.20
Round  19, Train loss: 0.279, Test loss: 1.083, Test accuracy: 66.70
Round  20, Train loss: 0.267, Test loss: 1.091, Test accuracy: 67.20
Round  21, Train loss: 0.250, Test loss: 1.037, Test accuracy: 67.90
Round  22, Train loss: 0.224, Test loss: 1.106, Test accuracy: 68.20
Round  23, Train loss: 0.183, Test loss: 1.108, Test accuracy: 69.30
Round  24, Train loss: 0.158, Test loss: 1.130, Test accuracy: 69.20
Round  25, Train loss: 0.168, Test loss: 1.148, Test accuracy: 68.00
Round  26, Train loss: 0.158, Test loss: 1.120, Test accuracy: 69.10
Round  27, Train loss: 0.153, Test loss: 1.108, Test accuracy: 69.70
Round  28, Train loss: 0.136, Test loss: 1.093, Test accuracy: 69.80
Round  29, Train loss: 0.127, Test loss: 1.157, Test accuracy: 68.50
Round  30, Train loss: 0.093, Test loss: 1.263, Test accuracy: 67.20
Round  31, Train loss: 0.088, Test loss: 1.240, Test accuracy: 68.40
Round  32, Train loss: 0.126, Test loss: 1.124, Test accuracy: 69.70
Round  33, Train loss: 0.091, Test loss: 1.216, Test accuracy: 68.70
Round  34, Train loss: 0.098, Test loss: 1.257, Test accuracy: 69.00
Round  35, Train loss: 0.081, Test loss: 1.235, Test accuracy: 68.40
Round  36, Train loss: 0.079, Test loss: 1.204, Test accuracy: 70.10
Round  37, Train loss: 0.056, Test loss: 1.231, Test accuracy: 69.70
Round  38, Train loss: 0.063, Test loss: 1.243, Test accuracy: 70.60
Round  39, Train loss: 0.065, Test loss: 1.242, Test accuracy: 69.30
Final Round, Train loss: 0.037, Test loss: 1.242, Test accuracy: 69.80
Average accuracy final 10 rounds: 69.11000000000001
565.4244985580444
[12.205410718917847, 18.346827745437622, 24.844794511795044, 30.940953731536865, 37.31321430206299, 43.76279616355896, 49.89825940132141, 56.29147672653198, 62.55826711654663, 68.82058072090149, 75.30654525756836, 81.67794108390808, 87.86889910697937, 94.24108862876892, 100.45197200775146, 106.61014747619629, 112.87952613830566, 119.20972442626953, 125.66340160369873, 132.00328063964844, 137.9363408088684, 144.2331202030182, 150.4782156944275, 156.89397764205933, 163.37740802764893, 169.57141304016113, 176.0297245979309, 182.3609881401062, 188.5851390361786, 194.75294256210327, 201.04856944084167, 207.09962940216064, 213.2791783809662, 219.59973692893982, 225.6389455795288, 231.88171291351318, 238.01523804664612, 244.48535227775574, 250.77727365493774, 257.17411041259766, 264.1334412097931]
[28.0, 46.5, 50.1, 57.4, 57.2, 58.2, 61.0, 61.4, 65.8, 63.9, 65.9, 66.5, 65.8, 66.2, 66.1, 68.7, 67.6, 67.4, 68.2, 66.7, 67.2, 67.9, 68.2, 69.3, 69.2, 68.0, 69.1, 69.7, 69.8, 68.5, 67.2, 68.4, 69.7, 68.7, 69.0, 68.4, 70.1, 69.7, 70.6, 69.3, 69.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.573, Train accuracy: 79.800, Test loss: 1.573, Test accuracy: 55.60 

        train local model (freeze embeding):client   0,  Train loss: 0.289, Train accuracy: 89.800, Test loss: 1.253, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.273, Train accuracy: 90.200, Test loss: 1.365, Test accuracy: 61.80 

Round   0, Train loss: 0.273, Test loss: 1.365, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.178, Train accuracy: 94.200, Test loss: 1.214, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.310, Train accuracy: 88.600, Test loss: 1.355, Test accuracy: 63.60 

Round   1, Train loss: 0.310, Test loss: 1.355, Test accuracy: 63.60 

        train local model (freeze embeding):client   0,  Train loss: 0.100, Train accuracy: 96.600, Test loss: 1.119, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.074, Train accuracy: 97.800, Test loss: 1.448, Test accuracy: 66.20 

Round   2, Train loss: 0.074, Test loss: 1.448, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 99.800, Test loss: 1.430, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.600, Test loss: 1.543, Test accuracy: 66.80 

Round   3, Train loss: 0.040, Test loss: 1.543, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.466, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.501, Test accuracy: 66.80 

Round   4, Train loss: 0.043, Test loss: 1.501, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.500, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.530, Test accuracy: 68.20 

Round   5, Train loss: 0.023, Test loss: 1.530, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.473, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.546, Test accuracy: 68.40 

Round   6, Train loss: 0.021, Test loss: 1.546, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.593, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.400, Test loss: 1.789, Test accuracy: 64.80 

Round   7, Train loss: 0.036, Test loss: 1.789, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.661, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.775, Test accuracy: 68.60 

Round   8, Train loss: 0.009, Test loss: 1.775, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.097, Train accuracy: 97.600, Test loss: 2.054, Test accuracy: 63.60 

Round   9, Train loss: 0.097, Test loss: 2.054, Test accuracy: 63.60 

        train local model (freeze embeding):client   0,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 1.786, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.744, Test accuracy: 67.60 

Round  10, Train loss: 0.010, Test loss: 1.744, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.801, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.552, Test accuracy: 68.60 

Round  11, Train loss: 0.004, Test loss: 1.552, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.644, Test accuracy: 71.00 

Round  12, Train loss: 0.002, Test loss: 1.644, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.685, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.714, Test accuracy: 70.00 

Round  13, Train loss: 0.001, Test loss: 1.714, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.714, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.723, Test accuracy: 70.80 

Round  14, Train loss: 0.002, Test loss: 1.723, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.686, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.732, Test accuracy: 68.20 

Round  15, Train loss: 0.003, Test loss: 1.732, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.710, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.854, Test accuracy: 66.60 

Round  16, Train loss: 0.002, Test loss: 1.854, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.782, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.664, Test accuracy: 69.20 

Round  17, Train loss: 0.001, Test loss: 1.664, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.685, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.573, Test accuracy: 70.20 

Round  18, Train loss: 0.000, Test loss: 1.573, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.805, Test accuracy: 70.40 

Round  19, Train loss: 0.005, Test loss: 1.805, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.786, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.723, Test accuracy: 70.20 

Final Round, Train loss: 0.001, Test loss: 1.718, Test accuracy: 70.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.918, Train accuracy: 65.200, Test loss: 1.056, Test accuracy: 58.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.709, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.585, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.929, Train accuracy: 61.400, Test loss: 1.048, Test accuracy: 57.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.719, Train accuracy: 79.600, Test loss: 2.218, Test accuracy: 58.80 

Round   0, Train loss: 0.360, Test loss: 1.294, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.543, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.338, Train accuracy: 88.800, Test loss: 0.931, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.188, Train accuracy: 94.200, Test loss: 1.252, Test accuracy: 66.00 

Round   1, Train loss: 0.094, Test loss: 1.214, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.500, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.102, Train accuracy: 97.800, Test loss: 0.918, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.117, Train accuracy: 96.200, Test loss: 1.303, Test accuracy: 69.00 

Round   2, Train loss: 0.059, Test loss: 1.219, Test accuracy: 70.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.448, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.691, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.073, Train accuracy: 97.800, Test loss: 1.013, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.198, Test accuracy: 71.00 

Round   3, Train loss: 0.020, Test loss: 1.249, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.563, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.600, Test loss: 1.820, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.600, Test loss: 1.050, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.182, Train accuracy: 92.800, Test loss: 2.206, Test accuracy: 58.60 

Round   4, Train loss: 0.094, Test loss: 1.563, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.628, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.889, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.800, Test loss: 1.147, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.074, Train accuracy: 98.000, Test loss: 1.684, Test accuracy: 66.80 

Round   5, Train loss: 0.055, Test loss: 1.486, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.595, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.843, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.600, Test loss: 1.246, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.559, Test accuracy: 71.00 

Round   6, Train loss: 0.021, Test loss: 1.354, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.627, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.357, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.108, Train accuracy: 97.000, Test loss: 2.124, Test accuracy: 64.40 

Round   7, Train loss: 0.054, Test loss: 1.530, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.464, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.572, Test accuracy: 71.80 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.409, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.907, Test accuracy: 64.20 

Round   8, Train loss: 0.021, Test loss: 1.424, Test accuracy: 71.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.553, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.305, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.349, Test accuracy: 73.00 

Round   9, Train loss: 0.004, Test loss: 1.372, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.716, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.092, Train accuracy: 96.400, Test loss: 1.999, Test accuracy: 64.60 

Round  10, Train loss: 0.048, Test loss: 1.420, Test accuracy: 71.30 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.550, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.904, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.337, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.562, Test accuracy: 71.00 

Round  11, Train loss: 0.008, Test loss: 1.469, Test accuracy: 71.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.539, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.876, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.606, Test accuracy: 67.80 

Round  12, Train loss: 0.015, Test loss: 1.481, Test accuracy: 70.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.552, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.589, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.522, Test accuracy: 70.20 

Round  13, Train loss: 0.006, Test loss: 1.436, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.462, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.615, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.453, Test accuracy: 72.60 

Round  14, Train loss: 0.000, Test loss: 1.434, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.672, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 71.40 

Round  15, Train loss: 0.000, Test loss: 1.534, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.669, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.613, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.724, Test accuracy: 69.00 

Round  16, Train loss: 0.003, Test loss: 1.559, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.652, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.643, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 73.80 

Round  17, Train loss: 0.000, Test loss: 1.504, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.595, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 70.60 

Round  18, Train loss: 0.001, Test loss: 1.570, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.553, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.921, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.672, Test accuracy: 71.80 

Round  19, Train loss: 0.001, Test loss: 1.613, Test accuracy: 72.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.640, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.609, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.541, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 71.20 

Final Round, Train loss: 0.000, Test loss: 1.589, Test accuracy: 72.10 

Average accuracy final 10 rounds: 140.73 

1266.1208662986755
[18.88166093826294, 37.76701545715332, 57.086535692214966, 76.03753876686096, 94.80474042892456, 113.03866910934448, 132.12749695777893, 151.16686916351318, 170.21847009658813, 188.7913773059845, 207.40606665611267, 225.77781343460083, 243.57427406311035, 262.6334547996521, 281.5269718170166, 300.5774257183075, 319.5962007045746, 337.10174012184143, 355.76842999458313, 374.4611032009125, 385.16884422302246, 403.84199380874634, 423.0970501899719, 442.79532122612, 461.9940423965454, 480.970499753952, 499.68422532081604, 518.6054029464722, 537.5420858860016, 556.4918689727783, 575.6633689403534, 594.5322015285492, 613.6808576583862, 632.7486793994904, 651.6645457744598, 670.537903547287, 689.4483458995819, 708.312840461731, 726.8905146121979, 745.9015035629272, 764.7346396446228, 776.4039561748505]
[61.8, 63.6, 66.2, 66.8, 66.8, 68.2, 68.4, 64.8, 68.6, 63.6, 67.6, 68.6, 71.0, 70.0, 70.8, 68.2, 66.6, 69.2, 70.2, 70.4, 70.0, 68.0, 69.0, 70.9, 70.6, 67.8, 69.8, 71.9, 69.4, 71.3, 73.2, 71.3, 71.3, 70.9, 71.6, 71.5, 71.4, 71.0, 71.9, 71.5, 72.3, 72.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.451, Test loss: 1.295, Test accuracy: 52.80 

Round   0, Global train loss: 1.451, Global test loss: 1.590, Global test accuracy: 32.40 

Round   1, Train loss: 1.103, Test loss: 1.053, Test accuracy: 58.20 

Round   1, Global train loss: 1.103, Global test loss: 1.761, Global test accuracy: 27.20 

Round   2, Train loss: 0.946, Test loss: 1.020, Test accuracy: 63.20 

Round   2, Global train loss: 0.946, Global test loss: 1.994, Global test accuracy: 23.50 

Round   3, Train loss: 0.783, Test loss: 0.996, Test accuracy: 64.20 

Round   3, Global train loss: 0.783, Global test loss: 1.974, Global test accuracy: 24.70 

Round   4, Train loss: 0.676, Test loss: 1.212, Test accuracy: 61.80 

Round   4, Global train loss: 0.676, Global test loss: 2.041, Global test accuracy: 25.90 

Round   5, Train loss: 0.605, Test loss: 1.170, Test accuracy: 64.40 

Round   5, Global train loss: 0.605, Global test loss: 2.258, Global test accuracy: 25.20 

Round   6, Train loss: 0.495, Test loss: 1.283, Test accuracy: 63.60 

Round   6, Global train loss: 0.495, Global test loss: 2.303, Global test accuracy: 25.80 

Round   7, Train loss: 0.429, Test loss: 1.230, Test accuracy: 66.30 

Round   7, Global train loss: 0.429, Global test loss: 2.053, Global test accuracy: 30.80 

Round   8, Train loss: 0.342, Test loss: 1.326, Test accuracy: 63.80 

Round   8, Global train loss: 0.342, Global test loss: 2.688, Global test accuracy: 21.90 

Round   9, Train loss: 0.323, Test loss: 1.707, Test accuracy: 63.10 

Round   9, Global train loss: 0.323, Global test loss: 2.403, Global test accuracy: 23.10 

Round  10, Train loss: 0.286, Test loss: 1.429, Test accuracy: 64.50 

Round  10, Global train loss: 0.286, Global test loss: 2.441, Global test accuracy: 25.30 

Round  11, Train loss: 0.219, Test loss: 1.749, Test accuracy: 62.10 

Round  11, Global train loss: 0.219, Global test loss: 2.971, Global test accuracy: 22.40 

Round  12, Train loss: 0.205, Test loss: 1.707, Test accuracy: 64.70 

Round  12, Global train loss: 0.205, Global test loss: 2.602, Global test accuracy: 26.30 

Round  13, Train loss: 0.157, Test loss: 2.415, Test accuracy: 57.10 

Round  13, Global train loss: 0.157, Global test loss: 3.232, Global test accuracy: 21.10 

Round  14, Train loss: 0.151, Test loss: 1.594, Test accuracy: 67.10 

Round  14, Global train loss: 0.151, Global test loss: 2.852, Global test accuracy: 23.70 

Round  15, Train loss: 0.122, Test loss: 1.707, Test accuracy: 66.60 

Round  15, Global train loss: 0.122, Global test loss: 2.869, Global test accuracy: 24.90 

Round  16, Train loss: 0.125, Test loss: 1.812, Test accuracy: 65.70 

Round  16, Global train loss: 0.125, Global test loss: 3.072, Global test accuracy: 22.50 

Round  17, Train loss: 0.115, Test loss: 1.618, Test accuracy: 66.60 

Round  17, Global train loss: 0.115, Global test loss: 3.032, Global test accuracy: 22.80 

Round  18, Train loss: 0.092, Test loss: 1.802, Test accuracy: 65.30 

Round  18, Global train loss: 0.092, Global test loss: 3.673, Global test accuracy: 20.90 

Round  19, Train loss: 0.087, Test loss: 1.709, Test accuracy: 68.30 

Round  19, Global train loss: 0.087, Global test loss: 3.151, Global test accuracy: 22.70 

Round  20, Train loss: 0.077, Test loss: 1.656, Test accuracy: 66.20 

Round  20, Global train loss: 0.077, Global test loss: 3.042, Global test accuracy: 21.90 

Round  21, Train loss: 0.072, Test loss: 1.645, Test accuracy: 67.70 

Round  21, Global train loss: 0.072, Global test loss: 2.763, Global test accuracy: 25.80 

Round  22, Train loss: 0.061, Test loss: 1.710, Test accuracy: 67.80 

Round  22, Global train loss: 0.061, Global test loss: 3.127, Global test accuracy: 24.20 

Round  23, Train loss: 0.075, Test loss: 1.662, Test accuracy: 67.90 

Round  23, Global train loss: 0.075, Global test loss: 3.487, Global test accuracy: 20.80 

Round  24, Train loss: 0.085, Test loss: 1.588, Test accuracy: 70.60 

Round  24, Global train loss: 0.085, Global test loss: 3.098, Global test accuracy: 23.70 

Round  25, Train loss: 0.027, Test loss: 1.467, Test accuracy: 70.60 

Round  25, Global train loss: 0.027, Global test loss: 3.176, Global test accuracy: 23.80 

Round  26, Train loss: 0.042, Test loss: 1.834, Test accuracy: 66.10 

Round  26, Global train loss: 0.042, Global test loss: 3.115, Global test accuracy: 24.90 

Round  27, Train loss: 0.030, Test loss: 1.643, Test accuracy: 69.20 

Round  27, Global train loss: 0.030, Global test loss: 2.839, Global test accuracy: 25.60 

Round  28, Train loss: 0.036, Test loss: 1.697, Test accuracy: 69.70 

Round  28, Global train loss: 0.036, Global test loss: 3.066, Global test accuracy: 26.10 

Round  29, Train loss: 0.034, Test loss: 2.082, Test accuracy: 67.10 

Round  29, Global train loss: 0.034, Global test loss: 3.475, Global test accuracy: 22.90 

Round  30, Train loss: 0.027, Test loss: 1.894, Test accuracy: 67.70 

Round  30, Global train loss: 0.027, Global test loss: 3.160, Global test accuracy: 24.00 

Round  31, Train loss: 0.041, Test loss: 1.708, Test accuracy: 69.80 

Round  31, Global train loss: 0.041, Global test loss: 3.285, Global test accuracy: 22.90 

Round  32, Train loss: 0.042, Test loss: 1.645, Test accuracy: 71.00 

Round  32, Global train loss: 0.042, Global test loss: 2.809, Global test accuracy: 25.20 

Round  33, Train loss: 0.030, Test loss: 1.634, Test accuracy: 69.90 

Round  33, Global train loss: 0.030, Global test loss: 3.242, Global test accuracy: 23.00 

Round  34, Train loss: 0.019, Test loss: 1.924, Test accuracy: 68.20 

Round  34, Global train loss: 0.019, Global test loss: 3.583, Global test accuracy: 23.70 

Final Round, Train loss: 0.027, Test loss: 1.593, Test accuracy: 69.30 

Final Round, Global train loss: 0.027, Global test loss: 3.583, Global test accuracy: 23.70 

Average accuracy final 10 rounds: 68.93 

Average global accuracy final 10 rounds: 24.21 

597.0648710727692
[12.431386947631836, 19.226229429244995, 26.06587529182434, 32.98135447502136, 39.88696360588074, 46.877567768096924, 53.70471739768982, 60.92793273925781, 67.75666999816895, 74.64515995979309, 81.42554569244385, 88.11146783828735, 95.25006341934204, 102.02151536941528, 109.07022380828857, 116.07739591598511, 122.99492526054382, 130.25442576408386, 137.04369473457336, 143.8489215373993, 150.7434663772583, 157.7506821155548, 164.45905232429504, 171.31365370750427, 178.09759783744812, 184.8923408985138, 191.76225447654724, 198.8003706932068, 205.83695602416992, 212.54527592658997, 219.89487290382385, 226.71612858772278, 233.22674703598022, 240.0660834312439, 246.8647756576538, 260.3639702796936]
[52.8, 58.2, 63.2, 64.2, 61.8, 64.4, 63.6, 66.3, 63.8, 63.1, 64.5, 62.1, 64.7, 57.1, 67.1, 66.6, 65.7, 66.6, 65.3, 68.3, 66.2, 67.7, 67.8, 67.9, 70.6, 70.6, 66.1, 69.2, 69.7, 67.1, 67.7, 69.8, 71.0, 69.9, 68.2, 69.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.442, Test loss: 1.261, Test accuracy: 52.80 

Round   0, Global train loss: 1.442, Global test loss: 1.525, Global test accuracy: 39.50 

Round   1, Train loss: 1.227, Test loss: 1.391, Test accuracy: 52.10 

Round   1, Global train loss: 1.227, Global test loss: 1.395, Global test accuracy: 44.80 

Round   2, Train loss: 1.086, Test loss: 1.359, Test accuracy: 53.00 

Round   2, Global train loss: 1.086, Global test loss: 1.276, Global test accuracy: 50.20 

Round   3, Train loss: 0.967, Test loss: 1.404, Test accuracy: 51.10 

Round   3, Global train loss: 0.967, Global test loss: 1.320, Global test accuracy: 51.90 

Round   4, Train loss: 0.909, Test loss: 1.022, Test accuracy: 64.70 

Round   4, Global train loss: 0.909, Global test loss: 1.206, Global test accuracy: 53.70 

Round   5, Train loss: 0.799, Test loss: 0.977, Test accuracy: 64.30 

Round   5, Global train loss: 0.799, Global test loss: 1.290, Global test accuracy: 55.40 

Round   6, Train loss: 0.721, Test loss: 1.114, Test accuracy: 62.50 

Round   6, Global train loss: 0.721, Global test loss: 1.327, Global test accuracy: 53.20 

Round   7, Train loss: 0.656, Test loss: 1.413, Test accuracy: 59.80 

Round   7, Global train loss: 0.656, Global test loss: 1.371, Global test accuracy: 57.60 

Round   8, Train loss: 0.571, Test loss: 1.059, Test accuracy: 65.90 

Round   8, Global train loss: 0.571, Global test loss: 1.237, Global test accuracy: 56.70 

Round   9, Train loss: 0.549, Test loss: 1.411, Test accuracy: 61.30 

Round   9, Global train loss: 0.549, Global test loss: 1.338, Global test accuracy: 57.40 

Round  10, Train loss: 0.462, Test loss: 1.086, Test accuracy: 66.60 

Round  10, Global train loss: 0.462, Global test loss: 1.417, Global test accuracy: 56.70 

Round  11, Train loss: 0.440, Test loss: 1.553, Test accuracy: 61.30 

Round  11, Global train loss: 0.440, Global test loss: 1.718, Global test accuracy: 54.70 

Round  12, Train loss: 0.374, Test loss: 1.308, Test accuracy: 66.20 

Round  12, Global train loss: 0.374, Global test loss: 1.669, Global test accuracy: 56.30 

Round  13, Train loss: 0.355, Test loss: 1.375, Test accuracy: 66.60 

Round  13, Global train loss: 0.355, Global test loss: 1.679, Global test accuracy: 57.60 

Round  14, Train loss: 0.303, Test loss: 1.336, Test accuracy: 67.40 

Round  14, Global train loss: 0.303, Global test loss: 1.824, Global test accuracy: 55.60 

Round  15, Train loss: 0.282, Test loss: 1.469, Test accuracy: 65.40 

Round  15, Global train loss: 0.282, Global test loss: 1.803, Global test accuracy: 57.30 

Round  16, Train loss: 0.232, Test loss: 1.452, Test accuracy: 64.90 

Round  16, Global train loss: 0.232, Global test loss: 1.944, Global test accuracy: 54.90 

Round  17, Train loss: 0.194, Test loss: 1.743, Test accuracy: 62.60 

Round  17, Global train loss: 0.194, Global test loss: 1.879, Global test accuracy: 56.40 

Round  18, Train loss: 0.214, Test loss: 1.472, Test accuracy: 66.40 

Round  18, Global train loss: 0.214, Global test loss: 1.671, Global test accuracy: 58.60 

Round  19, Train loss: 0.206, Test loss: 1.705, Test accuracy: 64.90 

Round  19, Global train loss: 0.206, Global test loss: 2.220, Global test accuracy: 53.20 

Round  20, Train loss: 0.158, Test loss: 1.546, Test accuracy: 67.40 

Round  20, Global train loss: 0.158, Global test loss: 1.834, Global test accuracy: 59.40 

Round  21, Train loss: 0.148, Test loss: 1.653, Test accuracy: 66.90 

Round  21, Global train loss: 0.148, Global test loss: 1.853, Global test accuracy: 58.00 

Round  22, Train loss: 0.148, Test loss: 1.757, Test accuracy: 66.90 

Round  22, Global train loss: 0.148, Global test loss: 1.993, Global test accuracy: 58.40 

Round  23, Train loss: 0.147, Test loss: 1.557, Test accuracy: 67.60 

Round  23, Global train loss: 0.147, Global test loss: 1.856, Global test accuracy: 59.20 

Round  24, Train loss: 0.096, Test loss: 1.673, Test accuracy: 67.40 

Round  24, Global train loss: 0.096, Global test loss: 1.894, Global test accuracy: 61.20 

Round  25, Train loss: 0.134, Test loss: 1.728, Test accuracy: 66.40 

Round  25, Global train loss: 0.134, Global test loss: 1.991, Global test accuracy: 58.70 

Round  26, Train loss: 0.107, Test loss: 1.533, Test accuracy: 68.10 

Round  26, Global train loss: 0.107, Global test loss: 1.898, Global test accuracy: 59.50 

Round  27, Train loss: 0.082, Test loss: 2.020, Test accuracy: 62.20 

Round  27, Global train loss: 0.082, Global test loss: 2.404, Global test accuracy: 54.80 

Round  28, Train loss: 0.059, Test loss: 1.543, Test accuracy: 70.40 

Round  28, Global train loss: 0.059, Global test loss: 2.047, Global test accuracy: 60.30 

Round  29, Train loss: 0.091, Test loss: 1.609, Test accuracy: 69.70 

Round  29, Global train loss: 0.091, Global test loss: 1.996, Global test accuracy: 59.90 

Round  30, Train loss: 0.075, Test loss: 1.741, Test accuracy: 68.90 

Round  30, Global train loss: 0.075, Global test loss: 2.284, Global test accuracy: 58.40 

Round  31, Train loss: 0.079, Test loss: 1.592, Test accuracy: 69.30 

Round  31, Global train loss: 0.079, Global test loss: 2.087, Global test accuracy: 59.50 

Round  32, Train loss: 0.057, Test loss: 1.403, Test accuracy: 70.70 

Round  32, Global train loss: 0.057, Global test loss: 1.752, Global test accuracy: 61.70 

Round  33, Train loss: 0.056, Test loss: 1.708, Test accuracy: 67.70 

Round  33, Global train loss: 0.056, Global test loss: 1.961, Global test accuracy: 59.90 

Round  34, Train loss: 0.032, Test loss: 1.566, Test accuracy: 70.40 

Round  34, Global train loss: 0.032, Global test loss: 2.027, Global test accuracy: 59.90 

Final Round, Train loss: 0.063, Test loss: 1.709, Test accuracy: 66.20 

Final Round, Global train loss: 0.063, Global test loss: 2.027, Global test accuracy: 59.90 

Average accuracy final 10 rounds: 68.38000000000001 

Average global accuracy final 10 rounds: 59.260000000000005 

592.6949408054352
[13.408410787582397, 20.210405588150024, 26.776235342025757, 33.42055344581604, 40.13870096206665, 47.09806942939758, 53.82111644744873, 60.626739740371704, 67.32042956352234, 74.05984830856323, 80.76192855834961, 87.58216857910156, 94.28210830688477, 100.94832873344421, 107.86257719993591, 114.74180459976196, 121.42877697944641, 128.29154515266418, 135.1080458164215, 141.9151690006256, 148.87116122245789, 155.9295802116394, 162.7855682373047, 169.4003643989563, 175.96526861190796, 183.20334315299988, 190.11204385757446, 197.01420092582703, 204.2581217288971, 210.82493042945862, 217.5344135761261, 224.56610894203186, 231.26735663414001, 237.96088790893555, 244.84354996681213, 258.1516537666321]
[52.8, 52.1, 53.0, 51.1, 64.7, 64.3, 62.5, 59.8, 65.9, 61.3, 66.6, 61.3, 66.2, 66.6, 67.4, 65.4, 64.9, 62.6, 66.4, 64.9, 67.4, 66.9, 66.9, 67.6, 67.4, 66.4, 68.1, 62.2, 70.4, 69.7, 68.9, 69.3, 70.7, 67.7, 70.4, 66.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.513, Test loss: 1.414, Test accuracy: 35.80 

Round   1, Train loss: 1.309, Test loss: 1.276, Test accuracy: 45.60 

Round   2, Train loss: 1.167, Test loss: 1.206, Test accuracy: 47.80 

Round   3, Train loss: 1.060, Test loss: 1.063, Test accuracy: 55.80 

Round   4, Train loss: 1.020, Test loss: 1.162, Test accuracy: 53.70 

Round   5, Train loss: 0.922, Test loss: 0.977, Test accuracy: 63.00 

Round   6, Train loss: 0.862, Test loss: 1.203, Test accuracy: 58.00 

Round   7, Train loss: 0.823, Test loss: 1.005, Test accuracy: 60.50 

Round   8, Train loss: 0.740, Test loss: 0.952, Test accuracy: 64.80 

Round   9, Train loss: 0.667, Test loss: 0.932, Test accuracy: 64.60 

Round  10, Train loss: 0.629, Test loss: 0.952, Test accuracy: 65.10 

Round  11, Train loss: 0.593, Test loss: 0.928, Test accuracy: 64.70 

Round  12, Train loss: 0.552, Test loss: 0.987, Test accuracy: 65.00 

Round  13, Train loss: 0.510, Test loss: 0.998, Test accuracy: 66.30 

Round  14, Train loss: 0.475, Test loss: 1.173, Test accuracy: 63.90 

Round  15, Train loss: 0.412, Test loss: 1.035, Test accuracy: 65.90 

Round  16, Train loss: 0.365, Test loss: 0.969, Test accuracy: 67.80 

Round  17, Train loss: 0.358, Test loss: 0.964, Test accuracy: 67.50 

Round  18, Train loss: 0.312, Test loss: 1.089, Test accuracy: 65.50 

Round  19, Train loss: 0.298, Test loss: 1.002, Test accuracy: 67.50 

Round  20, Train loss: 0.285, Test loss: 1.047, Test accuracy: 67.80 

Round  21, Train loss: 0.231, Test loss: 1.024, Test accuracy: 68.20 

Round  22, Train loss: 0.235, Test loss: 1.049, Test accuracy: 67.00 

Round  23, Train loss: 0.217, Test loss: 1.004, Test accuracy: 69.60 

Round  24, Train loss: 0.182, Test loss: 1.023, Test accuracy: 69.00 

Round  25, Train loss: 0.167, Test loss: 1.057, Test accuracy: 70.40 

Round  26, Train loss: 0.152, Test loss: 1.082, Test accuracy: 69.00 

Round  27, Train loss: 0.140, Test loss: 1.086, Test accuracy: 67.60 

Round  28, Train loss: 0.147, Test loss: 1.102, Test accuracy: 69.10 

Round  29, Train loss: 0.127, Test loss: 1.134, Test accuracy: 68.80 

Round  30, Train loss: 0.121, Test loss: 1.186, Test accuracy: 69.40 

Round  31, Train loss: 0.121, Test loss: 1.149, Test accuracy: 69.70 

Round  32, Train loss: 0.113, Test loss: 1.363, Test accuracy: 66.80 

Round  33, Train loss: 0.083, Test loss: 1.270, Test accuracy: 66.70 

Round  34, Train loss: 0.083, Test loss: 1.296, Test accuracy: 66.80 

Round  35, Train loss: 0.074, Test loss: 1.199, Test accuracy: 69.10 

Round  36, Train loss: 0.087, Test loss: 1.259, Test accuracy: 68.50 

Round  37, Train loss: 0.100, Test loss: 1.249, Test accuracy: 70.00 

Round  38, Train loss: 0.075, Test loss: 1.190, Test accuracy: 70.50 

Round  39, Train loss: 0.070, Test loss: 1.209, Test accuracy: 69.70 

Final Round, Train loss: 0.038, Test loss: 1.206, Test accuracy: 70.20 

Average accuracy final 10 rounds: 68.72 

475.0980370044708
[10.964684247970581, 15.884951829910278, 20.762449741363525, 26.139014959335327, 31.40168070793152, 36.58251714706421, 41.56996488571167, 46.694284439086914, 51.96345353126526, 57.079334020614624, 62.25625824928284, 67.47464323043823, 72.70686936378479, 77.85121893882751, 83.03686094284058, 88.09963846206665, 93.20434808731079, 98.36059904098511, 103.69366025924683, 108.92663097381592, 113.96176290512085, 118.90102028846741, 124.04306745529175, 129.16245794296265, 134.3764615058899, 139.5432732105255, 144.77110600471497, 149.81837821006775, 155.10664916038513, 160.3753044605255, 165.9035143852234, 171.24339723587036, 176.52746653556824, 181.53703808784485, 186.49110007286072, 191.4824104309082, 196.8074610233307, 201.95671248435974, 207.2355990409851, 212.5761697292328, 218.17127633094788]
[35.8, 45.6, 47.8, 55.8, 53.7, 63.0, 58.0, 60.5, 64.8, 64.6, 65.1, 64.7, 65.0, 66.3, 63.9, 65.9, 67.8, 67.5, 65.5, 67.5, 67.8, 68.2, 67.0, 69.6, 69.0, 70.4, 69.0, 67.6, 69.1, 68.8, 69.4, 69.7, 66.8, 66.7, 66.8, 69.1, 68.5, 70.0, 70.5, 69.7, 70.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.549, Test loss: 1.526, Test accuracy: 34.70
Round   1, Train loss: 1.299, Test loss: 1.204, Test accuracy: 47.60
Round   2, Train loss: 1.200, Test loss: 1.157, Test accuracy: 49.60
Round   3, Train loss: 1.079, Test loss: 1.104, Test accuracy: 54.70
Round   4, Train loss: 1.001, Test loss: 1.015, Test accuracy: 58.90
Round   5, Train loss: 0.908, Test loss: 0.921, Test accuracy: 62.00
Round   6, Train loss: 0.819, Test loss: 0.921, Test accuracy: 63.70
Round   7, Train loss: 0.800, Test loss: 1.107, Test accuracy: 59.30
Round   8, Train loss: 0.729, Test loss: 0.978, Test accuracy: 62.70
Round   9, Train loss: 0.667, Test loss: 0.917, Test accuracy: 65.60
Round  10, Train loss: 0.622, Test loss: 0.963, Test accuracy: 64.20
Round  11, Train loss: 0.571, Test loss: 1.008, Test accuracy: 65.10
Round  12, Train loss: 0.517, Test loss: 0.960, Test accuracy: 66.30
Round  13, Train loss: 0.487, Test loss: 0.891, Test accuracy: 67.50
Round  14, Train loss: 0.444, Test loss: 0.929, Test accuracy: 68.30
Round  15, Train loss: 0.432, Test loss: 0.912, Test accuracy: 69.30
Round  16, Train loss: 0.372, Test loss: 0.953, Test accuracy: 67.60
Round  17, Train loss: 0.353, Test loss: 1.052, Test accuracy: 66.80
Round  18, Train loss: 0.311, Test loss: 1.000, Test accuracy: 66.90
Round  19, Train loss: 0.288, Test loss: 1.072, Test accuracy: 67.20
Round  20, Train loss: 0.260, Test loss: 1.025, Test accuracy: 69.10
Round  21, Train loss: 0.240, Test loss: 1.070, Test accuracy: 69.00
Round  22, Train loss: 0.215, Test loss: 0.967, Test accuracy: 70.60
Round  23, Train loss: 0.202, Test loss: 0.991, Test accuracy: 71.60
Round  24, Train loss: 0.197, Test loss: 1.013, Test accuracy: 71.80
Round  25, Train loss: 0.162, Test loss: 1.075, Test accuracy: 70.00
Round  26, Train loss: 0.160, Test loss: 1.025, Test accuracy: 70.70
Round  27, Train loss: 0.137, Test loss: 1.025, Test accuracy: 70.50
Round  28, Train loss: 0.144, Test loss: 1.034, Test accuracy: 71.40
Round  29, Train loss: 0.109, Test loss: 1.089, Test accuracy: 71.00
Round  30, Train loss: 0.108, Test loss: 1.122, Test accuracy: 68.70
Round  31, Train loss: 0.138, Test loss: 1.056, Test accuracy: 70.40
Round  32, Train loss: 0.108, Test loss: 1.018, Test accuracy: 70.00
Round  33, Train loss: 0.075, Test loss: 1.112, Test accuracy: 71.60
Round  34, Train loss: 0.065, Test loss: 1.144, Test accuracy: 70.50
Round  35, Train loss: 0.076, Test loss: 1.153, Test accuracy: 70.30
Round  36, Train loss: 0.085, Test loss: 1.163, Test accuracy: 71.00
Round  37, Train loss: 0.081, Test loss: 1.156, Test accuracy: 70.20
Round  38, Train loss: 0.083, Test loss: 1.120, Test accuracy: 70.50
Round  39, Train loss: 0.077, Test loss: 1.107, Test accuracy: 71.30
Final Round, Train loss: 0.043, Test loss: 1.116, Test accuracy: 71.60
Average accuracy final 10 rounds: 70.45
571.042647600174
[12.117148876190186, 18.719846963882446, 24.979256629943848, 31.185516834259033, 37.58416485786438, 43.85437870025635, 50.27083992958069, 56.694019079208374, 62.98242163658142, 69.36813116073608, 75.9238293170929, 82.38910698890686, 88.7245728969574, 95.22417140007019, 101.86064863204956, 108.08176159858704, 114.7260901927948, 120.93338561058044, 126.80771899223328, 132.8939027786255, 139.13119387626648, 145.37938380241394, 151.85221982002258, 158.19033002853394, 164.6861433982849, 170.81829071044922, 176.9139585494995, 183.22954630851746, 189.47483706474304, 196.00815153121948, 202.21311593055725, 208.81641292572021, 215.09208869934082, 221.48104119300842, 227.90105485916138, 234.14511013031006, 240.40459489822388, 246.63579058647156, 252.89572834968567, 259.19841599464417, 265.62942481040955]
[34.7, 47.6, 49.6, 54.7, 58.9, 62.0, 63.7, 59.3, 62.7, 65.6, 64.2, 65.1, 66.3, 67.5, 68.3, 69.3, 67.6, 66.8, 66.9, 67.2, 69.1, 69.0, 70.6, 71.6, 71.8, 70.0, 70.7, 70.5, 71.4, 71.0, 68.7, 70.4, 70.0, 71.6, 70.5, 70.3, 71.0, 70.2, 70.5, 71.3, 71.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.561, Train accuracy: 79.400, Test loss: 1.500, Test accuracy: 53.40 

        train local model (freeze embeding):client   0,  Train loss: 0.281, Train accuracy: 89.400, Test loss: 1.148, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.442, Train accuracy: 82.400, Test loss: 1.606, Test accuracy: 58.00 

Round   0, Train loss: 0.442, Test loss: 1.606, Test accuracy: 58.00 

        train local model (freeze embeding):client   0,  Train loss: 0.212, Train accuracy: 93.600, Test loss: 1.367, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.142, Train accuracy: 96.000, Test loss: 1.343, Test accuracy: 64.60 

Round   1, Train loss: 0.142, Test loss: 1.343, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.106, Train accuracy: 96.800, Test loss: 1.350, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.084, Train accuracy: 96.800, Test loss: 1.564, Test accuracy: 63.40 

Round   2, Train loss: 0.084, Test loss: 1.564, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 1.480, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.400, Test loss: 1.576, Test accuracy: 65.40 

Round   3, Train loss: 0.070, Test loss: 1.576, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.040, Train accuracy: 98.800, Test loss: 1.494, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.700, Test accuracy: 62.80 

Round   4, Train loss: 0.029, Test loss: 1.700, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.565, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.400, Test loss: 1.859, Test accuracy: 63.80 

Round   5, Train loss: 0.042, Test loss: 1.859, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.698, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 97.800, Test loss: 1.902, Test accuracy: 64.00 

Round   6, Train loss: 0.064, Test loss: 1.902, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.681, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.763, Test accuracy: 63.20 

Round   7, Train loss: 0.013, Test loss: 1.763, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.904, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.971, Test accuracy: 62.60 

Round   8, Train loss: 0.033, Test loss: 1.971, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.906, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.938, Test accuracy: 65.60 

Round   9, Train loss: 0.006, Test loss: 1.938, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.963, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.925, Test accuracy: 65.20 

Round  10, Train loss: 0.004, Test loss: 1.925, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.889, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.097, Test accuracy: 64.60 

Round  11, Train loss: 0.007, Test loss: 2.097, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.067, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 98.000, Test loss: 1.883, Test accuracy: 63.40 

Round  12, Train loss: 0.064, Test loss: 1.883, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 1.905, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 63.80 

Round  13, Train loss: 0.005, Test loss: 1.825, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.812, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.854, Test accuracy: 65.80 

Round  14, Train loss: 0.001, Test loss: 1.854, Test accuracy: 65.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.914, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.055, Test accuracy: 62.60 

Round  15, Train loss: 0.006, Test loss: 2.055, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.902, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.756, Test accuracy: 65.80 

Round  16, Train loss: 0.003, Test loss: 1.756, Test accuracy: 65.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.705, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.819, Test accuracy: 65.00 

Round  17, Train loss: 0.006, Test loss: 1.819, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.772, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.784, Test accuracy: 65.60 

Round  18, Train loss: 0.001, Test loss: 1.784, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.744, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.850, Test accuracy: 64.20 

Round  19, Train loss: 0.000, Test loss: 1.850, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.815, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.801, Test accuracy: 66.40 

Final Round, Train loss: 0.000, Test loss: 1.838, Test accuracy: 64.80 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 1.059, Train accuracy: 59.600, Test loss: 1.423, Test accuracy: 51.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.827, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.779, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.915, Train accuracy: 61.600, Test loss: 1.181, Test accuracy: 57.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.298, Train accuracy: 89.600, Test loss: 1.267, Test accuracy: 68.20 

Round   0, Train loss: 0.149, Test loss: 1.525, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.949, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.803, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.251, Train accuracy: 92.800, Test loss: 0.812, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.239, Train accuracy: 91.800, Test loss: 1.293, Test accuracy: 70.40 

Round   1, Train loss: 0.120, Test loss: 1.359, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.835, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.995, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.112, Train accuracy: 97.600, Test loss: 0.780, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.061, Train accuracy: 98.600, Test loss: 1.022, Test accuracy: 72.00 

Round   2, Train loss: 0.032, Test loss: 1.344, Test accuracy: 67.10 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.803, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.835, Test accuracy: 66.00 

        train local model (freeze embeding):client   1,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 0.915, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.151, Train accuracy: 93.800, Test loss: 1.424, Test accuracy: 69.40 

Round   3, Train loss: 0.076, Test loss: 1.465, Test accuracy: 68.10 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.862, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.803, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.045, Train accuracy: 98.400, Test loss: 0.988, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 1.130, Test accuracy: 73.00 

Round   4, Train loss: 0.022, Test loss: 1.352, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.683, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.787, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.003, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 1.071, Test accuracy: 74.80 

Round   5, Train loss: 0.018, Test loss: 1.345, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.636, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.991, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.223, Test accuracy: 75.80 

Round   6, Train loss: 0.014, Test loss: 1.396, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.690, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.910, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.359, Test accuracy: 71.80 

Round   7, Train loss: 0.009, Test loss: 1.471, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.751, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.878, Test accuracy: 66.00 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.219, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.359, Test accuracy: 73.80 

Round   8, Train loss: 0.009, Test loss: 1.464, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.730, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.793, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.032, Train accuracy: 98.600, Test loss: 1.507, Test accuracy: 73.80 

Round   9, Train loss: 0.016, Test loss: 1.419, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.710, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.745, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.200, Test loss: 1.756, Test accuracy: 68.40 

Round  10, Train loss: 0.022, Test loss: 1.469, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.757, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.940, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.174, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 78.00 

Round  11, Train loss: 0.001, Test loss: 1.517, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.792, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.029, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.206, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.167, Test accuracy: 75.60 

Round  12, Train loss: 0.007, Test loss: 1.474, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.758, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.807, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.161, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 78.00 

Round  13, Train loss: 0.000, Test loss: 1.412, Test accuracy: 72.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.667, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.791, Test accuracy: 64.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.389, Test accuracy: 74.00 

Round  14, Train loss: 0.002, Test loss: 1.512, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.654, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.783, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.153, Test accuracy: 77.00 

Round  15, Train loss: 0.002, Test loss: 1.455, Test accuracy: 70.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.712, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.806, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 75.40 

Round  16, Train loss: 0.001, Test loss: 1.461, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.681, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 74.80 

Round  17, Train loss: 0.001, Test loss: 1.503, Test accuracy: 70.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.767, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.965, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.233, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.145, Train accuracy: 93.800, Test loss: 1.834, Test accuracy: 66.80 

Round  18, Train loss: 0.075, Test loss: 1.661, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.803, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.849, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.172, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.162, Test accuracy: 77.80 

Round  19, Train loss: 0.002, Test loss: 1.454, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.677, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.652, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 75.80 

Final Round, Train loss: 0.001, Test loss: 1.425, Test accuracy: 73.10 

Average accuracy final 10 rounds: 135.13 

1257.151626586914
[19.293440580368042, 37.431962966918945, 56.68519186973572, 75.1359760761261, 93.7475197315216, 112.1048629283905, 130.7230212688446, 149.39653754234314, 168.27494263648987, 187.1339831352234, 205.7348198890686, 224.8397946357727, 243.44115042686462, 262.32027101516724, 280.9918923377991, 299.13415718078613, 317.9190812110901, 336.48481369018555, 355.0214478969574, 373.8877465724945, 384.60780453681946, 403.30729365348816, 422.5662422180176, 441.83655548095703, 460.3422746658325, 479.05854773521423, 498.05388736724854, 517.0525782108307, 536.2460837364197, 555.5108861923218, 574.2060449123383, 593.0924289226532, 612.067423582077, 630.814614534378, 649.3753488063812, 667.7563309669495, 686.5849313735962, 705.3465931415558, 724.1532068252563, 743.8787896633148, 762.7788112163544, 773.4776563644409]
[58.0, 64.6, 63.4, 65.4, 62.8, 63.8, 64.0, 63.2, 62.6, 65.6, 65.2, 64.6, 63.4, 63.8, 65.8, 62.6, 65.8, 65.0, 65.6, 64.2, 64.8, 64.2, 67.0, 67.1, 68.1, 69.8, 69.6, 69.8, 67.8, 69.0, 71.1, 69.6, 70.1, 69.4, 72.1, 69.6, 70.3, 71.1, 70.9, 69.8, 72.4, 73.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.670, Test loss: 0.700, Test accuracy: 74.50 

Round   0, Global train loss: 0.670, Global test loss: 0.777, Global test accuracy: 50.00 

Round   1, Train loss: 0.465, Test loss: 0.560, Test accuracy: 79.60 

Round   1, Global train loss: 0.465, Global test loss: 0.738, Global test accuracy: 50.00 

Round   2, Train loss: 0.411, Test loss: 0.574, Test accuracy: 80.00 

Round   2, Global train loss: 0.411, Global test loss: 0.743, Global test accuracy: 50.00 

Round   3, Train loss: 0.349, Test loss: 0.616, Test accuracy: 79.70 

Round   3, Global train loss: 0.349, Global test loss: 0.764, Global test accuracy: 50.00 

Round   4, Train loss: 0.285, Test loss: 1.017, Test accuracy: 76.70 

Round   4, Global train loss: 0.285, Global test loss: 0.767, Global test accuracy: 50.00 

Round   5, Train loss: 0.259, Test loss: 0.632, Test accuracy: 79.90 

Round   5, Global train loss: 0.259, Global test loss: 0.796, Global test accuracy: 50.00 

Round   6, Train loss: 0.209, Test loss: 0.586, Test accuracy: 81.70 

Round   6, Global train loss: 0.209, Global test loss: 0.773, Global test accuracy: 50.00 

Round   7, Train loss: 0.199, Test loss: 1.239, Test accuracy: 74.60 

Round   7, Global train loss: 0.199, Global test loss: 0.738, Global test accuracy: 50.00 

Round   8, Train loss: 0.187, Test loss: 0.673, Test accuracy: 80.70 

Round   8, Global train loss: 0.187, Global test loss: 0.748, Global test accuracy: 50.00 

Round   9, Train loss: 0.143, Test loss: 0.675, Test accuracy: 81.70 

Round   9, Global train loss: 0.143, Global test loss: 0.791, Global test accuracy: 50.00 

Round  10, Train loss: 0.147, Test loss: 0.762, Test accuracy: 80.00 

Round  10, Global train loss: 0.147, Global test loss: 0.738, Global test accuracy: 50.00 

Round  11, Train loss: 0.123, Test loss: 0.710, Test accuracy: 78.10 

Round  11, Global train loss: 0.123, Global test loss: 0.789, Global test accuracy: 50.00 

Round  12, Train loss: 0.101, Test loss: 0.517, Test accuracy: 83.00 

Round  12, Global train loss: 0.101, Global test loss: 0.781, Global test accuracy: 50.00 

Round  13, Train loss: 0.088, Test loss: 0.696, Test accuracy: 81.30 

Round  13, Global train loss: 0.088, Global test loss: 0.787, Global test accuracy: 50.00 

Round  14, Train loss: 0.077, Test loss: 0.705, Test accuracy: 80.70 

Round  14, Global train loss: 0.077, Global test loss: 0.789, Global test accuracy: 50.00 

Round  15, Train loss: 0.081, Test loss: 0.650, Test accuracy: 82.10 

Round  15, Global train loss: 0.081, Global test loss: 0.767, Global test accuracy: 50.00 

Round  16, Train loss: 0.056, Test loss: 0.783, Test accuracy: 80.70 

Round  16, Global train loss: 0.056, Global test loss: 0.795, Global test accuracy: 50.00 

Round  17, Train loss: 0.079, Test loss: 0.735, Test accuracy: 81.40 

Round  17, Global train loss: 0.079, Global test loss: 0.849, Global test accuracy: 50.00 

Round  18, Train loss: 0.043, Test loss: 0.751, Test accuracy: 81.60 

Round  18, Global train loss: 0.043, Global test loss: 0.813, Global test accuracy: 50.00 

Round  19, Train loss: 0.033, Test loss: 0.841, Test accuracy: 81.30 

Round  19, Global train loss: 0.033, Global test loss: 0.836, Global test accuracy: 50.00 

Round  20, Train loss: 0.048, Test loss: 0.740, Test accuracy: 81.10 

Round  20, Global train loss: 0.048, Global test loss: 0.842, Global test accuracy: 50.00 

Round  21, Train loss: 0.034, Test loss: 0.921, Test accuracy: 79.60 

Round  21, Global train loss: 0.034, Global test loss: 0.871, Global test accuracy: 50.00 

Round  22, Train loss: 0.045, Test loss: 0.775, Test accuracy: 82.40 

Round  22, Global train loss: 0.045, Global test loss: 0.875, Global test accuracy: 50.00 

Round  23, Train loss: 0.038, Test loss: 0.715, Test accuracy: 83.30 

Round  23, Global train loss: 0.038, Global test loss: 0.841, Global test accuracy: 50.00 

Round  24, Train loss: 0.026, Test loss: 0.699, Test accuracy: 81.50 

Round  24, Global train loss: 0.026, Global test loss: 0.931, Global test accuracy: 50.00 

Round  25, Train loss: 0.026, Test loss: 0.738, Test accuracy: 83.00 

Round  25, Global train loss: 0.026, Global test loss: 0.930, Global test accuracy: 50.00 

Round  26, Train loss: 0.040, Test loss: 1.152, Test accuracy: 81.20 

Round  26, Global train loss: 0.040, Global test loss: 0.907, Global test accuracy: 50.00 

Round  27, Train loss: 0.022, Test loss: 0.735, Test accuracy: 82.70 

Round  27, Global train loss: 0.022, Global test loss: 0.876, Global test accuracy: 50.00 

Round  28, Train loss: 0.025, Test loss: 0.809, Test accuracy: 82.20 

Round  28, Global train loss: 0.025, Global test loss: 0.853, Global test accuracy: 50.00 

Round  29, Train loss: 0.020, Test loss: 0.823, Test accuracy: 82.40 

Round  29, Global train loss: 0.020, Global test loss: 0.885, Global test accuracy: 50.00 

Round  30, Train loss: 0.014, Test loss: 0.823, Test accuracy: 82.30 

Round  30, Global train loss: 0.014, Global test loss: 0.880, Global test accuracy: 50.00 

Round  31, Train loss: 0.013, Test loss: 0.818, Test accuracy: 81.90 

Round  31, Global train loss: 0.013, Global test loss: 0.921, Global test accuracy: 50.00 

Round  32, Train loss: 0.009, Test loss: 0.805, Test accuracy: 83.30 

Round  32, Global train loss: 0.009, Global test loss: 0.914, Global test accuracy: 50.00 

Round  33, Train loss: 0.007, Test loss: 0.788, Test accuracy: 83.30 

Round  33, Global train loss: 0.007, Global test loss: 0.973, Global test accuracy: 50.00 

Round  34, Train loss: 0.018, Test loss: 0.789, Test accuracy: 82.60 

Round  34, Global train loss: 0.018, Global test loss: 0.905, Global test accuracy: 50.00 

Final Round, Train loss: 0.024, Test loss: 0.867, Test accuracy: 82.80 

Final Round, Global train loss: 0.024, Global test loss: 0.905, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 82.49000000000001 

Average global accuracy final 10 rounds: 50.0 

601.7827241420746
[8.872289180755615, 11.583770751953125, 14.589677333831787, 17.395031213760376, 20.272149801254272, 23.122244119644165, 25.949604034423828, 28.737552165985107, 31.540014028549194, 34.41367220878601, 37.32060790061951, 40.12140607833862, 42.89680790901184, 45.72208213806152, 48.57168436050415, 51.25895810127258, 54.07789874076843, 57.01637578010559, 59.9120352268219, 62.714518785476685, 65.58088541030884, 68.3598370552063, 71.22987341880798, 73.96349763870239, 76.78575825691223, 79.52931427955627, 82.37392234802246, 85.20919013023376, 87.97732138633728, 90.72344374656677, 93.54540276527405, 96.30990934371948, 99.05221462249756, 101.84465551376343, 104.64461398124695, 110.1592276096344]
[74.5, 79.6, 80.0, 79.7, 76.7, 79.9, 81.7, 74.6, 80.7, 81.7, 80.0, 78.1, 83.0, 81.3, 80.7, 82.1, 80.7, 81.4, 81.6, 81.3, 81.1, 79.6, 82.4, 83.3, 81.5, 83.0, 81.2, 82.7, 82.2, 82.4, 82.3, 81.9, 83.3, 83.3, 82.6, 82.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.640, Test loss: 0.780, Test accuracy: 70.20 

Round   0, Global train loss: 0.640, Global test loss: 0.818, Global test accuracy: 50.00 

Round   1, Train loss: 0.594, Test loss: 0.644, Test accuracy: 68.60 

Round   1, Global train loss: 0.594, Global test loss: 0.705, Global test accuracy: 51.30 

Round   2, Train loss: 0.561, Test loss: 0.797, Test accuracy: 71.00 

Round   2, Global train loss: 0.561, Global test loss: 0.736, Global test accuracy: 52.70 

Round   3, Train loss: 0.518, Test loss: 0.598, Test accuracy: 76.90 

Round   3, Global train loss: 0.518, Global test loss: 0.648, Global test accuracy: 62.70 

Round   4, Train loss: 0.477, Test loss: 0.539, Test accuracy: 80.30 

Round   4, Global train loss: 0.477, Global test loss: 0.712, Global test accuracy: 62.80 

Round   5, Train loss: 0.437, Test loss: 0.550, Test accuracy: 80.00 

Round   5, Global train loss: 0.437, Global test loss: 0.683, Global test accuracy: 65.70 

Round   6, Train loss: 0.398, Test loss: 0.605, Test accuracy: 79.20 

Round   6, Global train loss: 0.398, Global test loss: 0.638, Global test accuracy: 66.70 

Round   7, Train loss: 0.398, Test loss: 0.682, Test accuracy: 78.70 

Round   7, Global train loss: 0.398, Global test loss: 0.731, Global test accuracy: 65.30 

Round   8, Train loss: 0.384, Test loss: 0.515, Test accuracy: 80.70 

Round   8, Global train loss: 0.384, Global test loss: 0.716, Global test accuracy: 63.60 

Round   9, Train loss: 0.344, Test loss: 0.856, Test accuracy: 77.80 

Round   9, Global train loss: 0.344, Global test loss: 0.698, Global test accuracy: 65.90 

Round  10, Train loss: 0.299, Test loss: 1.072, Test accuracy: 76.30 

Round  10, Global train loss: 0.299, Global test loss: 0.783, Global test accuracy: 65.90 

Round  11, Train loss: 0.316, Test loss: 0.589, Test accuracy: 78.50 

Round  11, Global train loss: 0.316, Global test loss: 0.749, Global test accuracy: 66.00 

Round  12, Train loss: 0.265, Test loss: 0.717, Test accuracy: 79.40 

Round  12, Global train loss: 0.265, Global test loss: 0.706, Global test accuracy: 69.30 

Round  13, Train loss: 0.279, Test loss: 0.531, Test accuracy: 83.80 

Round  13, Global train loss: 0.279, Global test loss: 0.793, Global test accuracy: 69.40 

Round  14, Train loss: 0.248, Test loss: 0.763, Test accuracy: 78.40 

Round  14, Global train loss: 0.248, Global test loss: 0.873, Global test accuracy: 66.60 

Round  15, Train loss: 0.249, Test loss: 0.585, Test accuracy: 80.80 

Round  15, Global train loss: 0.249, Global test loss: 0.786, Global test accuracy: 67.50 

Round  16, Train loss: 0.219, Test loss: 0.918, Test accuracy: 76.50 

Round  16, Global train loss: 0.219, Global test loss: 0.841, Global test accuracy: 67.70 

Round  17, Train loss: 0.227, Test loss: 1.102, Test accuracy: 75.00 

Round  17, Global train loss: 0.227, Global test loss: 0.998, Global test accuracy: 65.30 

Round  18, Train loss: 0.189, Test loss: 0.612, Test accuracy: 81.90 

Round  18, Global train loss: 0.189, Global test loss: 0.881, Global test accuracy: 68.60 

Round  19, Train loss: 0.179, Test loss: 0.716, Test accuracy: 78.70 

Round  19, Global train loss: 0.179, Global test loss: 0.777, Global test accuracy: 71.60 

Round  20, Train loss: 0.163, Test loss: 0.628, Test accuracy: 83.10 

Round  20, Global train loss: 0.163, Global test loss: 0.784, Global test accuracy: 69.20 

Round  21, Train loss: 0.172, Test loss: 0.594, Test accuracy: 84.30 

Round  21, Global train loss: 0.172, Global test loss: 0.785, Global test accuracy: 68.50 

Round  22, Train loss: 0.158, Test loss: 0.678, Test accuracy: 82.20 

Round  22, Global train loss: 0.158, Global test loss: 0.726, Global test accuracy: 71.50 

Round  23, Train loss: 0.156, Test loss: 0.707, Test accuracy: 81.20 

Round  23, Global train loss: 0.156, Global test loss: 0.807, Global test accuracy: 68.00 

Round  24, Train loss: 0.151, Test loss: 0.716, Test accuracy: 83.30 

Round  24, Global train loss: 0.151, Global test loss: 0.796, Global test accuracy: 71.90 

Round  25, Train loss: 0.135, Test loss: 0.780, Test accuracy: 80.70 

Round  25, Global train loss: 0.135, Global test loss: 0.952, Global test accuracy: 69.50 

Round  26, Train loss: 0.134, Test loss: 0.773, Test accuracy: 81.40 

Round  26, Global train loss: 0.134, Global test loss: 1.088, Global test accuracy: 66.30 

Round  27, Train loss: 0.129, Test loss: 0.560, Test accuracy: 84.90 

Round  27, Global train loss: 0.129, Global test loss: 0.798, Global test accuracy: 70.30 

Round  28, Train loss: 0.104, Test loss: 0.695, Test accuracy: 82.30 

Round  28, Global train loss: 0.104, Global test loss: 0.897, Global test accuracy: 71.40 

Round  29, Train loss: 0.137, Test loss: 0.521, Test accuracy: 84.90 

Round  29, Global train loss: 0.137, Global test loss: 0.839, Global test accuracy: 71.90 

Round  30, Train loss: 0.113, Test loss: 0.639, Test accuracy: 84.00 

Round  30, Global train loss: 0.113, Global test loss: 0.815, Global test accuracy: 72.00 

Round  31, Train loss: 0.115, Test loss: 0.629, Test accuracy: 83.70 

Round  31, Global train loss: 0.115, Global test loss: 0.925, Global test accuracy: 70.20 

Round  32, Train loss: 0.103, Test loss: 0.540, Test accuracy: 86.40 

Round  32, Global train loss: 0.103, Global test loss: 0.904, Global test accuracy: 71.10 

Round  33, Train loss: 0.094, Test loss: 0.685, Test accuracy: 82.30 

Round  33, Global train loss: 0.094, Global test loss: 0.828, Global test accuracy: 71.80 

Round  34, Train loss: 0.095, Test loss: 0.659, Test accuracy: 83.20 

Round  34, Global train loss: 0.095, Global test loss: 0.888, Global test accuracy: 71.30 

Final Round, Train loss: 0.061, Test loss: 0.702, Test accuracy: 84.80 

Final Round, Global train loss: 0.061, Global test loss: 0.888, Global test accuracy: 71.30 

Average accuracy final 10 rounds: 83.38000000000002 

Average global accuracy final 10 rounds: 70.58 

600.914342880249
[8.398095846176147, 11.263863801956177, 13.97402548789978, 16.68600559234619, 19.389827013015747, 22.231483936309814, 24.971628665924072, 27.82394766807556, 30.683748483657837, 33.4173481464386, 36.271148443222046, 39.010762453079224, 41.77507519721985, 44.761797189712524, 47.615479707717896, 50.88640880584717, 53.60952401161194, 56.43825554847717, 59.21115469932556, 62.01436424255371, 64.78049373626709, 67.57283186912537, 70.36209011077881, 73.18004035949707, 76.10520124435425, 78.80697274208069, 81.53482174873352, 84.25673842430115, 87.08836936950684, 89.86616659164429, 92.70389676094055, 95.47428107261658, 98.3634340763092, 101.16927123069763, 103.95670008659363, 109.43683385848999]
[70.2, 68.6, 71.0, 76.9, 80.3, 80.0, 79.2, 78.7, 80.7, 77.8, 76.3, 78.5, 79.4, 83.8, 78.4, 80.8, 76.5, 75.0, 81.9, 78.7, 83.1, 84.3, 82.2, 81.2, 83.3, 80.7, 81.4, 84.9, 82.3, 84.9, 84.0, 83.7, 86.4, 82.3, 83.2, 84.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.713, Test loss: 0.886, Test accuracy: 53.30 

Round   1, Train loss: 0.645, Test loss: 0.948, Test accuracy: 56.50 

Round   2, Train loss: 0.631, Test loss: 1.002, Test accuracy: 53.50 

Round   3, Train loss: 0.586, Test loss: 0.531, Test accuracy: 70.10 

Round   4, Train loss: 0.521, Test loss: 0.758, Test accuracy: 67.90 

Round   5, Train loss: 0.513, Test loss: 0.693, Test accuracy: 67.00 

Round   6, Train loss: 0.501, Test loss: 0.853, Test accuracy: 61.40 

Round   7, Train loss: 0.454, Test loss: 0.628, Test accuracy: 72.70 

Round   8, Train loss: 0.433, Test loss: 0.507, Test accuracy: 75.50 

Round   9, Train loss: 0.418, Test loss: 0.816, Test accuracy: 70.30 

Round  10, Train loss: 0.376, Test loss: 0.497, Test accuracy: 78.50 

Round  11, Train loss: 0.367, Test loss: 0.556, Test accuracy: 75.80 

Round  12, Train loss: 0.348, Test loss: 0.499, Test accuracy: 78.80 

Round  13, Train loss: 0.331, Test loss: 0.607, Test accuracy: 76.10 

Round  14, Train loss: 0.320, Test loss: 0.570, Test accuracy: 78.10 

Round  15, Train loss: 0.280, Test loss: 0.440, Test accuracy: 81.40 

Round  16, Train loss: 0.274, Test loss: 0.445, Test accuracy: 81.70 

Round  17, Train loss: 0.270, Test loss: 0.554, Test accuracy: 78.60 

Round  18, Train loss: 0.253, Test loss: 0.406, Test accuracy: 84.10 

Round  19, Train loss: 0.253, Test loss: 0.452, Test accuracy: 81.80 

Round  20, Train loss: 0.243, Test loss: 0.439, Test accuracy: 82.10 

Round  21, Train loss: 0.217, Test loss: 0.470, Test accuracy: 82.80 

Round  22, Train loss: 0.203, Test loss: 0.437, Test accuracy: 83.60 

Round  23, Train loss: 0.197, Test loss: 0.437, Test accuracy: 83.30 

Round  24, Train loss: 0.203, Test loss: 0.448, Test accuracy: 81.50 

Round  25, Train loss: 0.180, Test loss: 0.452, Test accuracy: 83.60 

Round  26, Train loss: 0.164, Test loss: 0.468, Test accuracy: 83.40 

Round  27, Train loss: 0.166, Test loss: 0.402, Test accuracy: 84.20 

Round  28, Train loss: 0.156, Test loss: 0.444, Test accuracy: 83.70 

Round  29, Train loss: 0.143, Test loss: 0.499, Test accuracy: 82.00 

Round  30, Train loss: 0.130, Test loss: 0.412, Test accuracy: 84.50 

Round  31, Train loss: 0.125, Test loss: 0.468, Test accuracy: 82.70 

Round  32, Train loss: 0.122, Test loss: 0.479, Test accuracy: 83.60 

Round  33, Train loss: 0.119, Test loss: 0.411, Test accuracy: 85.40 

Round  34, Train loss: 0.104, Test loss: 0.464, Test accuracy: 84.10 

Round  35, Train loss: 0.112, Test loss: 0.599, Test accuracy: 82.00 

Round  36, Train loss: 0.105, Test loss: 0.545, Test accuracy: 81.30 

Round  37, Train loss: 0.087, Test loss: 0.538, Test accuracy: 82.90 

Round  38, Train loss: 0.094, Test loss: 0.480, Test accuracy: 83.90 

Round  39, Train loss: 0.089, Test loss: 0.475, Test accuracy: 83.80 

Round  40, Train loss: 0.083, Test loss: 0.464, Test accuracy: 83.50 

Round  41, Train loss: 0.079, Test loss: 0.441, Test accuracy: 84.80 

Round  42, Train loss: 0.056, Test loss: 0.423, Test accuracy: 86.50 

Round  43, Train loss: 0.068, Test loss: 0.486, Test accuracy: 83.70 

Round  44, Train loss: 0.054, Test loss: 0.519, Test accuracy: 83.80 

Round  45, Train loss: 0.060, Test loss: 0.589, Test accuracy: 82.70 

Round  46, Train loss: 0.046, Test loss: 0.505, Test accuracy: 84.20 

Round  47, Train loss: 0.044, Test loss: 0.534, Test accuracy: 83.50 

Round  48, Train loss: 0.047, Test loss: 0.523, Test accuracy: 84.10 

Round  49, Train loss: 0.053, Test loss: 0.471, Test accuracy: 84.60 

Final Round, Train loss: 0.036, Test loss: 0.513, Test accuracy: 84.10 

Average accuracy final 10 rounds: 84.13999999999997 

612.7889304161072
[8.166877508163452, 10.405773162841797, 12.65897011756897, 14.838585138320923, 17.00076723098755, 19.230260848999023, 21.37698245048523, 23.58986258506775, 25.92128849029541, 28.155107975006104, 30.45681381225586, 32.61956286430359, 34.775418758392334, 37.0451819896698, 39.30820608139038, 41.458303451538086, 43.55929613113403, 45.7842161655426, 47.89674377441406, 50.197927951812744, 52.37429237365723, 54.76464653015137, 57.01276707649231, 59.2412486076355, 61.441399574279785, 63.775001764297485, 66.22946834564209, 68.36416554450989, 70.5526294708252, 72.684499502182, 74.94153690338135, 77.19669127464294, 79.33494734764099, 81.6059422492981, 83.89786672592163, 86.15830731391907, 88.29726552963257, 90.43200874328613, 92.66899585723877, 94.79994320869446, 97.08484411239624, 99.34482669830322, 101.55889010429382, 103.87856578826904, 106.13669228553772, 108.47975945472717, 110.6045880317688, 112.74063873291016, 114.93022537231445, 117.05393743515015, 119.33010768890381]
[53.3, 56.5, 53.5, 70.1, 67.9, 67.0, 61.4, 72.7, 75.5, 70.3, 78.5, 75.8, 78.8, 76.1, 78.1, 81.4, 81.7, 78.6, 84.1, 81.8, 82.1, 82.8, 83.6, 83.3, 81.5, 83.6, 83.4, 84.2, 83.7, 82.0, 84.5, 82.7, 83.6, 85.4, 84.1, 82.0, 81.3, 82.9, 83.9, 83.8, 83.5, 84.8, 86.5, 83.7, 83.8, 82.7, 84.2, 83.5, 84.1, 84.6, 84.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.739, Test loss: 0.905, Test accuracy: 51.60
Round   1, Train loss: 0.641, Test loss: 0.687, Test accuracy: 58.70
Round   2, Train loss: 0.603, Test loss: 0.656, Test accuracy: 62.90
Round   3, Train loss: 0.559, Test loss: 0.938, Test accuracy: 58.20
Round   4, Train loss: 0.551, Test loss: 0.749, Test accuracy: 62.50
Round   5, Train loss: 0.510, Test loss: 0.602, Test accuracy: 72.10
Round   6, Train loss: 0.472, Test loss: 0.649, Test accuracy: 75.50
Round   7, Train loss: 0.446, Test loss: 0.573, Test accuracy: 75.70
Round   8, Train loss: 0.421, Test loss: 0.585, Test accuracy: 77.70
Round   9, Train loss: 0.434, Test loss: 0.785, Test accuracy: 71.30
Round  10, Train loss: 0.394, Test loss: 0.604, Test accuracy: 73.60
Round  11, Train loss: 0.358, Test loss: 0.483, Test accuracy: 77.80
Round  12, Train loss: 0.362, Test loss: 0.503, Test accuracy: 79.70
Round  13, Train loss: 0.351, Test loss: 0.622, Test accuracy: 74.90
Round  14, Train loss: 0.312, Test loss: 0.515, Test accuracy: 79.70
Round  15, Train loss: 0.303, Test loss: 0.467, Test accuracy: 81.60
Round  16, Train loss: 0.288, Test loss: 0.395, Test accuracy: 83.10
Round  17, Train loss: 0.271, Test loss: 0.420, Test accuracy: 83.50
Round  18, Train loss: 0.252, Test loss: 0.415, Test accuracy: 83.10
Round  19, Train loss: 0.243, Test loss: 0.514, Test accuracy: 81.20
Round  20, Train loss: 0.217, Test loss: 0.406, Test accuracy: 83.30
Round  21, Train loss: 0.192, Test loss: 0.420, Test accuracy: 83.70
Round  22, Train loss: 0.188, Test loss: 0.430, Test accuracy: 83.60
Round  23, Train loss: 0.212, Test loss: 0.467, Test accuracy: 82.50
Round  24, Train loss: 0.181, Test loss: 0.420, Test accuracy: 84.40
Round  25, Train loss: 0.174, Test loss: 0.506, Test accuracy: 81.00
Round  26, Train loss: 0.155, Test loss: 0.443, Test accuracy: 82.70
Round  27, Train loss: 0.152, Test loss: 0.426, Test accuracy: 84.70
Round  28, Train loss: 0.138, Test loss: 0.436, Test accuracy: 84.70
Round  29, Train loss: 0.125, Test loss: 0.410, Test accuracy: 85.10
Round  30, Train loss: 0.125, Test loss: 0.455, Test accuracy: 84.20
Round  31, Train loss: 0.122, Test loss: 0.419, Test accuracy: 84.70
Round  32, Train loss: 0.108, Test loss: 0.429, Test accuracy: 84.10
Round  33, Train loss: 0.113, Test loss: 0.460, Test accuracy: 85.10
Round  34, Train loss: 0.093, Test loss: 0.453, Test accuracy: 84.70
Round  35, Train loss: 0.109, Test loss: 0.413, Test accuracy: 85.70
Round  36, Train loss: 0.088, Test loss: 0.408, Test accuracy: 85.60
Round  37, Train loss: 0.078, Test loss: 0.415, Test accuracy: 85.80
Round  38, Train loss: 0.068, Test loss: 0.449, Test accuracy: 84.70
Round  39, Train loss: 0.072, Test loss: 0.441, Test accuracy: 84.70
Round  40, Train loss: 0.074, Test loss: 0.449, Test accuracy: 84.80
Round  41, Train loss: 0.070, Test loss: 0.461, Test accuracy: 84.70
Round  42, Train loss: 0.069, Test loss: 0.432, Test accuracy: 85.30
Round  43, Train loss: 0.055, Test loss: 0.454, Test accuracy: 86.10
Round  44, Train loss: 0.052, Test loss: 0.459, Test accuracy: 84.80
Round  45, Train loss: 0.045, Test loss: 0.475, Test accuracy: 84.50
Round  46, Train loss: 0.051, Test loss: 0.450, Test accuracy: 85.50
Round  47, Train loss: 0.047, Test loss: 0.447, Test accuracy: 85.70
Round  48, Train loss: 0.052, Test loss: 0.443, Test accuracy: 85.60
Round  49, Train loss: 0.045, Test loss: 0.492, Test accuracy: 84.50
Final Round, Train loss: 0.024, Test loss: 0.475, Test accuracy: 84.70
Average accuracy final 10 rounds: 85.15000000000002
719.7662374973297
[8.485619306564331, 11.267996788024902, 14.218722343444824, 16.83176565170288, 19.436739683151245, 22.12087321281433, 24.863897800445557, 27.450933933258057, 29.952270984649658, 32.60511898994446, 35.15002417564392, 37.714932441711426, 40.26968336105347, 42.79250383377075, 45.371445417404175, 48.031479835510254, 50.706932067871094, 53.433429479599, 56.035672426223755, 58.60799503326416, 61.183531761169434, 63.74261951446533, 66.320561170578, 68.99165439605713, 71.7115433216095, 74.31056642532349, 76.99162912368774, 79.63277506828308, 82.38250255584717, 85.28800320625305, 88.03383493423462, 90.7351803779602, 93.26942348480225, 95.92820715904236, 98.60339140892029, 101.30971765518188, 104.00361633300781, 106.58067178726196, 109.24328780174255, 111.8706545829773, 114.49158883094788, 117.05651903152466, 119.79890394210815, 122.30488848686218, 124.848135471344, 127.536550283432, 130.13351678848267, 132.68233823776245, 135.2461712360382, 137.76437854766846, 140.50357270240784]
[51.6, 58.7, 62.9, 58.2, 62.5, 72.1, 75.5, 75.7, 77.7, 71.3, 73.6, 77.8, 79.7, 74.9, 79.7, 81.6, 83.1, 83.5, 83.1, 81.2, 83.3, 83.7, 83.6, 82.5, 84.4, 81.0, 82.7, 84.7, 84.7, 85.1, 84.2, 84.7, 84.1, 85.1, 84.7, 85.7, 85.6, 85.8, 84.7, 84.7, 84.8, 84.7, 85.3, 86.1, 84.8, 84.5, 85.5, 85.7, 85.6, 84.5, 84.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 0.333, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.500, Test loss: 0.305, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.297, Test accuracy: 89.00 

Round   0, Train loss: 0.021, Test loss: 0.297, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 91.00 

Round   1, Train loss: 0.006, Test loss: 0.202, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.204, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 0.357, Test accuracy: 86.00 

Round   2, Train loss: 0.029, Test loss: 0.357, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.332, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 88.00 

Round   3, Train loss: 0.008, Test loss: 0.459, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 87.50 

Round   4, Train loss: 0.004, Test loss: 0.363, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 88.50 

Round   5, Train loss: 0.000, Test loss: 0.406, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 87.50 

Round   6, Train loss: 0.008, Test loss: 0.330, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.442, Test accuracy: 87.50 

Round   7, Train loss: 0.001, Test loss: 0.442, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 87.50 

Round   8, Train loss: 0.000, Test loss: 0.405, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 86.50 

Round   9, Train loss: 0.000, Test loss: 0.470, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 89.00 

Round  10, Train loss: 0.000, Test loss: 0.451, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.572, Test accuracy: 88.00 

Round  11, Train loss: 0.016, Test loss: 0.572, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 97.500, Test loss: 0.508, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.502, Test accuracy: 87.50 

Round  12, Train loss: 0.001, Test loss: 0.502, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.472, Test accuracy: 88.00 

Round  13, Train loss: 0.003, Test loss: 0.472, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.542, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 90.00 

Round  14, Train loss: 0.000, Test loss: 0.406, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.428, Test accuracy: 89.00 

Round  15, Train loss: 0.000, Test loss: 0.428, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 89.00 

Round  16, Train loss: 0.000, Test loss: 0.448, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 90.50 

Round  17, Train loss: 0.000, Test loss: 0.411, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.426, Test accuracy: 91.00 

Round  18, Train loss: 0.000, Test loss: 0.426, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 89.50 

Round  19, Train loss: 0.000, Test loss: 0.446, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 90.00 

Final Round, Train loss: 0.000, Test loss: 0.443, Test accuracy: 90.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.489, Train accuracy: 76.500, Test loss: 0.518, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.901, Train accuracy: 54.000, Test loss: 0.947, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.380, Train accuracy: 86.000, Test loss: 0.600, Test accuracy: 77.00 

Round   0, Train loss: 0.190, Test loss: 0.411, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 0.351, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.438, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.286, Train accuracy: 90.000, Test loss: 0.487, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.226, Train accuracy: 90.500, Test loss: 0.668, Test accuracy: 73.50 

Round   1, Train loss: 0.114, Test loss: 0.417, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.237, Train accuracy: 90.000, Test loss: 0.584, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.073, Train accuracy: 98.000, Test loss: 0.586, Test accuracy: 78.50 

Round   2, Train loss: 0.037, Test loss: 0.402, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.347, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.100, Train accuracy: 98.000, Test loss: 0.512, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.108, Train accuracy: 97.000, Test loss: 0.683, Test accuracy: 80.00 

Round   3, Train loss: 0.054, Test loss: 0.401, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 0.266, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.633, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.080, Train accuracy: 97.000, Test loss: 0.630, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.102, Train accuracy: 96.500, Test loss: 1.066, Test accuracy: 75.50 

Round   4, Train loss: 0.064, Test loss: 0.570, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.436, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 0.737, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 0.790, Test accuracy: 79.00 

Round   5, Train loss: 0.022, Test loss: 0.532, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 0.733, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 81.00 

Round   6, Train loss: 0.009, Test loss: 0.534, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.747, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.804, Test accuracy: 79.50 

Round   7, Train loss: 0.016, Test loss: 0.485, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.274, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.281, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.807, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.130, Train accuracy: 97.500, Test loss: 0.826, Test accuracy: 81.00 

Round   8, Train loss: 0.065, Test loss: 0.491, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.260, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.737, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 82.00 

Round   9, Train loss: 0.004, Test loss: 0.506, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.101, Train accuracy: 98.000, Test loss: 1.131, Test accuracy: 80.50 

Round  10, Train loss: 0.051, Test loss: 0.527, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.300, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.842, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 76.00 

Round  11, Train loss: 0.003, Test loss: 0.545, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.042, Test accuracy: 78.50 

Round  12, Train loss: 0.005, Test loss: 0.618, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.619, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 82.50 

Round  13, Train loss: 0.005, Test loss: 0.698, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 97.000, Test loss: 0.611, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.936, Test accuracy: 77.00 

Round  14, Train loss: 0.043, Test loss: 0.719, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 0.885, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 77.00 

Round  15, Train loss: 0.001, Test loss: 0.596, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 82.00 

Round  16, Train loss: 0.000, Test loss: 0.644, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.067, Train accuracy: 97.500, Test loss: 1.215, Test accuracy: 74.50 

Round  17, Train loss: 0.034, Test loss: 0.659, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.918, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.099, Train accuracy: 96.000, Test loss: 1.152, Test accuracy: 70.50 

Round  18, Train loss: 0.049, Test loss: 0.647, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.500, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 81.00 

Round  19, Train loss: 0.002, Test loss: 0.631, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 80.50 

Final Round, Train loss: 0.001, Test loss: 0.654, Test accuracy: 86.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.701, Train accuracy: 61.000, Test loss: 0.786, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.544, Train accuracy: 74.500, Test loss: 0.600, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.226, Train accuracy: 92.500, Test loss: 0.788, Test accuracy: 79.00 

Round   0, Train loss: 0.076, Test loss: 0.622, Test accuracy: 80.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.329, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.520, Train accuracy: 75.000, Test loss: 0.859, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 98.500, Test loss: 0.692, Test accuracy: 77.50 

Round   1, Train loss: 0.021, Test loss: 0.611, Test accuracy: 79.17 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.291, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.000, Test loss: 0.924, Test accuracy: 80.50 

        train local model (freeze embeding):client   2,  Train loss: 0.252, Train accuracy: 87.500, Test loss: 0.771, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.183, Train accuracy: 93.000, Test loss: 0.910, Test accuracy: 76.00 

Round   2, Train loss: 0.066, Test loss: 0.600, Test accuracy: 80.83 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 1.145, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.106, Train accuracy: 97.000, Test loss: 0.599, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.073, Train accuracy: 97.500, Test loss: 0.820, Test accuracy: 80.00 

Round   3, Train loss: 0.026, Test loss: 0.622, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.398, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.240, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.059, Train accuracy: 98.500, Test loss: 0.626, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.191, Train accuracy: 92.500, Test loss: 1.541, Test accuracy: 72.50 

Round   4, Train loss: 0.076, Test loss: 0.602, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.302, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.387, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.066, Train accuracy: 97.500, Test loss: 0.573, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 1.079, Test accuracy: 73.50 

Round   5, Train loss: 0.021, Test loss: 0.610, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.627, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.857, Test accuracy: 76.00 

Round   6, Train loss: 0.010, Test loss: 0.567, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.027, Train accuracy: 100.000, Test loss: 0.686, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.357, Train accuracy: 91.500, Test loss: 1.514, Test accuracy: 68.00 

Round   7, Train loss: 0.119, Test loss: 0.572, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.265, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 0.787, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.660, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.805, Test accuracy: 78.00 

Round   8, Train loss: 0.021, Test loss: 0.611, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.692, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.846, Test accuracy: 83.50 

        train local model (freeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.706, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 98.500, Test loss: 1.288, Test accuracy: 74.50 

Round   9, Train loss: 0.009, Test loss: 0.707, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.293, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.211, Test accuracy: 75.00 

Round  10, Train loss: 0.006, Test loss: 0.692, Test accuracy: 82.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.733, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 1.002, Test accuracy: 79.50 

Round  11, Train loss: 0.007, Test loss: 0.638, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.302, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.878, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.751, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.136, Train accuracy: 94.500, Test loss: 1.190, Test accuracy: 71.50 

Round  12, Train loss: 0.046, Test loss: 0.660, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.697, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.500, Test loss: 0.971, Test accuracy: 76.50 

Round  13, Train loss: 0.010, Test loss: 0.627, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.109, Train accuracy: 97.500, Test loss: 1.342, Test accuracy: 70.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 80.00 

Round  14, Train loss: 0.038, Test loss: 0.669, Test accuracy: 82.17 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.315, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.630, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 77.00 

Round  15, Train loss: 0.000, Test loss: 0.649, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.292, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.849, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.762, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 79.00 

Round  16, Train loss: 0.004, Test loss: 0.640, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.840, Test accuracy: 79.00 

Round  17, Train loss: 0.001, Test loss: 0.628, Test accuracy: 83.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.719, Test accuracy: 84.00 

Round  18, Train loss: 0.000, Test loss: 0.671, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.696, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 79.00 

Round  19, Train loss: 0.000, Test loss: 0.695, Test accuracy: 84.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.807, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 80.50 

Final Round, Train loss: 0.000, Test loss: 0.695, Test accuracy: 84.33 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.390, Train accuracy: 83.500, Test loss: 0.462, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.752, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.854, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.393, Train accuracy: 81.500, Test loss: 0.662, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.160, Train accuracy: 92.500, Test loss: 1.161, Test accuracy: 79.00 

Round   0, Train loss: 0.040, Test loss: 0.667, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 80.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.219, Train accuracy: 92.500, Test loss: 0.502, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.040, Train accuracy: 97.500, Test loss: 0.552, Test accuracy: 85.00 

Round   1, Train loss: 0.011, Test loss: 0.604, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.881, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.095, Train accuracy: 97.500, Test loss: 0.501, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.135, Train accuracy: 94.500, Test loss: 0.723, Test accuracy: 83.00 

Round   2, Train loss: 0.034, Test loss: 0.593, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.533, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.772, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 0.515, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.762, Test accuracy: 82.50 

Round   3, Train loss: 0.009, Test loss: 0.616, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 80.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 0.580, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.180, Train accuracy: 92.000, Test loss: 1.094, Test accuracy: 78.00 

Round   4, Train loss: 0.045, Test loss: 0.640, Test accuracy: 83.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.283, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 1.210, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.593, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 97.000, Test loss: 0.918, Test accuracy: 84.00 

Round   5, Train loss: 0.015, Test loss: 0.642, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.636, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.844, Test accuracy: 80.50 

Round   6, Train loss: 0.007, Test loss: 0.646, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.233, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 80.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.717, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 82.50 

Round   7, Train loss: 0.001, Test loss: 0.666, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.726, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.760, Test accuracy: 81.00 

Round   8, Train loss: 0.003, Test loss: 0.694, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.223, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.916, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.693, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.025, Train accuracy: 98.500, Test loss: 1.148, Test accuracy: 80.00 

Round   9, Train loss: 0.007, Test loss: 0.668, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.710, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.161, Train accuracy: 95.000, Test loss: 1.050, Test accuracy: 77.50 

Round  10, Train loss: 0.040, Test loss: 0.688, Test accuracy: 83.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.918, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 79.50 

Round  11, Train loss: 0.000, Test loss: 0.706, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 80.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.697, Test accuracy: 84.50 

Round  12, Train loss: 0.000, Test loss: 0.648, Test accuracy: 84.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 84.00 

Round  13, Train loss: 0.000, Test loss: 0.689, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.723, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.770, Test accuracy: 85.00 

Round  14, Train loss: 0.000, Test loss: 0.679, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.471, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.717, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 84.00 

Round  15, Train loss: 0.000, Test loss: 0.667, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 83.50 

Round  16, Train loss: 0.001, Test loss: 0.708, Test accuracy: 83.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 83.00 

Round  17, Train loss: 0.001, Test loss: 0.717, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.298, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 83.50 

Round  18, Train loss: 0.000, Test loss: 0.712, Test accuracy: 83.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.866, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 0.805, Test accuracy: 82.00 

Round  19, Train loss: 0.019, Test loss: 0.648, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 80.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.849, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 84.50 

Final Round, Train loss: 0.001, Test loss: 0.669, Test accuracy: 84.75 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.237, Train accuracy: 89.000, Test loss: 0.449, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.226, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.850, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.066, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.729, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 83.00 

        train local model (freeze embeding):client   4,  Train loss: 0.269, Train accuracy: 88.500, Test loss: 0.528, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.458, Test accuracy: 85.50 

Round   0, Train loss: 0.012, Test loss: 0.610, Test accuracy: 84.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.129, Test accuracy: 75.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 82.50 

        train local model (freeze embeding):client   4,  Train loss: 0.142, Train accuracy: 95.500, Test loss: 0.392, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.109, Train accuracy: 96.500, Test loss: 0.435, Test accuracy: 86.00 

Round   1, Train loss: 0.024, Test loss: 0.633, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.274, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 81.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.794, Test accuracy: 83.00 

        train local model (freeze embeding):client   4,  Train loss: 0.075, Train accuracy: 98.500, Test loss: 0.458, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.078, Train accuracy: 97.000, Test loss: 0.570, Test accuracy: 89.50 

Round   2, Train loss: 0.019, Test loss: 0.631, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.033, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 85.50 

        train local model (freeze embeding):client   4,  Train loss: 0.067, Train accuracy: 98.000, Test loss: 0.330, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.692, Test accuracy: 81.50 

Round   3, Train loss: 0.009, Test loss: 0.607, Test accuracy: 85.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.059, Train accuracy: 98.000, Test loss: 1.169, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.734, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 82.50 

        train local model (freeze embeding):client   4,  Train loss: 0.049, Train accuracy: 99.000, Test loss: 0.605, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 84.00 

Round   4, Train loss: 0.017, Test loss: 0.610, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.770, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.566, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 0.362, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.502, Test accuracy: 81.50 

Round   5, Train loss: 0.005, Test loss: 0.624, Test accuracy: 84.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.194, Train accuracy: 93.500, Test loss: 2.256, Test accuracy: 68.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.626, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 84.50 

        train local model (freeze embeding):client   4,  Train loss: 0.030, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 87.00 

Round   6, Train loss: 0.040, Test loss: 0.654, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.298, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.967, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 85.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.650, Test accuracy: 86.00 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.463, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.839, Test accuracy: 82.50 

Round   7, Train loss: 0.004, Test loss: 0.693, Test accuracy: 85.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.035, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.755, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.676, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.722, Test accuracy: 84.50 

        train local model (freeze embeding):client   4,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.448, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.749, Test accuracy: 87.00 

Round   8, Train loss: 0.003, Test loss: 0.651, Test accuracy: 84.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.290, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.674, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 84.00 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 85.00 

Round   9, Train loss: 0.002, Test loss: 0.692, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.293, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 83.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 1.054, Test accuracy: 85.00 

Round  10, Train loss: 0.004, Test loss: 0.762, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.281, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.719, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 82.50 

Round  11, Train loss: 0.001, Test loss: 0.690, Test accuracy: 84.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.293, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.915, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.878, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.639, Test accuracy: 86.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.553, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 85.00 

Round  12, Train loss: 0.003, Test loss: 0.698, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 84.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.572, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 83.50 

Round  13, Train loss: 0.002, Test loss: 0.707, Test accuracy: 85.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.298, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.706, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.653, Test accuracy: 86.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.589, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.598, Test accuracy: 85.00 

Round  14, Train loss: 0.005, Test loss: 0.740, Test accuracy: 84.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.652, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 87.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.512, Test accuracy: 86.50 

Round  15, Train loss: 0.004, Test loss: 0.719, Test accuracy: 85.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.701, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 81.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.702, Test accuracy: 85.00 

Round  16, Train loss: 0.001, Test loss: 0.708, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 83.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.730, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.537, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.641, Test accuracy: 84.00 

Round  17, Train loss: 0.001, Test loss: 0.676, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.672, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.550, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 81.50 

Round  18, Train loss: 0.001, Test loss: 0.694, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.292, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 83.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.643, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.683, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 86.00 

Round  19, Train loss: 0.000, Test loss: 0.710, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 86.50 

        train local model (freeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.550, Test accuracy: 86.00 

Final Round, Train loss: 0.000, Test loss: 0.730, Test accuracy: 84.70 

Average accuracy final 10 rounds: 425.8 

2463.5298941135406
[7.481197834014893, 15.295459985733032, 22.72309136390686, 30.836345911026, 38.4341242313385, 46.27299499511719, 54.054259300231934, 61.495853662490845, 68.86765146255493, 76.42910623550415, 83.62732410430908, 91.11863255500793, 98.78822302818298, 106.00942206382751, 113.14958214759827, 120.60931277275085, 128.06923866271973, 135.8439724445343, 143.39952850341797, 151.03506898880005, 155.38650488853455, 163.24808597564697, 170.52240681648254, 178.068683385849, 185.54821491241455, 193.21657943725586, 200.8102729320526, 208.34116911888123, 216.0739254951477, 223.77359747886658, 231.52767848968506, 238.8500578403473, 246.3182942867279, 254.00993180274963, 262.2956693172455, 270.00526666641235, 277.4755153656006, 285.2788586616516, 292.9376051425934, 300.6225371360779, 308.06562328338623, 312.4259555339813, 320.3227746486664, 328.0146577358246, 335.807137966156, 343.7643258571625, 351.63512206077576, 359.60031604766846, 367.23251008987427, 375.3125104904175, 382.952020406723, 390.60010504722595, 398.2645335197449, 406.0494797229767, 413.5890247821808, 421.1932067871094, 428.73217844963074, 436.4111759662628, 443.9277992248535, 451.5643653869629, 459.18133330345154, 466.88998317718506, 471.3518862724304, 479.20777654647827, 486.82715678215027, 494.4196150302887, 502.00538659095764, 509.6389400959015, 517.3479986190796, 525.4258542060852, 533.3203847408295, 541.0746293067932, 548.8033661842346, 556.5371196269989, 564.221132516861, 572.0954716205597, 579.6996834278107, 587.5150337219238, 595.2045221328735, 603.1486351490021, 611.1561529636383, 618.826699256897, 626.3072590827942, 630.7275204658508, 638.8236730098724, 646.3456540107727, 654.2430558204651, 662.0780267715454, 669.6130714416504, 677.3593182563782, 685.2075221538544, 693.1366584300995, 700.6783514022827, 708.2636969089508, 716.0742475986481, 723.942446231842, 731.5949926376343, 739.2688817977905, 746.9435610771179, 754.7742319107056, 762.4057803153992, 770.5249464511871, 778.0654306411743, 785.8535487651825, 790.2835938930511]
[89.0, 91.0, 86.0, 88.0, 87.5, 88.5, 87.5, 87.5, 87.5, 86.5, 89.0, 88.0, 87.5, 88.0, 90.0, 89.0, 89.0, 90.5, 91.0, 89.5, 90.0, 85.25, 82.25, 85.25, 85.0, 82.5, 83.75, 84.75, 86.0, 85.5, 84.75, 87.0, 86.0, 84.5, 83.75, 80.75, 85.5, 86.25, 83.25, 83.75, 86.25, 86.0, 80.16666666666667, 79.16666666666667, 80.83333333333333, 82.5, 81.5, 81.5, 83.16666666666667, 82.16666666666667, 82.66666666666667, 82.16666666666667, 82.33333333333333, 83.0, 82.16666666666667, 83.33333333333333, 82.16666666666667, 83.16666666666667, 83.5, 83.66666666666667, 83.33333333333333, 84.33333333333333, 84.33333333333333, 81.5, 83.0, 83.0, 83.25, 83.875, 84.25, 83.625, 83.5, 83.25, 83.25, 83.125, 83.0, 84.125, 83.75, 84.25, 84.5, 83.375, 84.25, 83.875, 84.75, 84.75, 84.4, 84.7, 84.0, 85.4, 84.7, 84.6, 84.7, 85.1, 84.9, 85.3, 84.5, 84.6, 85.3, 85.4, 84.4, 85.1, 85.3, 85.5, 84.7, 84.7, 84.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.643, Test loss: 0.653, Test accuracy: 73.70 

Round   0, Global train loss: 0.643, Global test loss: 0.694, Global test accuracy: 51.50 

Round   1, Train loss: 0.470, Test loss: 0.733, Test accuracy: 72.10 

Round   1, Global train loss: 0.470, Global test loss: 0.725, Global test accuracy: 50.00 

Round   2, Train loss: 0.387, Test loss: 0.738, Test accuracy: 76.30 

Round   2, Global train loss: 0.387, Global test loss: 0.700, Global test accuracy: 49.90 

Round   3, Train loss: 0.310, Test loss: 0.524, Test accuracy: 81.50 

Round   3, Global train loss: 0.310, Global test loss: 0.747, Global test accuracy: 50.00 

Round   4, Train loss: 0.258, Test loss: 0.658, Test accuracy: 78.70 

Round   4, Global train loss: 0.258, Global test loss: 0.723, Global test accuracy: 50.00 

Round   5, Train loss: 0.249, Test loss: 0.619, Test accuracy: 81.80 

Round   5, Global train loss: 0.249, Global test loss: 0.731, Global test accuracy: 50.00 

Round   6, Train loss: 0.199, Test loss: 0.736, Test accuracy: 79.20 

Round   6, Global train loss: 0.199, Global test loss: 0.753, Global test accuracy: 50.00 

Round   7, Train loss: 0.193, Test loss: 1.147, Test accuracy: 79.20 

Round   7, Global train loss: 0.193, Global test loss: 0.745, Global test accuracy: 50.00 

Round   8, Train loss: 0.153, Test loss: 0.868, Test accuracy: 81.60 

Round   8, Global train loss: 0.153, Global test loss: 0.731, Global test accuracy: 50.00 

Round   9, Train loss: 0.144, Test loss: 0.564, Test accuracy: 83.60 

Round   9, Global train loss: 0.144, Global test loss: 0.733, Global test accuracy: 50.00 

Round  10, Train loss: 0.112, Test loss: 0.860, Test accuracy: 79.80 

Round  10, Global train loss: 0.112, Global test loss: 0.701, Global test accuracy: 50.00 

Round  11, Train loss: 0.096, Test loss: 0.653, Test accuracy: 83.80 

Round  11, Global train loss: 0.096, Global test loss: 0.691, Global test accuracy: 50.30 

Round  12, Train loss: 0.086, Test loss: 0.693, Test accuracy: 83.30 

Round  12, Global train loss: 0.086, Global test loss: 0.715, Global test accuracy: 50.00 

Round  13, Train loss: 0.083, Test loss: 0.692, Test accuracy: 83.90 

Round  13, Global train loss: 0.083, Global test loss: 0.697, Global test accuracy: 49.80 

Round  14, Train loss: 0.061, Test loss: 0.706, Test accuracy: 82.10 

Round  14, Global train loss: 0.061, Global test loss: 0.694, Global test accuracy: 50.00 

Round  15, Train loss: 0.070, Test loss: 0.682, Test accuracy: 83.30 

Round  15, Global train loss: 0.070, Global test loss: 0.719, Global test accuracy: 50.00 

Round  16, Train loss: 0.044, Test loss: 0.659, Test accuracy: 84.30 

Round  16, Global train loss: 0.044, Global test loss: 0.760, Global test accuracy: 50.00 

Round  17, Train loss: 0.060, Test loss: 0.625, Test accuracy: 83.80 

Round  17, Global train loss: 0.060, Global test loss: 0.717, Global test accuracy: 50.00 

Round  18, Train loss: 0.043, Test loss: 0.602, Test accuracy: 84.30 

Round  18, Global train loss: 0.043, Global test loss: 0.708, Global test accuracy: 50.00 

Round  19, Train loss: 0.032, Test loss: 0.700, Test accuracy: 82.60 

Round  19, Global train loss: 0.032, Global test loss: 0.707, Global test accuracy: 50.00 

Round  20, Train loss: 0.026, Test loss: 0.690, Test accuracy: 84.50 

Round  20, Global train loss: 0.026, Global test loss: 0.721, Global test accuracy: 50.00 

Round  21, Train loss: 0.018, Test loss: 0.692, Test accuracy: 84.40 

Round  21, Global train loss: 0.018, Global test loss: 0.713, Global test accuracy: 50.00 

Round  22, Train loss: 0.056, Test loss: 0.691, Test accuracy: 84.40 

Round  22, Global train loss: 0.056, Global test loss: 0.714, Global test accuracy: 50.00 

Round  23, Train loss: 0.023, Test loss: 0.682, Test accuracy: 86.20 

Round  23, Global train loss: 0.023, Global test loss: 0.703, Global test accuracy: 50.00 

Round  24, Train loss: 0.025, Test loss: 0.737, Test accuracy: 84.90 

Round  24, Global train loss: 0.025, Global test loss: 0.720, Global test accuracy: 50.00 

Round  25, Train loss: 0.032, Test loss: 0.791, Test accuracy: 82.50 

Round  25, Global train loss: 0.032, Global test loss: 0.714, Global test accuracy: 50.00 

Round  26, Train loss: 0.011, Test loss: 0.801, Test accuracy: 85.00 

Round  26, Global train loss: 0.011, Global test loss: 0.713, Global test accuracy: 50.00 

Round  27, Train loss: 0.024, Test loss: 0.718, Test accuracy: 84.80 

Round  27, Global train loss: 0.024, Global test loss: 0.726, Global test accuracy: 50.00 

Round  28, Train loss: 0.021, Test loss: 0.728, Test accuracy: 85.30 

Round  28, Global train loss: 0.021, Global test loss: 0.740, Global test accuracy: 50.00 

Round  29, Train loss: 0.026, Test loss: 0.701, Test accuracy: 85.00 

Round  29, Global train loss: 0.026, Global test loss: 0.742, Global test accuracy: 50.00 

Round  30, Train loss: 0.025, Test loss: 0.667, Test accuracy: 84.80 

Round  30, Global train loss: 0.025, Global test loss: 0.733, Global test accuracy: 50.00 

Round  31, Train loss: 0.014, Test loss: 0.705, Test accuracy: 84.90 

Round  31, Global train loss: 0.014, Global test loss: 0.715, Global test accuracy: 50.00 

Round  32, Train loss: 0.012, Test loss: 0.677, Test accuracy: 85.00 

Round  32, Global train loss: 0.012, Global test loss: 0.718, Global test accuracy: 50.00 

Round  33, Train loss: 0.013, Test loss: 0.708, Test accuracy: 83.60 

Round  33, Global train loss: 0.013, Global test loss: 0.727, Global test accuracy: 50.00 

Round  34, Train loss: 0.020, Test loss: 0.689, Test accuracy: 85.00 

Round  34, Global train loss: 0.020, Global test loss: 0.716, Global test accuracy: 50.00 

Final Round, Train loss: 0.010, Test loss: 0.755, Test accuracy: 84.70 

Final Round, Global train loss: 0.010, Global test loss: 0.716, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 84.58999999999999 

Average global accuracy final 10 rounds: 50.0 

592.8753855228424
[8.542013168334961, 11.342554092407227, 14.02508282661438, 16.86438751220703, 19.6067316532135, 22.25244140625, 24.92479109764099, 27.562267065048218, 30.20340919494629, 32.909995555877686, 35.61480903625488, 38.33563590049744, 41.08838248252869, 43.80788612365723, 46.51786994934082, 49.254353046417236, 51.97110319137573, 54.72205090522766, 57.43613934516907, 60.20271682739258, 62.94430232048035, 65.67624831199646, 68.39098715782166, 71.1293318271637, 73.85037875175476, 76.59356141090393, 79.34567141532898, 82.08408761024475, 85.01797366142273, 87.89036440849304, 90.75900864601135, 93.59546256065369, 96.30316948890686, 98.96972513198853, 101.73518633842468, 107.35763883590698]
[73.7, 72.1, 76.3, 81.5, 78.7, 81.8, 79.2, 79.2, 81.6, 83.6, 79.8, 83.8, 83.3, 83.9, 82.1, 83.3, 84.3, 83.8, 84.3, 82.6, 84.5, 84.4, 84.4, 86.2, 84.9, 82.5, 85.0, 84.8, 85.3, 85.0, 84.8, 84.9, 85.0, 83.6, 85.0, 84.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.677, Test loss: 0.696, Test accuracy: 74.50 

Round   0, Global train loss: 0.677, Global test loss: 0.697, Global test accuracy: 50.30 

Round   1, Train loss: 0.595, Test loss: 0.686, Test accuracy: 72.80 

Round   1, Global train loss: 0.595, Global test loss: 0.700, Global test accuracy: 56.20 

Round   2, Train loss: 0.537, Test loss: 0.797, Test accuracy: 66.60 

Round   2, Global train loss: 0.537, Global test loss: 0.685, Global test accuracy: 62.90 

Round   3, Train loss: 0.491, Test loss: 1.003, Test accuracy: 70.90 

Round   3, Global train loss: 0.491, Global test loss: 0.689, Global test accuracy: 61.70 

Round   4, Train loss: 0.465, Test loss: 0.714, Test accuracy: 73.70 

Round   4, Global train loss: 0.465, Global test loss: 0.742, Global test accuracy: 62.90 

Round   5, Train loss: 0.439, Test loss: 0.467, Test accuracy: 80.20 

Round   5, Global train loss: 0.439, Global test loss: 0.688, Global test accuracy: 64.60 

Round   6, Train loss: 0.400, Test loss: 0.691, Test accuracy: 78.90 

Round   6, Global train loss: 0.400, Global test loss: 0.721, Global test accuracy: 65.10 

Round   7, Train loss: 0.392, Test loss: 0.596, Test accuracy: 79.20 

Round   7, Global train loss: 0.392, Global test loss: 0.734, Global test accuracy: 65.10 

Round   8, Train loss: 0.350, Test loss: 0.587, Test accuracy: 79.70 

Round   8, Global train loss: 0.350, Global test loss: 0.690, Global test accuracy: 65.40 

Round   9, Train loss: 0.335, Test loss: 0.707, Test accuracy: 79.40 

Round   9, Global train loss: 0.335, Global test loss: 0.809, Global test accuracy: 66.10 

Round  10, Train loss: 0.316, Test loss: 0.534, Test accuracy: 82.50 

Round  10, Global train loss: 0.316, Global test loss: 0.759, Global test accuracy: 65.60 

Round  11, Train loss: 0.303, Test loss: 0.710, Test accuracy: 76.10 

Round  11, Global train loss: 0.303, Global test loss: 0.729, Global test accuracy: 65.20 

Round  12, Train loss: 0.290, Test loss: 0.546, Test accuracy: 83.20 

Round  12, Global train loss: 0.290, Global test loss: 0.723, Global test accuracy: 67.00 

Round  13, Train loss: 0.266, Test loss: 0.575, Test accuracy: 82.60 

Round  13, Global train loss: 0.266, Global test loss: 0.911, Global test accuracy: 65.30 

Round  14, Train loss: 0.248, Test loss: 0.726, Test accuracy: 78.70 

Round  14, Global train loss: 0.248, Global test loss: 0.824, Global test accuracy: 67.50 

Round  15, Train loss: 0.266, Test loss: 0.675, Test accuracy: 78.50 

Round  15, Global train loss: 0.266, Global test loss: 0.739, Global test accuracy: 67.10 

Round  16, Train loss: 0.238, Test loss: 0.645, Test accuracy: 80.90 

Round  16, Global train loss: 0.238, Global test loss: 0.796, Global test accuracy: 66.30 

Round  17, Train loss: 0.212, Test loss: 0.617, Test accuracy: 82.20 

Round  17, Global train loss: 0.212, Global test loss: 0.754, Global test accuracy: 67.50 

Round  18, Train loss: 0.221, Test loss: 0.535, Test accuracy: 82.10 

Round  18, Global train loss: 0.221, Global test loss: 0.775, Global test accuracy: 67.20 

Round  19, Train loss: 0.196, Test loss: 0.524, Test accuracy: 84.30 

Round  19, Global train loss: 0.196, Global test loss: 0.922, Global test accuracy: 67.10 

Round  20, Train loss: 0.179, Test loss: 0.539, Test accuracy: 81.90 

Round  20, Global train loss: 0.179, Global test loss: 0.834, Global test accuracy: 66.00 

Round  21, Train loss: 0.185, Test loss: 0.496, Test accuracy: 85.00 

Round  21, Global train loss: 0.185, Global test loss: 0.830, Global test accuracy: 68.10 

Round  22, Train loss: 0.171, Test loss: 0.693, Test accuracy: 83.40 

Round  22, Global train loss: 0.171, Global test loss: 0.914, Global test accuracy: 67.40 

Round  23, Train loss: 0.158, Test loss: 0.711, Test accuracy: 79.80 

Round  23, Global train loss: 0.158, Global test loss: 0.861, Global test accuracy: 68.50 

Round  24, Train loss: 0.154, Test loss: 0.609, Test accuracy: 83.40 

Round  24, Global train loss: 0.154, Global test loss: 0.808, Global test accuracy: 69.40 

Round  25, Train loss: 0.147, Test loss: 0.702, Test accuracy: 81.80 

Round  25, Global train loss: 0.147, Global test loss: 0.809, Global test accuracy: 68.90 

Round  26, Train loss: 0.152, Test loss: 0.606, Test accuracy: 82.30 

Round  26, Global train loss: 0.152, Global test loss: 0.820, Global test accuracy: 69.60 

Round  27, Train loss: 0.124, Test loss: 0.560, Test accuracy: 83.30 

Round  27, Global train loss: 0.124, Global test loss: 0.906, Global test accuracy: 69.00 

Round  28, Train loss: 0.142, Test loss: 0.672, Test accuracy: 83.20 

Round  28, Global train loss: 0.142, Global test loss: 0.826, Global test accuracy: 68.60 

Round  29, Train loss: 0.126, Test loss: 0.548, Test accuracy: 83.30 

Round  29, Global train loss: 0.126, Global test loss: 0.814, Global test accuracy: 70.10 

Round  30, Train loss: 0.080, Test loss: 0.696, Test accuracy: 83.60 

Round  30, Global train loss: 0.080, Global test loss: 0.993, Global test accuracy: 69.40 

Round  31, Train loss: 0.121, Test loss: 0.556, Test accuracy: 83.60 

Round  31, Global train loss: 0.121, Global test loss: 0.912, Global test accuracy: 68.20 

Round  32, Train loss: 0.110, Test loss: 0.648, Test accuracy: 83.30 

Round  32, Global train loss: 0.110, Global test loss: 0.796, Global test accuracy: 71.70 

Round  33, Train loss: 0.096, Test loss: 0.584, Test accuracy: 83.50 

Round  33, Global train loss: 0.096, Global test loss: 0.898, Global test accuracy: 70.30 

Round  34, Train loss: 0.082, Test loss: 0.713, Test accuracy: 82.60 

Round  34, Global train loss: 0.082, Global test loss: 0.956, Global test accuracy: 69.80 

Final Round, Train loss: 0.064, Test loss: 0.662, Test accuracy: 84.60 

Final Round, Global train loss: 0.064, Global test loss: 0.956, Global test accuracy: 69.80 

Average accuracy final 10 rounds: 83.05 

Average global accuracy final 10 rounds: 69.56 

604.791761636734
[8.742952585220337, 11.516886711120605, 14.233834743499756, 17.107444286346436, 19.93405818939209, 22.678932666778564, 25.56923508644104, 28.375158548355103, 31.30414652824402, 34.07002234458923, 36.85770559310913, 39.69324994087219, 42.485520362854004, 45.20948100090027, 48.03653860092163, 50.80611491203308, 53.863325119018555, 56.82690906524658, 59.794777393341064, 62.56906843185425, 65.59157752990723, 68.35090136528015, 71.16479110717773, 74.0632221698761, 76.77542018890381, 79.57303309440613, 82.32454419136047, 85.0635073184967, 87.8932523727417, 90.78641819953918, 93.62333178520203, 96.47924423217773, 99.35506892204285, 102.09641623497009, 104.88524317741394, 110.65419459342957]
[74.5, 72.8, 66.6, 70.9, 73.7, 80.2, 78.9, 79.2, 79.7, 79.4, 82.5, 76.1, 83.2, 82.6, 78.7, 78.5, 80.9, 82.2, 82.1, 84.3, 81.9, 85.0, 83.4, 79.8, 83.4, 81.8, 82.3, 83.3, 83.2, 83.3, 83.6, 83.6, 83.3, 83.5, 82.6, 84.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.696, Test loss: 0.987, Test accuracy: 55.20 

Round   1, Train loss: 0.618, Test loss: 0.632, Test accuracy: 66.60 

Round   2, Train loss: 0.584, Test loss: 0.599, Test accuracy: 68.40 

Round   3, Train loss: 0.559, Test loss: 0.925, Test accuracy: 60.80 

Round   4, Train loss: 0.512, Test loss: 0.801, Test accuracy: 61.00 

Round   5, Train loss: 0.497, Test loss: 0.572, Test accuracy: 74.30 

Round   6, Train loss: 0.485, Test loss: 0.531, Test accuracy: 74.50 

Round   7, Train loss: 0.439, Test loss: 0.573, Test accuracy: 72.70 

Round   8, Train loss: 0.409, Test loss: 0.481, Test accuracy: 78.30 

Round   9, Train loss: 0.393, Test loss: 0.537, Test accuracy: 76.00 

Round  10, Train loss: 0.365, Test loss: 0.630, Test accuracy: 74.60 

Round  11, Train loss: 0.347, Test loss: 0.635, Test accuracy: 76.40 

Round  12, Train loss: 0.346, Test loss: 0.532, Test accuracy: 76.80 

Round  13, Train loss: 0.316, Test loss: 0.421, Test accuracy: 83.10 

Round  14, Train loss: 0.299, Test loss: 0.427, Test accuracy: 80.90 

Round  15, Train loss: 0.279, Test loss: 0.458, Test accuracy: 81.70 

Round  16, Train loss: 0.257, Test loss: 0.534, Test accuracy: 79.80 

Round  17, Train loss: 0.256, Test loss: 0.509, Test accuracy: 80.80 

Round  18, Train loss: 0.245, Test loss: 0.461, Test accuracy: 81.40 

Round  19, Train loss: 0.227, Test loss: 0.396, Test accuracy: 84.10 

Round  20, Train loss: 0.214, Test loss: 0.472, Test accuracy: 82.60 

Round  21, Train loss: 0.226, Test loss: 0.530, Test accuracy: 79.60 

Round  22, Train loss: 0.194, Test loss: 0.452, Test accuracy: 82.80 

Round  23, Train loss: 0.185, Test loss: 0.505, Test accuracy: 81.40 

Round  24, Train loss: 0.171, Test loss: 0.525, Test accuracy: 81.30 

Round  25, Train loss: 0.160, Test loss: 0.438, Test accuracy: 83.20 

Round  26, Train loss: 0.177, Test loss: 0.456, Test accuracy: 82.70 

Round  27, Train loss: 0.137, Test loss: 0.435, Test accuracy: 83.30 

Round  28, Train loss: 0.147, Test loss: 0.527, Test accuracy: 81.30 

Round  29, Train loss: 0.123, Test loss: 0.476, Test accuracy: 82.90 

Round  30, Train loss: 0.107, Test loss: 0.434, Test accuracy: 84.90 

Round  31, Train loss: 0.135, Test loss: 0.483, Test accuracy: 83.20 

Round  32, Train loss: 0.113, Test loss: 0.522, Test accuracy: 81.90 

Round  33, Train loss: 0.116, Test loss: 0.603, Test accuracy: 79.10 

Round  34, Train loss: 0.089, Test loss: 0.488, Test accuracy: 84.00 

Round  35, Train loss: 0.109, Test loss: 0.497, Test accuracy: 83.00 

Round  36, Train loss: 0.089, Test loss: 0.485, Test accuracy: 83.40 

Round  37, Train loss: 0.066, Test loss: 0.486, Test accuracy: 82.60 

Round  38, Train loss: 0.070, Test loss: 0.506, Test accuracy: 82.60 

Round  39, Train loss: 0.074, Test loss: 0.531, Test accuracy: 83.50 

Round  40, Train loss: 0.066, Test loss: 0.574, Test accuracy: 83.20 

Round  41, Train loss: 0.080, Test loss: 0.539, Test accuracy: 82.00 

Round  42, Train loss: 0.051, Test loss: 0.489, Test accuracy: 84.30 

Round  43, Train loss: 0.055, Test loss: 0.515, Test accuracy: 83.70 

Round  44, Train loss: 0.055, Test loss: 0.521, Test accuracy: 83.30 

Round  45, Train loss: 0.063, Test loss: 0.557, Test accuracy: 83.40 

Round  46, Train loss: 0.046, Test loss: 0.556, Test accuracy: 82.80 

Round  47, Train loss: 0.053, Test loss: 0.548, Test accuracy: 84.60 

Round  48, Train loss: 0.045, Test loss: 0.512, Test accuracy: 84.10 

Round  49, Train loss: 0.036, Test loss: 0.532, Test accuracy: 83.50 

Final Round, Train loss: 0.026, Test loss: 0.540, Test accuracy: 84.60 

Average accuracy final 10 rounds: 83.48999999999998 

608.1715137958527
[7.705014944076538, 10.035321950912476, 12.278492450714111, 14.388059616088867, 16.55962562561035, 18.88481378555298, 21.143592834472656, 23.389747142791748, 25.49032163619995, 27.63597011566162, 29.870792388916016, 32.03735613822937, 34.290241956710815, 36.479267597198486, 38.845961809158325, 40.931862354278564, 43.13948655128479, 45.175989866256714, 47.391114950180054, 49.54505109786987, 51.767475605010986, 54.17894172668457, 56.490262508392334, 58.741629123687744, 60.95811891555786, 63.19662165641785, 65.52187466621399, 67.8015968799591, 70.03593397140503, 72.21765422821045, 74.28637909889221, 76.55180311203003, 78.86808848381042, 81.20569324493408, 83.26319122314453, 85.39543151855469, 87.6221330165863, 89.69336724281311, 91.93720746040344, 94.257395029068, 96.49395942687988, 98.75745582580566, 101.074387550354, 103.28856372833252, 105.51980566978455, 107.59515953063965, 109.88548731803894, 112.06934404373169, 114.24791598320007, 116.38265585899353, 118.77748203277588]
[55.2, 66.6, 68.4, 60.8, 61.0, 74.3, 74.5, 72.7, 78.3, 76.0, 74.6, 76.4, 76.8, 83.1, 80.9, 81.7, 79.8, 80.8, 81.4, 84.1, 82.6, 79.6, 82.8, 81.4, 81.3, 83.2, 82.7, 83.3, 81.3, 82.9, 84.9, 83.2, 81.9, 79.1, 84.0, 83.0, 83.4, 82.6, 82.6, 83.5, 83.2, 82.0, 84.3, 83.7, 83.3, 83.4, 82.8, 84.6, 84.1, 83.5, 84.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.733, Test loss: 0.745, Test accuracy: 53.80
Round   1, Train loss: 0.628, Test loss: 0.613, Test accuracy: 63.90
Round   2, Train loss: 0.593, Test loss: 0.693, Test accuracy: 64.80
Round   3, Train loss: 0.548, Test loss: 0.700, Test accuracy: 63.80
Round   4, Train loss: 0.529, Test loss: 0.560, Test accuracy: 72.60
Round   5, Train loss: 0.511, Test loss: 0.822, Test accuracy: 64.30
Round   6, Train loss: 0.476, Test loss: 0.581, Test accuracy: 72.70
Round   7, Train loss: 0.458, Test loss: 0.482, Test accuracy: 77.70
Round   8, Train loss: 0.435, Test loss: 0.602, Test accuracy: 75.70
Round   9, Train loss: 0.404, Test loss: 0.656, Test accuracy: 71.80
Round  10, Train loss: 0.373, Test loss: 0.529, Test accuracy: 77.70
Round  11, Train loss: 0.353, Test loss: 0.567, Test accuracy: 76.50
Round  12, Train loss: 0.345, Test loss: 0.549, Test accuracy: 76.10
Round  13, Train loss: 0.332, Test loss: 0.503, Test accuracy: 79.20
Round  14, Train loss: 0.297, Test loss: 0.577, Test accuracy: 76.60
Round  15, Train loss: 0.285, Test loss: 0.501, Test accuracy: 78.30
Round  16, Train loss: 0.276, Test loss: 0.550, Test accuracy: 78.00
Round  17, Train loss: 0.272, Test loss: 0.578, Test accuracy: 77.70
Round  18, Train loss: 0.240, Test loss: 0.468, Test accuracy: 80.80
Round  19, Train loss: 0.229, Test loss: 0.601, Test accuracy: 77.00
Round  20, Train loss: 0.225, Test loss: 0.458, Test accuracy: 83.40
Round  21, Train loss: 0.205, Test loss: 0.447, Test accuracy: 82.60
Round  22, Train loss: 0.203, Test loss: 0.500, Test accuracy: 80.80
Round  23, Train loss: 0.185, Test loss: 0.524, Test accuracy: 81.10
Round  24, Train loss: 0.190, Test loss: 0.581, Test accuracy: 79.10
Round  25, Train loss: 0.171, Test loss: 0.585, Test accuracy: 79.70
Round  26, Train loss: 0.178, Test loss: 0.522, Test accuracy: 81.50
Round  27, Train loss: 0.163, Test loss: 0.645, Test accuracy: 79.30
Round  28, Train loss: 0.152, Test loss: 0.482, Test accuracy: 83.10
Round  29, Train loss: 0.125, Test loss: 0.519, Test accuracy: 82.90
Round  30, Train loss: 0.134, Test loss: 0.484, Test accuracy: 83.70
Round  31, Train loss: 0.116, Test loss: 0.557, Test accuracy: 82.40
Round  32, Train loss: 0.120, Test loss: 0.500, Test accuracy: 83.10
Round  33, Train loss: 0.103, Test loss: 0.551, Test accuracy: 82.80
Round  34, Train loss: 0.108, Test loss: 0.622, Test accuracy: 81.10
Round  35, Train loss: 0.101, Test loss: 0.487, Test accuracy: 83.90
Round  36, Train loss: 0.122, Test loss: 0.526, Test accuracy: 82.40
Round  37, Train loss: 0.103, Test loss: 0.538, Test accuracy: 83.70
Round  38, Train loss: 0.095, Test loss: 0.487, Test accuracy: 85.00
Round  39, Train loss: 0.088, Test loss: 0.456, Test accuracy: 84.70
Round  40, Train loss: 0.073, Test loss: 0.520, Test accuracy: 84.10
Round  41, Train loss: 0.072, Test loss: 0.551, Test accuracy: 83.10
Round  42, Train loss: 0.062, Test loss: 0.517, Test accuracy: 83.50
Round  43, Train loss: 0.063, Test loss: 0.530, Test accuracy: 83.90
Round  44, Train loss: 0.063, Test loss: 0.499, Test accuracy: 84.90
Round  45, Train loss: 0.069, Test loss: 0.530, Test accuracy: 83.30
Round  46, Train loss: 0.051, Test loss: 0.529, Test accuracy: 83.60
Round  47, Train loss: 0.065, Test loss: 0.547, Test accuracy: 83.70
Round  48, Train loss: 0.052, Test loss: 0.586, Test accuracy: 83.10
Round  49, Train loss: 0.031, Test loss: 0.521, Test accuracy: 84.50
Final Round, Train loss: 0.028, Test loss: 0.544, Test accuracy: 84.50
Average accuracy final 10 rounds: 83.77000000000001
712.0917716026306
[8.28885269165039, 10.81589150428772, 13.365513563156128, 15.916007280349731, 18.444751024246216, 21.01360058784485, 23.579913854599, 26.18537712097168, 28.675536632537842, 31.226560354232788, 33.93303418159485, 36.44687747955322, 38.9907329082489, 41.7566397190094, 44.34199666976929, 46.97912406921387, 49.5861918926239, 52.108049154281616, 54.799166679382324, 57.41667056083679, 60.25761413574219, 63.09506630897522, 65.63314962387085, 68.26135444641113, 70.93617463111877, 73.75911927223206, 76.43703413009644, 79.00257205963135, 81.6333384513855, 84.44522905349731, 87.05319666862488, 89.78915524482727, 92.2348701953888, 94.8465576171875, 97.39893937110901, 100.0069146156311, 102.70797443389893, 105.22815608978271, 107.75704383850098, 110.37788534164429, 112.89756608009338, 115.49337482452393, 118.01136922836304, 120.63544392585754, 123.55081272125244, 126.1854841709137, 129.01545023918152, 131.56871438026428, 134.0645477771759, 136.60714507102966, 139.84106469154358]
[53.8, 63.9, 64.8, 63.8, 72.6, 64.3, 72.7, 77.7, 75.7, 71.8, 77.7, 76.5, 76.1, 79.2, 76.6, 78.3, 78.0, 77.7, 80.8, 77.0, 83.4, 82.6, 80.8, 81.1, 79.1, 79.7, 81.5, 79.3, 83.1, 82.9, 83.7, 82.4, 83.1, 82.8, 81.1, 83.9, 82.4, 83.7, 85.0, 84.7, 84.1, 83.1, 83.5, 83.9, 84.9, 83.3, 83.6, 83.7, 83.1, 84.5, 84.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.163, Train accuracy: 94.500, Test loss: 0.526, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.055, Train accuracy: 98.500, Test loss: 0.432, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 98.500, Test loss: 0.408, Test accuracy: 88.50 

Round   0, Train loss: 0.057, Test loss: 0.408, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.500, Test loss: 0.496, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.500, Test loss: 0.395, Test accuracy: 87.50 

Round   1, Train loss: 0.031, Test loss: 0.395, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.475, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 0.547, Test accuracy: 83.50 

Round   2, Train loss: 0.047, Test loss: 0.547, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.500, Test loss: 0.287, Test accuracy: 92.00 

Round   3, Train loss: 0.041, Test loss: 0.287, Test accuracy: 92.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.240, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 87.50 

Round   4, Train loss: 0.003, Test loss: 0.460, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.576, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 98.500, Test loss: 0.340, Test accuracy: 91.00 

Round   5, Train loss: 0.018, Test loss: 0.340, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 92.50 

Round   6, Train loss: 0.001, Test loss: 0.311, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 88.50 

Round   7, Train loss: 0.001, Test loss: 0.386, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 0.302, Test accuracy: 92.50 

Round   8, Train loss: 0.036, Test loss: 0.302, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 88.00 

Round   9, Train loss: 0.009, Test loss: 0.487, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.077, Train accuracy: 97.000, Test loss: 0.804, Test accuracy: 80.50 

Round  10, Train loss: 0.077, Test loss: 0.804, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 91.00 

Round  11, Train loss: 0.001, Test loss: 0.409, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 0.620, Test accuracy: 90.00 

Round  12, Train loss: 0.038, Test loss: 0.620, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 0.397, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 93.00 

Round  13, Train loss: 0.000, Test loss: 0.368, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 92.00 

Round  14, Train loss: 0.001, Test loss: 0.365, Test accuracy: 92.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 90.00 

Round  15, Train loss: 0.001, Test loss: 0.419, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 89.50 

Round  16, Train loss: 0.000, Test loss: 0.396, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 92.50 

Round  17, Train loss: 0.000, Test loss: 0.352, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 89.00 

Round  18, Train loss: 0.001, Test loss: 0.400, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 93.50 

Round  19, Train loss: 0.000, Test loss: 0.301, Test accuracy: 93.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 91.50 

Final Round, Train loss: 0.001, Test loss: 0.309, Test accuracy: 93.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.296, Train accuracy: 87.500, Test loss: 0.728, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.226, Train accuracy: 93.000, Test loss: 0.601, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.070, Train accuracy: 97.500, Test loss: 0.671, Test accuracy: 82.00 

Round   0, Train loss: 0.035, Test loss: 0.442, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.105, Train accuracy: 97.500, Test loss: 0.618, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 0.568, Test accuracy: 85.00 

Round   1, Train loss: 0.019, Test loss: 0.440, Test accuracy: 86.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.042, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.527, Test accuracy: 86.50 

Round   2, Train loss: 0.010, Test loss: 0.452, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.486, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.318, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.479, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 82.50 

Round   3, Train loss: 0.013, Test loss: 0.407, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.413, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.538, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.780, Test accuracy: 85.00 

Round   4, Train loss: 0.013, Test loss: 0.504, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.534, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.500, Test loss: 0.646, Test accuracy: 82.50 

Round   5, Train loss: 0.015, Test loss: 0.540, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.535, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 87.50 

Round   6, Train loss: 0.002, Test loss: 0.471, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 85.00 

Round   7, Train loss: 0.003, Test loss: 0.460, Test accuracy: 90.25 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 87.00 

Round   8, Train loss: 0.001, Test loss: 0.460, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.628, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 86.00 

Round   9, Train loss: 0.000, Test loss: 0.490, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.595, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.612, Test accuracy: 86.50 

Round  10, Train loss: 0.000, Test loss: 0.508, Test accuracy: 89.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.650, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.753, Test accuracy: 83.00 

Round  11, Train loss: 0.015, Test loss: 0.636, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.668, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 85.50 

Round  12, Train loss: 0.004, Test loss: 0.476, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.461, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 84.00 

Round  13, Train loss: 0.001, Test loss: 0.572, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.676, Test accuracy: 87.00 

Round  14, Train loss: 0.000, Test loss: 0.607, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.686, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.716, Test accuracy: 85.50 

Round  15, Train loss: 0.000, Test loss: 0.561, Test accuracy: 89.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.438, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.666, Test accuracy: 87.00 

Round  16, Train loss: 0.000, Test loss: 0.589, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 87.50 

Round  17, Train loss: 0.000, Test loss: 0.591, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.426, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.743, Test accuracy: 86.50 

Round  18, Train loss: 0.000, Test loss: 0.625, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.721, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 87.50 

Round  19, Train loss: 0.000, Test loss: 0.611, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.685, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 87.50 

Final Round, Train loss: 0.000, Test loss: 0.604, Test accuracy: 89.50 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.638, Train accuracy: 70.000, Test loss: 0.986, Test accuracy: 62.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.704, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 85.50 

        train local model (freeze embeding):client   2,  Train loss: 0.568, Train accuracy: 73.000, Test loss: 0.815, Test accuracy: 64.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.243, Train accuracy: 90.500, Test loss: 0.559, Test accuracy: 79.00 

Round   0, Train loss: 0.081, Test loss: 0.552, Test accuracy: 83.33 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.694, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.500, Test loss: 0.715, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.425, Train accuracy: 84.500, Test loss: 0.735, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.232, Train accuracy: 91.500, Test loss: 1.026, Test accuracy: 71.00 

Round   1, Train loss: 0.089, Test loss: 0.509, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.599, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.284, Train accuracy: 86.500, Test loss: 0.635, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.119, Train accuracy: 95.500, Test loss: 0.810, Test accuracy: 75.50 

Round   2, Train loss: 0.040, Test loss: 0.505, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.300, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.594, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.150, Train accuracy: 95.000, Test loss: 0.704, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.094, Train accuracy: 98.000, Test loss: 0.889, Test accuracy: 74.00 

Round   3, Train loss: 0.032, Test loss: 0.464, Test accuracy: 84.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.133, Train accuracy: 96.000, Test loss: 0.698, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.153, Train accuracy: 94.500, Test loss: 0.688, Test accuracy: 79.50 

Round   4, Train loss: 0.051, Test loss: 0.629, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.562, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.057, Train accuracy: 99.500, Test loss: 0.723, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 0.720, Test accuracy: 79.50 

Round   5, Train loss: 0.014, Test loss: 0.507, Test accuracy: 84.17 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.055, Train accuracy: 98.000, Test loss: 0.739, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.356, Train accuracy: 91.000, Test loss: 1.269, Test accuracy: 73.50 

Round   6, Train loss: 0.119, Test loss: 0.569, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.585, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 0.623, Test accuracy: 85.50 

        train local model (freeze embeding):client   2,  Train loss: 0.152, Train accuracy: 95.500, Test loss: 1.059, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 0.899, Test accuracy: 78.50 

Round   7, Train loss: 0.019, Test loss: 0.505, Test accuracy: 84.33 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.526, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.815, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.245, Train accuracy: 90.000, Test loss: 0.951, Test accuracy: 75.50 

Round   8, Train loss: 0.082, Test loss: 0.540, Test accuracy: 83.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 80.00 

Round   9, Train loss: 0.002, Test loss: 0.523, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.294, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.926, Test accuracy: 74.50 

Round  10, Train loss: 0.014, Test loss: 0.541, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.375, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.541, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.575, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 98.500, Test loss: 1.260, Test accuracy: 73.50 

Round  11, Train loss: 0.035, Test loss: 0.609, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.337, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.541, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.103, Train accuracy: 95.000, Test loss: 0.913, Test accuracy: 76.50 

Round  12, Train loss: 0.038, Test loss: 0.500, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 95.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.774, Test accuracy: 82.50 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.916, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 98.500, Test loss: 0.975, Test accuracy: 75.00 

Round  13, Train loss: 0.017, Test loss: 0.558, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.266, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.478, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.625, Test accuracy: 85.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 81.50 

Round  14, Train loss: 0.002, Test loss: 0.520, Test accuracy: 86.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.949, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 79.00 

Round  15, Train loss: 0.001, Test loss: 0.556, Test accuracy: 86.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 95.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 78.00 

Round  16, Train loss: 0.003, Test loss: 0.632, Test accuracy: 84.83 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.654, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 77.50 

Round  17, Train loss: 0.000, Test loss: 0.581, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.547, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.610, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.000, Test loss: 1.130, Test accuracy: 76.50 

Round  18, Train loss: 0.015, Test loss: 0.618, Test accuracy: 85.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.621, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 79.50 

Round  19, Train loss: 0.001, Test loss: 0.613, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.562, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 77.50 

Final Round, Train loss: 0.001, Test loss: 0.635, Test accuracy: 86.00 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 1.028, Train accuracy: 54.000, Test loss: 1.175, Test accuracy: 53.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.587, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.184, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.510, Train accuracy: 74.000, Test loss: 0.622, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.967, Train accuracy: 70.500, Test loss: 1.655, Test accuracy: 65.00 

Round   0, Train loss: 0.243, Test loss: 0.637, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.275, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.000, Test loss: 1.127, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.301, Train accuracy: 87.000, Test loss: 0.518, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.122, Train accuracy: 95.000, Test loss: 0.933, Test accuracy: 77.50 

Round   1, Train loss: 0.034, Test loss: 0.576, Test accuracy: 83.88 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.650, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.755, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.041, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.180, Train accuracy: 93.500, Test loss: 0.542, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 0.689, Test accuracy: 83.00 

Round   2, Train loss: 0.011, Test loss: 0.605, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 94.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.640, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.656, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.061, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.098, Train accuracy: 97.500, Test loss: 0.546, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.012, Test accuracy: 78.50 

Round   3, Train loss: 0.010, Test loss: 0.632, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.304, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.709, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.059, Train accuracy: 99.500, Test loss: 0.594, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.221, Train accuracy: 92.000, Test loss: 1.002, Test accuracy: 80.50 

Round   4, Train loss: 0.056, Test loss: 0.602, Test accuracy: 83.88 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 98.000, Test loss: 1.062, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.055, Train accuracy: 98.500, Test loss: 0.538, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 1.145, Test accuracy: 78.00 

Round   5, Train loss: 0.030, Test loss: 0.639, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.274, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.683, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.278, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 0.655, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.091, Train accuracy: 97.500, Test loss: 1.128, Test accuracy: 74.50 

Round   6, Train loss: 0.023, Test loss: 0.647, Test accuracy: 82.88 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.287, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.461, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.612, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.959, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.283, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.639, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.000, Test loss: 0.909, Test accuracy: 80.50 

Round   7, Train loss: 0.026, Test loss: 0.645, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.592, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.705, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.521, Train accuracy: 87.500, Test loss: 2.892, Test accuracy: 67.00 

        train local model (freeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.637, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.108, Test accuracy: 78.50 

Round   8, Train loss: 0.135, Test loss: 0.653, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.596, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.613, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 96.000, Test loss: 1.093, Test accuracy: 77.00 

Round   9, Train loss: 0.018, Test loss: 0.671, Test accuracy: 84.88 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.600, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.604, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.153, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.710, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 76.50 

Round  10, Train loss: 0.005, Test loss: 0.645, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.630, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.605, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.002, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 0.989, Test accuracy: 80.50 

Round  11, Train loss: 0.018, Test loss: 0.642, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.398, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.605, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.130, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.747, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 79.50 

Round  12, Train loss: 0.001, Test loss: 0.648, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.106, Train accuracy: 95.000, Test loss: 1.293, Test accuracy: 72.50 

Round  13, Train loss: 0.027, Test loss: 0.650, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.545, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 80.00 

Round  14, Train loss: 0.001, Test loss: 0.648, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.769, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.962, Test accuracy: 79.50 

Round  15, Train loss: 0.012, Test loss: 0.668, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.693, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.161, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.133, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 80.50 

Round  16, Train loss: 0.000, Test loss: 0.668, Test accuracy: 85.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.729, Test accuracy: 83.50 

Round  17, Train loss: 0.005, Test loss: 0.657, Test accuracy: 86.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.154, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.122, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 79.00 

Round  18, Train loss: 0.000, Test loss: 0.669, Test accuracy: 85.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.359, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.589, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.169, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.760, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 80.00 

Round  19, Train loss: 0.001, Test loss: 0.670, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.154, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 81.50 

Final Round, Train loss: 0.000, Test loss: 0.685, Test accuracy: 85.38 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.254, Train accuracy: 86.000, Test loss: 0.409, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.621, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.773, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 82.00 

        train local model (freeze embeding):client   4,  Train loss: 0.289, Train accuracy: 89.500, Test loss: 0.349, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.405, Test accuracy: 90.00 

Round   0, Train loss: 0.006, Test loss: 0.600, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.522, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 80.50 

        train local model (freeze embeding):client   4,  Train loss: 0.120, Train accuracy: 95.500, Test loss: 0.328, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 90.50 

Round   1, Train loss: 0.004, Test loss: 0.589, Test accuracy: 85.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.517, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 84.00 

        train local model (freeze embeding):client   4,  Train loss: 0.067, Train accuracy: 98.000, Test loss: 0.283, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.414, Test accuracy: 89.50 

Round   2, Train loss: 0.005, Test loss: 0.586, Test accuracy: 86.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.512, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.888, Test accuracy: 85.00 

        train local model (freeze embeding):client   4,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 0.309, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 91.00 

Round   3, Train loss: 0.003, Test loss: 0.588, Test accuracy: 85.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.604, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.398, Train accuracy: 90.500, Test loss: 1.325, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 1.268, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.287, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 91.50 

Round   4, Train loss: 0.084, Test loss: 0.626, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.562, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.614, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.082, Train accuracy: 98.000, Test loss: 1.592, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.030, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 91.50 

Round   5, Train loss: 0.017, Test loss: 0.623, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.521, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.651, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.096, Train accuracy: 96.500, Test loss: 0.676, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 1.414, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.340, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.062, Train accuracy: 97.000, Test loss: 0.487, Test accuracy: 91.00 

Round   6, Train loss: 0.033, Test loss: 0.618, Test accuracy: 85.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.695, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.531, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.556, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.137, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.000, Test loss: 1.022, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.306, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.369, Test accuracy: 88.50 

Round   7, Train loss: 0.020, Test loss: 0.587, Test accuracy: 86.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.041, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 79.50 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.468, Test accuracy: 91.50 

Round   8, Train loss: 0.003, Test loss: 0.614, Test accuracy: 86.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.610, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 84.50 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.352, Test accuracy: 93.50 

Round   9, Train loss: 0.002, Test loss: 0.632, Test accuracy: 85.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.413, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.667, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 82.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 89.50 

Round  10, Train loss: 0.001, Test loss: 0.647, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.370, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.581, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 81.50 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.571, Test accuracy: 90.00 

Round  11, Train loss: 0.002, Test loss: 0.653, Test accuracy: 85.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.593, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.715, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 82.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 91.00 

Round  12, Train loss: 0.001, Test loss: 0.642, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.181, Train accuracy: 94.500, Test loss: 1.236, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 83.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 88.50 

Round  13, Train loss: 0.038, Test loss: 0.633, Test accuracy: 85.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.613, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.029, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.119, Test accuracy: 81.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.398, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.428, Test accuracy: 92.00 

Round  14, Train loss: 0.002, Test loss: 0.644, Test accuracy: 85.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.584, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.196, Test accuracy: 80.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.359, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 91.50 

Round  15, Train loss: 0.000, Test loss: 0.650, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.051, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 81.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.645, Test accuracy: 86.00 

Round  16, Train loss: 0.006, Test loss: 0.662, Test accuracy: 86.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.618, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.056, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 82.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 90.00 

Round  17, Train loss: 0.000, Test loss: 0.654, Test accuracy: 86.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.589, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.726, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 80.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 92.50 

Round  18, Train loss: 0.001, Test loss: 0.640, Test accuracy: 86.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.617, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.637, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 82.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 91.00 

Round  19, Train loss: 0.000, Test loss: 0.652, Test accuracy: 86.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.320, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.621, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.619, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.091, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.056, Test accuracy: 79.50 

        train local model (freeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 89.00 

Final Round, Train loss: 0.000, Test loss: 0.657, Test accuracy: 85.60 

Average accuracy final 10 rounds: 435.7566666666667 

2453.2467052936554
[7.51492166519165, 14.971200942993164, 22.697683334350586, 30.16085433959961, 37.56902313232422, 45.06338977813721, 52.38454556465149, 59.926183462142944, 67.38897967338562, 74.73358488082886, 82.43532466888428, 90.12426495552063, 97.7924542427063, 105.22146129608154, 112.00477123260498, 119.56058835983276, 127.0548369884491, 134.5149006843567, 142.17540740966797, 149.74053502082825, 154.03447198867798, 161.51641941070557, 169.44846773147583, 177.16546368598938, 184.7856729030609, 192.25161910057068, 200.00275039672852, 207.5493438243866, 215.15439343452454, 222.98067808151245, 230.54148864746094, 238.03737211227417, 245.6916069984436, 253.44185662269592, 261.27997732162476, 268.5223264694214, 276.1259837150574, 283.57504534721375, 291.0903944969177, 298.74190616607666, 306.2404224872589, 310.68598103523254, 318.2068121433258, 325.9689681529999, 333.8093478679657, 341.52665996551514, 349.16133522987366, 356.7379095554352, 364.3269274234772, 372.0869998931885, 379.9274744987488, 387.65265226364136, 395.40911078453064, 403.30586218833923, 410.9817373752594, 418.5390086174011, 426.2188386917114, 433.8559114933014, 441.4233589172363, 449.17995023727417, 456.82084441185, 464.66959524154663, 468.9945092201233, 476.7347638607025, 484.3238434791565, 491.9831702709198, 499.82307171821594, 507.8054029941559, 515.2744061946869, 522.8744621276855, 530.375727891922, 537.939436674118, 545.5595104694366, 553.2505102157593, 561.1040258407593, 568.8315043449402, 576.7388100624084, 584.3479990959167, 592.1010656356812, 599.4363453388214, 607.0066361427307, 614.6498711109161, 622.1987085342407, 627.4409680366516, 635.1743206977844, 643.0418667793274, 650.6285357475281, 658.3050553798676, 666.0734708309174, 673.8734929561615, 681.4941289424896, 689.2755813598633, 696.9197471141815, 704.7861166000366, 712.806515455246, 720.614278793335, 728.2120764255524, 735.9062166213989, 743.6481413841248, 751.3206858634949, 759.1206827163696, 766.973566532135, 774.6524484157562, 782.4153094291687, 786.9281902313232]
[88.5, 87.5, 83.5, 92.0, 87.5, 91.0, 92.5, 88.5, 92.5, 88.0, 80.5, 91.0, 90.0, 93.0, 92.0, 90.0, 89.5, 92.5, 89.0, 93.5, 93.0, 85.5, 86.75, 87.5, 88.0, 87.25, 87.0, 89.25, 90.25, 89.0, 90.0, 89.75, 87.5, 89.5, 88.75, 88.75, 89.75, 89.25, 89.25, 88.75, 89.25, 89.5, 83.33333333333333, 82.0, 84.0, 84.66666666666667, 81.33333333333333, 84.16666666666667, 83.5, 84.33333333333333, 83.66666666666667, 86.0, 85.5, 83.83333333333333, 85.66666666666667, 85.33333333333333, 86.16666666666667, 86.66666666666667, 84.83333333333333, 85.66666666666667, 85.16666666666667, 85.33333333333333, 86.0, 80.5, 83.875, 83.625, 83.5, 83.875, 83.625, 82.875, 84.5, 84.25, 84.875, 85.125, 84.25, 85.125, 85.125, 85.0, 84.75, 85.875, 86.125, 85.625, 85.0, 85.375, 85.5, 85.7, 86.4, 85.7, 85.3, 85.0, 85.2, 86.3, 86.1, 85.8, 85.3, 85.4, 85.5, 85.7, 85.6, 87.0, 86.7, 86.3, 86.1, 86.3, 85.6]
