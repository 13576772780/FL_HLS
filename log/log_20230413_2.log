nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.547, Test loss: 0.420, Test accuracy: 82.10 

Round   0, Global train loss: 0.547, Global test loss: 0.849, Global test accuracy: 50.60 

Round   1, Train loss: 0.367, Test loss: 0.504, Test accuracy: 81.40 

Round   1, Global train loss: 0.367, Global test loss: 0.909, Global test accuracy: 50.00 

Round   2, Train loss: 0.305, Test loss: 0.581, Test accuracy: 83.90 

Round   2, Global train loss: 0.305, Global test loss: 0.852, Global test accuracy: 50.20 

Round   3, Train loss: 0.268, Test loss: 0.517, Test accuracy: 81.30 

Round   3, Global train loss: 0.268, Global test loss: 0.901, Global test accuracy: 50.00 

Round   4, Train loss: 0.209, Test loss: 0.435, Test accuracy: 85.80 

Round   4, Global train loss: 0.209, Global test loss: 0.866, Global test accuracy: 50.00 

Round   5, Train loss: 0.221, Test loss: 0.430, Test accuracy: 86.60 

Round   5, Global train loss: 0.221, Global test loss: 0.874, Global test accuracy: 50.00 

Round   6, Train loss: 0.163, Test loss: 0.520, Test accuracy: 85.50 

Round   6, Global train loss: 0.163, Global test loss: 0.925, Global test accuracy: 50.00 

Round   7, Train loss: 0.146, Test loss: 0.749, Test accuracy: 85.60 

Round   7, Global train loss: 0.146, Global test loss: 0.984, Global test accuracy: 50.00 

Round   8, Train loss: 0.117, Test loss: 0.533, Test accuracy: 86.40 

Round   8, Global train loss: 0.117, Global test loss: 1.025, Global test accuracy: 50.00 

Round   9, Train loss: 0.110, Test loss: 0.498, Test accuracy: 88.80 

Round   9, Global train loss: 0.110, Global test loss: 1.056, Global test accuracy: 50.00 

Round  10, Train loss: 0.115, Test loss: 0.681, Test accuracy: 83.20 

Round  10, Global train loss: 0.115, Global test loss: 0.929, Global test accuracy: 50.00 

Round  11, Train loss: 0.103, Test loss: 0.469, Test accuracy: 86.80 

Round  11, Global train loss: 0.103, Global test loss: 1.018, Global test accuracy: 50.00 

Round  12, Train loss: 0.077, Test loss: 0.670, Test accuracy: 87.20 

Round  12, Global train loss: 0.077, Global test loss: 1.018, Global test accuracy: 50.00 

Round  13, Train loss: 0.121, Test loss: 0.556, Test accuracy: 86.60 

Round  13, Global train loss: 0.121, Global test loss: 1.201, Global test accuracy: 50.00 

Round  14, Train loss: 0.080, Test loss: 0.466, Test accuracy: 87.10 

Round  14, Global train loss: 0.080, Global test loss: 1.056, Global test accuracy: 50.00 

Round  15, Train loss: 0.058, Test loss: 0.501, Test accuracy: 86.50 

Round  15, Global train loss: 0.058, Global test loss: 1.162, Global test accuracy: 50.00 

Round  16, Train loss: 0.056, Test loss: 0.693, Test accuracy: 84.50 

Round  16, Global train loss: 0.056, Global test loss: 1.101, Global test accuracy: 50.00 

Round  17, Train loss: 0.056, Test loss: 0.827, Test accuracy: 85.10 

Round  17, Global train loss: 0.056, Global test loss: 1.121, Global test accuracy: 50.00 

Round  18, Train loss: 0.040, Test loss: 0.575, Test accuracy: 88.10 

Round  18, Global train loss: 0.040, Global test loss: 1.241, Global test accuracy: 50.00 

Round  19, Train loss: 0.070, Test loss: 0.465, Test accuracy: 87.00 

Round  19, Global train loss: 0.070, Global test loss: 1.136, Global test accuracy: 50.00 

Round  20, Train loss: 0.033, Test loss: 0.459, Test accuracy: 87.90 

Round  20, Global train loss: 0.033, Global test loss: 1.124, Global test accuracy: 50.00 

Round  21, Train loss: 0.022, Test loss: 0.553, Test accuracy: 87.00 

Round  21, Global train loss: 0.022, Global test loss: 1.169, Global test accuracy: 50.00 

Round  22, Train loss: 0.026, Test loss: 0.503, Test accuracy: 87.80 

Round  22, Global train loss: 0.026, Global test loss: 1.214, Global test accuracy: 50.00 

Round  23, Train loss: 0.025, Test loss: 0.688, Test accuracy: 85.90 

Round  23, Global train loss: 0.025, Global test loss: 1.318, Global test accuracy: 50.00 

Round  24, Train loss: 0.033, Test loss: 0.547, Test accuracy: 87.80 

Round  24, Global train loss: 0.033, Global test loss: 1.294, Global test accuracy: 50.00 

Round  25, Train loss: 0.025, Test loss: 0.463, Test accuracy: 88.60 

Round  25, Global train loss: 0.025, Global test loss: 1.181, Global test accuracy: 50.00 

Round  26, Train loss: 0.033, Test loss: 0.550, Test accuracy: 87.50 

Round  26, Global train loss: 0.033, Global test loss: 1.280, Global test accuracy: 50.00 

Round  27, Train loss: 0.026, Test loss: 0.570, Test accuracy: 86.90 

Round  27, Global train loss: 0.026, Global test loss: 1.305, Global test accuracy: 50.00 

Round  28, Train loss: 0.016, Test loss: 0.520, Test accuracy: 88.40 

Round  28, Global train loss: 0.016, Global test loss: 1.304, Global test accuracy: 50.00 

Round  29, Train loss: 0.027, Test loss: 0.637, Test accuracy: 86.30 

Round  29, Global train loss: 0.027, Global test loss: 1.143, Global test accuracy: 50.00 

Round  30, Train loss: 0.022, Test loss: 0.494, Test accuracy: 88.50 

Round  30, Global train loss: 0.022, Global test loss: 1.257, Global test accuracy: 50.00 

Round  31, Train loss: 0.023, Test loss: 0.508, Test accuracy: 89.80 

Round  31, Global train loss: 0.023, Global test loss: 1.381, Global test accuracy: 50.00 

Round  32, Train loss: 0.017, Test loss: 0.588, Test accuracy: 87.50 

Round  32, Global train loss: 0.017, Global test loss: 1.291, Global test accuracy: 50.00 

Round  33, Train loss: 0.013, Test loss: 0.556, Test accuracy: 88.70 

Round  33, Global train loss: 0.013, Global test loss: 1.293, Global test accuracy: 50.00 

Round  34, Train loss: 0.013, Test loss: 0.532, Test accuracy: 87.10 

Round  34, Global train loss: 0.013, Global test loss: 1.357, Global test accuracy: 50.00 

Final Round, Train loss: 0.016, Test loss: 0.534, Test accuracy: 88.00 

Final Round, Global train loss: 0.016, Global test loss: 1.357, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 87.92999999999999 

Average global accuracy final 10 rounds: 50.0 

476.4670031070709
[4.409159183502197, 6.726792812347412, 9.018610715866089, 11.327664375305176, 13.639976501464844, 15.954938888549805, 18.404590368270874, 20.92250156402588, 23.29467487335205, 25.57597780227661, 28.158787965774536, 30.42019295692444, 33.034361362457275, 35.44575357437134, 37.66571569442749, 39.85593509674072, 42.356348752975464, 44.62924885749817, 47.050179958343506, 49.410927295684814, 51.82542943954468, 54.08673882484436, 56.34667611122131, 58.6500244140625, 60.94654130935669, 63.1797878742218, 65.44188475608826, 67.80544829368591, 70.08854055404663, 72.45059061050415, 74.87706708908081, 77.18243503570557, 79.52776026725769, 81.90732336044312, 84.28430366516113, 89.01521444320679]
[82.1, 81.4, 83.9, 81.3, 85.8, 86.6, 85.5, 85.6, 86.4, 88.8, 83.2, 86.8, 87.2, 86.6, 87.1, 86.5, 84.5, 85.1, 88.1, 87.0, 87.9, 87.0, 87.8, 85.9, 87.8, 88.6, 87.5, 86.9, 88.4, 86.3, 88.5, 89.8, 87.5, 88.7, 87.1, 88.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.389, Train accuracy: 86.000, Test loss: 0.523, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.173, Train accuracy: 95.000, Test loss: 0.286, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.147, Train accuracy: 96.500, Test loss: 0.333, Test accuracy: 87.50 

Round   0, Train loss: 0.147, Test loss: 0.333, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.095, Train accuracy: 97.500, Test loss: 0.249, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 0.566, Test accuracy: 88.00 

Round   1, Train loss: 0.047, Test loss: 0.566, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.486, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.245, Train accuracy: 93.000, Test loss: 0.877, Test accuracy: 84.00 

Round   2, Train loss: 0.245, Test loss: 0.877, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.088, Train accuracy: 95.500, Test loss: 0.531, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

Round   3, Train loss: 0.026, Test loss: 0.312, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 89.00 

Round   4, Train loss: 0.006, Test loss: 0.352, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 96.500, Test loss: 0.541, Test accuracy: 88.50 

Round   5, Train loss: 0.064, Test loss: 0.541, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.351, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 93.00 

Round   6, Train loss: 0.011, Test loss: 0.286, Test accuracy: 93.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 88.00 

Round   7, Train loss: 0.001, Test loss: 0.392, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 90.00 

Round   8, Train loss: 0.002, Test loss: 0.335, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 89.50 

Round   9, Train loss: 0.003, Test loss: 0.357, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 90.00 

Round  10, Train loss: 0.001, Test loss: 0.354, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 87.00 

Round  11, Train loss: 0.001, Test loss: 0.399, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 88.00 

Round  12, Train loss: 0.000, Test loss: 0.363, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 88.00 

Round  13, Train loss: 0.000, Test loss: 0.414, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.444, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.070, Train accuracy: 98.500, Test loss: 0.413, Test accuracy: 85.00 

Round  14, Train loss: 0.070, Test loss: 0.413, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.044, Train accuracy: 99.000, Test loss: 0.364, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 91.50 

Round  15, Train loss: 0.000, Test loss: 0.365, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.281, Test accuracy: 91.00 

Round  16, Train loss: 0.004, Test loss: 0.281, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 89.50 

Round  17, Train loss: 0.000, Test loss: 0.415, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.463, Test accuracy: 88.50 

Round  18, Train loss: 0.001, Test loss: 0.463, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 89.50 

Round  19, Train loss: 0.000, Test loss: 0.451, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 89.00 

Final Round, Train loss: 0.000, Test loss: 0.454, Test accuracy: 89.50 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.653, Train accuracy: 68.500, Test loss: 0.917, Test accuracy: 65.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.456, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.991, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.495, Train accuracy: 74.000, Test loss: 0.717, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.341, Train accuracy: 89.500, Test loss: 1.607, Test accuracy: 74.50 

Round   0, Train loss: 0.183, Test loss: 0.664, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.423, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.243, Train accuracy: 89.500, Test loss: 0.723, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.103, Train accuracy: 97.000, Test loss: 0.668, Test accuracy: 79.00 

Round   1, Train loss: 0.052, Test loss: 0.510, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.138, Train accuracy: 95.500, Test loss: 0.754, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.112, Train accuracy: 98.000, Test loss: 0.931, Test accuracy: 69.00 

Round   2, Train loss: 0.057, Test loss: 0.605, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.088, Train accuracy: 98.500, Test loss: 0.834, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 98.000, Test loss: 1.019, Test accuracy: 76.50 

Round   3, Train loss: 0.041, Test loss: 0.563, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.453, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.625, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.071, Train accuracy: 98.500, Test loss: 0.864, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.092, Train accuracy: 97.000, Test loss: 1.301, Test accuracy: 72.00 

Round   4, Train loss: 0.047, Test loss: 0.618, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.458, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.044, Train accuracy: 99.000, Test loss: 1.055, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 1.524, Test accuracy: 75.50 

Round   5, Train loss: 0.011, Test loss: 0.722, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 1.213, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 99.500, Test loss: 0.932, Test accuracy: 75.00 

Round   6, Train loss: 0.024, Test loss: 0.719, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.504, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 1.124, Test accuracy: 80.00 

Round   7, Train loss: 0.011, Test loss: 0.637, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.233, Train accuracy: 89.500, Test loss: 1.742, Test accuracy: 73.00 

Round   8, Train loss: 0.117, Test loss: 0.704, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 1.118, Test accuracy: 74.50 

Round   9, Train loss: 0.014, Test loss: 0.776, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.192, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 1.104, Test accuracy: 75.50 

Round  10, Train loss: 0.008, Test loss: 0.792, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.552, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 74.00 

Round  11, Train loss: 0.002, Test loss: 0.769, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.268, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.092, Train accuracy: 97.500, Test loss: 1.223, Test accuracy: 76.50 

Round  12, Train loss: 0.046, Test loss: 0.780, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.241, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.230, Test accuracy: 75.50 

Round  13, Train loss: 0.011, Test loss: 0.881, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.591, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.187, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.684, Test accuracy: 72.50 

Round  14, Train loss: 0.002, Test loss: 0.924, Test accuracy: 80.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.690, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 77.00 

Round  15, Train loss: 0.000, Test loss: 0.915, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.569, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.261, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 79.50 

Round  16, Train loss: 0.004, Test loss: 0.859, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.634, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.433, Test accuracy: 74.50 

Round  17, Train loss: 0.004, Test loss: 0.886, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.510, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.616, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 1.367, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.506, Test accuracy: 75.50 

Round  18, Train loss: 0.000, Test loss: 0.930, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.586, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.400, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.428, Test accuracy: 78.00 

Round  19, Train loss: 0.013, Test loss: 0.937, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.619, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.399, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.492, Test accuracy: 74.00 

Final Round, Train loss: 0.001, Test loss: 0.956, Test accuracy: 79.50 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.318, Train accuracy: 87.000, Test loss: 0.317, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 1.605, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.296, Train accuracy: 86.500, Test loss: 0.305, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 0.370, Test accuracy: 88.00 

Round   0, Train loss: 0.020, Test loss: 0.667, Test accuracy: 84.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.396, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.438, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.110, Train accuracy: 97.500, Test loss: 0.255, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.152, Train accuracy: 95.500, Test loss: 0.408, Test accuracy: 89.50 

Round   1, Train loss: 0.051, Test loss: 0.644, Test accuracy: 85.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 0.296, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.290, Test accuracy: 89.00 

Round   2, Train loss: 0.005, Test loss: 0.649, Test accuracy: 84.83 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 97.500, Test loss: 1.382, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.259, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.502, Test accuracy: 87.50 

Round   3, Train loss: 0.025, Test loss: 0.641, Test accuracy: 85.83 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.513, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.654, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.197, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.745, Train accuracy: 88.000, Test loss: 4.254, Test accuracy: 67.00 

        train local model (freeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.259, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.117, Train accuracy: 95.500, Test loss: 0.725, Test accuracy: 84.50 

Round   4, Train loss: 0.287, Test loss: 0.897, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.522, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.633, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 88.00 

Round   5, Train loss: 0.005, Test loss: 0.700, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.604, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.651, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.242, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 92.00 

Round   6, Train loss: 0.001, Test loss: 0.705, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.580, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 89.50 

Round   7, Train loss: 0.004, Test loss: 0.611, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.573, Test accuracy: 86.00 

Round   8, Train loss: 0.007, Test loss: 0.695, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.581, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 74.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.304, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 89.50 

Round   9, Train loss: 0.003, Test loss: 0.684, Test accuracy: 86.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.556, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.632, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.566, Test accuracy: 88.00 

Round  10, Train loss: 0.005, Test loss: 0.767, Test accuracy: 84.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.642, Train accuracy: 84.500, Test loss: 2.397, Test accuracy: 69.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.353, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.523, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 88.50 

Round  11, Train loss: 0.214, Test loss: 0.948, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.698, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.571, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.129, Train accuracy: 93.500, Test loss: 1.125, Test accuracy: 82.00 

Round  12, Train loss: 0.043, Test loss: 0.863, Test accuracy: 81.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.592, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.476, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.121, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 88.50 

Round  13, Train loss: 0.004, Test loss: 0.801, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.673, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.918, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 91.00 

Round  14, Train loss: 0.004, Test loss: 0.808, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.570, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.601, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.623, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.627, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 89.50 

Round  15, Train loss: 0.000, Test loss: 0.812, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.462, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 91.00 

Round  16, Train loss: 0.000, Test loss: 0.801, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.639, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.432, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 90.00 

Round  17, Train loss: 0.009, Test loss: 0.765, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.578, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.535, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.438, Test accuracy: 89.50 

Round  18, Train loss: 0.000, Test loss: 0.763, Test accuracy: 86.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.591, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.500, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.466, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.542, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 92.00 

Round  19, Train loss: 0.001, Test loss: 0.752, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.547, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.550, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.495, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 91.50 

Final Round, Train loss: 0.001, Test loss: 0.731, Test accuracy: 87.17 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.312, Train accuracy: 87.000, Test loss: 0.294, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.558, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.568, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.501, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.755, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.318, Train accuracy: 87.000, Test loss: 0.273, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.191, Test accuracy: 94.00 

Round   0, Train loss: 0.009, Test loss: 0.605, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.632, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.447, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.534, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 0.540, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.193, Train accuracy: 92.500, Test loss: 0.268, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 93.00 

Round   1, Train loss: 0.008, Test loss: 0.587, Test accuracy: 87.88 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.558, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.119, Train accuracy: 96.500, Test loss: 0.245, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.207, Test accuracy: 93.00 

Round   2, Train loss: 0.004, Test loss: 0.573, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.741, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.036, Train accuracy: 100.000, Test loss: 0.166, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.089, Train accuracy: 96.500, Test loss: 0.254, Test accuracy: 91.50 

Round   3, Train loss: 0.023, Test loss: 0.602, Test accuracy: 88.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.622, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.686, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 0.143, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.053, Train accuracy: 98.500, Test loss: 0.428, Test accuracy: 92.50 

Round   4, Train loss: 0.014, Test loss: 0.601, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.389, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.758, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.471, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.170, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 0.388, Test accuracy: 90.00 

Round   5, Train loss: 0.018, Test loss: 0.581, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.635, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.618, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.534, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.154, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.142, Test accuracy: 94.00 

Round   6, Train loss: 0.005, Test loss: 0.542, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.596, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.590, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.332, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.599, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 0.136, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.228, Test accuracy: 92.50 

Round   7, Train loss: 0.006, Test loss: 0.560, Test accuracy: 88.38 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.487, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.134, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.120, Test accuracy: 95.50 

Round   8, Train loss: 0.003, Test loss: 0.562, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.570, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.569, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.323, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.364, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.109, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.150, Test accuracy: 95.00 

Round   9, Train loss: 0.001, Test loss: 0.539, Test accuracy: 88.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.603, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.434, Test accuracy: 77.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.132, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.139, Test accuracy: 96.50 

Round  10, Train loss: 0.001, Test loss: 0.597, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.606, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.115, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.229, Test accuracy: 94.50 

Round  11, Train loss: 0.001, Test loss: 0.558, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.729, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.181, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 95.50 

Round  12, Train loss: 0.003, Test loss: 0.598, Test accuracy: 88.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.630, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.580, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 73.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.126, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.143, Test accuracy: 95.00 

Round  13, Train loss: 0.003, Test loss: 0.558, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.641, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.140, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 94.50 

Round  14, Train loss: 0.002, Test loss: 0.541, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.552, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.352, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.154, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.094, Test accuracy: 96.50 

Round  15, Train loss: 0.001, Test loss: 0.545, Test accuracy: 89.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.246, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 94.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.107, Test accuracy: 97.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.172, Test accuracy: 95.00 

Round  16, Train loss: 0.000, Test loss: 0.568, Test accuracy: 88.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.618, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.697, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.129, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.157, Test accuracy: 96.50 

Round  17, Train loss: 0.001, Test loss: 0.604, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.568, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.303, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 0.321, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.158, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 92.00 

Round  18, Train loss: 0.005, Test loss: 0.565, Test accuracy: 88.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.513, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.151, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 96.00 

Round  19, Train loss: 0.000, Test loss: 0.603, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.564, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.443, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.127, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.119, Test accuracy: 95.50 

Final Round, Train loss: 0.000, Test loss: 0.595, Test accuracy: 89.62 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.206, Train accuracy: 90.500, Test loss: 0.247, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.582, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.424, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.474, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.136, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.209, Test accuracy: 93.00 

        train local model (freeze embeding):client   4,  Train loss: 0.189, Train accuracy: 93.000, Test loss: 0.231, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.218, Train accuracy: 90.000, Test loss: 0.458, Test accuracy: 83.50 

Round   0, Train loss: 0.045, Test loss: 0.488, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.305, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 78.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.144, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.170, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.107, Train accuracy: 97.500, Test loss: 0.174, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.107, Test accuracy: 96.00 

Round   1, Train loss: 0.003, Test loss: 0.474, Test accuracy: 90.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.574, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.170, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.154, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.067, Train accuracy: 98.500, Test loss: 0.182, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.708, Train accuracy: 81.500, Test loss: 1.066, Test accuracy: 75.00 

Round   2, Train loss: 0.142, Test loss: 0.502, Test accuracy: 89.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.582, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.340, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.436, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.180, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.198, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.063, Train accuracy: 98.000, Test loss: 0.238, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.103, Test accuracy: 96.00 

Round   3, Train loss: 0.003, Test loss: 0.468, Test accuracy: 90.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.582, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.724, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.140, Test accuracy: 97.00 

        train local model (freeze embeding):client   4,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 0.151, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.168, Test accuracy: 96.00 

Round   4, Train loss: 0.002, Test loss: 0.482, Test accuracy: 89.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.568, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.571, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.433, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.283, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.158, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.120, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.196, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.153, Test accuracy: 96.00 

Round   5, Train loss: 0.001, Test loss: 0.478, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.601, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 1.766, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.165, Test accuracy: 93.50 

        train local model (freeze embeding):client   4,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 0.142, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.086, Test accuracy: 97.00 

Round   6, Train loss: 0.007, Test loss: 0.500, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.605, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.696, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.509, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.103, Test accuracy: 97.00 

        train local model (freeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.222, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.193, Test accuracy: 95.00 

Round   7, Train loss: 0.001, Test loss: 0.504, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.616, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.089, Train accuracy: 96.000, Test loss: 2.019, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.146, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 0.189, Test accuracy: 94.00 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.240, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.147, Test accuracy: 96.50 

Round   8, Train loss: 0.023, Test loss: 0.470, Test accuracy: 90.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.364, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.150, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.143, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.182, Test accuracy: 95.50 

Round   9, Train loss: 0.002, Test loss: 0.483, Test accuracy: 89.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.570, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.563, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.263, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.599, Test accuracy: 75.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.160, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.164, Test accuracy: 97.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.191, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.183, Test accuracy: 94.50 

Round  10, Train loss: 0.001, Test loss: 0.510, Test accuracy: 89.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.601, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.149, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.143, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.129, Test accuracy: 95.50 

Round  11, Train loss: 0.001, Test loss: 0.469, Test accuracy: 90.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.582, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 87.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.880, Test accuracy: 71.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.152, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.181, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.146, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 94.50 

Round  12, Train loss: 0.001, Test loss: 0.514, Test accuracy: 89.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.614, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.466, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.171, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.136, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.170, Test accuracy: 95.50 

Round  13, Train loss: 0.002, Test loss: 0.541, Test accuracy: 89.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.628, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.599, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.148, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.182, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.196, Test accuracy: 96.00 

Round  14, Train loss: 0.003, Test loss: 0.510, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.612, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 79.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.171, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.121, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.152, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.130, Test accuracy: 96.50 

Round  15, Train loss: 0.003, Test loss: 0.478, Test accuracy: 90.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.568, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.835, Test accuracy: 73.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 92.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.133, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.136, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 96.50 

Round  16, Train loss: 0.000, Test loss: 0.554, Test accuracy: 89.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.579, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.453, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.522, Test accuracy: 76.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.141, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.119, Test accuracy: 96.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.179, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 95.00 

Round  17, Train loss: 0.000, Test loss: 0.535, Test accuracy: 90.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.599, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.150, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.141, Test accuracy: 97.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.151, Test accuracy: 97.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 94.00 

Round  18, Train loss: 0.000, Test loss: 0.533, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.545, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.821, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.153, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.138, Test accuracy: 97.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.168, Test accuracy: 97.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 96.00 

Round  19, Train loss: 0.000, Test loss: 0.522, Test accuracy: 89.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.449, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.155, Test accuracy: 96.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.207, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 95.00 

Final Round, Train loss: 0.000, Test loss: 0.527, Test accuracy: 89.60 

Average accuracy final 10 rounds: 433.2816666666667 

1954.717628479004
[6.114645481109619, 12.010986089706421, 17.939141511917114, 23.635950088500977, 29.992507457733154, 36.1161105632782, 42.32365608215332, 48.83076548576355, 54.93630361557007, 61.27424621582031, 67.42844009399414, 73.39224910736084, 79.27878785133362, 85.06311392784119, 90.98896312713623, 96.84006261825562, 102.77532815933228, 108.86484146118164, 114.72624945640564, 120.65518093109131, 123.86439490318298, 129.9624960422516, 136.46278023719788, 142.61014771461487, 148.6090795993805, 154.55532598495483, 160.47917795181274, 166.65604496002197, 173.06958484649658, 179.1665141582489, 185.52693700790405, 191.7735104560852, 198.0474877357483, 204.45432090759277, 210.79813861846924, 216.78081822395325, 222.95571494102478, 228.93036484718323, 235.033709526062, 241.08344078063965, 246.9928698539734, 250.54910159111023, 256.7139868736267, 262.8345606327057, 269.23057675361633, 275.33668971061707, 281.1868305206299, 287.1538755893707, 293.15243268013, 299.36224365234375, 305.98816680908203, 312.2003767490387, 318.280437707901, 324.19972681999207, 330.47979855537415, 336.70536184310913, 342.7127859592438, 348.92100739479065, 355.35548543930054, 361.3837411403656, 367.7386255264282, 373.93353295326233, 377.8384783267975, 384.1832900047302, 390.45843958854675, 396.9517946243286, 403.3407392501831, 409.588680267334, 415.6302502155304, 421.97427248954773, 428.2564022541046, 434.602965593338, 440.751318693161, 446.87646412849426, 453.21986746788025, 459.1384382247925, 465.28666162490845, 471.842577457428, 478.0740385055542, 484.25293946266174, 490.6106197834015, 497.074951171875, 503.4982807636261, 506.9950089454651, 513.5123887062073, 519.767739534378, 526.0968487262726, 532.2313067913055, 538.7184498310089, 545.497533082962, 551.9925491809845, 558.4083626270294, 564.7888236045837, 571.1900491714478, 577.365097284317, 583.5175881385803, 589.9237298965454, 596.2280690670013, 602.6018087863922, 609.3458626270294, 615.5009760856628, 621.7033939361572, 628.1570250988007, 634.5089902877808, 637.964546918869]
[87.5, 88.0, 84.0, 89.5, 89.0, 88.5, 93.0, 88.0, 90.0, 89.5, 90.0, 87.0, 88.0, 88.0, 85.0, 91.5, 91.0, 89.5, 88.5, 89.5, 89.5, 79.5, 82.75, 80.0, 81.5, 80.5, 80.75, 80.75, 81.5, 84.25, 79.75, 79.75, 82.5, 82.25, 81.0, 80.75, 81.75, 82.25, 80.25, 80.25, 80.5, 79.5, 84.33333333333333, 85.16666666666667, 84.83333333333333, 85.83333333333333, 81.0, 83.83333333333333, 84.5, 85.66666666666667, 85.33333333333333, 86.33333333333333, 84.33333333333333, 80.5, 81.83333333333333, 84.5, 85.0, 85.5, 85.66666666666667, 86.0, 86.33333333333333, 87.0, 87.16666666666667, 88.25, 87.875, 88.25, 88.125, 88.0, 88.0, 87.5, 88.375, 89.25, 88.625, 88.75, 89.25, 88.125, 88.25, 88.75, 89.125, 88.875, 88.25, 88.875, 89.25, 89.625, 90.0, 90.1, 89.8, 90.4, 89.9, 90.0, 89.0, 89.5, 90.8, 89.2, 89.2, 90.2, 89.6, 89.4, 90.5, 90.6, 89.8, 90.2, 90.0, 89.9, 89.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.563, Test loss: 0.485, Test accuracy: 81.00 

Round   0, Global train loss: 0.563, Global test loss: 0.814, Global test accuracy: 50.50 

Round   1, Train loss: 0.475, Test loss: 0.469, Test accuracy: 85.60 

Round   1, Global train loss: 0.475, Global test loss: 0.783, Global test accuracy: 54.30 

Round   2, Train loss: 0.435, Test loss: 0.579, Test accuracy: 77.20 

Round   2, Global train loss: 0.435, Global test loss: 0.780, Global test accuracy: 54.80 

Round   3, Train loss: 0.394, Test loss: 0.440, Test accuracy: 84.10 

Round   3, Global train loss: 0.394, Global test loss: 0.842, Global test accuracy: 56.40 

Round   4, Train loss: 0.367, Test loss: 0.459, Test accuracy: 85.30 

Round   4, Global train loss: 0.367, Global test loss: 0.658, Global test accuracy: 61.70 

Round   5, Train loss: 0.351, Test loss: 0.507, Test accuracy: 84.60 

Round   5, Global train loss: 0.351, Global test loss: 0.647, Global test accuracy: 65.30 

Round   6, Train loss: 0.330, Test loss: 0.500, Test accuracy: 82.80 

Round   6, Global train loss: 0.330, Global test loss: 0.705, Global test accuracy: 61.10 

Round   7, Train loss: 0.325, Test loss: 0.486, Test accuracy: 84.00 

Round   7, Global train loss: 0.325, Global test loss: 0.621, Global test accuracy: 67.80 

Round   8, Train loss: 0.285, Test loss: 0.485, Test accuracy: 84.50 

Round   8, Global train loss: 0.285, Global test loss: 0.638, Global test accuracy: 66.80 

Round   9, Train loss: 0.281, Test loss: 0.481, Test accuracy: 86.20 

Round   9, Global train loss: 0.281, Global test loss: 0.645, Global test accuracy: 67.10 

Round  10, Train loss: 0.259, Test loss: 0.396, Test accuracy: 86.00 

Round  10, Global train loss: 0.259, Global test loss: 0.677, Global test accuracy: 65.60 

Round  11, Train loss: 0.256, Test loss: 0.385, Test accuracy: 88.00 

Round  11, Global train loss: 0.256, Global test loss: 0.684, Global test accuracy: 64.10 

Round  12, Train loss: 0.261, Test loss: 0.413, Test accuracy: 84.90 

Round  12, Global train loss: 0.261, Global test loss: 0.648, Global test accuracy: 67.00 

Round  13, Train loss: 0.229, Test loss: 0.585, Test accuracy: 87.10 

Round  13, Global train loss: 0.229, Global test loss: 0.662, Global test accuracy: 67.00 

Round  14, Train loss: 0.214, Test loss: 0.487, Test accuracy: 85.60 

Round  14, Global train loss: 0.214, Global test loss: 0.648, Global test accuracy: 68.20 

Round  15, Train loss: 0.200, Test loss: 0.396, Test accuracy: 87.10 

Round  15, Global train loss: 0.200, Global test loss: 0.630, Global test accuracy: 67.90 

Round  16, Train loss: 0.191, Test loss: 0.613, Test accuracy: 87.10 

Round  16, Global train loss: 0.191, Global test loss: 0.697, Global test accuracy: 67.60 

Round  17, Train loss: 0.195, Test loss: 0.461, Test accuracy: 87.40 

Round  17, Global train loss: 0.195, Global test loss: 0.733, Global test accuracy: 66.80 

Round  18, Train loss: 0.173, Test loss: 0.357, Test accuracy: 88.70 

Round  18, Global train loss: 0.173, Global test loss: 0.777, Global test accuracy: 66.50 

Round  19, Train loss: 0.191, Test loss: 0.383, Test accuracy: 86.80 

Round  19, Global train loss: 0.191, Global test loss: 0.620, Global test accuracy: 69.80 

Round  20, Train loss: 0.169, Test loss: 0.466, Test accuracy: 86.90 

Round  20, Global train loss: 0.169, Global test loss: 0.697, Global test accuracy: 70.80 

Round  21, Train loss: 0.168, Test loss: 0.483, Test accuracy: 85.00 

Round  21, Global train loss: 0.168, Global test loss: 0.704, Global test accuracy: 68.60 

Round  22, Train loss: 0.148, Test loss: 0.525, Test accuracy: 85.40 

Round  22, Global train loss: 0.148, Global test loss: 0.701, Global test accuracy: 69.40 

Round  23, Train loss: 0.129, Test loss: 0.380, Test accuracy: 88.30 

Round  23, Global train loss: 0.129, Global test loss: 0.878, Global test accuracy: 65.40 

Round  24, Train loss: 0.131, Test loss: 0.560, Test accuracy: 86.40 

Round  24, Global train loss: 0.131, Global test loss: 0.706, Global test accuracy: 71.10 

Round  25, Train loss: 0.112, Test loss: 0.385, Test accuracy: 88.90 

Round  25, Global train loss: 0.112, Global test loss: 0.743, Global test accuracy: 69.90 

Round  26, Train loss: 0.151, Test loss: 0.349, Test accuracy: 88.40 

Round  26, Global train loss: 0.151, Global test loss: 0.723, Global test accuracy: 69.10 

Round  27, Train loss: 0.110, Test loss: 0.374, Test accuracy: 88.20 

Round  27, Global train loss: 0.110, Global test loss: 0.768, Global test accuracy: 68.80 

Round  28, Train loss: 0.101, Test loss: 0.446, Test accuracy: 86.00 

Round  28, Global train loss: 0.101, Global test loss: 0.919, Global test accuracy: 65.90 

Round  29, Train loss: 0.101, Test loss: 0.378, Test accuracy: 87.80 

Round  29, Global train loss: 0.101, Global test loss: 0.855, Global test accuracy: 69.40 

Round  30, Train loss: 0.112, Test loss: 0.458, Test accuracy: 85.90 

Round  30, Global train loss: 0.112, Global test loss: 1.004, Global test accuracy: 63.80 

Round  31, Train loss: 0.093, Test loss: 0.379, Test accuracy: 88.80 

Round  31, Global train loss: 0.093, Global test loss: 0.775, Global test accuracy: 70.30 

Round  32, Train loss: 0.090, Test loss: 0.375, Test accuracy: 88.00 

Round  32, Global train loss: 0.090, Global test loss: 0.794, Global test accuracy: 69.90 

Round  33, Train loss: 0.102, Test loss: 0.537, Test accuracy: 87.40 

Round  33, Global train loss: 0.102, Global test loss: 0.943, Global test accuracy: 68.30 

Round  34, Train loss: 0.100, Test loss: 0.389, Test accuracy: 89.30 

Round  34, Global train loss: 0.100, Global test loss: 1.042, Global test accuracy: 66.00 

Final Round, Train loss: 0.078, Test loss: 0.399, Test accuracy: 89.20 

Final Round, Global train loss: 0.078, Global test loss: 1.042, Global test accuracy: 66.00 

Average accuracy final 10 rounds: 87.86999999999998 

Average global accuracy final 10 rounds: 68.14 

472.33939814567566
[4.33155083656311, 6.759554147720337, 9.20310354232788, 11.505975484848022, 13.951189279556274, 16.26349711418152, 18.579349040985107, 21.024623155593872, 23.298836708068848, 25.554028272628784, 27.85068988800049, 30.15768337249756, 32.41204285621643, 34.68542838096619, 36.969151973724365, 39.53366994857788, 41.7719988822937, 44.03489542007446, 46.31815719604492, 48.552815437316895, 50.9460175037384, 53.181729793548584, 55.418936252593994, 57.75991630554199, 60.370962142944336, 62.64168620109558, 65.21674275398254, 67.76958012580872, 70.20021557807922, 72.62263703346252, 74.93572068214417, 77.33738255500793, 79.6534492969513, 82.07230234146118, 84.36379194259644, 89.0331723690033]
[81.0, 85.6, 77.2, 84.1, 85.3, 84.6, 82.8, 84.0, 84.5, 86.2, 86.0, 88.0, 84.9, 87.1, 85.6, 87.1, 87.1, 87.4, 88.7, 86.8, 86.9, 85.0, 85.4, 88.3, 86.4, 88.9, 88.4, 88.2, 86.0, 87.8, 85.9, 88.8, 88.0, 87.4, 89.3, 89.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.641, Test loss: 1.123, Test accuracy: 52.10 

Round   1, Train loss: 0.540, Test loss: 1.144, Test accuracy: 59.90 

Round   2, Train loss: 0.457, Test loss: 0.552, Test accuracy: 73.70 

Round   3, Train loss: 0.472, Test loss: 0.908, Test accuracy: 63.60 

Round   4, Train loss: 0.418, Test loss: 0.446, Test accuracy: 79.30 

Round   5, Train loss: 0.394, Test loss: 0.471, Test accuracy: 78.50 

Round   6, Train loss: 0.349, Test loss: 0.437, Test accuracy: 80.20 

Round   7, Train loss: 0.339, Test loss: 0.369, Test accuracy: 85.20 

Round   8, Train loss: 0.335, Test loss: 0.396, Test accuracy: 84.20 

Round   9, Train loss: 0.309, Test loss: 0.362, Test accuracy: 84.00 

Round  10, Train loss: 0.303, Test loss: 0.443, Test accuracy: 80.50 

Round  11, Train loss: 0.292, Test loss: 0.320, Test accuracy: 86.40 

Round  12, Train loss: 0.276, Test loss: 0.306, Test accuracy: 87.60 

Round  13, Train loss: 0.254, Test loss: 0.298, Test accuracy: 88.40 

Round  14, Train loss: 0.252, Test loss: 0.407, Test accuracy: 85.00 

Round  15, Train loss: 0.247, Test loss: 0.305, Test accuracy: 88.30 

Round  16, Train loss: 0.221, Test loss: 0.297, Test accuracy: 88.70 

Round  17, Train loss: 0.223, Test loss: 0.336, Test accuracy: 86.40 

Round  18, Train loss: 0.210, Test loss: 0.332, Test accuracy: 88.30 

Round  19, Train loss: 0.204, Test loss: 0.327, Test accuracy: 87.40 

Round  20, Train loss: 0.182, Test loss: 0.348, Test accuracy: 87.80 

Round  21, Train loss: 0.182, Test loss: 0.297, Test accuracy: 88.30 

Round  22, Train loss: 0.173, Test loss: 0.281, Test accuracy: 89.90 

Round  23, Train loss: 0.169, Test loss: 0.274, Test accuracy: 90.10 

Round  24, Train loss: 0.158, Test loss: 0.362, Test accuracy: 85.80 

Round  25, Train loss: 0.162, Test loss: 0.304, Test accuracy: 89.20 

Round  26, Train loss: 0.150, Test loss: 0.327, Test accuracy: 87.00 

Round  27, Train loss: 0.136, Test loss: 0.331, Test accuracy: 88.40 

Round  28, Train loss: 0.146, Test loss: 0.287, Test accuracy: 90.10 

Round  29, Train loss: 0.147, Test loss: 0.354, Test accuracy: 88.60 

Round  30, Train loss: 0.118, Test loss: 0.300, Test accuracy: 89.20 

Round  31, Train loss: 0.126, Test loss: 0.472, Test accuracy: 85.00 

Round  32, Train loss: 0.122, Test loss: 0.390, Test accuracy: 86.00 

Round  33, Train loss: 0.100, Test loss: 0.305, Test accuracy: 88.80 

Round  34, Train loss: 0.104, Test loss: 0.325, Test accuracy: 89.50 

Round  35, Train loss: 0.097, Test loss: 0.318, Test accuracy: 89.60 

Round  36, Train loss: 0.101, Test loss: 0.336, Test accuracy: 88.40 

Round  37, Train loss: 0.080, Test loss: 0.317, Test accuracy: 89.80 

Round  38, Train loss: 0.088, Test loss: 0.358, Test accuracy: 88.10 

Round  39, Train loss: 0.077, Test loss: 0.311, Test accuracy: 90.20 

Round  40, Train loss: 0.059, Test loss: 0.348, Test accuracy: 88.90 

Round  41, Train loss: 0.068, Test loss: 0.314, Test accuracy: 89.50 

Round  42, Train loss: 0.062, Test loss: 0.362, Test accuracy: 89.00 

Round  43, Train loss: 0.069, Test loss: 0.325, Test accuracy: 89.10 

Round  44, Train loss: 0.066, Test loss: 0.353, Test accuracy: 88.70 

Round  45, Train loss: 0.060, Test loss: 0.370, Test accuracy: 88.60 

Round  46, Train loss: 0.057, Test loss: 0.332, Test accuracy: 90.20 

Round  47, Train loss: 0.054, Test loss: 0.344, Test accuracy: 88.00 

Round  48, Train loss: 0.046, Test loss: 0.315, Test accuracy: 90.20 

Round  49, Train loss: 0.061, Test loss: 0.328, Test accuracy: 89.30 

Final Round, Train loss: 0.030, Test loss: 0.361, Test accuracy: 89.10 

Average accuracy final 10 rounds: 89.15 

494.4559738636017
[3.779261589050293, 5.672966480255127, 7.687453508377075, 9.593786716461182, 11.394774436950684, 13.190723180770874, 15.028243780136108, 16.89850664138794, 18.834043264389038, 20.692939519882202, 22.486379623413086, 24.299463272094727, 26.128085613250732, 27.93986439704895, 29.70977783203125, 31.49095129966736, 33.29120445251465, 35.27128052711487, 37.00424814224243, 38.933587074279785, 40.80170702934265, 42.66660737991333, 44.5299813747406, 46.33646512031555, 48.213229179382324, 50.02704644203186, 51.918707847595215, 53.72928810119629, 55.524048805236816, 57.342862129211426, 59.15645217895508, 60.96568965911865, 62.922404766082764, 64.73892998695374, 66.82008290290833, 68.6592767238617, 70.41662096977234, 72.2560670375824, 74.15782976150513, 76.09407997131348, 77.98033046722412, 79.79186081886292, 81.60296535491943, 83.50811719894409, 85.56097435951233, 87.4562578201294, 89.23267364501953, 91.07583141326904, 92.93882918357849, 94.71808981895447, 96.64876127243042]
[52.1, 59.9, 73.7, 63.6, 79.3, 78.5, 80.2, 85.2, 84.2, 84.0, 80.5, 86.4, 87.6, 88.4, 85.0, 88.3, 88.7, 86.4, 88.3, 87.4, 87.8, 88.3, 89.9, 90.1, 85.8, 89.2, 87.0, 88.4, 90.1, 88.6, 89.2, 85.0, 86.0, 88.8, 89.5, 89.6, 88.4, 89.8, 88.1, 90.2, 88.9, 89.5, 89.0, 89.1, 88.7, 88.6, 90.2, 88.0, 90.2, 89.3, 89.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.700, Test loss: 1.525, Test accuracy: 54.90
Round   1, Train loss: 0.546, Test loss: 0.813, Test accuracy: 65.00
Round   2, Train loss: 0.505, Test loss: 0.799, Test accuracy: 62.70
Round   3, Train loss: 0.435, Test loss: 0.620, Test accuracy: 72.40
Round   4, Train loss: 0.409, Test loss: 0.432, Test accuracy: 79.50
Round   5, Train loss: 0.395, Test loss: 0.471, Test accuracy: 80.90
Round   6, Train loss: 0.394, Test loss: 0.953, Test accuracy: 64.80
Round   7, Train loss: 0.385, Test loss: 0.527, Test accuracy: 79.10
Round   8, Train loss: 0.335, Test loss: 0.484, Test accuracy: 79.90
Round   9, Train loss: 0.306, Test loss: 0.322, Test accuracy: 87.50
Round  10, Train loss: 0.303, Test loss: 0.475, Test accuracy: 81.30
Round  11, Train loss: 0.285, Test loss: 0.369, Test accuracy: 83.80
Round  12, Train loss: 0.275, Test loss: 0.371, Test accuracy: 83.10
Round  13, Train loss: 0.263, Test loss: 0.475, Test accuracy: 82.20
Round  14, Train loss: 0.242, Test loss: 0.325, Test accuracy: 86.40
Round  15, Train loss: 0.215, Test loss: 0.307, Test accuracy: 87.60
Round  16, Train loss: 0.228, Test loss: 0.347, Test accuracy: 86.10
Round  17, Train loss: 0.214, Test loss: 0.319, Test accuracy: 87.30
Round  18, Train loss: 0.221, Test loss: 0.312, Test accuracy: 88.10
Round  19, Train loss: 0.173, Test loss: 0.305, Test accuracy: 87.60
Round  20, Train loss: 0.182, Test loss: 0.314, Test accuracy: 88.10
Round  21, Train loss: 0.175, Test loss: 0.362, Test accuracy: 85.60
Round  22, Train loss: 0.179, Test loss: 0.270, Test accuracy: 89.30
Round  23, Train loss: 0.164, Test loss: 0.285, Test accuracy: 88.80
Round  24, Train loss: 0.163, Test loss: 0.359, Test accuracy: 85.90
Round  25, Train loss: 0.143, Test loss: 0.266, Test accuracy: 89.20
Round  26, Train loss: 0.144, Test loss: 0.306, Test accuracy: 88.70
Round  27, Train loss: 0.129, Test loss: 0.273, Test accuracy: 89.70
Round  28, Train loss: 0.117, Test loss: 0.321, Test accuracy: 88.40
Round  29, Train loss: 0.111, Test loss: 0.332, Test accuracy: 88.10
Round  30, Train loss: 0.116, Test loss: 0.308, Test accuracy: 88.90
Round  31, Train loss: 0.102, Test loss: 0.319, Test accuracy: 88.20
Round  32, Train loss: 0.115, Test loss: 0.290, Test accuracy: 89.40
Round  33, Train loss: 0.095, Test loss: 0.306, Test accuracy: 88.60
Round  34, Train loss: 0.096, Test loss: 0.309, Test accuracy: 88.10
Round  35, Train loss: 0.093, Test loss: 0.300, Test accuracy: 89.00
Round  36, Train loss: 0.073, Test loss: 0.322, Test accuracy: 88.80
Round  37, Train loss: 0.079, Test loss: 0.319, Test accuracy: 88.90
Round  38, Train loss: 0.067, Test loss: 0.299, Test accuracy: 90.10
Round  39, Train loss: 0.077, Test loss: 0.304, Test accuracy: 90.30
Round  40, Train loss: 0.087, Test loss: 0.297, Test accuracy: 90.00
Round  41, Train loss: 0.071, Test loss: 0.299, Test accuracy: 90.10
Round  42, Train loss: 0.076, Test loss: 0.307, Test accuracy: 90.00
Round  43, Train loss: 0.056, Test loss: 0.296, Test accuracy: 90.50
Round  44, Train loss: 0.054, Test loss: 0.312, Test accuracy: 90.00
Round  45, Train loss: 0.048, Test loss: 0.314, Test accuracy: 89.70
Round  46, Train loss: 0.055, Test loss: 0.308, Test accuracy: 89.80
Round  47, Train loss: 0.057, Test loss: 0.311, Test accuracy: 90.50
Round  48, Train loss: 0.038, Test loss: 0.334, Test accuracy: 89.70
Round  49, Train loss: 0.046, Test loss: 0.349, Test accuracy: 89.10
Final Round, Train loss: 0.029, Test loss: 0.333, Test accuracy: 89.90
Average accuracy final 10 rounds: 89.94
560.3787207603455
[4.241190195083618, 6.326895236968994, 8.387165546417236, 10.509550333023071, 12.601537942886353, 14.761482238769531, 17.00716543197632, 19.174025774002075, 21.344746589660645, 23.32335090637207, 25.721038818359375, 27.828643083572388, 30.02042555809021, 32.29977822303772, 34.463536500930786, 36.58358430862427, 38.675570249557495, 40.78221917152405, 42.927658557891846, 44.97082281112671, 47.16154336929321, 49.16921591758728, 51.271066427230835, 53.34323811531067, 55.39067268371582, 57.40342164039612, 59.50720524787903, 61.651649475097656, 63.716583251953125, 65.97768139839172, 68.14704203605652, 70.67783308029175, 72.69858884811401, 74.809002161026, 76.99780988693237, 79.12811470031738, 81.40562176704407, 83.52376317977905, 85.63710308074951, 87.78450131416321, 89.83785343170166, 91.94447827339172, 94.16909074783325, 96.32240915298462, 98.4463415145874, 100.57824730873108, 102.92425489425659, 105.06192564964294, 107.1408851146698, 109.2796528339386, 111.51442909240723]
[54.9, 65.0, 62.7, 72.4, 79.5, 80.9, 64.8, 79.1, 79.9, 87.5, 81.3, 83.8, 83.1, 82.2, 86.4, 87.6, 86.1, 87.3, 88.1, 87.6, 88.1, 85.6, 89.3, 88.8, 85.9, 89.2, 88.7, 89.7, 88.4, 88.1, 88.9, 88.2, 89.4, 88.6, 88.1, 89.0, 88.8, 88.9, 90.1, 90.3, 90.0, 90.1, 90.0, 90.5, 90.0, 89.7, 89.8, 90.5, 89.7, 89.1, 89.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.589, Test loss: 0.763, Test accuracy: 80.90 

Round   0, Global train loss: 0.589, Global test loss: 0.681, Global test accuracy: 56.80 

Round   1, Train loss: 0.392, Test loss: 0.410, Test accuracy: 86.80 

Round   1, Global train loss: 0.392, Global test loss: 0.914, Global test accuracy: 50.10 

Round   2, Train loss: 0.314, Test loss: 0.625, Test accuracy: 81.80 

Round   2, Global train loss: 0.314, Global test loss: 0.959, Global test accuracy: 50.00 

Round   3, Train loss: 0.226, Test loss: 0.515, Test accuracy: 84.30 

Round   3, Global train loss: 0.226, Global test loss: 0.989, Global test accuracy: 50.10 

Round   4, Train loss: 0.198, Test loss: 0.442, Test accuracy: 86.20 

Round   4, Global train loss: 0.198, Global test loss: 1.070, Global test accuracy: 50.00 

Round   5, Train loss: 0.189, Test loss: 0.445, Test accuracy: 88.10 

Round   5, Global train loss: 0.189, Global test loss: 1.009, Global test accuracy: 50.00 

Round   6, Train loss: 0.155, Test loss: 0.364, Test accuracy: 89.80 

Round   6, Global train loss: 0.155, Global test loss: 0.914, Global test accuracy: 50.00 

Round   7, Train loss: 0.130, Test loss: 0.333, Test accuracy: 89.70 

Round   7, Global train loss: 0.130, Global test loss: 1.118, Global test accuracy: 50.00 

Round   8, Train loss: 0.111, Test loss: 0.385, Test accuracy: 89.90 

Round   8, Global train loss: 0.111, Global test loss: 1.251, Global test accuracy: 50.00 

Round   9, Train loss: 0.137, Test loss: 0.375, Test accuracy: 89.40 

Round   9, Global train loss: 0.137, Global test loss: 1.124, Global test accuracy: 50.00 

Round  10, Train loss: 0.080, Test loss: 0.392, Test accuracy: 89.10 

Round  10, Global train loss: 0.080, Global test loss: 1.269, Global test accuracy: 50.00 

Round  11, Train loss: 0.085, Test loss: 0.381, Test accuracy: 87.50 

Round  11, Global train loss: 0.085, Global test loss: 1.302, Global test accuracy: 50.00 

Round  12, Train loss: 0.076, Test loss: 0.429, Test accuracy: 88.10 

Round  12, Global train loss: 0.076, Global test loss: 1.273, Global test accuracy: 50.00 

Round  13, Train loss: 0.089, Test loss: 0.437, Test accuracy: 89.80 

Round  13, Global train loss: 0.089, Global test loss: 1.005, Global test accuracy: 50.00 

Round  14, Train loss: 0.049, Test loss: 0.431, Test accuracy: 89.10 

Round  14, Global train loss: 0.049, Global test loss: 1.147, Global test accuracy: 50.00 

Round  15, Train loss: 0.043, Test loss: 0.431, Test accuracy: 90.10 

Round  15, Global train loss: 0.043, Global test loss: 1.253, Global test accuracy: 50.00 

Round  16, Train loss: 0.044, Test loss: 0.408, Test accuracy: 90.70 

Round  16, Global train loss: 0.044, Global test loss: 1.306, Global test accuracy: 50.00 

Round  17, Train loss: 0.037, Test loss: 0.417, Test accuracy: 90.90 

Round  17, Global train loss: 0.037, Global test loss: 1.385, Global test accuracy: 50.00 

Round  18, Train loss: 0.031, Test loss: 0.462, Test accuracy: 88.90 

Round  18, Global train loss: 0.031, Global test loss: 1.464, Global test accuracy: 50.00 

Round  19, Train loss: 0.029, Test loss: 0.414, Test accuracy: 91.10 

Round  19, Global train loss: 0.029, Global test loss: 1.311, Global test accuracy: 50.00 

Round  20, Train loss: 0.035, Test loss: 0.558, Test accuracy: 89.10 

Round  20, Global train loss: 0.035, Global test loss: 1.339, Global test accuracy: 50.00 

Round  21, Train loss: 0.032, Test loss: 0.445, Test accuracy: 90.70 

Round  21, Global train loss: 0.032, Global test loss: 1.229, Global test accuracy: 50.00 

Round  22, Train loss: 0.023, Test loss: 0.542, Test accuracy: 87.90 

Round  22, Global train loss: 0.023, Global test loss: 1.477, Global test accuracy: 50.00 

Round  23, Train loss: 0.050, Test loss: 0.428, Test accuracy: 90.60 

Round  23, Global train loss: 0.050, Global test loss: 1.406, Global test accuracy: 50.00 

Round  24, Train loss: 0.018, Test loss: 0.436, Test accuracy: 91.40 

Round  24, Global train loss: 0.018, Global test loss: 1.465, Global test accuracy: 50.00 

Round  25, Train loss: 0.019, Test loss: 0.380, Test accuracy: 92.00 

Round  25, Global train loss: 0.019, Global test loss: 1.583, Global test accuracy: 50.00 

Round  26, Train loss: 0.021, Test loss: 0.432, Test accuracy: 91.60 

Round  26, Global train loss: 0.021, Global test loss: 1.537, Global test accuracy: 50.00 

Round  27, Train loss: 0.013, Test loss: 0.438, Test accuracy: 92.10 

Round  27, Global train loss: 0.013, Global test loss: 1.548, Global test accuracy: 50.00 

Round  28, Train loss: 0.031, Test loss: 0.374, Test accuracy: 90.30 

Round  28, Global train loss: 0.031, Global test loss: 1.476, Global test accuracy: 50.00 

Round  29, Train loss: 0.025, Test loss: 0.358, Test accuracy: 90.70 

Round  29, Global train loss: 0.025, Global test loss: 1.578, Global test accuracy: 50.00 

Round  30, Train loss: 0.011, Test loss: 0.396, Test accuracy: 91.10 

Round  30, Global train loss: 0.011, Global test loss: 1.518, Global test accuracy: 50.00 

Round  31, Train loss: 0.008, Test loss: 0.398, Test accuracy: 91.40 

Round  31, Global train loss: 0.008, Global test loss: 1.632, Global test accuracy: 50.00 

Round  32, Train loss: 0.012, Test loss: 0.479, Test accuracy: 90.00 

Round  32, Global train loss: 0.012, Global test loss: 1.642, Global test accuracy: 50.00 

Round  33, Train loss: 0.014, Test loss: 0.458, Test accuracy: 89.60 

Round  33, Global train loss: 0.014, Global test loss: 1.494, Global test accuracy: 50.00 

Round  34, Train loss: 0.014, Test loss: 0.410, Test accuracy: 91.80 

Round  34, Global train loss: 0.014, Global test loss: 1.729, Global test accuracy: 50.00 

Final Round, Train loss: 0.011, Test loss: 0.435, Test accuracy: 90.50 

Final Round, Global train loss: 0.011, Global test loss: 1.729, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 91.06 

Average global accuracy final 10 rounds: 50.0 

475.3747036457062
[4.489410877227783, 6.788201808929443, 9.019173622131348, 11.295151472091675, 13.749027729034424, 16.153440713882446, 18.492186784744263, 20.758445262908936, 23.10262441635132, 25.4805006980896, 28.16450047492981, 30.466402292251587, 33.00561714172363, 35.3200888633728, 37.57417106628418, 39.82521724700928, 42.219974994659424, 44.48059034347534, 46.95332908630371, 49.23993515968323, 51.538569927215576, 53.81029963493347, 56.09162402153015, 58.570393085479736, 61.00535202026367, 63.26995635032654, 65.58150482177734, 67.9088442325592, 70.17785048484802, 72.571298122406, 74.97983908653259, 77.47621059417725, 79.90569257736206, 82.29617500305176, 84.64366364479065, 89.40504360198975]
[80.9, 86.8, 81.8, 84.3, 86.2, 88.1, 89.8, 89.7, 89.9, 89.4, 89.1, 87.5, 88.1, 89.8, 89.1, 90.1, 90.7, 90.9, 88.9, 91.1, 89.1, 90.7, 87.9, 90.6, 91.4, 92.0, 91.6, 92.1, 90.3, 90.7, 91.1, 91.4, 90.0, 89.6, 91.8, 90.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.106, Train accuracy: 96.000, Test loss: 0.472, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.071, Train accuracy: 96.500, Test loss: 0.537, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 89.50 

Round   0, Train loss: 0.026, Test loss: 0.468, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 0.419, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.548, Test accuracy: 87.00 

Round   1, Train loss: 0.017, Test loss: 0.548, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.413, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.075, Train accuracy: 98.500, Test loss: 0.637, Test accuracy: 88.50 

Round   2, Train loss: 0.075, Test loss: 0.637, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 98.500, Test loss: 0.554, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.631, Test accuracy: 88.00 

Round   3, Train loss: 0.021, Test loss: 0.631, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.523, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.514, Test accuracy: 88.50 

Round   4, Train loss: 0.007, Test loss: 0.514, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.102, Train accuracy: 95.500, Test loss: 0.901, Test accuracy: 81.00 

Round   5, Train loss: 0.102, Test loss: 0.901, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.337, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 89.50 

Round   6, Train loss: 0.001, Test loss: 0.489, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 92.50 

Round   7, Train loss: 0.001, Test loss: 0.467, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 91.00 

Round   8, Train loss: 0.000, Test loss: 0.453, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 86.00 

Round   9, Train loss: 0.019, Test loss: 0.855, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.585, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 88.50 

Round  10, Train loss: 0.006, Test loss: 0.539, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 88.50 

Round  11, Train loss: 0.000, Test loss: 0.555, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.519, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 91.50 

Round  12, Train loss: 0.005, Test loss: 0.445, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.486, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 88.00 

Round  13, Train loss: 0.002, Test loss: 0.611, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 92.00 

Round  14, Train loss: 0.001, Test loss: 0.391, Test accuracy: 92.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.436, Test accuracy: 89.50 

Round  15, Train loss: 0.002, Test loss: 0.436, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 89.50 

Round  16, Train loss: 0.000, Test loss: 0.450, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 90.50 

Round  17, Train loss: 0.000, Test loss: 0.469, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.429, Test accuracy: 90.50 

Round  18, Train loss: 0.005, Test loss: 0.429, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 90.00 

Round  19, Train loss: 0.000, Test loss: 0.504, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 89.50 

Final Round, Train loss: 0.000, Test loss: 0.479, Test accuracy: 89.50 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.411, Train accuracy: 82.500, Test loss: 0.430, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.389, Train accuracy: 82.000, Test loss: 0.388, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.085, Train accuracy: 96.500, Test loss: 0.296, Test accuracy: 91.00 

Round   0, Train loss: 0.043, Test loss: 0.477, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.699, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.517, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.110, Train accuracy: 95.000, Test loss: 0.252, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.085, Train accuracy: 96.000, Test loss: 0.424, Test accuracy: 89.00 

Round   1, Train loss: 0.043, Test loss: 0.363, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.000, Test loss: 0.576, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.531, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.044, Train accuracy: 99.500, Test loss: 0.251, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 91.00 

Round   2, Train loss: 0.005, Test loss: 0.386, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.640, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.641, Test accuracy: 86.50 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.294, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.456, Test accuracy: 90.50 

Round   3, Train loss: 0.017, Test loss: 0.417, Test accuracy: 87.75 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 0.670, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 92.50 

Round   4, Train loss: 0.020, Test loss: 0.410, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 89.00 

        train local model (freeze embeding):client   1,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 0.291, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.218, Test accuracy: 93.00 

Round   5, Train loss: 0.012, Test loss: 0.366, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.300, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.291, Test accuracy: 92.00 

Round   6, Train loss: 0.016, Test loss: 0.353, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.282, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.178, Test accuracy: 94.00 

Round   7, Train loss: 0.002, Test loss: 0.347, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.264, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.284, Test accuracy: 91.50 

Round   8, Train loss: 0.003, Test loss: 0.359, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.180, Test accuracy: 96.50 

Round   9, Train loss: 0.002, Test loss: 0.316, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 91.50 

Round  10, Train loss: 0.003, Test loss: 0.307, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.244, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 93.50 

Round  11, Train loss: 0.000, Test loss: 0.327, Test accuracy: 90.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.247, Test accuracy: 92.50 

Round  12, Train loss: 0.001, Test loss: 0.348, Test accuracy: 90.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.463, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 93.50 

Round  13, Train loss: 0.001, Test loss: 0.319, Test accuracy: 91.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 94.50 

Round  14, Train loss: 0.000, Test loss: 0.356, Test accuracy: 91.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.271, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 91.50 

Round  15, Train loss: 0.000, Test loss: 0.356, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 91.50 

Round  16, Train loss: 0.003, Test loss: 0.395, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.390, Test accuracy: 90.00 

Round  17, Train loss: 0.010, Test loss: 0.429, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.486, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 94.50 

Round  18, Train loss: 0.000, Test loss: 0.371, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 94.50 

Round  19, Train loss: 0.001, Test loss: 0.383, Test accuracy: 90.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.461, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 87.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.222, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.237, Test accuracy: 92.50 

Final Round, Train loss: 0.001, Test loss: 0.379, Test accuracy: 90.75 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.356, Train accuracy: 83.000, Test loss: 0.590, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.223, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.329, Train accuracy: 85.000, Test loss: 0.626, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 98.500, Test loss: 0.640, Test accuracy: 83.00 

Round   0, Train loss: 0.015, Test loss: 0.454, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.284, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.143, Train accuracy: 95.500, Test loss: 0.488, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.226, Train accuracy: 88.500, Test loss: 0.845, Test accuracy: 76.50 

Round   1, Train loss: 0.077, Test loss: 0.527, Test accuracy: 85.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.201, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.215, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.122, Train accuracy: 95.000, Test loss: 0.567, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 0.834, Test accuracy: 86.50 

Round   2, Train loss: 0.016, Test loss: 0.517, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.218, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.234, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.070, Train accuracy: 98.500, Test loss: 0.595, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.578, Test accuracy: 85.50 

Round   3, Train loss: 0.010, Test loss: 0.451, Test accuracy: 88.17 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.193, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.023, Train accuracy: 100.000, Test loss: 0.568, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.700, Test accuracy: 85.00 

Round   4, Train loss: 0.005, Test loss: 0.450, Test accuracy: 89.33 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.238, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.500, Test loss: 0.574, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.820, Test accuracy: 85.50 

Round   5, Train loss: 0.007, Test loss: 0.411, Test accuracy: 88.83 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.206, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.060, Train accuracy: 98.500, Test loss: 0.521, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.674, Test accuracy: 85.50 

Round   6, Train loss: 0.006, Test loss: 0.496, Test accuracy: 88.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.563, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.186, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.580, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.543, Test accuracy: 83.00 

Round   7, Train loss: 0.007, Test loss: 0.408, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.550, Test accuracy: 90.50 

Round   8, Train loss: 0.013, Test loss: 0.473, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.213, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.520, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.612, Test accuracy: 85.00 

Round   9, Train loss: 0.002, Test loss: 0.418, Test accuracy: 89.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.176, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.556, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.596, Test accuracy: 86.50 

Round  10, Train loss: 0.001, Test loss: 0.392, Test accuracy: 90.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.195, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.177, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.592, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.703, Test accuracy: 84.00 

Round  11, Train loss: 0.006, Test loss: 0.468, Test accuracy: 89.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.249, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 84.00 

Round  12, Train loss: 0.003, Test loss: 0.506, Test accuracy: 89.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.240, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.336, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.571, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 83.50 

Round  13, Train loss: 0.003, Test loss: 0.472, Test accuracy: 88.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.655, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 80.50 

Round  14, Train loss: 0.004, Test loss: 0.479, Test accuracy: 88.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.178, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.650, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.688, Test accuracy: 85.00 

Round  15, Train loss: 0.000, Test loss: 0.463, Test accuracy: 88.33 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.217, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.633, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 83.00 

Round  16, Train loss: 0.003, Test loss: 0.447, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.537, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.413, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.723, Test accuracy: 85.50 

Round  17, Train loss: 0.005, Test loss: 0.529, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.242, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.679, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 87.00 

Round  18, Train loss: 0.001, Test loss: 0.479, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.471, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.251, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.607, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.838, Test accuracy: 81.50 

Round  19, Train loss: 0.005, Test loss: 0.449, Test accuracy: 88.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.630, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.627, Test accuracy: 84.50 

Final Round, Train loss: 0.001, Test loss: 0.431, Test accuracy: 89.00 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.360, Train accuracy: 86.000, Test loss: 0.426, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.652, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.320, Train accuracy: 85.500, Test loss: 0.370, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.349, Test accuracy: 90.50 

Round   0, Train loss: 0.005, Test loss: 0.514, Test accuracy: 88.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.737, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.277, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.764, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.740, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.208, Train accuracy: 91.500, Test loss: 0.417, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.035, Train accuracy: 99.500, Test loss: 0.290, Test accuracy: 91.50 

Round   1, Train loss: 0.011, Test loss: 0.502, Test accuracy: 87.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.775, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.708, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.085, Train accuracy: 97.000, Test loss: 0.411, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 89.50 

Round   2, Train loss: 0.001, Test loss: 0.532, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.521, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.640, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.061, Train accuracy: 97.500, Test loss: 0.456, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 90.50 

Round   3, Train loss: 0.003, Test loss: 0.514, Test accuracy: 88.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.772, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.679, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.048, Train accuracy: 98.000, Test loss: 0.442, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.420, Test accuracy: 90.50 

Round   4, Train loss: 0.005, Test loss: 0.449, Test accuracy: 89.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.573, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.255, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.652, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.061, Train accuracy: 97.000, Test loss: 0.404, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 90.00 

Round   5, Train loss: 0.004, Test loss: 0.449, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.208, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.907, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.500, Test loss: 0.401, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 92.00 

Round   6, Train loss: 0.004, Test loss: 0.496, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.715, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.370, Test accuracy: 92.00 

Round   7, Train loss: 0.004, Test loss: 0.469, Test accuracy: 90.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.471, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.635, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.426, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 89.00 

Round   8, Train loss: 0.002, Test loss: 0.464, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.326, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.439, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 90.00 

Round   9, Train loss: 0.002, Test loss: 0.483, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.519, Test accuracy: 88.50 

Round  10, Train loss: 0.001, Test loss: 0.507, Test accuracy: 89.75 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.778, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.557, Test accuracy: 88.50 

Round  11, Train loss: 0.003, Test loss: 0.495, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.094, Train accuracy: 95.500, Test loss: 0.599, Test accuracy: 88.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.302, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.672, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.760, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.535, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 90.50 

Round  12, Train loss: 0.024, Test loss: 0.538, Test accuracy: 86.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.399, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.552, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.521, Test accuracy: 90.50 

Round  13, Train loss: 0.000, Test loss: 0.521, Test accuracy: 88.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 88.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.651, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 1.256, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.050, Train accuracy: 98.000, Test loss: 0.703, Test accuracy: 84.50 

Round  14, Train loss: 0.014, Test loss: 0.639, Test accuracy: 87.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 90.50 

Round  15, Train loss: 0.002, Test loss: 0.530, Test accuracy: 88.62 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 92.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.689, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.598, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 91.50 

Round  16, Train loss: 0.000, Test loss: 0.518, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.668, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.461, Test accuracy: 91.00 

Round  17, Train loss: 0.001, Test loss: 0.481, Test accuracy: 89.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.511, Test accuracy: 90.00 

Round  18, Train loss: 0.000, Test loss: 0.506, Test accuracy: 89.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.556, Test accuracy: 90.50 

Round  19, Train loss: 0.000, Test loss: 0.521, Test accuracy: 89.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.700, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 89.00 

Final Round, Train loss: 0.000, Test loss: 0.528, Test accuracy: 89.00 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.203, Train accuracy: 91.000, Test loss: 0.225, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 89.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.696, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.620, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.514, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.300, Train accuracy: 89.000, Test loss: 0.234, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 100.000, Test loss: 0.107, Test accuracy: 95.00 

Round   0, Train loss: 0.005, Test loss: 0.440, Test accuracy: 88.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.524, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.552, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.740, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.534, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.125, Train accuracy: 96.000, Test loss: 0.239, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.025, Train accuracy: 98.500, Test loss: 0.037, Test accuracy: 99.00 

Round   1, Train loss: 0.007, Test loss: 0.436, Test accuracy: 90.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 91.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.700, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.078, Train accuracy: 96.500, Test loss: 0.167, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 93.00 

Round   2, Train loss: 0.006, Test loss: 0.393, Test accuracy: 91.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.528, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.480, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.069, Train accuracy: 97.000, Test loss: 0.141, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.184, Test accuracy: 94.00 

Round   3, Train loss: 0.005, Test loss: 0.394, Test accuracy: 91.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.120, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.092, Test accuracy: 98.50 

Round   4, Train loss: 0.002, Test loss: 0.384, Test accuracy: 91.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.326, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.722, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.894, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.096, Test accuracy: 97.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 0.131, Test accuracy: 96.50 

Round   5, Train loss: 0.006, Test loss: 0.393, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.329, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.706, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.105, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.261, Test accuracy: 91.50 

Round   6, Train loss: 0.002, Test loss: 0.384, Test accuracy: 91.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.364, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 93.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.708, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.106, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 0.184, Test accuracy: 93.50 

Round   7, Train loss: 0.006, Test loss: 0.409, Test accuracy: 91.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.746, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.633, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.486, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.272, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.082, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.082, Test accuracy: 95.50 

Round   8, Train loss: 0.003, Test loss: 0.387, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.108, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.044, Train accuracy: 97.500, Test loss: 0.216, Test accuracy: 95.00 

Round   9, Train loss: 0.009, Test loss: 0.411, Test accuracy: 91.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.723, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.107, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 0.329, Test accuracy: 91.50 

Round  10, Train loss: 0.008, Test loss: 0.391, Test accuracy: 91.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.491, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.126, Train accuracy: 96.000, Test loss: 0.800, Test accuracy: 83.50 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.131, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.038, Train accuracy: 97.500, Test loss: 0.146, Test accuracy: 95.00 

Round  11, Train loss: 0.033, Test loss: 0.437, Test accuracy: 90.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 92.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.740, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.549, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 0.240, Test accuracy: 95.00 

Round  12, Train loss: 0.004, Test loss: 0.417, Test accuracy: 91.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 94.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.833, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.103, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.124, Test accuracy: 95.00 

Round  13, Train loss: 0.000, Test loss: 0.407, Test accuracy: 91.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 90.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.830, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.099, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.128, Test accuracy: 96.00 

Round  14, Train loss: 0.001, Test loss: 0.418, Test accuracy: 91.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.093, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.132, Test accuracy: 92.50 

Round  15, Train loss: 0.000, Test loss: 0.406, Test accuracy: 92.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.782, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.433, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.070, Test accuracy: 98.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.128, Test accuracy: 94.50 

Round  16, Train loss: 0.004, Test loss: 0.417, Test accuracy: 92.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 93.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.189, Train accuracy: 94.500, Test loss: 1.632, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.117, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.324, Train accuracy: 85.500, Test loss: 0.361, Test accuracy: 85.50 

Round  17, Train loss: 0.103, Test loss: 0.474, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.122, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.054, Test accuracy: 97.50 

Round  18, Train loss: 0.000, Test loss: 0.413, Test accuracy: 92.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 91.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.334, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.747, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 93.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.070, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.095, Test accuracy: 97.00 

Round  19, Train loss: 0.000, Test loss: 0.414, Test accuracy: 92.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.421, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 90.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.812, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.079, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.093, Test accuracy: 96.50 

Final Round, Train loss: 0.001, Test loss: 0.416, Test accuracy: 92.30 

Average accuracy final 10 rounds: 449.7450000000001 

1989.2112250328064
[5.972643613815308, 12.145200252532959, 18.110944032669067, 24.14810609817505, 30.03981637954712, 36.56790018081665, 42.70972990989685, 48.68135952949524, 54.68279814720154, 60.71133279800415, 67.21001434326172, 73.53487944602966, 79.71647787094116, 85.71954035758972, 91.6800811290741, 97.47711062431335, 103.16665649414062, 109.25901246070862, 115.24939370155334, 121.64604616165161, 125.66309428215027, 131.95546555519104, 138.0885374546051, 144.3341770172119, 150.5263795852661, 156.72853589057922, 163.11837482452393, 169.2546842098236, 175.46949124336243, 181.82628440856934, 187.90241265296936, 193.96457314491272, 200.4495348930359, 206.74117398262024, 212.95147037506104, 219.2072582244873, 225.4418065547943, 231.5292844772339, 237.90004134178162, 243.7920355796814, 250.13061952590942, 253.42436408996582, 259.6873848438263, 265.7431516647339, 272.0773992538452, 278.17603516578674, 284.53938007354736, 290.67774653434753, 296.9620990753174, 303.5696077346802, 310.0494873523712, 316.4189794063568, 322.60741925239563, 328.9417886734009, 335.1133003234863, 341.23501443862915, 347.67489767074585, 353.94001054763794, 360.3268780708313, 366.6293315887451, 372.86760425567627, 379.2750837802887, 382.96986413002014, 389.5925786495209, 395.9277231693268, 402.71940183639526, 408.9176654815674, 415.4031159877777, 421.5275971889496, 427.6761372089386, 434.17148661613464, 440.43328046798706, 446.48611283302307, 453.12515807151794, 459.87956166267395, 466.3462162017822, 472.6818130016327, 479.3237273693085, 485.4497072696686, 491.7142403125763, 498.1002514362335, 504.433331489563, 511.1114881038666, 514.8474996089935, 521.3230311870575, 527.7003393173218, 534.4642422199249, 540.7624359130859, 546.959564447403, 553.4050440788269, 559.6386926174164, 565.9066214561462, 572.0366103649139, 578.6218156814575, 585.4059419631958, 592.5053110122681, 598.9986433982849, 605.3182199001312, 611.7397639751434, 618.2163517475128, 624.6051061153412, 630.9836423397064, 637.6791841983795, 644.1485331058502, 648.185882806778]
[89.5, 87.0, 88.5, 88.0, 88.5, 81.0, 89.5, 92.5, 91.0, 86.0, 88.5, 88.5, 91.5, 88.0, 92.0, 89.5, 89.5, 90.5, 90.5, 90.0, 89.5, 84.25, 87.0, 87.25, 87.75, 86.0, 87.5, 88.75, 88.75, 89.5, 91.5, 90.5, 90.75, 90.75, 91.75, 91.25, 91.0, 89.25, 89.25, 91.0, 90.75, 90.75, 88.0, 85.83333333333333, 88.0, 88.16666666666667, 89.33333333333333, 88.83333333333333, 88.16666666666667, 90.5, 88.5, 89.66666666666667, 90.83333333333333, 89.33333333333333, 89.16666666666667, 88.83333333333333, 88.16666666666667, 88.33333333333333, 88.5, 89.5, 89.0, 88.83333333333333, 89.0, 88.875, 87.375, 88.25, 88.375, 89.875, 90.0, 89.25, 90.375, 90.0, 89.0, 89.75, 88.75, 86.625, 88.25, 87.625, 88.625, 89.25, 89.125, 89.375, 89.125, 89.0, 88.9, 90.0, 91.1, 91.6, 91.9, 91.5, 91.3, 91.1, 91.0, 91.3, 91.2, 90.1, 91.2, 91.7, 91.7, 92.0, 92.4, 91.0, 92.1, 92.3, 92.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.559, Test loss: 0.599, Test accuracy: 81.60 

Round   0, Global train loss: 0.559, Global test loss: 0.749, Global test accuracy: 50.30 

Round   1, Train loss: 0.480, Test loss: 0.462, Test accuracy: 85.00 

Round   1, Global train loss: 0.480, Global test loss: 0.655, Global test accuracy: 72.00 

Round   2, Train loss: 0.399, Test loss: 0.515, Test accuracy: 83.70 

Round   2, Global train loss: 0.399, Global test loss: 0.576, Global test accuracy: 78.20 

Round   3, Train loss: 0.369, Test loss: 0.702, Test accuracy: 83.40 

Round   3, Global train loss: 0.369, Global test loss: 0.523, Global test accuracy: 79.80 

Round   4, Train loss: 0.319, Test loss: 0.365, Test accuracy: 88.20 

Round   4, Global train loss: 0.319, Global test loss: 0.627, Global test accuracy: 78.30 

Round   5, Train loss: 0.312, Test loss: 0.330, Test accuracy: 87.50 

Round   5, Global train loss: 0.312, Global test loss: 0.638, Global test accuracy: 80.00 

Round   6, Train loss: 0.277, Test loss: 0.326, Test accuracy: 89.20 

Round   6, Global train loss: 0.277, Global test loss: 0.796, Global test accuracy: 76.00 

Round   7, Train loss: 0.262, Test loss: 0.415, Test accuracy: 88.30 

Round   7, Global train loss: 0.262, Global test loss: 0.521, Global test accuracy: 80.70 

Round   8, Train loss: 0.216, Test loss: 0.365, Test accuracy: 88.50 

Round   8, Global train loss: 0.216, Global test loss: 0.701, Global test accuracy: 79.10 

Round   9, Train loss: 0.239, Test loss: 0.326, Test accuracy: 89.30 

Round   9, Global train loss: 0.239, Global test loss: 0.593, Global test accuracy: 81.00 

Round  10, Train loss: 0.226, Test loss: 0.679, Test accuracy: 85.70 

Round  10, Global train loss: 0.226, Global test loss: 0.546, Global test accuracy: 81.50 

Round  11, Train loss: 0.193, Test loss: 0.343, Test accuracy: 90.30 

Round  11, Global train loss: 0.193, Global test loss: 0.605, Global test accuracy: 81.30 

Round  12, Train loss: 0.186, Test loss: 0.365, Test accuracy: 87.70 

Round  12, Global train loss: 0.186, Global test loss: 0.536, Global test accuracy: 83.60 

Round  13, Train loss: 0.176, Test loss: 0.305, Test accuracy: 90.50 

Round  13, Global train loss: 0.176, Global test loss: 0.684, Global test accuracy: 81.50 

Round  14, Train loss: 0.172, Test loss: 0.325, Test accuracy: 90.20 

Round  14, Global train loss: 0.172, Global test loss: 0.726, Global test accuracy: 81.00 

Round  15, Train loss: 0.157, Test loss: 0.307, Test accuracy: 89.70 

Round  15, Global train loss: 0.157, Global test loss: 0.661, Global test accuracy: 83.00 

Round  16, Train loss: 0.145, Test loss: 0.294, Test accuracy: 90.50 

Round  16, Global train loss: 0.145, Global test loss: 0.710, Global test accuracy: 80.50 

Round  17, Train loss: 0.122, Test loss: 0.328, Test accuracy: 89.00 

Round  17, Global train loss: 0.122, Global test loss: 0.701, Global test accuracy: 80.70 

Round  18, Train loss: 0.114, Test loss: 0.299, Test accuracy: 90.80 

Round  18, Global train loss: 0.114, Global test loss: 0.594, Global test accuracy: 83.80 

Round  19, Train loss: 0.126, Test loss: 0.297, Test accuracy: 90.80 

Round  19, Global train loss: 0.126, Global test loss: 0.613, Global test accuracy: 83.10 

Round  20, Train loss: 0.107, Test loss: 0.399, Test accuracy: 89.90 

Round  20, Global train loss: 0.107, Global test loss: 0.584, Global test accuracy: 82.70 

Round  21, Train loss: 0.107, Test loss: 0.348, Test accuracy: 92.10 

Round  21, Global train loss: 0.107, Global test loss: 0.732, Global test accuracy: 80.80 

Round  22, Train loss: 0.099, Test loss: 0.329, Test accuracy: 91.00 

Round  22, Global train loss: 0.099, Global test loss: 0.749, Global test accuracy: 80.90 

Round  23, Train loss: 0.107, Test loss: 0.342, Test accuracy: 89.80 

Round  23, Global train loss: 0.107, Global test loss: 0.657, Global test accuracy: 82.60 

Round  24, Train loss: 0.080, Test loss: 0.293, Test accuracy: 91.70 

Round  24, Global train loss: 0.080, Global test loss: 0.646, Global test accuracy: 82.50 

Round  25, Train loss: 0.094, Test loss: 0.306, Test accuracy: 91.20 

Round  25, Global train loss: 0.094, Global test loss: 0.743, Global test accuracy: 81.10 

Round  26, Train loss: 0.088, Test loss: 0.417, Test accuracy: 88.60 

Round  26, Global train loss: 0.088, Global test loss: 0.749, Global test accuracy: 81.50 

Round  27, Train loss: 0.075, Test loss: 0.317, Test accuracy: 90.30 

Round  27, Global train loss: 0.075, Global test loss: 0.777, Global test accuracy: 80.60 

Round  28, Train loss: 0.080, Test loss: 0.343, Test accuracy: 88.40 

Round  28, Global train loss: 0.080, Global test loss: 0.661, Global test accuracy: 81.40 

Round  29, Train loss: 0.077, Test loss: 0.420, Test accuracy: 90.00 

Round  29, Global train loss: 0.077, Global test loss: 0.793, Global test accuracy: 81.80 

Round  30, Train loss: 0.067, Test loss: 0.360, Test accuracy: 90.40 

Round  30, Global train loss: 0.067, Global test loss: 0.696, Global test accuracy: 82.80 

Round  31, Train loss: 0.066, Test loss: 0.326, Test accuracy: 91.30 

Round  31, Global train loss: 0.066, Global test loss: 0.760, Global test accuracy: 82.30 

Round  32, Train loss: 0.064, Test loss: 0.324, Test accuracy: 90.80 

Round  32, Global train loss: 0.064, Global test loss: 0.751, Global test accuracy: 82.20 

Round  33, Train loss: 0.058, Test loss: 0.425, Test accuracy: 89.40 

Round  33, Global train loss: 0.058, Global test loss: 0.685, Global test accuracy: 83.10 

Round  34, Train loss: 0.058, Test loss: 0.446, Test accuracy: 88.60 

Round  34, Global train loss: 0.058, Global test loss: 0.646, Global test accuracy: 83.10 

Final Round, Train loss: 0.056, Test loss: 0.352, Test accuracy: 91.90 

Final Round, Global train loss: 0.056, Global test loss: 0.646, Global test accuracy: 83.10 

Average accuracy final 10 rounds: 89.89999999999999 

Average global accuracy final 10 rounds: 81.99 

473.47161388397217
[4.236570358276367, 6.44542384147644, 8.77889347076416, 11.156596899032593, 13.428512573242188, 15.704146146774292, 17.940584659576416, 20.36211633682251, 22.781931161880493, 25.058619260787964, 27.34666109085083, 29.6170015335083, 31.980270862579346, 34.24342679977417, 36.62500739097595, 38.91760206222534, 41.19748616218567, 43.631853103637695, 45.919965744018555, 48.20351576805115, 50.56156396865845, 52.925931453704834, 55.34543466567993, 57.67674899101257, 59.983874559402466, 62.28097581863403, 64.8209638595581, 67.27123475074768, 69.84579539299011, 72.11889410018921, 74.36370730400085, 76.68871188163757, 79.16784691810608, 81.48364186286926, 83.71792888641357, 88.52931094169617]
[81.6, 85.0, 83.7, 83.4, 88.2, 87.5, 89.2, 88.3, 88.5, 89.3, 85.7, 90.3, 87.7, 90.5, 90.2, 89.7, 90.5, 89.0, 90.8, 90.8, 89.9, 92.1, 91.0, 89.8, 91.7, 91.2, 88.6, 90.3, 88.4, 90.0, 90.4, 91.3, 90.8, 89.4, 88.6, 91.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.706, Test loss: 0.903, Test accuracy: 53.00 

Round   1, Train loss: 0.559, Test loss: 0.909, Test accuracy: 68.50 

Round   2, Train loss: 0.508, Test loss: 0.549, Test accuracy: 73.10 

Round   3, Train loss: 0.428, Test loss: 0.575, Test accuracy: 73.60 

Round   4, Train loss: 0.422, Test loss: 0.632, Test accuracy: 77.10 

Round   5, Train loss: 0.407, Test loss: 0.578, Test accuracy: 77.20 

Round   6, Train loss: 0.390, Test loss: 0.551, Test accuracy: 74.20 

Round   7, Train loss: 0.342, Test loss: 0.422, Test accuracy: 84.60 

Round   8, Train loss: 0.320, Test loss: 0.441, Test accuracy: 83.10 

Round   9, Train loss: 0.320, Test loss: 0.634, Test accuracy: 78.30 

Round  10, Train loss: 0.311, Test loss: 0.387, Test accuracy: 86.20 

Round  11, Train loss: 0.284, Test loss: 0.417, Test accuracy: 83.50 

Round  12, Train loss: 0.244, Test loss: 0.335, Test accuracy: 87.40 

Round  13, Train loss: 0.288, Test loss: 0.322, Test accuracy: 88.30 

Round  14, Train loss: 0.238, Test loss: 0.356, Test accuracy: 86.50 

Round  15, Train loss: 0.209, Test loss: 0.343, Test accuracy: 87.10 

Round  16, Train loss: 0.213, Test loss: 0.365, Test accuracy: 87.40 

Round  17, Train loss: 0.201, Test loss: 0.350, Test accuracy: 88.30 

Round  18, Train loss: 0.190, Test loss: 0.345, Test accuracy: 86.50 

Round  19, Train loss: 0.179, Test loss: 0.280, Test accuracy: 90.00 

Round  20, Train loss: 0.157, Test loss: 0.353, Test accuracy: 87.90 

Round  21, Train loss: 0.152, Test loss: 0.331, Test accuracy: 88.70 

Round  22, Train loss: 0.144, Test loss: 0.313, Test accuracy: 89.70 

Round  23, Train loss: 0.136, Test loss: 0.380, Test accuracy: 87.70 

Round  24, Train loss: 0.138, Test loss: 0.291, Test accuracy: 89.70 

Round  25, Train loss: 0.124, Test loss: 0.308, Test accuracy: 89.30 

Round  26, Train loss: 0.130, Test loss: 0.259, Test accuracy: 90.90 

Round  27, Train loss: 0.119, Test loss: 0.384, Test accuracy: 88.60 

Round  28, Train loss: 0.113, Test loss: 0.399, Test accuracy: 87.50 

Round  29, Train loss: 0.096, Test loss: 0.323, Test accuracy: 90.20 

Round  30, Train loss: 0.102, Test loss: 0.483, Test accuracy: 85.60 

Round  31, Train loss: 0.097, Test loss: 0.284, Test accuracy: 90.50 

Round  32, Train loss: 0.086, Test loss: 0.303, Test accuracy: 89.90 

Round  33, Train loss: 0.081, Test loss: 0.297, Test accuracy: 91.00 

Round  34, Train loss: 0.070, Test loss: 0.312, Test accuracy: 90.50 

Round  35, Train loss: 0.082, Test loss: 0.266, Test accuracy: 91.50 

Round  36, Train loss: 0.062, Test loss: 0.328, Test accuracy: 90.50 

Round  37, Train loss: 0.046, Test loss: 0.306, Test accuracy: 90.80 

Round  38, Train loss: 0.065, Test loss: 0.297, Test accuracy: 91.50 

Round  39, Train loss: 0.054, Test loss: 0.338, Test accuracy: 90.50 

Round  40, Train loss: 0.078, Test loss: 0.461, Test accuracy: 87.40 

Round  41, Train loss: 0.049, Test loss: 0.356, Test accuracy: 89.90 

Round  42, Train loss: 0.051, Test loss: 0.341, Test accuracy: 90.80 

Round  43, Train loss: 0.037, Test loss: 0.344, Test accuracy: 90.50 

Round  44, Train loss: 0.044, Test loss: 0.335, Test accuracy: 89.60 

Round  45, Train loss: 0.043, Test loss: 0.324, Test accuracy: 90.80 

Round  46, Train loss: 0.041, Test loss: 0.327, Test accuracy: 91.00 

Round  47, Train loss: 0.042, Test loss: 0.329, Test accuracy: 91.20 

Round  48, Train loss: 0.044, Test loss: 0.296, Test accuracy: 91.60 

Round  49, Train loss: 0.035, Test loss: 0.314, Test accuracy: 91.10 

Final Round, Train loss: 0.023, Test loss: 0.334, Test accuracy: 90.70 

Average accuracy final 10 rounds: 90.39 

482.8924584388733
[3.8508291244506836, 5.6290504932403564, 7.416749715805054, 9.175100326538086, 10.986510038375854, 12.78201961517334, 14.580731868743896, 16.37216329574585, 18.123554229736328, 19.978933334350586, 22.004488468170166, 23.827932834625244, 25.52483081817627, 27.376829385757446, 29.19967532157898, 30.956507444381714, 32.789560079574585, 34.58189654350281, 36.4386203289032, 38.21608877182007, 40.124391078948975, 41.92044639587402, 43.68636727333069, 45.42583441734314, 47.19503045082092, 48.98908805847168, 50.76683068275452, 52.71486186981201, 54.46320605278015, 56.29109191894531, 58.13952565193176, 59.923500776290894, 61.62682342529297, 63.4038302898407, 65.2149703502655, 67.01611852645874, 68.97810626029968, 70.73905420303345, 72.60045504570007, 74.35644721984863, 76.25692915916443, 78.06076502799988, 79.79964590072632, 81.55310773849487, 83.37663245201111, 85.20696496963501, 86.90310311317444, 88.66092777252197, 90.62249898910522, 92.5321717262268, 94.739830493927]
[53.0, 68.5, 73.1, 73.6, 77.1, 77.2, 74.2, 84.6, 83.1, 78.3, 86.2, 83.5, 87.4, 88.3, 86.5, 87.1, 87.4, 88.3, 86.5, 90.0, 87.9, 88.7, 89.7, 87.7, 89.7, 89.3, 90.9, 88.6, 87.5, 90.2, 85.6, 90.5, 89.9, 91.0, 90.5, 91.5, 90.5, 90.8, 91.5, 90.5, 87.4, 89.9, 90.8, 90.5, 89.6, 90.8, 91.0, 91.2, 91.6, 91.1, 90.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.727, Test loss: 1.208, Test accuracy: 59.30
Round   1, Train loss: 0.573, Test loss: 1.160, Test accuracy: 50.90
Round   2, Train loss: 0.494, Test loss: 0.605, Test accuracy: 74.40
Round   3, Train loss: 0.453, Test loss: 0.622, Test accuracy: 74.20
Round   4, Train loss: 0.421, Test loss: 0.485, Test accuracy: 80.50
Round   5, Train loss: 0.382, Test loss: 0.493, Test accuracy: 79.60
Round   6, Train loss: 0.394, Test loss: 0.396, Test accuracy: 82.80
Round   7, Train loss: 0.343, Test loss: 0.446, Test accuracy: 83.30
Round   8, Train loss: 0.325, Test loss: 0.332, Test accuracy: 86.80
Round   9, Train loss: 0.297, Test loss: 0.401, Test accuracy: 83.80
Round  10, Train loss: 0.274, Test loss: 0.367, Test accuracy: 86.60
Round  11, Train loss: 0.273, Test loss: 0.368, Test accuracy: 86.00
Round  12, Train loss: 0.265, Test loss: 0.481, Test accuracy: 82.20
Round  13, Train loss: 0.247, Test loss: 0.370, Test accuracy: 85.70
Round  14, Train loss: 0.227, Test loss: 0.332, Test accuracy: 88.00
Round  15, Train loss: 0.207, Test loss: 0.290, Test accuracy: 88.60
Round  16, Train loss: 0.202, Test loss: 0.390, Test accuracy: 86.40
Round  17, Train loss: 0.177, Test loss: 0.360, Test accuracy: 86.20
Round  18, Train loss: 0.193, Test loss: 0.366, Test accuracy: 87.60
Round  19, Train loss: 0.187, Test loss: 0.341, Test accuracy: 87.40
Round  20, Train loss: 0.155, Test loss: 0.328, Test accuracy: 89.00
Round  21, Train loss: 0.174, Test loss: 0.313, Test accuracy: 88.50
Round  22, Train loss: 0.158, Test loss: 0.381, Test accuracy: 86.20
Round  23, Train loss: 0.136, Test loss: 0.285, Test accuracy: 90.50
Round  24, Train loss: 0.126, Test loss: 0.339, Test accuracy: 88.80
Round  25, Train loss: 0.129, Test loss: 0.320, Test accuracy: 89.30
Round  26, Train loss: 0.122, Test loss: 0.325, Test accuracy: 89.10
Round  27, Train loss: 0.110, Test loss: 0.304, Test accuracy: 90.40
Round  28, Train loss: 0.107, Test loss: 0.274, Test accuracy: 90.90
Round  29, Train loss: 0.114, Test loss: 0.311, Test accuracy: 89.40
Round  30, Train loss: 0.102, Test loss: 0.278, Test accuracy: 90.50
Round  31, Train loss: 0.090, Test loss: 0.257, Test accuracy: 90.70
Round  32, Train loss: 0.076, Test loss: 0.286, Test accuracy: 90.90
Round  33, Train loss: 0.073, Test loss: 0.307, Test accuracy: 90.20
Round  34, Train loss: 0.074, Test loss: 0.301, Test accuracy: 90.70
Round  35, Train loss: 0.076, Test loss: 0.314, Test accuracy: 91.00
Round  36, Train loss: 0.075, Test loss: 0.322, Test accuracy: 89.80
Round  37, Train loss: 0.077, Test loss: 0.342, Test accuracy: 88.90
Round  38, Train loss: 0.067, Test loss: 0.351, Test accuracy: 89.20
Round  39, Train loss: 0.048, Test loss: 0.348, Test accuracy: 89.80
Round  40, Train loss: 0.061, Test loss: 0.298, Test accuracy: 90.20
Round  41, Train loss: 0.045, Test loss: 0.313, Test accuracy: 90.20
Round  42, Train loss: 0.055, Test loss: 0.299, Test accuracy: 90.30
Round  43, Train loss: 0.037, Test loss: 0.299, Test accuracy: 90.70
Round  44, Train loss: 0.040, Test loss: 0.316, Test accuracy: 90.90
Round  45, Train loss: 0.046, Test loss: 0.354, Test accuracy: 89.50
Round  46, Train loss: 0.044, Test loss: 0.337, Test accuracy: 89.70
Round  47, Train loss: 0.041, Test loss: 0.284, Test accuracy: 91.20
Round  48, Train loss: 0.033, Test loss: 0.312, Test accuracy: 91.10
Round  49, Train loss: 0.034, Test loss: 0.296, Test accuracy: 90.70
Final Round, Train loss: 0.021, Test loss: 0.308, Test accuracy: 90.60
Average accuracy final 10 rounds: 90.45000000000002
552.7422182559967
[4.207953929901123, 6.358386993408203, 8.413732051849365, 10.46852707862854, 12.550393104553223, 14.814810991287231, 17.023035526275635, 19.11903667449951, 21.163254261016846, 23.28273367881775, 25.348016023635864, 27.392436981201172, 29.428953409194946, 31.512425899505615, 33.58900022506714, 35.83324861526489, 37.92611908912659, 40.03278565406799, 42.17402935028076, 44.15264678001404, 46.21941542625427, 48.27969813346863, 50.35183548927307, 52.46362113952637, 54.65074276924133, 56.723243713378906, 58.84178137779236, 60.96704316139221, 63.037741899490356, 65.25009155273438, 67.41316056251526, 69.46914625167847, 71.55613565444946, 73.532301902771, 75.55263686180115, 77.57878613471985, 79.57102012634277, 81.65510678291321, 83.75200176239014, 85.8246238231659, 87.89051604270935, 90.03440642356873, 92.11276125907898, 94.16199016571045, 96.23135304450989, 98.29757952690125, 100.3383240699768, 102.58585023880005, 104.71465802192688, 106.6953375339508, 108.62831473350525]
[59.3, 50.9, 74.4, 74.2, 80.5, 79.6, 82.8, 83.3, 86.8, 83.8, 86.6, 86.0, 82.2, 85.7, 88.0, 88.6, 86.4, 86.2, 87.6, 87.4, 89.0, 88.5, 86.2, 90.5, 88.8, 89.3, 89.1, 90.4, 90.9, 89.4, 90.5, 90.7, 90.9, 90.2, 90.7, 91.0, 89.8, 88.9, 89.2, 89.8, 90.2, 90.2, 90.3, 90.7, 90.9, 89.5, 89.7, 91.2, 91.1, 90.7, 90.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.421, Test loss: 1.317, Test accuracy: 45.50 

Round   0, Global train loss: 1.421, Global test loss: 1.631, Global test accuracy: 24.10 

Round   1, Train loss: 1.129, Test loss: 1.243, Test accuracy: 56.60 

Round   1, Global train loss: 1.129, Global test loss: 1.595, Global test accuracy: 29.20 

Round   2, Train loss: 0.949, Test loss: 1.280, Test accuracy: 54.80 

Round   2, Global train loss: 0.949, Global test loss: 1.594, Global test accuracy: 28.20 

Round   3, Train loss: 0.854, Test loss: 1.196, Test accuracy: 58.00 

Round   3, Global train loss: 0.854, Global test loss: 1.720, Global test accuracy: 24.10 

Round   4, Train loss: 0.740, Test loss: 1.170, Test accuracy: 60.20 

Round   4, Global train loss: 0.740, Global test loss: 1.689, Global test accuracy: 31.80 

Round   5, Train loss: 0.664, Test loss: 1.229, Test accuracy: 63.30 

Round   5, Global train loss: 0.664, Global test loss: 1.676, Global test accuracy: 30.60 

Round   6, Train loss: 0.558, Test loss: 1.210, Test accuracy: 62.00 

Round   6, Global train loss: 0.558, Global test loss: 1.739, Global test accuracy: 34.30 

Round   7, Train loss: 0.492, Test loss: 1.296, Test accuracy: 63.30 

Round   7, Global train loss: 0.492, Global test loss: 1.752, Global test accuracy: 29.40 

Round   8, Train loss: 0.430, Test loss: 1.354, Test accuracy: 63.00 

Round   8, Global train loss: 0.430, Global test loss: 1.701, Global test accuracy: 29.00 

Round   9, Train loss: 0.372, Test loss: 1.492, Test accuracy: 61.10 

Round   9, Global train loss: 0.372, Global test loss: 1.875, Global test accuracy: 30.30 

Round  10, Train loss: 0.321, Test loss: 1.252, Test accuracy: 65.50 

Round  10, Global train loss: 0.321, Global test loss: 1.935, Global test accuracy: 26.30 

Round  11, Train loss: 0.259, Test loss: 1.743, Test accuracy: 58.90 

Round  11, Global train loss: 0.259, Global test loss: 2.090, Global test accuracy: 27.90 

Round  12, Train loss: 0.249, Test loss: 1.427, Test accuracy: 64.10 

Round  12, Global train loss: 0.249, Global test loss: 2.072, Global test accuracy: 27.80 

Round  13, Train loss: 0.198, Test loss: 1.534, Test accuracy: 62.60 

Round  13, Global train loss: 0.198, Global test loss: 2.104, Global test accuracy: 28.50 

Round  14, Train loss: 0.147, Test loss: 1.568, Test accuracy: 65.90 

Round  14, Global train loss: 0.147, Global test loss: 2.239, Global test accuracy: 27.00 

Round  15, Train loss: 0.147, Test loss: 1.573, Test accuracy: 65.50 

Round  15, Global train loss: 0.147, Global test loss: 2.290, Global test accuracy: 24.20 

Round  16, Train loss: 0.116, Test loss: 1.634, Test accuracy: 63.50 

Round  16, Global train loss: 0.116, Global test loss: 2.185, Global test accuracy: 30.50 

Round  17, Train loss: 0.098, Test loss: 1.745, Test accuracy: 65.60 

Round  17, Global train loss: 0.098, Global test loss: 1.891, Global test accuracy: 31.20 

Round  18, Train loss: 0.113, Test loss: 1.538, Test accuracy: 66.40 

Round  18, Global train loss: 0.113, Global test loss: 2.193, Global test accuracy: 29.50 

Round  19, Train loss: 0.086, Test loss: 1.660, Test accuracy: 64.90 

Round  19, Global train loss: 0.086, Global test loss: 2.077, Global test accuracy: 28.90 

Round  20, Train loss: 0.085, Test loss: 1.703, Test accuracy: 66.10 

Round  20, Global train loss: 0.085, Global test loss: 2.214, Global test accuracy: 27.50 

Round  21, Train loss: 0.081, Test loss: 1.614, Test accuracy: 68.60 

Round  21, Global train loss: 0.081, Global test loss: 2.253, Global test accuracy: 29.00 

Round  22, Train loss: 0.075, Test loss: 1.500, Test accuracy: 68.90 

Round  22, Global train loss: 0.075, Global test loss: 2.206, Global test accuracy: 32.00 

Round  23, Train loss: 0.082, Test loss: 1.812, Test accuracy: 65.30 

Round  23, Global train loss: 0.082, Global test loss: 2.351, Global test accuracy: 28.90 

Round  24, Train loss: 0.064, Test loss: 1.747, Test accuracy: 66.20 

Round  24, Global train loss: 0.064, Global test loss: 2.188, Global test accuracy: 31.40 

Round  25, Train loss: 0.043, Test loss: 1.646, Test accuracy: 68.90 

Round  25, Global train loss: 0.043, Global test loss: 2.261, Global test accuracy: 30.30 

Round  26, Train loss: 0.026, Test loss: 1.616, Test accuracy: 68.50 

Round  26, Global train loss: 0.026, Global test loss: 2.635, Global test accuracy: 25.10 

Round  27, Train loss: 0.061, Test loss: 1.940, Test accuracy: 65.60 

Round  27, Global train loss: 0.061, Global test loss: 2.370, Global test accuracy: 29.30 

Round  28, Train loss: 0.038, Test loss: 1.815, Test accuracy: 65.60 

Round  28, Global train loss: 0.038, Global test loss: 2.430, Global test accuracy: 27.40 

Round  29, Train loss: 0.017, Test loss: 1.744, Test accuracy: 66.10 

Round  29, Global train loss: 0.017, Global test loss: 2.551, Global test accuracy: 29.30 

Round  30, Train loss: 0.037, Test loss: 1.665, Test accuracy: 67.30 

Round  30, Global train loss: 0.037, Global test loss: 2.111, Global test accuracy: 32.70 

Round  31, Train loss: 0.031, Test loss: 1.881, Test accuracy: 66.40 

Round  31, Global train loss: 0.031, Global test loss: 2.176, Global test accuracy: 33.00 

Round  32, Train loss: 0.022, Test loss: 1.620, Test accuracy: 70.40 

Round  32, Global train loss: 0.022, Global test loss: 2.379, Global test accuracy: 29.30 

Round  33, Train loss: 0.032, Test loss: 1.702, Test accuracy: 68.40 

Round  33, Global train loss: 0.032, Global test loss: 2.369, Global test accuracy: 26.10 

Round  34, Train loss: 0.032, Test loss: 1.679, Test accuracy: 69.40 

Round  34, Global train loss: 0.032, Global test loss: 2.386, Global test accuracy: 32.20 

Final Round, Train loss: 0.029, Test loss: 1.757, Test accuracy: 68.90 

Final Round, Global train loss: 0.029, Global test loss: 2.386, Global test accuracy: 32.20 

Average accuracy final 10 rounds: 67.66 

Average global accuracy final 10 rounds: 29.47 

463.690376996994
[7.775012731552124, 13.251070022583008, 19.05172371864319, 24.542269706726074, 30.90978717803955, 36.461387634277344, 41.92979979515076, 47.49836611747742, 53.017717361450195, 58.580991983413696, 64.13653635978699, 69.7314682006836, 75.29036808013916, 80.80036401748657, 86.27256774902344, 91.70214200019836, 97.22880220413208, 102.95149874687195, 108.51045083999634, 114.04568910598755, 119.64791822433472, 125.21471667289734, 130.65649557113647, 136.00195980072021, 141.56645965576172, 146.9917094707489, 152.96217036247253, 158.68989086151123, 164.67200469970703, 170.21056151390076, 175.73104858398438, 181.15149760246277, 186.9740514755249, 192.46730184555054, 197.92706203460693, 209.14896774291992]
[45.5, 56.6, 54.8, 58.0, 60.2, 63.3, 62.0, 63.3, 63.0, 61.1, 65.5, 58.9, 64.1, 62.6, 65.9, 65.5, 63.5, 65.6, 66.4, 64.9, 66.1, 68.6, 68.9, 65.3, 66.2, 68.9, 68.5, 65.6, 65.6, 66.1, 67.3, 66.4, 70.4, 68.4, 69.4, 68.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.406, Test loss: 1.384, Test accuracy: 49.10 

Round   0, Global train loss: 1.406, Global test loss: 1.559, Global test accuracy: 32.10 

Round   1, Train loss: 1.214, Test loss: 1.407, Test accuracy: 45.30 

Round   1, Global train loss: 1.214, Global test loss: 1.559, Global test accuracy: 35.30 

Round   2, Train loss: 1.098, Test loss: 1.261, Test accuracy: 57.30 

Round   2, Global train loss: 1.098, Global test loss: 1.548, Global test accuracy: 39.00 

Round   3, Train loss: 0.986, Test loss: 1.051, Test accuracy: 59.00 

Round   3, Global train loss: 0.986, Global test loss: 1.458, Global test accuracy: 43.20 

Round   4, Train loss: 0.894, Test loss: 1.121, Test accuracy: 58.80 

Round   4, Global train loss: 0.894, Global test loss: 1.403, Global test accuracy: 45.80 

Round   5, Train loss: 0.830, Test loss: 1.217, Test accuracy: 59.10 

Round   5, Global train loss: 0.830, Global test loss: 1.584, Global test accuracy: 43.50 

Round   6, Train loss: 0.744, Test loss: 1.241, Test accuracy: 61.50 

Round   6, Global train loss: 0.744, Global test loss: 1.949, Global test accuracy: 43.50 

Round   7, Train loss: 0.677, Test loss: 1.184, Test accuracy: 60.30 

Round   7, Global train loss: 0.677, Global test loss: 1.593, Global test accuracy: 46.40 

Round   8, Train loss: 0.602, Test loss: 1.224, Test accuracy: 63.20 

Round   8, Global train loss: 0.602, Global test loss: 1.506, Global test accuracy: 49.30 

Round   9, Train loss: 0.552, Test loss: 1.284, Test accuracy: 62.30 

Round   9, Global train loss: 0.552, Global test loss: 1.599, Global test accuracy: 47.80 

Round  10, Train loss: 0.515, Test loss: 1.467, Test accuracy: 61.00 

Round  10, Global train loss: 0.515, Global test loss: 1.681, Global test accuracy: 48.70 

Round  11, Train loss: 0.456, Test loss: 1.498, Test accuracy: 59.10 

Round  11, Global train loss: 0.456, Global test loss: 1.896, Global test accuracy: 46.40 

Round  12, Train loss: 0.408, Test loss: 1.665, Test accuracy: 59.30 

Round  12, Global train loss: 0.408, Global test loss: 2.004, Global test accuracy: 47.10 

Round  13, Train loss: 0.365, Test loss: 1.473, Test accuracy: 61.90 

Round  13, Global train loss: 0.365, Global test loss: 1.962, Global test accuracy: 47.20 

Round  14, Train loss: 0.343, Test loss: 1.296, Test accuracy: 65.20 

Round  14, Global train loss: 0.343, Global test loss: 1.843, Global test accuracy: 48.40 

Round  15, Train loss: 0.297, Test loss: 1.529, Test accuracy: 63.00 

Round  15, Global train loss: 0.297, Global test loss: 1.909, Global test accuracy: 50.10 

Round  16, Train loss: 0.303, Test loss: 1.502, Test accuracy: 61.90 

Round  16, Global train loss: 0.303, Global test loss: 1.963, Global test accuracy: 47.70 

Round  17, Train loss: 0.221, Test loss: 1.605, Test accuracy: 65.00 

Round  17, Global train loss: 0.221, Global test loss: 2.133, Global test accuracy: 50.00 

Round  18, Train loss: 0.220, Test loss: 1.502, Test accuracy: 64.60 

Round  18, Global train loss: 0.220, Global test loss: 1.936, Global test accuracy: 48.00 

Round  19, Train loss: 0.192, Test loss: 1.393, Test accuracy: 66.10 

Round  19, Global train loss: 0.192, Global test loss: 2.012, Global test accuracy: 50.80 

Round  20, Train loss: 0.178, Test loss: 1.579, Test accuracy: 64.70 

Round  20, Global train loss: 0.178, Global test loss: 2.087, Global test accuracy: 50.30 

Round  21, Train loss: 0.164, Test loss: 1.581, Test accuracy: 66.40 

Round  21, Global train loss: 0.164, Global test loss: 2.355, Global test accuracy: 48.90 

Round  22, Train loss: 0.175, Test loss: 2.007, Test accuracy: 58.80 

Round  22, Global train loss: 0.175, Global test loss: 2.367, Global test accuracy: 47.00 

Round  23, Train loss: 0.110, Test loss: 1.515, Test accuracy: 65.90 

Round  23, Global train loss: 0.110, Global test loss: 2.173, Global test accuracy: 50.30 

Round  24, Train loss: 0.095, Test loss: 1.695, Test accuracy: 64.80 

Round  24, Global train loss: 0.095, Global test loss: 2.300, Global test accuracy: 52.10 

Round  25, Train loss: 0.119, Test loss: 1.700, Test accuracy: 64.50 

Round  25, Global train loss: 0.119, Global test loss: 2.255, Global test accuracy: 51.00 

Round  26, Train loss: 0.090, Test loss: 1.463, Test accuracy: 69.10 

Round  26, Global train loss: 0.090, Global test loss: 2.078, Global test accuracy: 51.30 

Round  27, Train loss: 0.141, Test loss: 1.941, Test accuracy: 64.50 

Round  27, Global train loss: 0.141, Global test loss: 2.201, Global test accuracy: 50.30 

Round  28, Train loss: 0.098, Test loss: 1.612, Test accuracy: 66.90 

Round  28, Global train loss: 0.098, Global test loss: 2.401, Global test accuracy: 50.20 

Round  29, Train loss: 0.075, Test loss: 1.606, Test accuracy: 67.00 

Round  29, Global train loss: 0.075, Global test loss: 2.253, Global test accuracy: 50.60 

Round  30, Train loss: 0.081, Test loss: 1.771, Test accuracy: 67.10 

Round  30, Global train loss: 0.081, Global test loss: 2.464, Global test accuracy: 52.30 

Round  31, Train loss: 0.127, Test loss: 1.804, Test accuracy: 65.10 

Round  31, Global train loss: 0.127, Global test loss: 2.252, Global test accuracy: 50.80 

Round  32, Train loss: 0.042, Test loss: 1.555, Test accuracy: 68.40 

Round  32, Global train loss: 0.042, Global test loss: 2.233, Global test accuracy: 51.60 

Round  33, Train loss: 0.058, Test loss: 1.835, Test accuracy: 64.50 

Round  33, Global train loss: 0.058, Global test loss: 2.324, Global test accuracy: 50.40 

Round  34, Train loss: 0.047, Test loss: 1.633, Test accuracy: 67.40 

Round  34, Global train loss: 0.047, Global test loss: 2.356, Global test accuracy: 53.50 

Final Round, Train loss: 0.052, Test loss: 1.702, Test accuracy: 66.60 

Final Round, Global train loss: 0.052, Global test loss: 2.356, Global test accuracy: 53.50 

Average accuracy final 10 rounds: 66.45 

Average global accuracy final 10 rounds: 51.2 

471.1862573623657
[7.620478630065918, 13.627408504486084, 19.213096618652344, 24.87704372406006, 30.420725345611572, 36.118367195129395, 41.75146293640137, 47.39524221420288, 52.882561683654785, 58.88129758834839, 64.5586404800415, 70.08902788162231, 76.28047156333923, 82.18692564964294, 87.99225544929504, 93.5461061000824, 99.13516521453857, 104.71231532096863, 110.42504405975342, 115.96897840499878, 121.44963574409485, 126.97079110145569, 132.63201451301575, 138.09776163101196, 143.77148413658142, 149.42413330078125, 154.96702647209167, 160.5733196735382, 166.11527156829834, 171.69417119026184, 177.44790530204773, 183.21080780029297, 189.2166042327881, 194.96334052085876, 200.37966585159302, 211.64380836486816]
[49.1, 45.3, 57.3, 59.0, 58.8, 59.1, 61.5, 60.3, 63.2, 62.3, 61.0, 59.1, 59.3, 61.9, 65.2, 63.0, 61.9, 65.0, 64.6, 66.1, 64.7, 66.4, 58.8, 65.9, 64.8, 64.5, 69.1, 64.5, 66.9, 67.0, 67.1, 65.1, 68.4, 64.5, 67.4, 66.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.502, Test loss: 1.682, Test accuracy: 25.10 

Round   1, Train loss: 1.284, Test loss: 1.234, Test accuracy: 44.90 

Round   2, Train loss: 1.155, Test loss: 1.011, Test accuracy: 57.30 

Round   3, Train loss: 1.059, Test loss: 0.972, Test accuracy: 59.40 

Round   4, Train loss: 0.980, Test loss: 1.004, Test accuracy: 59.00 

Round   5, Train loss: 0.909, Test loss: 0.903, Test accuracy: 63.10 

Round   6, Train loss: 0.880, Test loss: 0.909, Test accuracy: 63.20 

Round   7, Train loss: 0.804, Test loss: 0.905, Test accuracy: 64.40 

Round   8, Train loss: 0.726, Test loss: 0.874, Test accuracy: 67.00 

Round   9, Train loss: 0.680, Test loss: 0.851, Test accuracy: 67.40 

Round  10, Train loss: 0.626, Test loss: 0.990, Test accuracy: 64.20 

Round  11, Train loss: 0.610, Test loss: 0.973, Test accuracy: 63.50 

Round  12, Train loss: 0.572, Test loss: 0.915, Test accuracy: 65.50 

Round  13, Train loss: 0.505, Test loss: 0.963, Test accuracy: 64.50 

Round  14, Train loss: 0.484, Test loss: 0.908, Test accuracy: 66.50 

Round  15, Train loss: 0.448, Test loss: 0.954, Test accuracy: 65.40 

Round  16, Train loss: 0.408, Test loss: 1.041, Test accuracy: 67.10 

Round  17, Train loss: 0.361, Test loss: 1.033, Test accuracy: 65.70 

Round  18, Train loss: 0.351, Test loss: 1.040, Test accuracy: 66.30 

Round  19, Train loss: 0.323, Test loss: 1.040, Test accuracy: 66.40 

Round  20, Train loss: 0.288, Test loss: 0.926, Test accuracy: 68.20 

Round  21, Train loss: 0.259, Test loss: 0.999, Test accuracy: 66.80 

Round  22, Train loss: 0.245, Test loss: 1.028, Test accuracy: 68.10 

Round  23, Train loss: 0.206, Test loss: 1.016, Test accuracy: 67.90 

Round  24, Train loss: 0.201, Test loss: 1.034, Test accuracy: 68.40 

Round  25, Train loss: 0.163, Test loss: 0.991, Test accuracy: 69.70 

Round  26, Train loss: 0.179, Test loss: 1.010, Test accuracy: 69.90 

Round  27, Train loss: 0.170, Test loss: 1.113, Test accuracy: 69.90 

Round  28, Train loss: 0.149, Test loss: 1.073, Test accuracy: 68.60 

Round  29, Train loss: 0.123, Test loss: 1.189, Test accuracy: 68.30 

Round  30, Train loss: 0.114, Test loss: 1.229, Test accuracy: 67.10 

Round  31, Train loss: 0.100, Test loss: 1.183, Test accuracy: 70.20 

Round  32, Train loss: 0.127, Test loss: 1.268, Test accuracy: 67.40 

Round  33, Train loss: 0.113, Test loss: 1.170, Test accuracy: 69.70 

Round  34, Train loss: 0.116, Test loss: 1.167, Test accuracy: 69.50 

Round  35, Train loss: 0.072, Test loss: 1.184, Test accuracy: 69.60 

Round  36, Train loss: 0.071, Test loss: 1.237, Test accuracy: 69.20 

Round  37, Train loss: 0.061, Test loss: 1.189, Test accuracy: 70.40 

Round  38, Train loss: 0.099, Test loss: 1.343, Test accuracy: 67.50 

Round  39, Train loss: 0.072, Test loss: 1.303, Test accuracy: 69.10 

Final Round, Train loss: 0.039, Test loss: 1.259, Test accuracy: 69.60 

Average accuracy final 10 rounds: 68.97 

387.54600858688354
[6.167392730712891, 10.645630836486816, 15.013683080673218, 19.419378757476807, 23.740752458572388, 28.19573402404785, 32.490026235580444, 36.90767455101013, 41.15544009208679, 45.59706425666809, 49.989532709121704, 54.68222618103027, 59.189016342163086, 63.43310523033142, 67.76858162879944, 72.05922174453735, 76.39861607551575, 80.78716540336609, 85.06613564491272, 89.22940802574158, 93.62171673774719, 98.04635763168335, 102.54719281196594, 107.23267436027527, 111.52060008049011, 115.87512183189392, 120.32526469230652, 124.54900765419006, 129.09007334709167, 133.43112969398499, 137.7558524608612, 142.27704858779907, 146.56434512138367, 150.88428926467896, 155.26912808418274, 159.61254739761353, 163.9951033592224, 168.10668015480042, 172.71525883674622, 176.99922919273376, 181.86674809455872]
[25.1, 44.9, 57.3, 59.4, 59.0, 63.1, 63.2, 64.4, 67.0, 67.4, 64.2, 63.5, 65.5, 64.5, 66.5, 65.4, 67.1, 65.7, 66.3, 66.4, 68.2, 66.8, 68.1, 67.9, 68.4, 69.7, 69.9, 69.9, 68.6, 68.3, 67.1, 70.2, 67.4, 69.7, 69.5, 69.6, 69.2, 70.4, 67.5, 69.1, 69.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.519, Test loss: 1.503, Test accuracy: 27.10
Round   1, Train loss: 1.295, Test loss: 1.303, Test accuracy: 43.80
Round   2, Train loss: 1.158, Test loss: 1.163, Test accuracy: 51.50
Round   3, Train loss: 1.041, Test loss: 1.092, Test accuracy: 54.40
Round   4, Train loss: 0.977, Test loss: 0.947, Test accuracy: 60.00
Round   5, Train loss: 0.916, Test loss: 0.997, Test accuracy: 58.40
Round   6, Train loss: 0.858, Test loss: 0.951, Test accuracy: 61.20
Round   7, Train loss: 0.816, Test loss: 1.026, Test accuracy: 58.80
Round   8, Train loss: 0.737, Test loss: 0.908, Test accuracy: 64.50
Round   9, Train loss: 0.674, Test loss: 0.889, Test accuracy: 64.20
Round  10, Train loss: 0.630, Test loss: 0.865, Test accuracy: 64.50
Round  11, Train loss: 0.571, Test loss: 0.819, Test accuracy: 67.70
Round  12, Train loss: 0.532, Test loss: 0.901, Test accuracy: 65.00
Round  13, Train loss: 0.506, Test loss: 0.878, Test accuracy: 66.80
Round  14, Train loss: 0.455, Test loss: 0.966, Test accuracy: 64.80
Round  15, Train loss: 0.420, Test loss: 0.925, Test accuracy: 66.20
Round  16, Train loss: 0.369, Test loss: 0.928, Test accuracy: 67.20
Round  17, Train loss: 0.365, Test loss: 1.004, Test accuracy: 65.00
Round  18, Train loss: 0.342, Test loss: 0.957, Test accuracy: 66.70
Round  19, Train loss: 0.291, Test loss: 0.998, Test accuracy: 67.50
Round  20, Train loss: 0.279, Test loss: 1.022, Test accuracy: 66.80
Round  21, Train loss: 0.281, Test loss: 1.005, Test accuracy: 67.60
Round  22, Train loss: 0.218, Test loss: 0.995, Test accuracy: 67.40
Round  23, Train loss: 0.214, Test loss: 1.021, Test accuracy: 68.20
Round  24, Train loss: 0.201, Test loss: 1.012, Test accuracy: 67.90
Round  25, Train loss: 0.185, Test loss: 1.087, Test accuracy: 66.60
Round  26, Train loss: 0.186, Test loss: 1.094, Test accuracy: 67.90
Round  27, Train loss: 0.142, Test loss: 1.058, Test accuracy: 68.30
Round  28, Train loss: 0.125, Test loss: 1.086, Test accuracy: 69.10
Round  29, Train loss: 0.134, Test loss: 1.022, Test accuracy: 70.10
Round  30, Train loss: 0.131, Test loss: 1.111, Test accuracy: 69.40
Round  31, Train loss: 0.103, Test loss: 1.129, Test accuracy: 68.90
Round  32, Train loss: 0.092, Test loss: 1.204, Test accuracy: 67.70
Round  33, Train loss: 0.123, Test loss: 1.195, Test accuracy: 69.10
Round  34, Train loss: 0.095, Test loss: 1.166, Test accuracy: 68.50
Round  35, Train loss: 0.080, Test loss: 1.127, Test accuracy: 69.50
Round  36, Train loss: 0.069, Test loss: 1.144, Test accuracy: 69.20
Round  37, Train loss: 0.044, Test loss: 1.191, Test accuracy: 70.00
Round  38, Train loss: 0.064, Test loss: 1.229, Test accuracy: 68.00
Round  39, Train loss: 0.074, Test loss: 1.257, Test accuracy: 69.20
Final Round, Train loss: 0.043, Test loss: 1.229, Test accuracy: 69.60
Average accuracy final 10 rounds: 68.95
441.37730598449707
[7.239416837692261, 12.224467992782593, 18.104013204574585, 23.34734845161438, 28.355297565460205, 33.239707469940186, 38.14278054237366, 43.02395510673523, 47.92386865615845, 53.13465237617493, 58.21924042701721, 63.0671911239624, 68.50708365440369, 73.6575357913971, 78.59011602401733, 83.65484666824341, 88.50440096855164, 93.39130163192749, 98.6848464012146, 103.46363377571106, 108.83924674987793, 114.24692106246948, 119.28511142730713, 124.73655605316162, 129.462708234787, 134.54510021209717, 139.5897035598755, 144.6766800880432, 149.81269764900208, 154.54974269866943, 159.41973423957825, 164.44360065460205, 169.77505373954773, 174.60405373573303, 179.60091471672058, 184.79699182510376, 189.77110171318054, 194.9152283668518, 199.92528581619263, 204.94528198242188, 210.22732877731323]
[27.1, 43.8, 51.5, 54.4, 60.0, 58.4, 61.2, 58.8, 64.5, 64.2, 64.5, 67.7, 65.0, 66.8, 64.8, 66.2, 67.2, 65.0, 66.7, 67.5, 66.8, 67.6, 67.4, 68.2, 67.9, 66.6, 67.9, 68.3, 69.1, 70.1, 69.4, 68.9, 67.7, 69.1, 68.5, 69.5, 69.2, 70.0, 68.0, 69.2, 69.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.677, Train accuracy: 70.800, Test loss: 1.049, Test accuracy: 58.60 

        train local model (freeze embeding):client   0,  Train loss: 0.537, Train accuracy: 79.200, Test loss: 0.974, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.472, Train accuracy: 82.400, Test loss: 1.052, Test accuracy: 63.20 

Round   0, Train loss: 0.472, Test loss: 1.052, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.355, Train accuracy: 87.400, Test loss: 1.067, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.364, Train accuracy: 85.800, Test loss: 1.292, Test accuracy: 61.20 

Round   1, Train loss: 0.364, Test loss: 1.292, Test accuracy: 61.20 

        train local model (freeze embeding):client   0,  Train loss: 0.206, Train accuracy: 92.600, Test loss: 1.117, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.248, Train accuracy: 90.600, Test loss: 1.686, Test accuracy: 55.00 

Round   2, Train loss: 0.248, Test loss: 1.686, Test accuracy: 55.00 

        train local model (freeze embeding):client   0,  Train loss: 0.134, Train accuracy: 95.800, Test loss: 1.314, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.353, Train accuracy: 87.600, Test loss: 1.907, Test accuracy: 62.40 

Round   3, Train loss: 0.353, Test loss: 1.907, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.117, Train accuracy: 95.400, Test loss: 1.508, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.126, Train accuracy: 95.800, Test loss: 1.705, Test accuracy: 62.80 

Round   4, Train loss: 0.126, Test loss: 1.705, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.059, Train accuracy: 98.000, Test loss: 1.488, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 97.600, Test loss: 1.798, Test accuracy: 63.80 

Round   5, Train loss: 0.050, Test loss: 1.798, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.705, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.600, Test loss: 1.626, Test accuracy: 64.60 

Round   6, Train loss: 0.049, Test loss: 1.626, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.524, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.400, Test loss: 1.691, Test accuracy: 66.00 

Round   7, Train loss: 0.042, Test loss: 1.691, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.618, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.736, Test accuracy: 62.60 

Round   8, Train loss: 0.023, Test loss: 1.736, Test accuracy: 62.60 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.824, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.490, Test accuracy: 67.20 

Round   9, Train loss: 0.009, Test loss: 1.490, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.583, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.400, Test loss: 1.824, Test accuracy: 65.60 

Round  10, Train loss: 0.011, Test loss: 1.824, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.800, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.623, Test accuracy: 66.60 

Round  11, Train loss: 0.008, Test loss: 1.623, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.642, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.799, Test accuracy: 65.60 

Round  12, Train loss: 0.004, Test loss: 1.799, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.737, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.798, Test accuracy: 68.60 

Round  13, Train loss: 0.001, Test loss: 1.798, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.784, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.700, Test accuracy: 69.20 

Round  14, Train loss: 0.027, Test loss: 1.700, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.526, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.690, Test accuracy: 68.00 

Round  15, Train loss: 0.005, Test loss: 1.690, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.642, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.892, Test accuracy: 68.40 

Round  16, Train loss: 0.002, Test loss: 1.892, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.917, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.780, Test accuracy: 70.40 

Round  17, Train loss: 0.002, Test loss: 1.780, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.651, Test accuracy: 69.80 

Round  18, Train loss: 0.000, Test loss: 1.651, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.731, Test accuracy: 69.40 

Round  19, Train loss: 0.000, Test loss: 1.731, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.726, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.717, Test accuracy: 68.60 

Final Round, Train loss: 0.000, Test loss: 1.713, Test accuracy: 69.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.935, Train accuracy: 63.600, Test loss: 1.203, Test accuracy: 55.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.749, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 2.176, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.787, Train accuracy: 68.000, Test loss: 1.017, Test accuracy: 57.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.377, Train accuracy: 85.600, Test loss: 1.244, Test accuracy: 65.80 

Round   0, Train loss: 0.206, Test loss: 1.385, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.682, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.388, Train accuracy: 85.400, Test loss: 0.960, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.354, Train accuracy: 86.600, Test loss: 1.695, Test accuracy: 61.80 

Round   1, Train loss: 0.178, Test loss: 1.312, Test accuracy: 65.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.752, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.157, Train accuracy: 95.000, Test loss: 1.108, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.148, Train accuracy: 94.000, Test loss: 1.457, Test accuracy: 66.80 

Round   2, Train loss: 0.074, Test loss: 1.318, Test accuracy: 68.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.746, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.071, Train accuracy: 98.200, Test loss: 1.173, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 98.800, Test loss: 1.280, Test accuracy: 68.60 

Round   3, Train loss: 0.026, Test loss: 1.316, Test accuracy: 67.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.525, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.506, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 1.245, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.055, Train accuracy: 98.200, Test loss: 1.494, Test accuracy: 67.20 

Round   4, Train loss: 0.028, Test loss: 1.358, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.793, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.312, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.400, Test loss: 1.528, Test accuracy: 67.20 

Round   5, Train loss: 0.020, Test loss: 1.363, Test accuracy: 69.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.655, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.347, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.192, Train accuracy: 93.400, Test loss: 1.883, Test accuracy: 64.60 

Round   6, Train loss: 0.097, Test loss: 1.462, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.465, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.698, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.404, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.704, Test accuracy: 70.60 

Round   7, Train loss: 0.003, Test loss: 1.482, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.541, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.753, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.517, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.539, Test accuracy: 69.80 

Round   8, Train loss: 0.015, Test loss: 1.468, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.493, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.409, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.827, Test accuracy: 67.60 

Round   9, Train loss: 0.010, Test loss: 1.457, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.609, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.558, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.708, Test accuracy: 70.60 

Round  10, Train loss: 0.011, Test loss: 1.436, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.447, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.822, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.512, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.701, Test accuracy: 67.80 

Round  11, Train loss: 0.010, Test loss: 1.512, Test accuracy: 69.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.500, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.630, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.589, Test accuracy: 71.00 

Round  12, Train loss: 0.002, Test loss: 1.527, Test accuracy: 69.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.556, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.808, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.574, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.938, Test accuracy: 66.20 

Round  13, Train loss: 0.011, Test loss: 1.562, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.578, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.685, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.581, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.631, Test accuracy: 70.80 

Round  14, Train loss: 0.004, Test loss: 1.559, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.658, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 98.600, Test loss: 1.742, Test accuracy: 67.60 

Round  15, Train loss: 0.013, Test loss: 1.566, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.497, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.458, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.500, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.531, Test accuracy: 68.20 

Round  16, Train loss: 0.010, Test loss: 1.450, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.492, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.462, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 97.800, Test loss: 2.003, Test accuracy: 70.20 

Round  17, Train loss: 0.023, Test loss: 1.572, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.469, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.526, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.067, Train accuracy: 98.000, Test loss: 2.069, Test accuracy: 66.40 

Round  18, Train loss: 0.033, Test loss: 1.622, Test accuracy: 69.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 71.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.659, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.631, Test accuracy: 69.40 

Round  19, Train loss: 0.000, Test loss: 1.537, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.545, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.550, Test accuracy: 71.40 

Final Round, Train loss: 0.000, Test loss: 1.542, Test accuracy: 71.50 

Average accuracy final 10 rounds: 138.05999999999997 

973.9658391475677
[15.03919267654419, 30.15974712371826, 44.7141854763031, 59.75433087348938, 74.63295245170593, 90.08154153823853, 105.43506908416748, 120.29894280433655, 135.6887092590332, 150.12422561645508, 164.444908618927, 178.91330647468567, 193.39337968826294, 207.71301531791687, 222.64861416816711, 237.39482879638672, 252.38063979148865, 266.8955705165863, 281.7039315700531, 296.88114166259766, 304.9923348426819, 319.7615714073181, 335.07091212272644, 350.33112025260925, 365.3864188194275, 380.18121218681335, 395.6759252548218, 410.77779507637024, 425.79654335975647, 441.3334000110626, 456.11926555633545, 471.1186888217926, 486.53054785728455, 501.4797990322113, 515.8905913829803, 531.0974543094635, 546.0601596832275, 561.0149681568146, 575.6063041687012, 590.564772605896, 605.5733261108398, 613.444563627243]
[63.2, 61.2, 55.0, 62.4, 62.8, 63.8, 64.6, 66.0, 62.6, 67.2, 65.6, 66.6, 65.6, 68.6, 69.2, 68.0, 68.4, 70.4, 69.8, 69.4, 69.0, 66.8, 65.7, 68.1, 67.5, 70.4, 69.9, 68.2, 70.1, 68.6, 69.6, 70.4, 69.1, 69.3, 69.6, 69.2, 69.6, 70.6, 71.1, 69.1, 71.0, 71.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.388, Test loss: 1.297, Test accuracy: 50.70 

Round   0, Global train loss: 1.388, Global test loss: 1.823, Global test accuracy: 20.30 

Round   1, Train loss: 1.104, Test loss: 1.083, Test accuracy: 55.60 

Round   1, Global train loss: 1.104, Global test loss: 1.957, Global test accuracy: 20.00 

Round   2, Train loss: 0.929, Test loss: 1.159, Test accuracy: 59.50 

Round   2, Global train loss: 0.929, Global test loss: 1.875, Global test accuracy: 20.50 

Round   3, Train loss: 0.796, Test loss: 1.129, Test accuracy: 61.50 

Round   3, Global train loss: 0.796, Global test loss: 1.994, Global test accuracy: 20.20 

Round   4, Train loss: 0.685, Test loss: 1.097, Test accuracy: 64.30 

Round   4, Global train loss: 0.685, Global test loss: 2.371, Global test accuracy: 20.00 

Round   5, Train loss: 0.567, Test loss: 1.147, Test accuracy: 65.20 

Round   5, Global train loss: 0.567, Global test loss: 2.135, Global test accuracy: 20.20 

Round   6, Train loss: 0.501, Test loss: 1.088, Test accuracy: 67.70 

Round   6, Global train loss: 0.501, Global test loss: 1.995, Global test accuracy: 20.00 

Round   7, Train loss: 0.414, Test loss: 1.478, Test accuracy: 64.00 

Round   7, Global train loss: 0.414, Global test loss: 2.011, Global test accuracy: 21.50 

Round   8, Train loss: 0.334, Test loss: 1.518, Test accuracy: 64.60 

Round   8, Global train loss: 0.334, Global test loss: 2.214, Global test accuracy: 20.00 

Round   9, Train loss: 0.288, Test loss: 1.929, Test accuracy: 59.40 

Round   9, Global train loss: 0.288, Global test loss: 2.100, Global test accuracy: 25.30 

Round  10, Train loss: 0.243, Test loss: 1.368, Test accuracy: 68.20 

Round  10, Global train loss: 0.243, Global test loss: 2.123, Global test accuracy: 20.50 

Round  11, Train loss: 0.211, Test loss: 1.399, Test accuracy: 67.60 

Round  11, Global train loss: 0.211, Global test loss: 2.444, Global test accuracy: 20.30 

Round  12, Train loss: 0.170, Test loss: 1.443, Test accuracy: 69.20 

Round  12, Global train loss: 0.170, Global test loss: 2.035, Global test accuracy: 20.80 

Round  13, Train loss: 0.151, Test loss: 1.501, Test accuracy: 67.10 

Round  13, Global train loss: 0.151, Global test loss: 2.505, Global test accuracy: 20.60 

Round  14, Train loss: 0.120, Test loss: 1.785, Test accuracy: 64.00 

Round  14, Global train loss: 0.120, Global test loss: 2.041, Global test accuracy: 24.80 

Round  15, Train loss: 0.108, Test loss: 1.647, Test accuracy: 67.10 

Round  15, Global train loss: 0.108, Global test loss: 2.547, Global test accuracy: 20.10 

Round  16, Train loss: 0.120, Test loss: 1.507, Test accuracy: 68.00 

Round  16, Global train loss: 0.120, Global test loss: 2.460, Global test accuracy: 20.70 

Round  17, Train loss: 0.063, Test loss: 1.484, Test accuracy: 70.00 

Round  17, Global train loss: 0.063, Global test loss: 2.530, Global test accuracy: 21.80 

Round  18, Train loss: 0.055, Test loss: 1.467, Test accuracy: 70.80 

Round  18, Global train loss: 0.055, Global test loss: 2.305, Global test accuracy: 22.60 

Round  19, Train loss: 0.057, Test loss: 1.561, Test accuracy: 69.20 

Round  19, Global train loss: 0.057, Global test loss: 2.370, Global test accuracy: 25.50 

Round  20, Train loss: 0.083, Test loss: 2.801, Test accuracy: 57.70 

Round  20, Global train loss: 0.083, Global test loss: 2.283, Global test accuracy: 29.00 

Round  21, Train loss: 0.050, Test loss: 1.353, Test accuracy: 71.80 

Round  21, Global train loss: 0.050, Global test loss: 2.459, Global test accuracy: 20.10 

Round  22, Train loss: 0.034, Test loss: 1.857, Test accuracy: 66.90 

Round  22, Global train loss: 0.034, Global test loss: 2.485, Global test accuracy: 20.90 

Round  23, Train loss: 0.028, Test loss: 1.669, Test accuracy: 69.40 

Round  23, Global train loss: 0.028, Global test loss: 2.413, Global test accuracy: 20.50 

Round  24, Train loss: 0.040, Test loss: 1.531, Test accuracy: 71.70 

Round  24, Global train loss: 0.040, Global test loss: 2.627, Global test accuracy: 20.10 

Round  25, Train loss: 0.055, Test loss: 1.549, Test accuracy: 71.70 

Round  25, Global train loss: 0.055, Global test loss: 2.487, Global test accuracy: 20.10 

Round  26, Train loss: 0.052, Test loss: 1.411, Test accuracy: 70.00 

Round  26, Global train loss: 0.052, Global test loss: 2.578, Global test accuracy: 20.40 

Round  27, Train loss: 0.051, Test loss: 1.534, Test accuracy: 71.40 

Round  27, Global train loss: 0.051, Global test loss: 2.691, Global test accuracy: 23.20 

Round  28, Train loss: 0.032, Test loss: 1.480, Test accuracy: 72.20 

Round  28, Global train loss: 0.032, Global test loss: 2.477, Global test accuracy: 23.70 

Round  29, Train loss: 0.025, Test loss: 1.634, Test accuracy: 70.90 

Round  29, Global train loss: 0.025, Global test loss: 2.641, Global test accuracy: 21.30 

Round  30, Train loss: 0.032, Test loss: 1.537, Test accuracy: 71.90 

Round  30, Global train loss: 0.032, Global test loss: 2.440, Global test accuracy: 25.70 

Round  31, Train loss: 0.019, Test loss: 1.497, Test accuracy: 72.70 

Round  31, Global train loss: 0.019, Global test loss: 2.543, Global test accuracy: 22.20 

Round  32, Train loss: 0.036, Test loss: 2.086, Test accuracy: 68.30 

Round  32, Global train loss: 0.036, Global test loss: 2.313, Global test accuracy: 25.00 

Round  33, Train loss: 0.037, Test loss: 1.379, Test accuracy: 74.50 

Round  33, Global train loss: 0.037, Global test loss: 2.246, Global test accuracy: 21.90 

Round  34, Train loss: 0.017, Test loss: 1.732, Test accuracy: 70.90 

Round  34, Global train loss: 0.017, Global test loss: 2.167, Global test accuracy: 27.50 

Final Round, Train loss: 0.009, Test loss: 1.475, Test accuracy: 74.00 

Final Round, Global train loss: 0.009, Global test loss: 2.167, Global test accuracy: 27.50 

Average accuracy final 10 rounds: 71.45 

Average global accuracy final 10 rounds: 23.1 

463.6070020198822
[7.712724685668945, 13.150758266448975, 18.654842376708984, 24.173755884170532, 29.536906480789185, 34.94692301750183, 40.50437831878662, 46.295252084732056, 51.86943864822388, 57.35800099372864, 63.10774517059326, 68.81408333778381, 74.36623859405518, 79.92439794540405, 85.72825741767883, 91.27033543586731, 96.77696657180786, 102.25007939338684, 107.82715010643005, 113.42020010948181, 118.95526719093323, 124.51271057128906, 130.0214672088623, 135.44776391983032, 141.0193510055542, 146.78803062438965, 152.31602096557617, 157.764892578125, 163.1454029083252, 168.9152319431305, 174.66158866882324, 180.30389881134033, 185.88212513923645, 191.42755341529846, 197.13215327262878, 208.27860760688782]
[50.7, 55.6, 59.5, 61.5, 64.3, 65.2, 67.7, 64.0, 64.6, 59.4, 68.2, 67.6, 69.2, 67.1, 64.0, 67.1, 68.0, 70.0, 70.8, 69.2, 57.7, 71.8, 66.9, 69.4, 71.7, 71.7, 70.0, 71.4, 72.2, 70.9, 71.9, 72.7, 68.3, 74.5, 70.9, 74.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.395, Test loss: 1.403, Test accuracy: 49.50 

Round   0, Global train loss: 1.395, Global test loss: 1.649, Global test accuracy: 24.70 

Round   1, Train loss: 1.207, Test loss: 1.621, Test accuracy: 49.00 

Round   1, Global train loss: 1.207, Global test loss: 1.664, Global test accuracy: 25.90 

Round   2, Train loss: 1.069, Test loss: 1.001, Test accuracy: 61.00 

Round   2, Global train loss: 1.069, Global test loss: 1.618, Global test accuracy: 32.20 

Round   3, Train loss: 0.953, Test loss: 1.042, Test accuracy: 65.50 

Round   3, Global train loss: 0.953, Global test loss: 1.584, Global test accuracy: 38.80 

Round   4, Train loss: 0.867, Test loss: 1.086, Test accuracy: 66.00 

Round   4, Global train loss: 0.867, Global test loss: 1.489, Global test accuracy: 41.30 

Round   5, Train loss: 0.764, Test loss: 1.256, Test accuracy: 64.40 

Round   5, Global train loss: 0.764, Global test loss: 1.719, Global test accuracy: 43.50 

Round   6, Train loss: 0.683, Test loss: 0.978, Test accuracy: 68.30 

Round   6, Global train loss: 0.683, Global test loss: 1.678, Global test accuracy: 42.90 

Round   7, Train loss: 0.583, Test loss: 1.359, Test accuracy: 64.70 

Round   7, Global train loss: 0.583, Global test loss: 1.502, Global test accuracy: 45.90 

Round   8, Train loss: 0.550, Test loss: 1.151, Test accuracy: 66.10 

Round   8, Global train loss: 0.550, Global test loss: 1.951, Global test accuracy: 43.00 

Round   9, Train loss: 0.511, Test loss: 1.076, Test accuracy: 67.10 

Round   9, Global train loss: 0.511, Global test loss: 1.828, Global test accuracy: 45.40 

Round  10, Train loss: 0.443, Test loss: 1.320, Test accuracy: 64.40 

Round  10, Global train loss: 0.443, Global test loss: 1.632, Global test accuracy: 47.80 

Round  11, Train loss: 0.381, Test loss: 1.144, Test accuracy: 66.60 

Round  11, Global train loss: 0.381, Global test loss: 1.817, Global test accuracy: 48.10 

Round  12, Train loss: 0.340, Test loss: 1.450, Test accuracy: 65.20 

Round  12, Global train loss: 0.340, Global test loss: 2.040, Global test accuracy: 45.60 

Round  13, Train loss: 0.337, Test loss: 1.392, Test accuracy: 67.60 

Round  13, Global train loss: 0.337, Global test loss: 1.983, Global test accuracy: 47.10 

Round  14, Train loss: 0.290, Test loss: 1.063, Test accuracy: 72.20 

Round  14, Global train loss: 0.290, Global test loss: 1.932, Global test accuracy: 49.20 

Round  15, Train loss: 0.246, Test loss: 1.163, Test accuracy: 70.70 

Round  15, Global train loss: 0.246, Global test loss: 1.881, Global test accuracy: 50.30 

Round  16, Train loss: 0.219, Test loss: 1.497, Test accuracy: 65.90 

Round  16, Global train loss: 0.219, Global test loss: 2.136, Global test accuracy: 48.20 

Round  17, Train loss: 0.239, Test loss: 1.260, Test accuracy: 68.20 

Round  17, Global train loss: 0.239, Global test loss: 2.330, Global test accuracy: 46.20 

Round  18, Train loss: 0.175, Test loss: 1.198, Test accuracy: 69.80 

Round  18, Global train loss: 0.175, Global test loss: 1.828, Global test accuracy: 51.60 

Round  19, Train loss: 0.211, Test loss: 1.294, Test accuracy: 69.30 

Round  19, Global train loss: 0.211, Global test loss: 2.002, Global test accuracy: 52.60 

Round  20, Train loss: 0.132, Test loss: 1.204, Test accuracy: 71.40 

Round  20, Global train loss: 0.132, Global test loss: 2.031, Global test accuracy: 50.00 

Round  21, Train loss: 0.135, Test loss: 1.360, Test accuracy: 71.10 

Round  21, Global train loss: 0.135, Global test loss: 2.059, Global test accuracy: 50.10 

Round  22, Train loss: 0.128, Test loss: 1.304, Test accuracy: 72.60 

Round  22, Global train loss: 0.128, Global test loss: 1.995, Global test accuracy: 51.10 

Round  23, Train loss: 0.164, Test loss: 1.516, Test accuracy: 69.60 

Round  23, Global train loss: 0.164, Global test loss: 2.170, Global test accuracy: 51.10 

Round  24, Train loss: 0.112, Test loss: 1.268, Test accuracy: 70.70 

Round  24, Global train loss: 0.112, Global test loss: 2.016, Global test accuracy: 51.50 

Round  25, Train loss: 0.058, Test loss: 1.211, Test accuracy: 74.10 

Round  25, Global train loss: 0.058, Global test loss: 2.214, Global test accuracy: 48.10 

Round  26, Train loss: 0.083, Test loss: 1.278, Test accuracy: 73.60 

Round  26, Global train loss: 0.083, Global test loss: 2.061, Global test accuracy: 52.80 

Round  27, Train loss: 0.075, Test loss: 1.260, Test accuracy: 73.40 

Round  27, Global train loss: 0.075, Global test loss: 2.147, Global test accuracy: 50.30 

Round  28, Train loss: 0.081, Test loss: 1.455, Test accuracy: 69.40 

Round  28, Global train loss: 0.081, Global test loss: 2.214, Global test accuracy: 51.90 

Round  29, Train loss: 0.093, Test loss: 1.193, Test accuracy: 73.30 

Round  29, Global train loss: 0.093, Global test loss: 2.165, Global test accuracy: 51.10 

Round  30, Train loss: 0.073, Test loss: 1.166, Test accuracy: 73.00 

Round  30, Global train loss: 0.073, Global test loss: 2.260, Global test accuracy: 49.60 

Round  31, Train loss: 0.086, Test loss: 1.225, Test accuracy: 73.70 

Round  31, Global train loss: 0.086, Global test loss: 2.221, Global test accuracy: 50.40 

Round  32, Train loss: 0.042, Test loss: 1.289, Test accuracy: 72.80 

Round  32, Global train loss: 0.042, Global test loss: 2.084, Global test accuracy: 52.30 

Round  33, Train loss: 0.053, Test loss: 1.236, Test accuracy: 74.00 

Round  33, Global train loss: 0.053, Global test loss: 1.998, Global test accuracy: 54.00 

Round  34, Train loss: 0.024, Test loss: 1.293, Test accuracy: 72.90 

Round  34, Global train loss: 0.024, Global test loss: 2.143, Global test accuracy: 52.90 

Final Round, Train loss: 0.059, Test loss: 1.460, Test accuracy: 71.70 

Final Round, Global train loss: 0.059, Global test loss: 2.143, Global test accuracy: 52.90 

Average accuracy final 10 rounds: 73.02000000000001 

Average global accuracy final 10 rounds: 51.339999999999996 

466.1743371486664
[7.649336576461792, 13.076842308044434, 18.72026538848877, 24.235382318496704, 29.79949975013733, 35.30044484138489, 41.00870490074158, 46.78469467163086, 52.332775354385376, 57.7767870426178, 63.20136594772339, 68.75762367248535, 74.49333667755127, 80.25184917449951, 85.85518884658813, 91.5795590877533, 97.1882917881012, 102.6840934753418, 108.14231491088867, 113.68761777877808, 119.25260496139526, 124.92000603675842, 130.41476464271545, 135.80798172950745, 141.08544754981995, 146.3818075656891, 151.91183710098267, 157.90247631072998, 163.2997806072235, 168.96397304534912, 174.93799376487732, 180.82729578018188, 186.31795597076416, 192.21748995780945, 197.89977359771729, 208.95689845085144]
[49.5, 49.0, 61.0, 65.5, 66.0, 64.4, 68.3, 64.7, 66.1, 67.1, 64.4, 66.6, 65.2, 67.6, 72.2, 70.7, 65.9, 68.2, 69.8, 69.3, 71.4, 71.1, 72.6, 69.6, 70.7, 74.1, 73.6, 73.4, 69.4, 73.3, 73.0, 73.7, 72.8, 74.0, 72.9, 71.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.513, Test loss: 1.560, Test accuracy: 26.20 

Round   1, Train loss: 1.273, Test loss: 1.251, Test accuracy: 45.80 

Round   2, Train loss: 1.117, Test loss: 1.017, Test accuracy: 57.60 

Round   3, Train loss: 1.005, Test loss: 1.011, Test accuracy: 59.80 

Round   4, Train loss: 0.935, Test loss: 0.955, Test accuracy: 62.10 

Round   5, Train loss: 0.842, Test loss: 0.992, Test accuracy: 62.90 

Round   6, Train loss: 0.778, Test loss: 0.915, Test accuracy: 64.30 

Round   7, Train loss: 0.698, Test loss: 0.939, Test accuracy: 67.30 

Round   8, Train loss: 0.644, Test loss: 0.851, Test accuracy: 70.00 

Round   9, Train loss: 0.594, Test loss: 0.774, Test accuracy: 70.80 

Round  10, Train loss: 0.543, Test loss: 0.914, Test accuracy: 66.60 

Round  11, Train loss: 0.507, Test loss: 0.955, Test accuracy: 68.00 

Round  12, Train loss: 0.449, Test loss: 0.881, Test accuracy: 71.10 

Round  13, Train loss: 0.407, Test loss: 0.910, Test accuracy: 70.80 

Round  14, Train loss: 0.376, Test loss: 0.912, Test accuracy: 71.00 

Round  15, Train loss: 0.358, Test loss: 0.934, Test accuracy: 69.10 

Round  16, Train loss: 0.307, Test loss: 0.888, Test accuracy: 73.50 

Round  17, Train loss: 0.283, Test loss: 0.868, Test accuracy: 71.70 

Round  18, Train loss: 0.252, Test loss: 0.930, Test accuracy: 71.80 

Round  19, Train loss: 0.241, Test loss: 0.957, Test accuracy: 73.10 

Round  20, Train loss: 0.222, Test loss: 1.001, Test accuracy: 72.90 

Round  21, Train loss: 0.191, Test loss: 0.989, Test accuracy: 72.80 

Round  22, Train loss: 0.180, Test loss: 0.934, Test accuracy: 74.20 

Round  23, Train loss: 0.151, Test loss: 1.000, Test accuracy: 72.20 

Round  24, Train loss: 0.144, Test loss: 1.036, Test accuracy: 72.00 

Round  25, Train loss: 0.133, Test loss: 1.086, Test accuracy: 71.00 

Round  26, Train loss: 0.116, Test loss: 1.021, Test accuracy: 74.60 

Round  27, Train loss: 0.111, Test loss: 1.079, Test accuracy: 73.30 

Round  28, Train loss: 0.096, Test loss: 1.055, Test accuracy: 74.20 

Round  29, Train loss: 0.099, Test loss: 1.132, Test accuracy: 73.00 

Round  30, Train loss: 0.103, Test loss: 1.036, Test accuracy: 74.20 

Round  31, Train loss: 0.097, Test loss: 1.149, Test accuracy: 72.50 

Round  32, Train loss: 0.087, Test loss: 1.021, Test accuracy: 75.20 

Round  33, Train loss: 0.079, Test loss: 1.168, Test accuracy: 72.70 

Round  34, Train loss: 0.068, Test loss: 1.096, Test accuracy: 73.10 

Round  35, Train loss: 0.065, Test loss: 1.067, Test accuracy: 74.00 

Round  36, Train loss: 0.052, Test loss: 1.055, Test accuracy: 75.20 

Round  37, Train loss: 0.063, Test loss: 1.135, Test accuracy: 73.60 

Round  38, Train loss: 0.052, Test loss: 1.187, Test accuracy: 73.90 

Round  39, Train loss: 0.048, Test loss: 1.181, Test accuracy: 73.40 

Final Round, Train loss: 0.034, Test loss: 1.187, Test accuracy: 73.50 

Average accuracy final 10 rounds: 73.78 

393.94117641448975
[6.499170780181885, 10.869303703308105, 15.47794508934021, 19.939338445663452, 24.37875008583069, 28.651389598846436, 33.14242696762085, 37.58004808425903, 41.966434955596924, 46.42234683036804, 50.761314392089844, 55.26798224449158, 59.6632182598114, 64.20439386367798, 68.6686601638794, 72.9977171421051, 77.4023551940918, 81.83919906616211, 86.21101641654968, 90.64002633094788, 95.01841449737549, 99.17542886734009, 103.6484899520874, 108.19453287124634, 112.58837652206421, 117.20624470710754, 121.41433334350586, 126.12884330749512, 130.79733514785767, 135.17193365097046, 139.76491737365723, 144.29121565818787, 148.828773021698, 153.29423213005066, 157.9409375190735, 162.2802312374115, 166.65945482254028, 170.85763144493103, 175.36014413833618, 180.00670909881592, 185.54972219467163]
[26.2, 45.8, 57.6, 59.8, 62.1, 62.9, 64.3, 67.3, 70.0, 70.8, 66.6, 68.0, 71.1, 70.8, 71.0, 69.1, 73.5, 71.7, 71.8, 73.1, 72.9, 72.8, 74.2, 72.2, 72.0, 71.0, 74.6, 73.3, 74.2, 73.0, 74.2, 72.5, 75.2, 72.7, 73.1, 74.0, 75.2, 73.6, 73.9, 73.4, 73.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.533, Test loss: 1.785, Test accuracy: 23.90
Round   1, Train loss: 1.277, Test loss: 1.338, Test accuracy: 43.80
Round   2, Train loss: 1.140, Test loss: 1.083, Test accuracy: 54.30
Round   3, Train loss: 1.017, Test loss: 1.029, Test accuracy: 58.90
Round   4, Train loss: 0.942, Test loss: 1.113, Test accuracy: 58.70
Round   5, Train loss: 0.850, Test loss: 0.954, Test accuracy: 63.10
Round   6, Train loss: 0.798, Test loss: 0.914, Test accuracy: 64.50
Round   7, Train loss: 0.723, Test loss: 0.812, Test accuracy: 70.50
Round   8, Train loss: 0.660, Test loss: 0.813, Test accuracy: 69.00
Round   9, Train loss: 0.595, Test loss: 0.849, Test accuracy: 68.40
Round  10, Train loss: 0.558, Test loss: 0.896, Test accuracy: 67.70
Round  11, Train loss: 0.526, Test loss: 0.884, Test accuracy: 69.60
Round  12, Train loss: 0.451, Test loss: 0.852, Test accuracy: 70.60
Round  13, Train loss: 0.412, Test loss: 0.892, Test accuracy: 70.90
Round  14, Train loss: 0.403, Test loss: 0.839, Test accuracy: 74.00
Round  15, Train loss: 0.375, Test loss: 0.786, Test accuracy: 73.70
Round  16, Train loss: 0.319, Test loss: 0.810, Test accuracy: 72.40
Round  17, Train loss: 0.299, Test loss: 0.802, Test accuracy: 74.70
Round  18, Train loss: 0.284, Test loss: 0.915, Test accuracy: 73.00
Round  19, Train loss: 0.237, Test loss: 0.845, Test accuracy: 73.10
Round  20, Train loss: 0.196, Test loss: 0.846, Test accuracy: 74.10
Round  21, Train loss: 0.199, Test loss: 0.989, Test accuracy: 71.90
Round  22, Train loss: 0.208, Test loss: 0.916, Test accuracy: 74.30
Round  23, Train loss: 0.174, Test loss: 0.960, Test accuracy: 72.70
Round  24, Train loss: 0.163, Test loss: 0.946, Test accuracy: 74.00
Round  25, Train loss: 0.138, Test loss: 0.981, Test accuracy: 74.20
Round  26, Train loss: 0.119, Test loss: 0.936, Test accuracy: 74.80
Round  27, Train loss: 0.120, Test loss: 0.974, Test accuracy: 73.90
Round  28, Train loss: 0.125, Test loss: 1.018, Test accuracy: 73.30
Round  29, Train loss: 0.104, Test loss: 1.005, Test accuracy: 73.60
Round  30, Train loss: 0.076, Test loss: 0.985, Test accuracy: 74.10
Round  31, Train loss: 0.071, Test loss: 0.955, Test accuracy: 77.40
Round  32, Train loss: 0.066, Test loss: 1.008, Test accuracy: 76.60
Round  33, Train loss: 0.081, Test loss: 0.954, Test accuracy: 75.50
Round  34, Train loss: 0.078, Test loss: 1.054, Test accuracy: 74.30
Round  35, Train loss: 0.073, Test loss: 1.032, Test accuracy: 75.50
Round  36, Train loss: 0.076, Test loss: 1.023, Test accuracy: 76.00
Round  37, Train loss: 0.044, Test loss: 0.973, Test accuracy: 76.30
Round  38, Train loss: 0.040, Test loss: 1.040, Test accuracy: 75.00
Round  39, Train loss: 0.041, Test loss: 1.037, Test accuracy: 75.80
Final Round, Train loss: 0.025, Test loss: 1.040, Test accuracy: 75.70
Average accuracy final 10 rounds: 75.64999999999999
433.1276776790619
[7.025851488113403, 11.999478101730347, 16.87526249885559, 21.85213589668274, 26.672942876815796, 31.497194051742554, 36.61736178398132, 42.027634382247925, 46.779072761535645, 51.58293581008911, 56.3522584438324, 61.45804977416992, 66.55019688606262, 71.81773495674133, 76.81746244430542, 81.59285950660706, 86.78227615356445, 91.617511510849, 96.55215048789978, 101.57195806503296, 106.46451711654663, 111.09856748580933, 115.84565162658691, 120.89091491699219, 125.98359656333923, 131.23177313804626, 136.49624705314636, 141.49916577339172, 146.47497391700745, 151.37169480323792, 156.3139796257019, 161.03616070747375, 166.11934900283813, 171.04017639160156, 176.00292539596558, 180.92351508140564, 186.17596006393433, 191.02817845344543, 195.9958701133728, 200.95382022857666, 205.86862182617188]
[23.9, 43.8, 54.3, 58.9, 58.7, 63.1, 64.5, 70.5, 69.0, 68.4, 67.7, 69.6, 70.6, 70.9, 74.0, 73.7, 72.4, 74.7, 73.0, 73.1, 74.1, 71.9, 74.3, 72.7, 74.0, 74.2, 74.8, 73.9, 73.3, 73.6, 74.1, 77.4, 76.6, 75.5, 74.3, 75.5, 76.0, 76.3, 75.0, 75.8, 75.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 1.589, Train accuracy: 53.600, Test loss: 2.631, Test accuracy: 44.00 

        train local model (freeze embeding):client   0,  Train loss: 0.512, Train accuracy: 80.200, Test loss: 1.081, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 1.084, Train accuracy: 60.400, Test loss: 2.007, Test accuracy: 49.20 

Round   0, Train loss: 1.084, Test loss: 2.007, Test accuracy: 49.20 

        train local model (freeze embeding):client   0,  Train loss: 0.338, Train accuracy: 88.000, Test loss: 1.157, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.341, Train accuracy: 87.200, Test loss: 1.467, Test accuracy: 60.60 

Round   1, Train loss: 0.341, Test loss: 1.467, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.214, Train accuracy: 91.800, Test loss: 1.187, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.105, Train accuracy: 97.400, Test loss: 1.132, Test accuracy: 71.60 

Round   2, Train loss: 0.105, Test loss: 1.132, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.075, Train accuracy: 97.400, Test loss: 1.179, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.065, Train accuracy: 98.000, Test loss: 1.543, Test accuracy: 67.20 

Round   3, Train loss: 0.065, Test loss: 1.543, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.200, Test loss: 1.391, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.100, Train accuracy: 96.400, Test loss: 1.544, Test accuracy: 67.20 

Round   4, Train loss: 0.100, Test loss: 1.544, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.047, Train accuracy: 98.800, Test loss: 1.461, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 98.800, Test loss: 1.671, Test accuracy: 66.60 

Round   5, Train loss: 0.029, Test loss: 1.671, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.630, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 98.400, Test loss: 1.700, Test accuracy: 66.20 

Round   6, Train loss: 0.034, Test loss: 1.700, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.031, Train accuracy: 98.600, Test loss: 1.659, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.399, Test accuracy: 69.40 

Round   7, Train loss: 0.011, Test loss: 1.399, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.363, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.539, Test accuracy: 68.40 

Round   8, Train loss: 0.018, Test loss: 1.539, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.497, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.873, Test accuracy: 67.00 

Round   9, Train loss: 0.015, Test loss: 1.873, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.611, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.600, Test loss: 1.632, Test accuracy: 69.40 

Round  10, Train loss: 0.022, Test loss: 1.632, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.578, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.619, Test accuracy: 68.40 

Round  11, Train loss: 0.004, Test loss: 1.619, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.679, Test accuracy: 71.20 

Round  12, Train loss: 0.002, Test loss: 1.679, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.687, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.069, Train accuracy: 98.200, Test loss: 2.053, Test accuracy: 67.20 

Round  13, Train loss: 0.069, Test loss: 2.053, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.200, Test loss: 1.914, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 1.848, Test accuracy: 66.20 

Round  14, Train loss: 0.021, Test loss: 1.848, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.620, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.812, Test accuracy: 65.80 

Round  15, Train loss: 0.007, Test loss: 1.812, Test accuracy: 65.80 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.752, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.621, Test accuracy: 70.00 

Round  16, Train loss: 0.001, Test loss: 1.621, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.599, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.673, Test accuracy: 69.60 

Round  17, Train loss: 0.001, Test loss: 1.673, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.637, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.814, Test accuracy: 65.00 

Round  18, Train loss: 0.021, Test loss: 1.814, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.640, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.754, Test accuracy: 69.40 

Round  19, Train loss: 0.006, Test loss: 1.754, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.772, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.816, Test accuracy: 70.20 

Final Round, Train loss: 0.002, Test loss: 1.786, Test accuracy: 70.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.866, Train accuracy: 67.800, Test loss: 0.947, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.833, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.697, Test accuracy: 70.40 

        train local model (freeze embeding):client   1,  Train loss: 0.833, Train accuracy: 66.400, Test loss: 1.006, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.461, Train accuracy: 83.000, Test loss: 1.191, Test accuracy: 66.60 

Round   0, Train loss: 0.231, Test loss: 1.202, Test accuracy: 70.70 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.598, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.669, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.278, Train accuracy: 90.800, Test loss: 0.708, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.318, Train accuracy: 88.000, Test loss: 1.403, Test accuracy: 71.20 

Round   1, Train loss: 0.159, Test loss: 1.288, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.732, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.400, Test loss: 1.811, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.149, Train accuracy: 94.800, Test loss: 0.789, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.057, Train accuracy: 97.800, Test loss: 0.840, Test accuracy: 77.00 

Round   2, Train loss: 0.034, Test loss: 1.195, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.578, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.564, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.060, Train accuracy: 98.200, Test loss: 0.779, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.600, Test loss: 1.008, Test accuracy: 74.60 

Round   3, Train loss: 0.039, Test loss: 1.139, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.466, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.620, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.052, Train accuracy: 98.200, Test loss: 0.897, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.086, Train accuracy: 97.000, Test loss: 1.056, Test accuracy: 77.80 

Round   4, Train loss: 0.044, Test loss: 1.204, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.488, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 0.860, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 0.921, Test accuracy: 78.00 

Round   5, Train loss: 0.013, Test loss: 1.107, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.012, Test accuracy: 77.40 

Round   6, Train loss: 0.013, Test loss: 1.143, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.452, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.829, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.196, Test accuracy: 74.20 

Round   7, Train loss: 0.009, Test loss: 1.196, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.606, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.547, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.019, Test accuracy: 76.80 

Round   8, Train loss: 0.012, Test loss: 1.145, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.470, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.564, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 98.600, Test loss: 1.077, Test accuracy: 77.80 

Round   9, Train loss: 0.015, Test loss: 1.219, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.493, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.657, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.105, Test accuracy: 74.40 

Round  10, Train loss: 0.012, Test loss: 1.212, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.520, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.726, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 78.40 

Round  11, Train loss: 0.002, Test loss: 1.260, Test accuracy: 74.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.753, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 78.60 

Round  12, Train loss: 0.004, Test loss: 1.304, Test accuracy: 74.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.539, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.582, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.107, Test accuracy: 76.40 

Round  13, Train loss: 0.003, Test loss: 1.242, Test accuracy: 75.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.656, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.620, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 77.40 

Round  14, Train loss: 0.000, Test loss: 1.308, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.528, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.580, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 77.20 

Round  15, Train loss: 0.001, Test loss: 1.234, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.481, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.666, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.246, Test accuracy: 72.80 

Round  16, Train loss: 0.011, Test loss: 1.244, Test accuracy: 73.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.564, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 77.20 

Round  17, Train loss: 0.002, Test loss: 1.271, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.501, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.668, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 78.20 

Round  18, Train loss: 0.005, Test loss: 1.227, Test accuracy: 75.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.554, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.653, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 80.20 

Round  19, Train loss: 0.001, Test loss: 1.281, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.571, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.459, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 79.00 

Final Round, Train loss: 0.000, Test loss: 1.269, Test accuracy: 76.00 

Average accuracy final 10 rounds: 143.42 

976.5520756244659
[15.004647016525269, 29.326602935791016, 44.442474365234375, 59.69478130340576, 74.13712167739868, 89.68506073951721, 104.60941505432129, 119.37540936470032, 134.13655376434326, 148.9950077533722, 164.07002592086792, 179.08316659927368, 194.47274470329285, 208.83423471450806, 223.54824090003967, 237.89541721343994, 253.09870767593384, 267.53974533081055, 281.9916024208069, 296.8447890281677, 305.92480278015137, 321.11235785484314, 336.5864863395691, 351.56596398353577, 366.86164116859436, 382.77271461486816, 397.65212750434875, 412.53896951675415, 427.513973236084, 442.8707013130188, 458.12862634658813, 473.39041566848755, 487.71699500083923, 503.0690698623657, 518.5012009143829, 533.5483984947205, 548.9220447540283, 563.7897489070892, 579.0036103725433, 594.4293251037598, 609.8837456703186, 618.2229039669037]
[49.2, 60.6, 71.6, 67.2, 67.2, 66.6, 66.2, 69.4, 68.4, 67.0, 69.4, 68.4, 71.2, 67.2, 66.2, 65.8, 70.0, 69.6, 65.0, 69.4, 70.0, 70.7, 71.4, 73.6, 74.4, 75.0, 74.6, 74.8, 74.6, 75.4, 75.4, 76.6, 74.9, 74.7, 75.7, 74.4, 75.8, 73.9, 74.4, 75.6, 76.0, 76.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.462, Test loss: 1.320, Test accuracy: 46.84 

Round   0, Global train loss: 1.462, Global test loss: 2.223, Global test accuracy: 21.84 

Round   1, Train loss: 1.148, Test loss: 1.299, Test accuracy: 52.68 

Round   1, Global train loss: 1.148, Global test loss: 2.203, Global test accuracy: 22.28 

Round   2, Train loss: 0.986, Test loss: 1.159, Test accuracy: 59.92 

Round   2, Global train loss: 0.986, Global test loss: 2.212, Global test accuracy: 21.64 

Round   3, Train loss: 0.848, Test loss: 1.242, Test accuracy: 58.56 

Round   3, Global train loss: 0.848, Global test loss: 2.259, Global test accuracy: 18.60 

Round   4, Train loss: 0.739, Test loss: 1.463, Test accuracy: 55.96 

Round   4, Global train loss: 0.739, Global test loss: 2.266, Global test accuracy: 18.32 

Round   5, Train loss: 0.644, Test loss: 1.266, Test accuracy: 63.00 

Round   5, Global train loss: 0.644, Global test loss: 2.263, Global test accuracy: 16.24 

Round   6, Train loss: 0.530, Test loss: 1.381, Test accuracy: 62.80 

Round   6, Global train loss: 0.530, Global test loss: 2.296, Global test accuracy: 19.00 

Round   7, Train loss: 0.453, Test loss: 1.257, Test accuracy: 66.84 

Round   7, Global train loss: 0.453, Global test loss: 2.271, Global test accuracy: 13.56 

Round   8, Train loss: 0.392, Test loss: 1.688, Test accuracy: 62.00 

Round   8, Global train loss: 0.392, Global test loss: 2.260, Global test accuracy: 15.24 

Round   9, Train loss: 0.330, Test loss: 1.462, Test accuracy: 65.28 

Round   9, Global train loss: 0.330, Global test loss: 2.279, Global test accuracy: 15.88 

Round  10, Train loss: 0.280, Test loss: 1.435, Test accuracy: 65.32 

Round  10, Global train loss: 0.280, Global test loss: 2.244, Global test accuracy: 15.08 

Round  11, Train loss: 0.237, Test loss: 1.564, Test accuracy: 66.32 

Round  11, Global train loss: 0.237, Global test loss: 2.240, Global test accuracy: 16.40 

Round  12, Train loss: 0.202, Test loss: 1.545, Test accuracy: 66.56 

Round  12, Global train loss: 0.202, Global test loss: 2.244, Global test accuracy: 18.12 

Round  13, Train loss: 0.165, Test loss: 1.681, Test accuracy: 65.84 

Round  13, Global train loss: 0.165, Global test loss: 2.222, Global test accuracy: 16.48 

Round  14, Train loss: 0.160, Test loss: 1.468, Test accuracy: 67.76 

Round  14, Global train loss: 0.160, Global test loss: 2.252, Global test accuracy: 16.92 

Round  15, Train loss: 0.131, Test loss: 1.693, Test accuracy: 65.80 

Round  15, Global train loss: 0.131, Global test loss: 2.246, Global test accuracy: 18.44 

Round  16, Train loss: 0.122, Test loss: 1.499, Test accuracy: 69.04 

Round  16, Global train loss: 0.122, Global test loss: 2.232, Global test accuracy: 20.28 

Round  17, Train loss: 0.084, Test loss: 1.636, Test accuracy: 67.68 

Round  17, Global train loss: 0.084, Global test loss: 2.253, Global test accuracy: 20.64 

Round  18, Train loss: 0.095, Test loss: 1.655, Test accuracy: 68.60 

Round  18, Global train loss: 0.095, Global test loss: 2.245, Global test accuracy: 17.92 

Round  19, Train loss: 0.069, Test loss: 1.568, Test accuracy: 70.28 

Round  19, Global train loss: 0.069, Global test loss: 2.240, Global test accuracy: 18.24 

Round  20, Train loss: 0.054, Test loss: 1.656, Test accuracy: 69.32 

Round  20, Global train loss: 0.054, Global test loss: 2.228, Global test accuracy: 19.68 

Round  21, Train loss: 0.053, Test loss: 1.651, Test accuracy: 69.08 

Round  21, Global train loss: 0.053, Global test loss: 2.242, Global test accuracy: 19.68 

Round  22, Train loss: 0.063, Test loss: 1.692, Test accuracy: 68.68 

Round  22, Global train loss: 0.063, Global test loss: 2.218, Global test accuracy: 18.32 

Round  23, Train loss: 0.047, Test loss: 1.702, Test accuracy: 69.04 

Round  23, Global train loss: 0.047, Global test loss: 2.242, Global test accuracy: 19.36 

Round  24, Train loss: 0.044, Test loss: 1.741, Test accuracy: 69.40 

Round  24, Global train loss: 0.044, Global test loss: 2.228, Global test accuracy: 18.88 

Round  25, Train loss: 0.055, Test loss: 1.865, Test accuracy: 67.76 

Round  25, Global train loss: 0.055, Global test loss: 2.230, Global test accuracy: 15.96 

Round  26, Train loss: 0.057, Test loss: 1.837, Test accuracy: 67.68 

Round  26, Global train loss: 0.057, Global test loss: 2.219, Global test accuracy: 20.00 

Round  27, Train loss: 0.046, Test loss: 1.749, Test accuracy: 69.68 

Round  27, Global train loss: 0.046, Global test loss: 2.226, Global test accuracy: 17.12 

Round  28, Train loss: 0.024, Test loss: 1.649, Test accuracy: 71.24 

Round  28, Global train loss: 0.024, Global test loss: 2.237, Global test accuracy: 15.28 

Round  29, Train loss: 0.033, Test loss: 1.772, Test accuracy: 70.84 

Round  29, Global train loss: 0.033, Global test loss: 2.234, Global test accuracy: 14.92 

Round  30, Train loss: 0.032, Test loss: 1.745, Test accuracy: 69.60 

Round  30, Global train loss: 0.032, Global test loss: 2.216, Global test accuracy: 16.88 

Round  31, Train loss: 0.042, Test loss: 1.809, Test accuracy: 68.60 

Round  31, Global train loss: 0.042, Global test loss: 2.232, Global test accuracy: 17.56 

Round  32, Train loss: 0.035, Test loss: 1.773, Test accuracy: 70.44 

Round  32, Global train loss: 0.035, Global test loss: 2.238, Global test accuracy: 15.92 

Round  33, Train loss: 0.019, Test loss: 1.739, Test accuracy: 70.00 

Round  33, Global train loss: 0.019, Global test loss: 2.229, Global test accuracy: 18.08 

Round  34, Train loss: 0.022, Test loss: 1.834, Test accuracy: 68.92 

Round  34, Global train loss: 0.022, Global test loss: 2.244, Global test accuracy: 17.92 

Final Round, Train loss: 0.018, Test loss: 1.722, Test accuracy: 70.84 

Final Round, Global train loss: 0.018, Global test loss: 2.244, Global test accuracy: 17.92 

Average accuracy final 10 rounds: 69.476 

Average global accuracy final 10 rounds: 16.964000000000002 

1143.4545679092407
[7.557682991027832, 13.010366678237915, 18.610679149627686, 24.28823208808899, 29.74852204322815, 35.48350524902344, 41.14680194854736, 46.73645901679993, 52.53851294517517, 58.01581025123596, 63.71379017829895, 69.3829414844513, 75.03900909423828, 80.8778784275055, 86.44243311882019, 91.9598617553711, 97.79069018363953, 103.27163290977478, 108.83657789230347, 114.78510737419128, 120.39839267730713, 126.45229029655457, 131.97311401367188, 137.5150887966156, 143.2318069934845, 148.89688634872437, 154.5440800189972, 160.13504028320312, 165.75954055786133, 171.38624811172485, 177.04361152648926, 182.8646478652954, 188.4195728302002, 194.1157796382904, 199.62547516822815, 210.54769659042358]
[46.84, 52.68, 59.92, 58.56, 55.96, 63.0, 62.8, 66.84, 62.0, 65.28, 65.32, 66.32, 66.56, 65.84, 67.76, 65.8, 69.04, 67.68, 68.6, 70.28, 69.32, 69.08, 68.68, 69.04, 69.4, 67.76, 67.68, 69.68, 71.24, 70.84, 69.6, 68.6, 70.44, 70.0, 68.92, 70.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.466, Test loss: 1.272, Test accuracy: 49.04 

Round   0, Global train loss: 1.466, Global test loss: 2.297, Global test accuracy: 21.92 

Round   1, Train loss: 1.346, Test loss: 1.185, Test accuracy: 50.80 

Round   1, Global train loss: 1.346, Global test loss: 2.021, Global test accuracy: 27.12 

Round   2, Train loss: 1.218, Test loss: 1.188, Test accuracy: 53.52 

Round   2, Global train loss: 1.218, Global test loss: 1.781, Global test accuracy: 33.88 

Round   3, Train loss: 1.107, Test loss: 1.195, Test accuracy: 56.52 

Round   3, Global train loss: 1.107, Global test loss: 1.779, Global test accuracy: 37.44 

Round   4, Train loss: 1.013, Test loss: 1.199, Test accuracy: 55.48 

Round   4, Global train loss: 1.013, Global test loss: 1.583, Global test accuracy: 43.64 

Round   5, Train loss: 0.932, Test loss: 1.249, Test accuracy: 58.08 

Round   5, Global train loss: 0.932, Global test loss: 1.392, Global test accuracy: 49.40 

Round   6, Train loss: 0.876, Test loss: 1.077, Test accuracy: 61.36 

Round   6, Global train loss: 0.876, Global test loss: 1.536, Global test accuracy: 46.60 

Round   7, Train loss: 0.802, Test loss: 1.077, Test accuracy: 64.24 

Round   7, Global train loss: 0.802, Global test loss: 1.370, Global test accuracy: 51.92 

Round   8, Train loss: 0.758, Test loss: 1.041, Test accuracy: 66.60 

Round   8, Global train loss: 0.758, Global test loss: 1.377, Global test accuracy: 51.88 

Round   9, Train loss: 0.689, Test loss: 1.122, Test accuracy: 64.64 

Round   9, Global train loss: 0.689, Global test loss: 1.253, Global test accuracy: 54.72 

Round  10, Train loss: 0.644, Test loss: 1.126, Test accuracy: 66.88 

Round  10, Global train loss: 0.644, Global test loss: 1.193, Global test accuracy: 57.28 

Round  11, Train loss: 0.600, Test loss: 1.134, Test accuracy: 67.08 

Round  11, Global train loss: 0.600, Global test loss: 1.198, Global test accuracy: 56.64 

Round  12, Train loss: 0.565, Test loss: 0.991, Test accuracy: 69.40 

Round  12, Global train loss: 0.565, Global test loss: 1.146, Global test accuracy: 59.04 

Round  13, Train loss: 0.524, Test loss: 1.120, Test accuracy: 66.72 

Round  13, Global train loss: 0.524, Global test loss: 1.237, Global test accuracy: 57.36 

Round  14, Train loss: 0.492, Test loss: 1.171, Test accuracy: 69.80 

Round  14, Global train loss: 0.492, Global test loss: 1.072, Global test accuracy: 62.72 

Round  15, Train loss: 0.451, Test loss: 1.228, Test accuracy: 67.16 

Round  15, Global train loss: 0.451, Global test loss: 1.146, Global test accuracy: 61.60 

Round  16, Train loss: 0.430, Test loss: 1.111, Test accuracy: 70.52 

Round  16, Global train loss: 0.430, Global test loss: 1.049, Global test accuracy: 64.52 

Round  17, Train loss: 0.399, Test loss: 1.188, Test accuracy: 68.84 

Round  17, Global train loss: 0.399, Global test loss: 1.088, Global test accuracy: 62.92 

Round  18, Train loss: 0.382, Test loss: 1.234, Test accuracy: 67.88 

Round  18, Global train loss: 0.382, Global test loss: 1.190, Global test accuracy: 61.56 

Round  19, Train loss: 0.354, Test loss: 0.969, Test accuracy: 73.84 

Round  19, Global train loss: 0.354, Global test loss: 1.083, Global test accuracy: 64.04 

Round  20, Train loss: 0.319, Test loss: 1.079, Test accuracy: 71.12 

Round  20, Global train loss: 0.319, Global test loss: 1.010, Global test accuracy: 65.48 

Round  21, Train loss: 0.314, Test loss: 1.004, Test accuracy: 73.04 

Round  21, Global train loss: 0.314, Global test loss: 1.081, Global test accuracy: 63.64 

Round  22, Train loss: 0.290, Test loss: 1.154, Test accuracy: 71.68 

Round  22, Global train loss: 0.290, Global test loss: 1.098, Global test accuracy: 64.48 

Round  23, Train loss: 0.262, Test loss: 1.059, Test accuracy: 73.16 

Round  23, Global train loss: 0.262, Global test loss: 1.105, Global test accuracy: 65.08 

Round  24, Train loss: 0.244, Test loss: 1.105, Test accuracy: 72.68 

Round  24, Global train loss: 0.244, Global test loss: 1.086, Global test accuracy: 65.96 

Round  25, Train loss: 0.236, Test loss: 1.130, Test accuracy: 72.48 

Round  25, Global train loss: 0.236, Global test loss: 1.043, Global test accuracy: 66.16 

Round  26, Train loss: 0.233, Test loss: 1.115, Test accuracy: 72.92 

Round  26, Global train loss: 0.233, Global test loss: 1.099, Global test accuracy: 66.08 

Round  27, Train loss: 0.208, Test loss: 1.134, Test accuracy: 71.80 

Round  27, Global train loss: 0.208, Global test loss: 1.071, Global test accuracy: 67.04 

Round  28, Train loss: 0.186, Test loss: 1.084, Test accuracy: 74.92 

Round  28, Global train loss: 0.186, Global test loss: 1.119, Global test accuracy: 66.20 

Round  29, Train loss: 0.188, Test loss: 1.061, Test accuracy: 75.32 

Round  29, Global train loss: 0.188, Global test loss: 1.094, Global test accuracy: 67.04 

Round  30, Train loss: 0.178, Test loss: 1.403, Test accuracy: 69.92 

Round  30, Global train loss: 0.178, Global test loss: 1.030, Global test accuracy: 68.32 

Round  31, Train loss: 0.173, Test loss: 1.088, Test accuracy: 74.52 

Round  31, Global train loss: 0.173, Global test loss: 1.080, Global test accuracy: 67.76 

Round  32, Train loss: 0.159, Test loss: 1.036, Test accuracy: 76.12 

Round  32, Global train loss: 0.159, Global test loss: 1.099, Global test accuracy: 66.36 

Round  33, Train loss: 0.132, Test loss: 1.135, Test accuracy: 75.08 

Round  33, Global train loss: 0.132, Global test loss: 1.129, Global test accuracy: 66.56 

Round  34, Train loss: 0.139, Test loss: 1.091, Test accuracy: 74.84 

Round  34, Global train loss: 0.139, Global test loss: 1.101, Global test accuracy: 66.00 

Round  35, Train loss: 0.133, Test loss: 1.156, Test accuracy: 74.40 

Round  35, Global train loss: 0.133, Global test loss: 1.140, Global test accuracy: 66.76 

Round  36, Train loss: 0.115, Test loss: 1.045, Test accuracy: 75.92 

Round  36, Global train loss: 0.115, Global test loss: 1.070, Global test accuracy: 67.68 

Round  37, Train loss: 0.100, Test loss: 1.010, Test accuracy: 78.12 

Round  37, Global train loss: 0.100, Global test loss: 1.063, Global test accuracy: 68.12 

Round  38, Train loss: 0.117, Test loss: 1.002, Test accuracy: 77.68 

Round  38, Global train loss: 0.117, Global test loss: 1.091, Global test accuracy: 68.52 

Round  39, Train loss: 0.095, Test loss: 1.116, Test accuracy: 76.36 

Round  39, Global train loss: 0.095, Global test loss: 1.134, Global test accuracy: 67.80 

Round  40, Train loss: 0.108, Test loss: 1.034, Test accuracy: 76.64 

Round  40, Global train loss: 0.108, Global test loss: 1.074, Global test accuracy: 68.48 

Round  41, Train loss: 0.081, Test loss: 1.333, Test accuracy: 75.16 

Round  41, Global train loss: 0.081, Global test loss: 1.148, Global test accuracy: 67.60 

Round  42, Train loss: 0.098, Test loss: 1.141, Test accuracy: 75.12 

Round  42, Global train loss: 0.098, Global test loss: 1.102, Global test accuracy: 68.12 

Round  43, Train loss: 0.084, Test loss: 1.231, Test accuracy: 75.20 

Round  43, Global train loss: 0.084, Global test loss: 1.108, Global test accuracy: 68.68 

Round  44, Train loss: 0.071, Test loss: 1.269, Test accuracy: 75.20 

Round  44, Global train loss: 0.071, Global test loss: 1.091, Global test accuracy: 68.64 

Round  45, Train loss: 0.081, Test loss: 1.099, Test accuracy: 76.12 

Round  45, Global train loss: 0.081, Global test loss: 1.079, Global test accuracy: 68.56 

Round  46, Train loss: 0.055, Test loss: 0.996, Test accuracy: 77.96 

Round  46, Global train loss: 0.055, Global test loss: 1.067, Global test accuracy: 69.84 

Round  47, Train loss: 0.073, Test loss: 1.057, Test accuracy: 77.44 

Round  47, Global train loss: 0.073, Global test loss: 1.094, Global test accuracy: 68.80 

Round  48, Train loss: 0.061, Test loss: 1.137, Test accuracy: 76.40 

Round  48, Global train loss: 0.061, Global test loss: 1.116, Global test accuracy: 69.44 

Round  49, Train loss: 0.072, Test loss: 1.060, Test accuracy: 78.04 

Round  49, Global train loss: 0.072, Global test loss: 1.177, Global test accuracy: 68.08 

Final Round, Train loss: 0.083, Test loss: 1.225, Test accuracy: 75.16 

Final Round, Global train loss: 0.083, Global test loss: 1.177, Global test accuracy: 68.08 

Average accuracy final 10 rounds: 76.328 

Average global accuracy final 10 rounds: 68.62400000000001 

1626.518806219101
[7.544736862182617, 13.381757736206055, 19.119218587875366, 24.838085651397705, 30.41819453239441, 36.08003306388855, 41.63322973251343, 47.62103295326233, 53.72731924057007, 59.27663326263428, 64.98676538467407, 70.72650504112244, 76.33635377883911, 81.96820402145386, 87.70346164703369, 93.37680792808533, 99.28209519386292, 105.15709805488586, 110.68280386924744, 116.13080763816833, 121.93030214309692, 127.90939140319824, 133.5324900150299, 139.43987488746643, 145.16895031929016, 150.82558155059814, 156.7356894016266, 162.59673953056335, 168.35171627998352, 173.97532963752747, 179.66882157325745, 185.40164256095886, 191.01103925704956, 196.5268702507019, 202.11218094825745, 207.7714011669159, 213.59537553787231, 219.17501878738403, 224.78748416900635, 230.42725896835327, 236.29293274879456, 242.0299243927002, 247.71231150627136, 253.52045059204102, 259.18611669540405, 264.941118478775, 270.5561680793762, 276.1461899280548, 281.694931268692, 287.22665333747864, 298.8467047214508]
[49.04, 50.8, 53.52, 56.52, 55.48, 58.08, 61.36, 64.24, 66.6, 64.64, 66.88, 67.08, 69.4, 66.72, 69.8, 67.16, 70.52, 68.84, 67.88, 73.84, 71.12, 73.04, 71.68, 73.16, 72.68, 72.48, 72.92, 71.8, 74.92, 75.32, 69.92, 74.52, 76.12, 75.08, 74.84, 74.4, 75.92, 78.12, 77.68, 76.36, 76.64, 75.16, 75.12, 75.2, 75.2, 76.12, 77.96, 77.44, 76.4, 78.04, 75.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.551, Test loss: 1.887, Test accuracy: 24.24 

Round   1, Train loss: 1.373, Test loss: 1.503, Test accuracy: 34.96 

Round   2, Train loss: 1.257, Test loss: 1.329, Test accuracy: 45.32 

Round   3, Train loss: 1.176, Test loss: 1.180, Test accuracy: 50.32 

Round   4, Train loss: 1.101, Test loss: 1.207, Test accuracy: 51.20 

Round   5, Train loss: 1.031, Test loss: 1.007, Test accuracy: 58.08 

Round   6, Train loss: 0.968, Test loss: 0.964, Test accuracy: 59.72 

Round   7, Train loss: 0.928, Test loss: 0.970, Test accuracy: 60.48 

Round   8, Train loss: 0.888, Test loss: 0.972, Test accuracy: 62.20 

Round   9, Train loss: 0.829, Test loss: 0.881, Test accuracy: 66.00 

Round  10, Train loss: 0.801, Test loss: 0.860, Test accuracy: 67.08 

Round  11, Train loss: 0.746, Test loss: 0.771, Test accuracy: 70.40 

Round  12, Train loss: 0.719, Test loss: 0.918, Test accuracy: 65.48 

Round  13, Train loss: 0.668, Test loss: 0.799, Test accuracy: 69.88 

Round  14, Train loss: 0.651, Test loss: 0.820, Test accuracy: 69.84 

Round  15, Train loss: 0.613, Test loss: 0.831, Test accuracy: 68.72 

Round  16, Train loss: 0.575, Test loss: 0.721, Test accuracy: 72.64 

Round  17, Train loss: 0.540, Test loss: 0.748, Test accuracy: 72.76 

Round  18, Train loss: 0.512, Test loss: 0.711, Test accuracy: 74.36 

Round  19, Train loss: 0.479, Test loss: 0.725, Test accuracy: 73.28 

Round  20, Train loss: 0.467, Test loss: 0.761, Test accuracy: 74.08 

Round  21, Train loss: 0.432, Test loss: 0.672, Test accuracy: 76.04 

Round  22, Train loss: 0.402, Test loss: 0.692, Test accuracy: 75.56 

Round  23, Train loss: 0.386, Test loss: 0.667, Test accuracy: 76.40 

Round  24, Train loss: 0.359, Test loss: 0.703, Test accuracy: 76.48 

Round  25, Train loss: 0.330, Test loss: 0.672, Test accuracy: 76.48 

Round  26, Train loss: 0.314, Test loss: 0.697, Test accuracy: 76.52 

Round  27, Train loss: 0.302, Test loss: 0.683, Test accuracy: 76.72 

Round  28, Train loss: 0.284, Test loss: 0.660, Test accuracy: 77.40 

Round  29, Train loss: 0.263, Test loss: 0.659, Test accuracy: 78.04 

Round  30, Train loss: 0.252, Test loss: 0.672, Test accuracy: 77.96 

Round  31, Train loss: 0.232, Test loss: 0.677, Test accuracy: 76.92 

Round  32, Train loss: 0.221, Test loss: 0.679, Test accuracy: 78.28 

Round  33, Train loss: 0.206, Test loss: 0.676, Test accuracy: 78.84 

Round  34, Train loss: 0.197, Test loss: 0.688, Test accuracy: 78.64 

Round  35, Train loss: 0.173, Test loss: 0.694, Test accuracy: 78.36 

Round  36, Train loss: 0.176, Test loss: 0.668, Test accuracy: 78.88 

Round  37, Train loss: 0.154, Test loss: 0.666, Test accuracy: 79.24 

Round  38, Train loss: 0.154, Test loss: 0.681, Test accuracy: 79.40 

Round  39, Train loss: 0.146, Test loss: 0.672, Test accuracy: 78.92 

Round  40, Train loss: 0.141, Test loss: 0.696, Test accuracy: 78.76 

Round  41, Train loss: 0.127, Test loss: 0.656, Test accuracy: 79.32 

Round  42, Train loss: 0.103, Test loss: 0.674, Test accuracy: 79.28 

Round  43, Train loss: 0.111, Test loss: 0.733, Test accuracy: 77.64 

Round  44, Train loss: 0.107, Test loss: 0.694, Test accuracy: 79.76 

Round  45, Train loss: 0.090, Test loss: 0.707, Test accuracy: 80.12 

Round  46, Train loss: 0.100, Test loss: 0.683, Test accuracy: 80.08 

Round  47, Train loss: 0.095, Test loss: 0.697, Test accuracy: 79.96 

Round  48, Train loss: 0.076, Test loss: 0.707, Test accuracy: 80.16 

Round  49, Train loss: 0.086, Test loss: 0.713, Test accuracy: 80.60 

Final Round, Train loss: 0.044, Test loss: 0.715, Test accuracy: 80.60 

Average accuracy final 10 rounds: 79.568 

1196.115990638733
[6.612208843231201, 11.159946918487549, 15.55414342880249, 20.047471523284912, 24.603781700134277, 29.01061224937439, 33.477415323257446, 38.02164626121521, 42.54991602897644, 46.942644357681274, 51.1518337726593, 55.618306398391724, 59.9409613609314, 64.45990943908691, 68.94534802436829, 73.34884762763977, 77.6149492263794, 82.43468379974365, 86.9238350391388, 91.42001414299011, 95.80460023880005, 100.20532989501953, 104.68960952758789, 109.09555721282959, 113.4255211353302, 117.8443295955658, 122.30945205688477, 126.90410780906677, 131.27465200424194, 135.66410088539124, 140.20745992660522, 144.76323413848877, 149.18238973617554, 153.55732822418213, 158.04035902023315, 162.50965213775635, 167.1638913154602, 171.9401135444641, 176.5659384727478, 180.9950635433197, 185.49663162231445, 190.08248853683472, 194.66221618652344, 198.99798774719238, 203.4581823348999, 207.70163536071777, 212.0670952796936, 216.6788341999054, 221.08309078216553, 225.47583937644958, 230.4880051612854]
[24.24, 34.96, 45.32, 50.32, 51.2, 58.08, 59.72, 60.48, 62.2, 66.0, 67.08, 70.4, 65.48, 69.88, 69.84, 68.72, 72.64, 72.76, 74.36, 73.28, 74.08, 76.04, 75.56, 76.4, 76.48, 76.48, 76.52, 76.72, 77.4, 78.04, 77.96, 76.92, 78.28, 78.84, 78.64, 78.36, 78.88, 79.24, 79.4, 78.92, 78.76, 79.32, 79.28, 77.64, 79.76, 80.12, 80.08, 79.96, 80.16, 80.6, 80.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.565, Test loss: 1.864, Test accuracy: 23.52
Round   1, Train loss: 1.349, Test loss: 1.539, Test accuracy: 36.56
Round   2, Train loss: 1.246, Test loss: 1.345, Test accuracy: 44.72
Round   3, Train loss: 1.163, Test loss: 1.254, Test accuracy: 49.76
Round   4, Train loss: 1.096, Test loss: 1.301, Test accuracy: 48.88
Round   5, Train loss: 1.019, Test loss: 1.082, Test accuracy: 57.00
Round   6, Train loss: 0.968, Test loss: 0.980, Test accuracy: 58.92
Round   7, Train loss: 0.922, Test loss: 0.937, Test accuracy: 60.40
Round   8, Train loss: 0.878, Test loss: 1.017, Test accuracy: 59.24
Round   9, Train loss: 0.828, Test loss: 0.914, Test accuracy: 64.84
Round  10, Train loss: 0.790, Test loss: 0.829, Test accuracy: 67.28
Round  11, Train loss: 0.745, Test loss: 0.881, Test accuracy: 65.52
Round  12, Train loss: 0.713, Test loss: 0.836, Test accuracy: 67.64
Round  13, Train loss: 0.671, Test loss: 0.796, Test accuracy: 68.92
Round  14, Train loss: 0.645, Test loss: 0.915, Test accuracy: 66.80
Round  15, Train loss: 0.613, Test loss: 0.733, Test accuracy: 71.96
Round  16, Train loss: 0.575, Test loss: 0.753, Test accuracy: 72.24
Round  17, Train loss: 0.534, Test loss: 0.800, Test accuracy: 71.40
Round  18, Train loss: 0.514, Test loss: 0.707, Test accuracy: 74.36
Round  19, Train loss: 0.477, Test loss: 0.720, Test accuracy: 74.44
Round  20, Train loss: 0.455, Test loss: 0.711, Test accuracy: 75.12
Round  21, Train loss: 0.431, Test loss: 0.725, Test accuracy: 74.28
Round  22, Train loss: 0.414, Test loss: 0.692, Test accuracy: 75.76
Round  23, Train loss: 0.383, Test loss: 0.703, Test accuracy: 76.16
Round  24, Train loss: 0.368, Test loss: 0.708, Test accuracy: 75.32
Round  25, Train loss: 0.343, Test loss: 0.667, Test accuracy: 77.08
Round  26, Train loss: 0.333, Test loss: 0.676, Test accuracy: 76.68
Round  27, Train loss: 0.309, Test loss: 0.705, Test accuracy: 76.04
Round  28, Train loss: 0.287, Test loss: 0.701, Test accuracy: 76.84
Round  29, Train loss: 0.273, Test loss: 0.689, Test accuracy: 76.68
Round  30, Train loss: 0.243, Test loss: 0.665, Test accuracy: 78.24
Round  31, Train loss: 0.246, Test loss: 0.700, Test accuracy: 76.68
Round  32, Train loss: 0.229, Test loss: 0.679, Test accuracy: 77.68
Round  33, Train loss: 0.219, Test loss: 0.668, Test accuracy: 78.12
Round  34, Train loss: 0.200, Test loss: 0.710, Test accuracy: 77.40
Round  35, Train loss: 0.199, Test loss: 0.675, Test accuracy: 78.88
Round  36, Train loss: 0.175, Test loss: 0.692, Test accuracy: 78.08
Round  37, Train loss: 0.176, Test loss: 0.711, Test accuracy: 77.92
Round  38, Train loss: 0.155, Test loss: 0.691, Test accuracy: 78.72
Round  39, Train loss: 0.151, Test loss: 0.695, Test accuracy: 78.96
Round  40, Train loss: 0.151, Test loss: 0.691, Test accuracy: 78.36
Round  41, Train loss: 0.136, Test loss: 0.702, Test accuracy: 78.32
Round  42, Train loss: 0.127, Test loss: 0.704, Test accuracy: 78.76
Round  43, Train loss: 0.114, Test loss: 0.713, Test accuracy: 78.80
Round  44, Train loss: 0.124, Test loss: 0.681, Test accuracy: 79.76
Round  45, Train loss: 0.102, Test loss: 0.736, Test accuracy: 78.68
Round  46, Train loss: 0.089, Test loss: 0.705, Test accuracy: 78.32
Round  47, Train loss: 0.088, Test loss: 0.707, Test accuracy: 78.60
Round  48, Train loss: 0.091, Test loss: 0.730, Test accuracy: 78.60
Round  49, Train loss: 0.095, Test loss: 0.704, Test accuracy: 79.40
Final Round, Train loss: 0.046, Test loss: 0.714, Test accuracy: 79.20
Average accuracy final 10 rounds: 78.75999999999999
1329.9729535579681
[6.904970169067383, 12.108075857162476, 17.2649507522583, 22.542754888534546, 27.601638793945312, 32.57949876785278, 37.84529685974121, 42.92541980743408, 48.54762387275696, 53.38264751434326, 58.52659296989441, 63.580854654312134, 68.64558553695679, 73.4941942691803, 78.58698511123657, 84.00072836875916, 88.83817100524902, 93.7134268283844, 98.86026787757874, 103.70402574539185, 108.65899991989136, 114.00910234451294, 119.12009167671204, 124.10548424720764, 128.99538040161133, 134.11656999588013, 139.1580104827881, 144.22127842903137, 149.25482749938965, 154.21534419059753, 159.24639797210693, 164.11200952529907, 169.02732491493225, 173.95679187774658, 179.09964847564697, 184.03638458251953, 188.906911611557, 194.04366326332092, 199.2936611175537, 204.48956060409546, 209.44964456558228, 214.41321182250977, 219.28201413154602, 224.1691677570343, 229.20505714416504, 234.28241562843323, 239.38661932945251, 244.3476688861847, 249.46032547950745, 254.5899350643158, 259.5777003765106]
[23.52, 36.56, 44.72, 49.76, 48.88, 57.0, 58.92, 60.4, 59.24, 64.84, 67.28, 65.52, 67.64, 68.92, 66.8, 71.96, 72.24, 71.4, 74.36, 74.44, 75.12, 74.28, 75.76, 76.16, 75.32, 77.08, 76.68, 76.04, 76.84, 76.68, 78.24, 76.68, 77.68, 78.12, 77.4, 78.88, 78.08, 77.92, 78.72, 78.96, 78.36, 78.32, 78.76, 78.8, 79.76, 78.68, 78.32, 78.6, 78.6, 79.4, 79.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.836, Train accuracy: 73.000, Test loss: 1.407, Test accuracy: 60.20 

        train local model (freeze embeding):client   0,  Train loss: 0.467, Train accuracy: 82.400, Test loss: 1.054, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.575, Train accuracy: 78.600, Test loss: 1.444, Test accuracy: 59.00 

Round   0, Train loss: 0.575, Test loss: 1.444, Test accuracy: 59.00 

        train local model (freeze embeding):client   0,  Train loss: 0.255, Train accuracy: 91.600, Test loss: 1.120, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.276, Train accuracy: 89.200, Test loss: 1.159, Test accuracy: 67.40 

Round   1, Train loss: 0.276, Test loss: 1.159, Test accuracy: 67.40 

        train local model (freeze embeding):client   0,  Train loss: 0.166, Train accuracy: 94.600, Test loss: 1.106, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.253, Train accuracy: 91.200, Test loss: 1.819, Test accuracy: 64.40 

Round   2, Train loss: 0.253, Test loss: 1.819, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.079, Train accuracy: 97.600, Test loss: 1.288, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.115, Train accuracy: 95.800, Test loss: 1.659, Test accuracy: 67.40 

Round   3, Train loss: 0.115, Test loss: 1.659, Test accuracy: 67.40 

        train local model (freeze embeding):client   0,  Train loss: 0.056, Train accuracy: 98.000, Test loss: 1.385, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.392, Test accuracy: 71.80 

Round   4, Train loss: 0.028, Test loss: 1.392, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 1.436, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.513, Test accuracy: 67.00 

Round   5, Train loss: 0.062, Test loss: 1.513, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.341, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.101, Train accuracy: 95.600, Test loss: 1.599, Test accuracy: 67.20 

Round   6, Train loss: 0.101, Test loss: 1.599, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.464, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 98.200, Test loss: 1.574, Test accuracy: 72.60 

Round   7, Train loss: 0.057, Test loss: 1.574, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.521, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.467, Test accuracy: 71.60 

Round   8, Train loss: 0.015, Test loss: 1.467, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.084, Train accuracy: 96.600, Test loss: 1.655, Test accuracy: 67.60 

Round   9, Train loss: 0.084, Test loss: 1.655, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.529, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.467, Test accuracy: 73.20 

Round  10, Train loss: 0.002, Test loss: 1.467, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.426, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 74.60 

Round  11, Train loss: 0.002, Test loss: 1.312, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.047, Train accuracy: 98.200, Test loss: 1.721, Test accuracy: 71.20 

Round  12, Train loss: 0.047, Test loss: 1.721, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.480, Test accuracy: 72.80 

Round  13, Train loss: 0.002, Test loss: 1.480, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.490, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.619, Test accuracy: 72.80 

Round  14, Train loss: 0.001, Test loss: 1.619, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.622, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.609, Test accuracy: 71.60 

Round  15, Train loss: 0.002, Test loss: 1.609, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.758, Test accuracy: 70.40 

Round  16, Train loss: 0.003, Test loss: 1.758, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.783, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.651, Test accuracy: 70.40 

Round  17, Train loss: 0.004, Test loss: 1.651, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.554, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.774, Test accuracy: 68.60 

Round  18, Train loss: 0.006, Test loss: 1.774, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.620, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 1.562, Test accuracy: 72.60 

Round  19, Train loss: 0.013, Test loss: 1.562, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.521, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.525, Test accuracy: 71.80 

Final Round, Train loss: 0.004, Test loss: 1.576, Test accuracy: 72.40 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.851, Train accuracy: 66.800, Test loss: 1.106, Test accuracy: 57.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.543, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.735, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.865, Train accuracy: 64.400, Test loss: 1.024, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.438, Train accuracy: 82.200, Test loss: 1.261, Test accuracy: 63.80 

Round   0, Train loss: 0.220, Test loss: 1.187, Test accuracy: 69.70 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.345, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.516, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.309, Train accuracy: 90.600, Test loss: 0.876, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.123, Train accuracy: 96.000, Test loss: 1.212, Test accuracy: 67.00 

Round   1, Train loss: 0.067, Test loss: 1.132, Test accuracy: 72.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.267, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.280, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.145, Train accuracy: 96.200, Test loss: 0.949, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 98.000, Test loss: 1.263, Test accuracy: 70.60 

Round   2, Train loss: 0.034, Test loss: 1.084, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.052, Train accuracy: 97.800, Test loss: 1.557, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.059, Train accuracy: 99.000, Test loss: 1.043, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.136, Train accuracy: 94.800, Test loss: 1.459, Test accuracy: 67.20 

Round   3, Train loss: 0.094, Test loss: 1.213, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.105, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.054, Train accuracy: 98.800, Test loss: 1.046, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 97.600, Test loss: 1.439, Test accuracy: 65.80 

Round   4, Train loss: 0.039, Test loss: 1.089, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.457, Test accuracy: 66.40 

Round   5, Train loss: 0.009, Test loss: 1.208, Test accuracy: 73.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.184, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.072, Train accuracy: 97.600, Test loss: 1.521, Test accuracy: 69.00 

Round   6, Train loss: 0.037, Test loss: 1.252, Test accuracy: 73.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 97.600, Test loss: 1.604, Test accuracy: 67.20 

Round   7, Train loss: 0.031, Test loss: 1.185, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.361, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.279, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.085, Train accuracy: 97.400, Test loss: 1.717, Test accuracy: 66.20 

Round   8, Train loss: 0.043, Test loss: 1.293, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.306, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.353, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.569, Test accuracy: 68.40 

Round   9, Train loss: 0.006, Test loss: 1.294, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.281, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.322, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 99.400, Test loss: 1.506, Test accuracy: 70.40 

Round  10, Train loss: 0.019, Test loss: 1.273, Test accuracy: 74.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 71.60 

Round  11, Train loss: 0.001, Test loss: 1.256, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.530, Test accuracy: 70.60 

Round  12, Train loss: 0.001, Test loss: 1.342, Test accuracy: 74.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.281, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.416, Test accuracy: 69.60 

Round  13, Train loss: 0.003, Test loss: 1.346, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.287, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.555, Test accuracy: 71.20 

Round  14, Train loss: 0.002, Test loss: 1.300, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.399, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.550, Test accuracy: 69.40 

Round  15, Train loss: 0.002, Test loss: 1.341, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.701, Test accuracy: 69.80 

Round  16, Train loss: 0.003, Test loss: 1.397, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.371, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.387, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.200, Test loss: 1.651, Test accuracy: 69.80 

Round  17, Train loss: 0.008, Test loss: 1.379, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.629, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.600, Test loss: 1.849, Test accuracy: 67.80 

Round  18, Train loss: 0.011, Test loss: 1.498, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.409, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.536, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.583, Test accuracy: 70.60 

Round  19, Train loss: 0.001, Test loss: 1.405, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.522, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.486, Test accuracy: 70.40 

Final Round, Train loss: 0.000, Test loss: 1.393, Test accuracy: 74.90 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.747, Train accuracy: 66.800, Test loss: 0.997, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.483, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.665, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.652, Train accuracy: 75.000, Test loss: 0.876, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.199, Train accuracy: 92.800, Test loss: 1.346, Test accuracy: 64.60 

Round   0, Train loss: 0.067, Test loss: 1.187, Test accuracy: 72.87 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.507, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 1.716, Test accuracy: 66.80 

        train local model (freeze embeding):client   2,  Train loss: 0.326, Train accuracy: 87.000, Test loss: 0.855, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.135, Train accuracy: 96.000, Test loss: 1.197, Test accuracy: 67.80 

Round   1, Train loss: 0.053, Test loss: 1.178, Test accuracy: 73.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.516, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.504, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.860, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.181, Train accuracy: 93.400, Test loss: 0.881, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.191, Train accuracy: 90.800, Test loss: 1.411, Test accuracy: 63.80 

Round   2, Train loss: 0.079, Test loss: 1.178, Test accuracy: 73.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.396, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.226, Train accuracy: 93.600, Test loss: 2.840, Test accuracy: 56.60 

        train local model (freeze embeding):client   2,  Train loss: 0.136, Train accuracy: 95.600, Test loss: 1.020, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.048, Train accuracy: 98.600, Test loss: 1.357, Test accuracy: 69.60 

Round   3, Train loss: 0.092, Test loss: 1.213, Test accuracy: 72.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.185, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.303, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.594, Test accuracy: 71.60 

        train local model (freeze embeding):client   2,  Train loss: 0.067, Train accuracy: 98.400, Test loss: 1.066, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 97.800, Test loss: 1.322, Test accuracy: 68.40 

Round   4, Train loss: 0.022, Test loss: 1.161, Test accuracy: 74.47 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.603, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.411, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.039, Train accuracy: 98.600, Test loss: 1.669, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.049, Train accuracy: 98.800, Test loss: 1.074, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 98.600, Test loss: 1.488, Test accuracy: 67.40 

Round   5, Train loss: 0.032, Test loss: 1.228, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.166, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.617, Test accuracy: 66.00 

Round   6, Train loss: 0.014, Test loss: 1.184, Test accuracy: 74.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.243, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.592, Test accuracy: 74.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.561, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.108, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.444, Test accuracy: 69.20 

Round   7, Train loss: 0.010, Test loss: 1.234, Test accuracy: 73.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.398, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.345, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.519, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.414, Test accuracy: 70.80 

Round   8, Train loss: 0.004, Test loss: 1.237, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.223, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.519, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.546, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.574, Test accuracy: 69.40 

Round   9, Train loss: 0.003, Test loss: 1.273, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.607, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.311, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.573, Test accuracy: 71.20 

Round  10, Train loss: 0.002, Test loss: 1.309, Test accuracy: 74.47 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.581, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.446, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.226, Train accuracy: 92.400, Test loss: 2.660, Test accuracy: 61.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 98.600, Test loss: 1.551, Test accuracy: 68.20 

Round  11, Train loss: 0.089, Test loss: 1.238, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.232, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.260, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.923, Test accuracy: 68.60 

Round  12, Train loss: 0.005, Test loss: 1.306, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.172, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.405, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.336, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.606, Test accuracy: 68.40 

Round  13, Train loss: 0.008, Test loss: 1.290, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.184, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.634, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.614, Test accuracy: 69.80 

Round  14, Train loss: 0.003, Test loss: 1.287, Test accuracy: 74.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.556, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.587, Test accuracy: 66.60 

Round  15, Train loss: 0.015, Test loss: 1.230, Test accuracy: 74.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.153, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.332, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 71.60 

Round  16, Train loss: 0.002, Test loss: 1.234, Test accuracy: 76.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.199, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.421, Test accuracy: 72.40 

Round  17, Train loss: 0.001, Test loss: 1.288, Test accuracy: 75.47 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.329, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.609, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.306, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.436, Test accuracy: 70.80 

Round  18, Train loss: 0.000, Test loss: 1.304, Test accuracy: 75.47 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.177, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.246, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.636, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 1.835, Test accuracy: 64.40 

Round  19, Train loss: 0.014, Test loss: 1.287, Test accuracy: 74.67 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 71.60 

Final Round, Train loss: 0.000, Test loss: 1.266, Test accuracy: 74.40 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.588, Train accuracy: 77.600, Test loss: 0.835, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.419, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.616, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.571, Train accuracy: 77.600, Test loss: 0.828, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.068, Train accuracy: 98.200, Test loss: 0.895, Test accuracy: 76.60 

Round   0, Train loss: 0.020, Test loss: 1.069, Test accuracy: 75.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 74.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.651, Test accuracy: 66.80 

        train local model (freeze embeding):client   3,  Train loss: 0.300, Train accuracy: 89.400, Test loss: 0.771, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.061, Train accuracy: 98.400, Test loss: 0.902, Test accuracy: 75.20 

Round   1, Train loss: 0.016, Test loss: 1.070, Test accuracy: 74.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.246, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.709, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 1.557, Test accuracy: 68.20 

        train local model (freeze embeding):client   3,  Train loss: 0.141, Train accuracy: 95.400, Test loss: 0.739, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.097, Train accuracy: 96.400, Test loss: 1.225, Test accuracy: 72.80 

Round   2, Train loss: 0.029, Test loss: 1.064, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.357, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.634, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.207, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 70.20 

        train local model (freeze embeding):client   3,  Train loss: 0.091, Train accuracy: 97.600, Test loss: 0.750, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.178, Train accuracy: 93.800, Test loss: 1.272, Test accuracy: 70.60 

Round   3, Train loss: 0.046, Test loss: 1.083, Test accuracy: 76.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 98.800, Test loss: 1.689, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.845, Test accuracy: 67.00 

        train local model (freeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.800, Test loss: 0.776, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.067, Train accuracy: 98.200, Test loss: 1.045, Test accuracy: 75.00 

Round   4, Train loss: 0.027, Test loss: 1.045, Test accuracy: 76.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.278, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.474, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.210, Train accuracy: 93.400, Test loss: 2.533, Test accuracy: 61.60 

        train local model (freeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.800, Test loss: 0.771, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.110, Train accuracy: 95.800, Test loss: 1.338, Test accuracy: 71.60 

Round   5, Train loss: 0.081, Test loss: 1.101, Test accuracy: 75.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.458, Test accuracy: 74.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.182, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.628, Test accuracy: 67.00 

        train local model (freeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.600, Test loss: 0.845, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.071, Train accuracy: 97.400, Test loss: 1.310, Test accuracy: 71.20 

Round   6, Train loss: 0.023, Test loss: 1.043, Test accuracy: 76.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.089, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.297, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.415, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.048, Train accuracy: 98.200, Test loss: 1.245, Test accuracy: 75.20 

Round   7, Train loss: 0.015, Test loss: 1.051, Test accuracy: 77.55 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.990, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.152, Test accuracy: 76.60 

Round   8, Train loss: 0.011, Test loss: 1.074, Test accuracy: 76.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.746, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 77.00 

Round   9, Train loss: 0.007, Test loss: 1.047, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.268, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.247, Test accuracy: 75.80 

Round  10, Train loss: 0.003, Test loss: 1.067, Test accuracy: 77.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.119, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.663, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.336, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.878, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.068, Train accuracy: 98.000, Test loss: 1.219, Test accuracy: 75.20 

Round  11, Train loss: 0.022, Test loss: 1.065, Test accuracy: 76.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 77.40 

Round  12, Train loss: 0.002, Test loss: 1.084, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.347, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.627, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 79.60 

Round  13, Train loss: 0.000, Test loss: 1.052, Test accuracy: 77.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.354, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.445, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 1.297, Test accuracy: 72.00 

Round  14, Train loss: 0.013, Test loss: 1.081, Test accuracy: 77.35 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.427, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.413, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.838, Test accuracy: 65.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.600, Test loss: 1.692, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 77.40 

Round  15, Train loss: 0.016, Test loss: 1.095, Test accuracy: 77.15 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 76.40 

Round  16, Train loss: 0.001, Test loss: 1.072, Test accuracy: 77.35 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.093, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.483, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.330, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.183, Test accuracy: 76.20 

Round  17, Train loss: 0.007, Test loss: 1.043, Test accuracy: 77.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 98.800, Test loss: 1.775, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.403, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 77.80 

Round  18, Train loss: 0.009, Test loss: 1.042, Test accuracy: 77.55 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.793, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.071, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.071, Test accuracy: 78.20 

Round  19, Train loss: 0.001, Test loss: 1.054, Test accuracy: 77.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 78.60 

Final Round, Train loss: 0.000, Test loss: 1.052, Test accuracy: 77.95 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.881, Train accuracy: 67.600, Test loss: 0.934, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.562, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 78.20 

        train local model (freeze embeding):client   4,  Train loss: 0.831, Train accuracy: 66.800, Test loss: 0.993, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.172, Train accuracy: 93.600, Test loss: 1.445, Test accuracy: 62.60 

Round   0, Train loss: 0.035, Test loss: 1.042, Test accuracy: 74.84 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.407, Test accuracy: 74.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.105, Test accuracy: 77.00 

        train local model (freeze embeding):client   4,  Train loss: 0.560, Train accuracy: 80.400, Test loss: 0.864, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.109, Train accuracy: 97.000, Test loss: 1.235, Test accuracy: 68.00 

Round   1, Train loss: 0.022, Test loss: 1.022, Test accuracy: 76.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.084, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.370, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.462, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.165, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.421, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 98.800, Test loss: 1.236, Test accuracy: 75.60 

        train local model (freeze embeding):client   4,  Train loss: 0.327, Train accuracy: 88.600, Test loss: 0.939, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.221, Train accuracy: 92.200, Test loss: 1.843, Test accuracy: 61.80 

Round   2, Train loss: 0.049, Test loss: 1.005, Test accuracy: 76.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.439, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.213, Train accuracy: 93.400, Test loss: 1.004, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.157, Train accuracy: 94.600, Test loss: 1.628, Test accuracy: 65.40 

Round   3, Train loss: 0.038, Test loss: 1.026, Test accuracy: 76.56 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.544, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.242, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.205, Test accuracy: 77.20 

        train local model (freeze embeding):client   4,  Train loss: 0.138, Train accuracy: 96.400, Test loss: 0.995, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.148, Train accuracy: 94.400, Test loss: 1.900, Test accuracy: 60.20 

Round   4, Train loss: 0.036, Test loss: 1.042, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 1.579, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 98.600, Test loss: 1.674, Test accuracy: 67.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.077, Train accuracy: 97.600, Test loss: 1.421, Test accuracy: 75.80 

        train local model (freeze embeding):client   4,  Train loss: 0.082, Train accuracy: 97.600, Test loss: 1.075, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.155, Train accuracy: 94.600, Test loss: 1.859, Test accuracy: 58.40 

Round   5, Train loss: 0.057, Test loss: 1.040, Test accuracy: 76.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.353, Test accuracy: 74.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.138, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.051, Train accuracy: 99.400, Test loss: 1.046, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 99.600, Test loss: 1.549, Test accuracy: 66.80 

Round   6, Train loss: 0.009, Test loss: 0.988, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.488, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.226, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.029, Train accuracy: 99.800, Test loss: 1.152, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.089, Train accuracy: 97.000, Test loss: 1.631, Test accuracy: 63.40 

Round   7, Train loss: 0.018, Test loss: 0.980, Test accuracy: 77.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 1.547, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.885, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.283, Test accuracy: 74.20 

        train local model (freeze embeding):client   4,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 1.142, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.366, Train accuracy: 89.400, Test loss: 2.853, Test accuracy: 57.40 

Round   8, Train loss: 0.084, Test loss: 1.054, Test accuracy: 76.72 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.091, Train accuracy: 97.400, Test loss: 1.969, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.122, Test accuracy: 76.00 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.171, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.130, Train accuracy: 94.400, Test loss: 1.936, Test accuracy: 64.40 

Round   9, Train loss: 0.048, Test loss: 1.091, Test accuracy: 75.84 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.508, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.468, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.878, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 77.40 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.035, Train accuracy: 99.200, Test loss: 1.769, Test accuracy: 63.20 

Round  10, Train loss: 0.015, Test loss: 1.055, Test accuracy: 76.92 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.059, Train accuracy: 98.000, Test loss: 1.652, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.299, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.905, Test accuracy: 65.40 

Round  11, Train loss: 0.014, Test loss: 1.059, Test accuracy: 76.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.189, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 74.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 80.00 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.338, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.124, Train accuracy: 93.600, Test loss: 2.368, Test accuracy: 59.60 

Round  12, Train loss: 0.026, Test loss: 1.042, Test accuracy: 76.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 81.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 79.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 80.40 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.299, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.120, Train accuracy: 96.000, Test loss: 2.352, Test accuracy: 59.20 

Round  13, Train loss: 0.024, Test loss: 1.047, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.226, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.447, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.159, Train accuracy: 94.600, Test loss: 1.861, Test accuracy: 63.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.320, Test accuracy: 77.80 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.320, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.859, Train accuracy: 77.600, Test loss: 2.849, Test accuracy: 52.80 

Round  14, Train loss: 0.215, Test loss: 1.090, Test accuracy: 76.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 80.40 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.049, Train accuracy: 97.600, Test loss: 1.945, Test accuracy: 61.00 

Round  15, Train loss: 0.010, Test loss: 1.049, Test accuracy: 76.84 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.159, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 79.40 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.329, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.659, Test accuracy: 67.80 

Round  16, Train loss: 0.001, Test loss: 1.052, Test accuracy: 76.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 76.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.662, Test accuracy: 72.20 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.053, Test accuracy: 81.00 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.614, Test accuracy: 69.00 

Round  17, Train loss: 0.006, Test loss: 1.067, Test accuracy: 77.16 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.674, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.140, Train accuracy: 94.800, Test loss: 1.657, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.800, Test loss: 1.732, Test accuracy: 63.80 

Round  18, Train loss: 0.044, Test loss: 1.061, Test accuracy: 75.72 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.328, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.220, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.110, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.698, Test accuracy: 71.60 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.052, Train accuracy: 98.600, Test loss: 2.027, Test accuracy: 64.00 

Round  19, Train loss: 0.013, Test loss: 1.075, Test accuracy: 76.68 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.091, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.071, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 80.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.388, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.423, Test accuracy: 70.40 

Final Round, Train loss: 0.001, Test loss: 1.060, Test accuracy: 76.84 

Average accuracy final 10 rounds: 375.1270000000001 

4748.065160036087
[14.89259672164917, 29.16838026046753, 43.69655704498291, 58.3380286693573, 72.83664917945862, 87.52953457832336, 102.91895961761475, 117.89603352546692, 132.3610544204712, 147.26611757278442, 162.10469126701355, 175.95083856582642, 190.41406846046448, 204.8117814064026, 218.832510471344, 233.23921132087708, 248.01677346229553, 263.361718416214, 277.76819133758545, 292.2275319099426, 299.7780387401581, 314.3439054489136, 328.9146544933319, 343.16611099243164, 358.44930267333984, 373.2708444595337, 388.06844544410706, 403.5122582912445, 418.7559461593628, 433.6949551105499, 448.3966338634491, 463.405725479126, 478.7662332057953, 494.41158056259155, 509.54170870780945, 524.6535730361938, 539.3691747188568, 553.8521013259888, 569.9153263568878, 584.7469069957733, 599.0476660728455, 607.8314228057861, 622.5361790657043, 637.0978105068207, 652.499356508255, 667.9894788265228, 683.476179599762, 699.1907198429108, 714.9961910247803, 729.9832530021667, 745.5151031017303, 761.1298611164093, 776.3523845672607, 791.7165334224701, 806.7084748744965, 821.5728027820587, 837.2873282432556, 852.4664442539215, 867.5528430938721, 882.7376914024353, 897.5992710590363, 913.5238218307495, 921.3722105026245, 936.3662550449371, 951.3819823265076, 966.5706140995026, 981.7115852832794, 996.7849938869476, 1011.7338166236877, 1026.7441239356995, 1041.3731045722961, 1056.811939239502, 1071.8218953609467, 1086.7740845680237, 1101.7624654769897, 1116.5528542995453, 1131.9469487667084, 1147.3787004947662, 1163.6670203208923, 1178.8131666183472, 1194.449408531189, 1209.2928245067596, 1224.4622008800507, 1233.4201438426971, 1249.2491037845612, 1264.2622442245483, 1279.6159331798553, 1294.5805141925812, 1310.6454575061798, 1325.8803038597107, 1341.3442294597626, 1356.4006254673004, 1371.710021018982, 1388.0440390110016, 1403.7248847484589, 1418.8048906326294, 1434.7764523029327, 1450.2881741523743, 1466.000321149826, 1481.235190153122, 1496.435874223709, 1511.826853275299, 1527.1639935970306, 1542.4656405448914, 1550.7435050010681]
[59.0, 67.4, 64.4, 67.4, 71.8, 67.0, 67.2, 72.6, 71.6, 67.6, 73.2, 74.6, 71.2, 72.8, 72.8, 71.6, 70.4, 70.4, 68.6, 72.6, 72.4, 69.7, 72.9, 73.4, 73.4, 74.4, 73.1, 73.7, 74.0, 74.6, 74.2, 74.9, 75.8, 74.9, 74.4, 75.0, 74.6, 73.8, 72.6, 74.3, 74.5, 74.9, 72.86666666666666, 73.33333333333333, 73.33333333333333, 72.93333333333334, 74.46666666666667, 73.2, 74.26666666666667, 73.26666666666667, 73.8, 74.4, 74.46666666666667, 74.4, 74.0, 75.2, 74.73333333333333, 74.73333333333333, 76.06666666666666, 75.46666666666667, 75.46666666666667, 74.66666666666667, 74.4, 75.1, 74.9, 76.75, 76.35, 76.25, 75.6, 76.3, 77.55, 76.9, 77.0, 77.1, 76.7, 76.75, 77.3, 77.35, 77.15, 77.35, 77.85, 77.55, 77.85, 77.95, 74.84, 76.48, 76.88, 76.56, 76.0, 76.24, 77.2, 77.04, 76.72, 75.84, 76.92, 76.12, 76.44, 76.96, 76.52, 76.84, 76.76, 77.16, 75.72, 76.68, 76.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.418, Test loss: 1.276, Test accuracy: 52.00 

Round   0, Global train loss: 1.418, Global test loss: 2.141, Global test accuracy: 23.16 

Round   1, Train loss: 1.057, Test loss: 1.158, Test accuracy: 58.40 

Round   1, Global train loss: 1.057, Global test loss: 2.034, Global test accuracy: 24.88 

Round   2, Train loss: 0.879, Test loss: 1.221, Test accuracy: 59.72 

Round   2, Global train loss: 0.879, Global test loss: 2.128, Global test accuracy: 18.68 

Round   3, Train loss: 0.755, Test loss: 1.268, Test accuracy: 60.00 

Round   3, Global train loss: 0.755, Global test loss: 2.159, Global test accuracy: 16.80 

Round   4, Train loss: 0.633, Test loss: 1.254, Test accuracy: 63.56 

Round   4, Global train loss: 0.633, Global test loss: 2.269, Global test accuracy: 16.36 

Round   5, Train loss: 0.546, Test loss: 1.138, Test accuracy: 64.76 

Round   5, Global train loss: 0.546, Global test loss: 2.242, Global test accuracy: 16.00 

Round   6, Train loss: 0.437, Test loss: 1.231, Test accuracy: 66.48 

Round   6, Global train loss: 0.437, Global test loss: 2.312, Global test accuracy: 16.08 

Round   7, Train loss: 0.373, Test loss: 1.169, Test accuracy: 68.44 

Round   7, Global train loss: 0.373, Global test loss: 2.294, Global test accuracy: 18.16 

Round   8, Train loss: 0.303, Test loss: 1.266, Test accuracy: 67.36 

Round   8, Global train loss: 0.303, Global test loss: 2.208, Global test accuracy: 16.96 

Round   9, Train loss: 0.275, Test loss: 1.309, Test accuracy: 68.32 

Round   9, Global train loss: 0.275, Global test loss: 2.263, Global test accuracy: 16.12 

Round  10, Train loss: 0.220, Test loss: 1.242, Test accuracy: 69.60 

Round  10, Global train loss: 0.220, Global test loss: 2.275, Global test accuracy: 19.00 

Round  11, Train loss: 0.179, Test loss: 1.365, Test accuracy: 69.08 

Round  11, Global train loss: 0.179, Global test loss: 2.323, Global test accuracy: 16.80 

Round  12, Train loss: 0.169, Test loss: 1.259, Test accuracy: 70.32 

Round  12, Global train loss: 0.169, Global test loss: 2.434, Global test accuracy: 16.72 

Round  13, Train loss: 0.145, Test loss: 1.244, Test accuracy: 70.92 

Round  13, Global train loss: 0.145, Global test loss: 2.318, Global test accuracy: 17.80 

Round  14, Train loss: 0.106, Test loss: 1.672, Test accuracy: 68.08 

Round  14, Global train loss: 0.106, Global test loss: 2.309, Global test accuracy: 20.64 

Round  15, Train loss: 0.137, Test loss: 1.359, Test accuracy: 70.00 

Round  15, Global train loss: 0.137, Global test loss: 2.468, Global test accuracy: 16.92 

Round  16, Train loss: 0.092, Test loss: 1.389, Test accuracy: 70.92 

Round  16, Global train loss: 0.092, Global test loss: 2.391, Global test accuracy: 16.60 

Round  17, Train loss: 0.090, Test loss: 1.552, Test accuracy: 67.84 

Round  17, Global train loss: 0.090, Global test loss: 2.339, Global test accuracy: 16.24 

Round  18, Train loss: 0.070, Test loss: 1.378, Test accuracy: 71.20 

Round  18, Global train loss: 0.070, Global test loss: 2.371, Global test accuracy: 16.32 

Round  19, Train loss: 0.075, Test loss: 1.375, Test accuracy: 70.72 

Round  19, Global train loss: 0.075, Global test loss: 2.446, Global test accuracy: 16.20 

Round  20, Train loss: 0.068, Test loss: 1.423, Test accuracy: 70.72 

Round  20, Global train loss: 0.068, Global test loss: 2.469, Global test accuracy: 16.48 

Round  21, Train loss: 0.052, Test loss: 1.475, Test accuracy: 69.32 

Round  21, Global train loss: 0.052, Global test loss: 2.379, Global test accuracy: 17.24 

Round  22, Train loss: 0.042, Test loss: 1.664, Test accuracy: 68.16 

Round  22, Global train loss: 0.042, Global test loss: 2.430, Global test accuracy: 17.92 

Round  23, Train loss: 0.043, Test loss: 1.524, Test accuracy: 70.52 

Round  23, Global train loss: 0.043, Global test loss: 2.398, Global test accuracy: 18.32 

Round  24, Train loss: 0.037, Test loss: 1.360, Test accuracy: 72.96 

Round  24, Global train loss: 0.037, Global test loss: 2.382, Global test accuracy: 20.32 

Round  25, Train loss: 0.029, Test loss: 1.430, Test accuracy: 71.80 

Round  25, Global train loss: 0.029, Global test loss: 2.452, Global test accuracy: 19.40 

Round  26, Train loss: 0.028, Test loss: 1.682, Test accuracy: 70.72 

Round  26, Global train loss: 0.028, Global test loss: 2.528, Global test accuracy: 21.40 

Round  27, Train loss: 0.038, Test loss: 1.507, Test accuracy: 71.04 

Round  27, Global train loss: 0.038, Global test loss: 2.383, Global test accuracy: 22.68 

Round  28, Train loss: 0.038, Test loss: 1.522, Test accuracy: 71.04 

Round  28, Global train loss: 0.038, Global test loss: 2.429, Global test accuracy: 17.56 

Round  29, Train loss: 0.034, Test loss: 1.492, Test accuracy: 72.52 

Round  29, Global train loss: 0.034, Global test loss: 2.423, Global test accuracy: 19.68 

Round  30, Train loss: 0.038, Test loss: 1.493, Test accuracy: 71.48 

Round  30, Global train loss: 0.038, Global test loss: 2.440, Global test accuracy: 18.28 

Round  31, Train loss: 0.023, Test loss: 1.466, Test accuracy: 72.92 

Round  31, Global train loss: 0.023, Global test loss: 2.362, Global test accuracy: 18.68 

Round  32, Train loss: 0.026, Test loss: 1.659, Test accuracy: 70.28 

Round  32, Global train loss: 0.026, Global test loss: 2.416, Global test accuracy: 16.64 

Round  33, Train loss: 0.029, Test loss: 1.518, Test accuracy: 71.44 

Round  33, Global train loss: 0.029, Global test loss: 2.502, Global test accuracy: 16.32 

Round  34, Train loss: 0.017, Test loss: 1.522, Test accuracy: 72.96 

Round  34, Global train loss: 0.017, Global test loss: 2.465, Global test accuracy: 18.80 

Final Round, Train loss: 0.019, Test loss: 1.583, Test accuracy: 71.28 

Final Round, Global train loss: 0.019, Global test loss: 2.465, Global test accuracy: 18.80 

Average accuracy final 10 rounds: 71.62 

Average global accuracy final 10 rounds: 18.944 

1167.324342250824
[7.583465099334717, 13.297951698303223, 19.28437066078186, 24.919947862625122, 30.638150691986084, 36.39590930938721, 42.03767800331116, 47.69817757606506, 53.37391209602356, 59.35620999336243, 65.3692774772644, 71.0765438079834, 77.02419805526733, 82.67975330352783, 88.39655256271362, 94.22341632843018, 100.08770203590393, 105.91064548492432, 111.60719609260559, 117.43727278709412, 123.05045866966248, 128.68856024742126, 134.32025957107544, 140.2325873374939, 146.02521562576294, 151.9691939353943, 157.5845546722412, 163.295156955719, 169.13417029380798, 174.84434866905212, 180.815199136734, 186.81723022460938, 192.55632662773132, 198.17551589012146, 203.91938257217407, 215.18788242340088]
[52.0, 58.4, 59.72, 60.0, 63.56, 64.76, 66.48, 68.44, 67.36, 68.32, 69.6, 69.08, 70.32, 70.92, 68.08, 70.0, 70.92, 67.84, 71.2, 70.72, 70.72, 69.32, 68.16, 70.52, 72.96, 71.8, 70.72, 71.04, 71.04, 72.52, 71.48, 72.92, 70.28, 71.44, 72.96, 71.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.421, Test loss: 1.359, Test accuracy: 50.48 

Round   0, Global train loss: 1.421, Global test loss: 2.097, Global test accuracy: 25.88 

Round   1, Train loss: 1.256, Test loss: 1.379, Test accuracy: 54.68 

Round   1, Global train loss: 1.256, Global test loss: 1.720, Global test accuracy: 49.16 

Round   2, Train loss: 1.097, Test loss: 1.165, Test accuracy: 59.32 

Round   2, Global train loss: 1.097, Global test loss: 1.870, Global test accuracy: 50.68 

Round   3, Train loss: 0.957, Test loss: 1.513, Test accuracy: 53.92 

Round   3, Global train loss: 0.957, Global test loss: 1.614, Global test accuracy: 55.16 

Round   4, Train loss: 0.864, Test loss: 1.150, Test accuracy: 61.32 

Round   4, Global train loss: 0.864, Global test loss: 1.589, Global test accuracy: 57.16 

Round   5, Train loss: 0.812, Test loss: 1.095, Test accuracy: 64.32 

Round   5, Global train loss: 0.812, Global test loss: 1.571, Global test accuracy: 58.36 

Round   6, Train loss: 0.723, Test loss: 1.009, Test accuracy: 66.28 

Round   6, Global train loss: 0.723, Global test loss: 1.493, Global test accuracy: 59.12 

Round   7, Train loss: 0.655, Test loss: 1.240, Test accuracy: 64.24 

Round   7, Global train loss: 0.655, Global test loss: 1.534, Global test accuracy: 59.08 

Round   8, Train loss: 0.596, Test loss: 1.012, Test accuracy: 67.84 

Round   8, Global train loss: 0.596, Global test loss: 1.424, Global test accuracy: 61.24 

Round   9, Train loss: 0.566, Test loss: 1.011, Test accuracy: 68.80 

Round   9, Global train loss: 0.566, Global test loss: 1.335, Global test accuracy: 61.60 

Round  10, Train loss: 0.515, Test loss: 0.908, Test accuracy: 72.52 

Round  10, Global train loss: 0.515, Global test loss: 1.409, Global test accuracy: 62.04 

Round  11, Train loss: 0.480, Test loss: 1.042, Test accuracy: 71.24 

Round  11, Global train loss: 0.480, Global test loss: 1.433, Global test accuracy: 62.72 

Round  12, Train loss: 0.435, Test loss: 0.886, Test accuracy: 73.92 

Round  12, Global train loss: 0.435, Global test loss: 1.398, Global test accuracy: 64.24 

Round  13, Train loss: 0.416, Test loss: 0.957, Test accuracy: 72.68 

Round  13, Global train loss: 0.416, Global test loss: 1.296, Global test accuracy: 65.00 

Round  14, Train loss: 0.379, Test loss: 0.957, Test accuracy: 73.48 

Round  14, Global train loss: 0.379, Global test loss: 1.207, Global test accuracy: 66.20 

Round  15, Train loss: 0.345, Test loss: 0.912, Test accuracy: 73.96 

Round  15, Global train loss: 0.345, Global test loss: 1.132, Global test accuracy: 68.20 

Round  16, Train loss: 0.320, Test loss: 0.917, Test accuracy: 75.04 

Round  16, Global train loss: 0.320, Global test loss: 1.198, Global test accuracy: 67.28 

Round  17, Train loss: 0.303, Test loss: 0.816, Test accuracy: 77.00 

Round  17, Global train loss: 0.303, Global test loss: 1.207, Global test accuracy: 67.28 

Round  18, Train loss: 0.276, Test loss: 0.804, Test accuracy: 77.44 

Round  18, Global train loss: 0.276, Global test loss: 1.172, Global test accuracy: 69.16 

Round  19, Train loss: 0.254, Test loss: 0.906, Test accuracy: 75.68 

Round  19, Global train loss: 0.254, Global test loss: 1.134, Global test accuracy: 69.00 

Round  20, Train loss: 0.239, Test loss: 0.869, Test accuracy: 76.32 

Round  20, Global train loss: 0.239, Global test loss: 1.080, Global test accuracy: 70.36 

Round  21, Train loss: 0.220, Test loss: 0.889, Test accuracy: 76.84 

Round  21, Global train loss: 0.220, Global test loss: 1.206, Global test accuracy: 68.48 

Round  22, Train loss: 0.205, Test loss: 0.780, Test accuracy: 79.16 

Round  22, Global train loss: 0.205, Global test loss: 1.051, Global test accuracy: 71.00 

Round  23, Train loss: 0.193, Test loss: 0.898, Test accuracy: 77.08 

Round  23, Global train loss: 0.193, Global test loss: 1.125, Global test accuracy: 70.48 

Round  24, Train loss: 0.198, Test loss: 1.073, Test accuracy: 74.16 

Round  24, Global train loss: 0.198, Global test loss: 1.083, Global test accuracy: 70.88 

Round  25, Train loss: 0.172, Test loss: 1.118, Test accuracy: 73.96 

Round  25, Global train loss: 0.172, Global test loss: 1.110, Global test accuracy: 70.48 

Round  26, Train loss: 0.154, Test loss: 0.870, Test accuracy: 78.64 

Round  26, Global train loss: 0.154, Global test loss: 1.056, Global test accuracy: 71.20 

Round  27, Train loss: 0.147, Test loss: 0.918, Test accuracy: 77.04 

Round  27, Global train loss: 0.147, Global test loss: 1.069, Global test accuracy: 71.48 

Round  28, Train loss: 0.158, Test loss: 1.008, Test accuracy: 74.92 

Round  28, Global train loss: 0.158, Global test loss: 1.081, Global test accuracy: 71.56 

Round  29, Train loss: 0.135, Test loss: 0.858, Test accuracy: 78.72 

Round  29, Global train loss: 0.135, Global test loss: 1.068, Global test accuracy: 71.72 

Round  30, Train loss: 0.113, Test loss: 0.984, Test accuracy: 76.40 

Round  30, Global train loss: 0.113, Global test loss: 1.042, Global test accuracy: 72.32 

Round  31, Train loss: 0.105, Test loss: 0.990, Test accuracy: 76.16 

Round  31, Global train loss: 0.105, Global test loss: 1.092, Global test accuracy: 72.12 

Round  32, Train loss: 0.100, Test loss: 0.843, Test accuracy: 79.12 

Round  32, Global train loss: 0.100, Global test loss: 1.048, Global test accuracy: 72.52 

Round  33, Train loss: 0.112, Test loss: 1.303, Test accuracy: 73.36 

Round  33, Global train loss: 0.112, Global test loss: 1.050, Global test accuracy: 71.80 

Round  34, Train loss: 0.092, Test loss: 0.967, Test accuracy: 77.32 

Round  34, Global train loss: 0.092, Global test loss: 1.010, Global test accuracy: 72.76 

Round  35, Train loss: 0.082, Test loss: 0.932, Test accuracy: 79.64 

Round  35, Global train loss: 0.082, Global test loss: 0.982, Global test accuracy: 73.84 

Round  36, Train loss: 0.105, Test loss: 0.862, Test accuracy: 79.08 

Round  36, Global train loss: 0.105, Global test loss: 1.085, Global test accuracy: 72.84 

Round  37, Train loss: 0.092, Test loss: 0.876, Test accuracy: 78.40 

Round  37, Global train loss: 0.092, Global test loss: 0.999, Global test accuracy: 73.40 

Round  38, Train loss: 0.067, Test loss: 1.020, Test accuracy: 78.20 

Round  38, Global train loss: 0.067, Global test loss: 1.031, Global test accuracy: 73.20 

Round  39, Train loss: 0.061, Test loss: 0.909, Test accuracy: 79.68 

Round  39, Global train loss: 0.061, Global test loss: 1.039, Global test accuracy: 73.28 

Round  40, Train loss: 0.075, Test loss: 0.916, Test accuracy: 80.08 

Round  40, Global train loss: 0.075, Global test loss: 1.068, Global test accuracy: 72.76 

Round  41, Train loss: 0.064, Test loss: 0.779, Test accuracy: 81.32 

Round  41, Global train loss: 0.064, Global test loss: 1.034, Global test accuracy: 73.40 

Round  42, Train loss: 0.064, Test loss: 0.872, Test accuracy: 80.40 

Round  42, Global train loss: 0.064, Global test loss: 0.987, Global test accuracy: 74.16 

Round  43, Train loss: 0.037, Test loss: 0.768, Test accuracy: 81.68 

Round  43, Global train loss: 0.037, Global test loss: 0.980, Global test accuracy: 74.92 

Round  44, Train loss: 0.053, Test loss: 0.901, Test accuracy: 79.24 

Round  44, Global train loss: 0.053, Global test loss: 0.962, Global test accuracy: 74.96 

Round  45, Train loss: 0.042, Test loss: 0.784, Test accuracy: 81.76 

Round  45, Global train loss: 0.042, Global test loss: 0.994, Global test accuracy: 73.88 

Round  46, Train loss: 0.049, Test loss: 1.058, Test accuracy: 77.92 

Round  46, Global train loss: 0.049, Global test loss: 1.068, Global test accuracy: 73.44 

Round  47, Train loss: 0.066, Test loss: 0.828, Test accuracy: 80.84 

Round  47, Global train loss: 0.066, Global test loss: 0.968, Global test accuracy: 74.68 

Round  48, Train loss: 0.045, Test loss: 0.847, Test accuracy: 81.24 

Round  48, Global train loss: 0.045, Global test loss: 1.011, Global test accuracy: 74.08 

Round  49, Train loss: 0.032, Test loss: 0.753, Test accuracy: 81.80 

Round  49, Global train loss: 0.032, Global test loss: 1.002, Global test accuracy: 74.12 

Final Round, Train loss: 0.029, Test loss: 0.897, Test accuracy: 79.20 

Final Round, Global train loss: 0.029, Global test loss: 1.002, Global test accuracy: 74.12 

Average accuracy final 10 rounds: 80.62799999999999 

Average global accuracy final 10 rounds: 74.04 

1621.336305141449
[7.72464919090271, 13.597561597824097, 19.208088159561157, 24.80892252922058, 30.422178745269775, 36.11043357849121, 41.913411378860474, 47.66156339645386, 53.25427317619324, 59.347800970077515, 65.09446716308594, 70.95320582389832, 76.55967140197754, 82.22953605651855, 87.8722174167633, 93.62143278121948, 99.35501217842102, 104.9141640663147, 110.46314835548401, 116.10513234138489, 121.78201651573181, 127.36834645271301, 133.1162109375, 138.66397786140442, 144.34282565116882, 150.31842470169067, 155.86924147605896, 161.46435236930847, 167.79601907730103, 173.48175740242004, 179.25388169288635, 184.840069770813, 190.6004500389099, 196.49334001541138, 202.04878115653992, 207.6325855255127, 213.30096101760864, 219.07585620880127, 224.94799280166626, 230.8102831840515, 236.49166798591614, 242.2508842945099, 247.95948696136475, 253.5448980331421, 259.1798903942108, 264.823184967041, 270.42302536964417, 276.0451612472534, 281.6669750213623, 287.62557768821716, 299.28543972969055]
[50.48, 54.68, 59.32, 53.92, 61.32, 64.32, 66.28, 64.24, 67.84, 68.8, 72.52, 71.24, 73.92, 72.68, 73.48, 73.96, 75.04, 77.0, 77.44, 75.68, 76.32, 76.84, 79.16, 77.08, 74.16, 73.96, 78.64, 77.04, 74.92, 78.72, 76.4, 76.16, 79.12, 73.36, 77.32, 79.64, 79.08, 78.4, 78.2, 79.68, 80.08, 81.32, 80.4, 81.68, 79.24, 81.76, 77.92, 80.84, 81.24, 81.8, 79.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.516, Test loss: 1.826, Test accuracy: 24.84 

Round   1, Train loss: 1.282, Test loss: 1.299, Test accuracy: 46.56 

Round   2, Train loss: 1.123, Test loss: 1.104, Test accuracy: 57.00 

Round   3, Train loss: 1.017, Test loss: 1.025, Test accuracy: 60.08 

Round   4, Train loss: 0.929, Test loss: 0.947, Test accuracy: 63.80 

Round   5, Train loss: 0.874, Test loss: 1.070, Test accuracy: 62.72 

Round   6, Train loss: 0.813, Test loss: 0.851, Test accuracy: 67.44 

Round   7, Train loss: 0.756, Test loss: 0.851, Test accuracy: 67.76 

Round   8, Train loss: 0.724, Test loss: 0.854, Test accuracy: 68.20 

Round   9, Train loss: 0.668, Test loss: 0.782, Test accuracy: 71.68 

Round  10, Train loss: 0.637, Test loss: 0.752, Test accuracy: 73.32 

Round  11, Train loss: 0.586, Test loss: 0.717, Test accuracy: 74.32 

Round  12, Train loss: 0.555, Test loss: 0.720, Test accuracy: 73.68 

Round  13, Train loss: 0.527, Test loss: 0.675, Test accuracy: 76.08 

Round  14, Train loss: 0.489, Test loss: 0.664, Test accuracy: 76.04 

Round  15, Train loss: 0.462, Test loss: 0.619, Test accuracy: 77.80 

Round  16, Train loss: 0.435, Test loss: 0.670, Test accuracy: 76.84 

Round  17, Train loss: 0.400, Test loss: 0.649, Test accuracy: 78.52 

Round  18, Train loss: 0.383, Test loss: 0.622, Test accuracy: 78.28 

Round  19, Train loss: 0.360, Test loss: 0.630, Test accuracy: 78.28 

Round  20, Train loss: 0.347, Test loss: 0.624, Test accuracy: 78.84 

Round  21, Train loss: 0.318, Test loss: 0.603, Test accuracy: 79.00 

Round  22, Train loss: 0.304, Test loss: 0.625, Test accuracy: 79.04 

Round  23, Train loss: 0.286, Test loss: 0.592, Test accuracy: 80.08 

Round  24, Train loss: 0.275, Test loss: 0.614, Test accuracy: 79.92 

Round  25, Train loss: 0.268, Test loss: 0.605, Test accuracy: 79.80 

Round  26, Train loss: 0.250, Test loss: 0.620, Test accuracy: 79.92 

Round  27, Train loss: 0.218, Test loss: 0.574, Test accuracy: 81.32 

Round  28, Train loss: 0.217, Test loss: 0.600, Test accuracy: 79.76 

Round  29, Train loss: 0.210, Test loss: 0.570, Test accuracy: 81.00 

Round  30, Train loss: 0.190, Test loss: 0.617, Test accuracy: 80.72 

Round  31, Train loss: 0.185, Test loss: 0.581, Test accuracy: 82.08 

Round  32, Train loss: 0.181, Test loss: 0.647, Test accuracy: 80.48 

Round  33, Train loss: 0.152, Test loss: 0.627, Test accuracy: 80.36 

Round  34, Train loss: 0.146, Test loss: 0.618, Test accuracy: 81.64 

Round  35, Train loss: 0.140, Test loss: 0.617, Test accuracy: 81.24 

Round  36, Train loss: 0.151, Test loss: 0.602, Test accuracy: 81.84 

Round  37, Train loss: 0.119, Test loss: 0.601, Test accuracy: 82.00 

Round  38, Train loss: 0.122, Test loss: 0.596, Test accuracy: 82.60 

Round  39, Train loss: 0.116, Test loss: 0.584, Test accuracy: 82.28 

Round  40, Train loss: 0.116, Test loss: 0.604, Test accuracy: 82.00 

Round  41, Train loss: 0.119, Test loss: 0.583, Test accuracy: 82.60 

Round  42, Train loss: 0.092, Test loss: 0.607, Test accuracy: 82.48 

Round  43, Train loss: 0.095, Test loss: 0.630, Test accuracy: 81.60 

Round  44, Train loss: 0.092, Test loss: 0.607, Test accuracy: 82.96 

Round  45, Train loss: 0.076, Test loss: 0.608, Test accuracy: 82.24 

Round  46, Train loss: 0.063, Test loss: 0.582, Test accuracy: 83.20 

Round  47, Train loss: 0.084, Test loss: 0.607, Test accuracy: 82.68 

Round  48, Train loss: 0.072, Test loss: 0.611, Test accuracy: 83.60 

Round  49, Train loss: 0.055, Test loss: 0.633, Test accuracy: 82.60 

Final Round, Train loss: 0.035, Test loss: 0.637, Test accuracy: 82.68 

Average accuracy final 10 rounds: 82.596 

1193.7186555862427
[6.307680130004883, 10.659703016281128, 15.127182483673096, 19.611856698989868, 24.29051184654236, 28.80856466293335, 33.37206768989563, 37.79372477531433, 42.61438584327698, 47.367629289627075, 52.07244873046875, 56.482277154922485, 60.79075503349304, 65.34858560562134, 69.68212819099426, 73.97457957267761, 78.38025665283203, 82.62692070007324, 87.28984212875366, 91.78936076164246, 96.21040368080139, 100.7689790725708, 105.11074256896973, 109.48254323005676, 113.99475526809692, 118.67855095863342, 123.33264112472534, 127.71306014060974, 132.15753507614136, 136.65430545806885, 141.0869972705841, 145.63719034194946, 150.2579927444458, 154.76234221458435, 159.1429958343506, 163.52498269081116, 168.00355744361877, 172.71418809890747, 177.15691757202148, 181.5908544063568, 186.1729383468628, 190.4691982269287, 194.87100839614868, 199.3913450241089, 203.89396929740906, 208.27887749671936, 212.71815490722656, 217.1299283504486, 221.74530148506165, 226.137677192688, 231.00975513458252]
[24.84, 46.56, 57.0, 60.08, 63.8, 62.72, 67.44, 67.76, 68.2, 71.68, 73.32, 74.32, 73.68, 76.08, 76.04, 77.8, 76.84, 78.52, 78.28, 78.28, 78.84, 79.0, 79.04, 80.08, 79.92, 79.8, 79.92, 81.32, 79.76, 81.0, 80.72, 82.08, 80.48, 80.36, 81.64, 81.24, 81.84, 82.0, 82.6, 82.28, 82.0, 82.6, 82.48, 81.6, 82.96, 82.24, 83.2, 82.68, 83.6, 82.6, 82.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.538, Test loss: 1.678, Test accuracy: 28.76
Round   1, Train loss: 1.288, Test loss: 1.309, Test accuracy: 45.64
Round   2, Train loss: 1.114, Test loss: 1.165, Test accuracy: 54.00
Round   3, Train loss: 1.016, Test loss: 1.119, Test accuracy: 58.24
Round   4, Train loss: 0.925, Test loss: 0.879, Test accuracy: 66.88
Round   5, Train loss: 0.854, Test loss: 0.962, Test accuracy: 64.08
Round   6, Train loss: 0.794, Test loss: 0.989, Test accuracy: 63.64
Round   7, Train loss: 0.746, Test loss: 0.836, Test accuracy: 69.32
Round   8, Train loss: 0.681, Test loss: 0.723, Test accuracy: 72.92
Round   9, Train loss: 0.649, Test loss: 0.862, Test accuracy: 69.92
Round  10, Train loss: 0.599, Test loss: 0.688, Test accuracy: 75.28
Round  11, Train loss: 0.560, Test loss: 0.748, Test accuracy: 73.12
Round  12, Train loss: 0.524, Test loss: 0.667, Test accuracy: 75.16
Round  13, Train loss: 0.485, Test loss: 0.634, Test accuracy: 76.96
Round  14, Train loss: 0.455, Test loss: 0.628, Test accuracy: 77.04
Round  15, Train loss: 0.436, Test loss: 0.662, Test accuracy: 75.40
Round  16, Train loss: 0.407, Test loss: 0.628, Test accuracy: 77.84
Round  17, Train loss: 0.379, Test loss: 0.577, Test accuracy: 78.48
Round  18, Train loss: 0.359, Test loss: 0.583, Test accuracy: 79.08
Round  19, Train loss: 0.337, Test loss: 0.596, Test accuracy: 79.28
Round  20, Train loss: 0.316, Test loss: 0.581, Test accuracy: 79.84
Round  21, Train loss: 0.290, Test loss: 0.594, Test accuracy: 79.48
Round  22, Train loss: 0.272, Test loss: 0.583, Test accuracy: 80.44
Round  23, Train loss: 0.265, Test loss: 0.548, Test accuracy: 80.60
Round  24, Train loss: 0.245, Test loss: 0.571, Test accuracy: 80.28
Round  25, Train loss: 0.237, Test loss: 0.573, Test accuracy: 80.96
Round  26, Train loss: 0.216, Test loss: 0.567, Test accuracy: 81.84
Round  27, Train loss: 0.213, Test loss: 0.581, Test accuracy: 80.60
Round  28, Train loss: 0.188, Test loss: 0.581, Test accuracy: 80.88
Round  29, Train loss: 0.188, Test loss: 0.595, Test accuracy: 80.68
Round  30, Train loss: 0.187, Test loss: 0.579, Test accuracy: 81.48
Round  31, Train loss: 0.162, Test loss: 0.578, Test accuracy: 82.08
Round  32, Train loss: 0.142, Test loss: 0.566, Test accuracy: 82.36
Round  33, Train loss: 0.149, Test loss: 0.551, Test accuracy: 82.56
Round  34, Train loss: 0.145, Test loss: 0.595, Test accuracy: 80.88
Round  35, Train loss: 0.132, Test loss: 0.547, Test accuracy: 83.20
Round  36, Train loss: 0.120, Test loss: 0.588, Test accuracy: 82.20
Round  37, Train loss: 0.103, Test loss: 0.563, Test accuracy: 83.60
Round  38, Train loss: 0.111, Test loss: 0.547, Test accuracy: 83.00
Round  39, Train loss: 0.110, Test loss: 0.572, Test accuracy: 82.52
Round  40, Train loss: 0.099, Test loss: 0.593, Test accuracy: 82.28
Round  41, Train loss: 0.087, Test loss: 0.616, Test accuracy: 82.04
Round  42, Train loss: 0.092, Test loss: 0.598, Test accuracy: 82.68
Round  43, Train loss: 0.083, Test loss: 0.562, Test accuracy: 83.36
Round  44, Train loss: 0.090, Test loss: 0.628, Test accuracy: 82.28
Round  45, Train loss: 0.082, Test loss: 0.590, Test accuracy: 83.28
Round  46, Train loss: 0.059, Test loss: 0.570, Test accuracy: 84.48
Round  47, Train loss: 0.071, Test loss: 0.563, Test accuracy: 83.84
Round  48, Train loss: 0.062, Test loss: 0.578, Test accuracy: 83.84
Round  49, Train loss: 0.048, Test loss: 0.589, Test accuracy: 82.68
Final Round, Train loss: 0.033, Test loss: 0.605, Test accuracy: 82.48
Average accuracy final 10 rounds: 83.07600000000001
1354.908599615097
[6.919129848480225, 12.075950860977173, 17.176755905151367, 22.2850124835968, 27.3265163898468, 32.72494292259216, 37.9445013999939, 43.25641751289368, 48.17459440231323, 53.151933908462524, 58.28745365142822, 63.19485020637512, 68.16551566123962, 73.52940034866333, 78.47490334510803, 83.56533479690552, 88.9161126613617, 94.0829246044159, 99.16046404838562, 104.2992627620697, 109.28509545326233, 114.41823434829712, 119.54438734054565, 124.81548142433167, 129.99866461753845, 135.1173551082611, 140.2718427181244, 145.48141860961914, 150.6408224105835, 155.74932765960693, 160.7302541732788, 165.83325290679932, 171.22378015518188, 176.24559712409973, 181.38115453720093, 186.48777556419373, 191.66323447227478, 196.8031530380249, 201.9323923587799, 207.13794541358948, 212.28469157218933, 217.6140275001526, 222.6550648212433, 227.79045486450195, 232.7206313610077, 237.79714059829712, 242.89368557929993, 247.89492297172546, 253.043701171875, 258.19001269340515, 263.0822343826294]
[28.76, 45.64, 54.0, 58.24, 66.88, 64.08, 63.64, 69.32, 72.92, 69.92, 75.28, 73.12, 75.16, 76.96, 77.04, 75.4, 77.84, 78.48, 79.08, 79.28, 79.84, 79.48, 80.44, 80.6, 80.28, 80.96, 81.84, 80.6, 80.88, 80.68, 81.48, 82.08, 82.36, 82.56, 80.88, 83.2, 82.2, 83.6, 83.0, 82.52, 82.28, 82.04, 82.68, 83.36, 82.28, 83.28, 84.48, 83.84, 83.84, 82.68, 82.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.890, Train accuracy: 64.600, Test loss: 1.401, Test accuracy: 54.00 

        train local model (freeze embeding):client   0,  Train loss: 0.380, Train accuracy: 86.800, Test loss: 0.964, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.537, Train accuracy: 81.800, Test loss: 1.373, Test accuracy: 64.80 

Round   0, Train loss: 0.537, Test loss: 1.373, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.227, Train accuracy: 92.400, Test loss: 0.996, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.582, Train accuracy: 83.000, Test loss: 1.924, Test accuracy: 64.40 

Round   1, Train loss: 0.582, Test loss: 1.924, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.148, Train accuracy: 95.000, Test loss: 1.156, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.138, Train accuracy: 94.600, Test loss: 1.277, Test accuracy: 70.40 

Round   2, Train loss: 0.138, Test loss: 1.277, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.060, Train accuracy: 98.000, Test loss: 1.170, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.052, Train accuracy: 98.400, Test loss: 1.167, Test accuracy: 72.40 

Round   3, Train loss: 0.052, Test loss: 1.167, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.128, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 1.423, Test accuracy: 70.00 

Round   4, Train loss: 0.050, Test loss: 1.423, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.318, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.243, Test accuracy: 71.80 

Round   5, Train loss: 0.009, Test loss: 1.243, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.248, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.294, Test accuracy: 70.40 

Round   6, Train loss: 0.011, Test loss: 1.294, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.320, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.200, Test loss: 1.477, Test accuracy: 69.00 

Round   7, Train loss: 0.041, Test loss: 1.477, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.181, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.355, Test accuracy: 71.40 

Round   8, Train loss: 0.010, Test loss: 1.355, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.384, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.279, Test accuracy: 71.60 

Round   9, Train loss: 0.006, Test loss: 1.279, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.307, Test accuracy: 72.20 

Round  10, Train loss: 0.007, Test loss: 1.307, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.281, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.325, Test accuracy: 74.20 

Round  11, Train loss: 0.006, Test loss: 1.325, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.280, Test accuracy: 74.40 

Round  12, Train loss: 0.001, Test loss: 1.280, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.401, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 73.40 

Round  13, Train loss: 0.003, Test loss: 1.244, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.443, Test accuracy: 72.40 

Round  14, Train loss: 0.006, Test loss: 1.443, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.479, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.655, Test accuracy: 71.60 

Round  15, Train loss: 0.004, Test loss: 1.655, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.486, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.499, Test accuracy: 72.00 

Round  16, Train loss: 0.002, Test loss: 1.499, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 75.40 

Round  17, Train loss: 0.000, Test loss: 1.412, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.444, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.511, Test accuracy: 71.00 

Round  18, Train loss: 0.001, Test loss: 1.511, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.486, Test accuracy: 72.20 

Round  19, Train loss: 0.002, Test loss: 1.486, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.482, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.464, Test accuracy: 72.20 

Final Round, Train loss: 0.003, Test loss: 1.495, Test accuracy: 71.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.685, Train accuracy: 73.200, Test loss: 0.900, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.461, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.633, Train accuracy: 77.200, Test loss: 0.816, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.227, Train accuracy: 93.000, Test loss: 1.033, Test accuracy: 73.40 

Round   0, Train loss: 0.114, Test loss: 0.970, Test accuracy: 76.70 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.140, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.255, Train accuracy: 92.000, Test loss: 0.805, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.078, Train accuracy: 97.400, Test loss: 0.948, Test accuracy: 75.20 

Round   1, Train loss: 0.039, Test loss: 0.899, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.072, Train accuracy: 98.200, Test loss: 0.747, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 0.906, Test accuracy: 78.00 

Round   2, Train loss: 0.026, Test loss: 0.886, Test accuracy: 78.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.800, Test loss: 0.781, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.052, Train accuracy: 98.600, Test loss: 1.003, Test accuracy: 77.00 

Round   3, Train loss: 0.026, Test loss: 0.886, Test accuracy: 78.90 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.024, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 0.800, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.102, Train accuracy: 96.000, Test loss: 1.132, Test accuracy: 74.00 

Round   4, Train loss: 0.052, Test loss: 0.941, Test accuracy: 78.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.165, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.800, Test loss: 0.798, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.032, Train accuracy: 98.800, Test loss: 1.042, Test accuracy: 78.00 

Round   5, Train loss: 0.019, Test loss: 0.868, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 0.765, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 0.816, Test accuracy: 78.80 

Round   6, Train loss: 0.014, Test loss: 0.842, Test accuracy: 81.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.017, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 0.922, Test accuracy: 79.40 

Round   7, Train loss: 0.012, Test loss: 0.837, Test accuracy: 80.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.742, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.088, Test accuracy: 79.40 

Round   8, Train loss: 0.004, Test loss: 0.892, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 81.60 

Round   9, Train loss: 0.002, Test loss: 0.844, Test accuracy: 80.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 83.00 

Round  10, Train loss: 0.001, Test loss: 0.823, Test accuracy: 81.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 0.963, Test accuracy: 80.40 

Round  11, Train loss: 0.007, Test loss: 0.875, Test accuracy: 80.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.193, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 79.00 

Round  12, Train loss: 0.011, Test loss: 0.917, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.016, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.400, Test loss: 1.162, Test accuracy: 76.80 

Round  13, Train loss: 0.017, Test loss: 0.948, Test accuracy: 79.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.153, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 84.20 

Round  14, Train loss: 0.000, Test loss: 0.879, Test accuracy: 81.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.100, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 84.00 

Round  15, Train loss: 0.001, Test loss: 0.912, Test accuracy: 79.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.044, Test accuracy: 79.80 

Round  16, Train loss: 0.015, Test loss: 0.905, Test accuracy: 80.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.937, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 82.20 

Round  17, Train loss: 0.001, Test loss: 0.887, Test accuracy: 80.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.850, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 81.80 

Round  18, Train loss: 0.000, Test loss: 0.885, Test accuracy: 81.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 82.20 

Round  19, Train loss: 0.000, Test loss: 0.875, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 81.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 81.40 

Final Round, Train loss: 0.000, Test loss: 0.875, Test accuracy: 82.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.579, Train accuracy: 77.800, Test loss: 0.662, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 80.40 

        train local model (freeze embeding):client   2,  Train loss: 0.571, Train accuracy: 77.600, Test loss: 0.708, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.144, Train accuracy: 95.400, Test loss: 0.866, Test accuracy: 77.80 

Round   0, Train loss: 0.048, Test loss: 0.779, Test accuracy: 80.47 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.283, Train accuracy: 90.000, Test loss: 0.665, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.130, Train accuracy: 95.200, Test loss: 1.078, Test accuracy: 74.20 

Round   1, Train loss: 0.044, Test loss: 0.767, Test accuracy: 81.13 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 0.784, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 79.20 

        train local model (freeze embeding):client   2,  Train loss: 0.143, Train accuracy: 94.800, Test loss: 0.765, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.056, Train accuracy: 97.600, Test loss: 1.004, Test accuracy: 75.80 

Round   2, Train loss: 0.022, Test loss: 0.814, Test accuracy: 79.13 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.758, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.103, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.101, Train accuracy: 97.200, Test loss: 0.720, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.922, Test accuracy: 77.00 

Round   3, Train loss: 0.013, Test loss: 0.824, Test accuracy: 79.93 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.820, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 0.774, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.126, Test accuracy: 75.20 

Round   4, Train loss: 0.010, Test loss: 0.858, Test accuracy: 80.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 0.948, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 0.866, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.042, Train accuracy: 99.200, Test loss: 1.274, Test accuracy: 75.00 

Round   5, Train loss: 0.028, Test loss: 0.861, Test accuracy: 80.27 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.013, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.060, Train accuracy: 97.600, Test loss: 1.080, Test accuracy: 78.40 

Round   6, Train loss: 0.024, Test loss: 0.846, Test accuracy: 81.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.067, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 80.40 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 0.904, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.165, Test accuracy: 75.00 

Round   7, Train loss: 0.008, Test loss: 0.833, Test accuracy: 81.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 77.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.995, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 0.861, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.188, Train accuracy: 94.600, Test loss: 1.529, Test accuracy: 70.60 

Round   8, Train loss: 0.065, Test loss: 0.862, Test accuracy: 80.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.814, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 77.40 

Round   9, Train loss: 0.002, Test loss: 0.813, Test accuracy: 81.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.766, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 81.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.945, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.106, Test accuracy: 78.00 

Round  10, Train loss: 0.012, Test loss: 0.832, Test accuracy: 81.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.748, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.913, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.438, Test accuracy: 74.80 

Round  11, Train loss: 0.004, Test loss: 0.921, Test accuracy: 80.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.278, Test accuracy: 75.40 

Round  12, Train loss: 0.005, Test loss: 0.885, Test accuracy: 80.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.130, Test accuracy: 78.40 

Round  13, Train loss: 0.001, Test loss: 0.872, Test accuracy: 81.47 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 78.20 

Round  14, Train loss: 0.001, Test loss: 0.846, Test accuracy: 81.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.842, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 81.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 78.20 

Round  15, Train loss: 0.001, Test loss: 0.804, Test accuracy: 81.73 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.832, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 83.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.106, Train accuracy: 96.800, Test loss: 1.625, Test accuracy: 70.20 

Round  16, Train loss: 0.035, Test loss: 0.873, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.832, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 78.60 

Round  17, Train loss: 0.000, Test loss: 0.837, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 82.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 79.40 

Round  18, Train loss: 0.000, Test loss: 0.849, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 77.80 

Round  19, Train loss: 0.002, Test loss: 0.906, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.846, Test accuracy: 82.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 79.80 

Final Round, Train loss: 0.000, Test loss: 0.900, Test accuracy: 81.33 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.441, Train accuracy: 83.600, Test loss: 0.707, Test accuracy: 77.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.817, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.219, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 1.169, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.404, Train accuracy: 86.800, Test loss: 0.705, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.168, Train accuracy: 94.000, Test loss: 1.077, Test accuracy: 72.80 

Round   0, Train loss: 0.047, Test loss: 0.871, Test accuracy: 80.70 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.820, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.048, Train accuracy: 97.400, Test loss: 1.028, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 78.20 

        train local model (freeze embeding):client   3,  Train loss: 0.189, Train accuracy: 93.200, Test loss: 0.711, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.800, Test loss: 1.058, Test accuracy: 73.60 

Round   1, Train loss: 0.029, Test loss: 0.853, Test accuracy: 81.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 0.958, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.760, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 79.80 

        train local model (freeze embeding):client   3,  Train loss: 0.116, Train accuracy: 96.200, Test loss: 0.750, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.040, Train accuracy: 98.800, Test loss: 0.963, Test accuracy: 76.80 

Round   2, Train loss: 0.014, Test loss: 0.807, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.779, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 83.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.720, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.116, Train accuracy: 96.800, Test loss: 1.596, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.044, Train accuracy: 98.600, Test loss: 0.735, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 0.972, Test accuracy: 76.00 

Round   3, Train loss: 0.036, Test loss: 0.837, Test accuracy: 81.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.743, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.804, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.772, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.994, Test accuracy: 79.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 78.80 

        train local model (freeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 0.745, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.052, Train accuracy: 98.600, Test loss: 1.091, Test accuracy: 73.60 

Round   4, Train loss: 0.019, Test loss: 0.794, Test accuracy: 82.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.690, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 82.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.068, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 0.814, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.065, Train accuracy: 98.400, Test loss: 0.975, Test accuracy: 78.40 

Round   5, Train loss: 0.020, Test loss: 0.780, Test accuracy: 82.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.170, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.779, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.200, Test loss: 1.062, Test accuracy: 75.80 

Round   6, Train loss: 0.010, Test loss: 0.761, Test accuracy: 82.45 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.660, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.717, Test accuracy: 86.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 83.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 98.400, Test loss: 1.147, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 0.890, Test accuracy: 78.40 

Round   7, Train loss: 0.015, Test loss: 0.741, Test accuracy: 82.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.645, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 0.987, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.647, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.885, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.005, Test accuracy: 78.00 

Round   8, Train loss: 0.008, Test loss: 0.755, Test accuracy: 82.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.720, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.689, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.768, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 78.80 

Round   9, Train loss: 0.001, Test loss: 0.779, Test accuracy: 83.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.679, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.722, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.188, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.200, Test loss: 1.044, Test accuracy: 76.80 

Round  10, Train loss: 0.011, Test loss: 0.781, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.496, Test accuracy: 74.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.172, Test accuracy: 76.40 

Round  11, Train loss: 0.019, Test loss: 0.811, Test accuracy: 82.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.731, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.674, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.807, Test accuracy: 84.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.808, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.023, Test accuracy: 77.80 

Round  12, Train loss: 0.003, Test loss: 0.827, Test accuracy: 82.55 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.693, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 82.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 85.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 77.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 79.80 

Round  13, Train loss: 0.001, Test loss: 0.814, Test accuracy: 82.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.652, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 83.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 86.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.722, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.045, Test accuracy: 78.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.047, Train accuracy: 98.200, Test loss: 1.315, Test accuracy: 74.60 

Round  14, Train loss: 0.012, Test loss: 0.802, Test accuracy: 82.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.707, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 0.982, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.340, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.341, Test accuracy: 74.20 

Round  15, Train loss: 0.016, Test loss: 0.787, Test accuracy: 82.35 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.639, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 83.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 79.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.057, Test accuracy: 78.60 

Round  16, Train loss: 0.006, Test loss: 0.798, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.671, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 0.986, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 80.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 81.60 

Round  17, Train loss: 0.004, Test loss: 0.790, Test accuracy: 83.25 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.737, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.635, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.629, Test accuracy: 88.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 80.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.047, Test accuracy: 79.40 

Round  18, Train loss: 0.003, Test loss: 0.792, Test accuracy: 83.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.652, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.840, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.627, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 84.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.169, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.062, Test accuracy: 78.20 

Round  19, Train loss: 0.005, Test loss: 0.810, Test accuracy: 82.90 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.693, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.685, Test accuracy: 84.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.680, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.666, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 80.20 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 82.40 

Final Round, Train loss: 0.000, Test loss: 0.816, Test accuracy: 83.15 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.437, Train accuracy: 85.600, Test loss: 0.665, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.681, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.685, Test accuracy: 85.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.306, Test accuracy: 76.80 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 0.942, Test accuracy: 79.60 

        train local model (freeze embeding):client   4,  Train loss: 0.467, Train accuracy: 83.400, Test loss: 0.618, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.198, Train accuracy: 92.800, Test loss: 1.144, Test accuracy: 73.60 

Round   0, Train loss: 0.041, Test loss: 0.769, Test accuracy: 82.88 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.690, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.696, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.680, Test accuracy: 86.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.809, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.267, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.259, Train accuracy: 90.800, Test loss: 0.648, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.093, Train accuracy: 95.800, Test loss: 0.951, Test accuracy: 74.20 

Round   1, Train loss: 0.023, Test loss: 0.770, Test accuracy: 82.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.755, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.680, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 87.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.289, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.141, Train accuracy: 94.800, Test loss: 0.718, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 0.891, Test accuracy: 78.40 

Round   2, Train loss: 0.015, Test loss: 0.761, Test accuracy: 83.36 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.627, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 83.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.048, Train accuracy: 98.600, Test loss: 1.273, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.092, Train accuracy: 97.000, Test loss: 0.722, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 75.60 

Round   3, Train loss: 0.014, Test loss: 0.798, Test accuracy: 82.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.671, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.652, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 86.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 81.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.850, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.003, Test accuracy: 79.20 

        train local model (freeze embeding):client   4,  Train loss: 0.064, Train accuracy: 99.000, Test loss: 0.751, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.049, Train accuracy: 98.600, Test loss: 1.146, Test accuracy: 73.20 

Round   4, Train loss: 0.011, Test loss: 0.780, Test accuracy: 82.84 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 83.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.661, Test accuracy: 86.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 83.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 82.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 80.60 

        train local model (freeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.200, Test loss: 0.729, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.031, Train accuracy: 98.600, Test loss: 1.102, Test accuracy: 77.40 

Round   5, Train loss: 0.007, Test loss: 0.782, Test accuracy: 83.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.694, Test accuracy: 86.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 85.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.249, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.139, Train accuracy: 96.600, Test loss: 1.447, Test accuracy: 72.20 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 0.771, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.057, Test accuracy: 78.00 

Round   6, Train loss: 0.040, Test loss: 0.782, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.687, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.660, Test accuracy: 86.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.639, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.851, Test accuracy: 80.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 80.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 0.973, Test accuracy: 79.20 

        train local model (freeze embeding):client   4,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 0.827, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.340, Test accuracy: 73.60 

Round   7, Train loss: 0.013, Test loss: 0.740, Test accuracy: 83.64 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.618, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 84.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.749, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 0.971, Test accuracy: 79.40 

        train local model (freeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 0.810, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.000, Test accuracy: 77.20 

Round   8, Train loss: 0.004, Test loss: 0.748, Test accuracy: 83.76 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.613, Test accuracy: 87.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.660, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.653, Test accuracy: 87.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 81.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.741, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 83.20 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 0.788, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.214, Test accuracy: 73.80 

Round   9, Train loss: 0.005, Test loss: 0.757, Test accuracy: 83.68 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.640, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.670, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 81.80 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.816, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.102, Train accuracy: 97.000, Test loss: 1.170, Test accuracy: 76.00 

Round  10, Train loss: 0.021, Test loss: 0.748, Test accuracy: 83.72 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.654, Test accuracy: 86.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.720, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.658, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.400, Test loss: 0.805, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.308, Test accuracy: 76.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 82.60 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.842, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.073, Train accuracy: 98.200, Test loss: 1.339, Test accuracy: 73.60 

Round  11, Train loss: 0.021, Test loss: 0.767, Test accuracy: 83.52 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.620, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.706, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.648, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 86.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.007, Test accuracy: 83.20 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 81.60 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.218, Test accuracy: 75.20 

Round  12, Train loss: 0.004, Test loss: 0.780, Test accuracy: 83.68 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.655, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.907, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.625, Test accuracy: 86.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 78.60 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 83.40 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.131, Test accuracy: 74.40 

Round  13, Train loss: 0.009, Test loss: 0.773, Test accuracy: 83.24 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.623, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 84.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.649, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.785, Test accuracy: 84.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.840, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 79.60 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.882, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 77.80 

Round  14, Train loss: 0.002, Test loss: 0.787, Test accuracy: 83.44 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.644, Test accuracy: 86.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.708, Test accuracy: 84.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.659, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.705, Test accuracy: 85.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 82.60 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 76.80 

Round  15, Train loss: 0.001, Test loss: 0.769, Test accuracy: 83.48 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.667, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 84.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.630, Test accuracy: 86.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.655, Test accuracy: 86.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.989, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 82.80 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 77.80 

Round  16, Train loss: 0.001, Test loss: 0.797, Test accuracy: 83.68 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.680, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.800, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.631, Test accuracy: 86.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 83.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.832, Test accuracy: 82.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.186, Test accuracy: 78.20 

Round  17, Train loss: 0.006, Test loss: 0.795, Test accuracy: 83.16 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.675, Test accuracy: 86.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.727, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.624, Test accuracy: 86.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.668, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 81.40 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 83.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.057, Test accuracy: 77.20 

Round  18, Train loss: 0.002, Test loss: 0.785, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.612, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.667, Test accuracy: 85.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.646, Test accuracy: 85.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 82.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.044, Train accuracy: 98.600, Test loss: 1.194, Test accuracy: 77.80 

Round  19, Train loss: 0.009, Test loss: 0.789, Test accuracy: 82.76 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.660, Test accuracy: 86.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.677, Test accuracy: 86.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.635, Test accuracy: 85.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.812, Test accuracy: 82.60 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.902, Test accuracy: 78.60 

Final Round, Train loss: 0.000, Test loss: 0.782, Test accuracy: 83.32 

Average accuracy final 10 rounds: 401.51966666666675 

4802.681317567825
[14.890954494476318, 29.475860834121704, 44.43922543525696, 59.89009141921997, 75.1302490234375, 90.12036728858948, 104.88459634780884, 119.69967913627625, 134.52698588371277, 149.79334211349487, 164.09485912322998, 178.57841897010803, 194.23454403877258, 209.18548965454102, 224.03880143165588, 239.12359833717346, 253.43386268615723, 268.8483371734619, 283.70419335365295, 298.51451301574707, 306.53328800201416, 321.528755903244, 336.28194212913513, 350.935551404953, 365.59327578544617, 381.1174883842468, 396.10230803489685, 411.11745500564575, 426.52579951286316, 441.5020990371704, 456.9992413520813, 472.435830116272, 487.29027104377747, 502.6753203868866, 518.3320574760437, 533.9168787002563, 548.7557499408722, 563.9016420841217, 579.2811841964722, 594.6799991130829, 609.7248394489288, 617.7759776115417, 633.0026054382324, 648.1209349632263, 663.5861401557922, 679.4166398048401, 694.6270608901978, 710.1307256221771, 725.2561616897583, 740.3344552516937, 755.4906680583954, 771.0076959133148, 786.6600096225739, 802.3565890789032, 818.0051963329315, 834.564165353775, 850.1557328701019, 865.6431341171265, 880.8063519001007, 896.3678963184357, 911.6317117214203, 926.7031552791595, 936.0804312229156, 951.4218392372131, 966.8589215278625, 982.2083775997162, 997.5918388366699, 1012.7728793621063, 1028.2426002025604, 1044.1756925582886, 1059.5302579402924, 1074.9696509838104, 1090.1610279083252, 1104.9597415924072, 1120.7963490486145, 1135.8391587734222, 1150.8781063556671, 1166.6821522712708, 1181.9466488361359, 1198.203283548355, 1213.6305277347565, 1228.6542596817017, 1243.9715764522552, 1252.610749721527, 1267.6868796348572, 1282.9574337005615, 1298.1761202812195, 1313.1034860610962, 1328.206696510315, 1343.8748111724854, 1359.0768475532532, 1374.101542711258, 1389.659657716751, 1405.5932214260101, 1420.6441826820374, 1438.2937383651733, 1454.2989757061005, 1469.7966389656067, 1484.9433732032776, 1500.394513130188, 1516.8047242164612, 1532.7316370010376, 1548.3125903606415, 1563.7106940746307, 1572.3022758960724]
[64.8, 64.4, 70.4, 72.4, 70.0, 71.8, 70.4, 69.0, 71.4, 71.6, 72.2, 74.2, 74.4, 73.4, 72.4, 71.6, 72.0, 75.4, 71.0, 72.2, 71.6, 76.7, 78.2, 78.3, 78.9, 78.2, 79.5, 81.7, 80.3, 80.0, 80.9, 81.7, 80.1, 80.5, 79.8, 81.9, 79.9, 80.6, 80.9, 81.6, 81.5, 82.0, 80.46666666666667, 81.13333333333334, 79.13333333333334, 79.93333333333334, 80.8, 80.26666666666667, 81.4, 81.6, 80.26666666666667, 81.8, 81.73333333333333, 80.8, 80.93333333333334, 81.46666666666667, 81.8, 81.73333333333333, 81.33333333333333, 82.0, 81.33333333333333, 81.33333333333333, 81.33333333333333, 80.7, 81.4, 82.5, 81.8, 82.9, 82.4, 82.45, 82.8, 82.65, 83.4, 83.25, 82.85, 82.55, 82.9, 82.85, 82.35, 83.0, 83.25, 83.65, 82.9, 83.15, 82.88, 82.52, 83.36, 82.8, 82.84, 83.04, 83.2, 83.64, 83.76, 83.68, 83.72, 83.52, 83.68, 83.24, 83.44, 83.48, 83.68, 83.16, 83.2, 82.76, 83.32]
