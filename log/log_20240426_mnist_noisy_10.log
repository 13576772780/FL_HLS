nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.288, Test loss: 2.288, Test accuracy: 17.46
Round   0, Global train loss: 2.288, Global test loss: 2.297, Global test accuracy: 16.46
Round   1, Train loss: 2.187, Test loss: 2.172, Test accuracy: 31.80
Round   1, Global train loss: 2.187, Global test loss: 2.208, Global test accuracy: 22.32
Round   2, Train loss: 1.818, Test loss: 2.017, Test accuracy: 50.80
Round   2, Global train loss: 1.818, Global test loss: 2.052, Global test accuracy: 46.44
Round   3, Train loss: 1.925, Test loss: 1.925, Test accuracy: 58.38
Round   3, Global train loss: 1.925, Global test loss: 2.051, Global test accuracy: 48.96
Round   4, Train loss: 1.894, Test loss: 1.836, Test accuracy: 65.70
Round   4, Global train loss: 1.894, Global test loss: 2.060, Global test accuracy: 45.10
Round   5, Train loss: 1.767, Test loss: 1.801, Test accuracy: 69.06
Round   5, Global train loss: 1.767, Global test loss: 2.039, Global test accuracy: 40.58
Round   6, Train loss: 1.757, Test loss: 1.728, Test accuracy: 76.28
Round   6, Global train loss: 1.757, Global test loss: 2.009, Global test accuracy: 48.88
Round   7, Train loss: 1.758, Test loss: 1.695, Test accuracy: 80.26
Round   7, Global train loss: 1.758, Global test loss: 2.006, Global test accuracy: 47.96
Round   8, Train loss: 1.608, Test loss: 1.669, Test accuracy: 82.76
Round   8, Global train loss: 1.608, Global test loss: 2.133, Global test accuracy: 30.76
Round   9, Train loss: 1.589, Test loss: 1.657, Test accuracy: 83.32
Round   9, Global train loss: 1.589, Global test loss: 2.140, Global test accuracy: 30.66
Round  10, Train loss: 1.509, Test loss: 1.655, Test accuracy: 83.06
Round  10, Global train loss: 1.509, Global test loss: 2.048, Global test accuracy: 43.02
Round  11, Train loss: 1.578, Test loss: 1.642, Test accuracy: 83.66
Round  11, Global train loss: 1.578, Global test loss: 2.016, Global test accuracy: 44.94
Round  12, Train loss: 1.557, Test loss: 1.640, Test accuracy: 83.62
Round  12, Global train loss: 1.557, Global test loss: 2.135, Global test accuracy: 31.48
Round  13, Train loss: 1.612, Test loss: 1.625, Test accuracy: 85.28
Round  13, Global train loss: 1.612, Global test loss: 1.966, Global test accuracy: 50.94
Round  14, Train loss: 1.488, Test loss: 1.624, Test accuracy: 85.32
Round  14, Global train loss: 1.488, Global test loss: 2.124, Global test accuracy: 31.54
Round  15, Train loss: 1.609, Test loss: 1.624, Test accuracy: 85.46
Round  15, Global train loss: 1.609, Global test loss: 2.044, Global test accuracy: 39.78
Round  16, Train loss: 1.616, Test loss: 1.619, Test accuracy: 85.54
Round  16, Global train loss: 1.616, Global test loss: 2.083, Global test accuracy: 33.22
Round  17, Train loss: 1.506, Test loss: 1.611, Test accuracy: 86.10
Round  17, Global train loss: 1.506, Global test loss: 2.004, Global test accuracy: 46.66
Round  18, Train loss: 1.604, Test loss: 1.610, Test accuracy: 86.14
Round  18, Global train loss: 1.604, Global test loss: 2.051, Global test accuracy: 41.02
Round  19, Train loss: 1.603, Test loss: 1.610, Test accuracy: 86.06
Round  19, Global train loss: 1.603, Global test loss: 1.965, Global test accuracy: 47.60
Round  20, Train loss: 1.550, Test loss: 1.607, Test accuracy: 86.10
Round  20, Global train loss: 1.550, Global test loss: 2.004, Global test accuracy: 44.78
Round  21, Train loss: 1.548, Test loss: 1.607, Test accuracy: 86.20
Round  21, Global train loss: 1.548, Global test loss: 1.983, Global test accuracy: 44.12
Round  22, Train loss: 1.604, Test loss: 1.606, Test accuracy: 86.16
Round  22, Global train loss: 1.604, Global test loss: 1.865, Global test accuracy: 60.12
Round  23, Train loss: 1.602, Test loss: 1.606, Test accuracy: 86.12
Round  23, Global train loss: 1.602, Global test loss: 1.994, Global test accuracy: 46.54
Round  24, Train loss: 1.603, Test loss: 1.606, Test accuracy: 86.08
Round  24, Global train loss: 1.603, Global test loss: 2.003, Global test accuracy: 45.94
Round  25, Train loss: 1.595, Test loss: 1.595, Test accuracy: 87.68
Round  25, Global train loss: 1.595, Global test loss: 1.948, Global test accuracy: 49.30
Round  26, Train loss: 1.487, Test loss: 1.588, Test accuracy: 87.98
Round  26, Global train loss: 1.487, Global test loss: 2.081, Global test accuracy: 36.32
Round  27, Train loss: 1.606, Test loss: 1.589, Test accuracy: 88.02
Round  27, Global train loss: 1.606, Global test loss: 2.025, Global test accuracy: 42.44
Round  28, Train loss: 1.537, Test loss: 1.589, Test accuracy: 88.02
Round  28, Global train loss: 1.537, Global test loss: 1.959, Global test accuracy: 49.48
Round  29, Train loss: 1.604, Test loss: 1.589, Test accuracy: 87.98
Round  29, Global train loss: 1.604, Global test loss: 2.028, Global test accuracy: 41.92
Round  30, Train loss: 1.540, Test loss: 1.588, Test accuracy: 88.02
Round  30, Global train loss: 1.540, Global test loss: 2.059, Global test accuracy: 39.46
Round  31, Train loss: 1.540, Test loss: 1.587, Test accuracy: 88.00
Round  31, Global train loss: 1.540, Global test loss: 2.043, Global test accuracy: 40.02
Round  32, Train loss: 1.539, Test loss: 1.587, Test accuracy: 87.96
Round  32, Global train loss: 1.539, Global test loss: 2.046, Global test accuracy: 42.82
Round  33, Train loss: 1.540, Test loss: 1.587, Test accuracy: 87.98
Round  33, Global train loss: 1.540, Global test loss: 2.142, Global test accuracy: 28.08
Round  34, Train loss: 1.599, Test loss: 1.587, Test accuracy: 88.00
Round  34, Global train loss: 1.599, Global test loss: 2.060, Global test accuracy: 38.26
Round  35, Train loss: 1.479, Test loss: 1.586, Test accuracy: 88.04
Round  35, Global train loss: 1.479, Global test loss: 2.028, Global test accuracy: 43.58
Round  36, Train loss: 1.536, Test loss: 1.586, Test accuracy: 88.08
Round  36, Global train loss: 1.536, Global test loss: 1.957, Global test accuracy: 51.04
Round  37, Train loss: 1.532, Test loss: 1.586, Test accuracy: 88.02
Round  37, Global train loss: 1.532, Global test loss: 2.117, Global test accuracy: 32.60
Round  38, Train loss: 1.534, Test loss: 1.586, Test accuracy: 87.98
Round  38, Global train loss: 1.534, Global test loss: 2.058, Global test accuracy: 39.56
Round  39, Train loss: 1.469, Test loss: 1.586, Test accuracy: 88.02
Round  39, Global train loss: 1.469, Global test loss: 1.978, Global test accuracy: 48.16
Round  40, Train loss: 1.474, Test loss: 1.586, Test accuracy: 88.00
Round  40, Global train loss: 1.474, Global test loss: 2.123, Global test accuracy: 33.32
Round  41, Train loss: 1.539, Test loss: 1.586, Test accuracy: 88.10
Round  41, Global train loss: 1.539, Global test loss: 2.047, Global test accuracy: 42.92
Round  42, Train loss: 1.532, Test loss: 1.585, Test accuracy: 88.02
Round  42, Global train loss: 1.532, Global test loss: 2.069, Global test accuracy: 39.12
Round  43, Train loss: 1.534, Test loss: 1.585, Test accuracy: 88.06
Round  43, Global train loss: 1.534, Global test loss: 2.045, Global test accuracy: 40.66
Round  44, Train loss: 1.475, Test loss: 1.585, Test accuracy: 88.04
Round  44, Global train loss: 1.475, Global test loss: 2.125, Global test accuracy: 31.80
Round  45, Train loss: 1.537, Test loss: 1.585, Test accuracy: 88.02
Round  45, Global train loss: 1.537, Global test loss: 2.154, Global test accuracy: 28.62
Round  46, Train loss: 1.476, Test loss: 1.585, Test accuracy: 87.98
Round  46, Global train loss: 1.476, Global test loss: 2.045, Global test accuracy: 42.72
Round  47, Train loss: 1.533, Test loss: 1.585, Test accuracy: 87.98
Round  47, Global train loss: 1.533, Global test loss: 1.898, Global test accuracy: 58.96
Round  48, Train loss: 1.469, Test loss: 1.585, Test accuracy: 87.98
Round  48, Global train loss: 1.469, Global test loss: 1.958, Global test accuracy: 51.82
Round  49, Train loss: 1.471, Test loss: 1.585, Test accuracy: 87.98
Round  49, Global train loss: 1.471, Global test loss: 1.990, Global test accuracy: 46.86
Round  50, Train loss: 1.532, Test loss: 1.585, Test accuracy: 87.98
Round  50, Global train loss: 1.532, Global test loss: 2.002, Global test accuracy: 44.52
Round  51, Train loss: 1.535, Test loss: 1.582, Test accuracy: 88.14
Round  51, Global train loss: 1.535, Global test loss: 2.016, Global test accuracy: 42.26
Round  52, Train loss: 1.472, Test loss: 1.582, Test accuracy: 88.10
Round  52, Global train loss: 1.472, Global test loss: 2.058, Global test accuracy: 40.36
Round  53, Train loss: 1.550, Test loss: 1.571, Test accuracy: 89.50
Round  53, Global train loss: 1.550, Global test loss: 2.042, Global test accuracy: 40.04
Round  54, Train loss: 1.539, Test loss: 1.570, Test accuracy: 89.42
Round  54, Global train loss: 1.539, Global test loss: 1.967, Global test accuracy: 48.88
Round  55, Train loss: 1.539, Test loss: 1.570, Test accuracy: 89.48
Round  55, Global train loss: 1.539, Global test loss: 2.088, Global test accuracy: 37.32
Round  56, Train loss: 1.469, Test loss: 1.570, Test accuracy: 89.46
Round  56, Global train loss: 1.469, Global test loss: 2.078, Global test accuracy: 37.36
Round  57, Train loss: 1.535, Test loss: 1.570, Test accuracy: 89.52
Round  57, Global train loss: 1.535, Global test loss: 1.993, Global test accuracy: 46.70
Round  58, Train loss: 1.538, Test loss: 1.570, Test accuracy: 89.46
Round  58, Global train loss: 1.538, Global test loss: 2.126, Global test accuracy: 32.66
Round  59, Train loss: 1.474, Test loss: 1.571, Test accuracy: 89.44
Round  59, Global train loss: 1.474, Global test loss: 2.027, Global test accuracy: 42.28
Round  60, Train loss: 1.534, Test loss: 1.571, Test accuracy: 89.46
Round  60, Global train loss: 1.534, Global test loss: 2.005, Global test accuracy: 44.04
Round  61, Train loss: 1.471, Test loss: 1.571, Test accuracy: 89.44
Round  61, Global train loss: 1.471, Global test loss: 2.055, Global test accuracy: 39.78
Round  62, Train loss: 1.534, Test loss: 1.570, Test accuracy: 89.56
Round  62, Global train loss: 1.534, Global test loss: 1.876, Global test accuracy: 59.12
Round  63, Train loss: 1.597, Test loss: 1.570, Test accuracy: 89.56
Round  63, Global train loss: 1.597, Global test loss: 1.992, Global test accuracy: 46.88
Round  64, Train loss: 1.598, Test loss: 1.570, Test accuracy: 89.56
Round  64, Global train loss: 1.598, Global test loss: 1.990, Global test accuracy: 45.00
Round  65, Train loss: 1.473, Test loss: 1.569, Test accuracy: 89.60
Round  65, Global train loss: 1.473, Global test loss: 2.026, Global test accuracy: 43.50
Round  66, Train loss: 1.534, Test loss: 1.557, Test accuracy: 91.06
Round  66, Global train loss: 1.534, Global test loss: 2.010, Global test accuracy: 42.04
Round  67, Train loss: 1.485, Test loss: 1.555, Test accuracy: 91.26
Round  67, Global train loss: 1.485, Global test loss: 2.022, Global test accuracy: 44.32
Round  68, Train loss: 1.532, Test loss: 1.555, Test accuracy: 91.20
Round  68, Global train loss: 1.532, Global test loss: 1.998, Global test accuracy: 44.72
Round  69, Train loss: 1.471, Test loss: 1.554, Test accuracy: 91.18
Round  69, Global train loss: 1.471, Global test loss: 2.030, Global test accuracy: 43.52
Round  70, Train loss: 1.470, Test loss: 1.555, Test accuracy: 91.20
Round  70, Global train loss: 1.470, Global test loss: 2.030, Global test accuracy: 40.52
Round  71, Train loss: 1.470, Test loss: 1.555, Test accuracy: 91.20
Round  71, Global train loss: 1.470, Global test loss: 1.922, Global test accuracy: 52.10
Round  72, Train loss: 1.473, Test loss: 1.554, Test accuracy: 91.20
Round  72, Global train loss: 1.473, Global test loss: 2.026, Global test accuracy: 43.62
Round  73, Train loss: 1.516, Test loss: 1.543, Test accuracy: 92.48
Round  73, Global train loss: 1.516, Global test loss: 2.027, Global test accuracy: 42.58
Round  74, Train loss: 1.475, Test loss: 1.542, Test accuracy: 92.56
Round  74, Global train loss: 1.475, Global test loss: 2.001, Global test accuracy: 45.04
Round  75, Train loss: 1.480, Test loss: 1.538, Test accuracy: 93.06
Round  75, Global train loss: 1.480, Global test loss: 1.864, Global test accuracy: 57.72
Round  76, Train loss: 1.470, Test loss: 1.537, Test accuracy: 93.02
Round  76, Global train loss: 1.470, Global test loss: 1.995, Global test accuracy: 46.06
Round  77, Train loss: 1.471, Test loss: 1.537, Test accuracy: 92.92
Round  77, Global train loss: 1.471, Global test loss: 1.915, Global test accuracy: 54.26
Round  78, Train loss: 1.469, Test loss: 1.537, Test accuracy: 92.96
Round  78, Global train loss: 1.469, Global test loss: 1.975, Global test accuracy: 49.02
Round  79, Train loss: 1.468, Test loss: 1.537, Test accuracy: 92.96
Round  79, Global train loss: 1.468, Global test loss: 2.127, Global test accuracy: 31.88
Round  80, Train loss: 1.472, Test loss: 1.537, Test accuracy: 92.92
Round  80, Global train loss: 1.472, Global test loss: 2.075, Global test accuracy: 36.70
Round  81, Train loss: 1.472, Test loss: 1.536, Test accuracy: 92.98
Round  81, Global train loss: 1.472, Global test loss: 2.126, Global test accuracy: 31.68
Round  82, Train loss: 1.471, Test loss: 1.536, Test accuracy: 92.98
Round  82, Global train loss: 1.471, Global test loss: 2.057, Global test accuracy: 40.20
Round  83, Train loss: 1.467, Test loss: 1.536, Test accuracy: 92.98
Round  83, Global train loss: 1.467, Global test loss: 2.084, Global test accuracy: 35.14
Round  84, Train loss: 1.474, Test loss: 1.536, Test accuracy: 93.06
Round  84, Global train loss: 1.474, Global test loss: 2.012, Global test accuracy: 41.60
Round  85, Train loss: 1.473, Test loss: 1.536, Test accuracy: 93.06
Round  85, Global train loss: 1.473, Global test loss: 2.072, Global test accuracy: 37.26
Round  86, Train loss: 1.472, Test loss: 1.535, Test accuracy: 93.12
Round  86, Global train loss: 1.472, Global test loss: 2.080, Global test accuracy: 35.62
Round  87, Train loss: 1.469, Test loss: 1.535, Test accuracy: 93.14
Round  87, Global train loss: 1.469, Global test loss: 1.919, Global test accuracy: 54.58
Round  88, Train loss: 1.469, Test loss: 1.535, Test accuracy: 93.16
Round  88, Global train loss: 1.469, Global test loss: 1.928, Global test accuracy: 53.50
Round  89, Train loss: 1.470, Test loss: 1.535, Test accuracy: 93.18
Round  89, Global train loss: 1.470, Global test loss: 1.937, Global test accuracy: 52.24
Round  90, Train loss: 1.469, Test loss: 1.535, Test accuracy: 93.08
Round  90, Global train loss: 1.469, Global test loss: 1.897, Global test accuracy: 56.84
Round  91, Train loss: 1.467, Test loss: 1.535, Test accuracy: 93.06
Round  91, Global train loss: 1.467, Global test loss: 1.976, Global test accuracy: 49.82
Round  92, Train loss: 1.468, Test loss: 1.535, Test accuracy: 93.14
Round  92, Global train loss: 1.468, Global test loss: 1.987, Global test accuracy: 46.02
Round  93, Train loss: 1.474, Test loss: 1.535, Test accuracy: 93.16
Round  93, Global train loss: 1.474, Global test loss: 2.023, Global test accuracy: 43.42
Round  94, Train loss: 1.471, Test loss: 1.535, Test accuracy: 93.14
Round  94, Global train loss: 1.471, Global test loss: 1.988, Global test accuracy: 46.00
Round  95, Train loss: 1.469, Test loss: 1.535, Test accuracy: 93.14
Round  95, Global train loss: 1.469, Global test loss: 1.931, Global test accuracy: 53.96/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.471, Test loss: 1.535, Test accuracy: 93.14
Round  96, Global train loss: 1.471, Global test loss: 2.061, Global test accuracy: 38.24
Round  97, Train loss: 1.468, Test loss: 1.535, Test accuracy: 93.16
Round  97, Global train loss: 1.468, Global test loss: 1.967, Global test accuracy: 48.60
Round  98, Train loss: 1.472, Test loss: 1.535, Test accuracy: 93.16
Round  98, Global train loss: 1.472, Global test loss: 2.131, Global test accuracy: 31.30
Round  99, Train loss: 1.473, Test loss: 1.535, Test accuracy: 93.16
Round  99, Global train loss: 1.473, Global test loss: 2.022, Global test accuracy: 43.50
Final Round, Train loss: 1.469, Test loss: 1.534, Test accuracy: 93.12
Final Round, Global train loss: 1.469, Global test loss: 2.022, Global test accuracy: 43.50
Average accuracy final 10 rounds: 93.13400000000001 

Average global accuracy final 10 rounds: 45.77 

786.9380505084991
[1.034684181213379, 2.069368362426758, 3.037788152694702, 4.0062079429626465, 5.040116548538208, 6.0740251541137695, 7.063889265060425, 8.05375337600708, 9.125656604766846, 10.197559833526611, 11.245528936386108, 12.293498039245605, 13.302772760391235, 14.312047481536865, 15.455385208129883, 16.5987229347229, 17.71392560005188, 18.82912826538086, 19.76061701774597, 20.692105770111084, 22.093531847000122, 23.49495792388916, 24.69230341911316, 25.889648914337158, 26.93592095375061, 27.982192993164062, 29.070465326309204, 30.158737659454346, 31.241297960281372, 32.3238582611084, 33.36029124259949, 34.396724224090576, 35.407246589660645, 36.41776895523071, 37.35667967796326, 38.2955904006958, 39.39685130119324, 40.498112201690674, 41.55513095855713, 42.612149715423584, 43.74123573303223, 44.87032175064087, 45.83330202102661, 46.79628229141235, 47.73960518836975, 48.68292808532715, 49.75910210609436, 50.83527612686157, 51.940064907073975, 53.04485368728638, 54.03137230873108, 55.01789093017578, 56.21341633796692, 57.40894174575806, 58.338083267211914, 59.26722478866577, 60.285024642944336, 61.3028244972229, 62.4816620349884, 63.660499572753906, 64.71284890174866, 65.76519823074341, 66.81670761108398, 67.86821699142456, 69.02140522003174, 70.17459344863892, 71.28936338424683, 72.40413331985474, 73.46315789222717, 74.52218246459961, 75.54361343383789, 76.56504440307617, 77.57056093215942, 78.57607746124268, 79.5551426410675, 80.53420782089233, 81.5835235118866, 82.63283920288086, 83.64586281776428, 84.6588864326477, 85.72989654541016, 86.80090665817261, 87.88991212844849, 88.97891759872437, 90.0454728603363, 91.11202812194824, 92.04497027397156, 92.97791242599487, 94.03908681869507, 95.10026121139526, 96.08223915100098, 97.06421709060669, 98.10363864898682, 99.14306020736694, 100.28843855857849, 101.43381690979004, 102.45432782173157, 103.4748387336731, 104.5211226940155, 105.56740665435791, 106.58882188796997, 107.61023712158203, 108.64378881454468, 109.67734050750732, 110.71454167366028, 111.75174283981323, 112.8187255859375, 113.88570833206177, 114.9483470916748, 116.01098585128784, 117.0474681854248, 118.08395051956177, 119.12296342849731, 120.16197633743286, 121.11634755134583, 122.07071876525879, 123.18868017196655, 124.30664157867432, 125.31564784049988, 126.32465410232544, 127.31659889221191, 128.3085436820984, 129.32833170890808, 130.34811973571777, 131.47052240371704, 132.5929250717163, 133.61247754096985, 134.6320300102234, 135.67368841171265, 136.7153468132019, 137.70679926872253, 138.69825172424316, 139.76824355125427, 140.83823537826538, 141.79561686515808, 142.75299835205078, 143.82508897781372, 144.89717960357666, 145.98174571990967, 147.06631183624268, 148.02961826324463, 148.99292469024658, 149.93123364448547, 150.86954259872437, 152.164208650589, 153.4588747024536, 154.50920343399048, 155.55953216552734, 156.58467268943787, 157.6098132133484, 158.8188545703888, 160.0278959274292, 161.12616682052612, 162.22443771362305, 163.37876176834106, 164.53308582305908, 165.64843273162842, 166.76377964019775, 167.7722282409668, 168.78067684173584, 169.8301944732666, 170.87971210479736, 171.97992396354675, 173.08013582229614, 174.11893892288208, 175.15774202346802, 176.1971890926361, 177.2366361618042, 178.3695409297943, 179.50244569778442, 180.48650360107422, 181.470561504364, 182.53573393821716, 183.6009063720703, 184.61061429977417, 185.62032222747803, 186.67338275909424, 187.72644329071045, 188.93893814086914, 190.15143299102783, 191.28409266471863, 192.41675233840942, 193.42229557037354, 194.42783880233765, 195.51591062545776, 196.60398244857788, 197.64726758003235, 198.69055271148682, 199.7018964290619, 200.71324014663696, 201.75949716567993, 202.8057541847229, 203.80989837646484, 204.8140425682068, 205.88621997833252, 206.95839738845825, 208.03298163414001, 209.10756587982178, 210.32937932014465, 211.55119276046753, 213.81378602981567, 216.07637929916382]
[17.46, 17.46, 31.8, 31.8, 50.8, 50.8, 58.38, 58.38, 65.7, 65.7, 69.06, 69.06, 76.28, 76.28, 80.26, 80.26, 82.76, 82.76, 83.32, 83.32, 83.06, 83.06, 83.66, 83.66, 83.62, 83.62, 85.28, 85.28, 85.32, 85.32, 85.46, 85.46, 85.54, 85.54, 86.1, 86.1, 86.14, 86.14, 86.06, 86.06, 86.1, 86.1, 86.2, 86.2, 86.16, 86.16, 86.12, 86.12, 86.08, 86.08, 87.68, 87.68, 87.98, 87.98, 88.02, 88.02, 88.02, 88.02, 87.98, 87.98, 88.02, 88.02, 88.0, 88.0, 87.96, 87.96, 87.98, 87.98, 88.0, 88.0, 88.04, 88.04, 88.08, 88.08, 88.02, 88.02, 87.98, 87.98, 88.02, 88.02, 88.0, 88.0, 88.1, 88.1, 88.02, 88.02, 88.06, 88.06, 88.04, 88.04, 88.02, 88.02, 87.98, 87.98, 87.98, 87.98, 87.98, 87.98, 87.98, 87.98, 87.98, 87.98, 88.14, 88.14, 88.1, 88.1, 89.5, 89.5, 89.42, 89.42, 89.48, 89.48, 89.46, 89.46, 89.52, 89.52, 89.46, 89.46, 89.44, 89.44, 89.46, 89.46, 89.44, 89.44, 89.56, 89.56, 89.56, 89.56, 89.56, 89.56, 89.6, 89.6, 91.06, 91.06, 91.26, 91.26, 91.2, 91.2, 91.18, 91.18, 91.2, 91.2, 91.2, 91.2, 91.2, 91.2, 92.48, 92.48, 92.56, 92.56, 93.06, 93.06, 93.02, 93.02, 92.92, 92.92, 92.96, 92.96, 92.96, 92.96, 92.92, 92.92, 92.98, 92.98, 92.98, 92.98, 92.98, 92.98, 93.06, 93.06, 93.06, 93.06, 93.12, 93.12, 93.14, 93.14, 93.16, 93.16, 93.18, 93.18, 93.08, 93.08, 93.06, 93.06, 93.14, 93.14, 93.16, 93.16, 93.14, 93.14, 93.14, 93.14, 93.14, 93.14, 93.16, 93.16, 93.16, 93.16, 93.16, 93.16, 93.12, 93.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.286, Test loss: 2.284, Test accuracy: 28.82
Round   0, Global train loss: 2.286, Global test loss: 2.293, Global test accuracy: 26.92
Round   1, Train loss: 2.197, Test loss: 2.160, Test accuracy: 38.28
Round   1, Global train loss: 2.197, Global test loss: 2.167, Global test accuracy: 39.34
Round   2, Train loss: 1.970, Test loss: 1.993, Test accuracy: 49.44
Round   2, Global train loss: 1.970, Global test loss: 2.037, Global test accuracy: 48.54
Round   3, Train loss: 1.889, Test loss: 1.932, Test accuracy: 53.42
Round   3, Global train loss: 1.889, Global test loss: 2.021, Global test accuracy: 42.82
Round   4, Train loss: 1.828, Test loss: 1.924, Test accuracy: 53.56
Round   4, Global train loss: 1.828, Global test loss: 1.981, Global test accuracy: 46.76
Round   5, Train loss: 1.745, Test loss: 1.879, Test accuracy: 57.90
Round   5, Global train loss: 1.745, Global test loss: 1.917, Global test accuracy: 55.82
Round   6, Train loss: 1.829, Test loss: 1.820, Test accuracy: 64.78
Round   6, Global train loss: 1.829, Global test loss: 1.914, Global test accuracy: 54.90
Round   7, Train loss: 1.709, Test loss: 1.780, Test accuracy: 68.28
Round   7, Global train loss: 1.709, Global test loss: 1.860, Global test accuracy: 61.56
Round   8, Train loss: 1.776, Test loss: 1.749, Test accuracy: 72.16
Round   8, Global train loss: 1.776, Global test loss: 1.975, Global test accuracy: 46.30
Round   9, Train loss: 1.566, Test loss: 1.713, Test accuracy: 75.82
Round   9, Global train loss: 1.566, Global test loss: 1.779, Global test accuracy: 72.76
Round  10, Train loss: 1.632, Test loss: 1.711, Test accuracy: 75.82
Round  10, Global train loss: 1.632, Global test loss: 1.815, Global test accuracy: 66.32
Round  11, Train loss: 1.697, Test loss: 1.709, Test accuracy: 75.84
Round  11, Global train loss: 1.697, Global test loss: 1.828, Global test accuracy: 63.58
Round  12, Train loss: 1.529, Test loss: 1.678, Test accuracy: 79.02
Round  12, Global train loss: 1.529, Global test loss: 1.780, Global test accuracy: 69.22
Round  13, Train loss: 1.690, Test loss: 1.675, Test accuracy: 79.26
Round  13, Global train loss: 1.690, Global test loss: 1.750, Global test accuracy: 72.38
Round  14, Train loss: 1.621, Test loss: 1.670, Test accuracy: 79.44
Round  14, Global train loss: 1.621, Global test loss: 1.772, Global test accuracy: 69.88
Round  15, Train loss: 1.621, Test loss: 1.669, Test accuracy: 79.60
Round  15, Global train loss: 1.621, Global test loss: 1.731, Global test accuracy: 74.38
Round  16, Train loss: 1.686, Test loss: 1.667, Test accuracy: 79.86
Round  16, Global train loss: 1.686, Global test loss: 1.760, Global test accuracy: 71.22
Round  17, Train loss: 1.739, Test loss: 1.666, Test accuracy: 79.86
Round  17, Global train loss: 1.739, Global test loss: 1.782, Global test accuracy: 68.62
Round  18, Train loss: 1.620, Test loss: 1.666, Test accuracy: 79.90
Round  18, Global train loss: 1.620, Global test loss: 1.750, Global test accuracy: 72.18
Round  19, Train loss: 1.625, Test loss: 1.667, Test accuracy: 79.66
Round  19, Global train loss: 1.625, Global test loss: 1.734, Global test accuracy: 73.42
Round  20, Train loss: 1.614, Test loss: 1.666, Test accuracy: 79.70
Round  20, Global train loss: 1.614, Global test loss: 1.742, Global test accuracy: 72.32
Round  21, Train loss: 1.620, Test loss: 1.665, Test accuracy: 79.90
Round  21, Global train loss: 1.620, Global test loss: 1.713, Global test accuracy: 75.50
Round  22, Train loss: 1.554, Test loss: 1.664, Test accuracy: 79.96
Round  22, Global train loss: 1.554, Global test loss: 1.704, Global test accuracy: 76.76
Round  23, Train loss: 1.547, Test loss: 1.665, Test accuracy: 79.82
Round  23, Global train loss: 1.547, Global test loss: 1.729, Global test accuracy: 74.02
Round  24, Train loss: 1.671, Test loss: 1.664, Test accuracy: 79.86
Round  24, Global train loss: 1.671, Global test loss: 1.739, Global test accuracy: 72.74
Round  25, Train loss: 1.557, Test loss: 1.664, Test accuracy: 79.78
Round  25, Global train loss: 1.557, Global test loss: 1.739, Global test accuracy: 72.92
Round  26, Train loss: 1.737, Test loss: 1.663, Test accuracy: 79.86
Round  26, Global train loss: 1.737, Global test loss: 1.709, Global test accuracy: 76.08
Round  27, Train loss: 1.674, Test loss: 1.663, Test accuracy: 80.00
Round  27, Global train loss: 1.674, Global test loss: 1.717, Global test accuracy: 74.82
Round  28, Train loss: 1.675, Test loss: 1.663, Test accuracy: 79.84
Round  28, Global train loss: 1.675, Global test loss: 1.697, Global test accuracy: 77.08
Round  29, Train loss: 1.673, Test loss: 1.663, Test accuracy: 80.04
Round  29, Global train loss: 1.673, Global test loss: 1.708, Global test accuracy: 76.20
Round  30, Train loss: 1.488, Test loss: 1.662, Test accuracy: 80.20
Round  30, Global train loss: 1.488, Global test loss: 1.724, Global test accuracy: 74.20
Round  31, Train loss: 1.608, Test loss: 1.661, Test accuracy: 80.26
Round  31, Global train loss: 1.608, Global test loss: 1.732, Global test accuracy: 73.36
Round  32, Train loss: 1.671, Test loss: 1.661, Test accuracy: 80.20
Round  32, Global train loss: 1.671, Global test loss: 1.761, Global test accuracy: 70.28
Round  33, Train loss: 1.607, Test loss: 1.661, Test accuracy: 80.18
Round  33, Global train loss: 1.607, Global test loss: 1.723, Global test accuracy: 74.48
Round  34, Train loss: 1.542, Test loss: 1.660, Test accuracy: 80.26
Round  34, Global train loss: 1.542, Global test loss: 1.738, Global test accuracy: 72.76
Round  35, Train loss: 1.482, Test loss: 1.660, Test accuracy: 80.20
Round  35, Global train loss: 1.482, Global test loss: 1.750, Global test accuracy: 70.88
Round  36, Train loss: 1.671, Test loss: 1.660, Test accuracy: 80.22
Round  36, Global train loss: 1.671, Global test loss: 1.709, Global test accuracy: 75.64
Round  37, Train loss: 1.608, Test loss: 1.660, Test accuracy: 80.16
Round  37, Global train loss: 1.608, Global test loss: 1.702, Global test accuracy: 76.52
Round  38, Train loss: 1.542, Test loss: 1.660, Test accuracy: 80.22
Round  38, Global train loss: 1.542, Global test loss: 1.716, Global test accuracy: 75.28
Round  39, Train loss: 1.610, Test loss: 1.660, Test accuracy: 80.12
Round  39, Global train loss: 1.610, Global test loss: 1.707, Global test accuracy: 75.72
Round  40, Train loss: 1.670, Test loss: 1.661, Test accuracy: 80.06
Round  40, Global train loss: 1.670, Global test loss: 1.750, Global test accuracy: 71.16
Round  41, Train loss: 1.731, Test loss: 1.660, Test accuracy: 80.06
Round  41, Global train loss: 1.731, Global test loss: 1.732, Global test accuracy: 73.00
Round  42, Train loss: 1.609, Test loss: 1.660, Test accuracy: 80.04
Round  42, Global train loss: 1.609, Global test loss: 1.705, Global test accuracy: 76.10
Round  43, Train loss: 1.665, Test loss: 1.661, Test accuracy: 80.00
Round  43, Global train loss: 1.665, Global test loss: 1.706, Global test accuracy: 76.20
Round  44, Train loss: 1.547, Test loss: 1.661, Test accuracy: 80.02
Round  44, Global train loss: 1.547, Global test loss: 1.694, Global test accuracy: 77.18
Round  45, Train loss: 1.603, Test loss: 1.661, Test accuracy: 80.10
Round  45, Global train loss: 1.603, Global test loss: 1.706, Global test accuracy: 76.26
Round  46, Train loss: 1.733, Test loss: 1.660, Test accuracy: 80.16
Round  46, Global train loss: 1.733, Global test loss: 1.698, Global test accuracy: 76.90
Round  47, Train loss: 1.543, Test loss: 1.660, Test accuracy: 80.06
Round  47, Global train loss: 1.543, Global test loss: 1.707, Global test accuracy: 75.78
Round  48, Train loss: 1.669, Test loss: 1.660, Test accuracy: 80.10
Round  48, Global train loss: 1.669, Global test loss: 1.709, Global test accuracy: 75.42
Round  49, Train loss: 1.606, Test loss: 1.660, Test accuracy: 80.10
Round  49, Global train loss: 1.606, Global test loss: 1.704, Global test accuracy: 76.12
Round  50, Train loss: 1.542, Test loss: 1.660, Test accuracy: 80.14
Round  50, Global train loss: 1.542, Global test loss: 1.689, Global test accuracy: 77.58
Round  51, Train loss: 1.729, Test loss: 1.660, Test accuracy: 80.20
Round  51, Global train loss: 1.729, Global test loss: 1.696, Global test accuracy: 76.82
Round  52, Train loss: 1.600, Test loss: 1.660, Test accuracy: 80.18
Round  52, Global train loss: 1.600, Global test loss: 1.695, Global test accuracy: 76.70
Round  53, Train loss: 1.668, Test loss: 1.660, Test accuracy: 80.12
Round  53, Global train loss: 1.668, Global test loss: 1.702, Global test accuracy: 75.98
Round  54, Train loss: 1.535, Test loss: 1.660, Test accuracy: 80.10
Round  54, Global train loss: 1.535, Global test loss: 1.692, Global test accuracy: 77.08
Round  55, Train loss: 1.601, Test loss: 1.660, Test accuracy: 80.10
Round  55, Global train loss: 1.601, Global test loss: 1.693, Global test accuracy: 77.10
Round  56, Train loss: 1.535, Test loss: 1.660, Test accuracy: 80.10
Round  56, Global train loss: 1.535, Global test loss: 1.690, Global test accuracy: 77.22
Round  57, Train loss: 1.602, Test loss: 1.660, Test accuracy: 80.10
Round  57, Global train loss: 1.602, Global test loss: 1.698, Global test accuracy: 76.34
Round  58, Train loss: 1.600, Test loss: 1.660, Test accuracy: 80.12
Round  58, Global train loss: 1.600, Global test loss: 1.703, Global test accuracy: 75.96
Round  59, Train loss: 1.663, Test loss: 1.659, Test accuracy: 80.16
Round  59, Global train loss: 1.663, Global test loss: 1.711, Global test accuracy: 75.26
Round  60, Train loss: 1.730, Test loss: 1.659, Test accuracy: 80.12
Round  60, Global train loss: 1.730, Global test loss: 1.703, Global test accuracy: 76.08
Round  61, Train loss: 1.535, Test loss: 1.659, Test accuracy: 80.10
Round  61, Global train loss: 1.535, Global test loss: 1.691, Global test accuracy: 77.12
Round  62, Train loss: 1.602, Test loss: 1.660, Test accuracy: 80.04
Round  62, Global train loss: 1.602, Global test loss: 1.693, Global test accuracy: 77.18
Round  63, Train loss: 1.666, Test loss: 1.660, Test accuracy: 80.00
Round  63, Global train loss: 1.666, Global test loss: 1.695, Global test accuracy: 76.82
Round  64, Train loss: 1.664, Test loss: 1.660, Test accuracy: 79.94
Round  64, Global train loss: 1.664, Global test loss: 1.696, Global test accuracy: 76.84
Round  65, Train loss: 1.538, Test loss: 1.660, Test accuracy: 80.00
Round  65, Global train loss: 1.538, Global test loss: 1.697, Global test accuracy: 76.70
Round  66, Train loss: 1.791, Test loss: 1.660, Test accuracy: 79.96
Round  66, Global train loss: 1.791, Global test loss: 1.700, Global test accuracy: 76.34
Round  67, Train loss: 1.727, Test loss: 1.660, Test accuracy: 80.00
Round  67, Global train loss: 1.727, Global test loss: 1.714, Global test accuracy: 74.90
Round  68, Train loss: 1.535, Test loss: 1.659, Test accuracy: 80.14
Round  68, Global train loss: 1.535, Global test loss: 1.706, Global test accuracy: 75.58
Round  69, Train loss: 1.599, Test loss: 1.659, Test accuracy: 80.14
Round  69, Global train loss: 1.599, Global test loss: 1.705, Global test accuracy: 75.98
Round  70, Train loss: 1.600, Test loss: 1.659, Test accuracy: 80.12
Round  70, Global train loss: 1.600, Global test loss: 1.691, Global test accuracy: 77.38
Round  71, Train loss: 1.533, Test loss: 1.659, Test accuracy: 80.16
Round  71, Global train loss: 1.533, Global test loss: 1.701, Global test accuracy: 76.24
Round  72, Train loss: 1.599, Test loss: 1.659, Test accuracy: 80.16
Round  72, Global train loss: 1.599, Global test loss: 1.699, Global test accuracy: 76.44
Round  73, Train loss: 1.596, Test loss: 1.659, Test accuracy: 80.20
Round  73, Global train loss: 1.596, Global test loss: 1.699, Global test accuracy: 76.52
Round  74, Train loss: 1.538, Test loss: 1.659, Test accuracy: 80.14
Round  74, Global train loss: 1.538, Global test loss: 1.691, Global test accuracy: 77.38
Round  75, Train loss: 1.662, Test loss: 1.659, Test accuracy: 80.12
Round  75, Global train loss: 1.662, Global test loss: 1.692, Global test accuracy: 76.98
Round  76, Train loss: 1.605, Test loss: 1.658, Test accuracy: 80.18
Round  76, Global train loss: 1.605, Global test loss: 1.698, Global test accuracy: 76.42
Round  77, Train loss: 1.663, Test loss: 1.658, Test accuracy: 80.20
Round  77, Global train loss: 1.663, Global test loss: 1.693, Global test accuracy: 77.04
Round  78, Train loss: 1.532, Test loss: 1.658, Test accuracy: 80.24
Round  78, Global train loss: 1.532, Global test loss: 1.689, Global test accuracy: 77.30
Round  79, Train loss: 1.602, Test loss: 1.659, Test accuracy: 80.16
Round  79, Global train loss: 1.602, Global test loss: 1.699, Global test accuracy: 76.52
Round  80, Train loss: 1.726, Test loss: 1.659, Test accuracy: 80.12
Round  80, Global train loss: 1.726, Global test loss: 1.687, Global test accuracy: 77.64
Round  81, Train loss: 1.725, Test loss: 1.659, Test accuracy: 80.04
Round  81, Global train loss: 1.725, Global test loss: 1.690, Global test accuracy: 77.54
Round  82, Train loss: 1.600, Test loss: 1.658, Test accuracy: 80.20
Round  82, Global train loss: 1.600, Global test loss: 1.721, Global test accuracy: 74.10
Round  83, Train loss: 1.599, Test loss: 1.658, Test accuracy: 80.22
Round  83, Global train loss: 1.599, Global test loss: 1.686, Global test accuracy: 77.62
Round  84, Train loss: 1.601, Test loss: 1.659, Test accuracy: 80.18
Round  84, Global train loss: 1.601, Global test loss: 1.698, Global test accuracy: 76.32
Round  85, Train loss: 1.727, Test loss: 1.658, Test accuracy: 80.14
Round  85, Global train loss: 1.727, Global test loss: 1.690, Global test accuracy: 77.38
Round  86, Train loss: 1.726, Test loss: 1.658, Test accuracy: 80.16
Round  86, Global train loss: 1.726, Global test loss: 1.692, Global test accuracy: 77.26
Round  87, Train loss: 1.788, Test loss: 1.658, Test accuracy: 80.14
Round  87, Global train loss: 1.788, Global test loss: 1.696, Global test accuracy: 76.70
Round  88, Train loss: 1.599, Test loss: 1.658, Test accuracy: 80.22
Round  88, Global train loss: 1.599, Global test loss: 1.690, Global test accuracy: 77.30
Round  89, Train loss: 1.728, Test loss: 1.658, Test accuracy: 80.18
Round  89, Global train loss: 1.728, Global test loss: 1.691, Global test accuracy: 77.24
Round  90, Train loss: 1.596, Test loss: 1.658, Test accuracy: 80.18
Round  90, Global train loss: 1.596, Global test loss: 1.688, Global test accuracy: 77.62
Round  91, Train loss: 1.534, Test loss: 1.659, Test accuracy: 80.08
Round  91, Global train loss: 1.534, Global test loss: 1.681, Global test accuracy: 78.04
Round  92, Train loss: 1.536, Test loss: 1.658, Test accuracy: 80.06
Round  92, Global train loss: 1.536, Global test loss: 1.683, Global test accuracy: 78.08
Round  93, Train loss: 1.666, Test loss: 1.658, Test accuracy: 80.10
Round  93, Global train loss: 1.666, Global test loss: 1.683, Global test accuracy: 78.10
Round  94, Train loss: 1.531, Test loss: 1.658, Test accuracy: 80.08
Round  94, Global train loss: 1.531, Global test loss: 1.685, Global test accuracy: 77.86
Round  95, Train loss: 1.601, Test loss: 1.658, Test accuracy: 80.18
Round  95, Global train loss: 1.601, Global test loss: 1.681, Global test accuracy: 78.24/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.663, Test loss: 1.658, Test accuracy: 80.24
Round  96, Global train loss: 1.663, Global test loss: 1.690, Global test accuracy: 77.32
Round  97, Train loss: 1.532, Test loss: 1.657, Test accuracy: 80.26
Round  97, Global train loss: 1.532, Global test loss: 1.699, Global test accuracy: 76.62
Round  98, Train loss: 1.660, Test loss: 1.657, Test accuracy: 80.34
Round  98, Global train loss: 1.660, Global test loss: 1.681, Global test accuracy: 77.94
Round  99, Train loss: 1.533, Test loss: 1.657, Test accuracy: 80.24
Round  99, Global train loss: 1.533, Global test loss: 1.684, Global test accuracy: 77.72
Final Round, Train loss: 1.622, Test loss: 1.657, Test accuracy: 80.38
Final Round, Global train loss: 1.622, Global test loss: 1.684, Global test accuracy: 77.72
Average accuracy final 10 rounds: 80.176 

Average global accuracy final 10 rounds: 77.754 

795.7903158664703
[1.124180793762207, 2.248361587524414, 3.2706291675567627, 4.292896747589111, 5.284825563430786, 6.276754379272461, 7.357539653778076, 8.438324928283691, 9.446536779403687, 10.454748630523682, 11.614402055740356, 12.774055480957031, 13.792932033538818, 14.811808586120605, 15.958805799484253, 17.1058030128479, 18.064225435256958, 19.022647857666016, 20.079198598861694, 21.135749340057373, 22.130410194396973, 23.125071048736572, 24.637040853500366, 26.14901065826416, 27.51501989364624, 28.88102912902832, 29.921221256256104, 30.961413383483887, 32.02879500389099, 33.096176624298096, 34.34973120689392, 35.603285789489746, 36.714242696762085, 37.825199604034424, 38.88005495071411, 39.9349102973938, 40.99632525444031, 42.057740211486816, 43.162458658218384, 44.26717710494995, 45.388630390167236, 46.51008367538452, 47.49004864692688, 48.47001361846924, 49.45158553123474, 50.433157444000244, 51.58567976951599, 52.73820209503174, 53.8049099445343, 54.871617794036865, 55.89693641662598, 56.92225503921509, 58.355236768722534, 59.78821849822998, 60.83307480812073, 61.877931118011475, 62.93699502944946, 63.99605894088745, 65.08486342430115, 66.17366790771484, 67.27446413040161, 68.37526035308838, 69.57431554794312, 70.77337074279785, 71.73452830314636, 72.69568586349487, 73.99302959442139, 75.2903733253479, 76.18496775627136, 77.07956218719482, 78.15291357040405, 79.22626495361328, 80.29210877418518, 81.35795259475708, 83.00567317008972, 84.65339374542236, 86.38413500785828, 88.11487627029419, 89.80727791786194, 91.49967956542969, 92.74074196815491, 93.98180437088013, 95.01561045646667, 96.04941654205322, 97.13371706008911, 98.218017578125, 99.20448970794678, 100.19096183776855, 101.25719356536865, 102.32342529296875, 103.49787163734436, 104.67231798171997, 105.70845580101013, 106.7445936203003, 107.76651883125305, 108.78844404220581, 109.89203310012817, 110.99562215805054, 111.99323558807373, 112.99084901809692, 114.11367058753967, 115.23649215698242, 116.25629115104675, 117.27609014511108, 118.30652737617493, 119.33696460723877, 120.37262964248657, 121.40829467773438, 122.48912906646729, 123.5699634552002, 124.65054059028625, 125.73111772537231, 126.79343271255493, 127.85574769973755, 128.874773979187, 129.89380025863647, 130.8399052619934, 131.78601026535034, 132.7851300239563, 133.78424978256226, 135.27465748786926, 136.76506519317627, 137.99360036849976, 139.22213554382324, 140.28907680511475, 141.35601806640625, 142.38175082206726, 143.40748357772827, 144.48038601875305, 145.55328845977783, 146.64248275756836, 147.7316770553589, 148.84170961380005, 149.9517421722412, 150.98943543434143, 152.02712869644165, 153.08210802078247, 154.1370873451233, 155.1400065422058, 156.14292573928833, 157.37583088874817, 158.608736038208, 159.61021614074707, 160.61169624328613, 161.72255277633667, 162.8334093093872, 163.8850598335266, 164.93671035766602, 165.98885035514832, 167.04099035263062, 168.1254107952118, 169.20983123779297, 170.429518699646, 171.64920616149902, 172.68882775306702, 173.728449344635, 174.90004444122314, 176.07163953781128, 177.2056143283844, 178.33958911895752, 179.39883065223694, 180.45807218551636, 181.49171447753906, 182.52535676956177, 183.52148175239563, 184.5176067352295, 185.4838583469391, 186.45010995864868, 187.5471646785736, 188.64421939849854, 189.62096118927002, 190.5977029800415, 191.61513018608093, 192.63255739212036, 193.6683430671692, 194.70412874221802, 195.90906310081482, 197.11399745941162, 198.2263159751892, 199.3386344909668, 200.43029928207397, 201.52196407318115, 202.6097755432129, 203.69758701324463, 204.79616570472717, 205.89474439620972, 206.87724471092224, 207.85974502563477, 208.83757829666138, 209.815411567688, 210.9633526802063, 212.1112937927246, 213.10170578956604, 214.09211778640747, 215.10696935653687, 216.12182092666626, 217.21028351783752, 218.2987461090088, 219.35417294502258, 220.40959978103638, 222.50171613693237, 224.59383249282837]
[28.82, 28.82, 38.28, 38.28, 49.44, 49.44, 53.42, 53.42, 53.56, 53.56, 57.9, 57.9, 64.78, 64.78, 68.28, 68.28, 72.16, 72.16, 75.82, 75.82, 75.82, 75.82, 75.84, 75.84, 79.02, 79.02, 79.26, 79.26, 79.44, 79.44, 79.6, 79.6, 79.86, 79.86, 79.86, 79.86, 79.9, 79.9, 79.66, 79.66, 79.7, 79.7, 79.9, 79.9, 79.96, 79.96, 79.82, 79.82, 79.86, 79.86, 79.78, 79.78, 79.86, 79.86, 80.0, 80.0, 79.84, 79.84, 80.04, 80.04, 80.2, 80.2, 80.26, 80.26, 80.2, 80.2, 80.18, 80.18, 80.26, 80.26, 80.2, 80.2, 80.22, 80.22, 80.16, 80.16, 80.22, 80.22, 80.12, 80.12, 80.06, 80.06, 80.06, 80.06, 80.04, 80.04, 80.0, 80.0, 80.02, 80.02, 80.1, 80.1, 80.16, 80.16, 80.06, 80.06, 80.1, 80.1, 80.1, 80.1, 80.14, 80.14, 80.2, 80.2, 80.18, 80.18, 80.12, 80.12, 80.1, 80.1, 80.1, 80.1, 80.1, 80.1, 80.1, 80.1, 80.12, 80.12, 80.16, 80.16, 80.12, 80.12, 80.1, 80.1, 80.04, 80.04, 80.0, 80.0, 79.94, 79.94, 80.0, 80.0, 79.96, 79.96, 80.0, 80.0, 80.14, 80.14, 80.14, 80.14, 80.12, 80.12, 80.16, 80.16, 80.16, 80.16, 80.2, 80.2, 80.14, 80.14, 80.12, 80.12, 80.18, 80.18, 80.2, 80.2, 80.24, 80.24, 80.16, 80.16, 80.12, 80.12, 80.04, 80.04, 80.2, 80.2, 80.22, 80.22, 80.18, 80.18, 80.14, 80.14, 80.16, 80.16, 80.14, 80.14, 80.22, 80.22, 80.18, 80.18, 80.18, 80.18, 80.08, 80.08, 80.06, 80.06, 80.1, 80.1, 80.08, 80.08, 80.18, 80.18, 80.24, 80.24, 80.26, 80.26, 80.34, 80.34, 80.24, 80.24, 80.38, 80.38]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.292, Test loss: 2.293, Test accuracy: 29.48
Round   0, Global train loss: 2.292, Global test loss: 2.297, Global test accuracy: 32.00
Round   1, Train loss: 2.268, Test loss: 2.265, Test accuracy: 18.78
Round   1, Global train loss: 2.268, Global test loss: 2.278, Global test accuracy: 8.96
Round   2, Train loss: 2.131, Test loss: 2.141, Test accuracy: 37.52
Round   2, Global train loss: 2.131, Global test loss: 2.119, Global test accuracy: 30.38
Round   3, Train loss: 1.875, Test loss: 2.016, Test accuracy: 48.66
Round   3, Global train loss: 1.875, Global test loss: 2.006, Global test accuracy: 45.16
Round   4, Train loss: 1.764, Test loss: 1.954, Test accuracy: 56.60
Round   4, Global train loss: 1.764, Global test loss: 1.946, Global test accuracy: 55.92
Round   5, Train loss: 1.708, Test loss: 1.874, Test accuracy: 61.46
Round   5, Global train loss: 1.708, Global test loss: 1.932, Global test accuracy: 53.46
Round   6, Train loss: 1.759, Test loss: 1.786, Test accuracy: 70.02
Round   6, Global train loss: 1.759, Global test loss: 1.892, Global test accuracy: 59.54
Round   7, Train loss: 1.659, Test loss: 1.719, Test accuracy: 76.02
Round   7, Global train loss: 1.659, Global test loss: 1.896, Global test accuracy: 56.94
Round   8, Train loss: 1.615, Test loss: 1.704, Test accuracy: 77.02
Round   8, Global train loss: 1.615, Global test loss: 1.831, Global test accuracy: 63.24
Round   9, Train loss: 1.660, Test loss: 1.692, Test accuracy: 78.20
Round   9, Global train loss: 1.660, Global test loss: 1.813, Global test accuracy: 65.30
Round  10, Train loss: 1.658, Test loss: 1.694, Test accuracy: 77.86
Round  10, Global train loss: 1.658, Global test loss: 1.798, Global test accuracy: 69.46
Round  11, Train loss: 1.642, Test loss: 1.677, Test accuracy: 79.12
Round  11, Global train loss: 1.642, Global test loss: 1.768, Global test accuracy: 71.04
Round  12, Train loss: 1.691, Test loss: 1.674, Test accuracy: 79.44
Round  12, Global train loss: 1.691, Global test loss: 1.809, Global test accuracy: 66.08
Round  13, Train loss: 1.692, Test loss: 1.674, Test accuracy: 79.56
Round  13, Global train loss: 1.692, Global test loss: 1.804, Global test accuracy: 66.06
Round  14, Train loss: 1.644, Test loss: 1.660, Test accuracy: 81.10
Round  14, Global train loss: 1.644, Global test loss: 1.765, Global test accuracy: 70.82
Round  15, Train loss: 1.702, Test loss: 1.660, Test accuracy: 80.94
Round  15, Global train loss: 1.702, Global test loss: 1.767, Global test accuracy: 69.48
Round  16, Train loss: 1.636, Test loss: 1.658, Test accuracy: 80.90
Round  16, Global train loss: 1.636, Global test loss: 1.758, Global test accuracy: 71.30
Round  17, Train loss: 1.625, Test loss: 1.656, Test accuracy: 81.04
Round  17, Global train loss: 1.625, Global test loss: 1.779, Global test accuracy: 69.34
Round  18, Train loss: 1.559, Test loss: 1.656, Test accuracy: 80.94
Round  18, Global train loss: 1.559, Global test loss: 1.734, Global test accuracy: 74.48
Round  19, Train loss: 1.678, Test loss: 1.641, Test accuracy: 82.66
Round  19, Global train loss: 1.678, Global test loss: 1.772, Global test accuracy: 68.90
Round  20, Train loss: 1.571, Test loss: 1.639, Test accuracy: 82.82
Round  20, Global train loss: 1.571, Global test loss: 1.732, Global test accuracy: 73.28
Round  21, Train loss: 1.625, Test loss: 1.624, Test accuracy: 84.60
Round  21, Global train loss: 1.625, Global test loss: 1.709, Global test accuracy: 76.22
Round  22, Train loss: 1.509, Test loss: 1.607, Test accuracy: 86.28
Round  22, Global train loss: 1.509, Global test loss: 1.721, Global test accuracy: 75.10
Round  23, Train loss: 1.529, Test loss: 1.592, Test accuracy: 87.92
Round  23, Global train loss: 1.529, Global test loss: 1.712, Global test accuracy: 75.78
Round  24, Train loss: 1.494, Test loss: 1.590, Test accuracy: 88.02
Round  24, Global train loss: 1.494, Global test loss: 1.677, Global test accuracy: 79.42
Round  25, Train loss: 1.564, Test loss: 1.587, Test accuracy: 88.38
Round  25, Global train loss: 1.564, Global test loss: 1.683, Global test accuracy: 79.30
Round  26, Train loss: 1.512, Test loss: 1.585, Test accuracy: 88.46
Round  26, Global train loss: 1.512, Global test loss: 1.683, Global test accuracy: 79.22
Round  27, Train loss: 1.619, Test loss: 1.583, Test accuracy: 88.60
Round  27, Global train loss: 1.619, Global test loss: 1.686, Global test accuracy: 78.24
Round  28, Train loss: 1.554, Test loss: 1.582, Test accuracy: 88.66
Round  28, Global train loss: 1.554, Global test loss: 1.695, Global test accuracy: 77.52
Round  29, Train loss: 1.614, Test loss: 1.584, Test accuracy: 88.52
Round  29, Global train loss: 1.614, Global test loss: 1.694, Global test accuracy: 77.22
Round  30, Train loss: 1.551, Test loss: 1.584, Test accuracy: 88.48
Round  30, Global train loss: 1.551, Global test loss: 1.688, Global test accuracy: 77.78
Round  31, Train loss: 1.508, Test loss: 1.584, Test accuracy: 88.44
Round  31, Global train loss: 1.508, Global test loss: 1.628, Global test accuracy: 84.54
Round  32, Train loss: 1.494, Test loss: 1.583, Test accuracy: 88.72
Round  32, Global train loss: 1.494, Global test loss: 1.628, Global test accuracy: 84.26
Round  33, Train loss: 1.551, Test loss: 1.582, Test accuracy: 88.68
Round  33, Global train loss: 1.551, Global test loss: 1.682, Global test accuracy: 78.94
Round  34, Train loss: 1.625, Test loss: 1.577, Test accuracy: 88.88
Round  34, Global train loss: 1.625, Global test loss: 1.624, Global test accuracy: 84.22
Round  35, Train loss: 1.548, Test loss: 1.576, Test accuracy: 88.96
Round  35, Global train loss: 1.548, Global test loss: 1.624, Global test accuracy: 84.46
Round  36, Train loss: 1.486, Test loss: 1.575, Test accuracy: 89.22
Round  36, Global train loss: 1.486, Global test loss: 1.623, Global test accuracy: 84.56
Round  37, Train loss: 1.551, Test loss: 1.575, Test accuracy: 89.04
Round  37, Global train loss: 1.551, Global test loss: 1.630, Global test accuracy: 84.00
Round  38, Train loss: 1.551, Test loss: 1.574, Test accuracy: 88.98
Round  38, Global train loss: 1.551, Global test loss: 1.632, Global test accuracy: 83.88
Round  39, Train loss: 1.551, Test loss: 1.573, Test accuracy: 89.10
Round  39, Global train loss: 1.551, Global test loss: 1.638, Global test accuracy: 83.06
Round  40, Train loss: 1.491, Test loss: 1.573, Test accuracy: 89.10
Round  40, Global train loss: 1.491, Global test loss: 1.628, Global test accuracy: 84.22
Round  41, Train loss: 1.610, Test loss: 1.573, Test accuracy: 89.18
Round  41, Global train loss: 1.610, Global test loss: 1.612, Global test accuracy: 85.84
Round  42, Train loss: 1.549, Test loss: 1.573, Test accuracy: 89.18
Round  42, Global train loss: 1.549, Global test loss: 1.633, Global test accuracy: 83.80
Round  43, Train loss: 1.552, Test loss: 1.573, Test accuracy: 89.14
Round  43, Global train loss: 1.552, Global test loss: 1.630, Global test accuracy: 83.80
Round  44, Train loss: 1.486, Test loss: 1.572, Test accuracy: 89.10
Round  44, Global train loss: 1.486, Global test loss: 1.614, Global test accuracy: 85.38
Round  45, Train loss: 1.486, Test loss: 1.573, Test accuracy: 89.04
Round  45, Global train loss: 1.486, Global test loss: 1.611, Global test accuracy: 85.72
Round  46, Train loss: 1.545, Test loss: 1.572, Test accuracy: 89.04
Round  46, Global train loss: 1.545, Global test loss: 1.639, Global test accuracy: 82.72
Round  47, Train loss: 1.608, Test loss: 1.571, Test accuracy: 89.22
Round  47, Global train loss: 1.608, Global test loss: 1.614, Global test accuracy: 85.40
Round  48, Train loss: 1.609, Test loss: 1.571, Test accuracy: 89.26
Round  48, Global train loss: 1.609, Global test loss: 1.609, Global test accuracy: 86.04
Round  49, Train loss: 1.478, Test loss: 1.570, Test accuracy: 89.26
Round  49, Global train loss: 1.478, Global test loss: 1.631, Global test accuracy: 83.74
Round  50, Train loss: 1.541, Test loss: 1.570, Test accuracy: 89.26
Round  50, Global train loss: 1.541, Global test loss: 1.613, Global test accuracy: 85.62
Round  51, Train loss: 1.480, Test loss: 1.570, Test accuracy: 89.24
Round  51, Global train loss: 1.480, Global test loss: 1.602, Global test accuracy: 86.52
Round  52, Train loss: 1.475, Test loss: 1.571, Test accuracy: 89.20
Round  52, Global train loss: 1.475, Global test loss: 1.633, Global test accuracy: 83.82
Round  53, Train loss: 1.543, Test loss: 1.571, Test accuracy: 89.18
Round  53, Global train loss: 1.543, Global test loss: 1.614, Global test accuracy: 85.44
Round  54, Train loss: 1.608, Test loss: 1.571, Test accuracy: 89.14
Round  54, Global train loss: 1.608, Global test loss: 1.641, Global test accuracy: 82.60
Round  55, Train loss: 1.541, Test loss: 1.570, Test accuracy: 89.30
Round  55, Global train loss: 1.541, Global test loss: 1.618, Global test accuracy: 85.12
Round  56, Train loss: 1.477, Test loss: 1.570, Test accuracy: 89.28
Round  56, Global train loss: 1.477, Global test loss: 1.642, Global test accuracy: 82.46
Round  57, Train loss: 1.602, Test loss: 1.570, Test accuracy: 89.34
Round  57, Global train loss: 1.602, Global test loss: 1.622, Global test accuracy: 84.42
Round  58, Train loss: 1.540, Test loss: 1.570, Test accuracy: 89.24
Round  58, Global train loss: 1.540, Global test loss: 1.629, Global test accuracy: 83.66
Round  59, Train loss: 1.476, Test loss: 1.570, Test accuracy: 89.28
Round  59, Global train loss: 1.476, Global test loss: 1.623, Global test accuracy: 84.16
Round  60, Train loss: 1.480, Test loss: 1.570, Test accuracy: 89.36
Round  60, Global train loss: 1.480, Global test loss: 1.600, Global test accuracy: 86.80
Round  61, Train loss: 1.477, Test loss: 1.569, Test accuracy: 89.42
Round  61, Global train loss: 1.477, Global test loss: 1.623, Global test accuracy: 84.74
Round  62, Train loss: 1.537, Test loss: 1.569, Test accuracy: 89.38
Round  62, Global train loss: 1.537, Global test loss: 1.627, Global test accuracy: 84.14
Round  63, Train loss: 1.480, Test loss: 1.569, Test accuracy: 89.36
Round  63, Global train loss: 1.480, Global test loss: 1.603, Global test accuracy: 86.48
Round  64, Train loss: 1.471, Test loss: 1.569, Test accuracy: 89.44
Round  64, Global train loss: 1.471, Global test loss: 1.607, Global test accuracy: 85.98
Round  65, Train loss: 1.542, Test loss: 1.569, Test accuracy: 89.44
Round  65, Global train loss: 1.542, Global test loss: 1.607, Global test accuracy: 85.96
Round  66, Train loss: 1.543, Test loss: 1.569, Test accuracy: 89.44
Round  66, Global train loss: 1.543, Global test loss: 1.629, Global test accuracy: 83.86
Round  67, Train loss: 1.546, Test loss: 1.573, Test accuracy: 88.98
Round  67, Global train loss: 1.546, Global test loss: 1.600, Global test accuracy: 86.54
Round  68, Train loss: 1.540, Test loss: 1.568, Test accuracy: 89.48
Round  68, Global train loss: 1.540, Global test loss: 1.617, Global test accuracy: 85.44
Round  69, Train loss: 1.478, Test loss: 1.568, Test accuracy: 89.46
Round  69, Global train loss: 1.478, Global test loss: 1.600, Global test accuracy: 86.88
Round  70, Train loss: 1.539, Test loss: 1.569, Test accuracy: 89.38
Round  70, Global train loss: 1.539, Global test loss: 1.614, Global test accuracy: 85.16
Round  71, Train loss: 1.602, Test loss: 1.569, Test accuracy: 89.42
Round  71, Global train loss: 1.602, Global test loss: 1.604, Global test accuracy: 86.38
Round  72, Train loss: 1.544, Test loss: 1.569, Test accuracy: 89.58
Round  72, Global train loss: 1.544, Global test loss: 1.606, Global test accuracy: 86.08
Round  73, Train loss: 1.475, Test loss: 1.569, Test accuracy: 89.50
Round  73, Global train loss: 1.475, Global test loss: 1.607, Global test accuracy: 86.34
Round  74, Train loss: 1.604, Test loss: 1.569, Test accuracy: 89.50
Round  74, Global train loss: 1.604, Global test loss: 1.610, Global test accuracy: 85.72
Round  75, Train loss: 1.540, Test loss: 1.569, Test accuracy: 89.44
Round  75, Global train loss: 1.540, Global test loss: 1.615, Global test accuracy: 85.38
Round  76, Train loss: 1.539, Test loss: 1.569, Test accuracy: 89.46
Round  76, Global train loss: 1.539, Global test loss: 1.607, Global test accuracy: 86.02
Round  77, Train loss: 1.541, Test loss: 1.569, Test accuracy: 89.52
Round  77, Global train loss: 1.541, Global test loss: 1.621, Global test accuracy: 84.28
Round  78, Train loss: 1.536, Test loss: 1.569, Test accuracy: 89.46
Round  78, Global train loss: 1.536, Global test loss: 1.614, Global test accuracy: 85.26
Round  79, Train loss: 1.475, Test loss: 1.569, Test accuracy: 89.38
Round  79, Global train loss: 1.475, Global test loss: 1.605, Global test accuracy: 85.84
Round  80, Train loss: 1.542, Test loss: 1.569, Test accuracy: 89.36
Round  80, Global train loss: 1.542, Global test loss: 1.602, Global test accuracy: 86.12
Round  81, Train loss: 1.473, Test loss: 1.570, Test accuracy: 89.36
Round  81, Global train loss: 1.473, Global test loss: 1.612, Global test accuracy: 85.58
Round  82, Train loss: 1.601, Test loss: 1.570, Test accuracy: 89.40
Round  82, Global train loss: 1.601, Global test loss: 1.613, Global test accuracy: 85.38
Round  83, Train loss: 1.538, Test loss: 1.569, Test accuracy: 89.44
Round  83, Global train loss: 1.538, Global test loss: 1.604, Global test accuracy: 86.26
Round  84, Train loss: 1.540, Test loss: 1.569, Test accuracy: 89.48
Round  84, Global train loss: 1.540, Global test loss: 1.615, Global test accuracy: 85.16
Round  85, Train loss: 1.538, Test loss: 1.569, Test accuracy: 89.32
Round  85, Global train loss: 1.538, Global test loss: 1.596, Global test accuracy: 86.94
Round  86, Train loss: 1.469, Test loss: 1.569, Test accuracy: 89.34
Round  86, Global train loss: 1.469, Global test loss: 1.616, Global test accuracy: 85.28
Round  87, Train loss: 1.543, Test loss: 1.569, Test accuracy: 89.38
Round  87, Global train loss: 1.543, Global test loss: 1.619, Global test accuracy: 84.64
Round  88, Train loss: 1.537, Test loss: 1.568, Test accuracy: 89.48
Round  88, Global train loss: 1.537, Global test loss: 1.615, Global test accuracy: 84.92
Round  89, Train loss: 1.534, Test loss: 1.568, Test accuracy: 89.46
Round  89, Global train loss: 1.534, Global test loss: 1.613, Global test accuracy: 85.28
Round  90, Train loss: 1.474, Test loss: 1.568, Test accuracy: 89.44
Round  90, Global train loss: 1.474, Global test loss: 1.604, Global test accuracy: 85.92
Round  91, Train loss: 1.473, Test loss: 1.568, Test accuracy: 89.54
Round  91, Global train loss: 1.473, Global test loss: 1.608, Global test accuracy: 85.82
Round  92, Train loss: 1.472, Test loss: 1.568, Test accuracy: 89.46
Round  92, Global train loss: 1.472, Global test loss: 1.608, Global test accuracy: 85.94
Round  93, Train loss: 1.472, Test loss: 1.568, Test accuracy: 89.48
Round  93, Global train loss: 1.472, Global test loss: 1.610, Global test accuracy: 85.64
Round  94, Train loss: 1.599, Test loss: 1.568, Test accuracy: 89.50
Round  94, Global train loss: 1.599, Global test loss: 1.620, Global test accuracy: 84.60
Round  95, Train loss: 1.472, Test loss: 1.569, Test accuracy: 89.46
Round  95, Global train loss: 1.472, Global test loss: 1.608, Global test accuracy: 85.88/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 1.666, Test loss: 1.569, Test accuracy: 89.48
Round  96, Global train loss: 1.666, Global test loss: 1.601, Global test accuracy: 86.44
Round  97, Train loss: 1.533, Test loss: 1.569, Test accuracy: 89.46
Round  97, Global train loss: 1.533, Global test loss: 1.617, Global test accuracy: 84.92
Round  98, Train loss: 1.476, Test loss: 1.569, Test accuracy: 89.44
Round  98, Global train loss: 1.476, Global test loss: 1.599, Global test accuracy: 86.66
Round  99, Train loss: 1.535, Test loss: 1.570, Test accuracy: 89.40
Round  99, Global train loss: 1.535, Global test loss: 1.605, Global test accuracy: 86.10
Final Round, Train loss: 1.530, Test loss: 1.569, Test accuracy: 89.40
Final Round, Global train loss: 1.530, Global test loss: 1.605, Global test accuracy: 86.10
Average accuracy final 10 rounds: 89.46600000000001 

Average global accuracy final 10 rounds: 85.792 

852.369206905365
[1.2652273178100586, 2.530454635620117, 3.793748140335083, 5.057041645050049, 6.301246166229248, 7.545450687408447, 8.786128759384155, 10.026806831359863, 11.189848899841309, 12.352890968322754, 13.778436422348022, 15.203981876373291, 16.33846378326416, 17.47294569015503, 18.5481379032135, 19.623330116271973, 20.999065160751343, 22.374800205230713, 23.572641134262085, 24.770482063293457, 25.984175205230713, 27.19786834716797, 28.261313438415527, 29.324758529663086, 30.478044033050537, 31.63132953643799, 32.711604833602905, 33.79188013076782, 34.9801459312439, 36.16841173171997, 37.409806966781616, 38.65120220184326, 39.79759693145752, 40.94399166107178, 42.0819456577301, 43.21989965438843, 44.73008918762207, 46.24027872085571, 47.71196103096008, 49.18364334106445, 50.850738525390625, 52.5178337097168, 54.15251636505127, 55.78719902038574, 57.11286902427673, 58.438539028167725, 59.70575714111328, 60.97297525405884, 62.19290566444397, 63.4128360748291, 64.61918115615845, 65.8255262374878, 66.96088099479675, 68.09623575210571, 69.29246211051941, 70.4886884689331, 71.64656162261963, 72.80443477630615, 74.01187586784363, 75.2193169593811, 76.33410954475403, 77.44890213012695, 78.69272971153259, 79.93655729293823, 81.09104776382446, 82.2455382347107, 83.46638774871826, 84.68723726272583, 85.83996605873108, 86.99269485473633, 88.10140013694763, 89.21010541915894, 90.37374424934387, 91.53738307952881, 92.82065939903259, 94.10393571853638, 95.2370114326477, 96.37008714675903, 97.61478042602539, 98.85947370529175, 100.17147946357727, 101.4834852218628, 102.6824541091919, 103.881422996521, 105.0280270576477, 106.17463111877441, 107.41567015647888, 108.65670919418335, 109.87003707885742, 111.0833649635315, 112.29552698135376, 113.50768899917603, 114.65348935127258, 115.79928970336914, 116.92147064208984, 118.04365158081055, 119.19876646995544, 120.35388135910034, 121.4984712600708, 122.64306116104126, 123.86714386940002, 125.09122657775879, 126.33155846595764, 127.5718903541565, 128.7649335861206, 129.95797681808472, 131.08539080619812, 132.21280479431152, 133.29445600509644, 134.37610721588135, 135.75796508789062, 137.1398229598999, 138.5021312236786, 139.86443948745728, 141.46169757843018, 143.05895566940308, 144.47680377960205, 145.89465188980103, 147.62925267219543, 149.36385345458984, 150.9587128162384, 152.55357217788696, 153.67163586616516, 154.78969955444336, 155.88687992095947, 156.9840602874756, 158.10625076293945, 159.22844123840332, 160.45204710960388, 161.67565298080444, 162.9378523826599, 164.20005178451538, 165.36689925193787, 166.53374671936035, 167.70097494125366, 168.86820316314697, 170.09518957138062, 171.32217597961426, 172.47271299362183, 173.6232500076294, 174.81678557395935, 176.0103211402893, 177.22664761543274, 178.44297409057617, 179.5983965396881, 180.75381898880005, 181.84859776496887, 182.9433765411377, 184.12549328804016, 185.30761003494263, 186.68346285820007, 188.05931568145752, 189.2529296875, 190.44654369354248, 191.71993708610535, 192.9933304786682, 194.31142449378967, 195.62951850891113, 196.84019446372986, 198.05087041854858, 199.14936351776123, 200.24785661697388, 201.3761796951294, 202.5045027732849, 203.66231513023376, 204.82012748718262, 206.07092094421387, 207.32171440124512, 208.51548409461975, 209.70925378799438, 211.24408078193665, 212.7789077758789, 213.93328499794006, 215.08766222000122, 216.24733591079712, 217.40700960159302, 218.5635883808136, 219.72016716003418, 220.9446041584015, 222.1690411567688, 223.369136095047, 224.5692310333252, 225.82260704040527, 227.07598304748535, 228.67740058898926, 230.27881813049316, 231.86955881118774, 233.46029949188232, 235.06121397018433, 236.66212844848633, 238.41563653945923, 240.16914463043213, 241.3355016708374, 242.50185871124268, 243.78668475151062, 245.07151079177856, 246.4025592803955, 247.73360776901245, 248.85964226722717, 249.9856767654419, 252.32502484321594, 254.66437292099]
[29.48, 29.48, 18.78, 18.78, 37.52, 37.52, 48.66, 48.66, 56.6, 56.6, 61.46, 61.46, 70.02, 70.02, 76.02, 76.02, 77.02, 77.02, 78.2, 78.2, 77.86, 77.86, 79.12, 79.12, 79.44, 79.44, 79.56, 79.56, 81.1, 81.1, 80.94, 80.94, 80.9, 80.9, 81.04, 81.04, 80.94, 80.94, 82.66, 82.66, 82.82, 82.82, 84.6, 84.6, 86.28, 86.28, 87.92, 87.92, 88.02, 88.02, 88.38, 88.38, 88.46, 88.46, 88.6, 88.6, 88.66, 88.66, 88.52, 88.52, 88.48, 88.48, 88.44, 88.44, 88.72, 88.72, 88.68, 88.68, 88.88, 88.88, 88.96, 88.96, 89.22, 89.22, 89.04, 89.04, 88.98, 88.98, 89.1, 89.1, 89.1, 89.1, 89.18, 89.18, 89.18, 89.18, 89.14, 89.14, 89.1, 89.1, 89.04, 89.04, 89.04, 89.04, 89.22, 89.22, 89.26, 89.26, 89.26, 89.26, 89.26, 89.26, 89.24, 89.24, 89.2, 89.2, 89.18, 89.18, 89.14, 89.14, 89.3, 89.3, 89.28, 89.28, 89.34, 89.34, 89.24, 89.24, 89.28, 89.28, 89.36, 89.36, 89.42, 89.42, 89.38, 89.38, 89.36, 89.36, 89.44, 89.44, 89.44, 89.44, 89.44, 89.44, 88.98, 88.98, 89.48, 89.48, 89.46, 89.46, 89.38, 89.38, 89.42, 89.42, 89.58, 89.58, 89.5, 89.5, 89.5, 89.5, 89.44, 89.44, 89.46, 89.46, 89.52, 89.52, 89.46, 89.46, 89.38, 89.38, 89.36, 89.36, 89.36, 89.36, 89.4, 89.4, 89.44, 89.44, 89.48, 89.48, 89.32, 89.32, 89.34, 89.34, 89.38, 89.38, 89.48, 89.48, 89.46, 89.46, 89.44, 89.44, 89.54, 89.54, 89.46, 89.46, 89.48, 89.48, 89.5, 89.5, 89.46, 89.46, 89.48, 89.48, 89.46, 89.46, 89.44, 89.44, 89.4, 89.4, 89.4, 89.4]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.0 , level_n_lowerb:0.4  

fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.312, Test loss: 2.295, Test accuracy: 25.92
Round   0, Global train loss: 2.312, Global test loss: 2.296, Global test accuracy: 25.86
Round   1, Train loss: 2.286, Test loss: 2.279, Test accuracy: 28.42
Round   1, Global train loss: 2.286, Global test loss: 2.280, Global test accuracy: 26.36
Round   2, Train loss: 2.214, Test loss: 2.159, Test accuracy: 30.00
Round   2, Global train loss: 2.214, Global test loss: 2.154, Global test accuracy: 29.92
Round   3, Train loss: 2.040, Test loss: 2.098, Test accuracy: 35.90
Round   3, Global train loss: 2.040, Global test loss: 2.097, Global test accuracy: 32.30
Round   4, Train loss: 2.007, Test loss: 2.037, Test accuracy: 49.74
Round   4, Global train loss: 2.007, Global test loss: 2.063, Global test accuracy: 44.94
Round   5, Train loss: 1.890, Test loss: 1.965, Test accuracy: 54.86
Round   5, Global train loss: 1.890, Global test loss: 2.016, Global test accuracy: 47.06
Round   6, Train loss: 1.813, Test loss: 1.908, Test accuracy: 59.52
Round   6, Global train loss: 1.813, Global test loss: 1.986, Global test accuracy: 50.68
Round   7, Train loss: 1.712, Test loss: 1.847, Test accuracy: 65.68
Round   7, Global train loss: 1.712, Global test loss: 1.939, Global test accuracy: 54.64
Round   8, Train loss: 1.669, Test loss: 1.814, Test accuracy: 71.46
Round   8, Global train loss: 1.669, Global test loss: 1.948, Global test accuracy: 54.36
Round   9, Train loss: 1.676, Test loss: 1.747, Test accuracy: 78.38
Round   9, Global train loss: 1.676, Global test loss: 1.888, Global test accuracy: 61.32
Round  10, Train loss: 1.617, Test loss: 1.726, Test accuracy: 79.36
Round  10, Global train loss: 1.617, Global test loss: 1.869, Global test accuracy: 62.86
Round  11, Train loss: 1.609, Test loss: 1.685, Test accuracy: 83.90
Round  11, Global train loss: 1.609, Global test loss: 1.833, Global test accuracy: 66.34
Round  12, Train loss: 1.586, Test loss: 1.671, Test accuracy: 84.24
Round  12, Global train loss: 1.586, Global test loss: 1.866, Global test accuracy: 62.32
Round  13, Train loss: 1.679, Test loss: 1.607, Test accuracy: 91.10
Round  13, Global train loss: 1.679, Global test loss: 1.875, Global test accuracy: 64.02
Round  14, Train loss: 1.566, Test loss: 1.599, Test accuracy: 91.82
Round  14, Global train loss: 1.566, Global test loss: 1.937, Global test accuracy: 50.32
Round  15, Train loss: 1.565, Test loss: 1.589, Test accuracy: 92.10
Round  15, Global train loss: 1.565, Global test loss: 1.878, Global test accuracy: 56.08
Round  16, Train loss: 1.551, Test loss: 1.585, Test accuracy: 92.12
Round  16, Global train loss: 1.551, Global test loss: 1.835, Global test accuracy: 67.28
Round  17, Train loss: 1.536, Test loss: 1.585, Test accuracy: 91.94
Round  17, Global train loss: 1.536, Global test loss: 1.827, Global test accuracy: 68.62
Round  18, Train loss: 1.583, Test loss: 1.576, Test accuracy: 92.08
Round  18, Global train loss: 1.583, Global test loss: 1.816, Global test accuracy: 68.68
Round  19, Train loss: 1.553, Test loss: 1.570, Test accuracy: 92.52
Round  19, Global train loss: 1.553, Global test loss: 1.790, Global test accuracy: 71.78
Round  20, Train loss: 1.543, Test loss: 1.566, Test accuracy: 92.76
Round  20, Global train loss: 1.543, Global test loss: 1.914, Global test accuracy: 52.58
Round  21, Train loss: 1.530, Test loss: 1.563, Test accuracy: 92.78
Round  21, Global train loss: 1.530, Global test loss: 1.902, Global test accuracy: 52.56
Round  22, Train loss: 1.522, Test loss: 1.563, Test accuracy: 92.78
Round  22, Global train loss: 1.522, Global test loss: 1.806, Global test accuracy: 68.54
Round  23, Train loss: 1.554, Test loss: 1.558, Test accuracy: 92.84
Round  23, Global train loss: 1.554, Global test loss: 1.772, Global test accuracy: 73.50
Round  24, Train loss: 1.580, Test loss: 1.559, Test accuracy: 92.74
Round  24, Global train loss: 1.580, Global test loss: 1.796, Global test accuracy: 73.20
Round  25, Train loss: 1.539, Test loss: 1.559, Test accuracy: 92.60
Round  25, Global train loss: 1.539, Global test loss: 1.851, Global test accuracy: 64.26
Round  26, Train loss: 1.552, Test loss: 1.550, Test accuracy: 93.86
Round  26, Global train loss: 1.552, Global test loss: 1.817, Global test accuracy: 69.18
Round  27, Train loss: 1.514, Test loss: 1.545, Test accuracy: 94.56
Round  27, Global train loss: 1.514, Global test loss: 1.903, Global test accuracy: 54.36
Round  28, Train loss: 1.513, Test loss: 1.542, Test accuracy: 94.60
Round  28, Global train loss: 1.513, Global test loss: 1.880, Global test accuracy: 57.82
Round  29, Train loss: 1.518, Test loss: 1.539, Test accuracy: 94.88
Round  29, Global train loss: 1.518, Global test loss: 1.829, Global test accuracy: 65.64
Round  30, Train loss: 1.533, Test loss: 1.536, Test accuracy: 94.84
Round  30, Global train loss: 1.533, Global test loss: 1.836, Global test accuracy: 63.60
Round  31, Train loss: 1.509, Test loss: 1.535, Test accuracy: 94.94
Round  31, Global train loss: 1.509, Global test loss: 1.793, Global test accuracy: 68.78
Round  32, Train loss: 1.512, Test loss: 1.533, Test accuracy: 95.12
Round  32, Global train loss: 1.512, Global test loss: 1.731, Global test accuracy: 79.48
Round  33, Train loss: 1.504, Test loss: 1.534, Test accuracy: 94.86
Round  33, Global train loss: 1.504, Global test loss: 1.777, Global test accuracy: 71.62
Round  34, Train loss: 1.520, Test loss: 1.532, Test accuracy: 94.82
Round  34, Global train loss: 1.520, Global test loss: 1.907, Global test accuracy: 53.34
Round  35, Train loss: 1.511, Test loss: 1.533, Test accuracy: 94.64
Round  35, Global train loss: 1.511, Global test loss: 1.817, Global test accuracy: 67.40
Round  36, Train loss: 1.498, Test loss: 1.529, Test accuracy: 95.08
Round  36, Global train loss: 1.498, Global test loss: 1.786, Global test accuracy: 71.04
Round  37, Train loss: 1.502, Test loss: 1.531, Test accuracy: 94.88
Round  37, Global train loss: 1.502, Global test loss: 1.813, Global test accuracy: 67.04
Round  38, Train loss: 1.503, Test loss: 1.531, Test accuracy: 94.78
Round  38, Global train loss: 1.503, Global test loss: 1.871, Global test accuracy: 58.46
Round  39, Train loss: 1.495, Test loss: 1.532, Test accuracy: 94.58
Round  39, Global train loss: 1.495, Global test loss: 1.829, Global test accuracy: 63.04
Round  40, Train loss: 1.497, Test loss: 1.530, Test accuracy: 94.84
Round  40, Global train loss: 1.497, Global test loss: 1.823, Global test accuracy: 66.90
Round  41, Train loss: 1.491, Test loss: 1.530, Test accuracy: 95.08
Round  41, Global train loss: 1.491, Global test loss: 1.775, Global test accuracy: 70.96
Round  42, Train loss: 1.490, Test loss: 1.530, Test accuracy: 94.98
Round  42, Global train loss: 1.490, Global test loss: 1.766, Global test accuracy: 75.94
Round  43, Train loss: 1.507, Test loss: 1.526, Test accuracy: 95.14
Round  43, Global train loss: 1.507, Global test loss: 1.791, Global test accuracy: 73.56
Round  44, Train loss: 1.495, Test loss: 1.526, Test accuracy: 95.22
Round  44, Global train loss: 1.495, Global test loss: 1.816, Global test accuracy: 66.08
Round  45, Train loss: 1.493, Test loss: 1.528, Test accuracy: 95.04
Round  45, Global train loss: 1.493, Global test loss: 1.833, Global test accuracy: 65.48
Round  46, Train loss: 1.492, Test loss: 1.527, Test accuracy: 95.18
Round  46, Global train loss: 1.492, Global test loss: 1.736, Global test accuracy: 80.96
Round  47, Train loss: 1.503, Test loss: 1.522, Test accuracy: 95.56
Round  47, Global train loss: 1.503, Global test loss: 1.746, Global test accuracy: 75.42
Round  48, Train loss: 1.494, Test loss: 1.522, Test accuracy: 95.58
Round  48, Global train loss: 1.494, Global test loss: 1.804, Global test accuracy: 69.16
Round  49, Train loss: 1.490, Test loss: 1.523, Test accuracy: 95.42
Round  49, Global train loss: 1.490, Global test loss: 1.808, Global test accuracy: 67.22
Round  50, Train loss: 1.488, Test loss: 1.523, Test accuracy: 95.36
Round  50, Global train loss: 1.488, Global test loss: 1.898, Global test accuracy: 54.48
Round  51, Train loss: 1.488, Test loss: 1.520, Test accuracy: 95.68
Round  51, Global train loss: 1.488, Global test loss: 1.846, Global test accuracy: 65.18
Round  52, Train loss: 1.486, Test loss: 1.522, Test accuracy: 95.46
Round  52, Global train loss: 1.486, Global test loss: 1.890, Global test accuracy: 55.18
Round  53, Train loss: 1.484, Test loss: 1.520, Test accuracy: 95.64
Round  53, Global train loss: 1.484, Global test loss: 1.768, Global test accuracy: 72.66
Round  54, Train loss: 1.491, Test loss: 1.521, Test accuracy: 95.50
Round  54, Global train loss: 1.491, Global test loss: 1.762, Global test accuracy: 73.54
Round  55, Train loss: 1.481, Test loss: 1.521, Test accuracy: 95.46
Round  55, Global train loss: 1.481, Global test loss: 1.765, Global test accuracy: 73.40
Round  56, Train loss: 1.484, Test loss: 1.522, Test accuracy: 95.42
Round  56, Global train loss: 1.484, Global test loss: 1.776, Global test accuracy: 73.00
Round  57, Train loss: 1.480, Test loss: 1.522, Test accuracy: 95.40
Round  57, Global train loss: 1.480, Global test loss: 1.824, Global test accuracy: 64.04
Round  58, Train loss: 1.491, Test loss: 1.520, Test accuracy: 95.50
Round  58, Global train loss: 1.491, Global test loss: 1.773, Global test accuracy: 75.52
Round  59, Train loss: 1.479, Test loss: 1.519, Test accuracy: 95.58
Round  59, Global train loss: 1.479, Global test loss: 1.760, Global test accuracy: 76.70
Round  60, Train loss: 1.485, Test loss: 1.517, Test accuracy: 95.80
Round  60, Global train loss: 1.485, Global test loss: 1.734, Global test accuracy: 76.90
Round  61, Train loss: 1.480, Test loss: 1.519, Test accuracy: 95.66
Round  61, Global train loss: 1.480, Global test loss: 1.807, Global test accuracy: 67.20
Round  62, Train loss: 1.489, Test loss: 1.516, Test accuracy: 95.84
Round  62, Global train loss: 1.489, Global test loss: 1.755, Global test accuracy: 73.62
Round  63, Train loss: 1.476, Test loss: 1.518, Test accuracy: 95.74
Round  63, Global train loss: 1.476, Global test loss: 1.789, Global test accuracy: 70.06
Round  64, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.60
Round  64, Global train loss: 1.480, Global test loss: 1.894, Global test accuracy: 55.66
Round  65, Train loss: 1.477, Test loss: 1.520, Test accuracy: 95.44
Round  65, Global train loss: 1.477, Global test loss: 1.811, Global test accuracy: 69.88
Round  66, Train loss: 1.483, Test loss: 1.520, Test accuracy: 95.56
Round  66, Global train loss: 1.483, Global test loss: 1.819, Global test accuracy: 66.28
Round  67, Train loss: 1.480, Test loss: 1.519, Test accuracy: 95.48
Round  67, Global train loss: 1.480, Global test loss: 1.763, Global test accuracy: 74.56
Round  68, Train loss: 1.478, Test loss: 1.518, Test accuracy: 95.58
Round  68, Global train loss: 1.478, Global test loss: 1.816, Global test accuracy: 63.78
Round  69, Train loss: 1.483, Test loss: 1.515, Test accuracy: 95.82
Round  69, Global train loss: 1.483, Global test loss: 1.816, Global test accuracy: 64.86
Round  70, Train loss: 1.477, Test loss: 1.516, Test accuracy: 95.70
Round  70, Global train loss: 1.477, Global test loss: 1.816, Global test accuracy: 63.66
Round  71, Train loss: 1.480, Test loss: 1.517, Test accuracy: 95.68
Round  71, Global train loss: 1.480, Global test loss: 1.817, Global test accuracy: 66.32
Round  72, Train loss: 1.479, Test loss: 1.516, Test accuracy: 95.72
Round  72, Global train loss: 1.479, Global test loss: 1.794, Global test accuracy: 70.50
Round  73, Train loss: 1.480, Test loss: 1.515, Test accuracy: 95.90
Round  73, Global train loss: 1.480, Global test loss: 1.756, Global test accuracy: 75.42
Round  74, Train loss: 1.479, Test loss: 1.516, Test accuracy: 95.68
Round  74, Global train loss: 1.479, Global test loss: 1.785, Global test accuracy: 72.30
Round  75, Train loss: 1.482, Test loss: 1.514, Test accuracy: 95.70
Round  75, Global train loss: 1.482, Global test loss: 1.740, Global test accuracy: 75.58
Round  76, Train loss: 1.476, Test loss: 1.514, Test accuracy: 95.82
Round  76, Global train loss: 1.476, Global test loss: 1.795, Global test accuracy: 71.02
Round  77, Train loss: 1.480, Test loss: 1.514, Test accuracy: 95.78
Round  77, Global train loss: 1.480, Global test loss: 1.757, Global test accuracy: 74.26
Round  78, Train loss: 1.478, Test loss: 1.513, Test accuracy: 95.98
Round  78, Global train loss: 1.478, Global test loss: 1.722, Global test accuracy: 78.12
Round  79, Train loss: 1.476, Test loss: 1.513, Test accuracy: 95.84
Round  79, Global train loss: 1.476, Global test loss: 1.808, Global test accuracy: 67.38
Round  80, Train loss: 1.475, Test loss: 1.514, Test accuracy: 95.76
Round  80, Global train loss: 1.475, Global test loss: 1.864, Global test accuracy: 59.06
Round  81, Train loss: 1.477, Test loss: 1.514, Test accuracy: 95.90
Round  81, Global train loss: 1.477, Global test loss: 1.825, Global test accuracy: 64.26
Round  82, Train loss: 1.476, Test loss: 1.514, Test accuracy: 95.98
Round  82, Global train loss: 1.476, Global test loss: 1.884, Global test accuracy: 54.74
Round  83, Train loss: 1.477, Test loss: 1.513, Test accuracy: 95.96
Round  83, Global train loss: 1.477, Global test loss: 1.801, Global test accuracy: 69.40
Round  84, Train loss: 1.476, Test loss: 1.514, Test accuracy: 95.88
Round  84, Global train loss: 1.476, Global test loss: 1.782, Global test accuracy: 71.80
Round  85, Train loss: 1.473, Test loss: 1.515, Test accuracy: 95.80
Round  85, Global train loss: 1.473, Global test loss: 1.758, Global test accuracy: 77.18
Round  86, Train loss: 1.477, Test loss: 1.513, Test accuracy: 95.96
Round  86, Global train loss: 1.477, Global test loss: 1.740, Global test accuracy: 72.34
Round  87, Train loss: 1.473, Test loss: 1.514, Test accuracy: 95.78
Round  87, Global train loss: 1.473, Global test loss: 1.780, Global test accuracy: 71.74
Round  88, Train loss: 1.474, Test loss: 1.512, Test accuracy: 96.08
Round  88, Global train loss: 1.474, Global test loss: 1.756, Global test accuracy: 75.68
Round  89, Train loss: 1.474, Test loss: 1.513, Test accuracy: 96.00
Round  89, Global train loss: 1.474, Global test loss: 1.855, Global test accuracy: 60.42
Round  90, Train loss: 1.473, Test loss: 1.514, Test accuracy: 95.84
Round  90, Global train loss: 1.473, Global test loss: 1.762, Global test accuracy: 74.90
Round  91, Train loss: 1.476, Test loss: 1.515, Test accuracy: 95.84
Round  91, Global train loss: 1.476, Global test loss: 1.865, Global test accuracy: 59.68
Round  92, Train loss: 1.475, Test loss: 1.511, Test accuracy: 96.02
Round  92, Global train loss: 1.475, Global test loss: 1.771, Global test accuracy: 71.66/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 1.471, Test loss: 1.511, Test accuracy: 96.16
Round  93, Global train loss: 1.471, Global test loss: 1.789, Global test accuracy: 67.16
Round  94, Train loss: 1.475, Test loss: 1.512, Test accuracy: 96.08
Round  94, Global train loss: 1.475, Global test loss: 1.819, Global test accuracy: 66.42
Round  95, Train loss: 1.475, Test loss: 1.512, Test accuracy: 96.10
Round  95, Global train loss: 1.475, Global test loss: 1.726, Global test accuracy: 77.98
Round  96, Train loss: 1.473, Test loss: 1.514, Test accuracy: 95.84
Round  96, Global train loss: 1.473, Global test loss: 1.778, Global test accuracy: 69.40
Round  97, Train loss: 1.475, Test loss: 1.512, Test accuracy: 96.06
Round  97, Global train loss: 1.475, Global test loss: 1.773, Global test accuracy: 75.60
Round  98, Train loss: 1.473, Test loss: 1.512, Test accuracy: 95.96
Round  98, Global train loss: 1.473, Global test loss: 1.903, Global test accuracy: 54.36
Round  99, Train loss: 1.473, Test loss: 1.511, Test accuracy: 96.04
Round  99, Global train loss: 1.473, Global test loss: 1.876, Global test accuracy: 57.86
Final Round, Train loss: 1.469, Test loss: 1.511, Test accuracy: 96.00
Final Round, Global train loss: 1.469, Global test loss: 1.876, Global test accuracy: 57.86
Average accuracy final 10 rounds: 95.994
713.2433559894562
[1.512683391571045, 2.734834909439087, 4.250230550765991, 5.571442365646362, 6.955472707748413, 8.547314167022705, 9.777450323104858, 11.146174192428589, 12.445757389068604, 13.629198789596558, 14.880697965621948, 16.09886145591736, 17.37585973739624, 18.655688524246216, 19.9070565700531, 21.14702820777893, 22.431499481201172, 23.747036933898926, 25.15113091468811, 26.42338228225708, 27.7313871383667, 29.29994773864746, 31.231322765350342, 32.611125230789185, 33.91566467285156, 35.25679588317871, 36.619425773620605, 37.85857391357422, 39.28590726852417, 40.654091358184814, 41.936477184295654, 43.26775360107422, 44.52520823478699, 45.82365822792053, 47.11377549171448, 48.38153600692749, 49.6434371471405, 50.88665795326233, 52.25005340576172, 53.50943064689636, 54.75574851036072, 56.02796220779419, 57.290871381759644, 58.607855558395386, 59.923436880111694, 61.08049535751343, 62.297531604766846, 63.53519678115845, 64.77137923240662, 66.00747156143188, 67.26079511642456, 68.5704038143158, 69.82632422447205, 71.21193170547485, 72.50658869743347, 73.87136006355286, 75.17500686645508, 76.46596479415894, 77.77254033088684, 78.94507813453674, 80.20951318740845, 81.53265285491943, 83.10674381256104, 84.79830121994019, 86.78284692764282, 88.04025554656982, 89.38343048095703, 90.82691621780396, 92.18574619293213, 93.53709983825684, 94.79348611831665, 95.97069597244263, 97.25104451179504, 98.5346565246582, 99.9993371963501, 101.52926468849182, 102.87549448013306, 104.34470772743225, 105.74142289161682, 107.02429056167603, 108.41491770744324, 109.71788740158081, 110.99852323532104, 112.30888533592224, 113.67191648483276, 115.00448369979858, 116.2333345413208, 117.44588303565979, 118.77484917640686, 120.13516783714294, 121.44005417823792, 122.76405739784241, 124.07720041275024, 125.41902279853821, 126.74713587760925, 128.11308240890503, 129.3551197052002, 130.69788646697998, 131.97188544273376, 133.31599926948547, 135.44155597686768]
[25.92, 28.42, 30.0, 35.9, 49.74, 54.86, 59.52, 65.68, 71.46, 78.38, 79.36, 83.9, 84.24, 91.1, 91.82, 92.1, 92.12, 91.94, 92.08, 92.52, 92.76, 92.78, 92.78, 92.84, 92.74, 92.6, 93.86, 94.56, 94.6, 94.88, 94.84, 94.94, 95.12, 94.86, 94.82, 94.64, 95.08, 94.88, 94.78, 94.58, 94.84, 95.08, 94.98, 95.14, 95.22, 95.04, 95.18, 95.56, 95.58, 95.42, 95.36, 95.68, 95.46, 95.64, 95.5, 95.46, 95.42, 95.4, 95.5, 95.58, 95.8, 95.66, 95.84, 95.74, 95.6, 95.44, 95.56, 95.48, 95.58, 95.82, 95.7, 95.68, 95.72, 95.9, 95.68, 95.7, 95.82, 95.78, 95.98, 95.84, 95.76, 95.9, 95.98, 95.96, 95.88, 95.8, 95.96, 95.78, 96.08, 96.0, 95.84, 95.84, 96.02, 96.16, 96.08, 96.1, 95.84, 96.06, 95.96, 96.04, 96.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.318, Test loss: 2.298, Test accuracy: 22.02
Round   0, Global train loss: 2.318, Global test loss: 2.300, Global test accuracy: 14.54
Round   1, Train loss: 2.290, Test loss: 2.288, Test accuracy: 39.20
Round   1, Global train loss: 2.290, Global test loss: 2.295, Global test accuracy: 38.56
Round   2, Train loss: 2.269, Test loss: 2.258, Test accuracy: 51.68
Round   2, Global train loss: 2.269, Global test loss: 2.278, Global test accuracy: 39.10
Round   3, Train loss: 2.187, Test loss: 2.112, Test accuracy: 49.08
Round   3, Global train loss: 2.187, Global test loss: 2.180, Global test accuracy: 36.84
Round   4, Train loss: 1.995, Test loss: 1.935, Test accuracy: 58.00
Round   4, Global train loss: 1.995, Global test loss: 2.056, Global test accuracy: 43.54
Round   5, Train loss: 1.847, Test loss: 1.812, Test accuracy: 71.24
Round   5, Global train loss: 1.847, Global test loss: 1.989, Global test accuracy: 55.26
Round   6, Train loss: 1.746, Test loss: 1.727, Test accuracy: 79.82
Round   6, Global train loss: 1.746, Global test loss: 1.937, Global test accuracy: 68.20
Round   7, Train loss: 1.677, Test loss: 1.668, Test accuracy: 86.00
Round   7, Global train loss: 1.677, Global test loss: 1.891, Global test accuracy: 70.50
Round   8, Train loss: 1.635, Test loss: 1.632, Test accuracy: 89.18
Round   8, Global train loss: 1.635, Global test loss: 1.856, Global test accuracy: 72.56
Round   9, Train loss: 1.607, Test loss: 1.608, Test accuracy: 90.36
Round   9, Global train loss: 1.607, Global test loss: 1.830, Global test accuracy: 74.42
Round  10, Train loss: 1.568, Test loss: 1.594, Test accuracy: 92.16
Round  10, Global train loss: 1.568, Global test loss: 1.962, Global test accuracy: 57.34
Round  11, Train loss: 1.536, Test loss: 1.587, Test accuracy: 92.42
Round  11, Global train loss: 1.536, Global test loss: 1.892, Global test accuracy: 56.94
Round  12, Train loss: 1.541, Test loss: 1.582, Test accuracy: 92.32
Round  12, Global train loss: 1.541, Global test loss: 1.901, Global test accuracy: 58.44
Round  13, Train loss: 1.553, Test loss: 1.572, Test accuracy: 92.90
Round  13, Global train loss: 1.553, Global test loss: 1.856, Global test accuracy: 64.72
Round  14, Train loss: 1.557, Test loss: 1.567, Test accuracy: 92.94
Round  14, Global train loss: 1.557, Global test loss: 1.933, Global test accuracy: 51.72
Round  15, Train loss: 1.537, Test loss: 1.560, Test accuracy: 93.56
Round  15, Global train loss: 1.537, Global test loss: 1.838, Global test accuracy: 65.88
Round  16, Train loss: 1.529, Test loss: 1.556, Test accuracy: 93.80
Round  16, Global train loss: 1.529, Global test loss: 1.889, Global test accuracy: 58.50
Round  17, Train loss: 1.514, Test loss: 1.554, Test accuracy: 93.80
Round  17, Global train loss: 1.514, Global test loss: 1.883, Global test accuracy: 59.12
Round  18, Train loss: 1.515, Test loss: 1.552, Test accuracy: 93.76
Round  18, Global train loss: 1.515, Global test loss: 1.833, Global test accuracy: 65.76
Round  19, Train loss: 1.512, Test loss: 1.552, Test accuracy: 93.86
Round  19, Global train loss: 1.512, Global test loss: 1.848, Global test accuracy: 61.64
Round  20, Train loss: 1.524, Test loss: 1.549, Test accuracy: 93.76
Round  20, Global train loss: 1.524, Global test loss: 1.934, Global test accuracy: 51.18
Round  21, Train loss: 1.505, Test loss: 1.547, Test accuracy: 93.90
Round  21, Global train loss: 1.505, Global test loss: 1.799, Global test accuracy: 68.60
Round  22, Train loss: 1.508, Test loss: 1.548, Test accuracy: 93.96
Round  22, Global train loss: 1.508, Global test loss: 1.859, Global test accuracy: 62.06
Round  23, Train loss: 1.513, Test loss: 1.548, Test accuracy: 93.92
Round  23, Global train loss: 1.513, Global test loss: 1.917, Global test accuracy: 53.34
Round  24, Train loss: 1.507, Test loss: 1.548, Test accuracy: 94.06
Round  24, Global train loss: 1.507, Global test loss: 1.912, Global test accuracy: 55.96
Round  25, Train loss: 1.524, Test loss: 1.541, Test accuracy: 94.48
Round  25, Global train loss: 1.524, Global test loss: 1.821, Global test accuracy: 65.58
Round  26, Train loss: 1.507, Test loss: 1.539, Test accuracy: 94.66
Round  26, Global train loss: 1.507, Global test loss: 1.830, Global test accuracy: 67.54
Round  27, Train loss: 1.495, Test loss: 1.538, Test accuracy: 94.44
Round  27, Global train loss: 1.495, Global test loss: 1.882, Global test accuracy: 59.14
Round  28, Train loss: 1.501, Test loss: 1.536, Test accuracy: 94.54
Round  28, Global train loss: 1.501, Global test loss: 1.867, Global test accuracy: 59.30
Round  29, Train loss: 1.494, Test loss: 1.536, Test accuracy: 94.56
Round  29, Global train loss: 1.494, Global test loss: 1.803, Global test accuracy: 67.54
Round  30, Train loss: 1.503, Test loss: 1.534, Test accuracy: 94.92
Round  30, Global train loss: 1.503, Global test loss: 1.879, Global test accuracy: 60.66
Round  31, Train loss: 1.509, Test loss: 1.531, Test accuracy: 94.88
Round  31, Global train loss: 1.509, Global test loss: 1.776, Global test accuracy: 71.32
Round  32, Train loss: 1.508, Test loss: 1.533, Test accuracy: 94.80
Round  32, Global train loss: 1.508, Global test loss: 1.806, Global test accuracy: 69.36
Round  33, Train loss: 1.500, Test loss: 1.531, Test accuracy: 94.84
Round  33, Global train loss: 1.500, Global test loss: 1.820, Global test accuracy: 67.76
Round  34, Train loss: 1.495, Test loss: 1.531, Test accuracy: 94.80
Round  34, Global train loss: 1.495, Global test loss: 1.846, Global test accuracy: 62.36
Round  35, Train loss: 1.499, Test loss: 1.528, Test accuracy: 94.96
Round  35, Global train loss: 1.499, Global test loss: 1.798, Global test accuracy: 73.20
Round  36, Train loss: 1.498, Test loss: 1.529, Test accuracy: 94.98
Round  36, Global train loss: 1.498, Global test loss: 1.819, Global test accuracy: 67.86
Round  37, Train loss: 1.495, Test loss: 1.529, Test accuracy: 95.12
Round  37, Global train loss: 1.495, Global test loss: 1.864, Global test accuracy: 63.66
Round  38, Train loss: 1.501, Test loss: 1.528, Test accuracy: 94.96
Round  38, Global train loss: 1.501, Global test loss: 1.851, Global test accuracy: 59.58
Round  39, Train loss: 1.490, Test loss: 1.529, Test accuracy: 94.98
Round  39, Global train loss: 1.490, Global test loss: 1.838, Global test accuracy: 64.62
Round  40, Train loss: 1.496, Test loss: 1.526, Test accuracy: 95.14
Round  40, Global train loss: 1.496, Global test loss: 1.797, Global test accuracy: 69.12
Round  41, Train loss: 1.493, Test loss: 1.526, Test accuracy: 95.10
Round  41, Global train loss: 1.493, Global test loss: 1.793, Global test accuracy: 68.78
Round  42, Train loss: 1.489, Test loss: 1.525, Test accuracy: 95.18
Round  42, Global train loss: 1.489, Global test loss: 1.786, Global test accuracy: 72.84
Round  43, Train loss: 1.489, Test loss: 1.525, Test accuracy: 95.16
Round  43, Global train loss: 1.489, Global test loss: 1.810, Global test accuracy: 67.74
Round  44, Train loss: 1.494, Test loss: 1.525, Test accuracy: 95.12
Round  44, Global train loss: 1.494, Global test loss: 1.800, Global test accuracy: 69.74
Round  45, Train loss: 1.488, Test loss: 1.524, Test accuracy: 95.14
Round  45, Global train loss: 1.488, Global test loss: 1.843, Global test accuracy: 66.86
Round  46, Train loss: 1.488, Test loss: 1.523, Test accuracy: 95.32
Round  46, Global train loss: 1.488, Global test loss: 1.842, Global test accuracy: 62.04
Round  47, Train loss: 1.486, Test loss: 1.523, Test accuracy: 95.30
Round  47, Global train loss: 1.486, Global test loss: 1.815, Global test accuracy: 67.26
Round  48, Train loss: 1.489, Test loss: 1.521, Test accuracy: 95.40
Round  48, Global train loss: 1.489, Global test loss: 1.866, Global test accuracy: 59.70
Round  49, Train loss: 1.486, Test loss: 1.521, Test accuracy: 95.46
Round  49, Global train loss: 1.486, Global test loss: 1.833, Global test accuracy: 63.70
Round  50, Train loss: 1.486, Test loss: 1.521, Test accuracy: 95.44
Round  50, Global train loss: 1.486, Global test loss: 1.737, Global test accuracy: 78.58
Round  51, Train loss: 1.483, Test loss: 1.520, Test accuracy: 95.50
Round  51, Global train loss: 1.483, Global test loss: 1.805, Global test accuracy: 68.08
Round  52, Train loss: 1.483, Test loss: 1.521, Test accuracy: 95.26
Round  52, Global train loss: 1.483, Global test loss: 1.831, Global test accuracy: 67.64
Round  53, Train loss: 1.481, Test loss: 1.519, Test accuracy: 95.56
Round  53, Global train loss: 1.481, Global test loss: 1.802, Global test accuracy: 66.40
Round  54, Train loss: 1.483, Test loss: 1.520, Test accuracy: 95.64
Round  54, Global train loss: 1.483, Global test loss: 1.809, Global test accuracy: 68.00
Round  55, Train loss: 1.481, Test loss: 1.520, Test accuracy: 95.62
Round  55, Global train loss: 1.481, Global test loss: 1.810, Global test accuracy: 68.38
Round  56, Train loss: 1.481, Test loss: 1.521, Test accuracy: 95.56
Round  56, Global train loss: 1.481, Global test loss: 1.859, Global test accuracy: 63.86
Round  57, Train loss: 1.478, Test loss: 1.520, Test accuracy: 95.46
Round  57, Global train loss: 1.478, Global test loss: 1.791, Global test accuracy: 69.22
Round  58, Train loss: 1.487, Test loss: 1.519, Test accuracy: 95.42
Round  58, Global train loss: 1.487, Global test loss: 1.880, Global test accuracy: 55.50
Round  59, Train loss: 1.481, Test loss: 1.518, Test accuracy: 95.56
Round  59, Global train loss: 1.481, Global test loss: 1.836, Global test accuracy: 64.82
Round  60, Train loss: 1.485, Test loss: 1.520, Test accuracy: 95.36
Round  60, Global train loss: 1.485, Global test loss: 1.852, Global test accuracy: 60.82
Round  61, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.66
Round  61, Global train loss: 1.480, Global test loss: 1.840, Global test accuracy: 62.94
Round  62, Train loss: 1.478, Test loss: 1.519, Test accuracy: 95.60
Round  62, Global train loss: 1.478, Global test loss: 1.828, Global test accuracy: 65.70
Round  63, Train loss: 1.478, Test loss: 1.518, Test accuracy: 95.70
Round  63, Global train loss: 1.478, Global test loss: 1.878, Global test accuracy: 58.54
Round  64, Train loss: 1.480, Test loss: 1.519, Test accuracy: 95.38
Round  64, Global train loss: 1.480, Global test loss: 1.889, Global test accuracy: 57.00
Round  65, Train loss: 1.481, Test loss: 1.518, Test accuracy: 95.46
Round  65, Global train loss: 1.481, Global test loss: 1.870, Global test accuracy: 60.60
Round  66, Train loss: 1.483, Test loss: 1.519, Test accuracy: 95.52
Round  66, Global train loss: 1.483, Global test loss: 1.882, Global test accuracy: 58.02
Round  67, Train loss: 1.481, Test loss: 1.517, Test accuracy: 95.56
Round  67, Global train loss: 1.481, Global test loss: 1.807, Global test accuracy: 72.18
Round  68, Train loss: 1.478, Test loss: 1.517, Test accuracy: 95.66
Round  68, Global train loss: 1.478, Global test loss: 1.811, Global test accuracy: 67.74
Round  69, Train loss: 1.478, Test loss: 1.517, Test accuracy: 95.52
Round  69, Global train loss: 1.478, Global test loss: 1.732, Global test accuracy: 78.32
Round  70, Train loss: 1.478, Test loss: 1.516, Test accuracy: 95.62
Round  70, Global train loss: 1.478, Global test loss: 1.771, Global test accuracy: 70.40
Round  71, Train loss: 1.476, Test loss: 1.517, Test accuracy: 95.60
Round  71, Global train loss: 1.476, Global test loss: 1.817, Global test accuracy: 66.68
Round  72, Train loss: 1.479, Test loss: 1.518, Test accuracy: 95.46
Round  72, Global train loss: 1.479, Global test loss: 1.835, Global test accuracy: 66.60
Round  73, Train loss: 1.476, Test loss: 1.518, Test accuracy: 95.58
Round  73, Global train loss: 1.476, Global test loss: 1.864, Global test accuracy: 61.56
Round  74, Train loss: 1.476, Test loss: 1.517, Test accuracy: 95.62
Round  74, Global train loss: 1.476, Global test loss: 1.830, Global test accuracy: 68.82
Round  75, Train loss: 1.478, Test loss: 1.517, Test accuracy: 95.54
Round  75, Global train loss: 1.478, Global test loss: 1.768, Global test accuracy: 76.00
Round  76, Train loss: 1.480, Test loss: 1.514, Test accuracy: 95.74
Round  76, Global train loss: 1.480, Global test loss: 1.761, Global test accuracy: 72.30
Round  77, Train loss: 1.476, Test loss: 1.515, Test accuracy: 95.70
Round  77, Global train loss: 1.476, Global test loss: 1.792, Global test accuracy: 69.56
Round  78, Train loss: 1.476, Test loss: 1.516, Test accuracy: 95.60
Round  78, Global train loss: 1.476, Global test loss: 1.888, Global test accuracy: 57.20
Round  79, Train loss: 1.478, Test loss: 1.517, Test accuracy: 95.52
Round  79, Global train loss: 1.478, Global test loss: 1.823, Global test accuracy: 68.92
Round  80, Train loss: 1.476, Test loss: 1.514, Test accuracy: 95.70
Round  80, Global train loss: 1.476, Global test loss: 1.704, Global test accuracy: 85.46
Round  81, Train loss: 1.475, Test loss: 1.514, Test accuracy: 95.72
Round  81, Global train loss: 1.475, Global test loss: 1.702, Global test accuracy: 85.66
Round  82, Train loss: 1.475, Test loss: 1.513, Test accuracy: 95.70
Round  82, Global train loss: 1.475, Global test loss: 1.701, Global test accuracy: 85.64
Round  83, Train loss: 1.474, Test loss: 1.513, Test accuracy: 95.70
Round  83, Global train loss: 1.474, Global test loss: 1.700, Global test accuracy: 85.80
Round  84, Train loss: 1.474, Test loss: 1.513, Test accuracy: 95.74
Round  84, Global train loss: 1.474, Global test loss: 1.699, Global test accuracy: 85.82
Round  85, Train loss: 1.474, Test loss: 1.513, Test accuracy: 95.72
Round  85, Global train loss: 1.474, Global test loss: 1.699, Global test accuracy: 85.92
Round  86, Train loss: 1.473, Test loss: 1.513, Test accuracy: 95.80
Round  86, Global train loss: 1.473, Global test loss: 1.698, Global test accuracy: 85.90
Round  87, Train loss: 1.473, Test loss: 1.512, Test accuracy: 95.78
Round  87, Global train loss: 1.473, Global test loss: 1.699, Global test accuracy: 85.72
Round  88, Train loss: 1.473, Test loss: 1.512, Test accuracy: 95.82
Round  88, Global train loss: 1.473, Global test loss: 1.698, Global test accuracy: 85.78
Round  89, Train loss: 1.472, Test loss: 1.512, Test accuracy: 95.86
Round  89, Global train loss: 1.472, Global test loss: 1.697, Global test accuracy: 86.12
Round  90, Train loss: 1.472, Test loss: 1.512, Test accuracy: 95.90
Round  90, Global train loss: 1.472, Global test loss: 1.697, Global test accuracy: 85.90
Round  91, Train loss: 1.472, Test loss: 1.512, Test accuracy: 95.86
Round  91, Global train loss: 1.472, Global test loss: 1.697, Global test accuracy: 86.02
Round  92, Train loss: 1.472, Test loss: 1.512, Test accuracy: 95.92
Round  92, Global train loss: 1.472, Global test loss: 1.696, Global test accuracy: 86.08/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 1.472, Test loss: 1.512, Test accuracy: 95.88
Round  93, Global train loss: 1.472, Global test loss: 1.696, Global test accuracy: 86.26
Round  94, Train loss: 1.471, Test loss: 1.512, Test accuracy: 95.92
Round  94, Global train loss: 1.471, Global test loss: 1.696, Global test accuracy: 86.16
Round  95, Train loss: 1.471, Test loss: 1.512, Test accuracy: 95.92
Round  95, Global train loss: 1.471, Global test loss: 1.696, Global test accuracy: 86.24
Round  96, Train loss: 1.471, Test loss: 1.511, Test accuracy: 95.94
Round  96, Global train loss: 1.471, Global test loss: 1.696, Global test accuracy: 86.34
Round  97, Train loss: 1.471, Test loss: 1.511, Test accuracy: 95.92
Round  97, Global train loss: 1.471, Global test loss: 1.696, Global test accuracy: 86.32
Round  98, Train loss: 1.471, Test loss: 1.511, Test accuracy: 95.92
Round  98, Global train loss: 1.471, Global test loss: 1.696, Global test accuracy: 86.44
Round  99, Train loss: 1.471, Test loss: 1.511, Test accuracy: 96.00
Round  99, Global train loss: 1.471, Global test loss: 1.675, Global test accuracy: 86.28
Final Round, Train loss: 1.469, Test loss: 1.510, Test accuracy: 95.96
Final Round, Global train loss: 1.469, Global test loss: 1.675, Global test accuracy: 86.28
Average accuracy final 10 rounds: 95.91799999999999
1413.0354354381561
[1.574991226196289, 3.046281576156616, 4.540193319320679, 6.229527711868286, 7.679267406463623, 9.17046570777893, 10.5523362159729, 12.073396444320679, 13.585567712783813, 15.06457233428955, 20.00824284553528, 28.269065856933594, 36.254236698150635, 37.69790196418762, 39.08405065536499, 47.29124045372009, 55.85779571533203, 64.77719640731812, 73.34973335266113, 82.08109641075134, 83.56224870681763, 95.22855234146118, 104.27843356132507, 105.75108742713928, 114.02855086326599, 115.521644115448, 124.0327730178833, 132.8432493209839, 141.7511909008026, 150.18031430244446, 159.03475403785706, 160.51281118392944, 162.3315441608429, 163.94447803497314, 165.59398555755615, 174.06882691383362, 183.13671970367432, 191.71729183197021, 193.2902753353119, 201.75945115089417, 203.28404307365417, 204.9214792251587, 213.42364072799683, 221.72077250480652, 223.20160937309265, 231.92913126945496, 233.4163064956665, 235.0624349117279, 236.7107434272766, 245.39388465881348, 253.8680739402771, 262.49890995025635, 271.11289525032043, 280.0331332683563, 288.665518283844, 297.216468334198, 305.88896560668945, 314.2967059612274, 315.7180025577545, 317.21403074264526, 325.96116375923157, 327.4583089351654, 328.810889005661, 337.4567856788635, 345.8508229255676, 354.51820731163025, 363.1715648174286, 364.84908986091614, 373.5327227115631, 382.2008740901947, 383.62075185775757, 392.2760851383209, 393.7163498401642, 402.55691599845886, 411.2735733985901, 412.7781729698181, 414.2964816093445, 415.7177002429962, 424.53771591186523, 426.2835097312927, 427.8275935649872, 429.43437027931213, 430.9022226333618, 432.39449548721313, 433.9562976360321, 435.5051898956299, 437.0574314594269, 438.52013874053955, 441.1210505962372, 442.4523046016693, 443.96525287628174, 445.43407344818115, 446.98613691329956, 448.5137155056, 450.02050137519836, 451.5330100059509, 452.9807815551758, 454.51196694374084, 455.95823645591736, 464.4532437324524, 472.3385920524597]
[22.02, 39.2, 51.68, 49.08, 58.0, 71.24, 79.82, 86.0, 89.18, 90.36, 92.16, 92.42, 92.32, 92.9, 92.94, 93.56, 93.8, 93.8, 93.76, 93.86, 93.76, 93.9, 93.96, 93.92, 94.06, 94.48, 94.66, 94.44, 94.54, 94.56, 94.92, 94.88, 94.8, 94.84, 94.8, 94.96, 94.98, 95.12, 94.96, 94.98, 95.14, 95.1, 95.18, 95.16, 95.12, 95.14, 95.32, 95.3, 95.4, 95.46, 95.44, 95.5, 95.26, 95.56, 95.64, 95.62, 95.56, 95.46, 95.42, 95.56, 95.36, 95.66, 95.6, 95.7, 95.38, 95.46, 95.52, 95.56, 95.66, 95.52, 95.62, 95.6, 95.46, 95.58, 95.62, 95.54, 95.74, 95.7, 95.6, 95.52, 95.7, 95.72, 95.7, 95.7, 95.74, 95.72, 95.8, 95.78, 95.82, 95.86, 95.9, 95.86, 95.92, 95.88, 95.92, 95.92, 95.94, 95.92, 95.92, 96.0, 95.96]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.292, Test loss: 2.289, Test accuracy: 33.94
Round   0, Global train loss: 2.292, Global test loss: 2.296, Global test accuracy: 36.92
Round   1, Train loss: 2.238, Test loss: 2.196, Test accuracy: 30.54
Round   1, Global train loss: 2.238, Global test loss: 2.214, Global test accuracy: 29.74
Round   2, Train loss: 1.947, Test loss: 2.046, Test accuracy: 46.40
Round   2, Global train loss: 1.947, Global test loss: 2.079, Global test accuracy: 39.18
Round   3, Train loss: 2.112, Test loss: 1.997, Test accuracy: 53.70
Round   3, Global train loss: 2.112, Global test loss: 2.167, Global test accuracy: 30.32
Round   4, Train loss: 1.814, Test loss: 1.898, Test accuracy: 62.80
Round   4, Global train loss: 1.814, Global test loss: 2.029, Global test accuracy: 44.34
Round   5, Train loss: 1.946, Test loss: 1.822, Test accuracy: 69.42
Round   5, Global train loss: 1.946, Global test loss: 2.030, Global test accuracy: 52.84
Round   6, Train loss: 1.778, Test loss: 1.755, Test accuracy: 74.94
Round   6, Global train loss: 1.778, Global test loss: 2.062, Global test accuracy: 38.18
Round   7, Train loss: 1.760, Test loss: 1.697, Test accuracy: 80.68
Round   7, Global train loss: 1.760, Global test loss: 2.061, Global test accuracy: 43.50
Round   8, Train loss: 1.592, Test loss: 1.690, Test accuracy: 80.98
Round   8, Global train loss: 1.592, Global test loss: 2.088, Global test accuracy: 37.84
Round   9, Train loss: 1.595, Test loss: 1.649, Test accuracy: 84.36
Round   9, Global train loss: 1.595, Global test loss: 2.047, Global test accuracy: 40.92
Round  10, Train loss: 1.670, Test loss: 1.635, Test accuracy: 84.82
Round  10, Global train loss: 1.670, Global test loss: 2.126, Global test accuracy: 32.70
Round  11, Train loss: 1.550, Test loss: 1.621, Test accuracy: 86.32
Round  11, Global train loss: 1.550, Global test loss: 2.060, Global test accuracy: 39.74
Round  12, Train loss: 1.572, Test loss: 1.613, Test accuracy: 86.66
Round  12, Global train loss: 1.572, Global test loss: 2.041, Global test accuracy: 41.50
Round  13, Train loss: 1.708, Test loss: 1.598, Test accuracy: 88.38
Round  13, Global train loss: 1.708, Global test loss: 2.003, Global test accuracy: 45.32
Round  14, Train loss: 1.608, Test loss: 1.594, Test accuracy: 88.36
Round  14, Global train loss: 1.608, Global test loss: 1.975, Global test accuracy: 51.36
Round  15, Train loss: 1.507, Test loss: 1.593, Test accuracy: 88.34
Round  15, Global train loss: 1.507, Global test loss: 2.115, Global test accuracy: 33.68
Round  16, Train loss: 1.505, Test loss: 1.591, Test accuracy: 88.44
Round  16, Global train loss: 1.505, Global test loss: 2.001, Global test accuracy: 46.16
Round  17, Train loss: 1.582, Test loss: 1.591, Test accuracy: 88.38
Round  17, Global train loss: 1.582, Global test loss: 1.999, Global test accuracy: 49.52
Round  18, Train loss: 1.479, Test loss: 1.591, Test accuracy: 88.40
Round  18, Global train loss: 1.479, Global test loss: 2.026, Global test accuracy: 42.76
Round  19, Train loss: 1.592, Test loss: 1.590, Test accuracy: 88.52
Round  19, Global train loss: 1.592, Global test loss: 1.969, Global test accuracy: 48.62
Round  20, Train loss: 1.595, Test loss: 1.590, Test accuracy: 88.24
Round  20, Global train loss: 1.595, Global test loss: 1.996, Global test accuracy: 46.24
Round  21, Train loss: 1.472, Test loss: 1.590, Test accuracy: 88.20
Round  21, Global train loss: 1.472, Global test loss: 2.097, Global test accuracy: 34.48
Round  22, Train loss: 1.542, Test loss: 1.590, Test accuracy: 88.18
Round  22, Global train loss: 1.542, Global test loss: 2.040, Global test accuracy: 42.30
Round  23, Train loss: 1.482, Test loss: 1.589, Test accuracy: 88.32
Round  23, Global train loss: 1.482, Global test loss: 1.947, Global test accuracy: 52.60
Round  24, Train loss: 1.620, Test loss: 1.587, Test accuracy: 88.26
Round  24, Global train loss: 1.620, Global test loss: 1.985, Global test accuracy: 51.64
Round  25, Train loss: 1.549, Test loss: 1.586, Test accuracy: 88.22
Round  25, Global train loss: 1.549, Global test loss: 2.041, Global test accuracy: 41.74
Round  26, Train loss: 1.478, Test loss: 1.586, Test accuracy: 88.20
Round  26, Global train loss: 1.478, Global test loss: 2.042, Global test accuracy: 43.82
Round  27, Train loss: 1.497, Test loss: 1.586, Test accuracy: 88.22
Round  27, Global train loss: 1.497, Global test loss: 1.931, Global test accuracy: 56.18
Round  28, Train loss: 1.541, Test loss: 1.586, Test accuracy: 88.26
Round  28, Global train loss: 1.541, Global test loss: 2.001, Global test accuracy: 42.92
Round  29, Train loss: 1.476, Test loss: 1.585, Test accuracy: 88.28
Round  29, Global train loss: 1.476, Global test loss: 2.032, Global test accuracy: 45.72
Round  30, Train loss: 1.541, Test loss: 1.585, Test accuracy: 88.26
Round  30, Global train loss: 1.541, Global test loss: 2.079, Global test accuracy: 37.72
Round  31, Train loss: 1.537, Test loss: 1.585, Test accuracy: 88.28
Round  31, Global train loss: 1.537, Global test loss: 2.035, Global test accuracy: 43.76
Round  32, Train loss: 1.472, Test loss: 1.585, Test accuracy: 88.36
Round  32, Global train loss: 1.472, Global test loss: 1.984, Global test accuracy: 49.12
Round  33, Train loss: 1.476, Test loss: 1.585, Test accuracy: 88.22
Round  33, Global train loss: 1.476, Global test loss: 2.137, Global test accuracy: 31.44
Round  34, Train loss: 1.469, Test loss: 1.584, Test accuracy: 88.26
Round  34, Global train loss: 1.469, Global test loss: 2.035, Global test accuracy: 42.68
Round  35, Train loss: 1.488, Test loss: 1.585, Test accuracy: 88.24
Round  35, Global train loss: 1.488, Global test loss: 2.013, Global test accuracy: 44.54
Round  36, Train loss: 1.627, Test loss: 1.584, Test accuracy: 88.24
Round  36, Global train loss: 1.627, Global test loss: 2.102, Global test accuracy: 35.54
Round  37, Train loss: 1.488, Test loss: 1.584, Test accuracy: 88.26
Round  37, Global train loss: 1.488, Global test loss: 2.014, Global test accuracy: 44.46
Round  38, Train loss: 1.486, Test loss: 1.584, Test accuracy: 88.26
Round  38, Global train loss: 1.486, Global test loss: 2.056, Global test accuracy: 40.74
Round  39, Train loss: 1.604, Test loss: 1.584, Test accuracy: 88.20
Round  39, Global train loss: 1.604, Global test loss: 1.957, Global test accuracy: 49.60
Round  40, Train loss: 1.488, Test loss: 1.584, Test accuracy: 88.18
Round  40, Global train loss: 1.488, Global test loss: 2.030, Global test accuracy: 42.12
Round  41, Train loss: 1.604, Test loss: 1.569, Test accuracy: 89.94
Round  41, Global train loss: 1.604, Global test loss: 1.979, Global test accuracy: 47.58
Round  42, Train loss: 1.708, Test loss: 1.569, Test accuracy: 89.90
Round  42, Global train loss: 1.708, Global test loss: 2.019, Global test accuracy: 44.28
Round  43, Train loss: 1.579, Test loss: 1.569, Test accuracy: 89.80
Round  43, Global train loss: 1.579, Global test loss: 1.970, Global test accuracy: 48.50
Round  44, Train loss: 1.475, Test loss: 1.568, Test accuracy: 89.82
Round  44, Global train loss: 1.475, Global test loss: 2.093, Global test accuracy: 35.34
Round  45, Train loss: 1.616, Test loss: 1.568, Test accuracy: 89.84
Round  45, Global train loss: 1.616, Global test loss: 1.952, Global test accuracy: 51.34
Round  46, Train loss: 1.479, Test loss: 1.567, Test accuracy: 89.90
Round  46, Global train loss: 1.479, Global test loss: 2.025, Global test accuracy: 43.42
Round  47, Train loss: 1.476, Test loss: 1.567, Test accuracy: 89.86
Round  47, Global train loss: 1.476, Global test loss: 2.048, Global test accuracy: 40.74
Round  48, Train loss: 1.564, Test loss: 1.568, Test accuracy: 89.78
Round  48, Global train loss: 1.564, Global test loss: 1.972, Global test accuracy: 47.84
Round  49, Train loss: 1.469, Test loss: 1.568, Test accuracy: 89.78
Round  49, Global train loss: 1.469, Global test loss: 2.043, Global test accuracy: 41.52
Round  50, Train loss: 1.471, Test loss: 1.568, Test accuracy: 89.78
Round  50, Global train loss: 1.471, Global test loss: 1.937, Global test accuracy: 52.76
Round  51, Train loss: 1.575, Test loss: 1.567, Test accuracy: 89.82
Round  51, Global train loss: 1.575, Global test loss: 2.074, Global test accuracy: 38.26
Round  52, Train loss: 1.473, Test loss: 1.567, Test accuracy: 89.78
Round  52, Global train loss: 1.473, Global test loss: 2.017, Global test accuracy: 43.52
Round  53, Train loss: 1.679, Test loss: 1.567, Test accuracy: 89.82
Round  53, Global train loss: 1.679, Global test loss: 1.983, Global test accuracy: 47.86
Round  54, Train loss: 1.593, Test loss: 1.567, Test accuracy: 89.88
Round  54, Global train loss: 1.593, Global test loss: 2.052, Global test accuracy: 41.92
Round  55, Train loss: 1.473, Test loss: 1.567, Test accuracy: 89.88
Round  55, Global train loss: 1.473, Global test loss: 2.027, Global test accuracy: 45.74
Round  56, Train loss: 1.677, Test loss: 1.567, Test accuracy: 89.84
Round  56, Global train loss: 1.677, Global test loss: 2.072, Global test accuracy: 38.20
Round  57, Train loss: 1.574, Test loss: 1.567, Test accuracy: 89.86
Round  57, Global train loss: 1.574, Global test loss: 2.075, Global test accuracy: 38.20
Round  58, Train loss: 1.468, Test loss: 1.567, Test accuracy: 89.86
Round  58, Global train loss: 1.468, Global test loss: 2.033, Global test accuracy: 39.78
Round  59, Train loss: 1.471, Test loss: 1.567, Test accuracy: 89.88
Round  59, Global train loss: 1.471, Global test loss: 2.041, Global test accuracy: 43.18
Round  60, Train loss: 1.471, Test loss: 1.566, Test accuracy: 89.90
Round  60, Global train loss: 1.471, Global test loss: 2.127, Global test accuracy: 32.18
Round  61, Train loss: 1.490, Test loss: 1.567, Test accuracy: 89.86
Round  61, Global train loss: 1.490, Global test loss: 2.115, Global test accuracy: 33.82
Round  62, Train loss: 1.610, Test loss: 1.566, Test accuracy: 89.86
Round  62, Global train loss: 1.610, Global test loss: 1.949, Global test accuracy: 51.44
Round  63, Train loss: 1.679, Test loss: 1.566, Test accuracy: 89.86
Round  63, Global train loss: 1.679, Global test loss: 1.942, Global test accuracy: 52.10
Round  64, Train loss: 1.475, Test loss: 1.566, Test accuracy: 89.86
Round  64, Global train loss: 1.475, Global test loss: 2.027, Global test accuracy: 43.40
Round  65, Train loss: 1.560, Test loss: 1.566, Test accuracy: 89.86
Round  65, Global train loss: 1.560, Global test loss: 1.910, Global test accuracy: 56.68
Round  66, Train loss: 1.555, Test loss: 1.566, Test accuracy: 89.86
Round  66, Global train loss: 1.555, Global test loss: 1.979, Global test accuracy: 50.28
Round  67, Train loss: 1.594, Test loss: 1.566, Test accuracy: 89.86
Round  67, Global train loss: 1.594, Global test loss: 1.943, Global test accuracy: 51.74
Round  68, Train loss: 1.677, Test loss: 1.566, Test accuracy: 89.90
Round  68, Global train loss: 1.677, Global test loss: 1.972, Global test accuracy: 48.26
Round  69, Train loss: 1.555, Test loss: 1.566, Test accuracy: 89.90
Round  69, Global train loss: 1.555, Global test loss: 1.941, Global test accuracy: 53.32
Round  70, Train loss: 1.557, Test loss: 1.566, Test accuracy: 89.88
Round  70, Global train loss: 1.557, Global test loss: 1.925, Global test accuracy: 52.74
Round  71, Train loss: 1.589, Test loss: 1.566, Test accuracy: 89.92
Round  71, Global train loss: 1.589, Global test loss: 1.939, Global test accuracy: 53.22
Round  72, Train loss: 1.487, Test loss: 1.566, Test accuracy: 89.88
Round  72, Global train loss: 1.487, Global test loss: 2.033, Global test accuracy: 41.78
Round  73, Train loss: 1.488, Test loss: 1.566, Test accuracy: 89.88
Round  73, Global train loss: 1.488, Global test loss: 1.962, Global test accuracy: 48.60
Round  74, Train loss: 1.472, Test loss: 1.566, Test accuracy: 89.88
Round  74, Global train loss: 1.472, Global test loss: 2.025, Global test accuracy: 45.80
Round  75, Train loss: 1.555, Test loss: 1.566, Test accuracy: 89.90
Round  75, Global train loss: 1.555, Global test loss: 2.101, Global test accuracy: 34.14
Round  76, Train loss: 1.589, Test loss: 1.566, Test accuracy: 89.90
Round  76, Global train loss: 1.589, Global test loss: 1.939, Global test accuracy: 53.30
Round  77, Train loss: 1.587, Test loss: 1.566, Test accuracy: 89.90
Round  77, Global train loss: 1.587, Global test loss: 1.933, Global test accuracy: 54.00
Round  78, Train loss: 1.605, Test loss: 1.566, Test accuracy: 89.88
Round  78, Global train loss: 1.605, Global test loss: 2.105, Global test accuracy: 35.50
Round  79, Train loss: 1.679, Test loss: 1.566, Test accuracy: 89.88
Round  79, Global train loss: 1.679, Global test loss: 2.059, Global test accuracy: 38.88
Round  80, Train loss: 1.605, Test loss: 1.566, Test accuracy: 89.86
Round  80, Global train loss: 1.605, Global test loss: 2.100, Global test accuracy: 35.00
Round  81, Train loss: 1.573, Test loss: 1.566, Test accuracy: 89.86
Round  81, Global train loss: 1.573, Global test loss: 1.969, Global test accuracy: 48.82
Round  82, Train loss: 1.675, Test loss: 1.566, Test accuracy: 89.86
Round  82, Global train loss: 1.675, Global test loss: 1.964, Global test accuracy: 49.96
Round  83, Train loss: 1.572, Test loss: 1.566, Test accuracy: 89.86
Round  83, Global train loss: 1.572, Global test loss: 2.075, Global test accuracy: 38.08
Round  84, Train loss: 1.675, Test loss: 1.566, Test accuracy: 89.88
Round  84, Global train loss: 1.675, Global test loss: 1.965, Global test accuracy: 49.92
Round  85, Train loss: 1.557, Test loss: 1.566, Test accuracy: 89.84
Round  85, Global train loss: 1.557, Global test loss: 2.003, Global test accuracy: 45.74
Round  86, Train loss: 1.559, Test loss: 1.566, Test accuracy: 89.88
Round  86, Global train loss: 1.559, Global test loss: 1.969, Global test accuracy: 47.88
Round  87, Train loss: 1.677, Test loss: 1.566, Test accuracy: 89.82
Round  87, Global train loss: 1.677, Global test loss: 1.943, Global test accuracy: 52.04
Round  88, Train loss: 1.557, Test loss: 1.566, Test accuracy: 89.84
Round  88, Global train loss: 1.557, Global test loss: 1.978, Global test accuracy: 47.42
Round  89, Train loss: 1.556, Test loss: 1.566, Test accuracy: 89.86
Round  89, Global train loss: 1.556, Global test loss: 2.003, Global test accuracy: 45.72
Round  90, Train loss: 1.486, Test loss: 1.566, Test accuracy: 89.86
Round  90, Global train loss: 1.486, Global test loss: 1.996, Global test accuracy: 46.44
Round  91, Train loss: 1.470, Test loss: 1.566, Test accuracy: 89.88
Round  91, Global train loss: 1.470, Global test loss: 1.970, Global test accuracy: 46.80
Round  92, Train loss: 1.553, Test loss: 1.566, Test accuracy: 89.84
Round  92, Global train loss: 1.553, Global test loss: 2.102, Global test accuracy: 34.08
Round  93, Train loss: 1.487, Test loss: 1.566, Test accuracy: 89.84
Round  93, Global train loss: 1.487, Global test loss: 2.031, Global test accuracy: 42.06
Round  94, Train loss: 1.488, Test loss: 1.566, Test accuracy: 89.84
Round  94, Global train loss: 1.488, Global test loss: 2.022, Global test accuracy: 42.42
Round  95, Train loss: 1.556, Test loss: 1.566, Test accuracy: 89.82
Round  95, Global train loss: 1.556, Global test loss: 1.979, Global test accuracy: 47.46/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.673, Test loss: 1.566, Test accuracy: 89.84
Round  96, Global train loss: 1.673, Global test loss: 1.964, Global test accuracy: 49.92
Round  97, Train loss: 1.490, Test loss: 1.566, Test accuracy: 89.84
Round  97, Global train loss: 1.490, Global test loss: 2.011, Global test accuracy: 44.26
Round  98, Train loss: 1.488, Test loss: 1.566, Test accuracy: 89.82
Round  98, Global train loss: 1.488, Global test loss: 1.975, Global test accuracy: 47.68
Round  99, Train loss: 1.489, Test loss: 1.566, Test accuracy: 89.86
Round  99, Global train loss: 1.489, Global test loss: 2.005, Global test accuracy: 45.54
Final Round, Train loss: 1.537, Test loss: 1.566, Test accuracy: 89.92
Final Round, Global train loss: 1.537, Global test loss: 2.005, Global test accuracy: 45.54
Average accuracy final 10 rounds: 89.84400000000001 

Average global accuracy final 10 rounds: 44.666000000000004 

801.7020809650421
[1.105330467224121, 2.210660934448242, 3.3463363647460938, 4.482011795043945, 5.471268653869629, 6.4605255126953125, 7.549253940582275, 8.637982368469238, 9.697357892990112, 10.756733417510986, 11.830402135848999, 12.904070854187012, 13.992533683776855, 15.0809965133667, 16.081679821014404, 17.08236312866211, 18.050745010375977, 19.019126892089844, 20.095771074295044, 21.172415256500244, 22.252670764923096, 23.332926273345947, 24.33078932762146, 25.328652381896973, 26.38700246810913, 27.44535255432129, 28.472384214401245, 29.4994158744812, 30.535781383514404, 31.572146892547607, 32.578147888183594, 33.58414888381958, 34.63057994842529, 35.677011013031006, 36.760483503341675, 37.843955993652344, 38.92003130912781, 39.99610662460327, 41.00433611869812, 42.01256561279297, 43.10490798950195, 44.19725036621094, 45.266602516174316, 46.335954666137695, 47.31730556488037, 48.29865646362305, 49.359933614730835, 50.42121076583862, 51.44734501838684, 52.47347927093506, 53.58682632446289, 54.70017337799072, 55.7975800037384, 56.894986629486084, 58.022130250930786, 59.14927387237549, 60.19583559036255, 61.24239730834961, 62.237290143966675, 63.23218297958374, 64.16341042518616, 65.09463787078857, 66.08751821517944, 67.08039855957031, 68.06173920631409, 69.04307985305786, 70.00975131988525, 70.97642278671265, 72.0024573802948, 73.02849197387695, 74.03521275520325, 75.04193353652954, 76.43570613861084, 77.82947874069214, 78.884836435318, 79.94019412994385, 80.91646099090576, 81.89272785186768, 82.8901629447937, 83.88759803771973, 84.91888236999512, 85.95016670227051, 87.00504541397095, 88.05992412567139, 89.14722228050232, 90.23452043533325, 91.29170441627502, 92.3488883972168, 93.36153960227966, 94.37419080734253, 95.44365310668945, 96.51311540603638, 97.5320999622345, 98.55108451843262, 99.59351968765259, 100.63595485687256, 101.65983033180237, 102.68370580673218, 103.67001223564148, 104.65631866455078, 105.78998231887817, 106.92364597320557, 108.30251955986023, 109.68139314651489, 110.99156785011292, 112.30174255371094, 113.55701637268066, 114.81229019165039, 115.89678525924683, 116.98128032684326, 118.17412257194519, 119.36696481704712, 120.45651245117188, 121.54606008529663, 122.65114307403564, 123.75622606277466, 124.88522458076477, 126.01422309875488, 127.05945658683777, 128.10469007492065, 129.14275979995728, 130.1808295249939, 131.2737591266632, 132.36668872833252, 133.59738659858704, 134.82808446884155, 135.8234703540802, 136.81885623931885, 137.8420855998993, 138.86531496047974, 140.17991471290588, 141.49451446533203, 142.5093412399292, 143.52416801452637, 144.5700180530548, 145.61586809158325, 146.8003647327423, 147.98486137390137, 148.9726173877716, 149.96037340164185, 150.97774577140808, 151.99511814117432, 153.29524397850037, 154.59536981582642, 156.08334016799927, 157.57131052017212, 158.86448550224304, 160.15766048431396, 161.5586678981781, 162.95967531204224, 164.64439296722412, 166.329110622406, 167.5562937259674, 168.7834768295288, 169.88500475883484, 170.98653268814087, 172.75597882270813, 174.5254249572754, 175.62260842323303, 176.71979188919067, 177.75019121170044, 178.7805905342102, 179.82196688652039, 180.86334323883057, 181.95696711540222, 183.05059099197388, 184.16396379470825, 185.27733659744263, 186.32793545722961, 187.3785343170166, 188.50494074821472, 189.63134717941284, 190.75060892105103, 191.8698706626892, 192.84912538528442, 193.82838010787964, 194.92117190361023, 196.01396369934082, 197.14664459228516, 198.2793254852295, 199.24239826202393, 200.20547103881836, 201.22577095031738, 202.2460708618164, 203.37154936790466, 204.49702787399292, 205.52991104125977, 206.5627942085266, 207.6137251853943, 208.66465616226196, 209.8274917602539, 210.99032735824585, 212.14527368545532, 213.3002200126648, 214.62166237831116, 215.94310474395752, 217.0211524963379, 218.09920024871826, 219.18622064590454, 220.27324104309082, 222.59891653060913, 224.92459201812744]
[33.94, 33.94, 30.54, 30.54, 46.4, 46.4, 53.7, 53.7, 62.8, 62.8, 69.42, 69.42, 74.94, 74.94, 80.68, 80.68, 80.98, 80.98, 84.36, 84.36, 84.82, 84.82, 86.32, 86.32, 86.66, 86.66, 88.38, 88.38, 88.36, 88.36, 88.34, 88.34, 88.44, 88.44, 88.38, 88.38, 88.4, 88.4, 88.52, 88.52, 88.24, 88.24, 88.2, 88.2, 88.18, 88.18, 88.32, 88.32, 88.26, 88.26, 88.22, 88.22, 88.2, 88.2, 88.22, 88.22, 88.26, 88.26, 88.28, 88.28, 88.26, 88.26, 88.28, 88.28, 88.36, 88.36, 88.22, 88.22, 88.26, 88.26, 88.24, 88.24, 88.24, 88.24, 88.26, 88.26, 88.26, 88.26, 88.2, 88.2, 88.18, 88.18, 89.94, 89.94, 89.9, 89.9, 89.8, 89.8, 89.82, 89.82, 89.84, 89.84, 89.9, 89.9, 89.86, 89.86, 89.78, 89.78, 89.78, 89.78, 89.78, 89.78, 89.82, 89.82, 89.78, 89.78, 89.82, 89.82, 89.88, 89.88, 89.88, 89.88, 89.84, 89.84, 89.86, 89.86, 89.86, 89.86, 89.88, 89.88, 89.9, 89.9, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.9, 89.9, 89.9, 89.9, 89.88, 89.88, 89.92, 89.92, 89.88, 89.88, 89.88, 89.88, 89.88, 89.88, 89.9, 89.9, 89.9, 89.9, 89.9, 89.9, 89.88, 89.88, 89.88, 89.88, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.86, 89.88, 89.88, 89.84, 89.84, 89.88, 89.88, 89.82, 89.82, 89.84, 89.84, 89.86, 89.86, 89.86, 89.86, 89.88, 89.88, 89.84, 89.84, 89.84, 89.84, 89.84, 89.84, 89.82, 89.82, 89.84, 89.84, 89.84, 89.84, 89.82, 89.82, 89.86, 89.86, 89.92, 89.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.289, Test loss: 2.290, Test accuracy: 14.08
Round   0, Global train loss: 2.289, Global test loss: 2.298, Global test accuracy: 14.40
Round   1, Train loss: 2.251, Test loss: 2.217, Test accuracy: 26.42
Round   1, Global train loss: 2.251, Global test loss: 2.249, Global test accuracy: 29.86
Round   2, Train loss: 1.999, Test loss: 2.054, Test accuracy: 41.70
Round   2, Global train loss: 1.999, Global test loss: 2.061, Global test accuracy: 40.80
Round   3, Train loss: 1.950, Test loss: 1.932, Test accuracy: 55.92
Round   3, Global train loss: 1.950, Global test loss: 1.982, Global test accuracy: 47.98
Round   4, Train loss: 1.815, Test loss: 1.903, Test accuracy: 59.14
Round   4, Global train loss: 1.815, Global test loss: 1.965, Global test accuracy: 49.60
Round   5, Train loss: 1.931, Test loss: 1.823, Test accuracy: 66.84
Round   5, Global train loss: 1.931, Global test loss: 1.934, Global test accuracy: 59.58
Round   6, Train loss: 1.779, Test loss: 1.794, Test accuracy: 69.88
Round   6, Global train loss: 1.779, Global test loss: 1.961, Global test accuracy: 49.90
Round   7, Train loss: 1.840, Test loss: 1.779, Test accuracy: 71.46
Round   7, Global train loss: 1.840, Global test loss: 1.921, Global test accuracy: 54.94
Round   8, Train loss: 1.740, Test loss: 1.755, Test accuracy: 73.60
Round   8, Global train loss: 1.740, Global test loss: 1.958, Global test accuracy: 48.62
Round   9, Train loss: 1.797, Test loss: 1.728, Test accuracy: 75.94
Round   9, Global train loss: 1.797, Global test loss: 1.909, Global test accuracy: 55.78
Round  10, Train loss: 1.779, Test loss: 1.709, Test accuracy: 77.84
Round  10, Global train loss: 1.779, Global test loss: 1.971, Global test accuracy: 46.24
Round  11, Train loss: 1.605, Test loss: 1.706, Test accuracy: 77.94
Round  11, Global train loss: 1.605, Global test loss: 1.863, Global test accuracy: 60.38
Round  12, Train loss: 1.632, Test loss: 1.671, Test accuracy: 80.18
Round  12, Global train loss: 1.632, Global test loss: 1.872, Global test accuracy: 57.88
Round  13, Train loss: 1.680, Test loss: 1.663, Test accuracy: 80.68
Round  13, Global train loss: 1.680, Global test loss: 1.786, Global test accuracy: 68.30
Round  14, Train loss: 1.725, Test loss: 1.662, Test accuracy: 80.58
Round  14, Global train loss: 1.725, Global test loss: 1.774, Global test accuracy: 69.64
Round  15, Train loss: 1.682, Test loss: 1.659, Test accuracy: 80.74
Round  15, Global train loss: 1.682, Global test loss: 1.802, Global test accuracy: 66.88
Round  16, Train loss: 1.667, Test loss: 1.658, Test accuracy: 80.94
Round  16, Global train loss: 1.667, Global test loss: 1.730, Global test accuracy: 74.64
Round  17, Train loss: 1.786, Test loss: 1.658, Test accuracy: 80.84
Round  17, Global train loss: 1.786, Global test loss: 1.756, Global test accuracy: 71.68
Round  18, Train loss: 1.730, Test loss: 1.656, Test accuracy: 80.98
Round  18, Global train loss: 1.730, Global test loss: 1.746, Global test accuracy: 73.08
Round  19, Train loss: 1.557, Test loss: 1.654, Test accuracy: 81.10
Round  19, Global train loss: 1.557, Global test loss: 1.784, Global test accuracy: 68.74
Round  20, Train loss: 1.495, Test loss: 1.654, Test accuracy: 81.16
Round  20, Global train loss: 1.495, Global test loss: 1.707, Global test accuracy: 76.70
Round  21, Train loss: 1.822, Test loss: 1.638, Test accuracy: 82.76
Round  21, Global train loss: 1.822, Global test loss: 1.711, Global test accuracy: 76.68
Round  22, Train loss: 1.771, Test loss: 1.610, Test accuracy: 85.80
Round  22, Global train loss: 1.771, Global test loss: 1.707, Global test accuracy: 78.16
Round  23, Train loss: 1.597, Test loss: 1.609, Test accuracy: 85.84
Round  23, Global train loss: 1.597, Global test loss: 1.764, Global test accuracy: 70.12
Round  24, Train loss: 1.723, Test loss: 1.590, Test accuracy: 87.74
Round  24, Global train loss: 1.723, Global test loss: 1.700, Global test accuracy: 77.24
Round  25, Train loss: 1.664, Test loss: 1.590, Test accuracy: 87.70
Round  25, Global train loss: 1.664, Global test loss: 1.712, Global test accuracy: 76.04
Round  26, Train loss: 1.625, Test loss: 1.589, Test accuracy: 87.92
Round  26, Global train loss: 1.625, Global test loss: 1.697, Global test accuracy: 77.46
Round  27, Train loss: 1.590, Test loss: 1.588, Test accuracy: 88.06
Round  27, Global train loss: 1.590, Global test loss: 1.688, Global test accuracy: 78.42
Round  28, Train loss: 1.679, Test loss: 1.576, Test accuracy: 89.40
Round  28, Global train loss: 1.679, Global test loss: 1.683, Global test accuracy: 78.80
Round  29, Train loss: 1.697, Test loss: 1.565, Test accuracy: 90.40
Round  29, Global train loss: 1.697, Global test loss: 1.703, Global test accuracy: 76.72
Round  30, Train loss: 1.516, Test loss: 1.543, Test accuracy: 92.52
Round  30, Global train loss: 1.516, Global test loss: 1.749, Global test accuracy: 72.26
Round  31, Train loss: 1.597, Test loss: 1.540, Test accuracy: 92.96
Round  31, Global train loss: 1.597, Global test loss: 1.734, Global test accuracy: 73.64
Round  32, Train loss: 1.496, Test loss: 1.538, Test accuracy: 93.08
Round  32, Global train loss: 1.496, Global test loss: 1.678, Global test accuracy: 79.02
Round  33, Train loss: 1.492, Test loss: 1.538, Test accuracy: 93.04
Round  33, Global train loss: 1.492, Global test loss: 1.663, Global test accuracy: 80.98
Round  34, Train loss: 1.683, Test loss: 1.537, Test accuracy: 92.96
Round  34, Global train loss: 1.683, Global test loss: 1.641, Global test accuracy: 83.98
Round  35, Train loss: 1.580, Test loss: 1.539, Test accuracy: 92.82
Round  35, Global train loss: 1.580, Global test loss: 1.631, Global test accuracy: 84.38
Round  36, Train loss: 1.504, Test loss: 1.538, Test accuracy: 92.74
Round  36, Global train loss: 1.504, Global test loss: 1.654, Global test accuracy: 81.34
Round  37, Train loss: 1.575, Test loss: 1.533, Test accuracy: 93.22
Round  37, Global train loss: 1.575, Global test loss: 1.622, Global test accuracy: 85.20
Round  38, Train loss: 1.575, Test loss: 1.535, Test accuracy: 93.00
Round  38, Global train loss: 1.575, Global test loss: 1.641, Global test accuracy: 82.96
Round  39, Train loss: 1.598, Test loss: 1.535, Test accuracy: 92.98
Round  39, Global train loss: 1.598, Global test loss: 1.658, Global test accuracy: 81.02
Round  40, Train loss: 1.484, Test loss: 1.535, Test accuracy: 93.16
Round  40, Global train loss: 1.484, Global test loss: 1.604, Global test accuracy: 86.36
Round  41, Train loss: 1.486, Test loss: 1.532, Test accuracy: 93.38
Round  41, Global train loss: 1.486, Global test loss: 1.616, Global test accuracy: 85.64
Round  42, Train loss: 1.489, Test loss: 1.532, Test accuracy: 93.52
Round  42, Global train loss: 1.489, Global test loss: 1.687, Global test accuracy: 77.82
Round  43, Train loss: 1.477, Test loss: 1.532, Test accuracy: 93.48
Round  43, Global train loss: 1.477, Global test loss: 1.656, Global test accuracy: 81.12
Round  44, Train loss: 1.580, Test loss: 1.529, Test accuracy: 93.64
Round  44, Global train loss: 1.580, Global test loss: 1.656, Global test accuracy: 81.48
Round  45, Train loss: 1.487, Test loss: 1.529, Test accuracy: 93.64
Round  45, Global train loss: 1.487, Global test loss: 1.635, Global test accuracy: 83.38
Round  46, Train loss: 1.485, Test loss: 1.529, Test accuracy: 93.60
Round  46, Global train loss: 1.485, Global test loss: 1.641, Global test accuracy: 82.38
Round  47, Train loss: 1.583, Test loss: 1.529, Test accuracy: 93.62
Round  47, Global train loss: 1.583, Global test loss: 1.671, Global test accuracy: 79.58
Round  48, Train loss: 1.480, Test loss: 1.529, Test accuracy: 93.76
Round  48, Global train loss: 1.480, Global test loss: 1.608, Global test accuracy: 85.82
Round  49, Train loss: 1.573, Test loss: 1.529, Test accuracy: 93.74
Round  49, Global train loss: 1.573, Global test loss: 1.583, Global test accuracy: 88.82
Round  50, Train loss: 1.576, Test loss: 1.528, Test accuracy: 93.80
Round  50, Global train loss: 1.576, Global test loss: 1.661, Global test accuracy: 80.26
Round  51, Train loss: 1.479, Test loss: 1.528, Test accuracy: 93.76
Round  51, Global train loss: 1.479, Global test loss: 1.609, Global test accuracy: 86.38
Round  52, Train loss: 1.571, Test loss: 1.530, Test accuracy: 93.40
Round  52, Global train loss: 1.571, Global test loss: 1.597, Global test accuracy: 87.00
Round  53, Train loss: 1.482, Test loss: 1.530, Test accuracy: 93.36
Round  53, Global train loss: 1.482, Global test loss: 1.631, Global test accuracy: 83.44
Round  54, Train loss: 1.486, Test loss: 1.530, Test accuracy: 93.44
Round  54, Global train loss: 1.486, Global test loss: 1.583, Global test accuracy: 88.58
Round  55, Train loss: 1.667, Test loss: 1.528, Test accuracy: 93.74
Round  55, Global train loss: 1.667, Global test loss: 1.611, Global test accuracy: 85.38
Round  56, Train loss: 1.568, Test loss: 1.529, Test accuracy: 93.60
Round  56, Global train loss: 1.568, Global test loss: 1.657, Global test accuracy: 80.80
Round  57, Train loss: 1.474, Test loss: 1.529, Test accuracy: 93.52
Round  57, Global train loss: 1.474, Global test loss: 1.620, Global test accuracy: 84.72
Round  58, Train loss: 1.662, Test loss: 1.528, Test accuracy: 93.56
Round  58, Global train loss: 1.662, Global test loss: 1.593, Global test accuracy: 87.38
Round  59, Train loss: 1.565, Test loss: 1.527, Test accuracy: 93.70
Round  59, Global train loss: 1.565, Global test loss: 1.591, Global test accuracy: 88.00
Round  60, Train loss: 1.575, Test loss: 1.527, Test accuracy: 93.74
Round  60, Global train loss: 1.575, Global test loss: 1.598, Global test accuracy: 87.06
Round  61, Train loss: 1.563, Test loss: 1.526, Test accuracy: 93.88
Round  61, Global train loss: 1.563, Global test loss: 1.612, Global test accuracy: 85.80
Round  62, Train loss: 1.481, Test loss: 1.526, Test accuracy: 93.94
Round  62, Global train loss: 1.481, Global test loss: 1.607, Global test accuracy: 85.86
Round  63, Train loss: 1.476, Test loss: 1.526, Test accuracy: 93.88
Round  63, Global train loss: 1.476, Global test loss: 1.613, Global test accuracy: 85.18
Round  64, Train loss: 1.575, Test loss: 1.526, Test accuracy: 93.90
Round  64, Global train loss: 1.575, Global test loss: 1.621, Global test accuracy: 84.70
Round  65, Train loss: 1.570, Test loss: 1.526, Test accuracy: 93.94
Round  65, Global train loss: 1.570, Global test loss: 1.614, Global test accuracy: 84.92
Round  66, Train loss: 1.561, Test loss: 1.526, Test accuracy: 93.96
Round  66, Global train loss: 1.561, Global test loss: 1.593, Global test accuracy: 87.58
Round  67, Train loss: 1.480, Test loss: 1.526, Test accuracy: 93.88
Round  67, Global train loss: 1.480, Global test loss: 1.581, Global test accuracy: 88.66
Round  68, Train loss: 1.477, Test loss: 1.527, Test accuracy: 93.90
Round  68, Global train loss: 1.477, Global test loss: 1.609, Global test accuracy: 85.62
Round  69, Train loss: 1.569, Test loss: 1.527, Test accuracy: 93.84
Round  69, Global train loss: 1.569, Global test loss: 1.582, Global test accuracy: 88.80
Round  70, Train loss: 1.473, Test loss: 1.526, Test accuracy: 93.94
Round  70, Global train loss: 1.473, Global test loss: 1.600, Global test accuracy: 86.38
Round  71, Train loss: 1.480, Test loss: 1.526, Test accuracy: 93.86
Round  71, Global train loss: 1.480, Global test loss: 1.579, Global test accuracy: 89.12
Round  72, Train loss: 1.475, Test loss: 1.526, Test accuracy: 93.96
Round  72, Global train loss: 1.475, Global test loss: 1.573, Global test accuracy: 89.68
Round  73, Train loss: 1.473, Test loss: 1.526, Test accuracy: 93.94
Round  73, Global train loss: 1.473, Global test loss: 1.603, Global test accuracy: 86.56
Round  74, Train loss: 1.661, Test loss: 1.524, Test accuracy: 94.16
Round  74, Global train loss: 1.661, Global test loss: 1.588, Global test accuracy: 87.80
Round  75, Train loss: 1.472, Test loss: 1.524, Test accuracy: 94.12
Round  75, Global train loss: 1.472, Global test loss: 1.575, Global test accuracy: 89.42
Round  76, Train loss: 1.479, Test loss: 1.524, Test accuracy: 94.16
Round  76, Global train loss: 1.479, Global test loss: 1.572, Global test accuracy: 89.50
Round  77, Train loss: 1.574, Test loss: 1.524, Test accuracy: 94.08
Round  77, Global train loss: 1.574, Global test loss: 1.579, Global test accuracy: 88.96
Round  78, Train loss: 1.477, Test loss: 1.524, Test accuracy: 94.22
Round  78, Global train loss: 1.477, Global test loss: 1.588, Global test accuracy: 87.78
Round  79, Train loss: 1.475, Test loss: 1.524, Test accuracy: 94.28
Round  79, Global train loss: 1.475, Global test loss: 1.597, Global test accuracy: 86.78
Round  80, Train loss: 1.562, Test loss: 1.525, Test accuracy: 94.12
Round  80, Global train loss: 1.562, Global test loss: 1.612, Global test accuracy: 84.96
Round  81, Train loss: 1.469, Test loss: 1.525, Test accuracy: 94.14
Round  81, Global train loss: 1.469, Global test loss: 1.596, Global test accuracy: 87.06
Round  82, Train loss: 1.569, Test loss: 1.525, Test accuracy: 94.12
Round  82, Global train loss: 1.569, Global test loss: 1.608, Global test accuracy: 85.84
Round  83, Train loss: 1.470, Test loss: 1.525, Test accuracy: 94.06
Round  83, Global train loss: 1.470, Global test loss: 1.583, Global test accuracy: 88.46
Round  84, Train loss: 1.568, Test loss: 1.525, Test accuracy: 94.06
Round  84, Global train loss: 1.568, Global test loss: 1.603, Global test accuracy: 86.16
Round  85, Train loss: 1.557, Test loss: 1.525, Test accuracy: 94.02
Round  85, Global train loss: 1.557, Global test loss: 1.588, Global test accuracy: 87.50
Round  86, Train loss: 1.473, Test loss: 1.525, Test accuracy: 94.02
Round  86, Global train loss: 1.473, Global test loss: 1.589, Global test accuracy: 87.44
Round  87, Train loss: 1.473, Test loss: 1.525, Test accuracy: 93.98
Round  87, Global train loss: 1.473, Global test loss: 1.579, Global test accuracy: 88.88
Round  88, Train loss: 1.566, Test loss: 1.525, Test accuracy: 93.90
Round  88, Global train loss: 1.566, Global test loss: 1.578, Global test accuracy: 88.98
Round  89, Train loss: 1.557, Test loss: 1.525, Test accuracy: 94.02
Round  89, Global train loss: 1.557, Global test loss: 1.593, Global test accuracy: 87.50
Round  90, Train loss: 1.652, Test loss: 1.523, Test accuracy: 94.10
Round  90, Global train loss: 1.652, Global test loss: 1.584, Global test accuracy: 88.30
Round  91, Train loss: 1.652, Test loss: 1.524, Test accuracy: 94.12
Round  91, Global train loss: 1.652, Global test loss: 1.582, Global test accuracy: 88.40
Round  92, Train loss: 1.471, Test loss: 1.523, Test accuracy: 94.12
Round  92, Global train loss: 1.471, Global test loss: 1.575, Global test accuracy: 89.38
Round  93, Train loss: 1.473, Test loss: 1.524, Test accuracy: 94.14
Round  93, Global train loss: 1.473, Global test loss: 1.569, Global test accuracy: 89.96
Round  94, Train loss: 1.556, Test loss: 1.524, Test accuracy: 94.10
Round  94, Global train loss: 1.556, Global test loss: 1.579, Global test accuracy: 88.78
Round  95, Train loss: 1.564, Test loss: 1.525, Test accuracy: 93.98
Round  95, Global train loss: 1.564, Global test loss: 1.572, Global test accuracy: 89.40/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.568, Test loss: 1.524, Test accuracy: 94.06
Round  96, Global train loss: 1.568, Global test loss: 1.595, Global test accuracy: 87.28
Round  97, Train loss: 1.473, Test loss: 1.524, Test accuracy: 94.12
Round  97, Global train loss: 1.473, Global test loss: 1.575, Global test accuracy: 89.46
Round  98, Train loss: 1.471, Test loss: 1.524, Test accuracy: 94.14
Round  98, Global train loss: 1.471, Global test loss: 1.578, Global test accuracy: 89.26
Round  99, Train loss: 1.472, Test loss: 1.523, Test accuracy: 94.16
Round  99, Global train loss: 1.472, Global test loss: 1.603, Global test accuracy: 86.16
Final Round, Train loss: 1.525, Test loss: 1.522, Test accuracy: 94.28
Final Round, Global train loss: 1.525, Global test loss: 1.603, Global test accuracy: 86.16
Average accuracy final 10 rounds: 94.10400000000001 

Average global accuracy final 10 rounds: 88.638 

797.8882756233215
[1.1223082542419434, 2.2446165084838867, 3.252535581588745, 4.2604546546936035, 5.240002393722534, 6.219550132751465, 7.211986064910889, 8.204421997070312, 9.284847497940063, 10.365272998809814, 11.412343502044678, 12.459414005279541, 13.75397515296936, 15.04853630065918, 16.11879253387451, 17.189048767089844, 18.104305505752563, 19.019562244415283, 19.970773220062256, 20.92198419570923, 21.901239156723022, 22.880494117736816, 24.009726762771606, 25.138959407806396, 26.24532198905945, 27.3516845703125, 28.422735929489136, 29.49378728866577, 30.59108853340149, 31.688389778137207, 32.72409152984619, 33.759793281555176, 34.865700244903564, 35.97160720825195, 36.95486760139465, 37.93812799453735, 39.039122581481934, 40.140117168426514, 41.28594470024109, 42.431772232055664, 43.46909213066101, 44.50641202926636, 45.54425311088562, 46.58209419250488, 47.6961567401886, 48.810219287872314, 49.76372838020325, 50.71723747253418, 51.795613050460815, 52.87398862838745, 53.85830593109131, 54.842623233795166, 55.997703552246094, 57.15278387069702, 58.24891996383667, 59.34505605697632, 60.35763168334961, 61.3702073097229, 62.43006896972656, 63.489930629730225, 64.80823421478271, 66.1265377998352, 67.21057271957397, 68.29460763931274, 69.33535671234131, 70.37610578536987, 71.47399544715881, 72.57188510894775, 73.58941197395325, 74.60693883895874, 75.59821915626526, 76.58949947357178, 77.79752492904663, 79.00555038452148, 80.0884063243866, 81.17126226425171, 82.20987510681152, 83.24848794937134, 84.15497350692749, 85.06145906448364, 86.10385584831238, 87.14625263214111, 88.24630951881409, 89.34636640548706, 90.40549421310425, 91.46462202072144, 92.51552772521973, 93.56643342971802, 94.49449944496155, 95.42256546020508, 96.37829089164734, 97.3340163230896, 98.33143258094788, 99.32884883880615, 100.33515167236328, 101.34145450592041, 102.44014930725098, 103.53884410858154, 104.46502137184143, 105.39119863510132, 106.37900161743164, 107.36680459976196, 108.64522981643677, 109.92365503311157, 110.94392418861389, 111.96419334411621, 112.96417927742004, 113.96416521072388, 115.01495456695557, 116.06574392318726, 117.2198281288147, 118.37391233444214, 119.40696048736572, 120.4400086402893, 121.4940505027771, 122.54809236526489, 123.6601984500885, 124.77230453491211, 125.76498436927795, 126.7576642036438, 127.77166843414307, 128.78567266464233, 129.82471871376038, 130.86376476287842, 131.93138217926025, 132.9989995956421, 134.08250951766968, 135.16601943969727, 136.25920867919922, 137.35239791870117, 138.41030406951904, 139.4682102203369, 140.45390129089355, 141.4395923614502, 142.6874098777771, 143.935227394104, 145.34653663635254, 146.75784587860107, 147.77202606201172, 148.78620624542236, 149.83811569213867, 150.89002513885498, 151.95921683311462, 153.02840852737427, 154.00339937210083, 154.9783902168274, 155.96827745437622, 156.95816469192505, 158.0138382911682, 159.06951189041138, 160.01453971862793, 160.95956754684448, 162.07677483558655, 163.1939821243286, 164.12210702896118, 165.05023193359375, 166.17532515525818, 167.3004183769226, 168.49376940727234, 169.68712043762207, 170.8471302986145, 172.00714015960693, 173.0590741634369, 174.11100816726685, 175.1964671611786, 176.28192615509033, 177.22476243972778, 178.16759872436523, 179.31321477890015, 180.45883083343506, 181.5054850578308, 182.55213928222656, 183.5462305545807, 184.54032182693481, 185.6040165424347, 186.66771125793457, 187.68021631240845, 188.69272136688232, 189.78253173828125, 190.87234210968018, 191.9534854888916, 193.03462886810303, 194.39765667915344, 195.76068449020386, 196.92438054084778, 198.0880765914917, 199.14457774162292, 200.20107889175415, 201.18157982826233, 202.1620807647705, 203.32703518867493, 204.49198961257935, 205.56111812591553, 206.6302466392517, 207.71492862701416, 208.7996106147766, 209.83937001228333, 210.87912940979004, 212.03208565711975, 213.18504190444946, 215.61184430122375, 218.03864669799805]
[14.08, 14.08, 26.42, 26.42, 41.7, 41.7, 55.92, 55.92, 59.14, 59.14, 66.84, 66.84, 69.88, 69.88, 71.46, 71.46, 73.6, 73.6, 75.94, 75.94, 77.84, 77.84, 77.94, 77.94, 80.18, 80.18, 80.68, 80.68, 80.58, 80.58, 80.74, 80.74, 80.94, 80.94, 80.84, 80.84, 80.98, 80.98, 81.1, 81.1, 81.16, 81.16, 82.76, 82.76, 85.8, 85.8, 85.84, 85.84, 87.74, 87.74, 87.7, 87.7, 87.92, 87.92, 88.06, 88.06, 89.4, 89.4, 90.4, 90.4, 92.52, 92.52, 92.96, 92.96, 93.08, 93.08, 93.04, 93.04, 92.96, 92.96, 92.82, 92.82, 92.74, 92.74, 93.22, 93.22, 93.0, 93.0, 92.98, 92.98, 93.16, 93.16, 93.38, 93.38, 93.52, 93.52, 93.48, 93.48, 93.64, 93.64, 93.64, 93.64, 93.6, 93.6, 93.62, 93.62, 93.76, 93.76, 93.74, 93.74, 93.8, 93.8, 93.76, 93.76, 93.4, 93.4, 93.36, 93.36, 93.44, 93.44, 93.74, 93.74, 93.6, 93.6, 93.52, 93.52, 93.56, 93.56, 93.7, 93.7, 93.74, 93.74, 93.88, 93.88, 93.94, 93.94, 93.88, 93.88, 93.9, 93.9, 93.94, 93.94, 93.96, 93.96, 93.88, 93.88, 93.9, 93.9, 93.84, 93.84, 93.94, 93.94, 93.86, 93.86, 93.96, 93.96, 93.94, 93.94, 94.16, 94.16, 94.12, 94.12, 94.16, 94.16, 94.08, 94.08, 94.22, 94.22, 94.28, 94.28, 94.12, 94.12, 94.14, 94.14, 94.12, 94.12, 94.06, 94.06, 94.06, 94.06, 94.02, 94.02, 94.02, 94.02, 93.98, 93.98, 93.9, 93.9, 94.02, 94.02, 94.1, 94.1, 94.12, 94.12, 94.12, 94.12, 94.14, 94.14, 94.1, 94.1, 93.98, 93.98, 94.06, 94.06, 94.12, 94.12, 94.14, 94.14, 94.16, 94.16, 94.28, 94.28]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.291, Test loss: 2.296, Test accuracy: 9.78
Round   0, Global train loss: 2.291, Global test loss: 2.301, Global test accuracy: 6.00
Round   1, Train loss: 2.274, Test loss: 2.264, Test accuracy: 27.60
Round   1, Global train loss: 2.274, Global test loss: 2.272, Global test accuracy: 24.40
Round   2, Train loss: 2.100, Test loss: 2.089, Test accuracy: 43.64
Round   2, Global train loss: 2.100, Global test loss: 2.082, Global test accuracy: 43.38
Round   3, Train loss: 1.959, Test loss: 1.963, Test accuracy: 54.04
Round   3, Global train loss: 1.959, Global test loss: 2.018, Global test accuracy: 46.24
Round   4, Train loss: 1.766, Test loss: 1.911, Test accuracy: 58.66
Round   4, Global train loss: 1.766, Global test loss: 1.989, Global test accuracy: 48.94
Round   5, Train loss: 1.935, Test loss: 1.819, Test accuracy: 68.24
Round   5, Global train loss: 1.935, Global test loss: 1.922, Global test accuracy: 60.14
Round   6, Train loss: 1.855, Test loss: 1.769, Test accuracy: 72.98
Round   6, Global train loss: 1.855, Global test loss: 1.945, Global test accuracy: 51.72
Round   7, Train loss: 1.776, Test loss: 1.764, Test accuracy: 73.18
Round   7, Global train loss: 1.776, Global test loss: 1.916, Global test accuracy: 55.22
Round   8, Train loss: 1.805, Test loss: 1.739, Test accuracy: 75.14
Round   8, Global train loss: 1.805, Global test loss: 1.956, Global test accuracy: 47.74
Round   9, Train loss: 1.817, Test loss: 1.719, Test accuracy: 77.22
Round   9, Global train loss: 1.817, Global test loss: 1.885, Global test accuracy: 57.78
Round  10, Train loss: 1.730, Test loss: 1.705, Test accuracy: 78.04
Round  10, Global train loss: 1.730, Global test loss: 1.877, Global test accuracy: 59.22
Round  11, Train loss: 1.776, Test loss: 1.700, Test accuracy: 78.08
Round  11, Global train loss: 1.776, Global test loss: 1.831, Global test accuracy: 64.84
Round  12, Train loss: 1.652, Test loss: 1.677, Test accuracy: 79.96
Round  12, Global train loss: 1.652, Global test loss: 1.836, Global test accuracy: 63.28
Round  13, Train loss: 1.595, Test loss: 1.675, Test accuracy: 79.86
Round  13, Global train loss: 1.595, Global test loss: 1.766, Global test accuracy: 71.86
Round  14, Train loss: 1.634, Test loss: 1.672, Test accuracy: 80.00
Round  14, Global train loss: 1.634, Global test loss: 1.756, Global test accuracy: 72.62
Round  15, Train loss: 1.640, Test loss: 1.669, Test accuracy: 80.22
Round  15, Global train loss: 1.640, Global test loss: 1.742, Global test accuracy: 74.58
Round  16, Train loss: 1.720, Test loss: 1.664, Test accuracy: 80.52
Round  16, Global train loss: 1.720, Global test loss: 1.720, Global test accuracy: 76.08
Round  17, Train loss: 1.740, Test loss: 1.663, Test accuracy: 80.66
Round  17, Global train loss: 1.740, Global test loss: 1.748, Global test accuracy: 72.90
Round  18, Train loss: 1.767, Test loss: 1.662, Test accuracy: 80.64
Round  18, Global train loss: 1.767, Global test loss: 1.725, Global test accuracy: 75.90
Round  19, Train loss: 1.634, Test loss: 1.662, Test accuracy: 80.56
Round  19, Global train loss: 1.634, Global test loss: 1.778, Global test accuracy: 69.96
Round  20, Train loss: 1.592, Test loss: 1.661, Test accuracy: 80.68
Round  20, Global train loss: 1.592, Global test loss: 1.718, Global test accuracy: 75.50
Round  21, Train loss: 1.871, Test loss: 1.663, Test accuracy: 80.40
Round  21, Global train loss: 1.871, Global test loss: 1.720, Global test accuracy: 76.14
Round  22, Train loss: 1.804, Test loss: 1.657, Test accuracy: 80.94
Round  22, Global train loss: 1.804, Global test loss: 1.717, Global test accuracy: 75.98
Round  23, Train loss: 1.732, Test loss: 1.657, Test accuracy: 80.96
Round  23, Global train loss: 1.732, Global test loss: 1.765, Global test accuracy: 70.26
Round  24, Train loss: 1.772, Test loss: 1.640, Test accuracy: 82.72
Round  24, Global train loss: 1.772, Global test loss: 1.712, Global test accuracy: 76.12
Round  25, Train loss: 1.523, Test loss: 1.623, Test accuracy: 84.52
Round  25, Global train loss: 1.523, Global test loss: 1.758, Global test accuracy: 71.06
Round  26, Train loss: 1.660, Test loss: 1.619, Test accuracy: 84.88
Round  26, Global train loss: 1.660, Global test loss: 1.730, Global test accuracy: 73.98
Round  27, Train loss: 1.501, Test loss: 1.620, Test accuracy: 84.88
Round  27, Global train loss: 1.501, Global test loss: 1.721, Global test accuracy: 74.54
Round  28, Train loss: 1.661, Test loss: 1.621, Test accuracy: 84.64
Round  28, Global train loss: 1.661, Global test loss: 1.729, Global test accuracy: 73.80
Round  29, Train loss: 1.558, Test loss: 1.621, Test accuracy: 84.52
Round  29, Global train loss: 1.558, Global test loss: 1.731, Global test accuracy: 73.36
Round  30, Train loss: 1.664, Test loss: 1.603, Test accuracy: 86.46
Round  30, Global train loss: 1.664, Global test loss: 1.763, Global test accuracy: 70.72
Round  31, Train loss: 1.622, Test loss: 1.602, Test accuracy: 86.54
Round  31, Global train loss: 1.622, Global test loss: 1.777, Global test accuracy: 68.14
Round  32, Train loss: 1.784, Test loss: 1.599, Test accuracy: 86.70
Round  32, Global train loss: 1.784, Global test loss: 1.712, Global test accuracy: 75.60
Round  33, Train loss: 1.646, Test loss: 1.600, Test accuracy: 86.66
Round  33, Global train loss: 1.646, Global test loss: 1.719, Global test accuracy: 74.88
Round  34, Train loss: 1.613, Test loss: 1.599, Test accuracy: 86.76
Round  34, Global train loss: 1.613, Global test loss: 1.673, Global test accuracy: 80.36
Round  35, Train loss: 1.685, Test loss: 1.598, Test accuracy: 86.74
Round  35, Global train loss: 1.685, Global test loss: 1.680, Global test accuracy: 79.90
Round  36, Train loss: 1.616, Test loss: 1.598, Test accuracy: 86.66
Round  36, Global train loss: 1.616, Global test loss: 1.714, Global test accuracy: 75.60
Round  37, Train loss: 1.679, Test loss: 1.598, Test accuracy: 86.64
Round  37, Global train loss: 1.679, Global test loss: 1.699, Global test accuracy: 77.70
Round  38, Train loss: 1.602, Test loss: 1.598, Test accuracy: 86.64
Round  38, Global train loss: 1.602, Global test loss: 1.694, Global test accuracy: 77.90
Round  39, Train loss: 1.654, Test loss: 1.598, Test accuracy: 86.76
Round  39, Global train loss: 1.654, Global test loss: 1.686, Global test accuracy: 78.36
Round  40, Train loss: 1.634, Test loss: 1.597, Test accuracy: 86.84
Round  40, Global train loss: 1.634, Global test loss: 1.667, Global test accuracy: 80.58
Round  41, Train loss: 1.581, Test loss: 1.596, Test accuracy: 86.72
Round  41, Global train loss: 1.581, Global test loss: 1.651, Global test accuracy: 82.20
Round  42, Train loss: 1.552, Test loss: 1.596, Test accuracy: 86.84
Round  42, Global train loss: 1.552, Global test loss: 1.718, Global test accuracy: 74.70
Round  43, Train loss: 1.614, Test loss: 1.595, Test accuracy: 86.98
Round  43, Global train loss: 1.614, Global test loss: 1.711, Global test accuracy: 75.88
Round  44, Train loss: 1.604, Test loss: 1.595, Test accuracy: 86.94
Round  44, Global train loss: 1.604, Global test loss: 1.696, Global test accuracy: 77.22
Round  45, Train loss: 1.550, Test loss: 1.595, Test accuracy: 86.92
Round  45, Global train loss: 1.550, Global test loss: 1.678, Global test accuracy: 78.86
Round  46, Train loss: 1.582, Test loss: 1.594, Test accuracy: 86.98
Round  46, Global train loss: 1.582, Global test loss: 1.682, Global test accuracy: 78.20
Round  47, Train loss: 1.580, Test loss: 1.595, Test accuracy: 87.00
Round  47, Global train loss: 1.580, Global test loss: 1.724, Global test accuracy: 73.58
Round  48, Train loss: 1.616, Test loss: 1.595, Test accuracy: 86.98
Round  48, Global train loss: 1.616, Global test loss: 1.659, Global test accuracy: 80.22
Round  49, Train loss: 1.691, Test loss: 1.595, Test accuracy: 87.08
Round  49, Global train loss: 1.691, Global test loss: 1.644, Global test accuracy: 82.74
Round  50, Train loss: 1.707, Test loss: 1.594, Test accuracy: 87.10
Round  50, Global train loss: 1.707, Global test loss: 1.697, Global test accuracy: 76.50
Round  51, Train loss: 1.536, Test loss: 1.594, Test accuracy: 87.04
Round  51, Global train loss: 1.536, Global test loss: 1.654, Global test accuracy: 81.56
Round  52, Train loss: 1.676, Test loss: 1.595, Test accuracy: 87.00
Round  52, Global train loss: 1.676, Global test loss: 1.652, Global test accuracy: 81.94
Round  53, Train loss: 1.678, Test loss: 1.594, Test accuracy: 87.00
Round  53, Global train loss: 1.678, Global test loss: 1.683, Global test accuracy: 78.38
Round  54, Train loss: 1.604, Test loss: 1.593, Test accuracy: 87.04
Round  54, Global train loss: 1.604, Global test loss: 1.642, Global test accuracy: 82.66
Round  55, Train loss: 1.544, Test loss: 1.593, Test accuracy: 86.96
Round  55, Global train loss: 1.544, Global test loss: 1.647, Global test accuracy: 82.32
Round  56, Train loss: 1.606, Test loss: 1.594, Test accuracy: 86.94
Round  56, Global train loss: 1.606, Global test loss: 1.689, Global test accuracy: 77.64
Round  57, Train loss: 1.532, Test loss: 1.593, Test accuracy: 86.98
Round  57, Global train loss: 1.532, Global test loss: 1.658, Global test accuracy: 80.86
Round  58, Train loss: 1.674, Test loss: 1.594, Test accuracy: 86.92
Round  58, Global train loss: 1.674, Global test loss: 1.643, Global test accuracy: 82.78
Round  59, Train loss: 1.596, Test loss: 1.594, Test accuracy: 86.98
Round  59, Global train loss: 1.596, Global test loss: 1.640, Global test accuracy: 82.90
Round  60, Train loss: 1.533, Test loss: 1.594, Test accuracy: 87.02
Round  60, Global train loss: 1.533, Global test loss: 1.664, Global test accuracy: 80.48
Round  61, Train loss: 1.539, Test loss: 1.594, Test accuracy: 86.98
Round  61, Global train loss: 1.539, Global test loss: 1.638, Global test accuracy: 83.16
Round  62, Train loss: 1.547, Test loss: 1.595, Test accuracy: 86.92
Round  62, Global train loss: 1.547, Global test loss: 1.646, Global test accuracy: 82.38
Round  63, Train loss: 1.543, Test loss: 1.594, Test accuracy: 86.94
Round  63, Global train loss: 1.543, Global test loss: 1.653, Global test accuracy: 81.42
Round  64, Train loss: 1.478, Test loss: 1.594, Test accuracy: 86.90
Round  64, Global train loss: 1.478, Global test loss: 1.663, Global test accuracy: 80.62
Round  65, Train loss: 1.475, Test loss: 1.594, Test accuracy: 86.96
Round  65, Global train loss: 1.475, Global test loss: 1.647, Global test accuracy: 81.94
Round  66, Train loss: 1.592, Test loss: 1.593, Test accuracy: 87.00
Round  66, Global train loss: 1.592, Global test loss: 1.637, Global test accuracy: 83.16
Round  67, Train loss: 1.543, Test loss: 1.593, Test accuracy: 86.98
Round  67, Global train loss: 1.543, Global test loss: 1.630, Global test accuracy: 83.54
Round  68, Train loss: 1.634, Test loss: 1.593, Test accuracy: 87.06
Round  68, Global train loss: 1.634, Global test loss: 1.654, Global test accuracy: 81.08
Round  69, Train loss: 1.529, Test loss: 1.593, Test accuracy: 87.00
Round  69, Global train loss: 1.529, Global test loss: 1.634, Global test accuracy: 83.28
Round  70, Train loss: 1.698, Test loss: 1.592, Test accuracy: 87.08
Round  70, Global train loss: 1.698, Global test loss: 1.649, Global test accuracy: 81.64
Round  71, Train loss: 1.691, Test loss: 1.591, Test accuracy: 87.16
Round  71, Global train loss: 1.691, Global test loss: 1.640, Global test accuracy: 82.76
Round  72, Train loss: 1.623, Test loss: 1.592, Test accuracy: 87.10
Round  72, Global train loss: 1.623, Global test loss: 1.638, Global test accuracy: 82.88
Round  73, Train loss: 1.530, Test loss: 1.591, Test accuracy: 87.12
Round  73, Global train loss: 1.530, Global test loss: 1.661, Global test accuracy: 80.38
Round  74, Train loss: 1.540, Test loss: 1.591, Test accuracy: 87.14
Round  74, Global train loss: 1.540, Global test loss: 1.632, Global test accuracy: 83.56
Round  75, Train loss: 1.660, Test loss: 1.591, Test accuracy: 87.12
Round  75, Global train loss: 1.660, Global test loss: 1.644, Global test accuracy: 82.26
Round  76, Train loss: 1.690, Test loss: 1.592, Test accuracy: 87.06
Round  76, Global train loss: 1.690, Global test loss: 1.635, Global test accuracy: 83.08
Round  77, Train loss: 1.598, Test loss: 1.592, Test accuracy: 87.00
Round  77, Global train loss: 1.598, Global test loss: 1.635, Global test accuracy: 83.26
Round  78, Train loss: 1.597, Test loss: 1.592, Test accuracy: 86.94
Round  78, Global train loss: 1.597, Global test loss: 1.647, Global test accuracy: 82.04
Round  79, Train loss: 1.539, Test loss: 1.592, Test accuracy: 87.00
Round  79, Global train loss: 1.539, Global test loss: 1.643, Global test accuracy: 82.40
Round  80, Train loss: 1.604, Test loss: 1.592, Test accuracy: 87.04
Round  80, Global train loss: 1.604, Global test loss: 1.657, Global test accuracy: 80.64
Round  81, Train loss: 1.602, Test loss: 1.591, Test accuracy: 87.14
Round  81, Global train loss: 1.602, Global test loss: 1.659, Global test accuracy: 80.78
Round  82, Train loss: 1.540, Test loss: 1.591, Test accuracy: 87.16
Round  82, Global train loss: 1.540, Global test loss: 1.663, Global test accuracy: 80.24
Round  83, Train loss: 1.527, Test loss: 1.592, Test accuracy: 87.10
Round  83, Global train loss: 1.527, Global test loss: 1.640, Global test accuracy: 82.52
Round  84, Train loss: 1.539, Test loss: 1.592, Test accuracy: 87.10
Round  84, Global train loss: 1.539, Global test loss: 1.650, Global test accuracy: 81.40
Round  85, Train loss: 1.628, Test loss: 1.591, Test accuracy: 87.16
Round  85, Global train loss: 1.628, Global test loss: 1.647, Global test accuracy: 82.16
Round  86, Train loss: 1.602, Test loss: 1.592, Test accuracy: 87.08
Round  86, Global train loss: 1.602, Global test loss: 1.635, Global test accuracy: 83.08
Round  87, Train loss: 1.539, Test loss: 1.593, Test accuracy: 87.02
Round  87, Global train loss: 1.539, Global test loss: 1.636, Global test accuracy: 83.04
Round  88, Train loss: 1.472, Test loss: 1.592, Test accuracy: 87.06
Round  88, Global train loss: 1.472, Global test loss: 1.625, Global test accuracy: 84.00
Round  89, Train loss: 1.628, Test loss: 1.592, Test accuracy: 87.08
Round  89, Global train loss: 1.628, Global test loss: 1.638, Global test accuracy: 82.80
Round  90, Train loss: 1.538, Test loss: 1.593, Test accuracy: 87.02
Round  90, Global train loss: 1.538, Global test loss: 1.626, Global test accuracy: 84.32
Round  91, Train loss: 1.537, Test loss: 1.593, Test accuracy: 86.98
Round  91, Global train loss: 1.537, Global test loss: 1.631, Global test accuracy: 83.50
Round  92, Train loss: 1.656, Test loss: 1.591, Test accuracy: 87.04
Round  92, Global train loss: 1.656, Global test loss: 1.635, Global test accuracy: 83.24
Round  93, Train loss: 1.622, Test loss: 1.591, Test accuracy: 87.06
Round  93, Global train loss: 1.622, Global test loss: 1.631, Global test accuracy: 83.50
Round  94, Train loss: 1.536, Test loss: 1.591, Test accuracy: 87.10
Round  94, Global train loss: 1.536, Global test loss: 1.633, Global test accuracy: 83.34
Round  95, Train loss: 1.471, Test loss: 1.591, Test accuracy: 87.10
Round  95, Global train loss: 1.471, Global test loss: 1.624, Global test accuracy: 84.16/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 1.538, Test loss: 1.591, Test accuracy: 87.12
Round  96, Global train loss: 1.538, Global test loss: 1.644, Global test accuracy: 82.14
Round  97, Train loss: 1.565, Test loss: 1.591, Test accuracy: 87.08
Round  97, Global train loss: 1.565, Global test loss: 1.625, Global test accuracy: 84.22
Round  98, Train loss: 1.601, Test loss: 1.590, Test accuracy: 87.20
Round  98, Global train loss: 1.601, Global test loss: 1.640, Global test accuracy: 82.90
Round  99, Train loss: 1.601, Test loss: 1.591, Test accuracy: 87.10
Round  99, Global train loss: 1.601, Global test loss: 1.646, Global test accuracy: 82.12
Final Round, Train loss: 1.593, Test loss: 1.591, Test accuracy: 87.02
Final Round, Global train loss: 1.593, Global test loss: 1.646, Global test accuracy: 82.12
Average accuracy final 10 rounds: 87.08 

Average global accuracy final 10 rounds: 83.344 

850.1084384918213
[1.3063759803771973, 2.6127519607543945, 3.876681327819824, 5.140610694885254, 6.287345886230469, 7.434081077575684, 8.580571174621582, 9.72706127166748, 10.892766952514648, 12.058472633361816, 13.194204092025757, 14.329935550689697, 15.524028062820435, 16.718120574951172, 17.90787982940674, 19.097639083862305, 20.228814125061035, 21.359989166259766, 22.494381427764893, 23.62877368927002, 24.875498294830322, 26.122222900390625, 27.257492780685425, 28.392762660980225, 29.55025005340576, 30.7077374458313, 31.963568925857544, 33.21940040588379, 34.528334617614746, 35.8372688293457, 37.10245728492737, 38.36764574050903, 39.60495114326477, 40.84225654602051, 42.40485668182373, 43.96745681762695, 45.23966455459595, 46.51187229156494, 47.827468156814575, 49.14306402206421, 50.338452100753784, 51.53384017944336, 52.66348910331726, 53.79313802719116, 54.99979519844055, 56.20645236968994, 57.47224164009094, 58.73803091049194, 60.070581674575806, 61.40313243865967, 62.652125120162964, 63.90111780166626, 65.07967591285706, 66.25823402404785, 67.44528937339783, 68.6323447227478, 69.84997940063477, 71.06761407852173, 72.32315683364868, 73.57869958877563, 74.67287492752075, 75.76705026626587, 77.03110551834106, 78.29516077041626, 79.54481387138367, 80.79446697235107, 82.04783582687378, 83.30120468139648, 84.53446531295776, 85.76772594451904, 86.9748740196228, 88.18202209472656, 89.29914331436157, 90.41626453399658, 91.56132411956787, 92.70638370513916, 93.89611530303955, 95.08584690093994, 96.35668158531189, 97.62751626968384, 98.79487943649292, 99.962242603302, 101.23976111412048, 102.51727962493896, 103.70217251777649, 104.88706541061401, 106.1061019897461, 107.32513856887817, 108.53525972366333, 109.74538087844849, 110.8714165687561, 111.99745225906372, 113.11383080482483, 114.23020935058594, 115.43501472473145, 116.63982009887695, 118.02108478546143, 119.4023494720459, 120.60506868362427, 121.80778789520264, 123.0437228679657, 124.27965784072876, 125.5207211971283, 126.76178455352783, 128.03508520126343, 129.30838584899902, 130.46766448020935, 131.62694311141968, 132.99674797058105, 134.36655282974243, 135.97170782089233, 137.57686281204224, 139.16667342185974, 140.75648403167725, 142.14168238639832, 143.52688074111938, 144.68146300315857, 145.83604526519775, 147.2183132171631, 148.60058116912842, 149.97444534301758, 151.34830951690674, 152.55778741836548, 153.76726531982422, 154.7972617149353, 155.8272581100464, 157.12372493743896, 158.42019176483154, 159.74018168449402, 161.0601716041565, 162.20001077651978, 163.33984994888306, 164.48187398910522, 165.6238980293274, 166.72747039794922, 167.83104276657104, 169.04622864723206, 170.26141452789307, 171.37234783172607, 172.48328113555908, 173.55390453338623, 174.62452793121338, 175.787677526474, 176.95082712173462, 178.0683228969574, 179.18581867218018, 180.32327485084534, 181.4607310295105, 182.51643061637878, 183.57213020324707, 184.89844584465027, 186.22476148605347, 187.40167808532715, 188.57859468460083, 189.69981336593628, 190.82103204727173, 191.98212432861328, 193.14321660995483, 194.2588450908661, 195.37447357177734, 196.44752740859985, 197.52058124542236, 198.5760042667389, 199.63142728805542, 200.7931559085846, 201.95488452911377, 203.09951329231262, 204.24414205551147, 205.46513319015503, 206.68612432479858, 207.79546451568604, 208.9048047065735, 210.0890212059021, 211.2732377052307, 212.70413374900818, 214.13502979278564, 215.53487181663513, 216.93471384048462, 218.17904591560364, 219.42337799072266, 220.59472584724426, 221.76607370376587, 222.92541551589966, 224.08475732803345, 225.26556301116943, 226.44636869430542, 227.56652927398682, 228.6866898536682, 229.86907148361206, 231.0514531135559, 232.2554965019226, 233.4595398902893, 234.67043471336365, 235.881329536438, 237.27890157699585, 238.6764736175537, 239.7593171596527, 240.8421607017517, 241.90282893180847, 242.96349716186523, 245.3245074748993, 247.68551778793335]
[9.78, 9.78, 27.6, 27.6, 43.64, 43.64, 54.04, 54.04, 58.66, 58.66, 68.24, 68.24, 72.98, 72.98, 73.18, 73.18, 75.14, 75.14, 77.22, 77.22, 78.04, 78.04, 78.08, 78.08, 79.96, 79.96, 79.86, 79.86, 80.0, 80.0, 80.22, 80.22, 80.52, 80.52, 80.66, 80.66, 80.64, 80.64, 80.56, 80.56, 80.68, 80.68, 80.4, 80.4, 80.94, 80.94, 80.96, 80.96, 82.72, 82.72, 84.52, 84.52, 84.88, 84.88, 84.88, 84.88, 84.64, 84.64, 84.52, 84.52, 86.46, 86.46, 86.54, 86.54, 86.7, 86.7, 86.66, 86.66, 86.76, 86.76, 86.74, 86.74, 86.66, 86.66, 86.64, 86.64, 86.64, 86.64, 86.76, 86.76, 86.84, 86.84, 86.72, 86.72, 86.84, 86.84, 86.98, 86.98, 86.94, 86.94, 86.92, 86.92, 86.98, 86.98, 87.0, 87.0, 86.98, 86.98, 87.08, 87.08, 87.1, 87.1, 87.04, 87.04, 87.0, 87.0, 87.0, 87.0, 87.04, 87.04, 86.96, 86.96, 86.94, 86.94, 86.98, 86.98, 86.92, 86.92, 86.98, 86.98, 87.02, 87.02, 86.98, 86.98, 86.92, 86.92, 86.94, 86.94, 86.9, 86.9, 86.96, 86.96, 87.0, 87.0, 86.98, 86.98, 87.06, 87.06, 87.0, 87.0, 87.08, 87.08, 87.16, 87.16, 87.1, 87.1, 87.12, 87.12, 87.14, 87.14, 87.12, 87.12, 87.06, 87.06, 87.0, 87.0, 86.94, 86.94, 87.0, 87.0, 87.04, 87.04, 87.14, 87.14, 87.16, 87.16, 87.1, 87.1, 87.1, 87.1, 87.16, 87.16, 87.08, 87.08, 87.02, 87.02, 87.06, 87.06, 87.08, 87.08, 87.02, 87.02, 86.98, 86.98, 87.04, 87.04, 87.06, 87.06, 87.1, 87.1, 87.1, 87.1, 87.12, 87.12, 87.08, 87.08, 87.2, 87.2, 87.1, 87.1, 87.02, 87.02]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 7, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.317, Test loss: 2.299, Test accuracy: 28.26
Round   0, Global train loss: 2.317, Global test loss: 2.299, Global test accuracy: 27.20
Round   1, Train loss: 2.293, Test loss: 2.291, Test accuracy: 23.64
Round   1, Global train loss: 2.293, Global test loss: 2.292, Global test accuracy: 23.58
Round   2, Train loss: 2.264, Test loss: 2.262, Test accuracy: 21.60
Round   2, Global train loss: 2.264, Global test loss: 2.266, Global test accuracy: 22.60
Round   3, Train loss: 2.227, Test loss: 2.209, Test accuracy: 36.94
Round   3, Global train loss: 2.227, Global test loss: 2.227, Global test accuracy: 34.96
Round   4, Train loss: 2.117, Test loss: 2.104, Test accuracy: 42.82
Round   4, Global train loss: 2.117, Global test loss: 2.120, Global test accuracy: 37.44
Round   5, Train loss: 2.032, Test loss: 2.027, Test accuracy: 56.60
Round   5, Global train loss: 2.032, Global test loss: 2.083, Global test accuracy: 48.48
Round   6, Train loss: 1.954, Test loss: 1.950, Test accuracy: 56.52
Round   6, Global train loss: 1.954, Global test loss: 2.044, Global test accuracy: 40.84
Round   7, Train loss: 1.972, Test loss: 1.899, Test accuracy: 65.42
Round   7, Global train loss: 1.972, Global test loss: 2.050, Global test accuracy: 46.32
Round   8, Train loss: 1.966, Test loss: 1.872, Test accuracy: 67.56
Round   8, Global train loss: 1.966, Global test loss: 2.063, Global test accuracy: 39.24
Round   9, Train loss: 1.804, Test loss: 1.826, Test accuracy: 72.26
Round   9, Global train loss: 1.804, Global test loss: 2.014, Global test accuracy: 45.32
Round  10, Train loss: 1.761, Test loss: 1.758, Test accuracy: 77.70
Round  10, Global train loss: 1.761, Global test loss: 2.021, Global test accuracy: 44.54
Round  11, Train loss: 1.656, Test loss: 1.725, Test accuracy: 82.00
Round  11, Global train loss: 1.656, Global test loss: 1.947, Global test accuracy: 56.36
Round  12, Train loss: 1.630, Test loss: 1.689, Test accuracy: 83.76
Round  12, Global train loss: 1.630, Global test loss: 1.946, Global test accuracy: 48.04
Round  13, Train loss: 1.682, Test loss: 1.656, Test accuracy: 86.22
Round  13, Global train loss: 1.682, Global test loss: 1.887, Global test accuracy: 61.46
Round  14, Train loss: 1.725, Test loss: 1.639, Test accuracy: 87.58
Round  14, Global train loss: 1.725, Global test loss: 1.852, Global test accuracy: 66.40
Round  15, Train loss: 1.716, Test loss: 1.628, Test accuracy: 89.46
Round  15, Global train loss: 1.716, Global test loss: 1.989, Global test accuracy: 46.56
Round  16, Train loss: 1.671, Test loss: 1.623, Test accuracy: 89.52
Round  16, Global train loss: 1.671, Global test loss: 1.851, Global test accuracy: 67.76
Round  17, Train loss: 1.693, Test loss: 1.606, Test accuracy: 91.20
Round  17, Global train loss: 1.693, Global test loss: 1.896, Global test accuracy: 59.54
Round  18, Train loss: 1.583, Test loss: 1.609, Test accuracy: 91.52
Round  18, Global train loss: 1.583, Global test loss: 1.903, Global test accuracy: 57.92
Round  19, Train loss: 1.694, Test loss: 1.603, Test accuracy: 91.62
Round  19, Global train loss: 1.694, Global test loss: 1.882, Global test accuracy: 60.30
Round  20, Train loss: 1.671, Test loss: 1.601, Test accuracy: 92.00
Round  20, Global train loss: 1.671, Global test loss: 1.840, Global test accuracy: 66.00
Round  21, Train loss: 1.676, Test loss: 1.595, Test accuracy: 92.28
Round  21, Global train loss: 1.676, Global test loss: 1.938, Global test accuracy: 56.88
Round  22, Train loss: 1.673, Test loss: 1.575, Test accuracy: 94.36
Round  22, Global train loss: 1.673, Global test loss: 1.961, Global test accuracy: 48.10
Round  23, Train loss: 1.560, Test loss: 1.569, Test accuracy: 94.12
Round  23, Global train loss: 1.560, Global test loss: 1.858, Global test accuracy: 64.10
Round  24, Train loss: 1.663, Test loss: 1.560, Test accuracy: 94.50
Round  24, Global train loss: 1.663, Global test loss: 1.895, Global test accuracy: 56.48
Round  25, Train loss: 1.555, Test loss: 1.554, Test accuracy: 94.54
Round  25, Global train loss: 1.555, Global test loss: 1.881, Global test accuracy: 58.54
Round  26, Train loss: 1.521, Test loss: 1.555, Test accuracy: 94.34
Round  26, Global train loss: 1.521, Global test loss: 1.848, Global test accuracy: 64.02
Round  27, Train loss: 1.639, Test loss: 1.557, Test accuracy: 94.16
Round  27, Global train loss: 1.639, Global test loss: 1.821, Global test accuracy: 66.24
Round  28, Train loss: 1.519, Test loss: 1.552, Test accuracy: 94.52
Round  28, Global train loss: 1.519, Global test loss: 1.797, Global test accuracy: 75.36
Round  29, Train loss: 1.512, Test loss: 1.552, Test accuracy: 94.42
Round  29, Global train loss: 1.512, Global test loss: 1.844, Global test accuracy: 63.68
Round  30, Train loss: 1.629, Test loss: 1.550, Test accuracy: 94.62
Round  30, Global train loss: 1.629, Global test loss: 1.901, Global test accuracy: 56.98
Round  31, Train loss: 1.616, Test loss: 1.551, Test accuracy: 94.94
Round  31, Global train loss: 1.616, Global test loss: 1.917, Global test accuracy: 53.44
Round  32, Train loss: 1.635, Test loss: 1.551, Test accuracy: 94.88
Round  32, Global train loss: 1.635, Global test loss: 1.836, Global test accuracy: 65.80
Round  33, Train loss: 1.613, Test loss: 1.551, Test accuracy: 94.90
Round  33, Global train loss: 1.613, Global test loss: 1.913, Global test accuracy: 56.62
Round  34, Train loss: 1.608, Test loss: 1.551, Test accuracy: 94.88
Round  34, Global train loss: 1.608, Global test loss: 1.838, Global test accuracy: 70.94
Round  35, Train loss: 1.637, Test loss: 1.551, Test accuracy: 94.74
Round  35, Global train loss: 1.637, Global test loss: 1.844, Global test accuracy: 66.66
Round  36, Train loss: 1.746, Test loss: 1.546, Test accuracy: 95.12
Round  36, Global train loss: 1.746, Global test loss: 1.893, Global test accuracy: 60.30
Round  37, Train loss: 1.626, Test loss: 1.548, Test accuracy: 95.08
Round  37, Global train loss: 1.626, Global test loss: 1.840, Global test accuracy: 67.22
Round  38, Train loss: 1.707, Test loss: 1.551, Test accuracy: 95.14
Round  38, Global train loss: 1.707, Global test loss: 1.878, Global test accuracy: 64.32
Round  39, Train loss: 1.527, Test loss: 1.541, Test accuracy: 95.08
Round  39, Global train loss: 1.527, Global test loss: 1.876, Global test accuracy: 58.26
Round  40, Train loss: 1.707, Test loss: 1.545, Test accuracy: 95.14
Round  40, Global train loss: 1.707, Global test loss: 1.842, Global test accuracy: 66.86
Round  41, Train loss: 1.534, Test loss: 1.540, Test accuracy: 95.20
Round  41, Global train loss: 1.534, Global test loss: 1.833, Global test accuracy: 66.58
Round  42, Train loss: 1.642, Test loss: 1.538, Test accuracy: 95.06
Round  42, Global train loss: 1.642, Global test loss: 1.860, Global test accuracy: 65.14
Round  43, Train loss: 1.644, Test loss: 1.540, Test accuracy: 95.02
Round  43, Global train loss: 1.644, Global test loss: 1.852, Global test accuracy: 63.30
Round  44, Train loss: 1.617, Test loss: 1.547, Test accuracy: 94.74
Round  44, Global train loss: 1.617, Global test loss: 1.934, Global test accuracy: 49.94
Round  45, Train loss: 1.614, Test loss: 1.541, Test accuracy: 94.96
Round  45, Global train loss: 1.614, Global test loss: 1.819, Global test accuracy: 68.04
Round  46, Train loss: 1.508, Test loss: 1.534, Test accuracy: 95.24
Round  46, Global train loss: 1.508, Global test loss: 1.888, Global test accuracy: 56.42
Round  47, Train loss: 1.502, Test loss: 1.532, Test accuracy: 95.20
Round  47, Global train loss: 1.502, Global test loss: 1.907, Global test accuracy: 53.44
Round  48, Train loss: 1.540, Test loss: 1.530, Test accuracy: 95.36
Round  48, Global train loss: 1.540, Global test loss: 1.810, Global test accuracy: 69.58
Round  49, Train loss: 1.595, Test loss: 1.532, Test accuracy: 95.40
Round  49, Global train loss: 1.595, Global test loss: 1.829, Global test accuracy: 72.34
Round  50, Train loss: 1.512, Test loss: 1.531, Test accuracy: 95.44
Round  50, Global train loss: 1.512, Global test loss: 1.846, Global test accuracy: 63.00
Round  51, Train loss: 1.722, Test loss: 1.533, Test accuracy: 95.50
Round  51, Global train loss: 1.722, Global test loss: 1.884, Global test accuracy: 62.08
Round  52, Train loss: 1.513, Test loss: 1.532, Test accuracy: 95.42
Round  52, Global train loss: 1.513, Global test loss: 1.863, Global test accuracy: 63.86
Round  53, Train loss: 1.540, Test loss: 1.529, Test accuracy: 95.32
Round  53, Global train loss: 1.540, Global test loss: 1.807, Global test accuracy: 70.18
Round  54, Train loss: 1.604, Test loss: 1.530, Test accuracy: 95.56
Round  54, Global train loss: 1.604, Global test loss: 1.804, Global test accuracy: 71.04
Round  55, Train loss: 1.493, Test loss: 1.527, Test accuracy: 95.44
Round  55, Global train loss: 1.493, Global test loss: 1.824, Global test accuracy: 66.86
Round  56, Train loss: 1.511, Test loss: 1.525, Test accuracy: 95.48
Round  56, Global train loss: 1.511, Global test loss: 1.851, Global test accuracy: 62.62
Round  57, Train loss: 1.715, Test loss: 1.531, Test accuracy: 95.38
Round  57, Global train loss: 1.715, Global test loss: 1.890, Global test accuracy: 61.38
Round  58, Train loss: 1.509, Test loss: 1.528, Test accuracy: 95.62
Round  58, Global train loss: 1.509, Global test loss: 1.812, Global test accuracy: 73.48
Round  59, Train loss: 1.584, Test loss: 1.528, Test accuracy: 95.50
Round  59, Global train loss: 1.584, Global test loss: 1.887, Global test accuracy: 57.74
Round  60, Train loss: 1.584, Test loss: 1.528, Test accuracy: 95.40
Round  60, Global train loss: 1.584, Global test loss: 1.913, Global test accuracy: 57.62
Round  61, Train loss: 1.587, Test loss: 1.531, Test accuracy: 95.38
Round  61, Global train loss: 1.587, Global test loss: 1.927, Global test accuracy: 54.46
Round  62, Train loss: 1.598, Test loss: 1.531, Test accuracy: 95.38
Round  62, Global train loss: 1.598, Global test loss: 1.823, Global test accuracy: 67.58
Round  63, Train loss: 1.512, Test loss: 1.529, Test accuracy: 95.30
Round  63, Global train loss: 1.512, Global test loss: 1.811, Global test accuracy: 67.98
Round  64, Train loss: 1.488, Test loss: 1.526, Test accuracy: 95.22
Round  64, Global train loss: 1.488, Global test loss: 1.879, Global test accuracy: 57.92
Round  65, Train loss: 1.502, Test loss: 1.525, Test accuracy: 95.28
Round  65, Global train loss: 1.502, Global test loss: 1.764, Global test accuracy: 75.08
Round  66, Train loss: 1.600, Test loss: 1.525, Test accuracy: 95.40
Round  66, Global train loss: 1.600, Global test loss: 1.838, Global test accuracy: 64.38
Round  67, Train loss: 1.493, Test loss: 1.526, Test accuracy: 95.56
Round  67, Global train loss: 1.493, Global test loss: 1.762, Global test accuracy: 75.24
Round  68, Train loss: 1.503, Test loss: 1.525, Test accuracy: 95.46
Round  68, Global train loss: 1.503, Global test loss: 1.843, Global test accuracy: 62.70
Round  69, Train loss: 1.598, Test loss: 1.524, Test accuracy: 95.76
Round  69, Global train loss: 1.598, Global test loss: 1.796, Global test accuracy: 71.16
Round  70, Train loss: 1.524, Test loss: 1.524, Test accuracy: 95.70
Round  70, Global train loss: 1.524, Global test loss: 1.816, Global test accuracy: 64.08
Round  71, Train loss: 1.579, Test loss: 1.524, Test accuracy: 95.76
Round  71, Global train loss: 1.579, Global test loss: 1.761, Global test accuracy: 76.40
Round  72, Train loss: 1.678, Test loss: 1.528, Test accuracy: 95.46
Round  72, Global train loss: 1.678, Global test loss: 1.852, Global test accuracy: 63.52
Round  73, Train loss: 1.677, Test loss: 1.532, Test accuracy: 95.42
Round  73, Global train loss: 1.677, Global test loss: 1.844, Global test accuracy: 67.96
Round  74, Train loss: 1.484, Test loss: 1.527, Test accuracy: 95.48
Round  74, Global train loss: 1.484, Global test loss: 1.826, Global test accuracy: 66.74
Round  75, Train loss: 1.612, Test loss: 1.528, Test accuracy: 95.52
Round  75, Global train loss: 1.612, Global test loss: 1.940, Global test accuracy: 54.34
Round  76, Train loss: 1.572, Test loss: 1.529, Test accuracy: 95.48
Round  76, Global train loss: 1.572, Global test loss: 1.770, Global test accuracy: 75.00
Round  77, Train loss: 1.569, Test loss: 1.528, Test accuracy: 95.52
Round  77, Global train loss: 1.569, Global test loss: 1.772, Global test accuracy: 74.70
Round  78, Train loss: 1.668, Test loss: 1.534, Test accuracy: 95.18
Round  78, Global train loss: 1.668, Global test loss: 1.865, Global test accuracy: 65.62
Round  79, Train loss: 1.500, Test loss: 1.529, Test accuracy: 95.54
Round  79, Global train loss: 1.500, Global test loss: 1.815, Global test accuracy: 67.80
Round  80, Train loss: 1.577, Test loss: 1.529, Test accuracy: 95.58
Round  80, Global train loss: 1.577, Global test loss: 1.808, Global test accuracy: 69.62
Round  81, Train loss: 1.614, Test loss: 1.531, Test accuracy: 95.60
Round  81, Global train loss: 1.614, Global test loss: 1.874, Global test accuracy: 59.12
Round  82, Train loss: 1.500, Test loss: 1.528, Test accuracy: 95.70
Round  82, Global train loss: 1.500, Global test loss: 1.859, Global test accuracy: 60.46
Round  83, Train loss: 1.683, Test loss: 1.534, Test accuracy: 95.42
Round  83, Global train loss: 1.683, Global test loss: 1.904, Global test accuracy: 56.22
Round  84, Train loss: 1.495, Test loss: 1.531, Test accuracy: 95.60
Round  84, Global train loss: 1.495, Global test loss: 1.861, Global test accuracy: 59.82
Round  85, Train loss: 1.495, Test loss: 1.529, Test accuracy: 95.44
Round  85, Global train loss: 1.495, Global test loss: 1.874, Global test accuracy: 58.80
Round  86, Train loss: 1.520, Test loss: 1.528, Test accuracy: 95.50
Round  86, Global train loss: 1.520, Global test loss: 1.818, Global test accuracy: 68.62
Round  87, Train loss: 1.499, Test loss: 1.524, Test accuracy: 95.78
Round  87, Global train loss: 1.499, Global test loss: 1.810, Global test accuracy: 68.16
Round  88, Train loss: 1.496, Test loss: 1.523, Test accuracy: 95.84
Round  88, Global train loss: 1.496, Global test loss: 1.818, Global test accuracy: 69.70
Round  89, Train loss: 1.493, Test loss: 1.522, Test accuracy: 95.84
Round  89, Global train loss: 1.493, Global test loss: 1.869, Global test accuracy: 60.06
Round  90, Train loss: 1.574, Test loss: 1.524, Test accuracy: 95.72
Round  90, Global train loss: 1.574, Global test loss: 1.818, Global test accuracy: 66.40
Round  91, Train loss: 1.476, Test loss: 1.522, Test accuracy: 95.70
Round  91, Global train loss: 1.476, Global test loss: 1.800, Global test accuracy: 71.20
Round  92, Train loss: 1.602, Test loss: 1.526, Test accuracy: 95.40
Round  92, Global train loss: 1.602, Global test loss: 1.936, Global test accuracy: 54.70/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 1.658, Test loss: 1.533, Test accuracy: 95.06
Round  93, Global train loss: 1.658, Global test loss: 1.869, Global test accuracy: 61.66
Round  94, Train loss: 1.572, Test loss: 1.531, Test accuracy: 95.22
Round  94, Global train loss: 1.572, Global test loss: 1.827, Global test accuracy: 67.28
Round  95, Train loss: 1.494, Test loss: 1.528, Test accuracy: 95.38
Round  95, Global train loss: 1.494, Global test loss: 1.830, Global test accuracy: 67.82
Round  96, Train loss: 1.491, Test loss: 1.524, Test accuracy: 95.70
Round  96, Global train loss: 1.491, Global test loss: 1.861, Global test accuracy: 59.48
Round  97, Train loss: 1.575, Test loss: 1.528, Test accuracy: 95.28
Round  97, Global train loss: 1.575, Global test loss: 1.871, Global test accuracy: 61.76
Round  98, Train loss: 1.587, Test loss: 1.531, Test accuracy: 95.04
Round  98, Global train loss: 1.587, Global test loss: 1.905, Global test accuracy: 57.40
Round  99, Train loss: 1.586, Test loss: 1.531, Test accuracy: 95.18
Round  99, Global train loss: 1.586, Global test loss: 1.901, Global test accuracy: 59.18
Final Round, Train loss: 1.533, Test loss: 1.526, Test accuracy: 95.32
Final Round, Global train loss: 1.533, Global test loss: 1.901, Global test accuracy: 59.18
Average accuracy final 10 rounds: 95.36800000000002
698.1715512275696
[1.5103707313537598, 3.006086587905884, 4.3523478507995605, 5.726576566696167, 6.944901466369629, 8.350234270095825, 9.753960132598877, 11.042995929718018, 12.296627759933472, 13.563425064086914, 14.853911638259888, 16.17489528656006, 17.609029293060303, 18.87289261817932, 20.16907024383545, 21.574707508087158, 22.874902963638306, 24.2454571723938, 25.764790296554565, 27.008602619171143, 28.506338834762573, 29.864049196243286, 31.329023122787476, 32.662055015563965, 33.960869789123535, 35.300213098526, 36.694002866744995, 38.150949001312256, 39.38308572769165, 40.58201813697815, 41.96269416809082, 43.26648259162903, 44.48386311531067, 45.814698457717896, 47.29552626609802, 48.98655843734741, 50.274943590164185, 51.488118410110474, 52.760077238082886, 54.027345418930054, 55.3714017868042, 56.640466928482056, 57.94876837730408, 59.334644079208374, 60.47410750389099, 61.946301221847534, 63.23931956291199, 64.57497644424438, 65.80120849609375, 67.02881717681885, 68.20086812973022, 69.40682482719421, 70.70792937278748, 71.9307131767273, 73.09190917015076, 74.43282580375671, 75.66993403434753, 76.91826033592224, 78.23920059204102, 79.52356958389282, 80.82310581207275, 82.05065321922302, 83.47691202163696, 84.89411091804504, 86.11185789108276, 87.30681586265564, 88.43578910827637, 89.59142327308655, 90.83883452415466, 92.09591317176819, 93.36636471748352, 94.59557557106018, 95.91640782356262, 97.27338743209839, 98.50060296058655, 99.81560611724854, 101.0320348739624, 102.33888077735901, 103.62757444381714, 104.85886216163635, 106.09344792366028, 107.39345622062683, 108.76250314712524, 110.27263474464417, 111.50829696655273, 112.66932797431946, 113.89828896522522, 115.08657217025757, 116.51811814308167, 117.79767632484436, 119.13555192947388, 120.31213903427124, 121.46200132369995, 122.76363897323608, 124.09679841995239, 125.41543698310852, 126.68067002296448, 127.89564371109009, 129.21325206756592, 130.50802993774414, 132.6467411518097]
[28.26, 23.64, 21.6, 36.94, 42.82, 56.6, 56.52, 65.42, 67.56, 72.26, 77.7, 82.0, 83.76, 86.22, 87.58, 89.46, 89.52, 91.2, 91.52, 91.62, 92.0, 92.28, 94.36, 94.12, 94.5, 94.54, 94.34, 94.16, 94.52, 94.42, 94.62, 94.94, 94.88, 94.9, 94.88, 94.74, 95.12, 95.08, 95.14, 95.08, 95.14, 95.2, 95.06, 95.02, 94.74, 94.96, 95.24, 95.2, 95.36, 95.4, 95.44, 95.5, 95.42, 95.32, 95.56, 95.44, 95.48, 95.38, 95.62, 95.5, 95.4, 95.38, 95.38, 95.3, 95.22, 95.28, 95.4, 95.56, 95.46, 95.76, 95.7, 95.76, 95.46, 95.42, 95.48, 95.52, 95.48, 95.52, 95.18, 95.54, 95.58, 95.6, 95.7, 95.42, 95.6, 95.44, 95.5, 95.78, 95.84, 95.84, 95.72, 95.7, 95.4, 95.06, 95.22, 95.38, 95.7, 95.28, 95.04, 95.18, 95.32]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.315, Test loss: 2.294, Test accuracy: 26.26
Round   0, Global train loss: 2.315, Global test loss: 2.297, Global test accuracy: 26.44
Round   1, Train loss: 2.279, Test loss: 2.267, Test accuracy: 27.04
Round   1, Global train loss: 2.279, Global test loss: 2.278, Global test accuracy: 27.00
Round   2, Train loss: 2.226, Test loss: 2.202, Test accuracy: 36.62
Round   2, Global train loss: 2.226, Global test loss: 2.234, Global test accuracy: 29.82
Round   3, Train loss: 2.153, Test loss: 2.101, Test accuracy: 41.96
Round   3, Global train loss: 2.153, Global test loss: 2.156, Global test accuracy: 30.34
Round   4, Train loss: 2.035, Test loss: 1.976, Test accuracy: 53.96
Round   4, Global train loss: 2.035, Global test loss: 2.073, Global test accuracy: 40.56
Round   5, Train loss: 1.934, Test loss: 1.876, Test accuracy: 62.76
Round   5, Global train loss: 1.934, Global test loss: 2.023, Global test accuracy: 47.58
Round   6, Train loss: 1.861, Test loss: 1.809, Test accuracy: 70.26
Round   6, Global train loss: 1.861, Global test loss: 1.985, Global test accuracy: 55.14
Round   7, Train loss: 1.815, Test loss: 1.765, Test accuracy: 73.92
Round   7, Global train loss: 1.815, Global test loss: 1.954, Global test accuracy: 60.08
Round   8, Train loss: 1.778, Test loss: 1.722, Test accuracy: 81.46
Round   8, Global train loss: 1.778, Global test loss: 1.924, Global test accuracy: 64.92
Round   9, Train loss: 1.743, Test loss: 1.683, Test accuracy: 84.46
Round   9, Global train loss: 1.743, Global test loss: 1.896, Global test accuracy: 69.34
Round  10, Train loss: 1.626, Test loss: 1.642, Test accuracy: 88.72
Round  10, Global train loss: 1.626, Global test loss: 2.023, Global test accuracy: 42.76
Round  11, Train loss: 1.554, Test loss: 1.626, Test accuracy: 89.10
Round  11, Global train loss: 1.554, Global test loss: 1.950, Global test accuracy: 51.78
Round  12, Train loss: 1.573, Test loss: 1.616, Test accuracy: 89.36
Round  12, Global train loss: 1.573, Global test loss: 1.961, Global test accuracy: 47.42
Round  13, Train loss: 1.628, Test loss: 1.609, Test accuracy: 89.54
Round  13, Global train loss: 1.628, Global test loss: 1.909, Global test accuracy: 58.26
Round  14, Train loss: 1.608, Test loss: 1.592, Test accuracy: 91.44
Round  14, Global train loss: 1.608, Global test loss: 1.851, Global test accuracy: 63.56
Round  15, Train loss: 1.560, Test loss: 1.580, Test accuracy: 93.04
Round  15, Global train loss: 1.560, Global test loss: 2.005, Global test accuracy: 42.72
Round  16, Train loss: 1.529, Test loss: 1.573, Test accuracy: 93.18
Round  16, Global train loss: 1.529, Global test loss: 1.846, Global test accuracy: 66.34
Round  17, Train loss: 1.567, Test loss: 1.566, Test accuracy: 93.80
Round  17, Global train loss: 1.567, Global test loss: 1.867, Global test accuracy: 62.40
Round  18, Train loss: 1.562, Test loss: 1.565, Test accuracy: 93.74
Round  18, Global train loss: 1.562, Global test loss: 1.889, Global test accuracy: 61.36
Round  19, Train loss: 1.561, Test loss: 1.558, Test accuracy: 94.02
Round  19, Global train loss: 1.561, Global test loss: 1.876, Global test accuracy: 59.78
Round  20, Train loss: 1.531, Test loss: 1.557, Test accuracy: 93.84
Round  20, Global train loss: 1.531, Global test loss: 1.847, Global test accuracy: 62.44
Round  21, Train loss: 1.590, Test loss: 1.557, Test accuracy: 94.12
Round  21, Global train loss: 1.590, Global test loss: 1.926, Global test accuracy: 54.80
Round  22, Train loss: 1.590, Test loss: 1.557, Test accuracy: 94.02
Round  22, Global train loss: 1.590, Global test loss: 1.965, Global test accuracy: 46.76
Round  23, Train loss: 1.546, Test loss: 1.555, Test accuracy: 94.24
Round  23, Global train loss: 1.546, Global test loss: 1.877, Global test accuracy: 59.46
Round  24, Train loss: 1.559, Test loss: 1.551, Test accuracy: 94.26
Round  24, Global train loss: 1.559, Global test loss: 1.875, Global test accuracy: 60.50
Round  25, Train loss: 1.562, Test loss: 1.546, Test accuracy: 94.60
Round  25, Global train loss: 1.562, Global test loss: 1.902, Global test accuracy: 53.94
Round  26, Train loss: 1.515, Test loss: 1.546, Test accuracy: 94.68
Round  26, Global train loss: 1.515, Global test loss: 1.848, Global test accuracy: 64.08
Round  27, Train loss: 1.522, Test loss: 1.544, Test accuracy: 94.70
Round  27, Global train loss: 1.522, Global test loss: 1.814, Global test accuracy: 67.08
Round  28, Train loss: 1.533, Test loss: 1.544, Test accuracy: 94.52
Round  28, Global train loss: 1.533, Global test loss: 1.842, Global test accuracy: 65.20
Round  29, Train loss: 1.506, Test loss: 1.546, Test accuracy: 94.54
Round  29, Global train loss: 1.506, Global test loss: 1.842, Global test accuracy: 63.98
Round  30, Train loss: 1.575, Test loss: 1.545, Test accuracy: 94.38
Round  30, Global train loss: 1.575, Global test loss: 1.928, Global test accuracy: 52.44
Round  31, Train loss: 1.566, Test loss: 1.550, Test accuracy: 94.20
Round  31, Global train loss: 1.566, Global test loss: 1.947, Global test accuracy: 51.06
Round  32, Train loss: 1.560, Test loss: 1.551, Test accuracy: 93.98
Round  32, Global train loss: 1.560, Global test loss: 1.829, Global test accuracy: 66.40
Round  33, Train loss: 1.539, Test loss: 1.547, Test accuracy: 94.46
Round  33, Global train loss: 1.539, Global test loss: 1.897, Global test accuracy: 59.06
Round  34, Train loss: 1.532, Test loss: 1.545, Test accuracy: 94.60
Round  34, Global train loss: 1.532, Global test loss: 1.837, Global test accuracy: 69.80
Round  35, Train loss: 1.525, Test loss: 1.542, Test accuracy: 94.68
Round  35, Global train loss: 1.525, Global test loss: 1.828, Global test accuracy: 68.68
Round  36, Train loss: 1.557, Test loss: 1.537, Test accuracy: 94.86
Round  36, Global train loss: 1.557, Global test loss: 1.868, Global test accuracy: 63.12
Round  37, Train loss: 1.514, Test loss: 1.537, Test accuracy: 94.88
Round  37, Global train loss: 1.514, Global test loss: 1.816, Global test accuracy: 69.34
Round  38, Train loss: 1.526, Test loss: 1.537, Test accuracy: 94.82
Round  38, Global train loss: 1.526, Global test loss: 1.827, Global test accuracy: 71.26
Round  39, Train loss: 1.514, Test loss: 1.533, Test accuracy: 94.98
Round  39, Global train loss: 1.514, Global test loss: 1.863, Global test accuracy: 59.86
Round  40, Train loss: 1.526, Test loss: 1.534, Test accuracy: 94.76
Round  40, Global train loss: 1.526, Global test loss: 1.821, Global test accuracy: 66.12
Round  41, Train loss: 1.530, Test loss: 1.533, Test accuracy: 94.76
Round  41, Global train loss: 1.530, Global test loss: 1.855, Global test accuracy: 64.82
Round  42, Train loss: 1.509, Test loss: 1.531, Test accuracy: 95.00
Round  42, Global train loss: 1.509, Global test loss: 1.861, Global test accuracy: 63.50
Round  43, Train loss: 1.513, Test loss: 1.532, Test accuracy: 94.92
Round  43, Global train loss: 1.513, Global test loss: 1.843, Global test accuracy: 63.02
Round  44, Train loss: 1.563, Test loss: 1.537, Test accuracy: 94.70
Round  44, Global train loss: 1.563, Global test loss: 1.935, Global test accuracy: 50.44
Round  45, Train loss: 1.532, Test loss: 1.535, Test accuracy: 95.00
Round  45, Global train loss: 1.532, Global test loss: 1.793, Global test accuracy: 73.24
Round  46, Train loss: 1.531, Test loss: 1.531, Test accuracy: 95.24
Round  46, Global train loss: 1.531, Global test loss: 1.895, Global test accuracy: 54.88
Round  47, Train loss: 1.497, Test loss: 1.530, Test accuracy: 95.12
Round  47, Global train loss: 1.497, Global test loss: 1.919, Global test accuracy: 51.86
Round  48, Train loss: 1.515, Test loss: 1.526, Test accuracy: 95.36
Round  48, Global train loss: 1.515, Global test loss: 1.795, Global test accuracy: 74.44
Round  49, Train loss: 1.519, Test loss: 1.528, Test accuracy: 95.22
Round  49, Global train loss: 1.519, Global test loss: 1.818, Global test accuracy: 71.48
Round  50, Train loss: 1.507, Test loss: 1.528, Test accuracy: 95.24
Round  50, Global train loss: 1.507, Global test loss: 1.858, Global test accuracy: 60.54
Round  51, Train loss: 1.520, Test loss: 1.528, Test accuracy: 95.12
Round  51, Global train loss: 1.520, Global test loss: 1.846, Global test accuracy: 66.42
Round  52, Train loss: 1.508, Test loss: 1.528, Test accuracy: 95.20
Round  52, Global train loss: 1.508, Global test loss: 1.845, Global test accuracy: 67.02
Round  53, Train loss: 1.514, Test loss: 1.526, Test accuracy: 95.40
Round  53, Global train loss: 1.514, Global test loss: 1.796, Global test accuracy: 70.02
Round  54, Train loss: 1.532, Test loss: 1.524, Test accuracy: 95.42
Round  54, Global train loss: 1.532, Global test loss: 1.789, Global test accuracy: 72.02
Round  55, Train loss: 1.489, Test loss: 1.524, Test accuracy: 95.44
Round  55, Global train loss: 1.489, Global test loss: 1.810, Global test accuracy: 69.12
Round  56, Train loss: 1.487, Test loss: 1.521, Test accuracy: 95.50
Round  56, Global train loss: 1.487, Global test loss: 1.853, Global test accuracy: 62.52
Round  57, Train loss: 1.513, Test loss: 1.523, Test accuracy: 95.46
Round  57, Global train loss: 1.513, Global test loss: 1.837, Global test accuracy: 67.44
Round  58, Train loss: 1.503, Test loss: 1.522, Test accuracy: 95.58
Round  58, Global train loss: 1.503, Global test loss: 1.790, Global test accuracy: 72.18
Round  59, Train loss: 1.512, Test loss: 1.523, Test accuracy: 95.50
Round  59, Global train loss: 1.512, Global test loss: 1.887, Global test accuracy: 58.90
Round  60, Train loss: 1.515, Test loss: 1.523, Test accuracy: 95.46
Round  60, Global train loss: 1.515, Global test loss: 1.866, Global test accuracy: 63.42
Round  61, Train loss: 1.481, Test loss: 1.524, Test accuracy: 95.36
Round  61, Global train loss: 1.481, Global test loss: 1.930, Global test accuracy: 54.06
Round  62, Train loss: 1.519, Test loss: 1.523, Test accuracy: 95.42
Round  62, Global train loss: 1.519, Global test loss: 1.790, Global test accuracy: 73.12
Round  63, Train loss: 1.515, Test loss: 1.524, Test accuracy: 95.44
Round  63, Global train loss: 1.515, Global test loss: 1.801, Global test accuracy: 67.84
Round  64, Train loss: 1.515, Test loss: 1.523, Test accuracy: 95.70
Round  64, Global train loss: 1.515, Global test loss: 1.884, Global test accuracy: 56.94
Round  65, Train loss: 1.481, Test loss: 1.522, Test accuracy: 95.72
Round  65, Global train loss: 1.481, Global test loss: 1.768, Global test accuracy: 74.68
Round  66, Train loss: 1.508, Test loss: 1.521, Test accuracy: 95.72
Round  66, Global train loss: 1.508, Global test loss: 1.823, Global test accuracy: 66.52
Round  67, Train loss: 1.514, Test loss: 1.521, Test accuracy: 95.72
Round  67, Global train loss: 1.514, Global test loss: 1.770, Global test accuracy: 75.88
Round  68, Train loss: 1.481, Test loss: 1.521, Test accuracy: 95.78
Round  68, Global train loss: 1.481, Global test loss: 1.842, Global test accuracy: 62.26
Round  69, Train loss: 1.507, Test loss: 1.520, Test accuracy: 95.76
Round  69, Global train loss: 1.507, Global test loss: 1.793, Global test accuracy: 72.54
Round  70, Train loss: 1.498, Test loss: 1.521, Test accuracy: 95.68
Round  70, Global train loss: 1.498, Global test loss: 1.792, Global test accuracy: 70.46
Round  71, Train loss: 1.509, Test loss: 1.519, Test accuracy: 95.68
Round  71, Global train loss: 1.509, Global test loss: 1.766, Global test accuracy: 73.80
Round  72, Train loss: 1.506, Test loss: 1.520, Test accuracy: 95.72
Round  72, Global train loss: 1.506, Global test loss: 1.819, Global test accuracy: 66.58
Round  73, Train loss: 1.537, Test loss: 1.522, Test accuracy: 95.70
Round  73, Global train loss: 1.537, Global test loss: 1.813, Global test accuracy: 69.42
Round  74, Train loss: 1.481, Test loss: 1.519, Test accuracy: 95.78
Round  74, Global train loss: 1.481, Global test loss: 1.803, Global test accuracy: 70.78
Round  75, Train loss: 1.523, Test loss: 1.519, Test accuracy: 95.88
Round  75, Global train loss: 1.523, Global test loss: 1.896, Global test accuracy: 60.76
Round  76, Train loss: 1.507, Test loss: 1.518, Test accuracy: 95.96
Round  76, Global train loss: 1.507, Global test loss: 1.764, Global test accuracy: 74.92
Round  77, Train loss: 1.504, Test loss: 1.518, Test accuracy: 95.90
Round  77, Global train loss: 1.504, Global test loss: 1.764, Global test accuracy: 74.86
Round  78, Train loss: 1.503, Test loss: 1.519, Test accuracy: 96.12
Round  78, Global train loss: 1.503, Global test loss: 1.830, Global test accuracy: 67.90
Round  79, Train loss: 1.478, Test loss: 1.518, Test accuracy: 95.96
Round  79, Global train loss: 1.478, Global test loss: 1.817, Global test accuracy: 66.06
Round  80, Train loss: 1.483, Test loss: 1.517, Test accuracy: 95.98
Round  80, Global train loss: 1.483, Global test loss: 1.716, Global test accuracy: 81.78
Round  81, Train loss: 1.483, Test loss: 1.516, Test accuracy: 95.92
Round  81, Global train loss: 1.483, Global test loss: 1.713, Global test accuracy: 81.96
Round  82, Train loss: 1.482, Test loss: 1.516, Test accuracy: 95.84
Round  82, Global train loss: 1.482, Global test loss: 1.711, Global test accuracy: 81.94
Round  83, Train loss: 1.482, Test loss: 1.516, Test accuracy: 95.90
Round  83, Global train loss: 1.482, Global test loss: 1.710, Global test accuracy: 81.98
Round  84, Train loss: 1.481, Test loss: 1.516, Test accuracy: 95.94
Round  84, Global train loss: 1.481, Global test loss: 1.708, Global test accuracy: 82.18
Round  85, Train loss: 1.481, Test loss: 1.515, Test accuracy: 95.90
Round  85, Global train loss: 1.481, Global test loss: 1.707, Global test accuracy: 82.32
Round  86, Train loss: 1.481, Test loss: 1.515, Test accuracy: 95.88
Round  86, Global train loss: 1.481, Global test loss: 1.707, Global test accuracy: 82.28
Round  87, Train loss: 1.480, Test loss: 1.515, Test accuracy: 95.94
Round  87, Global train loss: 1.480, Global test loss: 1.706, Global test accuracy: 82.34
Round  88, Train loss: 1.480, Test loss: 1.515, Test accuracy: 95.94
Round  88, Global train loss: 1.480, Global test loss: 1.707, Global test accuracy: 82.16
Round  89, Train loss: 1.480, Test loss: 1.515, Test accuracy: 95.92
Round  89, Global train loss: 1.480, Global test loss: 1.706, Global test accuracy: 82.30
Round  90, Train loss: 1.480, Test loss: 1.515, Test accuracy: 95.90
Round  90, Global train loss: 1.480, Global test loss: 1.705, Global test accuracy: 82.44
Round  91, Train loss: 1.480, Test loss: 1.514, Test accuracy: 95.96
Round  91, Global train loss: 1.480, Global test loss: 1.706, Global test accuracy: 82.24/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.479, Test loss: 1.514, Test accuracy: 95.98
Round  92, Global train loss: 1.479, Global test loss: 1.705, Global test accuracy: 82.36
Round  93, Train loss: 1.479, Test loss: 1.514, Test accuracy: 95.96
Round  93, Global train loss: 1.479, Global test loss: 1.706, Global test accuracy: 82.18
Round  94, Train loss: 1.479, Test loss: 1.514, Test accuracy: 95.96
Round  94, Global train loss: 1.479, Global test loss: 1.706, Global test accuracy: 82.24
Round  95, Train loss: 1.479, Test loss: 1.514, Test accuracy: 95.94
Round  95, Global train loss: 1.479, Global test loss: 1.706, Global test accuracy: 82.44
Round  96, Train loss: 1.479, Test loss: 1.514, Test accuracy: 95.92
Round  96, Global train loss: 1.479, Global test loss: 1.705, Global test accuracy: 82.58
Round  97, Train loss: 1.478, Test loss: 1.514, Test accuracy: 95.94
Round  97, Global train loss: 1.478, Global test loss: 1.705, Global test accuracy: 82.54
Round  98, Train loss: 1.478, Test loss: 1.514, Test accuracy: 95.96
Round  98, Global train loss: 1.478, Global test loss: 1.704, Global test accuracy: 82.72
Round  99, Train loss: 1.495, Test loss: 1.515, Test accuracy: 95.90
Round  99, Global train loss: 1.495, Global test loss: 1.686, Global test accuracy: 88.16
Final Round, Train loss: 1.531, Test loss: 1.515, Test accuracy: 95.82
Final Round, Global train loss: 1.531, Global test loss: 1.686, Global test accuracy: 88.16
Average accuracy final 10 rounds: 95.94200000000001
1336.200558423996
[1.5665972232818604, 3.028477907180786, 4.596852779388428, 6.221347808837891, 7.759201288223267, 9.168123006820679, 10.579499244689941, 11.92751145362854, 13.436176300048828, 15.124202728271484, 20.14538335800171, 28.080621004104614, 29.44012689590454, 37.43429517745972, 45.05251097679138, 53.09300184249878, 60.70484137535095, 68.63252902030945, 69.93895769119263, 71.47523021697998, 72.84635043144226, 80.65643787384033, 89.04460644721985, 91.06153774261475, 99.01458096504211, 106.54048538208008, 107.86974620819092, 109.1790771484375, 117.03653931617737, 118.56276607513428, 126.40519499778748, 134.3423113822937, 141.94436502456665, 150.26475882530212, 158.62522220611572, 159.9834439754486, 168.10869479179382, 169.60425782203674, 177.54608058929443, 179.20977115631104, 187.580153465271, 195.67106294631958, 197.0771346092224, 198.42994832992554, 206.52460932731628, 214.74940061569214, 222.4539396762848, 223.9770269393921, 225.47204875946045, 233.53447222709656, 234.96181058883667, 242.97395038604736, 244.35757780075073, 245.88136219978333, 254.16772270202637, 255.50959730148315, 256.9178125858307, 264.9604215621948, 266.32771921157837, 273.87284231185913, 281.7548098564148, 283.1679358482361, 291.5831072330475, 300.3031735420227, 308.24315071105957, 309.5843620300293, 317.4569184780121, 325.3749771118164, 326.8293194770813, 334.90809965133667, 336.33148288726807, 344.6614031791687, 352.51286792755127, 360.3854639530182, 361.84960412979126, 369.8739411830902, 378.2975950241089, 386.1482400894165, 394.443252325058, 396.01564598083496, 397.45376324653625, 398.88257598876953, 400.3924050331116, 401.81883001327515, 403.42760467529297, 404.9032127857208, 406.3420994281769, 407.8939242362976, 409.35292649269104, 410.76832723617554, 412.2858188152313, 413.8336877822876, 415.3630497455597, 416.7406346797943, 418.19025468826294, 419.80589175224304, 421.21203327178955, 422.67938327789307, 424.1794672012329, 432.0728795528412, 439.98824858665466]
[26.26, 27.04, 36.62, 41.96, 53.96, 62.76, 70.26, 73.92, 81.46, 84.46, 88.72, 89.1, 89.36, 89.54, 91.44, 93.04, 93.18, 93.8, 93.74, 94.02, 93.84, 94.12, 94.02, 94.24, 94.26, 94.6, 94.68, 94.7, 94.52, 94.54, 94.38, 94.2, 93.98, 94.46, 94.6, 94.68, 94.86, 94.88, 94.82, 94.98, 94.76, 94.76, 95.0, 94.92, 94.7, 95.0, 95.24, 95.12, 95.36, 95.22, 95.24, 95.12, 95.2, 95.4, 95.42, 95.44, 95.5, 95.46, 95.58, 95.5, 95.46, 95.36, 95.42, 95.44, 95.7, 95.72, 95.72, 95.72, 95.78, 95.76, 95.68, 95.68, 95.72, 95.7, 95.78, 95.88, 95.96, 95.9, 96.12, 95.96, 95.98, 95.92, 95.84, 95.9, 95.94, 95.9, 95.88, 95.94, 95.94, 95.92, 95.9, 95.96, 95.98, 95.96, 95.96, 95.94, 95.92, 95.94, 95.96, 95.9, 95.82]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.291, Test loss: 2.290, Test accuracy: 16.68
Round   0, Global train loss: 2.291, Global test loss: 2.296, Global test accuracy: 8.60
Round   1, Train loss: 2.261, Test loss: 2.250, Test accuracy: 34.02
Round   1, Global train loss: 2.261, Global test loss: 2.268, Global test accuracy: 35.70
Round   2, Train loss: 2.135, Test loss: 2.129, Test accuracy: 37.78
Round   2, Global train loss: 2.135, Global test loss: 2.128, Global test accuracy: 29.84
Round   3, Train loss: 1.981, Test loss: 2.061, Test accuracy: 45.00
Round   3, Global train loss: 1.981, Global test loss: 2.124, Global test accuracy: 34.20
Round   4, Train loss: 2.205, Test loss: 2.045, Test accuracy: 49.90
Round   4, Global train loss: 2.205, Global test loss: 2.269, Global test accuracy: 24.24
Round   5, Train loss: 1.863, Test loss: 1.995, Test accuracy: 53.14
Round   5, Global train loss: 1.863, Global test loss: 2.165, Global test accuracy: 27.40
Round   6, Train loss: 1.828, Test loss: 1.923, Test accuracy: 61.30
Round   6, Global train loss: 1.828, Global test loss: 2.073, Global test accuracy: 44.16
Round   7, Train loss: 1.664, Test loss: 1.867, Test accuracy: 66.70
Round   7, Global train loss: 1.664, Global test loss: 2.050, Global test accuracy: 46.58
Round   8, Train loss: 1.962, Test loss: 1.856, Test accuracy: 64.96
Round   8, Global train loss: 1.962, Global test loss: 2.112, Global test accuracy: 36.58
Round   9, Train loss: 1.943, Test loss: 1.843, Test accuracy: 66.06
Round   9, Global train loss: 1.943, Global test loss: 2.091, Global test accuracy: 39.88
Round  10, Train loss: 1.648, Test loss: 1.779, Test accuracy: 72.48
Round  10, Global train loss: 1.648, Global test loss: 2.043, Global test accuracy: 43.28
Round  11, Train loss: 1.735, Test loss: 1.773, Test accuracy: 72.88
Round  11, Global train loss: 1.735, Global test loss: 2.055, Global test accuracy: 46.50
Round  12, Train loss: 1.617, Test loss: 1.749, Test accuracy: 75.18
Round  12, Global train loss: 1.617, Global test loss: 2.033, Global test accuracy: 45.22
Round  13, Train loss: 1.738, Test loss: 1.722, Test accuracy: 76.80
Round  13, Global train loss: 1.738, Global test loss: 2.039, Global test accuracy: 44.88
Round  14, Train loss: 1.693, Test loss: 1.690, Test accuracy: 80.00
Round  14, Global train loss: 1.693, Global test loss: 1.950, Global test accuracy: 50.90
Round  15, Train loss: 1.567, Test loss: 1.686, Test accuracy: 80.26
Round  15, Global train loss: 1.567, Global test loss: 1.991, Global test accuracy: 54.30
Round  16, Train loss: 1.550, Test loss: 1.684, Test accuracy: 80.26
Round  16, Global train loss: 1.550, Global test loss: 1.989, Global test accuracy: 47.88
Round  17, Train loss: 1.484, Test loss: 1.683, Test accuracy: 80.28
Round  17, Global train loss: 1.484, Global test loss: 1.944, Global test accuracy: 53.94
Round  18, Train loss: 1.896, Test loss: 1.679, Test accuracy: 79.90
Round  18, Global train loss: 1.896, Global test loss: 2.136, Global test accuracy: 30.90
Round  19, Train loss: 1.577, Test loss: 1.660, Test accuracy: 81.94
Round  19, Global train loss: 1.577, Global test loss: 2.092, Global test accuracy: 34.10
Round  20, Train loss: 1.514, Test loss: 1.643, Test accuracy: 83.80
Round  20, Global train loss: 1.514, Global test loss: 1.973, Global test accuracy: 54.20
Round  21, Train loss: 1.681, Test loss: 1.640, Test accuracy: 83.86
Round  21, Global train loss: 1.681, Global test loss: 2.001, Global test accuracy: 56.64
Round  22, Train loss: 1.478, Test loss: 1.639, Test accuracy: 83.98
Round  22, Global train loss: 1.478, Global test loss: 2.157, Global test accuracy: 27.80
Round  23, Train loss: 1.655, Test loss: 1.643, Test accuracy: 83.34
Round  23, Global train loss: 1.655, Global test loss: 2.163, Global test accuracy: 29.04
Round  24, Train loss: 1.483, Test loss: 1.643, Test accuracy: 83.16
Round  24, Global train loss: 1.483, Global test loss: 2.157, Global test accuracy: 26.38
Round  25, Train loss: 1.540, Test loss: 1.642, Test accuracy: 83.20
Round  25, Global train loss: 1.540, Global test loss: 1.980, Global test accuracy: 47.82
Round  26, Train loss: 1.667, Test loss: 1.642, Test accuracy: 83.06
Round  26, Global train loss: 1.667, Global test loss: 2.084, Global test accuracy: 39.52
Round  27, Train loss: 1.470, Test loss: 1.642, Test accuracy: 83.04
Round  27, Global train loss: 1.470, Global test loss: 2.069, Global test accuracy: 37.96
Round  28, Train loss: 1.657, Test loss: 1.648, Test accuracy: 82.08
Round  28, Global train loss: 1.657, Global test loss: 2.060, Global test accuracy: 43.22
Round  29, Train loss: 1.480, Test loss: 1.646, Test accuracy: 82.18
Round  29, Global train loss: 1.480, Global test loss: 1.999, Global test accuracy: 46.62
Round  30, Train loss: 1.702, Test loss: 1.645, Test accuracy: 82.24
Round  30, Global train loss: 1.702, Global test loss: 2.069, Global test accuracy: 37.52
Round  31, Train loss: 1.477, Test loss: 1.645, Test accuracy: 82.30
Round  31, Global train loss: 1.477, Global test loss: 2.003, Global test accuracy: 48.20
Round  32, Train loss: 1.644, Test loss: 1.644, Test accuracy: 82.24
Round  32, Global train loss: 1.644, Global test loss: 2.035, Global test accuracy: 42.38
Round  33, Train loss: 1.473, Test loss: 1.643, Test accuracy: 82.22
Round  33, Global train loss: 1.473, Global test loss: 1.999, Global test accuracy: 46.60
Round  34, Train loss: 1.631, Test loss: 1.640, Test accuracy: 82.82
Round  34, Global train loss: 1.631, Global test loss: 2.003, Global test accuracy: 46.20
Round  35, Train loss: 1.621, Test loss: 1.646, Test accuracy: 81.96
Round  35, Global train loss: 1.621, Global test loss: 2.007, Global test accuracy: 43.62
Round  36, Train loss: 1.534, Test loss: 1.646, Test accuracy: 81.96
Round  36, Global train loss: 1.534, Global test loss: 2.098, Global test accuracy: 33.64
Round  37, Train loss: 1.472, Test loss: 1.646, Test accuracy: 81.96
Round  37, Global train loss: 1.472, Global test loss: 1.988, Global test accuracy: 46.76
Round  38, Train loss: 1.471, Test loss: 1.646, Test accuracy: 82.02
Round  38, Global train loss: 1.471, Global test loss: 1.974, Global test accuracy: 47.66
Round  39, Train loss: 1.609, Test loss: 1.647, Test accuracy: 81.88
Round  39, Global train loss: 1.609, Global test loss: 2.031, Global test accuracy: 43.22
Round  40, Train loss: 1.607, Test loss: 1.649, Test accuracy: 81.56
Round  40, Global train loss: 1.607, Global test loss: 2.071, Global test accuracy: 40.02
Round  41, Train loss: 1.471, Test loss: 1.649, Test accuracy: 81.54
Round  41, Global train loss: 1.471, Global test loss: 2.005, Global test accuracy: 44.78
Round  42, Train loss: 1.534, Test loss: 1.649, Test accuracy: 81.44
Round  42, Global train loss: 1.534, Global test loss: 2.019, Global test accuracy: 43.14
Round  43, Train loss: 1.689, Test loss: 1.648, Test accuracy: 81.58
Round  43, Global train loss: 1.689, Global test loss: 2.077, Global test accuracy: 38.30
Round  44, Train loss: 1.601, Test loss: 1.654, Test accuracy: 80.86
Round  44, Global train loss: 1.601, Global test loss: 2.091, Global test accuracy: 36.48
Round  45, Train loss: 1.592, Test loss: 1.654, Test accuracy: 81.14
Round  45, Global train loss: 1.592, Global test loss: 2.040, Global test accuracy: 43.24
Round  46, Train loss: 1.533, Test loss: 1.654, Test accuracy: 81.12
Round  46, Global train loss: 1.533, Global test loss: 2.079, Global test accuracy: 37.70
Round  47, Train loss: 1.468, Test loss: 1.653, Test accuracy: 81.14
Round  47, Global train loss: 1.468, Global test loss: 1.942, Global test accuracy: 51.50
Round  48, Train loss: 1.618, Test loss: 1.653, Test accuracy: 81.34
Round  48, Global train loss: 1.618, Global test loss: 2.221, Global test accuracy: 21.26
Round  49, Train loss: 1.533, Test loss: 1.653, Test accuracy: 81.38
Round  49, Global train loss: 1.533, Global test loss: 2.078, Global test accuracy: 37.80
Round  50, Train loss: 1.533, Test loss: 1.653, Test accuracy: 81.36
Round  50, Global train loss: 1.533, Global test loss: 2.076, Global test accuracy: 37.90
Round  51, Train loss: 1.708, Test loss: 1.649, Test accuracy: 81.64
Round  51, Global train loss: 1.708, Global test loss: 2.051, Global test accuracy: 47.16
Round  52, Train loss: 1.472, Test loss: 1.649, Test accuracy: 81.66
Round  52, Global train loss: 1.472, Global test loss: 2.073, Global test accuracy: 38.02
Round  53, Train loss: 1.584, Test loss: 1.649, Test accuracy: 81.54
Round  53, Global train loss: 1.584, Global test loss: 2.098, Global test accuracy: 36.02
Round  54, Train loss: 1.620, Test loss: 1.652, Test accuracy: 81.32
Round  54, Global train loss: 1.620, Global test loss: 1.948, Global test accuracy: 52.24
Round  55, Train loss: 1.544, Test loss: 1.649, Test accuracy: 81.52
Round  55, Global train loss: 1.544, Global test loss: 2.007, Global test accuracy: 43.88
Round  56, Train loss: 1.576, Test loss: 1.649, Test accuracy: 81.62
Round  56, Global train loss: 1.576, Global test loss: 2.055, Global test accuracy: 41.98
Round  57, Train loss: 1.472, Test loss: 1.648, Test accuracy: 81.62
Round  57, Global train loss: 1.472, Global test loss: 1.983, Global test accuracy: 50.10
Round  58, Train loss: 1.531, Test loss: 1.648, Test accuracy: 81.64
Round  58, Global train loss: 1.531, Global test loss: 1.969, Global test accuracy: 48.94
Round  59, Train loss: 1.633, Test loss: 1.649, Test accuracy: 81.52
Round  59, Global train loss: 1.633, Global test loss: 2.068, Global test accuracy: 38.82
Round  60, Train loss: 1.472, Test loss: 1.649, Test accuracy: 81.52
Round  60, Global train loss: 1.472, Global test loss: 2.022, Global test accuracy: 45.28
Round  61, Train loss: 1.565, Test loss: 1.650, Test accuracy: 81.40
Round  61, Global train loss: 1.565, Global test loss: 2.000, Global test accuracy: 47.74
Round  62, Train loss: 1.592, Test loss: 1.640, Test accuracy: 82.52
Round  62, Global train loss: 1.592, Global test loss: 1.994, Global test accuracy: 47.12
Round  63, Train loss: 1.532, Test loss: 1.639, Test accuracy: 82.66
Round  63, Global train loss: 1.532, Global test loss: 1.987, Global test accuracy: 47.86
Round  64, Train loss: 1.473, Test loss: 1.639, Test accuracy: 82.68
Round  64, Global train loss: 1.473, Global test loss: 1.921, Global test accuracy: 57.64
Round  65, Train loss: 1.530, Test loss: 1.640, Test accuracy: 82.50
Round  65, Global train loss: 1.530, Global test loss: 1.995, Global test accuracy: 45.94
Round  66, Train loss: 1.471, Test loss: 1.640, Test accuracy: 82.46
Round  66, Global train loss: 1.471, Global test loss: 2.103, Global test accuracy: 33.98
Round  67, Train loss: 1.564, Test loss: 1.640, Test accuracy: 82.40
Round  67, Global train loss: 1.564, Global test loss: 2.051, Global test accuracy: 41.82
Round  68, Train loss: 1.529, Test loss: 1.638, Test accuracy: 82.56
Round  68, Global train loss: 1.529, Global test loss: 2.040, Global test accuracy: 41.64
Round  69, Train loss: 1.561, Test loss: 1.637, Test accuracy: 82.72
Round  69, Global train loss: 1.561, Global test loss: 2.081, Global test accuracy: 37.58
Round  70, Train loss: 1.618, Test loss: 1.638, Test accuracy: 82.60
Round  70, Global train loss: 1.618, Global test loss: 2.025, Global test accuracy: 44.30
Round  71, Train loss: 1.482, Test loss: 1.634, Test accuracy: 82.92
Round  71, Global train loss: 1.482, Global test loss: 1.941, Global test accuracy: 51.14
Round  72, Train loss: 1.565, Test loss: 1.633, Test accuracy: 82.98
Round  72, Global train loss: 1.565, Global test loss: 2.065, Global test accuracy: 40.32
Round  73, Train loss: 1.469, Test loss: 1.632, Test accuracy: 82.98
Round  73, Global train loss: 1.469, Global test loss: 1.995, Global test accuracy: 45.52
Round  74, Train loss: 1.555, Test loss: 1.631, Test accuracy: 83.14
Round  74, Global train loss: 1.555, Global test loss: 2.052, Global test accuracy: 41.54
Round  75, Train loss: 1.528, Test loss: 1.630, Test accuracy: 83.28
Round  75, Global train loss: 1.528, Global test loss: 2.004, Global test accuracy: 44.32
Round  76, Train loss: 1.471, Test loss: 1.630, Test accuracy: 83.30
Round  76, Global train loss: 1.471, Global test loss: 2.036, Global test accuracy: 47.08
Round  77, Train loss: 1.524, Test loss: 1.630, Test accuracy: 83.26
Round  77, Global train loss: 1.524, Global test loss: 1.993, Global test accuracy: 46.06
Round  78, Train loss: 1.611, Test loss: 1.631, Test accuracy: 83.20
Round  78, Global train loss: 1.611, Global test loss: 2.052, Global test accuracy: 40.66
Round  79, Train loss: 1.472, Test loss: 1.631, Test accuracy: 83.18
Round  79, Global train loss: 1.472, Global test loss: 1.939, Global test accuracy: 50.66
Round  80, Train loss: 1.553, Test loss: 1.631, Test accuracy: 83.12
Round  80, Global train loss: 1.553, Global test loss: 2.147, Global test accuracy: 30.00
Round  81, Train loss: 1.523, Test loss: 1.631, Test accuracy: 83.12
Round  81, Global train loss: 1.523, Global test loss: 2.013, Global test accuracy: 44.56
Round  82, Train loss: 1.609, Test loss: 1.632, Test accuracy: 83.06
Round  82, Global train loss: 1.609, Global test loss: 2.117, Global test accuracy: 32.78
Round  83, Train loss: 1.522, Test loss: 1.631, Test accuracy: 83.04
Round  83, Global train loss: 1.522, Global test loss: 2.025, Global test accuracy: 43.26
Round  84, Train loss: 1.466, Test loss: 1.631, Test accuracy: 83.06
Round  84, Global train loss: 1.466, Global test loss: 2.006, Global test accuracy: 45.20
Round  85, Train loss: 1.606, Test loss: 1.635, Test accuracy: 82.64
Round  85, Global train loss: 1.606, Global test loss: 2.116, Global test accuracy: 33.26
Round  86, Train loss: 1.468, Test loss: 1.635, Test accuracy: 82.66
Round  86, Global train loss: 1.468, Global test loss: 1.936, Global test accuracy: 52.22
Round  87, Train loss: 1.467, Test loss: 1.635, Test accuracy: 82.66
Round  87, Global train loss: 1.467, Global test loss: 1.973, Global test accuracy: 48.02
Round  88, Train loss: 1.466, Test loss: 1.635, Test accuracy: 82.66
Round  88, Global train loss: 1.466, Global test loss: 1.983, Global test accuracy: 46.94
Round  89, Train loss: 1.468, Test loss: 1.635, Test accuracy: 82.68
Round  89, Global train loss: 1.468, Global test loss: 1.936, Global test accuracy: 52.20
Round  90, Train loss: 1.553, Test loss: 1.635, Test accuracy: 82.74
Round  90, Global train loss: 1.553, Global test loss: 2.136, Global test accuracy: 32.96
Round  91, Train loss: 1.553, Test loss: 1.635, Test accuracy: 82.70
Round  91, Global train loss: 1.553, Global test loss: 2.137, Global test accuracy: 32.82
Round  92, Train loss: 1.522, Test loss: 1.631, Test accuracy: 83.26
Round  92, Global train loss: 1.522, Global test loss: 2.002, Global test accuracy: 46.28
Round  93, Train loss: 1.466, Test loss: 1.631, Test accuracy: 83.26
Round  93, Global train loss: 1.466, Global test loss: 2.080, Global test accuracy: 36.70
Round  94, Train loss: 1.551, Test loss: 1.631, Test accuracy: 83.28
Round  94, Global train loss: 1.551, Global test loss: 2.058, Global test accuracy: 40.84
Round  95, Train loss: 1.551, Test loss: 1.631, Test accuracy: 83.30
Round  95, Global train loss: 1.551, Global test loss: 2.084, Global test accuracy: 36.24/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.551, Test loss: 1.631, Test accuracy: 83.22
Round  96, Global train loss: 1.551, Global test loss: 2.084, Global test accuracy: 36.30
Round  97, Train loss: 1.471, Test loss: 1.631, Test accuracy: 83.22
Round  97, Global train loss: 1.471, Global test loss: 2.013, Global test accuracy: 45.74
Round  98, Train loss: 1.526, Test loss: 1.632, Test accuracy: 82.96
Round  98, Global train loss: 1.526, Global test loss: 1.918, Global test accuracy: 57.42
Round  99, Train loss: 1.467, Test loss: 1.632, Test accuracy: 82.98
Round  99, Global train loss: 1.467, Global test loss: 2.069, Global test accuracy: 38.30
Final Round, Train loss: 1.509, Test loss: 1.631, Test accuracy: 83.26
Final Round, Global train loss: 1.509, Global test loss: 2.069, Global test accuracy: 38.30
Average accuracy final 10 rounds: 83.09200000000001 

Average global accuracy final 10 rounds: 40.35999999999999 

782.1158044338226
[1.2278363704681396, 2.4556727409362793, 3.471525192260742, 4.487377643585205, 5.771920919418335, 7.056464195251465, 8.075274467468262, 9.094084739685059, 10.096969604492188, 11.099854469299316, 12.064916372299194, 13.029978275299072, 14.079137802124023, 15.128297328948975, 16.079716682434082, 17.03113603591919, 18.057474374771118, 19.083812713623047, 20.238765716552734, 21.393718719482422, 22.47739315032959, 23.561067581176758, 24.687034845352173, 25.813002109527588, 26.878301858901978, 27.943601608276367, 29.014934301376343, 30.08626699447632, 31.104657411575317, 32.123047828674316, 33.19096255302429, 34.25887727737427, 35.270041704177856, 36.281206130981445, 37.55878281593323, 38.83635950088501, 39.8430962562561, 40.8498330116272, 41.91514730453491, 42.98046159744263, 44.02080202102661, 45.061142444610596, 46.07286858558655, 47.0845947265625, 48.20387554168701, 49.32315635681152, 50.39309048652649, 51.463024616241455, 52.46701002120972, 53.47099542617798, 54.52644157409668, 55.58188772201538, 56.63962244987488, 57.697357177734375, 58.80345869064331, 59.909560203552246, 60.99486494064331, 62.080169677734375, 63.207724809646606, 64.33527994155884, 65.32685089111328, 66.31842184066772, 67.44452619552612, 68.57063055038452, 69.64557313919067, 70.72051572799683, 71.79666662216187, 72.8728175163269, 74.35102820396423, 75.82923889160156, 76.94387221336365, 78.05850553512573, 79.10701942443848, 80.15553331375122, 81.19614124298096, 82.2367491722107, 83.2604010105133, 84.28405284881592, 85.29299283027649, 86.30193281173706, 87.33225893974304, 88.36258506774902, 89.51622486114502, 90.66986465454102, 91.68940854072571, 92.7089524269104, 93.75646805763245, 94.80398368835449, 95.97385287284851, 97.14372205734253, 98.30155086517334, 99.45937967300415, 100.4503333568573, 101.44128704071045, 102.34963202476501, 103.25797700881958, 104.19911694526672, 105.14025688171387, 106.18561673164368, 107.23097658157349, 108.25645995140076, 109.28194332122803, 110.39011526107788, 111.49828720092773, 112.69483089447021, 113.8913745880127, 114.96191358566284, 116.03245258331299, 117.131920337677, 118.23138809204102, 119.27524137496948, 120.31909465789795, 121.36616086959839, 122.41322708129883, 123.45140671730042, 124.489586353302, 125.5187304019928, 126.5478744506836, 127.66741132736206, 128.78694820404053, 129.94278526306152, 131.09862232208252, 132.11813235282898, 133.13764238357544, 134.17621207237244, 135.21478176116943, 136.2081093788147, 137.20143699645996, 138.2411391735077, 139.28084135055542, 140.35880064964294, 141.43675994873047, 142.4502124786377, 143.46366500854492, 144.51208591461182, 145.5605068206787, 146.56475591659546, 147.5690050125122, 148.65605688095093, 149.74310874938965, 150.7180438041687, 151.69297885894775, 152.8685827255249, 154.04418659210205, 155.07521414756775, 156.10624170303345, 157.26859951019287, 158.4309573173523, 159.5475537776947, 160.6641502380371, 161.6986849308014, 162.73321962356567, 163.87706875801086, 165.02091789245605, 166.04384660720825, 167.06677532196045, 168.14659190177917, 169.2264084815979, 170.42461919784546, 171.62282991409302, 172.66133379936218, 173.69983768463135, 174.61033272743225, 175.52082777023315, 176.51264667510986, 177.50446557998657, 178.4788420200348, 179.453218460083, 180.4051558971405, 181.357093334198, 182.397940158844, 183.43878698349, 184.4848117828369, 185.53083658218384, 186.63757348060608, 187.74431037902832, 188.8082230091095, 189.87213563919067, 190.80516004562378, 191.73818445205688, 192.8390109539032, 193.9398374557495, 195.04887318611145, 196.1579089164734, 197.2654266357422, 198.372944355011, 199.49197101593018, 200.61099767684937, 201.62096571922302, 202.63093376159668, 203.67106103897095, 204.71118831634521, 205.7543454170227, 206.7975025177002, 207.85371947288513, 208.90993642807007, 209.9377167224884, 210.96549701690674, 212.08196473121643, 213.19843244552612, 215.30377316474915, 217.40911388397217]
[16.68, 16.68, 34.02, 34.02, 37.78, 37.78, 45.0, 45.0, 49.9, 49.9, 53.14, 53.14, 61.3, 61.3, 66.7, 66.7, 64.96, 64.96, 66.06, 66.06, 72.48, 72.48, 72.88, 72.88, 75.18, 75.18, 76.8, 76.8, 80.0, 80.0, 80.26, 80.26, 80.26, 80.26, 80.28, 80.28, 79.9, 79.9, 81.94, 81.94, 83.8, 83.8, 83.86, 83.86, 83.98, 83.98, 83.34, 83.34, 83.16, 83.16, 83.2, 83.2, 83.06, 83.06, 83.04, 83.04, 82.08, 82.08, 82.18, 82.18, 82.24, 82.24, 82.3, 82.3, 82.24, 82.24, 82.22, 82.22, 82.82, 82.82, 81.96, 81.96, 81.96, 81.96, 81.96, 81.96, 82.02, 82.02, 81.88, 81.88, 81.56, 81.56, 81.54, 81.54, 81.44, 81.44, 81.58, 81.58, 80.86, 80.86, 81.14, 81.14, 81.12, 81.12, 81.14, 81.14, 81.34, 81.34, 81.38, 81.38, 81.36, 81.36, 81.64, 81.64, 81.66, 81.66, 81.54, 81.54, 81.32, 81.32, 81.52, 81.52, 81.62, 81.62, 81.62, 81.62, 81.64, 81.64, 81.52, 81.52, 81.52, 81.52, 81.4, 81.4, 82.52, 82.52, 82.66, 82.66, 82.68, 82.68, 82.5, 82.5, 82.46, 82.46, 82.4, 82.4, 82.56, 82.56, 82.72, 82.72, 82.6, 82.6, 82.92, 82.92, 82.98, 82.98, 82.98, 82.98, 83.14, 83.14, 83.28, 83.28, 83.3, 83.3, 83.26, 83.26, 83.2, 83.2, 83.18, 83.18, 83.12, 83.12, 83.12, 83.12, 83.06, 83.06, 83.04, 83.04, 83.06, 83.06, 82.64, 82.64, 82.66, 82.66, 82.66, 82.66, 82.66, 82.66, 82.68, 82.68, 82.74, 82.74, 82.7, 82.7, 83.26, 83.26, 83.26, 83.26, 83.28, 83.28, 83.3, 83.3, 83.22, 83.22, 83.22, 83.22, 82.96, 82.96, 82.98, 82.98, 83.26, 83.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.294, Test loss: 2.295, Test accuracy: 25.22
Round   0, Global train loss: 2.294, Global test loss: 2.299, Global test accuracy: 24.46
Round   1, Train loss: 2.275, Test loss: 2.254, Test accuracy: 31.10
Round   1, Global train loss: 2.275, Global test loss: 2.266, Global test accuracy: 29.68
Round   2, Train loss: 2.098, Test loss: 2.125, Test accuracy: 36.58
Round   2, Global train loss: 2.098, Global test loss: 2.105, Global test accuracy: 30.26
Round   3, Train loss: 1.939, Test loss: 2.025, Test accuracy: 46.56
Round   3, Global train loss: 1.939, Global test loss: 2.031, Global test accuracy: 42.48
Round   4, Train loss: 1.914, Test loss: 1.941, Test accuracy: 53.66
Round   4, Global train loss: 1.914, Global test loss: 2.070, Global test accuracy: 37.50
Round   5, Train loss: 1.803, Test loss: 1.894, Test accuracy: 58.22
Round   5, Global train loss: 1.803, Global test loss: 2.057, Global test accuracy: 36.38
Round   6, Train loss: 1.777, Test loss: 1.775, Test accuracy: 70.90
Round   6, Global train loss: 1.777, Global test loss: 1.893, Global test accuracy: 57.96
Round   7, Train loss: 1.749, Test loss: 1.758, Test accuracy: 72.46
Round   7, Global train loss: 1.749, Global test loss: 1.881, Global test accuracy: 58.92
Round   8, Train loss: 1.676, Test loss: 1.752, Test accuracy: 71.96
Round   8, Global train loss: 1.676, Global test loss: 1.892, Global test accuracy: 56.94
Round   9, Train loss: 1.662, Test loss: 1.735, Test accuracy: 74.10
Round   9, Global train loss: 1.662, Global test loss: 1.809, Global test accuracy: 67.62
Round  10, Train loss: 1.653, Test loss: 1.716, Test accuracy: 75.74
Round  10, Global train loss: 1.653, Global test loss: 1.800, Global test accuracy: 67.64
Round  11, Train loss: 1.786, Test loss: 1.705, Test accuracy: 76.12
Round  11, Global train loss: 1.786, Global test loss: 1.781, Global test accuracy: 68.44
Round  12, Train loss: 1.923, Test loss: 1.702, Test accuracy: 76.84
Round  12, Global train loss: 1.923, Global test loss: 1.839, Global test accuracy: 61.40
Round  13, Train loss: 1.643, Test loss: 1.705, Test accuracy: 76.40
Round  13, Global train loss: 1.643, Global test loss: 1.789, Global test accuracy: 68.80
Round  14, Train loss: 1.830, Test loss: 1.686, Test accuracy: 78.22
Round  14, Global train loss: 1.830, Global test loss: 1.771, Global test accuracy: 70.06
Round  15, Train loss: 1.976, Test loss: 1.692, Test accuracy: 77.54
Round  15, Global train loss: 1.976, Global test loss: 1.773, Global test accuracy: 69.86
Round  16, Train loss: 1.769, Test loss: 1.689, Test accuracy: 77.76
Round  16, Global train loss: 1.769, Global test loss: 1.773, Global test accuracy: 69.46
Round  17, Train loss: 1.562, Test loss: 1.689, Test accuracy: 77.68
Round  17, Global train loss: 1.562, Global test loss: 1.775, Global test accuracy: 68.98
Round  18, Train loss: 1.695, Test loss: 1.687, Test accuracy: 77.68
Round  18, Global train loss: 1.695, Global test loss: 1.741, Global test accuracy: 73.20
Round  19, Train loss: 1.682, Test loss: 1.686, Test accuracy: 77.78
Round  19, Global train loss: 1.682, Global test loss: 1.758, Global test accuracy: 71.70
Round  20, Train loss: 1.968, Test loss: 1.681, Test accuracy: 78.22
Round  20, Global train loss: 1.968, Global test loss: 1.743, Global test accuracy: 72.62
Round  21, Train loss: 1.823, Test loss: 1.678, Test accuracy: 78.42
Round  21, Global train loss: 1.823, Global test loss: 1.755, Global test accuracy: 71.48
Round  22, Train loss: 1.751, Test loss: 1.683, Test accuracy: 78.00
Round  22, Global train loss: 1.751, Global test loss: 1.761, Global test accuracy: 71.22
Round  23, Train loss: 1.754, Test loss: 1.682, Test accuracy: 77.98
Round  23, Global train loss: 1.754, Global test loss: 1.738, Global test accuracy: 73.16
Round  24, Train loss: 1.747, Test loss: 1.680, Test accuracy: 78.22
Round  24, Global train loss: 1.747, Global test loss: 1.762, Global test accuracy: 70.22
Round  25, Train loss: 1.611, Test loss: 1.680, Test accuracy: 78.12
Round  25, Global train loss: 1.611, Global test loss: 1.795, Global test accuracy: 66.56
Round  26, Train loss: 1.753, Test loss: 1.685, Test accuracy: 77.84
Round  26, Global train loss: 1.753, Global test loss: 1.782, Global test accuracy: 68.02
Round  27, Train loss: 1.549, Test loss: 1.685, Test accuracy: 77.76
Round  27, Global train loss: 1.549, Global test loss: 1.736, Global test accuracy: 73.26
Round  28, Train loss: 1.748, Test loss: 1.684, Test accuracy: 77.84
Round  28, Global train loss: 1.748, Global test loss: 1.758, Global test accuracy: 70.78
Round  29, Train loss: 1.762, Test loss: 1.683, Test accuracy: 77.84
Round  29, Global train loss: 1.762, Global test loss: 1.765, Global test accuracy: 69.56
Round  30, Train loss: 1.677, Test loss: 1.683, Test accuracy: 77.88
Round  30, Global train loss: 1.677, Global test loss: 1.730, Global test accuracy: 73.86
Round  31, Train loss: 1.682, Test loss: 1.685, Test accuracy: 77.78
Round  31, Global train loss: 1.682, Global test loss: 1.727, Global test accuracy: 74.18
Round  32, Train loss: 1.549, Test loss: 1.683, Test accuracy: 77.98
Round  32, Global train loss: 1.549, Global test loss: 1.707, Global test accuracy: 75.76
Round  33, Train loss: 1.757, Test loss: 1.683, Test accuracy: 78.02
Round  33, Global train loss: 1.757, Global test loss: 1.759, Global test accuracy: 69.96
Round  34, Train loss: 1.611, Test loss: 1.682, Test accuracy: 78.04
Round  34, Global train loss: 1.611, Global test loss: 1.706, Global test accuracy: 75.96
Round  35, Train loss: 1.612, Test loss: 1.682, Test accuracy: 78.04
Round  35, Global train loss: 1.612, Global test loss: 1.707, Global test accuracy: 76.00
Round  36, Train loss: 1.669, Test loss: 1.681, Test accuracy: 78.18
Round  36, Global train loss: 1.669, Global test loss: 1.722, Global test accuracy: 74.76
Round  37, Train loss: 1.753, Test loss: 1.680, Test accuracy: 78.28
Round  37, Global train loss: 1.753, Global test loss: 1.730, Global test accuracy: 73.40
Round  38, Train loss: 1.544, Test loss: 1.679, Test accuracy: 78.40
Round  38, Global train loss: 1.544, Global test loss: 1.700, Global test accuracy: 76.94
Round  39, Train loss: 1.543, Test loss: 1.679, Test accuracy: 78.34
Round  39, Global train loss: 1.543, Global test loss: 1.696, Global test accuracy: 76.82
Round  40, Train loss: 1.738, Test loss: 1.677, Test accuracy: 78.54
Round  40, Global train loss: 1.738, Global test loss: 1.738, Global test accuracy: 72.84
Round  41, Train loss: 1.688, Test loss: 1.675, Test accuracy: 78.74
Round  41, Global train loss: 1.688, Global test loss: 1.724, Global test accuracy: 74.32
Round  42, Train loss: 1.602, Test loss: 1.675, Test accuracy: 78.72
Round  42, Global train loss: 1.602, Global test loss: 1.747, Global test accuracy: 71.68
Round  43, Train loss: 1.668, Test loss: 1.676, Test accuracy: 78.62
Round  43, Global train loss: 1.668, Global test loss: 1.762, Global test accuracy: 70.10
Round  44, Train loss: 1.949, Test loss: 1.675, Test accuracy: 78.64
Round  44, Global train loss: 1.949, Global test loss: 1.738, Global test accuracy: 72.30
Round  45, Train loss: 1.797, Test loss: 1.677, Test accuracy: 78.56
Round  45, Global train loss: 1.797, Global test loss: 1.737, Global test accuracy: 73.12
Round  46, Train loss: 1.667, Test loss: 1.678, Test accuracy: 78.44
Round  46, Global train loss: 1.667, Global test loss: 1.737, Global test accuracy: 72.92
Round  47, Train loss: 1.680, Test loss: 1.678, Test accuracy: 78.46
Round  47, Global train loss: 1.680, Global test loss: 1.713, Global test accuracy: 75.10
Round  48, Train loss: 1.729, Test loss: 1.675, Test accuracy: 78.68
Round  48, Global train loss: 1.729, Global test loss: 1.725, Global test accuracy: 74.28
Round  49, Train loss: 1.665, Test loss: 1.675, Test accuracy: 78.66
Round  49, Global train loss: 1.665, Global test loss: 1.737, Global test accuracy: 72.72
Round  50, Train loss: 1.663, Test loss: 1.675, Test accuracy: 78.64
Round  50, Global train loss: 1.663, Global test loss: 1.736, Global test accuracy: 72.98
Round  51, Train loss: 1.796, Test loss: 1.681, Test accuracy: 78.14
Round  51, Global train loss: 1.796, Global test loss: 1.709, Global test accuracy: 75.44
Round  52, Train loss: 1.724, Test loss: 1.676, Test accuracy: 78.70
Round  52, Global train loss: 1.724, Global test loss: 1.716, Global test accuracy: 74.96
Round  53, Train loss: 1.603, Test loss: 1.675, Test accuracy: 78.66
Round  53, Global train loss: 1.603, Global test loss: 1.713, Global test accuracy: 75.10
Round  54, Train loss: 1.832, Test loss: 1.649, Test accuracy: 81.58
Round  54, Global train loss: 1.832, Global test loss: 1.714, Global test accuracy: 75.58
Round  55, Train loss: 1.746, Test loss: 1.635, Test accuracy: 83.02
Round  55, Global train loss: 1.746, Global test loss: 1.728, Global test accuracy: 74.66
Round  56, Train loss: 1.747, Test loss: 1.622, Test accuracy: 84.38
Round  56, Global train loss: 1.747, Global test loss: 1.711, Global test accuracy: 75.70
Round  57, Train loss: 1.854, Test loss: 1.624, Test accuracy: 84.10
Round  57, Global train loss: 1.854, Global test loss: 1.753, Global test accuracy: 71.70
Round  58, Train loss: 1.546, Test loss: 1.620, Test accuracy: 84.50
Round  58, Global train loss: 1.546, Global test loss: 1.724, Global test accuracy: 73.86
Round  59, Train loss: 1.619, Test loss: 1.620, Test accuracy: 84.52
Round  59, Global train loss: 1.619, Global test loss: 1.686, Global test accuracy: 78.94
Round  60, Train loss: 1.665, Test loss: 1.622, Test accuracy: 84.20
Round  60, Global train loss: 1.665, Global test loss: 1.722, Global test accuracy: 74.22
Round  61, Train loss: 1.669, Test loss: 1.622, Test accuracy: 84.28
Round  61, Global train loss: 1.669, Global test loss: 1.680, Global test accuracy: 79.12
Round  62, Train loss: 1.612, Test loss: 1.621, Test accuracy: 84.38
Round  62, Global train loss: 1.612, Global test loss: 1.674, Global test accuracy: 79.72
Round  63, Train loss: 1.664, Test loss: 1.619, Test accuracy: 84.64
Round  63, Global train loss: 1.664, Global test loss: 1.681, Global test accuracy: 79.10
Round  64, Train loss: 1.729, Test loss: 1.617, Test accuracy: 84.74
Round  64, Global train loss: 1.729, Global test loss: 1.711, Global test accuracy: 75.24
Round  65, Train loss: 1.539, Test loss: 1.617, Test accuracy: 84.74
Round  65, Global train loss: 1.539, Global test loss: 1.663, Global test accuracy: 80.50
Round  66, Train loss: 1.657, Test loss: 1.617, Test accuracy: 84.74
Round  66, Global train loss: 1.657, Global test loss: 1.718, Global test accuracy: 74.92
Round  67, Train loss: 1.542, Test loss: 1.616, Test accuracy: 84.84
Round  67, Global train loss: 1.542, Global test loss: 1.680, Global test accuracy: 78.36
Round  68, Train loss: 1.539, Test loss: 1.616, Test accuracy: 84.88
Round  68, Global train loss: 1.539, Global test loss: 1.664, Global test accuracy: 80.44
Round  69, Train loss: 1.537, Test loss: 1.616, Test accuracy: 84.86
Round  69, Global train loss: 1.537, Global test loss: 1.659, Global test accuracy: 81.14
Round  70, Train loss: 1.473, Test loss: 1.616, Test accuracy: 84.88
Round  70, Global train loss: 1.473, Global test loss: 1.661, Global test accuracy: 80.62
Round  71, Train loss: 1.728, Test loss: 1.617, Test accuracy: 84.80
Round  71, Global train loss: 1.728, Global test loss: 1.684, Global test accuracy: 78.22
Round  72, Train loss: 1.721, Test loss: 1.614, Test accuracy: 85.00
Round  72, Global train loss: 1.721, Global test loss: 1.676, Global test accuracy: 79.40
Round  73, Train loss: 1.601, Test loss: 1.614, Test accuracy: 84.94
Round  73, Global train loss: 1.601, Global test loss: 1.678, Global test accuracy: 78.74
Round  74, Train loss: 1.536, Test loss: 1.614, Test accuracy: 84.96
Round  74, Global train loss: 1.536, Global test loss: 1.665, Global test accuracy: 80.66
Round  75, Train loss: 1.538, Test loss: 1.614, Test accuracy: 85.00
Round  75, Global train loss: 1.538, Global test loss: 1.668, Global test accuracy: 80.04
Round  76, Train loss: 1.786, Test loss: 1.615, Test accuracy: 84.88
Round  76, Global train loss: 1.786, Global test loss: 1.673, Global test accuracy: 79.52
Round  77, Train loss: 1.536, Test loss: 1.615, Test accuracy: 84.82
Round  77, Global train loss: 1.536, Global test loss: 1.644, Global test accuracy: 82.30
Round  78, Train loss: 1.471, Test loss: 1.615, Test accuracy: 84.82
Round  78, Global train loss: 1.471, Global test loss: 1.657, Global test accuracy: 81.26
Round  79, Train loss: 1.719, Test loss: 1.615, Test accuracy: 84.78
Round  79, Global train loss: 1.719, Global test loss: 1.676, Global test accuracy: 78.96
Round  80, Train loss: 1.730, Test loss: 1.614, Test accuracy: 84.74
Round  80, Global train loss: 1.730, Global test loss: 1.668, Global test accuracy: 80.20
Round  81, Train loss: 1.470, Test loss: 1.614, Test accuracy: 84.68
Round  81, Global train loss: 1.470, Global test loss: 1.660, Global test accuracy: 80.70
Round  82, Train loss: 1.536, Test loss: 1.614, Test accuracy: 84.80
Round  82, Global train loss: 1.536, Global test loss: 1.686, Global test accuracy: 77.72
Round  83, Train loss: 1.470, Test loss: 1.614, Test accuracy: 84.86
Round  83, Global train loss: 1.470, Global test loss: 1.639, Global test accuracy: 82.70
Round  84, Train loss: 1.660, Test loss: 1.614, Test accuracy: 84.88
Round  84, Global train loss: 1.660, Global test loss: 1.652, Global test accuracy: 81.70
Round  85, Train loss: 1.535, Test loss: 1.614, Test accuracy: 84.80
Round  85, Global train loss: 1.535, Global test loss: 1.649, Global test accuracy: 82.00
Round  86, Train loss: 1.787, Test loss: 1.615, Test accuracy: 84.82
Round  86, Global train loss: 1.787, Global test loss: 1.659, Global test accuracy: 80.82
Round  87, Train loss: 1.534, Test loss: 1.614, Test accuracy: 84.82
Round  87, Global train loss: 1.534, Global test loss: 1.669, Global test accuracy: 79.94
Round  88, Train loss: 1.468, Test loss: 1.614, Test accuracy: 84.92
Round  88, Global train loss: 1.468, Global test loss: 1.666, Global test accuracy: 79.86
Round  89, Train loss: 1.785, Test loss: 1.614, Test accuracy: 85.00
Round  89, Global train loss: 1.785, Global test loss: 1.650, Global test accuracy: 81.82
Round  90, Train loss: 1.655, Test loss: 1.612, Test accuracy: 85.22
Round  90, Global train loss: 1.655, Global test loss: 1.670, Global test accuracy: 79.48
Round  91, Train loss: 1.649, Test loss: 1.613, Test accuracy: 85.18
Round  91, Global train loss: 1.649, Global test loss: 1.673, Global test accuracy: 79.28
Round  92, Train loss: 1.536, Test loss: 1.613, Test accuracy: 85.10
Round  92, Global train loss: 1.536, Global test loss: 1.642, Global test accuracy: 82.62
Round  93, Train loss: 1.533, Test loss: 1.613, Test accuracy: 85.14
Round  93, Global train loss: 1.533, Global test loss: 1.676, Global test accuracy: 78.84
Round  94, Train loss: 1.719, Test loss: 1.616, Test accuracy: 84.86
Round  94, Global train loss: 1.719, Global test loss: 1.657, Global test accuracy: 81.20
Round  95, Train loss: 1.533, Test loss: 1.609, Test accuracy: 85.80
Round  95, Global train loss: 1.533, Global test loss: 1.669, Global test accuracy: 79.56/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  96, Train loss: 1.484, Test loss: 1.599, Test accuracy: 86.62
Round  96, Global train loss: 1.484, Global test loss: 1.670, Global test accuracy: 79.66
Round  97, Train loss: 1.640, Test loss: 1.593, Test accuracy: 87.18
Round  97, Global train loss: 1.640, Global test loss: 1.676, Global test accuracy: 79.52
Round  98, Train loss: 1.643, Test loss: 1.576, Test accuracy: 89.02
Round  98, Global train loss: 1.643, Global test loss: 1.633, Global test accuracy: 84.38
Round  99, Train loss: 1.475, Test loss: 1.575, Test accuracy: 89.00
Round  99, Global train loss: 1.475, Global test loss: 1.646, Global test accuracy: 82.42
Final Round, Train loss: 1.572, Test loss: 1.558, Test accuracy: 90.98
Final Round, Global train loss: 1.572, Global test loss: 1.646, Global test accuracy: 82.42
Average accuracy final 10 rounds: 86.312 

Average global accuracy final 10 rounds: 80.69600000000003 

781.5753765106201
[1.1256554126739502, 2.2513108253479004, 3.243917465209961, 4.2365241050720215, 5.514791250228882, 6.793058395385742, 7.775499582290649, 8.757940769195557, 9.83440899848938, 10.910877227783203, 11.86447548866272, 12.818073749542236, 13.88887095451355, 14.959668159484863, 15.90324592590332, 16.846823692321777, 17.97469925880432, 19.102574825286865, 20.054972171783447, 21.00736951828003, 21.989588260650635, 22.97180700302124, 23.92709255218506, 24.882378101348877, 26.064385890960693, 27.24639368057251, 28.27069354057312, 29.29499340057373, 30.349287033081055, 31.40358066558838, 32.42059850692749, 33.4376163482666, 34.42824077606201, 35.41886520385742, 36.46700072288513, 37.51513624191284, 38.64681077003479, 39.77848529815674, 40.810325384140015, 41.84216547012329, 42.89184832572937, 43.94153118133545, 45.013123750686646, 46.08471632003784, 47.09012842178345, 48.09554052352905, 49.19157910346985, 50.287617683410645, 51.57733106613159, 52.86704444885254, 53.92976689338684, 54.99248933792114, 55.99915790557861, 57.005826473236084, 58.07433342933655, 59.14284038543701, 60.17172694206238, 61.200613498687744, 62.18966245651245, 63.17871141433716, 64.18187022209167, 65.18502902984619, 66.17837381362915, 67.17171859741211, 68.29980301856995, 69.42788743972778, 70.50496244430542, 71.58203744888306, 72.49891114234924, 73.41578483581543, 74.53639388084412, 75.6570029258728, 76.70432353019714, 77.75164413452148, 78.93429136276245, 80.11693859100342, 81.31609201431274, 82.51524543762207, 83.62669229507446, 84.73813915252686, 85.91416645050049, 87.09019374847412, 88.11052393913269, 89.13085412979126, 90.24891257286072, 91.36697101593018, 92.37190508842468, 93.37683916091919, 94.48188471794128, 95.58693027496338, 96.73191690444946, 97.87690353393555, 98.93094778060913, 99.98499202728271, 101.03987693786621, 102.0947618484497, 103.12453436851501, 104.15430688858032, 105.15718293190002, 106.16005897521973, 107.14292621612549, 108.12579345703125, 109.1514003276825, 110.17700719833374, 111.1779932975769, 112.17897939682007, 113.37095522880554, 114.56293106079102, 115.78656077384949, 117.01019048690796, 118.11060571670532, 119.21102094650269, 120.23141264915466, 121.25180435180664, 122.24286985397339, 123.23393535614014, 124.28275442123413, 125.33157348632812, 126.34384655952454, 127.35611963272095, 128.40797758102417, 129.4598355293274, 130.4741141796112, 131.48839282989502, 132.4893455505371, 133.4902982711792, 134.56767392158508, 135.64504957199097, 136.94631624221802, 138.24758291244507, 139.41401290893555, 140.58044290542603, 141.62674260139465, 142.67304229736328, 143.57399892807007, 144.47495555877686, 145.69340658187866, 146.91185760498047, 147.94195938110352, 148.97206115722656, 150.00329852104187, 151.03453588485718, 152.05460619926453, 153.07467651367188, 154.05832242965698, 155.0419683456421, 156.0633203983307, 157.0846724510193, 158.13124918937683, 159.17782592773438, 160.2432312965393, 161.30863666534424, 162.39095330238342, 163.4732699394226, 164.4672544002533, 165.46123886108398, 166.51087141036987, 167.56050395965576, 168.6577570438385, 169.75501012802124, 170.78574776649475, 171.81648540496826, 172.93217039108276, 174.04785537719727, 175.0168948173523, 175.98593425750732, 177.0723683834076, 178.15880250930786, 179.1107199192047, 180.06263732910156, 181.15376162528992, 182.24488592147827, 183.3228621482849, 184.40083837509155, 185.39093160629272, 186.3810248374939, 187.33519506454468, 188.28936529159546, 189.38650560379028, 190.4836459159851, 191.49164938926697, 192.49965286254883, 193.51768970489502, 194.5357265472412, 195.98650670051575, 197.43728685379028, 198.50747871398926, 199.57767057418823, 200.57570552825928, 201.57374048233032, 202.58833289146423, 203.60292530059814, 204.61124467849731, 205.61956405639648, 206.77480268478394, 207.9300413131714, 209.01384043693542, 210.09763956069946, 211.13652181625366, 212.17540407180786, 214.35136699676514, 216.5273299217224]
[25.22, 25.22, 31.1, 31.1, 36.58, 36.58, 46.56, 46.56, 53.66, 53.66, 58.22, 58.22, 70.9, 70.9, 72.46, 72.46, 71.96, 71.96, 74.1, 74.1, 75.74, 75.74, 76.12, 76.12, 76.84, 76.84, 76.4, 76.4, 78.22, 78.22, 77.54, 77.54, 77.76, 77.76, 77.68, 77.68, 77.68, 77.68, 77.78, 77.78, 78.22, 78.22, 78.42, 78.42, 78.0, 78.0, 77.98, 77.98, 78.22, 78.22, 78.12, 78.12, 77.84, 77.84, 77.76, 77.76, 77.84, 77.84, 77.84, 77.84, 77.88, 77.88, 77.78, 77.78, 77.98, 77.98, 78.02, 78.02, 78.04, 78.04, 78.04, 78.04, 78.18, 78.18, 78.28, 78.28, 78.4, 78.4, 78.34, 78.34, 78.54, 78.54, 78.74, 78.74, 78.72, 78.72, 78.62, 78.62, 78.64, 78.64, 78.56, 78.56, 78.44, 78.44, 78.46, 78.46, 78.68, 78.68, 78.66, 78.66, 78.64, 78.64, 78.14, 78.14, 78.7, 78.7, 78.66, 78.66, 81.58, 81.58, 83.02, 83.02, 84.38, 84.38, 84.1, 84.1, 84.5, 84.5, 84.52, 84.52, 84.2, 84.2, 84.28, 84.28, 84.38, 84.38, 84.64, 84.64, 84.74, 84.74, 84.74, 84.74, 84.74, 84.74, 84.84, 84.84, 84.88, 84.88, 84.86, 84.86, 84.88, 84.88, 84.8, 84.8, 85.0, 85.0, 84.94, 84.94, 84.96, 84.96, 85.0, 85.0, 84.88, 84.88, 84.82, 84.82, 84.82, 84.82, 84.78, 84.78, 84.74, 84.74, 84.68, 84.68, 84.8, 84.8, 84.86, 84.86, 84.88, 84.88, 84.8, 84.8, 84.82, 84.82, 84.82, 84.82, 84.92, 84.92, 85.0, 85.0, 85.22, 85.22, 85.18, 85.18, 85.1, 85.1, 85.14, 85.14, 84.86, 84.86, 85.8, 85.8, 86.62, 86.62, 87.18, 87.18, 89.02, 89.02, 89.0, 89.0, 90.98, 90.98]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.292, Test loss: 2.298, Test accuracy: 17.10
Round   0, Global train loss: 2.292, Global test loss: 2.301, Global test accuracy: 16.68
Round   1, Train loss: 2.290, Test loss: 2.285, Test accuracy: 18.00
Round   1, Global train loss: 2.290, Global test loss: 2.293, Global test accuracy: 10.06
Round   2, Train loss: 2.209, Test loss: 2.234, Test accuracy: 24.16
Round   2, Global train loss: 2.209, Global test loss: 2.243, Global test accuracy: 18.38
Round   3, Train loss: 2.114, Test loss: 2.162, Test accuracy: 34.08
Round   3, Global train loss: 2.114, Global test loss: 2.218, Global test accuracy: 23.20
Round   4, Train loss: 1.950, Test loss: 2.035, Test accuracy: 45.50
Round   4, Global train loss: 1.950, Global test loss: 2.055, Global test accuracy: 43.40
Round   5, Train loss: 1.999, Test loss: 1.989, Test accuracy: 50.76
Round   5, Global train loss: 1.999, Global test loss: 2.086, Global test accuracy: 35.90
Round   6, Train loss: 2.071, Test loss: 1.892, Test accuracy: 61.90
Round   6, Global train loss: 2.071, Global test loss: 1.987, Global test accuracy: 54.98
Round   7, Train loss: 1.895, Test loss: 1.854, Test accuracy: 64.82
Round   7, Global train loss: 1.895, Global test loss: 1.949, Global test accuracy: 54.34
Round   8, Train loss: 1.775, Test loss: 1.828, Test accuracy: 66.20
Round   8, Global train loss: 1.775, Global test loss: 1.957, Global test accuracy: 50.64
Round   9, Train loss: 1.721, Test loss: 1.809, Test accuracy: 68.44
Round   9, Global train loss: 1.721, Global test loss: 1.873, Global test accuracy: 61.70
Round  10, Train loss: 1.808, Test loss: 1.808, Test accuracy: 67.26
Round  10, Global train loss: 1.808, Global test loss: 1.871, Global test accuracy: 59.02
Round  11, Train loss: 1.866, Test loss: 1.785, Test accuracy: 69.36
Round  11, Global train loss: 1.866, Global test loss: 1.853, Global test accuracy: 61.56
Round  12, Train loss: 1.831, Test loss: 1.770, Test accuracy: 71.04
Round  12, Global train loss: 1.831, Global test loss: 1.851, Global test accuracy: 61.92
Round  13, Train loss: 1.740, Test loss: 1.776, Test accuracy: 69.96
Round  13, Global train loss: 1.740, Global test loss: 1.829, Global test accuracy: 64.30
Round  14, Train loss: 1.735, Test loss: 1.755, Test accuracy: 72.26
Round  14, Global train loss: 1.735, Global test loss: 1.799, Global test accuracy: 68.58
Round  15, Train loss: 1.896, Test loss: 1.757, Test accuracy: 71.96
Round  15, Global train loss: 1.896, Global test loss: 1.818, Global test accuracy: 65.52
Round  16, Train loss: 1.894, Test loss: 1.738, Test accuracy: 73.24
Round  16, Global train loss: 1.894, Global test loss: 1.809, Global test accuracy: 66.10
Round  17, Train loss: 1.901, Test loss: 1.740, Test accuracy: 73.02
Round  17, Global train loss: 1.901, Global test loss: 1.830, Global test accuracy: 64.34
Round  18, Train loss: 1.758, Test loss: 1.739, Test accuracy: 72.90
Round  18, Global train loss: 1.758, Global test loss: 1.815, Global test accuracy: 65.28
Round  19, Train loss: 1.791, Test loss: 1.737, Test accuracy: 72.94
Round  19, Global train loss: 1.791, Global test loss: 1.800, Global test accuracy: 68.40
Round  20, Train loss: 1.889, Test loss: 1.735, Test accuracy: 73.18
Round  20, Global train loss: 1.889, Global test loss: 1.790, Global test accuracy: 68.32
Round  21, Train loss: 1.890, Test loss: 1.734, Test accuracy: 73.20
Round  21, Global train loss: 1.890, Global test loss: 1.802, Global test accuracy: 66.60
Round  22, Train loss: 2.032, Test loss: 1.735, Test accuracy: 73.02
Round  22, Global train loss: 2.032, Global test loss: 1.814, Global test accuracy: 66.28
Round  23, Train loss: 1.811, Test loss: 1.746, Test accuracy: 72.00
Round  23, Global train loss: 1.811, Global test loss: 1.781, Global test accuracy: 69.76
Round  24, Train loss: 2.028, Test loss: 1.737, Test accuracy: 72.82
Round  24, Global train loss: 2.028, Global test loss: 1.786, Global test accuracy: 69.02
Round  25, Train loss: 1.866, Test loss: 1.741, Test accuracy: 72.46
Round  25, Global train loss: 1.866, Global test loss: 1.846, Global test accuracy: 62.42
Round  26, Train loss: 1.802, Test loss: 1.744, Test accuracy: 72.20
Round  26, Global train loss: 1.802, Global test loss: 1.794, Global test accuracy: 68.06
Round  27, Train loss: 1.862, Test loss: 1.741, Test accuracy: 72.32
Round  27, Global train loss: 1.862, Global test loss: 1.779, Global test accuracy: 69.58
Round  28, Train loss: 1.795, Test loss: 1.736, Test accuracy: 72.80
Round  28, Global train loss: 1.795, Global test loss: 1.797, Global test accuracy: 67.56
Round  29, Train loss: 1.717, Test loss: 1.736, Test accuracy: 72.76
Round  29, Global train loss: 1.717, Global test loss: 1.799, Global test accuracy: 67.18
Round  30, Train loss: 1.726, Test loss: 1.733, Test accuracy: 73.08
Round  30, Global train loss: 1.726, Global test loss: 1.776, Global test accuracy: 69.88
Round  31, Train loss: 1.797, Test loss: 1.734, Test accuracy: 73.08
Round  31, Global train loss: 1.797, Global test loss: 1.775, Global test accuracy: 70.02
Round  32, Train loss: 1.660, Test loss: 1.733, Test accuracy: 73.14
Round  32, Global train loss: 1.660, Global test loss: 1.766, Global test accuracy: 70.04
Round  33, Train loss: 1.713, Test loss: 1.735, Test accuracy: 72.90
Round  33, Global train loss: 1.713, Global test loss: 1.776, Global test accuracy: 68.94
Round  34, Train loss: 1.883, Test loss: 1.733, Test accuracy: 73.04
Round  34, Global train loss: 1.883, Global test loss: 1.778, Global test accuracy: 68.66
Round  35, Train loss: 1.742, Test loss: 1.733, Test accuracy: 73.02
Round  35, Global train loss: 1.742, Global test loss: 1.788, Global test accuracy: 67.58
Round  36, Train loss: 1.778, Test loss: 1.731, Test accuracy: 73.22
Round  36, Global train loss: 1.778, Global test loss: 1.773, Global test accuracy: 69.66
Round  37, Train loss: 1.876, Test loss: 1.733, Test accuracy: 73.02
Round  37, Global train loss: 1.876, Global test loss: 1.771, Global test accuracy: 69.64
Round  38, Train loss: 1.879, Test loss: 1.730, Test accuracy: 73.40
Round  38, Global train loss: 1.879, Global test loss: 1.761, Global test accuracy: 70.66
Round  39, Train loss: 1.654, Test loss: 1.729, Test accuracy: 73.48
Round  39, Global train loss: 1.654, Global test loss: 1.759, Global test accuracy: 70.48
Round  40, Train loss: 1.789, Test loss: 1.727, Test accuracy: 73.70
Round  40, Global train loss: 1.789, Global test loss: 1.765, Global test accuracy: 70.38
Round  41, Train loss: 1.813, Test loss: 1.729, Test accuracy: 73.52
Round  41, Global train loss: 1.813, Global test loss: 1.767, Global test accuracy: 70.06
Round  42, Train loss: 1.872, Test loss: 1.731, Test accuracy: 73.28
Round  42, Global train loss: 1.872, Global test loss: 1.812, Global test accuracy: 65.44
Round  43, Train loss: 1.872, Test loss: 1.728, Test accuracy: 73.44
Round  43, Global train loss: 1.872, Global test loss: 1.831, Global test accuracy: 63.68
Round  44, Train loss: 1.810, Test loss: 1.733, Test accuracy: 72.98
Round  44, Global train loss: 1.810, Global test loss: 1.760, Global test accuracy: 70.34
Round  45, Train loss: 1.867, Test loss: 1.733, Test accuracy: 72.92
Round  45, Global train loss: 1.867, Global test loss: 1.773, Global test accuracy: 69.16
Round  46, Train loss: 1.930, Test loss: 1.732, Test accuracy: 73.04
Round  46, Global train loss: 1.930, Global test loss: 1.799, Global test accuracy: 67.24
Round  47, Train loss: 1.777, Test loss: 1.732, Test accuracy: 73.04
Round  47, Global train loss: 1.777, Global test loss: 1.752, Global test accuracy: 71.24
Round  48, Train loss: 1.933, Test loss: 1.737, Test accuracy: 72.54
Round  48, Global train loss: 1.933, Global test loss: 1.776, Global test accuracy: 69.26
Round  49, Train loss: 1.923, Test loss: 1.737, Test accuracy: 72.50
Round  49, Global train loss: 1.923, Global test loss: 1.805, Global test accuracy: 66.18
Round  50, Train loss: 1.920, Test loss: 1.736, Test accuracy: 72.50
Round  50, Global train loss: 1.920, Global test loss: 1.818, Global test accuracy: 65.08
Round  51, Train loss: 1.805, Test loss: 1.740, Test accuracy: 72.12
Round  51, Global train loss: 1.805, Global test loss: 1.764, Global test accuracy: 70.34
Round  52, Train loss: 1.836, Test loss: 1.736, Test accuracy: 72.46
Round  52, Global train loss: 1.836, Global test loss: 1.779, Global test accuracy: 68.72
Round  53, Train loss: 1.713, Test loss: 1.736, Test accuracy: 72.58
Round  53, Global train loss: 1.713, Global test loss: 1.784, Global test accuracy: 68.12
Round  54, Train loss: 1.734, Test loss: 1.735, Test accuracy: 72.54
Round  54, Global train loss: 1.734, Global test loss: 1.752, Global test accuracy: 71.34
Round  55, Train loss: 1.732, Test loss: 1.735, Test accuracy: 72.56
Round  55, Global train loss: 1.732, Global test loss: 1.782, Global test accuracy: 68.24
Round  56, Train loss: 1.733, Test loss: 1.735, Test accuracy: 72.60
Round  56, Global train loss: 1.733, Global test loss: 1.785, Global test accuracy: 67.54
Round  57, Train loss: 1.769, Test loss: 1.739, Test accuracy: 72.08
Round  57, Global train loss: 1.769, Global test loss: 1.756, Global test accuracy: 71.16
Round  58, Train loss: 1.834, Test loss: 1.737, Test accuracy: 72.38
Round  58, Global train loss: 1.834, Global test loss: 1.776, Global test accuracy: 69.60
Round  59, Train loss: 1.797, Test loss: 1.737, Test accuracy: 72.38
Round  59, Global train loss: 1.797, Global test loss: 1.785, Global test accuracy: 68.20
Round  60, Train loss: 1.919, Test loss: 1.733, Test accuracy: 72.90
Round  60, Global train loss: 1.919, Global test loss: 1.767, Global test accuracy: 69.84
Round  61, Train loss: 1.646, Test loss: 1.733, Test accuracy: 72.96
Round  61, Global train loss: 1.646, Global test loss: 1.753, Global test accuracy: 71.24
Round  62, Train loss: 1.795, Test loss: 1.733, Test accuracy: 72.80
Round  62, Global train loss: 1.795, Global test loss: 1.752, Global test accuracy: 71.36
Round  63, Train loss: 1.793, Test loss: 1.734, Test accuracy: 72.76
Round  63, Global train loss: 1.793, Global test loss: 1.761, Global test accuracy: 70.22
Round  64, Train loss: 1.855, Test loss: 1.733, Test accuracy: 72.88
Round  64, Global train loss: 1.855, Global test loss: 1.769, Global test accuracy: 69.78
Round  65, Train loss: 1.856, Test loss: 1.735, Test accuracy: 72.82
Round  65, Global train loss: 1.856, Global test loss: 1.764, Global test accuracy: 70.08
Round  66, Train loss: 1.884, Test loss: 1.736, Test accuracy: 72.40
Round  66, Global train loss: 1.884, Global test loss: 1.774, Global test accuracy: 69.36
Round  67, Train loss: 1.734, Test loss: 1.736, Test accuracy: 72.34
Round  67, Global train loss: 1.734, Global test loss: 1.789, Global test accuracy: 67.20
Round  68, Train loss: 1.853, Test loss: 1.737, Test accuracy: 72.20
Round  68, Global train loss: 1.853, Global test loss: 1.767, Global test accuracy: 69.68
Round  69, Train loss: 1.707, Test loss: 1.739, Test accuracy: 72.12
Round  69, Global train loss: 1.707, Global test loss: 1.755, Global test accuracy: 70.96
Round  70, Train loss: 1.620, Test loss: 1.722, Test accuracy: 73.92
Round  70, Global train loss: 1.620, Global test loss: 1.755, Global test accuracy: 70.74
Round  71, Train loss: 1.796, Test loss: 1.691, Test accuracy: 77.46
Round  71, Global train loss: 1.796, Global test loss: 1.773, Global test accuracy: 69.70
Round  72, Train loss: 1.747, Test loss: 1.685, Test accuracy: 78.22
Round  72, Global train loss: 1.747, Global test loss: 1.754, Global test accuracy: 72.80
Round  73, Train loss: 1.664, Test loss: 1.670, Test accuracy: 79.80
Round  73, Global train loss: 1.664, Global test loss: 1.759, Global test accuracy: 71.50
Round  74, Train loss: 1.569, Test loss: 1.670, Test accuracy: 79.66
Round  74, Global train loss: 1.569, Global test loss: 1.788, Global test accuracy: 66.98
Round  75, Train loss: 1.558, Test loss: 1.667, Test accuracy: 79.84
Round  75, Global train loss: 1.558, Global test loss: 1.747, Global test accuracy: 73.66
Round  76, Train loss: 1.802, Test loss: 1.642, Test accuracy: 82.46
Round  76, Global train loss: 1.802, Global test loss: 1.736, Global test accuracy: 73.76
Round  77, Train loss: 1.741, Test loss: 1.638, Test accuracy: 82.80
Round  77, Global train loss: 1.741, Global test loss: 1.726, Global test accuracy: 74.44
Round  78, Train loss: 1.677, Test loss: 1.639, Test accuracy: 82.68
Round  78, Global train loss: 1.677, Global test loss: 1.732, Global test accuracy: 73.40
Round  79, Train loss: 1.722, Test loss: 1.650, Test accuracy: 81.48
Round  79, Global train loss: 1.722, Global test loss: 1.753, Global test accuracy: 72.74
Round  80, Train loss: 1.562, Test loss: 1.631, Test accuracy: 83.42
Round  80, Global train loss: 1.562, Global test loss: 1.737, Global test accuracy: 73.74
Round  81, Train loss: 1.669, Test loss: 1.630, Test accuracy: 83.58
Round  81, Global train loss: 1.669, Global test loss: 1.718, Global test accuracy: 76.36
Round  82, Train loss: 1.547, Test loss: 1.628, Test accuracy: 83.74
Round  82, Global train loss: 1.547, Global test loss: 1.753, Global test accuracy: 71.12
Round  83, Train loss: 1.523, Test loss: 1.625, Test accuracy: 84.08
Round  83, Global train loss: 1.523, Global test loss: 1.687, Global test accuracy: 79.40
Round  84, Train loss: 1.519, Test loss: 1.629, Test accuracy: 83.62
Round  84, Global train loss: 1.519, Global test loss: 1.687, Global test accuracy: 79.56
Round  85, Train loss: 1.543, Test loss: 1.629, Test accuracy: 83.68
Round  85, Global train loss: 1.543, Global test loss: 1.717, Global test accuracy: 75.08
Round  86, Train loss: 1.606, Test loss: 1.628, Test accuracy: 83.68
Round  86, Global train loss: 1.606, Global test loss: 1.696, Global test accuracy: 77.58
Round  87, Train loss: 1.589, Test loss: 1.626, Test accuracy: 83.98
Round  87, Global train loss: 1.589, Global test loss: 1.710, Global test accuracy: 75.12
Round  88, Train loss: 1.703, Test loss: 1.623, Test accuracy: 84.24
Round  88, Global train loss: 1.703, Global test loss: 1.705, Global test accuracy: 75.56
Round  89, Train loss: 1.607, Test loss: 1.623, Test accuracy: 84.22
Round  89, Global train loss: 1.607, Global test loss: 1.667, Global test accuracy: 81.66
Round  90, Train loss: 1.700, Test loss: 1.617, Test accuracy: 84.88
Round  90, Global train loss: 1.700, Global test loss: 1.697, Global test accuracy: 77.04
Round  91, Train loss: 1.679, Test loss: 1.618, Test accuracy: 84.64
Round  91, Global train loss: 1.679, Global test loss: 1.717, Global test accuracy: 75.00
Round  92, Train loss: 1.583, Test loss: 1.621, Test accuracy: 84.32
Round  92, Global train loss: 1.583, Global test loss: 1.696, Global test accuracy: 77.48
Round  93, Train loss: 1.762, Test loss: 1.618, Test accuracy: 84.72
Round  93, Global train loss: 1.762, Global test loss: 1.708, Global test accuracy: 75.60
Round  94, Train loss: 1.541, Test loss: 1.618, Test accuracy: 84.66
Round  94, Global train loss: 1.541, Global test loss: 1.698, Global test accuracy: 77.30
Round  95, Train loss: 1.543, Test loss: 1.618, Test accuracy: 84.72
Round  95, Global train loss: 1.543, Global test loss: 1.690, Global test accuracy: 78.78/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 1.540, Test loss: 1.618, Test accuracy: 84.62
Round  96, Global train loss: 1.540, Global test loss: 1.694, Global test accuracy: 78.14
Round  97, Train loss: 1.834, Test loss: 1.617, Test accuracy: 84.68
Round  97, Global train loss: 1.834, Global test loss: 1.715, Global test accuracy: 74.94
Round  98, Train loss: 1.704, Test loss: 1.615, Test accuracy: 84.96
Round  98, Global train loss: 1.704, Global test loss: 1.689, Global test accuracy: 78.76
Round  99, Train loss: 1.764, Test loss: 1.612, Test accuracy: 85.42
Round  99, Global train loss: 1.764, Global test loss: 1.711, Global test accuracy: 75.42
Final Round, Train loss: 1.644, Test loss: 1.622, Test accuracy: 84.32
Final Round, Global train loss: 1.644, Global test loss: 1.711, Global test accuracy: 75.42
Average accuracy final 10 rounds: 84.762 

Average global accuracy final 10 rounds: 76.846 

824.1414122581482
[1.1770873069763184, 2.3541746139526367, 3.4985997676849365, 4.643024921417236, 5.816091537475586, 6.9891581535339355, 8.170140027999878, 9.35112190246582, 10.438880681991577, 11.526639461517334, 12.588347673416138, 13.650055885314941, 14.671178579330444, 15.692301273345947, 16.921144008636475, 18.149986743927002, 19.284242868423462, 20.418498992919922, 21.61540198326111, 22.812304973602295, 24.00766897201538, 25.203032970428467, 26.2667293548584, 27.33042573928833, 28.520496606826782, 29.710567474365234, 30.913302898406982, 32.11603832244873, 33.29835820198059, 34.48067808151245, 35.5992157459259, 36.717753410339355, 37.77580451965332, 38.833855628967285, 39.93651509284973, 41.03917455673218, 42.146599531173706, 43.254024505615234, 44.411797285079956, 45.56957006454468, 46.729615449905396, 47.88966083526611, 49.08652663230896, 50.28339242935181, 51.386759996414185, 52.49012756347656, 53.537644147872925, 54.58516073226929, 55.64375638961792, 56.70235204696655, 57.76701092720032, 58.83166980743408, 60.039902687072754, 61.248135566711426, 62.40306782722473, 63.55800008773804, 64.67917943000793, 65.80035877227783, 66.96713089942932, 68.13390302658081, 69.29066371917725, 70.44742441177368, 71.61921334266663, 72.79100227355957, 73.94889664649963, 75.1067910194397, 76.30370140075684, 77.50061178207397, 78.71668601036072, 79.93276023864746, 81.09022402763367, 82.24768781661987, 83.41344618797302, 84.57920455932617, 85.69242787361145, 86.80565118789673, 87.85705804824829, 88.90846490859985, 90.00475525856018, 91.10104560852051, 92.15805006027222, 93.21505451202393, 94.3296582698822, 95.44426202774048, 96.62212204933167, 97.79998207092285, 98.98364973068237, 100.1673173904419, 101.33180356025696, 102.49628973007202, 103.61226391792297, 104.72823810577393, 105.8817663192749, 107.03529453277588, 108.12095212936401, 109.20660972595215, 110.40333676338196, 111.60006380081177, 112.7855978012085, 113.97113180160522, 115.20412397384644, 116.43711614608765, 117.48366403579712, 118.53021192550659, 119.70755815505981, 120.88490438461304, 121.98864793777466, 123.09239149093628, 124.3806414604187, 125.66889142990112, 126.7954638004303, 127.92203617095947, 129.29009771347046, 130.65815925598145, 131.81381940841675, 132.96947956085205, 134.11906003952026, 135.26864051818848, 136.4153974056244, 137.5621542930603, 138.99328446388245, 140.4244146347046, 141.58717584609985, 142.74993705749512, 143.8902723789215, 145.0306077003479, 146.21543836593628, 147.40026903152466, 148.55103850364685, 149.70180797576904, 150.85014653205872, 151.9984850883484, 153.2338478565216, 154.46921062469482, 155.57375621795654, 156.67830181121826, 157.76656413078308, 158.8548264503479, 159.92140221595764, 160.98797798156738, 162.11938786506653, 163.25079774856567, 164.41375374794006, 165.57670974731445, 166.84611058235168, 168.11551141738892, 169.27034282684326, 170.4251742362976, 171.53283309936523, 172.64049196243286, 173.88224864006042, 175.124005317688, 176.26787734031677, 177.41174936294556, 178.56809449195862, 179.72443962097168, 180.99948024749756, 182.27452087402344, 183.35303831100464, 184.43155574798584, 185.57259607315063, 186.71363639831543, 187.81613159179688, 188.91862678527832, 190.20218467712402, 191.48574256896973, 192.64306807518005, 193.80039358139038, 194.8653588294983, 195.9303240776062, 197.03641772270203, 198.14251136779785, 199.33568906784058, 200.5288667678833, 201.67268228530884, 202.81649780273438, 203.96584367752075, 205.11518955230713, 206.4002125263214, 207.6852355003357, 208.90858435630798, 210.13193321228027, 211.31248903274536, 212.49304485321045, 213.73905682563782, 214.98506879806519, 216.1132254600525, 217.2413821220398, 218.54592061042786, 219.85045909881592, 220.974951505661, 222.0994439125061, 223.11145782470703, 224.12347173690796, 225.283757686615, 226.44404363632202, 227.68325281143188, 228.92246198654175, 229.99420166015625, 231.06594133377075, 233.30574250221252, 235.5455436706543]
[17.1, 17.1, 18.0, 18.0, 24.16, 24.16, 34.08, 34.08, 45.5, 45.5, 50.76, 50.76, 61.9, 61.9, 64.82, 64.82, 66.2, 66.2, 68.44, 68.44, 67.26, 67.26, 69.36, 69.36, 71.04, 71.04, 69.96, 69.96, 72.26, 72.26, 71.96, 71.96, 73.24, 73.24, 73.02, 73.02, 72.9, 72.9, 72.94, 72.94, 73.18, 73.18, 73.2, 73.2, 73.02, 73.02, 72.0, 72.0, 72.82, 72.82, 72.46, 72.46, 72.2, 72.2, 72.32, 72.32, 72.8, 72.8, 72.76, 72.76, 73.08, 73.08, 73.08, 73.08, 73.14, 73.14, 72.9, 72.9, 73.04, 73.04, 73.02, 73.02, 73.22, 73.22, 73.02, 73.02, 73.4, 73.4, 73.48, 73.48, 73.7, 73.7, 73.52, 73.52, 73.28, 73.28, 73.44, 73.44, 72.98, 72.98, 72.92, 72.92, 73.04, 73.04, 73.04, 73.04, 72.54, 72.54, 72.5, 72.5, 72.5, 72.5, 72.12, 72.12, 72.46, 72.46, 72.58, 72.58, 72.54, 72.54, 72.56, 72.56, 72.6, 72.6, 72.08, 72.08, 72.38, 72.38, 72.38, 72.38, 72.9, 72.9, 72.96, 72.96, 72.8, 72.8, 72.76, 72.76, 72.88, 72.88, 72.82, 72.82, 72.4, 72.4, 72.34, 72.34, 72.2, 72.2, 72.12, 72.12, 73.92, 73.92, 77.46, 77.46, 78.22, 78.22, 79.8, 79.8, 79.66, 79.66, 79.84, 79.84, 82.46, 82.46, 82.8, 82.8, 82.68, 82.68, 81.48, 81.48, 83.42, 83.42, 83.58, 83.58, 83.74, 83.74, 84.08, 84.08, 83.62, 83.62, 83.68, 83.68, 83.68, 83.68, 83.98, 83.98, 84.24, 84.24, 84.22, 84.22, 84.88, 84.88, 84.64, 84.64, 84.32, 84.32, 84.72, 84.72, 84.66, 84.66, 84.72, 84.72, 84.62, 84.62, 84.68, 84.68, 84.96, 84.96, 85.42, 85.42, 84.32, 84.32]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.314, Test loss: 2.296, Test accuracy: 26.20
Round   0, Global train loss: 2.314, Global test loss: 2.297, Global test accuracy: 25.84
Round   1, Train loss: 2.293, Test loss: 2.281, Test accuracy: 18.14
Round   1, Global train loss: 2.293, Global test loss: 2.282, Global test accuracy: 18.00
Round   2, Train loss: 2.246, Test loss: 2.207, Test accuracy: 26.04
Round   2, Global train loss: 2.246, Global test loss: 2.209, Global test accuracy: 24.58
Round   3, Train loss: 2.101, Test loss: 2.103, Test accuracy: 38.54
Round   3, Global train loss: 2.101, Global test loss: 2.110, Global test accuracy: 37.86
Round   4, Train loss: 2.136, Test loss: 2.072, Test accuracy: 43.10
Round   4, Global train loss: 2.136, Global test loss: 2.121, Global test accuracy: 38.12
Round   5, Train loss: 2.058, Test loss: 2.046, Test accuracy: 45.34
Round   5, Global train loss: 2.058, Global test loss: 2.111, Global test accuracy: 31.20
Round   6, Train loss: 1.945, Test loss: 1.967, Test accuracy: 51.58
Round   6, Global train loss: 1.945, Global test loss: 2.032, Global test accuracy: 42.10
Round   7, Train loss: 1.861, Test loss: 1.919, Test accuracy: 58.38
Round   7, Global train loss: 1.861, Global test loss: 1.993, Global test accuracy: 51.36
Round   8, Train loss: 1.954, Test loss: 1.882, Test accuracy: 63.06
Round   8, Global train loss: 1.954, Global test loss: 2.016, Global test accuracy: 45.36
Round   9, Train loss: 1.874, Test loss: 1.853, Test accuracy: 68.08
Round   9, Global train loss: 1.874, Global test loss: 1.976, Global test accuracy: 57.52
Round  10, Train loss: 1.883, Test loss: 1.827, Test accuracy: 70.92
Round  10, Global train loss: 1.883, Global test loss: 1.964, Global test accuracy: 57.56
Round  11, Train loss: 1.748, Test loss: 1.785, Test accuracy: 73.60
Round  11, Global train loss: 1.748, Global test loss: 1.928, Global test accuracy: 57.98
Round  12, Train loss: 1.668, Test loss: 1.749, Test accuracy: 76.18
Round  12, Global train loss: 1.668, Global test loss: 1.909, Global test accuracy: 56.14
Round  13, Train loss: 1.801, Test loss: 1.734, Test accuracy: 77.56
Round  13, Global train loss: 1.801, Global test loss: 1.903, Global test accuracy: 61.26
Round  14, Train loss: 1.658, Test loss: 1.702, Test accuracy: 82.02
Round  14, Global train loss: 1.658, Global test loss: 1.878, Global test accuracy: 59.66
Round  15, Train loss: 1.619, Test loss: 1.678, Test accuracy: 83.32
Round  15, Global train loss: 1.619, Global test loss: 1.836, Global test accuracy: 70.06
Round  16, Train loss: 1.588, Test loss: 1.652, Test accuracy: 85.72
Round  16, Global train loss: 1.588, Global test loss: 1.855, Global test accuracy: 65.64
Round  17, Train loss: 1.582, Test loss: 1.643, Test accuracy: 86.70
Round  17, Global train loss: 1.582, Global test loss: 1.859, Global test accuracy: 65.92
Round  18, Train loss: 1.995, Test loss: 1.634, Test accuracy: 90.60
Round  18, Global train loss: 1.995, Global test loss: 1.923, Global test accuracy: 63.04
Round  19, Train loss: 1.567, Test loss: 1.619, Test accuracy: 91.64
Round  19, Global train loss: 1.567, Global test loss: 1.897, Global test accuracy: 62.12
Round  20, Train loss: 1.555, Test loss: 1.599, Test accuracy: 92.58
Round  20, Global train loss: 1.555, Global test loss: 1.802, Global test accuracy: 71.70
Round  21, Train loss: 1.740, Test loss: 1.605, Test accuracy: 92.62
Round  21, Global train loss: 1.740, Global test loss: 1.837, Global test accuracy: 69.54
Round  22, Train loss: 1.532, Test loss: 1.600, Test accuracy: 92.54
Round  22, Global train loss: 1.532, Global test loss: 1.861, Global test accuracy: 65.20
Round  23, Train loss: 1.544, Test loss: 1.592, Test accuracy: 92.60
Round  23, Global train loss: 1.544, Global test loss: 1.868, Global test accuracy: 57.96
Round  24, Train loss: 1.735, Test loss: 1.596, Test accuracy: 92.72
Round  24, Global train loss: 1.735, Global test loss: 1.844, Global test accuracy: 66.82
Round  25, Train loss: 1.527, Test loss: 1.591, Test accuracy: 92.88
Round  25, Global train loss: 1.527, Global test loss: 1.844, Global test accuracy: 64.74
Round  26, Train loss: 1.717, Test loss: 1.595, Test accuracy: 93.04
Round  26, Global train loss: 1.717, Global test loss: 1.872, Global test accuracy: 60.24
Round  27, Train loss: 1.510, Test loss: 1.593, Test accuracy: 93.08
Round  27, Global train loss: 1.510, Global test loss: 1.851, Global test accuracy: 65.66
Round  28, Train loss: 1.707, Test loss: 1.598, Test accuracy: 93.00
Round  28, Global train loss: 1.707, Global test loss: 1.869, Global test accuracy: 60.62
Round  29, Train loss: 1.727, Test loss: 1.598, Test accuracy: 93.18
Round  29, Global train loss: 1.727, Global test loss: 1.890, Global test accuracy: 56.94
Round  30, Train loss: 1.537, Test loss: 1.585, Test accuracy: 93.48
Round  30, Global train loss: 1.537, Global test loss: 1.800, Global test accuracy: 74.38
Round  31, Train loss: 1.517, Test loss: 1.574, Test accuracy: 93.86
Round  31, Global train loss: 1.517, Global test loss: 1.846, Global test accuracy: 61.22
Round  32, Train loss: 1.714, Test loss: 1.576, Test accuracy: 93.96
Round  32, Global train loss: 1.714, Global test loss: 1.860, Global test accuracy: 65.46
Round  33, Train loss: 1.716, Test loss: 1.581, Test accuracy: 93.70
Round  33, Global train loss: 1.716, Global test loss: 1.880, Global test accuracy: 57.76
Round  34, Train loss: 1.910, Test loss: 1.592, Test accuracy: 93.28
Round  34, Global train loss: 1.910, Global test loss: 1.859, Global test accuracy: 68.84
Round  35, Train loss: 1.907, Test loss: 1.606, Test accuracy: 92.60
Round  35, Global train loss: 1.907, Global test loss: 1.923, Global test accuracy: 60.60
Round  36, Train loss: 1.519, Test loss: 1.585, Test accuracy: 93.58
Round  36, Global train loss: 1.519, Global test loss: 1.862, Global test accuracy: 65.64
Round  37, Train loss: 1.511, Test loss: 1.571, Test accuracy: 93.84
Round  37, Global train loss: 1.511, Global test loss: 1.800, Global test accuracy: 73.12
Round  38, Train loss: 1.707, Test loss: 1.576, Test accuracy: 93.38
Round  38, Global train loss: 1.707, Global test loss: 1.853, Global test accuracy: 64.84
Round  39, Train loss: 1.695, Test loss: 1.584, Test accuracy: 93.26
Round  39, Global train loss: 1.695, Global test loss: 1.869, Global test accuracy: 64.84
Round  40, Train loss: 1.687, Test loss: 1.591, Test accuracy: 93.10
Round  40, Global train loss: 1.687, Global test loss: 1.875, Global test accuracy: 59.82
Round  41, Train loss: 1.511, Test loss: 1.577, Test accuracy: 93.62
Round  41, Global train loss: 1.511, Global test loss: 1.858, Global test accuracy: 63.88
Round  42, Train loss: 1.501, Test loss: 1.571, Test accuracy: 93.72
Round  42, Global train loss: 1.501, Global test loss: 1.872, Global test accuracy: 62.12
Round  43, Train loss: 1.513, Test loss: 1.567, Test accuracy: 93.36
Round  43, Global train loss: 1.513, Global test loss: 1.849, Global test accuracy: 65.28
Round  44, Train loss: 1.698, Test loss: 1.568, Test accuracy: 93.88
Round  44, Global train loss: 1.698, Global test loss: 1.887, Global test accuracy: 57.28
Round  45, Train loss: 1.883, Test loss: 1.588, Test accuracy: 92.54
Round  45, Global train loss: 1.883, Global test loss: 1.870, Global test accuracy: 66.14
Round  46, Train loss: 1.505, Test loss: 1.573, Test accuracy: 93.70
Round  46, Global train loss: 1.505, Global test loss: 1.880, Global test accuracy: 59.28
Round  47, Train loss: 1.490, Test loss: 1.566, Test accuracy: 93.88
Round  47, Global train loss: 1.490, Global test loss: 1.833, Global test accuracy: 62.74
Round  48, Train loss: 1.502, Test loss: 1.563, Test accuracy: 93.76
Round  48, Global train loss: 1.502, Global test loss: 1.829, Global test accuracy: 64.28
Round  49, Train loss: 1.489, Test loss: 1.559, Test accuracy: 93.90
Round  49, Global train loss: 1.489, Global test loss: 1.870, Global test accuracy: 60.36
Round  50, Train loss: 1.484, Test loss: 1.557, Test accuracy: 94.04
Round  50, Global train loss: 1.484, Global test loss: 1.864, Global test accuracy: 60.68
Round  51, Train loss: 1.692, Test loss: 1.566, Test accuracy: 93.52
Round  51, Global train loss: 1.692, Global test loss: 1.788, Global test accuracy: 74.92
Round  52, Train loss: 1.482, Test loss: 1.564, Test accuracy: 93.74
Round  52, Global train loss: 1.482, Global test loss: 1.828, Global test accuracy: 64.74
Round  53, Train loss: 1.695, Test loss: 1.569, Test accuracy: 93.44
Round  53, Global train loss: 1.695, Global test loss: 1.883, Global test accuracy: 59.46
Round  54, Train loss: 1.680, Test loss: 1.568, Test accuracy: 93.74
Round  54, Global train loss: 1.680, Global test loss: 1.887, Global test accuracy: 60.54
Round  55, Train loss: 1.863, Test loss: 1.585, Test accuracy: 92.86
Round  55, Global train loss: 1.863, Global test loss: 1.931, Global test accuracy: 53.78
Round  56, Train loss: 1.688, Test loss: 1.580, Test accuracy: 92.90
Round  56, Global train loss: 1.688, Global test loss: 1.844, Global test accuracy: 68.28
Round  57, Train loss: 1.487, Test loss: 1.570, Test accuracy: 93.54
Round  57, Global train loss: 1.487, Global test loss: 1.866, Global test accuracy: 59.26
Round  58, Train loss: 1.481, Test loss: 1.563, Test accuracy: 94.04
Round  58, Global train loss: 1.481, Global test loss: 1.827, Global test accuracy: 65.46
Round  59, Train loss: 1.677, Test loss: 1.569, Test accuracy: 92.92
Round  59, Global train loss: 1.677, Global test loss: 1.859, Global test accuracy: 63.32
Round  60, Train loss: 1.490, Test loss: 1.566, Test accuracy: 92.94
Round  60, Global train loss: 1.490, Global test loss: 1.828, Global test accuracy: 64.78
Round  61, Train loss: 1.486, Test loss: 1.560, Test accuracy: 93.58
Round  61, Global train loss: 1.486, Global test loss: 1.781, Global test accuracy: 71.80
Round  62, Train loss: 1.851, Test loss: 1.580, Test accuracy: 92.14
Round  62, Global train loss: 1.851, Global test loss: 1.896, Global test accuracy: 65.78
Round  63, Train loss: 1.658, Test loss: 1.584, Test accuracy: 92.26
Round  63, Global train loss: 1.658, Global test loss: 1.859, Global test accuracy: 65.92
Round  64, Train loss: 1.496, Test loss: 1.571, Test accuracy: 92.82
Round  64, Global train loss: 1.496, Global test loss: 1.791, Global test accuracy: 73.80
Round  65, Train loss: 1.826, Test loss: 1.592, Test accuracy: 91.72
Round  65, Global train loss: 1.826, Global test loss: 1.883, Global test accuracy: 63.66
Round  66, Train loss: 1.482, Test loss: 1.580, Test accuracy: 92.36
Round  66, Global train loss: 1.482, Global test loss: 1.879, Global test accuracy: 58.22
Round  67, Train loss: 1.664, Test loss: 1.578, Test accuracy: 91.92
Round  67, Global train loss: 1.664, Global test loss: 1.878, Global test accuracy: 62.04
Round  68, Train loss: 1.648, Test loss: 1.582, Test accuracy: 92.08
Round  68, Global train loss: 1.648, Global test loss: 1.855, Global test accuracy: 64.60
Round  69, Train loss: 1.487, Test loss: 1.569, Test accuracy: 92.70
Round  69, Global train loss: 1.487, Global test loss: 1.789, Global test accuracy: 73.98
Round  70, Train loss: 1.640, Test loss: 1.578, Test accuracy: 92.46
Round  70, Global train loss: 1.640, Global test loss: 1.843, Global test accuracy: 63.84
Round  71, Train loss: 1.487, Test loss: 1.565, Test accuracy: 92.96
Round  71, Global train loss: 1.487, Global test loss: 1.787, Global test accuracy: 73.26
Round  72, Train loss: 1.480, Test loss: 1.560, Test accuracy: 93.18
Round  72, Global train loss: 1.480, Global test loss: 1.739, Global test accuracy: 79.24
Round  73, Train loss: 1.646, Test loss: 1.569, Test accuracy: 92.30
Round  73, Global train loss: 1.646, Global test loss: 1.813, Global test accuracy: 68.36
Round  74, Train loss: 1.640, Test loss: 1.576, Test accuracy: 91.74
Round  74, Global train loss: 1.640, Global test loss: 1.878, Global test accuracy: 61.16
Round  75, Train loss: 1.640, Test loss: 1.583, Test accuracy: 91.30
Round  75, Global train loss: 1.640, Global test loss: 1.861, Global test accuracy: 63.10
Round  76, Train loss: 1.633, Test loss: 1.588, Test accuracy: 90.76
Round  76, Global train loss: 1.633, Global test loss: 1.902, Global test accuracy: 60.60
Round  77, Train loss: 1.768, Test loss: 1.607, Test accuracy: 89.36
Round  77, Global train loss: 1.768, Global test loss: 1.906, Global test accuracy: 60.52
Round  78, Train loss: 1.626, Test loss: 1.605, Test accuracy: 89.78
Round  78, Global train loss: 1.626, Global test loss: 1.858, Global test accuracy: 63.02
Round  79, Train loss: 1.489, Test loss: 1.579, Test accuracy: 91.64
Round  79, Global train loss: 1.489, Global test loss: 1.801, Global test accuracy: 71.78
Round  80, Train loss: 1.491, Test loss: 1.567, Test accuracy: 91.94
Round  80, Global train loss: 1.491, Global test loss: 1.901, Global test accuracy: 58.40
Round  81, Train loss: 1.625, Test loss: 1.581, Test accuracy: 90.98
Round  81, Global train loss: 1.625, Global test loss: 1.889, Global test accuracy: 58.60
Round  82, Train loss: 1.614, Test loss: 1.591, Test accuracy: 90.68
Round  82, Global train loss: 1.614, Global test loss: 1.942, Global test accuracy: 52.56
Round  83, Train loss: 1.609, Test loss: 1.599, Test accuracy: 89.98
Round  83, Global train loss: 1.609, Global test loss: 1.920, Global test accuracy: 56.56
Round  84, Train loss: 1.490, Test loss: 1.573, Test accuracy: 91.92
Round  84, Global train loss: 1.490, Global test loss: 1.869, Global test accuracy: 61.82
Round  85, Train loss: 1.753, Test loss: 1.607, Test accuracy: 89.06
Round  85, Global train loss: 1.753, Global test loss: 1.943, Global test accuracy: 58.40
Round  86, Train loss: 1.616, Test loss: 1.594, Test accuracy: 89.82
Round  86, Global train loss: 1.616, Global test loss: 1.877, Global test accuracy: 66.84
Round  87, Train loss: 1.485, Test loss: 1.581, Test accuracy: 90.56
Round  87, Global train loss: 1.485, Global test loss: 1.824, Global test accuracy: 68.28
Round  88, Train loss: 1.475, Test loss: 1.576, Test accuracy: 91.04
Round  88, Global train loss: 1.475, Global test loss: 1.843, Global test accuracy: 60.94
Round  89, Train loss: 1.606, Test loss: 1.582, Test accuracy: 90.68
Round  89, Global train loss: 1.606, Global test loss: 1.853, Global test accuracy: 69.08
Round  90, Train loss: 1.479, Test loss: 1.572, Test accuracy: 91.54
Round  90, Global train loss: 1.479, Global test loss: 1.841, Global test accuracy: 60.24
Round  91, Train loss: 1.474, Test loss: 1.568, Test accuracy: 92.08
Round  91, Global train loss: 1.474, Global test loss: 1.840, Global test accuracy: 60.18
Round  92, Train loss: 1.611, Test loss: 1.576, Test accuracy: 91.24
Round  92, Global train loss: 1.611, Global test loss: 1.862, Global test accuracy: 61.66/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  93, Train loss: 1.597, Test loss: 1.587, Test accuracy: 90.50
Round  93, Global train loss: 1.597, Global test loss: 1.869, Global test accuracy: 57.52
Round  94, Train loss: 1.592, Test loss: 1.586, Test accuracy: 90.48
Round  94, Global train loss: 1.592, Global test loss: 1.859, Global test accuracy: 64.70
Round  95, Train loss: 1.480, Test loss: 1.577, Test accuracy: 91.04
Round  95, Global train loss: 1.480, Global test loss: 1.877, Global test accuracy: 60.70
Round  96, Train loss: 1.474, Test loss: 1.575, Test accuracy: 91.00
Round  96, Global train loss: 1.474, Global test loss: 1.867, Global test accuracy: 61.80
Round  97, Train loss: 1.476, Test loss: 1.568, Test accuracy: 91.66
Round  97, Global train loss: 1.476, Global test loss: 1.829, Global test accuracy: 62.62
Round  98, Train loss: 1.609, Test loss: 1.577, Test accuracy: 90.98
Round  98, Global train loss: 1.609, Global test loss: 1.811, Global test accuracy: 70.06
Round  99, Train loss: 1.473, Test loss: 1.573, Test accuracy: 91.06
Round  99, Global train loss: 1.473, Global test loss: 1.825, Global test accuracy: 68.12
Final Round, Train loss: 1.541, Test loss: 1.577, Test accuracy: 90.42
Final Round, Global train loss: 1.541, Global test loss: 1.825, Global test accuracy: 68.12
Average accuracy final 10 rounds: 91.158
715.7772092819214
[1.6746103763580322, 3.1295716762542725, 4.56863260269165, 5.9636290073394775, 7.5369532108306885, 9.460958003997803, 11.150172710418701, 12.928753852844238, 15.265299797058105, 16.61306095123291, 17.876920223236084, 19.038876056671143, 20.27521562576294, 21.6258487701416, 22.892427682876587, 24.123762369155884, 25.36225962638855, 26.737483501434326, 28.029701471328735, 29.256879091262817, 30.714624643325806, 31.96165704727173, 33.124621868133545, 34.42820739746094, 35.748820304870605, 36.96412682533264, 38.2676317691803, 39.50687551498413, 40.76535725593567, 42.095858335494995, 43.50809359550476, 44.794737339019775, 46.17371082305908, 47.476752042770386, 48.736589670181274, 49.88605999946594, 51.2148597240448, 52.4937310218811, 53.7300820350647, 55.035802602767944, 56.22742056846619, 57.565293312072754, 59.09071636199951, 60.48655676841736, 61.76067757606506, 62.986310958862305, 64.25542855262756, 65.52353930473328, 67.04649090766907, 68.28966236114502, 69.59044551849365, 70.87032771110535, 72.23932218551636, 73.46790909767151, 74.76430940628052, 75.9730327129364, 77.29060363769531, 78.55249762535095, 80.0341260433197, 81.45109415054321, 82.76989531517029, 84.15295720100403, 85.4727075099945, 86.80575942993164, 88.21684861183167, 89.5316276550293, 90.95703721046448, 92.3578155040741, 93.64814162254333, 94.95785450935364, 96.39433121681213, 97.75176334381104, 99.1564621925354, 100.51900553703308, 101.73144197463989, 103.09969067573547, 104.42240476608276, 105.8816487789154, 107.2391996383667, 108.61228966712952, 110.11560082435608, 111.3639166355133, 112.69137406349182, 114.0158281326294, 115.2272961139679, 116.46044039726257, 117.63744759559631, 118.8889491558075, 120.07164216041565, 121.45059657096863, 122.74412751197815, 124.1428005695343, 125.45024824142456, 126.7781708240509, 128.00356006622314, 129.302729845047, 130.64423871040344, 132.2580156326294, 133.53757286071777, 134.79752945899963, 137.0651285648346]
[26.2, 18.14, 26.04, 38.54, 43.1, 45.34, 51.58, 58.38, 63.06, 68.08, 70.92, 73.6, 76.18, 77.56, 82.02, 83.32, 85.72, 86.7, 90.6, 91.64, 92.58, 92.62, 92.54, 92.6, 92.72, 92.88, 93.04, 93.08, 93.0, 93.18, 93.48, 93.86, 93.96, 93.7, 93.28, 92.6, 93.58, 93.84, 93.38, 93.26, 93.1, 93.62, 93.72, 93.36, 93.88, 92.54, 93.7, 93.88, 93.76, 93.9, 94.04, 93.52, 93.74, 93.44, 93.74, 92.86, 92.9, 93.54, 94.04, 92.92, 92.94, 93.58, 92.14, 92.26, 92.82, 91.72, 92.36, 91.92, 92.08, 92.7, 92.46, 92.96, 93.18, 92.3, 91.74, 91.3, 90.76, 89.36, 89.78, 91.64, 91.94, 90.98, 90.68, 89.98, 91.92, 89.06, 89.82, 90.56, 91.04, 90.68, 91.54, 92.08, 91.24, 90.5, 90.48, 91.04, 91.0, 91.66, 90.98, 91.06, 90.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.320, Test loss: 2.299, Test accuracy: 13.02
Round   0, Global train loss: 2.320, Global test loss: 2.301, Global test accuracy: 10.64
Round   1, Train loss: 2.292, Test loss: 2.291, Test accuracy: 30.46
Round   1, Global train loss: 2.292, Global test loss: 2.296, Global test accuracy: 27.52
Round   2, Train loss: 2.279, Test loss: 2.273, Test accuracy: 37.96
Round   2, Global train loss: 2.279, Global test loss: 2.286, Global test accuracy: 27.60
Round   3, Train loss: 2.239, Test loss: 2.195, Test accuracy: 45.00
Round   3, Global train loss: 2.239, Global test loss: 2.233, Global test accuracy: 34.10
Round   4, Train loss: 2.104, Test loss: 2.044, Test accuracy: 47.56
Round   4, Global train loss: 2.104, Global test loss: 2.124, Global test accuracy: 37.22
Round   5, Train loss: 1.995, Test loss: 1.952, Test accuracy: 54.42
Round   5, Global train loss: 1.995, Global test loss: 2.069, Global test accuracy: 39.08
Round   6, Train loss: 1.919, Test loss: 1.874, Test accuracy: 62.80
Round   6, Global train loss: 1.919, Global test loss: 2.029, Global test accuracy: 47.20
Round   7, Train loss: 1.836, Test loss: 1.784, Test accuracy: 76.88
Round   7, Global train loss: 1.836, Global test loss: 1.981, Global test accuracy: 65.34
Round   8, Train loss: 1.774, Test loss: 1.721, Test accuracy: 83.92
Round   8, Global train loss: 1.774, Global test loss: 1.936, Global test accuracy: 72.58
Round   9, Train loss: 1.736, Test loss: 1.683, Test accuracy: 86.42
Round   9, Global train loss: 1.736, Global test loss: 1.900, Global test accuracy: 75.58
Round  10, Train loss: 1.798, Test loss: 1.664, Test accuracy: 88.30
Round  10, Global train loss: 1.798, Global test loss: 1.979, Global test accuracy: 53.84
Round  11, Train loss: 1.717, Test loss: 1.644, Test accuracy: 88.48
Round  11, Global train loss: 1.717, Global test loss: 1.907, Global test accuracy: 60.10
Round  12, Train loss: 1.685, Test loss: 1.635, Test accuracy: 88.96
Round  12, Global train loss: 1.685, Global test loss: 1.966, Global test accuracy: 48.52
Round  13, Train loss: 1.579, Test loss: 1.618, Test accuracy: 89.64
Round  13, Global train loss: 1.579, Global test loss: 1.860, Global test accuracy: 64.60
Round  14, Train loss: 1.549, Test loss: 1.610, Test accuracy: 89.98
Round  14, Global train loss: 1.549, Global test loss: 1.847, Global test accuracy: 64.16
Round  15, Train loss: 1.661, Test loss: 1.606, Test accuracy: 90.22
Round  15, Global train loss: 1.661, Global test loss: 1.827, Global test accuracy: 71.60
Round  16, Train loss: 1.547, Test loss: 1.600, Test accuracy: 90.58
Round  16, Global train loss: 1.547, Global test loss: 1.853, Global test accuracy: 63.84
Round  17, Train loss: 1.547, Test loss: 1.597, Test accuracy: 90.28
Round  17, Global train loss: 1.547, Global test loss: 1.842, Global test accuracy: 65.98
Round  18, Train loss: 1.685, Test loss: 1.591, Test accuracy: 90.54
Round  18, Global train loss: 1.685, Global test loss: 1.905, Global test accuracy: 55.46
Round  19, Train loss: 1.534, Test loss: 1.591, Test accuracy: 90.80
Round  19, Global train loss: 1.534, Global test loss: 1.929, Global test accuracy: 54.24
Round  20, Train loss: 1.636, Test loss: 1.585, Test accuracy: 91.74
Round  20, Global train loss: 1.636, Global test loss: 1.806, Global test accuracy: 72.58
Round  21, Train loss: 1.634, Test loss: 1.585, Test accuracy: 91.84
Round  21, Global train loss: 1.634, Global test loss: 1.817, Global test accuracy: 70.26
Round  22, Train loss: 1.631, Test loss: 1.582, Test accuracy: 92.20
Round  22, Global train loss: 1.631, Global test loss: 1.906, Global test accuracy: 56.62
Round  23, Train loss: 1.638, Test loss: 1.579, Test accuracy: 92.26
Round  23, Global train loss: 1.638, Global test loss: 1.907, Global test accuracy: 55.04
Round  24, Train loss: 1.745, Test loss: 1.582, Test accuracy: 91.72
Round  24, Global train loss: 1.745, Global test loss: 1.871, Global test accuracy: 63.40
Round  25, Train loss: 1.525, Test loss: 1.579, Test accuracy: 92.34
Round  25, Global train loss: 1.525, Global test loss: 1.883, Global test accuracy: 57.76
Round  26, Train loss: 1.615, Test loss: 1.578, Test accuracy: 92.18
Round  26, Global train loss: 1.615, Global test loss: 1.908, Global test accuracy: 56.50
Round  27, Train loss: 1.509, Test loss: 1.574, Test accuracy: 92.60
Round  27, Global train loss: 1.509, Global test loss: 1.876, Global test accuracy: 60.82
Round  28, Train loss: 1.602, Test loss: 1.576, Test accuracy: 91.98
Round  28, Global train loss: 1.602, Global test loss: 1.912, Global test accuracy: 55.94
Round  29, Train loss: 1.629, Test loss: 1.573, Test accuracy: 92.18
Round  29, Global train loss: 1.629, Global test loss: 1.924, Global test accuracy: 52.86
Round  30, Train loss: 1.523, Test loss: 1.570, Test accuracy: 92.58
Round  30, Global train loss: 1.523, Global test loss: 1.835, Global test accuracy: 67.74
Round  31, Train loss: 1.600, Test loss: 1.573, Test accuracy: 91.80
Round  31, Global train loss: 1.600, Global test loss: 1.879, Global test accuracy: 58.84
Round  32, Train loss: 1.509, Test loss: 1.572, Test accuracy: 91.78
Round  32, Global train loss: 1.509, Global test loss: 1.856, Global test accuracy: 65.00
Round  33, Train loss: 1.619, Test loss: 1.568, Test accuracy: 92.20
Round  33, Global train loss: 1.619, Global test loss: 1.922, Global test accuracy: 53.20
Round  34, Train loss: 1.622, Test loss: 1.570, Test accuracy: 92.40
Round  34, Global train loss: 1.622, Global test loss: 1.841, Global test accuracy: 66.36
Round  35, Train loss: 1.620, Test loss: 1.572, Test accuracy: 92.06
Round  35, Global train loss: 1.620, Global test loss: 1.871, Global test accuracy: 59.40
Round  36, Train loss: 1.505, Test loss: 1.568, Test accuracy: 92.30
Round  36, Global train loss: 1.505, Global test loss: 1.909, Global test accuracy: 56.78
Round  37, Train loss: 1.503, Test loss: 1.563, Test accuracy: 92.50
Round  37, Global train loss: 1.503, Global test loss: 1.818, Global test accuracy: 67.44
Round  38, Train loss: 1.612, Test loss: 1.569, Test accuracy: 92.12
Round  38, Global train loss: 1.612, Global test loss: 1.846, Global test accuracy: 64.60
Round  39, Train loss: 1.497, Test loss: 1.565, Test accuracy: 92.38
Round  39, Global train loss: 1.497, Global test loss: 1.840, Global test accuracy: 67.44
Round  40, Train loss: 1.580, Test loss: 1.564, Test accuracy: 92.18
Round  40, Global train loss: 1.580, Global test loss: 1.905, Global test accuracy: 56.40
Round  41, Train loss: 1.499, Test loss: 1.563, Test accuracy: 92.34
Round  41, Global train loss: 1.499, Global test loss: 1.860, Global test accuracy: 63.80
Round  42, Train loss: 1.496, Test loss: 1.562, Test accuracy: 92.44
Round  42, Global train loss: 1.496, Global test loss: 1.880, Global test accuracy: 61.70
Round  43, Train loss: 1.507, Test loss: 1.557, Test accuracy: 92.76
Round  43, Global train loss: 1.507, Global test loss: 1.889, Global test accuracy: 60.14
Round  44, Train loss: 1.582, Test loss: 1.558, Test accuracy: 92.74
Round  44, Global train loss: 1.582, Global test loss: 1.918, Global test accuracy: 51.88
Round  45, Train loss: 1.684, Test loss: 1.568, Test accuracy: 91.76
Round  45, Global train loss: 1.684, Global test loss: 1.953, Global test accuracy: 53.64
Round  46, Train loss: 1.500, Test loss: 1.565, Test accuracy: 92.24
Round  46, Global train loss: 1.500, Global test loss: 1.915, Global test accuracy: 55.80
Round  47, Train loss: 1.487, Test loss: 1.559, Test accuracy: 92.98
Round  47, Global train loss: 1.487, Global test loss: 1.840, Global test accuracy: 63.04
Round  48, Train loss: 1.582, Test loss: 1.556, Test accuracy: 92.92
Round  48, Global train loss: 1.582, Global test loss: 1.862, Global test accuracy: 61.00
Round  49, Train loss: 1.490, Test loss: 1.555, Test accuracy: 92.98
Round  49, Global train loss: 1.490, Global test loss: 1.918, Global test accuracy: 55.54
Round  50, Train loss: 1.484, Test loss: 1.553, Test accuracy: 93.46
Round  50, Global train loss: 1.484, Global test loss: 1.912, Global test accuracy: 56.22
Round  51, Train loss: 1.581, Test loss: 1.556, Test accuracy: 92.96
Round  51, Global train loss: 1.581, Global test loss: 1.791, Global test accuracy: 71.72
Round  52, Train loss: 1.563, Test loss: 1.560, Test accuracy: 92.76
Round  52, Global train loss: 1.563, Global test loss: 1.878, Global test accuracy: 60.48
Round  53, Train loss: 1.604, Test loss: 1.561, Test accuracy: 92.46
Round  53, Global train loss: 1.604, Global test loss: 1.983, Global test accuracy: 41.82
Round  54, Train loss: 1.491, Test loss: 1.559, Test accuracy: 92.44
Round  54, Global train loss: 1.491, Global test loss: 1.868, Global test accuracy: 60.10
Round  55, Train loss: 1.590, Test loss: 1.564, Test accuracy: 91.90
Round  55, Global train loss: 1.590, Global test loss: 1.925, Global test accuracy: 52.30
Round  56, Train loss: 1.594, Test loss: 1.565, Test accuracy: 92.04
Round  56, Global train loss: 1.594, Global test loss: 1.876, Global test accuracy: 60.52
Round  57, Train loss: 1.562, Test loss: 1.564, Test accuracy: 91.96
Round  57, Global train loss: 1.562, Global test loss: 1.900, Global test accuracy: 57.06
Round  58, Train loss: 1.483, Test loss: 1.559, Test accuracy: 92.60
Round  58, Global train loss: 1.483, Global test loss: 1.877, Global test accuracy: 57.62
Round  59, Train loss: 1.582, Test loss: 1.558, Test accuracy: 92.50
Round  59, Global train loss: 1.582, Global test loss: 1.898, Global test accuracy: 60.80
Round  60, Train loss: 1.564, Test loss: 1.566, Test accuracy: 91.76
Round  60, Global train loss: 1.564, Global test loss: 1.856, Global test accuracy: 62.12
Round  61, Train loss: 1.488, Test loss: 1.557, Test accuracy: 92.46
Round  61, Global train loss: 1.488, Global test loss: 1.793, Global test accuracy: 72.04
Round  62, Train loss: 1.574, Test loss: 1.563, Test accuracy: 91.90
Round  62, Global train loss: 1.574, Global test loss: 1.872, Global test accuracy: 61.18
Round  63, Train loss: 1.483, Test loss: 1.562, Test accuracy: 92.16
Round  63, Global train loss: 1.483, Global test loss: 1.847, Global test accuracy: 61.40
Round  64, Train loss: 1.566, Test loss: 1.565, Test accuracy: 91.68
Round  64, Global train loss: 1.566, Global test loss: 1.811, Global test accuracy: 70.02
Round  65, Train loss: 1.571, Test loss: 1.564, Test accuracy: 91.88
Round  65, Global train loss: 1.571, Global test loss: 1.860, Global test accuracy: 62.06
Round  66, Train loss: 1.553, Test loss: 1.568, Test accuracy: 91.76
Round  66, Global train loss: 1.553, Global test loss: 1.911, Global test accuracy: 55.22
Round  67, Train loss: 1.578, Test loss: 1.568, Test accuracy: 91.62
Round  67, Global train loss: 1.578, Global test loss: 1.911, Global test accuracy: 52.28
Round  68, Train loss: 1.486, Test loss: 1.561, Test accuracy: 92.02
Round  68, Global train loss: 1.486, Global test loss: 1.813, Global test accuracy: 68.98
Round  69, Train loss: 1.484, Test loss: 1.553, Test accuracy: 92.56
Round  69, Global train loss: 1.484, Global test loss: 1.830, Global test accuracy: 67.16
Round  70, Train loss: 1.479, Test loss: 1.552, Test accuracy: 92.66
Round  70, Global train loss: 1.479, Global test loss: 1.782, Global test accuracy: 72.56
Round  71, Train loss: 1.551, Test loss: 1.559, Test accuracy: 92.18
Round  71, Global train loss: 1.551, Global test loss: 1.813, Global test accuracy: 69.14
Round  72, Train loss: 1.547, Test loss: 1.566, Test accuracy: 91.84
Round  72, Global train loss: 1.547, Global test loss: 1.810, Global test accuracy: 71.18
Round  73, Train loss: 1.567, Test loss: 1.566, Test accuracy: 91.98
Round  73, Global train loss: 1.567, Global test loss: 1.871, Global test accuracy: 62.28
Round  74, Train loss: 1.564, Test loss: 1.567, Test accuracy: 91.62
Round  74, Global train loss: 1.564, Global test loss: 1.912, Global test accuracy: 52.08
Round  75, Train loss: 1.481, Test loss: 1.561, Test accuracy: 92.00
Round  75, Global train loss: 1.481, Global test loss: 1.821, Global test accuracy: 67.66
Round  76, Train loss: 1.625, Test loss: 1.573, Test accuracy: 91.42
Round  76, Global train loss: 1.625, Global test loss: 1.941, Global test accuracy: 53.58
Round  77, Train loss: 1.560, Test loss: 1.572, Test accuracy: 91.72
Round  77, Global train loss: 1.560, Global test loss: 1.877, Global test accuracy: 58.56
Round  78, Train loss: 1.481, Test loss: 1.562, Test accuracy: 92.24
Round  78, Global train loss: 1.481, Global test loss: 1.799, Global test accuracy: 70.90
Round  79, Train loss: 1.544, Test loss: 1.570, Test accuracy: 91.58
Round  79, Global train loss: 1.544, Global test loss: 1.825, Global test accuracy: 67.88
Round  80, Train loss: 1.481, Test loss: 1.561, Test accuracy: 92.00
Round  80, Global train loss: 1.481, Global test loss: 1.766, Global test accuracy: 76.94
Round  81, Train loss: 1.477, Test loss: 1.556, Test accuracy: 92.12
Round  81, Global train loss: 1.477, Global test loss: 1.755, Global test accuracy: 77.94
Round  82, Train loss: 1.476, Test loss: 1.554, Test accuracy: 92.38
Round  82, Global train loss: 1.476, Global test loss: 1.749, Global test accuracy: 78.44
Round  83, Train loss: 1.475, Test loss: 1.553, Test accuracy: 92.42
Round  83, Global train loss: 1.475, Global test loss: 1.746, Global test accuracy: 78.52
Round  84, Train loss: 1.474, Test loss: 1.551, Test accuracy: 92.58
Round  84, Global train loss: 1.474, Global test loss: 1.743, Global test accuracy: 78.82
Round  85, Train loss: 1.474, Test loss: 1.550, Test accuracy: 92.48
Round  85, Global train loss: 1.474, Global test loss: 1.741, Global test accuracy: 79.10
Round  86, Train loss: 1.473, Test loss: 1.549, Test accuracy: 92.68
Round  86, Global train loss: 1.473, Global test loss: 1.739, Global test accuracy: 79.48
Round  87, Train loss: 1.473, Test loss: 1.549, Test accuracy: 92.68
Round  87, Global train loss: 1.473, Global test loss: 1.739, Global test accuracy: 79.36
Round  88, Train loss: 1.472, Test loss: 1.549, Test accuracy: 92.60
Round  88, Global train loss: 1.472, Global test loss: 1.739, Global test accuracy: 79.32
Round  89, Train loss: 1.472, Test loss: 1.548, Test accuracy: 92.62
Round  89, Global train loss: 1.472, Global test loss: 1.738, Global test accuracy: 79.42
Round  90, Train loss: 1.472, Test loss: 1.548, Test accuracy: 92.66
Round  90, Global train loss: 1.472, Global test loss: 1.737, Global test accuracy: 79.54
Round  91, Train loss: 1.472, Test loss: 1.547, Test accuracy: 92.80
Round  91, Global train loss: 1.472, Global test loss: 1.737, Global test accuracy: 79.60/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.471, Test loss: 1.547, Test accuracy: 92.88
Round  92, Global train loss: 1.471, Global test loss: 1.736, Global test accuracy: 79.70
Round  93, Train loss: 1.471, Test loss: 1.547, Test accuracy: 92.90
Round  93, Global train loss: 1.471, Global test loss: 1.736, Global test accuracy: 79.64
Round  94, Train loss: 1.471, Test loss: 1.546, Test accuracy: 92.98
Round  94, Global train loss: 1.471, Global test loss: 1.735, Global test accuracy: 79.70
Round  95, Train loss: 1.471, Test loss: 1.546, Test accuracy: 92.96
Round  95, Global train loss: 1.471, Global test loss: 1.736, Global test accuracy: 79.64
Round  96, Train loss: 1.471, Test loss: 1.546, Test accuracy: 93.00
Round  96, Global train loss: 1.471, Global test loss: 1.735, Global test accuracy: 79.54
Round  97, Train loss: 1.471, Test loss: 1.546, Test accuracy: 93.06
Round  97, Global train loss: 1.471, Global test loss: 1.735, Global test accuracy: 79.62
Round  98, Train loss: 1.470, Test loss: 1.545, Test accuracy: 93.04
Round  98, Global train loss: 1.470, Global test loss: 1.735, Global test accuracy: 79.60
Round  99, Train loss: 1.517, Test loss: 1.550, Test accuracy: 92.64
Round  99, Global train loss: 1.517, Global test loss: 1.712, Global test accuracy: 86.64
Final Round, Train loss: 1.550, Test loss: 1.549, Test accuracy: 92.74
Final Round, Global train loss: 1.550, Global test loss: 1.712, Global test accuracy: 86.64
Average accuracy final 10 rounds: 92.892
1285.493378162384
[1.603149652481079, 3.0392324924468994, 4.550504446029663, 6.040145397186279, 7.50131630897522, 8.957875728607178, 10.461886167526245, 11.873816013336182, 13.355625867843628, 15.252254962921143, 20.393418073654175, 28.08056950569153, 36.29454207420349, 37.588072061538696, 39.009949684143066, 46.74422788619995, 48.112059354782104, 49.56089401245117, 57.25984716415405, 58.72319746017456, 66.33351397514343, 73.57085800170898, 81.14148831367493, 88.70894432067871, 96.66448068618774, 98.09325075149536, 106.02726340293884, 107.4871895313263, 115.18481349945068, 123.265456199646, 124.67548775672913, 132.6899483203888, 134.01468062400818, 141.542147397995, 149.34290528297424, 157.39789724349976, 158.68059587478638, 160.05748677253723, 168.26586246490479, 169.6985878944397, 177.43090152740479, 178.85721111297607, 180.18738389015198, 181.49490571022034, 189.4179298877716, 199.82789659500122, 201.24952220916748, 202.73184394836426, 210.6420121192932, 212.1527714729309, 213.55695724487305, 221.34396314620972, 229.38923025131226, 237.28355503082275, 238.72708916664124, 246.76083374023438, 254.45482397079468, 262.6127681732178, 264.0444221496582, 272.2811243534088, 280.1291449069977, 281.5561430454254, 289.51174902915955, 290.8254539966583, 298.49627161026, 306.2583968639374, 314.02159333229065, 321.4650149345398, 322.95997953414917, 324.37436604499817, 325.72419905662537, 333.61011362075806, 341.6624228954315, 349.5506043434143, 357.26910305023193, 358.6385328769684, 366.88066601753235, 374.88363814353943, 376.44452261924744, 384.2137861251831, 385.6048672199249, 387.0416946411133, 388.55470991134644, 390.2573883533478, 391.76216554641724, 393.21587324142456, 394.6844599246979, 396.1490533351898, 397.7357316017151, 399.3013072013855, 400.7790596485138, 402.31145453453064, 403.7810950279236, 405.1973133087158, 406.7856431007385, 408.2240173816681, 409.63228964805603, 411.1132142543793, 412.65555715560913, 420.6348431110382, 428.79056334495544]
[13.02, 30.46, 37.96, 45.0, 47.56, 54.42, 62.8, 76.88, 83.92, 86.42, 88.3, 88.48, 88.96, 89.64, 89.98, 90.22, 90.58, 90.28, 90.54, 90.8, 91.74, 91.84, 92.2, 92.26, 91.72, 92.34, 92.18, 92.6, 91.98, 92.18, 92.58, 91.8, 91.78, 92.2, 92.4, 92.06, 92.3, 92.5, 92.12, 92.38, 92.18, 92.34, 92.44, 92.76, 92.74, 91.76, 92.24, 92.98, 92.92, 92.98, 93.46, 92.96, 92.76, 92.46, 92.44, 91.9, 92.04, 91.96, 92.6, 92.5, 91.76, 92.46, 91.9, 92.16, 91.68, 91.88, 91.76, 91.62, 92.02, 92.56, 92.66, 92.18, 91.84, 91.98, 91.62, 92.0, 91.42, 91.72, 92.24, 91.58, 92.0, 92.12, 92.38, 92.42, 92.58, 92.48, 92.68, 92.68, 92.6, 92.62, 92.66, 92.8, 92.88, 92.9, 92.98, 92.96, 93.0, 93.06, 93.04, 92.64, 92.74]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 2, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.293, Test loss: 2.294, Test accuracy: 12.72
Round   0, Global train loss: 2.293, Global test loss: 2.298, Global test accuracy: 10.04
Round   1, Train loss: 2.263, Test loss: 2.254, Test accuracy: 27.20
Round   1, Global train loss: 2.263, Global test loss: 2.273, Global test accuracy: 21.56
Round   2, Train loss: 2.191, Test loss: 2.162, Test accuracy: 37.08
Round   2, Global train loss: 2.191, Global test loss: 2.182, Global test accuracy: 32.34
Round   3, Train loss: 2.102, Test loss: 2.106, Test accuracy: 41.18
Round   3, Global train loss: 2.102, Global test loss: 2.191, Global test accuracy: 29.66
Round   4, Train loss: 2.080, Test loss: 2.004, Test accuracy: 50.36
Round   4, Global train loss: 2.080, Global test loss: 2.166, Global test accuracy: 27.34
Round   5, Train loss: 1.864, Test loss: 1.965, Test accuracy: 56.00
Round   5, Global train loss: 1.864, Global test loss: 2.138, Global test accuracy: 31.94
Round   6, Train loss: 1.929, Test loss: 1.908, Test accuracy: 61.62
Round   6, Global train loss: 1.929, Global test loss: 2.113, Global test accuracy: 41.08
Round   7, Train loss: 1.881, Test loss: 1.840, Test accuracy: 69.26
Round   7, Global train loss: 1.881, Global test loss: 2.096, Global test accuracy: 42.38
Round   8, Train loss: 1.840, Test loss: 1.784, Test accuracy: 72.18
Round   8, Global train loss: 1.840, Global test loss: 2.062, Global test accuracy: 38.68
Round   9, Train loss: 1.728, Test loss: 1.758, Test accuracy: 75.84
Round   9, Global train loss: 1.728, Global test loss: 2.005, Global test accuracy: 53.20
Round  10, Train loss: 1.760, Test loss: 1.736, Test accuracy: 75.78
Round  10, Global train loss: 1.760, Global test loss: 2.041, Global test accuracy: 46.74
Round  11, Train loss: 1.745, Test loss: 1.726, Test accuracy: 76.30
Round  11, Global train loss: 1.745, Global test loss: 2.003, Global test accuracy: 53.08
Round  12, Train loss: 1.746, Test loss: 1.711, Test accuracy: 76.56
Round  12, Global train loss: 1.746, Global test loss: 2.037, Global test accuracy: 39.78
Round  13, Train loss: 1.645, Test loss: 1.697, Test accuracy: 77.58
Round  13, Global train loss: 1.645, Global test loss: 1.998, Global test accuracy: 47.62
Round  14, Train loss: 1.806, Test loss: 1.641, Test accuracy: 83.92
Round  14, Global train loss: 1.806, Global test loss: 1.926, Global test accuracy: 54.66
Round  15, Train loss: 1.630, Test loss: 1.628, Test accuracy: 85.20
Round  15, Global train loss: 1.630, Global test loss: 1.994, Global test accuracy: 50.34
Round  16, Train loss: 1.616, Test loss: 1.622, Test accuracy: 85.44
Round  16, Global train loss: 1.616, Global test loss: 1.990, Global test accuracy: 46.86
Round  17, Train loss: 1.631, Test loss: 1.620, Test accuracy: 85.60
Round  17, Global train loss: 1.631, Global test loss: 1.985, Global test accuracy: 49.00
Round  18, Train loss: 1.636, Test loss: 1.612, Test accuracy: 86.74
Round  18, Global train loss: 1.636, Global test loss: 2.026, Global test accuracy: 46.24
Round  19, Train loss: 1.603, Test loss: 1.593, Test accuracy: 88.52
Round  19, Global train loss: 1.603, Global test loss: 2.074, Global test accuracy: 37.94
Round  20, Train loss: 1.577, Test loss: 1.593, Test accuracy: 88.52
Round  20, Global train loss: 1.577, Global test loss: 1.973, Global test accuracy: 51.98
Round  21, Train loss: 1.481, Test loss: 1.592, Test accuracy: 88.48
Round  21, Global train loss: 1.481, Global test loss: 1.922, Global test accuracy: 59.76
Round  22, Train loss: 1.495, Test loss: 1.591, Test accuracy: 88.52
Round  22, Global train loss: 1.495, Global test loss: 2.190, Global test accuracy: 24.56
Round  23, Train loss: 1.649, Test loss: 1.590, Test accuracy: 88.52
Round  23, Global train loss: 1.649, Global test loss: 2.156, Global test accuracy: 31.52
Round  24, Train loss: 1.513, Test loss: 1.582, Test accuracy: 89.02
Round  24, Global train loss: 1.513, Global test loss: 2.126, Global test accuracy: 31.22
Round  25, Train loss: 1.578, Test loss: 1.581, Test accuracy: 89.12
Round  25, Global train loss: 1.578, Global test loss: 1.967, Global test accuracy: 49.82
Round  26, Train loss: 1.556, Test loss: 1.580, Test accuracy: 89.20
Round  26, Global train loss: 1.556, Global test loss: 2.039, Global test accuracy: 44.64
Round  27, Train loss: 1.567, Test loss: 1.580, Test accuracy: 89.22
Round  27, Global train loss: 1.567, Global test loss: 2.078, Global test accuracy: 36.68
Round  28, Train loss: 1.553, Test loss: 1.580, Test accuracy: 89.22
Round  28, Global train loss: 1.553, Global test loss: 2.037, Global test accuracy: 44.86
Round  29, Train loss: 1.648, Test loss: 1.579, Test accuracy: 89.18
Round  29, Global train loss: 1.648, Global test loss: 2.069, Global test accuracy: 37.12
Round  30, Train loss: 1.641, Test loss: 1.579, Test accuracy: 89.14
Round  30, Global train loss: 1.641, Global test loss: 2.059, Global test accuracy: 39.64
Round  31, Train loss: 1.673, Test loss: 1.579, Test accuracy: 89.10
Round  31, Global train loss: 1.673, Global test loss: 2.027, Global test accuracy: 46.16
Round  32, Train loss: 1.668, Test loss: 1.580, Test accuracy: 88.98
Round  32, Global train loss: 1.668, Global test loss: 2.036, Global test accuracy: 43.92
Round  33, Train loss: 1.639, Test loss: 1.580, Test accuracy: 88.88
Round  33, Global train loss: 1.639, Global test loss: 2.073, Global test accuracy: 36.92
Round  34, Train loss: 1.490, Test loss: 1.580, Test accuracy: 88.88
Round  34, Global train loss: 1.490, Global test loss: 1.989, Global test accuracy: 47.24
Round  35, Train loss: 1.589, Test loss: 1.579, Test accuracy: 88.94
Round  35, Global train loss: 1.589, Global test loss: 2.004, Global test accuracy: 47.04
Round  36, Train loss: 1.545, Test loss: 1.580, Test accuracy: 88.92
Round  36, Global train loss: 1.545, Global test loss: 2.075, Global test accuracy: 37.68
Round  37, Train loss: 1.578, Test loss: 1.579, Test accuracy: 88.86
Round  37, Global train loss: 1.578, Global test loss: 1.989, Global test accuracy: 46.36
Round  38, Train loss: 1.605, Test loss: 1.579, Test accuracy: 88.86
Round  38, Global train loss: 1.605, Global test loss: 2.022, Global test accuracy: 44.44
Round  39, Train loss: 1.658, Test loss: 1.579, Test accuracy: 88.82
Round  39, Global train loss: 1.658, Global test loss: 2.038, Global test accuracy: 43.68
Round  40, Train loss: 1.544, Test loss: 1.578, Test accuracy: 88.92
Round  40, Global train loss: 1.544, Global test loss: 2.037, Global test accuracy: 44.48
Round  41, Train loss: 1.691, Test loss: 1.578, Test accuracy: 88.92
Round  41, Global train loss: 1.691, Global test loss: 2.021, Global test accuracy: 43.96
Round  42, Train loss: 1.600, Test loss: 1.578, Test accuracy: 88.84
Round  42, Global train loss: 1.600, Global test loss: 2.036, Global test accuracy: 41.70
Round  43, Train loss: 1.574, Test loss: 1.577, Test accuracy: 89.02
Round  43, Global train loss: 1.574, Global test loss: 2.044, Global test accuracy: 41.02
Round  44, Train loss: 1.561, Test loss: 1.578, Test accuracy: 88.98
Round  44, Global train loss: 1.561, Global test loss: 2.050, Global test accuracy: 41.06
Round  45, Train loss: 1.472, Test loss: 1.578, Test accuracy: 89.00
Round  45, Global train loss: 1.472, Global test loss: 1.987, Global test accuracy: 48.96
Round  46, Train loss: 1.485, Test loss: 1.577, Test accuracy: 89.04
Round  46, Global train loss: 1.485, Global test loss: 2.080, Global test accuracy: 38.04
Round  47, Train loss: 1.646, Test loss: 1.578, Test accuracy: 88.96
Round  47, Global train loss: 1.646, Global test loss: 1.961, Global test accuracy: 49.10
Round  48, Train loss: 1.574, Test loss: 1.578, Test accuracy: 88.94
Round  48, Global train loss: 1.574, Global test loss: 2.173, Global test accuracy: 29.28
Round  49, Train loss: 1.485, Test loss: 1.579, Test accuracy: 88.84
Round  49, Global train loss: 1.485, Global test loss: 2.080, Global test accuracy: 38.04
Round  50, Train loss: 1.484, Test loss: 1.578, Test accuracy: 88.90
Round  50, Global train loss: 1.484, Global test loss: 2.078, Global test accuracy: 38.16
Round  51, Train loss: 1.556, Test loss: 1.578, Test accuracy: 88.88
Round  51, Global train loss: 1.556, Global test loss: 1.908, Global test accuracy: 59.88
Round  52, Train loss: 1.544, Test loss: 1.578, Test accuracy: 88.84
Round  52, Global train loss: 1.544, Global test loss: 2.108, Global test accuracy: 33.38
Round  53, Train loss: 1.625, Test loss: 1.578, Test accuracy: 88.84
Round  53, Global train loss: 1.625, Global test loss: 2.109, Global test accuracy: 34.74
Round  54, Train loss: 1.556, Test loss: 1.578, Test accuracy: 88.86
Round  54, Global train loss: 1.556, Global test loss: 1.923, Global test accuracy: 54.62
Round  55, Train loss: 1.555, Test loss: 1.579, Test accuracy: 88.64
Round  55, Global train loss: 1.555, Global test loss: 2.000, Global test accuracy: 44.94
Round  56, Train loss: 1.638, Test loss: 1.579, Test accuracy: 88.74
Round  56, Global train loss: 1.638, Global test loss: 2.023, Global test accuracy: 43.30
Round  57, Train loss: 1.629, Test loss: 1.579, Test accuracy: 88.68
Round  57, Global train loss: 1.629, Global test loss: 2.040, Global test accuracy: 38.52
Round  58, Train loss: 1.556, Test loss: 1.579, Test accuracy: 88.66
Round  58, Global train loss: 1.556, Global test loss: 1.975, Global test accuracy: 48.24
Round  59, Train loss: 1.551, Test loss: 1.580, Test accuracy: 88.60
Round  59, Global train loss: 1.551, Global test loss: 2.029, Global test accuracy: 41.48
Round  60, Train loss: 1.600, Test loss: 1.579, Test accuracy: 88.62
Round  60, Global train loss: 1.600, Global test loss: 2.070, Global test accuracy: 40.14
Round  61, Train loss: 1.708, Test loss: 1.579, Test accuracy: 88.64
Round  61, Global train loss: 1.708, Global test loss: 2.031, Global test accuracy: 42.70
Round  62, Train loss: 1.467, Test loss: 1.579, Test accuracy: 88.64
Round  62, Global train loss: 1.467, Global test loss: 1.987, Global test accuracy: 46.58
Round  63, Train loss: 1.569, Test loss: 1.579, Test accuracy: 88.62
Round  63, Global train loss: 1.569, Global test loss: 2.001, Global test accuracy: 45.54
Round  64, Train loss: 1.583, Test loss: 1.580, Test accuracy: 88.58
Round  64, Global train loss: 1.583, Global test loss: 1.946, Global test accuracy: 52.86
Round  65, Train loss: 1.484, Test loss: 1.580, Test accuracy: 88.58
Round  65, Global train loss: 1.484, Global test loss: 1.988, Global test accuracy: 47.06
Round  66, Train loss: 1.560, Test loss: 1.580, Test accuracy: 88.58
Round  66, Global train loss: 1.560, Global test loss: 2.113, Global test accuracy: 34.02
Round  67, Train loss: 1.662, Test loss: 1.580, Test accuracy: 88.52
Round  67, Global train loss: 1.662, Global test loss: 2.079, Global test accuracy: 38.12
Round  68, Train loss: 1.484, Test loss: 1.579, Test accuracy: 88.54
Round  68, Global train loss: 1.484, Global test loss: 1.997, Global test accuracy: 45.46
Round  69, Train loss: 1.621, Test loss: 1.580, Test accuracy: 88.56
Round  69, Global train loss: 1.621, Global test loss: 2.057, Global test accuracy: 40.80
Round  70, Train loss: 1.620, Test loss: 1.579, Test accuracy: 88.64
Round  70, Global train loss: 1.620, Global test loss: 1.975, Global test accuracy: 49.58
Round  71, Train loss: 1.581, Test loss: 1.579, Test accuracy: 88.64
Round  71, Global train loss: 1.581, Global test loss: 1.971, Global test accuracy: 50.24
Round  72, Train loss: 1.551, Test loss: 1.579, Test accuracy: 88.62
Round  72, Global train loss: 1.551, Global test loss: 2.025, Global test accuracy: 44.34
Round  73, Train loss: 1.539, Test loss: 1.579, Test accuracy: 88.64
Round  73, Global train loss: 1.539, Global test loss: 1.998, Global test accuracy: 46.34
Round  74, Train loss: 1.658, Test loss: 1.579, Test accuracy: 88.68
Round  74, Global train loss: 1.658, Global test loss: 2.076, Global test accuracy: 38.26
Round  75, Train loss: 1.577, Test loss: 1.579, Test accuracy: 88.66
Round  75, Global train loss: 1.577, Global test loss: 1.999, Global test accuracy: 45.42
Round  76, Train loss: 1.470, Test loss: 1.579, Test accuracy: 88.70
Round  76, Global train loss: 1.470, Global test loss: 2.038, Global test accuracy: 45.06
Round  77, Train loss: 1.484, Test loss: 1.579, Test accuracy: 88.70
Round  77, Global train loss: 1.484, Global test loss: 1.989, Global test accuracy: 46.88
Round  78, Train loss: 1.564, Test loss: 1.579, Test accuracy: 88.64
Round  78, Global train loss: 1.564, Global test loss: 1.987, Global test accuracy: 47.36
Round  79, Train loss: 1.580, Test loss: 1.579, Test accuracy: 88.64
Round  79, Global train loss: 1.580, Global test loss: 1.967, Global test accuracy: 50.20
Round  80, Train loss: 1.631, Test loss: 1.579, Test accuracy: 88.68
Round  80, Global train loss: 1.631, Global test loss: 2.110, Global test accuracy: 33.42
Round  81, Train loss: 1.594, Test loss: 1.579, Test accuracy: 88.66
Round  81, Global train loss: 1.594, Global test loss: 2.033, Global test accuracy: 43.82
Round  82, Train loss: 1.547, Test loss: 1.579, Test accuracy: 88.60
Round  82, Global train loss: 1.547, Global test loss: 2.097, Global test accuracy: 35.20
Round  83, Train loss: 1.650, Test loss: 1.579, Test accuracy: 88.62
Round  83, Global train loss: 1.650, Global test loss: 2.034, Global test accuracy: 43.44
Round  84, Train loss: 1.734, Test loss: 1.579, Test accuracy: 88.60
Round  84, Global train loss: 1.734, Global test loss: 2.036, Global test accuracy: 42.24
Round  85, Train loss: 1.547, Test loss: 1.580, Test accuracy: 88.44
Round  85, Global train loss: 1.547, Global test loss: 2.015, Global test accuracy: 45.72
Round  86, Train loss: 1.551, Test loss: 1.580, Test accuracy: 88.44
Round  86, Global train loss: 1.551, Global test loss: 1.973, Global test accuracy: 46.82
Round  87, Train loss: 1.649, Test loss: 1.580, Test accuracy: 88.36
Round  87, Global train loss: 1.649, Global test loss: 2.012, Global test accuracy: 43.34
Round  88, Train loss: 1.666, Test loss: 1.580, Test accuracy: 88.32
Round  88, Global train loss: 1.666, Global test loss: 2.030, Global test accuracy: 42.10
Round  89, Train loss: 1.551, Test loss: 1.580, Test accuracy: 88.30
Round  89, Global train loss: 1.551, Global test loss: 1.973, Global test accuracy: 46.84
Round  90, Train loss: 1.622, Test loss: 1.580, Test accuracy: 88.40
Round  90, Global train loss: 1.622, Global test loss: 2.154, Global test accuracy: 31.52
Round  91, Train loss: 1.622, Test loss: 1.580, Test accuracy: 88.38
Round  91, Global train loss: 1.622, Global test loss: 2.156, Global test accuracy: 31.30
Round  92, Train loss: 1.539, Test loss: 1.580, Test accuracy: 88.38
Round  92, Global train loss: 1.539, Global test loss: 1.969, Global test accuracy: 49.02
Round  93, Train loss: 1.556, Test loss: 1.580, Test accuracy: 88.40
Round  93, Global train loss: 1.556, Global test loss: 2.086, Global test accuracy: 36.88
Round  94, Train loss: 1.630, Test loss: 1.581, Test accuracy: 88.32
Round  94, Global train loss: 1.630, Global test loss: 2.025, Global test accuracy: 43.00/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.655, Test loss: 1.581, Test accuracy: 88.36
Round  95, Global train loss: 1.655, Global test loss: 2.077, Global test accuracy: 35.74
Round  96, Train loss: 1.654, Test loss: 1.582, Test accuracy: 88.18
Round  96, Global train loss: 1.654, Global test loss: 2.077, Global test accuracy: 35.62
Round  97, Train loss: 1.596, Test loss: 1.582, Test accuracy: 88.22
Round  97, Global train loss: 1.596, Global test loss: 2.060, Global test accuracy: 41.86
Round  98, Train loss: 1.470, Test loss: 1.582, Test accuracy: 88.22
Round  98, Global train loss: 1.470, Global test loss: 1.897, Global test accuracy: 59.70
Round  99, Train loss: 1.556, Test loss: 1.582, Test accuracy: 88.20
Round  99, Global train loss: 1.556, Global test loss: 2.083, Global test accuracy: 36.34
Final Round, Train loss: 1.576, Test loss: 1.581, Test accuracy: 88.42
Final Round, Global train loss: 1.576, Global test loss: 2.083, Global test accuracy: 36.34
Average accuracy final 10 rounds: 88.30600000000001 

Average global accuracy final 10 rounds: 40.098000000000006 

795.7217764854431
[1.1172702312469482, 2.2345404624938965, 3.225672960281372, 4.216805458068848, 5.375201225280762, 6.533596992492676, 7.644144535064697, 8.754692077636719, 9.71267819404602, 10.670664310455322, 11.69223427772522, 12.713804244995117, 13.812788963317871, 14.911773681640625, 16.05861210823059, 17.205450534820557, 18.219868421554565, 19.234286308288574, 20.231963396072388, 21.2296404838562, 22.22478747367859, 23.219934463500977, 24.288018465042114, 25.356102466583252, 26.393061637878418, 27.430020809173584, 28.38415813446045, 29.338295459747314, 30.392073392868042, 31.44585132598877, 32.47995471954346, 33.514058113098145, 34.5591299533844, 35.604201793670654, 36.64402675628662, 37.68385171890259, 38.68381357192993, 39.683775424957275, 40.76448321342468, 41.84519100189209, 42.908507347106934, 43.97182369232178, 44.98883509635925, 46.00584650039673, 46.978811740875244, 47.95177698135376, 48.941930055618286, 49.93208312988281, 51.1798620223999, 52.42764091491699, 53.559951066970825, 54.69226121902466, 55.75752568244934, 56.82279014587402, 57.862752199172974, 58.902714252471924, 59.83610272407532, 60.76949119567871, 61.89898133277893, 63.02847146987915, 64.180823802948, 65.33317613601685, 66.45163130760193, 67.57008647918701, 68.61489462852478, 69.65970277786255, 70.79141497612, 71.92312717437744, 73.20445156097412, 74.4857759475708, 75.48349094390869, 76.48120594024658, 77.43902063369751, 78.39683532714844, 79.39737868309021, 80.39792203903198, 81.54530239105225, 82.69268274307251, 83.69322299957275, 84.693763256073, 85.84583377838135, 86.9979043006897, 88.05918002128601, 89.12045574188232, 90.27497291564941, 91.4294900894165, 92.38980484008789, 93.35011959075928, 94.37371349334717, 95.39730739593506, 96.6363160610199, 97.87532472610474, 98.97601127624512, 100.0766978263855, 101.20150685310364, 102.32631587982178, 103.4502534866333, 104.57419109344482, 105.59009981155396, 106.60600852966309, 107.57576441764832, 108.54552030563354, 109.58538174629211, 110.62524318695068, 111.67504501342773, 112.72484683990479, 113.69734120368958, 114.66983556747437, 115.63809418678284, 116.60635280609131, 117.55679154396057, 118.50723028182983, 119.64038252830505, 120.77353477478027, 121.97388410568237, 123.17423343658447, 124.2190363407135, 125.26383924484253, 126.32008337974548, 127.37632751464844, 128.4839973449707, 129.59166717529297, 130.6833508014679, 131.77503442764282, 133.06377577781677, 134.35251712799072, 135.38703560829163, 136.42155408859253, 137.52803564071655, 138.63451719284058, 139.9037857055664, 141.17305421829224, 142.50668931007385, 143.84032440185547, 144.8611934185028, 145.88206243515015, 146.99699544906616, 148.11192846298218, 149.2016453742981, 150.291362285614, 151.3699381351471, 152.44851398468018, 153.50342297554016, 154.55833196640015, 155.59470295906067, 156.6310739517212, 157.63761520385742, 158.64415645599365, 159.6839942932129, 160.72383213043213, 161.73363637924194, 162.74344062805176, 163.84007787704468, 164.9367151260376, 165.96029686927795, 166.9838786125183, 168.07138967514038, 169.15890073776245, 170.30824422836304, 171.45758771896362, 172.6212546825409, 173.78492164611816, 174.7997691631317, 175.81461668014526, 176.88382077217102, 177.95302486419678, 178.98817658424377, 180.02332830429077, 181.04005479812622, 182.05678129196167, 183.25958776474, 184.4623942375183, 185.54027938842773, 186.61816453933716, 187.62839078903198, 188.6386170387268, 189.7506194114685, 190.8626217842102, 191.90533900260925, 192.9480562210083, 194.07607173919678, 195.20408725738525, 196.19426822662354, 197.18444919586182, 198.11451411247253, 199.04457902908325, 200.0213348865509, 200.99809074401855, 202.02818846702576, 203.05828619003296, 204.04921984672546, 205.04015350341797, 206.179456949234, 207.31876039505005, 208.3234839439392, 209.32820749282837, 210.37106895446777, 211.41393041610718, 212.47046637535095, 213.52700233459473, 215.79705500602722, 218.06710767745972]
[12.72, 12.72, 27.2, 27.2, 37.08, 37.08, 41.18, 41.18, 50.36, 50.36, 56.0, 56.0, 61.62, 61.62, 69.26, 69.26, 72.18, 72.18, 75.84, 75.84, 75.78, 75.78, 76.3, 76.3, 76.56, 76.56, 77.58, 77.58, 83.92, 83.92, 85.2, 85.2, 85.44, 85.44, 85.6, 85.6, 86.74, 86.74, 88.52, 88.52, 88.52, 88.52, 88.48, 88.48, 88.52, 88.52, 88.52, 88.52, 89.02, 89.02, 89.12, 89.12, 89.2, 89.2, 89.22, 89.22, 89.22, 89.22, 89.18, 89.18, 89.14, 89.14, 89.1, 89.1, 88.98, 88.98, 88.88, 88.88, 88.88, 88.88, 88.94, 88.94, 88.92, 88.92, 88.86, 88.86, 88.86, 88.86, 88.82, 88.82, 88.92, 88.92, 88.92, 88.92, 88.84, 88.84, 89.02, 89.02, 88.98, 88.98, 89.0, 89.0, 89.04, 89.04, 88.96, 88.96, 88.94, 88.94, 88.84, 88.84, 88.9, 88.9, 88.88, 88.88, 88.84, 88.84, 88.84, 88.84, 88.86, 88.86, 88.64, 88.64, 88.74, 88.74, 88.68, 88.68, 88.66, 88.66, 88.6, 88.6, 88.62, 88.62, 88.64, 88.64, 88.64, 88.64, 88.62, 88.62, 88.58, 88.58, 88.58, 88.58, 88.58, 88.58, 88.52, 88.52, 88.54, 88.54, 88.56, 88.56, 88.64, 88.64, 88.64, 88.64, 88.62, 88.62, 88.64, 88.64, 88.68, 88.68, 88.66, 88.66, 88.7, 88.7, 88.7, 88.7, 88.64, 88.64, 88.64, 88.64, 88.68, 88.68, 88.66, 88.66, 88.6, 88.6, 88.62, 88.62, 88.6, 88.6, 88.44, 88.44, 88.44, 88.44, 88.36, 88.36, 88.32, 88.32, 88.3, 88.3, 88.4, 88.4, 88.38, 88.38, 88.38, 88.38, 88.4, 88.4, 88.32, 88.32, 88.36, 88.36, 88.18, 88.18, 88.22, 88.22, 88.22, 88.22, 88.2, 88.2, 88.42, 88.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.286, Test loss: 2.288, Test accuracy: 12.60
Round   0, Global train loss: 2.286, Global test loss: 2.295, Global test accuracy: 10.00
Round   1, Train loss: 2.204, Test loss: 2.165, Test accuracy: 34.22
Round   1, Global train loss: 2.204, Global test loss: 2.181, Global test accuracy: 29.50
Round   2, Train loss: 1.967, Test loss: 2.033, Test accuracy: 46.80
Round   2, Global train loss: 1.967, Global test loss: 2.046, Global test accuracy: 42.10
Round   3, Train loss: 1.838, Test loss: 1.975, Test accuracy: 52.90
Round   3, Global train loss: 1.838, Global test loss: 2.015, Global test accuracy: 45.24
Round   4, Train loss: 1.917, Test loss: 1.907, Test accuracy: 58.78
Round   4, Global train loss: 1.917, Global test loss: 2.008, Global test accuracy: 44.94
Round   5, Train loss: 1.908, Test loss: 1.890, Test accuracy: 60.32
Round   5, Global train loss: 1.908, Global test loss: 1.998, Global test accuracy: 47.24
Round   6, Train loss: 1.695, Test loss: 1.787, Test accuracy: 69.08
Round   6, Global train loss: 1.695, Global test loss: 1.871, Global test accuracy: 62.44
Round   7, Train loss: 1.656, Test loss: 1.782, Test accuracy: 68.84
Round   7, Global train loss: 1.656, Global test loss: 1.870, Global test accuracy: 59.50
Round   8, Train loss: 1.804, Test loss: 1.768, Test accuracy: 69.82
Round   8, Global train loss: 1.804, Global test loss: 1.901, Global test accuracy: 55.54
Round   9, Train loss: 1.717, Test loss: 1.749, Test accuracy: 72.20
Round   9, Global train loss: 1.717, Global test loss: 1.804, Global test accuracy: 67.62
Round  10, Train loss: 1.793, Test loss: 1.754, Test accuracy: 71.36
Round  10, Global train loss: 1.793, Global test loss: 1.835, Global test accuracy: 62.82
Round  11, Train loss: 1.773, Test loss: 1.743, Test accuracy: 72.16
Round  11, Global train loss: 1.773, Global test loss: 1.797, Global test accuracy: 67.02
Round  12, Train loss: 1.703, Test loss: 1.736, Test accuracy: 73.00
Round  12, Global train loss: 1.703, Global test loss: 1.836, Global test accuracy: 62.06
Round  13, Train loss: 1.688, Test loss: 1.742, Test accuracy: 72.10
Round  13, Global train loss: 1.688, Global test loss: 1.817, Global test accuracy: 65.26
Round  14, Train loss: 1.801, Test loss: 1.725, Test accuracy: 73.92
Round  14, Global train loss: 1.801, Global test loss: 1.788, Global test accuracy: 68.90
Round  15, Train loss: 1.817, Test loss: 1.725, Test accuracy: 74.02
Round  15, Global train loss: 1.817, Global test loss: 1.800, Global test accuracy: 66.54
Round  16, Train loss: 1.756, Test loss: 1.722, Test accuracy: 74.14
Round  16, Global train loss: 1.756, Global test loss: 1.786, Global test accuracy: 68.70
Round  17, Train loss: 1.685, Test loss: 1.722, Test accuracy: 74.26
Round  17, Global train loss: 1.685, Global test loss: 1.809, Global test accuracy: 65.88
Round  18, Train loss: 1.866, Test loss: 1.719, Test accuracy: 74.48
Round  18, Global train loss: 1.866, Global test loss: 1.785, Global test accuracy: 68.42
Round  19, Train loss: 1.780, Test loss: 1.719, Test accuracy: 74.36
Round  19, Global train loss: 1.780, Global test loss: 1.787, Global test accuracy: 68.64
Round  20, Train loss: 1.812, Test loss: 1.719, Test accuracy: 74.38
Round  20, Global train loss: 1.812, Global test loss: 1.776, Global test accuracy: 69.60
Round  21, Train loss: 1.738, Test loss: 1.719, Test accuracy: 74.36
Round  21, Global train loss: 1.738, Global test loss: 1.796, Global test accuracy: 66.76
Round  22, Train loss: 1.674, Test loss: 1.719, Test accuracy: 74.38
Round  22, Global train loss: 1.674, Global test loss: 1.771, Global test accuracy: 70.06
Round  23, Train loss: 1.685, Test loss: 1.719, Test accuracy: 74.36
Round  23, Global train loss: 1.685, Global test loss: 1.760, Global test accuracy: 70.96
Round  24, Train loss: 1.722, Test loss: 1.719, Test accuracy: 74.42
Round  24, Global train loss: 1.722, Global test loss: 1.794, Global test accuracy: 66.68
Round  25, Train loss: 1.654, Test loss: 1.717, Test accuracy: 74.50
Round  25, Global train loss: 1.654, Global test loss: 1.807, Global test accuracy: 65.24
Round  26, Train loss: 1.615, Test loss: 1.717, Test accuracy: 74.50
Round  26, Global train loss: 1.615, Global test loss: 1.796, Global test accuracy: 66.80
Round  27, Train loss: 1.604, Test loss: 1.717, Test accuracy: 74.48
Round  27, Global train loss: 1.604, Global test loss: 1.765, Global test accuracy: 70.30
Round  28, Train loss: 1.612, Test loss: 1.717, Test accuracy: 74.54
Round  28, Global train loss: 1.612, Global test loss: 1.797, Global test accuracy: 66.76
Round  29, Train loss: 1.791, Test loss: 1.717, Test accuracy: 74.38
Round  29, Global train loss: 1.791, Global test loss: 1.810, Global test accuracy: 65.10
Round  30, Train loss: 1.787, Test loss: 1.718, Test accuracy: 74.30
Round  30, Global train loss: 1.787, Global test loss: 1.757, Global test accuracy: 70.96
Round  31, Train loss: 1.615, Test loss: 1.721, Test accuracy: 74.02
Round  31, Global train loss: 1.615, Global test loss: 1.750, Global test accuracy: 71.86
Round  32, Train loss: 1.613, Test loss: 1.717, Test accuracy: 74.36
Round  32, Global train loss: 1.613, Global test loss: 1.758, Global test accuracy: 70.90
Round  33, Train loss: 1.785, Test loss: 1.717, Test accuracy: 74.50
Round  33, Global train loss: 1.785, Global test loss: 1.782, Global test accuracy: 68.22
Round  34, Train loss: 1.714, Test loss: 1.716, Test accuracy: 74.58
Round  34, Global train loss: 1.714, Global test loss: 1.752, Global test accuracy: 71.40
Round  35, Train loss: 1.778, Test loss: 1.716, Test accuracy: 74.54
Round  35, Global train loss: 1.778, Global test loss: 1.764, Global test accuracy: 69.96
Round  36, Train loss: 1.768, Test loss: 1.716, Test accuracy: 74.54
Round  36, Global train loss: 1.768, Global test loss: 1.779, Global test accuracy: 68.68
Round  37, Train loss: 1.735, Test loss: 1.716, Test accuracy: 74.52
Round  37, Global train loss: 1.735, Global test loss: 1.767, Global test accuracy: 69.82
Round  38, Train loss: 1.711, Test loss: 1.716, Test accuracy: 74.44
Round  38, Global train loss: 1.711, Global test loss: 1.744, Global test accuracy: 71.98
Round  39, Train loss: 1.605, Test loss: 1.716, Test accuracy: 74.52
Round  39, Global train loss: 1.605, Global test loss: 1.748, Global test accuracy: 71.50
Round  40, Train loss: 1.605, Test loss: 1.716, Test accuracy: 74.54
Round  40, Global train loss: 1.605, Global test loss: 1.770, Global test accuracy: 69.46
Round  41, Train loss: 1.679, Test loss: 1.715, Test accuracy: 74.58
Round  41, Global train loss: 1.679, Global test loss: 1.761, Global test accuracy: 70.60
Round  42, Train loss: 1.705, Test loss: 1.715, Test accuracy: 74.56
Round  42, Global train loss: 1.705, Global test loss: 1.799, Global test accuracy: 66.58
Round  43, Train loss: 1.773, Test loss: 1.713, Test accuracy: 74.80
Round  43, Global train loss: 1.773, Global test loss: 1.793, Global test accuracy: 66.72
Round  44, Train loss: 1.747, Test loss: 1.713, Test accuracy: 74.86
Round  44, Global train loss: 1.747, Global test loss: 1.754, Global test accuracy: 70.86
Round  45, Train loss: 1.774, Test loss: 1.713, Test accuracy: 74.88
Round  45, Global train loss: 1.774, Global test loss: 1.772, Global test accuracy: 69.30
Round  46, Train loss: 1.761, Test loss: 1.713, Test accuracy: 74.80
Round  46, Global train loss: 1.761, Global test loss: 1.789, Global test accuracy: 67.60
Round  47, Train loss: 1.611, Test loss: 1.713, Test accuracy: 74.76
Round  47, Global train loss: 1.611, Global test loss: 1.742, Global test accuracy: 71.72
Round  48, Train loss: 1.674, Test loss: 1.714, Test accuracy: 74.74
Round  48, Global train loss: 1.674, Global test loss: 1.742, Global test accuracy: 72.24
Round  49, Train loss: 1.756, Test loss: 1.714, Test accuracy: 74.68
Round  49, Global train loss: 1.756, Global test loss: 1.791, Global test accuracy: 67.28
Round  50, Train loss: 1.751, Test loss: 1.714, Test accuracy: 74.68
Round  50, Global train loss: 1.751, Global test loss: 1.794, Global test accuracy: 67.16
Round  51, Train loss: 1.739, Test loss: 1.714, Test accuracy: 74.64
Round  51, Global train loss: 1.739, Global test loss: 1.738, Global test accuracy: 72.44
Round  52, Train loss: 1.657, Test loss: 1.715, Test accuracy: 74.60
Round  52, Global train loss: 1.657, Global test loss: 1.754, Global test accuracy: 71.04
Round  53, Train loss: 1.771, Test loss: 1.714, Test accuracy: 74.70
Round  53, Global train loss: 1.771, Global test loss: 1.763, Global test accuracy: 70.36
Round  54, Train loss: 1.837, Test loss: 1.713, Test accuracy: 74.66
Round  54, Global train loss: 1.837, Global test loss: 1.756, Global test accuracy: 70.68
Round  55, Train loss: 1.842, Test loss: 1.713, Test accuracy: 74.64
Round  55, Global train loss: 1.842, Global test loss: 1.763, Global test accuracy: 69.94
Round  56, Train loss: 1.893, Test loss: 1.701, Test accuracy: 76.02
Round  56, Global train loss: 1.893, Global test loss: 1.767, Global test accuracy: 69.50
Round  57, Train loss: 1.676, Test loss: 1.701, Test accuracy: 76.06
Round  57, Global train loss: 1.676, Global test loss: 1.759, Global test accuracy: 70.36
Round  58, Train loss: 1.631, Test loss: 1.701, Test accuracy: 76.08
Round  58, Global train loss: 1.631, Global test loss: 1.766, Global test accuracy: 69.36
Round  59, Train loss: 1.900, Test loss: 1.699, Test accuracy: 76.32
Round  59, Global train loss: 1.900, Global test loss: 1.757, Global test accuracy: 70.36
Round  60, Train loss: 1.552, Test loss: 1.683, Test accuracy: 77.98
Round  60, Global train loss: 1.552, Global test loss: 1.738, Global test accuracy: 72.68
Round  61, Train loss: 1.734, Test loss: 1.683, Test accuracy: 77.98
Round  61, Global train loss: 1.734, Global test loss: 1.735, Global test accuracy: 72.46
Round  62, Train loss: 1.827, Test loss: 1.686, Test accuracy: 77.56
Round  62, Global train loss: 1.827, Global test loss: 1.738, Global test accuracy: 72.58
Round  63, Train loss: 1.672, Test loss: 1.686, Test accuracy: 77.66
Round  63, Global train loss: 1.672, Global test loss: 1.733, Global test accuracy: 72.74
Round  64, Train loss: 1.622, Test loss: 1.670, Test accuracy: 79.36
Round  64, Global train loss: 1.622, Global test loss: 1.743, Global test accuracy: 72.32
Round  65, Train loss: 1.662, Test loss: 1.668, Test accuracy: 79.62
Round  65, Global train loss: 1.662, Global test loss: 1.720, Global test accuracy: 74.52
Round  66, Train loss: 1.535, Test loss: 1.668, Test accuracy: 79.54
Round  66, Global train loss: 1.535, Global test loss: 1.753, Global test accuracy: 70.92
Round  67, Train loss: 1.732, Test loss: 1.666, Test accuracy: 79.76
Round  67, Global train loss: 1.732, Global test loss: 1.734, Global test accuracy: 73.06
Round  68, Train loss: 1.602, Test loss: 1.666, Test accuracy: 79.68
Round  68, Global train loss: 1.602, Global test loss: 1.723, Global test accuracy: 73.94
Round  69, Train loss: 1.657, Test loss: 1.666, Test accuracy: 79.64
Round  69, Global train loss: 1.657, Global test loss: 1.716, Global test accuracy: 75.00
Round  70, Train loss: 1.659, Test loss: 1.666, Test accuracy: 79.66
Round  70, Global train loss: 1.659, Global test loss: 1.721, Global test accuracy: 73.80
Round  71, Train loss: 1.701, Test loss: 1.665, Test accuracy: 79.70
Round  71, Global train loss: 1.701, Global test loss: 1.727, Global test accuracy: 73.56
Round  72, Train loss: 1.819, Test loss: 1.665, Test accuracy: 79.68
Round  72, Global train loss: 1.819, Global test loss: 1.726, Global test accuracy: 73.50
Round  73, Train loss: 1.749, Test loss: 1.669, Test accuracy: 79.16
Round  73, Global train loss: 1.749, Global test loss: 1.733, Global test accuracy: 72.92
Round  74, Train loss: 1.720, Test loss: 1.665, Test accuracy: 79.64
Round  74, Global train loss: 1.720, Global test loss: 1.726, Global test accuracy: 74.34
Round  75, Train loss: 1.693, Test loss: 1.665, Test accuracy: 79.72
Round  75, Global train loss: 1.693, Global test loss: 1.728, Global test accuracy: 73.90
Round  76, Train loss: 1.714, Test loss: 1.667, Test accuracy: 79.34
Round  76, Global train loss: 1.714, Global test loss: 1.706, Global test accuracy: 76.10
Round  77, Train loss: 1.651, Test loss: 1.665, Test accuracy: 79.58
Round  77, Global train loss: 1.651, Global test loss: 1.702, Global test accuracy: 76.42
Round  78, Train loss: 1.659, Test loss: 1.665, Test accuracy: 79.68
Round  78, Global train loss: 1.659, Global test loss: 1.720, Global test accuracy: 73.92
Round  79, Train loss: 1.692, Test loss: 1.665, Test accuracy: 79.72
Round  79, Global train loss: 1.692, Global test loss: 1.718, Global test accuracy: 74.48
Round  80, Train loss: 1.789, Test loss: 1.665, Test accuracy: 79.72
Round  80, Global train loss: 1.789, Global test loss: 1.724, Global test accuracy: 74.00
Round  81, Train loss: 1.527, Test loss: 1.649, Test accuracy: 81.38
Round  81, Global train loss: 1.527, Global test loss: 1.712, Global test accuracy: 75.08
Round  82, Train loss: 1.713, Test loss: 1.625, Test accuracy: 83.96
Round  82, Global train loss: 1.713, Global test loss: 1.762, Global test accuracy: 69.72
Round  83, Train loss: 1.476, Test loss: 1.625, Test accuracy: 83.94
Round  83, Global train loss: 1.476, Global test loss: 1.675, Global test accuracy: 79.72
Round  84, Train loss: 1.568, Test loss: 1.606, Test accuracy: 85.84
Round  84, Global train loss: 1.568, Global test loss: 1.669, Global test accuracy: 80.46
Round  85, Train loss: 1.680, Test loss: 1.605, Test accuracy: 85.84
Round  85, Global train loss: 1.680, Global test loss: 1.701, Global test accuracy: 76.78
Round  86, Train loss: 1.817, Test loss: 1.602, Test accuracy: 86.32
Round  86, Global train loss: 1.817, Global test loss: 1.706, Global test accuracy: 75.78
Round  87, Train loss: 1.526, Test loss: 1.602, Test accuracy: 86.30
Round  87, Global train loss: 1.526, Global test loss: 1.703, Global test accuracy: 75.64
Round  88, Train loss: 1.468, Test loss: 1.603, Test accuracy: 86.26
Round  88, Global train loss: 1.468, Global test loss: 1.691, Global test accuracy: 77.02
Round  89, Train loss: 1.811, Test loss: 1.606, Test accuracy: 85.76
Round  89, Global train loss: 1.811, Global test loss: 1.680, Global test accuracy: 79.20
Round  90, Train loss: 1.622, Test loss: 1.605, Test accuracy: 85.84
Round  90, Global train loss: 1.622, Global test loss: 1.690, Global test accuracy: 77.70
Round  91, Train loss: 1.617, Test loss: 1.606, Test accuracy: 85.74
Round  91, Global train loss: 1.617, Global test loss: 1.690, Global test accuracy: 77.46
Round  92, Train loss: 1.525, Test loss: 1.606, Test accuracy: 85.88
Round  92, Global train loss: 1.525, Global test loss: 1.663, Global test accuracy: 81.14
Round  93, Train loss: 1.583, Test loss: 1.605, Test accuracy: 85.98
Round  93, Global train loss: 1.583, Global test loss: 1.705, Global test accuracy: 75.60
Round  94, Train loss: 1.765, Test loss: 1.604, Test accuracy: 86.04
Round  94, Global train loss: 1.765, Global test loss: 1.690, Global test accuracy: 77.64/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.677, Test loss: 1.601, Test accuracy: 86.48
Round  95, Global train loss: 1.677, Global test loss: 1.707, Global test accuracy: 75.96
Round  96, Train loss: 1.670, Test loss: 1.603, Test accuracy: 86.10
Round  96, Global train loss: 1.670, Global test loss: 1.710, Global test accuracy: 76.08
Round  97, Train loss: 1.535, Test loss: 1.603, Test accuracy: 86.10
Round  97, Global train loss: 1.535, Global test loss: 1.686, Global test accuracy: 78.04
Round  98, Train loss: 1.588, Test loss: 1.603, Test accuracy: 86.10
Round  98, Global train loss: 1.588, Global test loss: 1.656, Global test accuracy: 81.58
Round  99, Train loss: 1.517, Test loss: 1.603, Test accuracy: 86.08
Round  99, Global train loss: 1.517, Global test loss: 1.683, Global test accuracy: 78.04
Final Round, Train loss: 1.623, Test loss: 1.603, Test accuracy: 85.92
Final Round, Global train loss: 1.623, Global test loss: 1.683, Global test accuracy: 78.04
Average accuracy final 10 rounds: 86.034 

Average global accuracy final 10 rounds: 77.92399999999999 

792.9322094917297
[1.2750449180603027, 2.5500898361206055, 3.545380115509033, 4.540670394897461, 5.560924530029297, 6.581178665161133, 7.52782678604126, 8.474474906921387, 9.522664308547974, 10.57085371017456, 11.599663496017456, 12.628473281860352, 13.6597158908844, 14.690958499908447, 15.727199792861938, 16.76344108581543, 17.914474487304688, 19.065507888793945, 20.160725116729736, 21.255942344665527, 22.33706569671631, 23.41818904876709, 24.532421588897705, 25.64665412902832, 26.640419483184814, 27.63418483734131, 28.693861961364746, 29.753539085388184, 30.696182012557983, 31.638824939727783, 32.69597363471985, 33.753122329711914, 34.75941872596741, 35.7657151222229, 36.88804006576538, 38.01036500930786, 39.06280541419983, 40.1152458190918, 41.127179861068726, 42.139113903045654, 43.261128664016724, 44.38314342498779, 45.51219630241394, 46.64124917984009, 47.67889046669006, 48.71653175354004, 49.810680627822876, 50.90482950210571, 52.009204387664795, 53.11357927322388, 54.16832137107849, 55.223063468933105, 56.201639890670776, 57.18021631240845, 58.32880973815918, 59.47740316390991, 60.53679609298706, 61.59618902206421, 62.55666399002075, 63.517138957977295, 64.44806146621704, 65.37898397445679, 66.42112708091736, 67.46327018737793, 68.40005421638489, 69.33683824539185, 70.43868660926819, 71.54053497314453, 72.5560827255249, 73.57163047790527, 74.52089786529541, 75.47016525268555, 76.55592727661133, 77.64168930053711, 78.7077784538269, 79.7738676071167, 80.79834699630737, 81.82282638549805, 82.93811130523682, 84.05339622497559, 85.07803654670715, 86.10267686843872, 87.1533772945404, 88.20407772064209, 89.19627523422241, 90.18847274780273, 91.15304064750671, 92.1176085472107, 93.1279730796814, 94.1383376121521, 95.19421768188477, 96.25009775161743, 97.234943151474, 98.21978855133057, 99.37946486473083, 100.5391411781311, 101.58454513549805, 102.62994909286499, 103.6963357925415, 104.76272249221802, 105.76974511146545, 106.77676773071289, 107.78588891029358, 108.79501008987427, 109.97795104980469, 111.16089200973511, 112.1793372631073, 113.19778251647949, 114.19833755493164, 115.19889259338379, 116.30568742752075, 117.41248226165771, 118.44034934043884, 119.46821641921997, 120.51341366767883, 121.5586109161377, 122.56967115402222, 123.58073139190674, 124.59204864501953, 125.60336589813232, 126.64650988578796, 127.6896538734436, 128.8084101676941, 129.92716646194458, 130.91310238838196, 131.89903831481934, 132.9642071723938, 134.02937602996826, 135.04331517219543, 136.0572543144226, 137.33034300804138, 138.60343170166016, 140.0310800075531, 141.45872831344604, 143.04328322410583, 144.62783813476562, 146.1367974281311, 147.64575672149658, 149.11128568649292, 150.57681465148926, 151.67301058769226, 152.76920652389526, 153.86107349395752, 154.95294046401978, 156.07573556900024, 157.1985306739807, 158.1612594127655, 159.1239881515503, 160.15174961090088, 161.17951107025146, 162.141667842865, 163.10382461547852, 164.17706942558289, 165.25031423568726, 166.25307416915894, 167.25583410263062, 168.3529269695282, 169.45001983642578, 170.61829948425293, 171.78657913208008, 172.81854009628296, 173.85050106048584, 174.901540517807, 175.95257997512817, 177.0964274406433, 178.24027490615845, 179.3332495689392, 180.42622423171997, 181.44564533233643, 182.46506643295288, 183.5304639339447, 184.59586143493652, 185.5922429561615, 186.58862447738647, 187.75138568878174, 188.914146900177, 189.8923680782318, 190.87058925628662, 191.99354434013367, 193.1164994239807, 194.09132599830627, 195.06615257263184, 196.13512802124023, 197.20410346984863, 198.27083373069763, 199.33756399154663, 200.54910230636597, 201.7606406211853, 202.7861042022705, 203.8115677833557, 204.90313935279846, 205.9947109222412, 207.07906198501587, 208.16341304779053, 209.16094136238098, 210.15846967697144, 211.20616459846497, 212.2538595199585, 213.2822620868683, 214.31066465377808, 216.57781291007996, 218.84496116638184]
[12.6, 12.6, 34.22, 34.22, 46.8, 46.8, 52.9, 52.9, 58.78, 58.78, 60.32, 60.32, 69.08, 69.08, 68.84, 68.84, 69.82, 69.82, 72.2, 72.2, 71.36, 71.36, 72.16, 72.16, 73.0, 73.0, 72.1, 72.1, 73.92, 73.92, 74.02, 74.02, 74.14, 74.14, 74.26, 74.26, 74.48, 74.48, 74.36, 74.36, 74.38, 74.38, 74.36, 74.36, 74.38, 74.38, 74.36, 74.36, 74.42, 74.42, 74.5, 74.5, 74.5, 74.5, 74.48, 74.48, 74.54, 74.54, 74.38, 74.38, 74.3, 74.3, 74.02, 74.02, 74.36, 74.36, 74.5, 74.5, 74.58, 74.58, 74.54, 74.54, 74.54, 74.54, 74.52, 74.52, 74.44, 74.44, 74.52, 74.52, 74.54, 74.54, 74.58, 74.58, 74.56, 74.56, 74.8, 74.8, 74.86, 74.86, 74.88, 74.88, 74.8, 74.8, 74.76, 74.76, 74.74, 74.74, 74.68, 74.68, 74.68, 74.68, 74.64, 74.64, 74.6, 74.6, 74.7, 74.7, 74.66, 74.66, 74.64, 74.64, 76.02, 76.02, 76.06, 76.06, 76.08, 76.08, 76.32, 76.32, 77.98, 77.98, 77.98, 77.98, 77.56, 77.56, 77.66, 77.66, 79.36, 79.36, 79.62, 79.62, 79.54, 79.54, 79.76, 79.76, 79.68, 79.68, 79.64, 79.64, 79.66, 79.66, 79.7, 79.7, 79.68, 79.68, 79.16, 79.16, 79.64, 79.64, 79.72, 79.72, 79.34, 79.34, 79.58, 79.58, 79.68, 79.68, 79.72, 79.72, 79.72, 79.72, 81.38, 81.38, 83.96, 83.96, 83.94, 83.94, 85.84, 85.84, 85.84, 85.84, 86.32, 86.32, 86.3, 86.3, 86.26, 86.26, 85.76, 85.76, 85.84, 85.84, 85.74, 85.74, 85.88, 85.88, 85.98, 85.98, 86.04, 86.04, 86.48, 86.48, 86.1, 86.1, 86.1, 86.1, 86.1, 86.1, 86.08, 86.08, 85.92, 85.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.288, Test loss: 2.290, Test accuracy: 16.72
Round   0, Global train loss: 2.288, Global test loss: 2.295, Global test accuracy: 16.94
Round   1, Train loss: 2.253, Test loss: 2.249, Test accuracy: 26.28
Round   1, Global train loss: 2.253, Global test loss: 2.259, Global test accuracy: 27.04
Round   2, Train loss: 2.175, Test loss: 2.165, Test accuracy: 34.02
Round   2, Global train loss: 2.175, Global test loss: 2.161, Global test accuracy: 29.84
Round   3, Train loss: 2.070, Test loss: 2.085, Test accuracy: 41.38
Round   3, Global train loss: 2.070, Global test loss: 2.098, Global test accuracy: 35.64
Round   4, Train loss: 1.921, Test loss: 1.992, Test accuracy: 51.36
Round   4, Global train loss: 1.921, Global test loss: 2.034, Global test accuracy: 42.72
Round   5, Train loss: 1.980, Test loss: 1.962, Test accuracy: 52.92
Round   5, Global train loss: 1.980, Global test loss: 2.059, Global test accuracy: 37.22
Round   6, Train loss: 1.931, Test loss: 1.867, Test accuracy: 63.54
Round   6, Global train loss: 1.931, Global test loss: 1.928, Global test accuracy: 58.10
Round   7, Train loss: 1.883, Test loss: 1.826, Test accuracy: 66.24
Round   7, Global train loss: 1.883, Global test loss: 1.910, Global test accuracy: 55.76
Round   8, Train loss: 1.781, Test loss: 1.804, Test accuracy: 67.76
Round   8, Global train loss: 1.781, Global test loss: 1.949, Global test accuracy: 50.08
Round   9, Train loss: 1.783, Test loss: 1.786, Test accuracy: 69.94
Round   9, Global train loss: 1.783, Global test loss: 1.865, Global test accuracy: 62.24
Round  10, Train loss: 1.914, Test loss: 1.781, Test accuracy: 69.90
Round  10, Global train loss: 1.914, Global test loss: 1.860, Global test accuracy: 61.04
Round  11, Train loss: 1.788, Test loss: 1.767, Test accuracy: 71.22
Round  11, Global train loss: 1.788, Global test loss: 1.823, Global test accuracy: 65.88
Round  12, Train loss: 1.816, Test loss: 1.757, Test accuracy: 72.18
Round  12, Global train loss: 1.816, Global test loss: 1.835, Global test accuracy: 63.42
Round  13, Train loss: 1.806, Test loss: 1.758, Test accuracy: 71.66
Round  13, Global train loss: 1.806, Global test loss: 1.818, Global test accuracy: 65.34
Round  14, Train loss: 1.798, Test loss: 1.740, Test accuracy: 73.44
Round  14, Global train loss: 1.798, Global test loss: 1.793, Global test accuracy: 68.78
Round  15, Train loss: 1.816, Test loss: 1.738, Test accuracy: 73.58
Round  15, Global train loss: 1.816, Global test loss: 1.810, Global test accuracy: 66.06
Round  16, Train loss: 1.793, Test loss: 1.730, Test accuracy: 73.84
Round  16, Global train loss: 1.793, Global test loss: 1.813, Global test accuracy: 65.68
Round  17, Train loss: 1.799, Test loss: 1.728, Test accuracy: 73.96
Round  17, Global train loss: 1.799, Global test loss: 1.812, Global test accuracy: 65.86
Round  18, Train loss: 1.805, Test loss: 1.726, Test accuracy: 74.04
Round  18, Global train loss: 1.805, Global test loss: 1.797, Global test accuracy: 67.42
Round  19, Train loss: 1.855, Test loss: 1.724, Test accuracy: 74.10
Round  19, Global train loss: 1.855, Global test loss: 1.784, Global test accuracy: 69.22
Round  20, Train loss: 1.810, Test loss: 1.723, Test accuracy: 74.24
Round  20, Global train loss: 1.810, Global test loss: 1.778, Global test accuracy: 69.44
Round  21, Train loss: 1.813, Test loss: 1.723, Test accuracy: 74.28
Round  21, Global train loss: 1.813, Global test loss: 1.789, Global test accuracy: 68.02
Round  22, Train loss: 1.851, Test loss: 1.723, Test accuracy: 74.18
Round  22, Global train loss: 1.851, Global test loss: 1.773, Global test accuracy: 69.80
Round  23, Train loss: 1.795, Test loss: 1.721, Test accuracy: 74.28
Round  23, Global train loss: 1.795, Global test loss: 1.756, Global test accuracy: 71.58
Round  24, Train loss: 1.889, Test loss: 1.723, Test accuracy: 74.18
Round  24, Global train loss: 1.889, Global test loss: 1.778, Global test accuracy: 69.64
Round  25, Train loss: 1.829, Test loss: 1.724, Test accuracy: 74.02
Round  25, Global train loss: 1.829, Global test loss: 1.803, Global test accuracy: 66.70
Round  26, Train loss: 1.788, Test loss: 1.721, Test accuracy: 74.28
Round  26, Global train loss: 1.788, Global test loss: 1.772, Global test accuracy: 69.92
Round  27, Train loss: 1.825, Test loss: 1.721, Test accuracy: 74.26
Round  27, Global train loss: 1.825, Global test loss: 1.766, Global test accuracy: 70.38
Round  28, Train loss: 1.783, Test loss: 1.723, Test accuracy: 74.24
Round  28, Global train loss: 1.783, Global test loss: 1.766, Global test accuracy: 70.52
Round  29, Train loss: 1.826, Test loss: 1.722, Test accuracy: 74.20
Round  29, Global train loss: 1.826, Global test loss: 1.777, Global test accuracy: 69.34
Round  30, Train loss: 1.790, Test loss: 1.722, Test accuracy: 74.20
Round  30, Global train loss: 1.790, Global test loss: 1.756, Global test accuracy: 71.52
Round  31, Train loss: 1.784, Test loss: 1.722, Test accuracy: 74.22
Round  31, Global train loss: 1.784, Global test loss: 1.750, Global test accuracy: 71.68
Round  32, Train loss: 1.726, Test loss: 1.720, Test accuracy: 74.36
Round  32, Global train loss: 1.726, Global test loss: 1.759, Global test accuracy: 70.64
Round  33, Train loss: 1.821, Test loss: 1.720, Test accuracy: 74.38
Round  33, Global train loss: 1.821, Global test loss: 1.760, Global test accuracy: 70.64
Round  34, Train loss: 1.822, Test loss: 1.720, Test accuracy: 74.36
Round  34, Global train loss: 1.822, Global test loss: 1.758, Global test accuracy: 70.92
Round  35, Train loss: 1.783, Test loss: 1.720, Test accuracy: 74.40
Round  35, Global train loss: 1.783, Global test loss: 1.783, Global test accuracy: 68.00
Round  36, Train loss: 1.845, Test loss: 1.719, Test accuracy: 74.36
Round  36, Global train loss: 1.845, Global test loss: 1.776, Global test accuracy: 69.16
Round  37, Train loss: 1.776, Test loss: 1.720, Test accuracy: 74.32
Round  37, Global train loss: 1.776, Global test loss: 1.768, Global test accuracy: 70.06
Round  38, Train loss: 1.819, Test loss: 1.720, Test accuracy: 74.22
Round  38, Global train loss: 1.819, Global test loss: 1.752, Global test accuracy: 71.64
Round  39, Train loss: 1.719, Test loss: 1.719, Test accuracy: 74.34
Round  39, Global train loss: 1.719, Global test loss: 1.754, Global test accuracy: 71.00
Round  40, Train loss: 1.776, Test loss: 1.720, Test accuracy: 74.22
Round  40, Global train loss: 1.776, Global test loss: 1.755, Global test accuracy: 71.16
Round  41, Train loss: 1.712, Test loss: 1.719, Test accuracy: 74.24
Round  41, Global train loss: 1.712, Global test loss: 1.757, Global test accuracy: 71.00
Round  42, Train loss: 1.773, Test loss: 1.719, Test accuracy: 74.20
Round  42, Global train loss: 1.773, Global test loss: 1.789, Global test accuracy: 67.66
Round  43, Train loss: 1.777, Test loss: 1.718, Test accuracy: 74.30
Round  43, Global train loss: 1.777, Global test loss: 1.803, Global test accuracy: 65.96
Round  44, Train loss: 1.732, Test loss: 1.720, Test accuracy: 74.16
Round  44, Global train loss: 1.732, Global test loss: 1.761, Global test accuracy: 70.16
Round  45, Train loss: 1.833, Test loss: 1.718, Test accuracy: 74.36
Round  45, Global train loss: 1.833, Global test loss: 1.775, Global test accuracy: 69.22
Round  46, Train loss: 1.838, Test loss: 1.719, Test accuracy: 74.26
Round  46, Global train loss: 1.838, Global test loss: 1.772, Global test accuracy: 69.94
Round  47, Train loss: 1.751, Test loss: 1.718, Test accuracy: 74.34
Round  47, Global train loss: 1.751, Global test loss: 1.741, Global test accuracy: 72.70
Round  48, Train loss: 1.770, Test loss: 1.718, Test accuracy: 74.40
Round  48, Global train loss: 1.770, Global test loss: 1.751, Global test accuracy: 71.32
Round  49, Train loss: 1.834, Test loss: 1.718, Test accuracy: 74.48
Round  49, Global train loss: 1.834, Global test loss: 1.781, Global test accuracy: 68.62
Round  50, Train loss: 1.833, Test loss: 1.717, Test accuracy: 74.48
Round  50, Global train loss: 1.833, Global test loss: 1.793, Global test accuracy: 67.46
Round  51, Train loss: 1.734, Test loss: 1.717, Test accuracy: 74.52
Round  51, Global train loss: 1.734, Global test loss: 1.745, Global test accuracy: 71.76
Round  52, Train loss: 1.833, Test loss: 1.718, Test accuracy: 74.30
Round  52, Global train loss: 1.833, Global test loss: 1.746, Global test accuracy: 72.14
Round  53, Train loss: 1.820, Test loss: 1.718, Test accuracy: 74.26
Round  53, Global train loss: 1.820, Global test loss: 1.760, Global test accuracy: 70.90
Round  54, Train loss: 1.733, Test loss: 1.718, Test accuracy: 74.28
Round  54, Global train loss: 1.733, Global test loss: 1.745, Global test accuracy: 71.84
Round  55, Train loss: 1.773, Test loss: 1.718, Test accuracy: 74.30
Round  55, Global train loss: 1.773, Global test loss: 1.780, Global test accuracy: 67.98
Round  56, Train loss: 1.772, Test loss: 1.718, Test accuracy: 74.32
Round  56, Global train loss: 1.772, Global test loss: 1.772, Global test accuracy: 68.98
Round  57, Train loss: 1.767, Test loss: 1.718, Test accuracy: 74.42
Round  57, Global train loss: 1.767, Global test loss: 1.746, Global test accuracy: 71.98
Round  58, Train loss: 1.813, Test loss: 1.718, Test accuracy: 74.36
Round  58, Global train loss: 1.813, Global test loss: 1.766, Global test accuracy: 69.90
Round  59, Train loss: 1.836, Test loss: 1.717, Test accuracy: 74.38
Round  59, Global train loss: 1.836, Global test loss: 1.754, Global test accuracy: 71.08
Round  60, Train loss: 1.764, Test loss: 1.717, Test accuracy: 74.38
Round  60, Global train loss: 1.764, Global test loss: 1.743, Global test accuracy: 72.08
Round  61, Train loss: 1.710, Test loss: 1.717, Test accuracy: 74.34
Round  61, Global train loss: 1.710, Global test loss: 1.740, Global test accuracy: 72.36
Round  62, Train loss: 1.836, Test loss: 1.717, Test accuracy: 74.28
Round  62, Global train loss: 1.836, Global test loss: 1.743, Global test accuracy: 72.02
Round  63, Train loss: 1.706, Test loss: 1.717, Test accuracy: 74.34
Round  63, Global train loss: 1.706, Global test loss: 1.746, Global test accuracy: 71.70
Round  64, Train loss: 1.788, Test loss: 1.717, Test accuracy: 74.36
Round  64, Global train loss: 1.788, Global test loss: 1.748, Global test accuracy: 71.98
Round  65, Train loss: 1.809, Test loss: 1.717, Test accuracy: 74.30
Round  65, Global train loss: 1.809, Global test loss: 1.744, Global test accuracy: 72.10
Round  66, Train loss: 1.804, Test loss: 1.717, Test accuracy: 74.32
Round  66, Global train loss: 1.804, Global test loss: 1.755, Global test accuracy: 70.90
Round  67, Train loss: 1.770, Test loss: 1.718, Test accuracy: 74.30
Round  67, Global train loss: 1.770, Global test loss: 1.763, Global test accuracy: 69.84
Round  68, Train loss: 1.771, Test loss: 1.718, Test accuracy: 74.32
Round  68, Global train loss: 1.771, Global test loss: 1.750, Global test accuracy: 71.36
Round  69, Train loss: 1.774, Test loss: 1.718, Test accuracy: 74.36
Round  69, Global train loss: 1.774, Global test loss: 1.753, Global test accuracy: 71.28
Round  70, Train loss: 1.711, Test loss: 1.718, Test accuracy: 74.40
Round  70, Global train loss: 1.711, Global test loss: 1.743, Global test accuracy: 71.98
Round  71, Train loss: 1.785, Test loss: 1.717, Test accuracy: 74.46
Round  71, Global train loss: 1.785, Global test loss: 1.748, Global test accuracy: 71.84
Round  72, Train loss: 1.785, Test loss: 1.717, Test accuracy: 74.42
Round  72, Global train loss: 1.785, Global test loss: 1.751, Global test accuracy: 71.40
Round  73, Train loss: 1.874, Test loss: 1.718, Test accuracy: 74.34
Round  73, Global train loss: 1.874, Global test loss: 1.746, Global test accuracy: 71.88
Round  74, Train loss: 1.767, Test loss: 1.718, Test accuracy: 74.32
Round  74, Global train loss: 1.767, Global test loss: 1.760, Global test accuracy: 70.20
Round  75, Train loss: 1.729, Test loss: 1.717, Test accuracy: 74.38
Round  75, Global train loss: 1.729, Global test loss: 1.760, Global test accuracy: 70.26
Round  76, Train loss: 1.886, Test loss: 1.718, Test accuracy: 74.32
Round  76, Global train loss: 1.886, Global test loss: 1.739, Global test accuracy: 72.58
Round  77, Train loss: 1.804, Test loss: 1.718, Test accuracy: 74.34
Round  77, Global train loss: 1.804, Global test loss: 1.746, Global test accuracy: 71.92
Round  78, Train loss: 1.704, Test loss: 1.718, Test accuracy: 74.24
Round  78, Global train loss: 1.704, Global test loss: 1.748, Global test accuracy: 71.66
Round  79, Train loss: 1.783, Test loss: 1.718, Test accuracy: 74.24
Round  79, Global train loss: 1.783, Global test loss: 1.747, Global test accuracy: 72.08
Round  80, Train loss: 1.729, Test loss: 1.718, Test accuracy: 74.28
Round  80, Global train loss: 1.729, Global test loss: 1.758, Global test accuracy: 70.66
Round  81, Train loss: 1.702, Test loss: 1.718, Test accuracy: 74.28
Round  81, Global train loss: 1.702, Global test loss: 1.751, Global test accuracy: 71.30
Round  82, Train loss: 1.728, Test loss: 1.718, Test accuracy: 74.24
Round  82, Global train loss: 1.728, Global test loss: 1.756, Global test accuracy: 70.70
Round  83, Train loss: 1.707, Test loss: 1.718, Test accuracy: 74.34
Round  83, Global train loss: 1.707, Global test loss: 1.742, Global test accuracy: 72.32
Round  84, Train loss: 1.705, Test loss: 1.718, Test accuracy: 74.30
Round  84, Global train loss: 1.705, Global test loss: 1.742, Global test accuracy: 72.16
Round  85, Train loss: 1.765, Test loss: 1.718, Test accuracy: 74.26
Round  85, Global train loss: 1.765, Global test loss: 1.760, Global test accuracy: 70.14
Round  86, Train loss: 1.827, Test loss: 1.718, Test accuracy: 74.34
Round  86, Global train loss: 1.827, Global test loss: 1.743, Global test accuracy: 72.28
Round  87, Train loss: 1.770, Test loss: 1.718, Test accuracy: 74.34
Round  87, Global train loss: 1.770, Global test loss: 1.743, Global test accuracy: 72.16
Round  88, Train loss: 1.743, Test loss: 1.718, Test accuracy: 74.36
Round  88, Global train loss: 1.743, Global test loss: 1.742, Global test accuracy: 72.20
Round  89, Train loss: 1.827, Test loss: 1.718, Test accuracy: 74.28
Round  89, Global train loss: 1.827, Global test loss: 1.740, Global test accuracy: 72.42
Round  90, Train loss: 1.761, Test loss: 1.720, Test accuracy: 74.06
Round  90, Global train loss: 1.761, Global test loss: 1.748, Global test accuracy: 71.68
Round  91, Train loss: 1.760, Test loss: 1.719, Test accuracy: 74.32
Round  91, Global train loss: 1.760, Global test loss: 1.743, Global test accuracy: 72.28
Round  92, Train loss: 1.770, Test loss: 1.719, Test accuracy: 74.30
Round  92, Global train loss: 1.770, Global test loss: 1.742, Global test accuracy: 72.18
Round  93, Train loss: 1.843, Test loss: 1.719, Test accuracy: 74.26
Round  93, Global train loss: 1.843, Global test loss: 1.752, Global test accuracy: 71.54
Round  94, Train loss: 1.763, Test loss: 1.719, Test accuracy: 74.28
Round  94, Global train loss: 1.763, Global test loss: 1.753, Global test accuracy: 70.96/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.727, Test loss: 1.719, Test accuracy: 74.32
Round  95, Global train loss: 1.727, Global test loss: 1.764, Global test accuracy: 69.74
Round  96, Train loss: 1.725, Test loss: 1.719, Test accuracy: 74.32
Round  96, Global train loss: 1.725, Global test loss: 1.772, Global test accuracy: 68.78
Round  97, Train loss: 1.756, Test loss: 1.719, Test accuracy: 74.28
Round  97, Global train loss: 1.756, Global test loss: 1.744, Global test accuracy: 72.28
Round  98, Train loss: 1.783, Test loss: 1.719, Test accuracy: 74.30
Round  98, Global train loss: 1.783, Global test loss: 1.741, Global test accuracy: 72.24
Round  99, Train loss: 1.807, Test loss: 1.719, Test accuracy: 74.26
Round  99, Global train loss: 1.807, Global test loss: 1.750, Global test accuracy: 71.50
Final Round, Train loss: 1.770, Test loss: 1.719, Test accuracy: 74.28
Final Round, Global train loss: 1.770, Global test loss: 1.750, Global test accuracy: 71.50
Average accuracy final 10 rounds: 74.27 

Average global accuracy final 10 rounds: 71.318 

815.7912039756775
[1.3078546524047852, 2.6157093048095703, 3.7122645378112793, 4.808819770812988, 6.00734281539917, 7.205865859985352, 8.431475400924683, 9.657084941864014, 10.73824691772461, 11.819408893585205, 12.958622694015503, 14.0978364944458, 15.123100996017456, 16.14836549758911, 17.32788395881653, 18.507402420043945, 19.613349676132202, 20.71929693222046, 22.117828369140625, 23.51635980606079, 24.723551511764526, 25.93074321746826, 27.01454758644104, 28.09835195541382, 29.224474668502808, 30.350597381591797, 31.43401265144348, 32.517427921295166, 33.7307014465332, 34.94397497177124, 35.99855279922485, 37.05313062667847, 38.18102765083313, 39.30892467498779, 40.48468494415283, 41.66044521331787, 42.77748227119446, 43.894519329071045, 45.034297466278076, 46.17407560348511, 47.31295347213745, 48.451831340789795, 49.60339975357056, 50.75496816635132, 51.826833724975586, 52.89869928359985, 53.97263503074646, 55.046570777893066, 56.18296194076538, 57.319353103637695, 58.57357382774353, 59.827794551849365, 60.96668839454651, 62.10558223724365, 63.224854469299316, 64.34412670135498, 65.49282717704773, 66.64152765274048, 67.71332788467407, 68.78512811660767, 69.99597215652466, 71.20681619644165, 72.33302402496338, 73.45923185348511, 74.7387285232544, 76.01822519302368, 77.15722298622131, 78.29622077941895, 79.41369318962097, 80.531165599823, 81.74353861808777, 82.95591163635254, 84.08134937286377, 85.206787109375, 86.43802285194397, 87.66925859451294, 88.84767818450928, 90.02609777450562, 91.31881976127625, 92.61154174804688, 93.85296583175659, 95.09438991546631, 96.24585270881653, 97.39731550216675, 98.5182032585144, 99.63909101486206, 100.86186361312866, 102.08463621139526, 103.19131660461426, 104.29799699783325, 105.52978086471558, 106.7615647315979, 107.95841383934021, 109.15526294708252, 110.4366807937622, 111.7180986404419, 112.90426564216614, 114.09043264389038, 115.21708250045776, 116.34373235702515, 117.50358700752258, 118.66344165802002, 119.8473002910614, 121.03115892410278, 122.16779637336731, 123.30443382263184, 124.46806693077087, 125.63170003890991, 126.79033923149109, 127.94897842407227, 129.21455907821655, 130.48013973236084, 131.88761615753174, 133.29509258270264, 134.42548775672913, 135.55588293075562, 136.69915318489075, 137.84242343902588, 138.96347856521606, 140.08453369140625, 141.41021728515625, 142.73590087890625, 143.89972925186157, 145.0635576248169, 146.4571976661682, 147.85083770751953, 149.23132848739624, 150.61181926727295, 151.85896277427673, 153.10610628128052, 154.52269458770752, 155.93928289413452, 157.06366848945618, 158.18805408477783, 159.33471632003784, 160.48137855529785, 161.7060387134552, 162.93069887161255, 164.0048315525055, 165.07896423339844, 166.13479161262512, 167.1906189918518, 168.327534198761, 169.46444940567017, 170.49093866348267, 171.51742792129517, 172.72442317008972, 173.93141841888428, 175.05219912528992, 176.17297983169556, 177.30995106697083, 178.4469223022461, 179.84720659255981, 181.24749088287354, 182.47366333007812, 183.69983577728271, 184.92234826087952, 186.14486074447632, 187.3302938938141, 188.51572704315186, 189.6420557498932, 190.76838445663452, 191.9477996826172, 193.12721490859985, 194.2834129333496, 195.43961095809937, 196.55725598335266, 197.67490100860596, 198.80566263198853, 199.9364242553711, 201.16827726364136, 202.40013027191162, 203.72150087356567, 205.04287147521973, 206.20355081558228, 207.36423015594482, 208.5592541694641, 209.7542781829834, 211.01668548583984, 212.2790927886963, 213.37790894508362, 214.47672510147095, 215.64175367355347, 216.806782245636, 217.9349229335785, 219.063063621521, 220.18956899642944, 221.3160743713379, 222.5990765094757, 223.88207864761353, 225.01314520835876, 226.144211769104, 227.41285586357117, 228.68149995803833, 229.92475533485413, 231.16801071166992, 232.30271339416504, 233.43741607666016, 234.49266695976257, 235.547917842865, 238.0107548236847, 240.4735918045044]
[16.72, 16.72, 26.28, 26.28, 34.02, 34.02, 41.38, 41.38, 51.36, 51.36, 52.92, 52.92, 63.54, 63.54, 66.24, 66.24, 67.76, 67.76, 69.94, 69.94, 69.9, 69.9, 71.22, 71.22, 72.18, 72.18, 71.66, 71.66, 73.44, 73.44, 73.58, 73.58, 73.84, 73.84, 73.96, 73.96, 74.04, 74.04, 74.1, 74.1, 74.24, 74.24, 74.28, 74.28, 74.18, 74.18, 74.28, 74.28, 74.18, 74.18, 74.02, 74.02, 74.28, 74.28, 74.26, 74.26, 74.24, 74.24, 74.2, 74.2, 74.2, 74.2, 74.22, 74.22, 74.36, 74.36, 74.38, 74.38, 74.36, 74.36, 74.4, 74.4, 74.36, 74.36, 74.32, 74.32, 74.22, 74.22, 74.34, 74.34, 74.22, 74.22, 74.24, 74.24, 74.2, 74.2, 74.3, 74.3, 74.16, 74.16, 74.36, 74.36, 74.26, 74.26, 74.34, 74.34, 74.4, 74.4, 74.48, 74.48, 74.48, 74.48, 74.52, 74.52, 74.3, 74.3, 74.26, 74.26, 74.28, 74.28, 74.3, 74.3, 74.32, 74.32, 74.42, 74.42, 74.36, 74.36, 74.38, 74.38, 74.38, 74.38, 74.34, 74.34, 74.28, 74.28, 74.34, 74.34, 74.36, 74.36, 74.3, 74.3, 74.32, 74.32, 74.3, 74.3, 74.32, 74.32, 74.36, 74.36, 74.4, 74.4, 74.46, 74.46, 74.42, 74.42, 74.34, 74.34, 74.32, 74.32, 74.38, 74.38, 74.32, 74.32, 74.34, 74.34, 74.24, 74.24, 74.24, 74.24, 74.28, 74.28, 74.28, 74.28, 74.24, 74.24, 74.34, 74.34, 74.3, 74.3, 74.26, 74.26, 74.34, 74.34, 74.34, 74.34, 74.36, 74.36, 74.28, 74.28, 74.06, 74.06, 74.32, 74.32, 74.3, 74.3, 74.26, 74.26, 74.28, 74.28, 74.32, 74.32, 74.32, 74.32, 74.28, 74.28, 74.3, 74.3, 74.26, 74.26, 74.28, 74.28]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.315, Test loss: 2.299, Test accuracy: 16.22
Round   0, Global train loss: 2.315, Global test loss: 2.299, Global test accuracy: 14.98
Round   1, Train loss: 2.293, Test loss: 2.293, Test accuracy: 23.48
Round   1, Global train loss: 2.293, Global test loss: 2.295, Global test accuracy: 20.08
Round   2, Train loss: 2.285, Test loss: 2.282, Test accuracy: 20.30
Round   2, Global train loss: 2.285, Global test loss: 2.285, Global test accuracy: 18.10
Round   3, Train loss: 2.254, Test loss: 2.248, Test accuracy: 22.88
Round   3, Global train loss: 2.254, Global test loss: 2.253, Global test accuracy: 18.56
Round   4, Train loss: 2.189, Test loss: 2.170, Test accuracy: 36.00
Round   4, Global train loss: 2.189, Global test loss: 2.177, Global test accuracy: 25.44
Round   5, Train loss: 2.109, Test loss: 2.101, Test accuracy: 46.06
Round   5, Global train loss: 2.109, Global test loss: 2.136, Global test accuracy: 33.70
Round   6, Train loss: 2.004, Test loss: 1.994, Test accuracy: 54.22
Round   6, Global train loss: 2.004, Global test loss: 2.050, Global test accuracy: 44.60
Round   7, Train loss: 1.966, Test loss: 1.948, Test accuracy: 57.08
Round   7, Global train loss: 1.966, Global test loss: 2.030, Global test accuracy: 47.60
Round   8, Train loss: 1.892, Test loss: 1.886, Test accuracy: 63.78
Round   8, Global train loss: 1.892, Global test loss: 2.002, Global test accuracy: 47.74
Round   9, Train loss: 1.893, Test loss: 1.845, Test accuracy: 69.38
Round   9, Global train loss: 1.893, Global test loss: 1.964, Global test accuracy: 59.54
Round  10, Train loss: 1.924, Test loss: 1.839, Test accuracy: 66.90
Round  10, Global train loss: 1.924, Global test loss: 1.988, Global test accuracy: 54.94
Round  11, Train loss: 1.908, Test loss: 1.816, Test accuracy: 69.40
Round  11, Global train loss: 1.908, Global test loss: 1.950, Global test accuracy: 54.28
Round  12, Train loss: 1.868, Test loss: 1.789, Test accuracy: 72.82
Round  12, Global train loss: 1.868, Global test loss: 1.967, Global test accuracy: 53.48
Round  13, Train loss: 1.792, Test loss: 1.764, Test accuracy: 74.84
Round  13, Global train loss: 1.792, Global test loss: 1.918, Global test accuracy: 56.04
Round  14, Train loss: 1.828, Test loss: 1.721, Test accuracy: 80.88
Round  14, Global train loss: 1.828, Global test loss: 1.887, Global test accuracy: 61.92
Round  15, Train loss: 1.772, Test loss: 1.697, Test accuracy: 82.48
Round  15, Global train loss: 1.772, Global test loss: 1.887, Global test accuracy: 61.74
Round  16, Train loss: 1.652, Test loss: 1.670, Test accuracy: 85.48
Round  16, Global train loss: 1.652, Global test loss: 1.882, Global test accuracy: 58.84
Round  17, Train loss: 1.647, Test loss: 1.645, Test accuracy: 87.82
Round  17, Global train loss: 1.647, Global test loss: 1.879, Global test accuracy: 63.32
Round  18, Train loss: 1.732, Test loss: 1.620, Test accuracy: 91.10
Round  18, Global train loss: 1.732, Global test loss: 1.876, Global test accuracy: 68.38
Round  19, Train loss: 1.802, Test loss: 1.616, Test accuracy: 92.06
Round  19, Global train loss: 1.802, Global test loss: 1.910, Global test accuracy: 61.18
Round  20, Train loss: 1.687, Test loss: 1.606, Test accuracy: 92.72
Round  20, Global train loss: 1.687, Global test loss: 1.836, Global test accuracy: 66.10
Round  21, Train loss: 1.678, Test loss: 1.601, Test accuracy: 92.78
Round  21, Global train loss: 1.678, Global test loss: 1.840, Global test accuracy: 65.28
Round  22, Train loss: 1.696, Test loss: 1.600, Test accuracy: 92.62
Round  22, Global train loss: 1.696, Global test loss: 1.888, Global test accuracy: 62.60
Round  23, Train loss: 1.869, Test loss: 1.602, Test accuracy: 92.92
Round  23, Global train loss: 1.869, Global test loss: 1.883, Global test accuracy: 61.86
Round  24, Train loss: 1.678, Test loss: 1.590, Test accuracy: 93.32
Round  24, Global train loss: 1.678, Global test loss: 1.857, Global test accuracy: 66.78
Round  25, Train loss: 1.773, Test loss: 1.591, Test accuracy: 93.70
Round  25, Global train loss: 1.773, Global test loss: 1.855, Global test accuracy: 66.08
Round  26, Train loss: 1.745, Test loss: 1.589, Test accuracy: 93.90
Round  26, Global train loss: 1.745, Global test loss: 1.900, Global test accuracy: 56.96
Round  27, Train loss: 1.666, Test loss: 1.589, Test accuracy: 93.60
Round  27, Global train loss: 1.666, Global test loss: 1.866, Global test accuracy: 66.64
Round  28, Train loss: 1.738, Test loss: 1.590, Test accuracy: 93.60
Round  28, Global train loss: 1.738, Global test loss: 1.903, Global test accuracy: 56.54
Round  29, Train loss: 1.638, Test loss: 1.583, Test accuracy: 93.56
Round  29, Global train loss: 1.638, Global test loss: 1.906, Global test accuracy: 55.32
Round  30, Train loss: 1.855, Test loss: 1.583, Test accuracy: 93.80
Round  30, Global train loss: 1.855, Global test loss: 1.834, Global test accuracy: 73.58
Round  31, Train loss: 1.743, Test loss: 1.574, Test accuracy: 93.84
Round  31, Global train loss: 1.743, Global test loss: 1.857, Global test accuracy: 63.42
Round  32, Train loss: 1.630, Test loss: 1.569, Test accuracy: 93.82
Round  32, Global train loss: 1.630, Global test loss: 1.878, Global test accuracy: 61.36
Round  33, Train loss: 1.623, Test loss: 1.566, Test accuracy: 94.08
Round  33, Global train loss: 1.623, Global test loss: 1.898, Global test accuracy: 56.82
Round  34, Train loss: 1.539, Test loss: 1.560, Test accuracy: 94.10
Round  34, Global train loss: 1.539, Global test loss: 1.805, Global test accuracy: 72.20
Round  35, Train loss: 1.518, Test loss: 1.556, Test accuracy: 94.14
Round  35, Global train loss: 1.518, Global test loss: 1.817, Global test accuracy: 69.90
Round  36, Train loss: 1.753, Test loss: 1.557, Test accuracy: 94.18
Round  36, Global train loss: 1.753, Global test loss: 1.899, Global test accuracy: 61.32
Round  37, Train loss: 1.552, Test loss: 1.555, Test accuracy: 94.30
Round  37, Global train loss: 1.552, Global test loss: 1.819, Global test accuracy: 66.88
Round  38, Train loss: 1.531, Test loss: 1.552, Test accuracy: 94.34
Round  38, Global train loss: 1.531, Global test loss: 1.811, Global test accuracy: 70.38
Round  39, Train loss: 1.609, Test loss: 1.554, Test accuracy: 94.30
Round  39, Global train loss: 1.609, Global test loss: 1.857, Global test accuracy: 64.66
Round  40, Train loss: 1.711, Test loss: 1.557, Test accuracy: 94.30
Round  40, Global train loss: 1.711, Global test loss: 1.891, Global test accuracy: 56.40
Round  41, Train loss: 1.526, Test loss: 1.554, Test accuracy: 94.22
Round  41, Global train loss: 1.526, Global test loss: 1.856, Global test accuracy: 63.40
Round  42, Train loss: 1.635, Test loss: 1.553, Test accuracy: 94.14
Round  42, Global train loss: 1.635, Global test loss: 1.891, Global test accuracy: 57.28
Round  43, Train loss: 1.746, Test loss: 1.553, Test accuracy: 94.04
Round  43, Global train loss: 1.746, Global test loss: 1.885, Global test accuracy: 63.48
Round  44, Train loss: 1.625, Test loss: 1.558, Test accuracy: 93.94
Round  44, Global train loss: 1.625, Global test loss: 1.880, Global test accuracy: 57.10
Round  45, Train loss: 1.608, Test loss: 1.555, Test accuracy: 93.96
Round  45, Global train loss: 1.608, Global test loss: 1.856, Global test accuracy: 62.96
Round  46, Train loss: 1.651, Test loss: 1.551, Test accuracy: 94.16
Round  46, Global train loss: 1.651, Global test loss: 1.918, Global test accuracy: 53.80
Round  47, Train loss: 1.621, Test loss: 1.553, Test accuracy: 94.16
Round  47, Global train loss: 1.621, Global test loss: 1.839, Global test accuracy: 64.86
Round  48, Train loss: 1.731, Test loss: 1.554, Test accuracy: 93.80
Round  48, Global train loss: 1.731, Global test loss: 1.864, Global test accuracy: 62.24
Round  49, Train loss: 1.643, Test loss: 1.553, Test accuracy: 93.90
Round  49, Global train loss: 1.643, Global test loss: 1.923, Global test accuracy: 53.54
Round  50, Train loss: 1.635, Test loss: 1.553, Test accuracy: 93.90
Round  50, Global train loss: 1.635, Global test loss: 1.926, Global test accuracy: 53.54
Round  51, Train loss: 1.719, Test loss: 1.554, Test accuracy: 94.18
Round  51, Global train loss: 1.719, Global test loss: 1.783, Global test accuracy: 76.40
Round  52, Train loss: 1.713, Test loss: 1.558, Test accuracy: 93.92
Round  52, Global train loss: 1.713, Global test loss: 1.856, Global test accuracy: 62.48
Round  53, Train loss: 1.710, Test loss: 1.557, Test accuracy: 94.00
Round  53, Global train loss: 1.710, Global test loss: 1.959, Global test accuracy: 48.38
Round  54, Train loss: 1.610, Test loss: 1.551, Test accuracy: 94.56
Round  54, Global train loss: 1.610, Global test loss: 1.868, Global test accuracy: 61.46
Round  55, Train loss: 1.496, Test loss: 1.547, Test accuracy: 94.52
Round  55, Global train loss: 1.496, Global test loss: 1.879, Global test accuracy: 57.10
Round  56, Train loss: 1.599, Test loss: 1.546, Test accuracy: 94.50
Round  56, Global train loss: 1.599, Global test loss: 1.820, Global test accuracy: 71.50
Round  57, Train loss: 1.691, Test loss: 1.550, Test accuracy: 94.18
Round  57, Global train loss: 1.691, Global test loss: 1.881, Global test accuracy: 58.20
Round  58, Train loss: 1.712, Test loss: 1.554, Test accuracy: 94.06
Round  58, Global train loss: 1.712, Global test loss: 1.862, Global test accuracy: 63.40
Round  59, Train loss: 1.703, Test loss: 1.549, Test accuracy: 94.44
Round  59, Global train loss: 1.703, Global test loss: 1.898, Global test accuracy: 59.18
Round  60, Train loss: 1.612, Test loss: 1.547, Test accuracy: 94.20
Round  60, Global train loss: 1.612, Global test loss: 1.853, Global test accuracy: 62.54
Round  61, Train loss: 1.688, Test loss: 1.549, Test accuracy: 94.18
Round  61, Global train loss: 1.688, Global test loss: 1.811, Global test accuracy: 70.08
Round  62, Train loss: 1.598, Test loss: 1.546, Test accuracy: 94.32
Round  62, Global train loss: 1.598, Global test loss: 1.843, Global test accuracy: 69.08
Round  63, Train loss: 1.502, Test loss: 1.544, Test accuracy: 94.30
Round  63, Global train loss: 1.502, Global test loss: 1.842, Global test accuracy: 62.64
Round  64, Train loss: 1.612, Test loss: 1.543, Test accuracy: 94.04
Round  64, Global train loss: 1.612, Global test loss: 1.813, Global test accuracy: 68.02
Round  65, Train loss: 1.503, Test loss: 1.541, Test accuracy: 94.36
Round  65, Global train loss: 1.503, Global test loss: 1.795, Global test accuracy: 73.32
Round  66, Train loss: 1.694, Test loss: 1.546, Test accuracy: 94.24
Round  66, Global train loss: 1.694, Global test loss: 1.874, Global test accuracy: 63.04
Round  67, Train loss: 1.592, Test loss: 1.543, Test accuracy: 94.08
Round  67, Global train loss: 1.592, Global test loss: 1.851, Global test accuracy: 65.60
Round  68, Train loss: 1.519, Test loss: 1.541, Test accuracy: 94.30
Round  68, Global train loss: 1.519, Global test loss: 1.821, Global test accuracy: 67.68
Round  69, Train loss: 1.698, Test loss: 1.545, Test accuracy: 93.92
Round  69, Global train loss: 1.698, Global test loss: 1.839, Global test accuracy: 71.64
Round  70, Train loss: 1.672, Test loss: 1.552, Test accuracy: 93.72
Round  70, Global train loss: 1.672, Global test loss: 1.819, Global test accuracy: 68.72
Round  71, Train loss: 1.692, Test loss: 1.549, Test accuracy: 93.64
Round  71, Global train loss: 1.692, Global test loss: 1.834, Global test accuracy: 65.72
Round  72, Train loss: 1.777, Test loss: 1.554, Test accuracy: 93.70
Round  72, Global train loss: 1.777, Global test loss: 1.831, Global test accuracy: 71.70
Round  73, Train loss: 1.681, Test loss: 1.555, Test accuracy: 93.62
Round  73, Global train loss: 1.681, Global test loss: 1.849, Global test accuracy: 69.76
Round  74, Train loss: 1.581, Test loss: 1.548, Test accuracy: 93.80
Round  74, Global train loss: 1.581, Global test loss: 1.864, Global test accuracy: 64.04
Round  75, Train loss: 1.588, Test loss: 1.546, Test accuracy: 93.88
Round  75, Global train loss: 1.588, Global test loss: 1.846, Global test accuracy: 64.80
Round  76, Train loss: 1.596, Test loss: 1.544, Test accuracy: 93.78
Round  76, Global train loss: 1.596, Global test loss: 1.870, Global test accuracy: 60.76
Round  77, Train loss: 1.501, Test loss: 1.542, Test accuracy: 94.22
Round  77, Global train loss: 1.501, Global test loss: 1.806, Global test accuracy: 72.30
Round  78, Train loss: 1.589, Test loss: 1.541, Test accuracy: 94.16
Round  78, Global train loss: 1.589, Global test loss: 1.807, Global test accuracy: 67.80
Round  79, Train loss: 1.679, Test loss: 1.546, Test accuracy: 94.00
Round  79, Global train loss: 1.679, Global test loss: 1.834, Global test accuracy: 64.92
Round  80, Train loss: 1.594, Test loss: 1.544, Test accuracy: 93.88
Round  80, Global train loss: 1.594, Global test loss: 1.938, Global test accuracy: 57.18
Round  81, Train loss: 1.497, Test loss: 1.541, Test accuracy: 94.04
Round  81, Global train loss: 1.497, Global test loss: 1.868, Global test accuracy: 62.20
Round  82, Train loss: 1.671, Test loss: 1.543, Test accuracy: 93.96
Round  82, Global train loss: 1.671, Global test loss: 1.891, Global test accuracy: 61.56
Round  83, Train loss: 1.574, Test loss: 1.547, Test accuracy: 93.68
Round  83, Global train loss: 1.574, Global test loss: 1.881, Global test accuracy: 59.56
Round  84, Train loss: 1.572, Test loss: 1.549, Test accuracy: 93.38
Round  84, Global train loss: 1.572, Global test loss: 1.873, Global test accuracy: 60.38
Round  85, Train loss: 1.568, Test loss: 1.547, Test accuracy: 93.58
Round  85, Global train loss: 1.568, Global test loss: 1.825, Global test accuracy: 72.00
Round  86, Train loss: 1.582, Test loss: 1.544, Test accuracy: 93.94
Round  86, Global train loss: 1.582, Global test loss: 1.839, Global test accuracy: 70.78
Round  87, Train loss: 1.588, Test loss: 1.547, Test accuracy: 93.50
Round  87, Global train loss: 1.588, Global test loss: 1.841, Global test accuracy: 67.16
Round  88, Train loss: 1.581, Test loss: 1.550, Test accuracy: 93.44
Round  88, Global train loss: 1.581, Global test loss: 1.880, Global test accuracy: 57.88
Round  89, Train loss: 1.585, Test loss: 1.547, Test accuracy: 93.90
Round  89, Global train loss: 1.585, Global test loss: 1.851, Global test accuracy: 70.38
Round  90, Train loss: 1.748, Test loss: 1.553, Test accuracy: 93.50
Round  90, Global train loss: 1.748, Global test loss: 1.873, Global test accuracy: 62.06
Round  91, Train loss: 1.737, Test loss: 1.563, Test accuracy: 92.92
Round  91, Global train loss: 1.737, Global test loss: 1.887, Global test accuracy: 61.22/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.582, Test loss: 1.556, Test accuracy: 93.06
Round  92, Global train loss: 1.582, Global test loss: 1.864, Global test accuracy: 61.74
Round  93, Train loss: 1.577, Test loss: 1.553, Test accuracy: 93.42
Round  93, Global train loss: 1.577, Global test loss: 1.875, Global test accuracy: 62.58
Round  94, Train loss: 1.565, Test loss: 1.548, Test accuracy: 93.58
Round  94, Global train loss: 1.565, Global test loss: 1.840, Global test accuracy: 70.40
Round  95, Train loss: 1.661, Test loss: 1.550, Test accuracy: 93.54
Round  95, Global train loss: 1.661, Global test loss: 1.934, Global test accuracy: 54.16
Round  96, Train loss: 1.655, Test loss: 1.555, Test accuracy: 93.30
Round  96, Global train loss: 1.655, Global test loss: 1.949, Global test accuracy: 50.58
Round  97, Train loss: 1.586, Test loss: 1.550, Test accuracy: 93.66
Round  97, Global train loss: 1.586, Global test loss: 1.861, Global test accuracy: 61.24
Round  98, Train loss: 1.585, Test loss: 1.546, Test accuracy: 93.66
Round  98, Global train loss: 1.585, Global test loss: 1.812, Global test accuracy: 66.76
Round  99, Train loss: 1.592, Test loss: 1.550, Test accuracy: 93.58
Round  99, Global train loss: 1.592, Global test loss: 1.898, Global test accuracy: 59.98
Final Round, Train loss: 1.585, Test loss: 1.547, Test accuracy: 93.50
Final Round, Global train loss: 1.585, Global test loss: 1.898, Global test accuracy: 59.98
Average accuracy final 10 rounds: 93.422
700.5305087566376
[1.4196767807006836, 2.831023931503296, 4.4456946849823, 5.674862623214722, 6.918193817138672, 8.095970630645752, 9.263502836227417, 10.571719884872437, 11.825966119766235, 13.116583108901978, 14.352201223373413, 15.675983190536499, 16.901030778884888, 18.149296522140503, 19.424891233444214, 20.794652700424194, 22.17744255065918, 23.428611993789673, 24.700812578201294, 25.950398445129395, 27.284117937088013, 28.519062280654907, 29.861334562301636, 31.224660634994507, 32.45303535461426, 33.7358238697052, 35.0533664226532, 36.292837619781494, 37.53738236427307, 38.766284465789795, 39.933366537094116, 41.14655542373657, 42.43592023849487, 43.675150632858276, 44.937870502471924, 46.25238633155823, 47.562129735946655, 48.81222200393677, 50.081748723983765, 51.206822872161865, 52.51488447189331, 53.79482460021973, 55.1013503074646, 56.393640756607056, 57.70654654502869, 58.88634014129639, 60.12848925590515, 61.362579584121704, 62.720417976379395, 64.45026135444641, 65.95312929153442, 67.17822885513306, 68.44194865226746, 70.34130859375, 71.61481642723083, 73.02514243125916, 74.23151564598083, 75.5040693283081, 76.82553339004517, 78.16644740104675, 79.45532488822937, 80.7081069946289, 81.98667216300964, 83.71198892593384, 84.93842363357544, 86.35792660713196, 87.6312460899353, 88.82361841201782, 90.19703078269958, 91.51318550109863, 92.80380582809448, 94.0976550579071, 95.31229758262634, 96.55612254142761, 97.89004826545715, 99.23846912384033, 100.57864737510681, 101.91198706626892, 103.15554809570312, 104.53283524513245, 105.98796820640564, 107.80837917327881, 109.45415139198303, 111.23150110244751, 112.7505431175232, 114.27635884284973, 115.50158452987671, 116.89556694030762, 118.18863201141357, 119.52883696556091, 120.83514928817749, 122.20830583572388, 123.55173301696777, 124.86942672729492, 126.19046473503113, 127.5194456577301, 128.86970114707947, 130.24107575416565, 131.5002555847168, 132.8384931087494, 134.97210121154785]
[16.22, 23.48, 20.3, 22.88, 36.0, 46.06, 54.22, 57.08, 63.78, 69.38, 66.9, 69.4, 72.82, 74.84, 80.88, 82.48, 85.48, 87.82, 91.1, 92.06, 92.72, 92.78, 92.62, 92.92, 93.32, 93.7, 93.9, 93.6, 93.6, 93.56, 93.8, 93.84, 93.82, 94.08, 94.1, 94.14, 94.18, 94.3, 94.34, 94.3, 94.3, 94.22, 94.14, 94.04, 93.94, 93.96, 94.16, 94.16, 93.8, 93.9, 93.9, 94.18, 93.92, 94.0, 94.56, 94.52, 94.5, 94.18, 94.06, 94.44, 94.2, 94.18, 94.32, 94.3, 94.04, 94.36, 94.24, 94.08, 94.3, 93.92, 93.72, 93.64, 93.7, 93.62, 93.8, 93.88, 93.78, 94.22, 94.16, 94.0, 93.88, 94.04, 93.96, 93.68, 93.38, 93.58, 93.94, 93.5, 93.44, 93.9, 93.5, 92.92, 93.06, 93.42, 93.58, 93.54, 93.3, 93.66, 93.66, 93.58, 93.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.318, Test loss: 2.298, Test accuracy: 9.24
Round   0, Global train loss: 2.318, Global test loss: 2.301, Global test accuracy: 8.10
Round   1, Train loss: 2.288, Test loss: 2.287, Test accuracy: 33.34
Round   1, Global train loss: 2.288, Global test loss: 2.295, Global test accuracy: 27.56
Round   2, Train loss: 2.267, Test loss: 2.257, Test accuracy: 38.88
Round   2, Global train loss: 2.267, Global test loss: 2.280, Global test accuracy: 32.66
Round   3, Train loss: 2.207, Test loss: 2.160, Test accuracy: 43.34
Round   3, Global train loss: 2.207, Global test loss: 2.224, Global test accuracy: 33.76
Round   4, Train loss: 2.079, Test loss: 1.980, Test accuracy: 62.32
Round   4, Global train loss: 2.079, Global test loss: 2.107, Global test accuracy: 46.80
Round   5, Train loss: 1.942, Test loss: 1.839, Test accuracy: 71.84
Round   5, Global train loss: 1.942, Global test loss: 2.019, Global test accuracy: 60.34
Round   6, Train loss: 1.863, Test loss: 1.766, Test accuracy: 77.60
Round   6, Global train loss: 1.863, Global test loss: 1.966, Global test accuracy: 65.56
Round   7, Train loss: 1.817, Test loss: 1.720, Test accuracy: 80.60
Round   7, Global train loss: 1.817, Global test loss: 1.930, Global test accuracy: 68.70
Round   8, Train loss: 1.776, Test loss: 1.673, Test accuracy: 86.44
Round   8, Global train loss: 1.776, Global test loss: 1.898, Global test accuracy: 74.58
Round   9, Train loss: 1.742, Test loss: 1.637, Test accuracy: 90.86
Round   9, Global train loss: 1.742, Global test loss: 1.868, Global test accuracy: 78.34
Round  10, Train loss: 1.690, Test loss: 1.621, Test accuracy: 91.88
Round  10, Global train loss: 1.690, Global test loss: 1.932, Global test accuracy: 55.70
Round  11, Train loss: 1.651, Test loss: 1.602, Test accuracy: 91.92
Round  11, Global train loss: 1.651, Global test loss: 1.865, Global test accuracy: 67.32
Round  12, Train loss: 1.650, Test loss: 1.598, Test accuracy: 91.56
Round  12, Global train loss: 1.650, Global test loss: 1.919, Global test accuracy: 55.66
Round  13, Train loss: 1.606, Test loss: 1.590, Test accuracy: 92.58
Round  13, Global train loss: 1.606, Global test loss: 1.858, Global test accuracy: 65.30
Round  14, Train loss: 1.600, Test loss: 1.586, Test accuracy: 92.48
Round  14, Global train loss: 1.600, Global test loss: 1.844, Global test accuracy: 65.40
Round  15, Train loss: 1.601, Test loss: 1.583, Test accuracy: 92.50
Round  15, Global train loss: 1.601, Global test loss: 1.828, Global test accuracy: 68.14
Round  16, Train loss: 1.596, Test loss: 1.576, Test accuracy: 93.12
Round  16, Global train loss: 1.596, Global test loss: 1.848, Global test accuracy: 63.30
Round  17, Train loss: 1.594, Test loss: 1.572, Test accuracy: 93.08
Round  17, Global train loss: 1.594, Global test loss: 1.845, Global test accuracy: 65.94
Round  18, Train loss: 1.575, Test loss: 1.564, Test accuracy: 93.66
Round  18, Global train loss: 1.575, Global test loss: 1.879, Global test accuracy: 64.42
Round  19, Train loss: 1.558, Test loss: 1.561, Test accuracy: 94.12
Round  19, Global train loss: 1.558, Global test loss: 1.919, Global test accuracy: 57.62
Round  20, Train loss: 1.573, Test loss: 1.559, Test accuracy: 93.96
Round  20, Global train loss: 1.573, Global test loss: 1.799, Global test accuracy: 71.36
Round  21, Train loss: 1.550, Test loss: 1.559, Test accuracy: 94.12
Round  21, Global train loss: 1.550, Global test loss: 1.798, Global test accuracy: 71.50
Round  22, Train loss: 1.565, Test loss: 1.559, Test accuracy: 94.08
Round  22, Global train loss: 1.565, Global test loss: 1.868, Global test accuracy: 64.96
Round  23, Train loss: 1.589, Test loss: 1.555, Test accuracy: 94.02
Round  23, Global train loss: 1.589, Global test loss: 1.876, Global test accuracy: 60.28
Round  24, Train loss: 1.564, Test loss: 1.556, Test accuracy: 93.88
Round  24, Global train loss: 1.564, Global test loss: 1.841, Global test accuracy: 66.10
Round  25, Train loss: 1.564, Test loss: 1.554, Test accuracy: 93.92
Round  25, Global train loss: 1.564, Global test loss: 1.880, Global test accuracy: 58.56
Round  26, Train loss: 1.569, Test loss: 1.553, Test accuracy: 94.08
Round  26, Global train loss: 1.569, Global test loss: 1.887, Global test accuracy: 57.14
Round  27, Train loss: 1.558, Test loss: 1.555, Test accuracy: 93.92
Round  27, Global train loss: 1.558, Global test loss: 1.856, Global test accuracy: 66.04
Round  28, Train loss: 1.563, Test loss: 1.554, Test accuracy: 93.94
Round  28, Global train loss: 1.563, Global test loss: 1.886, Global test accuracy: 57.08
Round  29, Train loss: 1.565, Test loss: 1.553, Test accuracy: 93.98
Round  29, Global train loss: 1.565, Global test loss: 1.890, Global test accuracy: 58.74
Round  30, Train loss: 1.553, Test loss: 1.549, Test accuracy: 94.28
Round  30, Global train loss: 1.553, Global test loss: 1.824, Global test accuracy: 71.16
Round  31, Train loss: 1.590, Test loss: 1.548, Test accuracy: 94.06
Round  31, Global train loss: 1.590, Global test loss: 1.859, Global test accuracy: 61.32
Round  32, Train loss: 1.570, Test loss: 1.549, Test accuracy: 94.00
Round  32, Global train loss: 1.570, Global test loss: 1.855, Global test accuracy: 65.74
Round  33, Train loss: 1.557, Test loss: 1.548, Test accuracy: 94.12
Round  33, Global train loss: 1.557, Global test loss: 1.891, Global test accuracy: 58.46
Round  34, Train loss: 1.531, Test loss: 1.545, Test accuracy: 94.34
Round  34, Global train loss: 1.531, Global test loss: 1.814, Global test accuracy: 70.58
Round  35, Train loss: 1.534, Test loss: 1.542, Test accuracy: 94.16
Round  35, Global train loss: 1.534, Global test loss: 1.839, Global test accuracy: 65.86
Round  36, Train loss: 1.527, Test loss: 1.540, Test accuracy: 94.48
Round  36, Global train loss: 1.527, Global test loss: 1.891, Global test accuracy: 61.02
Round  37, Train loss: 1.545, Test loss: 1.540, Test accuracy: 94.30
Round  37, Global train loss: 1.545, Global test loss: 1.815, Global test accuracy: 67.18
Round  38, Train loss: 1.551, Test loss: 1.540, Test accuracy: 94.28
Round  38, Global train loss: 1.551, Global test loss: 1.813, Global test accuracy: 71.88
Round  39, Train loss: 1.553, Test loss: 1.542, Test accuracy: 94.14
Round  39, Global train loss: 1.553, Global test loss: 1.845, Global test accuracy: 67.08
Round  40, Train loss: 1.543, Test loss: 1.540, Test accuracy: 94.46
Round  40, Global train loss: 1.543, Global test loss: 1.888, Global test accuracy: 56.56
Round  41, Train loss: 1.571, Test loss: 1.540, Test accuracy: 94.42
Round  41, Global train loss: 1.571, Global test loss: 1.866, Global test accuracy: 62.40
Round  42, Train loss: 1.546, Test loss: 1.540, Test accuracy: 94.62
Round  42, Global train loss: 1.546, Global test loss: 1.879, Global test accuracy: 62.50
Round  43, Train loss: 1.529, Test loss: 1.536, Test accuracy: 94.74
Round  43, Global train loss: 1.529, Global test loss: 1.867, Global test accuracy: 64.80
Round  44, Train loss: 1.549, Test loss: 1.537, Test accuracy: 94.72
Round  44, Global train loss: 1.549, Global test loss: 1.871, Global test accuracy: 59.10
Round  45, Train loss: 1.515, Test loss: 1.537, Test accuracy: 94.66
Round  45, Global train loss: 1.515, Global test loss: 1.846, Global test accuracy: 65.66
Round  46, Train loss: 1.513, Test loss: 1.532, Test accuracy: 94.94
Round  46, Global train loss: 1.513, Global test loss: 1.914, Global test accuracy: 55.14
Round  47, Train loss: 1.564, Test loss: 1.536, Test accuracy: 94.70
Round  47, Global train loss: 1.564, Global test loss: 1.831, Global test accuracy: 63.94
Round  48, Train loss: 1.545, Test loss: 1.534, Test accuracy: 95.04
Round  48, Global train loss: 1.545, Global test loss: 1.852, Global test accuracy: 61.64
Round  49, Train loss: 1.507, Test loss: 1.532, Test accuracy: 95.10
Round  49, Global train loss: 1.507, Global test loss: 1.908, Global test accuracy: 55.94
Round  50, Train loss: 1.503, Test loss: 1.531, Test accuracy: 95.02
Round  50, Global train loss: 1.503, Global test loss: 1.908, Global test accuracy: 56.12
Round  51, Train loss: 1.525, Test loss: 1.533, Test accuracy: 94.88
Round  51, Global train loss: 1.525, Global test loss: 1.751, Global test accuracy: 79.02
Round  52, Train loss: 1.533, Test loss: 1.534, Test accuracy: 94.64
Round  52, Global train loss: 1.533, Global test loss: 1.842, Global test accuracy: 63.38
Round  53, Train loss: 1.523, Test loss: 1.532, Test accuracy: 94.74
Round  53, Global train loss: 1.523, Global test loss: 1.953, Global test accuracy: 47.38
Round  54, Train loss: 1.512, Test loss: 1.530, Test accuracy: 95.00
Round  54, Global train loss: 1.512, Global test loss: 1.862, Global test accuracy: 59.76
Round  55, Train loss: 1.510, Test loss: 1.530, Test accuracy: 94.98
Round  55, Global train loss: 1.510, Global test loss: 1.901, Global test accuracy: 54.06
Round  56, Train loss: 1.517, Test loss: 1.529, Test accuracy: 95.12
Round  56, Global train loss: 1.517, Global test loss: 1.821, Global test accuracy: 70.52
Round  57, Train loss: 1.555, Test loss: 1.531, Test accuracy: 94.96
Round  57, Global train loss: 1.555, Global test loss: 1.878, Global test accuracy: 57.28
Round  58, Train loss: 1.528, Test loss: 1.532, Test accuracy: 94.80
Round  58, Global train loss: 1.528, Global test loss: 1.851, Global test accuracy: 62.82
Round  59, Train loss: 1.490, Test loss: 1.529, Test accuracy: 95.14
Round  59, Global train loss: 1.490, Global test loss: 1.863, Global test accuracy: 62.70
Round  60, Train loss: 1.556, Test loss: 1.529, Test accuracy: 95.04
Round  60, Global train loss: 1.556, Global test loss: 1.848, Global test accuracy: 61.94
Round  61, Train loss: 1.537, Test loss: 1.529, Test accuracy: 95.06
Round  61, Global train loss: 1.537, Global test loss: 1.776, Global test accuracy: 75.12
Round  62, Train loss: 1.483, Test loss: 1.529, Test accuracy: 95.08
Round  62, Global train loss: 1.483, Global test loss: 1.823, Global test accuracy: 70.58
Round  63, Train loss: 1.524, Test loss: 1.528, Test accuracy: 95.02
Round  63, Global train loss: 1.524, Global test loss: 1.844, Global test accuracy: 63.16
Round  64, Train loss: 1.536, Test loss: 1.526, Test accuracy: 94.96
Round  64, Global train loss: 1.536, Global test loss: 1.800, Global test accuracy: 68.42
Round  65, Train loss: 1.500, Test loss: 1.527, Test accuracy: 95.22
Round  65, Global train loss: 1.500, Global test loss: 1.798, Global test accuracy: 71.92
Round  66, Train loss: 1.543, Test loss: 1.527, Test accuracy: 95.10
Round  66, Global train loss: 1.543, Global test loss: 1.879, Global test accuracy: 61.64
Round  67, Train loss: 1.516, Test loss: 1.527, Test accuracy: 95.10
Round  67, Global train loss: 1.516, Global test loss: 1.852, Global test accuracy: 64.06
Round  68, Train loss: 1.499, Test loss: 1.525, Test accuracy: 95.28
Round  68, Global train loss: 1.499, Global test loss: 1.803, Global test accuracy: 70.44
Round  69, Train loss: 1.507, Test loss: 1.524, Test accuracy: 95.28
Round  69, Global train loss: 1.507, Global test loss: 1.802, Global test accuracy: 71.58
Round  70, Train loss: 1.504, Test loss: 1.525, Test accuracy: 95.12
Round  70, Global train loss: 1.504, Global test loss: 1.769, Global test accuracy: 75.28
Round  71, Train loss: 1.530, Test loss: 1.525, Test accuracy: 95.28
Round  71, Global train loss: 1.530, Global test loss: 1.802, Global test accuracy: 68.96
Round  72, Train loss: 1.500, Test loss: 1.525, Test accuracy: 95.38
Round  72, Global train loss: 1.500, Global test loss: 1.781, Global test accuracy: 73.96
Round  73, Train loss: 1.503, Test loss: 1.525, Test accuracy: 95.36
Round  73, Global train loss: 1.503, Global test loss: 1.808, Global test accuracy: 71.70
Round  74, Train loss: 1.509, Test loss: 1.525, Test accuracy: 95.32
Round  74, Global train loss: 1.509, Global test loss: 1.855, Global test accuracy: 63.22
Round  75, Train loss: 1.505, Test loss: 1.525, Test accuracy: 95.26
Round  75, Global train loss: 1.505, Global test loss: 1.832, Global test accuracy: 66.80
Round  76, Train loss: 1.499, Test loss: 1.523, Test accuracy: 95.30
Round  76, Global train loss: 1.499, Global test loss: 1.840, Global test accuracy: 65.42
Round  77, Train loss: 1.496, Test loss: 1.523, Test accuracy: 95.36
Round  77, Global train loss: 1.496, Global test loss: 1.795, Global test accuracy: 71.64
Round  78, Train loss: 1.496, Test loss: 1.524, Test accuracy: 95.34
Round  78, Global train loss: 1.496, Global test loss: 1.782, Global test accuracy: 71.44
Round  79, Train loss: 1.524, Test loss: 1.523, Test accuracy: 95.40
Round  79, Global train loss: 1.524, Global test loss: 1.794, Global test accuracy: 70.08
Round  80, Train loss: 1.486, Test loss: 1.522, Test accuracy: 95.60
Round  80, Global train loss: 1.486, Global test loss: 1.730, Global test accuracy: 85.48
Round  81, Train loss: 1.485, Test loss: 1.521, Test accuracy: 95.48
Round  81, Global train loss: 1.485, Global test loss: 1.729, Global test accuracy: 85.12
Round  82, Train loss: 1.484, Test loss: 1.521, Test accuracy: 95.46
Round  82, Global train loss: 1.484, Global test loss: 1.725, Global test accuracy: 85.00
Round  83, Train loss: 1.483, Test loss: 1.520, Test accuracy: 95.50
Round  83, Global train loss: 1.483, Global test loss: 1.722, Global test accuracy: 84.96
Round  84, Train loss: 1.483, Test loss: 1.520, Test accuracy: 95.52
Round  84, Global train loss: 1.483, Global test loss: 1.720, Global test accuracy: 84.86
Round  85, Train loss: 1.482, Test loss: 1.519, Test accuracy: 95.54
Round  85, Global train loss: 1.482, Global test loss: 1.719, Global test accuracy: 84.88
Round  86, Train loss: 1.482, Test loss: 1.519, Test accuracy: 95.52
Round  86, Global train loss: 1.482, Global test loss: 1.717, Global test accuracy: 85.16
Round  87, Train loss: 1.482, Test loss: 1.519, Test accuracy: 95.52
Round  87, Global train loss: 1.482, Global test loss: 1.716, Global test accuracy: 85.18
Round  88, Train loss: 1.482, Test loss: 1.519, Test accuracy: 95.54
Round  88, Global train loss: 1.482, Global test loss: 1.716, Global test accuracy: 85.10
Round  89, Train loss: 1.481, Test loss: 1.518, Test accuracy: 95.64
Round  89, Global train loss: 1.481, Global test loss: 1.714, Global test accuracy: 85.38
Round  90, Train loss: 1.481, Test loss: 1.518, Test accuracy: 95.56
Round  90, Global train loss: 1.481, Global test loss: 1.715, Global test accuracy: 85.26
Round  91, Train loss: 1.481, Test loss: 1.518, Test accuracy: 95.56
Round  91, Global train loss: 1.481, Global test loss: 1.715, Global test accuracy: 85.14/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.481, Test loss: 1.518, Test accuracy: 95.60
Round  92, Global train loss: 1.481, Global test loss: 1.715, Global test accuracy: 85.22
Round  93, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.60
Round  93, Global train loss: 1.480, Global test loss: 1.715, Global test accuracy: 85.28
Round  94, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.60
Round  94, Global train loss: 1.480, Global test loss: 1.715, Global test accuracy: 85.18
Round  95, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.72
Round  95, Global train loss: 1.480, Global test loss: 1.715, Global test accuracy: 85.12
Round  96, Train loss: 1.480, Test loss: 1.518, Test accuracy: 95.66
Round  96, Global train loss: 1.480, Global test loss: 1.715, Global test accuracy: 85.14
Round  97, Train loss: 1.479, Test loss: 1.518, Test accuracy: 95.72
Round  97, Global train loss: 1.479, Global test loss: 1.716, Global test accuracy: 85.06
Round  98, Train loss: 1.479, Test loss: 1.518, Test accuracy: 95.66
Round  98, Global train loss: 1.479, Global test loss: 1.716, Global test accuracy: 85.04
Round  99, Train loss: 1.508, Test loss: 1.518, Test accuracy: 95.56
Round  99, Global train loss: 1.508, Global test loss: 1.693, Global test accuracy: 87.08
Final Round, Train loss: 1.585, Test loss: 1.518, Test accuracy: 95.50
Final Round, Global train loss: 1.585, Global test loss: 1.693, Global test accuracy: 87.08
Average accuracy final 10 rounds: 95.62400000000001
1568.102912902832
[1.7698726654052734, 3.3342249393463135, 4.754603147506714, 6.182420969009399, 7.671528100967407, 9.268629789352417, 10.796578884124756, 12.29277753829956, 13.77086615562439, 15.113593816757202, 20.168838262557983, 28.227130889892578, 36.23707675933838, 44.25280547142029, 52.40178155899048, 60.41209316253662, 68.17341208457947, 75.92582845687866, 77.50130653381348, 85.6335289478302, 93.59114933013916, 101.42130637168884, 109.39056468009949, 117.40386462211609, 125.63802456855774, 133.4099681377411, 141.5020821094513, 149.7076539993286, 158.05359292030334, 166.29920649528503, 174.72825407981873, 183.14302158355713, 191.5037076473236, 199.7426953315735, 201.19849181175232, 208.97865056991577, 217.29780530929565, 225.29509449005127, 233.8575758934021, 242.29441928863525, 251.3374719619751, 260.3878490924835, 268.3958737850189, 269.9438292980194, 278.7074716091156, 289.34425592422485, 290.85767889022827, 299.39741134643555, 307.63583540916443, 309.03119921684265, 310.46611499786377, 318.864994764328, 327.22603392601013, 336.4086494445801, 345.4126310348511, 353.55223202705383, 362.0882053375244, 370.5491786003113, 378.9228229522705, 380.37246918678284, 389.16582703590393, 397.4743411540985, 399.0373282432556, 407.2834486961365, 415.696697473526, 417.17727541923523, 425.6618776321411, 433.7470724582672, 435.2142667770386, 443.21661710739136, 450.9655296802521, 459.4372057914734, 467.61770033836365, 475.73836040496826, 483.8958988189697, 492.1877987384796, 500.3043386936188, 501.72257471084595, 503.3624429702759, 511.75448989868164, 513.2446768283844, 514.7074906826019, 516.1449930667877, 517.5424020290375, 519.0028202533722, 520.3720834255219, 521.804053068161, 523.2407608032227, 524.8063514232635, 526.2507309913635, 527.6892218589783, 529.2281379699707, 530.6889395713806, 532.2073776721954, 533.5707287788391, 535.0669391155243, 536.6367566585541, 538.0884954929352, 539.5611877441406, 547.8237557411194, 555.9015877246857]
[9.24, 33.34, 38.88, 43.34, 62.32, 71.84, 77.6, 80.6, 86.44, 90.86, 91.88, 91.92, 91.56, 92.58, 92.48, 92.5, 93.12, 93.08, 93.66, 94.12, 93.96, 94.12, 94.08, 94.02, 93.88, 93.92, 94.08, 93.92, 93.94, 93.98, 94.28, 94.06, 94.0, 94.12, 94.34, 94.16, 94.48, 94.3, 94.28, 94.14, 94.46, 94.42, 94.62, 94.74, 94.72, 94.66, 94.94, 94.7, 95.04, 95.1, 95.02, 94.88, 94.64, 94.74, 95.0, 94.98, 95.12, 94.96, 94.8, 95.14, 95.04, 95.06, 95.08, 95.02, 94.96, 95.22, 95.1, 95.1, 95.28, 95.28, 95.12, 95.28, 95.38, 95.36, 95.32, 95.26, 95.3, 95.36, 95.34, 95.4, 95.6, 95.48, 95.46, 95.5, 95.52, 95.54, 95.52, 95.52, 95.54, 95.64, 95.56, 95.56, 95.6, 95.6, 95.6, 95.72, 95.66, 95.72, 95.66, 95.56, 95.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.293, Test loss: 2.291, Test accuracy: 24.12
Round   0, Global train loss: 2.293, Global test loss: 2.297, Global test accuracy: 20.84
Round   1, Train loss: 2.221, Test loss: 2.215, Test accuracy: 25.20
Round   1, Global train loss: 2.221, Global test loss: 2.250, Global test accuracy: 19.94
Round   2, Train loss: 2.080, Test loss: 2.146, Test accuracy: 32.12
Round   2, Global train loss: 2.080, Global test loss: 2.204, Global test accuracy: 23.32
Round   3, Train loss: 1.976, Test loss: 2.010, Test accuracy: 46.08
Round   3, Global train loss: 1.976, Global test loss: 2.124, Global test accuracy: 31.70
Round   4, Train loss: 2.077, Test loss: 2.007, Test accuracy: 48.32
Round   4, Global train loss: 2.077, Global test loss: 2.195, Global test accuracy: 27.84
Round   5, Train loss: 1.814, Test loss: 1.937, Test accuracy: 55.70
Round   5, Global train loss: 1.814, Global test loss: 2.031, Global test accuracy: 44.24
Round   6, Train loss: 1.812, Test loss: 1.921, Test accuracy: 57.06
Round   6, Global train loss: 1.812, Global test loss: 2.100, Global test accuracy: 38.22
Round   7, Train loss: 1.894, Test loss: 1.879, Test accuracy: 59.98
Round   7, Global train loss: 1.894, Global test loss: 2.110, Global test accuracy: 32.86
Round   8, Train loss: 2.029, Test loss: 1.874, Test accuracy: 60.64
Round   8, Global train loss: 2.029, Global test loss: 2.215, Global test accuracy: 25.02
Round   9, Train loss: 1.586, Test loss: 1.841, Test accuracy: 64.06
Round   9, Global train loss: 1.586, Global test loss: 2.043, Global test accuracy: 40.98
Round  10, Train loss: 1.920, Test loss: 1.807, Test accuracy: 69.44
Round  10, Global train loss: 1.920, Global test loss: 2.101, Global test accuracy: 33.28
Round  11, Train loss: 1.604, Test loss: 1.777, Test accuracy: 72.18
Round  11, Global train loss: 1.604, Global test loss: 2.020, Global test accuracy: 47.64
Round  12, Train loss: 1.814, Test loss: 1.767, Test accuracy: 73.52
Round  12, Global train loss: 1.814, Global test loss: 2.092, Global test accuracy: 35.20
Round  13, Train loss: 1.700, Test loss: 1.764, Test accuracy: 73.36
Round  13, Global train loss: 1.700, Global test loss: 1.985, Global test accuracy: 48.72
Round  14, Train loss: 2.080, Test loss: 1.761, Test accuracy: 72.14
Round  14, Global train loss: 2.080, Global test loss: 2.092, Global test accuracy: 33.46
Round  15, Train loss: 1.491, Test loss: 1.759, Test accuracy: 72.16
Round  15, Global train loss: 1.491, Global test loss: 1.928, Global test accuracy: 54.42
Round  16, Train loss: 1.715, Test loss: 1.755, Test accuracy: 72.28
Round  16, Global train loss: 1.715, Global test loss: 2.019, Global test accuracy: 42.18
Round  17, Train loss: 1.530, Test loss: 1.756, Test accuracy: 71.92
Round  17, Global train loss: 1.530, Global test loss: 2.010, Global test accuracy: 46.80
Round  18, Train loss: 1.746, Test loss: 1.752, Test accuracy: 72.00
Round  18, Global train loss: 1.746, Global test loss: 2.017, Global test accuracy: 44.62
Round  19, Train loss: 1.721, Test loss: 1.755, Test accuracy: 71.10
Round  19, Global train loss: 1.721, Global test loss: 2.075, Global test accuracy: 37.04
Round  20, Train loss: 1.585, Test loss: 1.758, Test accuracy: 70.70
Round  20, Global train loss: 1.585, Global test loss: 2.114, Global test accuracy: 34.86
Round  21, Train loss: 1.921, Test loss: 1.737, Test accuracy: 74.48
Round  21, Global train loss: 1.921, Global test loss: 2.113, Global test accuracy: 36.64
Round  22, Train loss: 1.713, Test loss: 1.738, Test accuracy: 74.36
Round  22, Global train loss: 1.713, Global test loss: 2.029, Global test accuracy: 42.32
Round  23, Train loss: 1.809, Test loss: 1.740, Test accuracy: 73.90
Round  23, Global train loss: 1.809, Global test loss: 2.015, Global test accuracy: 44.86
Round  24, Train loss: 1.751, Test loss: 1.729, Test accuracy: 74.30
Round  24, Global train loss: 1.751, Global test loss: 2.040, Global test accuracy: 44.84
Round  25, Train loss: 1.747, Test loss: 1.730, Test accuracy: 73.56
Round  25, Global train loss: 1.747, Global test loss: 2.111, Global test accuracy: 32.02
Round  26, Train loss: 1.881, Test loss: 1.730, Test accuracy: 73.68
Round  26, Global train loss: 1.881, Global test loss: 2.109, Global test accuracy: 32.84
Round  27, Train loss: 1.650, Test loss: 1.728, Test accuracy: 73.88
Round  27, Global train loss: 1.650, Global test loss: 2.030, Global test accuracy: 41.26
Round  28, Train loss: 1.779, Test loss: 1.731, Test accuracy: 73.36
Round  28, Global train loss: 1.779, Global test loss: 2.037, Global test accuracy: 43.70
Round  29, Train loss: 1.918, Test loss: 1.726, Test accuracy: 74.78
Round  29, Global train loss: 1.918, Global test loss: 2.074, Global test accuracy: 38.56
Round  30, Train loss: 1.665, Test loss: 1.728, Test accuracy: 74.40
Round  30, Global train loss: 1.665, Global test loss: 1.964, Global test accuracy: 52.88
Round  31, Train loss: 1.695, Test loss: 1.724, Test accuracy: 74.86
Round  31, Global train loss: 1.695, Global test loss: 1.946, Global test accuracy: 51.96
Round  32, Train loss: 1.839, Test loss: 1.719, Test accuracy: 75.44
Round  32, Global train loss: 1.839, Global test loss: 1.963, Global test accuracy: 51.68
Round  33, Train loss: 1.575, Test loss: 1.717, Test accuracy: 75.78
Round  33, Global train loss: 1.575, Global test loss: 2.080, Global test accuracy: 39.06
Round  34, Train loss: 1.720, Test loss: 1.695, Test accuracy: 78.44
Round  34, Global train loss: 1.720, Global test loss: 2.060, Global test accuracy: 38.36
Round  35, Train loss: 1.638, Test loss: 1.696, Test accuracy: 78.38
Round  35, Global train loss: 1.638, Global test loss: 2.012, Global test accuracy: 47.38
Round  36, Train loss: 1.968, Test loss: 1.698, Test accuracy: 77.78
Round  36, Global train loss: 1.968, Global test loss: 2.071, Global test accuracy: 38.20
Round  37, Train loss: 1.788, Test loss: 1.701, Test accuracy: 77.28
Round  37, Global train loss: 1.788, Global test loss: 1.969, Global test accuracy: 50.32
Round  38, Train loss: 1.795, Test loss: 1.698, Test accuracy: 77.40
Round  38, Global train loss: 1.795, Global test loss: 2.082, Global test accuracy: 35.80
Round  39, Train loss: 1.609, Test loss: 1.693, Test accuracy: 77.84
Round  39, Global train loss: 1.609, Global test loss: 2.052, Global test accuracy: 41.68
Round  40, Train loss: 1.476, Test loss: 1.692, Test accuracy: 77.80
Round  40, Global train loss: 1.476, Global test loss: 2.157, Global test accuracy: 29.64
Round  41, Train loss: 1.813, Test loss: 1.694, Test accuracy: 77.50
Round  41, Global train loss: 1.813, Global test loss: 2.026, Global test accuracy: 42.38
Round  42, Train loss: 1.599, Test loss: 1.696, Test accuracy: 77.24
Round  42, Global train loss: 1.599, Global test loss: 2.021, Global test accuracy: 43.90
Round  43, Train loss: 1.508, Test loss: 1.694, Test accuracy: 77.46
Round  43, Global train loss: 1.508, Global test loss: 1.966, Global test accuracy: 52.84
Round  44, Train loss: 1.628, Test loss: 1.692, Test accuracy: 77.44
Round  44, Global train loss: 1.628, Global test loss: 2.057, Global test accuracy: 38.88
Round  45, Train loss: 1.725, Test loss: 1.693, Test accuracy: 77.42
Round  45, Global train loss: 1.725, Global test loss: 2.033, Global test accuracy: 41.86
Round  46, Train loss: 1.633, Test loss: 1.700, Test accuracy: 76.64
Round  46, Global train loss: 1.633, Global test loss: 1.951, Global test accuracy: 54.36
Round  47, Train loss: 1.646, Test loss: 1.697, Test accuracy: 76.92
Round  47, Global train loss: 1.646, Global test loss: 1.988, Global test accuracy: 47.82
Round  48, Train loss: 1.605, Test loss: 1.699, Test accuracy: 76.64
Round  48, Global train loss: 1.605, Global test loss: 1.953, Global test accuracy: 51.22
Round  49, Train loss: 1.590, Test loss: 1.701, Test accuracy: 76.28
Round  49, Global train loss: 1.590, Global test loss: 2.024, Global test accuracy: 42.92
Round  50, Train loss: 1.736, Test loss: 1.708, Test accuracy: 75.60
Round  50, Global train loss: 1.736, Global test loss: 2.045, Global test accuracy: 42.28
Round  51, Train loss: 1.699, Test loss: 1.707, Test accuracy: 75.80
Round  51, Global train loss: 1.699, Global test loss: 2.060, Global test accuracy: 39.14
Round  52, Train loss: 1.707, Test loss: 1.709, Test accuracy: 75.60
Round  52, Global train loss: 1.707, Global test loss: 2.012, Global test accuracy: 43.48
Round  53, Train loss: 1.608, Test loss: 1.706, Test accuracy: 75.94
Round  53, Global train loss: 1.608, Global test loss: 2.054, Global test accuracy: 39.58
Round  54, Train loss: 1.504, Test loss: 1.705, Test accuracy: 75.96
Round  54, Global train loss: 1.504, Global test loss: 2.112, Global test accuracy: 34.32
Round  55, Train loss: 1.690, Test loss: 1.704, Test accuracy: 76.06
Round  55, Global train loss: 1.690, Global test loss: 2.040, Global test accuracy: 41.62
Round  56, Train loss: 1.597, Test loss: 1.704, Test accuracy: 76.00
Round  56, Global train loss: 1.597, Global test loss: 1.943, Global test accuracy: 51.54
Round  57, Train loss: 1.725, Test loss: 1.706, Test accuracy: 75.60
Round  57, Global train loss: 1.725, Global test loss: 2.062, Global test accuracy: 37.94
Round  58, Train loss: 1.578, Test loss: 1.706, Test accuracy: 75.56
Round  58, Global train loss: 1.578, Global test loss: 2.081, Global test accuracy: 37.46
Round  59, Train loss: 1.690, Test loss: 1.707, Test accuracy: 75.40
Round  59, Global train loss: 1.690, Global test loss: 2.179, Global test accuracy: 25.76
Round  60, Train loss: 1.599, Test loss: 1.707, Test accuracy: 75.60
Round  60, Global train loss: 1.599, Global test loss: 2.103, Global test accuracy: 35.80
Round  61, Train loss: 1.474, Test loss: 1.707, Test accuracy: 75.62
Round  61, Global train loss: 1.474, Global test loss: 1.978, Global test accuracy: 48.60
Round  62, Train loss: 1.726, Test loss: 1.708, Test accuracy: 75.36
Round  62, Global train loss: 1.726, Global test loss: 2.028, Global test accuracy: 41.96
Round  63, Train loss: 1.472, Test loss: 1.708, Test accuracy: 75.38
Round  63, Global train loss: 1.472, Global test loss: 2.154, Global test accuracy: 29.98
Round  64, Train loss: 1.590, Test loss: 1.707, Test accuracy: 75.60
Round  64, Global train loss: 1.590, Global test loss: 2.078, Global test accuracy: 37.16
Round  65, Train loss: 1.694, Test loss: 1.706, Test accuracy: 75.76
Round  65, Global train loss: 1.694, Global test loss: 2.038, Global test accuracy: 41.40
Round  66, Train loss: 1.783, Test loss: 1.708, Test accuracy: 75.42
Round  66, Global train loss: 1.783, Global test loss: 2.040, Global test accuracy: 42.56
Round  67, Train loss: 1.577, Test loss: 1.707, Test accuracy: 75.66
Round  67, Global train loss: 1.577, Global test loss: 1.999, Global test accuracy: 45.30
Round  68, Train loss: 1.575, Test loss: 1.707, Test accuracy: 75.62
Round  68, Global train loss: 1.575, Global test loss: 1.937, Global test accuracy: 54.58
Round  69, Train loss: 1.542, Test loss: 1.707, Test accuracy: 75.68
Round  69, Global train loss: 1.542, Global test loss: 2.119, Global test accuracy: 33.48
Round  70, Train loss: 1.699, Test loss: 1.706, Test accuracy: 75.68
Round  70, Global train loss: 1.699, Global test loss: 2.000, Global test accuracy: 45.42
Round  71, Train loss: 1.618, Test loss: 1.705, Test accuracy: 75.74
Round  71, Global train loss: 1.618, Global test loss: 1.955, Global test accuracy: 49.44
Round  72, Train loss: 1.755, Test loss: 1.706, Test accuracy: 75.56
Round  72, Global train loss: 1.755, Global test loss: 2.063, Global test accuracy: 38.80
Round  73, Train loss: 1.592, Test loss: 1.706, Test accuracy: 75.64
Round  73, Global train loss: 1.592, Global test loss: 1.875, Global test accuracy: 59.52
Round  74, Train loss: 1.561, Test loss: 1.708, Test accuracy: 75.52
Round  74, Global train loss: 1.561, Global test loss: 2.147, Global test accuracy: 30.28
Round  75, Train loss: 1.571, Test loss: 1.706, Test accuracy: 75.60
Round  75, Global train loss: 1.571, Global test loss: 1.926, Global test accuracy: 56.44
Round  76, Train loss: 1.651, Test loss: 1.707, Test accuracy: 75.56
Round  76, Global train loss: 1.651, Global test loss: 1.977, Global test accuracy: 48.48
Round  77, Train loss: 1.673, Test loss: 1.707, Test accuracy: 75.50
Round  77, Global train loss: 1.673, Global test loss: 2.044, Global test accuracy: 40.46
Round  78, Train loss: 1.551, Test loss: 1.706, Test accuracy: 75.60
Round  78, Global train loss: 1.551, Global test loss: 2.087, Global test accuracy: 36.24
Round  79, Train loss: 1.643, Test loss: 1.706, Test accuracy: 75.60
Round  79, Global train loss: 1.643, Global test loss: 2.017, Global test accuracy: 44.80
Round  80, Train loss: 1.467, Test loss: 1.706, Test accuracy: 75.60
Round  80, Global train loss: 1.467, Global test loss: 2.049, Global test accuracy: 39.88
Round  81, Train loss: 1.469, Test loss: 1.706, Test accuracy: 75.62
Round  81, Global train loss: 1.469, Global test loss: 2.019, Global test accuracy: 40.84
Round  82, Train loss: 1.620, Test loss: 1.707, Test accuracy: 75.44
Round  82, Global train loss: 1.620, Global test loss: 1.997, Global test accuracy: 45.48
Round  83, Train loss: 1.564, Test loss: 1.705, Test accuracy: 75.68
Round  83, Global train loss: 1.564, Global test loss: 1.920, Global test accuracy: 57.26
Round  84, Train loss: 1.589, Test loss: 1.704, Test accuracy: 75.72
Round  84, Global train loss: 1.589, Global test loss: 2.019, Global test accuracy: 43.40
Round  85, Train loss: 1.605, Test loss: 1.706, Test accuracy: 75.64
Round  85, Global train loss: 1.605, Global test loss: 1.971, Global test accuracy: 48.52
Round  86, Train loss: 1.580, Test loss: 1.706, Test accuracy: 75.66
Round  86, Global train loss: 1.580, Global test loss: 1.949, Global test accuracy: 51.56
Round  87, Train loss: 1.655, Test loss: 1.706, Test accuracy: 75.54
Round  87, Global train loss: 1.655, Global test loss: 2.147, Global test accuracy: 29.64
Round  88, Train loss: 1.575, Test loss: 1.705, Test accuracy: 75.58
Round  88, Global train loss: 1.575, Global test loss: 1.992, Global test accuracy: 48.30
Round  89, Train loss: 1.619, Test loss: 1.707, Test accuracy: 75.26
Round  89, Global train loss: 1.619, Global test loss: 2.007, Global test accuracy: 44.38
Round  90, Train loss: 1.544, Test loss: 1.707, Test accuracy: 75.26
Round  90, Global train loss: 1.544, Global test loss: 1.928, Global test accuracy: 52.92
Round  91, Train loss: 1.590, Test loss: 1.709, Test accuracy: 75.14
Round  91, Global train loss: 1.590, Global test loss: 2.034, Global test accuracy: 41.64
Round  92, Train loss: 1.520, Test loss: 1.710, Test accuracy: 75.06
Round  92, Global train loss: 1.520, Global test loss: 2.125, Global test accuracy: 33.08
Round  93, Train loss: 1.497, Test loss: 1.706, Test accuracy: 75.56
Round  93, Global train loss: 1.497, Global test loss: 2.166, Global test accuracy: 28.22
Round  94, Train loss: 1.591, Test loss: 1.709, Test accuracy: 75.32
Round  94, Global train loss: 1.591, Global test loss: 2.051, Global test accuracy: 43.22/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.614, Test loss: 1.710, Test accuracy: 75.32
Round  95, Global train loss: 1.614, Global test loss: 1.978, Global test accuracy: 48.10
Round  96, Train loss: 1.718, Test loss: 1.710, Test accuracy: 75.24
Round  96, Global train loss: 1.718, Global test loss: 1.965, Global test accuracy: 49.34
Round  97, Train loss: 1.583, Test loss: 1.707, Test accuracy: 75.62
Round  97, Global train loss: 1.583, Global test loss: 2.038, Global test accuracy: 44.72
Round  98, Train loss: 1.613, Test loss: 1.707, Test accuracy: 75.62
Round  98, Global train loss: 1.613, Global test loss: 1.978, Global test accuracy: 48.08
Round  99, Train loss: 1.593, Test loss: 1.707, Test accuracy: 75.58
Round  99, Global train loss: 1.593, Global test loss: 2.006, Global test accuracy: 43.74
Final Round, Train loss: 1.577, Test loss: 1.709, Test accuracy: 75.50
Final Round, Global train loss: 1.577, Global test loss: 2.006, Global test accuracy: 43.74
Average accuracy final 10 rounds: 75.37199999999999 

Average global accuracy final 10 rounds: 43.306 

781.4173452854156
[1.040806770324707, 2.081613540649414, 3.083632707595825, 4.085651874542236, 5.028779983520508, 5.971908092498779, 6.9178948402404785, 7.863881587982178, 8.996097564697266, 10.128313541412354, 11.122314214706421, 12.116314888000488, 13.118973970413208, 14.121633052825928, 15.145092725753784, 16.16855239868164, 17.166459560394287, 18.164366722106934, 19.246460676193237, 20.32855463027954, 21.35043215751648, 22.372309684753418, 23.349531650543213, 24.326753616333008, 25.286866903305054, 26.2469801902771, 27.159377813339233, 28.071775436401367, 29.04531717300415, 30.018858909606934, 31.128732442855835, 32.238605976104736, 33.21620273590088, 34.19379949569702, 35.26447916030884, 36.335158824920654, 37.41673421859741, 38.49830961227417, 39.55753540992737, 40.616761207580566, 41.68087816238403, 42.7449951171875, 43.717660665512085, 44.69032621383667, 45.681798696517944, 46.67327117919922, 47.60329222679138, 48.533313274383545, 49.70827913284302, 50.88324499130249, 51.89581847190857, 52.90839195251465, 53.89460015296936, 54.88080835342407, 55.974369287490845, 57.06793022155762, 58.18008470535278, 59.29223918914795, 60.44374084472656, 61.595242500305176, 62.664167404174805, 63.733092308044434, 64.66286420822144, 65.59263610839844, 66.67491030693054, 67.75718450546265, 68.72631669044495, 69.69544887542725, 70.77857327461243, 71.86169767379761, 72.86437940597534, 73.86706113815308, 74.88740181922913, 75.90774250030518, 76.91268014907837, 77.91761779785156, 78.94602155685425, 79.97442531585693, 81.00146961212158, 82.02851390838623, 83.09014391899109, 84.15177392959595, 85.17339062690735, 86.19500732421875, 87.16618633270264, 88.13736534118652, 89.12749719619751, 90.1176290512085, 91.06775259971619, 92.01787614822388, 93.53138208389282, 95.04488801956177, 96.16932272911072, 97.29375743865967, 98.3371205329895, 99.38048362731934, 100.38292956352234, 101.38537549972534, 102.45825147628784, 103.53112745285034, 104.58552241325378, 105.63991737365723, 106.88625931739807, 108.13260126113892, 109.19882082939148, 110.26504039764404, 111.42809581756592, 112.5911512374878, 113.69361996650696, 114.79608869552612, 115.81209778785706, 116.82810688018799, 117.85731363296509, 118.88652038574219, 119.9427330493927, 120.99894571304321, 122.03249382972717, 123.06604194641113, 124.04444527626038, 125.02284860610962, 126.02023029327393, 127.01761198043823, 128.04290294647217, 129.0681939125061, 130.1209683418274, 131.17374277114868, 132.1189742088318, 133.0642056465149, 134.07337999343872, 135.08255434036255, 136.11241745948792, 137.14228057861328, 138.19372820854187, 139.24517583847046, 140.41932702064514, 141.59347820281982, 142.6542890071869, 143.71509981155396, 144.75096893310547, 145.78683805465698, 146.81079840660095, 147.83475875854492, 148.8683567047119, 149.9019546508789, 150.99400067329407, 152.08604669570923, 153.02255177497864, 153.95905685424805, 155.0199272632599, 156.08079767227173, 157.05434727668762, 158.02789688110352, 159.13821482658386, 160.2485327720642, 161.52912545204163, 162.80971813201904, 163.98016738891602, 165.150616645813, 166.2320041656494, 167.31339168548584, 168.3143391609192, 169.31528663635254, 170.43742322921753, 171.55955982208252, 172.60073614120483, 173.64191246032715, 174.70292139053345, 175.76393032073975, 176.8498296737671, 177.93572902679443, 178.9076738357544, 179.87961864471436, 180.9314112663269, 181.98320388793945, 183.0071234703064, 184.03104305267334, 184.99861311912537, 185.9661831855774, 186.9728138446808, 187.97944450378418, 189.0085527896881, 190.03766107559204, 191.34215664863586, 192.6466522216797, 193.69843673706055, 194.7502212524414, 195.94947600364685, 197.1487307548523, 198.31504940986633, 199.48136806488037, 200.53339529037476, 201.58542251586914, 202.65334844589233, 203.72127437591553, 204.7794270515442, 205.83757972717285, 206.8542034626007, 207.87082719802856, 208.93073916435242, 209.99065113067627, 212.33018803596497, 214.66972494125366]
[24.12, 24.12, 25.2, 25.2, 32.12, 32.12, 46.08, 46.08, 48.32, 48.32, 55.7, 55.7, 57.06, 57.06, 59.98, 59.98, 60.64, 60.64, 64.06, 64.06, 69.44, 69.44, 72.18, 72.18, 73.52, 73.52, 73.36, 73.36, 72.14, 72.14, 72.16, 72.16, 72.28, 72.28, 71.92, 71.92, 72.0, 72.0, 71.1, 71.1, 70.7, 70.7, 74.48, 74.48, 74.36, 74.36, 73.9, 73.9, 74.3, 74.3, 73.56, 73.56, 73.68, 73.68, 73.88, 73.88, 73.36, 73.36, 74.78, 74.78, 74.4, 74.4, 74.86, 74.86, 75.44, 75.44, 75.78, 75.78, 78.44, 78.44, 78.38, 78.38, 77.78, 77.78, 77.28, 77.28, 77.4, 77.4, 77.84, 77.84, 77.8, 77.8, 77.5, 77.5, 77.24, 77.24, 77.46, 77.46, 77.44, 77.44, 77.42, 77.42, 76.64, 76.64, 76.92, 76.92, 76.64, 76.64, 76.28, 76.28, 75.6, 75.6, 75.8, 75.8, 75.6, 75.6, 75.94, 75.94, 75.96, 75.96, 76.06, 76.06, 76.0, 76.0, 75.6, 75.6, 75.56, 75.56, 75.4, 75.4, 75.6, 75.6, 75.62, 75.62, 75.36, 75.36, 75.38, 75.38, 75.6, 75.6, 75.76, 75.76, 75.42, 75.42, 75.66, 75.66, 75.62, 75.62, 75.68, 75.68, 75.68, 75.68, 75.74, 75.74, 75.56, 75.56, 75.64, 75.64, 75.52, 75.52, 75.6, 75.6, 75.56, 75.56, 75.5, 75.5, 75.6, 75.6, 75.6, 75.6, 75.6, 75.6, 75.62, 75.62, 75.44, 75.44, 75.68, 75.68, 75.72, 75.72, 75.64, 75.64, 75.66, 75.66, 75.54, 75.54, 75.58, 75.58, 75.26, 75.26, 75.26, 75.26, 75.14, 75.14, 75.06, 75.06, 75.56, 75.56, 75.32, 75.32, 75.32, 75.32, 75.24, 75.24, 75.62, 75.62, 75.62, 75.62, 75.58, 75.58, 75.5, 75.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.292, Test loss: 2.293, Test accuracy: 20.74
Round   0, Global train loss: 2.292, Global test loss: 2.298, Global test accuracy: 19.16
Round   1, Train loss: 2.248, Test loss: 2.216, Test accuracy: 28.90
Round   1, Global train loss: 2.248, Global test loss: 2.237, Global test accuracy: 26.64
Round   2, Train loss: 2.071, Test loss: 2.138, Test accuracy: 35.22
Round   2, Global train loss: 2.071, Global test loss: 2.161, Global test accuracy: 31.78
Round   3, Train loss: 2.137, Test loss: 2.058, Test accuracy: 41.80
Round   3, Global train loss: 2.137, Global test loss: 2.109, Global test accuracy: 36.44
Round   4, Train loss: 2.070, Test loss: 2.006, Test accuracy: 46.52
Round   4, Global train loss: 2.070, Global test loss: 2.026, Global test accuracy: 45.66
Round   5, Train loss: 1.975, Test loss: 1.972, Test accuracy: 52.30
Round   5, Global train loss: 1.975, Global test loss: 2.000, Global test accuracy: 51.48
Round   6, Train loss: 1.926, Test loss: 1.954, Test accuracy: 52.84
Round   6, Global train loss: 1.926, Global test loss: 1.978, Global test accuracy: 47.86
Round   7, Train loss: 1.777, Test loss: 1.920, Test accuracy: 56.64
Round   7, Global train loss: 1.777, Global test loss: 1.932, Global test accuracy: 54.80
Round   8, Train loss: 2.031, Test loss: 1.886, Test accuracy: 59.46
Round   8, Global train loss: 2.031, Global test loss: 2.021, Global test accuracy: 44.72
Round   9, Train loss: 1.913, Test loss: 1.859, Test accuracy: 61.70
Round   9, Global train loss: 1.913, Global test loss: 1.927, Global test accuracy: 52.14
Round  10, Train loss: 1.730, Test loss: 1.818, Test accuracy: 66.88
Round  10, Global train loss: 1.730, Global test loss: 1.876, Global test accuracy: 60.04
Round  11, Train loss: 1.954, Test loss: 1.762, Test accuracy: 72.00
Round  11, Global train loss: 1.954, Global test loss: 1.876, Global test accuracy: 56.86
Round  12, Train loss: 1.647, Test loss: 1.750, Test accuracy: 72.24
Round  12, Global train loss: 1.647, Global test loss: 1.839, Global test accuracy: 63.78
Round  13, Train loss: 1.871, Test loss: 1.746, Test accuracy: 72.60
Round  13, Global train loss: 1.871, Global test loss: 1.847, Global test accuracy: 60.84
Round  14, Train loss: 1.810, Test loss: 1.721, Test accuracy: 75.16
Round  14, Global train loss: 1.810, Global test loss: 1.833, Global test accuracy: 64.90
Round  15, Train loss: 1.969, Test loss: 1.714, Test accuracy: 75.88
Round  15, Global train loss: 1.969, Global test loss: 1.829, Global test accuracy: 63.14
Round  16, Train loss: 1.794, Test loss: 1.712, Test accuracy: 75.92
Round  16, Global train loss: 1.794, Global test loss: 1.823, Global test accuracy: 64.02
Round  17, Train loss: 1.906, Test loss: 1.713, Test accuracy: 75.60
Round  17, Global train loss: 1.906, Global test loss: 1.802, Global test accuracy: 68.82
Round  18, Train loss: 1.840, Test loss: 1.713, Test accuracy: 75.24
Round  18, Global train loss: 1.840, Global test loss: 1.840, Global test accuracy: 62.82
Round  19, Train loss: 1.627, Test loss: 1.713, Test accuracy: 75.22
Round  19, Global train loss: 1.627, Global test loss: 1.797, Global test accuracy: 66.96
Round  20, Train loss: 1.749, Test loss: 1.715, Test accuracy: 75.04
Round  20, Global train loss: 1.749, Global test loss: 1.802, Global test accuracy: 67.24
Round  21, Train loss: 1.776, Test loss: 1.701, Test accuracy: 76.52
Round  21, Global train loss: 1.776, Global test loss: 1.777, Global test accuracy: 69.28
Round  22, Train loss: 1.683, Test loss: 1.700, Test accuracy: 76.60
Round  22, Global train loss: 1.683, Global test loss: 1.801, Global test accuracy: 65.72
Round  23, Train loss: 1.769, Test loss: 1.702, Test accuracy: 76.34
Round  23, Global train loss: 1.769, Global test loss: 1.815, Global test accuracy: 64.76
Round  24, Train loss: 1.770, Test loss: 1.699, Test accuracy: 76.54
Round  24, Global train loss: 1.770, Global test loss: 1.794, Global test accuracy: 68.44
Round  25, Train loss: 1.883, Test loss: 1.695, Test accuracy: 76.90
Round  25, Global train loss: 1.883, Global test loss: 1.785, Global test accuracy: 68.68
Round  26, Train loss: 1.771, Test loss: 1.683, Test accuracy: 78.36
Round  26, Global train loss: 1.771, Global test loss: 1.759, Global test accuracy: 71.22
Round  27, Train loss: 1.683, Test loss: 1.684, Test accuracy: 78.20
Round  27, Global train loss: 1.683, Global test loss: 1.755, Global test accuracy: 71.22
Round  28, Train loss: 1.736, Test loss: 1.683, Test accuracy: 78.36
Round  28, Global train loss: 1.736, Global test loss: 1.807, Global test accuracy: 65.52
Round  29, Train loss: 1.817, Test loss: 1.683, Test accuracy: 78.38
Round  29, Global train loss: 1.817, Global test loss: 1.769, Global test accuracy: 70.88
Round  30, Train loss: 2.101, Test loss: 1.683, Test accuracy: 78.38
Round  30, Global train loss: 2.101, Global test loss: 1.769, Global test accuracy: 70.08
Round  31, Train loss: 1.788, Test loss: 1.684, Test accuracy: 78.18
Round  31, Global train loss: 1.788, Global test loss: 1.746, Global test accuracy: 72.90
Round  32, Train loss: 1.769, Test loss: 1.683, Test accuracy: 78.40
Round  32, Global train loss: 1.769, Global test loss: 1.740, Global test accuracy: 73.88
Round  33, Train loss: 1.723, Test loss: 1.682, Test accuracy: 78.54
Round  33, Global train loss: 1.723, Global test loss: 1.783, Global test accuracy: 67.64
Round  34, Train loss: 1.811, Test loss: 1.683, Test accuracy: 78.50
Round  34, Global train loss: 1.811, Global test loss: 1.760, Global test accuracy: 71.00
Round  35, Train loss: 1.937, Test loss: 1.683, Test accuracy: 78.30
Round  35, Global train loss: 1.937, Global test loss: 1.724, Global test accuracy: 75.12
Round  36, Train loss: 1.954, Test loss: 1.680, Test accuracy: 78.50
Round  36, Global train loss: 1.954, Global test loss: 1.798, Global test accuracy: 66.72
Round  37, Train loss: 1.754, Test loss: 1.684, Test accuracy: 78.16
Round  37, Global train loss: 1.754, Global test loss: 1.739, Global test accuracy: 73.74
Round  38, Train loss: 1.945, Test loss: 1.679, Test accuracy: 78.72
Round  38, Global train loss: 1.945, Global test loss: 1.759, Global test accuracy: 71.04
Round  39, Train loss: 1.609, Test loss: 1.680, Test accuracy: 78.48
Round  39, Global train loss: 1.609, Global test loss: 1.746, Global test accuracy: 71.48
Round  40, Train loss: 1.782, Test loss: 1.682, Test accuracy: 78.30
Round  40, Global train loss: 1.782, Global test loss: 1.755, Global test accuracy: 71.50
Round  41, Train loss: 1.740, Test loss: 1.681, Test accuracy: 78.18
Round  41, Global train loss: 1.740, Global test loss: 1.736, Global test accuracy: 73.84
Round  42, Train loss: 1.812, Test loss: 1.683, Test accuracy: 77.84
Round  42, Global train loss: 1.812, Global test loss: 1.729, Global test accuracy: 74.16
Round  43, Train loss: 1.758, Test loss: 1.686, Test accuracy: 77.52
Round  43, Global train loss: 1.758, Global test loss: 1.716, Global test accuracy: 75.60
Round  44, Train loss: 1.689, Test loss: 1.681, Test accuracy: 78.06
Round  44, Global train loss: 1.689, Global test loss: 1.721, Global test accuracy: 74.66
Round  45, Train loss: 1.808, Test loss: 1.678, Test accuracy: 78.44
Round  45, Global train loss: 1.808, Global test loss: 1.728, Global test accuracy: 74.38
Round  46, Train loss: 1.913, Test loss: 1.678, Test accuracy: 78.60
Round  46, Global train loss: 1.913, Global test loss: 1.732, Global test accuracy: 73.30
Round  47, Train loss: 1.734, Test loss: 1.677, Test accuracy: 78.58
Round  47, Global train loss: 1.734, Global test loss: 1.724, Global test accuracy: 74.74
Round  48, Train loss: 1.904, Test loss: 1.674, Test accuracy: 79.06
Round  48, Global train loss: 1.904, Global test loss: 1.740, Global test accuracy: 73.26
Round  49, Train loss: 1.793, Test loss: 1.674, Test accuracy: 79.04
Round  49, Global train loss: 1.793, Global test loss: 1.768, Global test accuracy: 69.50
Round  50, Train loss: 1.868, Test loss: 1.684, Test accuracy: 77.80
Round  50, Global train loss: 1.868, Global test loss: 1.775, Global test accuracy: 68.72
Round  51, Train loss: 1.880, Test loss: 1.687, Test accuracy: 77.54
Round  51, Global train loss: 1.880, Global test loss: 1.742, Global test accuracy: 72.74
Round  52, Train loss: 1.748, Test loss: 1.688, Test accuracy: 77.42
Round  52, Global train loss: 1.748, Global test loss: 1.769, Global test accuracy: 69.62
Round  53, Train loss: 1.539, Test loss: 1.687, Test accuracy: 77.48
Round  53, Global train loss: 1.539, Global test loss: 1.745, Global test accuracy: 72.00
Round  54, Train loss: 1.712, Test loss: 1.694, Test accuracy: 76.62
Round  54, Global train loss: 1.712, Global test loss: 1.752, Global test accuracy: 70.98
Round  55, Train loss: 1.887, Test loss: 1.688, Test accuracy: 77.32
Round  55, Global train loss: 1.887, Global test loss: 1.738, Global test accuracy: 73.34
Round  56, Train loss: 1.778, Test loss: 1.682, Test accuracy: 78.04
Round  56, Global train loss: 1.778, Global test loss: 1.766, Global test accuracy: 69.66
Round  57, Train loss: 1.539, Test loss: 1.681, Test accuracy: 78.06
Round  57, Global train loss: 1.539, Global test loss: 1.722, Global test accuracy: 74.64
Round  58, Train loss: 1.938, Test loss: 1.680, Test accuracy: 78.14
Round  58, Global train loss: 1.938, Global test loss: 1.810, Global test accuracy: 64.70
Round  59, Train loss: 1.925, Test loss: 1.683, Test accuracy: 77.86
Round  59, Global train loss: 1.925, Global test loss: 1.780, Global test accuracy: 68.14
Round  60, Train loss: 1.538, Test loss: 1.683, Test accuracy: 77.90
Round  60, Global train loss: 1.538, Global test loss: 1.720, Global test accuracy: 74.86
Round  61, Train loss: 1.918, Test loss: 1.686, Test accuracy: 77.64
Round  61, Global train loss: 1.918, Global test loss: 1.744, Global test accuracy: 71.92
Round  62, Train loss: 1.729, Test loss: 1.686, Test accuracy: 77.46
Round  62, Global train loss: 1.729, Global test loss: 1.721, Global test accuracy: 74.74
Round  63, Train loss: 1.772, Test loss: 1.687, Test accuracy: 77.44
Round  63, Global train loss: 1.772, Global test loss: 1.729, Global test accuracy: 74.00
Round  64, Train loss: 1.536, Test loss: 1.687, Test accuracy: 77.50
Round  64, Global train loss: 1.536, Global test loss: 1.741, Global test accuracy: 72.06
Round  65, Train loss: 1.792, Test loss: 1.687, Test accuracy: 77.58
Round  65, Global train loss: 1.792, Global test loss: 1.717, Global test accuracy: 75.18
Round  66, Train loss: 1.736, Test loss: 1.690, Test accuracy: 77.18
Round  66, Global train loss: 1.736, Global test loss: 1.720, Global test accuracy: 74.50
Round  67, Train loss: 1.795, Test loss: 1.684, Test accuracy: 77.84
Round  67, Global train loss: 1.795, Global test loss: 1.735, Global test accuracy: 73.44
Round  68, Train loss: 1.899, Test loss: 1.682, Test accuracy: 78.16
Round  68, Global train loss: 1.899, Global test loss: 1.724, Global test accuracy: 74.20
Round  69, Train loss: 1.599, Test loss: 1.682, Test accuracy: 78.12
Round  69, Global train loss: 1.599, Global test loss: 1.714, Global test accuracy: 75.34
Round  70, Train loss: 1.938, Test loss: 1.685, Test accuracy: 77.82
Round  70, Global train loss: 1.938, Global test loss: 1.776, Global test accuracy: 68.40
Round  71, Train loss: 1.602, Test loss: 1.685, Test accuracy: 77.72
Round  71, Global train loss: 1.602, Global test loss: 1.710, Global test accuracy: 76.10
Round  72, Train loss: 1.724, Test loss: 1.685, Test accuracy: 77.78
Round  72, Global train loss: 1.724, Global test loss: 1.714, Global test accuracy: 75.44
Round  73, Train loss: 1.769, Test loss: 1.686, Test accuracy: 77.52
Round  73, Global train loss: 1.769, Global test loss: 1.724, Global test accuracy: 74.32
Round  74, Train loss: 1.638, Test loss: 1.686, Test accuracy: 77.52
Round  74, Global train loss: 1.638, Global test loss: 1.735, Global test accuracy: 72.84
Round  75, Train loss: 1.891, Test loss: 1.686, Test accuracy: 77.62
Round  75, Global train loss: 1.891, Global test loss: 1.731, Global test accuracy: 73.10
Round  76, Train loss: 1.701, Test loss: 1.686, Test accuracy: 77.66
Round  76, Global train loss: 1.701, Global test loss: 1.735, Global test accuracy: 73.26
Round  77, Train loss: 1.534, Test loss: 1.686, Test accuracy: 77.64
Round  77, Global train loss: 1.534, Global test loss: 1.711, Global test accuracy: 75.76
Round  78, Train loss: 1.534, Test loss: 1.685, Test accuracy: 77.64
Round  78, Global train loss: 1.534, Global test loss: 1.737, Global test accuracy: 72.50
Round  79, Train loss: 1.598, Test loss: 1.685, Test accuracy: 77.66
Round  79, Global train loss: 1.598, Global test loss: 1.700, Global test accuracy: 76.70
Round  80, Train loss: 1.663, Test loss: 1.685, Test accuracy: 77.72
Round  80, Global train loss: 1.663, Global test loss: 1.701, Global test accuracy: 76.50
Round  81, Train loss: 1.806, Test loss: 1.684, Test accuracy: 77.86
Round  81, Global train loss: 1.806, Global test loss: 1.709, Global test accuracy: 75.78
Round  82, Train loss: 1.703, Test loss: 1.683, Test accuracy: 77.96
Round  82, Global train loss: 1.703, Global test loss: 1.705, Global test accuracy: 76.42
Round  83, Train loss: 1.888, Test loss: 1.684, Test accuracy: 77.84
Round  83, Global train loss: 1.888, Global test loss: 1.720, Global test accuracy: 74.48
Round  84, Train loss: 1.807, Test loss: 1.685, Test accuracy: 77.64
Round  84, Global train loss: 1.807, Global test loss: 1.765, Global test accuracy: 69.52
Round  85, Train loss: 1.869, Test loss: 1.684, Test accuracy: 77.72
Round  85, Global train loss: 1.869, Global test loss: 1.723, Global test accuracy: 75.02
Round  86, Train loss: 2.029, Test loss: 1.682, Test accuracy: 78.16
Round  86, Global train loss: 2.029, Global test loss: 1.731, Global test accuracy: 73.66
Round  87, Train loss: 1.910, Test loss: 1.687, Test accuracy: 77.50
Round  87, Global train loss: 1.910, Global test loss: 1.796, Global test accuracy: 66.24
Round  88, Train loss: 1.881, Test loss: 1.689, Test accuracy: 77.20
Round  88, Global train loss: 1.881, Global test loss: 1.731, Global test accuracy: 73.84
Round  89, Train loss: 1.690, Test loss: 1.678, Test accuracy: 78.48
Round  89, Global train loss: 1.690, Global test loss: 1.724, Global test accuracy: 74.40
Round  90, Train loss: 1.831, Test loss: 1.665, Test accuracy: 79.96
Round  90, Global train loss: 1.831, Global test loss: 1.737, Global test accuracy: 73.14
Round  91, Train loss: 1.662, Test loss: 1.666, Test accuracy: 79.90
Round  91, Global train loss: 1.662, Global test loss: 1.722, Global test accuracy: 75.14
Round  92, Train loss: 1.538, Test loss: 1.667, Test accuracy: 79.74
Round  92, Global train loss: 1.538, Global test loss: 1.711, Global test accuracy: 76.48
Round  93, Train loss: 1.696, Test loss: 1.664, Test accuracy: 79.96
Round  93, Global train loss: 1.696, Global test loss: 1.700, Global test accuracy: 76.70
Round  94, Train loss: 1.815, Test loss: 1.665, Test accuracy: 79.92
Round  94, Global train loss: 1.815, Global test loss: 1.716, Global test accuracy: 74.68/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.544, Test loss: 1.661, Test accuracy: 80.12
Round  95, Global train loss: 1.544, Global test loss: 1.701, Global test accuracy: 76.34
Round  96, Train loss: 1.657, Test loss: 1.651, Test accuracy: 81.36
Round  96, Global train loss: 1.657, Global test loss: 1.691, Global test accuracy: 78.62
Round  97, Train loss: 1.815, Test loss: 1.650, Test accuracy: 81.36
Round  97, Global train loss: 1.815, Global test loss: 1.707, Global test accuracy: 75.54
Round  98, Train loss: 1.539, Test loss: 1.650, Test accuracy: 81.32
Round  98, Global train loss: 1.539, Global test loss: 1.690, Global test accuracy: 77.48
Round  99, Train loss: 1.829, Test loss: 1.640, Test accuracy: 82.58
Round  99, Global train loss: 1.829, Global test loss: 1.738, Global test accuracy: 72.06
Final Round, Train loss: 1.718, Test loss: 1.650, Test accuracy: 81.40
Final Round, Global train loss: 1.718, Global test loss: 1.738, Global test accuracy: 72.06
Average accuracy final 10 rounds: 80.622 

Average global accuracy final 10 rounds: 75.61800000000001 

803.5339527130127
[1.151130199432373, 2.302260398864746, 3.307779312133789, 4.313298225402832, 5.31554388999939, 6.317789554595947, 7.379070281982422, 8.440351009368896, 9.582305669784546, 10.724260330200195, 11.894468545913696, 13.064676761627197, 14.18646502494812, 15.308253288269043, 16.55507802963257, 17.801902770996094, 18.88633108139038, 19.970759391784668, 21.004894733428955, 22.039030075073242, 23.03092646598816, 24.022822856903076, 25.118601322174072, 26.21437978744507, 27.217055559158325, 28.219731330871582, 29.249077320098877, 30.278423309326172, 31.342498064041138, 32.4065728187561, 33.57154059410095, 34.7365083694458, 35.80166029930115, 36.866812229156494, 38.01170802116394, 39.15660381317139, 40.275410175323486, 41.394216537475586, 42.524171352386475, 43.65412616729736, 44.66706609725952, 45.68000602722168, 46.67115592956543, 47.66230583190918, 48.61239242553711, 49.56247901916504, 50.62417554855347, 51.685872077941895, 52.74887490272522, 53.811877727508545, 54.86591935157776, 55.91996097564697, 56.999515771865845, 58.07907056808472, 59.17608046531677, 60.27309036254883, 61.25514578819275, 62.23720121383667, 63.36338782310486, 64.48957443237305, 65.46817827224731, 66.44678211212158, 67.46682167053223, 68.48686122894287, 69.61264038085938, 70.73841953277588, 71.83312344551086, 72.92782735824585, 73.96389198303223, 74.9999566078186, 76.04245090484619, 77.08494520187378, 78.21837306022644, 79.3518009185791, 80.52717208862305, 81.70254325866699, 82.64281964302063, 83.58309602737427, 84.59566116333008, 85.60822629928589, 86.62916970252991, 87.65011310577393, 88.59031295776367, 89.53051280975342, 90.60424160957336, 91.67797040939331, 92.73148918151855, 93.7850079536438, 94.92435932159424, 96.06371068954468, 96.96726536750793, 97.87082004547119, 98.83128571510315, 99.79175138473511, 100.85627293586731, 101.92079448699951, 102.94846367835999, 103.97613286972046, 105.09930443763733, 106.2224760055542, 107.39262461662292, 108.56277322769165, 109.62171530723572, 110.68065738677979, 111.78440237045288, 112.88814735412598, 114.11086654663086, 115.33358573913574, 116.38937067985535, 117.44515562057495, 118.4916262626648, 119.53809690475464, 120.41339302062988, 121.28868913650513, 122.41234827041626, 123.53600740432739, 124.60899448394775, 125.68198156356812, 126.70094418525696, 127.7199068069458, 129.15977573394775, 130.5996446609497, 131.76499605178833, 132.93034744262695, 134.05008172988892, 135.16981601715088, 136.12914562225342, 137.08847522735596, 138.2411618232727, 139.39384841918945, 140.4872133731842, 141.58057832717896, 142.62387561798096, 143.66717290878296, 144.80196595191956, 145.93675899505615, 147.0049238204956, 148.07308864593506, 149.32065892219543, 150.5682291984558, 151.6331295967102, 152.6980299949646, 153.75886154174805, 154.8196930885315, 155.91751146316528, 157.01532983779907, 158.0349826812744, 159.05463552474976, 160.11554765701294, 161.17645978927612, 162.32293796539307, 163.46941614151, 164.5212345123291, 165.5730528831482, 166.6301212310791, 167.68718957901, 168.72256064414978, 169.75793170928955, 170.88699889183044, 172.01606607437134, 173.15382170677185, 174.29157733917236, 175.3909695148468, 176.49036169052124, 177.5157928466797, 178.54122400283813, 179.54824471473694, 180.55526542663574, 181.67828631401062, 182.8013072013855, 183.9118537902832, 185.0224003791809, 185.99631929397583, 186.97023820877075, 187.98656821250916, 189.00289821624756, 190.48824334144592, 191.9735884666443, 193.00863218307495, 194.04367589950562, 195.04539513587952, 196.04711437225342, 197.18012523651123, 198.31313610076904, 199.39833879470825, 200.48354148864746, 201.53555560112, 202.58756971359253, 203.64856362342834, 204.70955753326416, 205.75770735740662, 206.80585718154907, 207.83718061447144, 208.8685040473938, 210.03437900543213, 211.20025396347046, 212.15159225463867, 213.10293054580688, 214.21696162223816, 215.33099269866943, 218.01505708694458, 220.69912147521973]
[20.74, 20.74, 28.9, 28.9, 35.22, 35.22, 41.8, 41.8, 46.52, 46.52, 52.3, 52.3, 52.84, 52.84, 56.64, 56.64, 59.46, 59.46, 61.7, 61.7, 66.88, 66.88, 72.0, 72.0, 72.24, 72.24, 72.6, 72.6, 75.16, 75.16, 75.88, 75.88, 75.92, 75.92, 75.6, 75.6, 75.24, 75.24, 75.22, 75.22, 75.04, 75.04, 76.52, 76.52, 76.6, 76.6, 76.34, 76.34, 76.54, 76.54, 76.9, 76.9, 78.36, 78.36, 78.2, 78.2, 78.36, 78.36, 78.38, 78.38, 78.38, 78.38, 78.18, 78.18, 78.4, 78.4, 78.54, 78.54, 78.5, 78.5, 78.3, 78.3, 78.5, 78.5, 78.16, 78.16, 78.72, 78.72, 78.48, 78.48, 78.3, 78.3, 78.18, 78.18, 77.84, 77.84, 77.52, 77.52, 78.06, 78.06, 78.44, 78.44, 78.6, 78.6, 78.58, 78.58, 79.06, 79.06, 79.04, 79.04, 77.8, 77.8, 77.54, 77.54, 77.42, 77.42, 77.48, 77.48, 76.62, 76.62, 77.32, 77.32, 78.04, 78.04, 78.06, 78.06, 78.14, 78.14, 77.86, 77.86, 77.9, 77.9, 77.64, 77.64, 77.46, 77.46, 77.44, 77.44, 77.5, 77.5, 77.58, 77.58, 77.18, 77.18, 77.84, 77.84, 78.16, 78.16, 78.12, 78.12, 77.82, 77.82, 77.72, 77.72, 77.78, 77.78, 77.52, 77.52, 77.52, 77.52, 77.62, 77.62, 77.66, 77.66, 77.64, 77.64, 77.64, 77.64, 77.66, 77.66, 77.72, 77.72, 77.86, 77.86, 77.96, 77.96, 77.84, 77.84, 77.64, 77.64, 77.72, 77.72, 78.16, 78.16, 77.5, 77.5, 77.2, 77.2, 78.48, 78.48, 79.96, 79.96, 79.9, 79.9, 79.74, 79.74, 79.96, 79.96, 79.92, 79.92, 80.12, 80.12, 81.36, 81.36, 81.36, 81.36, 81.32, 81.32, 82.58, 82.58, 81.4, 81.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.294, Test loss: 2.295, Test accuracy: 21.34
Round   0, Global train loss: 2.294, Global test loss: 2.299, Global test accuracy: 18.00
Round   1, Train loss: 2.282, Test loss: 2.280, Test accuracy: 24.72
Round   1, Global train loss: 2.282, Global test loss: 2.290, Global test accuracy: 18.18
Round   2, Train loss: 2.193, Test loss: 2.201, Test accuracy: 33.86
Round   2, Global train loss: 2.193, Global test loss: 2.202, Global test accuracy: 37.42
Round   3, Train loss: 2.235, Test loss: 2.149, Test accuracy: 36.14
Round   3, Global train loss: 2.235, Global test loss: 2.190, Global test accuracy: 25.08
Round   4, Train loss: 2.020, Test loss: 2.053, Test accuracy: 46.62
Round   4, Global train loss: 2.020, Global test loss: 2.058, Global test accuracy: 48.88
Round   5, Train loss: 2.006, Test loss: 1.993, Test accuracy: 51.20
Round   5, Global train loss: 2.006, Global test loss: 2.004, Global test accuracy: 47.08
Round   6, Train loss: 2.009, Test loss: 1.959, Test accuracy: 53.46
Round   6, Global train loss: 2.009, Global test loss: 1.978, Global test accuracy: 47.96
Round   7, Train loss: 1.794, Test loss: 1.944, Test accuracy: 54.88
Round   7, Global train loss: 1.794, Global test loss: 1.960, Global test accuracy: 52.98
Round   8, Train loss: 1.986, Test loss: 1.895, Test accuracy: 58.16
Round   8, Global train loss: 1.986, Global test loss: 1.987, Global test accuracy: 49.62
Round   9, Train loss: 2.090, Test loss: 1.887, Test accuracy: 58.62
Round   9, Global train loss: 2.090, Global test loss: 1.968, Global test accuracy: 48.88
Round  10, Train loss: 1.970, Test loss: 1.869, Test accuracy: 60.32
Round  10, Global train loss: 1.970, Global test loss: 1.952, Global test accuracy: 50.56
Round  11, Train loss: 1.834, Test loss: 1.837, Test accuracy: 63.64
Round  11, Global train loss: 1.834, Global test loss: 1.918, Global test accuracy: 54.84
Round  12, Train loss: 1.746, Test loss: 1.834, Test accuracy: 63.72
Round  12, Global train loss: 1.746, Global test loss: 1.903, Global test accuracy: 55.62
Round  13, Train loss: 2.025, Test loss: 1.832, Test accuracy: 63.82
Round  13, Global train loss: 2.025, Global test loss: 1.910, Global test accuracy: 55.48
Round  14, Train loss: 1.945, Test loss: 1.830, Test accuracy: 63.78
Round  14, Global train loss: 1.945, Global test loss: 1.901, Global test accuracy: 55.24
Round  15, Train loss: 2.033, Test loss: 1.820, Test accuracy: 64.66
Round  15, Global train loss: 2.033, Global test loss: 1.908, Global test accuracy: 55.68
Round  16, Train loss: 1.948, Test loss: 1.823, Test accuracy: 64.28
Round  16, Global train loss: 1.948, Global test loss: 1.951, Global test accuracy: 48.56
Round  17, Train loss: 1.799, Test loss: 1.823, Test accuracy: 64.26
Round  17, Global train loss: 1.799, Global test loss: 1.907, Global test accuracy: 55.40
Round  18, Train loss: 2.073, Test loss: 1.828, Test accuracy: 63.84
Round  18, Global train loss: 2.073, Global test loss: 1.934, Global test accuracy: 51.96
Round  19, Train loss: 1.852, Test loss: 1.820, Test accuracy: 64.44
Round  19, Global train loss: 1.852, Global test loss: 1.894, Global test accuracy: 56.60
Round  20, Train loss: 1.676, Test loss: 1.819, Test accuracy: 64.52
Round  20, Global train loss: 1.676, Global test loss: 1.871, Global test accuracy: 60.30
Round  21, Train loss: 1.747, Test loss: 1.816, Test accuracy: 64.66
Round  21, Global train loss: 1.747, Global test loss: 1.859, Global test accuracy: 60.56
Round  22, Train loss: 2.044, Test loss: 1.814, Test accuracy: 64.94
Round  22, Global train loss: 2.044, Global test loss: 1.881, Global test accuracy: 59.72
Round  23, Train loss: 1.943, Test loss: 1.812, Test accuracy: 65.18
Round  23, Global train loss: 1.943, Global test loss: 1.933, Global test accuracy: 51.68
Round  24, Train loss: 1.845, Test loss: 1.817, Test accuracy: 64.62
Round  24, Global train loss: 1.845, Global test loss: 1.875, Global test accuracy: 59.22
Round  25, Train loss: 1.686, Test loss: 1.816, Test accuracy: 64.60
Round  25, Global train loss: 1.686, Global test loss: 1.851, Global test accuracy: 61.90
Round  26, Train loss: 1.823, Test loss: 1.817, Test accuracy: 64.52
Round  26, Global train loss: 1.823, Global test loss: 1.857, Global test accuracy: 61.38
Round  27, Train loss: 2.053, Test loss: 1.810, Test accuracy: 65.28
Round  27, Global train loss: 2.053, Global test loss: 1.867, Global test accuracy: 59.74
Round  28, Train loss: 1.764, Test loss: 1.811, Test accuracy: 65.24
Round  28, Global train loss: 1.764, Global test loss: 1.888, Global test accuracy: 56.58
Round  29, Train loss: 1.931, Test loss: 1.813, Test accuracy: 65.02
Round  29, Global train loss: 1.931, Global test loss: 1.865, Global test accuracy: 60.48
Round  30, Train loss: 2.011, Test loss: 1.815, Test accuracy: 64.76
Round  30, Global train loss: 2.011, Global test loss: 1.853, Global test accuracy: 61.34
Round  31, Train loss: 1.868, Test loss: 1.814, Test accuracy: 64.86
Round  31, Global train loss: 1.868, Global test loss: 1.847, Global test accuracy: 62.38
Round  32, Train loss: 1.913, Test loss: 1.815, Test accuracy: 64.70
Round  32, Global train loss: 1.913, Global test loss: 1.861, Global test accuracy: 60.58
Round  33, Train loss: 1.659, Test loss: 1.814, Test accuracy: 64.80
Round  33, Global train loss: 1.659, Global test loss: 1.850, Global test accuracy: 61.66
Round  34, Train loss: 1.845, Test loss: 1.814, Test accuracy: 64.80
Round  34, Global train loss: 1.845, Global test loss: 1.835, Global test accuracy: 63.36
Round  35, Train loss: 1.991, Test loss: 1.817, Test accuracy: 64.34
Round  35, Global train loss: 1.991, Global test loss: 1.852, Global test accuracy: 61.68
Round  36, Train loss: 2.030, Test loss: 1.824, Test accuracy: 63.62
Round  36, Global train loss: 2.030, Global test loss: 1.893, Global test accuracy: 57.60
Round  37, Train loss: 1.894, Test loss: 1.823, Test accuracy: 63.68
Round  37, Global train loss: 1.894, Global test loss: 1.899, Global test accuracy: 56.60
Round  38, Train loss: 1.945, Test loss: 1.822, Test accuracy: 63.86
Round  38, Global train loss: 1.945, Global test loss: 1.863, Global test accuracy: 61.02
Round  39, Train loss: 1.717, Test loss: 1.822, Test accuracy: 63.68
Round  39, Global train loss: 1.717, Global test loss: 1.831, Global test accuracy: 63.34
Round  40, Train loss: 1.877, Test loss: 1.820, Test accuracy: 63.98
Round  40, Global train loss: 1.877, Global test loss: 1.841, Global test accuracy: 62.46
Round  41, Train loss: 1.813, Test loss: 1.821, Test accuracy: 63.82
Round  41, Global train loss: 1.813, Global test loss: 1.853, Global test accuracy: 61.64
Round  42, Train loss: 2.034, Test loss: 1.824, Test accuracy: 63.54
Round  42, Global train loss: 2.034, Global test loss: 1.879, Global test accuracy: 59.02
Round  43, Train loss: 1.842, Test loss: 1.828, Test accuracy: 63.30
Round  43, Global train loss: 1.842, Global test loss: 1.844, Global test accuracy: 61.86
Round  44, Train loss: 1.711, Test loss: 1.825, Test accuracy: 63.50
Round  44, Global train loss: 1.711, Global test loss: 1.848, Global test accuracy: 61.54
Round  45, Train loss: 1.996, Test loss: 1.818, Test accuracy: 64.26
Round  45, Global train loss: 1.996, Global test loss: 1.864, Global test accuracy: 60.72
Round  46, Train loss: 1.802, Test loss: 1.819, Test accuracy: 64.24
Round  46, Global train loss: 1.802, Global test loss: 1.833, Global test accuracy: 63.16
Round  47, Train loss: 1.732, Test loss: 1.818, Test accuracy: 64.20
Round  47, Global train loss: 1.732, Global test loss: 1.824, Global test accuracy: 64.10
Round  48, Train loss: 1.779, Test loss: 1.818, Test accuracy: 64.24
Round  48, Global train loss: 1.779, Global test loss: 1.822, Global test accuracy: 64.30
Round  49, Train loss: 1.931, Test loss: 1.822, Test accuracy: 63.78
Round  49, Global train loss: 1.931, Global test loss: 1.852, Global test accuracy: 61.48
Round  50, Train loss: 1.810, Test loss: 1.825, Test accuracy: 63.58
Round  50, Global train loss: 1.810, Global test loss: 1.874, Global test accuracy: 58.48
Round  51, Train loss: 1.840, Test loss: 1.824, Test accuracy: 63.62
Round  51, Global train loss: 1.840, Global test loss: 1.845, Global test accuracy: 61.68
Round  52, Train loss: 1.907, Test loss: 1.821, Test accuracy: 63.86
Round  52, Global train loss: 1.907, Global test loss: 1.905, Global test accuracy: 55.56
Round  53, Train loss: 1.583, Test loss: 1.822, Test accuracy: 63.70
Round  53, Global train loss: 1.583, Global test loss: 1.824, Global test accuracy: 64.08
Round  54, Train loss: 1.669, Test loss: 1.822, Test accuracy: 63.70
Round  54, Global train loss: 1.669, Global test loss: 1.822, Global test accuracy: 64.08
Round  55, Train loss: 1.912, Test loss: 1.825, Test accuracy: 63.48
Round  55, Global train loss: 1.912, Global test loss: 1.839, Global test accuracy: 62.38
Round  56, Train loss: 1.868, Test loss: 1.828, Test accuracy: 63.22
Round  56, Global train loss: 1.868, Global test loss: 1.856, Global test accuracy: 60.66
Round  57, Train loss: 1.669, Test loss: 1.826, Test accuracy: 63.40
Round  57, Global train loss: 1.669, Global test loss: 1.839, Global test accuracy: 62.38
Round  58, Train loss: 2.053, Test loss: 1.818, Test accuracy: 64.18
Round  58, Global train loss: 2.053, Global test loss: 1.843, Global test accuracy: 61.76
Round  59, Train loss: 1.917, Test loss: 1.819, Test accuracy: 64.08
Round  59, Global train loss: 1.917, Global test loss: 1.863, Global test accuracy: 59.62
Round  60, Train loss: 1.690, Test loss: 1.818, Test accuracy: 64.16
Round  60, Global train loss: 1.690, Global test loss: 1.840, Global test accuracy: 62.32
Round  61, Train loss: 1.901, Test loss: 1.819, Test accuracy: 64.14
Round  61, Global train loss: 1.901, Global test loss: 1.861, Global test accuracy: 59.68
Round  62, Train loss: 1.799, Test loss: 1.823, Test accuracy: 63.64
Round  62, Global train loss: 1.799, Global test loss: 1.839, Global test accuracy: 62.68
Round  63, Train loss: 1.861, Test loss: 1.823, Test accuracy: 63.62
Round  63, Global train loss: 1.861, Global test loss: 1.842, Global test accuracy: 61.88
Round  64, Train loss: 1.601, Test loss: 1.823, Test accuracy: 63.66
Round  64, Global train loss: 1.601, Global test loss: 1.820, Global test accuracy: 64.14
Round  65, Train loss: 1.903, Test loss: 1.824, Test accuracy: 63.64
Round  65, Global train loss: 1.903, Global test loss: 1.837, Global test accuracy: 62.66
Round  66, Train loss: 1.868, Test loss: 1.822, Test accuracy: 63.72
Round  66, Global train loss: 1.868, Global test loss: 1.852, Global test accuracy: 61.18
Round  67, Train loss: 1.999, Test loss: 1.824, Test accuracy: 63.58
Round  67, Global train loss: 1.999, Global test loss: 1.895, Global test accuracy: 57.24
Round  68, Train loss: 1.798, Test loss: 1.824, Test accuracy: 63.52
Round  68, Global train loss: 1.798, Global test loss: 1.824, Global test accuracy: 63.80
Round  69, Train loss: 1.792, Test loss: 1.823, Test accuracy: 63.58
Round  69, Global train loss: 1.792, Global test loss: 1.834, Global test accuracy: 62.88
Round  70, Train loss: 2.098, Test loss: 1.818, Test accuracy: 64.10
Round  70, Global train loss: 2.098, Global test loss: 1.867, Global test accuracy: 59.32
Round  71, Train loss: 1.769, Test loss: 1.821, Test accuracy: 63.84
Round  71, Global train loss: 1.769, Global test loss: 1.844, Global test accuracy: 62.02
Round  72, Train loss: 1.786, Test loss: 1.822, Test accuracy: 63.72
Round  72, Global train loss: 1.786, Global test loss: 1.842, Global test accuracy: 62.14
Round  73, Train loss: 1.830, Test loss: 1.820, Test accuracy: 64.04
Round  73, Global train loss: 1.830, Global test loss: 1.835, Global test accuracy: 62.96
Round  74, Train loss: 1.537, Test loss: 1.819, Test accuracy: 64.00
Round  74, Global train loss: 1.537, Global test loss: 1.823, Global test accuracy: 63.92
Round  75, Train loss: 1.795, Test loss: 1.819, Test accuracy: 64.06
Round  75, Global train loss: 1.795, Global test loss: 1.822, Global test accuracy: 63.94
Round  76, Train loss: 1.722, Test loss: 1.822, Test accuracy: 63.66
Round  76, Global train loss: 1.722, Global test loss: 1.839, Global test accuracy: 62.32
Round  77, Train loss: 1.654, Test loss: 1.819, Test accuracy: 64.00
Round  77, Global train loss: 1.654, Global test loss: 1.831, Global test accuracy: 63.44
Round  78, Train loss: 1.599, Test loss: 1.819, Test accuracy: 64.00
Round  78, Global train loss: 1.599, Global test loss: 1.820, Global test accuracy: 64.12
Round  79, Train loss: 1.761, Test loss: 1.818, Test accuracy: 64.06
Round  79, Global train loss: 1.761, Global test loss: 1.825, Global test accuracy: 63.76
Round  80, Train loss: 1.921, Test loss: 1.818, Test accuracy: 64.06
Round  80, Global train loss: 1.921, Global test loss: 1.833, Global test accuracy: 63.08
Round  81, Train loss: 1.940, Test loss: 1.828, Test accuracy: 63.06
Round  81, Global train loss: 1.940, Global test loss: 1.843, Global test accuracy: 62.32
Round  82, Train loss: 1.721, Test loss: 1.828, Test accuracy: 63.12
Round  82, Global train loss: 1.721, Global test loss: 1.828, Global test accuracy: 63.62
Round  83, Train loss: 1.792, Test loss: 1.828, Test accuracy: 63.10
Round  83, Global train loss: 1.792, Global test loss: 1.822, Global test accuracy: 63.88
Round  84, Train loss: 2.091, Test loss: 1.817, Test accuracy: 64.16
Round  84, Global train loss: 2.091, Global test loss: 1.880, Global test accuracy: 58.08
Round  85, Train loss: 1.897, Test loss: 1.821, Test accuracy: 63.82
Round  85, Global train loss: 1.897, Global test loss: 1.840, Global test accuracy: 62.36
Round  86, Train loss: 1.951, Test loss: 1.817, Test accuracy: 64.22
Round  86, Global train loss: 1.951, Global test loss: 1.842, Global test accuracy: 62.32
Round  87, Train loss: 2.012, Test loss: 1.821, Test accuracy: 63.86
Round  87, Global train loss: 2.012, Global test loss: 1.874, Global test accuracy: 59.18
Round  88, Train loss: 1.944, Test loss: 1.821, Test accuracy: 63.84
Round  88, Global train loss: 1.944, Global test loss: 1.865, Global test accuracy: 59.70
Round  89, Train loss: 1.721, Test loss: 1.819, Test accuracy: 64.08
Round  89, Global train loss: 1.721, Global test loss: 1.831, Global test accuracy: 63.16
Round  90, Train loss: 1.770, Test loss: 1.819, Test accuracy: 63.96
Round  90, Global train loss: 1.770, Global test loss: 1.823, Global test accuracy: 63.74
Round  91, Train loss: 1.697, Test loss: 1.804, Test accuracy: 65.70
Round  91, Global train loss: 1.697, Global test loss: 1.819, Global test accuracy: 63.94
Round  92, Train loss: 1.751, Test loss: 1.780, Test accuracy: 68.34
Round  92, Global train loss: 1.751, Global test loss: 1.818, Global test accuracy: 63.68
Round  93, Train loss: 1.736, Test loss: 1.778, Test accuracy: 68.54
Round  93, Global train loss: 1.736, Global test loss: 1.807, Global test accuracy: 66.20
Round  94, Train loss: 1.581, Test loss: 1.765, Test accuracy: 70.04
Round  94, Global train loss: 1.581, Global test loss: 1.800, Global test accuracy: 65.12/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.735, Test loss: 1.741, Test accuracy: 72.82
Round  95, Global train loss: 1.735, Global test loss: 1.796, Global test accuracy: 66.00
Round  96, Train loss: 1.845, Test loss: 1.728, Test accuracy: 73.88
Round  96, Global train loss: 1.845, Global test loss: 1.799, Global test accuracy: 67.70
Round  97, Train loss: 1.555, Test loss: 1.725, Test accuracy: 74.22
Round  97, Global train loss: 1.555, Global test loss: 1.779, Global test accuracy: 68.98
Round  98, Train loss: 1.719, Test loss: 1.728, Test accuracy: 74.00
Round  98, Global train loss: 1.719, Global test loss: 1.780, Global test accuracy: 68.62
Round  99, Train loss: 1.867, Test loss: 1.712, Test accuracy: 75.54
Round  99, Global train loss: 1.867, Global test loss: 1.816, Global test accuracy: 65.26
Final Round, Train loss: 1.743, Test loss: 1.711, Test accuracy: 75.78
Final Round, Global train loss: 1.743, Global test loss: 1.816, Global test accuracy: 65.26
Average accuracy final 10 rounds: 70.704 

Average global accuracy final 10 rounds: 65.924 

823.0453386306763
[1.2018074989318848, 2.4036149978637695, 3.534665822982788, 4.665716648101807, 5.818307876586914, 6.9708991050720215, 8.21276068687439, 9.454622268676758, 10.548497676849365, 11.642373085021973, 12.771082401275635, 13.899791717529297, 15.10629415512085, 16.312796592712402, 17.53638505935669, 18.759973526000977, 19.925034046173096, 21.090094566345215, 22.33442449569702, 23.578754425048828, 24.75689697265625, 25.935039520263672, 27.1422598361969, 28.349480152130127, 29.46520757675171, 30.58093500137329, 31.688136100769043, 32.795337200164795, 33.859315633773804, 34.92329406738281, 36.11885046958923, 37.314406871795654, 38.48407554626465, 39.65374422073364, 40.80050039291382, 41.947256565093994, 43.15667772293091, 44.36609888076782, 45.54330372810364, 46.72050857543945, 47.93859267234802, 49.15667676925659, 50.22642660140991, 51.29617643356323, 52.52119851112366, 53.74622058868408, 54.912479639053345, 56.07873868942261, 57.26018691062927, 58.44163513183594, 59.70295596122742, 60.9642767906189, 62.11012125015259, 63.25596570968628, 64.2948362827301, 65.33370685577393, 66.46588039398193, 67.59805393218994, 68.68787240982056, 69.77769088745117, 70.83632445335388, 71.89495801925659, 73.14831686019897, 74.40167570114136, 75.62490606307983, 76.84813642501831, 77.91747832298279, 78.98682022094727, 80.0911123752594, 81.19540452957153, 82.34187245368958, 83.48834037780762, 84.67709183692932, 85.86584329605103, 86.98563933372498, 88.10543537139893, 89.35860848426819, 90.61178159713745, 91.75013160705566, 92.88848161697388, 94.11470198631287, 95.34092235565186, 96.51382517814636, 97.68672800064087, 98.84471154212952, 100.00269508361816, 101.1343264579773, 102.26595783233643, 103.40029215812683, 104.53462648391724, 105.65862655639648, 106.78262662887573, 107.98886775970459, 109.19510889053345, 110.35656762123108, 111.51802635192871, 112.77828645706177, 114.03854656219482, 115.23490858078003, 116.43127059936523, 117.65801477432251, 118.88475894927979, 120.09676361083984, 121.3087682723999, 122.50868654251099, 123.70860481262207, 124.98476576805115, 126.26092672348022, 127.46376037597656, 128.6665940284729, 129.81725525856018, 130.96791648864746, 132.0328357219696, 133.09775495529175, 134.43906927108765, 135.78038358688354, 136.88097429275513, 137.9815649986267, 139.0872983932495, 140.19303178787231, 141.4506266117096, 142.70822143554688, 143.8302767276764, 144.9523320198059, 146.0597414970398, 147.16715097427368, 148.24590253829956, 149.32465410232544, 150.50921297073364, 151.69377183914185, 152.84087538719177, 153.9879789352417, 155.15505933761597, 156.32213973999023, 157.52433586120605, 158.72653198242188, 160.03112030029297, 161.33570861816406, 162.4988090991974, 163.6619095802307, 164.88871908187866, 166.1155285835266, 167.2593777179718, 168.403226852417, 169.56929683685303, 170.73536682128906, 171.81574058532715, 172.89611434936523, 174.0256540775299, 175.15519380569458, 176.598326921463, 178.04146003723145, 179.2159776687622, 180.39049530029297, 181.4680359363556, 182.5455765724182, 183.66878461837769, 184.79199266433716, 186.02390050888062, 187.25580835342407, 188.3423409461975, 189.42887353897095, 190.60800123214722, 191.7871289253235, 192.91933298110962, 194.05153703689575, 195.1271994113922, 196.20286178588867, 197.29017114639282, 198.37748050689697, 199.45116019248962, 200.52483987808228, 201.65783143043518, 202.7908229827881, 203.89959526062012, 205.00836753845215, 206.12217259407043, 207.23597764968872, 208.34868144989014, 209.46138525009155, 210.44374537467957, 211.42610549926758, 212.54155158996582, 213.65699768066406, 215.019784450531, 216.38257122039795, 217.60929489135742, 218.8360185623169, 220.40032577514648, 221.96463298797607, 223.12743067741394, 224.2902283668518, 225.4285168647766, 226.56680536270142, 227.8217363357544, 229.07666730880737, 230.22756123542786, 231.37845516204834, 232.60557651519775, 233.83269786834717, 237.34926867485046, 240.86583948135376]
[21.34, 21.34, 24.72, 24.72, 33.86, 33.86, 36.14, 36.14, 46.62, 46.62, 51.2, 51.2, 53.46, 53.46, 54.88, 54.88, 58.16, 58.16, 58.62, 58.62, 60.32, 60.32, 63.64, 63.64, 63.72, 63.72, 63.82, 63.82, 63.78, 63.78, 64.66, 64.66, 64.28, 64.28, 64.26, 64.26, 63.84, 63.84, 64.44, 64.44, 64.52, 64.52, 64.66, 64.66, 64.94, 64.94, 65.18, 65.18, 64.62, 64.62, 64.6, 64.6, 64.52, 64.52, 65.28, 65.28, 65.24, 65.24, 65.02, 65.02, 64.76, 64.76, 64.86, 64.86, 64.7, 64.7, 64.8, 64.8, 64.8, 64.8, 64.34, 64.34, 63.62, 63.62, 63.68, 63.68, 63.86, 63.86, 63.68, 63.68, 63.98, 63.98, 63.82, 63.82, 63.54, 63.54, 63.3, 63.3, 63.5, 63.5, 64.26, 64.26, 64.24, 64.24, 64.2, 64.2, 64.24, 64.24, 63.78, 63.78, 63.58, 63.58, 63.62, 63.62, 63.86, 63.86, 63.7, 63.7, 63.7, 63.7, 63.48, 63.48, 63.22, 63.22, 63.4, 63.4, 64.18, 64.18, 64.08, 64.08, 64.16, 64.16, 64.14, 64.14, 63.64, 63.64, 63.62, 63.62, 63.66, 63.66, 63.64, 63.64, 63.72, 63.72, 63.58, 63.58, 63.52, 63.52, 63.58, 63.58, 64.1, 64.1, 63.84, 63.84, 63.72, 63.72, 64.04, 64.04, 64.0, 64.0, 64.06, 64.06, 63.66, 63.66, 64.0, 64.0, 64.0, 64.0, 64.06, 64.06, 64.06, 64.06, 63.06, 63.06, 63.12, 63.12, 63.1, 63.1, 64.16, 64.16, 63.82, 63.82, 64.22, 64.22, 63.86, 63.86, 63.84, 63.84, 64.08, 64.08, 63.96, 63.96, 65.7, 65.7, 68.34, 68.34, 68.54, 68.54, 70.04, 70.04, 72.82, 72.82, 73.88, 73.88, 74.22, 74.22, 74.0, 74.0, 75.54, 75.54, 75.78, 75.78]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 1, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 1, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.312, Test loss: 2.297, Test accuracy: 20.68
Round   0, Global train loss: 2.312, Global test loss: 2.297, Global test accuracy: 19.04
Round   1, Train loss: 2.281, Test loss: 2.279, Test accuracy: 18.08
Round   1, Global train loss: 2.281, Global test loss: 2.282, Global test accuracy: 16.92
Round   2, Train loss: 2.264, Test loss: 2.261, Test accuracy: 19.98
Round   2, Global train loss: 2.264, Global test loss: 2.268, Global test accuracy: 17.24
Round   3, Train loss: 2.244, Test loss: 2.226, Test accuracy: 28.70
Round   3, Global train loss: 2.244, Global test loss: 2.249, Global test accuracy: 36.92
Round   4, Train loss: 2.182, Test loss: 2.190, Test accuracy: 27.68
Round   4, Global train loss: 2.182, Global test loss: 2.220, Global test accuracy: 21.48
Round   5, Train loss: 2.126, Test loss: 2.121, Test accuracy: 38.10
Round   5, Global train loss: 2.126, Global test loss: 2.144, Global test accuracy: 35.34
Round   6, Train loss: 2.033, Test loss: 2.061, Test accuracy: 45.76
Round   6, Global train loss: 2.033, Global test loss: 2.084, Global test accuracy: 43.96
Round   7, Train loss: 1.968, Test loss: 2.011, Test accuracy: 52.12
Round   7, Global train loss: 1.968, Global test loss: 2.038, Global test accuracy: 53.96
Round   8, Train loss: 2.040, Test loss: 1.984, Test accuracy: 53.16
Round   8, Global train loss: 2.040, Global test loss: 2.125, Global test accuracy: 28.80
Round   9, Train loss: 1.970, Test loss: 1.956, Test accuracy: 58.56
Round   9, Global train loss: 1.970, Global test loss: 2.041, Global test accuracy: 50.52
Round  10, Train loss: 1.923, Test loss: 1.906, Test accuracy: 61.74
Round  10, Global train loss: 1.923, Global test loss: 1.987, Global test accuracy: 50.90
Round  11, Train loss: 2.044, Test loss: 1.898, Test accuracy: 63.72
Round  11, Global train loss: 2.044, Global test loss: 2.018, Global test accuracy: 49.32
Round  12, Train loss: 1.808, Test loss: 1.863, Test accuracy: 67.38
Round  12, Global train loss: 1.808, Global test loss: 1.961, Global test accuracy: 57.18
Round  13, Train loss: 2.039, Test loss: 1.865, Test accuracy: 67.38
Round  13, Global train loss: 2.039, Global test loss: 1.996, Global test accuracy: 52.30
Round  14, Train loss: 1.869, Test loss: 1.858, Test accuracy: 67.78
Round  14, Global train loss: 1.869, Global test loss: 1.963, Global test accuracy: 53.42
Round  15, Train loss: 2.025, Test loss: 1.860, Test accuracy: 67.86
Round  15, Global train loss: 2.025, Global test loss: 1.994, Global test accuracy: 52.84
Round  16, Train loss: 1.853, Test loss: 1.853, Test accuracy: 68.36
Round  16, Global train loss: 1.853, Global test loss: 1.983, Global test accuracy: 46.76
Round  17, Train loss: 2.004, Test loss: 1.856, Test accuracy: 68.56
Round  17, Global train loss: 2.004, Global test loss: 1.994, Global test accuracy: 51.18
Round  18, Train loss: 2.027, Test loss: 1.851, Test accuracy: 69.50
Round  18, Global train loss: 2.027, Global test loss: 2.065, Global test accuracy: 40.46
Round  19, Train loss: 1.917, Test loss: 1.835, Test accuracy: 69.80
Round  19, Global train loss: 1.917, Global test loss: 1.977, Global test accuracy: 54.68
Round  20, Train loss: 2.009, Test loss: 1.839, Test accuracy: 70.46
Round  20, Global train loss: 2.009, Global test loss: 2.052, Global test accuracy: 48.02
Round  21, Train loss: 1.785, Test loss: 1.792, Test accuracy: 73.34
Round  21, Global train loss: 1.785, Global test loss: 1.933, Global test accuracy: 57.64
Round  22, Train loss: 1.847, Test loss: 1.788, Test accuracy: 73.48
Round  22, Global train loss: 1.847, Global test loss: 1.990, Global test accuracy: 50.98
Round  23, Train loss: 1.673, Test loss: 1.784, Test accuracy: 73.22
Round  23, Global train loss: 1.673, Global test loss: 1.958, Global test accuracy: 49.52
Round  24, Train loss: 2.013, Test loss: 1.786, Test accuracy: 72.80
Round  24, Global train loss: 2.013, Global test loss: 2.015, Global test accuracy: 48.96
Round  25, Train loss: 2.004, Test loss: 1.792, Test accuracy: 72.78
Round  25, Global train loss: 2.004, Global test loss: 1.992, Global test accuracy: 52.44
Round  26, Train loss: 1.829, Test loss: 1.784, Test accuracy: 74.44
Round  26, Global train loss: 1.829, Global test loss: 1.948, Global test accuracy: 60.00
Round  27, Train loss: 1.861, Test loss: 1.768, Test accuracy: 76.00
Round  27, Global train loss: 1.861, Global test loss: 1.982, Global test accuracy: 49.46
Round  28, Train loss: 1.822, Test loss: 1.769, Test accuracy: 75.64
Round  28, Global train loss: 1.822, Global test loss: 1.957, Global test accuracy: 53.48
Round  29, Train loss: 1.687, Test loss: 1.758, Test accuracy: 76.56
Round  29, Global train loss: 1.687, Global test loss: 1.945, Global test accuracy: 51.88
Round  30, Train loss: 1.992, Test loss: 1.765, Test accuracy: 76.34
Round  30, Global train loss: 1.992, Global test loss: 1.960, Global test accuracy: 58.98
Round  31, Train loss: 1.800, Test loss: 1.758, Test accuracy: 77.24
Round  31, Global train loss: 1.800, Global test loss: 1.913, Global test accuracy: 60.82
Round  32, Train loss: 1.949, Test loss: 1.755, Test accuracy: 77.50
Round  32, Global train loss: 1.949, Global test loss: 1.951, Global test accuracy: 61.12
Round  33, Train loss: 1.959, Test loss: 1.770, Test accuracy: 76.96
Round  33, Global train loss: 1.959, Global test loss: 2.038, Global test accuracy: 47.34
Round  34, Train loss: 1.696, Test loss: 1.741, Test accuracy: 78.64
Round  34, Global train loss: 1.696, Global test loss: 1.959, Global test accuracy: 54.12
Round  35, Train loss: 2.129, Test loss: 1.752, Test accuracy: 78.86
Round  35, Global train loss: 2.129, Global test loss: 2.039, Global test accuracy: 55.08
Round  36, Train loss: 1.797, Test loss: 1.743, Test accuracy: 78.68
Round  36, Global train loss: 1.797, Global test loss: 1.956, Global test accuracy: 55.16
Round  37, Train loss: 1.922, Test loss: 1.740, Test accuracy: 78.82
Round  37, Global train loss: 1.922, Global test loss: 1.944, Global test accuracy: 62.92
Round  38, Train loss: 1.788, Test loss: 1.702, Test accuracy: 83.16
Round  38, Global train loss: 1.788, Global test loss: 1.942, Global test accuracy: 57.08
Round  39, Train loss: 1.612, Test loss: 1.690, Test accuracy: 82.94
Round  39, Global train loss: 1.612, Global test loss: 1.870, Global test accuracy: 61.32
Round  40, Train loss: 1.950, Test loss: 1.696, Test accuracy: 84.38
Round  40, Global train loss: 1.950, Global test loss: 2.044, Global test accuracy: 43.04
Round  41, Train loss: 1.734, Test loss: 1.691, Test accuracy: 84.62
Round  41, Global train loss: 1.734, Global test loss: 1.917, Global test accuracy: 59.74
Round  42, Train loss: 1.922, Test loss: 1.692, Test accuracy: 84.56
Round  42, Global train loss: 1.922, Global test loss: 2.015, Global test accuracy: 48.04
Round  43, Train loss: 1.728, Test loss: 1.674, Test accuracy: 86.32
Round  43, Global train loss: 1.728, Global test loss: 1.895, Global test accuracy: 59.10
Round  44, Train loss: 1.743, Test loss: 1.675, Test accuracy: 85.84
Round  44, Global train loss: 1.743, Global test loss: 1.910, Global test accuracy: 56.48
Round  45, Train loss: 1.750, Test loss: 1.676, Test accuracy: 86.32
Round  45, Global train loss: 1.750, Global test loss: 1.974, Global test accuracy: 50.88
Round  46, Train loss: 1.728, Test loss: 1.663, Test accuracy: 87.02
Round  46, Global train loss: 1.728, Global test loss: 1.856, Global test accuracy: 68.80
Round  47, Train loss: 1.702, Test loss: 1.665, Test accuracy: 86.66
Round  47, Global train loss: 1.702, Global test loss: 1.867, Global test accuracy: 66.20
Round  48, Train loss: 1.738, Test loss: 1.669, Test accuracy: 86.04
Round  48, Global train loss: 1.738, Global test loss: 1.920, Global test accuracy: 53.72
Round  49, Train loss: 1.735, Test loss: 1.667, Test accuracy: 85.60
Round  49, Global train loss: 1.735, Global test loss: 1.939, Global test accuracy: 57.54
Round  50, Train loss: 1.892, Test loss: 1.683, Test accuracy: 85.58
Round  50, Global train loss: 1.892, Global test loss: 1.974, Global test accuracy: 51.74
Round  51, Train loss: 1.556, Test loss: 1.660, Test accuracy: 86.42
Round  51, Global train loss: 1.556, Global test loss: 1.874, Global test accuracy: 62.96
Round  52, Train loss: 1.539, Test loss: 1.648, Test accuracy: 86.16
Round  52, Global train loss: 1.539, Global test loss: 1.908, Global test accuracy: 53.82
Round  53, Train loss: 1.754, Test loss: 1.663, Test accuracy: 85.60
Round  53, Global train loss: 1.754, Global test loss: 1.958, Global test accuracy: 52.86
Round  54, Train loss: 1.875, Test loss: 1.677, Test accuracy: 84.80
Round  54, Global train loss: 1.875, Global test loss: 1.971, Global test accuracy: 54.28
Round  55, Train loss: 1.736, Test loss: 1.677, Test accuracy: 84.72
Round  55, Global train loss: 1.736, Global test loss: 1.881, Global test accuracy: 66.62
Round  56, Train loss: 1.689, Test loss: 1.668, Test accuracy: 85.66
Round  56, Global train loss: 1.689, Global test loss: 1.894, Global test accuracy: 59.16
Round  57, Train loss: 1.699, Test loss: 1.664, Test accuracy: 86.46
Round  57, Global train loss: 1.699, Global test loss: 1.898, Global test accuracy: 57.14
Round  58, Train loss: 1.695, Test loss: 1.657, Test accuracy: 85.68
Round  58, Global train loss: 1.695, Global test loss: 1.969, Global test accuracy: 45.48
Round  59, Train loss: 1.732, Test loss: 1.661, Test accuracy: 85.42
Round  59, Global train loss: 1.732, Global test loss: 1.977, Global test accuracy: 50.78
Round  60, Train loss: 1.879, Test loss: 1.671, Test accuracy: 84.92
Round  60, Global train loss: 1.879, Global test loss: 1.995, Global test accuracy: 47.50
Round  61, Train loss: 1.688, Test loss: 1.662, Test accuracy: 86.08
Round  61, Global train loss: 1.688, Global test loss: 1.905, Global test accuracy: 57.66
Round  62, Train loss: 1.661, Test loss: 1.663, Test accuracy: 85.46
Round  62, Global train loss: 1.661, Global test loss: 1.892, Global test accuracy: 61.92
Round  63, Train loss: 1.890, Test loss: 1.676, Test accuracy: 84.12
Round  63, Global train loss: 1.890, Global test loss: 2.010, Global test accuracy: 48.42
Round  64, Train loss: 1.693, Test loss: 1.672, Test accuracy: 84.96
Round  64, Global train loss: 1.693, Global test loss: 1.938, Global test accuracy: 53.56
Round  65, Train loss: 1.537, Test loss: 1.647, Test accuracy: 87.06
Round  65, Global train loss: 1.537, Global test loss: 1.872, Global test accuracy: 60.50
Round  66, Train loss: 1.714, Test loss: 1.658, Test accuracy: 85.80
Round  66, Global train loss: 1.714, Global test loss: 1.862, Global test accuracy: 66.80
Round  67, Train loss: 1.890, Test loss: 1.665, Test accuracy: 85.22
Round  67, Global train loss: 1.890, Global test loss: 2.007, Global test accuracy: 46.90
Round  68, Train loss: 1.673, Test loss: 1.657, Test accuracy: 86.06
Round  68, Global train loss: 1.673, Global test loss: 1.848, Global test accuracy: 69.28
Round  69, Train loss: 1.717, Test loss: 1.655, Test accuracy: 86.30
Round  69, Global train loss: 1.717, Global test loss: 1.969, Global test accuracy: 53.62
Round  70, Train loss: 1.684, Test loss: 1.658, Test accuracy: 85.70
Round  70, Global train loss: 1.684, Global test loss: 1.912, Global test accuracy: 55.44
Round  71, Train loss: 1.677, Test loss: 1.663, Test accuracy: 85.10
Round  71, Global train loss: 1.677, Global test loss: 1.886, Global test accuracy: 59.44
Round  72, Train loss: 1.516, Test loss: 1.642, Test accuracy: 87.32
Round  72, Global train loss: 1.516, Global test loss: 1.867, Global test accuracy: 62.08
Round  73, Train loss: 1.681, Test loss: 1.646, Test accuracy: 87.18
Round  73, Global train loss: 1.681, Global test loss: 1.837, Global test accuracy: 71.58
Round  74, Train loss: 1.826, Test loss: 1.670, Test accuracy: 85.06
Round  74, Global train loss: 1.826, Global test loss: 2.028, Global test accuracy: 44.72
Round  75, Train loss: 1.645, Test loss: 1.658, Test accuracy: 86.30
Round  75, Global train loss: 1.645, Global test loss: 1.863, Global test accuracy: 67.46
Round  76, Train loss: 1.649, Test loss: 1.654, Test accuracy: 86.58
Round  76, Global train loss: 1.649, Global test loss: 1.940, Global test accuracy: 52.78
Round  77, Train loss: 1.660, Test loss: 1.657, Test accuracy: 86.04
Round  77, Global train loss: 1.660, Global test loss: 1.907, Global test accuracy: 55.70
Round  78, Train loss: 1.655, Test loss: 1.672, Test accuracy: 84.08
Round  78, Global train loss: 1.655, Global test loss: 1.950, Global test accuracy: 51.14
Round  79, Train loss: 1.541, Test loss: 1.650, Test accuracy: 85.88
Round  79, Global train loss: 1.541, Global test loss: 1.844, Global test accuracy: 63.38
Round  80, Train loss: 1.681, Test loss: 1.648, Test accuracy: 85.98
Round  80, Global train loss: 1.681, Global test loss: 2.011, Global test accuracy: 44.12
Round  81, Train loss: 1.513, Test loss: 1.636, Test accuracy: 86.62
Round  81, Global train loss: 1.513, Global test loss: 1.848, Global test accuracy: 66.84
Round  82, Train loss: 1.777, Test loss: 1.675, Test accuracy: 83.54
Round  82, Global train loss: 1.777, Global test loss: 1.932, Global test accuracy: 55.24
Round  83, Train loss: 1.617, Test loss: 1.668, Test accuracy: 84.28
Round  83, Global train loss: 1.617, Global test loss: 1.865, Global test accuracy: 65.92
Round  84, Train loss: 1.646, Test loss: 1.660, Test accuracy: 85.02
Round  84, Global train loss: 1.646, Global test loss: 1.902, Global test accuracy: 55.62
Round  85, Train loss: 1.817, Test loss: 1.699, Test accuracy: 80.90
Round  85, Global train loss: 1.817, Global test loss: 1.931, Global test accuracy: 62.26
Round  86, Train loss: 1.787, Test loss: 1.712, Test accuracy: 78.86
Round  86, Global train loss: 1.787, Global test loss: 1.907, Global test accuracy: 63.34
Round  87, Train loss: 1.813, Test loss: 1.712, Test accuracy: 78.62
Round  87, Global train loss: 1.813, Global test loss: 2.005, Global test accuracy: 48.32
Round  88, Train loss: 1.898, Test loss: 1.758, Test accuracy: 75.02
Round  88, Global train loss: 1.898, Global test loss: 2.051, Global test accuracy: 46.42
Round  89, Train loss: 1.722, Test loss: 1.724, Test accuracy: 78.50
Round  89, Global train loss: 1.722, Global test loss: 1.976, Global test accuracy: 51.54
Round  90, Train loss: 1.617, Test loss: 1.693, Test accuracy: 81.24
Round  90, Global train loss: 1.617, Global test loss: 1.941, Global test accuracy: 54.94
Round  91, Train loss: 1.545, Test loss: 1.641, Test accuracy: 85.64
Round  91, Global train loss: 1.545, Global test loss: 1.884, Global test accuracy: 58.92/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.671, Test loss: 1.649, Test accuracy: 85.32
Round  92, Global train loss: 1.671, Global test loss: 1.992, Global test accuracy: 49.42
Round  93, Train loss: 1.841, Test loss: 1.753, Test accuracy: 74.58
Round  93, Global train loss: 1.841, Global test loss: 2.080, Global test accuracy: 40.70
Round  94, Train loss: 1.604, Test loss: 1.697, Test accuracy: 80.40
Round  94, Global train loss: 1.604, Global test loss: 1.946, Global test accuracy: 53.70
Round  95, Train loss: 1.619, Test loss: 1.677, Test accuracy: 81.62
Round  95, Global train loss: 1.619, Global test loss: 1.931, Global test accuracy: 52.66
Round  96, Train loss: 1.765, Test loss: 1.717, Test accuracy: 78.44
Round  96, Global train loss: 1.765, Global test loss: 1.946, Global test accuracy: 58.64
Round  97, Train loss: 1.599, Test loss: 1.689, Test accuracy: 82.00
Round  97, Global train loss: 1.599, Global test loss: 1.929, Global test accuracy: 56.54
Round  98, Train loss: 1.600, Test loss: 1.692, Test accuracy: 80.60
Round  98, Global train loss: 1.600, Global test loss: 1.934, Global test accuracy: 52.42
Round  99, Train loss: 1.565, Test loss: 1.681, Test accuracy: 82.20
Round  99, Global train loss: 1.565, Global test loss: 1.907, Global test accuracy: 56.08
Final Round, Train loss: 1.644, Test loss: 1.675, Test accuracy: 82.26
Final Round, Global train loss: 1.644, Global test loss: 1.907, Global test accuracy: 56.08
Average accuracy final 10 rounds: 81.204
702.3178503513336
[1.497769832611084, 2.7246222496032715, 3.9652163982391357, 5.182763576507568, 6.3158018589019775, 7.469708681106567, 8.804397821426392, 9.97514295578003, 11.27413034439087, 12.704193830490112, 14.378341913223267, 15.865011215209961, 17.09580707550049, 18.44121217727661, 19.662855625152588, 20.98671579360962, 22.244338989257812, 23.597835063934326, 24.918892860412598, 26.410502433776855, 27.60299324989319, 28.99193286895752, 30.277371406555176, 31.47158694267273, 32.75308299064636, 34.04611945152283, 35.37440371513367, 36.72218704223633, 37.99774217605591, 39.27767539024353, 40.72242975234985, 42.012059688568115, 43.380743741989136, 44.62804126739502, 45.829713106155396, 47.15227127075195, 48.42512607574463, 49.691651821136475, 50.9673171043396, 52.235960245132446, 53.527302265167236, 54.72503066062927, 55.95476269721985, 57.346440076828, 58.610291957855225, 59.867043018341064, 61.22642660140991, 62.53622579574585, 63.82079815864563, 65.04819393157959, 66.26355648040771, 67.4854633808136, 68.74552011489868, 70.16305589675903, 71.42555928230286, 72.74626111984253, 73.96099042892456, 75.24350023269653, 76.5164041519165, 77.90042734146118, 79.1234712600708, 80.4868483543396, 81.73295760154724, 82.97891116142273, 84.1414167881012, 85.45270490646362, 86.69442749023438, 88.0316903591156, 89.2752206325531, 90.52646517753601, 91.81798815727234, 93.09488916397095, 94.47403621673584, 95.75744104385376, 96.99865579605103, 98.33752012252808, 99.68519449234009, 100.90757966041565, 102.2426872253418, 103.56782364845276, 104.97504329681396, 106.28610038757324, 107.6121563911438, 108.84085273742676, 110.05587267875671, 111.26203632354736, 112.65269827842712, 114.14051580429077, 115.59775686264038, 117.0421667098999, 118.39235997200012, 119.77453804016113, 121.176424741745, 122.4485547542572, 123.7635862827301, 125.11673951148987, 126.52986240386963, 128.0974304676056, 129.53760433197021, 130.9130563735962, 133.04130506515503]
[20.68, 18.08, 19.98, 28.7, 27.68, 38.1, 45.76, 52.12, 53.16, 58.56, 61.74, 63.72, 67.38, 67.38, 67.78, 67.86, 68.36, 68.56, 69.5, 69.8, 70.46, 73.34, 73.48, 73.22, 72.8, 72.78, 74.44, 76.0, 75.64, 76.56, 76.34, 77.24, 77.5, 76.96, 78.64, 78.86, 78.68, 78.82, 83.16, 82.94, 84.38, 84.62, 84.56, 86.32, 85.84, 86.32, 87.02, 86.66, 86.04, 85.6, 85.58, 86.42, 86.16, 85.6, 84.8, 84.72, 85.66, 86.46, 85.68, 85.42, 84.92, 86.08, 85.46, 84.12, 84.96, 87.06, 85.8, 85.22, 86.06, 86.3, 85.7, 85.1, 87.32, 87.18, 85.06, 86.3, 86.58, 86.04, 84.08, 85.88, 85.98, 86.62, 83.54, 84.28, 85.02, 80.9, 78.86, 78.62, 75.02, 78.5, 81.24, 85.64, 85.32, 74.58, 80.4, 81.62, 78.44, 82.0, 80.6, 82.2, 82.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.316, Test loss: 2.298, Test accuracy: 15.50
Round   0, Global train loss: 2.316, Global test loss: 2.300, Global test accuracy: 11.34
Round   1, Train loss: 2.288, Test loss: 2.286, Test accuracy: 42.50
Round   1, Global train loss: 2.288, Global test loss: 2.294, Global test accuracy: 37.06
Round   2, Train loss: 2.265, Test loss: 2.252, Test accuracy: 43.34
Round   2, Global train loss: 2.265, Global test loss: 2.276, Global test accuracy: 32.68
Round   3, Train loss: 2.204, Test loss: 2.173, Test accuracy: 39.12
Round   3, Global train loss: 2.204, Global test loss: 2.234, Global test accuracy: 35.48
Round   4, Train loss: 2.125, Test loss: 2.076, Test accuracy: 46.90
Round   4, Global train loss: 2.125, Global test loss: 2.164, Global test accuracy: 37.28
Round   5, Train loss: 2.038, Test loss: 1.976, Test accuracy: 58.50
Round   5, Global train loss: 2.038, Global test loss: 2.089, Global test accuracy: 47.42
Round   6, Train loss: 1.975, Test loss: 1.905, Test accuracy: 67.34
Round   6, Global train loss: 1.975, Global test loss: 2.043, Global test accuracy: 49.64
Round   7, Train loss: 1.937, Test loss: 1.861, Test accuracy: 71.56
Round   7, Global train loss: 1.937, Global test loss: 2.012, Global test accuracy: 54.12
Round   8, Train loss: 1.913, Test loss: 1.831, Test accuracy: 74.22
Round   8, Global train loss: 1.913, Global test loss: 1.988, Global test accuracy: 59.90
Round   9, Train loss: 1.886, Test loss: 1.797, Test accuracy: 76.66
Round   9, Global train loss: 1.886, Global test loss: 1.966, Global test accuracy: 62.86
Round  10, Train loss: 1.832, Test loss: 1.780, Test accuracy: 76.60
Round  10, Global train loss: 1.832, Global test loss: 1.951, Global test accuracy: 56.04
Round  11, Train loss: 1.824, Test loss: 1.759, Test accuracy: 77.02
Round  11, Global train loss: 1.824, Global test loss: 1.983, Global test accuracy: 51.54
Round  12, Train loss: 1.720, Test loss: 1.751, Test accuracy: 78.48
Round  12, Global train loss: 1.720, Global test loss: 1.953, Global test accuracy: 53.86
Round  13, Train loss: 1.831, Test loss: 1.750, Test accuracy: 76.92
Round  13, Global train loss: 1.831, Global test loss: 1.935, Global test accuracy: 58.20
Round  14, Train loss: 1.744, Test loss: 1.738, Test accuracy: 77.78
Round  14, Global train loss: 1.744, Global test loss: 1.901, Global test accuracy: 61.16
Round  15, Train loss: 1.800, Test loss: 1.735, Test accuracy: 77.08
Round  15, Global train loss: 1.800, Global test loss: 1.921, Global test accuracy: 59.04
Round  16, Train loss: 1.661, Test loss: 1.725, Test accuracy: 77.52
Round  16, Global train loss: 1.661, Global test loss: 1.917, Global test accuracy: 55.08
Round  17, Train loss: 1.771, Test loss: 1.723, Test accuracy: 78.48
Round  17, Global train loss: 1.771, Global test loss: 1.941, Global test accuracy: 56.56
Round  18, Train loss: 1.828, Test loss: 1.721, Test accuracy: 79.40
Round  18, Global train loss: 1.828, Global test loss: 2.020, Global test accuracy: 43.22
Round  19, Train loss: 1.718, Test loss: 1.719, Test accuracy: 79.80
Round  19, Global train loss: 1.718, Global test loss: 1.948, Global test accuracy: 57.62
Round  20, Train loss: 1.789, Test loss: 1.714, Test accuracy: 81.02
Round  20, Global train loss: 1.789, Global test loss: 2.033, Global test accuracy: 46.82
Round  21, Train loss: 1.617, Test loss: 1.689, Test accuracy: 82.82
Round  21, Global train loss: 1.617, Global test loss: 1.896, Global test accuracy: 56.46
Round  22, Train loss: 1.651, Test loss: 1.677, Test accuracy: 83.84
Round  22, Global train loss: 1.651, Global test loss: 1.940, Global test accuracy: 57.82
Round  23, Train loss: 1.575, Test loss: 1.661, Test accuracy: 85.22
Round  23, Global train loss: 1.575, Global test loss: 1.912, Global test accuracy: 54.52
Round  24, Train loss: 1.766, Test loss: 1.671, Test accuracy: 84.28
Round  24, Global train loss: 1.766, Global test loss: 1.926, Global test accuracy: 58.42
Round  25, Train loss: 1.766, Test loss: 1.678, Test accuracy: 83.80
Round  25, Global train loss: 1.766, Global test loss: 1.958, Global test accuracy: 53.74
Round  26, Train loss: 1.755, Test loss: 1.660, Test accuracy: 85.70
Round  26, Global train loss: 1.755, Global test loss: 1.896, Global test accuracy: 60.94
Round  27, Train loss: 1.642, Test loss: 1.653, Test accuracy: 86.00
Round  27, Global train loss: 1.642, Global test loss: 1.907, Global test accuracy: 64.30
Round  28, Train loss: 1.672, Test loss: 1.657, Test accuracy: 85.30
Round  28, Global train loss: 1.672, Global test loss: 1.940, Global test accuracy: 54.10
Round  29, Train loss: 1.575, Test loss: 1.648, Test accuracy: 86.70
Round  29, Global train loss: 1.575, Global test loss: 1.887, Global test accuracy: 59.28
Round  30, Train loss: 1.743, Test loss: 1.643, Test accuracy: 86.12
Round  30, Global train loss: 1.743, Global test loss: 1.853, Global test accuracy: 65.52
Round  31, Train loss: 1.657, Test loss: 1.652, Test accuracy: 85.56
Round  31, Global train loss: 1.657, Global test loss: 1.869, Global test accuracy: 64.34
Round  32, Train loss: 1.736, Test loss: 1.651, Test accuracy: 85.58
Round  32, Global train loss: 1.736, Global test loss: 1.864, Global test accuracy: 65.24
Round  33, Train loss: 1.766, Test loss: 1.673, Test accuracy: 83.38
Round  33, Global train loss: 1.766, Global test loss: 2.031, Global test accuracy: 42.94
Round  34, Train loss: 1.585, Test loss: 1.646, Test accuracy: 86.38
Round  34, Global train loss: 1.585, Global test loss: 1.927, Global test accuracy: 57.32
Round  35, Train loss: 1.824, Test loss: 1.660, Test accuracy: 84.32
Round  35, Global train loss: 1.824, Global test loss: 1.941, Global test accuracy: 59.06
Round  36, Train loss: 1.619, Test loss: 1.653, Test accuracy: 85.48
Round  36, Global train loss: 1.619, Global test loss: 1.915, Global test accuracy: 54.68
Round  37, Train loss: 1.709, Test loss: 1.662, Test accuracy: 84.10
Round  37, Global train loss: 1.709, Global test loss: 1.864, Global test accuracy: 64.26
Round  38, Train loss: 1.617, Test loss: 1.644, Test accuracy: 85.74
Round  38, Global train loss: 1.617, Global test loss: 1.893, Global test accuracy: 59.66
Round  39, Train loss: 1.601, Test loss: 1.631, Test accuracy: 87.00
Round  39, Global train loss: 1.601, Global test loss: 1.886, Global test accuracy: 61.16
Round  40, Train loss: 1.747, Test loss: 1.656, Test accuracy: 84.30
Round  40, Global train loss: 1.747, Global test loss: 2.058, Global test accuracy: 40.42
Round  41, Train loss: 1.612, Test loss: 1.662, Test accuracy: 84.02
Round  41, Global train loss: 1.612, Global test loss: 1.898, Global test accuracy: 59.92
Round  42, Train loss: 1.704, Test loss: 1.649, Test accuracy: 85.50
Round  42, Global train loss: 1.704, Global test loss: 1.959, Global test accuracy: 53.82
Round  43, Train loss: 1.610, Test loss: 1.652, Test accuracy: 84.60
Round  43, Global train loss: 1.610, Global test loss: 1.872, Global test accuracy: 61.02
Round  44, Train loss: 1.642, Test loss: 1.655, Test accuracy: 83.90
Round  44, Global train loss: 1.642, Global test loss: 1.893, Global test accuracy: 58.24
Round  45, Train loss: 1.635, Test loss: 1.643, Test accuracy: 85.28
Round  45, Global train loss: 1.635, Global test loss: 1.938, Global test accuracy: 52.76
Round  46, Train loss: 1.595, Test loss: 1.631, Test accuracy: 86.56
Round  46, Global train loss: 1.595, Global test loss: 1.852, Global test accuracy: 65.36
Round  47, Train loss: 1.591, Test loss: 1.634, Test accuracy: 85.88
Round  47, Global train loss: 1.591, Global test loss: 1.876, Global test accuracy: 58.74
Round  48, Train loss: 1.622, Test loss: 1.635, Test accuracy: 86.26
Round  48, Global train loss: 1.622, Global test loss: 1.907, Global test accuracy: 56.54
Round  49, Train loss: 1.637, Test loss: 1.636, Test accuracy: 86.12
Round  49, Global train loss: 1.637, Global test loss: 1.925, Global test accuracy: 57.44
Round  50, Train loss: 1.675, Test loss: 1.649, Test accuracy: 84.68
Round  50, Global train loss: 1.675, Global test loss: 1.900, Global test accuracy: 59.48
Round  51, Train loss: 1.546, Test loss: 1.632, Test accuracy: 86.58
Round  51, Global train loss: 1.546, Global test loss: 1.871, Global test accuracy: 63.56
Round  52, Train loss: 1.531, Test loss: 1.624, Test accuracy: 86.86
Round  52, Global train loss: 1.531, Global test loss: 1.887, Global test accuracy: 57.74
Round  53, Train loss: 1.663, Test loss: 1.649, Test accuracy: 84.22
Round  53, Global train loss: 1.663, Global test loss: 1.994, Global test accuracy: 45.92
Round  54, Train loss: 1.663, Test loss: 1.649, Test accuracy: 84.54
Round  54, Global train loss: 1.663, Global test loss: 1.987, Global test accuracy: 46.38
Round  55, Train loss: 1.624, Test loss: 1.640, Test accuracy: 85.22
Round  55, Global train loss: 1.624, Global test loss: 1.839, Global test accuracy: 65.44
Round  56, Train loss: 1.566, Test loss: 1.635, Test accuracy: 85.82
Round  56, Global train loss: 1.566, Global test loss: 1.880, Global test accuracy: 61.34
Round  57, Train loss: 1.606, Test loss: 1.638, Test accuracy: 85.52
Round  57, Global train loss: 1.606, Global test loss: 1.880, Global test accuracy: 58.08
Round  58, Train loss: 1.585, Test loss: 1.631, Test accuracy: 86.18
Round  58, Global train loss: 1.585, Global test loss: 1.956, Global test accuracy: 47.44
Round  59, Train loss: 1.621, Test loss: 1.628, Test accuracy: 86.06
Round  59, Global train loss: 1.621, Global test loss: 1.929, Global test accuracy: 56.60
Round  60, Train loss: 1.696, Test loss: 1.653, Test accuracy: 83.68
Round  60, Global train loss: 1.696, Global test loss: 2.004, Global test accuracy: 47.52
Round  61, Train loss: 1.571, Test loss: 1.642, Test accuracy: 84.68
Round  61, Global train loss: 1.571, Global test loss: 1.888, Global test accuracy: 59.50
Round  62, Train loss: 1.564, Test loss: 1.642, Test accuracy: 84.86
Round  62, Global train loss: 1.564, Global test loss: 1.889, Global test accuracy: 61.28
Round  63, Train loss: 1.685, Test loss: 1.648, Test accuracy: 84.62
Round  63, Global train loss: 1.685, Global test loss: 2.002, Global test accuracy: 49.32
Round  64, Train loss: 1.608, Test loss: 1.648, Test accuracy: 83.98
Round  64, Global train loss: 1.608, Global test loss: 1.917, Global test accuracy: 57.00
Round  65, Train loss: 1.526, Test loss: 1.629, Test accuracy: 86.44
Round  65, Global train loss: 1.526, Global test loss: 1.869, Global test accuracy: 60.82
Round  66, Train loss: 1.608, Test loss: 1.633, Test accuracy: 85.26
Round  66, Global train loss: 1.608, Global test loss: 1.826, Global test accuracy: 66.18
Round  67, Train loss: 1.680, Test loss: 1.641, Test accuracy: 84.64
Round  67, Global train loss: 1.680, Global test loss: 1.972, Global test accuracy: 50.84
Round  68, Train loss: 1.566, Test loss: 1.630, Test accuracy: 85.90
Round  68, Global train loss: 1.566, Global test loss: 1.851, Global test accuracy: 65.52
Round  69, Train loss: 1.622, Test loss: 1.638, Test accuracy: 84.92
Round  69, Global train loss: 1.622, Global test loss: 2.002, Global test accuracy: 49.08
Round  70, Train loss: 1.569, Test loss: 1.626, Test accuracy: 86.32
Round  70, Global train loss: 1.569, Global test loss: 1.904, Global test accuracy: 55.22
Round  71, Train loss: 1.584, Test loss: 1.633, Test accuracy: 85.68
Round  71, Global train loss: 1.584, Global test loss: 1.879, Global test accuracy: 57.32
Round  72, Train loss: 1.517, Test loss: 1.626, Test accuracy: 86.24
Round  72, Global train loss: 1.517, Global test loss: 1.864, Global test accuracy: 63.32
Round  73, Train loss: 1.576, Test loss: 1.629, Test accuracy: 85.90
Round  73, Global train loss: 1.576, Global test loss: 1.845, Global test accuracy: 64.92
Round  74, Train loss: 1.661, Test loss: 1.646, Test accuracy: 84.18
Round  74, Global train loss: 1.661, Global test loss: 2.061, Global test accuracy: 39.24
Round  75, Train loss: 1.560, Test loss: 1.632, Test accuracy: 86.00
Round  75, Global train loss: 1.560, Global test loss: 1.864, Global test accuracy: 63.22
Round  76, Train loss: 1.586, Test loss: 1.633, Test accuracy: 85.86
Round  76, Global train loss: 1.586, Global test loss: 1.944, Global test accuracy: 52.84
Round  77, Train loss: 1.586, Test loss: 1.648, Test accuracy: 84.16
Round  77, Global train loss: 1.586, Global test loss: 1.898, Global test accuracy: 56.00
Round  78, Train loss: 1.589, Test loss: 1.647, Test accuracy: 84.28
Round  78, Global train loss: 1.589, Global test loss: 1.948, Global test accuracy: 53.22
Round  79, Train loss: 1.535, Test loss: 1.636, Test accuracy: 85.18
Round  79, Global train loss: 1.535, Global test loss: 1.846, Global test accuracy: 62.66
Round  80, Train loss: 1.507, Test loss: 1.618, Test accuracy: 86.54
Round  80, Global train loss: 1.507, Global test loss: 1.834, Global test accuracy: 67.14
Round  81, Train loss: 1.504, Test loss: 1.612, Test accuracy: 87.04
Round  81, Global train loss: 1.504, Global test loss: 1.821, Global test accuracy: 68.38
Round  82, Train loss: 1.502, Test loss: 1.609, Test accuracy: 87.28
Round  82, Global train loss: 1.502, Global test loss: 1.818, Global test accuracy: 68.80
Round  83, Train loss: 1.501, Test loss: 1.608, Test accuracy: 87.44
Round  83, Global train loss: 1.501, Global test loss: 1.814, Global test accuracy: 68.98
Round  84, Train loss: 1.500, Test loss: 1.603, Test accuracy: 87.98
Round  84, Global train loss: 1.500, Global test loss: 1.812, Global test accuracy: 69.28
Round  85, Train loss: 1.500, Test loss: 1.602, Test accuracy: 88.14
Round  85, Global train loss: 1.500, Global test loss: 1.812, Global test accuracy: 69.08
Round  86, Train loss: 1.499, Test loss: 1.604, Test accuracy: 87.90
Round  86, Global train loss: 1.499, Global test loss: 1.811, Global test accuracy: 68.70
Round  87, Train loss: 1.498, Test loss: 1.601, Test accuracy: 88.16
Round  87, Global train loss: 1.498, Global test loss: 1.812, Global test accuracy: 68.86
Round  88, Train loss: 1.497, Test loss: 1.602, Test accuracy: 87.76
Round  88, Global train loss: 1.497, Global test loss: 1.811, Global test accuracy: 68.96
Round  89, Train loss: 1.496, Test loss: 1.602, Test accuracy: 87.96
Round  89, Global train loss: 1.496, Global test loss: 1.808, Global test accuracy: 69.20
Round  90, Train loss: 1.495, Test loss: 1.601, Test accuracy: 88.12
Round  90, Global train loss: 1.495, Global test loss: 1.810, Global test accuracy: 68.86
Round  91, Train loss: 1.494, Test loss: 1.601, Test accuracy: 88.08
Round  91, Global train loss: 1.494, Global test loss: 1.809, Global test accuracy: 68.96/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.493, Test loss: 1.601, Test accuracy: 88.04
Round  92, Global train loss: 1.493, Global test loss: 1.808, Global test accuracy: 68.96
Round  93, Train loss: 1.493, Test loss: 1.600, Test accuracy: 88.32
Round  93, Global train loss: 1.493, Global test loss: 1.810, Global test accuracy: 68.72
Round  94, Train loss: 1.492, Test loss: 1.601, Test accuracy: 87.98
Round  94, Global train loss: 1.492, Global test loss: 1.808, Global test accuracy: 68.88
Round  95, Train loss: 1.492, Test loss: 1.600, Test accuracy: 88.06
Round  95, Global train loss: 1.492, Global test loss: 1.806, Global test accuracy: 69.04
Round  96, Train loss: 1.491, Test loss: 1.599, Test accuracy: 88.06
Round  96, Global train loss: 1.491, Global test loss: 1.807, Global test accuracy: 68.84
Round  97, Train loss: 1.490, Test loss: 1.599, Test accuracy: 88.20
Round  97, Global train loss: 1.490, Global test loss: 1.809, Global test accuracy: 68.44
Round  98, Train loss: 1.490, Test loss: 1.601, Test accuracy: 87.90
Round  98, Global train loss: 1.490, Global test loss: 1.807, Global test accuracy: 68.64
Round  99, Train loss: 1.581, Test loss: 1.610, Test accuracy: 87.32
Round  99, Global train loss: 1.581, Global test loss: 1.776, Global test accuracy: 79.98
Final Round, Train loss: 1.640, Test loss: 1.618, Test accuracy: 86.14
Final Round, Global train loss: 1.640, Global test loss: 1.776, Global test accuracy: 79.98
Average accuracy final 10 rounds: 88.008
1617.2885179519653
[1.7088823318481445, 3.1229608058929443, 4.683633804321289, 6.312673568725586, 7.710902214050293, 9.212579250335693, 10.69164776802063, 12.129775285720825, 13.612449169158936, 15.085942029953003, 20.07578420639038, 31.182194471359253, 32.58131718635559, 40.69444990158081, 49.040855884552, 58.08500957489014, 66.81724071502686, 75.41929650306702, 84.39861488342285, 92.55863070487976, 101.60074615478516, 103.07942295074463, 111.79707384109497, 113.34098529815674, 122.30806040763855, 131.199476480484, 140.14081048965454, 148.565571308136, 157.30805325508118, 158.754807472229, 167.28223586082458, 176.4147810935974, 185.45235633850098, 194.14730644226074, 195.7537078857422, 204.5348846912384, 213.31622624397278, 222.06682991981506, 230.73487377166748, 232.17001342773438, 241.05130219459534, 249.43729329109192, 258.31990337371826, 267.05082058906555, 275.7239363193512, 284.1653368473053, 292.5998420715332, 301.548868894577, 309.85325145721436, 318.4383180141449, 327.0433406829834, 328.4953854084015, 330.0543339252472, 338.602014541626, 347.61076402664185, 356.4828579425812, 365.5244233608246, 373.84231543540955, 382.78529357910156, 391.21322441101074, 400.2878243923187, 410.190833568573, 418.91568183898926, 428.1019937992096, 436.6077935695648, 438.04069328308105, 446.3823022842407, 457.5345969200134, 466.3350598812103, 475.3546643257141, 483.72128200531006, 492.19102120399475, 493.67509412765503, 502.5221767425537, 511.4117410182953, 520.1342885494232, 528.9753832817078, 537.348904132843, 546.0541920661926, 547.8616261482239, 549.4292366504669, 550.9515483379364, 552.3977799415588, 553.979391336441, 555.4600610733032, 557.0478422641754, 558.6604511737823, 560.3922278881073, 561.983880519867, 563.5580892562866, 565.1070711612701, 566.6108798980713, 568.1517241001129, 569.6048412322998, 571.0666699409485, 572.5719316005707, 574.0987241268158, 575.4655683040619, 576.9611644744873, 584.9532840251923, 593.2457542419434]
[15.5, 42.5, 43.34, 39.12, 46.9, 58.5, 67.34, 71.56, 74.22, 76.66, 76.6, 77.02, 78.48, 76.92, 77.78, 77.08, 77.52, 78.48, 79.4, 79.8, 81.02, 82.82, 83.84, 85.22, 84.28, 83.8, 85.7, 86.0, 85.3, 86.7, 86.12, 85.56, 85.58, 83.38, 86.38, 84.32, 85.48, 84.1, 85.74, 87.0, 84.3, 84.02, 85.5, 84.6, 83.9, 85.28, 86.56, 85.88, 86.26, 86.12, 84.68, 86.58, 86.86, 84.22, 84.54, 85.22, 85.82, 85.52, 86.18, 86.06, 83.68, 84.68, 84.86, 84.62, 83.98, 86.44, 85.26, 84.64, 85.9, 84.92, 86.32, 85.68, 86.24, 85.9, 84.18, 86.0, 85.86, 84.16, 84.28, 85.18, 86.54, 87.04, 87.28, 87.44, 87.98, 88.14, 87.9, 88.16, 87.76, 87.96, 88.12, 88.08, 88.04, 88.32, 87.98, 88.06, 88.06, 88.2, 87.9, 87.32, 86.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.291, Test loss: 2.290, Test accuracy: 23.50
Round   0, Global train loss: 2.291, Global test loss: 2.298, Global test accuracy: 19.92
Round   1, Train loss: 2.209, Test loss: 2.192, Test accuracy: 35.06
Round   1, Global train loss: 2.209, Global test loss: 2.220, Global test accuracy: 34.40
Round   2, Train loss: 2.009, Test loss: 2.043, Test accuracy: 48.06
Round   2, Global train loss: 2.009, Global test loss: 2.066, Global test accuracy: 40.98
Round   3, Train loss: 2.068, Test loss: 2.054, Test accuracy: 42.14
Round   3, Global train loss: 2.068, Global test loss: 2.157, Global test accuracy: 28.86
Round   4, Train loss: 2.034, Test loss: 2.001, Test accuracy: 48.22
Round   4, Global train loss: 2.034, Global test loss: 2.131, Global test accuracy: 38.18
Round   5, Train loss: 1.912, Test loss: 1.915, Test accuracy: 55.34
Round   5, Global train loss: 1.912, Global test loss: 2.045, Global test accuracy: 48.38
Round   6, Train loss: 1.891, Test loss: 1.906, Test accuracy: 56.76
Round   6, Global train loss: 1.891, Global test loss: 2.134, Global test accuracy: 31.44
Round   7, Train loss: 2.042, Test loss: 1.882, Test accuracy: 59.50
Round   7, Global train loss: 2.042, Global test loss: 2.105, Global test accuracy: 44.82
Round   8, Train loss: 1.956, Test loss: 1.854, Test accuracy: 62.96
Round   8, Global train loss: 1.956, Global test loss: 2.050, Global test accuracy: 45.32
Round   9, Train loss: 1.725, Test loss: 1.845, Test accuracy: 63.44
Round   9, Global train loss: 1.725, Global test loss: 2.069, Global test accuracy: 38.96
Round  10, Train loss: 1.765, Test loss: 1.825, Test accuracy: 65.64
Round  10, Global train loss: 1.765, Global test loss: 1.963, Global test accuracy: 50.46
Round  11, Train loss: 2.050, Test loss: 1.800, Test accuracy: 68.74
Round  11, Global train loss: 2.050, Global test loss: 2.040, Global test accuracy: 52.94
Round  12, Train loss: 1.735, Test loss: 1.780, Test accuracy: 70.46
Round  12, Global train loss: 1.735, Global test loss: 2.034, Global test accuracy: 39.82
Round  13, Train loss: 1.819, Test loss: 1.773, Test accuracy: 70.60
Round  13, Global train loss: 1.819, Global test loss: 2.070, Global test accuracy: 42.56
Round  14, Train loss: 2.003, Test loss: 1.751, Test accuracy: 72.58
Round  14, Global train loss: 2.003, Global test loss: 2.139, Global test accuracy: 27.18
Round  15, Train loss: 1.684, Test loss: 1.733, Test accuracy: 74.56
Round  15, Global train loss: 1.684, Global test loss: 1.929, Global test accuracy: 57.84
Round  16, Train loss: 1.919, Test loss: 1.723, Test accuracy: 75.74
Round  16, Global train loss: 1.919, Global test loss: 2.058, Global test accuracy: 41.66
Round  17, Train loss: 1.778, Test loss: 1.721, Test accuracy: 75.74
Round  17, Global train loss: 1.778, Global test loss: 2.011, Global test accuracy: 48.04
Round  18, Train loss: 1.787, Test loss: 1.717, Test accuracy: 75.54
Round  18, Global train loss: 1.787, Global test loss: 2.042, Global test accuracy: 46.66
Round  19, Train loss: 1.733, Test loss: 1.716, Test accuracy: 75.64
Round  19, Global train loss: 1.733, Global test loss: 2.058, Global test accuracy: 45.40
Round  20, Train loss: 1.803, Test loss: 1.715, Test accuracy: 75.72
Round  20, Global train loss: 1.803, Global test loss: 2.097, Global test accuracy: 33.88
Round  21, Train loss: 1.900, Test loss: 1.693, Test accuracy: 78.80
Round  21, Global train loss: 1.900, Global test loss: 2.109, Global test accuracy: 33.06
Round  22, Train loss: 1.614, Test loss: 1.691, Test accuracy: 78.72
Round  22, Global train loss: 1.614, Global test loss: 1.980, Global test accuracy: 51.42
Round  23, Train loss: 1.812, Test loss: 1.678, Test accuracy: 79.60
Round  23, Global train loss: 1.812, Global test loss: 2.102, Global test accuracy: 37.56
Round  24, Train loss: 1.621, Test loss: 1.677, Test accuracy: 79.56
Round  24, Global train loss: 1.621, Global test loss: 2.003, Global test accuracy: 45.28
Round  25, Train loss: 1.612, Test loss: 1.676, Test accuracy: 79.64
Round  25, Global train loss: 1.612, Global test loss: 1.961, Global test accuracy: 52.18
Round  26, Train loss: 1.723, Test loss: 1.677, Test accuracy: 79.58
Round  26, Global train loss: 1.723, Global test loss: 2.006, Global test accuracy: 48.12
Round  27, Train loss: 1.757, Test loss: 1.674, Test accuracy: 79.80
Round  27, Global train loss: 1.757, Global test loss: 2.087, Global test accuracy: 35.28
Round  28, Train loss: 1.619, Test loss: 1.674, Test accuracy: 79.72
Round  28, Global train loss: 1.619, Global test loss: 1.974, Global test accuracy: 48.68
Round  29, Train loss: 1.573, Test loss: 1.672, Test accuracy: 80.10
Round  29, Global train loss: 1.573, Global test loss: 2.106, Global test accuracy: 34.00
Round  30, Train loss: 1.759, Test loss: 1.673, Test accuracy: 79.94
Round  30, Global train loss: 1.759, Global test loss: 2.008, Global test accuracy: 44.84
Round  31, Train loss: 1.855, Test loss: 1.671, Test accuracy: 80.00
Round  31, Global train loss: 1.855, Global test loss: 2.034, Global test accuracy: 42.36
Round  32, Train loss: 1.681, Test loss: 1.668, Test accuracy: 80.24
Round  32, Global train loss: 1.681, Global test loss: 2.059, Global test accuracy: 41.02
Round  33, Train loss: 1.684, Test loss: 1.668, Test accuracy: 80.20
Round  33, Global train loss: 1.684, Global test loss: 2.074, Global test accuracy: 37.06
Round  34, Train loss: 1.821, Test loss: 1.669, Test accuracy: 80.02
Round  34, Global train loss: 1.821, Global test loss: 2.012, Global test accuracy: 43.12
Round  35, Train loss: 1.761, Test loss: 1.663, Test accuracy: 80.90
Round  35, Global train loss: 1.761, Global test loss: 1.992, Global test accuracy: 46.18
Round  36, Train loss: 1.679, Test loss: 1.663, Test accuracy: 80.84
Round  36, Global train loss: 1.679, Global test loss: 2.073, Global test accuracy: 37.16
Round  37, Train loss: 1.803, Test loss: 1.659, Test accuracy: 81.20
Round  37, Global train loss: 1.803, Global test loss: 2.104, Global test accuracy: 41.00
Round  38, Train loss: 1.789, Test loss: 1.659, Test accuracy: 80.86
Round  38, Global train loss: 1.789, Global test loss: 2.095, Global test accuracy: 41.48
Round  39, Train loss: 1.656, Test loss: 1.658, Test accuracy: 81.00
Round  39, Global train loss: 1.656, Global test loss: 1.968, Global test accuracy: 48.52
Round  40, Train loss: 1.718, Test loss: 1.659, Test accuracy: 80.82
Round  40, Global train loss: 1.718, Global test loss: 2.048, Global test accuracy: 40.76
Round  41, Train loss: 1.750, Test loss: 1.659, Test accuracy: 80.82
Round  41, Global train loss: 1.750, Global test loss: 2.105, Global test accuracy: 33.44
Round  42, Train loss: 1.663, Test loss: 1.659, Test accuracy: 80.88
Round  42, Global train loss: 1.663, Global test loss: 2.098, Global test accuracy: 34.14
Round  43, Train loss: 1.659, Test loss: 1.660, Test accuracy: 80.68
Round  43, Global train loss: 1.659, Global test loss: 2.102, Global test accuracy: 33.88
Round  44, Train loss: 1.712, Test loss: 1.658, Test accuracy: 80.88
Round  44, Global train loss: 1.712, Global test loss: 1.981, Global test accuracy: 48.90
Round  45, Train loss: 1.637, Test loss: 1.655, Test accuracy: 81.44
Round  45, Global train loss: 1.637, Global test loss: 1.963, Global test accuracy: 52.18
Round  46, Train loss: 1.668, Test loss: 1.654, Test accuracy: 81.52
Round  46, Global train loss: 1.668, Global test loss: 1.963, Global test accuracy: 49.50
Round  47, Train loss: 1.666, Test loss: 1.654, Test accuracy: 81.48
Round  47, Global train loss: 1.666, Global test loss: 1.964, Global test accuracy: 49.48
Round  48, Train loss: 1.688, Test loss: 1.654, Test accuracy: 81.32
Round  48, Global train loss: 1.688, Global test loss: 2.143, Global test accuracy: 27.26
Round  49, Train loss: 1.692, Test loss: 1.655, Test accuracy: 81.30
Round  49, Global train loss: 1.692, Global test loss: 1.989, Global test accuracy: 46.60
Round  50, Train loss: 1.647, Test loss: 1.655, Test accuracy: 81.32
Round  50, Global train loss: 1.647, Global test loss: 1.982, Global test accuracy: 49.10
Round  51, Train loss: 1.660, Test loss: 1.654, Test accuracy: 81.28
Round  51, Global train loss: 1.660, Global test loss: 2.115, Global test accuracy: 36.54
Round  52, Train loss: 1.645, Test loss: 1.654, Test accuracy: 81.30
Round  52, Global train loss: 1.645, Global test loss: 1.979, Global test accuracy: 47.00
Round  53, Train loss: 1.731, Test loss: 1.655, Test accuracy: 81.20
Round  53, Global train loss: 1.731, Global test loss: 2.007, Global test accuracy: 44.64
Round  54, Train loss: 1.562, Test loss: 1.654, Test accuracy: 81.22
Round  54, Global train loss: 1.562, Global test loss: 2.071, Global test accuracy: 42.02
Round  55, Train loss: 1.693, Test loss: 1.654, Test accuracy: 81.14
Round  55, Global train loss: 1.693, Global test loss: 2.091, Global test accuracy: 35.44
Round  56, Train loss: 1.724, Test loss: 1.655, Test accuracy: 81.00
Round  56, Global train loss: 1.724, Global test loss: 2.197, Global test accuracy: 23.44
Round  57, Train loss: 1.575, Test loss: 1.655, Test accuracy: 81.00
Round  57, Global train loss: 1.575, Global test loss: 1.973, Global test accuracy: 47.36
Round  58, Train loss: 1.732, Test loss: 1.655, Test accuracy: 80.92
Round  58, Global train loss: 1.732, Global test loss: 1.999, Global test accuracy: 45.06
Round  59, Train loss: 1.691, Test loss: 1.655, Test accuracy: 81.00
Round  59, Global train loss: 1.691, Global test loss: 2.062, Global test accuracy: 39.98
Round  60, Train loss: 1.652, Test loss: 1.655, Test accuracy: 81.04
Round  60, Global train loss: 1.652, Global test loss: 2.097, Global test accuracy: 34.50
Round  61, Train loss: 1.619, Test loss: 1.655, Test accuracy: 81.06
Round  61, Global train loss: 1.619, Global test loss: 1.994, Global test accuracy: 46.38
Round  62, Train loss: 1.644, Test loss: 1.654, Test accuracy: 81.04
Round  62, Global train loss: 1.644, Global test loss: 1.982, Global test accuracy: 46.78
Round  63, Train loss: 1.641, Test loss: 1.654, Test accuracy: 80.96
Round  63, Global train loss: 1.641, Global test loss: 2.012, Global test accuracy: 45.72
Round  64, Train loss: 1.690, Test loss: 1.654, Test accuracy: 80.98
Round  64, Global train loss: 1.690, Global test loss: 2.061, Global test accuracy: 40.16
Round  65, Train loss: 1.594, Test loss: 1.655, Test accuracy: 80.88
Round  65, Global train loss: 1.594, Global test loss: 1.975, Global test accuracy: 50.24
Round  66, Train loss: 1.650, Test loss: 1.655, Test accuracy: 80.80
Round  66, Global train loss: 1.650, Global test loss: 1.979, Global test accuracy: 49.36
Round  67, Train loss: 1.680, Test loss: 1.656, Test accuracy: 80.66
Round  67, Global train loss: 1.680, Global test loss: 1.975, Global test accuracy: 49.94
Round  68, Train loss: 1.572, Test loss: 1.656, Test accuracy: 80.62
Round  68, Global train loss: 1.572, Global test loss: 1.944, Global test accuracy: 51.26
Round  69, Train loss: 1.634, Test loss: 1.657, Test accuracy: 80.62
Round  69, Global train loss: 1.634, Global test loss: 2.017, Global test accuracy: 45.32
Round  70, Train loss: 1.601, Test loss: 1.656, Test accuracy: 80.66
Round  70, Global train loss: 1.601, Global test loss: 2.029, Global test accuracy: 42.86
Round  71, Train loss: 1.753, Test loss: 1.656, Test accuracy: 80.64
Round  71, Global train loss: 1.753, Global test loss: 2.002, Global test accuracy: 47.24
Round  72, Train loss: 1.548, Test loss: 1.656, Test accuracy: 80.66
Round  72, Global train loss: 1.548, Global test loss: 2.069, Global test accuracy: 41.90
Round  73, Train loss: 1.801, Test loss: 1.658, Test accuracy: 80.50
Round  73, Global train loss: 1.801, Global test loss: 2.037, Global test accuracy: 42.48
Round  74, Train loss: 1.531, Test loss: 1.658, Test accuracy: 80.54
Round  74, Global train loss: 1.531, Global test loss: 1.965, Global test accuracy: 49.96
Round  75, Train loss: 1.664, Test loss: 1.659, Test accuracy: 80.44
Round  75, Global train loss: 1.664, Global test loss: 1.984, Global test accuracy: 46.82
Round  76, Train loss: 1.661, Test loss: 1.658, Test accuracy: 80.42
Round  76, Global train loss: 1.661, Global test loss: 1.929, Global test accuracy: 53.18
Round  77, Train loss: 1.657, Test loss: 1.658, Test accuracy: 80.42
Round  77, Global train loss: 1.657, Global test loss: 1.976, Global test accuracy: 51.22
Round  78, Train loss: 1.649, Test loss: 1.658, Test accuracy: 80.46
Round  78, Global train loss: 1.649, Global test loss: 2.092, Global test accuracy: 34.72
Round  79, Train loss: 1.639, Test loss: 1.658, Test accuracy: 80.54
Round  79, Global train loss: 1.639, Global test loss: 1.992, Global test accuracy: 45.58
Round  80, Train loss: 1.638, Test loss: 1.658, Test accuracy: 80.56
Round  80, Global train loss: 1.638, Global test loss: 2.086, Global test accuracy: 37.76
Round  81, Train loss: 1.578, Test loss: 1.658, Test accuracy: 80.54
Round  81, Global train loss: 1.578, Global test loss: 1.955, Global test accuracy: 51.54
Round  82, Train loss: 1.681, Test loss: 1.658, Test accuracy: 80.54
Round  82, Global train loss: 1.681, Global test loss: 1.967, Global test accuracy: 53.16
Round  83, Train loss: 1.527, Test loss: 1.658, Test accuracy: 80.54
Round  83, Global train loss: 1.527, Global test loss: 1.916, Global test accuracy: 57.94
Round  84, Train loss: 1.555, Test loss: 1.658, Test accuracy: 80.52
Round  84, Global train loss: 1.555, Global test loss: 1.959, Global test accuracy: 52.08
Round  85, Train loss: 1.546, Test loss: 1.658, Test accuracy: 80.50
Round  85, Global train loss: 1.546, Global test loss: 2.072, Global test accuracy: 41.38
Round  86, Train loss: 1.687, Test loss: 1.657, Test accuracy: 80.62
Round  86, Global train loss: 1.687, Global test loss: 2.065, Global test accuracy: 37.04
Round  87, Train loss: 1.658, Test loss: 1.657, Test accuracy: 80.62
Round  87, Global train loss: 1.658, Global test loss: 2.009, Global test accuracy: 51.12
Round  88, Train loss: 1.646, Test loss: 1.658, Test accuracy: 80.46
Round  88, Global train loss: 1.646, Global test loss: 2.085, Global test accuracy: 35.18
Round  89, Train loss: 1.555, Test loss: 1.658, Test accuracy: 80.38
Round  89, Global train loss: 1.555, Global test loss: 1.961, Global test accuracy: 52.00
Round  90, Train loss: 1.755, Test loss: 1.659, Test accuracy: 80.36
Round  90, Global train loss: 1.755, Global test loss: 2.084, Global test accuracy: 37.78
Round  91, Train loss: 1.688, Test loss: 1.659, Test accuracy: 80.38
Round  91, Global train loss: 1.688, Global test loss: 2.060, Global test accuracy: 40.28
Round  92, Train loss: 1.590, Test loss: 1.659, Test accuracy: 80.40
Round  92, Global train loss: 1.590, Global test loss: 2.192, Global test accuracy: 24.04
Round  93, Train loss: 1.595, Test loss: 1.659, Test accuracy: 80.38
Round  93, Global train loss: 1.595, Global test loss: 1.969, Global test accuracy: 48.40
Round  94, Train loss: 1.706, Test loss: 1.659, Test accuracy: 80.40
Round  94, Global train loss: 1.706, Global test loss: 2.103, Global test accuracy: 33.98/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.678, Test loss: 1.659, Test accuracy: 80.34
Round  95, Global train loss: 1.678, Global test loss: 2.006, Global test accuracy: 45.52
Round  96, Train loss: 1.681, Test loss: 1.659, Test accuracy: 80.42
Round  96, Global train loss: 1.681, Global test loss: 2.040, Global test accuracy: 40.82
Round  97, Train loss: 1.534, Test loss: 1.659, Test accuracy: 80.34
Round  97, Global train loss: 1.534, Global test loss: 2.112, Global test accuracy: 33.58
Round  98, Train loss: 1.743, Test loss: 1.658, Test accuracy: 80.54
Round  98, Global train loss: 1.743, Global test loss: 2.014, Global test accuracy: 47.64
Round  99, Train loss: 1.681, Test loss: 1.649, Test accuracy: 81.58
Round  99, Global train loss: 1.681, Global test loss: 1.963, Global test accuracy: 50.60
Final Round, Train loss: 1.640, Test loss: 1.647, Test accuracy: 81.80
Final Round, Global train loss: 1.640, Global test loss: 1.963, Global test accuracy: 50.60
Average accuracy final 10 rounds: 80.51400000000001 

Average global accuracy final 10 rounds: 40.264 

792.5610308647156
[1.1064198017120361, 2.2128396034240723, 3.2495741844177246, 4.286308765411377, 5.325315475463867, 6.364322185516357, 7.476803302764893, 8.589284420013428, 9.607528686523438, 10.625772953033447, 11.717400550842285, 12.809028148651123, 13.885498285293579, 14.961968421936035, 15.985046148300171, 17.008123874664307, 18.06719183921814, 19.126259803771973, 20.1966290473938, 21.266998291015625, 22.45297360420227, 23.638948917388916, 24.64387536048889, 25.648801803588867, 26.732402324676514, 27.81600284576416, 28.865833044052124, 29.915663242340088, 31.005251169204712, 32.094839096069336, 33.13741612434387, 34.17999315261841, 35.42921447753906, 36.67843580245972, 37.81701064109802, 38.95558547973633, 40.0677056312561, 41.17982578277588, 42.29243040084839, 43.4050350189209, 44.39846229553223, 45.391889572143555, 46.44101119041443, 47.4901328086853, 48.57218790054321, 49.65424299240112, 50.662559270858765, 51.670875549316406, 52.66352868080139, 53.65618181228638, 54.783310890197754, 55.91043996810913, 56.874123334884644, 57.837806701660156, 59.159146785736084, 60.48048686981201, 61.6274938583374, 62.77450084686279, 63.73093247413635, 64.68736410140991, 65.77174592018127, 66.85612773895264, 67.87518811225891, 68.89424848556519, 69.92723798751831, 70.96022748947144, 71.93164277076721, 72.90305805206299, 73.95083117485046, 74.99860429763794, 76.05534100532532, 77.1120777130127, 78.10969805717468, 79.10731840133667, 80.07011699676514, 81.0329155921936, 82.16362977027893, 83.29434394836426, 84.31062865257263, 85.326913356781, 86.47152972221375, 87.61614608764648, 88.66820216178894, 89.7202582359314, 90.84904146194458, 91.97782468795776, 92.95719909667969, 93.93657350540161, 95.0803771018982, 96.22418069839478, 97.26258397102356, 98.30098724365234, 99.40886569023132, 100.5167441368103, 101.62218451499939, 102.72762489318848, 103.81770157814026, 104.90777826309204, 105.92695760726929, 106.94613695144653, 108.10094094276428, 109.25574493408203, 110.38409686088562, 111.51244878768921, 112.53488659858704, 113.55732440948486, 114.70695114135742, 115.85657787322998, 116.9832284450531, 118.10987901687622, 119.10611414909363, 120.10234928131104, 121.7132031917572, 123.32405710220337, 124.54698395729065, 125.76991081237793, 126.78586792945862, 127.8018250465393, 128.79315328598022, 129.78448152542114, 131.02063536643982, 132.2567892074585, 133.63871717453003, 135.02064514160156, 136.20219659805298, 137.3837480545044, 138.38077235221863, 139.37779664993286, 140.46644568443298, 141.5550947189331, 142.5738492012024, 143.59260368347168, 144.597229719162, 145.6018557548523, 146.6014392375946, 147.6010227203369, 148.6461319923401, 149.69124126434326, 150.67281985282898, 151.6543984413147, 152.6553246974945, 153.65625095367432, 154.75033926963806, 155.8444275856018, 156.89413571357727, 157.94384384155273, 159.02333045005798, 160.10281705856323, 161.0855197906494, 162.0682225227356, 162.96651363372803, 163.86480474472046, 164.88904452323914, 165.9132843017578, 166.98520827293396, 168.0571322441101, 169.09129190444946, 170.12545156478882, 171.21499800682068, 172.30454444885254, 173.4442446231842, 174.58394479751587, 175.7184920310974, 176.85303926467896, 177.92091464996338, 178.9887900352478, 179.9465947151184, 180.904399394989, 182.0327126979828, 183.16102600097656, 184.2060568332672, 185.25108766555786, 186.3014829158783, 187.35187816619873, 188.42443943023682, 189.4970006942749, 190.56669187545776, 191.63638305664062, 192.64782977104187, 193.65927648544312, 194.7387592792511, 195.81824207305908, 196.82242560386658, 197.82660913467407, 198.99151182174683, 200.15641450881958, 201.11879515647888, 202.08117580413818, 203.12522864341736, 204.16928148269653, 205.14923119544983, 206.12918090820312, 207.0838749408722, 208.03856897354126, 209.14069533348083, 210.2428216934204, 211.33913159370422, 212.43544149398804, 213.76810359954834, 215.10076570510864, 217.18624639511108, 219.27172708511353]
[23.5, 23.5, 35.06, 35.06, 48.06, 48.06, 42.14, 42.14, 48.22, 48.22, 55.34, 55.34, 56.76, 56.76, 59.5, 59.5, 62.96, 62.96, 63.44, 63.44, 65.64, 65.64, 68.74, 68.74, 70.46, 70.46, 70.6, 70.6, 72.58, 72.58, 74.56, 74.56, 75.74, 75.74, 75.74, 75.74, 75.54, 75.54, 75.64, 75.64, 75.72, 75.72, 78.8, 78.8, 78.72, 78.72, 79.6, 79.6, 79.56, 79.56, 79.64, 79.64, 79.58, 79.58, 79.8, 79.8, 79.72, 79.72, 80.1, 80.1, 79.94, 79.94, 80.0, 80.0, 80.24, 80.24, 80.2, 80.2, 80.02, 80.02, 80.9, 80.9, 80.84, 80.84, 81.2, 81.2, 80.86, 80.86, 81.0, 81.0, 80.82, 80.82, 80.82, 80.82, 80.88, 80.88, 80.68, 80.68, 80.88, 80.88, 81.44, 81.44, 81.52, 81.52, 81.48, 81.48, 81.32, 81.32, 81.3, 81.3, 81.32, 81.32, 81.28, 81.28, 81.3, 81.3, 81.2, 81.2, 81.22, 81.22, 81.14, 81.14, 81.0, 81.0, 81.0, 81.0, 80.92, 80.92, 81.0, 81.0, 81.04, 81.04, 81.06, 81.06, 81.04, 81.04, 80.96, 80.96, 80.98, 80.98, 80.88, 80.88, 80.8, 80.8, 80.66, 80.66, 80.62, 80.62, 80.62, 80.62, 80.66, 80.66, 80.64, 80.64, 80.66, 80.66, 80.5, 80.5, 80.54, 80.54, 80.44, 80.44, 80.42, 80.42, 80.42, 80.42, 80.46, 80.46, 80.54, 80.54, 80.56, 80.56, 80.54, 80.54, 80.54, 80.54, 80.54, 80.54, 80.52, 80.52, 80.5, 80.5, 80.62, 80.62, 80.62, 80.62, 80.46, 80.46, 80.38, 80.38, 80.36, 80.36, 80.38, 80.38, 80.4, 80.4, 80.38, 80.38, 80.4, 80.4, 80.34, 80.34, 80.42, 80.42, 80.34, 80.34, 80.54, 80.54, 81.58, 81.58, 81.8, 81.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 2, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.293, Test loss: 2.295, Test accuracy: 19.00
Round   0, Global train loss: 2.293, Global test loss: 2.300, Global test accuracy: 15.96
Round   1, Train loss: 2.288, Test loss: 2.280, Test accuracy: 34.86
Round   1, Global train loss: 2.288, Global test loss: 2.291, Global test accuracy: 31.38
Round   2, Train loss: 2.230, Test loss: 2.205, Test accuracy: 31.80
Round   2, Global train loss: 2.230, Global test loss: 2.219, Global test accuracy: 26.98
Round   3, Train loss: 2.043, Test loss: 2.082, Test accuracy: 41.18
Round   3, Global train loss: 2.043, Global test loss: 2.106, Global test accuracy: 35.84
Round   4, Train loss: 1.962, Test loss: 1.996, Test accuracy: 47.78
Round   4, Global train loss: 1.962, Global test loss: 2.052, Global test accuracy: 39.42
Round   5, Train loss: 2.051, Test loss: 1.950, Test accuracy: 52.38
Round   5, Global train loss: 2.051, Global test loss: 2.005, Global test accuracy: 45.14
Round   6, Train loss: 1.949, Test loss: 1.940, Test accuracy: 52.98
Round   6, Global train loss: 1.949, Global test loss: 1.991, Global test accuracy: 48.44
Round   7, Train loss: 2.006, Test loss: 1.907, Test accuracy: 56.90
Round   7, Global train loss: 2.006, Global test loss: 1.952, Global test accuracy: 50.28
Round   8, Train loss: 1.879, Test loss: 1.884, Test accuracy: 59.80
Round   8, Global train loss: 1.879, Global test loss: 1.912, Global test accuracy: 57.20
Round   9, Train loss: 1.875, Test loss: 1.803, Test accuracy: 67.26
Round   9, Global train loss: 1.875, Global test loss: 1.898, Global test accuracy: 56.30
Round  10, Train loss: 1.865, Test loss: 1.791, Test accuracy: 68.16
Round  10, Global train loss: 1.865, Global test loss: 1.881, Global test accuracy: 58.94
Round  11, Train loss: 1.937, Test loss: 1.762, Test accuracy: 71.06
Round  11, Global train loss: 1.937, Global test loss: 1.868, Global test accuracy: 61.22
Round  12, Train loss: 1.815, Test loss: 1.761, Test accuracy: 71.08
Round  12, Global train loss: 1.815, Global test loss: 1.865, Global test accuracy: 59.66
Round  13, Train loss: 1.842, Test loss: 1.755, Test accuracy: 71.22
Round  13, Global train loss: 1.842, Global test loss: 1.917, Global test accuracy: 54.34
Round  14, Train loss: 1.825, Test loss: 1.750, Test accuracy: 71.60
Round  14, Global train loss: 1.825, Global test loss: 1.854, Global test accuracy: 61.38
Round  15, Train loss: 1.923, Test loss: 1.751, Test accuracy: 71.36
Round  15, Global train loss: 1.923, Global test loss: 1.854, Global test accuracy: 62.38
Round  16, Train loss: 1.880, Test loss: 1.750, Test accuracy: 71.56
Round  16, Global train loss: 1.880, Global test loss: 1.837, Global test accuracy: 63.50
Round  17, Train loss: 1.799, Test loss: 1.750, Test accuracy: 71.46
Round  17, Global train loss: 1.799, Global test loss: 1.801, Global test accuracy: 67.22
Round  18, Train loss: 1.927, Test loss: 1.750, Test accuracy: 71.58
Round  18, Global train loss: 1.927, Global test loss: 1.811, Global test accuracy: 66.24
Round  19, Train loss: 1.811, Test loss: 1.752, Test accuracy: 71.34
Round  19, Global train loss: 1.811, Global test loss: 1.795, Global test accuracy: 67.48
Round  20, Train loss: 1.866, Test loss: 1.749, Test accuracy: 71.70
Round  20, Global train loss: 1.866, Global test loss: 1.840, Global test accuracy: 61.98
Round  21, Train loss: 1.800, Test loss: 1.749, Test accuracy: 71.72
Round  21, Global train loss: 1.800, Global test loss: 1.811, Global test accuracy: 65.98
Round  22, Train loss: 1.954, Test loss: 1.749, Test accuracy: 71.74
Round  22, Global train loss: 1.954, Global test loss: 1.850, Global test accuracy: 61.48
Round  23, Train loss: 1.801, Test loss: 1.750, Test accuracy: 71.62
Round  23, Global train loss: 1.801, Global test loss: 1.811, Global test accuracy: 65.58
Round  24, Train loss: 1.797, Test loss: 1.749, Test accuracy: 71.68
Round  24, Global train loss: 1.797, Global test loss: 1.809, Global test accuracy: 65.66
Round  25, Train loss: 1.799, Test loss: 1.748, Test accuracy: 71.64
Round  25, Global train loss: 1.799, Global test loss: 1.782, Global test accuracy: 68.82
Round  26, Train loss: 1.913, Test loss: 1.747, Test accuracy: 71.62
Round  26, Global train loss: 1.913, Global test loss: 1.792, Global test accuracy: 67.38
Round  27, Train loss: 1.839, Test loss: 1.744, Test accuracy: 71.74
Round  27, Global train loss: 1.839, Global test loss: 1.837, Global test accuracy: 62.50
Round  28, Train loss: 1.908, Test loss: 1.744, Test accuracy: 71.68
Round  28, Global train loss: 1.908, Global test loss: 1.799, Global test accuracy: 67.02
Round  29, Train loss: 1.833, Test loss: 1.744, Test accuracy: 71.78
Round  29, Global train loss: 1.833, Global test loss: 1.810, Global test accuracy: 65.60
Round  30, Train loss: 1.893, Test loss: 1.745, Test accuracy: 71.60
Round  30, Global train loss: 1.893, Global test loss: 1.801, Global test accuracy: 66.72
Round  31, Train loss: 1.894, Test loss: 1.744, Test accuracy: 71.74
Round  31, Global train loss: 1.894, Global test loss: 1.801, Global test accuracy: 66.36
Round  32, Train loss: 1.714, Test loss: 1.743, Test accuracy: 71.70
Round  32, Global train loss: 1.714, Global test loss: 1.774, Global test accuracy: 69.26
Round  33, Train loss: 1.830, Test loss: 1.744, Test accuracy: 71.56
Round  33, Global train loss: 1.830, Global test loss: 1.794, Global test accuracy: 66.86
Round  34, Train loss: 1.969, Test loss: 1.746, Test accuracy: 71.32
Round  34, Global train loss: 1.969, Global test loss: 1.804, Global test accuracy: 66.48
Round  35, Train loss: 1.931, Test loss: 1.746, Test accuracy: 71.44
Round  35, Global train loss: 1.931, Global test loss: 1.805, Global test accuracy: 65.90
Round  36, Train loss: 1.826, Test loss: 1.747, Test accuracy: 71.30
Round  36, Global train loss: 1.826, Global test loss: 1.802, Global test accuracy: 66.04
Round  37, Train loss: 1.744, Test loss: 1.746, Test accuracy: 71.36
Round  37, Global train loss: 1.744, Global test loss: 1.802, Global test accuracy: 66.24
Round  38, Train loss: 1.741, Test loss: 1.746, Test accuracy: 71.34
Round  38, Global train loss: 1.741, Global test loss: 1.796, Global test accuracy: 66.92
Round  39, Train loss: 1.891, Test loss: 1.749, Test accuracy: 71.16
Round  39, Global train loss: 1.891, Global test loss: 1.790, Global test accuracy: 67.34
Round  40, Train loss: 1.816, Test loss: 1.748, Test accuracy: 71.16
Round  40, Global train loss: 1.816, Global test loss: 1.859, Global test accuracy: 59.38
Round  41, Train loss: 1.710, Test loss: 1.748, Test accuracy: 71.32
Round  41, Global train loss: 1.710, Global test loss: 1.770, Global test accuracy: 69.46
Round  42, Train loss: 1.903, Test loss: 1.748, Test accuracy: 71.32
Round  42, Global train loss: 1.903, Global test loss: 1.811, Global test accuracy: 65.38
Round  43, Train loss: 1.901, Test loss: 1.748, Test accuracy: 71.26
Round  43, Global train loss: 1.901, Global test loss: 1.827, Global test accuracy: 63.66
Round  44, Train loss: 1.870, Test loss: 1.748, Test accuracy: 71.32
Round  44, Global train loss: 1.870, Global test loss: 1.787, Global test accuracy: 67.46
Round  45, Train loss: 1.827, Test loss: 1.746, Test accuracy: 71.60
Round  45, Global train loss: 1.827, Global test loss: 1.775, Global test accuracy: 68.80
Round  46, Train loss: 1.926, Test loss: 1.746, Test accuracy: 71.60
Round  46, Global train loss: 1.926, Global test loss: 1.791, Global test accuracy: 67.26
Round  47, Train loss: 1.923, Test loss: 1.746, Test accuracy: 71.56
Round  47, Global train loss: 1.923, Global test loss: 1.803, Global test accuracy: 65.88
Round  48, Train loss: 1.752, Test loss: 1.746, Test accuracy: 71.50
Round  48, Global train loss: 1.752, Global test loss: 1.849, Global test accuracy: 60.48
Round  49, Train loss: 1.900, Test loss: 1.749, Test accuracy: 71.28
Round  49, Global train loss: 1.900, Global test loss: 1.786, Global test accuracy: 67.76
Round  50, Train loss: 1.959, Test loss: 1.752, Test accuracy: 70.80
Round  50, Global train loss: 1.959, Global test loss: 1.797, Global test accuracy: 66.68
Round  51, Train loss: 1.784, Test loss: 1.751, Test accuracy: 71.02
Round  51, Global train loss: 1.784, Global test loss: 1.798, Global test accuracy: 66.40
Round  52, Train loss: 1.881, Test loss: 1.750, Test accuracy: 71.16
Round  52, Global train loss: 1.881, Global test loss: 1.782, Global test accuracy: 68.22
Round  53, Train loss: 1.811, Test loss: 1.748, Test accuracy: 71.40
Round  53, Global train loss: 1.811, Global test loss: 1.780, Global test accuracy: 68.68
Round  54, Train loss: 1.862, Test loss: 1.750, Test accuracy: 71.12
Round  54, Global train loss: 1.862, Global test loss: 1.783, Global test accuracy: 67.98
Round  55, Train loss: 1.812, Test loss: 1.751, Test accuracy: 71.02
Round  55, Global train loss: 1.812, Global test loss: 1.808, Global test accuracy: 65.44
Round  56, Train loss: 1.736, Test loss: 1.751, Test accuracy: 71.00
Round  56, Global train loss: 1.736, Global test loss: 1.788, Global test accuracy: 67.58
Round  57, Train loss: 1.891, Test loss: 1.750, Test accuracy: 71.04
Round  57, Global train loss: 1.891, Global test loss: 1.788, Global test accuracy: 67.14
Round  58, Train loss: 1.870, Test loss: 1.751, Test accuracy: 70.96
Round  58, Global train loss: 1.870, Global test loss: 1.791, Global test accuracy: 67.38
Round  59, Train loss: 1.839, Test loss: 1.751, Test accuracy: 71.02
Round  59, Global train loss: 1.839, Global test loss: 1.797, Global test accuracy: 66.58
Round  60, Train loss: 1.892, Test loss: 1.751, Test accuracy: 70.92
Round  60, Global train loss: 1.892, Global test loss: 1.816, Global test accuracy: 64.92
Round  61, Train loss: 1.913, Test loss: 1.752, Test accuracy: 70.88
Round  61, Global train loss: 1.913, Global test loss: 1.820, Global test accuracy: 64.30
Round  62, Train loss: 1.874, Test loss: 1.751, Test accuracy: 70.88
Round  62, Global train loss: 1.874, Global test loss: 1.791, Global test accuracy: 67.20
Round  63, Train loss: 1.781, Test loss: 1.751, Test accuracy: 70.88
Round  63, Global train loss: 1.781, Global test loss: 1.787, Global test accuracy: 67.42
Round  64, Train loss: 1.836, Test loss: 1.751, Test accuracy: 70.98
Round  64, Global train loss: 1.836, Global test loss: 1.798, Global test accuracy: 66.52
Round  65, Train loss: 1.814, Test loss: 1.752, Test accuracy: 70.98
Round  65, Global train loss: 1.814, Global test loss: 1.774, Global test accuracy: 69.18
Round  66, Train loss: 1.765, Test loss: 1.751, Test accuracy: 71.02
Round  66, Global train loss: 1.765, Global test loss: 1.778, Global test accuracy: 68.32
Round  67, Train loss: 1.807, Test loss: 1.750, Test accuracy: 70.94
Round  67, Global train loss: 1.807, Global test loss: 1.774, Global test accuracy: 68.96
Round  68, Train loss: 1.812, Test loss: 1.750, Test accuracy: 70.98
Round  68, Global train loss: 1.812, Global test loss: 1.777, Global test accuracy: 68.74
Round  69, Train loss: 1.779, Test loss: 1.750, Test accuracy: 71.06
Round  69, Global train loss: 1.779, Global test loss: 1.779, Global test accuracy: 68.30
Round  70, Train loss: 1.881, Test loss: 1.749, Test accuracy: 71.14
Round  70, Global train loss: 1.881, Global test loss: 1.810, Global test accuracy: 65.14
Round  71, Train loss: 1.833, Test loss: 1.748, Test accuracy: 71.16
Round  71, Global train loss: 1.833, Global test loss: 1.787, Global test accuracy: 67.32
Round  72, Train loss: 1.856, Test loss: 1.749, Test accuracy: 71.12
Round  72, Global train loss: 1.856, Global test loss: 1.778, Global test accuracy: 68.18
Round  73, Train loss: 1.842, Test loss: 1.749, Test accuracy: 71.16
Round  73, Global train loss: 1.842, Global test loss: 1.784, Global test accuracy: 67.74
Round  74, Train loss: 1.915, Test loss: 1.749, Test accuracy: 71.26
Round  74, Global train loss: 1.915, Global test loss: 1.803, Global test accuracy: 65.94
Round  75, Train loss: 1.792, Test loss: 1.749, Test accuracy: 71.24
Round  75, Global train loss: 1.792, Global test loss: 1.787, Global test accuracy: 67.78
Round  76, Train loss: 1.965, Test loss: 1.749, Test accuracy: 71.14
Round  76, Global train loss: 1.965, Global test loss: 1.792, Global test accuracy: 66.88
Round  77, Train loss: 1.862, Test loss: 1.749, Test accuracy: 71.14
Round  77, Global train loss: 1.862, Global test loss: 1.777, Global test accuracy: 68.64
Round  78, Train loss: 1.835, Test loss: 1.749, Test accuracy: 71.18
Round  78, Global train loss: 1.835, Global test loss: 1.781, Global test accuracy: 68.30
Round  79, Train loss: 1.804, Test loss: 1.749, Test accuracy: 71.06
Round  79, Global train loss: 1.804, Global test loss: 1.768, Global test accuracy: 69.46
Round  80, Train loss: 1.762, Test loss: 1.748, Test accuracy: 71.16
Round  80, Global train loss: 1.762, Global test loss: 1.784, Global test accuracy: 67.78
Round  81, Train loss: 1.921, Test loss: 1.748, Test accuracy: 71.22
Round  81, Global train loss: 1.921, Global test loss: 1.800, Global test accuracy: 66.52
Round  82, Train loss: 1.700, Test loss: 1.748, Test accuracy: 71.18
Round  82, Global train loss: 1.700, Global test loss: 1.767, Global test accuracy: 69.28
Round  83, Train loss: 1.808, Test loss: 1.748, Test accuracy: 71.18
Round  83, Global train loss: 1.808, Global test loss: 1.772, Global test accuracy: 69.04
Round  84, Train loss: 1.779, Test loss: 1.748, Test accuracy: 71.14
Round  84, Global train loss: 1.779, Global test loss: 1.772, Global test accuracy: 68.70
Round  85, Train loss: 1.853, Test loss: 1.748, Test accuracy: 71.24
Round  85, Global train loss: 1.853, Global test loss: 1.770, Global test accuracy: 69.38
Round  86, Train loss: 1.885, Test loss: 1.749, Test accuracy: 71.14
Round  86, Global train loss: 1.885, Global test loss: 1.773, Global test accuracy: 68.98
Round  87, Train loss: 1.772, Test loss: 1.748, Test accuracy: 71.14
Round  87, Global train loss: 1.772, Global test loss: 1.768, Global test accuracy: 69.34
Round  88, Train loss: 1.811, Test loss: 1.749, Test accuracy: 71.14
Round  88, Global train loss: 1.811, Global test loss: 1.795, Global test accuracy: 66.72
Round  89, Train loss: 1.777, Test loss: 1.748, Test accuracy: 71.18
Round  89, Global train loss: 1.777, Global test loss: 1.776, Global test accuracy: 68.28
Round  90, Train loss: 1.777, Test loss: 1.748, Test accuracy: 71.18
Round  90, Global train loss: 1.777, Global test loss: 1.773, Global test accuracy: 68.46
Round  91, Train loss: 1.831, Test loss: 1.747, Test accuracy: 71.24
Round  91, Global train loss: 1.831, Global test loss: 1.784, Global test accuracy: 67.64
Round  92, Train loss: 1.878, Test loss: 1.747, Test accuracy: 71.26
Round  92, Global train loss: 1.878, Global test loss: 1.768, Global test accuracy: 69.66
Round  93, Train loss: 1.890, Test loss: 1.747, Test accuracy: 71.22
Round  93, Global train loss: 1.890, Global test loss: 1.773, Global test accuracy: 68.78
Round  94, Train loss: 1.764, Test loss: 1.734, Test accuracy: 72.70
Round  94, Global train loss: 1.764, Global test loss: 1.765, Global test accuracy: 69.46/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.724, Test loss: 1.719, Test accuracy: 74.30
Round  95, Global train loss: 1.724, Global test loss: 1.749, Global test accuracy: 71.46
Round  96, Train loss: 1.754, Test loss: 1.707, Test accuracy: 75.64
Round  96, Global train loss: 1.754, Global test loss: 1.751, Global test accuracy: 71.84
Round  97, Train loss: 1.775, Test loss: 1.695, Test accuracy: 77.04
Round  97, Global train loss: 1.775, Global test loss: 1.767, Global test accuracy: 69.88
Round  98, Train loss: 1.728, Test loss: 1.679, Test accuracy: 78.78
Round  98, Global train loss: 1.728, Global test loss: 1.735, Global test accuracy: 73.68
Round  99, Train loss: 1.795, Test loss: 1.677, Test accuracy: 78.94
Round  99, Global train loss: 1.795, Global test loss: 1.728, Global test accuracy: 74.50
Final Round, Train loss: 1.753, Test loss: 1.676, Test accuracy: 78.80
Final Round, Global train loss: 1.753, Global test loss: 1.728, Global test accuracy: 74.50
Average accuracy final 10 rounds: 74.23000000000002 

Average global accuracy final 10 rounds: 70.536 

779.743159532547
[1.0982067584991455, 2.196413516998291, 3.258286237716675, 4.320158958435059, 5.353427886962891, 6.386696815490723, 7.474880933761597, 8.56306505203247, 9.701811790466309, 10.840558528900146, 11.833645820617676, 12.826733112335205, 13.789816856384277, 14.75290060043335, 15.824130535125732, 16.895360469818115, 17.987371921539307, 19.079383373260498, 20.126800060272217, 21.174216747283936, 22.179341554641724, 23.18446636199951, 24.187137842178345, 25.189809322357178, 26.23399329185486, 27.27817726135254, 28.446531295776367, 29.614885330200195, 30.647151708602905, 31.679418087005615, 32.644274950027466, 33.609131813049316, 34.772539377212524, 35.93594694137573, 37.034706354141235, 38.13346576690674, 39.16743326187134, 40.20140075683594, 41.22339916229248, 42.24539756774902, 43.31934452056885, 44.39329147338867, 45.36566472053528, 46.338037967681885, 47.41254234313965, 48.48704671859741, 49.496954679489136, 50.50686264038086, 51.54612970352173, 52.5853967666626, 53.5519745349884, 54.51855230331421, 55.425678730010986, 56.332805156707764, 57.481926918029785, 58.63104867935181, 59.717968463897705, 60.8048882484436, 61.8366265296936, 62.8683648109436, 63.84696316719055, 64.8255615234375, 65.73338317871094, 66.64120483398438, 67.54887700080872, 68.45654916763306, 69.46317839622498, 70.4698076248169, 71.55193591117859, 72.63406419754028, 73.67280507087708, 74.71154594421387, 75.74221205711365, 76.77287817001343, 77.64260125160217, 78.51232433319092, 79.52059316635132, 80.52886199951172, 81.53379583358765, 82.53872966766357, 83.49423861503601, 84.44974756240845, 85.62418603897095, 86.79862451553345, 87.77631402015686, 88.75400352478027, 89.86422514915466, 90.97444677352905, 92.0189471244812, 93.06344747543335, 94.07986450195312, 95.0962815284729, 96.08573532104492, 97.07518911361694, 98.2175543308258, 99.35991954803467, 100.37568545341492, 101.39145135879517, 102.55017471313477, 103.70889806747437, 104.77882432937622, 105.84875059127808, 106.9441876411438, 108.03962469100952, 109.10294032096863, 110.16625595092773, 111.19408011436462, 112.22190427780151, 113.37882399559021, 114.5357437133789, 115.61453866958618, 116.69333362579346, 117.70149397850037, 118.70965433120728, 119.67831921577454, 120.6469841003418, 121.71137595176697, 122.77576780319214, 123.80973863601685, 124.84370946884155, 125.90066456794739, 126.95761966705322, 127.95238924026489, 128.94715881347656, 129.98823237419128, 131.029305934906, 132.02439856529236, 133.0194911956787, 134.1377809047699, 135.25607061386108, 136.40114855766296, 137.54622650146484, 138.5648329257965, 139.58343935012817, 140.5234730243683, 141.4635066986084, 142.493816614151, 143.5241265296936, 144.54147791862488, 145.55882930755615, 146.5952455997467, 147.63166189193726, 148.73742246627808, 149.8431830406189, 150.85820889472961, 151.87323474884033, 152.925048828125, 153.97686290740967, 155.4379003047943, 156.89893770217896, 157.86011815071106, 158.82129859924316, 159.8293251991272, 160.83735179901123, 161.82118844985962, 162.805025100708, 163.77688360214233, 164.74874210357666, 165.90803408622742, 167.06732606887817, 168.06962299346924, 169.0719199180603, 170.1541666984558, 171.23641347885132, 172.19669198989868, 173.15697050094604, 174.1560778617859, 175.15518522262573, 176.29123711585999, 177.42728900909424, 178.4228127002716, 179.41833639144897, 180.5166208744049, 181.61490535736084, 182.62238550186157, 183.6298656463623, 184.6409375667572, 185.6520094871521, 186.5817985534668, 187.5115876197815, 188.54830646514893, 189.58502531051636, 190.57177472114563, 191.5585241317749, 192.5082767009735, 193.45802927017212, 194.44691634178162, 195.4358034133911, 196.47409629821777, 197.51238918304443, 198.81182074546814, 200.11125230789185, 201.18819856643677, 202.2651448249817, 203.38705682754517, 204.50896883010864, 205.59841132164001, 206.6878538131714, 207.69574618339539, 208.70363855361938, 210.87054419517517, 213.03744983673096]
[19.0, 19.0, 34.86, 34.86, 31.8, 31.8, 41.18, 41.18, 47.78, 47.78, 52.38, 52.38, 52.98, 52.98, 56.9, 56.9, 59.8, 59.8, 67.26, 67.26, 68.16, 68.16, 71.06, 71.06, 71.08, 71.08, 71.22, 71.22, 71.6, 71.6, 71.36, 71.36, 71.56, 71.56, 71.46, 71.46, 71.58, 71.58, 71.34, 71.34, 71.7, 71.7, 71.72, 71.72, 71.74, 71.74, 71.62, 71.62, 71.68, 71.68, 71.64, 71.64, 71.62, 71.62, 71.74, 71.74, 71.68, 71.68, 71.78, 71.78, 71.6, 71.6, 71.74, 71.74, 71.7, 71.7, 71.56, 71.56, 71.32, 71.32, 71.44, 71.44, 71.3, 71.3, 71.36, 71.36, 71.34, 71.34, 71.16, 71.16, 71.16, 71.16, 71.32, 71.32, 71.32, 71.32, 71.26, 71.26, 71.32, 71.32, 71.6, 71.6, 71.6, 71.6, 71.56, 71.56, 71.5, 71.5, 71.28, 71.28, 70.8, 70.8, 71.02, 71.02, 71.16, 71.16, 71.4, 71.4, 71.12, 71.12, 71.02, 71.02, 71.0, 71.0, 71.04, 71.04, 70.96, 70.96, 71.02, 71.02, 70.92, 70.92, 70.88, 70.88, 70.88, 70.88, 70.88, 70.88, 70.98, 70.98, 70.98, 70.98, 71.02, 71.02, 70.94, 70.94, 70.98, 70.98, 71.06, 71.06, 71.14, 71.14, 71.16, 71.16, 71.12, 71.12, 71.16, 71.16, 71.26, 71.26, 71.24, 71.24, 71.14, 71.14, 71.14, 71.14, 71.18, 71.18, 71.06, 71.06, 71.16, 71.16, 71.22, 71.22, 71.18, 71.18, 71.18, 71.18, 71.14, 71.14, 71.24, 71.24, 71.14, 71.14, 71.14, 71.14, 71.14, 71.14, 71.18, 71.18, 71.18, 71.18, 71.24, 71.24, 71.26, 71.26, 71.22, 71.22, 72.7, 72.7, 74.3, 74.3, 75.64, 75.64, 77.04, 77.04, 78.78, 78.78, 78.94, 78.94, 78.8, 78.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.293, Test loss: 2.292, Test accuracy: 16.02
Round   0, Global train loss: 2.293, Global test loss: 2.298, Global test accuracy: 8.96
Round   1, Train loss: 2.270, Test loss: 2.256, Test accuracy: 31.22
Round   1, Global train loss: 2.270, Global test loss: 2.271, Global test accuracy: 28.96
Round   2, Train loss: 2.167, Test loss: 2.150, Test accuracy: 39.54
Round   2, Global train loss: 2.167, Global test loss: 2.157, Global test accuracy: 33.36
Round   3, Train loss: 2.000, Test loss: 2.060, Test accuracy: 43.32
Round   3, Global train loss: 2.000, Global test loss: 2.063, Global test accuracy: 43.98
Round   4, Train loss: 1.857, Test loss: 1.992, Test accuracy: 48.40
Round   4, Global train loss: 1.857, Global test loss: 2.015, Global test accuracy: 44.08
Round   5, Train loss: 1.978, Test loss: 1.921, Test accuracy: 55.50
Round   5, Global train loss: 1.978, Global test loss: 1.980, Global test accuracy: 49.26
Round   6, Train loss: 1.959, Test loss: 1.882, Test accuracy: 59.68
Round   6, Global train loss: 1.959, Global test loss: 1.960, Global test accuracy: 55.12
Round   7, Train loss: 1.939, Test loss: 1.843, Test accuracy: 63.62
Round   7, Global train loss: 1.939, Global test loss: 1.951, Global test accuracy: 51.58
Round   8, Train loss: 1.696, Test loss: 1.832, Test accuracy: 64.10
Round   8, Global train loss: 1.696, Global test loss: 1.884, Global test accuracy: 60.14
Round   9, Train loss: 1.947, Test loss: 1.772, Test accuracy: 70.34
Round   9, Global train loss: 1.947, Global test loss: 1.857, Global test accuracy: 61.68
Round  10, Train loss: 1.791, Test loss: 1.769, Test accuracy: 70.74
Round  10, Global train loss: 1.791, Global test loss: 1.862, Global test accuracy: 61.24
Round  11, Train loss: 1.943, Test loss: 1.749, Test accuracy: 72.42
Round  11, Global train loss: 1.943, Global test loss: 1.846, Global test accuracy: 63.64
Round  12, Train loss: 1.915, Test loss: 1.748, Test accuracy: 72.44
Round  12, Global train loss: 1.915, Global test loss: 1.842, Global test accuracy: 63.18
Round  13, Train loss: 1.813, Test loss: 1.746, Test accuracy: 72.54
Round  13, Global train loss: 1.813, Global test loss: 1.913, Global test accuracy: 54.24
Round  14, Train loss: 1.894, Test loss: 1.743, Test accuracy: 72.66
Round  14, Global train loss: 1.894, Global test loss: 1.827, Global test accuracy: 64.52
Round  15, Train loss: 1.957, Test loss: 1.742, Test accuracy: 72.62
Round  15, Global train loss: 1.957, Global test loss: 1.805, Global test accuracy: 67.80
Round  16, Train loss: 1.833, Test loss: 1.742, Test accuracy: 72.56
Round  16, Global train loss: 1.833, Global test loss: 1.812, Global test accuracy: 66.34
Round  17, Train loss: 1.744, Test loss: 1.743, Test accuracy: 72.36
Round  17, Global train loss: 1.744, Global test loss: 1.795, Global test accuracy: 68.00
Round  18, Train loss: 1.928, Test loss: 1.742, Test accuracy: 72.48
Round  18, Global train loss: 1.928, Global test loss: 1.778, Global test accuracy: 70.10
Round  19, Train loss: 1.809, Test loss: 1.741, Test accuracy: 72.60
Round  19, Global train loss: 1.809, Global test loss: 1.786, Global test accuracy: 69.28
Round  20, Train loss: 1.892, Test loss: 1.740, Test accuracy: 72.60
Round  20, Global train loss: 1.892, Global test loss: 1.827, Global test accuracy: 63.70
Round  21, Train loss: 1.879, Test loss: 1.739, Test accuracy: 72.74
Round  21, Global train loss: 1.879, Global test loss: 1.793, Global test accuracy: 67.80
Round  22, Train loss: 1.956, Test loss: 1.740, Test accuracy: 72.68
Round  22, Global train loss: 1.956, Global test loss: 1.797, Global test accuracy: 67.22
Round  23, Train loss: 1.883, Test loss: 1.741, Test accuracy: 72.50
Round  23, Global train loss: 1.883, Global test loss: 1.807, Global test accuracy: 66.10
Round  24, Train loss: 1.894, Test loss: 1.738, Test accuracy: 72.82
Round  24, Global train loss: 1.894, Global test loss: 1.811, Global test accuracy: 65.34
Round  25, Train loss: 1.823, Test loss: 1.739, Test accuracy: 72.64
Round  25, Global train loss: 1.823, Global test loss: 1.784, Global test accuracy: 68.54
Round  26, Train loss: 1.917, Test loss: 1.739, Test accuracy: 72.64
Round  26, Global train loss: 1.917, Global test loss: 1.773, Global test accuracy: 69.88
Round  27, Train loss: 1.748, Test loss: 1.738, Test accuracy: 72.46
Round  27, Global train loss: 1.748, Global test loss: 1.796, Global test accuracy: 67.24
Round  28, Train loss: 1.936, Test loss: 1.738, Test accuracy: 72.54
Round  28, Global train loss: 1.936, Global test loss: 1.794, Global test accuracy: 67.72
Round  29, Train loss: 1.831, Test loss: 1.738, Test accuracy: 72.46
Round  29, Global train loss: 1.831, Global test loss: 1.795, Global test accuracy: 67.36
Round  30, Train loss: 1.845, Test loss: 1.738, Test accuracy: 72.46
Round  30, Global train loss: 1.845, Global test loss: 1.784, Global test accuracy: 68.34
Round  31, Train loss: 1.750, Test loss: 1.737, Test accuracy: 72.52
Round  31, Global train loss: 1.750, Global test loss: 1.794, Global test accuracy: 67.54
Round  32, Train loss: 1.784, Test loss: 1.737, Test accuracy: 72.58
Round  32, Global train loss: 1.784, Global test loss: 1.774, Global test accuracy: 69.38
Round  33, Train loss: 1.805, Test loss: 1.738, Test accuracy: 72.46
Round  33, Global train loss: 1.805, Global test loss: 1.786, Global test accuracy: 68.28
Round  34, Train loss: 1.934, Test loss: 1.738, Test accuracy: 72.54
Round  34, Global train loss: 1.934, Global test loss: 1.783, Global test accuracy: 68.54
Round  35, Train loss: 1.910, Test loss: 1.737, Test accuracy: 72.58
Round  35, Global train loss: 1.910, Global test loss: 1.807, Global test accuracy: 65.96
Round  36, Train loss: 1.801, Test loss: 1.737, Test accuracy: 72.62
Round  36, Global train loss: 1.801, Global test loss: 1.777, Global test accuracy: 69.20
Round  37, Train loss: 1.693, Test loss: 1.737, Test accuracy: 72.62
Round  37, Global train loss: 1.693, Global test loss: 1.786, Global test accuracy: 68.02
Round  38, Train loss: 1.691, Test loss: 1.737, Test accuracy: 72.68
Round  38, Global train loss: 1.691, Global test loss: 1.779, Global test accuracy: 68.50
Round  39, Train loss: 1.849, Test loss: 1.736, Test accuracy: 72.74
Round  39, Global train loss: 1.849, Global test loss: 1.767, Global test accuracy: 69.66
Round  40, Train loss: 1.862, Test loss: 1.736, Test accuracy: 72.80
Round  40, Global train loss: 1.862, Global test loss: 1.835, Global test accuracy: 62.52
Round  41, Train loss: 1.684, Test loss: 1.736, Test accuracy: 72.82
Round  41, Global train loss: 1.684, Global test loss: 1.765, Global test accuracy: 70.06
Round  42, Train loss: 1.906, Test loss: 1.735, Test accuracy: 72.84
Round  42, Global train loss: 1.906, Global test loss: 1.773, Global test accuracy: 69.40
Round  43, Train loss: 1.904, Test loss: 1.736, Test accuracy: 72.76
Round  43, Global train loss: 1.904, Global test loss: 1.780, Global test accuracy: 68.86
Round  44, Train loss: 1.897, Test loss: 1.736, Test accuracy: 72.72
Round  44, Global train loss: 1.897, Global test loss: 1.783, Global test accuracy: 68.28
Round  45, Train loss: 1.834, Test loss: 1.736, Test accuracy: 72.68
Round  45, Global train loss: 1.834, Global test loss: 1.767, Global test accuracy: 69.72
Round  46, Train loss: 1.914, Test loss: 1.736, Test accuracy: 72.66
Round  46, Global train loss: 1.914, Global test loss: 1.785, Global test accuracy: 67.90
Round  47, Train loss: 1.911, Test loss: 1.737, Test accuracy: 72.62
Round  47, Global train loss: 1.911, Global test loss: 1.796, Global test accuracy: 66.64
Round  48, Train loss: 1.847, Test loss: 1.736, Test accuracy: 72.66
Round  48, Global train loss: 1.847, Global test loss: 1.834, Global test accuracy: 62.92
Round  49, Train loss: 1.831, Test loss: 1.736, Test accuracy: 72.56
Round  49, Global train loss: 1.831, Global test loss: 1.774, Global test accuracy: 69.14
Round  50, Train loss: 1.923, Test loss: 1.736, Test accuracy: 72.60
Round  50, Global train loss: 1.923, Global test loss: 1.771, Global test accuracy: 69.52
Round  51, Train loss: 1.855, Test loss: 1.737, Test accuracy: 72.50
Round  51, Global train loss: 1.855, Global test loss: 1.802, Global test accuracy: 66.12
Round  52, Train loss: 1.842, Test loss: 1.737, Test accuracy: 72.50
Round  52, Global train loss: 1.842, Global test loss: 1.765, Global test accuracy: 69.84
Round  53, Train loss: 1.799, Test loss: 1.737, Test accuracy: 72.60
Round  53, Global train loss: 1.799, Global test loss: 1.771, Global test accuracy: 69.28
Round  54, Train loss: 1.889, Test loss: 1.737, Test accuracy: 72.68
Round  54, Global train loss: 1.889, Global test loss: 1.784, Global test accuracy: 68.24
Round  55, Train loss: 1.732, Test loss: 1.736, Test accuracy: 72.66
Round  55, Global train loss: 1.732, Global test loss: 1.773, Global test accuracy: 69.18
Round  56, Train loss: 1.688, Test loss: 1.736, Test accuracy: 72.64
Round  56, Global train loss: 1.688, Global test loss: 1.772, Global test accuracy: 69.34
Round  57, Train loss: 1.821, Test loss: 1.736, Test accuracy: 72.70
Round  57, Global train loss: 1.821, Global test loss: 1.763, Global test accuracy: 70.24
Round  58, Train loss: 1.743, Test loss: 1.736, Test accuracy: 72.64
Round  58, Global train loss: 1.743, Global test loss: 1.764, Global test accuracy: 69.74
Round  59, Train loss: 1.865, Test loss: 1.736, Test accuracy: 72.64
Round  59, Global train loss: 1.865, Global test loss: 1.787, Global test accuracy: 67.72
Round  60, Train loss: 1.899, Test loss: 1.735, Test accuracy: 72.70
Round  60, Global train loss: 1.899, Global test loss: 1.768, Global test accuracy: 69.64
Round  61, Train loss: 1.837, Test loss: 1.735, Test accuracy: 72.74
Round  61, Global train loss: 1.837, Global test loss: 1.782, Global test accuracy: 68.26
Round  62, Train loss: 1.838, Test loss: 1.736, Test accuracy: 72.62
Round  62, Global train loss: 1.838, Global test loss: 1.767, Global test accuracy: 69.46
Round  63, Train loss: 1.711, Test loss: 1.736, Test accuracy: 72.68
Round  63, Global train loss: 1.711, Global test loss: 1.767, Global test accuracy: 69.68
Round  64, Train loss: 1.863, Test loss: 1.736, Test accuracy: 72.60
Round  64, Global train loss: 1.863, Global test loss: 1.787, Global test accuracy: 67.88
Round  65, Train loss: 1.825, Test loss: 1.735, Test accuracy: 72.72
Round  65, Global train loss: 1.825, Global test loss: 1.764, Global test accuracy: 70.04
Round  66, Train loss: 1.717, Test loss: 1.735, Test accuracy: 72.68
Round  66, Global train loss: 1.717, Global test loss: 1.765, Global test accuracy: 69.72
Round  67, Train loss: 1.727, Test loss: 1.735, Test accuracy: 72.70
Round  67, Global train loss: 1.727, Global test loss: 1.762, Global test accuracy: 70.08
Round  68, Train loss: 1.739, Test loss: 1.735, Test accuracy: 72.58
Round  68, Global train loss: 1.739, Global test loss: 1.765, Global test accuracy: 69.70
Round  69, Train loss: 1.708, Test loss: 1.735, Test accuracy: 72.62
Round  69, Global train loss: 1.708, Global test loss: 1.765, Global test accuracy: 69.84
Round  70, Train loss: 1.899, Test loss: 1.735, Test accuracy: 72.60
Round  70, Global train loss: 1.899, Global test loss: 1.765, Global test accuracy: 69.80
Round  71, Train loss: 1.872, Test loss: 1.735, Test accuracy: 72.66
Round  71, Global train loss: 1.872, Global test loss: 1.779, Global test accuracy: 68.62
Round  72, Train loss: 1.883, Test loss: 1.735, Test accuracy: 72.66
Round  72, Global train loss: 1.883, Global test loss: 1.776, Global test accuracy: 68.78
Round  73, Train loss: 1.871, Test loss: 1.735, Test accuracy: 72.64
Round  73, Global train loss: 1.871, Global test loss: 1.775, Global test accuracy: 68.80
Round  74, Train loss: 1.929, Test loss: 1.735, Test accuracy: 72.68
Round  74, Global train loss: 1.929, Global test loss: 1.768, Global test accuracy: 69.58
Round  75, Train loss: 1.649, Test loss: 1.735, Test accuracy: 72.66
Round  75, Global train loss: 1.649, Global test loss: 1.769, Global test accuracy: 69.66
Round  76, Train loss: 2.008, Test loss: 1.735, Test accuracy: 72.70
Round  76, Global train loss: 2.008, Global test loss: 1.780, Global test accuracy: 68.40
Round  77, Train loss: 1.890, Test loss: 1.735, Test accuracy: 72.66
Round  77, Global train loss: 1.890, Global test loss: 1.778, Global test accuracy: 68.40
Round  78, Train loss: 1.793, Test loss: 1.735, Test accuracy: 72.66
Round  78, Global train loss: 1.793, Global test loss: 1.761, Global test accuracy: 70.36
Round  79, Train loss: 1.887, Test loss: 1.736, Test accuracy: 72.68
Round  79, Global train loss: 1.887, Global test loss: 1.764, Global test accuracy: 69.90
Round  80, Train loss: 1.715, Test loss: 1.735, Test accuracy: 72.74
Round  80, Global train loss: 1.715, Global test loss: 1.769, Global test accuracy: 69.32
Round  81, Train loss: 1.926, Test loss: 1.736, Test accuracy: 72.66
Round  81, Global train loss: 1.926, Global test loss: 1.767, Global test accuracy: 69.54
Round  82, Train loss: 1.605, Test loss: 1.736, Test accuracy: 72.66
Round  82, Global train loss: 1.605, Global test loss: 1.756, Global test accuracy: 70.80
Round  83, Train loss: 1.810, Test loss: 1.735, Test accuracy: 72.60
Round  83, Global train loss: 1.810, Global test loss: 1.763, Global test accuracy: 70.16
Round  84, Train loss: 1.800, Test loss: 1.735, Test accuracy: 72.66
Round  84, Global train loss: 1.800, Global test loss: 1.764, Global test accuracy: 70.06
Round  85, Train loss: 1.881, Test loss: 1.735, Test accuracy: 72.72
Round  85, Global train loss: 1.881, Global test loss: 1.770, Global test accuracy: 69.34
Round  86, Train loss: 1.963, Test loss: 1.735, Test accuracy: 72.72
Round  86, Global train loss: 1.963, Global test loss: 1.765, Global test accuracy: 69.80
Round  87, Train loss: 1.787, Test loss: 1.735, Test accuracy: 72.66
Round  87, Global train loss: 1.787, Global test loss: 1.762, Global test accuracy: 70.06
Round  88, Train loss: 1.814, Test loss: 1.735, Test accuracy: 72.66
Round  88, Global train loss: 1.814, Global test loss: 1.771, Global test accuracy: 69.46
Round  89, Train loss: 1.798, Test loss: 1.735, Test accuracy: 72.58
Round  89, Global train loss: 1.798, Global test loss: 1.769, Global test accuracy: 69.34
Round  90, Train loss: 1.851, Test loss: 1.735, Test accuracy: 72.56
Round  90, Global train loss: 1.851, Global test loss: 1.766, Global test accuracy: 69.70
Round  91, Train loss: 1.861, Test loss: 1.735, Test accuracy: 72.64
Round  91, Global train loss: 1.861, Global test loss: 1.773, Global test accuracy: 69.00
Round  92, Train loss: 1.898, Test loss: 1.734, Test accuracy: 72.70
Round  92, Global train loss: 1.898, Global test loss: 1.772, Global test accuracy: 69.18
Round  93, Train loss: 1.915, Test loss: 1.734, Test accuracy: 72.80
Round  93, Global train loss: 1.915, Global test loss: 1.766, Global test accuracy: 69.54
Round  94, Train loss: 1.853, Test loss: 1.734, Test accuracy: 72.76
Round  94, Global train loss: 1.853, Global test loss: 1.768, Global test accuracy: 69.66/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.772, Test loss: 1.734, Test accuracy: 72.76
Round  95, Global train loss: 1.772, Global test loss: 1.764, Global test accuracy: 69.84
Round  96, Train loss: 1.718, Test loss: 1.734, Test accuracy: 72.76
Round  96, Global train loss: 1.718, Global test loss: 1.768, Global test accuracy: 69.34
Round  97, Train loss: 1.806, Test loss: 1.735, Test accuracy: 72.68
Round  97, Global train loss: 1.806, Global test loss: 1.767, Global test accuracy: 69.56
Round  98, Train loss: 1.853, Test loss: 1.735, Test accuracy: 72.72
Round  98, Global train loss: 1.853, Global test loss: 1.764, Global test accuracy: 69.90
Round  99, Train loss: 1.951, Test loss: 1.735, Test accuracy: 72.70
Round  99, Global train loss: 1.951, Global test loss: 1.774, Global test accuracy: 68.76
Final Round, Train loss: 1.814, Test loss: 1.735, Test accuracy: 72.64
Final Round, Global train loss: 1.814, Global test loss: 1.774, Global test accuracy: 68.76
Average accuracy final 10 rounds: 72.70800000000001 

Average global accuracy final 10 rounds: 69.44800000000001 

833.9631860256195
[1.2488470077514648, 2.4976940155029297, 3.947373151779175, 5.39705228805542, 6.786858558654785, 8.17666482925415, 9.51328444480896, 10.84990406036377, 12.011976957321167, 13.174049854278564, 14.248908281326294, 15.323766708374023, 16.643766403198242, 17.96376609802246, 19.08407211303711, 20.204378128051758, 21.429842710494995, 22.655307292938232, 23.880192279815674, 25.105077266693115, 26.43584132194519, 27.766605377197266, 29.17254400253296, 30.578482627868652, 31.868651628494263, 33.15882062911987, 34.47577929496765, 35.79273796081543, 36.886269330978394, 37.97980070114136, 39.35590934753418, 40.732017993927, 41.83223867416382, 42.932459354400635, 44.0083532333374, 45.08424711227417, 46.13668990135193, 47.18913269042969, 48.338706493377686, 49.488280296325684, 50.76426649093628, 52.040252685546875, 53.1752188205719, 54.310184955596924, 55.53426766395569, 56.75835037231445, 57.94250202178955, 59.12665367126465, 60.248255014419556, 61.36985635757446, 62.53845524787903, 63.707054138183594, 64.88960552215576, 66.07215690612793, 67.21754884719849, 68.36294078826904, 69.48604893684387, 70.6091570854187, 71.75162363052368, 72.89409017562866, 74.2061665058136, 75.51824283599854, 76.56848192214966, 77.61872100830078, 78.67987847328186, 79.74103593826294, 80.89794588088989, 82.05485582351685, 83.13024091720581, 84.20562601089478, 85.32557559013367, 86.44552516937256, 87.54057383537292, 88.63562250137329, 89.68830633163452, 90.74099016189575, 92.11914920806885, 93.49730825424194, 94.69322419166565, 95.88914012908936, 97.03305435180664, 98.17696857452393, 99.41931223869324, 100.66165590286255, 101.77538084983826, 102.88910579681396, 104.00955080986023, 105.1299958229065, 106.3812665939331, 107.63253736495972, 108.75709247589111, 109.88164758682251, 110.96656966209412, 112.05149173736572, 113.2324914932251, 114.41349124908447, 115.59195160865784, 116.7704119682312, 117.85544657707214, 118.94048118591309, 120.09314489364624, 121.2458086013794, 122.40348243713379, 123.56115627288818, 124.704261302948, 125.84736633300781, 126.9309151172638, 128.01446390151978, 129.17950630187988, 130.34454870224, 131.50320482254028, 132.66186094284058, 133.80299067497253, 134.9441204071045, 136.2419617176056, 137.5398030281067, 138.65171217918396, 139.76362133026123, 140.82231974601746, 141.88101816177368, 142.95036554336548, 144.01971292495728, 145.29455709457397, 146.56940126419067, 147.73946118354797, 148.90952110290527, 150.10173344612122, 151.29394578933716, 152.58201122283936, 153.87007665634155, 155.04801201820374, 156.22594738006592, 157.38250637054443, 158.53906536102295, 159.6869077682495, 160.83475017547607, 161.9353528022766, 163.03595542907715, 164.14412593841553, 165.2522964477539, 166.39198994636536, 167.5316834449768, 168.71198630332947, 169.89228916168213, 171.0206708908081, 172.14905261993408, 173.40072107315063, 174.6523895263672, 175.77094221115112, 176.88949489593506, 178.08145761489868, 179.2734203338623, 180.63322830200195, 181.9930362701416, 183.33861708641052, 184.68419790267944, 185.89851093292236, 187.11282396316528, 188.23466730117798, 189.35651063919067, 190.45260000228882, 191.54868936538696, 192.75188088417053, 193.9550724029541, 195.07561349868774, 196.1961545944214, 197.3103551864624, 198.42455577850342, 199.68218064308167, 200.9398055076599, 202.06262588500977, 203.18544626235962, 204.269850730896, 205.35425519943237, 206.5200710296631, 207.6858868598938, 208.8091492652893, 209.93241167068481, 211.0607831478119, 212.18915462493896, 213.39884877204895, 214.60854291915894, 216.06181168556213, 217.51508045196533, 218.7956326007843, 220.07618474960327, 221.36108326911926, 222.64598178863525, 223.8299045562744, 225.01382732391357, 226.18636226654053, 227.35889720916748, 229.21023607254028, 231.0615749359131, 232.25519323349, 233.4488115310669, 234.70998454093933, 235.97115755081177, 237.20336627960205, 238.43557500839233, 241.1456422805786, 243.8557095527649]
[16.02, 16.02, 31.22, 31.22, 39.54, 39.54, 43.32, 43.32, 48.4, 48.4, 55.5, 55.5, 59.68, 59.68, 63.62, 63.62, 64.1, 64.1, 70.34, 70.34, 70.74, 70.74, 72.42, 72.42, 72.44, 72.44, 72.54, 72.54, 72.66, 72.66, 72.62, 72.62, 72.56, 72.56, 72.36, 72.36, 72.48, 72.48, 72.6, 72.6, 72.6, 72.6, 72.74, 72.74, 72.68, 72.68, 72.5, 72.5, 72.82, 72.82, 72.64, 72.64, 72.64, 72.64, 72.46, 72.46, 72.54, 72.54, 72.46, 72.46, 72.46, 72.46, 72.52, 72.52, 72.58, 72.58, 72.46, 72.46, 72.54, 72.54, 72.58, 72.58, 72.62, 72.62, 72.62, 72.62, 72.68, 72.68, 72.74, 72.74, 72.8, 72.8, 72.82, 72.82, 72.84, 72.84, 72.76, 72.76, 72.72, 72.72, 72.68, 72.68, 72.66, 72.66, 72.62, 72.62, 72.66, 72.66, 72.56, 72.56, 72.6, 72.6, 72.5, 72.5, 72.5, 72.5, 72.6, 72.6, 72.68, 72.68, 72.66, 72.66, 72.64, 72.64, 72.7, 72.7, 72.64, 72.64, 72.64, 72.64, 72.7, 72.7, 72.74, 72.74, 72.62, 72.62, 72.68, 72.68, 72.6, 72.6, 72.72, 72.72, 72.68, 72.68, 72.7, 72.7, 72.58, 72.58, 72.62, 72.62, 72.6, 72.6, 72.66, 72.66, 72.66, 72.66, 72.64, 72.64, 72.68, 72.68, 72.66, 72.66, 72.7, 72.7, 72.66, 72.66, 72.66, 72.66, 72.68, 72.68, 72.74, 72.74, 72.66, 72.66, 72.66, 72.66, 72.6, 72.6, 72.66, 72.66, 72.72, 72.72, 72.72, 72.72, 72.66, 72.66, 72.66, 72.66, 72.58, 72.58, 72.56, 72.56, 72.64, 72.64, 72.7, 72.7, 72.8, 72.8, 72.76, 72.76, 72.76, 72.76, 72.76, 72.76, 72.68, 72.68, 72.72, 72.72, 72.7, 72.7, 72.64, 72.64]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.319, Test loss: 2.300, Test accuracy: 8.62
Round   0, Global train loss: 2.319, Global test loss: 2.301, Global test accuracy: 8.34
Round   1, Train loss: 2.297, Test loss: 2.294, Test accuracy: 35.68
Round   1, Global train loss: 2.297, Global test loss: 2.296, Global test accuracy: 31.36
Round   2, Train loss: 2.283, Test loss: 2.280, Test accuracy: 36.46
Round   2, Global train loss: 2.283, Global test loss: 2.283, Global test accuracy: 31.70
Round   3, Train loss: 2.246, Test loss: 2.220, Test accuracy: 26.66
Round   3, Global train loss: 2.246, Global test loss: 2.227, Global test accuracy: 20.30
Round   4, Train loss: 2.198, Test loss: 2.141, Test accuracy: 36.00
Round   4, Global train loss: 2.198, Global test loss: 2.158, Global test accuracy: 29.84
Round   5, Train loss: 2.139, Test loss: 2.096, Test accuracy: 40.34
Round   5, Global train loss: 2.139, Global test loss: 2.117, Global test accuracy: 30.54
Round   6, Train loss: 2.107, Test loss: 2.051, Test accuracy: 45.34
Round   6, Global train loss: 2.107, Global test loss: 2.130, Global test accuracy: 33.22
Round   7, Train loss: 2.072, Test loss: 1.998, Test accuracy: 52.66
Round   7, Global train loss: 2.072, Global test loss: 2.073, Global test accuracy: 39.80
Round   8, Train loss: 2.051, Test loss: 1.949, Test accuracy: 58.78
Round   8, Global train loss: 2.051, Global test loss: 2.034, Global test accuracy: 50.70
Round   9, Train loss: 1.967, Test loss: 1.884, Test accuracy: 63.04
Round   9, Global train loss: 1.967, Global test loss: 2.018, Global test accuracy: 49.58
Round  10, Train loss: 1.948, Test loss: 1.852, Test accuracy: 65.64
Round  10, Global train loss: 1.948, Global test loss: 1.971, Global test accuracy: 53.46
Round  11, Train loss: 1.923, Test loss: 1.793, Test accuracy: 73.78
Round  11, Global train loss: 1.923, Global test loss: 1.944, Global test accuracy: 60.24
Round  12, Train loss: 1.792, Test loss: 1.744, Test accuracy: 79.38
Round  12, Global train loss: 1.792, Global test loss: 1.922, Global test accuracy: 55.20
Round  13, Train loss: 1.754, Test loss: 1.712, Test accuracy: 82.56
Round  13, Global train loss: 1.754, Global test loss: 1.955, Global test accuracy: 56.32
Round  14, Train loss: 1.876, Test loss: 1.697, Test accuracy: 84.50
Round  14, Global train loss: 1.876, Global test loss: 1.956, Global test accuracy: 55.82
Round  15, Train loss: 1.769, Test loss: 1.674, Test accuracy: 86.76
Round  15, Global train loss: 1.769, Global test loss: 1.871, Global test accuracy: 67.04
Round  16, Train loss: 1.863, Test loss: 1.662, Test accuracy: 87.80
Round  16, Global train loss: 1.863, Global test loss: 1.883, Global test accuracy: 66.64
Round  17, Train loss: 1.896, Test loss: 1.658, Test accuracy: 89.50
Round  17, Global train loss: 1.896, Global test loss: 1.882, Global test accuracy: 64.58
Round  18, Train loss: 1.822, Test loss: 1.628, Test accuracy: 92.94
Round  18, Global train loss: 1.822, Global test loss: 1.862, Global test accuracy: 70.22
Round  19, Train loss: 1.795, Test loss: 1.618, Test accuracy: 93.06
Round  19, Global train loss: 1.795, Global test loss: 1.853, Global test accuracy: 72.16
Round  20, Train loss: 1.765, Test loss: 1.615, Test accuracy: 93.02
Round  20, Global train loss: 1.765, Global test loss: 1.867, Global test accuracy: 66.94
Round  21, Train loss: 1.785, Test loss: 1.606, Test accuracy: 92.92
Round  21, Global train loss: 1.785, Global test loss: 1.909, Global test accuracy: 59.48
Round  22, Train loss: 1.868, Test loss: 1.604, Test accuracy: 93.48
Round  22, Global train loss: 1.868, Global test loss: 1.870, Global test accuracy: 66.98
Round  23, Train loss: 1.586, Test loss: 1.594, Test accuracy: 93.62
Round  23, Global train loss: 1.586, Global test loss: 1.856, Global test accuracy: 64.48
Round  24, Train loss: 1.664, Test loss: 1.589, Test accuracy: 93.66
Round  24, Global train loss: 1.664, Global test loss: 1.820, Global test accuracy: 69.90
Round  25, Train loss: 1.774, Test loss: 1.586, Test accuracy: 93.78
Round  25, Global train loss: 1.774, Global test loss: 1.830, Global test accuracy: 72.00
Round  26, Train loss: 1.759, Test loss: 1.584, Test accuracy: 93.92
Round  26, Global train loss: 1.759, Global test loss: 1.825, Global test accuracy: 70.70
Round  27, Train loss: 1.798, Test loss: 1.577, Test accuracy: 94.12
Round  27, Global train loss: 1.798, Global test loss: 1.914, Global test accuracy: 59.96
Round  28, Train loss: 1.762, Test loss: 1.580, Test accuracy: 93.94
Round  28, Global train loss: 1.762, Global test loss: 1.870, Global test accuracy: 64.22
Round  29, Train loss: 1.839, Test loss: 1.583, Test accuracy: 93.92
Round  29, Global train loss: 1.839, Global test loss: 1.930, Global test accuracy: 58.30
Round  30, Train loss: 1.837, Test loss: 1.583, Test accuracy: 94.02
Round  30, Global train loss: 1.837, Global test loss: 1.896, Global test accuracy: 56.64
Round  31, Train loss: 1.850, Test loss: 1.579, Test accuracy: 94.16
Round  31, Global train loss: 1.850, Global test loss: 1.899, Global test accuracy: 57.94
Round  32, Train loss: 1.725, Test loss: 1.576, Test accuracy: 94.04
Round  32, Global train loss: 1.725, Global test loss: 1.841, Global test accuracy: 71.88
Round  33, Train loss: 1.732, Test loss: 1.573, Test accuracy: 93.86
Round  33, Global train loss: 1.732, Global test loss: 1.864, Global test accuracy: 71.14
Round  34, Train loss: 1.771, Test loss: 1.571, Test accuracy: 93.90
Round  34, Global train loss: 1.771, Global test loss: 1.848, Global test accuracy: 67.18
Round  35, Train loss: 1.755, Test loss: 1.572, Test accuracy: 93.80
Round  35, Global train loss: 1.755, Global test loss: 1.857, Global test accuracy: 61.32
Round  36, Train loss: 1.730, Test loss: 1.569, Test accuracy: 94.16
Round  36, Global train loss: 1.730, Global test loss: 1.860, Global test accuracy: 72.52
Round  37, Train loss: 1.737, Test loss: 1.563, Test accuracy: 94.42
Round  37, Global train loss: 1.737, Global test loss: 1.839, Global test accuracy: 66.88
Round  38, Train loss: 1.723, Test loss: 1.562, Test accuracy: 94.52
Round  38, Global train loss: 1.723, Global test loss: 1.834, Global test accuracy: 66.98
Round  39, Train loss: 1.743, Test loss: 1.564, Test accuracy: 94.16
Round  39, Global train loss: 1.743, Global test loss: 1.828, Global test accuracy: 70.28
Round  40, Train loss: 1.635, Test loss: 1.563, Test accuracy: 94.34
Round  40, Global train loss: 1.635, Global test loss: 1.844, Global test accuracy: 66.38
Round  41, Train loss: 1.721, Test loss: 1.559, Test accuracy: 94.36
Round  41, Global train loss: 1.721, Global test loss: 1.838, Global test accuracy: 72.76
Round  42, Train loss: 1.827, Test loss: 1.564, Test accuracy: 94.20
Round  42, Global train loss: 1.827, Global test loss: 1.949, Global test accuracy: 51.26
Round  43, Train loss: 1.815, Test loss: 1.569, Test accuracy: 93.80
Round  43, Global train loss: 1.815, Global test loss: 1.959, Global test accuracy: 49.50
Round  44, Train loss: 1.644, Test loss: 1.562, Test accuracy: 94.08
Round  44, Global train loss: 1.644, Global test loss: 1.821, Global test accuracy: 69.06
Round  45, Train loss: 1.637, Test loss: 1.555, Test accuracy: 94.56
Round  45, Global train loss: 1.637, Global test loss: 1.787, Global test accuracy: 75.06
Round  46, Train loss: 1.661, Test loss: 1.557, Test accuracy: 94.12
Round  46, Global train loss: 1.661, Global test loss: 1.867, Global test accuracy: 63.72
Round  47, Train loss: 1.650, Test loss: 1.557, Test accuracy: 94.10
Round  47, Global train loss: 1.650, Global test loss: 1.860, Global test accuracy: 64.68
Round  48, Train loss: 1.521, Test loss: 1.555, Test accuracy: 94.24
Round  48, Global train loss: 1.521, Global test loss: 1.803, Global test accuracy: 71.04
Round  49, Train loss: 1.738, Test loss: 1.553, Test accuracy: 94.54
Round  49, Global train loss: 1.738, Global test loss: 1.882, Global test accuracy: 59.10
Round  50, Train loss: 1.733, Test loss: 1.557, Test accuracy: 94.30
Round  50, Global train loss: 1.733, Global test loss: 1.905, Global test accuracy: 61.52
Round  51, Train loss: 1.601, Test loss: 1.556, Test accuracy: 94.30
Round  51, Global train loss: 1.601, Global test loss: 1.816, Global test accuracy: 72.64
Round  52, Train loss: 1.722, Test loss: 1.556, Test accuracy: 94.30
Round  52, Global train loss: 1.722, Global test loss: 1.825, Global test accuracy: 70.24
Round  53, Train loss: 1.627, Test loss: 1.553, Test accuracy: 94.42
Round  53, Global train loss: 1.627, Global test loss: 1.864, Global test accuracy: 66.44
Round  54, Train loss: 1.624, Test loss: 1.553, Test accuracy: 94.46
Round  54, Global train loss: 1.624, Global test loss: 1.866, Global test accuracy: 63.28
Round  55, Train loss: 1.731, Test loss: 1.552, Test accuracy: 94.28
Round  55, Global train loss: 1.731, Global test loss: 1.935, Global test accuracy: 55.94
Round  56, Train loss: 1.695, Test loss: 1.553, Test accuracy: 94.26
Round  56, Global train loss: 1.695, Global test loss: 1.832, Global test accuracy: 66.46
Round  57, Train loss: 1.721, Test loss: 1.556, Test accuracy: 94.40
Round  57, Global train loss: 1.721, Global test loss: 1.870, Global test accuracy: 60.26
Round  58, Train loss: 1.718, Test loss: 1.559, Test accuracy: 94.04
Round  58, Global train loss: 1.718, Global test loss: 1.836, Global test accuracy: 68.00
Round  59, Train loss: 1.690, Test loss: 1.561, Test accuracy: 94.04
Round  59, Global train loss: 1.690, Global test loss: 1.833, Global test accuracy: 72.44
Round  60, Train loss: 1.798, Test loss: 1.565, Test accuracy: 93.84
Round  60, Global train loss: 1.798, Global test loss: 1.951, Global test accuracy: 50.00
Round  61, Train loss: 1.712, Test loss: 1.567, Test accuracy: 93.58
Round  61, Global train loss: 1.712, Global test loss: 1.877, Global test accuracy: 66.08
Round  62, Train loss: 1.710, Test loss: 1.564, Test accuracy: 93.54
Round  62, Global train loss: 1.710, Global test loss: 1.832, Global test accuracy: 69.04
Round  63, Train loss: 1.618, Test loss: 1.556, Test accuracy: 94.06
Round  63, Global train loss: 1.618, Global test loss: 1.828, Global test accuracy: 66.54
Round  64, Train loss: 1.682, Test loss: 1.558, Test accuracy: 93.94
Round  64, Global train loss: 1.682, Global test loss: 1.835, Global test accuracy: 71.22
Round  65, Train loss: 1.609, Test loss: 1.556, Test accuracy: 93.76
Round  65, Global train loss: 1.609, Global test loss: 1.795, Global test accuracy: 72.56
Round  66, Train loss: 1.780, Test loss: 1.561, Test accuracy: 93.78
Round  66, Global train loss: 1.780, Global test loss: 1.836, Global test accuracy: 67.78
Round  67, Train loss: 1.612, Test loss: 1.557, Test accuracy: 93.98
Round  67, Global train loss: 1.612, Global test loss: 1.794, Global test accuracy: 73.08
Round  68, Train loss: 1.703, Test loss: 1.557, Test accuracy: 94.24
Round  68, Global train loss: 1.703, Global test loss: 1.883, Global test accuracy: 58.44
Round  69, Train loss: 1.603, Test loss: 1.554, Test accuracy: 94.12
Round  69, Global train loss: 1.603, Global test loss: 1.824, Global test accuracy: 66.50
Round  70, Train loss: 1.706, Test loss: 1.558, Test accuracy: 93.64
Round  70, Global train loss: 1.706, Global test loss: 1.900, Global test accuracy: 57.38
Round  71, Train loss: 1.605, Test loss: 1.558, Test accuracy: 93.80
Round  71, Global train loss: 1.605, Global test loss: 1.840, Global test accuracy: 64.86
Round  72, Train loss: 1.603, Test loss: 1.561, Test accuracy: 93.40
Round  72, Global train loss: 1.603, Global test loss: 1.907, Global test accuracy: 58.34
Round  73, Train loss: 1.689, Test loss: 1.562, Test accuracy: 93.52
Round  73, Global train loss: 1.689, Global test loss: 1.840, Global test accuracy: 66.18
Round  74, Train loss: 1.692, Test loss: 1.569, Test accuracy: 92.88
Round  74, Global train loss: 1.692, Global test loss: 1.870, Global test accuracy: 66.88
Round  75, Train loss: 1.765, Test loss: 1.573, Test accuracy: 93.04
Round  75, Global train loss: 1.765, Global test loss: 1.925, Global test accuracy: 53.90
Round  76, Train loss: 1.635, Test loss: 1.567, Test accuracy: 92.76
Round  76, Global train loss: 1.635, Global test loss: 1.834, Global test accuracy: 68.44
Round  77, Train loss: 1.610, Test loss: 1.564, Test accuracy: 92.76
Round  77, Global train loss: 1.610, Global test loss: 1.831, Global test accuracy: 65.06
Round  78, Train loss: 1.767, Test loss: 1.570, Test accuracy: 92.62
Round  78, Global train loss: 1.767, Global test loss: 1.886, Global test accuracy: 63.86
Round  79, Train loss: 1.598, Test loss: 1.562, Test accuracy: 93.38
Round  79, Global train loss: 1.598, Global test loss: 1.875, Global test accuracy: 66.04
Round  80, Train loss: 1.661, Test loss: 1.561, Test accuracy: 93.50
Round  80, Global train loss: 1.661, Global test loss: 1.894, Global test accuracy: 59.22
Round  81, Train loss: 1.765, Test loss: 1.572, Test accuracy: 93.02
Round  81, Global train loss: 1.765, Global test loss: 1.887, Global test accuracy: 61.66
Round  82, Train loss: 1.677, Test loss: 1.564, Test accuracy: 93.28
Round  82, Global train loss: 1.677, Global test loss: 1.789, Global test accuracy: 76.82
Round  83, Train loss: 1.655, Test loss: 1.563, Test accuracy: 93.30
Round  83, Global train loss: 1.655, Global test loss: 1.829, Global test accuracy: 69.12
Round  84, Train loss: 1.681, Test loss: 1.566, Test accuracy: 92.84
Round  84, Global train loss: 1.681, Global test loss: 1.837, Global test accuracy: 67.40
Round  85, Train loss: 1.587, Test loss: 1.562, Test accuracy: 93.14
Round  85, Global train loss: 1.587, Global test loss: 1.885, Global test accuracy: 60.04
Round  86, Train loss: 1.670, Test loss: 1.563, Test accuracy: 93.00
Round  86, Global train loss: 1.670, Global test loss: 1.897, Global test accuracy: 64.84
Round  87, Train loss: 1.592, Test loss: 1.559, Test accuracy: 93.08
Round  87, Global train loss: 1.592, Global test loss: 1.785, Global test accuracy: 75.22
Round  88, Train loss: 1.755, Test loss: 1.572, Test accuracy: 92.36
Round  88, Global train loss: 1.755, Global test loss: 1.923, Global test accuracy: 53.52
Round  89, Train loss: 1.668, Test loss: 1.575, Test accuracy: 92.22
Round  89, Global train loss: 1.668, Global test loss: 1.843, Global test accuracy: 66.28
Round  90, Train loss: 1.665, Test loss: 1.574, Test accuracy: 92.18
Round  90, Global train loss: 1.665, Global test loss: 1.875, Global test accuracy: 63.82
Round  91, Train loss: 1.657, Test loss: 1.567, Test accuracy: 92.74
Round  91, Global train loss: 1.657, Global test loss: 1.849, Global test accuracy: 68.80/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.581, Test loss: 1.567, Test accuracy: 92.60
Round  92, Global train loss: 1.581, Global test loss: 1.944, Global test accuracy: 56.98
Round  93, Train loss: 1.683, Test loss: 1.569, Test accuracy: 92.32
Round  93, Global train loss: 1.683, Global test loss: 1.898, Global test accuracy: 56.72
Round  94, Train loss: 1.584, Test loss: 1.564, Test accuracy: 92.56
Round  94, Global train loss: 1.584, Global test loss: 1.914, Global test accuracy: 53.70
Round  95, Train loss: 1.599, Test loss: 1.556, Test accuracy: 93.32
Round  95, Global train loss: 1.599, Global test loss: 1.828, Global test accuracy: 68.24
Round  96, Train loss: 1.682, Test loss: 1.563, Test accuracy: 93.02
Round  96, Global train loss: 1.682, Global test loss: 1.879, Global test accuracy: 58.30
Round  97, Train loss: 1.723, Test loss: 1.574, Test accuracy: 92.34
Round  97, Global train loss: 1.723, Global test loss: 1.973, Global test accuracy: 50.92
Round  98, Train loss: 1.581, Test loss: 1.564, Test accuracy: 93.08
Round  98, Global train loss: 1.581, Global test loss: 1.806, Global test accuracy: 70.04
Round  99, Train loss: 1.594, Test loss: 1.563, Test accuracy: 92.96
Round  99, Global train loss: 1.594, Global test loss: 1.827, Global test accuracy: 68.36
Final Round, Train loss: 1.638, Test loss: 1.561, Test accuracy: 92.84
Final Round, Global train loss: 1.638, Global test loss: 1.827, Global test accuracy: 68.36
Average accuracy final 10 rounds: 92.71199999999999
677.8016443252563
[1.4967784881591797, 2.6757025718688965, 4.086844444274902, 5.437037229537964, 6.684868097305298, 7.9350831508636475, 9.301361083984375, 10.550599813461304, 11.76475477218628, 13.06555986404419, 14.303147077560425, 15.572818756103516, 16.83765721321106, 18.12507915496826, 19.59428882598877, 20.954842567443848, 22.248329877853394, 23.534355401992798, 24.72845220565796, 25.9337477684021, 27.298162937164307, 28.70658564567566, 29.92778182029724, 31.23224186897278, 32.41827893257141, 33.73679876327515, 35.04331016540527, 36.20498561859131, 37.36667776107788, 38.647138595581055, 39.97183918952942, 41.25835561752319, 42.52530884742737, 43.81284713745117, 45.162582874298096, 46.4552321434021, 47.729612827301025, 49.079394578933716, 50.34457564353943, 51.64162468910217, 53.03768849372864, 54.30328726768494, 55.67314887046814, 56.92668414115906, 58.129722595214844, 59.43542551994324, 60.66217374801636, 61.99976181983948, 63.262372732162476, 64.44665670394897, 65.6706292629242, 66.92715716362, 68.05642652511597, 69.28270101547241, 70.5246057510376, 71.68995499610901, 72.87424206733704, 74.09938621520996, 75.302405834198, 76.5216965675354, 77.74526834487915, 78.9530737400055, 80.18835663795471, 81.4008584022522, 82.53497529029846, 83.75526833534241, 84.98721480369568, 86.1323230266571, 87.27837777137756, 88.45918297767639, 89.69876050949097, 90.84440660476685, 92.08568549156189, 93.30989789962769, 94.55618190765381, 95.66088914871216, 96.84952473640442, 98.08062767982483, 99.34688949584961, 100.47628045082092, 101.67599129676819, 102.88612365722656, 104.02620697021484, 105.18204092979431, 107.76184844970703, 108.79583191871643, 109.8383355140686, 110.88953447341919, 111.96804857254028, 113.09094071388245, 114.14118480682373, 115.16571545600891, 116.24942421913147, 117.20897507667542, 118.13512086868286, 119.1397590637207, 120.11668395996094, 121.08371829986572, 122.02279019355774, 122.99540686607361, 124.5927369594574]
[8.62, 35.68, 36.46, 26.66, 36.0, 40.34, 45.34, 52.66, 58.78, 63.04, 65.64, 73.78, 79.38, 82.56, 84.5, 86.76, 87.8, 89.5, 92.94, 93.06, 93.02, 92.92, 93.48, 93.62, 93.66, 93.78, 93.92, 94.12, 93.94, 93.92, 94.02, 94.16, 94.04, 93.86, 93.9, 93.8, 94.16, 94.42, 94.52, 94.16, 94.34, 94.36, 94.2, 93.8, 94.08, 94.56, 94.12, 94.1, 94.24, 94.54, 94.3, 94.3, 94.3, 94.42, 94.46, 94.28, 94.26, 94.4, 94.04, 94.04, 93.84, 93.58, 93.54, 94.06, 93.94, 93.76, 93.78, 93.98, 94.24, 94.12, 93.64, 93.8, 93.4, 93.52, 92.88, 93.04, 92.76, 92.76, 92.62, 93.38, 93.5, 93.02, 93.28, 93.3, 92.84, 93.14, 93.0, 93.08, 92.36, 92.22, 92.18, 92.74, 92.6, 92.32, 92.56, 93.32, 93.02, 92.34, 93.08, 92.96, 92.84]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

   Client 2, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.317, Test loss: 2.298, Test accuracy: 20.00
Round   0, Global train loss: 2.317, Global test loss: 2.301, Global test accuracy: 9.04
Round   1, Train loss: 2.289, Test loss: 2.287, Test accuracy: 28.12
Round   1, Global train loss: 2.289, Global test loss: 2.295, Global test accuracy: 19.26
Round   2, Train loss: 2.269, Test loss: 2.258, Test accuracy: 32.32
Round   2, Global train loss: 2.269, Global test loss: 2.282, Global test accuracy: 30.36
Round   3, Train loss: 2.216, Test loss: 2.169, Test accuracy: 40.50
Round   3, Global train loss: 2.216, Global test loss: 2.234, Global test accuracy: 38.94
Round   4, Train loss: 2.118, Test loss: 2.037, Test accuracy: 47.98
Round   4, Global train loss: 2.118, Global test loss: 2.126, Global test accuracy: 37.96
Round   5, Train loss: 2.031, Test loss: 1.943, Test accuracy: 58.12
Round   5, Global train loss: 2.031, Global test loss: 2.067, Global test accuracy: 41.00
Round   6, Train loss: 1.965, Test loss: 1.861, Test accuracy: 67.14
Round   6, Global train loss: 1.965, Global test loss: 2.028, Global test accuracy: 48.90
Round   7, Train loss: 1.918, Test loss: 1.800, Test accuracy: 71.98
Round   7, Global train loss: 1.918, Global test loss: 1.993, Global test accuracy: 54.92
Round   8, Train loss: 1.883, Test loss: 1.757, Test accuracy: 77.18
Round   8, Global train loss: 1.883, Global test loss: 1.967, Global test accuracy: 58.46
Round   9, Train loss: 1.859, Test loss: 1.729, Test accuracy: 79.72
Round   9, Global train loss: 1.859, Global test loss: 1.946, Global test accuracy: 61.80
Round  10, Train loss: 1.850, Test loss: 1.724, Test accuracy: 80.22
Round  10, Global train loss: 1.850, Global test loss: 1.974, Global test accuracy: 47.24
Round  11, Train loss: 1.674, Test loss: 1.691, Test accuracy: 82.44
Round  11, Global train loss: 1.674, Global test loss: 1.914, Global test accuracy: 59.84
Round  12, Train loss: 1.672, Test loss: 1.668, Test accuracy: 85.82
Round  12, Global train loss: 1.672, Global test loss: 1.913, Global test accuracy: 59.58
Round  13, Train loss: 1.696, Test loss: 1.643, Test accuracy: 87.58
Round  13, Global train loss: 1.696, Global test loss: 1.965, Global test accuracy: 53.04
Round  14, Train loss: 1.658, Test loss: 1.618, Test accuracy: 90.40
Round  14, Global train loss: 1.658, Global test loss: 1.921, Global test accuracy: 60.44
Round  15, Train loss: 1.611, Test loss: 1.610, Test accuracy: 90.82
Round  15, Global train loss: 1.611, Global test loss: 1.871, Global test accuracy: 62.72
Round  16, Train loss: 1.642, Test loss: 1.602, Test accuracy: 90.96
Round  16, Global train loss: 1.642, Global test loss: 1.882, Global test accuracy: 66.70
Round  17, Train loss: 1.630, Test loss: 1.598, Test accuracy: 91.00
Round  17, Global train loss: 1.630, Global test loss: 1.862, Global test accuracy: 65.10
Round  18, Train loss: 1.601, Test loss: 1.588, Test accuracy: 91.64
Round  18, Global train loss: 1.601, Global test loss: 1.838, Global test accuracy: 68.08
Round  19, Train loss: 1.603, Test loss: 1.586, Test accuracy: 91.54
Round  19, Global train loss: 1.603, Global test loss: 1.831, Global test accuracy: 72.48
Round  20, Train loss: 1.576, Test loss: 1.581, Test accuracy: 92.00
Round  20, Global train loss: 1.576, Global test loss: 1.840, Global test accuracy: 70.08
Round  21, Train loss: 1.586, Test loss: 1.578, Test accuracy: 92.20
Round  21, Global train loss: 1.586, Global test loss: 1.886, Global test accuracy: 61.28
Round  22, Train loss: 1.554, Test loss: 1.575, Test accuracy: 92.46
Round  22, Global train loss: 1.554, Global test loss: 1.856, Global test accuracy: 62.38
Round  23, Train loss: 1.560, Test loss: 1.571, Test accuracy: 92.50
Round  23, Global train loss: 1.560, Global test loss: 1.879, Global test accuracy: 60.20
Round  24, Train loss: 1.567, Test loss: 1.567, Test accuracy: 92.66
Round  24, Global train loss: 1.567, Global test loss: 1.817, Global test accuracy: 71.40
Round  25, Train loss: 1.596, Test loss: 1.568, Test accuracy: 92.54
Round  25, Global train loss: 1.596, Global test loss: 1.839, Global test accuracy: 64.78
Round  26, Train loss: 1.571, Test loss: 1.564, Test accuracy: 92.86
Round  26, Global train loss: 1.571, Global test loss: 1.809, Global test accuracy: 71.32
Round  27, Train loss: 1.601, Test loss: 1.554, Test accuracy: 94.24
Round  27, Global train loss: 1.601, Global test loss: 1.933, Global test accuracy: 54.60
Round  28, Train loss: 1.583, Test loss: 1.554, Test accuracy: 94.24
Round  28, Global train loss: 1.583, Global test loss: 1.878, Global test accuracy: 60.58
Round  29, Train loss: 1.540, Test loss: 1.553, Test accuracy: 94.34
Round  29, Global train loss: 1.540, Global test loss: 1.882, Global test accuracy: 60.84
Round  30, Train loss: 1.579, Test loss: 1.549, Test accuracy: 94.28
Round  30, Global train loss: 1.579, Global test loss: 1.869, Global test accuracy: 61.90
Round  31, Train loss: 1.614, Test loss: 1.550, Test accuracy: 94.08
Round  31, Global train loss: 1.614, Global test loss: 1.869, Global test accuracy: 63.56
Round  32, Train loss: 1.541, Test loss: 1.550, Test accuracy: 94.32
Round  32, Global train loss: 1.541, Global test loss: 1.822, Global test accuracy: 71.62
Round  33, Train loss: 1.537, Test loss: 1.547, Test accuracy: 94.44
Round  33, Global train loss: 1.537, Global test loss: 1.851, Global test accuracy: 65.96
Round  34, Train loss: 1.578, Test loss: 1.545, Test accuracy: 94.52
Round  34, Global train loss: 1.578, Global test loss: 1.856, Global test accuracy: 63.70
Round  35, Train loss: 1.613, Test loss: 1.548, Test accuracy: 94.42
Round  35, Global train loss: 1.613, Global test loss: 1.852, Global test accuracy: 63.46
Round  36, Train loss: 1.536, Test loss: 1.547, Test accuracy: 94.30
Round  36, Global train loss: 1.536, Global test loss: 1.855, Global test accuracy: 66.00
Round  37, Train loss: 1.609, Test loss: 1.542, Test accuracy: 94.66
Round  37, Global train loss: 1.609, Global test loss: 1.874, Global test accuracy: 59.34
Round  38, Train loss: 1.604, Test loss: 1.543, Test accuracy: 94.68
Round  38, Global train loss: 1.604, Global test loss: 1.869, Global test accuracy: 59.86
Round  39, Train loss: 1.547, Test loss: 1.542, Test accuracy: 94.56
Round  39, Global train loss: 1.547, Global test loss: 1.810, Global test accuracy: 72.62
Round  40, Train loss: 1.581, Test loss: 1.541, Test accuracy: 94.50
Round  40, Global train loss: 1.581, Global test loss: 1.869, Global test accuracy: 59.20
Round  41, Train loss: 1.562, Test loss: 1.541, Test accuracy: 94.66
Round  41, Global train loss: 1.562, Global test loss: 1.832, Global test accuracy: 72.16
Round  42, Train loss: 1.553, Test loss: 1.538, Test accuracy: 95.12
Round  42, Global train loss: 1.553, Global test loss: 1.894, Global test accuracy: 61.04
Round  43, Train loss: 1.548, Test loss: 1.539, Test accuracy: 95.02
Round  43, Global train loss: 1.548, Global test loss: 1.892, Global test accuracy: 61.02
Round  44, Train loss: 1.594, Test loss: 1.538, Test accuracy: 94.98
Round  44, Global train loss: 1.594, Global test loss: 1.832, Global test accuracy: 66.18
Round  45, Train loss: 1.532, Test loss: 1.536, Test accuracy: 95.16
Round  45, Global train loss: 1.532, Global test loss: 1.784, Global test accuracy: 74.20
Round  46, Train loss: 1.574, Test loss: 1.536, Test accuracy: 94.56
Round  46, Global train loss: 1.574, Global test loss: 1.880, Global test accuracy: 62.12
Round  47, Train loss: 1.570, Test loss: 1.538, Test accuracy: 94.50
Round  47, Global train loss: 1.570, Global test loss: 1.878, Global test accuracy: 62.56
Round  48, Train loss: 1.561, Test loss: 1.537, Test accuracy: 94.94
Round  48, Global train loss: 1.561, Global test loss: 1.831, Global test accuracy: 64.52
Round  49, Train loss: 1.592, Test loss: 1.535, Test accuracy: 94.82
Round  49, Global train loss: 1.592, Global test loss: 1.887, Global test accuracy: 60.58
Round  50, Train loss: 1.529, Test loss: 1.536, Test accuracy: 94.90
Round  50, Global train loss: 1.529, Global test loss: 1.933, Global test accuracy: 54.88
Round  51, Train loss: 1.517, Test loss: 1.534, Test accuracy: 95.14
Round  51, Global train loss: 1.517, Global test loss: 1.850, Global test accuracy: 64.42
Round  52, Train loss: 1.529, Test loss: 1.533, Test accuracy: 94.92
Round  52, Global train loss: 1.529, Global test loss: 1.803, Global test accuracy: 72.90
Round  53, Train loss: 1.520, Test loss: 1.533, Test accuracy: 94.96
Round  53, Global train loss: 1.520, Global test loss: 1.858, Global test accuracy: 67.08
Round  54, Train loss: 1.558, Test loss: 1.533, Test accuracy: 95.00
Round  54, Global train loss: 1.558, Global test loss: 1.881, Global test accuracy: 59.86
Round  55, Train loss: 1.552, Test loss: 1.532, Test accuracy: 95.08
Round  55, Global train loss: 1.552, Global test loss: 1.931, Global test accuracy: 54.50
Round  56, Train loss: 1.586, Test loss: 1.536, Test accuracy: 94.72
Round  56, Global train loss: 1.586, Global test loss: 1.874, Global test accuracy: 57.86
Round  57, Train loss: 1.556, Test loss: 1.534, Test accuracy: 95.18
Round  57, Global train loss: 1.556, Global test loss: 1.853, Global test accuracy: 61.70
Round  58, Train loss: 1.555, Test loss: 1.536, Test accuracy: 94.86
Round  58, Global train loss: 1.555, Global test loss: 1.812, Global test accuracy: 72.14
Round  59, Train loss: 1.525, Test loss: 1.535, Test accuracy: 94.94
Round  59, Global train loss: 1.525, Global test loss: 1.837, Global test accuracy: 68.38
Round  60, Train loss: 1.543, Test loss: 1.532, Test accuracy: 94.84
Round  60, Global train loss: 1.543, Global test loss: 1.893, Global test accuracy: 61.64
Round  61, Train loss: 1.512, Test loss: 1.533, Test accuracy: 94.94
Round  61, Global train loss: 1.512, Global test loss: 1.871, Global test accuracy: 60.28
Round  62, Train loss: 1.523, Test loss: 1.534, Test accuracy: 94.94
Round  62, Global train loss: 1.523, Global test loss: 1.808, Global test accuracy: 71.22
Round  63, Train loss: 1.584, Test loss: 1.532, Test accuracy: 94.90
Round  63, Global train loss: 1.584, Global test loss: 1.837, Global test accuracy: 64.68
Round  64, Train loss: 1.520, Test loss: 1.533, Test accuracy: 94.88
Round  64, Global train loss: 1.520, Global test loss: 1.832, Global test accuracy: 69.36
Round  65, Train loss: 1.511, Test loss: 1.530, Test accuracy: 95.20
Round  65, Global train loss: 1.511, Global test loss: 1.782, Global test accuracy: 72.60
Round  66, Train loss: 1.551, Test loss: 1.529, Test accuracy: 94.98
Round  66, Global train loss: 1.551, Global test loss: 1.803, Global test accuracy: 70.80
Round  67, Train loss: 1.539, Test loss: 1.531, Test accuracy: 95.18
Round  67, Global train loss: 1.539, Global test loss: 1.784, Global test accuracy: 72.32
Round  68, Train loss: 1.553, Test loss: 1.530, Test accuracy: 95.28
Round  68, Global train loss: 1.553, Global test loss: 1.866, Global test accuracy: 59.58
Round  69, Train loss: 1.576, Test loss: 1.531, Test accuracy: 95.24
Round  69, Global train loss: 1.576, Global test loss: 1.833, Global test accuracy: 65.42
Round  70, Train loss: 1.512, Test loss: 1.531, Test accuracy: 95.30
Round  70, Global train loss: 1.512, Global test loss: 1.873, Global test accuracy: 59.86
Round  71, Train loss: 1.518, Test loss: 1.530, Test accuracy: 95.22
Round  71, Global train loss: 1.518, Global test loss: 1.845, Global test accuracy: 64.90
Round  72, Train loss: 1.545, Test loss: 1.531, Test accuracy: 95.38
Round  72, Global train loss: 1.545, Global test loss: 1.874, Global test accuracy: 60.52
Round  73, Train loss: 1.549, Test loss: 1.530, Test accuracy: 95.16
Round  73, Global train loss: 1.549, Global test loss: 1.841, Global test accuracy: 65.42
Round  74, Train loss: 1.478, Test loss: 1.529, Test accuracy: 95.26
Round  74, Global train loss: 1.478, Global test loss: 1.863, Global test accuracy: 61.26
Round  75, Train loss: 1.548, Test loss: 1.529, Test accuracy: 95.02
Round  75, Global train loss: 1.548, Global test loss: 1.894, Global test accuracy: 56.60
Round  76, Train loss: 1.548, Test loss: 1.531, Test accuracy: 94.98
Round  76, Global train loss: 1.548, Global test loss: 1.835, Global test accuracy: 67.62
Round  77, Train loss: 1.574, Test loss: 1.533, Test accuracy: 95.10
Round  77, Global train loss: 1.574, Global test loss: 1.846, Global test accuracy: 64.36
Round  78, Train loss: 1.548, Test loss: 1.532, Test accuracy: 95.12
Round  78, Global train loss: 1.548, Global test loss: 1.831, Global test accuracy: 72.02
Round  79, Train loss: 1.480, Test loss: 1.530, Test accuracy: 95.30
Round  79, Global train loss: 1.480, Global test loss: 1.860, Global test accuracy: 65.88
Round  80, Train loss: 1.475, Test loss: 1.527, Test accuracy: 95.48
Round  80, Global train loss: 1.475, Global test loss: 1.843, Global test accuracy: 66.26
Round  81, Train loss: 1.473, Test loss: 1.525, Test accuracy: 95.52
Round  81, Global train loss: 1.473, Global test loss: 1.834, Global test accuracy: 66.66
Round  82, Train loss: 1.472, Test loss: 1.524, Test accuracy: 95.46
Round  82, Global train loss: 1.472, Global test loss: 1.829, Global test accuracy: 67.12
Round  83, Train loss: 1.472, Test loss: 1.524, Test accuracy: 95.50
Round  83, Global train loss: 1.472, Global test loss: 1.827, Global test accuracy: 66.88
Round  84, Train loss: 1.471, Test loss: 1.524, Test accuracy: 95.52
Round  84, Global train loss: 1.471, Global test loss: 1.824, Global test accuracy: 67.14
Round  85, Train loss: 1.471, Test loss: 1.524, Test accuracy: 95.48
Round  85, Global train loss: 1.471, Global test loss: 1.823, Global test accuracy: 67.26
Round  86, Train loss: 1.470, Test loss: 1.523, Test accuracy: 95.44
Round  86, Global train loss: 1.470, Global test loss: 1.822, Global test accuracy: 67.16
Round  87, Train loss: 1.470, Test loss: 1.523, Test accuracy: 95.48
Round  87, Global train loss: 1.470, Global test loss: 1.822, Global test accuracy: 67.20
Round  88, Train loss: 1.470, Test loss: 1.523, Test accuracy: 95.46
Round  88, Global train loss: 1.470, Global test loss: 1.822, Global test accuracy: 67.22
Round  89, Train loss: 1.470, Test loss: 1.523, Test accuracy: 95.50
Round  89, Global train loss: 1.470, Global test loss: 1.821, Global test accuracy: 67.26
Round  90, Train loss: 1.469, Test loss: 1.523, Test accuracy: 95.54
Round  90, Global train loss: 1.469, Global test loss: 1.821, Global test accuracy: 67.18/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.469, Test loss: 1.523, Test accuracy: 95.54
Round  91, Global train loss: 1.469, Global test loss: 1.822, Global test accuracy: 66.90
Round  92, Train loss: 1.469, Test loss: 1.523, Test accuracy: 95.50
Round  92, Global train loss: 1.469, Global test loss: 1.822, Global test accuracy: 66.78
Round  93, Train loss: 1.469, Test loss: 1.523, Test accuracy: 95.54
Round  93, Global train loss: 1.469, Global test loss: 1.822, Global test accuracy: 66.72
Round  94, Train loss: 1.468, Test loss: 1.523, Test accuracy: 95.58
Round  94, Global train loss: 1.468, Global test loss: 1.822, Global test accuracy: 66.46
Round  95, Train loss: 1.468, Test loss: 1.523, Test accuracy: 95.54
Round  95, Global train loss: 1.468, Global test loss: 1.821, Global test accuracy: 66.54
Round  96, Train loss: 1.468, Test loss: 1.524, Test accuracy: 95.52
Round  96, Global train loss: 1.468, Global test loss: 1.821, Global test accuracy: 66.54
Round  97, Train loss: 1.468, Test loss: 1.524, Test accuracy: 95.56
Round  97, Global train loss: 1.468, Global test loss: 1.822, Global test accuracy: 66.44
Round  98, Train loss: 1.468, Test loss: 1.524, Test accuracy: 95.52
Round  98, Global train loss: 1.468, Global test loss: 1.822, Global test accuracy: 66.44
Round  99, Train loss: 1.532, Test loss: 1.522, Test accuracy: 95.54
Round  99, Global train loss: 1.532, Global test loss: 1.710, Global test accuracy: 87.98
Final Round, Train loss: 1.648, Test loss: 1.522, Test accuracy: 95.44
Final Round, Global train loss: 1.648, Global test loss: 1.710, Global test accuracy: 87.98
Average accuracy final 10 rounds: 95.53800000000001
1512.2716665267944
[1.2771763801574707, 2.397296190261841, 3.514991283416748, 4.815378427505493, 5.949156999588013, 7.0803773403167725, 8.207262992858887, 9.320920705795288, 10.436395645141602, 11.585969924926758, 15.479521751403809, 22.58477020263672, 29.230052947998047, 36.02391576766968, 42.90969944000244, 49.76716709136963, 56.524274826049805, 63.321858644485474, 70.18837690353394, 77.35354256629944, 84.23336625099182, 91.36777830123901, 98.21271324157715, 105.25675535202026, 112.1687240600586, 119.10039806365967, 126.08999300003052, 133.07584810256958, 140.03499126434326, 147.0050253868103, 154.07656073570251, 161.15070700645447, 168.0979027748108, 175.0459520816803, 182.19022011756897, 189.50923943519592, 196.2892804145813, 203.28256130218506, 210.20391702651978, 217.03450965881348, 223.93250584602356, 230.87607526779175, 237.83778929710388, 244.69703698158264, 251.70669651031494, 258.77351808547974, 266.0555193424225, 272.9700026512146, 279.8840003013611, 286.9676399230957, 294.57717847824097, 302.2070622444153, 309.13275504112244, 316.20739006996155, 323.55035948753357, 330.6120285987854, 337.705228805542, 344.8010811805725, 351.7421109676361, 358.6911344528198, 365.91571044921875, 372.7299220561981, 379.70600843429565, 386.9406478404999, 394.11356258392334, 401.2016305923462, 408.2120475769043, 415.1725516319275, 422.2525372505188, 429.257568359375, 436.3485667705536, 443.11823320388794, 450.37938952445984, 457.80731225013733, 458.9562575817108, 465.8347806930542, 472.8024277687073, 479.8846616744995, 486.9299142360687, 488.0605676174164, 489.18218994140625, 490.35751152038574, 491.65289998054504, 492.91043639183044, 494.0121395587921, 495.17079424858093, 496.36185789108276, 497.51668643951416, 498.81576132774353, 500.04236221313477, 501.24887108802795, 502.4362106323242, 503.60113048553467, 504.8128311634064, 505.9840819835663, 507.1195602416992, 508.20137190818787, 509.39882373809814, 510.6490750312805, 517.3401973247528, 523.6549637317657]
[20.0, 28.12, 32.32, 40.5, 47.98, 58.12, 67.14, 71.98, 77.18, 79.72, 80.22, 82.44, 85.82, 87.58, 90.4, 90.82, 90.96, 91.0, 91.64, 91.54, 92.0, 92.2, 92.46, 92.5, 92.66, 92.54, 92.86, 94.24, 94.24, 94.34, 94.28, 94.08, 94.32, 94.44, 94.52, 94.42, 94.3, 94.66, 94.68, 94.56, 94.5, 94.66, 95.12, 95.02, 94.98, 95.16, 94.56, 94.5, 94.94, 94.82, 94.9, 95.14, 94.92, 94.96, 95.0, 95.08, 94.72, 95.18, 94.86, 94.94, 94.84, 94.94, 94.94, 94.9, 94.88, 95.2, 94.98, 95.18, 95.28, 95.24, 95.3, 95.22, 95.38, 95.16, 95.26, 95.02, 94.98, 95.1, 95.12, 95.3, 95.48, 95.52, 95.46, 95.5, 95.52, 95.48, 95.44, 95.48, 95.46, 95.5, 95.54, 95.54, 95.5, 95.54, 95.58, 95.54, 95.52, 95.56, 95.52, 95.54, 95.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.291, Test loss: 2.288, Test accuracy: 19.88
Round   0, Global train loss: 2.291, Global test loss: 2.299, Global test accuracy: 18.36
Round   1, Train loss: 2.188, Test loss: 2.198, Test accuracy: 37.92
Round   1, Global train loss: 2.188, Global test loss: 2.237, Global test accuracy: 35.62
Round   2, Train loss: 2.074, Test loss: 2.136, Test accuracy: 35.38
Round   2, Global train loss: 2.074, Global test loss: 2.187, Global test accuracy: 29.96
Round   3, Train loss: 2.207, Test loss: 2.082, Test accuracy: 41.82
Round   3, Global train loss: 2.207, Global test loss: 2.192, Global test accuracy: 27.80
Round   4, Train loss: 1.950, Test loss: 2.028, Test accuracy: 45.08
Round   4, Global train loss: 1.950, Global test loss: 2.200, Global test accuracy: 22.76
Round   5, Train loss: 1.817, Test loss: 1.997, Test accuracy: 48.82
Round   5, Global train loss: 1.817, Global test loss: 2.141, Global test accuracy: 37.84
Round   6, Train loss: 1.877, Test loss: 1.933, Test accuracy: 56.16
Round   6, Global train loss: 1.877, Global test loss: 2.104, Global test accuracy: 33.22
Round   7, Train loss: 1.920, Test loss: 1.929, Test accuracy: 55.40
Round   7, Global train loss: 1.920, Global test loss: 2.086, Global test accuracy: 36.74
Round   8, Train loss: 2.178, Test loss: 1.921, Test accuracy: 56.40
Round   8, Global train loss: 2.178, Global test loss: 2.245, Global test accuracy: 18.00
Round   9, Train loss: 1.952, Test loss: 1.917, Test accuracy: 57.68
Round   9, Global train loss: 1.952, Global test loss: 2.101, Global test accuracy: 37.16
Round  10, Train loss: 2.037, Test loss: 1.910, Test accuracy: 58.62
Round  10, Global train loss: 2.037, Global test loss: 2.228, Global test accuracy: 21.20
Round  11, Train loss: 1.833, Test loss: 1.919, Test accuracy: 57.14
Round  11, Global train loss: 1.833, Global test loss: 2.186, Global test accuracy: 24.38
Round  12, Train loss: 1.785, Test loss: 1.908, Test accuracy: 57.34
Round  12, Global train loss: 1.785, Global test loss: 2.054, Global test accuracy: 39.62
Round  13, Train loss: 2.113, Test loss: 1.897, Test accuracy: 58.46
Round  13, Global train loss: 2.113, Global test loss: 2.216, Global test accuracy: 18.06
Round  14, Train loss: 1.732, Test loss: 1.899, Test accuracy: 58.16
Round  14, Global train loss: 1.732, Global test loss: 2.022, Global test accuracy: 42.34
Round  15, Train loss: 1.957, Test loss: 1.900, Test accuracy: 57.24
Round  15, Global train loss: 1.957, Global test loss: 2.143, Global test accuracy: 39.36
Round  16, Train loss: 1.845, Test loss: 1.902, Test accuracy: 56.84
Round  16, Global train loss: 1.845, Global test loss: 2.052, Global test accuracy: 42.26
Round  17, Train loss: 1.943, Test loss: 1.878, Test accuracy: 58.98
Round  17, Global train loss: 1.943, Global test loss: 2.034, Global test accuracy: 46.64
Round  18, Train loss: 1.847, Test loss: 1.879, Test accuracy: 58.56
Round  18, Global train loss: 1.847, Global test loss: 2.046, Global test accuracy: 41.98
Round  19, Train loss: 1.637, Test loss: 1.879, Test accuracy: 58.48
Round  19, Global train loss: 1.637, Global test loss: 2.034, Global test accuracy: 44.78
Round  20, Train loss: 1.844, Test loss: 1.878, Test accuracy: 58.84
Round  20, Global train loss: 1.844, Global test loss: 2.135, Global test accuracy: 39.68
Round  21, Train loss: 2.040, Test loss: 1.877, Test accuracy: 59.46
Round  21, Global train loss: 2.040, Global test loss: 2.137, Global test accuracy: 29.14
Round  22, Train loss: 1.895, Test loss: 1.881, Test accuracy: 58.94
Round  22, Global train loss: 1.895, Global test loss: 2.077, Global test accuracy: 40.54
Round  23, Train loss: 1.805, Test loss: 1.883, Test accuracy: 58.62
Round  23, Global train loss: 1.805, Global test loss: 2.068, Global test accuracy: 38.04
Round  24, Train loss: 1.858, Test loss: 1.876, Test accuracy: 58.74
Round  24, Global train loss: 1.858, Global test loss: 2.049, Global test accuracy: 45.22
Round  25, Train loss: 1.971, Test loss: 1.872, Test accuracy: 59.80
Round  25, Global train loss: 1.971, Global test loss: 2.163, Global test accuracy: 29.36
Round  26, Train loss: 1.867, Test loss: 1.859, Test accuracy: 63.06
Round  26, Global train loss: 1.867, Global test loss: 2.078, Global test accuracy: 37.80
Round  27, Train loss: 1.784, Test loss: 1.864, Test accuracy: 62.70
Round  27, Global train loss: 1.784, Global test loss: 2.128, Global test accuracy: 33.10
Round  28, Train loss: 1.754, Test loss: 1.870, Test accuracy: 62.04
Round  28, Global train loss: 1.754, Global test loss: 2.049, Global test accuracy: 38.92
Round  29, Train loss: 1.830, Test loss: 1.871, Test accuracy: 61.98
Round  29, Global train loss: 1.830, Global test loss: 2.134, Global test accuracy: 38.42
Round  30, Train loss: 1.687, Test loss: 1.873, Test accuracy: 61.66
Round  30, Global train loss: 1.687, Global test loss: 1.989, Global test accuracy: 45.20
Round  31, Train loss: 1.612, Test loss: 1.866, Test accuracy: 62.34
Round  31, Global train loss: 1.612, Global test loss: 2.129, Global test accuracy: 36.28
Round  32, Train loss: 2.048, Test loss: 1.853, Test accuracy: 62.24
Round  32, Global train loss: 2.048, Global test loss: 2.226, Global test accuracy: 19.20
Round  33, Train loss: 1.821, Test loss: 1.852, Test accuracy: 62.38
Round  33, Global train loss: 1.821, Global test loss: 2.063, Global test accuracy: 41.08
Round  34, Train loss: 1.970, Test loss: 1.853, Test accuracy: 61.74
Round  34, Global train loss: 1.970, Global test loss: 2.072, Global test accuracy: 39.76
Round  35, Train loss: 1.837, Test loss: 1.853, Test accuracy: 61.60
Round  35, Global train loss: 1.837, Global test loss: 2.155, Global test accuracy: 28.66
Round  36, Train loss: 1.811, Test loss: 1.853, Test accuracy: 62.20
Round  36, Global train loss: 1.811, Global test loss: 2.081, Global test accuracy: 37.94
Round  37, Train loss: 1.810, Test loss: 1.850, Test accuracy: 62.78
Round  37, Global train loss: 1.810, Global test loss: 2.069, Global test accuracy: 39.28
Round  38, Train loss: 1.783, Test loss: 1.845, Test accuracy: 62.52
Round  38, Global train loss: 1.783, Global test loss: 2.093, Global test accuracy: 34.88
Round  39, Train loss: 1.862, Test loss: 1.847, Test accuracy: 62.40
Round  39, Global train loss: 1.862, Global test loss: 2.181, Global test accuracy: 26.74
Round  40, Train loss: 1.797, Test loss: 1.851, Test accuracy: 61.78
Round  40, Global train loss: 1.797, Global test loss: 2.179, Global test accuracy: 24.66
Round  41, Train loss: 1.785, Test loss: 1.849, Test accuracy: 61.30
Round  41, Global train loss: 1.785, Global test loss: 2.149, Global test accuracy: 27.98
Round  42, Train loss: 1.728, Test loss: 1.847, Test accuracy: 61.40
Round  42, Global train loss: 1.728, Global test loss: 2.074, Global test accuracy: 37.10
Round  43, Train loss: 1.786, Test loss: 1.848, Test accuracy: 61.34
Round  43, Global train loss: 1.786, Global test loss: 2.080, Global test accuracy: 43.44
Round  44, Train loss: 1.659, Test loss: 1.846, Test accuracy: 61.24
Round  44, Global train loss: 1.659, Global test loss: 2.079, Global test accuracy: 36.88
Round  45, Train loss: 1.703, Test loss: 1.844, Test accuracy: 61.80
Round  45, Global train loss: 1.703, Global test loss: 2.041, Global test accuracy: 41.26
Round  46, Train loss: 1.712, Test loss: 1.848, Test accuracy: 61.44
Round  46, Global train loss: 1.712, Global test loss: 2.079, Global test accuracy: 37.22
Round  47, Train loss: 1.677, Test loss: 1.851, Test accuracy: 60.96
Round  47, Global train loss: 1.677, Global test loss: 2.125, Global test accuracy: 32.56
Round  48, Train loss: 1.735, Test loss: 1.852, Test accuracy: 60.74
Round  48, Global train loss: 1.735, Global test loss: 2.249, Global test accuracy: 18.76
Round  49, Train loss: 1.745, Test loss: 1.855, Test accuracy: 60.32
Round  49, Global train loss: 1.745, Global test loss: 2.045, Global test accuracy: 40.94
Round  50, Train loss: 1.609, Test loss: 1.848, Test accuracy: 61.12
Round  50, Global train loss: 1.609, Global test loss: 2.082, Global test accuracy: 36.44
Round  51, Train loss: 1.654, Test loss: 1.848, Test accuracy: 61.02
Round  51, Global train loss: 1.654, Global test loss: 2.008, Global test accuracy: 47.62
Round  52, Train loss: 1.753, Test loss: 1.853, Test accuracy: 60.56
Round  52, Global train loss: 1.753, Global test loss: 2.122, Global test accuracy: 45.42
Round  53, Train loss: 1.655, Test loss: 1.853, Test accuracy: 60.64
Round  53, Global train loss: 1.655, Global test loss: 2.095, Global test accuracy: 36.60
Round  54, Train loss: 1.816, Test loss: 1.852, Test accuracy: 60.74
Round  54, Global train loss: 1.816, Global test loss: 2.045, Global test accuracy: 44.38
Round  55, Train loss: 1.619, Test loss: 1.853, Test accuracy: 60.44
Round  55, Global train loss: 1.619, Global test loss: 2.036, Global test accuracy: 42.72
Round  56, Train loss: 1.699, Test loss: 1.852, Test accuracy: 60.76
Round  56, Global train loss: 1.699, Global test loss: 2.148, Global test accuracy: 28.46
Round  57, Train loss: 1.640, Test loss: 1.852, Test accuracy: 60.52
Round  57, Global train loss: 1.640, Global test loss: 2.144, Global test accuracy: 30.66
Round  58, Train loss: 1.790, Test loss: 1.854, Test accuracy: 60.36
Round  58, Global train loss: 1.790, Global test loss: 2.166, Global test accuracy: 29.44
Round  59, Train loss: 1.674, Test loss: 1.862, Test accuracy: 59.32
Round  59, Global train loss: 1.674, Global test loss: 2.204, Global test accuracy: 23.42
Round  60, Train loss: 1.657, Test loss: 1.862, Test accuracy: 59.32
Round  60, Global train loss: 1.657, Global test loss: 2.173, Global test accuracy: 25.82
Round  61, Train loss: 1.725, Test loss: 1.861, Test accuracy: 59.30
Round  61, Global train loss: 1.725, Global test loss: 2.200, Global test accuracy: 23.12
Round  62, Train loss: 1.740, Test loss: 1.861, Test accuracy: 59.34
Round  62, Global train loss: 1.740, Global test loss: 2.126, Global test accuracy: 32.86
Round  63, Train loss: 1.653, Test loss: 1.862, Test accuracy: 59.24
Round  63, Global train loss: 1.653, Global test loss: 2.058, Global test accuracy: 38.82
Round  64, Train loss: 1.715, Test loss: 1.864, Test accuracy: 59.20
Round  64, Global train loss: 1.715, Global test loss: 2.227, Global test accuracy: 21.30
Round  65, Train loss: 1.711, Test loss: 1.864, Test accuracy: 59.32
Round  65, Global train loss: 1.711, Global test loss: 2.119, Global test accuracy: 31.26
Round  66, Train loss: 1.566, Test loss: 1.867, Test accuracy: 59.00
Round  66, Global train loss: 1.566, Global test loss: 1.990, Global test accuracy: 49.84
Round  67, Train loss: 1.698, Test loss: 1.860, Test accuracy: 59.84
Round  67, Global train loss: 1.698, Global test loss: 2.152, Global test accuracy: 27.98
Round  68, Train loss: 1.654, Test loss: 1.861, Test accuracy: 59.66
Round  68, Global train loss: 1.654, Global test loss: 2.065, Global test accuracy: 38.42
Round  69, Train loss: 1.733, Test loss: 1.860, Test accuracy: 59.74
Round  69, Global train loss: 1.733, Global test loss: 2.066, Global test accuracy: 39.66
Round  70, Train loss: 1.681, Test loss: 1.861, Test accuracy: 59.58
Round  70, Global train loss: 1.681, Global test loss: 2.068, Global test accuracy: 38.12
Round  71, Train loss: 1.593, Test loss: 1.862, Test accuracy: 59.48
Round  71, Global train loss: 1.593, Global test loss: 1.961, Global test accuracy: 48.36
Round  72, Train loss: 1.576, Test loss: 1.863, Test accuracy: 59.34
Round  72, Global train loss: 1.576, Global test loss: 2.154, Global test accuracy: 27.26
Round  73, Train loss: 1.622, Test loss: 1.862, Test accuracy: 59.52
Round  73, Global train loss: 1.622, Global test loss: 2.041, Global test accuracy: 43.06
Round  74, Train loss: 1.746, Test loss: 1.864, Test accuracy: 59.26
Round  74, Global train loss: 1.746, Global test loss: 2.180, Global test accuracy: 25.86
Round  75, Train loss: 1.717, Test loss: 1.865, Test accuracy: 58.96
Round  75, Global train loss: 1.717, Global test loss: 2.073, Global test accuracy: 38.34
Round  76, Train loss: 1.690, Test loss: 1.863, Test accuracy: 59.18
Round  76, Global train loss: 1.690, Global test loss: 2.023, Global test accuracy: 42.78
Round  77, Train loss: 1.664, Test loss: 1.866, Test accuracy: 58.92
Round  77, Global train loss: 1.664, Global test loss: 2.059, Global test accuracy: 43.42
Round  78, Train loss: 1.755, Test loss: 1.866, Test accuracy: 58.88
Round  78, Global train loss: 1.755, Global test loss: 2.130, Global test accuracy: 33.24
Round  79, Train loss: 1.603, Test loss: 1.867, Test accuracy: 58.98
Round  79, Global train loss: 1.603, Global test loss: 2.014, Global test accuracy: 48.60
Round  80, Train loss: 1.590, Test loss: 1.867, Test accuracy: 59.00
Round  80, Global train loss: 1.590, Global test loss: 1.963, Global test accuracy: 47.80
Round  81, Train loss: 1.732, Test loss: 1.866, Test accuracy: 59.08
Round  81, Global train loss: 1.732, Global test loss: 2.034, Global test accuracy: 43.40
Round  82, Train loss: 1.683, Test loss: 1.862, Test accuracy: 59.52
Round  82, Global train loss: 1.683, Global test loss: 2.113, Global test accuracy: 32.68
Round  83, Train loss: 1.739, Test loss: 1.860, Test accuracy: 59.78
Round  83, Global train loss: 1.739, Global test loss: 2.153, Global test accuracy: 30.26
Round  84, Train loss: 1.590, Test loss: 1.860, Test accuracy: 59.68
Round  84, Global train loss: 1.590, Global test loss: 2.085, Global test accuracy: 35.00
Round  85, Train loss: 1.589, Test loss: 1.860, Test accuracy: 59.78
Round  85, Global train loss: 1.589, Global test loss: 2.123, Global test accuracy: 35.64
Round  86, Train loss: 1.650, Test loss: 1.860, Test accuracy: 59.68
Round  86, Global train loss: 1.650, Global test loss: 2.172, Global test accuracy: 26.44
Round  87, Train loss: 1.606, Test loss: 1.858, Test accuracy: 60.06
Round  87, Global train loss: 1.606, Global test loss: 2.235, Global test accuracy: 20.74
Round  88, Train loss: 1.707, Test loss: 1.858, Test accuracy: 60.04
Round  88, Global train loss: 1.707, Global test loss: 2.058, Global test accuracy: 38.82
Round  89, Train loss: 1.639, Test loss: 1.856, Test accuracy: 60.38
Round  89, Global train loss: 1.639, Global test loss: 2.069, Global test accuracy: 37.50
Round  90, Train loss: 1.635, Test loss: 1.854, Test accuracy: 60.54
Round  90, Global train loss: 1.635, Global test loss: 2.050, Global test accuracy: 40.76
Round  91, Train loss: 1.638, Test loss: 1.855, Test accuracy: 60.26
Round  91, Global train loss: 1.638, Global test loss: 2.227, Global test accuracy: 20.12
Round  92, Train loss: 1.580, Test loss: 1.856, Test accuracy: 60.14
Round  92, Global train loss: 1.580, Global test loss: 2.177, Global test accuracy: 25.26
Round  93, Train loss: 1.593, Test loss: 1.854, Test accuracy: 60.34
Round  93, Global train loss: 1.593, Global test loss: 2.068, Global test accuracy: 38.20
Round  94, Train loss: 1.631, Test loss: 1.857, Test accuracy: 60.02
Round  94, Global train loss: 1.631, Global test loss: 2.238, Global test accuracy: 16.60/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.546, Test loss: 1.856, Test accuracy: 60.02
Round  95, Global train loss: 1.546, Global test loss: 2.021, Global test accuracy: 43.72
Round  96, Train loss: 1.609, Test loss: 1.857, Test accuracy: 59.86
Round  96, Global train loss: 1.609, Global test loss: 2.011, Global test accuracy: 44.26
Round  97, Train loss: 1.553, Test loss: 1.857, Test accuracy: 59.92
Round  97, Global train loss: 1.553, Global test loss: 1.980, Global test accuracy: 50.30
Round  98, Train loss: 1.749, Test loss: 1.857, Test accuracy: 60.02
Round  98, Global train loss: 1.749, Global test loss: 2.140, Global test accuracy: 31.84
Round  99, Train loss: 1.554, Test loss: 1.854, Test accuracy: 60.32
Round  99, Global train loss: 1.554, Global test loss: 2.120, Global test accuracy: 32.78
Final Round, Train loss: 1.626, Test loss: 1.856, Test accuracy: 60.34
Final Round, Global train loss: 1.626, Global test loss: 2.120, Global test accuracy: 32.78
Average accuracy final 10 rounds: 60.144000000000005 

Average global accuracy final 10 rounds: 34.38400000000001 

658.5768802165985
[0.9657092094421387, 1.9314184188842773, 2.7211577892303467, 3.510897159576416, 4.3193371295928955, 5.127777099609375, 5.959397077560425, 6.791017055511475, 7.594115734100342, 8.397214412689209, 9.212653398513794, 10.028092384338379, 10.80824327468872, 11.588394165039062, 12.352400541305542, 13.116406917572021, 13.9117112159729, 14.70701551437378, 15.51938533782959, 16.3317551612854, 17.134716272354126, 17.93767738342285, 18.72041344642639, 19.50314950942993, 20.292303323745728, 21.081457138061523, 21.896434783935547, 22.71141242980957, 23.482757091522217, 24.254101753234863, 25.031792640686035, 25.809483528137207, 26.574321031570435, 27.339158535003662, 28.08233118057251, 28.825503826141357, 29.578673362731934, 30.33184289932251, 31.17961835861206, 32.02739381790161, 32.82061839103699, 33.61384296417236, 34.412561655044556, 35.21128034591675, 36.02770471572876, 36.84412908554077, 37.66908288002014, 38.49403667449951, 39.31170439720154, 40.129372119903564, 40.971842527389526, 41.81431293487549, 42.64623212814331, 43.47815132141113, 44.26941251754761, 45.06067371368408, 45.82421827316284, 46.5877628326416, 47.352431774139404, 48.11710071563721, 48.93264412879944, 49.74818754196167, 50.55012011528015, 51.35205268859863, 52.14326548576355, 52.93447828292847, 53.708165884017944, 54.48185348510742, 55.25702452659607, 56.03219556808472, 56.873337745666504, 57.71447992324829, 58.505598068237305, 59.29671621322632, 60.1418719291687, 60.987027645111084, 61.76317596435547, 62.53932428359985, 63.36178183555603, 64.1842393875122, 64.98814487457275, 65.7920503616333, 66.58763408660889, 67.38321781158447, 68.26417803764343, 69.14513826370239, 69.91477870941162, 70.68441915512085, 71.46143817901611, 72.23845720291138, 73.04754590988159, 73.8566346168518, 74.64052438735962, 75.42441415786743, 76.18823480606079, 76.95205545425415, 77.73619437217712, 78.5203332901001, 79.30444121360779, 80.08854913711548, 80.85173511505127, 81.61492109298706, 82.38746404647827, 83.16000699996948, 83.93721723556519, 84.71442747116089, 85.5032286643982, 86.2920298576355, 87.07378244400024, 87.85553503036499, 88.6229817867279, 89.39042854309082, 90.15839982032776, 90.9263710975647, 91.69354963302612, 92.46072816848755, 93.22479462623596, 93.98886108398438, 94.76320576667786, 95.53755044937134, 96.33345746994019, 97.12936449050903, 97.9001452922821, 98.67092609405518, 99.4574785232544, 100.24403095245361, 101.01903223991394, 101.79403352737427, 102.58169102668762, 103.36934852600098, 104.21832299232483, 105.06729745864868, 105.9519875049591, 106.83667755126953, 107.61990141868591, 108.4031252861023, 109.16684007644653, 109.93055486679077, 110.6896300315857, 111.44870519638062, 112.22921633720398, 113.00972747802734, 113.79790425300598, 114.58608102798462, 115.36158990859985, 116.13709878921509, 116.92054033279419, 117.70398187637329, 118.51539635658264, 119.32681083679199, 120.11619400978088, 120.90557718276978, 121.69187307357788, 122.47816896438599, 123.33305215835571, 124.18793535232544, 124.9957480430603, 125.80356073379517, 126.55040216445923, 127.29724359512329, 128.086008310318, 128.8747730255127, 129.63630199432373, 130.39783096313477, 131.17477083206177, 131.95171070098877, 132.73555159568787, 133.51939249038696, 134.30305814743042, 135.08672380447388, 135.88923931121826, 136.69175481796265, 137.45720982551575, 138.22266483306885, 139.00971126556396, 139.79675769805908, 140.58018565177917, 141.36361360549927, 142.13771200180054, 142.9118103981018, 143.69156527519226, 144.47132015228271, 145.24360370635986, 146.015887260437, 146.7827010154724, 147.5495147705078, 148.3676278591156, 149.1857409477234, 150.02126336097717, 150.85678577423096, 151.6687433719635, 152.48070096969604, 153.26410388946533, 154.04750680923462, 154.81686735153198, 155.58622789382935, 156.39873385429382, 157.2112398147583, 158.0400722026825, 158.8689045906067, 160.4262237548828, 161.98354291915894]
[19.88, 19.88, 37.92, 37.92, 35.38, 35.38, 41.82, 41.82, 45.08, 45.08, 48.82, 48.82, 56.16, 56.16, 55.4, 55.4, 56.4, 56.4, 57.68, 57.68, 58.62, 58.62, 57.14, 57.14, 57.34, 57.34, 58.46, 58.46, 58.16, 58.16, 57.24, 57.24, 56.84, 56.84, 58.98, 58.98, 58.56, 58.56, 58.48, 58.48, 58.84, 58.84, 59.46, 59.46, 58.94, 58.94, 58.62, 58.62, 58.74, 58.74, 59.8, 59.8, 63.06, 63.06, 62.7, 62.7, 62.04, 62.04, 61.98, 61.98, 61.66, 61.66, 62.34, 62.34, 62.24, 62.24, 62.38, 62.38, 61.74, 61.74, 61.6, 61.6, 62.2, 62.2, 62.78, 62.78, 62.52, 62.52, 62.4, 62.4, 61.78, 61.78, 61.3, 61.3, 61.4, 61.4, 61.34, 61.34, 61.24, 61.24, 61.8, 61.8, 61.44, 61.44, 60.96, 60.96, 60.74, 60.74, 60.32, 60.32, 61.12, 61.12, 61.02, 61.02, 60.56, 60.56, 60.64, 60.64, 60.74, 60.74, 60.44, 60.44, 60.76, 60.76, 60.52, 60.52, 60.36, 60.36, 59.32, 59.32, 59.32, 59.32, 59.3, 59.3, 59.34, 59.34, 59.24, 59.24, 59.2, 59.2, 59.32, 59.32, 59.0, 59.0, 59.84, 59.84, 59.66, 59.66, 59.74, 59.74, 59.58, 59.58, 59.48, 59.48, 59.34, 59.34, 59.52, 59.52, 59.26, 59.26, 58.96, 58.96, 59.18, 59.18, 58.92, 58.92, 58.88, 58.88, 58.98, 58.98, 59.0, 59.0, 59.08, 59.08, 59.52, 59.52, 59.78, 59.78, 59.68, 59.68, 59.78, 59.78, 59.68, 59.68, 60.06, 60.06, 60.04, 60.04, 60.38, 60.38, 60.54, 60.54, 60.26, 60.26, 60.14, 60.14, 60.34, 60.34, 60.02, 60.02, 60.02, 60.02, 59.86, 59.86, 59.92, 59.92, 60.02, 60.02, 60.32, 60.32, 60.34, 60.34]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.294, Test loss: 2.293, Test accuracy: 20.34
Round   0, Global train loss: 2.294, Global test loss: 2.298, Global test accuracy: 18.06
Round   1, Train loss: 2.278, Test loss: 2.268, Test accuracy: 21.12
Round   1, Global train loss: 2.278, Global test loss: 2.280, Global test accuracy: 18.00
Round   2, Train loss: 2.172, Test loss: 2.197, Test accuracy: 22.06
Round   2, Global train loss: 2.172, Global test loss: 2.204, Global test accuracy: 18.02
Round   3, Train loss: 2.108, Test loss: 2.097, Test accuracy: 35.88
Round   3, Global train loss: 2.108, Global test loss: 2.103, Global test accuracy: 32.00
Round   4, Train loss: 2.106, Test loss: 2.030, Test accuracy: 45.32
Round   4, Global train loss: 2.106, Global test loss: 2.072, Global test accuracy: 41.92
Round   5, Train loss: 1.967, Test loss: 1.993, Test accuracy: 48.94
Round   5, Global train loss: 1.967, Global test loss: 2.002, Global test accuracy: 45.12
Round   6, Train loss: 2.170, Test loss: 1.962, Test accuracy: 52.88
Round   6, Global train loss: 2.170, Global test loss: 2.040, Global test accuracy: 42.42
Round   7, Train loss: 1.919, Test loss: 1.947, Test accuracy: 54.20
Round   7, Global train loss: 1.919, Global test loss: 1.966, Global test accuracy: 51.32
Round   8, Train loss: 2.010, Test loss: 1.891, Test accuracy: 60.82
Round   8, Global train loss: 2.010, Global test loss: 2.022, Global test accuracy: 43.40
Round   9, Train loss: 1.973, Test loss: 1.884, Test accuracy: 61.10
Round   9, Global train loss: 1.973, Global test loss: 1.974, Global test accuracy: 47.66
Round  10, Train loss: 2.115, Test loss: 1.867, Test accuracy: 61.64
Round  10, Global train loss: 2.115, Global test loss: 1.956, Global test accuracy: 49.30
Round  11, Train loss: 1.974, Test loss: 1.854, Test accuracy: 62.98
Round  11, Global train loss: 1.974, Global test loss: 1.933, Global test accuracy: 51.66
Round  12, Train loss: 2.065, Test loss: 1.843, Test accuracy: 64.18
Round  12, Global train loss: 2.065, Global test loss: 1.922, Global test accuracy: 56.18
Round  13, Train loss: 1.907, Test loss: 1.834, Test accuracy: 65.32
Round  13, Global train loss: 1.907, Global test loss: 1.928, Global test accuracy: 53.44
Round  14, Train loss: 2.008, Test loss: 1.827, Test accuracy: 65.74
Round  14, Global train loss: 2.008, Global test loss: 1.904, Global test accuracy: 58.18
Round  15, Train loss: 2.037, Test loss: 1.826, Test accuracy: 65.76
Round  15, Global train loss: 2.037, Global test loss: 1.922, Global test accuracy: 54.98
Round  16, Train loss: 1.736, Test loss: 1.821, Test accuracy: 66.14
Round  16, Global train loss: 1.736, Global test loss: 1.894, Global test accuracy: 58.74
Round  17, Train loss: 2.138, Test loss: 1.798, Test accuracy: 68.10
Round  17, Global train loss: 2.138, Global test loss: 1.912, Global test accuracy: 54.82
Round  18, Train loss: 2.041, Test loss: 1.799, Test accuracy: 67.84
Round  18, Global train loss: 2.041, Global test loss: 1.964, Global test accuracy: 48.32
Round  19, Train loss: 1.978, Test loss: 1.795, Test accuracy: 68.00
Round  19, Global train loss: 1.978, Global test loss: 1.883, Global test accuracy: 59.08
Round  20, Train loss: 2.116, Test loss: 1.796, Test accuracy: 67.92
Round  20, Global train loss: 2.116, Global test loss: 1.901, Global test accuracy: 57.00
Round  21, Train loss: 1.877, Test loss: 1.795, Test accuracy: 67.94
Round  21, Global train loss: 1.877, Global test loss: 1.853, Global test accuracy: 62.32
Round  22, Train loss: 1.944, Test loss: 1.800, Test accuracy: 67.40
Round  22, Global train loss: 1.944, Global test loss: 1.909, Global test accuracy: 56.58
Round  23, Train loss: 1.872, Test loss: 1.805, Test accuracy: 66.70
Round  23, Global train loss: 1.872, Global test loss: 1.859, Global test accuracy: 61.72
Round  24, Train loss: 1.867, Test loss: 1.801, Test accuracy: 67.02
Round  24, Global train loss: 1.867, Global test loss: 1.855, Global test accuracy: 62.74
Round  25, Train loss: 1.923, Test loss: 1.810, Test accuracy: 65.54
Round  25, Global train loss: 1.923, Global test loss: 1.912, Global test accuracy: 57.34
Round  26, Train loss: 1.963, Test loss: 1.810, Test accuracy: 65.60
Round  26, Global train loss: 1.963, Global test loss: 1.877, Global test accuracy: 58.94
Round  27, Train loss: 1.911, Test loss: 1.807, Test accuracy: 65.72
Round  27, Global train loss: 1.911, Global test loss: 1.895, Global test accuracy: 59.10
Round  28, Train loss: 2.051, Test loss: 1.808, Test accuracy: 65.76
Round  28, Global train loss: 2.051, Global test loss: 1.881, Global test accuracy: 57.92
Round  29, Train loss: 2.101, Test loss: 1.809, Test accuracy: 65.64
Round  29, Global train loss: 2.101, Global test loss: 1.882, Global test accuracy: 58.32
Round  30, Train loss: 1.957, Test loss: 1.807, Test accuracy: 65.80
Round  30, Global train loss: 1.957, Global test loss: 1.871, Global test accuracy: 59.56
Round  31, Train loss: 1.774, Test loss: 1.802, Test accuracy: 67.00
Round  31, Global train loss: 1.774, Global test loss: 1.849, Global test accuracy: 63.10
Round  32, Train loss: 1.878, Test loss: 1.778, Test accuracy: 69.50
Round  32, Global train loss: 1.878, Global test loss: 1.836, Global test accuracy: 64.84
Round  33, Train loss: 1.915, Test loss: 1.775, Test accuracy: 69.92
Round  33, Global train loss: 1.915, Global test loss: 1.879, Global test accuracy: 59.50
Round  34, Train loss: 1.951, Test loss: 1.776, Test accuracy: 69.94
Round  34, Global train loss: 1.951, Global test loss: 1.876, Global test accuracy: 60.30
Round  35, Train loss: 2.101, Test loss: 1.770, Test accuracy: 70.56
Round  35, Global train loss: 2.101, Global test loss: 1.878, Global test accuracy: 59.92
Round  36, Train loss: 1.968, Test loss: 1.771, Test accuracy: 70.14
Round  36, Global train loss: 1.968, Global test loss: 1.903, Global test accuracy: 56.50
Round  37, Train loss: 1.927, Test loss: 1.782, Test accuracy: 69.26
Round  37, Global train loss: 1.927, Global test loss: 1.851, Global test accuracy: 61.24
Round  38, Train loss: 1.915, Test loss: 1.770, Test accuracy: 70.28
Round  38, Global train loss: 1.915, Global test loss: 1.868, Global test accuracy: 60.02
Round  39, Train loss: 1.892, Test loss: 1.763, Test accuracy: 71.20
Round  39, Global train loss: 1.892, Global test loss: 1.942, Global test accuracy: 51.74
Round  40, Train loss: 2.046, Test loss: 1.762, Test accuracy: 71.28
Round  40, Global train loss: 2.046, Global test loss: 1.846, Global test accuracy: 63.16
Round  41, Train loss: 1.930, Test loss: 1.761, Test accuracy: 71.16
Round  41, Global train loss: 1.930, Global test loss: 1.870, Global test accuracy: 58.64
Round  42, Train loss: 1.897, Test loss: 1.757, Test accuracy: 71.66
Round  42, Global train loss: 1.897, Global test loss: 1.829, Global test accuracy: 63.80
Round  43, Train loss: 1.913, Test loss: 1.755, Test accuracy: 71.72
Round  43, Global train loss: 1.913, Global test loss: 1.842, Global test accuracy: 62.28
Round  44, Train loss: 1.964, Test loss: 1.756, Test accuracy: 71.34
Round  44, Global train loss: 1.964, Global test loss: 1.819, Global test accuracy: 65.30
Round  45, Train loss: 1.731, Test loss: 1.749, Test accuracy: 71.78
Round  45, Global train loss: 1.731, Global test loss: 1.790, Global test accuracy: 68.28
Round  46, Train loss: 1.895, Test loss: 1.748, Test accuracy: 72.06
Round  46, Global train loss: 1.895, Global test loss: 1.822, Global test accuracy: 64.88
Round  47, Train loss: 2.030, Test loss: 1.747, Test accuracy: 72.04
Round  47, Global train loss: 2.030, Global test loss: 1.817, Global test accuracy: 65.54
Round  48, Train loss: 1.907, Test loss: 1.754, Test accuracy: 71.20
Round  48, Global train loss: 1.907, Global test loss: 1.809, Global test accuracy: 66.66
Round  49, Train loss: 1.599, Test loss: 1.754, Test accuracy: 71.26
Round  49, Global train loss: 1.599, Global test loss: 1.832, Global test accuracy: 62.38
Round  50, Train loss: 1.850, Test loss: 1.746, Test accuracy: 71.98
Round  50, Global train loss: 1.850, Global test loss: 1.771, Global test accuracy: 69.98
Round  51, Train loss: 1.895, Test loss: 1.756, Test accuracy: 70.74
Round  51, Global train loss: 1.895, Global test loss: 1.776, Global test accuracy: 69.76
Round  52, Train loss: 1.860, Test loss: 1.752, Test accuracy: 71.18
Round  52, Global train loss: 1.860, Global test loss: 1.786, Global test accuracy: 68.54
Round  53, Train loss: 2.006, Test loss: 1.752, Test accuracy: 71.08
Round  53, Global train loss: 2.006, Global test loss: 1.800, Global test accuracy: 66.94
Round  54, Train loss: 1.888, Test loss: 1.757, Test accuracy: 70.30
Round  54, Global train loss: 1.888, Global test loss: 1.827, Global test accuracy: 63.96
Round  55, Train loss: 1.919, Test loss: 1.750, Test accuracy: 71.18
Round  55, Global train loss: 1.919, Global test loss: 1.851, Global test accuracy: 61.48
Round  56, Train loss: 1.883, Test loss: 1.749, Test accuracy: 71.28
Round  56, Global train loss: 1.883, Global test loss: 1.832, Global test accuracy: 63.02
Round  57, Train loss: 1.874, Test loss: 1.755, Test accuracy: 70.56
Round  57, Global train loss: 1.874, Global test loss: 1.820, Global test accuracy: 65.08
Round  58, Train loss: 1.889, Test loss: 1.749, Test accuracy: 71.32
Round  58, Global train loss: 1.889, Global test loss: 1.786, Global test accuracy: 68.66
Round  59, Train loss: 1.687, Test loss: 1.752, Test accuracy: 71.22
Round  59, Global train loss: 1.687, Global test loss: 1.790, Global test accuracy: 67.84
Round  60, Train loss: 1.820, Test loss: 1.749, Test accuracy: 71.58
Round  60, Global train loss: 1.820, Global test loss: 1.771, Global test accuracy: 70.22
Round  61, Train loss: 1.966, Test loss: 1.759, Test accuracy: 70.50
Round  61, Global train loss: 1.966, Global test loss: 1.897, Global test accuracy: 55.62
Round  62, Train loss: 1.828, Test loss: 1.748, Test accuracy: 71.50
Round  62, Global train loss: 1.828, Global test loss: 1.891, Global test accuracy: 56.38
Round  63, Train loss: 1.777, Test loss: 1.758, Test accuracy: 70.50
Round  63, Global train loss: 1.777, Global test loss: 1.778, Global test accuracy: 68.90
Round  64, Train loss: 1.703, Test loss: 1.751, Test accuracy: 71.34
Round  64, Global train loss: 1.703, Global test loss: 1.781, Global test accuracy: 68.84
Round  65, Train loss: 1.727, Test loss: 1.745, Test accuracy: 71.92
Round  65, Global train loss: 1.727, Global test loss: 1.769, Global test accuracy: 69.94
Round  66, Train loss: 1.791, Test loss: 1.746, Test accuracy: 71.72
Round  66, Global train loss: 1.791, Global test loss: 1.765, Global test accuracy: 70.38
Round  67, Train loss: 1.899, Test loss: 1.746, Test accuracy: 71.60
Round  67, Global train loss: 1.899, Global test loss: 1.776, Global test accuracy: 68.90
Round  68, Train loss: 1.888, Test loss: 1.747, Test accuracy: 71.60
Round  68, Global train loss: 1.888, Global test loss: 1.780, Global test accuracy: 68.40
Round  69, Train loss: 1.985, Test loss: 1.748, Test accuracy: 71.50
Round  69, Global train loss: 1.985, Global test loss: 1.797, Global test accuracy: 66.60
Round  70, Train loss: 1.784, Test loss: 1.748, Test accuracy: 71.38
Round  70, Global train loss: 1.784, Global test loss: 1.822, Global test accuracy: 64.08
Round  71, Train loss: 1.895, Test loss: 1.748, Test accuracy: 71.40
Round  71, Global train loss: 1.895, Global test loss: 1.761, Global test accuracy: 70.54
Round  72, Train loss: 1.818, Test loss: 1.747, Test accuracy: 71.54
Round  72, Global train loss: 1.818, Global test loss: 1.796, Global test accuracy: 66.56
Round  73, Train loss: 1.873, Test loss: 1.753, Test accuracy: 70.92
Round  73, Global train loss: 1.873, Global test loss: 1.776, Global test accuracy: 69.26
Round  74, Train loss: 1.820, Test loss: 1.749, Test accuracy: 71.44
Round  74, Global train loss: 1.820, Global test loss: 1.856, Global test accuracy: 60.46
Round  75, Train loss: 1.733, Test loss: 1.745, Test accuracy: 71.94
Round  75, Global train loss: 1.733, Global test loss: 1.767, Global test accuracy: 70.02
Round  76, Train loss: 1.752, Test loss: 1.746, Test accuracy: 71.82
Round  76, Global train loss: 1.752, Global test loss: 1.752, Global test accuracy: 71.58
Round  77, Train loss: 1.841, Test loss: 1.748, Test accuracy: 71.58
Round  77, Global train loss: 1.841, Global test loss: 1.788, Global test accuracy: 67.54
Round  78, Train loss: 1.858, Test loss: 1.750, Test accuracy: 71.40
Round  78, Global train loss: 1.858, Global test loss: 1.777, Global test accuracy: 69.00
Round  79, Train loss: 1.667, Test loss: 1.751, Test accuracy: 71.22
Round  79, Global train loss: 1.667, Global test loss: 1.771, Global test accuracy: 69.44
Round  80, Train loss: 1.892, Test loss: 1.750, Test accuracy: 71.34
Round  80, Global train loss: 1.892, Global test loss: 1.762, Global test accuracy: 70.54
Round  81, Train loss: 1.842, Test loss: 1.756, Test accuracy: 70.62
Round  81, Global train loss: 1.842, Global test loss: 1.810, Global test accuracy: 65.38
Round  82, Train loss: 1.762, Test loss: 1.756, Test accuracy: 70.72
Round  82, Global train loss: 1.762, Global test loss: 1.775, Global test accuracy: 69.18
Round  83, Train loss: 1.803, Test loss: 1.749, Test accuracy: 71.60
Round  83, Global train loss: 1.803, Global test loss: 1.828, Global test accuracy: 63.82
Round  84, Train loss: 1.847, Test loss: 1.753, Test accuracy: 71.08
Round  84, Global train loss: 1.847, Global test loss: 1.817, Global test accuracy: 64.82
Round  85, Train loss: 1.645, Test loss: 1.748, Test accuracy: 71.60
Round  85, Global train loss: 1.645, Global test loss: 1.774, Global test accuracy: 69.62
Round  86, Train loss: 1.772, Test loss: 1.743, Test accuracy: 72.08
Round  86, Global train loss: 1.772, Global test loss: 1.789, Global test accuracy: 67.94
Round  87, Train loss: 1.930, Test loss: 1.750, Test accuracy: 71.38
Round  87, Global train loss: 1.930, Global test loss: 1.852, Global test accuracy: 60.66
Round  88, Train loss: 1.689, Test loss: 1.753, Test accuracy: 71.22
Round  88, Global train loss: 1.689, Global test loss: 1.773, Global test accuracy: 69.06
Round  89, Train loss: 1.873, Test loss: 1.753, Test accuracy: 71.22
Round  89, Global train loss: 1.873, Global test loss: 1.776, Global test accuracy: 69.40
Round  90, Train loss: 1.572, Test loss: 1.753, Test accuracy: 71.06
Round  90, Global train loss: 1.572, Global test loss: 1.803, Global test accuracy: 65.66
Round  91, Train loss: 1.806, Test loss: 1.757, Test accuracy: 70.70
Round  91, Global train loss: 1.806, Global test loss: 1.826, Global test accuracy: 63.52
Round  92, Train loss: 1.862, Test loss: 1.763, Test accuracy: 70.04
Round  92, Global train loss: 1.862, Global test loss: 1.769, Global test accuracy: 69.42
Round  93, Train loss: 1.919, Test loss: 1.759, Test accuracy: 70.54
Round  93, Global train loss: 1.919, Global test loss: 1.787, Global test accuracy: 67.80
Round  94, Train loss: 1.791, Test loss: 1.756, Test accuracy: 70.88
Round  94, Global train loss: 1.791, Global test loss: 1.826, Global test accuracy: 63.78/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  95, Train loss: 1.686, Test loss: 1.757, Test accuracy: 70.60
Round  95, Global train loss: 1.686, Global test loss: 1.772, Global test accuracy: 69.26
Round  96, Train loss: 1.719, Test loss: 1.760, Test accuracy: 70.40
Round  96, Global train loss: 1.719, Global test loss: 1.774, Global test accuracy: 68.86
Round  97, Train loss: 1.777, Test loss: 1.758, Test accuracy: 70.66
Round  97, Global train loss: 1.777, Global test loss: 1.771, Global test accuracy: 69.56
Round  98, Train loss: 1.681, Test loss: 1.755, Test accuracy: 70.90
Round  98, Global train loss: 1.681, Global test loss: 1.779, Global test accuracy: 68.54
Round  99, Train loss: 1.963, Test loss: 1.765, Test accuracy: 69.92
Round  99, Global train loss: 1.963, Global test loss: 1.823, Global test accuracy: 64.30
Final Round, Train loss: 1.792, Test loss: 1.768, Test accuracy: 69.48
Final Round, Global train loss: 1.792, Global test loss: 1.823, Global test accuracy: 64.30
Average accuracy final 10 rounds: 70.57000000000001 

Average global accuracy final 10 rounds: 67.07000000000001 

674.4883160591125
[0.8827574253082275, 1.765514850616455, 2.5256996154785156, 3.285884380340576, 4.106088161468506, 4.9262919425964355, 5.759613990783691, 6.592936038970947, 7.364295244216919, 8.13565444946289, 8.942238569259644, 9.748822689056396, 10.538203477859497, 11.327584266662598, 12.107762336730957, 12.887940406799316, 13.665093421936035, 14.442246437072754, 15.262849807739258, 16.08345317840576, 16.877025604248047, 17.670598030090332, 18.492804527282715, 19.315011024475098, 20.122495412826538, 20.92997980117798, 21.713943481445312, 22.497907161712646, 23.299493312835693, 24.10107946395874, 24.889252424240112, 25.677425384521484, 26.474438190460205, 27.271450996398926, 28.110580682754517, 28.949710369110107, 29.732882976531982, 30.516055583953857, 31.322184801101685, 32.12831401824951, 32.93859553337097, 33.74887704849243, 34.55790686607361, 35.366936683654785, 36.1556499004364, 36.94436311721802, 37.734867334365845, 38.52537155151367, 39.30540442466736, 40.085437297821045, 40.8773512840271, 41.669265270233154, 42.501245975494385, 43.333226680755615, 44.14170598983765, 44.95018529891968, 45.756386280059814, 46.56258726119995, 47.34963345527649, 48.13667964935303, 48.93063735961914, 49.724595069885254, 50.61884093284607, 51.513086795806885, 52.31089901924133, 53.10871124267578, 53.95102024078369, 54.7933292388916, 55.59784817695618, 56.40236711502075, 57.203805923461914, 58.005244731903076, 58.793954610824585, 59.582664489746094, 60.41315293312073, 61.24364137649536, 62.090961933135986, 62.93828248977661, 63.748719930648804, 64.559157371521, 65.36759209632874, 66.17602682113647, 67.04478764533997, 67.91354846954346, 68.70975613594055, 69.50596380233765, 70.3723156452179, 71.23866748809814, 72.09384632110596, 72.94902515411377, 73.77554631233215, 74.60206747055054, 75.46729516983032, 76.33252286911011, 77.19824075698853, 78.06395864486694, 78.95035123825073, 79.83674383163452, 80.71754574775696, 81.5983476638794, 82.42680025100708, 83.25525283813477, 84.15472197532654, 85.05419111251831, 85.93985438346863, 86.82551765441895, 87.65900754928589, 88.49249744415283, 89.40849280357361, 90.32448816299438, 91.11545085906982, 91.90641355514526, 92.69100499153137, 93.47559642791748, 94.27262043952942, 95.06964445114136, 95.8760302066803, 96.68241596221924, 97.48669099807739, 98.29096603393555, 99.10694980621338, 99.92293357849121, 100.74218034744263, 101.56142711639404, 102.41339707374573, 103.26536703109741, 104.0853099822998, 104.9052529335022, 105.72776484489441, 106.55027675628662, 107.3724410533905, 108.19460535049438, 109.03546380996704, 109.8763222694397, 110.67635202407837, 111.47638177871704, 112.26451063156128, 113.05263948440552, 113.98302555084229, 114.91341161727905, 115.75024580955505, 116.58708000183105, 117.40896320343018, 118.2308464050293, 119.04844284057617, 119.86603927612305, 120.66337156295776, 121.46070384979248, 122.33244848251343, 123.20419311523438, 124.06037926673889, 124.91656541824341, 125.73199558258057, 126.54742574691772, 127.47317218780518, 128.39891862869263, 129.24918818473816, 130.0994577407837, 130.99727773666382, 131.89509773254395, 132.77516555786133, 133.6552333831787, 134.49488496780396, 135.3345365524292, 136.21415901184082, 137.09378147125244, 137.88164472579956, 138.66950798034668, 139.50193309783936, 140.33435821533203, 141.20390582084656, 142.07345342636108, 142.91708040237427, 143.76070737838745, 144.57327699661255, 145.38584661483765, 146.21372032165527, 147.0415940284729, 147.84442043304443, 148.64724683761597, 149.470294713974, 150.29334259033203, 151.11475896835327, 151.9361753463745, 152.78025460243225, 153.62433385849, 154.47264432907104, 155.3209547996521, 156.1471073627472, 156.97325992584229, 157.80822134017944, 158.6431827545166, 159.4829294681549, 160.3226761817932, 161.08398699760437, 161.84529781341553, 162.66052269935608, 163.47574758529663, 164.3008313179016, 165.1259150505066, 166.81326913833618, 168.50062322616577]
[20.34, 20.34, 21.12, 21.12, 22.06, 22.06, 35.88, 35.88, 45.32, 45.32, 48.94, 48.94, 52.88, 52.88, 54.2, 54.2, 60.82, 60.82, 61.1, 61.1, 61.64, 61.64, 62.98, 62.98, 64.18, 64.18, 65.32, 65.32, 65.74, 65.74, 65.76, 65.76, 66.14, 66.14, 68.1, 68.1, 67.84, 67.84, 68.0, 68.0, 67.92, 67.92, 67.94, 67.94, 67.4, 67.4, 66.7, 66.7, 67.02, 67.02, 65.54, 65.54, 65.6, 65.6, 65.72, 65.72, 65.76, 65.76, 65.64, 65.64, 65.8, 65.8, 67.0, 67.0, 69.5, 69.5, 69.92, 69.92, 69.94, 69.94, 70.56, 70.56, 70.14, 70.14, 69.26, 69.26, 70.28, 70.28, 71.2, 71.2, 71.28, 71.28, 71.16, 71.16, 71.66, 71.66, 71.72, 71.72, 71.34, 71.34, 71.78, 71.78, 72.06, 72.06, 72.04, 72.04, 71.2, 71.2, 71.26, 71.26, 71.98, 71.98, 70.74, 70.74, 71.18, 71.18, 71.08, 71.08, 70.3, 70.3, 71.18, 71.18, 71.28, 71.28, 70.56, 70.56, 71.32, 71.32, 71.22, 71.22, 71.58, 71.58, 70.5, 70.5, 71.5, 71.5, 70.5, 70.5, 71.34, 71.34, 71.92, 71.92, 71.72, 71.72, 71.6, 71.6, 71.6, 71.6, 71.5, 71.5, 71.38, 71.38, 71.4, 71.4, 71.54, 71.54, 70.92, 70.92, 71.44, 71.44, 71.94, 71.94, 71.82, 71.82, 71.58, 71.58, 71.4, 71.4, 71.22, 71.22, 71.34, 71.34, 70.62, 70.62, 70.72, 70.72, 71.6, 71.6, 71.08, 71.08, 71.6, 71.6, 72.08, 72.08, 71.38, 71.38, 71.22, 71.22, 71.22, 71.22, 71.06, 71.06, 70.7, 70.7, 70.04, 70.04, 70.54, 70.54, 70.88, 70.88, 70.6, 70.6, 70.4, 70.4, 70.66, 70.66, 70.9, 70.9, 69.92, 69.92, 69.48, 69.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.297, Test loss: 2.297, Test accuracy: 13.42
Round   0, Global train loss: 2.297, Global test loss: 2.301, Global test accuracy: 9.54
Round   1, Train loss: 2.289, Test loss: 2.290, Test accuracy: 18.42
Round   1, Global train loss: 2.289, Global test loss: 2.298, Global test accuracy: 18.32
Round   2, Train loss: 2.278, Test loss: 2.273, Test accuracy: 22.94
Round   2, Global train loss: 2.278, Global test loss: 2.287, Global test accuracy: 18.00
Round   3, Train loss: 2.226, Test loss: 2.221, Test accuracy: 31.22
Round   3, Global train loss: 2.226, Global test loss: 2.257, Global test accuracy: 24.74
Round   4, Train loss: 2.061, Test loss: 2.158, Test accuracy: 36.18
Round   4, Global train loss: 2.061, Global test loss: 2.153, Global test accuracy: 41.06
Round   5, Train loss: 2.061, Test loss: 2.083, Test accuracy: 39.30
Round   5, Global train loss: 2.061, Global test loss: 2.069, Global test accuracy: 40.40
Round   6, Train loss: 2.067, Test loss: 2.046, Test accuracy: 44.98
Round   6, Global train loss: 2.067, Global test loss: 2.051, Global test accuracy: 46.36
Round   7, Train loss: 1.933, Test loss: 2.027, Test accuracy: 46.86
Round   7, Global train loss: 1.933, Global test loss: 2.002, Global test accuracy: 50.58
Round   8, Train loss: 2.015, Test loss: 1.976, Test accuracy: 52.40
Round   8, Global train loss: 2.015, Global test loss: 2.003, Global test accuracy: 46.72
Round   9, Train loss: 2.177, Test loss: 1.959, Test accuracy: 52.40
Round   9, Global train loss: 2.177, Global test loss: 2.048, Global test accuracy: 38.92
Round  10, Train loss: 2.001, Test loss: 1.942, Test accuracy: 53.80
Round  10, Global train loss: 2.001, Global test loss: 2.000, Global test accuracy: 46.78
Round  11, Train loss: 1.871, Test loss: 1.925, Test accuracy: 54.42
Round  11, Global train loss: 1.871, Global test loss: 1.945, Global test accuracy: 52.70
Round  12, Train loss: 2.117, Test loss: 1.924, Test accuracy: 54.24
Round  12, Global train loss: 2.117, Global test loss: 1.999, Global test accuracy: 45.56
Round  13, Train loss: 1.997, Test loss: 1.917, Test accuracy: 54.88
Round  13, Global train loss: 1.997, Global test loss: 1.935, Global test accuracy: 53.28
Round  14, Train loss: 2.026, Test loss: 1.916, Test accuracy: 55.02
Round  14, Global train loss: 2.026, Global test loss: 1.954, Global test accuracy: 51.10
Round  15, Train loss: 2.155, Test loss: 1.916, Test accuracy: 55.02
Round  15, Global train loss: 2.155, Global test loss: 1.966, Global test accuracy: 49.92
Round  16, Train loss: 1.978, Test loss: 1.916, Test accuracy: 54.98
Round  16, Global train loss: 1.978, Global test loss: 2.007, Global test accuracy: 44.28
Round  17, Train loss: 2.043, Test loss: 1.917, Test accuracy: 54.72
Round  17, Global train loss: 2.043, Global test loss: 1.960, Global test accuracy: 50.02
Round  18, Train loss: 2.038, Test loss: 1.916, Test accuracy: 54.84
Round  18, Global train loss: 2.038, Global test loss: 1.968, Global test accuracy: 49.68
Round  19, Train loss: 2.022, Test loss: 1.916, Test accuracy: 54.64
Round  19, Global train loss: 2.022, Global test loss: 1.955, Global test accuracy: 50.34
Round  20, Train loss: 2.027, Test loss: 1.914, Test accuracy: 54.72
Round  20, Global train loss: 2.027, Global test loss: 1.934, Global test accuracy: 53.16
Round  21, Train loss: 2.000, Test loss: 1.914, Test accuracy: 54.66
Round  21, Global train loss: 2.000, Global test loss: 1.946, Global test accuracy: 51.38
Round  22, Train loss: 1.766, Test loss: 1.900, Test accuracy: 56.46
Round  22, Global train loss: 1.766, Global test loss: 1.936, Global test accuracy: 52.48
Round  23, Train loss: 2.014, Test loss: 1.888, Test accuracy: 57.40
Round  23, Global train loss: 2.014, Global test loss: 1.937, Global test accuracy: 53.82
Round  24, Train loss: 2.002, Test loss: 1.887, Test accuracy: 57.48
Round  24, Global train loss: 2.002, Global test loss: 1.926, Global test accuracy: 53.50
Round  25, Train loss: 1.828, Test loss: 1.876, Test accuracy: 58.72
Round  25, Global train loss: 1.828, Global test loss: 1.884, Global test accuracy: 59.94
Round  26, Train loss: 2.076, Test loss: 1.865, Test accuracy: 59.88
Round  26, Global train loss: 2.076, Global test loss: 1.930, Global test accuracy: 53.84
Round  27, Train loss: 1.790, Test loss: 1.847, Test accuracy: 61.64
Round  27, Global train loss: 1.790, Global test loss: 1.875, Global test accuracy: 60.20
Round  28, Train loss: 1.953, Test loss: 1.838, Test accuracy: 62.84
Round  28, Global train loss: 1.953, Global test loss: 1.891, Global test accuracy: 58.12
Round  29, Train loss: 2.011, Test loss: 1.837, Test accuracy: 62.78
Round  29, Global train loss: 2.011, Global test loss: 1.886, Global test accuracy: 56.90
Round  30, Train loss: 1.760, Test loss: 1.837, Test accuracy: 62.78
Round  30, Global train loss: 1.760, Global test loss: 1.894, Global test accuracy: 56.30
Round  31, Train loss: 1.921, Test loss: 1.834, Test accuracy: 63.00
Round  31, Global train loss: 1.921, Global test loss: 1.900, Global test accuracy: 55.56
Round  32, Train loss: 2.166, Test loss: 1.832, Test accuracy: 63.18
Round  32, Global train loss: 2.166, Global test loss: 1.936, Global test accuracy: 52.38
Round  33, Train loss: 1.703, Test loss: 1.833, Test accuracy: 63.10
Round  33, Global train loss: 1.703, Global test loss: 1.882, Global test accuracy: 59.16
Round  34, Train loss: 1.996, Test loss: 1.841, Test accuracy: 62.14
Round  34, Global train loss: 1.996, Global test loss: 1.891, Global test accuracy: 57.56
Round  35, Train loss: 2.050, Test loss: 1.836, Test accuracy: 62.58
Round  35, Global train loss: 2.050, Global test loss: 1.901, Global test accuracy: 56.36
Round  36, Train loss: 2.045, Test loss: 1.833, Test accuracy: 62.98
Round  36, Global train loss: 2.045, Global test loss: 1.905, Global test accuracy: 56.16
Round  37, Train loss: 1.702, Test loss: 1.832, Test accuracy: 63.00
Round  37, Global train loss: 1.702, Global test loss: 1.873, Global test accuracy: 59.80
Round  38, Train loss: 1.845, Test loss: 1.832, Test accuracy: 63.10
Round  38, Global train loss: 1.845, Global test loss: 1.907, Global test accuracy: 54.60
Round  39, Train loss: 1.950, Test loss: 1.833, Test accuracy: 63.00
Round  39, Global train loss: 1.950, Global test loss: 1.907, Global test accuracy: 54.82
Round  40, Train loss: 2.014, Test loss: 1.834, Test accuracy: 62.94
Round  40, Global train loss: 2.014, Global test loss: 1.906, Global test accuracy: 54.82
Round  41, Train loss: 2.049, Test loss: 1.833, Test accuracy: 62.94
Round  41, Global train loss: 2.049, Global test loss: 1.881, Global test accuracy: 58.00
Round  42, Train loss: 1.836, Test loss: 1.834, Test accuracy: 62.86
Round  42, Global train loss: 1.836, Global test loss: 1.875, Global test accuracy: 58.92
Round  43, Train loss: 2.092, Test loss: 1.837, Test accuracy: 62.48
Round  43, Global train loss: 2.092, Global test loss: 1.882, Global test accuracy: 58.48
Round  44, Train loss: 1.929, Test loss: 1.835, Test accuracy: 62.82
Round  44, Global train loss: 1.929, Global test loss: 1.878, Global test accuracy: 59.18
Round  45, Train loss: 2.108, Test loss: 1.837, Test accuracy: 62.62
Round  45, Global train loss: 2.108, Global test loss: 1.938, Global test accuracy: 52.42
Round  46, Train loss: 1.840, Test loss: 1.838, Test accuracy: 62.54
Round  46, Global train loss: 1.840, Global test loss: 1.907, Global test accuracy: 54.68
Round  47, Train loss: 2.018, Test loss: 1.839, Test accuracy: 62.34
Round  47, Global train loss: 2.018, Global test loss: 1.883, Global test accuracy: 58.12
Round  48, Train loss: 2.001, Test loss: 1.845, Test accuracy: 61.70
Round  48, Global train loss: 2.001, Global test loss: 1.898, Global test accuracy: 56.78
Round  49, Train loss: 2.123, Test loss: 1.846, Test accuracy: 61.58
Round  49, Global train loss: 2.123, Global test loss: 1.938, Global test accuracy: 52.08
Round  50, Train loss: 1.993, Test loss: 1.847, Test accuracy: 61.54
Round  50, Global train loss: 1.993, Global test loss: 1.924, Global test accuracy: 53.50
Round  51, Train loss: 1.855, Test loss: 1.850, Test accuracy: 61.22
Round  51, Global train loss: 1.855, Global test loss: 1.878, Global test accuracy: 58.68
Round  52, Train loss: 2.079, Test loss: 1.846, Test accuracy: 61.78
Round  52, Global train loss: 2.079, Global test loss: 1.896, Global test accuracy: 56.94
Round  53, Train loss: 1.972, Test loss: 1.846, Test accuracy: 61.78
Round  53, Global train loss: 1.972, Global test loss: 1.878, Global test accuracy: 58.62
Round  54, Train loss: 1.961, Test loss: 1.845, Test accuracy: 61.88
Round  54, Global train loss: 1.961, Global test loss: 1.867, Global test accuracy: 60.08
Round  55, Train loss: 1.982, Test loss: 1.844, Test accuracy: 61.90
Round  55, Global train loss: 1.982, Global test loss: 1.893, Global test accuracy: 57.42
Round  56, Train loss: 2.033, Test loss: 1.845, Test accuracy: 61.74
Round  56, Global train loss: 2.033, Global test loss: 1.893, Global test accuracy: 56.96
Round  57, Train loss: 1.797, Test loss: 1.850, Test accuracy: 61.22
Round  57, Global train loss: 1.797, Global test loss: 1.877, Global test accuracy: 58.96
Round  58, Train loss: 1.875, Test loss: 1.854, Test accuracy: 60.70
Round  58, Global train loss: 1.875, Global test loss: 1.898, Global test accuracy: 56.88
Round  59, Train loss: 2.101, Test loss: 1.855, Test accuracy: 60.62
Round  59, Global train loss: 2.101, Global test loss: 1.914, Global test accuracy: 54.32
Round  60, Train loss: 1.923, Test loss: 1.856, Test accuracy: 60.48
Round  60, Global train loss: 1.923, Global test loss: 1.870, Global test accuracy: 59.80
Round  61, Train loss: 1.900, Test loss: 1.857, Test accuracy: 60.40
Round  61, Global train loss: 1.900, Global test loss: 1.896, Global test accuracy: 56.80
Round  62, Train loss: 1.742, Test loss: 1.858, Test accuracy: 60.40
Round  62, Global train loss: 1.742, Global test loss: 1.885, Global test accuracy: 57.94
Round  63, Train loss: 1.843, Test loss: 1.860, Test accuracy: 60.20
Round  63, Global train loss: 1.843, Global test loss: 1.866, Global test accuracy: 59.96
Round  64, Train loss: 1.891, Test loss: 1.852, Test accuracy: 61.14
Round  64, Global train loss: 1.891, Global test loss: 1.878, Global test accuracy: 58.58
Round  65, Train loss: 1.898, Test loss: 1.854, Test accuracy: 60.86
Round  65, Global train loss: 1.898, Global test loss: 1.885, Global test accuracy: 58.08
Round  66, Train loss: 2.030, Test loss: 1.860, Test accuracy: 60.14
Round  66, Global train loss: 2.030, Global test loss: 1.901, Global test accuracy: 56.30
Round  67, Train loss: 1.991, Test loss: 1.868, Test accuracy: 59.20
Round  67, Global train loss: 1.991, Global test loss: 1.897, Global test accuracy: 56.60
Round  68, Train loss: 1.937, Test loss: 1.867, Test accuracy: 59.32
Round  68, Global train loss: 1.937, Global test loss: 1.896, Global test accuracy: 57.00
Round  69, Train loss: 1.860, Test loss: 1.870, Test accuracy: 59.04
Round  69, Global train loss: 1.860, Global test loss: 1.870, Global test accuracy: 59.76
Round  70, Train loss: 2.009, Test loss: 1.869, Test accuracy: 59.16
Round  70, Global train loss: 2.009, Global test loss: 1.887, Global test accuracy: 57.48
Round  71, Train loss: 1.745, Test loss: 1.868, Test accuracy: 59.16
Round  71, Global train loss: 1.745, Global test loss: 1.855, Global test accuracy: 61.34
Round  72, Train loss: 1.990, Test loss: 1.867, Test accuracy: 59.32
Round  72, Global train loss: 1.990, Global test loss: 1.914, Global test accuracy: 54.46
Round  73, Train loss: 1.980, Test loss: 1.863, Test accuracy: 59.72
Round  73, Global train loss: 1.980, Global test loss: 1.871, Global test accuracy: 59.14
Round  74, Train loss: 1.762, Test loss: 1.859, Test accuracy: 60.26
Round  74, Global train loss: 1.762, Global test loss: 1.870, Global test accuracy: 59.52
Round  75, Train loss: 2.038, Test loss: 1.857, Test accuracy: 60.36
Round  75, Global train loss: 2.038, Global test loss: 1.892, Global test accuracy: 57.06
Round  76, Train loss: 1.801, Test loss: 1.858, Test accuracy: 60.28
Round  76, Global train loss: 1.801, Global test loss: 1.866, Global test accuracy: 59.92
Round  77, Train loss: 2.017, Test loss: 1.855, Test accuracy: 60.64
Round  77, Global train loss: 2.017, Global test loss: 1.898, Global test accuracy: 56.54
Round  78, Train loss: 1.865, Test loss: 1.853, Test accuracy: 60.72
Round  78, Global train loss: 1.865, Global test loss: 1.879, Global test accuracy: 58.24
Round  79, Train loss: 2.045, Test loss: 1.858, Test accuracy: 60.26
Round  79, Global train loss: 2.045, Global test loss: 1.906, Global test accuracy: 55.78
Round  80, Train loss: 1.732, Test loss: 1.847, Test accuracy: 61.48
Round  80, Global train loss: 1.732, Global test loss: 1.861, Global test accuracy: 60.02
Round  81, Train loss: 1.627, Test loss: 1.842, Test accuracy: 61.94
Round  81, Global train loss: 1.627, Global test loss: 1.844, Global test accuracy: 62.66
Round  82, Train loss: 1.928, Test loss: 1.834, Test accuracy: 62.86
Round  82, Global train loss: 1.928, Global test loss: 1.877, Global test accuracy: 58.76
Round  83, Train loss: 1.764, Test loss: 1.831, Test accuracy: 63.22
Round  83, Global train loss: 1.764, Global test loss: 1.844, Global test accuracy: 63.06
Round  84, Train loss: 1.732, Test loss: 1.809, Test accuracy: 65.50
Round  84, Global train loss: 1.732, Global test loss: 1.839, Global test accuracy: 63.18
Round  85, Train loss: 1.860, Test loss: 1.810, Test accuracy: 65.42
Round  85, Global train loss: 1.860, Global test loss: 1.873, Global test accuracy: 58.96
Round  86, Train loss: 1.888, Test loss: 1.813, Test accuracy: 65.14
Round  86, Global train loss: 1.888, Global test loss: 1.874, Global test accuracy: 58.92
Round  87, Train loss: 2.003, Test loss: 1.817, Test accuracy: 64.70
Round  87, Global train loss: 2.003, Global test loss: 1.906, Global test accuracy: 55.06
Round  88, Train loss: 1.922, Test loss: 1.820, Test accuracy: 64.18
Round  88, Global train loss: 1.922, Global test loss: 1.910, Global test accuracy: 55.28
Round  89, Train loss: 1.851, Test loss: 1.814, Test accuracy: 64.98
Round  89, Global train loss: 1.851, Global test loss: 1.864, Global test accuracy: 61.46
Round  90, Train loss: 2.061, Test loss: 1.821, Test accuracy: 64.14
Round  90, Global train loss: 2.061, Global test loss: 1.897, Global test accuracy: 57.04
Round  91, Train loss: 1.844, Test loss: 1.822, Test accuracy: 64.12
Round  91, Global train loss: 1.844, Global test loss: 1.907, Global test accuracy: 55.24
Round  92, Train loss: 1.947, Test loss: 1.824, Test accuracy: 63.82
Round  92, Global train loss: 1.947, Global test loss: 1.868, Global test accuracy: 60.14
Round  93, Train loss: 1.759, Test loss: 1.822, Test accuracy: 64.16
Round  93, Global train loss: 1.759, Global test loss: 1.888, Global test accuracy: 57.56
Round  94, Train loss: 1.844, Test loss: 1.814, Test accuracy: 65.06
Round  94, Global train loss: 1.844, Global test loss: 1.849, Global test accuracy: 62.04/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.770, Test loss: 1.817, Test accuracy: 64.74
Round  95, Global train loss: 1.770, Global test loss: 1.842, Global test accuracy: 62.50
Round  96, Train loss: 1.781, Test loss: 1.823, Test accuracy: 64.12
Round  96, Global train loss: 1.781, Global test loss: 1.842, Global test accuracy: 62.46
Round  97, Train loss: 2.003, Test loss: 1.815, Test accuracy: 64.96
Round  97, Global train loss: 2.003, Global test loss: 1.894, Global test accuracy: 56.64
Round  98, Train loss: 1.783, Test loss: 1.802, Test accuracy: 66.32
Round  98, Global train loss: 1.783, Global test loss: 1.865, Global test accuracy: 59.30
Round  99, Train loss: 1.905, Test loss: 1.803, Test accuracy: 66.02
Round  99, Global train loss: 1.905, Global test loss: 1.846, Global test accuracy: 62.44
Final Round, Train loss: 1.847, Test loss: 1.819, Test accuracy: 64.22
Final Round, Global train loss: 1.847, Global test loss: 1.846, Global test accuracy: 62.44
Average accuracy final 10 rounds: 64.746 

Average global accuracy final 10 rounds: 59.536 

707.1875987052917
[1.0291824340820312, 2.0583648681640625, 2.971583843231201, 3.88480281829834, 4.816138505935669, 5.747474193572998, 6.636204719543457, 7.524935245513916, 8.384535074234009, 9.244134902954102, 10.143794536590576, 11.04345417022705, 11.948097229003906, 12.852740287780762, 13.72277569770813, 14.592811107635498, 15.540018796920776, 16.487226486206055, 17.437217712402344, 18.387208938598633, 19.339946269989014, 20.292683601379395, 21.201217651367188, 22.10975170135498, 23.018688201904297, 23.927624702453613, 24.83015727996826, 25.73268985748291, 26.62895631790161, 27.525222778320312, 28.387377500534058, 29.249532222747803, 30.12727642059326, 31.00502061843872, 31.87436580657959, 32.74371099472046, 33.60526418685913, 34.4668173789978, 35.42076349258423, 36.374709606170654, 37.34538221359253, 38.316054821014404, 39.260363817214966, 40.20467281341553, 41.18713879585266, 42.169604778289795, 43.035046100616455, 43.900487422943115, 44.76413822174072, 45.62778902053833, 46.4721155166626, 47.316442012786865, 48.2072389125824, 49.09803581237793, 49.960060834884644, 50.82208585739136, 51.73291254043579, 52.643739223480225, 53.59132432937622, 54.53890943527222, 55.41751980781555, 56.29613018035889, 57.144352436065674, 57.99257469177246, 58.87185978889465, 59.751144886016846, 60.57866621017456, 61.406187534332275, 62.2476019859314, 63.08901643753052, 63.930850982666016, 64.77268552780151, 65.63206577301025, 66.491446018219, 67.41509342193604, 68.33874082565308, 69.25459098815918, 70.17044115066528, 71.05046200752258, 71.93048286437988, 72.81141376495361, 73.69234466552734, 74.57924914360046, 75.46615362167358, 76.33992218971252, 77.21369075775146, 78.12566757202148, 79.0376443862915, 79.94686126708984, 80.85607814788818, 81.74585485458374, 82.6356315612793, 83.53299331665039, 84.43035507202148, 85.29602003097534, 86.1616849899292, 87.05336356163025, 87.9450421333313, 88.86843276023865, 89.791823387146, 90.68322920799255, 91.57463502883911, 92.47257542610168, 93.37051582336426, 94.31439685821533, 95.2582778930664, 96.11457180976868, 96.97086572647095, 97.85978126525879, 98.74869680404663, 99.67676305770874, 100.60482931137085, 101.54610896110535, 102.48738861083984, 103.40578651428223, 104.32418441772461, 105.28897094726562, 106.25375747680664, 107.18429517745972, 108.1148328781128, 109.00212240219116, 109.88941192626953, 110.7666289806366, 111.64384603500366, 112.58171701431274, 113.51958799362183, 114.40649366378784, 115.29339933395386, 116.1296317577362, 116.96586418151855, 117.84813642501831, 118.73040866851807, 119.63511109352112, 120.53981351852417, 121.45790004730225, 122.37598657608032, 123.25173425674438, 124.12748193740845, 125.04320645332336, 125.95893096923828, 126.8953607082367, 127.83179044723511, 128.71583104133606, 129.599871635437, 130.5030324459076, 131.40619325637817, 132.2802665233612, 133.15433979034424, 134.0831515789032, 135.01196336746216, 135.89164924621582, 136.77133512496948, 137.6747591495514, 138.5781831741333, 139.45332622528076, 140.32846927642822, 141.23883199691772, 142.14919471740723, 143.11919021606445, 144.08918571472168, 144.97237467765808, 145.85556364059448, 146.70760202407837, 147.55964040756226, 148.41891813278198, 149.2781958580017, 150.1876881122589, 151.0971803665161, 151.9986686706543, 152.90015697479248, 153.85768246650696, 154.81520795822144, 155.71707725524902, 156.6189465522766, 157.5269272327423, 158.434907913208, 159.3218755722046, 160.20884323120117, 161.1380317211151, 162.06722021102905, 162.99147844314575, 163.91573667526245, 164.816565990448, 165.71739530563354, 166.63467526435852, 167.5519552230835, 168.49708104133606, 169.44220685958862, 170.4797646999359, 171.5173225402832, 172.47373390197754, 173.43014526367188, 174.3871991634369, 175.3442530632019, 176.35118460655212, 177.35811614990234, 178.35400915145874, 179.34990215301514, 180.28899264335632, 181.2280831336975, 183.0707597732544, 184.91343641281128]
[13.42, 13.42, 18.42, 18.42, 22.94, 22.94, 31.22, 31.22, 36.18, 36.18, 39.3, 39.3, 44.98, 44.98, 46.86, 46.86, 52.4, 52.4, 52.4, 52.4, 53.8, 53.8, 54.42, 54.42, 54.24, 54.24, 54.88, 54.88, 55.02, 55.02, 55.02, 55.02, 54.98, 54.98, 54.72, 54.72, 54.84, 54.84, 54.64, 54.64, 54.72, 54.72, 54.66, 54.66, 56.46, 56.46, 57.4, 57.4, 57.48, 57.48, 58.72, 58.72, 59.88, 59.88, 61.64, 61.64, 62.84, 62.84, 62.78, 62.78, 62.78, 62.78, 63.0, 63.0, 63.18, 63.18, 63.1, 63.1, 62.14, 62.14, 62.58, 62.58, 62.98, 62.98, 63.0, 63.0, 63.1, 63.1, 63.0, 63.0, 62.94, 62.94, 62.94, 62.94, 62.86, 62.86, 62.48, 62.48, 62.82, 62.82, 62.62, 62.62, 62.54, 62.54, 62.34, 62.34, 61.7, 61.7, 61.58, 61.58, 61.54, 61.54, 61.22, 61.22, 61.78, 61.78, 61.78, 61.78, 61.88, 61.88, 61.9, 61.9, 61.74, 61.74, 61.22, 61.22, 60.7, 60.7, 60.62, 60.62, 60.48, 60.48, 60.4, 60.4, 60.4, 60.4, 60.2, 60.2, 61.14, 61.14, 60.86, 60.86, 60.14, 60.14, 59.2, 59.2, 59.32, 59.32, 59.04, 59.04, 59.16, 59.16, 59.16, 59.16, 59.32, 59.32, 59.72, 59.72, 60.26, 60.26, 60.36, 60.36, 60.28, 60.28, 60.64, 60.64, 60.72, 60.72, 60.26, 60.26, 61.48, 61.48, 61.94, 61.94, 62.86, 62.86, 63.22, 63.22, 65.5, 65.5, 65.42, 65.42, 65.14, 65.14, 64.7, 64.7, 64.18, 64.18, 64.98, 64.98, 64.14, 64.14, 64.12, 64.12, 63.82, 63.82, 64.16, 64.16, 65.06, 65.06, 64.74, 64.74, 64.12, 64.12, 64.96, 64.96, 66.32, 66.32, 66.02, 66.02, 64.22, 64.22]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 5, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.316, Test loss: 2.300, Test accuracy: 12.00
Round   0, Global train loss: 2.316, Global test loss: 2.301, Global test accuracy: 10.92
Round   1, Train loss: 2.292, Test loss: 2.294, Test accuracy: 18.84
Round   1, Global train loss: 2.292, Global test loss: 2.296, Global test accuracy: 18.32
Round   2, Train loss: 2.281, Test loss: 2.279, Test accuracy: 18.02
Round   2, Global train loss: 2.281, Global test loss: 2.283, Global test accuracy: 18.00
Round   3, Train loss: 2.248, Test loss: 2.226, Test accuracy: 18.64
Round   3, Global train loss: 2.248, Global test loss: 2.229, Global test accuracy: 18.06
Round   4, Train loss: 2.111, Test loss: 2.117, Test accuracy: 37.54
Round   4, Global train loss: 2.111, Global test loss: 2.135, Global test accuracy: 33.50
Round   5, Train loss: 2.027, Test loss: 2.059, Test accuracy: 42.54
Round   5, Global train loss: 2.027, Global test loss: 2.078, Global test accuracy: 38.20
Round   6, Train loss: 2.044, Test loss: 2.041, Test accuracy: 43.86
Round   6, Global train loss: 2.044, Global test loss: 2.061, Global test accuracy: 38.64
Round   7, Train loss: 2.080, Test loss: 2.030, Test accuracy: 47.60
Round   7, Global train loss: 2.080, Global test loss: 2.073, Global test accuracy: 43.66
Round   8, Train loss: 2.062, Test loss: 2.001, Test accuracy: 51.04
Round   8, Global train loss: 2.062, Global test loss: 2.118, Global test accuracy: 30.68
Round   9, Train loss: 2.208, Test loss: 2.014, Test accuracy: 50.48
Round   9, Global train loss: 2.208, Global test loss: 2.108, Global test accuracy: 36.00
Round  10, Train loss: 2.125, Test loss: 1.995, Test accuracy: 51.98
Round  10, Global train loss: 2.125, Global test loss: 2.124, Global test accuracy: 37.04
Round  11, Train loss: 1.791, Test loss: 1.946, Test accuracy: 53.92
Round  11, Global train loss: 1.791, Global test loss: 1.986, Global test accuracy: 50.26
Round  12, Train loss: 2.126, Test loss: 1.945, Test accuracy: 55.38
Round  12, Global train loss: 2.126, Global test loss: 2.061, Global test accuracy: 40.96
Round  13, Train loss: 2.000, Test loss: 1.946, Test accuracy: 55.20
Round  13, Global train loss: 2.000, Global test loss: 2.032, Global test accuracy: 49.52
Round  14, Train loss: 2.093, Test loss: 1.931, Test accuracy: 57.68
Round  14, Global train loss: 2.093, Global test loss: 2.054, Global test accuracy: 46.78
Round  15, Train loss: 2.042, Test loss: 1.920, Test accuracy: 59.16
Round  15, Global train loss: 2.042, Global test loss: 2.059, Global test accuracy: 41.10
Round  16, Train loss: 1.965, Test loss: 1.912, Test accuracy: 59.92
Round  16, Global train loss: 1.965, Global test loss: 2.018, Global test accuracy: 42.42
Round  17, Train loss: 2.077, Test loss: 1.901, Test accuracy: 60.66
Round  17, Global train loss: 2.077, Global test loss: 2.033, Global test accuracy: 46.28
Round  18, Train loss: 2.050, Test loss: 1.895, Test accuracy: 61.54
Round  18, Global train loss: 2.050, Global test loss: 2.034, Global test accuracy: 47.88
Round  19, Train loss: 1.886, Test loss: 1.875, Test accuracy: 63.62
Round  19, Global train loss: 1.886, Global test loss: 1.971, Global test accuracy: 50.30
Round  20, Train loss: 1.872, Test loss: 1.867, Test accuracy: 63.80
Round  20, Global train loss: 1.872, Global test loss: 1.967, Global test accuracy: 57.28
Round  21, Train loss: 1.957, Test loss: 1.860, Test accuracy: 65.46
Round  21, Global train loss: 1.957, Global test loss: 1.970, Global test accuracy: 57.10
Round  22, Train loss: 1.836, Test loss: 1.852, Test accuracy: 66.28
Round  22, Global train loss: 1.836, Global test loss: 1.971, Global test accuracy: 51.76
Round  23, Train loss: 2.161, Test loss: 1.867, Test accuracy: 65.94
Round  23, Global train loss: 2.161, Global test loss: 2.047, Global test accuracy: 44.24
Round  24, Train loss: 2.166, Test loss: 1.879, Test accuracy: 66.12
Round  24, Global train loss: 2.166, Global test loss: 2.065, Global test accuracy: 50.08
Round  25, Train loss: 1.954, Test loss: 1.870, Test accuracy: 67.16
Round  25, Global train loss: 1.954, Global test loss: 2.015, Global test accuracy: 49.58
Round  26, Train loss: 2.030, Test loss: 1.850, Test accuracy: 67.88
Round  26, Global train loss: 2.030, Global test loss: 2.031, Global test accuracy: 44.38
Round  27, Train loss: 1.753, Test loss: 1.833, Test accuracy: 68.72
Round  27, Global train loss: 1.753, Global test loss: 1.963, Global test accuracy: 52.70
Round  28, Train loss: 1.844, Test loss: 1.804, Test accuracy: 71.16
Round  28, Global train loss: 1.844, Global test loss: 1.982, Global test accuracy: 52.94
Round  29, Train loss: 1.805, Test loss: 1.798, Test accuracy: 72.56
Round  29, Global train loss: 1.805, Global test loss: 1.934, Global test accuracy: 62.80
Round  30, Train loss: 1.592, Test loss: 1.779, Test accuracy: 73.18
Round  30, Global train loss: 1.592, Global test loss: 1.912, Global test accuracy: 54.38
Round  31, Train loss: 1.720, Test loss: 1.776, Test accuracy: 73.90
Round  31, Global train loss: 1.720, Global test loss: 1.890, Global test accuracy: 57.90
Round  32, Train loss: 2.152, Test loss: 1.782, Test accuracy: 76.18
Round  32, Global train loss: 2.152, Global test loss: 2.042, Global test accuracy: 51.42
Round  33, Train loss: 1.784, Test loss: 1.794, Test accuracy: 75.36
Round  33, Global train loss: 1.784, Global test loss: 1.966, Global test accuracy: 51.96
Round  34, Train loss: 2.133, Test loss: 1.805, Test accuracy: 75.42
Round  34, Global train loss: 2.133, Global test loss: 2.002, Global test accuracy: 55.20
Round  35, Train loss: 1.950, Test loss: 1.787, Test accuracy: 77.02
Round  35, Global train loss: 1.950, Global test loss: 2.004, Global test accuracy: 55.78
Round  36, Train loss: 1.932, Test loss: 1.779, Test accuracy: 76.94
Round  36, Global train loss: 1.932, Global test loss: 1.981, Global test accuracy: 53.96
Round  37, Train loss: 1.778, Test loss: 1.786, Test accuracy: 76.50
Round  37, Global train loss: 1.778, Global test loss: 1.980, Global test accuracy: 51.10
Round  38, Train loss: 1.766, Test loss: 1.779, Test accuracy: 77.02
Round  38, Global train loss: 1.766, Global test loss: 1.961, Global test accuracy: 56.56
Round  39, Train loss: 1.907, Test loss: 1.783, Test accuracy: 75.80
Round  39, Global train loss: 1.907, Global test loss: 2.040, Global test accuracy: 41.02
Round  40, Train loss: 1.952, Test loss: 1.791, Test accuracy: 75.30
Round  40, Global train loss: 1.952, Global test loss: 2.053, Global test accuracy: 41.88
Round  41, Train loss: 1.938, Test loss: 1.770, Test accuracy: 77.56
Round  41, Global train loss: 1.938, Global test loss: 2.026, Global test accuracy: 46.66
Round  42, Train loss: 1.743, Test loss: 1.764, Test accuracy: 78.18
Round  42, Global train loss: 1.743, Global test loss: 1.950, Global test accuracy: 51.94
Round  43, Train loss: 1.898, Test loss: 1.754, Test accuracy: 78.22
Round  43, Global train loss: 1.898, Global test loss: 1.979, Global test accuracy: 50.68
Round  44, Train loss: 1.753, Test loss: 1.749, Test accuracy: 78.16
Round  44, Global train loss: 1.753, Global test loss: 1.965, Global test accuracy: 52.64
Round  45, Train loss: 2.085, Test loss: 1.761, Test accuracy: 78.40
Round  45, Global train loss: 2.085, Global test loss: 2.017, Global test accuracy: 50.30
Round  46, Train loss: 1.746, Test loss: 1.764, Test accuracy: 78.14
Round  46, Global train loss: 1.746, Global test loss: 1.965, Global test accuracy: 55.32
Round  47, Train loss: 1.887, Test loss: 1.763, Test accuracy: 78.32
Round  47, Global train loss: 1.887, Global test loss: 1.992, Global test accuracy: 53.74
Round  48, Train loss: 1.771, Test loss: 1.740, Test accuracy: 78.98
Round  48, Global train loss: 1.771, Global test loss: 1.989, Global test accuracy: 51.66
Round  49, Train loss: 2.109, Test loss: 1.750, Test accuracy: 78.32
Round  49, Global train loss: 2.109, Global test loss: 2.060, Global test accuracy: 41.36
Round  50, Train loss: 1.921, Test loss: 1.754, Test accuracy: 78.10
Round  50, Global train loss: 1.921, Global test loss: 2.027, Global test accuracy: 45.48
Round  51, Train loss: 1.701, Test loss: 1.742, Test accuracy: 79.14
Round  51, Global train loss: 1.701, Global test loss: 1.912, Global test accuracy: 63.02
Round  52, Train loss: 1.886, Test loss: 1.735, Test accuracy: 78.68
Round  52, Global train loss: 1.886, Global test loss: 1.973, Global test accuracy: 53.28
Round  53, Train loss: 1.732, Test loss: 1.737, Test accuracy: 78.42
Round  53, Global train loss: 1.732, Global test loss: 1.927, Global test accuracy: 61.12
Round  54, Train loss: 2.095, Test loss: 1.778, Test accuracy: 76.42
Round  54, Global train loss: 2.095, Global test loss: 1.992, Global test accuracy: 61.80
Round  55, Train loss: 1.695, Test loss: 1.741, Test accuracy: 78.76
Round  55, Global train loss: 1.695, Global test loss: 1.942, Global test accuracy: 52.86
Round  56, Train loss: 1.891, Test loss: 1.746, Test accuracy: 77.58
Round  56, Global train loss: 1.891, Global test loss: 2.012, Global test accuracy: 47.18
Round  57, Train loss: 1.539, Test loss: 1.720, Test accuracy: 79.00
Round  57, Global train loss: 1.539, Global test loss: 1.898, Global test accuracy: 57.22
Round  58, Train loss: 1.953, Test loss: 1.738, Test accuracy: 78.24
Round  58, Global train loss: 1.953, Global test loss: 2.051, Global test accuracy: 42.50
Round  59, Train loss: 2.063, Test loss: 1.744, Test accuracy: 78.02
Round  59, Global train loss: 2.063, Global test loss: 2.122, Global test accuracy: 32.40
Round  60, Train loss: 1.891, Test loss: 1.753, Test accuracy: 77.42
Round  60, Global train loss: 1.891, Global test loss: 1.951, Global test accuracy: 58.12
Round  61, Train loss: 1.859, Test loss: 1.748, Test accuracy: 78.26
Round  61, Global train loss: 1.859, Global test loss: 1.972, Global test accuracy: 52.84
Round  62, Train loss: 1.678, Test loss: 1.735, Test accuracy: 79.20
Round  62, Global train loss: 1.678, Global test loss: 1.931, Global test accuracy: 57.44
Round  63, Train loss: 1.681, Test loss: 1.714, Test accuracy: 80.64
Round  63, Global train loss: 1.681, Global test loss: 1.920, Global test accuracy: 55.94
Round  64, Train loss: 1.676, Test loss: 1.712, Test accuracy: 80.36
Round  64, Global train loss: 1.676, Global test loss: 1.905, Global test accuracy: 58.64
Round  65, Train loss: 1.837, Test loss: 1.729, Test accuracy: 79.40
Round  65, Global train loss: 1.837, Global test loss: 1.930, Global test accuracy: 57.94
Round  66, Train loss: 1.841, Test loss: 1.730, Test accuracy: 79.42
Round  66, Global train loss: 1.841, Global test loss: 1.941, Global test accuracy: 53.88
Round  67, Train loss: 1.899, Test loss: 1.752, Test accuracy: 78.62
Round  67, Global train loss: 1.899, Global test loss: 2.054, Global test accuracy: 40.86
Round  68, Train loss: 1.701, Test loss: 1.735, Test accuracy: 79.02
Round  68, Global train loss: 1.701, Global test loss: 1.913, Global test accuracy: 59.04
Round  69, Train loss: 1.906, Test loss: 1.762, Test accuracy: 76.88
Round  69, Global train loss: 1.906, Global test loss: 1.981, Global test accuracy: 55.52
Round  70, Train loss: 1.854, Test loss: 1.741, Test accuracy: 77.80
Round  70, Global train loss: 1.854, Global test loss: 1.972, Global test accuracy: 51.04
Round  71, Train loss: 1.536, Test loss: 1.711, Test accuracy: 79.82
Round  71, Global train loss: 1.536, Global test loss: 1.883, Global test accuracy: 58.12
Round  72, Train loss: 1.902, Test loss: 1.743, Test accuracy: 77.44
Round  72, Global train loss: 1.902, Global test loss: 2.039, Global test accuracy: 41.98
Round  73, Train loss: 1.673, Test loss: 1.720, Test accuracy: 79.04
Round  73, Global train loss: 1.673, Global test loss: 1.895, Global test accuracy: 59.36
Round  74, Train loss: 1.835, Test loss: 1.738, Test accuracy: 78.30
Round  74, Global train loss: 1.835, Global test loss: 1.964, Global test accuracy: 55.32
Round  75, Train loss: 1.827, Test loss: 1.735, Test accuracy: 77.78
Round  75, Global train loss: 1.827, Global test loss: 1.943, Global test accuracy: 53.82
Round  76, Train loss: 1.684, Test loss: 1.735, Test accuracy: 77.80
Round  76, Global train loss: 1.684, Global test loss: 1.923, Global test accuracy: 55.26
Round  77, Train loss: 1.811, Test loss: 1.758, Test accuracy: 75.28
Round  77, Global train loss: 1.811, Global test loss: 1.955, Global test accuracy: 54.08
Round  78, Train loss: 1.882, Test loss: 1.774, Test accuracy: 73.74
Round  78, Global train loss: 1.882, Global test loss: 2.112, Global test accuracy: 34.64
Round  79, Train loss: 1.835, Test loss: 1.742, Test accuracy: 77.30
Round  79, Global train loss: 1.835, Global test loss: 1.956, Global test accuracy: 57.32
Round  80, Train loss: 1.537, Test loss: 1.708, Test accuracy: 79.86
Round  80, Global train loss: 1.537, Global test loss: 1.882, Global test accuracy: 57.84
Round  81, Train loss: 1.696, Test loss: 1.720, Test accuracy: 79.16
Round  81, Global train loss: 1.696, Global test loss: 1.942, Global test accuracy: 52.18
Round  82, Train loss: 1.831, Test loss: 1.748, Test accuracy: 76.72
Round  82, Global train loss: 1.831, Global test loss: 1.984, Global test accuracy: 56.24
Round  83, Train loss: 1.822, Test loss: 1.764, Test accuracy: 75.18
Round  83, Global train loss: 1.822, Global test loss: 1.993, Global test accuracy: 50.64
Round  84, Train loss: 1.495, Test loss: 1.714, Test accuracy: 78.60
Round  84, Global train loss: 1.495, Global test loss: 1.871, Global test accuracy: 61.34
Round  85, Train loss: 1.663, Test loss: 1.708, Test accuracy: 78.94
Round  85, Global train loss: 1.663, Global test loss: 1.880, Global test accuracy: 60.28
Round  86, Train loss: 1.815, Test loss: 1.744, Test accuracy: 76.36
Round  86, Global train loss: 1.815, Global test loss: 1.960, Global test accuracy: 53.74
Round  87, Train loss: 1.823, Test loss: 1.753, Test accuracy: 76.10
Round  87, Global train loss: 1.823, Global test loss: 2.040, Global test accuracy: 42.06
Round  88, Train loss: 1.954, Test loss: 1.787, Test accuracy: 73.08
Round  88, Global train loss: 1.954, Global test loss: 2.060, Global test accuracy: 43.52
Round  89, Train loss: 1.668, Test loss: 1.747, Test accuracy: 76.76
Round  89, Global train loss: 1.668, Global test loss: 1.929, Global test accuracy: 56.54
Round  90, Train loss: 1.935, Test loss: 1.780, Test accuracy: 73.36
Round  90, Global train loss: 1.935, Global test loss: 2.076, Global test accuracy: 38.60
Round  91, Train loss: 1.651, Test loss: 1.734, Test accuracy: 77.76
Round  91, Global train loss: 1.651, Global test loss: 1.929, Global test accuracy: 56.32/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  92, Train loss: 1.785, Test loss: 1.732, Test accuracy: 77.12
Round  92, Global train loss: 1.785, Global test loss: 2.007, Global test accuracy: 47.24
Round  93, Train loss: 1.654, Test loss: 1.716, Test accuracy: 79.10
Round  93, Global train loss: 1.654, Global test loss: 1.928, Global test accuracy: 54.34
Round  94, Train loss: 1.652, Test loss: 1.717, Test accuracy: 79.00
Round  94, Global train loss: 1.652, Global test loss: 1.916, Global test accuracy: 57.70
Round  95, Train loss: 1.648, Test loss: 1.703, Test accuracy: 80.00
Round  95, Global train loss: 1.648, Global test loss: 1.928, Global test accuracy: 56.50
Round  96, Train loss: 1.620, Test loss: 1.703, Test accuracy: 80.16
Round  96, Global train loss: 1.620, Global test loss: 1.912, Global test accuracy: 57.12
Round  97, Train loss: 1.787, Test loss: 1.728, Test accuracy: 77.48
Round  97, Global train loss: 1.787, Global test loss: 1.938, Global test accuracy: 54.56
Round  98, Train loss: 1.768, Test loss: 1.774, Test accuracy: 72.56
Round  98, Global train loss: 1.768, Global test loss: 2.001, Global test accuracy: 48.86
Round  99, Train loss: 1.798, Test loss: 1.765, Test accuracy: 74.76
Round  99, Global train loss: 1.798, Global test loss: 1.961, Global test accuracy: 56.14
Final Round, Train loss: 1.747, Test loss: 1.740, Test accuracy: 76.18
Final Round, Global train loss: 1.747, Global test loss: 1.961, Global test accuracy: 56.14
Average accuracy final 10 rounds: 77.13
576.9493210315704
[1.1737606525421143, 2.223299741744995, 3.245814085006714, 4.271435499191284, 5.258639097213745, 6.3281049728393555, 7.3164215087890625, 8.283505201339722, 9.289512634277344, 10.301088809967041, 11.289867639541626, 12.282840728759766, 13.24190378189087, 14.207560777664185, 15.204795360565186, 16.194892644882202, 17.193639039993286, 18.188525915145874, 19.168793439865112, 20.143664598464966, 21.080316066741943, 22.050141096115112, 23.027770280838013, 24.013545274734497, 24.985806703567505, 25.98787498474121, 26.975847244262695, 27.980194568634033, 28.954572916030884, 29.94958782196045, 30.930599689483643, 31.925615787506104, 32.92088031768799, 33.88394117355347, 34.872140645980835, 35.85899376869202, 36.932700634002686, 37.967477321624756, 38.94419813156128, 39.95668292045593, 40.990997076034546, 42.02377271652222, 43.04888367652893, 44.11260747909546, 45.10858607292175, 46.126901149749756, 47.09139609336853, 48.071688652038574, 49.037834882736206, 50.03618931770325, 51.0588059425354, 52.07215189933777, 53.06942296028137, 54.052505016326904, 55.07391333580017, 56.063820600509644, 57.038532733917236, 58.04327750205994, 59.00439953804016, 59.99036502838135, 60.960731744766235, 61.92257046699524, 62.94399881362915, 63.91862392425537, 64.93316459655762, 65.96926951408386, 66.91101789474487, 67.93050050735474, 68.94885563850403, 69.94192337989807, 70.92882585525513, 71.92120409011841, 72.95609617233276, 73.93549251556396, 74.91167116165161, 75.8808946609497, 76.88531374931335, 77.8790225982666, 78.8445565700531, 79.86768054962158, 80.93486952781677, 81.98507452011108, 82.98472785949707, 83.96419525146484, 84.96636247634888, 85.97116732597351, 86.9450466632843, 87.94901394844055, 88.94367671012878, 89.9229564666748, 90.9104495048523, 91.90386176109314, 92.89931201934814, 93.88046717643738, 94.88922142982483, 95.88008856773376, 96.88001847267151, 97.92668342590332, 98.90962886810303, 99.924724817276, 101.48680782318115]
[12.0, 18.84, 18.02, 18.64, 37.54, 42.54, 43.86, 47.6, 51.04, 50.48, 51.98, 53.92, 55.38, 55.2, 57.68, 59.16, 59.92, 60.66, 61.54, 63.62, 63.8, 65.46, 66.28, 65.94, 66.12, 67.16, 67.88, 68.72, 71.16, 72.56, 73.18, 73.9, 76.18, 75.36, 75.42, 77.02, 76.94, 76.5, 77.02, 75.8, 75.3, 77.56, 78.18, 78.22, 78.16, 78.4, 78.14, 78.32, 78.98, 78.32, 78.1, 79.14, 78.68, 78.42, 76.42, 78.76, 77.58, 79.0, 78.24, 78.02, 77.42, 78.26, 79.2, 80.64, 80.36, 79.4, 79.42, 78.62, 79.02, 76.88, 77.8, 79.82, 77.44, 79.04, 78.3, 77.78, 77.8, 75.28, 73.74, 77.3, 79.86, 79.16, 76.72, 75.18, 78.6, 78.94, 76.36, 76.1, 73.08, 76.76, 73.36, 77.76, 77.12, 79.1, 79.0, 80.0, 80.16, 77.48, 72.56, 74.76, 76.18]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

   Client 6, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.316, Test loss: 2.297, Test accuracy: 18.20
Round   0, Global train loss: 2.316, Global test loss: 2.300, Global test accuracy: 14.54
Round   1, Train loss: 2.290, Test loss: 2.287, Test accuracy: 23.32
Round   1, Global train loss: 2.290, Global test loss: 2.295, Global test accuracy: 18.08
Round   2, Train loss: 2.275, Test loss: 2.264, Test accuracy: 27.88
Round   2, Global train loss: 2.275, Global test loss: 2.282, Global test accuracy: 18.66
Round   3, Train loss: 2.235, Test loss: 2.199, Test accuracy: 33.28
Round   3, Global train loss: 2.235, Global test loss: 2.242, Global test accuracy: 28.02
Round   4, Train loss: 2.178, Test loss: 2.124, Test accuracy: 39.96
Round   4, Global train loss: 2.178, Global test loss: 2.185, Global test accuracy: 29.80
Round   5, Train loss: 2.131, Test loss: 2.068, Test accuracy: 48.16
Round   5, Global train loss: 2.131, Global test loss: 2.143, Global test accuracy: 33.10
Round   6, Train loss: 2.090, Test loss: 2.013, Test accuracy: 57.62
Round   6, Global train loss: 2.090, Global test loss: 2.109, Global test accuracy: 41.02
Round   7, Train loss: 2.053, Test loss: 1.959, Test accuracy: 60.54
Round   7, Global train loss: 2.053, Global test loss: 2.075, Global test accuracy: 46.62
Round   8, Train loss: 2.015, Test loss: 1.905, Test accuracy: 67.78
Round   8, Global train loss: 2.015, Global test loss: 2.043, Global test accuracy: 54.80
Round   9, Train loss: 1.984, Test loss: 1.860, Test accuracy: 72.94
Round   9, Global train loss: 1.984, Global test loss: 2.015, Global test accuracy: 60.48
Round  10, Train loss: 1.841, Test loss: 1.834, Test accuracy: 75.58
Round  10, Global train loss: 1.841, Global test loss: 2.087, Global test accuracy: 35.02
Round  11, Train loss: 1.854, Test loss: 1.815, Test accuracy: 74.80
Round  11, Global train loss: 1.854, Global test loss: 2.050, Global test accuracy: 45.04
Round  12, Train loss: 1.867, Test loss: 1.816, Test accuracy: 74.22
Round  12, Global train loss: 1.867, Global test loss: 2.007, Global test accuracy: 46.76
Round  13, Train loss: 1.885, Test loss: 1.827, Test accuracy: 73.38
Round  13, Global train loss: 1.885, Global test loss: 2.003, Global test accuracy: 59.64
Round  14, Train loss: 1.850, Test loss: 1.809, Test accuracy: 74.02
Round  14, Global train loss: 1.850, Global test loss: 2.025, Global test accuracy: 48.56
Round  15, Train loss: 1.844, Test loss: 1.792, Test accuracy: 73.98
Round  15, Global train loss: 1.844, Global test loss: 1.948, Global test accuracy: 56.94
Round  16, Train loss: 1.817, Test loss: 1.806, Test accuracy: 72.24
Round  16, Global train loss: 1.817, Global test loss: 2.016, Global test accuracy: 50.02
Round  17, Train loss: 1.844, Test loss: 1.790, Test accuracy: 70.06
Round  17, Global train loss: 1.844, Global test loss: 1.970, Global test accuracy: 50.22
Round  18, Train loss: 1.673, Test loss: 1.772, Test accuracy: 72.26
Round  18, Global train loss: 1.673, Global test loss: 1.943, Global test accuracy: 52.48
Round  19, Train loss: 1.816, Test loss: 1.772, Test accuracy: 72.80
Round  19, Global train loss: 1.816, Global test loss: 1.935, Global test accuracy: 60.04
Round  20, Train loss: 1.804, Test loss: 1.776, Test accuracy: 72.84
Round  20, Global train loss: 1.804, Global test loss: 1.946, Global test accuracy: 61.04
Round  21, Train loss: 1.831, Test loss: 1.768, Test accuracy: 73.62
Round  21, Global train loss: 1.831, Global test loss: 1.933, Global test accuracy: 65.12
Round  22, Train loss: 1.790, Test loss: 1.766, Test accuracy: 73.66
Round  22, Global train loss: 1.790, Global test loss: 2.059, Global test accuracy: 38.30
Round  23, Train loss: 1.780, Test loss: 1.765, Test accuracy: 73.66
Round  23, Global train loss: 1.780, Global test loss: 2.011, Global test accuracy: 49.32
Round  24, Train loss: 1.828, Test loss: 1.760, Test accuracy: 74.46
Round  24, Global train loss: 1.828, Global test loss: 1.983, Global test accuracy: 53.16
Round  25, Train loss: 1.921, Test loss: 1.766, Test accuracy: 74.36
Round  25, Global train loss: 1.921, Global test loss: 2.095, Global test accuracy: 39.34
Round  26, Train loss: 1.601, Test loss: 1.744, Test accuracy: 76.16
Round  26, Global train loss: 1.601, Global test loss: 1.919, Global test accuracy: 54.56
Round  27, Train loss: 1.887, Test loss: 1.747, Test accuracy: 75.38
Round  27, Global train loss: 1.887, Global test loss: 2.104, Global test accuracy: 35.64
Round  28, Train loss: 1.532, Test loss: 1.737, Test accuracy: 76.16
Round  28, Global train loss: 1.532, Global test loss: 1.904, Global test accuracy: 56.58
Round  29, Train loss: 1.779, Test loss: 1.746, Test accuracy: 75.36
Round  29, Global train loss: 1.779, Global test loss: 1.927, Global test accuracy: 60.94
Round  30, Train loss: 1.639, Test loss: 1.739, Test accuracy: 76.56
Round  30, Global train loss: 1.639, Global test loss: 1.873, Global test accuracy: 62.20
Round  31, Train loss: 1.881, Test loss: 1.749, Test accuracy: 76.06
Round  31, Global train loss: 1.881, Global test loss: 2.055, Global test accuracy: 42.68
Round  32, Train loss: 1.731, Test loss: 1.729, Test accuracy: 77.96
Round  32, Global train loss: 1.731, Global test loss: 1.929, Global test accuracy: 65.88
Round  33, Train loss: 1.736, Test loss: 1.730, Test accuracy: 77.46
Round  33, Global train loss: 1.736, Global test loss: 2.044, Global test accuracy: 39.16
Round  34, Train loss: 1.762, Test loss: 1.729, Test accuracy: 78.18
Round  34, Global train loss: 1.762, Global test loss: 1.970, Global test accuracy: 49.56
Round  35, Train loss: 1.788, Test loss: 1.737, Test accuracy: 76.82
Round  35, Global train loss: 1.788, Global test loss: 1.968, Global test accuracy: 54.10
Round  36, Train loss: 1.632, Test loss: 1.744, Test accuracy: 74.92
Round  36, Global train loss: 1.632, Global test loss: 1.951, Global test accuracy: 52.46
Round  37, Train loss: 1.719, Test loss: 1.736, Test accuracy: 76.18
Round  37, Global train loss: 1.719, Global test loss: 2.052, Global test accuracy: 38.68
Round  38, Train loss: 1.730, Test loss: 1.755, Test accuracy: 73.72
Round  38, Global train loss: 1.730, Global test loss: 1.998, Global test accuracy: 53.14
Round  39, Train loss: 1.865, Test loss: 1.783, Test accuracy: 71.70
Round  39, Global train loss: 1.865, Global test loss: 2.080, Global test accuracy: 40.22
Round  40, Train loss: 1.761, Test loss: 1.780, Test accuracy: 71.98
Round  40, Global train loss: 1.761, Global test loss: 2.019, Global test accuracy: 44.74
Round  41, Train loss: 1.665, Test loss: 1.742, Test accuracy: 75.54
Round  41, Global train loss: 1.665, Global test loss: 1.989, Global test accuracy: 48.80
Round  42, Train loss: 1.735, Test loss: 1.745, Test accuracy: 75.82
Round  42, Global train loss: 1.735, Global test loss: 1.953, Global test accuracy: 56.74
Round  43, Train loss: 1.762, Test loss: 1.729, Test accuracy: 76.90
Round  43, Global train loss: 1.762, Global test loss: 1.976, Global test accuracy: 47.62
Round  44, Train loss: 1.503, Test loss: 1.709, Test accuracy: 78.54
Round  44, Global train loss: 1.503, Global test loss: 1.888, Global test accuracy: 58.12
Round  45, Train loss: 1.747, Test loss: 1.713, Test accuracy: 78.44
Round  45, Global train loss: 1.747, Global test loss: 1.947, Global test accuracy: 54.26
Round  46, Train loss: 1.708, Test loss: 1.738, Test accuracy: 76.46
Round  46, Global train loss: 1.708, Global test loss: 2.000, Global test accuracy: 52.80
Round  47, Train loss: 1.730, Test loss: 1.753, Test accuracy: 74.48
Round  47, Global train loss: 1.730, Global test loss: 2.002, Global test accuracy: 50.20
Round  48, Train loss: 1.648, Test loss: 1.700, Test accuracy: 79.38
Round  48, Global train loss: 1.648, Global test loss: 1.953, Global test accuracy: 54.78
Round  49, Train loss: 1.636, Test loss: 1.690, Test accuracy: 80.36
Round  49, Global train loss: 1.636, Global test loss: 1.961, Global test accuracy: 52.02
Round  50, Train loss: 1.721, Test loss: 1.707, Test accuracy: 79.32
Round  50, Global train loss: 1.721, Global test loss: 1.974, Global test accuracy: 56.94
Round  51, Train loss: 1.703, Test loss: 1.731, Test accuracy: 76.86
Round  51, Global train loss: 1.703, Global test loss: 1.952, Global test accuracy: 54.54
Round  52, Train loss: 1.732, Test loss: 1.703, Test accuracy: 79.42
Round  52, Global train loss: 1.732, Global test loss: 1.992, Global test accuracy: 50.50
Round  53, Train loss: 1.705, Test loss: 1.715, Test accuracy: 79.08
Round  53, Global train loss: 1.705, Global test loss: 1.944, Global test accuracy: 59.48
Round  54, Train loss: 1.696, Test loss: 1.722, Test accuracy: 76.84
Round  54, Global train loss: 1.696, Global test loss: 1.945, Global test accuracy: 54.60
Round  55, Train loss: 1.594, Test loss: 1.712, Test accuracy: 77.80
Round  55, Global train loss: 1.594, Global test loss: 1.923, Global test accuracy: 53.96
Round  56, Train loss: 1.598, Test loss: 1.695, Test accuracy: 79.54
Round  56, Global train loss: 1.598, Global test loss: 1.970, Global test accuracy: 50.80
Round  57, Train loss: 1.681, Test loss: 1.707, Test accuracy: 78.90
Round  57, Global train loss: 1.681, Global test loss: 2.016, Global test accuracy: 46.20
Round  58, Train loss: 1.589, Test loss: 1.689, Test accuracy: 80.42
Round  58, Global train loss: 1.589, Global test loss: 2.000, Global test accuracy: 46.84
Round  59, Train loss: 1.720, Test loss: 1.707, Test accuracy: 78.24
Round  59, Global train loss: 1.720, Global test loss: 2.050, Global test accuracy: 38.42
Round  60, Train loss: 1.782, Test loss: 1.717, Test accuracy: 77.22
Round  60, Global train loss: 1.782, Global test loss: 2.098, Global test accuracy: 33.52
Round  61, Train loss: 1.762, Test loss: 1.742, Test accuracy: 75.72
Round  61, Global train loss: 1.762, Global test loss: 2.076, Global test accuracy: 39.82
Round  62, Train loss: 1.740, Test loss: 1.748, Test accuracy: 75.32
Round  62, Global train loss: 1.740, Global test loss: 2.152, Global test accuracy: 28.44
Round  63, Train loss: 1.589, Test loss: 1.721, Test accuracy: 78.08
Round  63, Global train loss: 1.589, Global test loss: 1.911, Global test accuracy: 55.82
Round  64, Train loss: 1.664, Test loss: 1.728, Test accuracy: 77.10
Round  64, Global train loss: 1.664, Global test loss: 2.001, Global test accuracy: 49.60
Round  65, Train loss: 1.666, Test loss: 1.746, Test accuracy: 74.68
Round  65, Global train loss: 1.666, Global test loss: 1.977, Global test accuracy: 52.76
Round  66, Train loss: 1.774, Test loss: 1.764, Test accuracy: 73.24
Round  66, Global train loss: 1.774, Global test loss: 2.041, Global test accuracy: 44.72
Round  67, Train loss: 1.600, Test loss: 1.717, Test accuracy: 77.72
Round  67, Global train loss: 1.600, Global test loss: 1.968, Global test accuracy: 52.62
Round  68, Train loss: 1.560, Test loss: 1.691, Test accuracy: 80.54
Round  68, Global train loss: 1.560, Global test loss: 1.883, Global test accuracy: 60.80
Round  69, Train loss: 1.655, Test loss: 1.707, Test accuracy: 78.76
Round  69, Global train loss: 1.655, Global test loss: 1.920, Global test accuracy: 61.02
Round  70, Train loss: 1.498, Test loss: 1.681, Test accuracy: 80.74
Round  70, Global train loss: 1.498, Global test loss: 1.908, Global test accuracy: 54.44
Round  71, Train loss: 1.555, Test loss: 1.682, Test accuracy: 80.94
Round  71, Global train loss: 1.555, Global test loss: 1.881, Global test accuracy: 59.52
Round  72, Train loss: 1.680, Test loss: 1.702, Test accuracy: 78.98
Round  72, Global train loss: 1.680, Global test loss: 1.979, Global test accuracy: 54.02
Round  73, Train loss: 1.570, Test loss: 1.688, Test accuracy: 80.16
Round  73, Global train loss: 1.570, Global test loss: 1.886, Global test accuracy: 61.16
Round  74, Train loss: 1.722, Test loss: 1.732, Test accuracy: 76.08
Round  74, Global train loss: 1.722, Global test loss: 2.116, Global test accuracy: 35.28
Round  75, Train loss: 1.568, Test loss: 1.697, Test accuracy: 79.70
Round  75, Global train loss: 1.568, Global test loss: 1.893, Global test accuracy: 59.40
Round  76, Train loss: 1.550, Test loss: 1.693, Test accuracy: 79.62
Round  76, Global train loss: 1.550, Global test loss: 1.898, Global test accuracy: 58.48
Round  77, Train loss: 1.640, Test loss: 1.724, Test accuracy: 75.74
Round  77, Global train loss: 1.640, Global test loss: 1.932, Global test accuracy: 54.54
Round  78, Train loss: 1.559, Test loss: 1.691, Test accuracy: 79.74
Round  78, Global train loss: 1.559, Global test loss: 2.002, Global test accuracy: 47.98
Round  79, Train loss: 1.659, Test loss: 1.707, Test accuracy: 78.42
Round  79, Global train loss: 1.659, Global test loss: 1.949, Global test accuracy: 53.40
Round  80, Train loss: 1.483, Test loss: 1.677, Test accuracy: 81.04
Round  80, Global train loss: 1.483, Global test loss: 1.866, Global test accuracy: 64.52
Round  81, Train loss: 1.474, Test loss: 1.663, Test accuracy: 82.18
Round  81, Global train loss: 1.474, Global test loss: 1.853, Global test accuracy: 65.22
Round  82, Train loss: 1.472, Test loss: 1.657, Test accuracy: 82.80
Round  82, Global train loss: 1.472, Global test loss: 1.845, Global test accuracy: 65.84
Round  83, Train loss: 1.471, Test loss: 1.654, Test accuracy: 83.12
Round  83, Global train loss: 1.471, Global test loss: 1.841, Global test accuracy: 66.02
Round  84, Train loss: 1.470, Test loss: 1.650, Test accuracy: 83.40
Round  84, Global train loss: 1.470, Global test loss: 1.837, Global test accuracy: 66.18
Round  85, Train loss: 1.469, Test loss: 1.648, Test accuracy: 83.62
Round  85, Global train loss: 1.469, Global test loss: 1.834, Global test accuracy: 66.32
Round  86, Train loss: 1.469, Test loss: 1.646, Test accuracy: 83.90
Round  86, Global train loss: 1.469, Global test loss: 1.833, Global test accuracy: 66.48
Round  87, Train loss: 1.468, Test loss: 1.645, Test accuracy: 84.12
Round  87, Global train loss: 1.468, Global test loss: 1.832, Global test accuracy: 66.72
Round  88, Train loss: 1.468, Test loss: 1.643, Test accuracy: 84.28
Round  88, Global train loss: 1.468, Global test loss: 1.831, Global test accuracy: 66.62
Round  89, Train loss: 1.468, Test loss: 1.642, Test accuracy: 84.46
Round  89, Global train loss: 1.468, Global test loss: 1.830, Global test accuracy: 66.78
Round  90, Train loss: 1.467, Test loss: 1.642, Test accuracy: 84.44
Round  90, Global train loss: 1.467, Global test loss: 1.829, Global test accuracy: 66.86/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.467, Test loss: 1.641, Test accuracy: 84.40
Round  91, Global train loss: 1.467, Global test loss: 1.828, Global test accuracy: 67.18
Round  92, Train loss: 1.467, Test loss: 1.640, Test accuracy: 84.50
Round  92, Global train loss: 1.467, Global test loss: 1.828, Global test accuracy: 67.14
Round  93, Train loss: 1.467, Test loss: 1.640, Test accuracy: 84.58
Round  93, Global train loss: 1.467, Global test loss: 1.828, Global test accuracy: 67.20
Round  94, Train loss: 1.466, Test loss: 1.639, Test accuracy: 84.70
Round  94, Global train loss: 1.466, Global test loss: 1.826, Global test accuracy: 67.28
Round  95, Train loss: 1.466, Test loss: 1.638, Test accuracy: 84.76
Round  95, Global train loss: 1.466, Global test loss: 1.826, Global test accuracy: 67.36
Round  96, Train loss: 1.466, Test loss: 1.638, Test accuracy: 84.82
Round  96, Global train loss: 1.466, Global test loss: 1.826, Global test accuracy: 67.32
Round  97, Train loss: 1.466, Test loss: 1.638, Test accuracy: 84.88
Round  97, Global train loss: 1.466, Global test loss: 1.826, Global test accuracy: 67.22
Round  98, Train loss: 1.466, Test loss: 1.637, Test accuracy: 84.92
Round  98, Global train loss: 1.466, Global test loss: 1.826, Global test accuracy: 67.34
Round  99, Train loss: 1.629, Test loss: 1.687, Test accuracy: 79.48
Round  99, Global train loss: 1.629, Global test loss: 1.819, Global test accuracy: 75.44
Final Round, Train loss: 1.722, Test loss: 1.676, Test accuracy: 80.68
Final Round, Global train loss: 1.722, Global test loss: 1.819, Global test accuracy: 75.44
Average accuracy final 10 rounds: 84.148
1477.6535813808441
[1.2868084907531738, 2.397188425064087, 3.5573220252990723, 4.699361801147461, 5.819880485534668, 6.961190938949585, 8.12103009223938, 9.290753841400146, 10.434080600738525, 11.539297819137573, 15.339038133621216, 21.951992511749268, 28.616679191589355, 35.26908588409424, 41.94561171531677, 48.63985991477966, 55.27272343635559, 61.997374296188354, 68.90898156166077, 75.77983140945435, 82.625173330307, 89.42830514907837, 96.26670408248901, 103.16944599151611, 110.10920858383179, 117.08784484863281, 118.24075031280518, 125.23348951339722, 126.40134239196777, 133.17546606063843, 139.79966640472412, 146.55321431159973, 153.40791296958923, 160.20673823356628, 167.11770915985107, 174.02327799797058, 180.92135334014893, 187.88047528266907, 194.87959575653076, 201.79961800575256, 208.67767930030823, 215.18131971359253, 222.02963590621948, 228.70898485183716, 229.79688024520874, 236.58137273788452, 243.48587203025818, 250.4354271888733, 257.33402705192566, 264.2705297470093, 271.07370233535767, 278.0251495838165, 284.8379089832306, 291.5839560031891, 298.3687653541565, 305.2632749080658, 312.384024143219, 319.0209400653839, 325.7061221599579, 332.7130608558655, 339.64445090293884, 346.5156512260437, 353.4517595767975, 360.2695336341858, 367.178094625473, 374.0733687877655, 381.20167350769043, 387.8504660129547, 394.73429799079895, 401.66064381599426, 402.77557373046875, 409.50674772262573, 416.2726159095764, 423.10194301605225, 430.004611492157, 436.8190486431122, 443.68115758895874, 450.48155760765076, 456.85925245285034, 463.58550357818604, 464.69329166412354, 465.8162100315094, 466.9285910129547, 468.0520350933075, 469.24640941619873, 470.43763995170593, 471.62381196022034, 472.8126792907715, 473.9708032608032, 475.1014029979706, 476.28216457366943, 477.40330743789673, 478.5354766845703, 479.66879177093506, 480.81446647644043, 481.84185314178467, 482.978143453598, 484.16180205345154, 485.30637192726135, 492.4379549026489, 498.99435114860535]
[18.2, 23.32, 27.88, 33.28, 39.96, 48.16, 57.62, 60.54, 67.78, 72.94, 75.58, 74.8, 74.22, 73.38, 74.02, 73.98, 72.24, 70.06, 72.26, 72.8, 72.84, 73.62, 73.66, 73.66, 74.46, 74.36, 76.16, 75.38, 76.16, 75.36, 76.56, 76.06, 77.96, 77.46, 78.18, 76.82, 74.92, 76.18, 73.72, 71.7, 71.98, 75.54, 75.82, 76.9, 78.54, 78.44, 76.46, 74.48, 79.38, 80.36, 79.32, 76.86, 79.42, 79.08, 76.84, 77.8, 79.54, 78.9, 80.42, 78.24, 77.22, 75.72, 75.32, 78.08, 77.1, 74.68, 73.24, 77.72, 80.54, 78.76, 80.74, 80.94, 78.98, 80.16, 76.08, 79.7, 79.62, 75.74, 79.74, 78.42, 81.04, 82.18, 82.8, 83.12, 83.4, 83.62, 83.9, 84.12, 84.28, 84.46, 84.44, 84.4, 84.5, 84.58, 84.7, 84.76, 84.82, 84.88, 84.92, 79.48, 80.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.290, Test loss: 2.292, Test accuracy: 15.42
Round   0, Global train loss: 2.290, Global test loss: 2.298, Global test accuracy: 10.00
Round   1, Train loss: 2.215, Test loss: 2.230, Test accuracy: 25.22
Round   1, Global train loss: 2.215, Global test loss: 2.266, Global test accuracy: 13.20
Round   2, Train loss: 2.160, Test loss: 2.155, Test accuracy: 36.78
Round   2, Global train loss: 2.160, Global test loss: 2.190, Global test accuracy: 27.62
Round   3, Train loss: 2.108, Test loss: 2.049, Test accuracy: 46.96
Round   3, Global train loss: 2.108, Global test loss: 2.194, Global test accuracy: 22.26
Round   4, Train loss: 1.990, Test loss: 2.011, Test accuracy: 50.58
Round   4, Global train loss: 1.990, Global test loss: 2.184, Global test accuracy: 22.94
Round   5, Train loss: 2.049, Test loss: 1.964, Test accuracy: 54.52
Round   5, Global train loss: 2.049, Global test loss: 2.108, Global test accuracy: 31.82
Round   6, Train loss: 1.790, Test loss: 1.922, Test accuracy: 61.42
Round   6, Global train loss: 1.790, Global test loss: 2.072, Global test accuracy: 42.20
Round   7, Train loss: 1.895, Test loss: 1.878, Test accuracy: 64.82
Round   7, Global train loss: 1.895, Global test loss: 2.028, Global test accuracy: 45.18
Round   8, Train loss: 2.136, Test loss: 1.880, Test accuracy: 61.20
Round   8, Global train loss: 2.136, Global test loss: 2.187, Global test accuracy: 19.42
Round   9, Train loss: 1.830, Test loss: 1.860, Test accuracy: 61.66
Round   9, Global train loss: 1.830, Global test loss: 2.147, Global test accuracy: 25.80
Round  10, Train loss: 1.725, Test loss: 1.806, Test accuracy: 68.54
Round  10, Global train loss: 1.725, Global test loss: 2.053, Global test accuracy: 40.48
Round  11, Train loss: 1.920, Test loss: 1.795, Test accuracy: 68.84
Round  11, Global train loss: 1.920, Global test loss: 2.016, Global test accuracy: 48.06
Round  12, Train loss: 1.784, Test loss: 1.788, Test accuracy: 68.74
Round  12, Global train loss: 1.784, Global test loss: 1.999, Global test accuracy: 47.00
Round  13, Train loss: 1.799, Test loss: 1.782, Test accuracy: 68.70
Round  13, Global train loss: 1.799, Global test loss: 2.042, Global test accuracy: 46.34
Round  14, Train loss: 1.819, Test loss: 1.778, Test accuracy: 68.84
Round  14, Global train loss: 1.819, Global test loss: 1.975, Global test accuracy: 50.90
Round  15, Train loss: 1.791, Test loss: 1.769, Test accuracy: 69.76
Round  15, Global train loss: 1.791, Global test loss: 2.022, Global test accuracy: 47.58
Round  16, Train loss: 1.846, Test loss: 1.770, Test accuracy: 69.48
Round  16, Global train loss: 1.846, Global test loss: 2.057, Global test accuracy: 38.90
Round  17, Train loss: 1.869, Test loss: 1.769, Test accuracy: 69.44
Round  17, Global train loss: 1.869, Global test loss: 2.002, Global test accuracy: 48.10
Round  18, Train loss: 1.834, Test loss: 1.754, Test accuracy: 71.50
Round  18, Global train loss: 1.834, Global test loss: 2.083, Global test accuracy: 38.04
Round  19, Train loss: 1.660, Test loss: 1.752, Test accuracy: 71.44
Round  19, Global train loss: 1.660, Global test loss: 2.038, Global test accuracy: 40.72
Round  20, Train loss: 1.865, Test loss: 1.753, Test accuracy: 71.30
Round  20, Global train loss: 1.865, Global test loss: 2.113, Global test accuracy: 34.86
Round  21, Train loss: 1.867, Test loss: 1.738, Test accuracy: 73.10
Round  21, Global train loss: 1.867, Global test loss: 2.048, Global test accuracy: 41.00
Round  22, Train loss: 1.711, Test loss: 1.735, Test accuracy: 73.50
Round  22, Global train loss: 1.711, Global test loss: 2.040, Global test accuracy: 41.42
Round  23, Train loss: 1.704, Test loss: 1.735, Test accuracy: 73.40
Round  23, Global train loss: 1.704, Global test loss: 2.027, Global test accuracy: 42.56
Round  24, Train loss: 1.824, Test loss: 1.720, Test accuracy: 75.50
Round  24, Global train loss: 1.824, Global test loss: 2.093, Global test accuracy: 35.32
Round  25, Train loss: 1.896, Test loss: 1.705, Test accuracy: 76.94
Round  25, Global train loss: 1.896, Global test loss: 2.045, Global test accuracy: 46.02
Round  26, Train loss: 1.795, Test loss: 1.704, Test accuracy: 76.70
Round  26, Global train loss: 1.795, Global test loss: 2.033, Global test accuracy: 42.84
Round  27, Train loss: 1.719, Test loss: 1.703, Test accuracy: 76.60
Round  27, Global train loss: 1.719, Global test loss: 2.011, Global test accuracy: 44.20
Round  28, Train loss: 1.706, Test loss: 1.698, Test accuracy: 77.68
Round  28, Global train loss: 1.706, Global test loss: 1.993, Global test accuracy: 48.38
Round  29, Train loss: 1.826, Test loss: 1.696, Test accuracy: 77.60
Round  29, Global train loss: 1.826, Global test loss: 2.081, Global test accuracy: 38.52
Round  30, Train loss: 1.867, Test loss: 1.684, Test accuracy: 78.86
Round  30, Global train loss: 1.867, Global test loss: 1.992, Global test accuracy: 47.40
Round  31, Train loss: 1.763, Test loss: 1.682, Test accuracy: 79.10
Round  31, Global train loss: 1.763, Global test loss: 1.933, Global test accuracy: 56.62
Round  32, Train loss: 1.852, Test loss: 1.677, Test accuracy: 79.34
Round  32, Global train loss: 1.852, Global test loss: 2.007, Global test accuracy: 46.18
Round  33, Train loss: 1.776, Test loss: 1.674, Test accuracy: 79.68
Round  33, Global train loss: 1.776, Global test loss: 2.055, Global test accuracy: 41.46
Round  34, Train loss: 1.823, Test loss: 1.675, Test accuracy: 79.44
Round  34, Global train loss: 1.823, Global test loss: 2.104, Global test accuracy: 29.74
Round  35, Train loss: 1.708, Test loss: 1.674, Test accuracy: 79.36
Round  35, Global train loss: 1.708, Global test loss: 2.044, Global test accuracy: 43.74
Round  36, Train loss: 1.822, Test loss: 1.666, Test accuracy: 80.50
Round  36, Global train loss: 1.822, Global test loss: 2.080, Global test accuracy: 37.18
Round  37, Train loss: 1.824, Test loss: 1.668, Test accuracy: 80.14
Round  37, Global train loss: 1.824, Global test loss: 2.015, Global test accuracy: 44.96
Round  38, Train loss: 1.837, Test loss: 1.663, Test accuracy: 80.44
Round  38, Global train loss: 1.837, Global test loss: 2.062, Global test accuracy: 41.64
Round  39, Train loss: 1.691, Test loss: 1.663, Test accuracy: 80.22
Round  39, Global train loss: 1.691, Global test loss: 1.998, Global test accuracy: 44.02
Round  40, Train loss: 1.635, Test loss: 1.662, Test accuracy: 80.40
Round  40, Global train loss: 1.635, Global test loss: 2.133, Global test accuracy: 32.60
Round  41, Train loss: 1.791, Test loss: 1.659, Test accuracy: 80.82
Round  41, Global train loss: 1.791, Global test loss: 2.067, Global test accuracy: 36.84
Round  42, Train loss: 1.738, Test loss: 1.658, Test accuracy: 81.00
Round  42, Global train loss: 1.738, Global test loss: 2.069, Global test accuracy: 38.36
Round  43, Train loss: 1.835, Test loss: 1.651, Test accuracy: 82.00
Round  43, Global train loss: 1.835, Global test loss: 2.021, Global test accuracy: 43.24
Round  44, Train loss: 1.731, Test loss: 1.651, Test accuracy: 81.98
Round  44, Global train loss: 1.731, Global test loss: 2.005, Global test accuracy: 45.68
Round  45, Train loss: 1.754, Test loss: 1.653, Test accuracy: 81.70
Round  45, Global train loss: 1.754, Global test loss: 2.029, Global test accuracy: 44.10
Round  46, Train loss: 1.736, Test loss: 1.647, Test accuracy: 82.10
Round  46, Global train loss: 1.736, Global test loss: 1.953, Global test accuracy: 57.76
Round  47, Train loss: 1.779, Test loss: 1.647, Test accuracy: 82.12
Round  47, Global train loss: 1.779, Global test loss: 2.028, Global test accuracy: 42.20
Round  48, Train loss: 1.696, Test loss: 1.645, Test accuracy: 82.48
Round  48, Global train loss: 1.696, Global test loss: 1.974, Global test accuracy: 50.16
Round  49, Train loss: 1.635, Test loss: 1.646, Test accuracy: 82.34
Round  49, Global train loss: 1.635, Global test loss: 1.998, Global test accuracy: 46.78
Round  50, Train loss: 1.794, Test loss: 1.637, Test accuracy: 83.70
Round  50, Global train loss: 1.794, Global test loss: 2.074, Global test accuracy: 35.84
Round  51, Train loss: 1.682, Test loss: 1.637, Test accuracy: 83.64
Round  51, Global train loss: 1.682, Global test loss: 2.081, Global test accuracy: 36.96
Round  52, Train loss: 1.691, Test loss: 1.637, Test accuracy: 83.60
Round  52, Global train loss: 1.691, Global test loss: 2.023, Global test accuracy: 43.06
Round  53, Train loss: 1.648, Test loss: 1.635, Test accuracy: 83.72
Round  53, Global train loss: 1.648, Global test loss: 1.997, Global test accuracy: 46.28
Round  54, Train loss: 1.721, Test loss: 1.635, Test accuracy: 83.36
Round  54, Global train loss: 1.721, Global test loss: 2.044, Global test accuracy: 41.88
Round  55, Train loss: 1.723, Test loss: 1.630, Test accuracy: 84.04
Round  55, Global train loss: 1.723, Global test loss: 1.991, Global test accuracy: 47.28
Round  56, Train loss: 1.714, Test loss: 1.631, Test accuracy: 84.04
Round  56, Global train loss: 1.714, Global test loss: 1.977, Global test accuracy: 48.30
Round  57, Train loss: 1.664, Test loss: 1.633, Test accuracy: 83.90
Round  57, Global train loss: 1.664, Global test loss: 1.976, Global test accuracy: 47.72
Round  58, Train loss: 1.665, Test loss: 1.627, Test accuracy: 84.44
Round  58, Global train loss: 1.665, Global test loss: 2.103, Global test accuracy: 35.16
Round  59, Train loss: 1.736, Test loss: 1.626, Test accuracy: 84.56
Round  59, Global train loss: 1.736, Global test loss: 2.175, Global test accuracy: 25.72
Round  60, Train loss: 1.587, Test loss: 1.626, Test accuracy: 84.52
Round  60, Global train loss: 1.587, Global test loss: 2.083, Global test accuracy: 37.16
Round  61, Train loss: 1.709, Test loss: 1.628, Test accuracy: 84.16
Round  61, Global train loss: 1.709, Global test loss: 1.972, Global test accuracy: 48.60
Round  62, Train loss: 1.721, Test loss: 1.628, Test accuracy: 83.98
Round  62, Global train loss: 1.721, Global test loss: 2.042, Global test accuracy: 42.14
Round  63, Train loss: 1.617, Test loss: 1.628, Test accuracy: 84.00
Round  63, Global train loss: 1.617, Global test loss: 2.128, Global test accuracy: 33.34
Round  64, Train loss: 1.646, Test loss: 1.628, Test accuracy: 84.12
Round  64, Global train loss: 1.646, Global test loss: 2.027, Global test accuracy: 42.22
Round  65, Train loss: 1.699, Test loss: 1.628, Test accuracy: 84.08
Round  65, Global train loss: 1.699, Global test loss: 2.029, Global test accuracy: 42.28
Round  66, Train loss: 1.696, Test loss: 1.628, Test accuracy: 84.08
Round  66, Global train loss: 1.696, Global test loss: 1.968, Global test accuracy: 49.64
Round  67, Train loss: 1.671, Test loss: 1.628, Test accuracy: 84.06
Round  67, Global train loss: 1.671, Global test loss: 2.019, Global test accuracy: 45.28
Round  68, Train loss: 1.694, Test loss: 1.628, Test accuracy: 84.10
Round  68, Global train loss: 1.694, Global test loss: 1.935, Global test accuracy: 57.20
Round  69, Train loss: 1.563, Test loss: 1.628, Test accuracy: 84.08
Round  69, Global train loss: 1.563, Global test loss: 2.140, Global test accuracy: 31.12
Round  70, Train loss: 1.763, Test loss: 1.628, Test accuracy: 83.96
Round  70, Global train loss: 1.763, Global test loss: 2.006, Global test accuracy: 44.00
Round  71, Train loss: 1.701, Test loss: 1.628, Test accuracy: 83.96
Round  71, Global train loss: 1.701, Global test loss: 1.973, Global test accuracy: 48.04
Round  72, Train loss: 1.650, Test loss: 1.627, Test accuracy: 83.98
Round  72, Global train loss: 1.650, Global test loss: 2.064, Global test accuracy: 38.66
Round  73, Train loss: 1.688, Test loss: 1.627, Test accuracy: 83.94
Round  73, Global train loss: 1.688, Global test loss: 1.895, Global test accuracy: 58.90
Round  74, Train loss: 1.634, Test loss: 1.627, Test accuracy: 83.92
Round  74, Global train loss: 1.634, Global test loss: 2.063, Global test accuracy: 38.54
Round  75, Train loss: 1.693, Test loss: 1.628, Test accuracy: 83.86
Round  75, Global train loss: 1.693, Global test loss: 1.933, Global test accuracy: 57.20
Round  76, Train loss: 1.640, Test loss: 1.628, Test accuracy: 83.90
Round  76, Global train loss: 1.640, Global test loss: 1.992, Global test accuracy: 47.68
Round  77, Train loss: 1.652, Test loss: 1.627, Test accuracy: 83.90
Round  77, Global train loss: 1.652, Global test loss: 1.987, Global test accuracy: 46.48
Round  78, Train loss: 1.642, Test loss: 1.627, Test accuracy: 83.88
Round  78, Global train loss: 1.642, Global test loss: 2.028, Global test accuracy: 42.24
Round  79, Train loss: 1.633, Test loss: 1.627, Test accuracy: 83.88
Round  79, Global train loss: 1.633, Global test loss: 1.950, Global test accuracy: 50.56
Round  80, Train loss: 1.624, Test loss: 1.628, Test accuracy: 83.78
Round  80, Global train loss: 1.624, Global test loss: 2.091, Global test accuracy: 33.78
Round  81, Train loss: 1.687, Test loss: 1.626, Test accuracy: 84.02
Round  81, Global train loss: 1.687, Global test loss: 2.020, Global test accuracy: 43.18
Round  82, Train loss: 1.702, Test loss: 1.626, Test accuracy: 84.10
Round  82, Global train loss: 1.702, Global test loss: 1.968, Global test accuracy: 48.88
Round  83, Train loss: 1.692, Test loss: 1.626, Test accuracy: 84.04
Round  83, Global train loss: 1.692, Global test loss: 1.932, Global test accuracy: 56.88
Round  84, Train loss: 1.644, Test loss: 1.627, Test accuracy: 83.98
Round  84, Global train loss: 1.644, Global test loss: 2.013, Global test accuracy: 43.58
Round  85, Train loss: 1.746, Test loss: 1.627, Test accuracy: 84.04
Round  85, Global train loss: 1.746, Global test loss: 1.997, Global test accuracy: 47.64
Round  86, Train loss: 1.734, Test loss: 1.628, Test accuracy: 83.86
Round  86, Global train loss: 1.734, Global test loss: 1.966, Global test accuracy: 49.20
Round  87, Train loss: 1.685, Test loss: 1.628, Test accuracy: 83.76
Round  87, Global train loss: 1.685, Global test loss: 2.143, Global test accuracy: 30.34
Round  88, Train loss: 1.675, Test loss: 1.628, Test accuracy: 83.76
Round  88, Global train loss: 1.675, Global test loss: 2.030, Global test accuracy: 44.10
Round  89, Train loss: 1.701, Test loss: 1.628, Test accuracy: 83.74
Round  89, Global train loss: 1.701, Global test loss: 1.970, Global test accuracy: 48.66
Round  90, Train loss: 1.677, Test loss: 1.628, Test accuracy: 83.70
Round  90, Global train loss: 1.677, Global test loss: 1.969, Global test accuracy: 50.26
Round  91, Train loss: 1.624, Test loss: 1.628, Test accuracy: 83.70
Round  91, Global train loss: 1.624, Global test loss: 2.014, Global test accuracy: 43.10
Round  92, Train loss: 1.562, Test loss: 1.628, Test accuracy: 83.76
Round  92, Global train loss: 1.562, Global test loss: 2.141, Global test accuracy: 31.14
Round  93, Train loss: 1.631, Test loss: 1.629, Test accuracy: 83.70
Round  93, Global train loss: 1.631, Global test loss: 2.146, Global test accuracy: 30.90/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.630, Test loss: 1.628, Test accuracy: 83.66
Round  94, Global train loss: 1.630, Global test loss: 1.961, Global test accuracy: 52.50
Round  95, Train loss: 1.709, Test loss: 1.628, Test accuracy: 83.66
Round  95, Global train loss: 1.709, Global test loss: 1.965, Global test accuracy: 49.48
Round  96, Train loss: 1.755, Test loss: 1.628, Test accuracy: 83.76
Round  96, Global train loss: 1.755, Global test loss: 1.976, Global test accuracy: 50.46
Round  97, Train loss: 1.630, Test loss: 1.628, Test accuracy: 83.78
Round  97, Global train loss: 1.630, Global test loss: 1.962, Global test accuracy: 52.34
Round  98, Train loss: 1.708, Test loss: 1.628, Test accuracy: 83.74
Round  98, Global train loss: 1.708, Global test loss: 1.965, Global test accuracy: 49.20
Round  99, Train loss: 1.694, Test loss: 1.628, Test accuracy: 83.82
Round  99, Global train loss: 1.694, Global test loss: 2.001, Global test accuracy: 45.30
Final Round, Train loss: 1.671, Test loss: 1.628, Test accuracy: 83.60
Final Round, Global train loss: 1.671, Global test loss: 2.001, Global test accuracy: 45.30
Average accuracy final 10 rounds: 83.72800000000001 

Average global accuracy final 10 rounds: 45.468 

663.896386384964
[0.9820983409881592, 1.9641966819763184, 2.838956832885742, 3.713716983795166, 4.561289548873901, 5.408862113952637, 6.131033897399902, 6.853205680847168, 7.583879709243774, 8.31455373764038, 9.169572114944458, 10.024590492248535, 10.9142587184906, 11.803926944732666, 12.662691354751587, 13.521455764770508, 14.355628490447998, 15.189801216125488, 16.03606390953064, 16.88232660293579, 17.786433696746826, 18.69054079055786, 19.53072452545166, 20.37090826034546, 21.272579669952393, 22.174251079559326, 22.935858488082886, 23.697465896606445, 24.4216206073761, 25.145775318145752, 25.960267543792725, 26.774759769439697, 27.58934473991394, 28.403929710388184, 29.207751750946045, 30.011573791503906, 30.766053676605225, 31.520533561706543, 32.26610231399536, 33.01167106628418, 33.83536076545715, 34.65905046463013, 35.47641348838806, 36.293776512145996, 37.12792754173279, 37.96207857131958, 38.77926230430603, 39.59644603729248, 40.37065625190735, 41.14486646652222, 41.94882583618164, 42.752785205841064, 43.55972933769226, 44.36667346954346, 45.133424043655396, 45.900174617767334, 46.640246868133545, 47.380319118499756, 48.16408896446228, 48.947858810424805, 49.75418710708618, 50.56051540374756, 51.37045216560364, 52.18038892745972, 53.03631663322449, 53.89224433898926, 54.65628743171692, 55.42033052444458, 56.21428322792053, 57.008235931396484, 57.892062187194824, 58.775888442993164, 59.647188901901245, 60.518489360809326, 61.37066459655762, 62.22283983230591, 63.04504656791687, 63.86725330352783, 64.74242854118347, 65.61760377883911, 66.45070672035217, 67.28380966186523, 68.11984133720398, 68.95587301254272, 69.72371292114258, 70.49155282974243, 71.25329971313477, 72.0150465965271, 72.81718826293945, 73.6193299293518, 74.45346713066101, 75.28760433197021, 76.12743592262268, 76.96726751327515, 77.75278377532959, 78.53830003738403, 79.30291366577148, 80.06752729415894, 80.85511326789856, 81.64269924163818, 82.50810027122498, 83.37350130081177, 84.22241711616516, 85.07133293151855, 85.88550400733948, 86.6996750831604, 87.46736216545105, 88.2350492477417, 89.01590299606323, 89.79675674438477, 90.61460018157959, 91.43244361877441, 92.2425606250763, 93.05267763137817, 93.9143385887146, 94.77599954605103, 95.54918932914734, 96.32237911224365, 97.14809250831604, 97.97380590438843, 98.81002354621887, 99.64624118804932, 100.46122145652771, 101.2762017250061, 102.08995938301086, 102.90371704101562, 103.68848323822021, 104.4732494354248, 105.26490950584412, 106.05656957626343, 106.90496826171875, 107.75336694717407, 108.5707778930664, 109.38818883895874, 110.1938054561615, 110.99942207336426, 111.79098701477051, 112.58255195617676, 113.3407073020935, 114.09886264801025, 114.97494316101074, 115.85102367401123, 116.71131014823914, 117.57159662246704, 118.41997122764587, 119.2683458328247, 120.08256340026855, 120.8967809677124, 121.75227403640747, 122.60776710510254, 123.45864057540894, 124.30951404571533, 125.16197156906128, 126.01442909240723, 126.88647842407227, 127.7585277557373, 128.54269313812256, 129.3268585205078, 130.17238402366638, 131.01790952682495, 131.81944346427917, 132.6209774017334, 133.430725812912, 134.24047422409058, 135.01111888885498, 135.78176355361938, 136.5449390411377, 137.308114528656, 138.06383609771729, 138.81955766677856, 139.66794896125793, 140.5163402557373, 141.28325533866882, 142.05017042160034, 142.833420753479, 143.61667108535767, 144.3734152317047, 145.13015937805176, 145.95489144325256, 146.77962350845337, 147.54273629188538, 148.30584907531738, 149.04855465888977, 149.79126024246216, 150.60936975479126, 151.42747926712036, 152.2806842327118, 153.13388919830322, 153.91936659812927, 154.70484399795532, 155.49543976783752, 156.28603553771973, 157.09859704971313, 157.91115856170654, 158.73128509521484, 159.55141162872314, 160.30991554260254, 161.06841945648193, 161.83083605766296, 162.593252658844, 164.18496322631836, 165.77667379379272]
[15.42, 15.42, 25.22, 25.22, 36.78, 36.78, 46.96, 46.96, 50.58, 50.58, 54.52, 54.52, 61.42, 61.42, 64.82, 64.82, 61.2, 61.2, 61.66, 61.66, 68.54, 68.54, 68.84, 68.84, 68.74, 68.74, 68.7, 68.7, 68.84, 68.84, 69.76, 69.76, 69.48, 69.48, 69.44, 69.44, 71.5, 71.5, 71.44, 71.44, 71.3, 71.3, 73.1, 73.1, 73.5, 73.5, 73.4, 73.4, 75.5, 75.5, 76.94, 76.94, 76.7, 76.7, 76.6, 76.6, 77.68, 77.68, 77.6, 77.6, 78.86, 78.86, 79.1, 79.1, 79.34, 79.34, 79.68, 79.68, 79.44, 79.44, 79.36, 79.36, 80.5, 80.5, 80.14, 80.14, 80.44, 80.44, 80.22, 80.22, 80.4, 80.4, 80.82, 80.82, 81.0, 81.0, 82.0, 82.0, 81.98, 81.98, 81.7, 81.7, 82.1, 82.1, 82.12, 82.12, 82.48, 82.48, 82.34, 82.34, 83.7, 83.7, 83.64, 83.64, 83.6, 83.6, 83.72, 83.72, 83.36, 83.36, 84.04, 84.04, 84.04, 84.04, 83.9, 83.9, 84.44, 84.44, 84.56, 84.56, 84.52, 84.52, 84.16, 84.16, 83.98, 83.98, 84.0, 84.0, 84.12, 84.12, 84.08, 84.08, 84.08, 84.08, 84.06, 84.06, 84.1, 84.1, 84.08, 84.08, 83.96, 83.96, 83.96, 83.96, 83.98, 83.98, 83.94, 83.94, 83.92, 83.92, 83.86, 83.86, 83.9, 83.9, 83.9, 83.9, 83.88, 83.88, 83.88, 83.88, 83.78, 83.78, 84.02, 84.02, 84.1, 84.1, 84.04, 84.04, 83.98, 83.98, 84.04, 84.04, 83.86, 83.86, 83.76, 83.76, 83.76, 83.76, 83.74, 83.74, 83.7, 83.7, 83.7, 83.7, 83.76, 83.76, 83.7, 83.7, 83.66, 83.66, 83.66, 83.66, 83.76, 83.76, 83.78, 83.78, 83.74, 83.74, 83.82, 83.82, 83.6, 83.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 5, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.289, Test loss: 2.290, Test accuracy: 22.52
Round   0, Global train loss: 2.289, Global test loss: 2.299, Global test accuracy: 22.48
Round   1, Train loss: 2.251, Test loss: 2.243, Test accuracy: 23.96
Round   1, Global train loss: 2.251, Global test loss: 2.267, Global test accuracy: 29.74
Round   2, Train loss: 2.128, Test loss: 2.174, Test accuracy: 25.22
Round   2, Global train loss: 2.128, Global test loss: 2.196, Global test accuracy: 26.34
Round   3, Train loss: 2.138, Test loss: 2.064, Test accuracy: 39.30
Round   3, Global train loss: 2.138, Global test loss: 2.099, Global test accuracy: 33.16
Round   4, Train loss: 2.011, Test loss: 1.978, Test accuracy: 52.10
Round   4, Global train loss: 2.011, Global test loss: 2.047, Global test accuracy: 44.06
Round   5, Train loss: 1.988, Test loss: 1.922, Test accuracy: 56.72
Round   5, Global train loss: 1.988, Global test loss: 1.974, Global test accuracy: 50.28
Round   6, Train loss: 1.972, Test loss: 1.887, Test accuracy: 58.74
Round   6, Global train loss: 1.972, Global test loss: 1.947, Global test accuracy: 51.14
Round   7, Train loss: 1.895, Test loss: 1.856, Test accuracy: 62.36
Round   7, Global train loss: 1.895, Global test loss: 1.894, Global test accuracy: 59.78
Round   8, Train loss: 1.980, Test loss: 1.816, Test accuracy: 66.36
Round   8, Global train loss: 1.980, Global test loss: 1.994, Global test accuracy: 47.80
Round   9, Train loss: 1.934, Test loss: 1.806, Test accuracy: 67.00
Round   9, Global train loss: 1.934, Global test loss: 1.923, Global test accuracy: 53.18
Round  10, Train loss: 1.960, Test loss: 1.775, Test accuracy: 70.40
Round  10, Global train loss: 1.960, Global test loss: 1.892, Global test accuracy: 57.04
Round  11, Train loss: 1.813, Test loss: 1.741, Test accuracy: 73.32
Round  11, Global train loss: 1.813, Global test loss: 1.863, Global test accuracy: 60.14
Round  12, Train loss: 1.834, Test loss: 1.736, Test accuracy: 73.70
Round  12, Global train loss: 1.834, Global test loss: 1.839, Global test accuracy: 62.18
Round  13, Train loss: 1.843, Test loss: 1.731, Test accuracy: 73.98
Round  13, Global train loss: 1.843, Global test loss: 1.853, Global test accuracy: 60.68
Round  14, Train loss: 1.935, Test loss: 1.713, Test accuracy: 75.70
Round  14, Global train loss: 1.935, Global test loss: 1.823, Global test accuracy: 64.14
Round  15, Train loss: 1.790, Test loss: 1.701, Test accuracy: 77.14
Round  15, Global train loss: 1.790, Global test loss: 1.802, Global test accuracy: 67.66
Round  16, Train loss: 1.902, Test loss: 1.689, Test accuracy: 78.24
Round  16, Global train loss: 1.902, Global test loss: 1.809, Global test accuracy: 65.12
Round  17, Train loss: 1.751, Test loss: 1.689, Test accuracy: 78.22
Round  17, Global train loss: 1.751, Global test loss: 1.765, Global test accuracy: 72.02
Round  18, Train loss: 1.871, Test loss: 1.685, Test accuracy: 78.18
Round  18, Global train loss: 1.871, Global test loss: 1.794, Global test accuracy: 68.76
Round  19, Train loss: 1.879, Test loss: 1.683, Test accuracy: 78.40
Round  19, Global train loss: 1.879, Global test loss: 1.762, Global test accuracy: 70.48
Round  20, Train loss: 1.693, Test loss: 1.683, Test accuracy: 78.32
Round  20, Global train loss: 1.693, Global test loss: 1.775, Global test accuracy: 69.38
Round  21, Train loss: 1.889, Test loss: 1.666, Test accuracy: 80.02
Round  21, Global train loss: 1.889, Global test loss: 1.753, Global test accuracy: 70.74
Round  22, Train loss: 1.857, Test loss: 1.665, Test accuracy: 80.08
Round  22, Global train loss: 1.857, Global test loss: 1.774, Global test accuracy: 69.92
Round  23, Train loss: 1.872, Test loss: 1.666, Test accuracy: 80.08
Round  23, Global train loss: 1.872, Global test loss: 1.821, Global test accuracy: 63.12
Round  24, Train loss: 1.891, Test loss: 1.665, Test accuracy: 80.08
Round  24, Global train loss: 1.891, Global test loss: 1.755, Global test accuracy: 72.04
Round  25, Train loss: 1.751, Test loss: 1.665, Test accuracy: 80.16
Round  25, Global train loss: 1.751, Global test loss: 1.731, Global test accuracy: 74.36
Round  26, Train loss: 1.817, Test loss: 1.662, Test accuracy: 80.48
Round  26, Global train loss: 1.817, Global test loss: 1.725, Global test accuracy: 75.12
Round  27, Train loss: 1.903, Test loss: 1.661, Test accuracy: 80.62
Round  27, Global train loss: 1.903, Global test loss: 1.745, Global test accuracy: 72.60
Round  28, Train loss: 1.736, Test loss: 1.661, Test accuracy: 80.60
Round  28, Global train loss: 1.736, Global test loss: 1.768, Global test accuracy: 69.58
Round  29, Train loss: 1.851, Test loss: 1.660, Test accuracy: 80.46
Round  29, Global train loss: 1.851, Global test loss: 1.764, Global test accuracy: 70.42
Round  30, Train loss: 1.761, Test loss: 1.660, Test accuracy: 80.42
Round  30, Global train loss: 1.761, Global test loss: 1.714, Global test accuracy: 75.24
Round  31, Train loss: 1.705, Test loss: 1.660, Test accuracy: 80.36
Round  31, Global train loss: 1.705, Global test loss: 1.700, Global test accuracy: 77.30
Round  32, Train loss: 1.874, Test loss: 1.658, Test accuracy: 80.58
Round  32, Global train loss: 1.874, Global test loss: 1.722, Global test accuracy: 74.66
Round  33, Train loss: 1.677, Test loss: 1.658, Test accuracy: 80.54
Round  33, Global train loss: 1.677, Global test loss: 1.760, Global test accuracy: 69.06
Round  34, Train loss: 1.844, Test loss: 1.657, Test accuracy: 80.68
Round  34, Global train loss: 1.844, Global test loss: 1.705, Global test accuracy: 76.44
Round  35, Train loss: 1.759, Test loss: 1.658, Test accuracy: 80.56
Round  35, Global train loss: 1.759, Global test loss: 1.697, Global test accuracy: 77.18
Round  36, Train loss: 1.898, Test loss: 1.658, Test accuracy: 80.58
Round  36, Global train loss: 1.898, Global test loss: 1.809, Global test accuracy: 64.72
Round  37, Train loss: 1.862, Test loss: 1.658, Test accuracy: 80.62
Round  37, Global train loss: 1.862, Global test loss: 1.729, Global test accuracy: 73.60
Round  38, Train loss: 1.890, Test loss: 1.659, Test accuracy: 80.42
Round  38, Global train loss: 1.890, Global test loss: 1.742, Global test accuracy: 72.56
Round  39, Train loss: 1.806, Test loss: 1.658, Test accuracy: 80.58
Round  39, Global train loss: 1.806, Global test loss: 1.719, Global test accuracy: 74.60
Round  40, Train loss: 1.702, Test loss: 1.658, Test accuracy: 80.58
Round  40, Global train loss: 1.702, Global test loss: 1.724, Global test accuracy: 74.78
Round  41, Train loss: 1.868, Test loss: 1.657, Test accuracy: 80.62
Round  41, Global train loss: 1.868, Global test loss: 1.725, Global test accuracy: 74.50
Round  42, Train loss: 1.883, Test loss: 1.656, Test accuracy: 80.74
Round  42, Global train loss: 1.883, Global test loss: 1.719, Global test accuracy: 74.68
Round  43, Train loss: 1.856, Test loss: 1.657, Test accuracy: 80.68
Round  43, Global train loss: 1.856, Global test loss: 1.713, Global test accuracy: 75.42
Round  44, Train loss: 1.824, Test loss: 1.657, Test accuracy: 80.62
Round  44, Global train loss: 1.824, Global test loss: 1.701, Global test accuracy: 76.82
Round  45, Train loss: 1.828, Test loss: 1.658, Test accuracy: 80.54
Round  45, Global train loss: 1.828, Global test loss: 1.722, Global test accuracy: 74.50
Round  46, Train loss: 1.754, Test loss: 1.656, Test accuracy: 80.68
Round  46, Global train loss: 1.754, Global test loss: 1.703, Global test accuracy: 76.46
Round  47, Train loss: 1.858, Test loss: 1.657, Test accuracy: 80.62
Round  47, Global train loss: 1.858, Global test loss: 1.700, Global test accuracy: 76.74
Round  48, Train loss: 1.700, Test loss: 1.657, Test accuracy: 80.66
Round  48, Global train loss: 1.700, Global test loss: 1.697, Global test accuracy: 77.12
Round  49, Train loss: 1.832, Test loss: 1.657, Test accuracy: 80.66
Round  49, Global train loss: 1.832, Global test loss: 1.739, Global test accuracy: 72.54
Round  50, Train loss: 1.853, Test loss: 1.657, Test accuracy: 80.58
Round  50, Global train loss: 1.853, Global test loss: 1.737, Global test accuracy: 72.46
Round  51, Train loss: 1.850, Test loss: 1.659, Test accuracy: 80.44
Round  51, Global train loss: 1.850, Global test loss: 1.712, Global test accuracy: 75.62
Round  52, Train loss: 1.843, Test loss: 1.657, Test accuracy: 80.68
Round  52, Global train loss: 1.843, Global test loss: 1.742, Global test accuracy: 72.46
Round  53, Train loss: 1.771, Test loss: 1.657, Test accuracy: 80.66
Round  53, Global train loss: 1.771, Global test loss: 1.750, Global test accuracy: 70.62
Round  54, Train loss: 1.721, Test loss: 1.658, Test accuracy: 80.50
Round  54, Global train loss: 1.721, Global test loss: 1.740, Global test accuracy: 71.88
Round  55, Train loss: 1.838, Test loss: 1.659, Test accuracy: 80.42
Round  55, Global train loss: 1.838, Global test loss: 1.695, Global test accuracy: 77.18
Round  56, Train loss: 1.745, Test loss: 1.659, Test accuracy: 80.34
Round  56, Global train loss: 1.745, Global test loss: 1.732, Global test accuracy: 73.26
Round  57, Train loss: 1.821, Test loss: 1.658, Test accuracy: 80.42
Round  57, Global train loss: 1.821, Global test loss: 1.702, Global test accuracy: 76.94
Round  58, Train loss: 1.877, Test loss: 1.659, Test accuracy: 80.24
Round  58, Global train loss: 1.877, Global test loss: 1.753, Global test accuracy: 70.84
Round  59, Train loss: 1.823, Test loss: 1.658, Test accuracy: 80.46
Round  59, Global train loss: 1.823, Global test loss: 1.739, Global test accuracy: 72.66
Round  60, Train loss: 1.822, Test loss: 1.658, Test accuracy: 80.30
Round  60, Global train loss: 1.822, Global test loss: 1.717, Global test accuracy: 75.18
Round  61, Train loss: 1.737, Test loss: 1.658, Test accuracy: 80.28
Round  61, Global train loss: 1.737, Global test loss: 1.734, Global test accuracy: 73.06
Round  62, Train loss: 1.854, Test loss: 1.659, Test accuracy: 80.16
Round  62, Global train loss: 1.854, Global test loss: 1.702, Global test accuracy: 76.46
Round  63, Train loss: 1.694, Test loss: 1.658, Test accuracy: 80.22
Round  63, Global train loss: 1.694, Global test loss: 1.711, Global test accuracy: 75.76
Round  64, Train loss: 1.815, Test loss: 1.658, Test accuracy: 80.34
Round  64, Global train loss: 1.815, Global test loss: 1.728, Global test accuracy: 73.48
Round  65, Train loss: 1.826, Test loss: 1.657, Test accuracy: 80.40
Round  65, Global train loss: 1.826, Global test loss: 1.714, Global test accuracy: 75.36
Round  66, Train loss: 1.838, Test loss: 1.658, Test accuracy: 80.28
Round  66, Global train loss: 1.838, Global test loss: 1.697, Global test accuracy: 76.82
Round  67, Train loss: 1.818, Test loss: 1.658, Test accuracy: 80.38
Round  67, Global train loss: 1.818, Global test loss: 1.716, Global test accuracy: 74.88
Round  68, Train loss: 1.743, Test loss: 1.658, Test accuracy: 80.36
Round  68, Global train loss: 1.743, Global test loss: 1.699, Global test accuracy: 76.36
Round  69, Train loss: 1.789, Test loss: 1.658, Test accuracy: 80.28
Round  69, Global train loss: 1.789, Global test loss: 1.711, Global test accuracy: 76.00
Round  70, Train loss: 1.864, Test loss: 1.660, Test accuracy: 80.12
Round  70, Global train loss: 1.864, Global test loss: 1.758, Global test accuracy: 70.50
Round  71, Train loss: 1.796, Test loss: 1.660, Test accuracy: 80.12
Round  71, Global train loss: 1.796, Global test loss: 1.694, Global test accuracy: 77.08
Round  72, Train loss: 1.841, Test loss: 1.659, Test accuracy: 80.16
Round  72, Global train loss: 1.841, Global test loss: 1.702, Global test accuracy: 76.08
Round  73, Train loss: 1.688, Test loss: 1.660, Test accuracy: 80.06
Round  73, Global train loss: 1.688, Global test loss: 1.694, Global test accuracy: 77.42
Round  74, Train loss: 1.686, Test loss: 1.661, Test accuracy: 79.98
Round  74, Global train loss: 1.686, Global test loss: 1.742, Global test accuracy: 71.66
Round  75, Train loss: 1.740, Test loss: 1.661, Test accuracy: 80.02
Round  75, Global train loss: 1.740, Global test loss: 1.702, Global test accuracy: 76.34
Round  76, Train loss: 1.708, Test loss: 1.662, Test accuracy: 80.06
Round  76, Global train loss: 1.708, Global test loss: 1.712, Global test accuracy: 75.44
Round  77, Train loss: 1.814, Test loss: 1.661, Test accuracy: 80.08
Round  77, Global train loss: 1.814, Global test loss: 1.697, Global test accuracy: 77.16
Round  78, Train loss: 1.812, Test loss: 1.660, Test accuracy: 80.06
Round  78, Global train loss: 1.812, Global test loss: 1.729, Global test accuracy: 73.32
Round  79, Train loss: 1.785, Test loss: 1.660, Test accuracy: 80.12
Round  79, Global train loss: 1.785, Global test loss: 1.692, Global test accuracy: 77.62
Round  80, Train loss: 1.816, Test loss: 1.660, Test accuracy: 80.02
Round  80, Global train loss: 1.816, Global test loss: 1.691, Global test accuracy: 77.34
Round  81, Train loss: 1.809, Test loss: 1.660, Test accuracy: 80.08
Round  81, Global train loss: 1.809, Global test loss: 1.694, Global test accuracy: 76.88
Round  82, Train loss: 1.715, Test loss: 1.659, Test accuracy: 80.26
Round  82, Global train loss: 1.715, Global test loss: 1.689, Global test accuracy: 77.92
Round  83, Train loss: 1.738, Test loss: 1.660, Test accuracy: 80.18
Round  83, Global train loss: 1.738, Global test loss: 1.692, Global test accuracy: 77.44
Round  84, Train loss: 1.863, Test loss: 1.660, Test accuracy: 80.18
Round  84, Global train loss: 1.863, Global test loss: 1.732, Global test accuracy: 72.96
Round  85, Train loss: 1.837, Test loss: 1.659, Test accuracy: 80.18
Round  85, Global train loss: 1.837, Global test loss: 1.696, Global test accuracy: 76.78
Round  86, Train loss: 1.728, Test loss: 1.659, Test accuracy: 80.22
Round  86, Global train loss: 1.728, Global test loss: 1.691, Global test accuracy: 77.46
Round  87, Train loss: 1.865, Test loss: 1.659, Test accuracy: 80.22
Round  87, Global train loss: 1.865, Global test loss: 1.736, Global test accuracy: 72.56
Round  88, Train loss: 1.731, Test loss: 1.659, Test accuracy: 80.26
Round  88, Global train loss: 1.731, Global test loss: 1.696, Global test accuracy: 76.98
Round  89, Train loss: 1.713, Test loss: 1.659, Test accuracy: 80.22
Round  89, Global train loss: 1.713, Global test loss: 1.688, Global test accuracy: 77.82
Round  90, Train loss: 1.689, Test loss: 1.659, Test accuracy: 80.20
Round  90, Global train loss: 1.689, Global test loss: 1.688, Global test accuracy: 77.62
Round  91, Train loss: 1.788, Test loss: 1.659, Test accuracy: 80.18
Round  91, Global train loss: 1.788, Global test loss: 1.690, Global test accuracy: 77.52
Round  92, Train loss: 1.783, Test loss: 1.660, Test accuracy: 80.16
Round  92, Global train loss: 1.783, Global test loss: 1.708, Global test accuracy: 75.64
Round  93, Train loss: 1.710, Test loss: 1.660, Test accuracy: 80.20
Round  93, Global train loss: 1.710, Global test loss: 1.707, Global test accuracy: 75.84/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.709, Test loss: 1.659, Test accuracy: 80.36
Round  94, Global train loss: 1.709, Global test loss: 1.687, Global test accuracy: 78.12
Round  95, Train loss: 1.840, Test loss: 1.659, Test accuracy: 80.42
Round  95, Global train loss: 1.840, Global test loss: 1.694, Global test accuracy: 76.96
Round  96, Train loss: 1.836, Test loss: 1.659, Test accuracy: 80.48
Round  96, Global train loss: 1.836, Global test loss: 1.691, Global test accuracy: 77.30
Round  97, Train loss: 1.709, Test loss: 1.659, Test accuracy: 80.30
Round  97, Global train loss: 1.709, Global test loss: 1.689, Global test accuracy: 77.90
Round  98, Train loss: 1.838, Test loss: 1.660, Test accuracy: 80.26
Round  98, Global train loss: 1.838, Global test loss: 1.695, Global test accuracy: 76.96
Round  99, Train loss: 1.729, Test loss: 1.663, Test accuracy: 79.86
Round  99, Global train loss: 1.729, Global test loss: 1.717, Global test accuracy: 74.86
Final Round, Train loss: 1.786, Test loss: 1.646, Test accuracy: 81.56
Final Round, Global train loss: 1.786, Global test loss: 1.717, Global test accuracy: 74.86
Average accuracy final 10 rounds: 80.242 

Average global accuracy final 10 rounds: 76.872 

668.7442469596863
[0.9417212009429932, 1.8834424018859863, 2.702371835708618, 3.52130126953125, 4.29381251335144, 5.066323757171631, 5.877658367156982, 6.688992977142334, 7.564248561859131, 8.439504146575928, 9.267881870269775, 10.096259593963623, 10.916134357452393, 11.736009120941162, 12.4882230758667, 13.240437030792236, 14.061594009399414, 14.882750988006592, 15.67633581161499, 16.46992063522339, 17.27870011329651, 18.08747959136963, 18.909194231033325, 19.73090887069702, 20.550798892974854, 21.370688915252686, 22.161606311798096, 22.952523708343506, 23.73915934562683, 24.525794982910156, 25.357523441314697, 26.18925189971924, 26.960129976272583, 27.731008052825928, 28.55860924720764, 29.386210441589355, 30.194084882736206, 31.001959323883057, 31.890466690063477, 32.7789740562439, 33.63544321060181, 34.49191236495972, 35.30856108665466, 36.12520980834961, 36.90127420425415, 37.67733860015869, 38.50626349449158, 39.33518838882446, 40.13553476333618, 40.9358811378479, 41.75576138496399, 42.57564163208008, 43.3512704372406, 44.12689924240112, 44.93296146392822, 45.73902368545532, 46.53231453895569, 47.325605392456055, 48.1744544506073, 49.023303508758545, 49.846306800842285, 50.669310092926025, 51.45763945579529, 52.24596881866455, 53.016427993774414, 53.78688716888428, 54.581257820129395, 55.37562847137451, 56.16730713844299, 56.958985805511475, 57.733357429504395, 58.507729053497314, 59.28544783592224, 60.06316661834717, 60.827160596847534, 61.5911545753479, 62.46791195869446, 63.344669342041016, 64.1641116142273, 64.98355388641357, 65.7703275680542, 66.55710124969482, 67.36113286018372, 68.16516447067261, 69.06424236297607, 69.96332025527954, 70.76682567596436, 71.57033109664917, 72.34084582328796, 73.11136054992676, 73.93860149383545, 74.76584243774414, 75.53067874908447, 76.2955150604248, 77.1343104839325, 77.97310590744019, 78.82610726356506, 79.67910861968994, 80.53278303146362, 81.3864574432373, 82.25550246238708, 83.12454748153687, 83.91154050827026, 84.69853353500366, 85.50032997131348, 86.30212640762329, 87.12736535072327, 87.95260429382324, 88.75918006896973, 89.56575584411621, 90.35193204879761, 91.138108253479, 91.94793176651001, 92.75775527954102, 93.55480408668518, 94.35185289382935, 95.17378187179565, 95.99571084976196, 96.8227436542511, 97.64977645874023, 98.3994951248169, 99.14921379089355, 99.9461772441864, 100.74314069747925, 101.54382562637329, 102.34451055526733, 103.16288709640503, 103.98126363754272, 104.76658344268799, 105.55190324783325, 106.3533866405487, 107.15487003326416, 107.96572184562683, 108.7765736579895, 109.56063747406006, 110.34470129013062, 111.144207239151, 111.94371318817139, 112.72723460197449, 113.51075601577759, 114.34415411949158, 115.17755222320557, 115.9232542514801, 116.66895627975464, 117.48096966743469, 118.29298305511475, 119.07221150398254, 119.85143995285034, 120.65064311027527, 121.4498462677002, 122.27036261558533, 123.09087896347046, 123.95025944709778, 124.8096399307251, 125.6092460155487, 126.40885210037231, 127.16711711883545, 127.92538213729858, 128.72763323783875, 129.5298843383789, 130.30316710472107, 131.07644987106323, 131.8849914073944, 132.6935329437256, 133.49615097045898, 134.29876899719238, 135.12904238700867, 135.95931577682495, 136.76387405395508, 137.5684323310852, 138.3700156211853, 139.1715989112854, 139.96969032287598, 140.76778173446655, 141.51944541931152, 142.2711091041565, 143.17001104354858, 144.06891298294067, 144.91803908348083, 145.767165184021, 146.59513902664185, 147.4231128692627, 148.23526072502136, 149.04740858078003, 149.85168957710266, 150.6559705734253, 151.48166155815125, 152.3073525428772, 153.1068398952484, 153.90632724761963, 154.71483039855957, 155.5233335494995, 156.36796855926514, 157.21260356903076, 158.03589057922363, 158.8591775894165, 159.68296933174133, 160.50676107406616, 161.31332230567932, 162.11988353729248, 163.74557852745056, 165.37127351760864]
[22.52, 22.52, 23.96, 23.96, 25.22, 25.22, 39.3, 39.3, 52.1, 52.1, 56.72, 56.72, 58.74, 58.74, 62.36, 62.36, 66.36, 66.36, 67.0, 67.0, 70.4, 70.4, 73.32, 73.32, 73.7, 73.7, 73.98, 73.98, 75.7, 75.7, 77.14, 77.14, 78.24, 78.24, 78.22, 78.22, 78.18, 78.18, 78.4, 78.4, 78.32, 78.32, 80.02, 80.02, 80.08, 80.08, 80.08, 80.08, 80.08, 80.08, 80.16, 80.16, 80.48, 80.48, 80.62, 80.62, 80.6, 80.6, 80.46, 80.46, 80.42, 80.42, 80.36, 80.36, 80.58, 80.58, 80.54, 80.54, 80.68, 80.68, 80.56, 80.56, 80.58, 80.58, 80.62, 80.62, 80.42, 80.42, 80.58, 80.58, 80.58, 80.58, 80.62, 80.62, 80.74, 80.74, 80.68, 80.68, 80.62, 80.62, 80.54, 80.54, 80.68, 80.68, 80.62, 80.62, 80.66, 80.66, 80.66, 80.66, 80.58, 80.58, 80.44, 80.44, 80.68, 80.68, 80.66, 80.66, 80.5, 80.5, 80.42, 80.42, 80.34, 80.34, 80.42, 80.42, 80.24, 80.24, 80.46, 80.46, 80.3, 80.3, 80.28, 80.28, 80.16, 80.16, 80.22, 80.22, 80.34, 80.34, 80.4, 80.4, 80.28, 80.28, 80.38, 80.38, 80.36, 80.36, 80.28, 80.28, 80.12, 80.12, 80.12, 80.12, 80.16, 80.16, 80.06, 80.06, 79.98, 79.98, 80.02, 80.02, 80.06, 80.06, 80.08, 80.08, 80.06, 80.06, 80.12, 80.12, 80.02, 80.02, 80.08, 80.08, 80.26, 80.26, 80.18, 80.18, 80.18, 80.18, 80.18, 80.18, 80.22, 80.22, 80.22, 80.22, 80.26, 80.26, 80.22, 80.22, 80.2, 80.2, 80.18, 80.18, 80.16, 80.16, 80.2, 80.2, 80.36, 80.36, 80.42, 80.42, 80.48, 80.48, 80.3, 80.3, 80.26, 80.26, 79.86, 79.86, 81.56, 81.56]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.295, Test loss: 2.297, Test accuracy: 14.00
Round   0, Global train loss: 2.295, Global test loss: 2.300, Global test accuracy: 12.02
Round   1, Train loss: 2.265, Test loss: 2.254, Test accuracy: 14.00
Round   1, Global train loss: 2.265, Global test loss: 2.269, Global test accuracy: 12.00
Round   2, Train loss: 2.203, Test loss: 2.226, Test accuracy: 19.30
Round   2, Global train loss: 2.203, Global test loss: 2.240, Global test accuracy: 19.30
Round   3, Train loss: 2.204, Test loss: 2.177, Test accuracy: 24.88
Round   3, Global train loss: 2.204, Global test loss: 2.205, Global test accuracy: 28.42
Round   4, Train loss: 2.078, Test loss: 2.094, Test accuracy: 37.68
Round   4, Global train loss: 2.078, Global test loss: 2.127, Global test accuracy: 34.70
Round   5, Train loss: 1.992, Test loss: 1.995, Test accuracy: 50.08
Round   5, Global train loss: 1.992, Global test loss: 2.029, Global test accuracy: 47.10
Round   6, Train loss: 1.806, Test loss: 1.918, Test accuracy: 58.72
Round   6, Global train loss: 1.806, Global test loss: 1.930, Global test accuracy: 54.90
Round   7, Train loss: 1.909, Test loss: 1.881, Test accuracy: 61.96
Round   7, Global train loss: 1.909, Global test loss: 1.929, Global test accuracy: 55.20
Round   8, Train loss: 1.979, Test loss: 1.799, Test accuracy: 69.56
Round   8, Global train loss: 1.979, Global test loss: 1.970, Global test accuracy: 49.10
Round   9, Train loss: 1.833, Test loss: 1.778, Test accuracy: 71.92
Round   9, Global train loss: 1.833, Global test loss: 1.893, Global test accuracy: 57.96
Round  10, Train loss: 1.826, Test loss: 1.755, Test accuracy: 73.68
Round  10, Global train loss: 1.826, Global test loss: 1.846, Global test accuracy: 62.62
Round  11, Train loss: 1.773, Test loss: 1.709, Test accuracy: 78.20
Round  11, Global train loss: 1.773, Global test loss: 1.850, Global test accuracy: 61.82
Round  12, Train loss: 1.844, Test loss: 1.704, Test accuracy: 78.34
Round  12, Global train loss: 1.844, Global test loss: 1.863, Global test accuracy: 60.28
Round  13, Train loss: 1.919, Test loss: 1.701, Test accuracy: 78.38
Round  13, Global train loss: 1.919, Global test loss: 1.825, Global test accuracy: 65.76
Round  14, Train loss: 1.760, Test loss: 1.690, Test accuracy: 79.22
Round  14, Global train loss: 1.760, Global test loss: 1.799, Global test accuracy: 68.34
Round  15, Train loss: 1.808, Test loss: 1.688, Test accuracy: 79.18
Round  15, Global train loss: 1.808, Global test loss: 1.801, Global test accuracy: 68.08
Round  16, Train loss: 1.713, Test loss: 1.685, Test accuracy: 79.32
Round  16, Global train loss: 1.713, Global test loss: 1.832, Global test accuracy: 61.80
Round  17, Train loss: 1.740, Test loss: 1.687, Test accuracy: 78.96
Round  17, Global train loss: 1.740, Global test loss: 1.781, Global test accuracy: 69.92
Round  18, Train loss: 1.914, Test loss: 1.684, Test accuracy: 79.10
Round  18, Global train loss: 1.914, Global test loss: 1.801, Global test accuracy: 68.28
Round  19, Train loss: 1.861, Test loss: 1.684, Test accuracy: 78.98
Round  19, Global train loss: 1.861, Global test loss: 1.815, Global test accuracy: 64.92
Round  20, Train loss: 1.864, Test loss: 1.682, Test accuracy: 79.16
Round  20, Global train loss: 1.864, Global test loss: 1.807, Global test accuracy: 65.12
Round  21, Train loss: 1.836, Test loss: 1.676, Test accuracy: 79.22
Round  21, Global train loss: 1.836, Global test loss: 1.789, Global test accuracy: 68.08
Round  22, Train loss: 1.893, Test loss: 1.676, Test accuracy: 79.16
Round  22, Global train loss: 1.893, Global test loss: 1.783, Global test accuracy: 68.22
Round  23, Train loss: 1.618, Test loss: 1.675, Test accuracy: 79.34
Round  23, Global train loss: 1.618, Global test loss: 1.805, Global test accuracy: 65.58
Round  24, Train loss: 1.900, Test loss: 1.676, Test accuracy: 79.26
Round  24, Global train loss: 1.900, Global test loss: 1.803, Global test accuracy: 66.74
Round  25, Train loss: 1.861, Test loss: 1.670, Test accuracy: 79.82
Round  25, Global train loss: 1.861, Global test loss: 1.774, Global test accuracy: 69.80
Round  26, Train loss: 1.755, Test loss: 1.667, Test accuracy: 79.98
Round  26, Global train loss: 1.755, Global test loss: 1.735, Global test accuracy: 74.72
Round  27, Train loss: 1.929, Test loss: 1.669, Test accuracy: 79.80
Round  27, Global train loss: 1.929, Global test loss: 1.751, Global test accuracy: 72.34
Round  28, Train loss: 1.740, Test loss: 1.673, Test accuracy: 79.46
Round  28, Global train loss: 1.740, Global test loss: 1.780, Global test accuracy: 68.70
Round  29, Train loss: 1.854, Test loss: 1.674, Test accuracy: 79.48
Round  29, Global train loss: 1.854, Global test loss: 1.767, Global test accuracy: 70.54
Round  30, Train loss: 1.730, Test loss: 1.671, Test accuracy: 79.66
Round  30, Global train loss: 1.730, Global test loss: 1.729, Global test accuracy: 74.48
Round  31, Train loss: 1.839, Test loss: 1.670, Test accuracy: 79.92
Round  31, Global train loss: 1.839, Global test loss: 1.725, Global test accuracy: 74.90
Round  32, Train loss: 1.787, Test loss: 1.669, Test accuracy: 79.74
Round  32, Global train loss: 1.787, Global test loss: 1.724, Global test accuracy: 75.20
Round  33, Train loss: 1.840, Test loss: 1.674, Test accuracy: 79.14
Round  33, Global train loss: 1.840, Global test loss: 1.763, Global test accuracy: 70.26
Round  34, Train loss: 1.925, Test loss: 1.669, Test accuracy: 79.64
Round  34, Global train loss: 1.925, Global test loss: 1.741, Global test accuracy: 72.96
Round  35, Train loss: 1.878, Test loss: 1.668, Test accuracy: 79.72
Round  35, Global train loss: 1.878, Global test loss: 1.734, Global test accuracy: 73.88
Round  36, Train loss: 1.815, Test loss: 1.667, Test accuracy: 79.98
Round  36, Global train loss: 1.815, Global test loss: 1.773, Global test accuracy: 69.30
Round  37, Train loss: 1.777, Test loss: 1.666, Test accuracy: 80.02
Round  37, Global train loss: 1.777, Global test loss: 1.739, Global test accuracy: 73.02
Round  38, Train loss: 1.887, Test loss: 1.665, Test accuracy: 79.94
Round  38, Global train loss: 1.887, Global test loss: 1.763, Global test accuracy: 70.62
Round  39, Train loss: 1.809, Test loss: 1.666, Test accuracy: 79.90
Round  39, Global train loss: 1.809, Global test loss: 1.746, Global test accuracy: 72.06
Round  40, Train loss: 1.903, Test loss: 1.666, Test accuracy: 80.00
Round  40, Global train loss: 1.903, Global test loss: 1.734, Global test accuracy: 73.64
Round  41, Train loss: 1.810, Test loss: 1.665, Test accuracy: 80.20
Round  41, Global train loss: 1.810, Global test loss: 1.731, Global test accuracy: 74.18
Round  42, Train loss: 1.916, Test loss: 1.666, Test accuracy: 80.10
Round  42, Global train loss: 1.916, Global test loss: 1.734, Global test accuracy: 73.68
Round  43, Train loss: 1.759, Test loss: 1.666, Test accuracy: 80.10
Round  43, Global train loss: 1.759, Global test loss: 1.725, Global test accuracy: 74.20
Round  44, Train loss: 1.607, Test loss: 1.666, Test accuracy: 79.98
Round  44, Global train loss: 1.607, Global test loss: 1.708, Global test accuracy: 75.90
Round  45, Train loss: 1.797, Test loss: 1.665, Test accuracy: 80.10
Round  45, Global train loss: 1.797, Global test loss: 1.736, Global test accuracy: 72.84
Round  46, Train loss: 1.914, Test loss: 1.665, Test accuracy: 80.10
Round  46, Global train loss: 1.914, Global test loss: 1.724, Global test accuracy: 74.16
Round  47, Train loss: 1.881, Test loss: 1.663, Test accuracy: 80.20
Round  47, Global train loss: 1.881, Global test loss: 1.747, Global test accuracy: 71.68
Round  48, Train loss: 1.861, Test loss: 1.663, Test accuracy: 80.28
Round  48, Global train loss: 1.861, Global test loss: 1.726, Global test accuracy: 74.20
Round  49, Train loss: 1.896, Test loss: 1.663, Test accuracy: 80.16
Round  49, Global train loss: 1.896, Global test loss: 1.773, Global test accuracy: 69.08
Round  50, Train loss: 1.799, Test loss: 1.664, Test accuracy: 80.20
Round  50, Global train loss: 1.799, Global test loss: 1.773, Global test accuracy: 69.00
Round  51, Train loss: 1.635, Test loss: 1.663, Test accuracy: 80.30
Round  51, Global train loss: 1.635, Global test loss: 1.713, Global test accuracy: 75.44
Round  52, Train loss: 1.599, Test loss: 1.662, Test accuracy: 80.28
Round  52, Global train loss: 1.599, Global test loss: 1.730, Global test accuracy: 73.56
Round  53, Train loss: 1.724, Test loss: 1.662, Test accuracy: 80.30
Round  53, Global train loss: 1.724, Global test loss: 1.727, Global test accuracy: 74.14
Round  54, Train loss: 1.876, Test loss: 1.662, Test accuracy: 80.30
Round  54, Global train loss: 1.876, Global test loss: 1.776, Global test accuracy: 68.52
Round  55, Train loss: 1.596, Test loss: 1.663, Test accuracy: 80.08
Round  55, Global train loss: 1.596, Global test loss: 1.699, Global test accuracy: 77.12
Round  56, Train loss: 1.873, Test loss: 1.664, Test accuracy: 79.94
Round  56, Global train loss: 1.873, Global test loss: 1.731, Global test accuracy: 73.36
Round  57, Train loss: 1.691, Test loss: 1.664, Test accuracy: 79.92
Round  57, Global train loss: 1.691, Global test loss: 1.705, Global test accuracy: 76.46
Round  58, Train loss: 1.772, Test loss: 1.664, Test accuracy: 79.88
Round  58, Global train loss: 1.772, Global test loss: 1.753, Global test accuracy: 70.94
Round  59, Train loss: 1.822, Test loss: 1.661, Test accuracy: 80.18
Round  59, Global train loss: 1.822, Global test loss: 1.750, Global test accuracy: 71.60
Round  60, Train loss: 1.757, Test loss: 1.662, Test accuracy: 80.18
Round  60, Global train loss: 1.757, Global test loss: 1.737, Global test accuracy: 72.74
Round  61, Train loss: 1.778, Test loss: 1.663, Test accuracy: 80.14
Round  61, Global train loss: 1.778, Global test loss: 1.732, Global test accuracy: 73.16
Round  62, Train loss: 1.798, Test loss: 1.661, Test accuracy: 80.38
Round  62, Global train loss: 1.798, Global test loss: 1.712, Global test accuracy: 75.44
Round  63, Train loss: 1.889, Test loss: 1.660, Test accuracy: 80.40
Round  63, Global train loss: 1.889, Global test loss: 1.726, Global test accuracy: 74.26
Round  64, Train loss: 1.765, Test loss: 1.662, Test accuracy: 80.22
Round  64, Global train loss: 1.765, Global test loss: 1.758, Global test accuracy: 70.62
Round  65, Train loss: 1.824, Test loss: 1.663, Test accuracy: 80.08
Round  65, Global train loss: 1.824, Global test loss: 1.718, Global test accuracy: 75.22
Round  66, Train loss: 1.683, Test loss: 1.663, Test accuracy: 80.04
Round  66, Global train loss: 1.683, Global test loss: 1.699, Global test accuracy: 76.98
Round  67, Train loss: 1.851, Test loss: 1.662, Test accuracy: 80.16
Round  67, Global train loss: 1.851, Global test loss: 1.715, Global test accuracy: 75.32
Round  68, Train loss: 1.902, Test loss: 1.661, Test accuracy: 80.32
Round  68, Global train loss: 1.902, Global test loss: 1.719, Global test accuracy: 74.38
Round  69, Train loss: 1.778, Test loss: 1.661, Test accuracy: 80.30
Round  69, Global train loss: 1.778, Global test loss: 1.715, Global test accuracy: 75.38
Round  70, Train loss: 1.662, Test loss: 1.663, Test accuracy: 80.14
Round  70, Global train loss: 1.662, Global test loss: 1.738, Global test accuracy: 72.58
Round  71, Train loss: 1.790, Test loss: 1.662, Test accuracy: 80.18
Round  71, Global train loss: 1.790, Global test loss: 1.707, Global test accuracy: 75.80
Round  72, Train loss: 1.718, Test loss: 1.663, Test accuracy: 80.10
Round  72, Global train loss: 1.718, Global test loss: 1.705, Global test accuracy: 76.10
Round  73, Train loss: 1.817, Test loss: 1.663, Test accuracy: 80.04
Round  73, Global train loss: 1.817, Global test loss: 1.706, Global test accuracy: 76.36
Round  74, Train loss: 1.718, Test loss: 1.665, Test accuracy: 79.72
Round  74, Global train loss: 1.718, Global test loss: 1.747, Global test accuracy: 71.64
Round  75, Train loss: 1.899, Test loss: 1.664, Test accuracy: 79.86
Round  75, Global train loss: 1.899, Global test loss: 1.739, Global test accuracy: 72.28
Round  76, Train loss: 1.712, Test loss: 1.664, Test accuracy: 79.92
Round  76, Global train loss: 1.712, Global test loss: 1.729, Global test accuracy: 73.68
Round  77, Train loss: 1.685, Test loss: 1.664, Test accuracy: 79.96
Round  77, Global train loss: 1.685, Global test loss: 1.712, Global test accuracy: 75.34
Round  78, Train loss: 1.762, Test loss: 1.664, Test accuracy: 79.98
Round  78, Global train loss: 1.762, Global test loss: 1.757, Global test accuracy: 70.70
Round  79, Train loss: 1.710, Test loss: 1.665, Test accuracy: 79.90
Round  79, Global train loss: 1.710, Global test loss: 1.706, Global test accuracy: 76.02
Round  80, Train loss: 1.927, Test loss: 1.664, Test accuracy: 79.90
Round  80, Global train loss: 1.927, Global test loss: 1.709, Global test accuracy: 75.62
Round  81, Train loss: 1.768, Test loss: 1.666, Test accuracy: 79.72
Round  81, Global train loss: 1.768, Global test loss: 1.709, Global test accuracy: 75.74
Round  82, Train loss: 1.788, Test loss: 1.665, Test accuracy: 79.82
Round  82, Global train loss: 1.788, Global test loss: 1.706, Global test accuracy: 76.02
Round  83, Train loss: 1.894, Test loss: 1.665, Test accuracy: 79.76
Round  83, Global train loss: 1.894, Global test loss: 1.722, Global test accuracy: 74.10
Round  84, Train loss: 1.731, Test loss: 1.665, Test accuracy: 79.76
Round  84, Global train loss: 1.731, Global test loss: 1.730, Global test accuracy: 73.56
Round  85, Train loss: 1.663, Test loss: 1.663, Test accuracy: 79.94
Round  85, Global train loss: 1.663, Global test loss: 1.707, Global test accuracy: 75.82
Round  86, Train loss: 1.683, Test loss: 1.664, Test accuracy: 80.14
Round  86, Global train loss: 1.683, Global test loss: 1.698, Global test accuracy: 76.86
Round  87, Train loss: 1.849, Test loss: 1.664, Test accuracy: 80.18
Round  87, Global train loss: 1.849, Global test loss: 1.726, Global test accuracy: 73.78
Round  88, Train loss: 1.839, Test loss: 1.664, Test accuracy: 79.96
Round  88, Global train loss: 1.839, Global test loss: 1.708, Global test accuracy: 75.72
Round  89, Train loss: 1.786, Test loss: 1.663, Test accuracy: 80.18
Round  89, Global train loss: 1.786, Global test loss: 1.702, Global test accuracy: 76.36
Round  90, Train loss: 1.843, Test loss: 1.665, Test accuracy: 79.92
Round  90, Global train loss: 1.843, Global test loss: 1.711, Global test accuracy: 75.52
Round  91, Train loss: 1.741, Test loss: 1.663, Test accuracy: 80.08
Round  91, Global train loss: 1.741, Global test loss: 1.708, Global test accuracy: 75.90
Round  92, Train loss: 1.773, Test loss: 1.663, Test accuracy: 80.08
Round  92, Global train loss: 1.773, Global test loss: 1.711, Global test accuracy: 75.56
Round  93, Train loss: 1.848, Test loss: 1.663, Test accuracy: 79.90
Round  93, Global train loss: 1.848, Global test loss: 1.723, Global test accuracy: 74.32
Round  94, Train loss: 1.741, Test loss: 1.663, Test accuracy: 79.96
Round  94, Global train loss: 1.741, Global test loss: 1.723, Global test accuracy: 74.18/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.833, Test loss: 1.664, Test accuracy: 79.92
Round  95, Global train loss: 1.833, Global test loss: 1.711, Global test accuracy: 75.44
Round  96, Train loss: 1.748, Test loss: 1.664, Test accuracy: 79.98
Round  96, Global train loss: 1.748, Global test loss: 1.702, Global test accuracy: 76.50
Round  97, Train loss: 1.740, Test loss: 1.664, Test accuracy: 80.00
Round  97, Global train loss: 1.740, Global test loss: 1.712, Global test accuracy: 75.42
Round  98, Train loss: 1.832, Test loss: 1.663, Test accuracy: 80.00
Round  98, Global train loss: 1.832, Global test loss: 1.711, Global test accuracy: 75.38
Round  99, Train loss: 1.687, Test loss: 1.664, Test accuracy: 79.92
Round  99, Global train loss: 1.687, Global test loss: 1.710, Global test accuracy: 75.60
Final Round, Train loss: 1.768, Test loss: 1.661, Test accuracy: 80.30
Final Round, Global train loss: 1.768, Global test loss: 1.710, Global test accuracy: 75.60
Average accuracy final 10 rounds: 79.976 

Average global accuracy final 10 rounds: 75.382 

691.9147391319275
[1.020918846130371, 2.041837692260742, 2.9125888347625732, 3.7833399772644043, 4.652020692825317, 5.5207014083862305, 6.3807432651519775, 7.240785121917725, 8.1564199924469, 9.072054862976074, 9.948067903518677, 10.82408094406128, 11.691894054412842, 12.559707164764404, 13.43851613998413, 14.317325115203857, 15.159159183502197, 16.000993251800537, 16.867460012435913, 17.73392677307129, 18.591912508010864, 19.44989824295044, 20.32089614868164, 21.191894054412842, 22.03912615776062, 22.8863582611084, 23.7615385055542, 24.63671875, 25.48652720451355, 26.3363356590271, 27.193452835083008, 28.050570011138916, 28.918503522872925, 29.786437034606934, 30.624539852142334, 31.462642669677734, 32.326629638671875, 33.190616607666016, 34.0797598361969, 34.96890306472778, 35.856425523757935, 36.743947982788086, 37.645134687423706, 38.546321392059326, 39.42631649971008, 40.30631160736084, 41.27209830284119, 42.23788499832153, 43.195900678634644, 44.153916358947754, 45.08989357948303, 46.02587080001831, 46.940471172332764, 47.85507154464722, 48.75769233703613, 49.66031312942505, 50.563955307006836, 51.46759748458862, 52.348971128463745, 53.23034477233887, 54.121301889419556, 55.012259006500244, 55.856998443603516, 56.70173788070679, 57.61347842216492, 58.52521896362305, 59.382421255111694, 60.23962354660034, 61.133161306381226, 62.02669906616211, 62.88406491279602, 63.74143075942993, 64.60529160499573, 65.46915245056152, 66.35742163658142, 67.24569082260132, 68.1232795715332, 69.00086832046509, 69.85360813140869, 70.7063479423523, 71.56115770339966, 72.41596746444702, 73.34343600273132, 74.27090454101562, 75.13882255554199, 76.00674057006836, 76.86114454269409, 77.71554851531982, 78.56392478942871, 79.4123010635376, 80.26486563682556, 81.11743021011353, 81.96614718437195, 82.81486415863037, 83.6570417881012, 84.49921941757202, 85.40203523635864, 86.30485105514526, 87.3294095993042, 88.35396814346313, 89.29109215736389, 90.22821617126465, 91.1793384552002, 92.13046073913574, 93.0482349395752, 93.96600914001465, 94.87764835357666, 95.78928756713867, 96.67650890350342, 97.56373023986816, 98.48076939582825, 99.39780855178833, 100.35551190376282, 101.3132152557373, 102.25324726104736, 103.19327926635742, 104.11860370635986, 105.0439281463623, 105.94033169746399, 106.83673524856567, 107.7286868095398, 108.62063837051392, 109.48886513710022, 110.35709190368652, 111.24709844589233, 112.13710498809814, 113.09108567237854, 114.04506635665894, 114.99090814590454, 115.93674993515015, 116.79607701301575, 117.65540409088135, 118.55251145362854, 119.44961881637573, 120.30444645881653, 121.15927410125732, 122.00848960876465, 122.85770511627197, 123.76310300827026, 124.66850090026855, 125.60426831245422, 126.54003572463989, 127.4247510433197, 128.3094663619995, 129.18288731575012, 130.05630826950073, 130.9249391555786, 131.7935700416565, 132.63756775856018, 133.48156547546387, 134.39919471740723, 135.3168239593506, 136.20260906219482, 137.08839416503906, 137.9945285320282, 138.90066289901733, 139.79522681236267, 140.689790725708, 141.56444692611694, 142.43910312652588, 143.31059622764587, 144.18208932876587, 145.10738348960876, 146.03267765045166, 146.97236728668213, 147.9120569229126, 148.79027771949768, 149.66849851608276, 150.54697608947754, 151.42545366287231, 152.32329511642456, 153.2211365699768, 154.15666675567627, 155.09219694137573, 156.01195073127747, 156.9317045211792, 157.77195072174072, 158.61219692230225, 159.52125525474548, 160.43031358718872, 161.30649638175964, 162.18267917633057, 163.06291246414185, 163.94314575195312, 164.8250503540039, 165.7069549560547, 166.57683420181274, 167.4467134475708, 168.334157705307, 169.2216019630432, 170.0544672012329, 170.8873324394226, 171.77515196800232, 172.66297149658203, 173.54763197898865, 174.43229246139526, 175.3238136768341, 176.21533489227295, 177.1086666584015, 178.00199842453003, 179.79250979423523, 181.58302116394043]
[14.0, 14.0, 14.0, 14.0, 19.3, 19.3, 24.88, 24.88, 37.68, 37.68, 50.08, 50.08, 58.72, 58.72, 61.96, 61.96, 69.56, 69.56, 71.92, 71.92, 73.68, 73.68, 78.2, 78.2, 78.34, 78.34, 78.38, 78.38, 79.22, 79.22, 79.18, 79.18, 79.32, 79.32, 78.96, 78.96, 79.1, 79.1, 78.98, 78.98, 79.16, 79.16, 79.22, 79.22, 79.16, 79.16, 79.34, 79.34, 79.26, 79.26, 79.82, 79.82, 79.98, 79.98, 79.8, 79.8, 79.46, 79.46, 79.48, 79.48, 79.66, 79.66, 79.92, 79.92, 79.74, 79.74, 79.14, 79.14, 79.64, 79.64, 79.72, 79.72, 79.98, 79.98, 80.02, 80.02, 79.94, 79.94, 79.9, 79.9, 80.0, 80.0, 80.2, 80.2, 80.1, 80.1, 80.1, 80.1, 79.98, 79.98, 80.1, 80.1, 80.1, 80.1, 80.2, 80.2, 80.28, 80.28, 80.16, 80.16, 80.2, 80.2, 80.3, 80.3, 80.28, 80.28, 80.3, 80.3, 80.3, 80.3, 80.08, 80.08, 79.94, 79.94, 79.92, 79.92, 79.88, 79.88, 80.18, 80.18, 80.18, 80.18, 80.14, 80.14, 80.38, 80.38, 80.4, 80.4, 80.22, 80.22, 80.08, 80.08, 80.04, 80.04, 80.16, 80.16, 80.32, 80.32, 80.3, 80.3, 80.14, 80.14, 80.18, 80.18, 80.1, 80.1, 80.04, 80.04, 79.72, 79.72, 79.86, 79.86, 79.92, 79.92, 79.96, 79.96, 79.98, 79.98, 79.9, 79.9, 79.9, 79.9, 79.72, 79.72, 79.82, 79.82, 79.76, 79.76, 79.76, 79.76, 79.94, 79.94, 80.14, 80.14, 80.18, 80.18, 79.96, 79.96, 80.18, 80.18, 79.92, 79.92, 80.08, 80.08, 80.08, 80.08, 79.9, 79.9, 79.96, 79.96, 79.92, 79.92, 79.98, 79.98, 80.0, 80.0, 80.0, 80.0, 79.92, 79.92, 80.3, 80.3]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 6, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.316, Test loss: 2.299, Test accuracy: 13.98
Round   0, Global train loss: 2.316, Global test loss: 2.299, Global test accuracy: 12.90
Round   1, Train loss: 2.290, Test loss: 2.291, Test accuracy: 24.62
Round   1, Global train loss: 2.290, Global test loss: 2.293, Global test accuracy: 25.00
Round   2, Train loss: 2.284, Test loss: 2.275, Test accuracy: 17.96
Round   2, Global train loss: 2.284, Global test loss: 2.280, Global test accuracy: 15.56
Round   3, Train loss: 2.256, Test loss: 2.240, Test accuracy: 33.16
Round   3, Global train loss: 2.256, Global test loss: 2.256, Global test accuracy: 33.58
Round   4, Train loss: 2.222, Test loss: 2.195, Test accuracy: 34.06
Round   4, Global train loss: 2.222, Global test loss: 2.223, Global test accuracy: 30.14
Round   5, Train loss: 2.144, Test loss: 2.106, Test accuracy: 42.00
Round   5, Global train loss: 2.144, Global test loss: 2.127, Global test accuracy: 32.44
Round   6, Train loss: 2.056, Test loss: 2.028, Test accuracy: 51.66
Round   6, Global train loss: 2.056, Global test loss: 2.066, Global test accuracy: 46.34
Round   7, Train loss: 2.045, Test loss: 1.988, Test accuracy: 56.18
Round   7, Global train loss: 2.045, Global test loss: 2.056, Global test accuracy: 44.36
Round   8, Train loss: 1.980, Test loss: 1.911, Test accuracy: 62.22
Round   8, Global train loss: 1.980, Global test loss: 2.040, Global test accuracy: 48.52
Round   9, Train loss: 1.790, Test loss: 1.865, Test accuracy: 63.74
Round   9, Global train loss: 1.790, Global test loss: 1.974, Global test accuracy: 53.30
Round  10, Train loss: 1.888, Test loss: 1.828, Test accuracy: 67.98
Round  10, Global train loss: 1.888, Global test loss: 1.938, Global test accuracy: 57.88
Round  11, Train loss: 2.010, Test loss: 1.787, Test accuracy: 75.24
Round  11, Global train loss: 2.010, Global test loss: 1.973, Global test accuracy: 58.10
Round  12, Train loss: 1.848, Test loss: 1.743, Test accuracy: 82.28
Round  12, Global train loss: 1.848, Global test loss: 1.940, Global test accuracy: 60.74
Round  13, Train loss: 1.831, Test loss: 1.725, Test accuracy: 82.54
Round  13, Global train loss: 1.831, Global test loss: 1.916, Global test accuracy: 58.96
Round  14, Train loss: 1.958, Test loss: 1.718, Test accuracy: 83.26
Round  14, Global train loss: 1.958, Global test loss: 1.934, Global test accuracy: 60.48
Round  15, Train loss: 1.818, Test loss: 1.710, Test accuracy: 83.30
Round  15, Global train loss: 1.818, Global test loss: 1.899, Global test accuracy: 61.12
Round  16, Train loss: 1.928, Test loss: 1.707, Test accuracy: 83.62
Round  16, Global train loss: 1.928, Global test loss: 1.967, Global test accuracy: 49.30
Round  17, Train loss: 1.918, Test loss: 1.701, Test accuracy: 83.70
Round  17, Global train loss: 1.918, Global test loss: 1.931, Global test accuracy: 60.72
Round  18, Train loss: 1.710, Test loss: 1.686, Test accuracy: 84.76
Round  18, Global train loss: 1.710, Global test loss: 1.932, Global test accuracy: 56.02
Round  19, Train loss: 1.787, Test loss: 1.667, Test accuracy: 85.52
Round  19, Global train loss: 1.787, Global test loss: 1.909, Global test accuracy: 61.26
Round  20, Train loss: 1.782, Test loss: 1.666, Test accuracy: 85.60
Round  20, Global train loss: 1.782, Global test loss: 1.931, Global test accuracy: 58.28
Round  21, Train loss: 1.908, Test loss: 1.643, Test accuracy: 88.60
Round  21, Global train loss: 1.908, Global test loss: 1.907, Global test accuracy: 63.86
Round  22, Train loss: 1.654, Test loss: 1.641, Test accuracy: 89.18
Round  22, Global train loss: 1.654, Global test loss: 1.900, Global test accuracy: 58.52
Round  23, Train loss: 1.899, Test loss: 1.646, Test accuracy: 88.96
Round  23, Global train loss: 1.899, Global test loss: 1.949, Global test accuracy: 51.06
Round  24, Train loss: 1.786, Test loss: 1.637, Test accuracy: 89.82
Round  24, Global train loss: 1.786, Global test loss: 1.885, Global test accuracy: 67.06
Round  25, Train loss: 1.886, Test loss: 1.633, Test accuracy: 89.78
Round  25, Global train loss: 1.886, Global test loss: 1.899, Global test accuracy: 60.58
Round  26, Train loss: 1.779, Test loss: 1.622, Test accuracy: 90.18
Round  26, Global train loss: 1.779, Global test loss: 1.895, Global test accuracy: 63.78
Round  27, Train loss: 1.756, Test loss: 1.619, Test accuracy: 90.12
Round  27, Global train loss: 1.756, Global test loss: 1.929, Global test accuracy: 57.20
Round  28, Train loss: 1.872, Test loss: 1.621, Test accuracy: 90.38
Round  28, Global train loss: 1.872, Global test loss: 1.888, Global test accuracy: 62.08
Round  29, Train loss: 1.758, Test loss: 1.620, Test accuracy: 90.60
Round  29, Global train loss: 1.758, Global test loss: 1.868, Global test accuracy: 65.52
Round  30, Train loss: 1.895, Test loss: 1.610, Test accuracy: 90.96
Round  30, Global train loss: 1.895, Global test loss: 1.874, Global test accuracy: 68.32
Round  31, Train loss: 1.742, Test loss: 1.610, Test accuracy: 91.10
Round  31, Global train loss: 1.742, Global test loss: 1.860, Global test accuracy: 63.86
Round  32, Train loss: 1.881, Test loss: 1.608, Test accuracy: 90.88
Round  32, Global train loss: 1.881, Global test loss: 1.869, Global test accuracy: 67.38
Round  33, Train loss: 1.738, Test loss: 1.608, Test accuracy: 91.18
Round  33, Global train loss: 1.738, Global test loss: 1.902, Global test accuracy: 60.84
Round  34, Train loss: 1.734, Test loss: 1.600, Test accuracy: 91.20
Round  34, Global train loss: 1.734, Global test loss: 1.903, Global test accuracy: 63.84
Round  35, Train loss: 1.743, Test loss: 1.597, Test accuracy: 91.14
Round  35, Global train loss: 1.743, Global test loss: 1.873, Global test accuracy: 64.78
Round  36, Train loss: 1.859, Test loss: 1.598, Test accuracy: 91.14
Round  36, Global train loss: 1.859, Global test loss: 1.926, Global test accuracy: 53.10
Round  37, Train loss: 1.860, Test loss: 1.603, Test accuracy: 91.06
Round  37, Global train loss: 1.860, Global test loss: 1.863, Global test accuracy: 67.38
Round  38, Train loss: 1.839, Test loss: 1.600, Test accuracy: 91.10
Round  38, Global train loss: 1.839, Global test loss: 1.912, Global test accuracy: 59.48
Round  39, Train loss: 1.730, Test loss: 1.596, Test accuracy: 91.10
Round  39, Global train loss: 1.730, Global test loss: 1.854, Global test accuracy: 71.34
Round  40, Train loss: 1.611, Test loss: 1.592, Test accuracy: 91.30
Round  40, Global train loss: 1.611, Global test loss: 1.985, Global test accuracy: 46.28
Round  41, Train loss: 1.855, Test loss: 1.594, Test accuracy: 91.16
Round  41, Global train loss: 1.855, Global test loss: 1.903, Global test accuracy: 61.20
Round  42, Train loss: 1.721, Test loss: 1.592, Test accuracy: 91.04
Round  42, Global train loss: 1.721, Global test loss: 1.926, Global test accuracy: 55.70
Round  43, Train loss: 1.859, Test loss: 1.599, Test accuracy: 90.50
Round  43, Global train loss: 1.859, Global test loss: 1.909, Global test accuracy: 59.50
Round  44, Train loss: 1.868, Test loss: 1.602, Test accuracy: 90.44
Round  44, Global train loss: 1.868, Global test loss: 1.929, Global test accuracy: 53.10
Round  45, Train loss: 1.727, Test loss: 1.595, Test accuracy: 91.20
Round  45, Global train loss: 1.727, Global test loss: 1.930, Global test accuracy: 59.94
Round  46, Train loss: 1.822, Test loss: 1.594, Test accuracy: 91.04
Round  46, Global train loss: 1.822, Global test loss: 1.852, Global test accuracy: 69.34
Round  47, Train loss: 1.821, Test loss: 1.597, Test accuracy: 90.92
Round  47, Global train loss: 1.821, Global test loss: 1.888, Global test accuracy: 62.08
Round  48, Train loss: 1.705, Test loss: 1.595, Test accuracy: 91.04
Round  48, Global train loss: 1.705, Global test loss: 1.857, Global test accuracy: 65.12
Round  49, Train loss: 1.599, Test loss: 1.590, Test accuracy: 91.00
Round  49, Global train loss: 1.599, Global test loss: 1.879, Global test accuracy: 63.36
Round  50, Train loss: 1.822, Test loss: 1.593, Test accuracy: 91.06
Round  50, Global train loss: 1.822, Global test loss: 1.902, Global test accuracy: 59.34
Round  51, Train loss: 1.851, Test loss: 1.598, Test accuracy: 90.56
Round  51, Global train loss: 1.851, Global test loss: 1.945, Global test accuracy: 55.74
Round  52, Train loss: 1.862, Test loss: 1.596, Test accuracy: 90.92
Round  52, Global train loss: 1.862, Global test loss: 1.965, Global test accuracy: 49.24
Round  53, Train loss: 1.721, Test loss: 1.601, Test accuracy: 90.70
Round  53, Global train loss: 1.721, Global test loss: 1.912, Global test accuracy: 58.08
Round  54, Train loss: 1.812, Test loss: 1.602, Test accuracy: 90.22
Round  54, Global train loss: 1.812, Global test loss: 1.886, Global test accuracy: 64.96
Round  55, Train loss: 1.844, Test loss: 1.598, Test accuracy: 90.66
Round  55, Global train loss: 1.844, Global test loss: 1.903, Global test accuracy: 61.08
Round  56, Train loss: 1.816, Test loss: 1.598, Test accuracy: 90.48
Round  56, Global train loss: 1.816, Global test loss: 1.866, Global test accuracy: 66.78
Round  57, Train loss: 1.831, Test loss: 1.605, Test accuracy: 90.32
Round  57, Global train loss: 1.831, Global test loss: 1.931, Global test accuracy: 52.98
Round  58, Train loss: 1.732, Test loss: 1.596, Test accuracy: 90.40
Round  58, Global train loss: 1.732, Global test loss: 1.954, Global test accuracy: 49.22
Round  59, Train loss: 1.696, Test loss: 1.592, Test accuracy: 90.68
Round  59, Global train loss: 1.696, Global test loss: 1.939, Global test accuracy: 54.32
Round  60, Train loss: 1.711, Test loss: 1.599, Test accuracy: 90.26
Round  60, Global train loss: 1.711, Global test loss: 1.937, Global test accuracy: 56.54
Round  61, Train loss: 1.822, Test loss: 1.595, Test accuracy: 90.58
Round  61, Global train loss: 1.822, Global test loss: 1.881, Global test accuracy: 65.00
Round  62, Train loss: 1.816, Test loss: 1.600, Test accuracy: 90.66
Round  62, Global train loss: 1.816, Global test loss: 1.920, Global test accuracy: 58.82
Round  63, Train loss: 1.591, Test loss: 1.594, Test accuracy: 90.60
Round  63, Global train loss: 1.591, Global test loss: 1.968, Global test accuracy: 49.22
Round  64, Train loss: 1.802, Test loss: 1.604, Test accuracy: 89.84
Round  64, Global train loss: 1.802, Global test loss: 1.899, Global test accuracy: 62.38
Round  65, Train loss: 1.703, Test loss: 1.597, Test accuracy: 90.36
Round  65, Global train loss: 1.703, Global test loss: 1.878, Global test accuracy: 62.90
Round  66, Train loss: 1.813, Test loss: 1.601, Test accuracy: 90.12
Round  66, Global train loss: 1.813, Global test loss: 1.887, Global test accuracy: 63.30
Round  67, Train loss: 1.588, Test loss: 1.591, Test accuracy: 90.72
Round  67, Global train loss: 1.588, Global test loss: 1.879, Global test accuracy: 60.92
Round  68, Train loss: 1.785, Test loss: 1.598, Test accuracy: 90.04
Round  68, Global train loss: 1.785, Global test loss: 1.859, Global test accuracy: 66.84
Round  69, Train loss: 1.587, Test loss: 1.594, Test accuracy: 90.34
Round  69, Global train loss: 1.587, Global test loss: 1.941, Global test accuracy: 53.94
Round  70, Train loss: 1.832, Test loss: 1.592, Test accuracy: 90.54
Round  70, Global train loss: 1.832, Global test loss: 1.978, Global test accuracy: 47.24
Round  71, Train loss: 1.700, Test loss: 1.597, Test accuracy: 90.42
Round  71, Global train loss: 1.700, Global test loss: 1.883, Global test accuracy: 59.00
Round  72, Train loss: 1.798, Test loss: 1.604, Test accuracy: 89.64
Round  72, Global train loss: 1.798, Global test loss: 1.943, Global test accuracy: 54.14
Round  73, Train loss: 1.690, Test loss: 1.604, Test accuracy: 90.02
Round  73, Global train loss: 1.690, Global test loss: 1.862, Global test accuracy: 63.84
Round  74, Train loss: 1.784, Test loss: 1.611, Test accuracy: 88.94
Round  74, Global train loss: 1.784, Global test loss: 1.984, Global test accuracy: 50.18
Round  75, Train loss: 1.773, Test loss: 1.610, Test accuracy: 89.12
Round  75, Global train loss: 1.773, Global test loss: 1.868, Global test accuracy: 66.20
Round  76, Train loss: 1.781, Test loss: 1.621, Test accuracy: 88.34
Round  76, Global train loss: 1.781, Global test loss: 1.924, Global test accuracy: 58.14
Round  77, Train loss: 1.786, Test loss: 1.619, Test accuracy: 88.66
Round  77, Global train loss: 1.786, Global test loss: 1.956, Global test accuracy: 48.74
Round  78, Train loss: 1.768, Test loss: 1.623, Test accuracy: 88.06
Round  78, Global train loss: 1.768, Global test loss: 1.917, Global test accuracy: 59.46
Round  79, Train loss: 1.678, Test loss: 1.615, Test accuracy: 88.70
Round  79, Global train loss: 1.678, Global test loss: 1.909, Global test accuracy: 56.58
Round  80, Train loss: 1.582, Test loss: 1.599, Test accuracy: 89.44
Round  80, Global train loss: 1.582, Global test loss: 1.976, Global test accuracy: 49.72
Round  81, Train loss: 1.698, Test loss: 1.589, Test accuracy: 90.50
Round  81, Global train loss: 1.698, Global test loss: 1.910, Global test accuracy: 62.58
Round  82, Train loss: 1.779, Test loss: 1.605, Test accuracy: 89.10
Round  82, Global train loss: 1.779, Global test loss: 1.911, Global test accuracy: 58.40
Round  83, Train loss: 1.759, Test loss: 1.610, Test accuracy: 88.68
Round  83, Global train loss: 1.759, Global test loss: 1.875, Global test accuracy: 64.64
Round  84, Train loss: 1.709, Test loss: 1.593, Test accuracy: 90.68
Round  84, Global train loss: 1.709, Global test loss: 1.932, Global test accuracy: 53.84
Round  85, Train loss: 1.792, Test loss: 1.590, Test accuracy: 91.32
Round  85, Global train loss: 1.792, Global test loss: 1.871, Global test accuracy: 63.32
Round  86, Train loss: 1.771, Test loss: 1.594, Test accuracy: 90.80
Round  86, Global train loss: 1.771, Global test loss: 1.830, Global test accuracy: 75.20
Round  87, Train loss: 1.676, Test loss: 1.591, Test accuracy: 91.18
Round  87, Global train loss: 1.676, Global test loss: 1.963, Global test accuracy: 52.06
Round  88, Train loss: 1.656, Test loss: 1.595, Test accuracy: 91.08
Round  88, Global train loss: 1.656, Global test loss: 1.859, Global test accuracy: 68.24
Round  89, Train loss: 1.762, Test loss: 1.608, Test accuracy: 90.00
Round  89, Global train loss: 1.762, Global test loss: 1.917, Global test accuracy: 58.02
Round  90, Train loss: 1.654, Test loss: 1.604, Test accuracy: 90.14
Round  90, Global train loss: 1.654, Global test loss: 1.871, Global test accuracy: 63.90/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.666, Test loss: 1.617, Test accuracy: 88.54
Round  91, Global train loss: 1.666, Global test loss: 1.898, Global test accuracy: 60.74
Round  92, Train loss: 1.569, Test loss: 1.602, Test accuracy: 89.72
Round  92, Global train loss: 1.569, Global test loss: 1.961, Global test accuracy: 51.58
Round  93, Train loss: 1.648, Test loss: 1.604, Test accuracy: 89.80
Round  93, Global train loss: 1.648, Global test loss: 1.924, Global test accuracy: 59.40
Round  94, Train loss: 1.733, Test loss: 1.621, Test accuracy: 88.32
Round  94, Global train loss: 1.733, Global test loss: 1.915, Global test accuracy: 59.78
Round  95, Train loss: 1.767, Test loss: 1.611, Test accuracy: 89.36
Round  95, Global train loss: 1.767, Global test loss: 1.913, Global test accuracy: 59.78
Round  96, Train loss: 1.762, Test loss: 1.617, Test accuracy: 89.38
Round  96, Global train loss: 1.762, Global test loss: 1.884, Global test accuracy: 62.92
Round  97, Train loss: 1.729, Test loss: 1.625, Test accuracy: 88.14
Round  97, Global train loss: 1.729, Global test loss: 1.907, Global test accuracy: 61.56
Round  98, Train loss: 1.755, Test loss: 1.618, Test accuracy: 88.88
Round  98, Global train loss: 1.755, Global test loss: 1.928, Global test accuracy: 56.50
Round  99, Train loss: 1.760, Test loss: 1.613, Test accuracy: 88.94
Round  99, Global train loss: 1.760, Global test loss: 1.925, Global test accuracy: 57.90
Final Round, Train loss: 1.687, Test loss: 1.608, Test accuracy: 88.74
Final Round, Global train loss: 1.687, Global test loss: 1.925, Global test accuracy: 57.90
Average accuracy final 10 rounds: 89.12200000000001
575.812629699707
[1.1656091213226318, 2.156632900238037, 3.1411561965942383, 4.0966315269470215, 5.052506446838379, 6.0961973667144775, 7.104992151260376, 8.091510534286499, 9.047651290893555, 9.992286682128906, 10.936704874038696, 11.921619176864624, 12.89913558959961, 13.874036073684692, 14.871252536773682, 15.832871437072754, 16.848166942596436, 17.816182374954224, 18.781524181365967, 19.765092134475708, 20.79437279701233, 21.811445951461792, 22.84893274307251, 23.841556310653687, 24.839438915252686, 25.79255247116089, 26.80891466140747, 27.778205156326294, 28.724576950073242, 29.781639575958252, 30.815619230270386, 31.80401921272278, 32.784881353378296, 33.75560450553894, 34.72190237045288, 35.69120407104492, 36.698978900909424, 37.72163510322571, 38.69457268714905, 39.690452337265015, 40.66841506958008, 41.61836552619934, 42.6160888671875, 43.635910749435425, 44.723408937454224, 45.78032350540161, 46.79502773284912, 47.79037022590637, 48.78408694267273, 49.79663300514221, 50.80770397186279, 51.855578660964966, 52.91071343421936, 53.9472553730011, 54.99687480926514, 55.95985245704651, 57.00136065483093, 58.032018184661865, 59.02493858337402, 60.01270008087158, 60.98625111579895, 61.96115207672119, 62.97700905799866, 63.99878191947937, 64.99199104309082, 66.0087263584137, 67.02837872505188, 68.0033073425293, 68.95242404937744, 69.95482468605042, 70.96123719215393, 71.94194984436035, 72.98413276672363, 73.9821183681488, 74.92742347717285, 75.89903163909912, 76.88103008270264, 77.8586938381195, 78.82904195785522, 79.79020023345947, 80.78156733512878, 81.75307416915894, 82.80021905899048, 83.75366115570068, 84.72978091239929, 85.73181200027466, 86.75767040252686, 87.7395133972168, 88.71280074119568, 89.70052170753479, 90.69759583473206, 91.69366526603699, 92.6614887714386, 93.67374038696289, 94.66157627105713, 95.63538813591003, 96.61240196228027, 97.56569409370422, 98.5585527420044, 99.54133343696594, 101.15540361404419]
[13.98, 24.62, 17.96, 33.16, 34.06, 42.0, 51.66, 56.18, 62.22, 63.74, 67.98, 75.24, 82.28, 82.54, 83.26, 83.3, 83.62, 83.7, 84.76, 85.52, 85.6, 88.6, 89.18, 88.96, 89.82, 89.78, 90.18, 90.12, 90.38, 90.6, 90.96, 91.1, 90.88, 91.18, 91.2, 91.14, 91.14, 91.06, 91.1, 91.1, 91.3, 91.16, 91.04, 90.5, 90.44, 91.2, 91.04, 90.92, 91.04, 91.0, 91.06, 90.56, 90.92, 90.7, 90.22, 90.66, 90.48, 90.32, 90.4, 90.68, 90.26, 90.58, 90.66, 90.6, 89.84, 90.36, 90.12, 90.72, 90.04, 90.34, 90.54, 90.42, 89.64, 90.02, 88.94, 89.12, 88.34, 88.66, 88.06, 88.7, 89.44, 90.5, 89.1, 88.68, 90.68, 91.32, 90.8, 91.18, 91.08, 90.0, 90.14, 88.54, 89.72, 89.8, 88.32, 89.36, 89.38, 88.14, 88.88, 88.94, 88.74]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.4  

   Client 0, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.319, Test loss: 2.298, Test accuracy: 21.12
Round   0, Global train loss: 2.319, Global test loss: 2.300, Global test accuracy: 15.00
Round   1, Train loss: 2.292, Test loss: 2.290, Test accuracy: 36.04
Round   1, Global train loss: 2.292, Global test loss: 2.297, Global test accuracy: 25.86
Round   2, Train loss: 2.281, Test loss: 2.275, Test accuracy: 40.76
Round   2, Global train loss: 2.281, Global test loss: 2.289, Global test accuracy: 36.26
Round   3, Train loss: 2.254, Test loss: 2.229, Test accuracy: 38.08
Round   3, Global train loss: 2.254, Global test loss: 2.268, Global test accuracy: 35.82
Round   4, Train loss: 2.205, Test loss: 2.155, Test accuracy: 40.06
Round   4, Global train loss: 2.205, Global test loss: 2.230, Global test accuracy: 41.68
Round   5, Train loss: 2.149, Test loss: 2.068, Test accuracy: 53.40
Round   5, Global train loss: 2.149, Global test loss: 2.169, Global test accuracy: 43.50
Round   6, Train loss: 2.079, Test loss: 1.957, Test accuracy: 62.02
Round   6, Global train loss: 2.079, Global test loss: 2.086, Global test accuracy: 43.76
Round   7, Train loss: 2.025, Test loss: 1.892, Test accuracy: 63.92
Round   7, Global train loss: 2.025, Global test loss: 2.044, Global test accuracy: 47.70
Round   8, Train loss: 1.995, Test loss: 1.856, Test accuracy: 67.78
Round   8, Global train loss: 1.995, Global test loss: 2.019, Global test accuracy: 50.00
Round   9, Train loss: 1.970, Test loss: 1.825, Test accuracy: 70.78
Round   9, Global train loss: 1.970, Global test loss: 1.997, Global test accuracy: 54.20
Round  10, Train loss: 1.833, Test loss: 1.795, Test accuracy: 73.74
Round  10, Global train loss: 1.833, Global test loss: 1.967, Global test accuracy: 53.84
Round  11, Train loss: 1.735, Test loss: 1.756, Test accuracy: 77.36
Round  11, Global train loss: 1.735, Global test loss: 1.975, Global test accuracy: 47.46
Round  12, Train loss: 1.710, Test loss: 1.722, Test accuracy: 80.64
Round  12, Global train loss: 1.710, Global test loss: 1.935, Global test accuracy: 58.82
Round  13, Train loss: 1.707, Test loss: 1.697, Test accuracy: 82.62
Round  13, Global train loss: 1.707, Global test loss: 1.888, Global test accuracy: 70.20
Round  14, Train loss: 1.679, Test loss: 1.689, Test accuracy: 83.06
Round  14, Global train loss: 1.679, Global test loss: 1.883, Global test accuracy: 62.06
Round  15, Train loss: 1.667, Test loss: 1.677, Test accuracy: 83.56
Round  15, Global train loss: 1.667, Global test loss: 1.860, Global test accuracy: 71.36
Round  16, Train loss: 1.644, Test loss: 1.666, Test accuracy: 83.86
Round  16, Global train loss: 1.644, Global test loss: 1.907, Global test accuracy: 56.04
Round  17, Train loss: 1.645, Test loss: 1.665, Test accuracy: 83.86
Round  17, Global train loss: 1.645, Global test loss: 1.902, Global test accuracy: 57.04
Round  18, Train loss: 1.681, Test loss: 1.656, Test accuracy: 83.98
Round  18, Global train loss: 1.681, Global test loss: 1.940, Global test accuracy: 52.84
Round  19, Train loss: 1.642, Test loss: 1.639, Test accuracy: 86.08
Round  19, Global train loss: 1.642, Global test loss: 1.879, Global test accuracy: 63.58
Round  20, Train loss: 1.654, Test loss: 1.628, Test accuracy: 87.54
Round  20, Global train loss: 1.654, Global test loss: 1.914, Global test accuracy: 57.40
Round  21, Train loss: 1.665, Test loss: 1.610, Test accuracy: 89.36
Round  21, Global train loss: 1.665, Global test loss: 1.901, Global test accuracy: 58.48
Round  22, Train loss: 1.629, Test loss: 1.608, Test accuracy: 89.60
Round  22, Global train loss: 1.629, Global test loss: 1.883, Global test accuracy: 62.50
Round  23, Train loss: 1.607, Test loss: 1.608, Test accuracy: 89.52
Round  23, Global train loss: 1.607, Global test loss: 1.897, Global test accuracy: 57.78
Round  24, Train loss: 1.650, Test loss: 1.604, Test accuracy: 89.78
Round  24, Global train loss: 1.650, Global test loss: 1.901, Global test accuracy: 60.44
Round  25, Train loss: 1.647, Test loss: 1.599, Test accuracy: 90.08
Round  25, Global train loss: 1.647, Global test loss: 1.889, Global test accuracy: 62.26
Round  26, Train loss: 1.652, Test loss: 1.598, Test accuracy: 90.46
Round  26, Global train loss: 1.652, Global test loss: 1.832, Global test accuracy: 75.40
Round  27, Train loss: 1.612, Test loss: 1.593, Test accuracy: 90.48
Round  27, Global train loss: 1.612, Global test loss: 1.857, Global test accuracy: 68.32
Round  28, Train loss: 1.603, Test loss: 1.591, Test accuracy: 90.62
Round  28, Global train loss: 1.603, Global test loss: 1.888, Global test accuracy: 58.20
Round  29, Train loss: 1.645, Test loss: 1.592, Test accuracy: 90.52
Round  29, Global train loss: 1.645, Global test loss: 1.891, Global test accuracy: 61.58
Round  30, Train loss: 1.636, Test loss: 1.591, Test accuracy: 90.22
Round  30, Global train loss: 1.636, Global test loss: 1.812, Global test accuracy: 72.08
Round  31, Train loss: 1.610, Test loss: 1.591, Test accuracy: 90.26
Round  31, Global train loss: 1.610, Global test loss: 1.813, Global test accuracy: 68.80
Round  32, Train loss: 1.638, Test loss: 1.591, Test accuracy: 90.50
Round  32, Global train loss: 1.638, Global test loss: 1.854, Global test accuracy: 64.04
Round  33, Train loss: 1.616, Test loss: 1.595, Test accuracy: 90.10
Round  33, Global train loss: 1.616, Global test loss: 1.880, Global test accuracy: 61.04
Round  34, Train loss: 1.639, Test loss: 1.590, Test accuracy: 90.14
Round  34, Global train loss: 1.639, Global test loss: 1.888, Global test accuracy: 70.86
Round  35, Train loss: 1.625, Test loss: 1.588, Test accuracy: 90.34
Round  35, Global train loss: 1.625, Global test loss: 1.839, Global test accuracy: 67.62
Round  36, Train loss: 1.649, Test loss: 1.587, Test accuracy: 90.44
Round  36, Global train loss: 1.649, Global test loss: 1.952, Global test accuracy: 50.62
Round  37, Train loss: 1.627, Test loss: 1.589, Test accuracy: 90.42
Round  37, Global train loss: 1.627, Global test loss: 1.856, Global test accuracy: 63.04
Round  38, Train loss: 1.651, Test loss: 1.588, Test accuracy: 90.54
Round  38, Global train loss: 1.651, Global test loss: 1.920, Global test accuracy: 57.38
Round  39, Train loss: 1.601, Test loss: 1.582, Test accuracy: 90.86
Round  39, Global train loss: 1.601, Global test loss: 1.844, Global test accuracy: 66.96
Round  40, Train loss: 1.595, Test loss: 1.583, Test accuracy: 90.58
Round  40, Global train loss: 1.595, Global test loss: 1.984, Global test accuracy: 44.70
Round  41, Train loss: 1.626, Test loss: 1.582, Test accuracy: 90.72
Round  41, Global train loss: 1.626, Global test loss: 1.907, Global test accuracy: 58.78
Round  42, Train loss: 1.613, Test loss: 1.582, Test accuracy: 90.68
Round  42, Global train loss: 1.613, Global test loss: 1.928, Global test accuracy: 51.14
Round  43, Train loss: 1.600, Test loss: 1.581, Test accuracy: 90.64
Round  43, Global train loss: 1.600, Global test loss: 1.848, Global test accuracy: 65.28
Round  44, Train loss: 1.594, Test loss: 1.579, Test accuracy: 90.92
Round  44, Global train loss: 1.594, Global test loss: 1.863, Global test accuracy: 61.10
Round  45, Train loss: 1.623, Test loss: 1.580, Test accuracy: 90.78
Round  45, Global train loss: 1.623, Global test loss: 1.920, Global test accuracy: 57.78
Round  46, Train loss: 1.616, Test loss: 1.580, Test accuracy: 90.82
Round  46, Global train loss: 1.616, Global test loss: 1.844, Global test accuracy: 64.82
Round  47, Train loss: 1.620, Test loss: 1.581, Test accuracy: 90.74
Round  47, Global train loss: 1.620, Global test loss: 1.865, Global test accuracy: 67.16
Round  48, Train loss: 1.619, Test loss: 1.580, Test accuracy: 90.62
Round  48, Global train loss: 1.619, Global test loss: 1.834, Global test accuracy: 70.30
Round  49, Train loss: 1.614, Test loss: 1.574, Test accuracy: 91.76
Round  49, Global train loss: 1.614, Global test loss: 1.889, Global test accuracy: 63.48
Round  50, Train loss: 1.634, Test loss: 1.571, Test accuracy: 91.94
Round  50, Global train loss: 1.634, Global test loss: 1.880, Global test accuracy: 62.06
Round  51, Train loss: 1.600, Test loss: 1.567, Test accuracy: 92.26
Round  51, Global train loss: 1.600, Global test loss: 1.873, Global test accuracy: 62.74
Round  52, Train loss: 1.581, Test loss: 1.562, Test accuracy: 92.50
Round  52, Global train loss: 1.581, Global test loss: 1.887, Global test accuracy: 58.46
Round  53, Train loss: 1.591, Test loss: 1.567, Test accuracy: 92.28
Round  53, Global train loss: 1.591, Global test loss: 1.888, Global test accuracy: 58.48
Round  54, Train loss: 1.585, Test loss: 1.566, Test accuracy: 92.14
Round  54, Global train loss: 1.585, Global test loss: 1.833, Global test accuracy: 65.38
Round  55, Train loss: 1.605, Test loss: 1.563, Test accuracy: 92.24
Round  55, Global train loss: 1.605, Global test loss: 1.825, Global test accuracy: 67.94
Round  56, Train loss: 1.581, Test loss: 1.563, Test accuracy: 92.18
Round  56, Global train loss: 1.581, Global test loss: 1.856, Global test accuracy: 63.34
Round  57, Train loss: 1.578, Test loss: 1.565, Test accuracy: 92.08
Round  57, Global train loss: 1.578, Global test loss: 1.849, Global test accuracy: 63.12
Round  58, Train loss: 1.594, Test loss: 1.555, Test accuracy: 92.86
Round  58, Global train loss: 1.594, Global test loss: 1.938, Global test accuracy: 50.48
Round  59, Train loss: 1.614, Test loss: 1.546, Test accuracy: 94.36
Round  59, Global train loss: 1.614, Global test loss: 1.912, Global test accuracy: 61.52
Round  60, Train loss: 1.571, Test loss: 1.545, Test accuracy: 94.80
Round  60, Global train loss: 1.571, Global test loss: 1.895, Global test accuracy: 58.82
Round  61, Train loss: 1.581, Test loss: 1.545, Test accuracy: 94.86
Round  61, Global train loss: 1.581, Global test loss: 1.856, Global test accuracy: 63.68
Round  62, Train loss: 1.595, Test loss: 1.547, Test accuracy: 94.68
Round  62, Global train loss: 1.595, Global test loss: 1.858, Global test accuracy: 67.16
Round  63, Train loss: 1.576, Test loss: 1.548, Test accuracy: 94.62
Round  63, Global train loss: 1.576, Global test loss: 1.964, Global test accuracy: 48.74
Round  64, Train loss: 1.575, Test loss: 1.548, Test accuracy: 94.50
Round  64, Global train loss: 1.575, Global test loss: 1.853, Global test accuracy: 63.60
Round  65, Train loss: 1.594, Test loss: 1.548, Test accuracy: 94.40
Round  65, Global train loss: 1.594, Global test loss: 1.847, Global test accuracy: 68.80
Round  66, Train loss: 1.581, Test loss: 1.543, Test accuracy: 94.58
Round  66, Global train loss: 1.581, Global test loss: 1.811, Global test accuracy: 68.38
Round  67, Train loss: 1.581, Test loss: 1.542, Test accuracy: 94.56
Round  67, Global train loss: 1.581, Global test loss: 1.882, Global test accuracy: 59.78
Round  68, Train loss: 1.586, Test loss: 1.542, Test accuracy: 94.60
Round  68, Global train loss: 1.586, Global test loss: 1.816, Global test accuracy: 68.60
Round  69, Train loss: 1.563, Test loss: 1.543, Test accuracy: 94.72
Round  69, Global train loss: 1.563, Global test loss: 1.930, Global test accuracy: 55.88
Round  70, Train loss: 1.584, Test loss: 1.538, Test accuracy: 94.66
Round  70, Global train loss: 1.584, Global test loss: 1.922, Global test accuracy: 52.68
Round  71, Train loss: 1.581, Test loss: 1.542, Test accuracy: 94.68
Round  71, Global train loss: 1.581, Global test loss: 1.850, Global test accuracy: 63.94
Round  72, Train loss: 1.579, Test loss: 1.542, Test accuracy: 94.68
Round  72, Global train loss: 1.579, Global test loss: 1.870, Global test accuracy: 62.42
Round  73, Train loss: 1.575, Test loss: 1.544, Test accuracy: 94.60
Round  73, Global train loss: 1.575, Global test loss: 1.794, Global test accuracy: 73.00
Round  74, Train loss: 1.564, Test loss: 1.545, Test accuracy: 94.62
Round  74, Global train loss: 1.564, Global test loss: 1.892, Global test accuracy: 58.40
Round  75, Train loss: 1.582, Test loss: 1.544, Test accuracy: 94.54
Round  75, Global train loss: 1.582, Global test loss: 1.820, Global test accuracy: 66.88
Round  76, Train loss: 1.562, Test loss: 1.545, Test accuracy: 94.68
Round  76, Global train loss: 1.562, Global test loss: 1.876, Global test accuracy: 59.36
Round  77, Train loss: 1.569, Test loss: 1.545, Test accuracy: 94.62
Round  77, Global train loss: 1.569, Global test loss: 1.852, Global test accuracy: 61.36
Round  78, Train loss: 1.566, Test loss: 1.545, Test accuracy: 94.70
Round  78, Global train loss: 1.566, Global test loss: 1.858, Global test accuracy: 61.70
Round  79, Train loss: 1.567, Test loss: 1.545, Test accuracy: 94.72
Round  79, Global train loss: 1.567, Global test loss: 1.838, Global test accuracy: 63.40
Round  80, Train loss: 1.551, Test loss: 1.541, Test accuracy: 94.60
Round  80, Global train loss: 1.551, Global test loss: 1.855, Global test accuracy: 66.38
Round  81, Train loss: 1.544, Test loss: 1.539, Test accuracy: 94.62
Round  81, Global train loss: 1.544, Global test loss: 1.849, Global test accuracy: 66.36
Round  82, Train loss: 1.542, Test loss: 1.538, Test accuracy: 94.64
Round  82, Global train loss: 1.542, Global test loss: 1.842, Global test accuracy: 66.98
Round  83, Train loss: 1.541, Test loss: 1.538, Test accuracy: 94.70
Round  83, Global train loss: 1.541, Global test loss: 1.843, Global test accuracy: 66.64
Round  84, Train loss: 1.540, Test loss: 1.538, Test accuracy: 94.60
Round  84, Global train loss: 1.540, Global test loss: 1.845, Global test accuracy: 66.44
Round  85, Train loss: 1.540, Test loss: 1.538, Test accuracy: 94.62
Round  85, Global train loss: 1.540, Global test loss: 1.844, Global test accuracy: 66.58
Round  86, Train loss: 1.539, Test loss: 1.538, Test accuracy: 94.76
Round  86, Global train loss: 1.539, Global test loss: 1.840, Global test accuracy: 67.22
Round  87, Train loss: 1.539, Test loss: 1.539, Test accuracy: 94.64
Round  87, Global train loss: 1.539, Global test loss: 1.844, Global test accuracy: 67.02
Round  88, Train loss: 1.539, Test loss: 1.539, Test accuracy: 94.68
Round  88, Global train loss: 1.539, Global test loss: 1.840, Global test accuracy: 67.44
Round  89, Train loss: 1.538, Test loss: 1.539, Test accuracy: 94.58
Round  89, Global train loss: 1.538, Global test loss: 1.841, Global test accuracy: 67.48
Round  90, Train loss: 1.538, Test loss: 1.540, Test accuracy: 94.60
Round  90, Global train loss: 1.538, Global test loss: 1.840, Global test accuracy: 67.46/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.538, Test loss: 1.540, Test accuracy: 94.52
Round  91, Global train loss: 1.538, Global test loss: 1.840, Global test accuracy: 67.52
Round  92, Train loss: 1.538, Test loss: 1.542, Test accuracy: 94.36
Round  92, Global train loss: 1.538, Global test loss: 1.848, Global test accuracy: 66.86
Round  93, Train loss: 1.537, Test loss: 1.542, Test accuracy: 94.34
Round  93, Global train loss: 1.537, Global test loss: 1.845, Global test accuracy: 67.32
Round  94, Train loss: 1.537, Test loss: 1.542, Test accuracy: 94.28
Round  94, Global train loss: 1.537, Global test loss: 1.843, Global test accuracy: 67.62
Round  95, Train loss: 1.536, Test loss: 1.543, Test accuracy: 94.22
Round  95, Global train loss: 1.536, Global test loss: 1.843, Global test accuracy: 67.66
Round  96, Train loss: 1.536, Test loss: 1.543, Test accuracy: 94.12
Round  96, Global train loss: 1.536, Global test loss: 1.847, Global test accuracy: 67.04
Round  97, Train loss: 1.535, Test loss: 1.544, Test accuracy: 94.18
Round  97, Global train loss: 1.535, Global test loss: 1.849, Global test accuracy: 66.76
Round  98, Train loss: 1.535, Test loss: 1.545, Test accuracy: 94.14
Round  98, Global train loss: 1.535, Global test loss: 1.853, Global test accuracy: 66.70
Round  99, Train loss: 1.575, Test loss: 1.539, Test accuracy: 94.70
Round  99, Global train loss: 1.575, Global test loss: 1.764, Global test accuracy: 80.94
Final Round, Train loss: 1.726, Test loss: 1.537, Test accuracy: 94.42
Final Round, Global train loss: 1.726, Global test loss: 1.764, Global test accuracy: 80.94
Average accuracy final 10 rounds: 94.346
1778.7917873859406
[1.3201959133148193, 2.423184394836426, 3.5626890659332275, 4.646317005157471, 5.7437663078308105, 6.8572773933410645, 7.982342004776001, 9.0776526927948, 10.198137760162354, 11.302150249481201, 12.346737623214722, 18.89338445663452, 25.682907581329346, 32.36560392379761, 39.31291127204895, 45.999568462371826, 52.956358671188354, 59.98404145240784, 67.08500480651855, 74.35091543197632, 81.61077833175659, 88.63668537139893, 95.75144505500793, 103.07310056686401, 110.32064270973206, 117.74851107597351, 125.20642304420471, 132.54878973960876, 139.71680784225464, 147.01402068138123, 154.66676115989685, 161.9775722026825, 169.2332112789154, 176.52128744125366, 183.66546154022217, 190.94140481948853, 198.2696189880371, 205.76932311058044, 213.417827129364, 221.22095847129822, 228.66928219795227, 236.02024841308594, 243.0032913684845, 250.4392716884613, 257.7221200466156, 264.797137260437, 271.84290170669556, 279.0508334636688, 286.6982419490814, 293.8542323112488, 301.1820137500763, 308.3187966346741, 315.60893273353577, 322.84217047691345, 330.11251401901245, 337.67253398895264, 344.847847700119, 352.04937410354614, 359.23723244667053, 367.06271600723267, 374.35652351379395, 381.6496789455414, 389.1104383468628, 396.50343561172485, 403.8912580013275, 411.3374197483063, 418.53766441345215, 425.94870924949646, 433.1875205039978, 440.2780125141144, 447.4958174228668, 454.71882820129395, 462.29018115997314, 469.4862961769104, 476.76900362968445, 483.9078996181488, 491.1613218784332, 498.36463713645935, 505.79175186157227, 512.8924088478088, 514.0317015647888, 515.1778383255005, 516.3176634311676, 517.4368984699249, 518.5209264755249, 519.6632182598114, 520.7632060050964, 521.9135720729828, 523.0374293327332, 524.1643171310425, 525.3119673728943, 526.423614025116, 527.5489194393158, 528.6519024372101, 529.7432906627655, 530.8835542201996, 532.0460534095764, 533.2323787212372, 534.405187368393, 541.3801934719086, 548.1519646644592]
[21.12, 36.04, 40.76, 38.08, 40.06, 53.4, 62.02, 63.92, 67.78, 70.78, 73.74, 77.36, 80.64, 82.62, 83.06, 83.56, 83.86, 83.86, 83.98, 86.08, 87.54, 89.36, 89.6, 89.52, 89.78, 90.08, 90.46, 90.48, 90.62, 90.52, 90.22, 90.26, 90.5, 90.1, 90.14, 90.34, 90.44, 90.42, 90.54, 90.86, 90.58, 90.72, 90.68, 90.64, 90.92, 90.78, 90.82, 90.74, 90.62, 91.76, 91.94, 92.26, 92.5, 92.28, 92.14, 92.24, 92.18, 92.08, 92.86, 94.36, 94.8, 94.86, 94.68, 94.62, 94.5, 94.4, 94.58, 94.56, 94.6, 94.72, 94.66, 94.68, 94.68, 94.6, 94.62, 94.54, 94.68, 94.62, 94.7, 94.72, 94.6, 94.62, 94.64, 94.7, 94.6, 94.62, 94.76, 94.64, 94.68, 94.58, 94.6, 94.52, 94.36, 94.34, 94.28, 94.22, 94.12, 94.18, 94.14, 94.7, 94.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 0, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.293, Test loss: 2.294, Test accuracy: 22.72
Round   0, Global train loss: 2.293, Global test loss: 2.300, Global test accuracy: 21.72
Round   1, Train loss: 2.273, Test loss: 2.261, Test accuracy: 24.12
Round   1, Global train loss: 2.273, Global test loss: 2.277, Global test accuracy: 24.62
Round   2, Train loss: 2.137, Test loss: 2.193, Test accuracy: 31.20
Round   2, Global train loss: 2.137, Global test loss: 2.227, Global test accuracy: 31.30
Round   3, Train loss: 2.213, Test loss: 2.176, Test accuracy: 32.22
Round   3, Global train loss: 2.213, Global test loss: 2.232, Global test accuracy: 30.00
Round   4, Train loss: 2.045, Test loss: 2.147, Test accuracy: 35.44
Round   4, Global train loss: 2.045, Global test loss: 2.212, Global test accuracy: 41.80
Round   5, Train loss: 1.983, Test loss: 2.101, Test accuracy: 36.42
Round   5, Global train loss: 1.983, Global test loss: 2.118, Global test accuracy: 37.74
Round   6, Train loss: 2.215, Test loss: 2.110, Test accuracy: 34.86
Round   6, Global train loss: 2.215, Global test loss: 2.263, Global test accuracy: 18.00
Round   7, Train loss: 1.952, Test loss: 2.085, Test accuracy: 37.48
Round   7, Global train loss: 1.952, Global test loss: 2.182, Global test accuracy: 29.42
Round   8, Train loss: 1.947, Test loss: 2.053, Test accuracy: 41.16
Round   8, Global train loss: 1.947, Global test loss: 2.058, Global test accuracy: 38.98
Round   9, Train loss: 1.938, Test loss: 2.036, Test accuracy: 43.96
Round   9, Global train loss: 1.938, Global test loss: 2.049, Global test accuracy: 40.36
Round  10, Train loss: 2.136, Test loss: 2.033, Test accuracy: 44.76
Round  10, Global train loss: 2.136, Global test loss: 2.177, Global test accuracy: 30.96
Round  11, Train loss: 2.065, Test loss: 1.988, Test accuracy: 49.42
Round  11, Global train loss: 2.065, Global test loss: 2.155, Global test accuracy: 29.86
Round  12, Train loss: 1.977, Test loss: 1.966, Test accuracy: 52.36
Round  12, Global train loss: 1.977, Global test loss: 2.163, Global test accuracy: 33.00
Round  13, Train loss: 2.127, Test loss: 1.953, Test accuracy: 54.18
Round  13, Global train loss: 2.127, Global test loss: 2.206, Global test accuracy: 18.32
Round  14, Train loss: 1.936, Test loss: 1.945, Test accuracy: 55.78
Round  14, Global train loss: 1.936, Global test loss: 2.195, Global test accuracy: 26.80
Round  15, Train loss: 2.102, Test loss: 1.942, Test accuracy: 55.20
Round  15, Global train loss: 2.102, Global test loss: 2.201, Global test accuracy: 33.04
Round  16, Train loss: 1.882, Test loss: 1.940, Test accuracy: 54.98
Round  16, Global train loss: 1.882, Global test loss: 2.128, Global test accuracy: 34.74
Round  17, Train loss: 2.091, Test loss: 1.936, Test accuracy: 55.04
Round  17, Global train loss: 2.091, Global test loss: 2.177, Global test accuracy: 29.52
Round  18, Train loss: 1.874, Test loss: 1.940, Test accuracy: 54.38
Round  18, Global train loss: 1.874, Global test loss: 2.140, Global test accuracy: 31.54
Round  19, Train loss: 1.861, Test loss: 1.946, Test accuracy: 53.10
Round  19, Global train loss: 1.861, Global test loss: 2.109, Global test accuracy: 33.10
Round  20, Train loss: 1.827, Test loss: 1.949, Test accuracy: 52.78
Round  20, Global train loss: 1.827, Global test loss: 2.071, Global test accuracy: 39.28
Round  21, Train loss: 1.973, Test loss: 1.957, Test accuracy: 51.72
Round  21, Global train loss: 1.973, Global test loss: 2.227, Global test accuracy: 19.50
Round  22, Train loss: 1.870, Test loss: 1.959, Test accuracy: 51.00
Round  22, Global train loss: 1.870, Global test loss: 2.101, Global test accuracy: 35.22
Round  23, Train loss: 2.039, Test loss: 1.958, Test accuracy: 51.26
Round  23, Global train loss: 2.039, Global test loss: 2.228, Global test accuracy: 19.60
Round  24, Train loss: 1.967, Test loss: 1.954, Test accuracy: 51.28
Round  24, Global train loss: 1.967, Global test loss: 2.157, Global test accuracy: 28.02
Round  25, Train loss: 1.760, Test loss: 1.957, Test accuracy: 50.90
Round  25, Global train loss: 1.760, Global test loss: 2.087, Global test accuracy: 36.02
Round  26, Train loss: 1.811, Test loss: 1.960, Test accuracy: 50.72
Round  26, Global train loss: 1.811, Global test loss: 2.108, Global test accuracy: 37.56
Round  27, Train loss: 2.017, Test loss: 1.949, Test accuracy: 51.56
Round  27, Global train loss: 2.017, Global test loss: 2.158, Global test accuracy: 38.92
Round  28, Train loss: 1.788, Test loss: 1.955, Test accuracy: 50.74
Round  28, Global train loss: 1.788, Global test loss: 2.110, Global test accuracy: 36.98
Round  29, Train loss: 1.959, Test loss: 1.952, Test accuracy: 50.46
Round  29, Global train loss: 1.959, Global test loss: 2.144, Global test accuracy: 39.64
Round  30, Train loss: 1.982, Test loss: 1.953, Test accuracy: 50.40
Round  30, Global train loss: 1.982, Global test loss: 2.277, Global test accuracy: 16.78
Round  31, Train loss: 2.016, Test loss: 1.946, Test accuracy: 51.54
Round  31, Global train loss: 2.016, Global test loss: 2.255, Global test accuracy: 17.98
Round  32, Train loss: 1.714, Test loss: 1.947, Test accuracy: 51.50
Round  32, Global train loss: 1.714, Global test loss: 2.110, Global test accuracy: 34.64
Round  33, Train loss: 1.710, Test loss: 1.949, Test accuracy: 51.38
Round  33, Global train loss: 1.710, Global test loss: 2.175, Global test accuracy: 28.22
Round  34, Train loss: 1.799, Test loss: 1.942, Test accuracy: 52.22
Round  34, Global train loss: 1.799, Global test loss: 2.097, Global test accuracy: 34.80
Round  35, Train loss: 1.931, Test loss: 1.938, Test accuracy: 52.44
Round  35, Global train loss: 1.931, Global test loss: 2.125, Global test accuracy: 37.62
Round  36, Train loss: 1.937, Test loss: 1.943, Test accuracy: 51.82
Round  36, Global train loss: 1.937, Global test loss: 2.183, Global test accuracy: 28.66
Round  37, Train loss: 1.749, Test loss: 1.943, Test accuracy: 51.94
Round  37, Global train loss: 1.749, Global test loss: 2.062, Global test accuracy: 40.64
Round  38, Train loss: 1.857, Test loss: 1.942, Test accuracy: 52.34
Round  38, Global train loss: 1.857, Global test loss: 2.218, Global test accuracy: 20.94
Round  39, Train loss: 1.764, Test loss: 1.944, Test accuracy: 51.98
Round  39, Global train loss: 1.764, Global test loss: 2.099, Global test accuracy: 35.00
Round  40, Train loss: 1.888, Test loss: 1.943, Test accuracy: 52.08
Round  40, Global train loss: 1.888, Global test loss: 2.160, Global test accuracy: 29.06
Round  41, Train loss: 1.892, Test loss: 1.942, Test accuracy: 52.00
Round  41, Global train loss: 1.892, Global test loss: 2.291, Global test accuracy: 16.16
Round  42, Train loss: 1.836, Test loss: 1.944, Test accuracy: 51.64
Round  42, Global train loss: 1.836, Global test loss: 2.174, Global test accuracy: 27.30
Round  43, Train loss: 1.737, Test loss: 1.942, Test accuracy: 51.90
Round  43, Global train loss: 1.737, Global test loss: 2.111, Global test accuracy: 36.20
Round  44, Train loss: 1.914, Test loss: 1.944, Test accuracy: 51.52
Round  44, Global train loss: 1.914, Global test loss: 2.221, Global test accuracy: 20.26
Round  45, Train loss: 1.871, Test loss: 1.944, Test accuracy: 51.42
Round  45, Global train loss: 1.871, Global test loss: 2.211, Global test accuracy: 21.80
Round  46, Train loss: 1.904, Test loss: 1.951, Test accuracy: 50.66
Round  46, Global train loss: 1.904, Global test loss: 2.194, Global test accuracy: 25.24
Round  47, Train loss: 1.687, Test loss: 1.950, Test accuracy: 50.78
Round  47, Global train loss: 1.687, Global test loss: 2.118, Global test accuracy: 32.10
Round  48, Train loss: 1.868, Test loss: 1.950, Test accuracy: 50.74
Round  48, Global train loss: 1.868, Global test loss: 2.289, Global test accuracy: 14.24
Round  49, Train loss: 1.876, Test loss: 1.951, Test accuracy: 50.52
Round  49, Global train loss: 1.876, Global test loss: 2.217, Global test accuracy: 23.50
Round  50, Train loss: 1.699, Test loss: 1.952, Test accuracy: 50.40
Round  50, Global train loss: 1.699, Global test loss: 2.114, Global test accuracy: 34.30
Round  51, Train loss: 1.724, Test loss: 1.950, Test accuracy: 50.52
Round  51, Global train loss: 1.724, Global test loss: 2.176, Global test accuracy: 25.22
Round  52, Train loss: 1.846, Test loss: 1.952, Test accuracy: 50.56
Round  52, Global train loss: 1.846, Global test loss: 2.137, Global test accuracy: 39.16
Round  53, Train loss: 1.608, Test loss: 1.953, Test accuracy: 50.46
Round  53, Global train loss: 1.608, Global test loss: 2.065, Global test accuracy: 38.64
Round  54, Train loss: 1.869, Test loss: 1.955, Test accuracy: 50.42
Round  54, Global train loss: 1.869, Global test loss: 2.217, Global test accuracy: 25.46
Round  55, Train loss: 1.870, Test loss: 1.956, Test accuracy: 50.14
Round  55, Global train loss: 1.870, Global test loss: 2.192, Global test accuracy: 25.22
Round  56, Train loss: 1.701, Test loss: 1.955, Test accuracy: 50.10
Round  56, Global train loss: 1.701, Global test loss: 2.041, Global test accuracy: 45.08
Round  57, Train loss: 1.859, Test loss: 1.961, Test accuracy: 49.32
Round  57, Global train loss: 1.859, Global test loss: 2.205, Global test accuracy: 29.44
Round  58, Train loss: 1.712, Test loss: 1.958, Test accuracy: 49.66
Round  58, Global train loss: 1.712, Global test loss: 2.116, Global test accuracy: 36.20
Round  59, Train loss: 1.705, Test loss: 1.955, Test accuracy: 50.20
Round  59, Global train loss: 1.705, Global test loss: 2.102, Global test accuracy: 34.14
Round  60, Train loss: 1.820, Test loss: 1.957, Test accuracy: 49.98
Round  60, Global train loss: 1.820, Global test loss: 2.172, Global test accuracy: 30.96
Round  61, Train loss: 1.801, Test loss: 1.954, Test accuracy: 50.38
Round  61, Global train loss: 1.801, Global test loss: 2.202, Global test accuracy: 23.56
Round  62, Train loss: 1.732, Test loss: 1.954, Test accuracy: 50.32
Round  62, Global train loss: 1.732, Global test loss: 2.108, Global test accuracy: 36.08
Round  63, Train loss: 1.784, Test loss: 1.954, Test accuracy: 50.44
Round  63, Global train loss: 1.784, Global test loss: 2.134, Global test accuracy: 34.06
Round  64, Train loss: 1.844, Test loss: 1.954, Test accuracy: 50.52
Round  64, Global train loss: 1.844, Global test loss: 2.146, Global test accuracy: 35.02
Round  65, Train loss: 1.799, Test loss: 1.955, Test accuracy: 50.40
Round  65, Global train loss: 1.799, Global test loss: 2.304, Global test accuracy: 14.46
Round  66, Train loss: 1.782, Test loss: 1.955, Test accuracy: 50.10
Round  66, Global train loss: 1.782, Global test loss: 2.124, Global test accuracy: 38.92
Round  67, Train loss: 1.801, Test loss: 1.957, Test accuracy: 49.86
Round  67, Global train loss: 1.801, Global test loss: 2.155, Global test accuracy: 31.84
Round  68, Train loss: 1.822, Test loss: 1.957, Test accuracy: 49.92
Round  68, Global train loss: 1.822, Global test loss: 2.146, Global test accuracy: 31.06
Round  69, Train loss: 1.695, Test loss: 1.958, Test accuracy: 49.84
Round  69, Global train loss: 1.695, Global test loss: 2.141, Global test accuracy: 30.16
Round  70, Train loss: 1.785, Test loss: 1.958, Test accuracy: 49.98
Round  70, Global train loss: 1.785, Global test loss: 2.200, Global test accuracy: 23.90
Round  71, Train loss: 1.692, Test loss: 1.957, Test accuracy: 50.00
Round  71, Global train loss: 1.692, Global test loss: 2.133, Global test accuracy: 30.72
Round  72, Train loss: 1.766, Test loss: 1.955, Test accuracy: 50.02
Round  72, Global train loss: 1.766, Global test loss: 2.143, Global test accuracy: 35.50
Round  73, Train loss: 1.709, Test loss: 1.955, Test accuracy: 50.00
Round  73, Global train loss: 1.709, Global test loss: 2.062, Global test accuracy: 38.84
Round  74, Train loss: 1.701, Test loss: 1.955, Test accuracy: 50.08
Round  74, Global train loss: 1.701, Global test loss: 2.142, Global test accuracy: 33.40
Round  75, Train loss: 1.685, Test loss: 1.954, Test accuracy: 50.10
Round  75, Global train loss: 1.685, Global test loss: 2.042, Global test accuracy: 46.00
Round  76, Train loss: 1.689, Test loss: 1.954, Test accuracy: 50.16
Round  76, Global train loss: 1.689, Global test loss: 2.102, Global test accuracy: 34.54
Round  77, Train loss: 1.776, Test loss: 1.953, Test accuracy: 50.30
Round  77, Global train loss: 1.776, Global test loss: 2.126, Global test accuracy: 34.24
Round  78, Train loss: 1.728, Test loss: 1.953, Test accuracy: 50.16
Round  78, Global train loss: 1.728, Global test loss: 2.094, Global test accuracy: 35.52
Round  79, Train loss: 1.799, Test loss: 1.955, Test accuracy: 50.02
Round  79, Global train loss: 1.799, Global test loss: 2.326, Global test accuracy: 10.62
Round  80, Train loss: 1.667, Test loss: 1.956, Test accuracy: 49.90
Round  80, Global train loss: 1.667, Global test loss: 2.036, Global test accuracy: 42.10
Round  81, Train loss: 1.695, Test loss: 1.953, Test accuracy: 50.20
Round  81, Global train loss: 1.695, Global test loss: 2.231, Global test accuracy: 20.68
Round  82, Train loss: 1.774, Test loss: 1.954, Test accuracy: 50.12
Round  82, Global train loss: 1.774, Global test loss: 2.198, Global test accuracy: 24.16
Round  83, Train loss: 1.701, Test loss: 1.954, Test accuracy: 50.04
Round  83, Global train loss: 1.701, Global test loss: 2.083, Global test accuracy: 40.32
Round  84, Train loss: 1.784, Test loss: 1.955, Test accuracy: 50.04
Round  84, Global train loss: 1.784, Global test loss: 2.327, Global test accuracy: 11.32
Round  85, Train loss: 1.708, Test loss: 1.954, Test accuracy: 50.00
Round  85, Global train loss: 1.708, Global test loss: 2.048, Global test accuracy: 40.10
Round  86, Train loss: 1.725, Test loss: 1.955, Test accuracy: 49.86
Round  86, Global train loss: 1.725, Global test loss: 2.091, Global test accuracy: 35.60
Round  87, Train loss: 1.785, Test loss: 1.952, Test accuracy: 50.18
Round  87, Global train loss: 1.785, Global test loss: 2.141, Global test accuracy: 30.20
Round  88, Train loss: 1.743, Test loss: 1.952, Test accuracy: 50.10
Round  88, Global train loss: 1.743, Global test loss: 2.151, Global test accuracy: 32.14
Round  89, Train loss: 1.668, Test loss: 1.948, Test accuracy: 50.46
Round  89, Global train loss: 1.668, Global test loss: 2.074, Global test accuracy: 40.50
Round  90, Train loss: 1.773, Test loss: 1.951, Test accuracy: 50.16
Round  90, Global train loss: 1.773, Global test loss: 2.230, Global test accuracy: 23.00
Round  91, Train loss: 1.677, Test loss: 1.952, Test accuracy: 50.12
Round  91, Global train loss: 1.677, Global test loss: 2.035, Global test accuracy: 45.18
Round  92, Train loss: 1.755, Test loss: 1.951, Test accuracy: 50.30
Round  92, Global train loss: 1.755, Global test loss: 2.124, Global test accuracy: 33.16
Round  93, Train loss: 1.763, Test loss: 1.952, Test accuracy: 50.16
Round  93, Global train loss: 1.763, Global test loss: 2.126, Global test accuracy: 32.22/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.658, Test loss: 1.954, Test accuracy: 50.06
Round  94, Global train loss: 1.658, Global test loss: 2.134, Global test accuracy: 26.68
Round  95, Train loss: 1.683, Test loss: 1.953, Test accuracy: 49.90
Round  95, Global train loss: 1.683, Global test loss: 2.048, Global test accuracy: 42.84
Round  96, Train loss: 1.766, Test loss: 1.952, Test accuracy: 49.84
Round  96, Global train loss: 1.766, Global test loss: 2.171, Global test accuracy: 27.08
Round  97, Train loss: 1.636, Test loss: 1.954, Test accuracy: 49.70
Round  97, Global train loss: 1.636, Global test loss: 2.024, Global test accuracy: 43.04
Round  98, Train loss: 1.802, Test loss: 1.954, Test accuracy: 49.64
Round  98, Global train loss: 1.802, Global test loss: 2.212, Global test accuracy: 22.18
Round  99, Train loss: 1.772, Test loss: 1.959, Test accuracy: 49.12
Round  99, Global train loss: 1.772, Global test loss: 2.313, Global test accuracy: 11.14
Final Round, Train loss: 1.696, Test loss: 1.958, Test accuracy: 49.60
Final Round, Global train loss: 1.696, Global test loss: 2.313, Global test accuracy: 11.14
Average accuracy final 10 rounds: 49.9 

Average global accuracy final 10 rounds: 30.652 

664.6557779312134
[0.9440107345581055, 1.888021469116211, 2.7823681831359863, 3.6767148971557617, 4.536586284637451, 5.396457672119141, 6.280553579330444, 7.164649486541748, 8.018927097320557, 8.873204708099365, 9.68630576133728, 10.499406814575195, 11.317211866378784, 12.135016918182373, 12.98434853553772, 13.833680152893066, 14.674092531204224, 15.51450490951538, 16.36121368408203, 17.20792245864868, 18.065351247787476, 18.92278003692627, 19.873019456863403, 20.823258876800537, 21.71560311317444, 22.60794734954834, 23.39595937728882, 24.183971405029297, 25.02157735824585, 25.859183311462402, 26.60493564605713, 27.350687980651855, 28.168529510498047, 28.98637104034424, 29.789993286132812, 30.593615531921387, 31.47970199584961, 32.36578845977783, 33.18230891227722, 33.99882936477661, 34.85125684738159, 35.70368432998657, 36.54650259017944, 37.389320850372314, 38.261053800582886, 39.13278675079346, 39.99997401237488, 40.8671612739563, 41.670772314071655, 42.47438335418701, 43.24700713157654, 44.019630908966064, 44.80801177024841, 45.59639263153076, 46.35781168937683, 47.1192307472229, 47.90249586105347, 48.68576097488403, 49.43653678894043, 50.187312602996826, 50.91480541229248, 51.642298221588135, 52.39526844024658, 53.14823865890503, 53.98498749732971, 54.821736335754395, 55.658668756484985, 56.495601177215576, 57.2373731136322, 57.97914505004883, 58.715964794158936, 59.45278453826904, 60.1820228099823, 60.91126108169556, 61.636070728302, 62.36088037490845, 63.097569942474365, 63.83425951004028, 64.7349226474762, 65.63558578491211, 66.47607159614563, 67.31655740737915, 68.14592480659485, 68.97529220581055, 69.79301333427429, 70.61073446273804, 71.3614752292633, 72.11221599578857, 72.84637475013733, 73.58053350448608, 74.35072588920593, 75.12091827392578, 75.99123072624207, 76.86154317855835, 77.75452160835266, 78.64750003814697, 79.45986127853394, 80.2722225189209, 81.07609176635742, 81.87996101379395, 82.6181218624115, 83.35628271102905, 84.19431591033936, 85.03234910964966, 85.86535739898682, 86.69836568832397, 87.5513072013855, 88.40424871444702, 89.23686408996582, 90.06947946548462, 90.89142751693726, 91.71337556838989, 92.56640481948853, 93.41943407058716, 94.23417639732361, 95.04891872406006, 95.83470964431763, 96.6205005645752, 97.4216456413269, 98.22279071807861, 99.0090217590332, 99.7952527999878, 100.56758499145508, 101.33991718292236, 102.13848304748535, 102.93704891204834, 103.77640914916992, 104.6157693862915, 105.52089738845825, 106.426025390625, 107.17518448829651, 107.92434358596802, 108.68432760238647, 109.44431161880493, 110.21668004989624, 110.98904848098755, 111.74346852302551, 112.49788856506348, 113.25119829177856, 114.00450801849365, 114.76836967468262, 115.53223133087158, 116.33551406860352, 117.13879680633545, 117.89812755584717, 118.65745830535889, 119.4353380203247, 120.21321773529053, 120.9773325920105, 121.74144744873047, 122.50207805633545, 123.26270866394043, 124.09730195999146, 124.93189525604248, 125.72899985313416, 126.52610445022583, 127.32972192764282, 128.13333940505981, 128.8998303413391, 129.6663212776184, 130.43659329414368, 131.20686531066895, 131.9749140739441, 132.74296283721924, 133.5316505432129, 134.32033824920654, 135.11423802375793, 135.90813779830933, 136.7881464958191, 137.66815519332886, 138.51720356941223, 139.3662519454956, 140.12555742263794, 140.88486289978027, 141.678466796875, 142.47207069396973, 143.3164393901825, 144.16080808639526, 145.04999089241028, 145.9391736984253, 146.80277371406555, 147.6663737297058, 148.48098230361938, 149.29559087753296, 150.1860156059265, 151.07644033432007, 151.8588526248932, 152.6412649154663, 153.46031188964844, 154.27935886383057, 155.1001250743866, 155.92089128494263, 156.6980459690094, 157.47520065307617, 158.2643449306488, 159.05348920822144, 159.7887465953827, 160.52400398254395, 161.28227591514587, 162.0405478477478, 163.8931107521057, 165.74567365646362]
[22.72, 22.72, 24.12, 24.12, 31.2, 31.2, 32.22, 32.22, 35.44, 35.44, 36.42, 36.42, 34.86, 34.86, 37.48, 37.48, 41.16, 41.16, 43.96, 43.96, 44.76, 44.76, 49.42, 49.42, 52.36, 52.36, 54.18, 54.18, 55.78, 55.78, 55.2, 55.2, 54.98, 54.98, 55.04, 55.04, 54.38, 54.38, 53.1, 53.1, 52.78, 52.78, 51.72, 51.72, 51.0, 51.0, 51.26, 51.26, 51.28, 51.28, 50.9, 50.9, 50.72, 50.72, 51.56, 51.56, 50.74, 50.74, 50.46, 50.46, 50.4, 50.4, 51.54, 51.54, 51.5, 51.5, 51.38, 51.38, 52.22, 52.22, 52.44, 52.44, 51.82, 51.82, 51.94, 51.94, 52.34, 52.34, 51.98, 51.98, 52.08, 52.08, 52.0, 52.0, 51.64, 51.64, 51.9, 51.9, 51.52, 51.52, 51.42, 51.42, 50.66, 50.66, 50.78, 50.78, 50.74, 50.74, 50.52, 50.52, 50.4, 50.4, 50.52, 50.52, 50.56, 50.56, 50.46, 50.46, 50.42, 50.42, 50.14, 50.14, 50.1, 50.1, 49.32, 49.32, 49.66, 49.66, 50.2, 50.2, 49.98, 49.98, 50.38, 50.38, 50.32, 50.32, 50.44, 50.44, 50.52, 50.52, 50.4, 50.4, 50.1, 50.1, 49.86, 49.86, 49.92, 49.92, 49.84, 49.84, 49.98, 49.98, 50.0, 50.0, 50.02, 50.02, 50.0, 50.0, 50.08, 50.08, 50.1, 50.1, 50.16, 50.16, 50.3, 50.3, 50.16, 50.16, 50.02, 50.02, 49.9, 49.9, 50.2, 50.2, 50.12, 50.12, 50.04, 50.04, 50.04, 50.04, 50.0, 50.0, 49.86, 49.86, 50.18, 50.18, 50.1, 50.1, 50.46, 50.46, 50.16, 50.16, 50.12, 50.12, 50.3, 50.3, 50.16, 50.16, 50.06, 50.06, 49.9, 49.9, 49.84, 49.84, 49.7, 49.7, 49.64, 49.64, 49.12, 49.12, 49.6, 49.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.281, Test loss: 2.288, Test accuracy: 14.12
Round   0, Global train loss: 2.281, Global test loss: 2.299, Global test accuracy: 12.92
Round   1, Train loss: 2.265, Test loss: 2.269, Test accuracy: 13.92
Round   1, Global train loss: 2.265, Global test loss: 2.296, Global test accuracy: 8.00
Round   2, Train loss: 2.220, Test loss: 2.266, Test accuracy: 15.46
Round   2, Global train loss: 2.220, Global test loss: 2.301, Global test accuracy: 8.00
Round   3, Train loss: 2.233, Test loss: 2.228, Test accuracy: 20.92
Round   3, Global train loss: 2.233, Global test loss: 2.284, Global test accuracy: 10.00
Round   4, Train loss: 2.220, Test loss: 2.192, Test accuracy: 28.76
Round   4, Global train loss: 2.220, Global test loss: 2.241, Global test accuracy: 24.68
Round   5, Train loss: 2.205, Test loss: 2.169, Test accuracy: 30.98
Round   5, Global train loss: 2.205, Global test loss: 2.215, Global test accuracy: 23.44
Round   6, Train loss: 2.123, Test loss: 2.124, Test accuracy: 35.92
Round   6, Global train loss: 2.123, Global test loss: 2.180, Global test accuracy: 23.34
Round   7, Train loss: 2.190, Test loss: 2.078, Test accuracy: 41.72
Round   7, Global train loss: 2.190, Global test loss: 2.129, Global test accuracy: 35.74
Round   8, Train loss: 2.197, Test loss: 2.066, Test accuracy: 42.72
Round   8, Global train loss: 2.197, Global test loss: 2.118, Global test accuracy: 37.70
Round   9, Train loss: 2.179, Test loss: 2.043, Test accuracy: 46.14
Round   9, Global train loss: 2.179, Global test loss: 2.110, Global test accuracy: 35.42
Round  10, Train loss: 2.147, Test loss: 2.033, Test accuracy: 46.22
Round  10, Global train loss: 2.147, Global test loss: 2.073, Global test accuracy: 38.22
Round  11, Train loss: 2.081, Test loss: 2.024, Test accuracy: 47.22
Round  11, Global train loss: 2.081, Global test loss: 2.039, Global test accuracy: 43.34
Round  12, Train loss: 2.171, Test loss: 2.004, Test accuracy: 48.74
Round  12, Global train loss: 2.171, Global test loss: 2.040, Global test accuracy: 42.28
Round  13, Train loss: 2.188, Test loss: 2.002, Test accuracy: 48.54
Round  13, Global train loss: 2.188, Global test loss: 2.065, Global test accuracy: 40.30
Round  14, Train loss: 2.174, Test loss: 1.991, Test accuracy: 48.12
Round  14, Global train loss: 2.174, Global test loss: 2.061, Global test accuracy: 40.58
Round  15, Train loss: 2.056, Test loss: 1.988, Test accuracy: 48.42
Round  15, Global train loss: 2.056, Global test loss: 2.007, Global test accuracy: 45.50
Round  16, Train loss: 2.126, Test loss: 1.986, Test accuracy: 49.00
Round  16, Global train loss: 2.126, Global test loss: 2.018, Global test accuracy: 44.48
Round  17, Train loss: 2.135, Test loss: 1.981, Test accuracy: 50.16
Round  17, Global train loss: 2.135, Global test loss: 2.009, Global test accuracy: 47.14
Round  18, Train loss: 2.111, Test loss: 1.968, Test accuracy: 51.72
Round  18, Global train loss: 2.111, Global test loss: 2.048, Global test accuracy: 41.48
Round  19, Train loss: 2.153, Test loss: 1.958, Test accuracy: 52.40
Round  19, Global train loss: 2.153, Global test loss: 2.026, Global test accuracy: 44.04
Round  20, Train loss: 2.160, Test loss: 1.962, Test accuracy: 51.66
Round  20, Global train loss: 2.160, Global test loss: 2.081, Global test accuracy: 35.72
Round  21, Train loss: 2.073, Test loss: 1.959, Test accuracy: 51.90
Round  21, Global train loss: 2.073, Global test loss: 2.056, Global test accuracy: 39.72
Round  22, Train loss: 2.049, Test loss: 1.944, Test accuracy: 53.52
Round  22, Global train loss: 2.049, Global test loss: 1.989, Global test accuracy: 46.86
Round  23, Train loss: 2.056, Test loss: 1.918, Test accuracy: 56.44
Round  23, Global train loss: 2.056, Global test loss: 1.971, Global test accuracy: 49.74
Round  24, Train loss: 2.149, Test loss: 1.934, Test accuracy: 54.74
Round  24, Global train loss: 2.149, Global test loss: 1.977, Global test accuracy: 50.12
Round  25, Train loss: 2.146, Test loss: 1.929, Test accuracy: 54.96
Round  25, Global train loss: 2.146, Global test loss: 2.043, Global test accuracy: 41.10
Round  26, Train loss: 2.053, Test loss: 1.929, Test accuracy: 54.56
Round  26, Global train loss: 2.053, Global test loss: 1.956, Global test accuracy: 52.66
Round  27, Train loss: 2.021, Test loss: 1.916, Test accuracy: 55.52
Round  27, Global train loss: 2.021, Global test loss: 1.930, Global test accuracy: 54.32
Round  28, Train loss: 2.024, Test loss: 1.901, Test accuracy: 57.42
Round  28, Global train loss: 2.024, Global test loss: 1.938, Global test accuracy: 53.60
Round  29, Train loss: 2.109, Test loss: 1.902, Test accuracy: 57.24
Round  29, Global train loss: 2.109, Global test loss: 1.954, Global test accuracy: 52.50
Round  30, Train loss: 1.951, Test loss: 1.894, Test accuracy: 58.40
Round  30, Global train loss: 1.951, Global test loss: 1.910, Global test accuracy: 59.82
Round  31, Train loss: 2.079, Test loss: 1.879, Test accuracy: 59.66
Round  31, Global train loss: 2.079, Global test loss: 1.961, Global test accuracy: 50.96
Round  32, Train loss: 2.102, Test loss: 1.881, Test accuracy: 59.50
Round  32, Global train loss: 2.102, Global test loss: 1.999, Global test accuracy: 46.08
Round  33, Train loss: 2.094, Test loss: 1.886, Test accuracy: 59.14
Round  33, Global train loss: 2.094, Global test loss: 2.036, Global test accuracy: 41.56
Round  34, Train loss: 2.003, Test loss: 1.893, Test accuracy: 58.14
Round  34, Global train loss: 2.003, Global test loss: 1.940, Global test accuracy: 54.04
Round  35, Train loss: 2.082, Test loss: 1.892, Test accuracy: 58.20
Round  35, Global train loss: 2.082, Global test loss: 1.937, Global test accuracy: 54.56
Round  36, Train loss: 1.821, Test loss: 1.897, Test accuracy: 57.26
Round  36, Global train loss: 1.821, Global test loss: 1.910, Global test accuracy: 55.16
Round  37, Train loss: 2.071, Test loss: 1.894, Test accuracy: 57.18
Round  37, Global train loss: 2.071, Global test loss: 1.996, Global test accuracy: 46.56
Round  38, Train loss: 1.941, Test loss: 1.892, Test accuracy: 57.28
Round  38, Global train loss: 1.941, Global test loss: 1.928, Global test accuracy: 54.44
Round  39, Train loss: 1.993, Test loss: 1.886, Test accuracy: 57.94
Round  39, Global train loss: 1.993, Global test loss: 1.914, Global test accuracy: 56.40
Round  40, Train loss: 1.950, Test loss: 1.888, Test accuracy: 57.76
Round  40, Global train loss: 1.950, Global test loss: 1.939, Global test accuracy: 52.12
Round  41, Train loss: 1.908, Test loss: 1.885, Test accuracy: 57.70
Round  41, Global train loss: 1.908, Global test loss: 1.913, Global test accuracy: 55.28
Round  42, Train loss: 1.944, Test loss: 1.880, Test accuracy: 58.32
Round  42, Global train loss: 1.944, Global test loss: 1.891, Global test accuracy: 58.58
Round  43, Train loss: 1.932, Test loss: 1.893, Test accuracy: 56.88
Round  43, Global train loss: 1.932, Global test loss: 1.907, Global test accuracy: 56.12
Round  44, Train loss: 1.971, Test loss: 1.885, Test accuracy: 57.60
Round  44, Global train loss: 1.971, Global test loss: 1.912, Global test accuracy: 55.64
Round  45, Train loss: 1.965, Test loss: 1.887, Test accuracy: 57.40
Round  45, Global train loss: 1.965, Global test loss: 1.967, Global test accuracy: 49.08
Round  46, Train loss: 1.961, Test loss: 1.878, Test accuracy: 58.56
Round  46, Global train loss: 1.961, Global test loss: 1.963, Global test accuracy: 49.36
Round  47, Train loss: 2.074, Test loss: 1.884, Test accuracy: 57.86
Round  47, Global train loss: 2.074, Global test loss: 1.931, Global test accuracy: 53.46
Round  48, Train loss: 2.009, Test loss: 1.870, Test accuracy: 59.44
Round  48, Global train loss: 2.009, Global test loss: 1.988, Global test accuracy: 47.42
Round  49, Train loss: 1.975, Test loss: 1.874, Test accuracy: 59.08
Round  49, Global train loss: 1.975, Global test loss: 1.975, Global test accuracy: 49.54
Round  50, Train loss: 1.937, Test loss: 1.872, Test accuracy: 59.22
Round  50, Global train loss: 1.937, Global test loss: 1.913, Global test accuracy: 55.62
Round  51, Train loss: 1.979, Test loss: 1.878, Test accuracy: 58.60
Round  51, Global train loss: 1.979, Global test loss: 2.025, Global test accuracy: 43.12
Round  52, Train loss: 1.921, Test loss: 1.883, Test accuracy: 58.18
Round  52, Global train loss: 1.921, Global test loss: 1.899, Global test accuracy: 57.46
Round  53, Train loss: 2.072, Test loss: 1.885, Test accuracy: 57.72
Round  53, Global train loss: 2.072, Global test loss: 1.970, Global test accuracy: 49.56
Round  54, Train loss: 1.924, Test loss: 1.888, Test accuracy: 57.48
Round  54, Global train loss: 1.924, Global test loss: 1.961, Global test accuracy: 49.52
Round  55, Train loss: 1.919, Test loss: 1.885, Test accuracy: 57.82
Round  55, Global train loss: 1.919, Global test loss: 1.964, Global test accuracy: 49.86
Round  56, Train loss: 2.018, Test loss: 1.885, Test accuracy: 57.66
Round  56, Global train loss: 2.018, Global test loss: 1.921, Global test accuracy: 55.32
Round  57, Train loss: 1.775, Test loss: 1.881, Test accuracy: 57.94
Round  57, Global train loss: 1.775, Global test loss: 1.871, Global test accuracy: 59.62
Round  58, Train loss: 1.893, Test loss: 1.882, Test accuracy: 58.08
Round  58, Global train loss: 1.893, Global test loss: 1.894, Global test accuracy: 57.34
Round  59, Train loss: 1.971, Test loss: 1.880, Test accuracy: 58.50
Round  59, Global train loss: 1.971, Global test loss: 1.947, Global test accuracy: 51.82
Round  60, Train loss: 1.910, Test loss: 1.883, Test accuracy: 58.26
Round  60, Global train loss: 1.910, Global test loss: 1.949, Global test accuracy: 51.22
Round  61, Train loss: 1.941, Test loss: 1.894, Test accuracy: 57.00
Round  61, Global train loss: 1.941, Global test loss: 1.943, Global test accuracy: 51.82
Round  62, Train loss: 1.887, Test loss: 1.895, Test accuracy: 56.92
Round  62, Global train loss: 1.887, Global test loss: 1.893, Global test accuracy: 57.98
Round  63, Train loss: 1.978, Test loss: 1.885, Test accuracy: 58.08
Round  63, Global train loss: 1.978, Global test loss: 1.962, Global test accuracy: 50.70
Round  64, Train loss: 1.866, Test loss: 1.895, Test accuracy: 56.98
Round  64, Global train loss: 1.866, Global test loss: 1.908, Global test accuracy: 56.18
Round  65, Train loss: 1.858, Test loss: 1.894, Test accuracy: 56.96
Round  65, Global train loss: 1.858, Global test loss: 1.897, Global test accuracy: 57.16
Round  66, Train loss: 1.878, Test loss: 1.895, Test accuracy: 56.80
Round  66, Global train loss: 1.878, Global test loss: 1.898, Global test accuracy: 57.14
Round  67, Train loss: 1.976, Test loss: 1.890, Test accuracy: 57.56
Round  67, Global train loss: 1.976, Global test loss: 1.952, Global test accuracy: 51.18
Round  68, Train loss: 1.846, Test loss: 1.883, Test accuracy: 58.08
Round  68, Global train loss: 1.846, Global test loss: 1.919, Global test accuracy: 54.70
Round  69, Train loss: 2.023, Test loss: 1.890, Test accuracy: 57.52
Round  69, Global train loss: 2.023, Global test loss: 2.013, Global test accuracy: 44.84
Round  70, Train loss: 1.926, Test loss: 1.896, Test accuracy: 56.90
Round  70, Global train loss: 1.926, Global test loss: 1.959, Global test accuracy: 50.06
Round  71, Train loss: 2.004, Test loss: 1.902, Test accuracy: 56.02
Round  71, Global train loss: 2.004, Global test loss: 2.024, Global test accuracy: 43.44
Round  72, Train loss: 1.868, Test loss: 1.894, Test accuracy: 56.66
Round  72, Global train loss: 1.868, Global test loss: 1.925, Global test accuracy: 54.56
Round  73, Train loss: 1.988, Test loss: 1.908, Test accuracy: 55.28
Round  73, Global train loss: 1.988, Global test loss: 1.960, Global test accuracy: 50.62
Round  74, Train loss: 1.937, Test loss: 1.918, Test accuracy: 54.62
Round  74, Global train loss: 1.937, Global test loss: 2.012, Global test accuracy: 45.22
Round  75, Train loss: 1.973, Test loss: 1.918, Test accuracy: 54.64
Round  75, Global train loss: 1.973, Global test loss: 1.972, Global test accuracy: 49.38
Round  76, Train loss: 1.977, Test loss: 1.910, Test accuracy: 55.40
Round  76, Global train loss: 1.977, Global test loss: 1.983, Global test accuracy: 47.24
Round  77, Train loss: 1.867, Test loss: 1.908, Test accuracy: 55.58
Round  77, Global train loss: 1.867, Global test loss: 1.966, Global test accuracy: 49.30
Round  78, Train loss: 1.859, Test loss: 1.901, Test accuracy: 56.38
Round  78, Global train loss: 1.859, Global test loss: 1.937, Global test accuracy: 52.24
Round  79, Train loss: 1.782, Test loss: 1.891, Test accuracy: 57.24
Round  79, Global train loss: 1.782, Global test loss: 1.950, Global test accuracy: 50.62
Round  80, Train loss: 1.957, Test loss: 1.882, Test accuracy: 58.54
Round  80, Global train loss: 1.957, Global test loss: 2.008, Global test accuracy: 45.42
Round  81, Train loss: 1.885, Test loss: 1.886, Test accuracy: 58.02
Round  81, Global train loss: 1.885, Global test loss: 1.962, Global test accuracy: 50.98
Round  82, Train loss: 1.856, Test loss: 1.868, Test accuracy: 59.70
Round  82, Global train loss: 1.856, Global test loss: 1.958, Global test accuracy: 49.28
Round  83, Train loss: 1.818, Test loss: 1.869, Test accuracy: 59.68
Round  83, Global train loss: 1.818, Global test loss: 1.897, Global test accuracy: 56.66
Round  84, Train loss: 1.853, Test loss: 1.864, Test accuracy: 60.00
Round  84, Global train loss: 1.853, Global test loss: 1.960, Global test accuracy: 51.02
Round  85, Train loss: 1.941, Test loss: 1.873, Test accuracy: 58.98
Round  85, Global train loss: 1.941, Global test loss: 1.962, Global test accuracy: 49.60
Round  86, Train loss: 1.811, Test loss: 1.874, Test accuracy: 59.06
Round  86, Global train loss: 1.811, Global test loss: 1.921, Global test accuracy: 54.36
Round  87, Train loss: 1.816, Test loss: 1.874, Test accuracy: 59.06
Round  87, Global train loss: 1.816, Global test loss: 1.956, Global test accuracy: 50.02
Round  88, Train loss: 1.796, Test loss: 1.872, Test accuracy: 59.10
Round  88, Global train loss: 1.796, Global test loss: 1.940, Global test accuracy: 51.82
Round  89, Train loss: 1.786, Test loss: 1.865, Test accuracy: 60.02
Round  89, Global train loss: 1.786, Global test loss: 1.929, Global test accuracy: 53.30
Round  90, Train loss: 1.816, Test loss: 1.862, Test accuracy: 60.34
Round  90, Global train loss: 1.816, Global test loss: 1.945, Global test accuracy: 51.42
Round  91, Train loss: 1.889, Test loss: 1.869, Test accuracy: 59.52
Round  91, Global train loss: 1.889, Global test loss: 1.955, Global test accuracy: 51.10
Round  92, Train loss: 1.779, Test loss: 1.876, Test accuracy: 58.62
Round  92, Global train loss: 1.779, Global test loss: 1.943, Global test accuracy: 52.02
Round  93, Train loss: 1.892, Test loss: 1.866, Test accuracy: 59.68
Round  93, Global train loss: 1.892, Global test loss: 1.977, Global test accuracy: 48.62/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  94, Train loss: 1.778, Test loss: 1.866, Test accuracy: 59.72
Round  94, Global train loss: 1.778, Global test loss: 1.897, Global test accuracy: 56.68
Round  95, Train loss: 1.942, Test loss: 1.865, Test accuracy: 59.62
Round  95, Global train loss: 1.942, Global test loss: 2.005, Global test accuracy: 45.12
Round  96, Train loss: 1.836, Test loss: 1.868, Test accuracy: 59.48
Round  96, Global train loss: 1.836, Global test loss: 2.002, Global test accuracy: 45.88
Round  97, Train loss: 1.972, Test loss: 1.873, Test accuracy: 58.94
Round  97, Global train loss: 1.972, Global test loss: 1.978, Global test accuracy: 48.52
Round  98, Train loss: 1.857, Test loss: 1.880, Test accuracy: 58.24
Round  98, Global train loss: 1.857, Global test loss: 2.020, Global test accuracy: 43.62
Round  99, Train loss: 1.714, Test loss: 1.883, Test accuracy: 58.04
Round  99, Global train loss: 1.714, Global test loss: 1.960, Global test accuracy: 50.68
Final Round, Train loss: 1.807, Test loss: 1.893, Test accuracy: 56.66
Final Round, Global train loss: 1.807, Global test loss: 1.960, Global test accuracy: 50.68
Average accuracy final 10 rounds: 59.22 

Average global accuracy final 10 rounds: 49.36600000000001 

663.7602245807648
[0.9661493301391602, 1.9322986602783203, 2.8240115642547607, 3.715724468231201, 4.5595057010650635, 5.403286933898926, 6.25499153137207, 7.106696128845215, 7.934345722198486, 8.761995315551758, 9.591374635696411, 10.420753955841064, 11.20742392539978, 11.994093894958496, 12.828431129455566, 13.662768363952637, 14.456477880477905, 15.250187397003174, 16.03482460975647, 16.819461822509766, 17.574334144592285, 18.329206466674805, 19.072713375091553, 19.8162202835083, 20.55715847015381, 21.298096656799316, 22.12177801132202, 22.945459365844727, 23.785776376724243, 24.62609338760376, 25.461445569992065, 26.29679775238037, 27.068323135375977, 27.839848518371582, 28.634493827819824, 29.429139137268066, 30.19323968887329, 30.957340240478516, 31.738250494003296, 32.519160747528076, 33.305689573287964, 34.09221839904785, 34.869876861572266, 35.64753532409668, 36.41364502906799, 37.17975473403931, 37.97149872779846, 38.76324272155762, 39.55319786071777, 40.34315299987793, 41.220773220062256, 42.09839344024658, 42.941831827163696, 43.78527021408081, 44.624773025512695, 45.46427583694458, 46.27012753486633, 47.075979232788086, 47.872299671173096, 48.668620109558105, 49.55140209197998, 50.434184074401855, 51.24788212776184, 52.061580181121826, 52.92259120941162, 53.783602237701416, 54.6169171333313, 55.45023202896118, 56.361165285110474, 57.272098541259766, 58.13084363937378, 58.98958873748779, 59.87795805931091, 60.76632738113403, 61.64161205291748, 62.51689672470093, 63.30894088745117, 64.10098505020142, 64.87737607955933, 65.65376710891724, 66.42451167106628, 67.19525623321533, 68.06306505203247, 68.93087387084961, 69.7480194568634, 70.5651650428772, 71.3579170703888, 72.15066909790039, 72.96089291572571, 73.77111673355103, 74.633629322052, 75.49614191055298, 76.33893656730652, 77.18173122406006, 78.0203161239624, 78.85890102386475, 79.71963143348694, 80.58036184310913, 81.50040888786316, 82.42045593261719, 83.22419548034668, 84.02793502807617, 84.77268147468567, 85.51742792129517, 86.28213620185852, 87.04684448242188, 87.78053283691406, 88.51422119140625, 89.26275777816772, 90.0112943649292, 90.79763102531433, 91.58396768569946, 92.42386722564697, 93.26376676559448, 94.10457611083984, 94.9453854560852, 95.72717428207397, 96.50896310806274, 97.28354358673096, 98.05812406539917, 98.84391570091248, 99.62970733642578, 100.42378687858582, 101.21786642074585, 101.9942307472229, 102.77059507369995, 103.58079719543457, 104.39099931716919, 105.19176769256592, 105.99253606796265, 106.8094654083252, 107.62639474868774, 108.41930913925171, 109.21222352981567, 110.00539565086365, 110.79856777191162, 111.6349983215332, 112.47142887115479, 113.32043957710266, 114.16945028305054, 115.06451225280762, 115.9595742225647, 116.72223329544067, 117.48489236831665, 118.26856398582458, 119.05223560333252, 119.8455216884613, 120.63880777359009, 121.4605565071106, 122.2823052406311, 123.1511218547821, 124.0199384689331, 124.93500757217407, 125.85007667541504, 126.65187430381775, 127.45367193222046, 128.19934034347534, 128.94500875473022, 129.71412658691406, 130.4832444190979, 131.33089423179626, 132.17854404449463, 133.04138135910034, 133.90421867370605, 134.74642992019653, 135.588641166687, 136.44081950187683, 137.29299783706665, 138.11216020584106, 138.93132257461548, 139.76360845565796, 140.59589433670044, 141.47700572013855, 142.35811710357666, 143.19178915023804, 144.0254611968994, 144.83064079284668, 145.63582038879395, 146.3790044784546, 147.12218856811523, 147.85560512542725, 148.58902168273926, 149.3664698600769, 150.14391803741455, 150.9272656440735, 151.71061325073242, 152.49021410942078, 153.26981496810913, 154.03187704086304, 154.79393911361694, 155.53190422058105, 156.26986932754517, 157.00052428245544, 157.73117923736572, 158.48666739463806, 159.2421555519104, 160.01035141944885, 160.7785472869873, 161.551828622818, 162.32510995864868, 163.87004828453064, 165.4149866104126]
[14.12, 14.12, 13.92, 13.92, 15.46, 15.46, 20.92, 20.92, 28.76, 28.76, 30.98, 30.98, 35.92, 35.92, 41.72, 41.72, 42.72, 42.72, 46.14, 46.14, 46.22, 46.22, 47.22, 47.22, 48.74, 48.74, 48.54, 48.54, 48.12, 48.12, 48.42, 48.42, 49.0, 49.0, 50.16, 50.16, 51.72, 51.72, 52.4, 52.4, 51.66, 51.66, 51.9, 51.9, 53.52, 53.52, 56.44, 56.44, 54.74, 54.74, 54.96, 54.96, 54.56, 54.56, 55.52, 55.52, 57.42, 57.42, 57.24, 57.24, 58.4, 58.4, 59.66, 59.66, 59.5, 59.5, 59.14, 59.14, 58.14, 58.14, 58.2, 58.2, 57.26, 57.26, 57.18, 57.18, 57.28, 57.28, 57.94, 57.94, 57.76, 57.76, 57.7, 57.7, 58.32, 58.32, 56.88, 56.88, 57.6, 57.6, 57.4, 57.4, 58.56, 58.56, 57.86, 57.86, 59.44, 59.44, 59.08, 59.08, 59.22, 59.22, 58.6, 58.6, 58.18, 58.18, 57.72, 57.72, 57.48, 57.48, 57.82, 57.82, 57.66, 57.66, 57.94, 57.94, 58.08, 58.08, 58.5, 58.5, 58.26, 58.26, 57.0, 57.0, 56.92, 56.92, 58.08, 58.08, 56.98, 56.98, 56.96, 56.96, 56.8, 56.8, 57.56, 57.56, 58.08, 58.08, 57.52, 57.52, 56.9, 56.9, 56.02, 56.02, 56.66, 56.66, 55.28, 55.28, 54.62, 54.62, 54.64, 54.64, 55.4, 55.4, 55.58, 55.58, 56.38, 56.38, 57.24, 57.24, 58.54, 58.54, 58.02, 58.02, 59.7, 59.7, 59.68, 59.68, 60.0, 60.0, 58.98, 58.98, 59.06, 59.06, 59.06, 59.06, 59.1, 59.1, 60.02, 60.02, 60.34, 60.34, 59.52, 59.52, 58.62, 58.62, 59.68, 59.68, 59.72, 59.72, 59.62, 59.62, 59.48, 59.48, 58.94, 58.94, 58.24, 58.24, 58.04, 58.04, 56.66, 56.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 1, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
prox
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 2.296, Test loss: 2.296, Test accuracy: 12.58
Round   0, Global train loss: 2.296, Global test loss: 2.301, Global test accuracy: 9.98
Round   1, Train loss: 2.289, Test loss: 2.284, Test accuracy: 26.68
Round   1, Global train loss: 2.289, Global test loss: 2.293, Global test accuracy: 29.68
Round   2, Train loss: 2.241, Test loss: 2.241, Test accuracy: 26.58
Round   2, Global train loss: 2.241, Global test loss: 2.258, Global test accuracy: 28.16
Round   3, Train loss: 2.221, Test loss: 2.203, Test accuracy: 31.94
Round   3, Global train loss: 2.221, Global test loss: 2.216, Global test accuracy: 28.04
Round   4, Train loss: 2.143, Test loss: 2.151, Test accuracy: 37.64
Round   4, Global train loss: 2.143, Global test loss: 2.146, Global test accuracy: 37.44
Round   5, Train loss: 2.092, Test loss: 2.117, Test accuracy: 40.00
Round   5, Global train loss: 2.092, Global test loss: 2.086, Global test accuracy: 43.68
Round   6, Train loss: 2.207, Test loss: 2.082, Test accuracy: 42.56
Round   6, Global train loss: 2.207, Global test loss: 2.140, Global test accuracy: 32.42
Round   7, Train loss: 2.069, Test loss: 2.049, Test accuracy: 43.90
Round   7, Global train loss: 2.069, Global test loss: 2.064, Global test accuracy: 38.18
Round   8, Train loss: 2.081, Test loss: 2.031, Test accuracy: 45.98
Round   8, Global train loss: 2.081, Global test loss: 2.053, Global test accuracy: 38.54
Round   9, Train loss: 2.054, Test loss: 2.027, Test accuracy: 46.32
Round   9, Global train loss: 2.054, Global test loss: 2.046, Global test accuracy: 41.42
Round  10, Train loss: 2.161, Test loss: 2.008, Test accuracy: 48.28
Round  10, Global train loss: 2.161, Global test loss: 2.058, Global test accuracy: 39.90
Round  11, Train loss: 2.084, Test loss: 1.975, Test accuracy: 51.42
Round  11, Global train loss: 2.084, Global test loss: 2.054, Global test accuracy: 42.76
Round  12, Train loss: 2.058, Test loss: 1.960, Test accuracy: 52.20
Round  12, Global train loss: 2.058, Global test loss: 1.998, Global test accuracy: 49.42
Round  13, Train loss: 2.172, Test loss: 1.956, Test accuracy: 52.64
Round  13, Global train loss: 2.172, Global test loss: 2.062, Global test accuracy: 38.98
Round  14, Train loss: 2.085, Test loss: 1.946, Test accuracy: 53.58
Round  14, Global train loss: 2.085, Global test loss: 2.026, Global test accuracy: 43.60
Round  15, Train loss: 2.164, Test loss: 1.943, Test accuracy: 53.92
Round  15, Global train loss: 2.164, Global test loss: 2.020, Global test accuracy: 47.38
Round  16, Train loss: 2.054, Test loss: 1.942, Test accuracy: 53.68
Round  16, Global train loss: 2.054, Global test loss: 2.017, Global test accuracy: 47.68
Round  17, Train loss: 2.174, Test loss: 1.944, Test accuracy: 53.38
Round  17, Global train loss: 2.174, Global test loss: 2.025, Global test accuracy: 43.80
Round  18, Train loss: 2.054, Test loss: 1.945, Test accuracy: 52.72
Round  18, Global train loss: 2.054, Global test loss: 2.025, Global test accuracy: 44.28
Round  19, Train loss: 2.054, Test loss: 1.942, Test accuracy: 53.74
Round  19, Global train loss: 2.054, Global test loss: 1.997, Global test accuracy: 47.26
Round  20, Train loss: 2.044, Test loss: 1.946, Test accuracy: 52.40
Round  20, Global train loss: 2.044, Global test loss: 2.024, Global test accuracy: 42.24
Round  21, Train loss: 2.136, Test loss: 1.945, Test accuracy: 52.96
Round  21, Global train loss: 2.136, Global test loss: 2.018, Global test accuracy: 45.12
Round  22, Train loss: 2.073, Test loss: 1.946, Test accuracy: 52.68
Round  22, Global train loss: 2.073, Global test loss: 2.012, Global test accuracy: 46.92
Round  23, Train loss: 2.170, Test loss: 1.950, Test accuracy: 52.36
Round  23, Global train loss: 2.170, Global test loss: 2.072, Global test accuracy: 38.24
Round  24, Train loss: 2.154, Test loss: 1.952, Test accuracy: 52.10
Round  24, Global train loss: 2.154, Global test loss: 2.058, Global test accuracy: 38.00
Round  25, Train loss: 1.986, Test loss: 1.949, Test accuracy: 51.88
Round  25, Global train loss: 1.986, Global test loss: 2.019, Global test accuracy: 42.94
Round  26, Train loss: 2.037, Test loss: 1.945, Test accuracy: 52.12
Round  26, Global train loss: 2.037, Global test loss: 1.985, Global test accuracy: 49.94
Round  27, Train loss: 2.163, Test loss: 1.939, Test accuracy: 52.58
Round  27, Global train loss: 2.163, Global test loss: 1.991, Global test accuracy: 48.58
Round  28, Train loss: 2.020, Test loss: 1.946, Test accuracy: 52.08
Round  28, Global train loss: 2.020, Global test loss: 2.010, Global test accuracy: 46.82
Round  29, Train loss: 2.133, Test loss: 1.940, Test accuracy: 52.84
Round  29, Global train loss: 2.133, Global test loss: 1.980, Global test accuracy: 48.20
Round  30, Train loss: 2.119, Test loss: 1.931, Test accuracy: 53.52
Round  30, Global train loss: 2.119, Global test loss: 2.085, Global test accuracy: 35.94
Round  31, Train loss: 2.132, Test loss: 1.928, Test accuracy: 53.80
Round  31, Global train loss: 2.132, Global test loss: 2.019, Global test accuracy: 46.72
Round  32, Train loss: 1.967, Test loss: 1.922, Test accuracy: 54.34
Round  32, Global train loss: 1.967, Global test loss: 1.979, Global test accuracy: 49.20
Round  33, Train loss: 1.949, Test loss: 1.928, Test accuracy: 53.46
Round  33, Global train loss: 1.949, Global test loss: 1.970, Global test accuracy: 49.44
Round  34, Train loss: 1.994, Test loss: 1.922, Test accuracy: 54.44
Round  34, Global train loss: 1.994, Global test loss: 1.978, Global test accuracy: 49.10
Round  35, Train loss: 2.118, Test loss: 1.917, Test accuracy: 55.04
Round  35, Global train loss: 2.118, Global test loss: 1.974, Global test accuracy: 49.58
Round  36, Train loss: 2.112, Test loss: 1.926, Test accuracy: 53.64
Round  36, Global train loss: 2.112, Global test loss: 2.041, Global test accuracy: 41.36
Round  37, Train loss: 1.962, Test loss: 1.922, Test accuracy: 54.12
Round  37, Global train loss: 1.962, Global test loss: 1.973, Global test accuracy: 49.20
Round  38, Train loss: 2.077, Test loss: 1.917, Test accuracy: 54.70
Round  38, Global train loss: 2.077, Global test loss: 1.987, Global test accuracy: 48.94
Round  39, Train loss: 1.972, Test loss: 1.914, Test accuracy: 55.04
Round  39, Global train loss: 1.972, Global test loss: 1.969, Global test accuracy: 50.44
Round  40, Train loss: 2.094, Test loss: 1.915, Test accuracy: 54.92
Round  40, Global train loss: 2.094, Global test loss: 2.049, Global test accuracy: 40.74
Round  41, Train loss: 2.069, Test loss: 1.915, Test accuracy: 54.92
Round  41, Global train loss: 2.069, Global test loss: 2.035, Global test accuracy: 42.72
Round  42, Train loss: 2.075, Test loss: 1.918, Test accuracy: 54.60
Round  42, Global train loss: 2.075, Global test loss: 2.047, Global test accuracy: 41.62
Round  43, Train loss: 1.929, Test loss: 1.909, Test accuracy: 55.70
Round  43, Global train loss: 1.929, Global test loss: 1.948, Global test accuracy: 52.06
Round  44, Train loss: 2.112, Test loss: 1.891, Test accuracy: 57.70
Round  44, Global train loss: 2.112, Global test loss: 1.967, Global test accuracy: 50.68
Round  45, Train loss: 2.117, Test loss: 1.890, Test accuracy: 57.82
Round  45, Global train loss: 2.117, Global test loss: 2.053, Global test accuracy: 40.42
Round  46, Train loss: 2.114, Test loss: 1.893, Test accuracy: 57.42
Round  46, Global train loss: 2.114, Global test loss: 2.024, Global test accuracy: 42.82
Round  47, Train loss: 1.955, Test loss: 1.896, Test accuracy: 57.02
Round  47, Global train loss: 1.955, Global test loss: 1.991, Global test accuracy: 47.12
Round  48, Train loss: 2.085, Test loss: 1.899, Test accuracy: 56.70
Round  48, Global train loss: 2.085, Global test loss: 1.949, Global test accuracy: 52.94
Round  49, Train loss: 2.039, Test loss: 1.896, Test accuracy: 56.94
Round  49, Global train loss: 2.039, Global test loss: 1.991, Global test accuracy: 47.36
Round  50, Train loss: 1.918, Test loss: 1.900, Test accuracy: 56.40
Round  50, Global train loss: 1.918, Global test loss: 1.925, Global test accuracy: 54.70
Round  51, Train loss: 1.951, Test loss: 1.901, Test accuracy: 56.28
Round  51, Global train loss: 1.951, Global test loss: 1.985, Global test accuracy: 46.86
Round  52, Train loss: 2.075, Test loss: 1.903, Test accuracy: 56.26
Round  52, Global train loss: 2.075, Global test loss: 1.946, Global test accuracy: 52.80
Round  53, Train loss: 1.798, Test loss: 1.902, Test accuracy: 56.18
Round  53, Global train loss: 1.798, Global test loss: 1.900, Global test accuracy: 56.90
Round  54, Train loss: 2.100, Test loss: 1.903, Test accuracy: 56.02
Round  54, Global train loss: 2.100, Global test loss: 2.008, Global test accuracy: 44.66
Round  55, Train loss: 2.089, Test loss: 1.908, Test accuracy: 55.46
Round  55, Global train loss: 2.089, Global test loss: 2.019, Global test accuracy: 44.36
Round  56, Train loss: 1.944, Test loss: 1.908, Test accuracy: 55.58
Round  56, Global train loss: 1.944, Global test loss: 1.925, Global test accuracy: 54.60
Round  57, Train loss: 2.055, Test loss: 1.906, Test accuracy: 55.86
Round  57, Global train loss: 2.055, Global test loss: 1.984, Global test accuracy: 47.60
Round  58, Train loss: 1.891, Test loss: 1.910, Test accuracy: 55.38
Round  58, Global train loss: 1.891, Global test loss: 1.947, Global test accuracy: 51.88
Round  59, Train loss: 1.949, Test loss: 1.908, Test accuracy: 55.48
Round  59, Global train loss: 1.949, Global test loss: 1.949, Global test accuracy: 51.44
Round  60, Train loss: 2.056, Test loss: 1.907, Test accuracy: 55.70
Round  60, Global train loss: 2.056, Global test loss: 2.005, Global test accuracy: 44.90
Round  61, Train loss: 2.088, Test loss: 1.906, Test accuracy: 55.90
Round  61, Global train loss: 2.088, Global test loss: 2.034, Global test accuracy: 42.48
Round  62, Train loss: 1.896, Test loss: 1.906, Test accuracy: 55.86
Round  62, Global train loss: 1.896, Global test loss: 1.926, Global test accuracy: 54.14
Round  63, Train loss: 1.999, Test loss: 1.906, Test accuracy: 55.94
Round  63, Global train loss: 1.999, Global test loss: 1.962, Global test accuracy: 50.52
Round  64, Train loss: 2.031, Test loss: 1.911, Test accuracy: 55.32
Round  64, Global train loss: 2.031, Global test loss: 2.004, Global test accuracy: 46.00
Round  65, Train loss: 1.989, Test loss: 1.912, Test accuracy: 55.32
Round  65, Global train loss: 1.989, Global test loss: 2.045, Global test accuracy: 41.64
Round  66, Train loss: 2.036, Test loss: 1.924, Test accuracy: 53.90
Round  66, Global train loss: 2.036, Global test loss: 2.021, Global test accuracy: 44.36
Round  67, Train loss: 2.024, Test loss: 1.931, Test accuracy: 53.28
Round  67, Global train loss: 2.024, Global test loss: 2.041, Global test accuracy: 41.84
Round  68, Train loss: 1.978, Test loss: 1.914, Test accuracy: 54.82
Round  68, Global train loss: 1.978, Global test loss: 1.994, Global test accuracy: 46.80
Round  69, Train loss: 1.889, Test loss: 1.911, Test accuracy: 55.04
Round  69, Global train loss: 1.889, Global test loss: 1.945, Global test accuracy: 51.94
Round  70, Train loss: 2.073, Test loss: 1.910, Test accuracy: 55.12
Round  70, Global train loss: 2.073, Global test loss: 2.019, Global test accuracy: 43.52
Round  71, Train loss: 1.882, Test loss: 1.912, Test accuracy: 54.80
Round  71, Global train loss: 1.882, Global test loss: 1.940, Global test accuracy: 52.62
Round  72, Train loss: 2.019, Test loss: 1.914, Test accuracy: 54.60
Round  72, Global train loss: 2.019, Global test loss: 1.968, Global test accuracy: 49.24
Round  73, Train loss: 1.923, Test loss: 1.912, Test accuracy: 54.96
Round  73, Global train loss: 1.923, Global test loss: 1.949, Global test accuracy: 51.66
Round  74, Train loss: 1.878, Test loss: 1.916, Test accuracy: 54.58
Round  74, Global train loss: 1.878, Global test loss: 1.956, Global test accuracy: 50.92
Round  75, Train loss: 1.910, Test loss: 1.911, Test accuracy: 55.18
Round  75, Global train loss: 1.910, Global test loss: 1.927, Global test accuracy: 54.12
Round  76, Train loss: 1.869, Test loss: 1.908, Test accuracy: 55.42
Round  76, Global train loss: 1.869, Global test loss: 1.923, Global test accuracy: 54.16
Round  77, Train loss: 2.017, Test loss: 1.910, Test accuracy: 55.06
Round  77, Global train loss: 2.017, Global test loss: 1.982, Global test accuracy: 48.12
Round  78, Train loss: 1.869, Test loss: 1.912, Test accuracy: 54.90
Round  78, Global train loss: 1.869, Global test loss: 1.968, Global test accuracy: 49.00
Round  79, Train loss: 2.004, Test loss: 1.917, Test accuracy: 54.14
Round  79, Global train loss: 2.004, Global test loss: 2.018, Global test accuracy: 43.54
Round  80, Train loss: 1.870, Test loss: 1.929, Test accuracy: 52.90
Round  80, Global train loss: 1.870, Global test loss: 1.965, Global test accuracy: 49.42
Round  81, Train loss: 1.848, Test loss: 1.925, Test accuracy: 53.32
Round  81, Global train loss: 1.848, Global test loss: 1.963, Global test accuracy: 49.80
Round  82, Train loss: 2.062, Test loss: 1.928, Test accuracy: 52.96
Round  82, Global train loss: 2.062, Global test loss: 2.021, Global test accuracy: 43.74
Round  83, Train loss: 1.865, Test loss: 1.931, Test accuracy: 52.64
Round  83, Global train loss: 1.865, Global test loss: 1.968, Global test accuracy: 49.04
Round  84, Train loss: 1.933, Test loss: 1.934, Test accuracy: 52.36
Round  84, Global train loss: 1.933, Global test loss: 1.996, Global test accuracy: 46.10
Round  85, Train loss: 1.915, Test loss: 1.931, Test accuracy: 52.74
Round  85, Global train loss: 1.915, Global test loss: 1.966, Global test accuracy: 49.36
Round  86, Train loss: 1.853, Test loss: 1.928, Test accuracy: 53.18
Round  86, Global train loss: 1.853, Global test loss: 1.955, Global test accuracy: 50.46
Round  87, Train loss: 1.958, Test loss: 1.936, Test accuracy: 52.28
Round  87, Global train loss: 1.958, Global test loss: 2.048, Global test accuracy: 40.44
Round  88, Train loss: 1.946, Test loss: 1.940, Test accuracy: 51.90
Round  88, Global train loss: 1.946, Global test loss: 2.053, Global test accuracy: 40.32
Round  89, Train loss: 1.845, Test loss: 1.939, Test accuracy: 51.96
Round  89, Global train loss: 1.845, Global test loss: 2.019, Global test accuracy: 43.58
Round  90, Train loss: 1.987, Test loss: 1.935, Test accuracy: 52.46
Round  90, Global train loss: 1.987, Global test loss: 2.029, Global test accuracy: 43.04
Round  91, Train loss: 1.896, Test loss: 1.936, Test accuracy: 52.40
Round  91, Global train loss: 1.896, Global test loss: 1.963, Global test accuracy: 49.68
Round  92, Train loss: 2.007, Test loss: 1.932, Test accuracy: 52.76
Round  92, Global train loss: 2.007, Global test loss: 1.993, Global test accuracy: 46.84
Round  93, Train loss: 1.992, Test loss: 1.929, Test accuracy: 53.20
Round  93, Global train loss: 1.992, Global test loss: 1.991, Global test accuracy: 47.00
Round  94, Train loss: 1.906, Test loss: 1.928, Test accuracy: 53.44
Round  94, Global train loss: 1.906, Global test loss: 1.954, Global test accuracy: 50.70/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 1.851, Test loss: 1.924, Test accuracy: 53.86
Round  95, Global train loss: 1.851, Global test loss: 1.970, Global test accuracy: 48.54
Round  96, Train loss: 1.931, Test loss: 1.928, Test accuracy: 53.50
Round  96, Global train loss: 1.931, Global test loss: 1.994, Global test accuracy: 47.24
Round  97, Train loss: 1.901, Test loss: 1.927, Test accuracy: 53.48
Round  97, Global train loss: 1.901, Global test loss: 1.978, Global test accuracy: 47.78
Round  98, Train loss: 1.985, Test loss: 1.933, Test accuracy: 52.90
Round  98, Global train loss: 1.985, Global test loss: 1.990, Global test accuracy: 47.28
Round  99, Train loss: 1.975, Test loss: 1.931, Test accuracy: 52.86
Round  99, Global train loss: 1.975, Global test loss: 2.024, Global test accuracy: 43.26
Final Round, Train loss: 1.896, Test loss: 1.947, Test accuracy: 51.12
Final Round, Global train loss: 1.896, Global test loss: 2.024, Global test accuracy: 43.26
Average accuracy final 10 rounds: 53.086 

Average global accuracy final 10 rounds: 47.136 

667.6228775978088
[1.0111925601959229, 2.0223851203918457, 2.926299571990967, 3.830214023590088, 4.716659069061279, 5.603104114532471, 6.491753578186035, 7.3804030418396, 8.255256414413452, 9.130109786987305, 10.03182053565979, 10.933531284332275, 11.84403395652771, 12.754536628723145, 13.649977207183838, 14.545417785644531, 15.43833589553833, 16.33125400543213, 17.173496961593628, 18.015739917755127, 18.902191400527954, 19.78864288330078, 20.654824018478394, 21.521005153656006, 22.40307593345642, 23.285146713256836, 24.17777442932129, 25.070402145385742, 25.94235372543335, 26.814305305480957, 27.68860387802124, 28.562902450561523, 29.450473070144653, 30.338043689727783, 31.24541926383972, 32.15279483795166, 33.01743030548096, 33.882065773010254, 34.77996516227722, 35.67786455154419, 36.559946060180664, 37.44202756881714, 38.290218114852905, 39.13840866088867, 39.95252251625061, 40.76663637161255, 41.604785203933716, 42.44293403625488, 43.29727649688721, 44.15161895751953, 44.99487018585205, 45.83812141418457, 46.675318002700806, 47.51251459121704, 48.34973478317261, 49.186954975128174, 50.013503313064575, 50.84005165100098, 51.691580057144165, 52.54310846328735, 53.4100444316864, 54.27698040008545, 55.13965559005737, 56.0023307800293, 56.83029890060425, 57.6582670211792, 58.4851770401001, 59.312087059020996, 60.14267587661743, 60.97326469421387, 61.83539938926697, 62.69753408432007, 63.5867817401886, 64.47602939605713, 65.3315417766571, 66.18705415725708, 67.01704049110413, 67.84702682495117, 68.67866206169128, 69.5102972984314, 70.33239150047302, 71.15448570251465, 71.95237708091736, 72.75026845932007, 73.5600357055664, 74.36980295181274, 75.18290424346924, 75.99600553512573, 76.81429481506348, 77.63258409500122, 78.45575213432312, 79.27892017364502, 80.06369733810425, 80.84847450256348, 81.63747596740723, 82.42647743225098, 83.24679112434387, 84.06710481643677, 84.90823292732239, 85.74936103820801, 86.590176820755, 87.430992603302, 88.25307869911194, 89.07516479492188, 89.87297010421753, 90.67077541351318, 91.59465003013611, 92.51852464675903, 93.33021545410156, 94.14190626144409, 94.95867776870728, 95.77544927597046, 96.59291577339172, 97.41038227081299, 98.23519539833069, 99.06000852584839, 99.89060640335083, 100.72120428085327, 101.53940272331238, 102.35760116577148, 103.18112087249756, 104.00464057922363, 104.8146333694458, 105.62462615966797, 106.42138123512268, 107.21813631057739, 108.02976369857788, 108.84139108657837, 109.6610004901886, 110.48060989379883, 111.29017782211304, 112.09974575042725, 112.91608881950378, 113.73243188858032, 114.58865785598755, 115.44488382339478, 116.28041315078735, 117.11594247817993, 117.95544934272766, 118.79495620727539, 119.57718467712402, 120.35941314697266, 121.17889785766602, 121.99838256835938, 122.81972408294678, 123.64106559753418, 124.4652042388916, 125.28934288024902, 126.11222577095032, 126.93510866165161, 127.7469551563263, 128.55880165100098, 129.3806631565094, 130.20252466201782, 131.01218938827515, 131.82185411453247, 132.64049863815308, 133.45914316177368, 134.2998926639557, 135.1406421661377, 135.95900559425354, 136.77736902236938, 137.57559728622437, 138.37382555007935, 139.17854166030884, 139.98325777053833, 140.81864094734192, 141.6540241241455, 142.49250316619873, 143.33098220825195, 144.1793613433838, 145.02774047851562, 145.8545687198639, 146.68139696121216, 147.51214718818665, 148.34289741516113, 149.13904571533203, 149.93519401550293, 150.7811815738678, 151.62716913223267, 152.46585392951965, 153.30453872680664, 154.13755822181702, 154.9705777168274, 155.77227902412415, 156.5739803314209, 157.37979316711426, 158.18560600280762, 158.98164319992065, 159.7776803970337, 160.61302137374878, 161.44836235046387, 162.30756163597107, 163.16676092147827, 164.00746250152588, 164.8481640815735, 165.69037508964539, 166.53258609771729, 167.33370518684387, 168.13482427597046, 169.83376574516296, 171.53270721435547]
[12.58, 12.58, 26.68, 26.68, 26.58, 26.58, 31.94, 31.94, 37.64, 37.64, 40.0, 40.0, 42.56, 42.56, 43.9, 43.9, 45.98, 45.98, 46.32, 46.32, 48.28, 48.28, 51.42, 51.42, 52.2, 52.2, 52.64, 52.64, 53.58, 53.58, 53.92, 53.92, 53.68, 53.68, 53.38, 53.38, 52.72, 52.72, 53.74, 53.74, 52.4, 52.4, 52.96, 52.96, 52.68, 52.68, 52.36, 52.36, 52.1, 52.1, 51.88, 51.88, 52.12, 52.12, 52.58, 52.58, 52.08, 52.08, 52.84, 52.84, 53.52, 53.52, 53.8, 53.8, 54.34, 54.34, 53.46, 53.46, 54.44, 54.44, 55.04, 55.04, 53.64, 53.64, 54.12, 54.12, 54.7, 54.7, 55.04, 55.04, 54.92, 54.92, 54.92, 54.92, 54.6, 54.6, 55.7, 55.7, 57.7, 57.7, 57.82, 57.82, 57.42, 57.42, 57.02, 57.02, 56.7, 56.7, 56.94, 56.94, 56.4, 56.4, 56.28, 56.28, 56.26, 56.26, 56.18, 56.18, 56.02, 56.02, 55.46, 55.46, 55.58, 55.58, 55.86, 55.86, 55.38, 55.38, 55.48, 55.48, 55.7, 55.7, 55.9, 55.9, 55.86, 55.86, 55.94, 55.94, 55.32, 55.32, 55.32, 55.32, 53.9, 53.9, 53.28, 53.28, 54.82, 54.82, 55.04, 55.04, 55.12, 55.12, 54.8, 54.8, 54.6, 54.6, 54.96, 54.96, 54.58, 54.58, 55.18, 55.18, 55.42, 55.42, 55.06, 55.06, 54.9, 54.9, 54.14, 54.14, 52.9, 52.9, 53.32, 53.32, 52.96, 52.96, 52.64, 52.64, 52.36, 52.36, 52.74, 52.74, 53.18, 53.18, 52.28, 52.28, 51.9, 51.9, 51.96, 51.96, 52.46, 52.46, 52.4, 52.4, 52.76, 52.76, 53.2, 53.2, 53.44, 53.44, 53.86, 53.86, 53.5, 53.5, 53.48, 53.48, 52.9, 52.9, 52.86, 52.86, 51.12, 51.12]
/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
fedavg
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
[]
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Traceback (most recent call last):
  File "main_fedpac_co_teaching.py", line 250, in <module>
    local.filter_data(net=net_local.to(args.device), net2=net_local2.to(args.device), concept_matrix_local = concept_matrix[idx])
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 1587, in filter_data
    data_tmp = torch.from_numpy(np.array([self.dataset.data[data_idx].reshape(3, 32, 32)])).to(torch.float32)
RuntimeError: shape '[3, 32, 32]' is invalid for input of size 784
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist  

   Client 9, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.316, Test loss: 2.302, Test accuracy: 8.66
Round   0, Global train loss: 2.316, Global test loss: 2.303, Global test accuracy: 8.06
Round   1, Train loss: 2.297, Test loss: 2.297, Test accuracy: 24.56
Round   1, Global train loss: 2.297, Global test loss: 2.299, Global test accuracy: 21.92
Round   2, Train loss: 2.282, Test loss: 2.289, Test accuracy: 27.50
Round   2, Global train loss: 2.282, Global test loss: 2.293, Global test accuracy: 24.86
Round   3, Train loss: 2.258, Test loss: 2.240, Test accuracy: 20.40
Round   3, Global train loss: 2.258, Global test loss: 2.244, Global test accuracy: 18.00
Round   4, Train loss: 2.244, Test loss: 2.218, Test accuracy: 27.64
Round   4, Global train loss: 2.244, Global test loss: 2.247, Global test accuracy: 34.50
Round   5, Train loss: 2.175, Test loss: 2.172, Test accuracy: 31.22
Round   5, Global train loss: 2.175, Global test loss: 2.193, Global test accuracy: 30.72
Round   6, Train loss: 2.228, Test loss: 2.156, Test accuracy: 29.84
Round   6, Global train loss: 2.228, Global test loss: 2.201, Global test accuracy: 18.20
Round   7, Train loss: 2.128, Test loss: 2.106, Test accuracy: 35.94
Round   7, Global train loss: 2.128, Global test loss: 2.138, Global test accuracy: 34.52
Round   8, Train loss: 2.120, Test loss: 2.073, Test accuracy: 41.48
Round   8, Global train loss: 2.120, Global test loss: 2.122, Global test accuracy: 37.72
Round   9, Train loss: 2.112, Test loss: 2.046, Test accuracy: 45.18
Round   9, Global train loss: 2.112, Global test loss: 2.088, Global test accuracy: 40.20
Round  10, Train loss: 2.080, Test loss: 2.016, Test accuracy: 50.56
Round  10, Global train loss: 2.080, Global test loss: 2.080, Global test accuracy: 41.82
Round  11, Train loss: 2.065, Test loss: 1.996, Test accuracy: 51.24
Round  11, Global train loss: 2.065, Global test loss: 2.066, Global test accuracy: 40.72
Round  12, Train loss: 2.013, Test loss: 1.963, Test accuracy: 56.26
Round  12, Global train loss: 2.013, Global test loss: 2.030, Global test accuracy: 45.28
Round  13, Train loss: 2.177, Test loss: 1.962, Test accuracy: 58.58
Round  13, Global train loss: 2.177, Global test loss: 2.131, Global test accuracy: 34.24
Round  14, Train loss: 2.040, Test loss: 1.945, Test accuracy: 59.88
Round  14, Global train loss: 2.040, Global test loss: 2.050, Global test accuracy: 44.30
Round  15, Train loss: 1.991, Test loss: 1.930, Test accuracy: 59.98
Round  15, Global train loss: 1.991, Global test loss: 2.020, Global test accuracy: 49.34
Round  16, Train loss: 1.984, Test loss: 1.921, Test accuracy: 61.38
Round  16, Global train loss: 1.984, Global test loss: 2.010, Global test accuracy: 47.70
Round  17, Train loss: 2.185, Test loss: 1.930, Test accuracy: 62.18
Round  17, Global train loss: 2.185, Global test loss: 2.095, Global test accuracy: 45.36
Round  18, Train loss: 2.165, Test loss: 1.930, Test accuracy: 63.04
Round  18, Global train loss: 2.165, Global test loss: 2.100, Global test accuracy: 39.04
Round  19, Train loss: 1.986, Test loss: 1.901, Test accuracy: 65.54
Round  19, Global train loss: 1.986, Global test loss: 2.023, Global test accuracy: 44.80
Round  20, Train loss: 2.153, Test loss: 1.911, Test accuracy: 64.44
Round  20, Global train loss: 2.153, Global test loss: 2.087, Global test accuracy: 39.30
Round  21, Train loss: 2.153, Test loss: 1.913, Test accuracy: 64.62
Round  21, Global train loss: 2.153, Global test loss: 2.097, Global test accuracy: 42.64
Round  22, Train loss: 1.977, Test loss: 1.889, Test accuracy: 66.44
Round  22, Global train loss: 1.977, Global test loss: 2.020, Global test accuracy: 47.34
Round  23, Train loss: 2.161, Test loss: 1.898, Test accuracy: 66.16
Round  23, Global train loss: 2.161, Global test loss: 2.128, Global test accuracy: 31.58
Round  24, Train loss: 1.962, Test loss: 1.879, Test accuracy: 67.14
Round  24, Global train loss: 1.962, Global test loss: 2.012, Global test accuracy: 52.40
Round  25, Train loss: 2.144, Test loss: 1.885, Test accuracy: 66.78
Round  25, Global train loss: 2.144, Global test loss: 2.093, Global test accuracy: 38.64
Round  26, Train loss: 1.958, Test loss: 1.868, Test accuracy: 68.92
Round  26, Global train loss: 1.958, Global test loss: 1.993, Global test accuracy: 53.26
Round  27, Train loss: 2.154, Test loss: 1.875, Test accuracy: 69.18
Round  27, Global train loss: 2.154, Global test loss: 2.084, Global test accuracy: 47.84
Round  28, Train loss: 1.944, Test loss: 1.860, Test accuracy: 69.98
Round  28, Global train loss: 1.944, Global test loss: 1.983, Global test accuracy: 55.86
Round  29, Train loss: 2.136, Test loss: 1.860, Test accuracy: 69.86
Round  29, Global train loss: 2.136, Global test loss: 2.050, Global test accuracy: 52.88
Round  30, Train loss: 1.940, Test loss: 1.848, Test accuracy: 69.88
Round  30, Global train loss: 1.940, Global test loss: 2.015, Global test accuracy: 53.98
Round  31, Train loss: 1.935, Test loss: 1.838, Test accuracy: 70.74
Round  31, Global train loss: 1.935, Global test loss: 2.006, Global test accuracy: 50.24
Round  32, Train loss: 1.925, Test loss: 1.841, Test accuracy: 70.46
Round  32, Global train loss: 1.925, Global test loss: 2.024, Global test accuracy: 44.72
Round  33, Train loss: 1.929, Test loss: 1.838, Test accuracy: 70.98
Round  33, Global train loss: 1.929, Global test loss: 1.982, Global test accuracy: 54.24
Round  34, Train loss: 2.139, Test loss: 1.843, Test accuracy: 71.36
Round  34, Global train loss: 2.139, Global test loss: 2.108, Global test accuracy: 35.16
Round  35, Train loss: 2.122, Test loss: 1.855, Test accuracy: 70.40
Round  35, Global train loss: 2.122, Global test loss: 2.043, Global test accuracy: 53.94
Round  36, Train loss: 1.926, Test loss: 1.844, Test accuracy: 71.72
Round  36, Global train loss: 1.926, Global test loss: 2.004, Global test accuracy: 49.08
Round  37, Train loss: 2.120, Test loss: 1.863, Test accuracy: 69.62
Round  37, Global train loss: 2.120, Global test loss: 2.155, Global test accuracy: 27.82
Round  38, Train loss: 2.100, Test loss: 1.862, Test accuracy: 70.04
Round  38, Global train loss: 2.100, Global test loss: 2.072, Global test accuracy: 43.76
Round  39, Train loss: 2.119, Test loss: 1.860, Test accuracy: 71.02
Round  39, Global train loss: 2.119, Global test loss: 2.125, Global test accuracy: 34.04
Round  40, Train loss: 2.093, Test loss: 1.862, Test accuracy: 70.46
Round  40, Global train loss: 2.093, Global test loss: 2.114, Global test accuracy: 33.20
Round  41, Train loss: 2.090, Test loss: 1.869, Test accuracy: 69.52
Round  41, Global train loss: 2.090, Global test loss: 2.118, Global test accuracy: 34.68
Round  42, Train loss: 2.079, Test loss: 1.884, Test accuracy: 67.76
Round  42, Global train loss: 2.079, Global test loss: 2.120, Global test accuracy: 31.32
Round  43, Train loss: 1.904, Test loss: 1.856, Test accuracy: 69.14
Round  43, Global train loss: 1.904, Global test loss: 2.023, Global test accuracy: 46.78
Round  44, Train loss: 1.926, Test loss: 1.809, Test accuracy: 73.20
Round  44, Global train loss: 1.926, Global test loss: 2.013, Global test accuracy: 48.10
Round  45, Train loss: 2.084, Test loss: 1.829, Test accuracy: 71.94
Round  45, Global train loss: 2.084, Global test loss: 2.098, Global test accuracy: 39.76
Round  46, Train loss: 1.901, Test loss: 1.812, Test accuracy: 72.30
Round  46, Global train loss: 1.901, Global test loss: 2.124, Global test accuracy: 28.00
Round  47, Train loss: 2.070, Test loss: 1.830, Test accuracy: 70.98
Round  47, Global train loss: 2.070, Global test loss: 2.131, Global test accuracy: 28.00
Round  48, Train loss: 1.888, Test loss: 1.823, Test accuracy: 71.40
Round  48, Global train loss: 1.888, Global test loss: 2.032, Global test accuracy: 46.12
Round  49, Train loss: 1.712, Test loss: 1.794, Test accuracy: 72.66
Round  49, Global train loss: 1.712, Global test loss: 1.945, Global test accuracy: 54.42
Round  50, Train loss: 2.069, Test loss: 1.837, Test accuracy: 69.08
Round  50, Global train loss: 2.069, Global test loss: 2.075, Global test accuracy: 39.12
Round  51, Train loss: 2.080, Test loss: 1.822, Test accuracy: 71.94
Round  51, Global train loss: 2.080, Global test loss: 2.111, Global test accuracy: 33.76
Round  52, Train loss: 2.080, Test loss: 1.850, Test accuracy: 68.88
Round  52, Global train loss: 2.080, Global test loss: 2.060, Global test accuracy: 50.54
Round  53, Train loss: 1.921, Test loss: 1.814, Test accuracy: 71.86
Round  53, Global train loss: 1.921, Global test loss: 2.009, Global test accuracy: 49.54
Round  54, Train loss: 1.864, Test loss: 1.827, Test accuracy: 70.06
Round  54, Global train loss: 1.864, Global test loss: 2.103, Global test accuracy: 33.16
Round  55, Train loss: 1.853, Test loss: 1.817, Test accuracy: 70.46
Round  55, Global train loss: 1.853, Global test loss: 2.122, Global test accuracy: 28.94
Round  56, Train loss: 2.056, Test loss: 1.838, Test accuracy: 68.66
Round  56, Global train loss: 2.056, Global test loss: 2.024, Global test accuracy: 52.28
Round  57, Train loss: 2.044, Test loss: 1.862, Test accuracy: 66.02
Round  57, Global train loss: 2.044, Global test loss: 2.071, Global test accuracy: 44.50
Round  58, Train loss: 2.062, Test loss: 1.876, Test accuracy: 64.68
Round  58, Global train loss: 2.062, Global test loss: 2.098, Global test accuracy: 44.16
Round  59, Train loss: 2.064, Test loss: 1.857, Test accuracy: 66.88
Round  59, Global train loss: 2.064, Global test loss: 2.086, Global test accuracy: 42.62
Round  60, Train loss: 1.844, Test loss: 1.823, Test accuracy: 69.92
Round  60, Global train loss: 1.844, Global test loss: 2.048, Global test accuracy: 40.68
Round  61, Train loss: 2.008, Test loss: 1.860, Test accuracy: 66.36
Round  61, Global train loss: 2.008, Global test loss: 2.128, Global test accuracy: 32.52
Round  62, Train loss: 1.868, Test loss: 1.828, Test accuracy: 69.46
Round  62, Global train loss: 1.868, Global test loss: 1.999, Global test accuracy: 50.66
Round  63, Train loss: 1.839, Test loss: 1.815, Test accuracy: 70.22
Round  63, Global train loss: 1.839, Global test loss: 1.969, Global test accuracy: 53.40
Round  64, Train loss: 1.824, Test loss: 1.820, Test accuracy: 70.02
Round  64, Global train loss: 1.824, Global test loss: 2.048, Global test accuracy: 41.28
Round  65, Train loss: 1.994, Test loss: 1.863, Test accuracy: 65.02
Round  65, Global train loss: 1.994, Global test loss: 2.139, Global test accuracy: 31.64
Round  66, Train loss: 1.998, Test loss: 1.886, Test accuracy: 63.12
Round  66, Global train loss: 1.998, Global test loss: 2.080, Global test accuracy: 45.16
Round  67, Train loss: 1.817, Test loss: 1.828, Test accuracy: 68.64
Round  67, Global train loss: 1.817, Global test loss: 2.035, Global test accuracy: 43.70
Round  68, Train loss: 1.816, Test loss: 1.837, Test accuracy: 67.44
Round  68, Global train loss: 1.816, Global test loss: 2.001, Global test accuracy: 50.52
Round  69, Train loss: 1.863, Test loss: 1.808, Test accuracy: 70.50
Round  69, Global train loss: 1.863, Global test loss: 2.010, Global test accuracy: 47.02
Round  70, Train loss: 1.962, Test loss: 1.848, Test accuracy: 66.32
Round  70, Global train loss: 1.962, Global test loss: 2.118, Global test accuracy: 35.06
Round  71, Train loss: 1.849, Test loss: 1.806, Test accuracy: 70.08
Round  71, Global train loss: 1.849, Global test loss: 2.000, Global test accuracy: 47.42
Round  72, Train loss: 1.958, Test loss: 1.864, Test accuracy: 64.16
Round  72, Global train loss: 1.958, Global test loss: 2.060, Global test accuracy: 44.30
Round  73, Train loss: 1.845, Test loss: 1.823, Test accuracy: 69.02
Round  73, Global train loss: 1.845, Global test loss: 2.014, Global test accuracy: 46.88
Round  74, Train loss: 1.836, Test loss: 1.817, Test accuracy: 69.38
Round  74, Global train loss: 1.836, Global test loss: 2.027, Global test accuracy: 46.80
Round  75, Train loss: 1.989, Test loss: 1.865, Test accuracy: 64.48
Round  75, Global train loss: 1.989, Global test loss: 2.060, Global test accuracy: 46.02
Round  76, Train loss: 1.819, Test loss: 1.818, Test accuracy: 68.52
Round  76, Global train loss: 1.819, Global test loss: 1.990, Global test accuracy: 51.80
Round  77, Train loss: 1.784, Test loss: 1.825, Test accuracy: 67.62
Round  77, Global train loss: 1.784, Global test loss: 1.994, Global test accuracy: 49.52
Round  78, Train loss: 1.837, Test loss: 1.820, Test accuracy: 68.20
Round  78, Global train loss: 1.837, Global test loss: 2.024, Global test accuracy: 42.84
Round  79, Train loss: 1.781, Test loss: 1.838, Test accuracy: 66.58
Round  79, Global train loss: 1.781, Global test loss: 1.998, Global test accuracy: 48.24
Round  80, Train loss: 1.803, Test loss: 1.818, Test accuracy: 68.60
Round  80, Global train loss: 1.803, Global test loss: 2.028, Global test accuracy: 43.10
Round  81, Train loss: 1.786, Test loss: 1.822, Test accuracy: 67.72
Round  81, Global train loss: 1.786, Global test loss: 1.974, Global test accuracy: 52.48
Round  82, Train loss: 1.932, Test loss: 1.866, Test accuracy: 64.04
Round  82, Global train loss: 1.932, Global test loss: 2.113, Global test accuracy: 36.30
Round  83, Train loss: 1.926, Test loss: 1.877, Test accuracy: 62.36
Round  83, Global train loss: 1.926, Global test loss: 2.111, Global test accuracy: 34.10
Round  84, Train loss: 1.747, Test loss: 1.846, Test accuracy: 65.42
Round  84, Global train loss: 1.747, Global test loss: 1.993, Global test accuracy: 48.50
Round  85, Train loss: 1.804, Test loss: 1.815, Test accuracy: 69.10
Round  85, Global train loss: 1.804, Global test loss: 1.988, Global test accuracy: 52.92
Round  86, Train loss: 1.775, Test loss: 1.835, Test accuracy: 66.80
Round  86, Global train loss: 1.775, Global test loss: 2.012, Global test accuracy: 48.40
Round  87, Train loss: 1.774, Test loss: 1.824, Test accuracy: 67.48
Round  87, Global train loss: 1.774, Global test loss: 2.026, Global test accuracy: 44.06
Round  88, Train loss: 1.871, Test loss: 1.898, Test accuracy: 59.76
Round  88, Global train loss: 1.871, Global test loss: 2.131, Global test accuracy: 32.90
Round  89, Train loss: 1.862, Test loss: 1.922, Test accuracy: 57.10
Round  89, Global train loss: 1.862, Global test loss: 2.158, Global test accuracy: 28.10
Round  90, Train loss: 1.867, Test loss: 1.917, Test accuracy: 57.60
Round  90, Global train loss: 1.867, Global test loss: 2.116, Global test accuracy: 36.08/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.860, Test loss: 1.920, Test accuracy: 57.16
Round  91, Global train loss: 1.860, Global test loss: 2.088, Global test accuracy: 41.26
Round  92, Train loss: 1.787, Test loss: 1.844, Test accuracy: 65.10
Round  92, Global train loss: 1.787, Global test loss: 2.020, Global test accuracy: 46.18
Round  93, Train loss: 1.747, Test loss: 1.853, Test accuracy: 64.74
Round  93, Global train loss: 1.747, Global test loss: 2.016, Global test accuracy: 47.60
Round  94, Train loss: 1.945, Test loss: 1.881, Test accuracy: 61.82
Round  94, Global train loss: 1.945, Global test loss: 2.147, Global test accuracy: 30.48
Round  95, Train loss: 1.803, Test loss: 1.835, Test accuracy: 66.50
Round  95, Global train loss: 1.803, Global test loss: 2.062, Global test accuracy: 40.18
Round  96, Train loss: 1.602, Test loss: 1.802, Test accuracy: 69.58
Round  96, Global train loss: 1.602, Global test loss: 1.947, Global test accuracy: 51.82
Round  97, Train loss: 1.896, Test loss: 1.892, Test accuracy: 59.68
Round  97, Global train loss: 1.896, Global test loss: 2.140, Global test accuracy: 32.02
Round  98, Train loss: 1.759, Test loss: 1.854, Test accuracy: 64.52
Round  98, Global train loss: 1.759, Global test loss: 2.039, Global test accuracy: 43.58
Round  99, Train loss: 1.727, Test loss: 1.867, Test accuracy: 63.08
Round  99, Global train loss: 1.727, Global test loss: 2.032, Global test accuracy: 44.08
Final Round, Train loss: 1.793, Test loss: 1.845, Test accuracy: 64.80
Final Round, Global train loss: 1.793, Global test loss: 2.032, Global test accuracy: 44.08
Average accuracy final 10 rounds: 62.97799999999999
625.3845000267029
[1.1608493328094482, 2.2824900150299072, 3.2686209678649902, 4.378550052642822, 5.432528257369995, 6.459788084030151, 7.487138032913208, 8.524381160736084, 9.580326557159424, 10.551225662231445, 11.531479597091675, 12.611724615097046, 13.69965648651123, 14.767540216445923, 15.833831787109375, 16.869934558868408, 17.896207094192505, 18.930054664611816, 20.04632329940796, 21.10474443435669, 22.137082815170288, 23.218666315078735, 24.284101009368896, 25.309609174728394, 26.40408444404602, 27.517747402191162, 28.497896909713745, 29.49328923225403, 30.535258054733276, 31.480520248413086, 32.549347162246704, 33.60575795173645, 34.658926010131836, 35.7201771736145, 36.75129961967468, 37.82944345474243, 38.82526159286499, 39.884708404541016, 40.896631717681885, 41.86087989807129, 42.87135100364685, 43.91292762756348, 44.833054304122925, 45.93597936630249, 47.043407678604126, 48.11353373527527, 49.1840238571167, 50.23052358627319, 51.29220652580261, 52.350306272506714, 53.43362236022949, 54.55106234550476, 55.58587670326233, 56.656222105026245, 57.72334122657776, 58.68510031700134, 59.73106002807617, 60.838289737701416, 61.843637228012085, 62.87705373764038, 63.971657037734985, 65.05792713165283, 66.18138432502747, 67.2858715057373, 68.38181138038635, 69.4071433544159, 70.52252912521362, 71.5840048789978, 72.66738319396973, 73.75945973396301, 74.82543540000916, 75.95926117897034, 77.26299238204956, 78.68712997436523, 79.93383359909058, 81.27918291091919, 82.6119647026062, 83.81926584243774, 85.22841930389404, 86.73668956756592, 88.04720377922058, 89.254070520401, 90.50524735450745, 91.77215051651001, 92.96267461776733, 94.35983872413635, 95.6912682056427, 96.94783735275269, 98.18704152107239, 99.47083187103271, 100.73965167999268, 102.01281261444092, 103.33241939544678, 104.58352971076965, 105.83943033218384, 106.95414018630981, 108.2414481639862, 109.46005368232727, 110.78334498405457, 112.00087285041809, 114.05205416679382]
[8.66, 24.56, 27.5, 20.4, 27.64, 31.22, 29.84, 35.94, 41.48, 45.18, 50.56, 51.24, 56.26, 58.58, 59.88, 59.98, 61.38, 62.18, 63.04, 65.54, 64.44, 64.62, 66.44, 66.16, 67.14, 66.78, 68.92, 69.18, 69.98, 69.86, 69.88, 70.74, 70.46, 70.98, 71.36, 70.4, 71.72, 69.62, 70.04, 71.02, 70.46, 69.52, 67.76, 69.14, 73.2, 71.94, 72.3, 70.98, 71.4, 72.66, 69.08, 71.94, 68.88, 71.86, 70.06, 70.46, 68.66, 66.02, 64.68, 66.88, 69.92, 66.36, 69.46, 70.22, 70.02, 65.02, 63.12, 68.64, 67.44, 70.5, 66.32, 70.08, 64.16, 69.02, 69.38, 64.48, 68.52, 67.62, 68.2, 66.58, 68.6, 67.72, 64.04, 62.36, 65.42, 69.1, 66.8, 67.48, 59.76, 57.1, 57.6, 57.16, 65.1, 64.74, 61.82, 66.5, 69.58, 59.68, 64.52, 63.08, 64.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: mnist,  filter_alg: loss_psl, level_n_system: 0.8 , level_n_lowerb:0.8  

   Client 5, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
odict_keys(['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias'])
8
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias']
['layer_input.weight', 'layer_input.bias', 'layer_hidden1.weight', 'layer_hidden1.bias', 'layer_hidden2.weight', 'layer_hidden2.bias', 'layer_out.weight', 'layer_out.bias']
# Params: 550346 (local), 549696 (global); Percentage 99.88 (549696/550346)
learning rate, batch size: 0.01, 10
MLP(
  (layer_input): Linear(in_features=784, out_features=512, bias=True)
  (relu): ReLU()
  (dropout): Dropout(p=0, inplace=False)
  (layer_hidden1): Linear(in_features=512, out_features=256, bias=True)
  (layer_hidden2): Linear(in_features=256, out_features=64, bias=True)
  (layer_out): Linear(in_features=64, out_features=10, bias=True)
  (softmax): Softmax(dim=1)
)
Round   0, Train loss: 2.317, Test loss: 2.298, Test accuracy: 11.24
Round   0, Global train loss: 2.317, Global test loss: 2.300, Global test accuracy: 10.04
Round   1, Train loss: 2.293, Test loss: 2.292, Test accuracy: 28.90
Round   1, Global train loss: 2.293, Global test loss: 2.298, Global test accuracy: 26.42
Round   2, Train loss: 2.284, Test loss: 2.280, Test accuracy: 31.50
Round   2, Global train loss: 2.284, Global test loss: 2.293, Global test accuracy: 20.36
Round   3, Train loss: 2.266, Test loss: 2.253, Test accuracy: 23.78
Round   3, Global train loss: 2.266, Global test loss: 2.281, Global test accuracy: 18.00
Round   4, Train loss: 2.227, Test loss: 2.202, Test accuracy: 26.54
Round   4, Global train loss: 2.227, Global test loss: 2.251, Global test accuracy: 18.00
Round   5, Train loss: 2.185, Test loss: 2.147, Test accuracy: 35.58
Round   5, Global train loss: 2.185, Global test loss: 2.212, Global test accuracy: 23.70
Round   6, Train loss: 2.155, Test loss: 2.094, Test accuracy: 43.82
Round   6, Global train loss: 2.155, Global test loss: 2.175, Global test accuracy: 28.54
Round   7, Train loss: 2.133, Test loss: 2.052, Test accuracy: 48.98
Round   7, Global train loss: 2.133, Global test loss: 2.145, Global test accuracy: 30.02
Round   8, Train loss: 2.117, Test loss: 2.021, Test accuracy: 52.62
Round   8, Global train loss: 2.117, Global test loss: 2.125, Global test accuracy: 32.56
Round   9, Train loss: 2.105, Test loss: 1.996, Test accuracy: 55.96
Round   9, Global train loss: 2.105, Global test loss: 2.109, Global test accuracy: 36.00
Round  10, Train loss: 2.029, Test loss: 1.974, Test accuracy: 58.38
Round  10, Global train loss: 2.029, Global test loss: 2.078, Global test accuracy: 39.56
Round  11, Train loss: 1.919, Test loss: 1.930, Test accuracy: 61.24
Round  11, Global train loss: 1.919, Global test loss: 2.026, Global test accuracy: 45.64
Round  12, Train loss: 1.888, Test loss: 1.903, Test accuracy: 62.84
Round  12, Global train loss: 1.888, Global test loss: 2.038, Global test accuracy: 43.60
Round  13, Train loss: 1.996, Test loss: 1.900, Test accuracy: 62.18
Round  13, Global train loss: 1.996, Global test loss: 2.129, Global test accuracy: 30.96
Round  14, Train loss: 1.873, Test loss: 1.878, Test accuracy: 63.84
Round  14, Global train loss: 1.873, Global test loss: 2.015, Global test accuracy: 46.64
Round  15, Train loss: 1.847, Test loss: 1.869, Test accuracy: 64.34
Round  15, Global train loss: 1.847, Global test loss: 1.998, Global test accuracy: 45.10
Round  16, Train loss: 1.846, Test loss: 1.873, Test accuracy: 63.24
Round  16, Global train loss: 1.846, Global test loss: 1.996, Global test accuracy: 52.56
Round  17, Train loss: 1.968, Test loss: 1.877, Test accuracy: 62.52
Round  17, Global train loss: 1.968, Global test loss: 2.033, Global test accuracy: 47.74
Round  18, Train loss: 1.961, Test loss: 1.875, Test accuracy: 62.86
Round  18, Global train loss: 1.961, Global test loss: 2.067, Global test accuracy: 43.46
Round  19, Train loss: 1.830, Test loss: 1.863, Test accuracy: 63.42
Round  19, Global train loss: 1.830, Global test loss: 1.999, Global test accuracy: 48.78
Round  20, Train loss: 1.931, Test loss: 1.871, Test accuracy: 62.80
Round  20, Global train loss: 1.931, Global test loss: 2.062, Global test accuracy: 38.74
Round  21, Train loss: 1.939, Test loss: 1.872, Test accuracy: 62.96
Round  21, Global train loss: 1.939, Global test loss: 2.085, Global test accuracy: 37.56
Round  22, Train loss: 1.826, Test loss: 1.857, Test accuracy: 63.50
Round  22, Global train loss: 1.826, Global test loss: 1.985, Global test accuracy: 47.80
Round  23, Train loss: 1.957, Test loss: 1.866, Test accuracy: 63.54
Round  23, Global train loss: 1.957, Global test loss: 2.116, Global test accuracy: 34.00
Round  24, Train loss: 1.813, Test loss: 1.849, Test accuracy: 64.82
Round  24, Global train loss: 1.813, Global test loss: 2.011, Global test accuracy: 47.50
Round  25, Train loss: 1.946, Test loss: 1.856, Test accuracy: 64.14
Round  25, Global train loss: 1.946, Global test loss: 2.060, Global test accuracy: 42.16
Round  26, Train loss: 1.806, Test loss: 1.846, Test accuracy: 64.42
Round  26, Global train loss: 1.806, Global test loss: 1.993, Global test accuracy: 51.66
Round  27, Train loss: 1.933, Test loss: 1.853, Test accuracy: 64.14
Round  27, Global train loss: 1.933, Global test loss: 2.011, Global test accuracy: 48.16
Round  28, Train loss: 1.790, Test loss: 1.843, Test accuracy: 64.74
Round  28, Global train loss: 1.790, Global test loss: 1.990, Global test accuracy: 51.10
Round  29, Train loss: 1.911, Test loss: 1.857, Test accuracy: 62.98
Round  29, Global train loss: 1.911, Global test loss: 1.998, Global test accuracy: 54.26
Round  30, Train loss: 1.791, Test loss: 1.844, Test accuracy: 64.06
Round  30, Global train loss: 1.791, Global test loss: 2.006, Global test accuracy: 48.44
Round  31, Train loss: 1.780, Test loss: 1.838, Test accuracy: 64.62
Round  31, Global train loss: 1.780, Global test loss: 2.029, Global test accuracy: 47.20
Round  32, Train loss: 1.752, Test loss: 1.846, Test accuracy: 64.38
Round  32, Global train loss: 1.752, Global test loss: 2.051, Global test accuracy: 38.06
Round  33, Train loss: 1.768, Test loss: 1.824, Test accuracy: 66.74
Round  33, Global train loss: 1.768, Global test loss: 1.995, Global test accuracy: 47.14
Round  34, Train loss: 1.900, Test loss: 1.811, Test accuracy: 67.94
Round  34, Global train loss: 1.900, Global test loss: 2.067, Global test accuracy: 43.00
Round  35, Train loss: 1.857, Test loss: 1.834, Test accuracy: 66.22
Round  35, Global train loss: 1.857, Global test loss: 2.008, Global test accuracy: 46.98
Round  36, Train loss: 1.783, Test loss: 1.831, Test accuracy: 66.10
Round  36, Global train loss: 1.783, Global test loss: 1.987, Global test accuracy: 50.42
Round  37, Train loss: 1.849, Test loss: 1.840, Test accuracy: 65.78
Round  37, Global train loss: 1.849, Global test loss: 2.048, Global test accuracy: 39.36
Round  38, Train loss: 1.868, Test loss: 1.834, Test accuracy: 66.12
Round  38, Global train loss: 1.868, Global test loss: 2.060, Global test accuracy: 42.22
Round  39, Train loss: 1.859, Test loss: 1.826, Test accuracy: 67.14
Round  39, Global train loss: 1.859, Global test loss: 2.097, Global test accuracy: 34.62
Round  40, Train loss: 1.843, Test loss: 1.838, Test accuracy: 65.64
Round  40, Global train loss: 1.843, Global test loss: 2.099, Global test accuracy: 36.36
Round  41, Train loss: 1.835, Test loss: 1.871, Test accuracy: 61.62
Round  41, Global train loss: 1.835, Global test loss: 2.110, Global test accuracy: 33.92
Round  42, Train loss: 1.804, Test loss: 1.861, Test accuracy: 63.30
Round  42, Global train loss: 1.804, Global test loss: 2.114, Global test accuracy: 31.68
Round  43, Train loss: 1.726, Test loss: 1.842, Test accuracy: 65.40
Round  43, Global train loss: 1.726, Global test loss: 1.997, Global test accuracy: 49.26
Round  44, Train loss: 1.780, Test loss: 1.813, Test accuracy: 67.64
Round  44, Global train loss: 1.780, Global test loss: 2.022, Global test accuracy: 44.96
Round  45, Train loss: 1.822, Test loss: 1.845, Test accuracy: 64.82
Round  45, Global train loss: 1.822, Global test loss: 2.126, Global test accuracy: 32.92
Round  46, Train loss: 1.729, Test loss: 1.815, Test accuracy: 67.94
Round  46, Global train loss: 1.729, Global test loss: 2.091, Global test accuracy: 35.00
Round  47, Train loss: 1.786, Test loss: 1.834, Test accuracy: 66.36
Round  47, Global train loss: 1.786, Global test loss: 2.138, Global test accuracy: 27.96
Round  48, Train loss: 1.691, Test loss: 1.816, Test accuracy: 67.40
Round  48, Global train loss: 1.691, Global test loss: 2.019, Global test accuracy: 47.46
Round  49, Train loss: 1.604, Test loss: 1.791, Test accuracy: 69.42
Round  49, Global train loss: 1.604, Global test loss: 1.966, Global test accuracy: 52.16
Round  50, Train loss: 1.789, Test loss: 1.840, Test accuracy: 64.66
Round  50, Global train loss: 1.789, Global test loss: 2.053, Global test accuracy: 41.36
Round  51, Train loss: 1.840, Test loss: 1.858, Test accuracy: 62.44
Round  51, Global train loss: 1.840, Global test loss: 2.133, Global test accuracy: 29.38
Round  52, Train loss: 1.797, Test loss: 1.862, Test accuracy: 62.72
Round  52, Global train loss: 1.797, Global test loss: 2.011, Global test accuracy: 47.78
Round  53, Train loss: 1.734, Test loss: 1.824, Test accuracy: 66.54
Round  53, Global train loss: 1.734, Global test loss: 2.045, Global test accuracy: 38.98
Round  54, Train loss: 1.685, Test loss: 1.831, Test accuracy: 65.80
Round  54, Global train loss: 1.685, Global test loss: 2.072, Global test accuracy: 37.78
Round  55, Train loss: 1.675, Test loss: 1.821, Test accuracy: 66.66
Round  55, Global train loss: 1.675, Global test loss: 2.089, Global test accuracy: 35.76
Round  56, Train loss: 1.742, Test loss: 1.848, Test accuracy: 63.94
Round  56, Global train loss: 1.742, Global test loss: 2.019, Global test accuracy: 43.74
Round  57, Train loss: 1.767, Test loss: 1.883, Test accuracy: 59.72
Round  57, Global train loss: 1.767, Global test loss: 2.063, Global test accuracy: 44.12
Round  58, Train loss: 1.774, Test loss: 1.893, Test accuracy: 58.20
Round  58, Global train loss: 1.774, Global test loss: 2.058, Global test accuracy: 42.90
Round  59, Train loss: 1.797, Test loss: 1.884, Test accuracy: 59.58
Round  59, Global train loss: 1.797, Global test loss: 2.077, Global test accuracy: 37.14
Round  60, Train loss: 1.694, Test loss: 1.853, Test accuracy: 63.20
Round  60, Global train loss: 1.694, Global test loss: 2.044, Global test accuracy: 43.04
Round  61, Train loss: 1.745, Test loss: 1.850, Test accuracy: 63.76
Round  61, Global train loss: 1.745, Global test loss: 2.120, Global test accuracy: 32.94
Round  62, Train loss: 1.667, Test loss: 1.847, Test accuracy: 63.74
Round  62, Global train loss: 1.667, Global test loss: 1.994, Global test accuracy: 48.42
Round  63, Train loss: 1.662, Test loss: 1.831, Test accuracy: 65.08
Round  63, Global train loss: 1.662, Global test loss: 1.982, Global test accuracy: 48.50
Round  64, Train loss: 1.640, Test loss: 1.839, Test accuracy: 64.26
Round  64, Global train loss: 1.640, Global test loss: 2.018, Global test accuracy: 45.50
Round  65, Train loss: 1.720, Test loss: 1.876, Test accuracy: 60.12
Round  65, Global train loss: 1.720, Global test loss: 2.125, Global test accuracy: 31.72
Round  66, Train loss: 1.737, Test loss: 1.883, Test accuracy: 59.56
Round  66, Global train loss: 1.737, Global test loss: 2.031, Global test accuracy: 45.88
Round  67, Train loss: 1.654, Test loss: 1.838, Test accuracy: 64.72
Round  67, Global train loss: 1.654, Global test loss: 2.012, Global test accuracy: 47.58
Round  68, Train loss: 1.634, Test loss: 1.849, Test accuracy: 62.64
Round  68, Global train loss: 1.634, Global test loss: 1.989, Global test accuracy: 49.58
Round  69, Train loss: 1.680, Test loss: 1.811, Test accuracy: 66.82
Round  69, Global train loss: 1.680, Global test loss: 2.022, Global test accuracy: 41.80
Round  70, Train loss: 1.731, Test loss: 1.859, Test accuracy: 62.72
Round  70, Global train loss: 1.731, Global test loss: 2.131, Global test accuracy: 32.60
Round  71, Train loss: 1.671, Test loss: 1.822, Test accuracy: 65.60
Round  71, Global train loss: 1.671, Global test loss: 2.027, Global test accuracy: 41.26
Round  72, Train loss: 1.714, Test loss: 1.858, Test accuracy: 62.34
Round  72, Global train loss: 1.714, Global test loss: 2.009, Global test accuracy: 47.22
Round  73, Train loss: 1.647, Test loss: 1.832, Test accuracy: 64.74
Round  73, Global train loss: 1.647, Global test loss: 2.039, Global test accuracy: 41.10
Round  74, Train loss: 1.644, Test loss: 1.833, Test accuracy: 64.96
Round  74, Global train loss: 1.644, Global test loss: 2.012, Global test accuracy: 47.14
Round  75, Train loss: 1.713, Test loss: 1.859, Test accuracy: 62.22
Round  75, Global train loss: 1.713, Global test loss: 2.041, Global test accuracy: 44.54
Round  76, Train loss: 1.653, Test loss: 1.833, Test accuracy: 64.68
Round  76, Global train loss: 1.653, Global test loss: 1.993, Global test accuracy: 46.92
Round  77, Train loss: 1.651, Test loss: 1.831, Test accuracy: 64.62
Round  77, Global train loss: 1.651, Global test loss: 2.007, Global test accuracy: 43.92
Round  78, Train loss: 1.651, Test loss: 1.832, Test accuracy: 63.76
Round  78, Global train loss: 1.651, Global test loss: 1.970, Global test accuracy: 51.66
Round  79, Train loss: 1.639, Test loss: 1.840, Test accuracy: 63.68
Round  79, Global train loss: 1.639, Global test loss: 1.977, Global test accuracy: 50.10
Round  80, Train loss: 1.493, Test loss: 1.780, Test accuracy: 69.20
Round  80, Global train loss: 1.493, Global test loss: 1.903, Global test accuracy: 56.98
Round  81, Train loss: 1.470, Test loss: 1.765, Test accuracy: 70.86
Round  81, Global train loss: 1.470, Global test loss: 1.890, Global test accuracy: 58.60
Round  82, Train loss: 1.468, Test loss: 1.759, Test accuracy: 71.46
Round  82, Global train loss: 1.468, Global test loss: 1.884, Global test accuracy: 59.38
Round  83, Train loss: 1.467, Test loss: 1.756, Test accuracy: 71.92
Round  83, Global train loss: 1.467, Global test loss: 1.880, Global test accuracy: 59.70
Round  84, Train loss: 1.466, Test loss: 1.754, Test accuracy: 72.10
Round  84, Global train loss: 1.466, Global test loss: 1.879, Global test accuracy: 59.84
Round  85, Train loss: 1.465, Test loss: 1.752, Test accuracy: 72.22
Round  85, Global train loss: 1.465, Global test loss: 1.878, Global test accuracy: 59.76
Round  86, Train loss: 1.465, Test loss: 1.751, Test accuracy: 72.40
Round  86, Global train loss: 1.465, Global test loss: 1.876, Global test accuracy: 59.84
Round  87, Train loss: 1.465, Test loss: 1.750, Test accuracy: 72.36
Round  87, Global train loss: 1.465, Global test loss: 1.876, Global test accuracy: 59.92
Round  88, Train loss: 1.465, Test loss: 1.749, Test accuracy: 72.42
Round  88, Global train loss: 1.465, Global test loss: 1.875, Global test accuracy: 60.02
Round  89, Train loss: 1.464, Test loss: 1.748, Test accuracy: 72.44
Round  89, Global train loss: 1.464, Global test loss: 1.874, Global test accuracy: 60.20
Round  90, Train loss: 1.464, Test loss: 1.748, Test accuracy: 72.44
Round  90, Global train loss: 1.464, Global test loss: 1.874, Global test accuracy: 60.18/home/ChenSM/code/FL_HLS/utils/sampling.py:93: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  label = torch.tensor(dataset.targets[i]).item()

Round  91, Train loss: 1.464, Test loss: 1.747, Test accuracy: 72.52
Round  91, Global train loss: 1.464, Global test loss: 1.874, Global test accuracy: 60.20
Round  92, Train loss: 1.464, Test loss: 1.747, Test accuracy: 72.60
Round  92, Global train loss: 1.464, Global test loss: 1.874, Global test accuracy: 60.18
Round  93, Train loss: 1.464, Test loss: 1.747, Test accuracy: 72.68
Round  93, Global train loss: 1.464, Global test loss: 1.874, Global test accuracy: 60.24
Round  94, Train loss: 1.464, Test loss: 1.747, Test accuracy: 72.76
Round  94, Global train loss: 1.464, Global test loss: 1.873, Global test accuracy: 60.24
Round  95, Train loss: 1.464, Test loss: 1.746, Test accuracy: 72.74
Round  95, Global train loss: 1.464, Global test loss: 1.873, Global test accuracy: 60.40
Round  96, Train loss: 1.464, Test loss: 1.746, Test accuracy: 72.78
Round  96, Global train loss: 1.464, Global test loss: 1.873, Global test accuracy: 60.34
Round  97, Train loss: 1.464, Test loss: 1.745, Test accuracy: 72.84
Round  97, Global train loss: 1.464, Global test loss: 1.873, Global test accuracy: 60.36
Round  98, Train loss: 1.464, Test loss: 1.745, Test accuracy: 72.80
Round  98, Global train loss: 1.464, Global test loss: 1.872, Global test accuracy: 60.42
Round  99, Train loss: 1.673, Test loss: 1.800, Test accuracy: 67.26
Round  99, Global train loss: 1.673, Global test loss: 1.930, Global test accuracy: 58.00
Final Round, Train loss: 1.814, Test loss: 1.790, Test accuracy: 68.36
Final Round, Global train loss: 1.814, Global test loss: 1.930, Global test accuracy: 58.00
Average accuracy final 10 rounds: 72.142
1971.8798735141754
[1.475492000579834, 2.860579013824463, 4.290587425231934, 5.633291482925415, 7.1965107917785645, 8.64552640914917, 10.059365510940552, 11.404685735702515, 12.848083972930908, 14.274983167648315, 19.02018094062805, 26.612950086593628, 34.41765379905701, 42.03925395011902, 49.860535621643066, 57.46800208091736, 65.16310834884644, 72.8052978515625, 80.41213989257812, 88.16937041282654, 96.16005182266235, 104.1623306274414, 112.33153223991394, 120.17285180091858, 127.98407626152039, 136.1107861995697, 143.88653659820557, 151.82148265838623, 159.83970665931702, 167.63538265228271, 175.6469156742096, 183.47805047035217, 191.11926698684692, 199.05286955833435, 206.9924886226654, 215.1676435470581, 223.2021074295044, 231.02970385551453, 238.92535662651062, 246.937819480896, 254.59944939613342, 262.53239727020264, 270.60022735595703, 278.321786403656, 286.29502153396606, 294.3007342815399, 302.5201106071472, 310.4309027194977, 318.056782245636, 325.9081242084503, 333.9212040901184, 341.8704206943512, 349.7893033027649, 357.7818400859833, 365.7972538471222, 373.4654018878937, 381.22023034095764, 388.99172854423523, 397.31356382369995, 405.4240918159485, 413.9698088169098, 421.7902019023895, 429.92143058776855, 437.68645334243774, 445.8116202354431, 453.76734733581543, 461.7390727996826, 469.4749114513397, 477.4197416305542, 484.9382495880127, 492.7118937969208, 500.441547870636, 508.34118008613586, 516.1205205917358, 523.8593876361847, 531.3936626911163, 538.8865420818329, 546.267011642456, 553.6570959091187, 561.3402915000916, 562.6910417079926, 564.051812171936, 565.3399758338928, 566.6083254814148, 567.9810492992401, 569.3699760437012, 570.7427415847778, 572.0953016281128, 573.3916220664978, 574.7096774578094, 575.9811067581177, 577.2191436290741, 578.5195226669312, 579.8257491588593, 581.2130424976349, 582.4691865444183, 583.7534682750702, 585.1581201553345, 586.4083743095398, 594.0052876472473, 602.332269191742]
[11.24, 28.9, 31.5, 23.78, 26.54, 35.58, 43.82, 48.98, 52.62, 55.96, 58.38, 61.24, 62.84, 62.18, 63.84, 64.34, 63.24, 62.52, 62.86, 63.42, 62.8, 62.96, 63.5, 63.54, 64.82, 64.14, 64.42, 64.14, 64.74, 62.98, 64.06, 64.62, 64.38, 66.74, 67.94, 66.22, 66.1, 65.78, 66.12, 67.14, 65.64, 61.62, 63.3, 65.4, 67.64, 64.82, 67.94, 66.36, 67.4, 69.42, 64.66, 62.44, 62.72, 66.54, 65.8, 66.66, 63.94, 59.72, 58.2, 59.58, 63.2, 63.76, 63.74, 65.08, 64.26, 60.12, 59.56, 64.72, 62.64, 66.82, 62.72, 65.6, 62.34, 64.74, 64.96, 62.22, 64.68, 64.62, 63.76, 63.68, 69.2, 70.86, 71.46, 71.92, 72.1, 72.22, 72.4, 72.36, 72.42, 72.44, 72.44, 72.52, 72.6, 72.68, 72.76, 72.74, 72.78, 72.84, 72.8, 67.26, 68.36]
