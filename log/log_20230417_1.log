nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.465, Test loss: 1.321, Test accuracy: 49.24 

Round   0, Global train loss: 1.465, Global test loss: 2.224, Global test accuracy: 21.64 

Round   1, Train loss: 1.166, Test loss: 1.381, Test accuracy: 50.16 

Round   1, Global train loss: 1.166, Global test loss: 2.263, Global test accuracy: 18.28 

Round   2, Train loss: 0.992, Test loss: 1.317, Test accuracy: 54.16 

Round   2, Global train loss: 0.992, Global test loss: 2.310, Global test accuracy: 21.68 

Round   3, Train loss: 0.851, Test loss: 1.363, Test accuracy: 56.00 

Round   3, Global train loss: 0.851, Global test loss: 2.397, Global test accuracy: 18.56 

Round   4, Train loss: 0.727, Test loss: 1.583, Test accuracy: 54.00 

Round   4, Global train loss: 0.727, Global test loss: 2.352, Global test accuracy: 23.16 

Round   5, Train loss: 0.634, Test loss: 1.353, Test accuracy: 59.60 

Round   5, Global train loss: 0.634, Global test loss: 2.312, Global test accuracy: 24.16 

Round   6, Train loss: 0.527, Test loss: 1.433, Test accuracy: 59.52 

Round   6, Global train loss: 0.527, Global test loss: 2.325, Global test accuracy: 23.24 

Round   7, Train loss: 0.467, Test loss: 1.577, Test accuracy: 59.20 

Round   7, Global train loss: 0.467, Global test loss: 2.380, Global test accuracy: 21.56 

Round   8, Train loss: 0.381, Test loss: 1.857, Test accuracy: 59.80 

Round   8, Global train loss: 0.381, Global test loss: 2.375, Global test accuracy: 17.68 

Round   9, Train loss: 0.337, Test loss: 1.686, Test accuracy: 59.84 

Round   9, Global train loss: 0.337, Global test loss: 2.323, Global test accuracy: 22.36 

Round  10, Train loss: 0.281, Test loss: 1.765, Test accuracy: 60.24 

Round  10, Global train loss: 0.281, Global test loss: 2.307, Global test accuracy: 18.00 

Round  11, Train loss: 0.237, Test loss: 1.660, Test accuracy: 61.00 

Round  11, Global train loss: 0.237, Global test loss: 2.318, Global test accuracy: 18.04 

Round  12, Train loss: 0.199, Test loss: 1.681, Test accuracy: 62.04 

Round  12, Global train loss: 0.199, Global test loss: 2.322, Global test accuracy: 21.12 

Round  13, Train loss: 0.174, Test loss: 1.586, Test accuracy: 64.28 

Round  13, Global train loss: 0.174, Global test loss: 2.338, Global test accuracy: 14.52 

Round  14, Train loss: 0.158, Test loss: 1.707, Test accuracy: 64.20 

Round  14, Global train loss: 0.158, Global test loss: 2.337, Global test accuracy: 19.00 

Round  15, Train loss: 0.129, Test loss: 1.790, Test accuracy: 63.48 

Round  15, Global train loss: 0.129, Global test loss: 2.324, Global test accuracy: 21.24 

Round  16, Train loss: 0.127, Test loss: 1.754, Test accuracy: 64.20 

Round  16, Global train loss: 0.127, Global test loss: 2.354, Global test accuracy: 20.40 

Round  17, Train loss: 0.082, Test loss: 1.745, Test accuracy: 65.88 

Round  17, Global train loss: 0.082, Global test loss: 2.307, Global test accuracy: 14.96 

Round  18, Train loss: 0.085, Test loss: 1.876, Test accuracy: 63.32 

Round  18, Global train loss: 0.085, Global test loss: 2.295, Global test accuracy: 17.88 

Round  19, Train loss: 0.079, Test loss: 1.910, Test accuracy: 64.80 

Round  19, Global train loss: 0.079, Global test loss: 2.313, Global test accuracy: 21.16 

Round  20, Train loss: 0.068, Test loss: 1.737, Test accuracy: 66.96 

Round  20, Global train loss: 0.068, Global test loss: 2.323, Global test accuracy: 21.96 

Round  21, Train loss: 0.069, Test loss: 1.846, Test accuracy: 64.40 

Round  21, Global train loss: 0.069, Global test loss: 2.304, Global test accuracy: 16.64 

Round  22, Train loss: 0.063, Test loss: 1.811, Test accuracy: 66.32 

Round  22, Global train loss: 0.063, Global test loss: 2.274, Global test accuracy: 20.56 

Round  23, Train loss: 0.040, Test loss: 1.815, Test accuracy: 66.52 

Round  23, Global train loss: 0.040, Global test loss: 2.316, Global test accuracy: 17.84 

Round  24, Train loss: 0.047, Test loss: 2.005, Test accuracy: 64.44 

Round  24, Global train loss: 0.047, Global test loss: 2.286, Global test accuracy: 20.52 

Round  25, Train loss: 0.049, Test loss: 1.841, Test accuracy: 67.00 

Round  25, Global train loss: 0.049, Global test loss: 2.313, Global test accuracy: 18.60 

Round  26, Train loss: 0.039, Test loss: 1.963, Test accuracy: 65.44 

Round  26, Global train loss: 0.039, Global test loss: 2.301, Global test accuracy: 16.44 

Round  27, Train loss: 0.044, Test loss: 2.008, Test accuracy: 65.48 

Round  27, Global train loss: 0.044, Global test loss: 2.293, Global test accuracy: 16.76 

Round  28, Train loss: 0.044, Test loss: 1.943, Test accuracy: 65.04 

Round  28, Global train loss: 0.044, Global test loss: 2.284, Global test accuracy: 22.08 

Round  29, Train loss: 0.054, Test loss: 1.937, Test accuracy: 65.48 

Round  29, Global train loss: 0.054, Global test loss: 2.280, Global test accuracy: 21.12 

Round  30, Train loss: 0.046, Test loss: 1.998, Test accuracy: 65.56 

Round  30, Global train loss: 0.046, Global test loss: 2.282, Global test accuracy: 23.80 

Round  31, Train loss: 0.035, Test loss: 1.989, Test accuracy: 64.52 

Round  31, Global train loss: 0.035, Global test loss: 2.284, Global test accuracy: 21.64 

Round  32, Train loss: 0.034, Test loss: 1.888, Test accuracy: 66.60 

Round  32, Global train loss: 0.034, Global test loss: 2.349, Global test accuracy: 16.08 

Round  33, Train loss: 0.016, Test loss: 1.890, Test accuracy: 67.32 

Round  33, Global train loss: 0.016, Global test loss: 2.317, Global test accuracy: 17.04 

Round  34, Train loss: 0.025, Test loss: 1.946, Test accuracy: 65.76 

Round  34, Global train loss: 0.025, Global test loss: 2.317, Global test accuracy: 18.12 

Final Round, Train loss: 0.028, Test loss: 1.858, Test accuracy: 66.36 

Final Round, Global train loss: 0.028, Global test loss: 2.317, Global test accuracy: 18.12 

Average accuracy final 10 rounds: 65.82 

Average global accuracy final 10 rounds: 19.168 

1282.42564702034
[8.731400728225708, 15.195722579956055, 21.243261575698853, 26.92864990234375, 32.36662030220032, 38.14274334907532, 43.57316780090332, 50.048444747924805, 56.46652054786682, 63.40118956565857, 70.46328783035278, 77.27466607093811, 83.74025630950928, 90.15148186683655, 96.555837392807, 102.98367762565613, 110.16229915618896, 116.57993030548096, 123.02472972869873, 129.4251036643982, 135.81456422805786, 142.26418566703796, 149.52542448043823, 155.92778992652893, 162.63837552070618, 169.1357650756836, 176.14700150489807, 182.6779646873474, 189.07564663887024, 196.16944694519043, 202.5610454082489, 208.9303891658783, 215.73112773895264, 222.4710397720337, 229.23087096214294, 242.61751675605774]
[49.24, 50.16, 54.16, 56.0, 54.0, 59.6, 59.52, 59.2, 59.8, 59.84, 60.24, 61.0, 62.04, 64.28, 64.2, 63.48, 64.2, 65.88, 63.32, 64.8, 66.96, 64.4, 66.32, 66.52, 64.44, 67.0, 65.44, 65.48, 65.04, 65.48, 65.56, 64.52, 66.6, 67.32, 65.76, 66.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.478, Test loss: 1.364, Test accuracy: 48.28 

Round   0, Global train loss: 1.478, Global test loss: 2.291, Global test accuracy: 16.20 

Round   1, Train loss: 1.366, Test loss: 1.246, Test accuracy: 50.68 

Round   1, Global train loss: 1.366, Global test loss: 1.909, Global test accuracy: 36.12 

Round   2, Train loss: 1.204, Test loss: 1.315, Test accuracy: 50.92 

Round   2, Global train loss: 1.204, Global test loss: 1.752, Global test accuracy: 40.28 

Round   3, Train loss: 1.102, Test loss: 1.278, Test accuracy: 53.88 

Round   3, Global train loss: 1.102, Global test loss: 1.734, Global test accuracy: 42.40 

Round   4, Train loss: 1.025, Test loss: 1.135, Test accuracy: 59.16 

Round   4, Global train loss: 1.025, Global test loss: 1.514, Global test accuracy: 46.52 

Round   5, Train loss: 0.923, Test loss: 1.092, Test accuracy: 60.92 

Round   5, Global train loss: 0.923, Global test loss: 1.585, Global test accuracy: 47.64 

Round   6, Train loss: 0.853, Test loss: 1.218, Test accuracy: 59.32 

Round   6, Global train loss: 0.853, Global test loss: 1.465, Global test accuracy: 49.76 

Round   7, Train loss: 0.783, Test loss: 1.159, Test accuracy: 61.28 

Round   7, Global train loss: 0.783, Global test loss: 1.340, Global test accuracy: 54.12 

Round   8, Train loss: 0.717, Test loss: 1.386, Test accuracy: 61.64 

Round   8, Global train loss: 0.717, Global test loss: 1.413, Global test accuracy: 53.00 

Round   9, Train loss: 0.662, Test loss: 1.168, Test accuracy: 62.36 

Round   9, Global train loss: 0.662, Global test loss: 1.330, Global test accuracy: 55.56 

Round  10, Train loss: 0.619, Test loss: 1.110, Test accuracy: 66.28 

Round  10, Global train loss: 0.619, Global test loss: 1.290, Global test accuracy: 57.60 

Round  11, Train loss: 0.574, Test loss: 1.307, Test accuracy: 63.56 

Round  11, Global train loss: 0.574, Global test loss: 1.286, Global test accuracy: 57.04 

Round  12, Train loss: 0.526, Test loss: 1.216, Test accuracy: 65.28 

Round  12, Global train loss: 0.526, Global test loss: 1.310, Global test accuracy: 58.28 

Round  13, Train loss: 0.490, Test loss: 1.223, Test accuracy: 66.80 

Round  13, Global train loss: 0.490, Global test loss: 1.273, Global test accuracy: 58.88 

Round  14, Train loss: 0.461, Test loss: 1.744, Test accuracy: 60.32 

Round  14, Global train loss: 0.461, Global test loss: 1.345, Global test accuracy: 58.92 

Round  15, Train loss: 0.419, Test loss: 1.413, Test accuracy: 65.48 

Round  15, Global train loss: 0.419, Global test loss: 1.266, Global test accuracy: 59.76 

Round  16, Train loss: 0.402, Test loss: 1.031, Test accuracy: 71.56 

Round  16, Global train loss: 0.402, Global test loss: 1.242, Global test accuracy: 61.44 

Round  17, Train loss: 0.376, Test loss: 1.140, Test accuracy: 69.76 

Round  17, Global train loss: 0.376, Global test loss: 1.200, Global test accuracy: 62.52 

Round  18, Train loss: 0.344, Test loss: 1.149, Test accuracy: 69.40 

Round  18, Global train loss: 0.344, Global test loss: 1.270, Global test accuracy: 62.32 

Round  19, Train loss: 0.339, Test loss: 1.206, Test accuracy: 67.36 

Round  19, Global train loss: 0.339, Global test loss: 1.180, Global test accuracy: 63.36 

Round  20, Train loss: 0.309, Test loss: 1.280, Test accuracy: 69.72 

Round  20, Global train loss: 0.309, Global test loss: 1.139, Global test accuracy: 64.36 

Round  21, Train loss: 0.284, Test loss: 1.223, Test accuracy: 69.16 

Round  21, Global train loss: 0.284, Global test loss: 1.279, Global test accuracy: 62.76 

Round  22, Train loss: 0.264, Test loss: 1.231, Test accuracy: 70.36 

Round  22, Global train loss: 0.264, Global test loss: 1.267, Global test accuracy: 61.80 

Round  23, Train loss: 0.245, Test loss: 1.404, Test accuracy: 68.92 

Round  23, Global train loss: 0.245, Global test loss: 1.211, Global test accuracy: 64.00 

Round  24, Train loss: 0.237, Test loss: 1.224, Test accuracy: 69.52 

Round  24, Global train loss: 0.237, Global test loss: 1.270, Global test accuracy: 63.60 

Round  25, Train loss: 0.217, Test loss: 1.177, Test accuracy: 71.64 

Round  25, Global train loss: 0.217, Global test loss: 1.206, Global test accuracy: 64.12 

Round  26, Train loss: 0.194, Test loss: 1.307, Test accuracy: 70.04 

Round  26, Global train loss: 0.194, Global test loss: 1.183, Global test accuracy: 65.16 

Round  27, Train loss: 0.198, Test loss: 1.201, Test accuracy: 72.00 

Round  27, Global train loss: 0.198, Global test loss: 1.245, Global test accuracy: 64.96 

Round  28, Train loss: 0.182, Test loss: 1.179, Test accuracy: 72.44 

Round  28, Global train loss: 0.182, Global test loss: 1.288, Global test accuracy: 63.64 

Round  29, Train loss: 0.162, Test loss: 1.204, Test accuracy: 72.96 

Round  29, Global train loss: 0.162, Global test loss: 1.234, Global test accuracy: 64.12 

Round  30, Train loss: 0.169, Test loss: 1.393, Test accuracy: 69.08 

Round  30, Global train loss: 0.169, Global test loss: 1.256, Global test accuracy: 64.52 

Round  31, Train loss: 0.158, Test loss: 1.311, Test accuracy: 70.72 

Round  31, Global train loss: 0.158, Global test loss: 1.258, Global test accuracy: 65.16 

Round  32, Train loss: 0.144, Test loss: 1.245, Test accuracy: 72.60 

Round  32, Global train loss: 0.144, Global test loss: 1.302, Global test accuracy: 63.84 

Round  33, Train loss: 0.129, Test loss: 1.137, Test accuracy: 74.00 

Round  33, Global train loss: 0.129, Global test loss: 1.203, Global test accuracy: 65.44 

Round  34, Train loss: 0.117, Test loss: 1.341, Test accuracy: 72.40 

Round  34, Global train loss: 0.117, Global test loss: 1.256, Global test accuracy: 65.60 

Round  35, Train loss: 0.108, Test loss: 1.393, Test accuracy: 71.72 

Round  35, Global train loss: 0.108, Global test loss: 1.314, Global test accuracy: 65.56 

Round  36, Train loss: 0.115, Test loss: 1.305, Test accuracy: 73.04 

Round  36, Global train loss: 0.115, Global test loss: 1.302, Global test accuracy: 65.20 

Round  37, Train loss: 0.111, Test loss: 1.632, Test accuracy: 69.56 

Round  37, Global train loss: 0.111, Global test loss: 1.279, Global test accuracy: 65.12 

Round  38, Train loss: 0.098, Test loss: 1.316, Test accuracy: 73.36 

Round  38, Global train loss: 0.098, Global test loss: 1.302, Global test accuracy: 65.68 

Round  39, Train loss: 0.110, Test loss: 1.271, Test accuracy: 72.84 

Round  39, Global train loss: 0.110, Global test loss: 1.299, Global test accuracy: 65.60 

Round  40, Train loss: 0.081, Test loss: 1.429, Test accuracy: 72.76 

Round  40, Global train loss: 0.081, Global test loss: 1.311, Global test accuracy: 64.84 

Round  41, Train loss: 0.097, Test loss: 1.392, Test accuracy: 72.24 

Round  41, Global train loss: 0.097, Global test loss: 1.416, Global test accuracy: 64.80 

Round  42, Train loss: 0.057, Test loss: 1.304, Test accuracy: 74.28 

Round  42, Global train loss: 0.057, Global test loss: 1.349, Global test accuracy: 65.72 

Round  43, Train loss: 0.077, Test loss: 1.486, Test accuracy: 71.48 

Round  43, Global train loss: 0.077, Global test loss: 1.333, Global test accuracy: 66.96 

Round  44, Train loss: 0.090, Test loss: 1.572, Test accuracy: 70.32 

Round  44, Global train loss: 0.090, Global test loss: 1.297, Global test accuracy: 65.84 

Round  45, Train loss: 0.047, Test loss: 1.199, Test accuracy: 75.48 

Round  45, Global train loss: 0.047, Global test loss: 1.346, Global test accuracy: 66.08 

Round  46, Train loss: 0.078, Test loss: 1.331, Test accuracy: 73.76 

Round  46, Global train loss: 0.078, Global test loss: 1.392, Global test accuracy: 64.92 

Round  47, Train loss: 0.066, Test loss: 1.345, Test accuracy: 73.60 

Round  47, Global train loss: 0.066, Global test loss: 1.464, Global test accuracy: 64.60 

Round  48, Train loss: 0.063, Test loss: 1.317, Test accuracy: 74.88 

Round  48, Global train loss: 0.063, Global test loss: 1.248, Global test accuracy: 66.40 

Round  49, Train loss: 0.030, Test loss: 1.158, Test accuracy: 75.68 

Round  49, Global train loss: 0.030, Global test loss: 1.338, Global test accuracy: 65.96 

Final Round, Train loss: 0.066, Test loss: 1.625, Test accuracy: 71.52 

Final Round, Global train loss: 0.066, Global test loss: 1.338, Global test accuracy: 65.96 

Average accuracy final 10 rounds: 73.448 

Average global accuracy final 10 rounds: 65.612 

1695.3903510570526
[8.317355632781982, 15.49483871459961, 21.909587383270264, 28.355016231536865, 34.95175051689148, 41.50926065444946, 48.15660738945007, 54.46133780479431, 60.75912690162659, 67.97397232055664, 74.35943555831909, 80.21786308288574, 86.05500984191895, 91.92395091056824, 97.71835136413574, 103.57063961029053, 109.56099247932434, 115.46467614173889, 121.4543445110321, 127.21334409713745, 132.99328541755676, 138.81864857673645, 144.69078588485718, 150.6120662689209, 156.31883597373962, 162.0251853466034, 167.8092451095581, 173.80726265907288, 179.64120221138, 185.47470784187317, 191.32506108283997, 197.12683010101318, 202.86418390274048, 208.51187086105347, 214.00676274299622, 219.49827456474304, 225.0938971042633, 230.75419569015503, 236.39116311073303, 241.99051976203918, 247.60131072998047, 253.14009952545166, 259.0725269317627, 264.7103452682495, 270.31492805480957, 276.2668204307556, 282.1092941761017, 287.70001125335693, 293.4851257801056, 299.30649971961975, 310.7065460681915]
[48.28, 50.68, 50.92, 53.88, 59.16, 60.92, 59.32, 61.28, 61.64, 62.36, 66.28, 63.56, 65.28, 66.8, 60.32, 65.48, 71.56, 69.76, 69.4, 67.36, 69.72, 69.16, 70.36, 68.92, 69.52, 71.64, 70.04, 72.0, 72.44, 72.96, 69.08, 70.72, 72.6, 74.0, 72.4, 71.72, 73.04, 69.56, 73.36, 72.84, 72.76, 72.24, 74.28, 71.48, 70.32, 75.48, 73.76, 73.6, 74.88, 75.68, 71.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.591, Test loss: 1.847, Test accuracy: 20.84 

Round   1, Train loss: 1.397, Test loss: 1.687, Test accuracy: 34.68 

Round   2, Train loss: 1.290, Test loss: 1.402, Test accuracy: 39.28 

Round   3, Train loss: 1.198, Test loss: 1.301, Test accuracy: 45.60 

Round   4, Train loss: 1.105, Test loss: 1.213, Test accuracy: 48.84 

Round   5, Train loss: 1.035, Test loss: 1.180, Test accuracy: 51.80 

Round   6, Train loss: 0.986, Test loss: 1.109, Test accuracy: 55.64 

Round   7, Train loss: 0.910, Test loss: 0.986, Test accuracy: 59.92 

Round   8, Train loss: 0.853, Test loss: 0.973, Test accuracy: 61.68 

Round   9, Train loss: 0.821, Test loss: 0.960, Test accuracy: 62.44 

Round  10, Train loss: 0.764, Test loss: 0.938, Test accuracy: 63.40 

Round  11, Train loss: 0.720, Test loss: 0.915, Test accuracy: 64.72 

Round  12, Train loss: 0.681, Test loss: 0.864, Test accuracy: 67.48 

Round  13, Train loss: 0.633, Test loss: 0.873, Test accuracy: 68.16 

Round  14, Train loss: 0.598, Test loss: 0.876, Test accuracy: 67.88 

Round  15, Train loss: 0.563, Test loss: 0.893, Test accuracy: 67.16 

Round  16, Train loss: 0.534, Test loss: 0.822, Test accuracy: 69.96 

Round  17, Train loss: 0.510, Test loss: 0.805, Test accuracy: 70.96 

Round  18, Train loss: 0.477, Test loss: 0.828, Test accuracy: 71.20 

Round  19, Train loss: 0.451, Test loss: 0.828, Test accuracy: 70.76 

Round  20, Train loss: 0.434, Test loss: 0.805, Test accuracy: 72.80 

Round  21, Train loss: 0.399, Test loss: 0.839, Test accuracy: 70.88 

Round  22, Train loss: 0.395, Test loss: 0.751, Test accuracy: 74.04 

Round  23, Train loss: 0.365, Test loss: 0.793, Test accuracy: 73.60 

Round  24, Train loss: 0.334, Test loss: 0.819, Test accuracy: 72.28 

Round  25, Train loss: 0.318, Test loss: 0.840, Test accuracy: 72.44 

Round  26, Train loss: 0.304, Test loss: 0.825, Test accuracy: 73.16 

Round  27, Train loss: 0.286, Test loss: 0.796, Test accuracy: 74.12 

Round  28, Train loss: 0.264, Test loss: 0.841, Test accuracy: 73.72 

Round  29, Train loss: 0.256, Test loss: 0.808, Test accuracy: 74.56 

Round  30, Train loss: 0.244, Test loss: 0.788, Test accuracy: 74.44 

Round  31, Train loss: 0.225, Test loss: 0.772, Test accuracy: 75.40 

Round  32, Train loss: 0.213, Test loss: 0.814, Test accuracy: 74.24 

Round  33, Train loss: 0.209, Test loss: 0.766, Test accuracy: 75.76 

Round  34, Train loss: 0.189, Test loss: 0.861, Test accuracy: 74.72 

Round  35, Train loss: 0.180, Test loss: 0.841, Test accuracy: 74.88 

Round  36, Train loss: 0.175, Test loss: 0.810, Test accuracy: 75.52 

Round  37, Train loss: 0.145, Test loss: 0.856, Test accuracy: 75.04 

Round  38, Train loss: 0.158, Test loss: 0.833, Test accuracy: 75.40 

Round  39, Train loss: 0.152, Test loss: 0.808, Test accuracy: 76.44 

Round  40, Train loss: 0.133, Test loss: 0.829, Test accuracy: 75.16 

Round  41, Train loss: 0.122, Test loss: 0.798, Test accuracy: 76.72 

Round  42, Train loss: 0.119, Test loss: 0.840, Test accuracy: 76.24 

Round  43, Train loss: 0.111, Test loss: 0.838, Test accuracy: 76.20 

Round  44, Train loss: 0.098, Test loss: 0.858, Test accuracy: 76.48 

Round  45, Train loss: 0.106, Test loss: 0.841, Test accuracy: 76.32 

Round  46, Train loss: 0.096, Test loss: 0.870, Test accuracy: 75.20 

Round  47, Train loss: 0.086, Test loss: 0.842, Test accuracy: 75.96 

Round  48, Train loss: 0.089, Test loss: 0.872, Test accuracy: 76.24 

Round  49, Train loss: 0.084, Test loss: 0.887, Test accuracy: 76.84 

Final Round, Train loss: 0.048, Test loss: 0.898, Test accuracy: 76.76 

Average accuracy final 10 rounds: 76.136 

1166.3247742652893
[6.347867250442505, 10.765222072601318, 15.054012060165405, 19.263938903808594, 23.4797625541687, 27.823498487472534, 32.13921785354614, 36.4406578540802, 40.829370737075806, 45.233160972595215, 49.618061542510986, 53.88502788543701, 58.096526861190796, 62.45802855491638, 66.83790636062622, 71.0001323223114, 75.38032746315002, 79.86775970458984, 84.19288778305054, 88.47822499275208, 92.82381105422974, 97.21086168289185, 101.57070899009705, 105.86896014213562, 110.2337110042572, 114.50677013397217, 118.83792519569397, 123.18851613998413, 127.5030038356781, 131.852153301239, 136.4894576072693, 140.83674573898315, 145.11549282073975, 149.5098774433136, 153.86433482170105, 158.30112433433533, 162.51766777038574, 166.91723227500916, 171.31839990615845, 175.65115118026733, 180.01275777816772, 184.4295952320099, 188.72353267669678, 193.17709016799927, 197.8157980442047, 202.26402258872986, 206.78324127197266, 211.0882966518402, 215.5502688884735, 219.88246321678162, 225.30650448799133]
[20.84, 34.68, 39.28, 45.6, 48.84, 51.8, 55.64, 59.92, 61.68, 62.44, 63.4, 64.72, 67.48, 68.16, 67.88, 67.16, 69.96, 70.96, 71.2, 70.76, 72.8, 70.88, 74.04, 73.6, 72.28, 72.44, 73.16, 74.12, 73.72, 74.56, 74.44, 75.4, 74.24, 75.76, 74.72, 74.88, 75.52, 75.04, 75.4, 76.44, 75.16, 76.72, 76.24, 76.2, 76.48, 76.32, 75.2, 75.96, 76.24, 76.84, 76.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.595, Test loss: 1.998, Test accuracy: 21.92
Round   1, Train loss: 1.391, Test loss: 1.555, Test accuracy: 35.04
Round   2, Train loss: 1.270, Test loss: 1.323, Test accuracy: 42.72
Round   3, Train loss: 1.169, Test loss: 1.159, Test accuracy: 50.56
Round   4, Train loss: 1.111, Test loss: 1.281, Test accuracy: 48.16
Round   5, Train loss: 1.034, Test loss: 1.178, Test accuracy: 51.04
Round   6, Train loss: 0.973, Test loss: 0.966, Test accuracy: 60.68
Round   7, Train loss: 0.913, Test loss: 1.000, Test accuracy: 59.64
Round   8, Train loss: 0.858, Test loss: 0.995, Test accuracy: 59.76
Round   9, Train loss: 0.805, Test loss: 0.947, Test accuracy: 61.64
Round  10, Train loss: 0.766, Test loss: 0.843, Test accuracy: 66.16
Round  11, Train loss: 0.724, Test loss: 0.913, Test accuracy: 65.60
Round  12, Train loss: 0.683, Test loss: 0.821, Test accuracy: 67.64
Round  13, Train loss: 0.647, Test loss: 0.891, Test accuracy: 67.16
Round  14, Train loss: 0.605, Test loss: 0.804, Test accuracy: 69.44
Round  15, Train loss: 0.580, Test loss: 0.857, Test accuracy: 68.40
Round  16, Train loss: 0.552, Test loss: 0.945, Test accuracy: 66.76
Round  17, Train loss: 0.517, Test loss: 0.799, Test accuracy: 70.92
Round  18, Train loss: 0.482, Test loss: 0.849, Test accuracy: 70.00
Round  19, Train loss: 0.467, Test loss: 0.788, Test accuracy: 71.92
Round  20, Train loss: 0.432, Test loss: 0.749, Test accuracy: 72.80
Round  21, Train loss: 0.407, Test loss: 0.792, Test accuracy: 72.28
Round  22, Train loss: 0.383, Test loss: 0.752, Test accuracy: 73.48
Round  23, Train loss: 0.367, Test loss: 0.804, Test accuracy: 73.04
Round  24, Train loss: 0.338, Test loss: 0.781, Test accuracy: 72.96
Round  25, Train loss: 0.330, Test loss: 0.755, Test accuracy: 74.52
Round  26, Train loss: 0.308, Test loss: 0.808, Test accuracy: 72.88
Round  27, Train loss: 0.287, Test loss: 0.750, Test accuracy: 74.92
Round  28, Train loss: 0.274, Test loss: 0.791, Test accuracy: 74.88
Round  29, Train loss: 0.248, Test loss: 0.742, Test accuracy: 75.20
Round  30, Train loss: 0.242, Test loss: 0.769, Test accuracy: 75.28
Round  31, Train loss: 0.225, Test loss: 0.780, Test accuracy: 74.84
Round  32, Train loss: 0.226, Test loss: 0.770, Test accuracy: 75.32
Round  33, Train loss: 0.203, Test loss: 0.759, Test accuracy: 76.32
Round  34, Train loss: 0.191, Test loss: 0.761, Test accuracy: 75.72
Round  35, Train loss: 0.186, Test loss: 0.740, Test accuracy: 76.64
Round  36, Train loss: 0.153, Test loss: 0.762, Test accuracy: 76.24
Round  37, Train loss: 0.150, Test loss: 0.791, Test accuracy: 76.24
Round  38, Train loss: 0.140, Test loss: 0.773, Test accuracy: 77.20
Round  39, Train loss: 0.155, Test loss: 0.795, Test accuracy: 76.64
Round  40, Train loss: 0.138, Test loss: 0.804, Test accuracy: 76.12
Round  41, Train loss: 0.117, Test loss: 0.777, Test accuracy: 76.56
Round  42, Train loss: 0.119, Test loss: 0.822, Test accuracy: 75.96
Round  43, Train loss: 0.112, Test loss: 0.770, Test accuracy: 77.04
Round  44, Train loss: 0.104, Test loss: 0.808, Test accuracy: 76.88
Round  45, Train loss: 0.093, Test loss: 0.821, Test accuracy: 76.88
Round  46, Train loss: 0.091, Test loss: 0.837, Test accuracy: 76.04
Round  47, Train loss: 0.086, Test loss: 0.822, Test accuracy: 76.44
Round  48, Train loss: 0.095, Test loss: 0.803, Test accuracy: 76.68
Round  49, Train loss: 0.086, Test loss: 0.815, Test accuracy: 76.92
Final Round, Train loss: 0.047, Test loss: 0.847, Test accuracy: 76.52
Average accuracy final 10 rounds: 76.55199999999999
1318.6710028648376
[6.915538787841797, 11.737204551696777, 16.639991998672485, 21.64552927017212, 26.52373695373535, 31.63977026939392, 36.51302671432495, 41.359023571014404, 46.46246004104614, 51.5956757068634, 56.562753200531006, 61.511908531188965, 66.58880376815796, 71.45497155189514, 76.41116786003113, 81.21426606178284, 86.12322926521301, 90.95377993583679, 95.90961337089539, 100.84480881690979, 105.8914966583252, 110.7899923324585, 115.77880787849426, 120.75855231285095, 125.77639818191528, 130.8704764842987, 136.0139570236206, 140.83926939964294, 145.78371286392212, 150.57441234588623, 155.38553929328918, 160.18279910087585, 165.1407823562622, 169.90790939331055, 174.98749709129333, 180.00393104553223, 185.12110877037048, 190.2327754497528, 195.1959776878357, 200.17844104766846, 205.03999018669128, 210.09201002120972, 214.95853757858276, 219.81840634346008, 224.73801016807556, 229.63100671768188, 234.69018530845642, 239.51168847084045, 244.47450470924377, 249.36782264709473, 254.39834785461426]
[21.92, 35.04, 42.72, 50.56, 48.16, 51.04, 60.68, 59.64, 59.76, 61.64, 66.16, 65.6, 67.64, 67.16, 69.44, 68.4, 66.76, 70.92, 70.0, 71.92, 72.8, 72.28, 73.48, 73.04, 72.96, 74.52, 72.88, 74.92, 74.88, 75.2, 75.28, 74.84, 75.32, 76.32, 75.72, 76.64, 76.24, 76.24, 77.2, 76.64, 76.12, 76.56, 75.96, 77.04, 76.88, 76.88, 76.04, 76.44, 76.68, 76.92, 76.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.374, Train accuracy: 87.400, Test loss: 1.333, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.209, Train accuracy: 93.200, Test loss: 1.213, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.304, Train accuracy: 87.600, Test loss: 1.494, Test accuracy: 63.00 

Round   0, Train loss: 0.304, Test loss: 1.494, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.163, Train accuracy: 95.000, Test loss: 1.312, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.237, Train accuracy: 92.200, Test loss: 1.422, Test accuracy: 63.00 

Round   1, Train loss: 0.237, Test loss: 1.422, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.168, Train accuracy: 95.000, Test loss: 1.329, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.171, Train accuracy: 94.000, Test loss: 1.721, Test accuracy: 62.00 

Round   2, Train loss: 0.171, Test loss: 1.721, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.081, Train accuracy: 97.800, Test loss: 1.603, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.317, Train accuracy: 89.200, Test loss: 2.049, Test accuracy: 62.80 

Round   3, Train loss: 0.317, Test loss: 2.049, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.128, Train accuracy: 95.800, Test loss: 1.543, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.101, Train accuracy: 96.200, Test loss: 1.562, Test accuracy: 65.40 

Round   4, Train loss: 0.101, Test loss: 1.562, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.077, Train accuracy: 97.200, Test loss: 1.639, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.089, Train accuracy: 96.800, Test loss: 1.742, Test accuracy: 65.20 

Round   5, Train loss: 0.089, Test loss: 1.742, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.060, Train accuracy: 97.800, Test loss: 1.729, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.085, Train accuracy: 97.000, Test loss: 1.773, Test accuracy: 62.40 

Round   6, Train loss: 0.085, Test loss: 1.773, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.800, Test loss: 1.727, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.913, Test accuracy: 65.60 

Round   7, Train loss: 0.023, Test loss: 1.913, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.751, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.800, Test loss: 1.733, Test accuracy: 61.20 

Round   8, Train loss: 0.042, Test loss: 1.733, Test accuracy: 61.20 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.200, Test loss: 1.816, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.944, Test accuracy: 66.60 

Round   9, Train loss: 0.019, Test loss: 1.944, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 2.041, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.132, Train accuracy: 95.000, Test loss: 2.564, Test accuracy: 63.40 

Round  10, Train loss: 0.132, Test loss: 2.564, Test accuracy: 63.40 

        train local model (freeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 1.873, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 2.017, Test accuracy: 65.40 

Round  11, Train loss: 0.012, Test loss: 2.017, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.855, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.255, Train accuracy: 90.800, Test loss: 2.497, Test accuracy: 62.00 

Round  12, Train loss: 0.255, Test loss: 2.497, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 1.939, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 2.226, Test accuracy: 63.20 

Round  13, Train loss: 0.013, Test loss: 2.226, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.155, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 2.195, Test accuracy: 63.80 

Round  14, Train loss: 0.014, Test loss: 2.195, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.400, Test loss: 2.154, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.058, Train accuracy: 98.400, Test loss: 2.040, Test accuracy: 63.20 

Round  15, Train loss: 0.058, Test loss: 2.040, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 98.600, Test loss: 1.936, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 98.800, Test loss: 1.982, Test accuracy: 65.60 

Round  16, Train loss: 0.031, Test loss: 1.982, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.034, Train accuracy: 98.600, Test loss: 1.899, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.091, Test accuracy: 65.40 

Round  17, Train loss: 0.010, Test loss: 2.091, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.018, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.851, Test accuracy: 64.20 

Round  18, Train loss: 0.016, Test loss: 1.851, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.832, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.992, Test accuracy: 68.20 

Round  19, Train loss: 0.002, Test loss: 1.992, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.035, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.994, Test accuracy: 69.00 

Final Round, Train loss: 0.001, Test loss: 1.967, Test accuracy: 68.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.143, Train accuracy: 95.400, Test loss: 1.367, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.989, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.200, Test loss: 2.284, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 1.234, Train accuracy: 50.400, Test loss: 1.322, Test accuracy: 50.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.533, Train accuracy: 79.400, Test loss: 0.977, Test accuracy: 64.40 

Round   0, Train loss: 0.274, Test loss: 1.508, Test accuracy: 62.10 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.801, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.969, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.599, Train accuracy: 77.800, Test loss: 1.038, Test accuracy: 60.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.408, Train accuracy: 86.600, Test loss: 1.295, Test accuracy: 65.60 

Round   1, Train loss: 0.209, Test loss: 1.403, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.668, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.945, Test accuracy: 66.20 

        train local model (freeze embeding):client   1,  Train loss: 0.355, Train accuracy: 88.000, Test loss: 1.037, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.323, Train accuracy: 87.000, Test loss: 1.523, Test accuracy: 62.20 

Round   2, Train loss: 0.163, Test loss: 1.470, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.742, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 2.100, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.202, Train accuracy: 94.200, Test loss: 1.083, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.274, Train accuracy: 89.600, Test loss: 1.202, Test accuracy: 65.40 

Round   3, Train loss: 0.142, Test loss: 1.452, Test accuracy: 64.90 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.667, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.790, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.179, Train accuracy: 95.200, Test loss: 1.148, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.345, Train accuracy: 87.600, Test loss: 1.830, Test accuracy: 59.60 

Round   4, Train loss: 0.187, Test loss: 1.451, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.200, Test loss: 1.820, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.114, Train accuracy: 96.000, Test loss: 1.164, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.259, Train accuracy: 90.200, Test loss: 1.657, Test accuracy: 65.00 

Round   5, Train loss: 0.138, Test loss: 1.447, Test accuracy: 68.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.614, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.867, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.080, Train accuracy: 97.800, Test loss: 1.134, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.192, Train accuracy: 93.600, Test loss: 1.415, Test accuracy: 67.60 

Round   6, Train loss: 0.101, Test loss: 1.591, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.773, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.913, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.047, Train accuracy: 99.600, Test loss: 1.157, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.114, Train accuracy: 96.000, Test loss: 1.326, Test accuracy: 69.00 

Round   7, Train loss: 0.058, Test loss: 1.510, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.712, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.160, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.040, Train accuracy: 98.800, Test loss: 1.256, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.103, Train accuracy: 96.200, Test loss: 1.500, Test accuracy: 65.40 

Round   8, Train loss: 0.054, Test loss: 1.588, Test accuracy: 67.30 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.656, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 2.028, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.261, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.173, Train accuracy: 94.800, Test loss: 1.606, Test accuracy: 63.20 

Round   9, Train loss: 0.092, Test loss: 1.722, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.766, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.017, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.035, Train accuracy: 99.400, Test loss: 1.259, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 1.603, Test accuracy: 68.20 

Round  10, Train loss: 0.033, Test loss: 1.696, Test accuracy: 66.70 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.816, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.030, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.322, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.090, Train accuracy: 97.600, Test loss: 1.476, Test accuracy: 71.00 

Round  11, Train loss: 0.045, Test loss: 1.611, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.761, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 2.177, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.349, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 1.493, Test accuracy: 69.00 

Round  12, Train loss: 0.025, Test loss: 1.632, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.812, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.255, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.377, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.400, Test loss: 1.675, Test accuracy: 69.20 

Round  13, Train loss: 0.025, Test loss: 1.727, Test accuracy: 69.10 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.862, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.039, Train accuracy: 99.200, Test loss: 2.104, Test accuracy: 62.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.488, Test accuracy: 73.40 

Round  14, Train loss: 0.030, Test loss: 1.699, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.818, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.932, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.365, Test accuracy: 72.60 

Round  15, Train loss: 0.023, Test loss: 1.577, Test accuracy: 69.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.753, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.600, Test loss: 2.188, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.369, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.581, Test accuracy: 71.00 

Round  16, Train loss: 0.026, Test loss: 1.639, Test accuracy: 69.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.767, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 2.158, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.400, Test loss: 1.654, Test accuracy: 70.00 

Round  17, Train loss: 0.035, Test loss: 1.668, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.746, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.061, Train accuracy: 98.800, Test loss: 2.329, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.626, Test accuracy: 71.20 

Round  18, Train loss: 0.040, Test loss: 1.731, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.913, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.014, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.400, Test loss: 1.311, Test accuracy: 73.40 

Round  19, Train loss: 0.024, Test loss: 1.651, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.600, Test loss: 1.756, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.741, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.260, Test accuracy: 74.60 

Final Round, Train loss: 0.002, Test loss: 1.533, Test accuracy: 71.70 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.161, Train accuracy: 93.600, Test loss: 1.739, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.753, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.768, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.652, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.759, Train accuracy: 68.600, Test loss: 0.927, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.328, Train accuracy: 86.000, Test loss: 0.814, Test accuracy: 69.60 

Round   0, Train loss: 0.115, Test loss: 1.245, Test accuracy: 70.53 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.671, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.216, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.600, Test loss: 1.681, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.564, Train accuracy: 77.200, Test loss: 0.920, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.356, Train accuracy: 84.400, Test loss: 1.315, Test accuracy: 60.80 

Round   1, Train loss: 0.131, Test loss: 1.394, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.774, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.911, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.216, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.629, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.341, Train accuracy: 86.200, Test loss: 0.897, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.529, Train accuracy: 81.000, Test loss: 1.304, Test accuracy: 58.60 

Round   2, Train loss: 0.186, Test loss: 1.364, Test accuracy: 69.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.691, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.067, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.600, Test loss: 1.715, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.274, Train accuracy: 88.600, Test loss: 0.902, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.214, Train accuracy: 93.200, Test loss: 1.076, Test accuracy: 67.00 

Round   3, Train loss: 0.086, Test loss: 1.313, Test accuracy: 70.27 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.707, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.972, Test accuracy: 67.40 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.532, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.199, Train accuracy: 92.400, Test loss: 0.906, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.262, Train accuracy: 89.800, Test loss: 1.381, Test accuracy: 65.00 

Round   4, Train loss: 0.094, Test loss: 1.311, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.584, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.122, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.349, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.303, Train accuracy: 91.400, Test loss: 2.364, Test accuracy: 66.20 

        train local model (freeze embeding):client   2,  Train loss: 0.140, Train accuracy: 95.800, Test loss: 0.855, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.143, Train accuracy: 94.400, Test loss: 1.279, Test accuracy: 64.20 

Round   5, Train loss: 0.151, Test loss: 1.501, Test accuracy: 69.07 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.709, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.902, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.340, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.082, Train accuracy: 97.800, Test loss: 0.957, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.183, Train accuracy: 93.400, Test loss: 1.425, Test accuracy: 63.60 

Round   6, Train loss: 0.064, Test loss: 1.340, Test accuracy: 70.53 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.692, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.026, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 97.800, Test loss: 1.687, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.073, Train accuracy: 98.400, Test loss: 0.997, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.169, Train accuracy: 93.200, Test loss: 1.638, Test accuracy: 64.00 

Round   7, Train loss: 0.082, Test loss: 1.429, Test accuracy: 70.47 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.714, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.743, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.600, Test loss: 1.453, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.056, Train accuracy: 98.600, Test loss: 0.969, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.236, Train accuracy: 90.800, Test loss: 1.491, Test accuracy: 65.40 

Round   8, Train loss: 0.091, Test loss: 1.334, Test accuracy: 71.13 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.538, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.933, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.600, Test loss: 1.349, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.609, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.200, Test loss: 1.034, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.271, Train accuracy: 88.400, Test loss: 2.026, Test accuracy: 65.40 

Round   9, Train loss: 0.098, Test loss: 1.401, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.564, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.095, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.458, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.400, Test loss: 1.042, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.084, Train accuracy: 97.400, Test loss: 1.291, Test accuracy: 66.80 

Round  10, Train loss: 0.033, Test loss: 1.334, Test accuracy: 71.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.643, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 2.040, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.131, Train accuracy: 96.800, Test loss: 1.806, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.800, Test loss: 1.056, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 97.600, Test loss: 1.433, Test accuracy: 66.40 

Round  11, Train loss: 0.068, Test loss: 1.380, Test accuracy: 71.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.741, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.838, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.332, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.600, Test loss: 1.607, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.024, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.411, Train accuracy: 88.600, Test loss: 1.986, Test accuracy: 63.20 

Round  12, Train loss: 0.149, Test loss: 1.404, Test accuracy: 71.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.653, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.084, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.469, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.058, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.070, Train accuracy: 97.600, Test loss: 1.491, Test accuracy: 64.20 

Round  13, Train loss: 0.028, Test loss: 1.448, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.665, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.956, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 75.60 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.232, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.280, Train accuracy: 93.600, Test loss: 1.834, Test accuracy: 66.00 

Round  14, Train loss: 0.096, Test loss: 1.470, Test accuracy: 70.87 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.717, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.856, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.633, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.174, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.381, Test accuracy: 66.60 

Round  15, Train loss: 0.019, Test loss: 1.356, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.639, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.049, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.241, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.488, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.281, Test accuracy: 70.20 

Round  16, Train loss: 0.007, Test loss: 1.408, Test accuracy: 72.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.704, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 99.200, Test loss: 2.173, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.280, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.602, Test accuracy: 74.40 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.137, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.047, Train accuracy: 98.200, Test loss: 1.738, Test accuracy: 66.00 

Round  17, Train loss: 0.039, Test loss: 1.511, Test accuracy: 70.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.667, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.933, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.355, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.355, Test accuracy: 69.20 

Round  18, Train loss: 0.008, Test loss: 1.376, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.718, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.110, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.312, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.539, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.317, Test accuracy: 69.40 

Round  19, Train loss: 0.006, Test loss: 1.454, Test accuracy: 71.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.675, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.756, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.345, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.186, Test accuracy: 71.00 

Final Round, Train loss: 0.002, Test loss: 1.442, Test accuracy: 72.13 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.084, Train accuracy: 98.200, Test loss: 1.781, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.727, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.928, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.189, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.529, Test accuracy: 67.00 

        train local model (freeze embeding):client   3,  Train loss: 0.948, Train accuracy: 66.200, Test loss: 1.036, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.470, Train accuracy: 82.800, Test loss: 1.213, Test accuracy: 63.60 

Round   0, Train loss: 0.122, Test loss: 1.255, Test accuracy: 71.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.639, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.805, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.217, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.400, Test loss: 1.402, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.137, Train accuracy: 95.600, Test loss: 1.953, Test accuracy: 62.00 

        train local model (freeze embeding):client   3,  Train loss: 0.660, Train accuracy: 74.600, Test loss: 1.007, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.309, Train accuracy: 90.000, Test loss: 1.169, Test accuracy: 66.20 

Round   1, Train loss: 0.114, Test loss: 1.249, Test accuracy: 71.15 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.985, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.212, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.295, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.264, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.506, Train accuracy: 81.200, Test loss: 1.078, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.316, Train accuracy: 88.800, Test loss: 1.275, Test accuracy: 63.60 

Round   2, Train loss: 0.090, Test loss: 1.188, Test accuracy: 71.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.589, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.841, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.097, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.217, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.501, Test accuracy: 70.60 

        train local model (freeze embeding):client   3,  Train loss: 0.331, Train accuracy: 87.600, Test loss: 1.009, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.228, Train accuracy: 92.000, Test loss: 1.157, Test accuracy: 65.00 

Round   3, Train loss: 0.065, Test loss: 1.171, Test accuracy: 72.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.483, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.744, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.354, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.037, Train accuracy: 98.000, Test loss: 1.629, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.245, Train accuracy: 91.400, Test loss: 0.966, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.232, Train accuracy: 92.400, Test loss: 1.509, Test accuracy: 63.60 

Round   4, Train loss: 0.069, Test loss: 1.260, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.881, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.119, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.086, Train accuracy: 96.800, Test loss: 1.856, Test accuracy: 71.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.257, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.391, Test accuracy: 69.20 

        train local model (freeze embeding):client   3,  Train loss: 0.174, Train accuracy: 94.600, Test loss: 1.056, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.124, Train accuracy: 96.000, Test loss: 1.454, Test accuracy: 66.40 

Round   5, Train loss: 0.059, Test loss: 1.218, Test accuracy: 72.55 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.583, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.140, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.390, Test accuracy: 73.60 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.512, Test accuracy: 67.80 

        train local model (freeze embeding):client   3,  Train loss: 0.208, Train accuracy: 93.400, Test loss: 1.187, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.227, Train accuracy: 92.200, Test loss: 1.564, Test accuracy: 61.80 

Round   6, Train loss: 0.075, Test loss: 1.232, Test accuracy: 71.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.847, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.163, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.224, Test accuracy: 75.60 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.042, Train accuracy: 98.200, Test loss: 1.457, Test accuracy: 68.40 

        train local model (freeze embeding):client   3,  Train loss: 0.120, Train accuracy: 97.200, Test loss: 1.097, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.342, Train accuracy: 87.000, Test loss: 1.835, Test accuracy: 60.80 

Round   7, Train loss: 0.099, Test loss: 1.241, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.498, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.720, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.186, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.123, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.469, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.078, Train accuracy: 98.400, Test loss: 1.179, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.154, Train accuracy: 95.000, Test loss: 1.556, Test accuracy: 63.00 

Round   8, Train loss: 0.043, Test loss: 1.171, Test accuracy: 72.55 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.439, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.012, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.200, Train accuracy: 92.800, Test loss: 1.971, Test accuracy: 62.60 

        train local model (freeze embeding):client   3,  Train loss: 0.057, Train accuracy: 98.800, Test loss: 1.211, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.144, Train accuracy: 94.800, Test loss: 1.655, Test accuracy: 62.00 

Round   9, Train loss: 0.087, Test loss: 1.210, Test accuracy: 73.35 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.515, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.870, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.478, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.056, Train accuracy: 98.000, Test loss: 1.558, Test accuracy: 66.80 

        train local model (freeze embeding):client   3,  Train loss: 0.057, Train accuracy: 99.000, Test loss: 1.191, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.072, Train accuracy: 96.800, Test loss: 1.673, Test accuracy: 66.60 

Round  10, Train loss: 0.035, Test loss: 1.282, Test accuracy: 72.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.911, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.086, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.550, Test accuracy: 72.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.497, Test accuracy: 68.00 

        train local model (freeze embeding):client   3,  Train loss: 0.036, Train accuracy: 99.400, Test loss: 1.282, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.056, Train accuracy: 98.200, Test loss: 1.568, Test accuracy: 68.60 

Round  11, Train loss: 0.041, Test loss: 1.229, Test accuracy: 72.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.738, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.177, Train accuracy: 93.600, Test loss: 1.653, Test accuracy: 69.40 

        train local model (freeze embeding):client   3,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.316, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.090, Train accuracy: 97.400, Test loss: 1.605, Test accuracy: 67.00 

Round  12, Train loss: 0.068, Test loss: 1.240, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.600, Test loss: 1.880, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.250, Test accuracy: 77.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.438, Test accuracy: 67.80 

        train local model (freeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.600, Test loss: 1.321, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.147, Train accuracy: 95.400, Test loss: 1.765, Test accuracy: 65.40 

Round  13, Train loss: 0.052, Test loss: 1.237, Test accuracy: 73.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.489, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.793, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.063, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.147, Test accuracy: 71.60 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.137, Train accuracy: 95.600, Test loss: 1.915, Test accuracy: 64.80 

Round  14, Train loss: 0.038, Test loss: 1.245, Test accuracy: 73.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.846, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.118, Train accuracy: 95.400, Test loss: 1.613, Test accuracy: 74.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.463, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.387, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.305, Train accuracy: 90.000, Test loss: 2.195, Test accuracy: 59.00 

Round  15, Train loss: 0.111, Test loss: 1.297, Test accuracy: 72.05 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.737, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.249, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.523, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.426, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.113, Train accuracy: 95.600, Test loss: 1.923, Test accuracy: 64.00 

Round  16, Train loss: 0.029, Test loss: 1.304, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.818, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.224, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.296, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.109, Train accuracy: 95.800, Test loss: 1.779, Test accuracy: 65.40 

Round  17, Train loss: 0.033, Test loss: 1.286, Test accuracy: 73.05 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.930, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.237, Train accuracy: 92.200, Test loss: 2.649, Test accuracy: 62.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.415, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.111, Train accuracy: 95.200, Test loss: 1.930, Test accuracy: 63.40 

Round  18, Train loss: 0.089, Test loss: 1.337, Test accuracy: 72.05 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.521, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.742, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.000, Test loss: 1.524, Test accuracy: 71.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.059, Train accuracy: 97.600, Test loss: 1.650, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.427, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.087, Train accuracy: 97.000, Test loss: 1.860, Test accuracy: 64.80 

Round  19, Train loss: 0.048, Test loss: 1.231, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.445, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.404, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.122, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 71.80 

Final Round, Train loss: 0.004, Test loss: 1.219, Test accuracy: 73.40 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.015, Test accuracy: 74.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.937, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.438, Test accuracy: 74.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.338, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.367, Train accuracy: 91.000, Test loss: 2.424, Test accuracy: 61.20 

        train local model (freeze embeding):client   4,  Train loss: 0.876, Train accuracy: 71.000, Test loss: 0.963, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.193, Train accuracy: 94.200, Test loss: 0.787, Test accuracy: 74.80 

Round   0, Train loss: 0.127, Test loss: 1.136, Test accuracy: 74.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.465, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.821, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 75.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 98.200, Test loss: 1.595, Test accuracy: 66.80 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.383, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 1.701, Test accuracy: 67.80 

        train local model (freeze embeding):client   4,  Train loss: 0.554, Train accuracy: 79.200, Test loss: 0.829, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.211, Train accuracy: 92.800, Test loss: 1.108, Test accuracy: 70.00 

Round   1, Train loss: 0.062, Test loss: 1.125, Test accuracy: 75.08 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.460, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.655, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.125, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.490, Test accuracy: 68.60 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.399, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.098, Train accuracy: 96.800, Test loss: 2.249, Test accuracy: 65.80 

        train local model (freeze embeding):client   4,  Train loss: 0.389, Train accuracy: 85.600, Test loss: 0.767, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.173, Train accuracy: 94.800, Test loss: 0.836, Test accuracy: 74.40 

Round   2, Train loss: 0.060, Test loss: 1.109, Test accuracy: 75.24 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.472, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.748, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.349, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.449, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.067, Train accuracy: 98.600, Test loss: 1.766, Test accuracy: 67.20 

        train local model (freeze embeding):client   4,  Train loss: 0.271, Train accuracy: 92.800, Test loss: 0.691, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.127, Train accuracy: 96.200, Test loss: 0.925, Test accuracy: 72.80 

Round   3, Train loss: 0.042, Test loss: 1.107, Test accuracy: 75.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.569, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.432, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.241, Train accuracy: 92.600, Test loss: 2.254, Test accuracy: 57.60 

        train local model (freeze embeding):client   4,  Train loss: 0.215, Train accuracy: 93.000, Test loss: 0.712, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.106, Train accuracy: 97.200, Test loss: 0.959, Test accuracy: 73.20 

Round   4, Train loss: 0.073, Test loss: 1.105, Test accuracy: 75.28 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.037, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.353, Test accuracy: 74.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.320, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.452, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.155, Train accuracy: 95.000, Test loss: 2.258, Test accuracy: 63.00 

        train local model (freeze embeding):client   4,  Train loss: 0.160, Train accuracy: 95.600, Test loss: 0.751, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.165, Train accuracy: 93.800, Test loss: 1.050, Test accuracy: 71.40 

Round   5, Train loss: 0.072, Test loss: 1.092, Test accuracy: 75.52 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.433, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.720, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.337, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 70.60 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.429, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.744, Test accuracy: 67.20 

        train local model (freeze embeding):client   4,  Train loss: 0.141, Train accuracy: 95.400, Test loss: 0.731, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.194, Train accuracy: 94.400, Test loss: 1.254, Test accuracy: 71.00 

Round   6, Train loss: 0.057, Test loss: 1.095, Test accuracy: 75.24 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.446, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.871, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.337, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.419, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.665, Test accuracy: 68.60 

        train local model (freeze embeding):client   4,  Train loss: 0.100, Train accuracy: 97.400, Test loss: 0.733, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.177, Train accuracy: 93.200, Test loss: 1.250, Test accuracy: 67.60 

Round   7, Train loss: 0.042, Test loss: 1.128, Test accuracy: 74.84 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.453, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.689, Test accuracy: 72.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.271, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.470, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.075, Train accuracy: 98.000, Test loss: 1.983, Test accuracy: 66.60 

        train local model (freeze embeding):client   4,  Train loss: 0.066, Train accuracy: 99.000, Test loss: 0.715, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.122, Train accuracy: 96.200, Test loss: 1.016, Test accuracy: 72.80 

Round   8, Train loss: 0.043, Test loss: 1.149, Test accuracy: 74.76 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.499, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.964, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.202, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.504, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.101, Train accuracy: 96.400, Test loss: 2.228, Test accuracy: 62.20 

        train local model (freeze embeding):client   4,  Train loss: 0.059, Train accuracy: 98.600, Test loss: 0.749, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.166, Train accuracy: 93.800, Test loss: 1.278, Test accuracy: 67.80 

Round   9, Train loss: 0.061, Test loss: 1.112, Test accuracy: 74.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 98.800, Test loss: 2.021, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.029, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.423, Test accuracy: 69.40 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.570, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.672, Test accuracy: 69.00 

        train local model (freeze embeding):client   4,  Train loss: 0.050, Train accuracy: 99.400, Test loss: 0.807, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.081, Train accuracy: 97.400, Test loss: 1.162, Test accuracy: 74.20 

Round  10, Train loss: 0.024, Test loss: 1.175, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.466, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.787, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.003, Test accuracy: 78.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.092, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.125, Train accuracy: 94.400, Test loss: 1.705, Test accuracy: 66.40 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.519, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.044, Train accuracy: 98.600, Test loss: 1.989, Test accuracy: 66.20 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 100.000, Test loss: 0.780, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.044, Train accuracy: 99.200, Test loss: 1.150, Test accuracy: 73.80 

Round  11, Train loss: 0.044, Test loss: 1.142, Test accuracy: 75.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.452, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.509, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.489, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.546, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.614, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.099, Train accuracy: 96.600, Test loss: 2.293, Test accuracy: 62.00 

        train local model (freeze embeding):client   4,  Train loss: 0.025, Train accuracy: 100.000, Test loss: 0.786, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.053, Train accuracy: 98.600, Test loss: 1.060, Test accuracy: 77.60 

Round  12, Train loss: 0.042, Test loss: 1.155, Test accuracy: 75.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.434, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.849, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 1.286, Test accuracy: 75.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.345, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.898, Test accuracy: 66.20 

        train local model (freeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 0.800, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.073, Train accuracy: 98.200, Test loss: 1.138, Test accuracy: 73.00 

Round  13, Train loss: 0.033, Test loss: 1.196, Test accuracy: 75.28 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.741, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.555, Test accuracy: 66.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.032, Train accuracy: 98.800, Test loss: 2.074, Test accuracy: 62.80 

        train local model (freeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.800, Test loss: 0.837, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.097, Train accuracy: 96.600, Test loss: 1.292, Test accuracy: 72.60 

Round  14, Train loss: 0.031, Test loss: 1.162, Test accuracy: 74.76 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.456, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.697, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.415, Test accuracy: 74.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.278, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.539, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.400, Test loss: 1.809, Test accuracy: 66.40 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 0.827, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.289, Train accuracy: 90.200, Test loss: 1.851, Test accuracy: 66.00 

Round  15, Train loss: 0.079, Test loss: 1.187, Test accuracy: 74.16 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.421, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.000, Test loss: 2.356, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.965, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 97.600, Test loss: 1.652, Test accuracy: 66.80 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.491, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.078, Train accuracy: 96.800, Test loss: 1.962, Test accuracy: 64.60 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.830, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.173, Train accuracy: 95.000, Test loss: 1.457, Test accuracy: 71.20 

Round  16, Train loss: 0.067, Test loss: 1.197, Test accuracy: 74.24 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.496, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.561, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.085, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.049, Train accuracy: 98.800, Test loss: 1.697, Test accuracy: 65.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.596, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.400, Test loss: 1.913, Test accuracy: 66.20 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.109, Train accuracy: 96.800, Test loss: 1.525, Test accuracy: 70.60 

Round  17, Train loss: 0.037, Test loss: 1.201, Test accuracy: 74.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.452, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.769, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.175, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.641, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.788, Test accuracy: 68.60 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.885, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.209, Test accuracy: 72.40 

Round  18, Train loss: 0.010, Test loss: 1.181, Test accuracy: 75.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.443, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.048, Train accuracy: 98.400, Test loss: 2.009, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 1.342, Test accuracy: 74.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.449, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.594, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.846, Test accuracy: 70.20 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.850, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.091, Train accuracy: 96.800, Test loss: 1.502, Test accuracy: 71.80 

Round  19, Train loss: 0.035, Test loss: 1.223, Test accuracy: 75.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.476, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.618, Test accuracy: 69.40 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 79.00 

Final Round, Train loss: 0.002, Test loss: 1.202, Test accuracy: 75.36 

Average accuracy final 10 rounds: 351.871 

3117.0354516506195
[9.0529305934906, 17.944392919540405, 26.723402500152588, 35.654685735702515, 44.890376567840576, 54.09618330001831, 63.35824418067932, 72.17771506309509, 81.62212610244751, 90.7006287574768, 99.67054271697998, 108.71113228797913, 117.61372327804565, 126.55653071403503, 135.6090545654297, 144.83860230445862, 153.74005270004272, 162.90358638763428, 172.20399951934814, 181.623633146286, 187.2334954738617, 196.5015676021576, 205.62592267990112, 215.05094575881958, 224.36051297187805, 233.43171453475952, 242.62720942497253, 252.58997869491577, 262.1602976322174, 271.1501545906067, 280.7806761264801, 290.5715386867523, 299.6214282512665, 309.1070852279663, 318.52685022354126, 328.40842747688293, 337.31700825691223, 346.7955515384674, 356.0611264705658, 365.4041802883148, 374.7653954029083, 380.60821771621704, 390.1020348072052, 399.0444815158844, 408.1436548233032, 417.52374601364136, 426.7924439907074, 436.0299835205078, 445.5363202095032, 454.93894958496094, 464.32535099983215, 474.1501054763794, 483.73994278907776, 493.30339550971985, 503.1327199935913, 512.283536195755, 521.5198299884796, 531.2413213253021, 540.9879534244537, 550.0415260791779, 559.0555772781372, 568.1728236675262, 573.7276937961578, 583.1752760410309, 592.7638175487518, 602.9543149471283, 612.5790922641754, 622.1127321720123, 631.3856666088104, 640.849413394928, 650.0838108062744, 659.4757976531982, 669.0992569923401, 678.5242660045624, 687.9053604602814, 697.4863913059235, 706.6684420108795, 716.1951575279236, 725.8009347915649, 735.709445476532, 745.4362621307373, 754.9356048107147, 764.3382811546326, 770.0519680976868, 779.4154517650604, 789.1014921665192, 798.2514050006866, 808.1388576030731, 817.7523865699768, 827.236406326294, 836.4104163646698, 845.9709317684174, 856.0367035865784, 865.6045711040497, 875.0725317001343, 884.4951493740082, 894.309511423111, 903.6673605442047, 912.9968621730804, 922.3022041320801, 931.9989845752716, 941.1180713176727, 950.047369480133, 959.2518045902252, 964.8130795955658]
[63.0, 63.0, 62.0, 62.8, 65.4, 65.2, 62.4, 65.6, 61.2, 66.6, 63.4, 65.4, 62.0, 63.2, 63.8, 63.2, 65.6, 65.4, 64.2, 68.2, 68.6, 62.1, 62.8, 64.4, 64.9, 66.8, 68.5, 68.6, 66.8, 67.3, 64.0, 66.7, 67.0, 67.8, 69.1, 68.2, 69.3, 69.3, 68.6, 68.4, 70.0, 71.7, 70.53333333333333, 67.0, 69.73333333333333, 70.26666666666667, 71.0, 69.06666666666666, 70.53333333333333, 70.46666666666667, 71.13333333333334, 71.0, 71.33333333333333, 71.66666666666667, 71.33333333333333, 70.6, 70.86666666666666, 71.0, 72.33333333333333, 70.13333333333334, 71.8, 71.13333333333334, 72.13333333333334, 71.15, 71.15, 71.3, 72.25, 72.2, 72.55, 71.35, 72.8, 72.55, 73.35, 72.65, 72.75, 73.0, 73.25, 73.35, 72.05, 73.0, 73.05, 72.05, 73.8, 73.4, 74.32, 75.08, 75.24, 75.6, 75.28, 75.52, 75.24, 74.84, 74.76, 74.52, 75.0, 75.04, 75.32, 75.28, 74.76, 74.16, 74.24, 74.32, 75.6, 75.04, 75.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.446, Test loss: 1.526, Test accuracy: 42.80 

Round   0, Global train loss: 1.446, Global test loss: 2.225, Global test accuracy: 24.00 

Round   1, Train loss: 1.122, Test loss: 1.380, Test accuracy: 52.96 

Round   1, Global train loss: 1.122, Global test loss: 2.249, Global test accuracy: 20.28 

Round   2, Train loss: 0.942, Test loss: 1.196, Test accuracy: 58.44 

Round   2, Global train loss: 0.942, Global test loss: 2.221, Global test accuracy: 24.84 

Round   3, Train loss: 0.825, Test loss: 1.219, Test accuracy: 60.36 

Round   3, Global train loss: 0.825, Global test loss: 2.170, Global test accuracy: 19.20 

Round   4, Train loss: 0.714, Test loss: 1.345, Test accuracy: 61.28 

Round   4, Global train loss: 0.714, Global test loss: 2.186, Global test accuracy: 17.40 

Round   5, Train loss: 0.587, Test loss: 1.501, Test accuracy: 59.72 

Round   5, Global train loss: 0.587, Global test loss: 2.194, Global test accuracy: 18.96 

Round   6, Train loss: 0.510, Test loss: 1.366, Test accuracy: 61.92 

Round   6, Global train loss: 0.510, Global test loss: 2.219, Global test accuracy: 18.40 

Round   7, Train loss: 0.421, Test loss: 1.622, Test accuracy: 60.72 

Round   7, Global train loss: 0.421, Global test loss: 2.250, Global test accuracy: 14.36 

Round   8, Train loss: 0.370, Test loss: 1.428, Test accuracy: 62.96 

Round   8, Global train loss: 0.370, Global test loss: 2.276, Global test accuracy: 15.40 

Round   9, Train loss: 0.313, Test loss: 1.486, Test accuracy: 65.64 

Round   9, Global train loss: 0.313, Global test loss: 2.261, Global test accuracy: 16.68 

Round  10, Train loss: 0.253, Test loss: 1.438, Test accuracy: 66.28 

Round  10, Global train loss: 0.253, Global test loss: 2.259, Global test accuracy: 14.20 

Round  11, Train loss: 0.215, Test loss: 1.754, Test accuracy: 64.64 

Round  11, Global train loss: 0.215, Global test loss: 2.261, Global test accuracy: 12.40 

Round  12, Train loss: 0.193, Test loss: 2.033, Test accuracy: 62.44 

Round  12, Global train loss: 0.193, Global test loss: 2.238, Global test accuracy: 14.32 

Round  13, Train loss: 0.162, Test loss: 1.751, Test accuracy: 64.16 

Round  13, Global train loss: 0.162, Global test loss: 2.264, Global test accuracy: 12.92 

Round  14, Train loss: 0.129, Test loss: 1.571, Test accuracy: 67.56 

Round  14, Global train loss: 0.129, Global test loss: 2.279, Global test accuracy: 14.92 

Round  15, Train loss: 0.117, Test loss: 1.643, Test accuracy: 66.84 

Round  15, Global train loss: 0.117, Global test loss: 2.289, Global test accuracy: 14.92 

Round  16, Train loss: 0.107, Test loss: 1.653, Test accuracy: 66.32 

Round  16, Global train loss: 0.107, Global test loss: 2.330, Global test accuracy: 14.08 

Round  17, Train loss: 0.091, Test loss: 1.644, Test accuracy: 67.44 

Round  17, Global train loss: 0.091, Global test loss: 2.341, Global test accuracy: 13.20 

Round  18, Train loss: 0.092, Test loss: 1.859, Test accuracy: 65.88 

Round  18, Global train loss: 0.092, Global test loss: 2.352, Global test accuracy: 14.24 

Round  19, Train loss: 0.087, Test loss: 1.839, Test accuracy: 67.92 

Round  19, Global train loss: 0.087, Global test loss: 2.300, Global test accuracy: 13.00 

Round  20, Train loss: 0.075, Test loss: 1.640, Test accuracy: 68.00 

Round  20, Global train loss: 0.075, Global test loss: 2.283, Global test accuracy: 15.08 

Round  21, Train loss: 0.073, Test loss: 1.706, Test accuracy: 67.88 

Round  21, Global train loss: 0.073, Global test loss: 2.320, Global test accuracy: 15.24 

Round  22, Train loss: 0.053, Test loss: 1.755, Test accuracy: 67.32 

Round  22, Global train loss: 0.053, Global test loss: 2.337, Global test accuracy: 13.40 

Round  23, Train loss: 0.051, Test loss: 1.839, Test accuracy: 67.16 

Round  23, Global train loss: 0.051, Global test loss: 2.317, Global test accuracy: 13.36 

Round  24, Train loss: 0.041, Test loss: 1.815, Test accuracy: 67.64 

Round  24, Global train loss: 0.041, Global test loss: 2.342, Global test accuracy: 14.08 

Round  25, Train loss: 0.055, Test loss: 1.640, Test accuracy: 69.92 

Round  25, Global train loss: 0.055, Global test loss: 2.313, Global test accuracy: 14.12 

Round  26, Train loss: 0.027, Test loss: 1.802, Test accuracy: 68.08 

Round  26, Global train loss: 0.027, Global test loss: 2.335, Global test accuracy: 14.96 

Round  27, Train loss: 0.045, Test loss: 1.607, Test accuracy: 69.96 

Round  27, Global train loss: 0.045, Global test loss: 2.327, Global test accuracy: 13.80 

Round  28, Train loss: 0.022, Test loss: 1.743, Test accuracy: 69.52 

Round  28, Global train loss: 0.022, Global test loss: 2.312, Global test accuracy: 14.36 

Round  29, Train loss: 0.028, Test loss: 1.764, Test accuracy: 69.84 

Round  29, Global train loss: 0.028, Global test loss: 2.316, Global test accuracy: 14.36 

Round  30, Train loss: 0.028, Test loss: 1.735, Test accuracy: 70.08 

Round  30, Global train loss: 0.028, Global test loss: 2.358, Global test accuracy: 15.60 

Round  31, Train loss: 0.036, Test loss: 1.749, Test accuracy: 69.96 

Round  31, Global train loss: 0.036, Global test loss: 2.341, Global test accuracy: 15.40 

Round  32, Train loss: 0.018, Test loss: 1.761, Test accuracy: 69.52 

Round  32, Global train loss: 0.018, Global test loss: 2.333, Global test accuracy: 15.88 

Round  33, Train loss: 0.014, Test loss: 1.896, Test accuracy: 68.76 

Round  33, Global train loss: 0.014, Global test loss: 2.352, Global test accuracy: 15.16 

Round  34, Train loss: 0.015, Test loss: 1.721, Test accuracy: 70.64 

Round  34, Global train loss: 0.015, Global test loss: 2.311, Global test accuracy: 14.96 

Final Round, Train loss: 0.014, Test loss: 1.921, Test accuracy: 67.68 

Final Round, Global train loss: 0.014, Global test loss: 2.311, Global test accuracy: 14.96 

Average accuracy final 10 rounds: 69.628 

Average global accuracy final 10 rounds: 14.860000000000003 

1152.0632119178772
[8.706780672073364, 14.707064151763916, 20.32274580001831, 26.124409198760986, 31.852001428604126, 37.55800008773804, 43.19539713859558, 48.856385946273804, 54.51414203643799, 60.23959732055664, 65.77243900299072, 71.34722518920898, 76.88751435279846, 82.72064065933228, 88.34103202819824, 93.93966841697693, 99.50660181045532, 105.13598871231079, 110.72721028327942, 116.37799954414368, 121.85801696777344, 127.56715655326843, 133.23204827308655, 138.98516416549683, 144.76828384399414, 150.33207821846008, 156.04714703559875, 161.74474167823792, 167.31496477127075, 172.86340427398682, 178.51935601234436, 184.1641824245453, 189.80179357528687, 195.47442770004272, 201.04255723953247, 212.11985325813293]
[42.8, 52.96, 58.44, 60.36, 61.28, 59.72, 61.92, 60.72, 62.96, 65.64, 66.28, 64.64, 62.44, 64.16, 67.56, 66.84, 66.32, 67.44, 65.88, 67.92, 68.0, 67.88, 67.32, 67.16, 67.64, 69.92, 68.08, 69.96, 69.52, 69.84, 70.08, 69.96, 69.52, 68.76, 70.64, 67.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.456, Test loss: 1.206, Test accuracy: 52.80 

Round   0, Global train loss: 1.456, Global test loss: 2.301, Global test accuracy: 22.60 

Round   1, Train loss: 1.326, Test loss: 1.305, Test accuracy: 52.24 

Round   1, Global train loss: 1.326, Global test loss: 1.914, Global test accuracy: 37.80 

Round   2, Train loss: 1.189, Test loss: 1.103, Test accuracy: 59.00 

Round   2, Global train loss: 1.189, Global test loss: 1.909, Global test accuracy: 37.76 

Round   3, Train loss: 1.059, Test loss: 1.255, Test accuracy: 56.84 

Round   3, Global train loss: 1.059, Global test loss: 1.906, Global test accuracy: 39.40 

Round   4, Train loss: 0.968, Test loss: 1.208, Test accuracy: 58.08 

Round   4, Global train loss: 0.968, Global test loss: 1.627, Global test accuracy: 44.40 

Round   5, Train loss: 0.884, Test loss: 0.949, Test accuracy: 66.56 

Round   5, Global train loss: 0.884, Global test loss: 1.745, Global test accuracy: 43.04 

Round   6, Train loss: 0.823, Test loss: 1.037, Test accuracy: 65.24 

Round   6, Global train loss: 0.823, Global test loss: 1.604, Global test accuracy: 47.40 

Round   7, Train loss: 0.765, Test loss: 1.162, Test accuracy: 61.56 

Round   7, Global train loss: 0.765, Global test loss: 1.467, Global test accuracy: 50.28 

Round   8, Train loss: 0.715, Test loss: 1.139, Test accuracy: 63.48 

Round   8, Global train loss: 0.715, Global test loss: 1.484, Global test accuracy: 50.68 

Round   9, Train loss: 0.665, Test loss: 1.210, Test accuracy: 63.56 

Round   9, Global train loss: 0.665, Global test loss: 1.451, Global test accuracy: 52.48 

Round  10, Train loss: 0.606, Test loss: 1.132, Test accuracy: 65.00 

Round  10, Global train loss: 0.606, Global test loss: 1.562, Global test accuracy: 51.80 

Round  11, Train loss: 0.567, Test loss: 1.362, Test accuracy: 63.16 

Round  11, Global train loss: 0.567, Global test loss: 1.331, Global test accuracy: 57.16 

Round  12, Train loss: 0.535, Test loss: 1.137, Test accuracy: 67.16 

Round  12, Global train loss: 0.535, Global test loss: 1.409, Global test accuracy: 57.28 

Round  13, Train loss: 0.477, Test loss: 1.210, Test accuracy: 67.32 

Round  13, Global train loss: 0.477, Global test loss: 1.449, Global test accuracy: 56.24 

Round  14, Train loss: 0.451, Test loss: 1.101, Test accuracy: 69.08 

Round  14, Global train loss: 0.451, Global test loss: 1.292, Global test accuracy: 60.52 

Round  15, Train loss: 0.416, Test loss: 1.168, Test accuracy: 67.64 

Round  15, Global train loss: 0.416, Global test loss: 1.524, Global test accuracy: 56.64 

Round  16, Train loss: 0.395, Test loss: 1.186, Test accuracy: 68.72 

Round  16, Global train loss: 0.395, Global test loss: 1.393, Global test accuracy: 60.32 

Round  17, Train loss: 0.362, Test loss: 1.051, Test accuracy: 71.12 

Round  17, Global train loss: 0.362, Global test loss: 1.304, Global test accuracy: 61.56 

Round  18, Train loss: 0.338, Test loss: 1.244, Test accuracy: 69.68 

Round  18, Global train loss: 0.338, Global test loss: 1.294, Global test accuracy: 62.12 

Round  19, Train loss: 0.319, Test loss: 1.026, Test accuracy: 71.56 

Round  19, Global train loss: 0.319, Global test loss: 1.110, Global test accuracy: 65.60 

Round  20, Train loss: 0.293, Test loss: 1.346, Test accuracy: 69.36 

Round  20, Global train loss: 0.293, Global test loss: 1.088, Global test accuracy: 66.84 

Round  21, Train loss: 0.276, Test loss: 0.960, Test accuracy: 73.24 

Round  21, Global train loss: 0.276, Global test loss: 1.208, Global test accuracy: 64.80 

Round  22, Train loss: 0.253, Test loss: 1.010, Test accuracy: 74.44 

Round  22, Global train loss: 0.253, Global test loss: 1.247, Global test accuracy: 64.84 

Round  23, Train loss: 0.251, Test loss: 1.083, Test accuracy: 73.60 

Round  23, Global train loss: 0.251, Global test loss: 1.195, Global test accuracy: 65.12 

Round  24, Train loss: 0.234, Test loss: 1.063, Test accuracy: 73.28 

Round  24, Global train loss: 0.234, Global test loss: 1.180, Global test accuracy: 65.52 

Round  25, Train loss: 0.203, Test loss: 1.135, Test accuracy: 73.08 

Round  25, Global train loss: 0.203, Global test loss: 1.134, Global test accuracy: 67.44 

Round  26, Train loss: 0.209, Test loss: 1.098, Test accuracy: 72.88 

Round  26, Global train loss: 0.209, Global test loss: 1.222, Global test accuracy: 65.52 

Round  27, Train loss: 0.194, Test loss: 1.044, Test accuracy: 74.40 

Round  27, Global train loss: 0.194, Global test loss: 1.165, Global test accuracy: 66.76 

Round  28, Train loss: 0.173, Test loss: 1.199, Test accuracy: 73.00 

Round  28, Global train loss: 0.173, Global test loss: 1.097, Global test accuracy: 69.64 

Round  29, Train loss: 0.168, Test loss: 1.177, Test accuracy: 74.24 

Round  29, Global train loss: 0.168, Global test loss: 1.164, Global test accuracy: 67.88 

Round  30, Train loss: 0.149, Test loss: 1.079, Test accuracy: 74.60 

Round  30, Global train loss: 0.149, Global test loss: 1.151, Global test accuracy: 68.92 

Round  31, Train loss: 0.152, Test loss: 1.155, Test accuracy: 74.52 

Round  31, Global train loss: 0.152, Global test loss: 1.144, Global test accuracy: 68.36 

Round  32, Train loss: 0.128, Test loss: 1.230, Test accuracy: 73.28 

Round  32, Global train loss: 0.128, Global test loss: 1.131, Global test accuracy: 69.12 

Round  33, Train loss: 0.138, Test loss: 1.475, Test accuracy: 70.64 

Round  33, Global train loss: 0.138, Global test loss: 1.117, Global test accuracy: 69.20 

Round  34, Train loss: 0.131, Test loss: 1.158, Test accuracy: 75.12 

Round  34, Global train loss: 0.131, Global test loss: 1.094, Global test accuracy: 69.52 

Round  35, Train loss: 0.092, Test loss: 1.215, Test accuracy: 72.96 

Round  35, Global train loss: 0.092, Global test loss: 1.114, Global test accuracy: 69.88 

Round  36, Train loss: 0.120, Test loss: 1.350, Test accuracy: 74.28 

Round  36, Global train loss: 0.120, Global test loss: 1.299, Global test accuracy: 67.80 

Round  37, Train loss: 0.098, Test loss: 1.207, Test accuracy: 73.72 

Round  37, Global train loss: 0.098, Global test loss: 1.213, Global test accuracy: 68.68 

Round  38, Train loss: 0.098, Test loss: 1.342, Test accuracy: 72.76 

Round  38, Global train loss: 0.098, Global test loss: 1.074, Global test accuracy: 71.40 

Round  39, Train loss: 0.085, Test loss: 1.200, Test accuracy: 75.64 

Round  39, Global train loss: 0.085, Global test loss: 1.171, Global test accuracy: 69.84 

Round  40, Train loss: 0.081, Test loss: 1.269, Test accuracy: 74.84 

Round  40, Global train loss: 0.081, Global test loss: 1.119, Global test accuracy: 71.40 

Round  41, Train loss: 0.086, Test loss: 1.231, Test accuracy: 76.76 

Round  41, Global train loss: 0.086, Global test loss: 1.049, Global test accuracy: 71.72 

Round  42, Train loss: 0.099, Test loss: 1.191, Test accuracy: 76.24 

Round  42, Global train loss: 0.099, Global test loss: 1.103, Global test accuracy: 70.64 

Round  43, Train loss: 0.070, Test loss: 1.156, Test accuracy: 77.44 

Round  43, Global train loss: 0.070, Global test loss: 1.089, Global test accuracy: 71.36 

Round  44, Train loss: 0.055, Test loss: 1.122, Test accuracy: 76.60 

Round  44, Global train loss: 0.055, Global test loss: 1.155, Global test accuracy: 70.84 

Round  45, Train loss: 0.054, Test loss: 1.150, Test accuracy: 76.80 

Round  45, Global train loss: 0.054, Global test loss: 1.109, Global test accuracy: 71.16 

Round  46, Train loss: 0.069, Test loss: 1.101, Test accuracy: 77.00 

Round  46, Global train loss: 0.069, Global test loss: 1.143, Global test accuracy: 70.76 

Round  47, Train loss: 0.057, Test loss: 1.115, Test accuracy: 76.24 

Round  47, Global train loss: 0.057, Global test loss: 1.137, Global test accuracy: 71.36 

Round  48, Train loss: 0.089, Test loss: 1.191, Test accuracy: 75.32 

Round  48, Global train loss: 0.089, Global test loss: 1.099, Global test accuracy: 70.80 

Round  49, Train loss: 0.048, Test loss: 1.062, Test accuracy: 78.64 

Round  49, Global train loss: 0.048, Global test loss: 1.118, Global test accuracy: 71.16 

Final Round, Train loss: 0.043, Test loss: 1.106, Test accuracy: 78.40 

Final Round, Global train loss: 0.043, Global test loss: 1.118, Global test accuracy: 71.16 

Average accuracy final 10 rounds: 76.58800000000001 

Average global accuracy final 10 rounds: 71.12 

1585.3933494091034
[7.680918455123901, 13.574843406677246, 19.28681468963623, 24.843071460723877, 30.46853256225586, 36.094512939453125, 41.63619780540466, 47.20161509513855, 52.82635951042175, 58.39866375923157, 63.98436188697815, 69.49090957641602, 74.9769856929779, 80.3985276222229, 85.90407657623291, 91.70524573326111, 97.08870530128479, 102.66560435295105, 108.22274160385132, 113.62205934524536, 119.12543869018555, 124.65451550483704, 130.14750981330872, 135.7767255306244, 141.22952437400818, 146.94018054008484, 152.48499369621277, 158.00304865837097, 163.73468399047852, 169.4290053844452, 174.91824221611023, 180.5575349330902, 186.13246202468872, 191.6777539253235, 197.3253219127655, 202.9523286819458, 208.4710910320282, 214.07208919525146, 219.57160687446594, 225.0500967502594, 230.83913040161133, 236.47190880775452, 241.9016625881195, 247.4030191898346, 252.99480271339417, 258.6379315853119, 264.1481385231018, 269.7822344303131, 275.24553894996643, 280.79927372932434, 291.7238459587097]
[52.8, 52.24, 59.0, 56.84, 58.08, 66.56, 65.24, 61.56, 63.48, 63.56, 65.0, 63.16, 67.16, 67.32, 69.08, 67.64, 68.72, 71.12, 69.68, 71.56, 69.36, 73.24, 74.44, 73.6, 73.28, 73.08, 72.88, 74.4, 73.0, 74.24, 74.6, 74.52, 73.28, 70.64, 75.12, 72.96, 74.28, 73.72, 72.76, 75.64, 74.84, 76.76, 76.24, 77.44, 76.6, 76.8, 77.0, 76.24, 75.32, 78.64, 78.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.546, Test loss: 1.724, Test accuracy: 26.28 

Round   1, Train loss: 1.378, Test loss: 1.599, Test accuracy: 34.96 

Round   2, Train loss: 1.230, Test loss: 1.249, Test accuracy: 48.12 

Round   3, Train loss: 1.112, Test loss: 1.178, Test accuracy: 53.60 

Round   4, Train loss: 1.047, Test loss: 1.191, Test accuracy: 51.28 

Round   5, Train loss: 0.983, Test loss: 1.122, Test accuracy: 56.60 

Round   6, Train loss: 0.919, Test loss: 1.026, Test accuracy: 59.52 

Round   7, Train loss: 0.877, Test loss: 0.937, Test accuracy: 63.16 

Round   8, Train loss: 0.816, Test loss: 0.955, Test accuracy: 63.44 

Round   9, Train loss: 0.768, Test loss: 0.917, Test accuracy: 64.76 

Round  10, Train loss: 0.727, Test loss: 0.866, Test accuracy: 67.60 

Round  11, Train loss: 0.697, Test loss: 0.891, Test accuracy: 66.28 

Round  12, Train loss: 0.653, Test loss: 0.867, Test accuracy: 67.36 

Round  13, Train loss: 0.626, Test loss: 0.779, Test accuracy: 71.72 

Round  14, Train loss: 0.572, Test loss: 0.779, Test accuracy: 70.56 

Round  15, Train loss: 0.542, Test loss: 0.718, Test accuracy: 73.04 

Round  16, Train loss: 0.518, Test loss: 0.794, Test accuracy: 70.96 

Round  17, Train loss: 0.483, Test loss: 0.763, Test accuracy: 73.44 

Round  18, Train loss: 0.461, Test loss: 0.762, Test accuracy: 72.36 

Round  19, Train loss: 0.443, Test loss: 0.746, Test accuracy: 74.56 

Round  20, Train loss: 0.417, Test loss: 0.820, Test accuracy: 73.16 

Round  21, Train loss: 0.389, Test loss: 0.722, Test accuracy: 74.76 

Round  22, Train loss: 0.368, Test loss: 0.708, Test accuracy: 75.36 

Round  23, Train loss: 0.343, Test loss: 0.702, Test accuracy: 76.08 

Round  24, Train loss: 0.327, Test loss: 0.727, Test accuracy: 74.80 

Round  25, Train loss: 0.309, Test loss: 0.771, Test accuracy: 73.36 

Round  26, Train loss: 0.277, Test loss: 0.709, Test accuracy: 76.68 

Round  27, Train loss: 0.262, Test loss: 0.717, Test accuracy: 76.04 

Round  28, Train loss: 0.249, Test loss: 0.721, Test accuracy: 76.36 

Round  29, Train loss: 0.228, Test loss: 0.727, Test accuracy: 77.24 

Round  30, Train loss: 0.227, Test loss: 0.687, Test accuracy: 77.56 

Round  31, Train loss: 0.207, Test loss: 0.725, Test accuracy: 77.28 

Round  32, Train loss: 0.195, Test loss: 0.721, Test accuracy: 77.08 

Round  33, Train loss: 0.179, Test loss: 0.734, Test accuracy: 77.48 

Round  34, Train loss: 0.170, Test loss: 0.716, Test accuracy: 78.00 

Round  35, Train loss: 0.165, Test loss: 0.770, Test accuracy: 76.44 

Round  36, Train loss: 0.143, Test loss: 0.742, Test accuracy: 77.68 

Round  37, Train loss: 0.149, Test loss: 0.764, Test accuracy: 78.56 

Round  38, Train loss: 0.139, Test loss: 0.771, Test accuracy: 77.12 

Round  39, Train loss: 0.121, Test loss: 0.741, Test accuracy: 78.36 

Round  40, Train loss: 0.110, Test loss: 0.714, Test accuracy: 79.36 

Round  41, Train loss: 0.104, Test loss: 0.766, Test accuracy: 78.20 

Round  42, Train loss: 0.091, Test loss: 0.715, Test accuracy: 79.32 

Round  43, Train loss: 0.099, Test loss: 0.750, Test accuracy: 78.60 

Round  44, Train loss: 0.097, Test loss: 0.752, Test accuracy: 79.60 

Round  45, Train loss: 0.092, Test loss: 0.789, Test accuracy: 78.60 

Round  46, Train loss: 0.091, Test loss: 0.765, Test accuracy: 78.60 

Round  47, Train loss: 0.071, Test loss: 0.738, Test accuracy: 79.00 

Round  48, Train loss: 0.067, Test loss: 0.798, Test accuracy: 78.04 

Round  49, Train loss: 0.059, Test loss: 0.764, Test accuracy: 78.96 

Final Round, Train loss: 0.037, Test loss: 0.774, Test accuracy: 78.88 

Average accuracy final 10 rounds: 78.82799999999999 

1166.7358102798462
[6.301999092102051, 10.499280452728271, 14.813511371612549, 19.23141598701477, 23.485095262527466, 27.86708164215088, 32.17603945732117, 36.4516282081604, 40.821831941604614, 45.20494246482849, 49.48382782936096, 53.92125391960144, 58.37313532829285, 62.689940452575684, 67.04320955276489, 71.20783495903015, 75.71582055091858, 80.1334662437439, 84.52827572822571, 88.83557438850403, 93.06340909004211, 97.29487800598145, 101.68526840209961, 106.00204682350159, 110.29418182373047, 114.75041604042053, 119.25796103477478, 123.7147924900055, 127.94493055343628, 132.3779330253601, 136.6398720741272, 140.87848210334778, 145.2570722103119, 149.6180145740509, 153.90118551254272, 158.10676670074463, 162.52559185028076, 166.80472803115845, 171.20427703857422, 175.41292309761047, 179.84276008605957, 184.15622878074646, 188.6059820652008, 192.87877106666565, 197.199289560318, 201.46804857254028, 205.83609557151794, 210.21214747428894, 214.64343357086182, 218.84800338745117, 223.78542494773865]
[26.28, 34.96, 48.12, 53.6, 51.28, 56.6, 59.52, 63.16, 63.44, 64.76, 67.6, 66.28, 67.36, 71.72, 70.56, 73.04, 70.96, 73.44, 72.36, 74.56, 73.16, 74.76, 75.36, 76.08, 74.8, 73.36, 76.68, 76.04, 76.36, 77.24, 77.56, 77.28, 77.08, 77.48, 78.0, 76.44, 77.68, 78.56, 77.12, 78.36, 79.36, 78.2, 79.32, 78.6, 79.6, 78.6, 78.6, 79.0, 78.04, 78.96, 78.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.573, Test loss: 1.682, Test accuracy: 27.72
Round   1, Train loss: 1.373, Test loss: 1.471, Test accuracy: 40.04
Round   2, Train loss: 1.238, Test loss: 1.233, Test accuracy: 50.44
Round   3, Train loss: 1.164, Test loss: 1.326, Test accuracy: 50.68
Round   4, Train loss: 1.059, Test loss: 1.089, Test accuracy: 55.28
Round   5, Train loss: 0.994, Test loss: 1.052, Test accuracy: 57.52
Round   6, Train loss: 0.936, Test loss: 1.011, Test accuracy: 59.88
Round   7, Train loss: 0.880, Test loss: 0.904, Test accuracy: 64.76
Round   8, Train loss: 0.840, Test loss: 1.001, Test accuracy: 60.88
Round   9, Train loss: 0.801, Test loss: 0.981, Test accuracy: 63.60
Round  10, Train loss: 0.764, Test loss: 0.849, Test accuracy: 66.60
Round  11, Train loss: 0.709, Test loss: 0.777, Test accuracy: 70.08
Round  12, Train loss: 0.673, Test loss: 0.853, Test accuracy: 68.12
Round  13, Train loss: 0.646, Test loss: 0.823, Test accuracy: 69.36
Round  14, Train loss: 0.612, Test loss: 0.794, Test accuracy: 70.96
Round  15, Train loss: 0.577, Test loss: 0.765, Test accuracy: 72.48
Round  16, Train loss: 0.536, Test loss: 0.743, Test accuracy: 72.60
Round  17, Train loss: 0.515, Test loss: 0.741, Test accuracy: 72.80
Round  18, Train loss: 0.484, Test loss: 0.864, Test accuracy: 70.48
Round  19, Train loss: 0.461, Test loss: 0.749, Test accuracy: 73.20
Round  20, Train loss: 0.428, Test loss: 0.752, Test accuracy: 74.04
Round  21, Train loss: 0.415, Test loss: 0.738, Test accuracy: 73.48
Round  22, Train loss: 0.383, Test loss: 0.739, Test accuracy: 74.24
Round  23, Train loss: 0.372, Test loss: 0.719, Test accuracy: 74.88
Round  24, Train loss: 0.345, Test loss: 0.728, Test accuracy: 74.72
Round  25, Train loss: 0.319, Test loss: 0.683, Test accuracy: 77.04
Round  26, Train loss: 0.305, Test loss: 0.716, Test accuracy: 75.16
Round  27, Train loss: 0.287, Test loss: 0.692, Test accuracy: 76.92
Round  28, Train loss: 0.281, Test loss: 0.759, Test accuracy: 74.44
Round  29, Train loss: 0.268, Test loss: 0.689, Test accuracy: 77.08
Round  30, Train loss: 0.244, Test loss: 0.740, Test accuracy: 76.28
Round  31, Train loss: 0.219, Test loss: 0.712, Test accuracy: 77.24
Round  32, Train loss: 0.218, Test loss: 0.711, Test accuracy: 77.84
Round  33, Train loss: 0.207, Test loss: 0.696, Test accuracy: 76.88
Round  34, Train loss: 0.198, Test loss: 0.742, Test accuracy: 77.28
Round  35, Train loss: 0.177, Test loss: 0.727, Test accuracy: 77.28
Round  36, Train loss: 0.167, Test loss: 0.745, Test accuracy: 77.52
Round  37, Train loss: 0.150, Test loss: 0.730, Test accuracy: 77.56
Round  38, Train loss: 0.150, Test loss: 0.693, Test accuracy: 78.96
Round  39, Train loss: 0.138, Test loss: 0.705, Test accuracy: 78.48
Round  40, Train loss: 0.125, Test loss: 0.696, Test accuracy: 78.56
Round  41, Train loss: 0.115, Test loss: 0.698, Test accuracy: 78.68
Round  42, Train loss: 0.118, Test loss: 0.728, Test accuracy: 78.48
Round  43, Train loss: 0.116, Test loss: 0.722, Test accuracy: 78.48
Round  44, Train loss: 0.095, Test loss: 0.731, Test accuracy: 78.76
Round  45, Train loss: 0.095, Test loss: 0.742, Test accuracy: 78.00
Round  46, Train loss: 0.083, Test loss: 0.741, Test accuracy: 78.40
Round  47, Train loss: 0.090, Test loss: 0.762, Test accuracy: 78.68
Round  48, Train loss: 0.074, Test loss: 0.732, Test accuracy: 79.32
Round  49, Train loss: 0.068, Test loss: 0.755, Test accuracy: 78.56
Final Round, Train loss: 0.040, Test loss: 0.761, Test accuracy: 78.80
Average accuracy final 10 rounds: 78.592
1315.721774816513
[6.872829914093018, 11.92222809791565, 16.952366590499878, 21.908317804336548, 26.801040649414062, 31.58374285697937, 36.717705965042114, 41.72403001785278, 46.74557280540466, 51.52962398529053, 56.35320019721985, 61.06861066818237, 65.93434119224548, 70.75908875465393, 75.66299247741699, 80.78816938400269, 85.6328353881836, 90.50996565818787, 95.47860670089722, 100.43137645721436, 105.2006094455719, 110.30965518951416, 115.24369168281555, 120.3703100681305, 125.39017462730408, 130.36553072929382, 135.52145314216614, 140.64877247810364, 145.61241745948792, 150.4470579624176, 155.33026337623596, 160.29383492469788, 165.13978624343872, 170.1991674900055, 175.18177580833435, 180.0560278892517, 185.0282919406891, 190.03699660301208, 195.05169415473938, 199.82612323760986, 204.73346590995789, 209.6673505306244, 214.67176151275635, 219.56003761291504, 224.67675137519836, 229.7350618839264, 234.63541269302368, 239.61760568618774, 244.6195306777954, 249.63646173477173, 254.41801762580872]
[27.72, 40.04, 50.44, 50.68, 55.28, 57.52, 59.88, 64.76, 60.88, 63.6, 66.6, 70.08, 68.12, 69.36, 70.96, 72.48, 72.6, 72.8, 70.48, 73.2, 74.04, 73.48, 74.24, 74.88, 74.72, 77.04, 75.16, 76.92, 74.44, 77.08, 76.28, 77.24, 77.84, 76.88, 77.28, 77.28, 77.52, 77.56, 78.96, 78.48, 78.56, 78.68, 78.48, 78.48, 78.76, 78.0, 78.4, 78.68, 79.32, 78.56, 78.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.505, Train accuracy: 80.200, Test loss: 1.448, Test accuracy: 55.20 

        train local model (freeze embeding):client   0,  Train loss: 0.273, Train accuracy: 89.600, Test loss: 1.329, Test accuracy: 60.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.262, Train accuracy: 89.800, Test loss: 1.430, Test accuracy: 61.60 

Round   0, Train loss: 0.262, Test loss: 1.430, Test accuracy: 61.60 

        train local model (freeze embeding):client   0,  Train loss: 0.212, Train accuracy: 93.000, Test loss: 1.311, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.263, Train accuracy: 91.200, Test loss: 1.411, Test accuracy: 59.80 

Round   1, Train loss: 0.263, Test loss: 1.411, Test accuracy: 59.80 

        train local model (freeze embeding):client   0,  Train loss: 0.167, Train accuracy: 94.400, Test loss: 1.377, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.191, Train accuracy: 92.800, Test loss: 1.698, Test accuracy: 64.40 

Round   2, Train loss: 0.191, Test loss: 1.698, Test accuracy: 64.40 

        train local model (freeze embeding):client   0,  Train loss: 0.146, Train accuracy: 94.800, Test loss: 1.568, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.281, Train accuracy: 89.000, Test loss: 1.655, Test accuracy: 60.00 

Round   3, Train loss: 0.281, Test loss: 1.655, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.097, Train accuracy: 97.000, Test loss: 1.490, Test accuracy: 61.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.175, Train accuracy: 93.600, Test loss: 1.821, Test accuracy: 60.00 

Round   4, Train loss: 0.175, Test loss: 1.821, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.132, Train accuracy: 95.600, Test loss: 1.628, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.250, Train accuracy: 91.000, Test loss: 1.990, Test accuracy: 62.20 

Round   5, Train loss: 0.250, Test loss: 1.990, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.082, Train accuracy: 97.400, Test loss: 1.612, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.120, Train accuracy: 96.200, Test loss: 2.071, Test accuracy: 61.00 

Round   6, Train loss: 0.120, Test loss: 2.071, Test accuracy: 61.00 

        train local model (freeze embeding):client   0,  Train loss: 0.068, Train accuracy: 98.000, Test loss: 1.767, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.071, Train accuracy: 97.800, Test loss: 1.874, Test accuracy: 64.80 

Round   7, Train loss: 0.071, Test loss: 1.874, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.600, Test loss: 1.605, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.059, Train accuracy: 97.600, Test loss: 1.722, Test accuracy: 62.80 

Round   8, Train loss: 0.059, Test loss: 1.722, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.796, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.865, Test accuracy: 65.00 

Round   9, Train loss: 0.036, Test loss: 1.865, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.851, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.988, Test accuracy: 61.40 

Round  10, Train loss: 0.027, Test loss: 1.988, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.926, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.826, Test accuracy: 63.60 

Round  11, Train loss: 0.025, Test loss: 1.826, Test accuracy: 63.60 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.846, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.875, Test accuracy: 65.60 

Round  12, Train loss: 0.014, Test loss: 1.875, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.971, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.200, Test loss: 2.218, Test accuracy: 65.40 

Round  13, Train loss: 0.040, Test loss: 2.218, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.844, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 1.933, Test accuracy: 62.80 

Round  14, Train loss: 0.027, Test loss: 1.933, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.890, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.837, Test accuracy: 66.40 

Round  15, Train loss: 0.010, Test loss: 1.837, Test accuracy: 66.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.940, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 2.185, Test accuracy: 60.60 

Round  16, Train loss: 0.028, Test loss: 2.185, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 2.008, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.970, Test accuracy: 64.80 

Round  17, Train loss: 0.021, Test loss: 1.970, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.916, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 2.038, Test accuracy: 65.40 

Round  18, Train loss: 0.008, Test loss: 2.038, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.105, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 2.267, Test accuracy: 62.20 

Round  19, Train loss: 0.018, Test loss: 2.267, Test accuracy: 62.20 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.194, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.205, Test accuracy: 63.40 

Final Round, Train loss: 0.007, Test loss: 2.213, Test accuracy: 63.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.238, Train accuracy: 91.200, Test loss: 1.561, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.168, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.038, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 1.152, Train accuracy: 56.600, Test loss: 1.282, Test accuracy: 55.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.592, Train accuracy: 76.800, Test loss: 1.035, Test accuracy: 63.60 

Round   0, Train loss: 0.300, Test loss: 1.368, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.684, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.822, Test accuracy: 67.40 

        train local model (freeze embeding):client   1,  Train loss: 0.632, Train accuracy: 77.800, Test loss: 0.974, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.708, Train accuracy: 77.400, Test loss: 1.309, Test accuracy: 62.40 

Round   1, Train loss: 0.357, Test loss: 1.316, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.011, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.371, Train accuracy: 88.400, Test loss: 0.932, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.456, Train accuracy: 80.600, Test loss: 1.345, Test accuracy: 61.60 

Round   2, Train loss: 0.231, Test loss: 1.383, Test accuracy: 66.50 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.764, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 2.023, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.293, Train accuracy: 89.400, Test loss: 1.054, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.209, Train accuracy: 92.600, Test loss: 1.185, Test accuracy: 68.80 

Round   3, Train loss: 0.114, Test loss: 1.357, Test accuracy: 67.70 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.706, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.846, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.172, Train accuracy: 95.400, Test loss: 1.088, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.148, Train accuracy: 95.800, Test loss: 1.266, Test accuracy: 66.00 

Round   4, Train loss: 0.087, Test loss: 1.357, Test accuracy: 68.10 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.679, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.885, Test accuracy: 66.00 

        train local model (freeze embeding):client   1,  Train loss: 0.121, Train accuracy: 97.800, Test loss: 1.118, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.305, Train accuracy: 91.600, Test loss: 2.014, Test accuracy: 59.20 

Round   5, Train loss: 0.154, Test loss: 1.486, Test accuracy: 66.70 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.695, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.245, Train accuracy: 92.800, Test loss: 2.998, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.106, Train accuracy: 96.600, Test loss: 1.251, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.205, Train accuracy: 91.600, Test loss: 1.468, Test accuracy: 66.00 

Round   6, Train loss: 0.225, Test loss: 1.738, Test accuracy: 66.10 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.720, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 2.080, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.062, Train accuracy: 98.800, Test loss: 1.179, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.172, Train accuracy: 94.200, Test loss: 1.529, Test accuracy: 64.60 

Round   7, Train loss: 0.091, Test loss: 1.551, Test accuracy: 67.10 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.798, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.989, Test accuracy: 66.00 

        train local model (freeze embeding):client   1,  Train loss: 0.058, Train accuracy: 98.800, Test loss: 1.249, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.169, Train accuracy: 93.800, Test loss: 1.331, Test accuracy: 66.00 

Round   8, Train loss: 0.093, Test loss: 1.511, Test accuracy: 67.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.837, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.026, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.039, Train accuracy: 99.600, Test loss: 1.222, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.224, Train accuracy: 93.400, Test loss: 1.852, Test accuracy: 62.40 

Round   9, Train loss: 0.114, Test loss: 1.565, Test accuracy: 68.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.947, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.973, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.236, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.207, Train accuracy: 93.600, Test loss: 2.201, Test accuracy: 59.20 

Round  10, Train loss: 0.105, Test loss: 1.760, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.909, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.964, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.438, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.208, Train accuracy: 94.000, Test loss: 1.782, Test accuracy: 65.80 

Round  11, Train loss: 0.105, Test loss: 1.701, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.884, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.033, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.403, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.061, Train accuracy: 98.000, Test loss: 1.753, Test accuracy: 66.80 

Round  12, Train loss: 0.031, Test loss: 1.682, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.008, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.275, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.281, Train accuracy: 91.200, Test loss: 2.403, Test accuracy: 59.60 

Round  13, Train loss: 0.145, Test loss: 1.747, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.911, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 2.372, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.340, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.195, Train accuracy: 93.200, Test loss: 2.074, Test accuracy: 61.60 

Round  14, Train loss: 0.103, Test loss: 1.783, Test accuracy: 65.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.045, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.060, Train accuracy: 98.600, Test loss: 2.387, Test accuracy: 66.20 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.379, Test accuracy: 67.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.406, Test accuracy: 68.60 

Round  15, Train loss: 0.048, Test loss: 1.666, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.892, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 2.336, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.259, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.600, Test loss: 1.514, Test accuracy: 66.20 

Round  16, Train loss: 0.030, Test loss: 1.640, Test accuracy: 67.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.900, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.065, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.354, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 70.60 

Round  17, Train loss: 0.004, Test loss: 1.628, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.982, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.400, Test loss: 2.340, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.305, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 70.80 

Round  18, Train loss: 0.023, Test loss: 1.818, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.082, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.183, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 1.629, Test accuracy: 68.20 

Round  19, Train loss: 0.010, Test loss: 1.702, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.880, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.921, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 71.40 

Final Round, Train loss: 0.002, Test loss: 1.688, Test accuracy: 70.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 0.985, Test accuracy: 76.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.985, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.076, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.420, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.623, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.923, Train accuracy: 66.200, Test loss: 1.086, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.327, Train accuracy: 89.000, Test loss: 0.965, Test accuracy: 69.40 

Round   0, Train loss: 0.113, Test loss: 1.413, Test accuracy: 68.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.805, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.867, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.666, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.474, Train accuracy: 82.800, Test loss: 0.820, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.280, Train accuracy: 90.800, Test loss: 1.077, Test accuracy: 70.00 

Round   1, Train loss: 0.097, Test loss: 1.311, Test accuracy: 72.33 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.738, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.914, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.066, Train accuracy: 96.800, Test loss: 1.912, Test accuracy: 68.00 

        train local model (freeze embeding):client   2,  Train loss: 0.312, Train accuracy: 86.800, Test loss: 0.845, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.222, Train accuracy: 93.200, Test loss: 1.096, Test accuracy: 70.20 

Round   2, Train loss: 0.096, Test loss: 1.312, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.663, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.091, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.637, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.194, Train accuracy: 94.400, Test loss: 0.785, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.160, Train accuracy: 94.600, Test loss: 0.895, Test accuracy: 72.00 

Round   3, Train loss: 0.057, Test loss: 1.258, Test accuracy: 72.07 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.748, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.055, Train accuracy: 97.600, Test loss: 2.253, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.147, Train accuracy: 95.000, Test loss: 1.872, Test accuracy: 66.20 

        train local model (freeze embeding):client   2,  Train loss: 0.120, Train accuracy: 96.800, Test loss: 0.710, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.117, Train accuracy: 96.800, Test loss: 0.828, Test accuracy: 75.20 

Round   4, Train loss: 0.106, Test loss: 1.231, Test accuracy: 73.53 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.749, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.984, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.323, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 2.027, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.123, Train accuracy: 96.200, Test loss: 0.738, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.122, Train accuracy: 96.000, Test loss: 1.210, Test accuracy: 70.60 

Round   5, Train loss: 0.058, Test loss: 1.371, Test accuracy: 70.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.742, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.964, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.487, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.169, Train accuracy: 94.400, Test loss: 2.164, Test accuracy: 62.20 

        train local model (freeze embeding):client   2,  Train loss: 0.073, Train accuracy: 98.200, Test loss: 0.846, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.132, Train accuracy: 94.600, Test loss: 1.097, Test accuracy: 73.60 

Round   6, Train loss: 0.101, Test loss: 1.360, Test accuracy: 71.07 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.741, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.874, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.395, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.055, Train accuracy: 97.800, Test loss: 1.642, Test accuracy: 66.20 

        train local model (freeze embeding):client   2,  Train loss: 0.059, Train accuracy: 98.800, Test loss: 0.858, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.105, Train accuracy: 96.600, Test loss: 1.034, Test accuracy: 74.00 

Round   7, Train loss: 0.054, Test loss: 1.286, Test accuracy: 71.73 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.721, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.947, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.122, Train accuracy: 95.400, Test loss: 1.996, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.200, Test loss: 0.847, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.056, Train accuracy: 98.200, Test loss: 1.082, Test accuracy: 72.40 

Round   8, Train loss: 0.061, Test loss: 1.382, Test accuracy: 71.87 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.706, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.931, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.400, Test loss: 1.700, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.800, Test loss: 0.860, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.408, Train accuracy: 87.800, Test loss: 1.694, Test accuracy: 66.60 

Round   9, Train loss: 0.146, Test loss: 1.412, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.789, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.986, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.483, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.867, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 0.890, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 1.049, Test accuracy: 72.80 

Round  10, Train loss: 0.032, Test loss: 1.382, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.668, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.874, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.512, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.703, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 0.874, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.339, Test accuracy: 69.60 

Round  11, Train loss: 0.016, Test loss: 1.365, Test accuracy: 72.07 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.883, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.512, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.676, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.883, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.039, Train accuracy: 99.400, Test loss: 1.121, Test accuracy: 74.80 

Round  12, Train loss: 0.016, Test loss: 1.379, Test accuracy: 71.87 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.711, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.915, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.472, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.323, Train accuracy: 89.600, Test loss: 2.632, Test accuracy: 60.20 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 0.963, Test accuracy: 76.20 

Round  13, Train loss: 0.113, Test loss: 1.349, Test accuracy: 72.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.682, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.925, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.429, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 2.141, Test accuracy: 64.20 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.091, Train accuracy: 98.400, Test loss: 1.381, Test accuracy: 73.20 

Round  14, Train loss: 0.043, Test loss: 1.410, Test accuracy: 72.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.715, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.968, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.436, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.138, Train accuracy: 95.600, Test loss: 2.265, Test accuracy: 64.00 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.073, Train accuracy: 97.800, Test loss: 1.529, Test accuracy: 72.20 

Round  15, Train loss: 0.072, Test loss: 1.450, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.732, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.784, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.441, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.782, Test accuracy: 68.20 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 0.978, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.090, Train accuracy: 97.000, Test loss: 1.393, Test accuracy: 73.00 

Round  16, Train loss: 0.032, Test loss: 1.428, Test accuracy: 71.87 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.761, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.971, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.571, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.248, Train accuracy: 92.600, Test loss: 1.592, Test accuracy: 70.40 

Round  17, Train loss: 0.083, Test loss: 1.345, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.714, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.983, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.451, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.058, Train accuracy: 97.800, Test loss: 1.290, Test accuracy: 72.40 

Round  18, Train loss: 0.020, Test loss: 1.410, Test accuracy: 72.13 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.818, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.849, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.469, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 76.80 

Round  19, Train loss: 0.004, Test loss: 1.366, Test accuracy: 73.13 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.738, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.775, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.443, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.425, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.977, Test accuracy: 79.20 

Final Round, Train loss: 0.001, Test loss: 1.374, Test accuracy: 72.80 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.022, Test accuracy: 79.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.724, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.854, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.679, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.308, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.737, Train accuracy: 74.200, Test loss: 0.889, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.198, Train accuracy: 93.200, Test loss: 0.892, Test accuracy: 72.80 

Round   0, Train loss: 0.055, Test loss: 1.167, Test accuracy: 74.65 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.630, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.078, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.401, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.492, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.924, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.335, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.405, Train accuracy: 87.000, Test loss: 0.754, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.142, Train accuracy: 95.600, Test loss: 0.868, Test accuracy: 77.20 

Round   1, Train loss: 0.043, Test loss: 1.167, Test accuracy: 74.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.610, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.737, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.524, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.904, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.026, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.270, Train accuracy: 89.000, Test loss: 0.683, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.189, Train accuracy: 92.600, Test loss: 0.963, Test accuracy: 76.00 

Round   2, Train loss: 0.050, Test loss: 1.116, Test accuracy: 75.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.604, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.789, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.331, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.774, Test accuracy: 67.20 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.005, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.218, Train accuracy: 93.200, Test loss: 0.756, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.121, Train accuracy: 96.000, Test loss: 0.975, Test accuracy: 77.00 

Round   3, Train loss: 0.045, Test loss: 1.124, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.596, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.855, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.079, Train accuracy: 97.200, Test loss: 1.810, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.091, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.145, Train accuracy: 96.200, Test loss: 0.737, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.113, Train accuracy: 96.400, Test loss: 1.046, Test accuracy: 75.40 

Round   4, Train loss: 0.052, Test loss: 1.114, Test accuracy: 76.35 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.982, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.891, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 1.045, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.100, Train accuracy: 97.000, Test loss: 0.722, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.104, Train accuracy: 97.000, Test loss: 1.146, Test accuracy: 74.20 

Round   5, Train loss: 0.032, Test loss: 1.100, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.542, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 1.758, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.259, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.114, Train accuracy: 95.400, Test loss: 1.911, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.058, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.077, Train accuracy: 98.000, Test loss: 0.764, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.400, Test loss: 0.916, Test accuracy: 78.40 

Round   6, Train loss: 0.051, Test loss: 1.125, Test accuracy: 76.30 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.558, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.852, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.344, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.101, Train accuracy: 96.200, Test loss: 2.188, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.876, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.087, Train accuracy: 97.400, Test loss: 1.722, Test accuracy: 69.00 

        train local model (freeze embeding):client   3,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 0.746, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.149, Test accuracy: 76.00 

Round   7, Train loss: 0.065, Test loss: 1.197, Test accuracy: 75.55 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.649, Test accuracy: 70.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.389, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.297, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.008, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.054, Train accuracy: 99.000, Test loss: 0.790, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.140, Train accuracy: 95.000, Test loss: 1.222, Test accuracy: 71.00 

Round   8, Train loss: 0.040, Test loss: 1.113, Test accuracy: 75.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.844, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.292, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.457, Test accuracy: 71.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.041, Train accuracy: 99.200, Test loss: 0.762, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.067, Train accuracy: 97.800, Test loss: 1.019, Test accuracy: 75.00 

Round   9, Train loss: 0.019, Test loss: 1.095, Test accuracy: 77.15 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.538, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.676, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.634, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.079, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 0.810, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.066, Train accuracy: 97.800, Test loss: 1.233, Test accuracy: 73.80 

Round  10, Train loss: 0.024, Test loss: 1.156, Test accuracy: 76.95 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.618, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.792, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.488, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.058, Train accuracy: 98.200, Test loss: 1.038, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.994, Test accuracy: 77.40 

Round  11, Train loss: 0.027, Test loss: 1.090, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.509, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.080, Train accuracy: 97.800, Test loss: 2.174, Test accuracy: 66.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.509, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 79.20 

        train local model (freeze embeding):client   3,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.036, Train accuracy: 98.600, Test loss: 0.957, Test accuracy: 78.60 

Round  12, Train loss: 0.033, Test loss: 1.136, Test accuracy: 76.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 2.240, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.451, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 77.60 

        train local model (freeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 0.742, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.051, Train accuracy: 98.000, Test loss: 1.296, Test accuracy: 75.40 

Round  13, Train loss: 0.019, Test loss: 1.202, Test accuracy: 76.35 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.728, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.687, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.469, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 0.824, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.075, Train accuracy: 98.000, Test loss: 1.301, Test accuracy: 74.60 

Round  14, Train loss: 0.022, Test loss: 1.176, Test accuracy: 76.95 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.599, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.736, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.490, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 0.964, Test accuracy: 79.80 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.885, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 81.40 

Round  15, Train loss: 0.006, Test loss: 1.141, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.554, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.993, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.188, Train accuracy: 94.600, Test loss: 2.273, Test accuracy: 62.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.086, Test accuracy: 78.80 

Round  16, Train loss: 0.057, Test loss: 1.234, Test accuracy: 76.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.635, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 2.170, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.433, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.055, Train accuracy: 98.800, Test loss: 1.288, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 79.40 

Round  17, Train loss: 0.022, Test loss: 1.197, Test accuracy: 76.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.668, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 2.096, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.785, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 0.916, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.156, Test accuracy: 78.60 

Round  18, Train loss: 0.015, Test loss: 1.166, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.614, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.783, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.389, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.669, Test accuracy: 72.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 80.20 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.025, Test accuracy: 80.60 

Round  19, Train loss: 0.005, Test loss: 1.176, Test accuracy: 75.95 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.588, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.640, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.372, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.390, Test accuracy: 71.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.853, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.891, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 80.60 

Final Round, Train loss: 0.002, Test loss: 1.181, Test accuracy: 76.20 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.121, Test accuracy: 77.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.582, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.813, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.371, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.478, Test accuracy: 71.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.200, Test loss: 0.935, Test accuracy: 81.80 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.065, Test accuracy: 79.80 

        train local model (freeze embeding):client   4,  Train loss: 0.798, Train accuracy: 68.000, Test loss: 1.150, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.239, Train accuracy: 92.200, Test loss: 0.898, Test accuracy: 74.40 

Round   0, Train loss: 0.055, Test loss: 1.053, Test accuracy: 76.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.614, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.715, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.311, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.584, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 0.965, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.082, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.446, Train accuracy: 81.600, Test loss: 0.755, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.208, Train accuracy: 93.600, Test loss: 0.877, Test accuracy: 73.60 

Round   1, Train loss: 0.048, Test loss: 1.019, Test accuracy: 77.28 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.555, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.682, Test accuracy: 70.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.804, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.830, Test accuracy: 81.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 85.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.954, Test accuracy: 80.00 

        train local model (freeze embeding):client   4,  Train loss: 0.328, Train accuracy: 87.200, Test loss: 0.717, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.144, Train accuracy: 94.200, Test loss: 0.819, Test accuracy: 74.60 

Round   2, Train loss: 0.033, Test loss: 1.036, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.763, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.304, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 1.693, Test accuracy: 72.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.753, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.961, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.804, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   3,  Train loss: 1.137, Train accuracy: 81.600, Test loss: 3.069, Test accuracy: 64.00 

        train local model (freeze embeding):client   4,  Train loss: 0.205, Train accuracy: 92.800, Test loss: 0.695, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.088, Train accuracy: 97.200, Test loss: 0.802, Test accuracy: 77.80 

Round   3, Train loss: 0.248, Test loss: 1.087, Test accuracy: 75.88 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.602, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.854, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.338, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.796, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.899, Test accuracy: 83.40 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 0.805, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.126, Test accuracy: 78.40 

        train local model (freeze embeding):client   4,  Train loss: 0.171, Train accuracy: 94.800, Test loss: 0.742, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.349, Train accuracy: 87.600, Test loss: 1.209, Test accuracy: 68.20 

Round   4, Train loss: 0.076, Test loss: 1.041, Test accuracy: 77.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.561, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.200, Test loss: 1.909, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.373, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.241, Train accuracy: 93.200, Test loss: 2.485, Test accuracy: 64.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 81.40 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.833, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 80.80 

        train local model (freeze embeding):client   4,  Train loss: 0.118, Train accuracy: 97.000, Test loss: 0.728, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.123, Train accuracy: 95.600, Test loss: 1.020, Test accuracy: 73.20 

Round   5, Train loss: 0.078, Test loss: 0.992, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.960, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 2.080, Test accuracy: 68.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 99.000, Test loss: 1.101, Test accuracy: 80.80 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 0.772, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.869, Test accuracy: 81.20 

        train local model (freeze embeding):client   4,  Train loss: 0.097, Train accuracy: 97.800, Test loss: 0.809, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.477, Train accuracy: 87.800, Test loss: 1.482, Test accuracy: 69.80 

Round   6, Train loss: 0.121, Test loss: 1.103, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.648, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.694, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 84.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.212, Train accuracy: 93.800, Test loss: 1.578, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.059, Test accuracy: 81.40 

        train local model (freeze embeding):client   4,  Train loss: 0.080, Train accuracy: 98.000, Test loss: 0.746, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.234, Train accuracy: 92.000, Test loss: 1.413, Test accuracy: 68.80 

Round   7, Train loss: 0.092, Test loss: 1.074, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.601, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.823, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.477, Test accuracy: 71.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.756, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 81.20 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.051, Train accuracy: 97.400, Test loss: 1.323, Test accuracy: 75.20 

        train local model (freeze embeding):client   4,  Train loss: 0.044, Train accuracy: 99.400, Test loss: 0.708, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.092, Train accuracy: 96.200, Test loss: 0.937, Test accuracy: 76.40 

Round   8, Train loss: 0.030, Test loss: 1.065, Test accuracy: 77.44 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.701, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.400, Test loss: 1.743, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.337, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 83.80 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.745, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 82.40 

        train local model (freeze embeding):client   4,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 0.720, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.212, Train accuracy: 93.000, Test loss: 1.228, Test accuracy: 73.00 

Round   9, Train loss: 0.045, Test loss: 1.063, Test accuracy: 77.84 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.664, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.752, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 1.970, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 0.928, Test accuracy: 82.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 81.40 

        train local model (freeze embeding):client   4,  Train loss: 0.027, Train accuracy: 99.600, Test loss: 0.783, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.072, Train accuracy: 97.800, Test loss: 0.862, Test accuracy: 78.20 

Round  10, Train loss: 0.025, Test loss: 1.031, Test accuracy: 78.24 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.645, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.085, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.326, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.503, Test accuracy: 71.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 82.40 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.791, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.054, Train accuracy: 98.200, Test loss: 1.165, Test accuracy: 78.20 

        train local model (freeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 0.747, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.229, Train accuracy: 92.200, Test loss: 1.237, Test accuracy: 72.00 

Round  11, Train loss: 0.058, Test loss: 1.055, Test accuracy: 78.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.672, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 2.068, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.705, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.772, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 82.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 81.60 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 0.775, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.304, Train accuracy: 92.200, Test loss: 1.591, Test accuracy: 71.80 

Round  12, Train loss: 0.067, Test loss: 1.154, Test accuracy: 77.16 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.648, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.987, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.357, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 2.184, Test accuracy: 64.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.076, Test accuracy: 82.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.096, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 0.788, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.113, Train accuracy: 95.800, Test loss: 1.281, Test accuracy: 74.60 

Round  13, Train loss: 0.045, Test loss: 1.094, Test accuracy: 77.48 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.703, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.053, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.359, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.480, Test accuracy: 71.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 85.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.798, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 0.938, Test accuracy: 80.80 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.078, Train accuracy: 97.800, Test loss: 1.187, Test accuracy: 74.20 

Round  14, Train loss: 0.023, Test loss: 1.087, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.618, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.622, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.770, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 84.80 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.825, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.082, Test accuracy: 81.20 

        train local model (freeze embeding):client   4,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 0.806, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 78.60 

Round  15, Train loss: 0.005, Test loss: 1.056, Test accuracy: 78.32 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.781, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.350, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.398, Test accuracy: 71.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.757, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.600, Test loss: 1.221, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 79.80 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.762, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 0.999, Test accuracy: 78.80 

Round  16, Train loss: 0.012, Test loss: 1.075, Test accuracy: 77.76 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.646, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.807, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 84.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 83.20 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.841, Test accuracy: 79.60 

Round  17, Train loss: 0.003, Test loss: 1.068, Test accuracy: 77.68 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.588, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.665, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.572, Test accuracy: 70.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 85.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.011, Test accuracy: 80.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.823, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.042, Train accuracy: 98.800, Test loss: 1.144, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.824, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.150, Train accuracy: 95.800, Test loss: 1.312, Test accuracy: 73.40 

Round  18, Train loss: 0.041, Test loss: 1.088, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.641, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.811, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.413, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.512, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.801, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.824, Test accuracy: 82.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 83.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.881, Test accuracy: 84.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.795, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.080, Train accuracy: 98.000, Test loss: 1.243, Test accuracy: 76.40 

Round  19, Train loss: 0.017, Test loss: 1.076, Test accuracy: 78.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.609, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.590, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.336, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.387, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.738, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.764, Test accuracy: 85.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.847, Test accuracy: 83.20 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.857, Test accuracy: 77.80 

Final Round, Train loss: 0.002, Test loss: 1.110, Test accuracy: 77.48 

Average accuracy final 10 rounds: 358.4330000000001 

3171.632779598236
[9.477612733840942, 19.296302556991577, 28.742658138275146, 38.5348744392395, 47.63414430618286, 56.91899752616882, 66.73936009407043, 75.91605854034424, 85.66629123687744, 94.87501239776611, 104.25859785079956, 113.35225367546082, 122.5955822467804, 131.66766357421875, 141.243061542511, 150.53008127212524, 159.57024598121643, 168.9639003276825, 177.88242483139038, 186.77836680412292, 192.49816703796387, 202.0011076927185, 211.73946475982666, 220.9214062690735, 230.15087175369263, 239.64039731025696, 249.5045735836029, 259.01771426200867, 268.3437190055847, 277.70202016830444, 286.83099603652954, 296.22009229660034, 306.0948143005371, 315.15428137779236, 324.4790630340576, 334.1272683143616, 343.84235858917236, 353.39481377601624, 362.6496980190277, 371.93839287757874, 381.2953255176544, 387.2227711677551, 396.8995475769043, 406.9350519180298, 416.35190081596375, 426.34328269958496, 436.0482325553894, 445.72836923599243, 455.29231238365173, 465.17572808265686, 474.23561453819275, 483.98560214042664, 493.84150218963623, 503.1166968345642, 512.7958567142487, 521.998774766922, 532.0139107704163, 541.7331278324127, 551.2408990859985, 560.6169710159302, 569.953861951828, 579.6025543212891, 585.9135401248932, 595.7250678539276, 605.3275542259216, 614.7959456443787, 624.4630088806152, 634.3804488182068, 644.3081696033478, 654.2687964439392, 663.6213757991791, 673.2564313411713, 682.9101955890656, 692.2743449211121, 701.5649633407593, 711.0940554141998, 720.723776102066, 730.1587104797363, 739.656539440155, 749.3193216323853, 759.0711140632629, 768.9357335567474, 778.2553956508636, 784.3508939743042, 793.9388604164124, 803.6112422943115, 813.5036671161652, 823.1317729949951, 832.8222126960754, 842.5225217342377, 852.2132558822632, 862.034449338913, 871.0546593666077, 880.4595241546631, 890.0350203514099, 899.513612985611, 909.2750923633575, 919.1178748607635, 928.6781938076019, 938.2802262306213, 947.8354835510254, 957.6480793952942, 967.2962613105774, 977.2983770370483, 983.7819702625275]
[61.6, 59.8, 64.4, 60.0, 60.0, 62.2, 61.0, 64.8, 62.8, 65.0, 61.4, 63.6, 65.6, 65.4, 62.8, 66.4, 60.6, 64.8, 65.4, 62.2, 63.0, 64.8, 67.8, 66.5, 67.7, 68.1, 66.7, 66.1, 67.1, 67.7, 68.5, 67.0, 68.0, 68.8, 67.2, 65.5, 69.0, 67.9, 70.4, 66.8, 69.2, 70.0, 68.33333333333333, 72.33333333333333, 71.4, 72.06666666666666, 73.53333333333333, 70.93333333333334, 71.06666666666666, 71.73333333333333, 71.86666666666666, 71.8, 72.2, 72.06666666666666, 71.86666666666666, 72.66666666666667, 72.06666666666666, 71.8, 71.86666666666666, 72.8, 72.13333333333334, 73.13333333333334, 72.8, 74.65, 74.9, 75.75, 75.5, 76.35, 76.5, 76.3, 75.55, 75.15, 77.15, 76.95, 77.2, 76.3, 76.35, 76.95, 77.0, 76.65, 76.9, 75.8, 75.95, 76.2, 76.2, 77.28, 76.96, 75.88, 77.52, 77.4, 76.96, 76.96, 77.44, 77.84, 78.24, 78.32, 77.16, 77.48, 77.2, 78.32, 77.76, 77.68, 77.4, 78.12, 77.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.436, Test loss: 1.309, Test accuracy: 51.30 

Round   0, Global train loss: 1.436, Global test loss: 1.607, Global test accuracy: 24.10 

Round   1, Train loss: 1.123, Test loss: 1.123, Test accuracy: 57.50 

Round   1, Global train loss: 1.123, Global test loss: 1.762, Global test accuracy: 28.80 

Round   2, Train loss: 0.972, Test loss: 1.306, Test accuracy: 56.20 

Round   2, Global train loss: 0.972, Global test loss: 1.834, Global test accuracy: 26.90 

Round   3, Train loss: 0.820, Test loss: 1.157, Test accuracy: 62.20 

Round   3, Global train loss: 0.820, Global test loss: 1.801, Global test accuracy: 25.30 

Round   4, Train loss: 0.717, Test loss: 1.268, Test accuracy: 61.20 

Round   4, Global train loss: 0.717, Global test loss: 2.066, Global test accuracy: 24.60 

Round   5, Train loss: 0.609, Test loss: 1.216, Test accuracy: 64.70 

Round   5, Global train loss: 0.609, Global test loss: 2.139, Global test accuracy: 21.40 

Round   6, Train loss: 0.531, Test loss: 1.356, Test accuracy: 62.10 

Round   6, Global train loss: 0.531, Global test loss: 2.122, Global test accuracy: 22.50 

Round   7, Train loss: 0.437, Test loss: 1.204, Test accuracy: 62.30 

Round   7, Global train loss: 0.437, Global test loss: 1.988, Global test accuracy: 29.00 

Round   8, Train loss: 0.359, Test loss: 1.252, Test accuracy: 66.50 

Round   8, Global train loss: 0.359, Global test loss: 2.263, Global test accuracy: 23.70 

Round   9, Train loss: 0.300, Test loss: 1.459, Test accuracy: 66.00 

Round   9, Global train loss: 0.300, Global test loss: 2.522, Global test accuracy: 21.70 

Round  10, Train loss: 0.273, Test loss: 1.581, Test accuracy: 63.40 

Round  10, Global train loss: 0.273, Global test loss: 2.208, Global test accuracy: 26.40 

Round  11, Train loss: 0.206, Test loss: 1.550, Test accuracy: 63.70 

Round  11, Global train loss: 0.206, Global test loss: 2.546, Global test accuracy: 23.20 

Round  12, Train loss: 0.205, Test loss: 1.548, Test accuracy: 67.00 

Round  12, Global train loss: 0.205, Global test loss: 2.677, Global test accuracy: 22.80 

Round  13, Train loss: 0.157, Test loss: 1.679, Test accuracy: 64.80 

Round  13, Global train loss: 0.157, Global test loss: 2.976, Global test accuracy: 21.00 

Round  14, Train loss: 0.148, Test loss: 1.426, Test accuracy: 68.40 

Round  14, Global train loss: 0.148, Global test loss: 2.376, Global test accuracy: 24.70 

Round  15, Train loss: 0.103, Test loss: 1.516, Test accuracy: 65.80 

Round  15, Global train loss: 0.103, Global test loss: 2.711, Global test accuracy: 21.90 

Round  16, Train loss: 0.102, Test loss: 1.604, Test accuracy: 66.40 

Round  16, Global train loss: 0.102, Global test loss: 2.519, Global test accuracy: 26.00 

Round  17, Train loss: 0.099, Test loss: 1.646, Test accuracy: 67.20 

Round  17, Global train loss: 0.099, Global test loss: 2.665, Global test accuracy: 23.40 

Round  18, Train loss: 0.126, Test loss: 1.501, Test accuracy: 68.20 

Round  18, Global train loss: 0.126, Global test loss: 3.217, Global test accuracy: 21.90 

Round  19, Train loss: 0.046, Test loss: 1.537, Test accuracy: 70.60 

Round  19, Global train loss: 0.046, Global test loss: 3.249, Global test accuracy: 22.20 

Round  20, Train loss: 0.056, Test loss: 1.632, Test accuracy: 68.20 

Round  20, Global train loss: 0.056, Global test loss: 2.845, Global test accuracy: 22.80 

Round  21, Train loss: 0.068, Test loss: 1.775, Test accuracy: 67.50 

Round  21, Global train loss: 0.068, Global test loss: 3.125, Global test accuracy: 22.40 

Round  22, Train loss: 0.059, Test loss: 1.728, Test accuracy: 67.50 

Round  22, Global train loss: 0.059, Global test loss: 3.219, Global test accuracy: 22.30 

Round  23, Train loss: 0.033, Test loss: 1.782, Test accuracy: 66.10 

Round  23, Global train loss: 0.033, Global test loss: 3.398, Global test accuracy: 21.80 

Round  24, Train loss: 0.057, Test loss: 1.583, Test accuracy: 69.70 

Round  24, Global train loss: 0.057, Global test loss: 2.870, Global test accuracy: 23.20 

Round  25, Train loss: 0.033, Test loss: 1.639, Test accuracy: 68.70 

Round  25, Global train loss: 0.033, Global test loss: 3.123, Global test accuracy: 21.60 

Round  26, Train loss: 0.040, Test loss: 1.575, Test accuracy: 68.00 

Round  26, Global train loss: 0.040, Global test loss: 2.808, Global test accuracy: 21.90 

Round  27, Train loss: 0.031, Test loss: 1.679, Test accuracy: 71.20 

Round  27, Global train loss: 0.031, Global test loss: 2.753, Global test accuracy: 22.30 

Round  28, Train loss: 0.027, Test loss: 1.798, Test accuracy: 68.40 

Round  28, Global train loss: 0.027, Global test loss: 3.128, Global test accuracy: 20.40 

Round  29, Train loss: 0.019, Test loss: 1.739, Test accuracy: 68.50 

Round  29, Global train loss: 0.019, Global test loss: 3.091, Global test accuracy: 21.30 

Round  30, Train loss: 0.018, Test loss: 1.757, Test accuracy: 70.20 

Round  30, Global train loss: 0.018, Global test loss: 2.753, Global test accuracy: 22.60 

Round  31, Train loss: 0.026, Test loss: 1.734, Test accuracy: 69.20 

Round  31, Global train loss: 0.026, Global test loss: 2.739, Global test accuracy: 22.90 

Round  32, Train loss: 0.046, Test loss: 1.816, Test accuracy: 67.80 

Round  32, Global train loss: 0.046, Global test loss: 2.561, Global test accuracy: 24.80 

Round  33, Train loss: 0.049, Test loss: 1.700, Test accuracy: 68.70 

Round  33, Global train loss: 0.049, Global test loss: 2.371, Global test accuracy: 24.40 

Round  34, Train loss: 0.012, Test loss: 1.687, Test accuracy: 69.00 

Round  34, Global train loss: 0.012, Global test loss: 2.618, Global test accuracy: 25.20 

Final Round, Train loss: 0.016, Test loss: 1.734, Test accuracy: 70.80 

Final Round, Global train loss: 0.016, Global test loss: 2.618, Global test accuracy: 25.20 

Average accuracy final 10 rounds: 68.97 

Average global accuracy final 10 rounds: 22.740000000000002 

456.5806829929352
[7.438822507858276, 12.931051969528198, 18.353870391845703, 23.696906566619873, 29.28411316871643, 34.79260969161987, 40.44202518463135, 46.27874970436096, 51.80937314033508, 57.412046909332275, 62.89660954475403, 68.37370467185974, 73.9532208442688, 79.43829321861267, 85.03350758552551, 90.53267812728882, 95.85091972351074, 101.3504991531372, 106.78742384910583, 112.37749552726746, 117.84751152992249, 123.43346190452576, 128.99869346618652, 134.42689633369446, 139.82829999923706, 145.17505955696106, 150.65944385528564, 156.23814845085144, 161.8232765197754, 167.1432056427002, 172.59732747077942, 178.04169154167175, 183.54173612594604, 188.8825376033783, 194.33689332008362, 205.41524529457092]
[51.3, 57.5, 56.2, 62.2, 61.2, 64.7, 62.1, 62.3, 66.5, 66.0, 63.4, 63.7, 67.0, 64.8, 68.4, 65.8, 66.4, 67.2, 68.2, 70.6, 68.2, 67.5, 67.5, 66.1, 69.7, 68.7, 68.0, 71.2, 68.4, 68.5, 70.2, 69.2, 67.8, 68.7, 69.0, 70.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.417, Test loss: 1.096, Test accuracy: 59.10 

Round   0, Global train loss: 1.417, Global test loss: 1.558, Global test accuracy: 33.90 

Round   1, Train loss: 1.222, Test loss: 1.171, Test accuracy: 56.20 

Round   1, Global train loss: 1.222, Global test loss: 1.260, Global test accuracy: 48.70 

Round   2, Train loss: 1.060, Test loss: 1.108, Test accuracy: 58.80 

Round   2, Global train loss: 1.060, Global test loss: 1.124, Global test accuracy: 52.80 

Round   3, Train loss: 0.954, Test loss: 1.179, Test accuracy: 59.20 

Round   3, Global train loss: 0.954, Global test loss: 1.005, Global test accuracy: 60.30 

Round   4, Train loss: 0.845, Test loss: 1.138, Test accuracy: 61.80 

Round   4, Global train loss: 0.845, Global test loss: 1.191, Global test accuracy: 55.40 

Round   5, Train loss: 0.757, Test loss: 1.215, Test accuracy: 58.50 

Round   5, Global train loss: 0.757, Global test loss: 1.132, Global test accuracy: 60.00 

Round   6, Train loss: 0.685, Test loss: 1.049, Test accuracy: 64.30 

Round   6, Global train loss: 0.685, Global test loss: 1.133, Global test accuracy: 62.40 

Round   7, Train loss: 0.589, Test loss: 1.054, Test accuracy: 67.50 

Round   7, Global train loss: 0.589, Global test loss: 1.138, Global test accuracy: 62.10 

Round   8, Train loss: 0.556, Test loss: 1.140, Test accuracy: 67.10 

Round   8, Global train loss: 0.556, Global test loss: 1.134, Global test accuracy: 65.30 

Round   9, Train loss: 0.517, Test loss: 1.221, Test accuracy: 63.10 

Round   9, Global train loss: 0.517, Global test loss: 1.203, Global test accuracy: 62.10 

Round  10, Train loss: 0.420, Test loss: 1.190, Test accuracy: 68.20 

Round  10, Global train loss: 0.420, Global test loss: 1.227, Global test accuracy: 63.00 

Round  11, Train loss: 0.393, Test loss: 1.445, Test accuracy: 63.40 

Round  11, Global train loss: 0.393, Global test loss: 1.350, Global test accuracy: 63.40 

Round  12, Train loss: 0.385, Test loss: 1.139, Test accuracy: 66.70 

Round  12, Global train loss: 0.385, Global test loss: 1.067, Global test accuracy: 65.20 

Round  13, Train loss: 0.320, Test loss: 1.358, Test accuracy: 65.10 

Round  13, Global train loss: 0.320, Global test loss: 1.522, Global test accuracy: 61.20 

Round  14, Train loss: 0.286, Test loss: 1.434, Test accuracy: 66.70 

Round  14, Global train loss: 0.286, Global test loss: 1.518, Global test accuracy: 62.30 

Round  15, Train loss: 0.220, Test loss: 1.394, Test accuracy: 70.60 

Round  15, Global train loss: 0.220, Global test loss: 1.546, Global test accuracy: 62.50 

Round  16, Train loss: 0.227, Test loss: 1.550, Test accuracy: 65.20 

Round  16, Global train loss: 0.227, Global test loss: 1.530, Global test accuracy: 63.20 

Round  17, Train loss: 0.187, Test loss: 1.426, Test accuracy: 67.80 

Round  17, Global train loss: 0.187, Global test loss: 1.448, Global test accuracy: 64.70 

Round  18, Train loss: 0.193, Test loss: 1.582, Test accuracy: 65.80 

Round  18, Global train loss: 0.193, Global test loss: 1.499, Global test accuracy: 63.50 

Round  19, Train loss: 0.154, Test loss: 1.637, Test accuracy: 66.60 

Round  19, Global train loss: 0.154, Global test loss: 1.759, Global test accuracy: 61.80 

Round  20, Train loss: 0.174, Test loss: 1.279, Test accuracy: 69.60 

Round  20, Global train loss: 0.174, Global test loss: 1.462, Global test accuracy: 64.60 

Round  21, Train loss: 0.131, Test loss: 1.403, Test accuracy: 68.90 

Round  21, Global train loss: 0.131, Global test loss: 1.463, Global test accuracy: 65.60 

Round  22, Train loss: 0.144, Test loss: 1.553, Test accuracy: 67.40 

Round  22, Global train loss: 0.144, Global test loss: 1.607, Global test accuracy: 63.50 

Round  23, Train loss: 0.120, Test loss: 1.374, Test accuracy: 71.00 

Round  23, Global train loss: 0.120, Global test loss: 1.502, Global test accuracy: 64.30 

Round  24, Train loss: 0.087, Test loss: 1.515, Test accuracy: 68.40 

Round  24, Global train loss: 0.087, Global test loss: 1.637, Global test accuracy: 64.70 

Round  25, Train loss: 0.066, Test loss: 1.959, Test accuracy: 65.30 

Round  25, Global train loss: 0.066, Global test loss: 1.849, Global test accuracy: 61.90 

Round  26, Train loss: 0.110, Test loss: 1.467, Test accuracy: 70.70 

Round  26, Global train loss: 0.110, Global test loss: 1.621, Global test accuracy: 65.80 

Round  27, Train loss: 0.080, Test loss: 1.459, Test accuracy: 70.50 

Round  27, Global train loss: 0.080, Global test loss: 1.625, Global test accuracy: 66.10 

Round  28, Train loss: 0.095, Test loss: 1.454, Test accuracy: 70.60 

Round  28, Global train loss: 0.095, Global test loss: 1.655, Global test accuracy: 65.30 

Round  29, Train loss: 0.079, Test loss: 1.609, Test accuracy: 67.80 

Round  29, Global train loss: 0.079, Global test loss: 1.619, Global test accuracy: 65.10 

Round  30, Train loss: 0.038, Test loss: 1.353, Test accuracy: 71.40 

Round  30, Global train loss: 0.038, Global test loss: 1.668, Global test accuracy: 66.40 

Round  31, Train loss: 0.063, Test loss: 1.646, Test accuracy: 69.50 

Round  31, Global train loss: 0.063, Global test loss: 1.698, Global test accuracy: 64.70 

Round  32, Train loss: 0.057, Test loss: 1.510, Test accuracy: 70.70 

Round  32, Global train loss: 0.057, Global test loss: 1.775, Global test accuracy: 65.00 

Round  33, Train loss: 0.052, Test loss: 1.732, Test accuracy: 68.20 

Round  33, Global train loss: 0.052, Global test loss: 1.934, Global test accuracy: 63.60 

Round  34, Train loss: 0.040, Test loss: 1.640, Test accuracy: 70.30 

Round  34, Global train loss: 0.040, Global test loss: 1.830, Global test accuracy: 65.50 

Final Round, Train loss: 0.051, Test loss: 1.437, Test accuracy: 71.00 

Final Round, Global train loss: 0.051, Global test loss: 1.830, Global test accuracy: 65.50 

Average accuracy final 10 rounds: 69.5 

Average global accuracy final 10 rounds: 64.94 

457.76811385154724
[7.549494028091431, 12.891143321990967, 18.322761058807373, 23.808173418045044, 29.35124135017395, 34.65877985954285, 40.04274034500122, 45.58151412010193, 51.04835319519043, 56.48178815841675, 61.897366762161255, 67.3962938785553, 72.87567234039307, 78.33479881286621, 83.97765040397644, 89.53866577148438, 95.04221820831299, 100.55037212371826, 106.05603313446045, 111.71886920928955, 117.31616926193237, 122.91185760498047, 128.38661170005798, 134.0107982158661, 139.5094072818756, 145.00061893463135, 150.5714054107666, 156.03318643569946, 161.55830574035645, 167.1631155014038, 172.70923590660095, 178.22469973564148, 183.7522256374359, 189.1669406890869, 194.7838339805603, 205.62390303611755]
[59.1, 56.2, 58.8, 59.2, 61.8, 58.5, 64.3, 67.5, 67.1, 63.1, 68.2, 63.4, 66.7, 65.1, 66.7, 70.6, 65.2, 67.8, 65.8, 66.6, 69.6, 68.9, 67.4, 71.0, 68.4, 65.3, 70.7, 70.5, 70.6, 67.8, 71.4, 69.5, 70.7, 68.2, 70.3, 71.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.561, Test loss: 1.574, Test accuracy: 28.40 

Round   1, Train loss: 1.280, Test loss: 1.403, Test accuracy: 43.00 

Round   2, Train loss: 1.165, Test loss: 1.162, Test accuracy: 51.90 

Round   3, Train loss: 1.077, Test loss: 1.079, Test accuracy: 55.70 

Round   4, Train loss: 0.984, Test loss: 1.272, Test accuracy: 54.80 

Round   5, Train loss: 0.901, Test loss: 1.021, Test accuracy: 62.00 

Round   6, Train loss: 0.860, Test loss: 0.943, Test accuracy: 64.10 

Round   7, Train loss: 0.783, Test loss: 0.977, Test accuracy: 62.20 

Round   8, Train loss: 0.713, Test loss: 0.896, Test accuracy: 64.80 

Round   9, Train loss: 0.662, Test loss: 0.891, Test accuracy: 67.50 

Round  10, Train loss: 0.625, Test loss: 0.910, Test accuracy: 67.60 

Round  11, Train loss: 0.577, Test loss: 0.978, Test accuracy: 65.60 

Round  12, Train loss: 0.538, Test loss: 0.857, Test accuracy: 69.10 

Round  13, Train loss: 0.460, Test loss: 0.882, Test accuracy: 70.60 

Round  14, Train loss: 0.459, Test loss: 0.872, Test accuracy: 71.50 

Round  15, Train loss: 0.414, Test loss: 0.940, Test accuracy: 69.80 

Round  16, Train loss: 0.377, Test loss: 0.904, Test accuracy: 68.60 

Round  17, Train loss: 0.351, Test loss: 0.866, Test accuracy: 71.00 

Round  18, Train loss: 0.313, Test loss: 0.956, Test accuracy: 68.20 

Round  19, Train loss: 0.294, Test loss: 0.930, Test accuracy: 71.60 

Round  20, Train loss: 0.255, Test loss: 0.899, Test accuracy: 73.60 

Round  21, Train loss: 0.240, Test loss: 0.985, Test accuracy: 71.20 

Round  22, Train loss: 0.211, Test loss: 0.974, Test accuracy: 71.70 

Round  23, Train loss: 0.228, Test loss: 0.953, Test accuracy: 72.80 

Round  24, Train loss: 0.180, Test loss: 1.014, Test accuracy: 71.90 

Round  25, Train loss: 0.156, Test loss: 1.051, Test accuracy: 71.90 

Round  26, Train loss: 0.166, Test loss: 1.027, Test accuracy: 71.90 

Round  27, Train loss: 0.148, Test loss: 1.013, Test accuracy: 72.60 

Round  28, Train loss: 0.130, Test loss: 1.007, Test accuracy: 72.20 

Round  29, Train loss: 0.119, Test loss: 0.935, Test accuracy: 75.50 

Round  30, Train loss: 0.107, Test loss: 1.051, Test accuracy: 72.80 

Round  31, Train loss: 0.101, Test loss: 1.106, Test accuracy: 72.00 

Round  32, Train loss: 0.103, Test loss: 1.139, Test accuracy: 70.70 

Round  33, Train loss: 0.110, Test loss: 1.015, Test accuracy: 72.30 

Round  34, Train loss: 0.073, Test loss: 1.137, Test accuracy: 71.80 

Round  35, Train loss: 0.053, Test loss: 1.175, Test accuracy: 72.10 

Round  36, Train loss: 0.062, Test loss: 1.187, Test accuracy: 70.90 

Round  37, Train loss: 0.070, Test loss: 1.130, Test accuracy: 72.30 

Round  38, Train loss: 0.058, Test loss: 1.046, Test accuracy: 72.50 

Round  39, Train loss: 0.056, Test loss: 1.201, Test accuracy: 71.60 

Final Round, Train loss: 0.038, Test loss: 1.197, Test accuracy: 71.30 

Average accuracy final 10 rounds: 71.9 

382.73654437065125
[6.273966073989868, 10.63483738899231, 15.056766271591187, 19.13229465484619, 23.40423893928528, 28.064200162887573, 32.488388538360596, 37.1287055015564, 41.2998251914978, 45.719444036483765, 49.76979446411133, 54.083062410354614, 58.538193702697754, 62.83989071846008, 66.9837532043457, 71.39188265800476, 75.76641488075256, 80.01544380187988, 84.48375511169434, 88.85010170936584, 93.00251579284668, 97.20179772377014, 101.50178599357605, 105.93428444862366, 110.3109917640686, 114.43065237998962, 118.69241237640381, 122.8504707813263, 126.9820008277893, 131.4230432510376, 135.73395466804504, 140.20133233070374, 144.50865960121155, 148.7958948612213, 153.06806182861328, 157.4157657623291, 161.65423488616943, 165.82924485206604, 170.20937275886536, 174.7620551586151, 179.12606024742126]
[28.4, 43.0, 51.9, 55.7, 54.8, 62.0, 64.1, 62.2, 64.8, 67.5, 67.6, 65.6, 69.1, 70.6, 71.5, 69.8, 68.6, 71.0, 68.2, 71.6, 73.6, 71.2, 71.7, 72.8, 71.9, 71.9, 71.9, 72.6, 72.2, 75.5, 72.8, 72.0, 70.7, 72.3, 71.8, 72.1, 70.9, 72.3, 72.5, 71.6, 71.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.566, Test loss: 1.816, Test accuracy: 21.40
Round   1, Train loss: 1.282, Test loss: 1.178, Test accuracy: 51.60
Round   2, Train loss: 1.163, Test loss: 1.125, Test accuracy: 52.50
Round   3, Train loss: 1.055, Test loss: 1.003, Test accuracy: 58.10
Round   4, Train loss: 0.965, Test loss: 1.069, Test accuracy: 57.80
Round   5, Train loss: 0.901, Test loss: 0.968, Test accuracy: 61.10
Round   6, Train loss: 0.824, Test loss: 0.978, Test accuracy: 60.00
Round   7, Train loss: 0.767, Test loss: 0.850, Test accuracy: 67.40
Round   8, Train loss: 0.690, Test loss: 0.862, Test accuracy: 67.50
Round   9, Train loss: 0.644, Test loss: 0.909, Test accuracy: 68.00
Round  10, Train loss: 0.600, Test loss: 0.873, Test accuracy: 68.00
Round  11, Train loss: 0.557, Test loss: 0.897, Test accuracy: 68.60
Round  12, Train loss: 0.497, Test loss: 0.876, Test accuracy: 69.20
Round  13, Train loss: 0.482, Test loss: 0.831, Test accuracy: 71.20
Round  14, Train loss: 0.427, Test loss: 0.853, Test accuracy: 70.30
Round  15, Train loss: 0.384, Test loss: 0.859, Test accuracy: 71.40
Round  16, Train loss: 0.355, Test loss: 0.912, Test accuracy: 70.40
Round  17, Train loss: 0.307, Test loss: 0.946, Test accuracy: 70.80
Round  18, Train loss: 0.295, Test loss: 0.960, Test accuracy: 69.10
Round  19, Train loss: 0.270, Test loss: 1.030, Test accuracy: 68.00
Round  20, Train loss: 0.248, Test loss: 1.059, Test accuracy: 68.20
Round  21, Train loss: 0.246, Test loss: 1.024, Test accuracy: 70.90
Round  22, Train loss: 0.208, Test loss: 0.999, Test accuracy: 71.60
Round  23, Train loss: 0.200, Test loss: 1.018, Test accuracy: 70.60
Round  24, Train loss: 0.182, Test loss: 1.053, Test accuracy: 69.80
Round  25, Train loss: 0.166, Test loss: 1.020, Test accuracy: 71.60
Round  26, Train loss: 0.134, Test loss: 1.038, Test accuracy: 72.30
Round  27, Train loss: 0.146, Test loss: 1.017, Test accuracy: 72.30
Round  28, Train loss: 0.126, Test loss: 1.028, Test accuracy: 71.70
Round  29, Train loss: 0.116, Test loss: 1.122, Test accuracy: 70.30
Round  30, Train loss: 0.116, Test loss: 1.075, Test accuracy: 71.60
Round  31, Train loss: 0.103, Test loss: 1.064, Test accuracy: 72.20
Round  32, Train loss: 0.077, Test loss: 1.160, Test accuracy: 72.00
Round  33, Train loss: 0.085, Test loss: 1.126, Test accuracy: 71.70
Round  34, Train loss: 0.082, Test loss: 1.124, Test accuracy: 72.70
Round  35, Train loss: 0.051, Test loss: 1.115, Test accuracy: 71.90
Round  36, Train loss: 0.064, Test loss: 1.144, Test accuracy: 72.90
Round  37, Train loss: 0.096, Test loss: 1.154, Test accuracy: 72.80
Round  38, Train loss: 0.038, Test loss: 1.168, Test accuracy: 71.80
Round  39, Train loss: 0.039, Test loss: 1.255, Test accuracy: 72.00
Final Round, Train loss: 0.030, Test loss: 1.228, Test accuracy: 72.50
Average accuracy final 10 rounds: 72.16000000000001
437.326189994812
[6.974678993225098, 11.885538101196289, 16.705817461013794, 21.612067699432373, 26.57648754119873, 31.750220775604248, 36.648789167404175, 41.7738242149353, 46.684290409088135, 51.69135499000549, 57.100741386413574, 62.215973138809204, 67.08816695213318, 72.1934404373169, 77.26822113990784, 82.21142220497131, 87.09386372566223, 92.12650966644287, 97.18264389038086, 102.23248720169067, 107.31943845748901, 112.18174862861633, 117.30067038536072, 122.32917881011963, 127.17429327964783, 132.16695475578308, 137.17084407806396, 142.06257677078247, 146.97167491912842, 151.9220471382141, 156.96242380142212, 161.81509399414062, 166.80241012573242, 171.54979801177979, 176.4446074962616, 181.52264499664307, 186.48627376556396, 191.32293725013733, 196.1891384124756, 201.24901413917542, 206.823397397995]
[21.4, 51.6, 52.5, 58.1, 57.8, 61.1, 60.0, 67.4, 67.5, 68.0, 68.0, 68.6, 69.2, 71.2, 70.3, 71.4, 70.4, 70.8, 69.1, 68.0, 68.2, 70.9, 71.6, 70.6, 69.8, 71.6, 72.3, 72.3, 71.7, 70.3, 71.6, 72.2, 72.0, 71.7, 72.7, 71.9, 72.9, 72.8, 71.8, 72.0, 72.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.314, Train accuracy: 87.200, Test loss: 1.056, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.206, Train accuracy: 92.400, Test loss: 1.129, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.250, Train accuracy: 91.000, Test loss: 1.168, Test accuracy: 66.00 

Round   0, Train loss: 0.250, Test loss: 1.168, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.195, Train accuracy: 94.000, Test loss: 1.246, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.230, Train accuracy: 93.000, Test loss: 1.304, Test accuracy: 67.00 

Round   1, Train loss: 0.230, Test loss: 1.304, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.118, Train accuracy: 96.000, Test loss: 1.187, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.370, Train accuracy: 88.200, Test loss: 1.636, Test accuracy: 62.40 

Round   2, Train loss: 0.370, Test loss: 1.636, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.114, Train accuracy: 97.000, Test loss: 1.214, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.369, Train accuracy: 88.000, Test loss: 1.444, Test accuracy: 67.20 

Round   3, Train loss: 0.369, Test loss: 1.444, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.091, Train accuracy: 97.400, Test loss: 1.089, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.154, Train accuracy: 93.000, Test loss: 1.401, Test accuracy: 69.80 

Round   4, Train loss: 0.154, Test loss: 1.401, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.063, Train accuracy: 97.800, Test loss: 1.234, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.216, Train accuracy: 93.200, Test loss: 1.706, Test accuracy: 66.60 

Round   5, Train loss: 0.216, Test loss: 1.706, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.200, Test loss: 1.247, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.295, Test accuracy: 71.40 

Round   6, Train loss: 0.046, Test loss: 1.295, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.288, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 97.400, Test loss: 1.240, Test accuracy: 70.60 

Round   7, Train loss: 0.064, Test loss: 1.240, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.224, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.556, Test accuracy: 72.80 

Round   8, Train loss: 0.030, Test loss: 1.556, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.079, Train accuracy: 97.200, Test loss: 1.803, Test accuracy: 67.20 

Round   9, Train loss: 0.079, Test loss: 1.803, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.444, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.487, Test accuracy: 73.00 

Round  10, Train loss: 0.010, Test loss: 1.487, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.450, Test accuracy: 71.60 

Round  11, Train loss: 0.006, Test loss: 1.450, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.480, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.310, Test accuracy: 72.20 

Round  12, Train loss: 0.017, Test loss: 1.310, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.600, Test loss: 1.499, Test accuracy: 72.80 

Round  13, Train loss: 0.022, Test loss: 1.499, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.463, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.410, Test accuracy: 72.80 

Round  14, Train loss: 0.029, Test loss: 1.410, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.600, Test loss: 1.459, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.573, Test accuracy: 69.20 

Round  15, Train loss: 0.008, Test loss: 1.573, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.516, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.436, Test accuracy: 73.80 

Round  16, Train loss: 0.005, Test loss: 1.436, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.370, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.393, Test accuracy: 72.40 

Round  17, Train loss: 0.016, Test loss: 1.393, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.436, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.447, Test accuracy: 73.00 

Round  18, Train loss: 0.004, Test loss: 1.447, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.406, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 74.20 

Round  19, Train loss: 0.005, Test loss: 1.471, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.418, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.424, Test accuracy: 74.00 

Final Round, Train loss: 0.007, Test loss: 1.417, Test accuracy: 74.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.067, Train accuracy: 97.600, Test loss: 1.420, Test accuracy: 66.40 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.473, Test accuracy: 73.80 

        train local model (freeze embeding):client   1,  Train loss: 1.069, Train accuracy: 53.400, Test loss: 1.237, Test accuracy: 50.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.580, Train accuracy: 77.600, Test loss: 0.987, Test accuracy: 63.20 

Round   0, Train loss: 0.291, Test loss: 1.103, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.800, Test loss: 1.455, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.736, Train accuracy: 70.800, Test loss: 0.951, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.460, Train accuracy: 81.800, Test loss: 0.996, Test accuracy: 63.20 

Round   1, Train loss: 0.247, Test loss: 1.060, Test accuracy: 70.30 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.156, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.435, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.466, Train accuracy: 82.000, Test loss: 0.984, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.314, Train accuracy: 88.200, Test loss: 1.142, Test accuracy: 64.40 

Round   2, Train loss: 0.163, Test loss: 1.060, Test accuracy: 71.90 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.183, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.441, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.308, Train accuracy: 89.000, Test loss: 0.966, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.562, Train accuracy: 79.000, Test loss: 1.684, Test accuracy: 55.00 

Round   3, Train loss: 0.286, Test loss: 1.370, Test accuracy: 66.30 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.233, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.468, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.252, Train accuracy: 91.200, Test loss: 1.086, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.211, Train accuracy: 93.200, Test loss: 1.231, Test accuracy: 70.40 

Round   4, Train loss: 0.111, Test loss: 1.097, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.194, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.167, Train accuracy: 94.800, Test loss: 1.089, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.176, Train accuracy: 93.800, Test loss: 1.298, Test accuracy: 68.60 

Round   5, Train loss: 0.089, Test loss: 1.171, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.588, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.118, Train accuracy: 96.800, Test loss: 1.068, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.178, Train accuracy: 93.200, Test loss: 1.380, Test accuracy: 67.40 

Round   6, Train loss: 0.098, Test loss: 1.259, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.366, Test accuracy: 74.60 

        train local model (freeze embeding):client   1,  Train loss: 0.074, Train accuracy: 98.200, Test loss: 1.220, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.189, Train accuracy: 94.200, Test loss: 1.592, Test accuracy: 64.00 

Round   7, Train loss: 0.099, Test loss: 1.219, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.084, Train accuracy: 98.200, Test loss: 1.143, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.111, Train accuracy: 96.000, Test loss: 1.682, Test accuracy: 63.60 

Round   8, Train loss: 0.058, Test loss: 1.220, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.477, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.058, Train accuracy: 99.000, Test loss: 1.272, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.076, Train accuracy: 98.000, Test loss: 1.591, Test accuracy: 67.80 

Round   9, Train loss: 0.041, Test loss: 1.284, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.222, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.413, Test accuracy: 73.80 

        train local model (freeze embeding):client   1,  Train loss: 0.040, Train accuracy: 99.400, Test loss: 1.267, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.131, Train accuracy: 96.600, Test loss: 1.535, Test accuracy: 65.40 

Round  10, Train loss: 0.068, Test loss: 1.209, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.600, Test loss: 1.238, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.101, Train accuracy: 97.400, Test loss: 1.648, Test accuracy: 66.80 

Round  11, Train loss: 0.051, Test loss: 1.271, Test accuracy: 73.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.252, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.311, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.150, Train accuracy: 94.200, Test loss: 1.708, Test accuracy: 63.80 

Round  12, Train loss: 0.076, Test loss: 1.268, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.800, Test loss: 1.244, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 99.400, Test loss: 1.396, Test accuracy: 69.20 

Round  13, Train loss: 0.017, Test loss: 1.273, Test accuracy: 73.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.274, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.464, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.200, Test loss: 1.579, Test accuracy: 65.60 

Round  14, Train loss: 0.022, Test loss: 1.326, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 67.00 

Round  15, Train loss: 0.005, Test loss: 1.323, Test accuracy: 73.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.203, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.564, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.375, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.062, Train accuracy: 98.000, Test loss: 1.570, Test accuracy: 68.80 

Round  16, Train loss: 0.038, Test loss: 1.344, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.332, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.129, Train accuracy: 96.400, Test loss: 1.775, Test accuracy: 65.00 

Round  17, Train loss: 0.065, Test loss: 1.359, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.537, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.400, Test loss: 1.531, Test accuracy: 68.80 

Round  18, Train loss: 0.021, Test loss: 1.381, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.388, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.395, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.364, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.588, Test accuracy: 68.40 

Round  19, Train loss: 0.009, Test loss: 1.344, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.432, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.463, Test accuracy: 70.80 

Final Round, Train loss: 0.004, Test loss: 1.351, Test accuracy: 72.80 

Average accuracy final 10 rounds: 145.43000000000004 

667.0336329936981
[9.114261865615845, 18.29041576385498, 27.930142402648926, 37.22677755355835, 46.68542194366455, 56.004560470581055, 65.56716322898865, 74.77264666557312, 84.20448517799377, 93.54561281204224, 102.55429935455322, 111.5553503036499, 120.52783250808716, 129.91105008125305, 139.35288214683533, 148.99255537986755, 158.0701925754547, 167.1027615070343, 176.64641737937927, 185.7047998905182, 191.77453446388245, 201.13735103607178, 210.66232705116272, 219.84344100952148, 228.8863434791565, 238.31895112991333, 247.50958490371704, 256.5783939361572, 265.7864878177643, 276.0796151161194, 285.3363711833954, 295.3257269859314, 304.81931471824646, 314.5972068309784, 324.1061518192291, 333.552401304245, 343.5346908569336, 352.6901948451996, 361.98602867126465, 372.14073395729065, 381.38574028015137, 387.23206973075867]
[66.0, 67.0, 62.4, 67.2, 69.8, 66.6, 71.4, 70.6, 72.8, 67.2, 73.0, 71.6, 72.2, 72.8, 72.8, 69.2, 73.8, 72.4, 73.0, 74.2, 74.6, 70.1, 70.3, 71.9, 66.3, 73.4, 70.1, 70.2, 70.1, 71.6, 72.4, 72.0, 73.7, 70.6, 73.9, 73.2, 73.4, 74.3, 72.8, 72.2, 73.2, 72.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.433, Test loss: 1.231, Test accuracy: 52.30 

Round   0, Global train loss: 1.433, Global test loss: 1.684, Global test accuracy: 27.60 

Round   1, Train loss: 1.130, Test loss: 1.183, Test accuracy: 55.50 

Round   1, Global train loss: 1.130, Global test loss: 1.746, Global test accuracy: 29.10 

Round   2, Train loss: 0.945, Test loss: 1.113, Test accuracy: 63.30 

Round   2, Global train loss: 0.945, Global test loss: 1.552, Global test accuracy: 26.80 

Round   3, Train loss: 0.791, Test loss: 1.151, Test accuracy: 60.50 

Round   3, Global train loss: 0.791, Global test loss: 1.825, Global test accuracy: 20.70 

Round   4, Train loss: 0.676, Test loss: 1.071, Test accuracy: 64.40 

Round   4, Global train loss: 0.676, Global test loss: 1.689, Global test accuracy: 23.40 

Round   5, Train loss: 0.570, Test loss: 1.224, Test accuracy: 63.60 

Round   5, Global train loss: 0.570, Global test loss: 2.180, Global test accuracy: 21.00 

Round   6, Train loss: 0.493, Test loss: 2.129, Test accuracy: 57.60 

Round   6, Global train loss: 0.493, Global test loss: 1.798, Global test accuracy: 24.20 

Round   7, Train loss: 0.431, Test loss: 1.162, Test accuracy: 66.80 

Round   7, Global train loss: 0.431, Global test loss: 1.789, Global test accuracy: 20.60 

Round   8, Train loss: 0.331, Test loss: 1.291, Test accuracy: 64.50 

Round   8, Global train loss: 0.331, Global test loss: 2.261, Global test accuracy: 20.00 

Round   9, Train loss: 0.275, Test loss: 1.462, Test accuracy: 65.00 

Round   9, Global train loss: 0.275, Global test loss: 2.129, Global test accuracy: 22.50 

Round  10, Train loss: 0.257, Test loss: 1.663, Test accuracy: 65.20 

Round  10, Global train loss: 0.257, Global test loss: 1.846, Global test accuracy: 26.20 

Round  11, Train loss: 0.207, Test loss: 1.335, Test accuracy: 70.10 

Round  11, Global train loss: 0.207, Global test loss: 2.024, Global test accuracy: 26.80 

Round  12, Train loss: 0.183, Test loss: 1.228, Test accuracy: 72.10 

Round  12, Global train loss: 0.183, Global test loss: 1.874, Global test accuracy: 30.90 

Round  13, Train loss: 0.143, Test loss: 1.483, Test accuracy: 70.00 

Round  13, Global train loss: 0.143, Global test loss: 2.634, Global test accuracy: 20.20 

Round  14, Train loss: 0.115, Test loss: 1.492, Test accuracy: 70.30 

Round  14, Global train loss: 0.115, Global test loss: 1.970, Global test accuracy: 30.80 

Round  15, Train loss: 0.104, Test loss: 1.411, Test accuracy: 71.20 

Round  15, Global train loss: 0.104, Global test loss: 2.339, Global test accuracy: 24.80 

Round  16, Train loss: 0.111, Test loss: 1.456, Test accuracy: 70.70 

Round  16, Global train loss: 0.111, Global test loss: 2.182, Global test accuracy: 27.10 

Round  17, Train loss: 0.087, Test loss: 2.065, Test accuracy: 62.70 

Round  17, Global train loss: 0.087, Global test loss: 2.257, Global test accuracy: 21.10 

Round  18, Train loss: 0.091, Test loss: 1.391, Test accuracy: 71.30 

Round  18, Global train loss: 0.091, Global test loss: 2.052, Global test accuracy: 24.30 

Round  19, Train loss: 0.091, Test loss: 1.365, Test accuracy: 72.00 

Round  19, Global train loss: 0.091, Global test loss: 2.326, Global test accuracy: 25.10 

Round  20, Train loss: 0.069, Test loss: 1.425, Test accuracy: 70.90 

Round  20, Global train loss: 0.069, Global test loss: 1.866, Global test accuracy: 27.70 

Round  21, Train loss: 0.054, Test loss: 1.390, Test accuracy: 72.80 

Round  21, Global train loss: 0.054, Global test loss: 1.827, Global test accuracy: 28.70 

Round  22, Train loss: 0.032, Test loss: 1.252, Test accuracy: 74.20 

Round  22, Global train loss: 0.032, Global test loss: 1.816, Global test accuracy: 31.60 

Round  23, Train loss: 0.042, Test loss: 1.675, Test accuracy: 72.60 

Round  23, Global train loss: 0.042, Global test loss: 2.357, Global test accuracy: 25.80 

Round  24, Train loss: 0.030, Test loss: 1.380, Test accuracy: 73.80 

Round  24, Global train loss: 0.030, Global test loss: 2.276, Global test accuracy: 28.10 

Round  25, Train loss: 0.033, Test loss: 1.443, Test accuracy: 75.40 

Round  25, Global train loss: 0.033, Global test loss: 2.269, Global test accuracy: 26.10 

Round  26, Train loss: 0.049, Test loss: 1.377, Test accuracy: 75.30 

Round  26, Global train loss: 0.049, Global test loss: 2.347, Global test accuracy: 22.90 

Round  27, Train loss: 0.026, Test loss: 1.406, Test accuracy: 73.10 

Round  27, Global train loss: 0.026, Global test loss: 2.117, Global test accuracy: 25.10 

Round  28, Train loss: 0.048, Test loss: 1.757, Test accuracy: 68.80 

Round  28, Global train loss: 0.048, Global test loss: 2.101, Global test accuracy: 24.20 

Round  29, Train loss: 0.037, Test loss: 1.588, Test accuracy: 71.70 

Round  29, Global train loss: 0.037, Global test loss: 2.207, Global test accuracy: 27.40 

Round  30, Train loss: 0.036, Test loss: 1.427, Test accuracy: 73.40 

Round  30, Global train loss: 0.036, Global test loss: 2.216, Global test accuracy: 28.30 

Round  31, Train loss: 0.036, Test loss: 1.447, Test accuracy: 72.10 

Round  31, Global train loss: 0.036, Global test loss: 2.197, Global test accuracy: 25.70 

Round  32, Train loss: 0.012, Test loss: 1.339, Test accuracy: 75.30 

Round  32, Global train loss: 0.012, Global test loss: 1.936, Global test accuracy: 28.50 

Round  33, Train loss: 0.020, Test loss: 1.791, Test accuracy: 70.30 

Round  33, Global train loss: 0.020, Global test loss: 1.935, Global test accuracy: 29.50 

Round  34, Train loss: 0.026, Test loss: 1.314, Test accuracy: 76.50 

Round  34, Global train loss: 0.026, Global test loss: 2.161, Global test accuracy: 27.00 

Final Round, Train loss: 0.010, Test loss: 1.316, Test accuracy: 77.10 

Final Round, Global train loss: 0.010, Global test loss: 2.161, Global test accuracy: 27.00 

Average accuracy final 10 rounds: 73.19000000000001 

Average global accuracy final 10 rounds: 26.47 

458.89981985092163
[7.778977632522583, 13.184356927871704, 18.651286363601685, 23.862459182739258, 29.517528533935547, 34.992849826812744, 40.34932732582092, 45.772992849349976, 51.15921211242676, 56.5579047203064, 62.01858830451965, 67.5199613571167, 73.11360049247742, 78.61853575706482, 84.16327500343323, 89.69636631011963, 95.25123929977417, 100.65321016311646, 106.06437873840332, 111.52278089523315, 117.01799392700195, 122.72917294502258, 128.37480354309082, 133.83940052986145, 139.44497561454773, 144.97622418403625, 150.44801330566406, 155.9632453918457, 161.58667469024658, 167.10554146766663, 172.61908268928528, 178.04102683067322, 183.58234858512878, 189.05788731575012, 194.66177558898926, 205.69277834892273]
[52.3, 55.5, 63.3, 60.5, 64.4, 63.6, 57.6, 66.8, 64.5, 65.0, 65.2, 70.1, 72.1, 70.0, 70.3, 71.2, 70.7, 62.7, 71.3, 72.0, 70.9, 72.8, 74.2, 72.6, 73.8, 75.4, 75.3, 73.1, 68.8, 71.7, 73.4, 72.1, 75.3, 70.3, 76.5, 77.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.430, Test loss: 1.059, Test accuracy: 58.70 

Round   0, Global train loss: 1.430, Global test loss: 1.974, Global test accuracy: 20.50 

Round   1, Train loss: 1.205, Test loss: 1.313, Test accuracy: 55.10 

Round   1, Global train loss: 1.205, Global test loss: 1.524, Global test accuracy: 37.40 

Round   2, Train loss: 1.083, Test loss: 0.983, Test accuracy: 63.10 

Round   2, Global train loss: 1.083, Global test loss: 1.362, Global test accuracy: 43.30 

Round   3, Train loss: 0.977, Test loss: 1.013, Test accuracy: 62.30 

Round   3, Global train loss: 0.977, Global test loss: 1.386, Global test accuracy: 43.90 

Round   4, Train loss: 0.869, Test loss: 1.011, Test accuracy: 63.10 

Round   4, Global train loss: 0.869, Global test loss: 1.340, Global test accuracy: 43.60 

Round   5, Train loss: 0.777, Test loss: 1.094, Test accuracy: 62.70 

Round   5, Global train loss: 0.777, Global test loss: 1.426, Global test accuracy: 45.50 

Round   6, Train loss: 0.706, Test loss: 1.031, Test accuracy: 66.40 

Round   6, Global train loss: 0.706, Global test loss: 1.406, Global test accuracy: 47.50 

Round   7, Train loss: 0.625, Test loss: 1.213, Test accuracy: 62.50 

Round   7, Global train loss: 0.625, Global test loss: 1.387, Global test accuracy: 46.50 

Round   8, Train loss: 0.552, Test loss: 1.186, Test accuracy: 66.80 

Round   8, Global train loss: 0.552, Global test loss: 1.502, Global test accuracy: 47.70 

Round   9, Train loss: 0.506, Test loss: 1.411, Test accuracy: 63.20 

Round   9, Global train loss: 0.506, Global test loss: 1.568, Global test accuracy: 48.20 

Round  10, Train loss: 0.448, Test loss: 1.234, Test accuracy: 65.10 

Round  10, Global train loss: 0.448, Global test loss: 1.734, Global test accuracy: 46.80 

Round  11, Train loss: 0.406, Test loss: 1.399, Test accuracy: 66.20 

Round  11, Global train loss: 0.406, Global test loss: 1.580, Global test accuracy: 49.10 

Round  12, Train loss: 0.371, Test loss: 1.299, Test accuracy: 65.50 

Round  12, Global train loss: 0.371, Global test loss: 1.987, Global test accuracy: 45.60 

Round  13, Train loss: 0.302, Test loss: 1.562, Test accuracy: 63.30 

Round  13, Global train loss: 0.302, Global test loss: 1.833, Global test accuracy: 47.40 

Round  14, Train loss: 0.301, Test loss: 1.525, Test accuracy: 65.10 

Round  14, Global train loss: 0.301, Global test loss: 1.842, Global test accuracy: 45.90 

Round  15, Train loss: 0.251, Test loss: 1.565, Test accuracy: 66.60 

Round  15, Global train loss: 0.251, Global test loss: 1.925, Global test accuracy: 48.90 

Round  16, Train loss: 0.218, Test loss: 1.216, Test accuracy: 71.60 

Round  16, Global train loss: 0.218, Global test loss: 1.836, Global test accuracy: 49.80 

Round  17, Train loss: 0.213, Test loss: 1.369, Test accuracy: 69.40 

Round  17, Global train loss: 0.213, Global test loss: 1.933, Global test accuracy: 49.10 

Round  18, Train loss: 0.186, Test loss: 1.268, Test accuracy: 69.70 

Round  18, Global train loss: 0.186, Global test loss: 2.077, Global test accuracy: 50.00 

Round  19, Train loss: 0.171, Test loss: 1.482, Test accuracy: 69.50 

Round  19, Global train loss: 0.171, Global test loss: 2.210, Global test accuracy: 48.90 

Round  20, Train loss: 0.107, Test loss: 1.403, Test accuracy: 68.90 

Round  20, Global train loss: 0.107, Global test loss: 2.639, Global test accuracy: 46.80 

Round  21, Train loss: 0.136, Test loss: 1.468, Test accuracy: 70.70 

Round  21, Global train loss: 0.136, Global test loss: 2.356, Global test accuracy: 48.50 

Round  22, Train loss: 0.113, Test loss: 1.517, Test accuracy: 69.90 

Round  22, Global train loss: 0.113, Global test loss: 2.259, Global test accuracy: 51.20 

Round  23, Train loss: 0.116, Test loss: 1.366, Test accuracy: 70.90 

Round  23, Global train loss: 0.116, Global test loss: 2.251, Global test accuracy: 48.80 

Round  24, Train loss: 0.111, Test loss: 1.502, Test accuracy: 69.70 

Round  24, Global train loss: 0.111, Global test loss: 2.256, Global test accuracy: 53.30 

Round  25, Train loss: 0.104, Test loss: 1.314, Test accuracy: 71.40 

Round  25, Global train loss: 0.104, Global test loss: 2.151, Global test accuracy: 52.00 

Round  26, Train loss: 0.078, Test loss: 1.549, Test accuracy: 69.80 

Round  26, Global train loss: 0.078, Global test loss: 2.274, Global test accuracy: 51.00 

Round  27, Train loss: 0.092, Test loss: 1.509, Test accuracy: 69.80 

Round  27, Global train loss: 0.092, Global test loss: 2.175, Global test accuracy: 50.90 

Round  28, Train loss: 0.065, Test loss: 1.643, Test accuracy: 69.80 

Round  28, Global train loss: 0.065, Global test loss: 2.719, Global test accuracy: 49.20 

Round  29, Train loss: 0.070, Test loss: 1.789, Test accuracy: 67.80 

Round  29, Global train loss: 0.070, Global test loss: 2.164, Global test accuracy: 52.30 

Round  30, Train loss: 0.077, Test loss: 1.776, Test accuracy: 66.50 

Round  30, Global train loss: 0.077, Global test loss: 2.445, Global test accuracy: 49.20 

Round  31, Train loss: 0.042, Test loss: 1.554, Test accuracy: 69.70 

Round  31, Global train loss: 0.042, Global test loss: 2.567, Global test accuracy: 49.50 

Round  32, Train loss: 0.043, Test loss: 1.635, Test accuracy: 68.10 

Round  32, Global train loss: 0.043, Global test loss: 2.537, Global test accuracy: 50.00 

Round  33, Train loss: 0.048, Test loss: 1.423, Test accuracy: 72.30 

Round  33, Global train loss: 0.048, Global test loss: 2.586, Global test accuracy: 51.90 

Round  34, Train loss: 0.077, Test loss: 1.758, Test accuracy: 69.50 

Round  34, Global train loss: 0.077, Global test loss: 2.361, Global test accuracy: 51.70 

Final Round, Train loss: 0.019, Test loss: 1.379, Test accuracy: 73.20 

Final Round, Global train loss: 0.019, Global test loss: 2.361, Global test accuracy: 51.70 

Average accuracy final 10 rounds: 69.47 

Average global accuracy final 10 rounds: 50.77 

459.5737919807434
[7.707693338394165, 13.108008861541748, 18.509472608566284, 23.989519357681274, 29.50400400161743, 34.961090326309204, 40.519126653671265, 46.06837773323059, 51.57370042800903, 57.038241147994995, 62.48954963684082, 68.08978414535522, 73.56167364120483, 79.02836155891418, 84.53537821769714, 90.13447761535645, 95.50926756858826, 101.05166029930115, 106.58536171913147, 112.02878141403198, 117.67041563987732, 123.16786456108093, 128.67335033416748, 134.0110206604004, 139.78459644317627, 145.16508555412292, 150.76111125946045, 156.3709328174591, 161.9635603427887, 167.40421724319458, 172.90749788284302, 178.48123407363892, 184.0381429195404, 189.68906807899475, 195.10718059539795, 206.09885120391846]
[58.7, 55.1, 63.1, 62.3, 63.1, 62.7, 66.4, 62.5, 66.8, 63.2, 65.1, 66.2, 65.5, 63.3, 65.1, 66.6, 71.6, 69.4, 69.7, 69.5, 68.9, 70.7, 69.9, 70.9, 69.7, 71.4, 69.8, 69.8, 69.8, 67.8, 66.5, 69.7, 68.1, 72.3, 69.5, 73.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.518, Test loss: 1.996, Test accuracy: 24.10 

Round   1, Train loss: 1.305, Test loss: 1.151, Test accuracy: 48.90 

Round   2, Train loss: 1.170, Test loss: 1.113, Test accuracy: 53.70 

Round   3, Train loss: 1.049, Test loss: 1.035, Test accuracy: 59.50 

Round   4, Train loss: 0.945, Test loss: 1.088, Test accuracy: 60.40 

Round   5, Train loss: 0.866, Test loss: 0.983, Test accuracy: 63.30 

Round   6, Train loss: 0.781, Test loss: 0.925, Test accuracy: 66.50 

Round   7, Train loss: 0.717, Test loss: 0.985, Test accuracy: 63.90 

Round   8, Train loss: 0.664, Test loss: 0.818, Test accuracy: 70.70 

Round   9, Train loss: 0.599, Test loss: 0.852, Test accuracy: 69.40 

Round  10, Train loss: 0.550, Test loss: 0.850, Test accuracy: 69.20 

Round  11, Train loss: 0.498, Test loss: 0.971, Test accuracy: 66.90 

Round  12, Train loss: 0.438, Test loss: 0.811, Test accuracy: 71.60 

Round  13, Train loss: 0.389, Test loss: 0.901, Test accuracy: 70.20 

Round  14, Train loss: 0.371, Test loss: 0.974, Test accuracy: 69.20 

Round  15, Train loss: 0.354, Test loss: 0.816, Test accuracy: 72.10 

Round  16, Train loss: 0.310, Test loss: 0.888, Test accuracy: 71.30 

Round  17, Train loss: 0.285, Test loss: 0.887, Test accuracy: 72.70 

Round  18, Train loss: 0.236, Test loss: 0.845, Test accuracy: 73.30 

Round  19, Train loss: 0.231, Test loss: 0.876, Test accuracy: 72.40 

Round  20, Train loss: 0.209, Test loss: 0.872, Test accuracy: 74.60 

Round  21, Train loss: 0.177, Test loss: 0.870, Test accuracy: 73.40 

Round  22, Train loss: 0.171, Test loss: 0.897, Test accuracy: 73.90 

Round  23, Train loss: 0.164, Test loss: 0.970, Test accuracy: 72.50 

Round  24, Train loss: 0.142, Test loss: 0.946, Test accuracy: 73.30 

Round  25, Train loss: 0.142, Test loss: 0.871, Test accuracy: 75.40 

Round  26, Train loss: 0.109, Test loss: 0.986, Test accuracy: 72.90 

Round  27, Train loss: 0.107, Test loss: 1.071, Test accuracy: 71.90 

Round  28, Train loss: 0.129, Test loss: 0.979, Test accuracy: 73.60 

Round  29, Train loss: 0.083, Test loss: 1.035, Test accuracy: 72.20 

Round  30, Train loss: 0.068, Test loss: 1.019, Test accuracy: 73.90 

Round  31, Train loss: 0.083, Test loss: 0.948, Test accuracy: 73.40 

Round  32, Train loss: 0.075, Test loss: 1.096, Test accuracy: 71.30 

Round  33, Train loss: 0.077, Test loss: 1.043, Test accuracy: 72.90 

Round  34, Train loss: 0.059, Test loss: 1.018, Test accuracy: 74.70 

Round  35, Train loss: 0.045, Test loss: 1.019, Test accuracy: 74.00 

Round  36, Train loss: 0.057, Test loss: 1.012, Test accuracy: 74.80 

Round  37, Train loss: 0.053, Test loss: 1.100, Test accuracy: 73.20 

Round  38, Train loss: 0.036, Test loss: 1.093, Test accuracy: 74.80 

Round  39, Train loss: 0.063, Test loss: 1.043, Test accuracy: 74.80 

Final Round, Train loss: 0.044, Test loss: 1.077, Test accuracy: 74.70 

Average accuracy final 10 rounds: 73.78 

383.5017569065094
[6.174675703048706, 10.5180983543396, 14.917672157287598, 19.299474716186523, 23.497754335403442, 27.968842267990112, 32.33812189102173, 36.66769099235535, 40.94115734100342, 45.32418346405029, 49.492982387542725, 53.900237798690796, 58.3321053981781, 62.64786410331726, 67.17420649528503, 71.42391180992126, 75.82111644744873, 80.03614687919617, 84.34075975418091, 88.39949417114258, 92.80061149597168, 96.98876881599426, 101.15003967285156, 105.52789831161499, 109.66665744781494, 113.92144250869751, 118.10125613212585, 122.47488975524902, 126.86498832702637, 131.21083784103394, 135.927508354187, 140.54788160324097, 145.01575756072998, 149.3531334400177, 153.79250383377075, 158.36734533309937, 162.50325536727905, 166.7720115184784, 170.94249510765076, 175.35113096237183, 180.06143522262573]
[24.1, 48.9, 53.7, 59.5, 60.4, 63.3, 66.5, 63.9, 70.7, 69.4, 69.2, 66.9, 71.6, 70.2, 69.2, 72.1, 71.3, 72.7, 73.3, 72.4, 74.6, 73.4, 73.9, 72.5, 73.3, 75.4, 72.9, 71.9, 73.6, 72.2, 73.9, 73.4, 71.3, 72.9, 74.7, 74.0, 74.8, 73.2, 74.8, 74.8, 74.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.524, Test loss: 1.691, Test accuracy: 32.20
Round   1, Train loss: 1.282, Test loss: 1.295, Test accuracy: 43.50
Round   2, Train loss: 1.122, Test loss: 0.980, Test accuracy: 61.70
Round   3, Train loss: 0.997, Test loss: 0.921, Test accuracy: 64.70
Round   4, Train loss: 0.935, Test loss: 0.952, Test accuracy: 62.10
Round   5, Train loss: 0.835, Test loss: 0.850, Test accuracy: 65.20
Round   6, Train loss: 0.755, Test loss: 0.872, Test accuracy: 65.70
Round   7, Train loss: 0.720, Test loss: 0.839, Test accuracy: 67.40
Round   8, Train loss: 0.650, Test loss: 0.772, Test accuracy: 70.60
Round   9, Train loss: 0.563, Test loss: 0.806, Test accuracy: 70.40
Round  10, Train loss: 0.550, Test loss: 0.799, Test accuracy: 70.70
Round  11, Train loss: 0.491, Test loss: 0.764, Test accuracy: 72.50
Round  12, Train loss: 0.448, Test loss: 0.831, Test accuracy: 70.80
Round  13, Train loss: 0.408, Test loss: 0.814, Test accuracy: 72.40
Round  14, Train loss: 0.386, Test loss: 0.808, Test accuracy: 72.80
Round  15, Train loss: 0.351, Test loss: 0.831, Test accuracy: 72.70
Round  16, Train loss: 0.290, Test loss: 0.821, Test accuracy: 73.40
Round  17, Train loss: 0.271, Test loss: 0.838, Test accuracy: 71.40
Round  18, Train loss: 0.248, Test loss: 0.800, Test accuracy: 72.60
Round  19, Train loss: 0.235, Test loss: 0.822, Test accuracy: 73.90
Round  20, Train loss: 0.210, Test loss: 0.781, Test accuracy: 75.00
Round  21, Train loss: 0.153, Test loss: 0.866, Test accuracy: 74.00
Round  22, Train loss: 0.174, Test loss: 0.875, Test accuracy: 73.90
Round  23, Train loss: 0.165, Test loss: 0.866, Test accuracy: 74.90
Round  24, Train loss: 0.153, Test loss: 0.853, Test accuracy: 74.30
Round  25, Train loss: 0.150, Test loss: 0.854, Test accuracy: 75.10
Round  26, Train loss: 0.110, Test loss: 0.924, Test accuracy: 74.40
Round  27, Train loss: 0.093, Test loss: 0.911, Test accuracy: 75.10
Round  28, Train loss: 0.096, Test loss: 0.956, Test accuracy: 75.20
Round  29, Train loss: 0.099, Test loss: 0.944, Test accuracy: 73.80
Round  30, Train loss: 0.085, Test loss: 0.962, Test accuracy: 73.70
Round  31, Train loss: 0.070, Test loss: 0.960, Test accuracy: 74.40
Round  32, Train loss: 0.053, Test loss: 0.968, Test accuracy: 75.80
Round  33, Train loss: 0.058, Test loss: 1.040, Test accuracy: 73.70
Round  34, Train loss: 0.055, Test loss: 1.016, Test accuracy: 75.00
Round  35, Train loss: 0.051, Test loss: 0.972, Test accuracy: 74.80
Round  36, Train loss: 0.036, Test loss: 1.072, Test accuracy: 74.60
Round  37, Train loss: 0.069, Test loss: 1.008, Test accuracy: 75.70
Round  38, Train loss: 0.039, Test loss: 1.008, Test accuracy: 75.60
Round  39, Train loss: 0.043, Test loss: 1.025, Test accuracy: 77.00
Final Round, Train loss: 0.021, Test loss: 1.064, Test accuracy: 75.90
Average accuracy final 10 rounds: 75.03
430.87442541122437
[6.943729639053345, 12.029512643814087, 16.845805644989014, 21.616405963897705, 26.660611391067505, 31.376139640808105, 36.24267578125, 41.17013192176819, 46.25177502632141, 51.147074460983276, 56.0105881690979, 60.75513696670532, 65.62354850769043, 70.55250716209412, 75.49784421920776, 80.22319412231445, 84.99900913238525, 89.9535322189331, 94.97044110298157, 99.88997650146484, 104.97422933578491, 109.9977478981018, 115.06439208984375, 120.10848331451416, 124.99985790252686, 129.9959557056427, 134.79004955291748, 139.78689002990723, 144.61413407325745, 149.41739749908447, 154.37083435058594, 159.24696946144104, 164.1288628578186, 169.18132138252258, 173.955482006073, 178.77235198020935, 183.89056158065796, 188.98011350631714, 193.8792564868927, 198.94859099388123, 204.0545084476471]
[32.2, 43.5, 61.7, 64.7, 62.1, 65.2, 65.7, 67.4, 70.6, 70.4, 70.7, 72.5, 70.8, 72.4, 72.8, 72.7, 73.4, 71.4, 72.6, 73.9, 75.0, 74.0, 73.9, 74.9, 74.3, 75.1, 74.4, 75.1, 75.2, 73.8, 73.7, 74.4, 75.8, 73.7, 75.0, 74.8, 74.6, 75.7, 75.6, 77.0, 75.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.471, Train accuracy: 82.600, Test loss: 1.109, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.266, Train accuracy: 91.800, Test loss: 0.974, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.221, Train accuracy: 90.800, Test loss: 1.137, Test accuracy: 68.00 

Round   0, Train loss: 0.221, Test loss: 1.137, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.191, Train accuracy: 92.800, Test loss: 1.130, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.263, Train accuracy: 90.400, Test loss: 1.347, Test accuracy: 66.00 

Round   1, Train loss: 0.263, Test loss: 1.347, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.198, Train accuracy: 93.000, Test loss: 1.198, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.338, Train accuracy: 86.800, Test loss: 1.854, Test accuracy: 61.40 

Round   2, Train loss: 0.338, Test loss: 1.854, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.144, Train accuracy: 94.600, Test loss: 1.320, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.299, Train accuracy: 89.800, Test loss: 1.635, Test accuracy: 58.00 

Round   3, Train loss: 0.299, Test loss: 1.635, Test accuracy: 58.00 

        train local model (freeze embeding):client   0,  Train loss: 0.112, Train accuracy: 96.000, Test loss: 1.248, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.204, Train accuracy: 93.200, Test loss: 1.643, Test accuracy: 62.80 

Round   4, Train loss: 0.204, Test loss: 1.643, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.083, Train accuracy: 96.800, Test loss: 1.475, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.077, Train accuracy: 97.600, Test loss: 1.347, Test accuracy: 67.80 

Round   5, Train loss: 0.077, Test loss: 1.347, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.800, Test loss: 1.302, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.141, Train accuracy: 95.200, Test loss: 1.856, Test accuracy: 64.00 

Round   6, Train loss: 0.141, Test loss: 1.856, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.200, Test loss: 1.452, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.071, Train accuracy: 97.600, Test loss: 1.669, Test accuracy: 66.60 

Round   7, Train loss: 0.071, Test loss: 1.669, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.533, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.059, Train accuracy: 98.400, Test loss: 1.455, Test accuracy: 69.40 

Round   8, Train loss: 0.059, Test loss: 1.455, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.053, Train accuracy: 97.800, Test loss: 1.450, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.068, Train accuracy: 97.800, Test loss: 1.709, Test accuracy: 68.00 

Round   9, Train loss: 0.068, Test loss: 1.709, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.617, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.725, Test accuracy: 67.00 

Round  10, Train loss: 0.030, Test loss: 1.725, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.633, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.053, Train accuracy: 98.400, Test loss: 1.921, Test accuracy: 65.60 

Round  11, Train loss: 0.053, Test loss: 1.921, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.776, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.566, Test accuracy: 69.60 

Round  12, Train loss: 0.009, Test loss: 1.566, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.561, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.682, Test accuracy: 69.00 

Round  13, Train loss: 0.011, Test loss: 1.682, Test accuracy: 69.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.656, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.600, Test loss: 1.895, Test accuracy: 65.20 

Round  14, Train loss: 0.029, Test loss: 1.895, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.726, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 68.80 

Round  15, Train loss: 0.007, Test loss: 1.825, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.740, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.651, Test accuracy: 69.80 

Round  16, Train loss: 0.006, Test loss: 1.651, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.654, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.674, Test accuracy: 69.40 

Round  17, Train loss: 0.006, Test loss: 1.674, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.706, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.852, Test accuracy: 70.80 

Round  18, Train loss: 0.003, Test loss: 1.852, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.811, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.825, Test accuracy: 69.60 

Round  19, Train loss: 0.005, Test loss: 1.825, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.790, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.775, Test accuracy: 69.00 

Final Round, Train loss: 0.004, Test loss: 1.790, Test accuracy: 69.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.177, Train accuracy: 95.200, Test loss: 1.337, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.815, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.885, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 1.081, Train accuracy: 55.600, Test loss: 1.203, Test accuracy: 53.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.524, Train accuracy: 82.000, Test loss: 1.075, Test accuracy: 67.40 

Round   0, Train loss: 0.267, Test loss: 1.301, Test accuracy: 68.30 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.519, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.727, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.568, Train accuracy: 76.400, Test loss: 0.950, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.252, Train accuracy: 90.600, Test loss: 0.856, Test accuracy: 71.40 

Round   1, Train loss: 0.128, Test loss: 1.170, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.523, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.573, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.325, Train accuracy: 88.400, Test loss: 0.923, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.369, Train accuracy: 86.200, Test loss: 1.410, Test accuracy: 64.60 

Round   2, Train loss: 0.192, Test loss: 1.288, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.470, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 1.829, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.226, Train accuracy: 92.000, Test loss: 1.088, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.174, Train accuracy: 94.000, Test loss: 1.132, Test accuracy: 71.40 

Round   3, Train loss: 0.096, Test loss: 1.242, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.732, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.127, Train accuracy: 96.600, Test loss: 0.968, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.314, Train accuracy: 87.200, Test loss: 1.473, Test accuracy: 64.80 

Round   4, Train loss: 0.162, Test loss: 1.232, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.507, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 1.725, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.111, Train accuracy: 97.200, Test loss: 0.961, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.170, Train accuracy: 93.200, Test loss: 1.055, Test accuracy: 71.80 

Round   5, Train loss: 0.091, Test loss: 1.318, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.603, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.061, Train accuracy: 98.800, Test loss: 0.944, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.257, Train accuracy: 92.200, Test loss: 1.636, Test accuracy: 68.00 

Round   6, Train loss: 0.133, Test loss: 1.382, Test accuracy: 70.10 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.473, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 98.800, Test loss: 1.836, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.059, Train accuracy: 98.400, Test loss: 1.002, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.098, Train accuracy: 96.800, Test loss: 1.393, Test accuracy: 71.60 

Round   7, Train loss: 0.065, Test loss: 1.364, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.334, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.726, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.050, Train accuracy: 99.200, Test loss: 1.122, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.102, Train accuracy: 97.400, Test loss: 1.355, Test accuracy: 71.20 

Round   8, Train loss: 0.057, Test loss: 1.251, Test accuracy: 72.10 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.395, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.713, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.800, Test loss: 1.118, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.181, Train accuracy: 95.400, Test loss: 1.461, Test accuracy: 69.00 

Round   9, Train loss: 0.098, Test loss: 1.304, Test accuracy: 73.10 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.530, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.800, Test loss: 1.094, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 98.000, Test loss: 1.127, Test accuracy: 73.00 

Round  10, Train loss: 0.035, Test loss: 1.229, Test accuracy: 72.90 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.482, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.624, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.097, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.072, Train accuracy: 97.800, Test loss: 1.663, Test accuracy: 69.60 

Round  11, Train loss: 0.037, Test loss: 1.414, Test accuracy: 72.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.542, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.621, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.238, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.203, Train accuracy: 92.400, Test loss: 1.452, Test accuracy: 69.80 

Round  12, Train loss: 0.107, Test loss: 1.299, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.397, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.200, Test loss: 1.595, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.178, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.494, Train accuracy: 85.000, Test loss: 2.192, Test accuracy: 60.80 

Round  13, Train loss: 0.255, Test loss: 1.394, Test accuracy: 72.10 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.492, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.954, Test accuracy: 70.40 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.265, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 98.800, Test loss: 1.357, Test accuracy: 71.00 

Round  14, Train loss: 0.034, Test loss: 1.409, Test accuracy: 73.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.524, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.726, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.236, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.600, Test loss: 1.268, Test accuracy: 69.40 

Round  15, Train loss: 0.020, Test loss: 1.370, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.414, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.557, Test accuracy: 70.80 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.263, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.165, Train accuracy: 94.000, Test loss: 1.677, Test accuracy: 66.20 

Round  16, Train loss: 0.083, Test loss: 1.430, Test accuracy: 70.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.458, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.562, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.200, Test loss: 1.550, Test accuracy: 69.20 

Round  17, Train loss: 0.026, Test loss: 1.397, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.567, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.588, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.254, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 76.20 

Round  18, Train loss: 0.003, Test loss: 1.376, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.535, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.601, Train accuracy: 88.200, Test loss: 2.452, Test accuracy: 60.80 

Round  19, Train loss: 0.302, Test loss: 1.614, Test accuracy: 69.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.533, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.632, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.301, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.291, Test accuracy: 72.40 

Final Round, Train loss: 0.005, Test loss: 1.573, Test accuracy: 70.10 

Average accuracy final 10 rounds: 140.43 

665.0691647529602
[9.348454713821411, 18.593499422073364, 27.916083097457886, 37.04171657562256, 46.43348264694214, 55.33295917510986, 64.81998443603516, 74.24066424369812, 83.76349520683289, 92.88395714759827, 101.97163414955139, 111.38914394378662, 120.85314989089966, 130.78574419021606, 139.75988101959229, 148.76401567459106, 157.6762809753418, 167.2384045124054, 176.47841334342957, 185.77269387245178, 191.79935765266418, 201.45235466957092, 210.64485621452332, 219.8083198070526, 229.0166096687317, 238.80478835105896, 248.33814096450806, 257.97823882102966, 267.6360373497009, 277.02741408348083, 286.1977880001068, 295.57182097435, 305.2384400367737, 314.5277638435364, 324.2045543193817, 333.7837975025177, 342.9302957057953, 353.00103092193604, 362.3906228542328, 371.2066082954407, 380.4261872768402, 386.6600341796875]
[68.0, 66.0, 61.4, 58.0, 62.8, 67.8, 64.0, 66.6, 69.4, 68.0, 67.0, 65.6, 69.6, 69.0, 65.2, 68.8, 69.8, 69.4, 70.8, 69.6, 69.6, 68.3, 72.0, 70.5, 71.2, 70.1, 70.6, 70.1, 72.5, 72.1, 73.1, 72.9, 72.1, 73.0, 72.1, 73.1, 71.1, 70.9, 72.0, 72.4, 69.9, 70.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.648, Test loss: 0.623, Test accuracy: 76.90 

Round   0, Global train loss: 0.648, Global test loss: 0.755, Global test accuracy: 50.10 

Round   1, Train loss: 0.512, Test loss: 0.602, Test accuracy: 77.70 

Round   1, Global train loss: 0.512, Global test loss: 0.755, Global test accuracy: 50.10 

Round   2, Train loss: 0.371, Test loss: 0.794, Test accuracy: 75.20 

Round   2, Global train loss: 0.371, Global test loss: 0.838, Global test accuracy: 50.00 

Round   3, Train loss: 0.327, Test loss: 0.962, Test accuracy: 74.90 

Round   3, Global train loss: 0.327, Global test loss: 0.743, Global test accuracy: 50.00 

Round   4, Train loss: 0.290, Test loss: 0.578, Test accuracy: 81.00 

Round   4, Global train loss: 0.290, Global test loss: 0.873, Global test accuracy: 50.00 

Round   5, Train loss: 0.249, Test loss: 0.845, Test accuracy: 78.80 

Round   5, Global train loss: 0.249, Global test loss: 0.821, Global test accuracy: 50.00 

Round   6, Train loss: 0.219, Test loss: 0.697, Test accuracy: 78.40 

Round   6, Global train loss: 0.219, Global test loss: 0.775, Global test accuracy: 50.00 

Round   7, Train loss: 0.196, Test loss: 0.917, Test accuracy: 78.50 

Round   7, Global train loss: 0.196, Global test loss: 0.855, Global test accuracy: 50.00 

Round   8, Train loss: 0.185, Test loss: 0.610, Test accuracy: 82.20 

Round   8, Global train loss: 0.185, Global test loss: 0.837, Global test accuracy: 50.00 

Round   9, Train loss: 0.149, Test loss: 0.797, Test accuracy: 80.00 

Round   9, Global train loss: 0.149, Global test loss: 0.837, Global test accuracy: 50.00 

Round  10, Train loss: 0.131, Test loss: 0.766, Test accuracy: 81.80 

Round  10, Global train loss: 0.131, Global test loss: 0.837, Global test accuracy: 50.00 

Round  11, Train loss: 0.113, Test loss: 0.680, Test accuracy: 82.60 

Round  11, Global train loss: 0.113, Global test loss: 0.805, Global test accuracy: 50.00 

Round  12, Train loss: 0.115, Test loss: 0.680, Test accuracy: 82.60 

Round  12, Global train loss: 0.115, Global test loss: 0.800, Global test accuracy: 50.00 

Round  13, Train loss: 0.069, Test loss: 0.785, Test accuracy: 83.30 

Round  13, Global train loss: 0.069, Global test loss: 0.815, Global test accuracy: 50.00 

Round  14, Train loss: 0.075, Test loss: 0.722, Test accuracy: 83.00 

Round  14, Global train loss: 0.075, Global test loss: 0.906, Global test accuracy: 50.00 

Round  15, Train loss: 0.066, Test loss: 0.801, Test accuracy: 83.60 

Round  15, Global train loss: 0.066, Global test loss: 0.913, Global test accuracy: 50.00 

Round  16, Train loss: 0.071, Test loss: 0.758, Test accuracy: 81.60 

Round  16, Global train loss: 0.071, Global test loss: 0.852, Global test accuracy: 50.00 

Round  17, Train loss: 0.070, Test loss: 0.884, Test accuracy: 81.70 

Round  17, Global train loss: 0.070, Global test loss: 0.894, Global test accuracy: 50.00 

Round  18, Train loss: 0.059, Test loss: 0.856, Test accuracy: 82.20 

Round  18, Global train loss: 0.059, Global test loss: 0.891, Global test accuracy: 50.00 

Round  19, Train loss: 0.045, Test loss: 0.744, Test accuracy: 82.90 

Round  19, Global train loss: 0.045, Global test loss: 0.884, Global test accuracy: 50.00 

Round  20, Train loss: 0.026, Test loss: 0.845, Test accuracy: 84.00 

Round  20, Global train loss: 0.026, Global test loss: 0.971, Global test accuracy: 50.00 

Round  21, Train loss: 0.045, Test loss: 0.805, Test accuracy: 82.50 

Round  21, Global train loss: 0.045, Global test loss: 0.903, Global test accuracy: 50.00 

Round  22, Train loss: 0.026, Test loss: 0.755, Test accuracy: 83.30 

Round  22, Global train loss: 0.026, Global test loss: 0.876, Global test accuracy: 50.00 

Round  23, Train loss: 0.026, Test loss: 0.890, Test accuracy: 83.30 

Round  23, Global train loss: 0.026, Global test loss: 0.887, Global test accuracy: 50.00 

Round  24, Train loss: 0.017, Test loss: 0.886, Test accuracy: 84.10 

Round  24, Global train loss: 0.017, Global test loss: 0.931, Global test accuracy: 50.00 

Round  25, Train loss: 0.035, Test loss: 0.870, Test accuracy: 83.80 

Round  25, Global train loss: 0.035, Global test loss: 0.880, Global test accuracy: 50.00 

Round  26, Train loss: 0.036, Test loss: 0.784, Test accuracy: 82.20 

Round  26, Global train loss: 0.036, Global test loss: 0.933, Global test accuracy: 50.00 

Round  27, Train loss: 0.046, Test loss: 0.803, Test accuracy: 81.80 

Round  27, Global train loss: 0.046, Global test loss: 0.896, Global test accuracy: 50.00 

Round  28, Train loss: 0.023, Test loss: 0.836, Test accuracy: 83.20 

Round  28, Global train loss: 0.023, Global test loss: 0.964, Global test accuracy: 50.00 

Round  29, Train loss: 0.031, Test loss: 0.786, Test accuracy: 83.40 

Round  29, Global train loss: 0.031, Global test loss: 0.924, Global test accuracy: 50.00 

Round  30, Train loss: 0.021, Test loss: 0.966, Test accuracy: 82.20 

Round  30, Global train loss: 0.021, Global test loss: 0.989, Global test accuracy: 50.00 

Round  31, Train loss: 0.034, Test loss: 0.837, Test accuracy: 83.40 

Round  31, Global train loss: 0.034, Global test loss: 1.026, Global test accuracy: 50.00 

Round  32, Train loss: 0.012, Test loss: 0.795, Test accuracy: 82.80 

Round  32, Global train loss: 0.012, Global test loss: 0.979, Global test accuracy: 50.00 

Round  33, Train loss: 0.031, Test loss: 0.854, Test accuracy: 83.00 

Round  33, Global train loss: 0.031, Global test loss: 0.981, Global test accuracy: 50.00 

Round  34, Train loss: 0.019, Test loss: 0.840, Test accuracy: 83.30 

Round  34, Global train loss: 0.019, Global test loss: 0.989, Global test accuracy: 50.00 

Final Round, Train loss: 0.015, Test loss: 0.880, Test accuracy: 81.90 

Final Round, Global train loss: 0.015, Global test loss: 0.989, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 82.91 

Average global accuracy final 10 rounds: 50.0 

458.2191867828369
[4.255932569503784, 6.463922023773193, 8.891438245773315, 11.075977087020874, 13.253557443618774, 15.485416889190674, 17.66597867012024, 19.849777460098267, 22.28401207923889, 24.584124326705933, 26.830788612365723, 29.212732315063477, 31.421428203582764, 33.682295083999634, 35.950257301330566, 38.191434144973755, 40.44947361946106, 42.68129634857178, 44.953028202056885, 47.17482233047485, 49.39223265647888, 51.61623573303223, 53.82622504234314, 56.049691915512085, 58.28449249267578, 60.49384546279907, 62.738083362579346, 65.0556173324585, 67.26909065246582, 69.50893807411194, 71.73403930664062, 73.93263101577759, 76.16031217575073, 78.3744010925293, 80.58844900131226, 84.9690580368042]
[76.9, 77.7, 75.2, 74.9, 81.0, 78.8, 78.4, 78.5, 82.2, 80.0, 81.8, 82.6, 82.6, 83.3, 83.0, 83.6, 81.6, 81.7, 82.2, 82.9, 84.0, 82.5, 83.3, 83.3, 84.1, 83.8, 82.2, 81.8, 83.2, 83.4, 82.2, 83.4, 82.8, 83.0, 83.3, 81.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.635, Test loss: 0.648, Test accuracy: 75.70 

Round   0, Global train loss: 0.635, Global test loss: 0.734, Global test accuracy: 50.40 

Round   1, Train loss: 0.595, Test loss: 0.576, Test accuracy: 76.70 

Round   1, Global train loss: 0.595, Global test loss: 0.666, Global test accuracy: 59.40 

Round   2, Train loss: 0.510, Test loss: 0.773, Test accuracy: 75.40 

Round   2, Global train loss: 0.510, Global test loss: 0.822, Global test accuracy: 58.00 

Round   3, Train loss: 0.482, Test loss: 0.598, Test accuracy: 75.70 

Round   3, Global train loss: 0.482, Global test loss: 0.690, Global test accuracy: 64.10 

Round   4, Train loss: 0.466, Test loss: 0.618, Test accuracy: 79.40 

Round   4, Global train loss: 0.466, Global test loss: 0.687, Global test accuracy: 63.80 

Round   5, Train loss: 0.439, Test loss: 0.998, Test accuracy: 71.00 

Round   5, Global train loss: 0.439, Global test loss: 0.779, Global test accuracy: 60.10 

Round   6, Train loss: 0.402, Test loss: 0.687, Test accuracy: 76.50 

Round   6, Global train loss: 0.402, Global test loss: 0.685, Global test accuracy: 64.80 

Round   7, Train loss: 0.393, Test loss: 0.766, Test accuracy: 73.50 

Round   7, Global train loss: 0.393, Global test loss: 0.783, Global test accuracy: 58.70 

Round   8, Train loss: 0.354, Test loss: 0.624, Test accuracy: 78.10 

Round   8, Global train loss: 0.354, Global test loss: 0.768, Global test accuracy: 60.00 

Round   9, Train loss: 0.356, Test loss: 0.981, Test accuracy: 75.40 

Round   9, Global train loss: 0.356, Global test loss: 0.822, Global test accuracy: 58.90 

Round  10, Train loss: 0.334, Test loss: 0.677, Test accuracy: 73.40 

Round  10, Global train loss: 0.334, Global test loss: 1.021, Global test accuracy: 53.90 

Round  11, Train loss: 0.295, Test loss: 0.612, Test accuracy: 80.30 

Round  11, Global train loss: 0.295, Global test loss: 0.871, Global test accuracy: 62.90 

Round  12, Train loss: 0.294, Test loss: 0.576, Test accuracy: 81.00 

Round  12, Global train loss: 0.294, Global test loss: 0.885, Global test accuracy: 59.30 

Round  13, Train loss: 0.281, Test loss: 0.579, Test accuracy: 81.40 

Round  13, Global train loss: 0.281, Global test loss: 0.814, Global test accuracy: 65.30 

Round  14, Train loss: 0.263, Test loss: 0.770, Test accuracy: 77.80 

Round  14, Global train loss: 0.263, Global test loss: 1.010, Global test accuracy: 60.00 

Round  15, Train loss: 0.234, Test loss: 0.707, Test accuracy: 79.90 

Round  15, Global train loss: 0.234, Global test loss: 0.741, Global test accuracy: 64.60 

Round  16, Train loss: 0.241, Test loss: 0.864, Test accuracy: 78.90 

Round  16, Global train loss: 0.241, Global test loss: 0.741, Global test accuracy: 65.60 

Round  17, Train loss: 0.249, Test loss: 0.609, Test accuracy: 81.90 

Round  17, Global train loss: 0.249, Global test loss: 0.860, Global test accuracy: 62.40 

Round  18, Train loss: 0.209, Test loss: 0.810, Test accuracy: 82.40 

Round  18, Global train loss: 0.209, Global test loss: 0.884, Global test accuracy: 65.10 

Round  19, Train loss: 0.224, Test loss: 0.565, Test accuracy: 82.20 

Round  19, Global train loss: 0.224, Global test loss: 0.819, Global test accuracy: 64.40 

Round  20, Train loss: 0.201, Test loss: 0.653, Test accuracy: 81.10 

Round  20, Global train loss: 0.201, Global test loss: 0.889, Global test accuracy: 66.70 

Round  21, Train loss: 0.197, Test loss: 0.679, Test accuracy: 81.20 

Round  21, Global train loss: 0.197, Global test loss: 0.819, Global test accuracy: 66.40 

Round  22, Train loss: 0.188, Test loss: 0.659, Test accuracy: 81.80 

Round  22, Global train loss: 0.188, Global test loss: 0.763, Global test accuracy: 68.60 

Round  23, Train loss: 0.185, Test loss: 0.680, Test accuracy: 78.60 

Round  23, Global train loss: 0.185, Global test loss: 0.848, Global test accuracy: 67.80 

Round  24, Train loss: 0.165, Test loss: 0.643, Test accuracy: 81.40 

Round  24, Global train loss: 0.165, Global test loss: 0.850, Global test accuracy: 66.80 

Round  25, Train loss: 0.174, Test loss: 0.602, Test accuracy: 82.00 

Round  25, Global train loss: 0.174, Global test loss: 0.841, Global test accuracy: 66.40 

Round  26, Train loss: 0.143, Test loss: 1.505, Test accuracy: 78.90 

Round  26, Global train loss: 0.143, Global test loss: 0.869, Global test accuracy: 66.10 

Round  27, Train loss: 0.151, Test loss: 0.617, Test accuracy: 81.80 

Round  27, Global train loss: 0.151, Global test loss: 1.097, Global test accuracy: 60.50 

Round  28, Train loss: 0.133, Test loss: 0.678, Test accuracy: 82.40 

Round  28, Global train loss: 0.133, Global test loss: 0.948, Global test accuracy: 64.20 

Round  29, Train loss: 0.161, Test loss: 0.627, Test accuracy: 82.00 

Round  29, Global train loss: 0.161, Global test loss: 0.898, Global test accuracy: 63.50 

Round  30, Train loss: 0.108, Test loss: 0.707, Test accuracy: 81.60 

Round  30, Global train loss: 0.108, Global test loss: 1.056, Global test accuracy: 62.90 

Round  31, Train loss: 0.096, Test loss: 0.858, Test accuracy: 81.10 

Round  31, Global train loss: 0.096, Global test loss: 1.176, Global test accuracy: 64.90 

Round  32, Train loss: 0.116, Test loss: 0.718, Test accuracy: 81.70 

Round  32, Global train loss: 0.116, Global test loss: 0.994, Global test accuracy: 65.00 

Round  33, Train loss: 0.105, Test loss: 0.582, Test accuracy: 82.50 

Round  33, Global train loss: 0.105, Global test loss: 0.963, Global test accuracy: 67.20 

Round  34, Train loss: 0.101, Test loss: 0.665, Test accuracy: 81.70 

Round  34, Global train loss: 0.101, Global test loss: 1.055, Global test accuracy: 65.50 

Final Round, Train loss: 0.097, Test loss: 0.655, Test accuracy: 82.70 

Final Round, Global train loss: 0.097, Global test loss: 1.055, Global test accuracy: 65.50 

Average accuracy final 10 rounds: 81.57 

Average global accuracy final 10 rounds: 64.62 

467.75194334983826
[4.317778825759888, 6.55881404876709, 8.814733505249023, 11.179796695709229, 13.507028341293335, 15.821933269500732, 18.098105430603027, 20.377782344818115, 22.721466779708862, 25.002777099609375, 27.306058406829834, 29.621522903442383, 31.976380109786987, 34.212669134140015, 36.544493198394775, 38.815473794937134, 41.10674786567688, 43.377163887023926, 45.66987490653992, 47.94109511375427, 50.18574786186218, 52.469733476638794, 54.677236557006836, 57.02446413040161, 59.29965615272522, 61.58059787750244, 63.85113596916199, 66.04312801361084, 68.33286333084106, 70.59500980377197, 72.8331847190857, 75.10894465446472, 77.36935448646545, 79.62747716903687, 81.8957166671753, 86.41269397735596]
[75.7, 76.7, 75.4, 75.7, 79.4, 71.0, 76.5, 73.5, 78.1, 75.4, 73.4, 80.3, 81.0, 81.4, 77.8, 79.9, 78.9, 81.9, 82.4, 82.2, 81.1, 81.2, 81.8, 78.6, 81.4, 82.0, 78.9, 81.8, 82.4, 82.0, 81.6, 81.1, 81.7, 82.5, 81.7, 82.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.692, Test loss: 0.798, Test accuracy: 56.60 

Round   1, Train loss: 0.634, Test loss: 0.978, Test accuracy: 55.10 

Round   2, Train loss: 0.583, Test loss: 0.629, Test accuracy: 65.50 

Round   3, Train loss: 0.540, Test loss: 1.018, Test accuracy: 54.00 

Round   4, Train loss: 0.540, Test loss: 0.974, Test accuracy: 61.40 

Round   5, Train loss: 0.488, Test loss: 0.794, Test accuracy: 64.10 

Round   6, Train loss: 0.477, Test loss: 0.897, Test accuracy: 66.10 

Round   7, Train loss: 0.432, Test loss: 0.776, Test accuracy: 69.60 

Round   8, Train loss: 0.459, Test loss: 0.745, Test accuracy: 69.70 

Round   9, Train loss: 0.393, Test loss: 0.517, Test accuracy: 77.00 

Round  10, Train loss: 0.367, Test loss: 0.504, Test accuracy: 77.00 

Round  11, Train loss: 0.359, Test loss: 0.482, Test accuracy: 78.00 

Round  12, Train loss: 0.331, Test loss: 0.468, Test accuracy: 79.10 

Round  13, Train loss: 0.325, Test loss: 0.661, Test accuracy: 78.00 

Round  14, Train loss: 0.290, Test loss: 0.535, Test accuracy: 80.00 

Round  15, Train loss: 0.290, Test loss: 0.591, Test accuracy: 78.40 

Round  16, Train loss: 0.268, Test loss: 0.493, Test accuracy: 81.90 

Round  17, Train loss: 0.275, Test loss: 0.630, Test accuracy: 77.90 

Round  18, Train loss: 0.239, Test loss: 0.543, Test accuracy: 78.60 

Round  19, Train loss: 0.241, Test loss: 0.434, Test accuracy: 83.10 

Round  20, Train loss: 0.227, Test loss: 0.471, Test accuracy: 81.40 

Round  21, Train loss: 0.217, Test loss: 0.530, Test accuracy: 80.40 

Round  22, Train loss: 0.210, Test loss: 0.550, Test accuracy: 78.70 

Round  23, Train loss: 0.184, Test loss: 0.444, Test accuracy: 82.60 

Round  24, Train loss: 0.182, Test loss: 0.506, Test accuracy: 79.90 

Round  25, Train loss: 0.178, Test loss: 0.601, Test accuracy: 78.70 

Round  26, Train loss: 0.173, Test loss: 0.483, Test accuracy: 81.40 

Round  27, Train loss: 0.152, Test loss: 0.492, Test accuracy: 82.10 

Round  28, Train loss: 0.153, Test loss: 0.587, Test accuracy: 80.60 

Round  29, Train loss: 0.146, Test loss: 0.517, Test accuracy: 82.10 

Round  30, Train loss: 0.134, Test loss: 0.648, Test accuracy: 81.60 

Round  31, Train loss: 0.141, Test loss: 0.523, Test accuracy: 81.90 

Round  32, Train loss: 0.130, Test loss: 0.541, Test accuracy: 83.20 

Round  33, Train loss: 0.108, Test loss: 0.632, Test accuracy: 82.70 

Round  34, Train loss: 0.115, Test loss: 0.548, Test accuracy: 84.00 

Round  35, Train loss: 0.103, Test loss: 0.567, Test accuracy: 83.10 

Round  36, Train loss: 0.099, Test loss: 0.570, Test accuracy: 81.60 

Round  37, Train loss: 0.089, Test loss: 0.583, Test accuracy: 82.40 

Round  38, Train loss: 0.098, Test loss: 0.551, Test accuracy: 82.20 

Round  39, Train loss: 0.085, Test loss: 0.543, Test accuracy: 83.50 

Round  40, Train loss: 0.074, Test loss: 0.552, Test accuracy: 82.10 

Round  41, Train loss: 0.093, Test loss: 0.530, Test accuracy: 83.10 

Round  42, Train loss: 0.071, Test loss: 0.572, Test accuracy: 82.90 

Round  43, Train loss: 0.069, Test loss: 0.648, Test accuracy: 82.70 

Round  44, Train loss: 0.069, Test loss: 0.581, Test accuracy: 81.90 

Round  45, Train loss: 0.064, Test loss: 0.580, Test accuracy: 83.20 

Round  46, Train loss: 0.071, Test loss: 0.569, Test accuracy: 83.20 

Round  47, Train loss: 0.058, Test loss: 0.591, Test accuracy: 82.50 

Round  48, Train loss: 0.053, Test loss: 0.572, Test accuracy: 82.80 

Round  49, Train loss: 0.055, Test loss: 0.706, Test accuracy: 82.90 

Final Round, Train loss: 0.038, Test loss: 0.648, Test accuracy: 82.80 

Average accuracy final 10 rounds: 82.73 

482.66127610206604
[3.753180980682373, 5.618242502212524, 7.406105041503906, 9.197187900543213, 10.95222806930542, 12.749099731445312, 14.547061681747437, 16.40862011909485, 18.246580362319946, 20.08897352218628, 21.87957787513733, 23.68895149230957, 25.502195119857788, 27.29910111427307, 29.041056632995605, 30.769411325454712, 32.56011700630188, 34.306636810302734, 36.080132484436035, 37.84246826171875, 39.623591899871826, 41.32767343521118, 43.07675790786743, 44.890416860580444, 46.662426233291626, 48.40953707695007, 50.20698523521423, 52.01259803771973, 53.84190845489502, 55.648483753204346, 57.542990922927856, 59.33315420150757, 61.14233469963074, 62.97470712661743, 64.77100038528442, 66.5919258594513, 68.34943962097168, 70.1126298904419, 71.96670055389404, 73.74749302864075, 75.59411406517029, 77.37905430793762, 79.22968697547913, 81.02886605262756, 82.82394742965698, 84.6437475681305, 86.39303970336914, 88.17359972000122, 89.97535824775696, 91.74670219421387, 93.66169548034668]
[56.6, 55.1, 65.5, 54.0, 61.4, 64.1, 66.1, 69.6, 69.7, 77.0, 77.0, 78.0, 79.1, 78.0, 80.0, 78.4, 81.9, 77.9, 78.6, 83.1, 81.4, 80.4, 78.7, 82.6, 79.9, 78.7, 81.4, 82.1, 80.6, 82.1, 81.6, 81.9, 83.2, 82.7, 84.0, 83.1, 81.6, 82.4, 82.2, 83.5, 82.1, 83.1, 82.9, 82.7, 81.9, 83.2, 83.2, 82.5, 82.8, 82.9, 82.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.731, Test loss: 0.979, Test accuracy: 56.50
Round   1, Train loss: 0.618, Test loss: 0.882, Test accuracy: 54.60
Round   2, Train loss: 0.623, Test loss: 0.910, Test accuracy: 58.40
Round   3, Train loss: 0.565, Test loss: 1.193, Test accuracy: 53.60
Round   4, Train loss: 0.550, Test loss: 0.827, Test accuracy: 66.90
Round   5, Train loss: 0.492, Test loss: 0.570, Test accuracy: 71.80
Round   6, Train loss: 0.485, Test loss: 0.779, Test accuracy: 67.10
Round   7, Train loss: 0.440, Test loss: 0.735, Test accuracy: 70.20
Round   8, Train loss: 0.426, Test loss: 0.603, Test accuracy: 72.20
Round   9, Train loss: 0.388, Test loss: 0.634, Test accuracy: 71.50
Round  10, Train loss: 0.385, Test loss: 0.644, Test accuracy: 74.60
Round  11, Train loss: 0.393, Test loss: 0.873, Test accuracy: 70.80
Round  12, Train loss: 0.354, Test loss: 0.498, Test accuracy: 78.70
Round  13, Train loss: 0.340, Test loss: 0.483, Test accuracy: 78.10
Round  14, Train loss: 0.310, Test loss: 0.896, Test accuracy: 69.10
Round  15, Train loss: 0.311, Test loss: 0.661, Test accuracy: 75.60
Round  16, Train loss: 0.291, Test loss: 0.511, Test accuracy: 79.80
Round  17, Train loss: 0.288, Test loss: 0.539, Test accuracy: 77.30
Round  18, Train loss: 0.268, Test loss: 0.647, Test accuracy: 73.60
Round  19, Train loss: 0.244, Test loss: 0.680, Test accuracy: 76.40
Round  20, Train loss: 0.261, Test loss: 0.474, Test accuracy: 81.00
Round  21, Train loss: 0.216, Test loss: 0.466, Test accuracy: 81.70
Round  22, Train loss: 0.221, Test loss: 0.538, Test accuracy: 80.00
Round  23, Train loss: 0.195, Test loss: 0.472, Test accuracy: 80.20
Round  24, Train loss: 0.186, Test loss: 0.440, Test accuracy: 82.50
Round  25, Train loss: 0.170, Test loss: 0.481, Test accuracy: 82.00
Round  26, Train loss: 0.184, Test loss: 0.510, Test accuracy: 81.10
Round  27, Train loss: 0.160, Test loss: 0.456, Test accuracy: 82.80
Round  28, Train loss: 0.158, Test loss: 0.510, Test accuracy: 80.40
Round  29, Train loss: 0.147, Test loss: 0.426, Test accuracy: 83.80
Round  30, Train loss: 0.155, Test loss: 0.523, Test accuracy: 81.00
Round  31, Train loss: 0.142, Test loss: 0.524, Test accuracy: 81.10
Round  32, Train loss: 0.132, Test loss: 0.459, Test accuracy: 81.50
Round  33, Train loss: 0.123, Test loss: 0.458, Test accuracy: 82.10
Round  34, Train loss: 0.126, Test loss: 0.534, Test accuracy: 81.40
Round  35, Train loss: 0.102, Test loss: 0.505, Test accuracy: 82.40
Round  36, Train loss: 0.105, Test loss: 0.473, Test accuracy: 82.30
Round  37, Train loss: 0.107, Test loss: 0.484, Test accuracy: 82.90
Round  38, Train loss: 0.096, Test loss: 0.520, Test accuracy: 82.10
Round  39, Train loss: 0.086, Test loss: 0.545, Test accuracy: 83.20
Round  40, Train loss: 0.081, Test loss: 0.510, Test accuracy: 83.10
Round  41, Train loss: 0.061, Test loss: 0.579, Test accuracy: 82.30
Round  42, Train loss: 0.089, Test loss: 0.545, Test accuracy: 83.10
Round  43, Train loss: 0.083, Test loss: 0.500, Test accuracy: 83.70
Round  44, Train loss: 0.068, Test loss: 0.532, Test accuracy: 83.00
Round  45, Train loss: 0.072, Test loss: 0.520, Test accuracy: 84.10
Round  46, Train loss: 0.053, Test loss: 0.518, Test accuracy: 84.00
Round  47, Train loss: 0.056, Test loss: 0.617, Test accuracy: 81.50
Round  48, Train loss: 0.060, Test loss: 0.573, Test accuracy: 82.60
Round  49, Train loss: 0.047, Test loss: 0.618, Test accuracy: 81.70
Final Round, Train loss: 0.033, Test loss: 0.617, Test accuracy: 82.50
Average accuracy final 10 rounds: 82.91
539.449346780777
[4.13471794128418, 6.1932313442230225, 8.176598310470581, 10.190667152404785, 12.185217142105103, 14.252168416976929, 16.27729630470276, 18.192237854003906, 20.277042388916016, 22.34320616722107, 24.380999088287354, 26.446324825286865, 28.507068157196045, 30.564809799194336, 32.53077816963196, 34.613619327545166, 36.62071871757507, 38.70622158050537, 40.775099992752075, 42.80794143676758, 44.804327964782715, 46.860846519470215, 48.93652868270874, 50.9622106552124, 53.00530290603638, 55.01066589355469, 57.000423431396484, 59.09309387207031, 61.13443398475647, 63.196375131607056, 65.24292182922363, 67.26706218719482, 69.3050286769867, 71.24794387817383, 73.25642323493958, 75.34011816978455, 77.33747148513794, 79.2863380908966, 81.27018404006958, 83.26168823242188, 85.35403943061829, 87.53245043754578, 89.67396593093872, 91.78486013412476, 93.75406336784363, 95.8020567893982, 97.84475684165955, 99.89361524581909, 102.00084233283997, 103.99689173698425, 106.00672841072083]
[56.5, 54.6, 58.4, 53.6, 66.9, 71.8, 67.1, 70.2, 72.2, 71.5, 74.6, 70.8, 78.7, 78.1, 69.1, 75.6, 79.8, 77.3, 73.6, 76.4, 81.0, 81.7, 80.0, 80.2, 82.5, 82.0, 81.1, 82.8, 80.4, 83.8, 81.0, 81.1, 81.5, 82.1, 81.4, 82.4, 82.3, 82.9, 82.1, 83.2, 83.1, 82.3, 83.1, 83.7, 83.0, 84.1, 84.0, 81.5, 82.6, 81.7, 82.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.777, Train accuracy: 80.500, Test loss: 1.906, Test accuracy: 73.50 

        train local model (freeze embeding):client   0,  Train loss: 0.123, Train accuracy: 94.500, Test loss: 0.981, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.144, Train accuracy: 94.000, Test loss: 1.057, Test accuracy: 71.00 

Round   0, Train loss: 0.144, Test loss: 1.057, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.113, Train accuracy: 95.000, Test loss: 1.212, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 4.348, Train accuracy: 59.000, Test loss: 5.483, Test accuracy: 51.50 

Round   1, Train loss: 4.348, Test loss: 5.483, Test accuracy: 51.50 

        train local model (freeze embeding):client   0,  Train loss: 0.194, Train accuracy: 92.500, Test loss: 1.011, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.140, Train accuracy: 93.500, Test loss: 1.257, Test accuracy: 71.50 

Round   2, Train loss: 0.140, Test loss: 1.257, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.124, Train accuracy: 94.500, Test loss: 1.199, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.278, Train accuracy: 90.000, Test loss: 1.175, Test accuracy: 71.00 

Round   3, Train loss: 0.278, Test loss: 1.175, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.191, Train accuracy: 93.000, Test loss: 0.968, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.287, Train accuracy: 87.500, Test loss: 1.074, Test accuracy: 72.00 

Round   4, Train loss: 0.287, Test loss: 1.074, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 1.196, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.109, Train accuracy: 95.500, Test loss: 1.312, Test accuracy: 69.50 

Round   5, Train loss: 0.109, Test loss: 1.312, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.473, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.176, Train accuracy: 92.500, Test loss: 1.274, Test accuracy: 69.50 

Round   6, Train loss: 0.176, Test loss: 1.274, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.091, Train accuracy: 98.000, Test loss: 1.159, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.275, Test accuracy: 76.00 

Round   7, Train loss: 0.030, Test loss: 1.275, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 1.276, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 76.50 

Round   8, Train loss: 0.011, Test loss: 1.034, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.190, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 1.866, Test accuracy: 73.00 

Round   9, Train loss: 0.036, Test loss: 1.866, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.357, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.243, Test accuracy: 75.00 

Round  10, Train loss: 0.010, Test loss: 1.243, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.335, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.059, Train accuracy: 97.500, Test loss: 1.331, Test accuracy: 72.50 

Round  11, Train loss: 0.059, Test loss: 1.331, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 1.263, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 73.00 

Round  12, Train loss: 0.009, Test loss: 1.221, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.136, Test accuracy: 75.50 

Round  13, Train loss: 0.019, Test loss: 1.136, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.253, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.564, Test accuracy: 76.00 

Round  14, Train loss: 0.002, Test loss: 1.564, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.436, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.193, Test accuracy: 74.50 

Round  15, Train loss: 0.014, Test loss: 1.193, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.308, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 76.00 

Round  16, Train loss: 0.004, Test loss: 1.234, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.617, Test accuracy: 75.00 

Round  17, Train loss: 0.001, Test loss: 1.617, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.336, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 1.597, Test accuracy: 71.50 

Round  18, Train loss: 0.015, Test loss: 1.597, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 1.552, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.594, Test accuracy: 74.00 

Round  19, Train loss: 0.026, Test loss: 1.594, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.258, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 74.50 

Final Round, Train loss: 0.003, Test loss: 1.578, Test accuracy: 74.50 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.391, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.368, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.435, Train accuracy: 78.000, Test loss: 0.458, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.113, Train accuracy: 96.000, Test loss: 0.315, Test accuracy: 88.50 

Round   0, Train loss: 0.057, Test loss: 0.792, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 1.215, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 1.481, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.135, Train accuracy: 95.500, Test loss: 0.340, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.107, Train accuracy: 95.000, Test loss: 0.290, Test accuracy: 88.00 

Round   1, Train loss: 0.072, Test loss: 0.684, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.163, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.228, Train accuracy: 94.000, Test loss: 1.763, Test accuracy: 68.50 

        train local model (freeze embeding):client   1,  Train loss: 0.166, Train accuracy: 94.500, Test loss: 0.392, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.183, Train accuracy: 91.000, Test loss: 0.629, Test accuracy: 78.00 

Round   2, Train loss: 0.205, Test loss: 0.812, Test accuracy: 75.75 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 98.500, Test loss: 1.235, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 1.942, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.106, Train accuracy: 95.500, Test loss: 0.349, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.082, Train accuracy: 98.000, Test loss: 0.593, Test accuracy: 84.00 

Round   3, Train loss: 0.051, Test loss: 0.937, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 1.351, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.607, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 0.449, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 0.308, Test accuracy: 89.50 

Round   4, Train loss: 0.022, Test loss: 0.803, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 1.333, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.353, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.240, Train accuracy: 90.500, Test loss: 1.002, Test accuracy: 80.00 

Round   5, Train loss: 0.145, Test loss: 0.872, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 1.442, Test accuracy: 70.50 

        train local model (freeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.364, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.525, Test accuracy: 85.50 

Round   6, Train loss: 0.015, Test loss: 0.840, Test accuracy: 79.25 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.381, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.347, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 0.421, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.168, Train accuracy: 94.000, Test loss: 0.578, Test accuracy: 77.50 

Round   7, Train loss: 0.090, Test loss: 0.861, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.596, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.463, Test accuracy: 88.50 

Round   8, Train loss: 0.012, Test loss: 0.874, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.405, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 1.042, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.695, Test accuracy: 84.00 

Round   9, Train loss: 0.037, Test loss: 0.861, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.488, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.484, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 0.722, Test accuracy: 87.00 

Round  10, Train loss: 0.010, Test loss: 0.926, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.629, Test accuracy: 84.50 

Round  11, Train loss: 0.009, Test loss: 0.928, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.663, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.567, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 88.00 

Round  12, Train loss: 0.009, Test loss: 0.886, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.317, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.543, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 90.00 

Round  13, Train loss: 0.002, Test loss: 0.875, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.513, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 90.00 

Round  14, Train loss: 0.003, Test loss: 0.859, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.273, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.591, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.052, Train accuracy: 98.000, Test loss: 0.543, Test accuracy: 86.00 

Round  15, Train loss: 0.033, Test loss: 0.883, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.416, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 88.50 

Round  16, Train loss: 0.002, Test loss: 0.803, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.571, Test accuracy: 87.50 

Round  17, Train loss: 0.010, Test loss: 0.701, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.437, Test accuracy: 89.00 

Round  18, Train loss: 0.005, Test loss: 0.761, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.238, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 89.00 

Round  19, Train loss: 0.002, Test loss: 0.792, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 88.50 

Final Round, Train loss: 0.002, Test loss: 0.785, Test accuracy: 81.75 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.074, Train accuracy: 98.000, Test loss: 1.014, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.289, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.604, Train accuracy: 62.500, Test loss: 0.740, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.459, Train accuracy: 79.500, Test loss: 1.027, Test accuracy: 68.00 

Round   0, Train loss: 0.155, Test loss: 0.737, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.231, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.635, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.387, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.440, Train accuracy: 77.500, Test loss: 0.649, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.227, Train accuracy: 89.500, Test loss: 0.598, Test accuracy: 78.00 

Round   1, Train loss: 0.079, Test loss: 0.706, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.314, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.652, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 0.467, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.323, Train accuracy: 87.500, Test loss: 0.639, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.236, Train accuracy: 90.500, Test loss: 0.813, Test accuracy: 72.50 

Round   2, Train loss: 0.094, Test loss: 0.815, Test accuracy: 77.33 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.000, Test loss: 1.268, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.479, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.361, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.800, Test accuracy: 83.50 

        train local model (freeze embeding):client   2,  Train loss: 0.213, Train accuracy: 91.500, Test loss: 0.615, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.285, Train accuracy: 91.000, Test loss: 1.098, Test accuracy: 75.50 

Round   3, Train loss: 0.109, Test loss: 0.732, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.238, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.628, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.393, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.200, Train accuracy: 92.000, Test loss: 0.774, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.127, Train accuracy: 96.000, Test loss: 0.654, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.299, Train accuracy: 88.500, Test loss: 0.810, Test accuracy: 73.00 

Round   4, Train loss: 0.168, Test loss: 0.745, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.236, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.284, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.463, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.540, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.149, Train accuracy: 95.000, Test loss: 0.653, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.118, Train accuracy: 96.500, Test loss: 0.721, Test accuracy: 77.00 

Round   5, Train loss: 0.040, Test loss: 0.703, Test accuracy: 78.17 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.127, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.105, Train accuracy: 98.000, Test loss: 1.815, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.126, Train accuracy: 95.500, Test loss: 0.713, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.459, Train accuracy: 83.500, Test loss: 0.935, Test accuracy: 74.50 

Round   6, Train loss: 0.188, Test loss: 0.932, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 1.131, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.387, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.715, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.100, Train accuracy: 97.000, Test loss: 0.617, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.233, Train accuracy: 87.000, Test loss: 0.716, Test accuracy: 74.50 

Round   7, Train loss: 0.092, Test loss: 0.678, Test accuracy: 79.67 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.332, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.113, Train accuracy: 97.000, Test loss: 0.785, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.118, Train accuracy: 96.000, Test loss: 1.033, Test accuracy: 76.00 

Round   8, Train loss: 0.040, Test loss: 0.768, Test accuracy: 78.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.427, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.083, Train accuracy: 97.000, Test loss: 0.804, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.359, Train accuracy: 82.500, Test loss: 1.043, Test accuracy: 71.50 

Round   9, Train loss: 0.121, Test loss: 0.813, Test accuracy: 77.67 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 0.687, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.098, Train accuracy: 97.000, Test loss: 0.959, Test accuracy: 71.50 

Round  10, Train loss: 0.033, Test loss: 0.756, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.500, Test loss: 0.718, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.069, Train accuracy: 97.000, Test loss: 0.823, Test accuracy: 82.50 

Round  11, Train loss: 0.025, Test loss: 0.879, Test accuracy: 80.33 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.279, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.676, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.730, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.463, Train accuracy: 83.500, Test loss: 1.366, Test accuracy: 68.50 

Round  12, Train loss: 0.158, Test loss: 0.706, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.315, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.609, Test accuracy: 84.50 

        train local model (freeze embeding):client   2,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 0.776, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.195, Train accuracy: 93.000, Test loss: 0.750, Test accuracy: 80.50 

Round  13, Train loss: 0.066, Test loss: 0.877, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.182, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.259, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 98.500, Test loss: 0.720, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 0.690, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.532, Train accuracy: 84.000, Test loss: 1.550, Test accuracy: 70.50 

Round  14, Train loss: 0.194, Test loss: 0.890, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 1.168, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.542, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.869, Test accuracy: 83.00 

        train local model (freeze embeding):client   2,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.736, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.091, Train accuracy: 97.500, Test loss: 0.953, Test accuracy: 78.00 

Round  15, Train loss: 0.045, Test loss: 0.840, Test accuracy: 79.83 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.238, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.471, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.029, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.807, Test accuracy: 81.00 

Round  16, Train loss: 0.012, Test loss: 0.703, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.041, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.183, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 0.599, Test accuracy: 84.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.726, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 79.00 

Round  17, Train loss: 0.013, Test loss: 0.791, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.062, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.583, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.766, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.080, Train accuracy: 97.500, Test loss: 1.308, Test accuracy: 71.00 

Round  18, Train loss: 0.031, Test loss: 0.877, Test accuracy: 80.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.116, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.567, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.092, Train accuracy: 97.000, Test loss: 1.252, Test accuracy: 80.00 

Round  19, Train loss: 0.037, Test loss: 0.822, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.066, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.444, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.946, Test accuracy: 79.50 

Final Round, Train loss: 0.009, Test loss: 0.819, Test accuracy: 81.17 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.412, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.566, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.050, Train accuracy: 98.000, Test loss: 1.269, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.593, Train accuracy: 72.500, Test loss: 0.732, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.251, Train accuracy: 88.500, Test loss: 0.945, Test accuracy: 75.00 

Round   0, Train loss: 0.075, Test loss: 0.797, Test accuracy: 78.38 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.187, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.667, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.547, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.043, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.293, Test accuracy: 73.50 

        train local model (freeze embeding):client   3,  Train loss: 0.606, Train accuracy: 72.000, Test loss: 0.858, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.144, Train accuracy: 94.500, Test loss: 0.847, Test accuracy: 76.50 

Round   1, Train loss: 0.048, Test loss: 0.905, Test accuracy: 77.62 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.216, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.169, Train accuracy: 94.000, Test loss: 2.097, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.442, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.009, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.067, Train accuracy: 96.500, Test loss: 0.791, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.368, Train accuracy: 85.000, Test loss: 0.965, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.120, Train accuracy: 95.500, Test loss: 0.766, Test accuracy: 80.00 

Round   2, Train loss: 0.089, Test loss: 0.777, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.436, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.383, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 98.500, Test loss: 0.802, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.239, Train accuracy: 90.500, Test loss: 0.659, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.283, Train accuracy: 89.500, Test loss: 1.207, Test accuracy: 69.50 

Round   3, Train loss: 0.083, Test loss: 0.772, Test accuracy: 78.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.133, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.356, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.190, Train accuracy: 93.500, Test loss: 0.870, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.088, Train accuracy: 98.000, Test loss: 0.836, Test accuracy: 76.50 

Round   4, Train loss: 0.025, Test loss: 0.790, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.264, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.163, Train accuracy: 93.500, Test loss: 0.778, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.176, Train accuracy: 91.000, Test loss: 1.009, Test accuracy: 73.00 

Round   5, Train loss: 0.048, Test loss: 0.752, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.147, Train accuracy: 96.500, Test loss: 1.220, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.943, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.098, Train accuracy: 97.000, Test loss: 0.865, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.106, Train accuracy: 96.000, Test loss: 0.890, Test accuracy: 77.50 

Round   6, Train loss: 0.066, Test loss: 0.848, Test accuracy: 80.12 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.456, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 99.000, Test loss: 0.916, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.095, Train accuracy: 96.000, Test loss: 0.791, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.151, Train accuracy: 95.000, Test loss: 1.120, Test accuracy: 79.00 

Round   7, Train loss: 0.051, Test loss: 0.807, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.426, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.868, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.048, Train accuracy: 99.500, Test loss: 0.719, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.048, Train accuracy: 99.000, Test loss: 0.914, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.044, Train accuracy: 99.000, Test loss: 0.985, Test accuracy: 79.50 

Round   8, Train loss: 0.025, Test loss: 0.773, Test accuracy: 79.88 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.073, Train accuracy: 96.500, Test loss: 1.305, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.387, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.076, Train accuracy: 97.500, Test loss: 1.075, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.049, Train accuracy: 99.000, Test loss: 0.956, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.078, Train accuracy: 96.500, Test loss: 0.993, Test accuracy: 72.50 

Round   9, Train loss: 0.057, Test loss: 0.953, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.381, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.037, Train accuracy: 99.500, Test loss: 0.995, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.078, Train accuracy: 98.000, Test loss: 0.985, Test accuracy: 72.50 

Round  10, Train loss: 0.023, Test loss: 0.741, Test accuracy: 80.12 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.165, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.620, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 78.50 

        train local model (freeze embeding):client   3,  Train loss: 0.029, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.119, Train accuracy: 95.500, Test loss: 1.375, Test accuracy: 68.00 

Round  11, Train loss: 0.032, Test loss: 0.751, Test accuracy: 80.12 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.112, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.989, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 1.043, Test accuracy: 69.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.120, Train accuracy: 96.000, Test loss: 1.249, Test accuracy: 72.00 

Round  12, Train loss: 0.037, Test loss: 0.734, Test accuracy: 80.62 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.691, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.262, Train accuracy: 90.000, Test loss: 1.528, Test accuracy: 70.00 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.868, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.122, Train accuracy: 96.000, Test loss: 1.013, Test accuracy: 81.00 

Round  13, Train loss: 0.096, Test loss: 0.836, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 1.403, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.618, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.070, Test accuracy: 75.00 

Round  14, Train loss: 0.012, Test loss: 0.858, Test accuracy: 80.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.169, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.396, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.756, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 75.00 

Round  15, Train loss: 0.008, Test loss: 0.906, Test accuracy: 78.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.232, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.851, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 98.000, Test loss: 1.328, Test accuracy: 79.00 

Round  16, Train loss: 0.008, Test loss: 0.805, Test accuracy: 80.62 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.190, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.846, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.802, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.055, Train accuracy: 99.000, Test loss: 0.950, Test accuracy: 74.00 

Round  17, Train loss: 0.014, Test loss: 0.818, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.380, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.421, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.304, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.051, Train accuracy: 97.500, Test loss: 1.134, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.057, Train accuracy: 97.500, Test loss: 0.858, Test accuracy: 80.00 

Round  18, Train loss: 0.027, Test loss: 0.853, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.386, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.824, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 1.138, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.175, Train accuracy: 94.000, Test loss: 1.220, Test accuracy: 69.50 

Round  19, Train loss: 0.053, Test loss: 0.818, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.194, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.883, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 78.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 77.00 

Final Round, Train loss: 0.004, Test loss: 0.865, Test accuracy: 80.75 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 94.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.143, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.710, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.851, Test accuracy: 81.50 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.925, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.093, Train accuracy: 96.500, Test loss: 1.198, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.232, Train accuracy: 91.500, Test loss: 0.255, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.000, Test loss: 0.155, Test accuracy: 94.50 

Round   0, Train loss: 0.035, Test loss: 0.621, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.517, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 80.00 

        train local model (freeze embeding):client   4,  Train loss: 0.139, Train accuracy: 94.500, Test loss: 0.205, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 93.50 

Round   1, Train loss: 0.005, Test loss: 0.706, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.586, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.672, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.938, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.032, Train accuracy: 99.000, Test loss: 1.048, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.077, Train accuracy: 98.000, Test loss: 0.150, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.175, Test accuracy: 93.50 

Round   2, Train loss: 0.018, Test loss: 0.655, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.196, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.926, Test accuracy: 68.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.071, Train accuracy: 98.000, Test loss: 0.954, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 1.372, Test accuracy: 73.00 

        train local model (freeze embeding):client   4,  Train loss: 0.082, Train accuracy: 95.500, Test loss: 0.149, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.055, Train accuracy: 98.500, Test loss: 0.220, Test accuracy: 94.00 

Round   3, Train loss: 0.037, Test loss: 0.674, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.341, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.300, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.606, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.500, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.063, Train accuracy: 97.500, Test loss: 2.008, Test accuracy: 72.50 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.043, Test accuracy: 78.50 

        train local model (freeze embeding):client   4,  Train loss: 0.061, Train accuracy: 97.500, Test loss: 0.172, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.357, Test accuracy: 92.00 

Round   4, Train loss: 0.023, Test loss: 0.657, Test accuracy: 83.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.410, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 78.50 

        train local model (freeze embeding):client   4,  Train loss: 0.057, Train accuracy: 98.000, Test loss: 0.179, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.145, Train accuracy: 93.500, Test loss: 0.335, Test accuracy: 87.50 

Round   5, Train loss: 0.033, Test loss: 0.700, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.394, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 86.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 0.868, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.974, Test accuracy: 79.00 

        train local model (freeze embeding):client   4,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.134, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.179, Test accuracy: 94.50 

Round   6, Train loss: 0.011, Test loss: 0.648, Test accuracy: 84.10 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.130, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.240, Test accuracy: 91.00 

Round   7, Train loss: 0.004, Test loss: 0.673, Test accuracy: 83.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.340, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.547, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.376, Train accuracy: 92.000, Test loss: 1.925, Test accuracy: 66.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.051, Train accuracy: 98.000, Test loss: 1.229, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.137, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.174, Test accuracy: 94.50 

Round   8, Train loss: 0.089, Test loss: 0.691, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.366, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.143, Train accuracy: 94.500, Test loss: 1.243, Test accuracy: 77.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 81.50 

        train local model (freeze embeding):client   4,  Train loss: 0.027, Train accuracy: 100.000, Test loss: 0.149, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.180, Test accuracy: 94.00 

Round   9, Train loss: 0.035, Test loss: 0.670, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.483, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.822, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.059, Train accuracy: 98.000, Test loss: 1.013, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.061, Train accuracy: 97.500, Test loss: 1.004, Test accuracy: 74.50 

        train local model (freeze embeding):client   4,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.169, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.233, Test accuracy: 93.50 

Round  10, Train loss: 0.027, Test loss: 0.684, Test accuracy: 83.30 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.511, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.040, Train accuracy: 97.500, Test loss: 1.143, Test accuracy: 79.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 75.00 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.260, Test accuracy: 93.50 

Round  11, Train loss: 0.011, Test loss: 0.697, Test accuracy: 83.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.105, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.103, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.475, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.525, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.842, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.982, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.198, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.227, Test accuracy: 92.00 

Round  12, Train loss: 0.004, Test loss: 0.679, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 77.00 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.151, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.355, Train accuracy: 85.500, Test loss: 0.683, Test accuracy: 78.00 

Round  13, Train loss: 0.072, Test loss: 0.712, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.088, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.511, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.588, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.864, Test accuracy: 83.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.072, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.206, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.142, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.500, Test loss: 0.205, Test accuracy: 93.50 

Round  14, Train loss: 0.009, Test loss: 0.714, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.385, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 80.50 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.135, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.334, Test accuracy: 92.00 

Round  15, Train loss: 0.005, Test loss: 0.769, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.641, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 78.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.150, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.162, Test accuracy: 94.00 

Round  16, Train loss: 0.003, Test loss: 0.746, Test accuracy: 83.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.621, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.541, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 78.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.169, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.059, Train accuracy: 98.500, Test loss: 0.333, Test accuracy: 91.00 

Round  17, Train loss: 0.013, Test loss: 0.804, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.495, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.793, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.298, Train accuracy: 92.500, Test loss: 1.479, Test accuracy: 76.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.193, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.256, Train accuracy: 92.000, Test loss: 0.466, Test accuracy: 88.50 

Round  18, Train loss: 0.114, Test loss: 0.751, Test accuracy: 83.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.388, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.587, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.723, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.230, Test accuracy: 77.00 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.171, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 0.313, Test accuracy: 92.00 

Round  19, Train loss: 0.005, Test loss: 0.735, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.537, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 81.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.091, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.070, Test accuracy: 77.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 95.00 

Final Round, Train loss: 0.001, Test loss: 0.760, Test accuracy: 83.00 

Average accuracy final 10 rounds: 399.0616666666667 

1311.7728607654572
[3.908097267150879, 7.825064420700073, 11.605916023254395, 15.593806743621826, 19.467461585998535, 23.11521577835083, 26.82501721382141, 30.77994203567505, 34.65041422843933, 38.663363218307495, 42.7139310836792, 46.52650284767151, 50.457483530044556, 54.33943510055542, 58.14122033119202, 62.1627254486084, 66.21106457710266, 70.03536796569824, 74.0987389087677, 78.03497862815857, 80.74495077133179, 84.81987285614014, 88.70800232887268, 92.8176474571228, 96.76247191429138, 100.597336769104, 104.71013283729553, 108.64777374267578, 112.77960729598999, 116.44321942329407, 120.13231587409973, 123.92180895805359, 128.03803277015686, 131.9504086971283, 135.94741535186768, 139.97632145881653, 143.993581533432, 147.80132269859314, 151.57370710372925, 155.41032147407532, 159.19078731536865, 161.55084586143494, 165.45084238052368, 169.48016786575317, 173.44278836250305, 177.19944190979004, 181.3162395954132, 185.31604599952698, 189.2400918006897, 193.2256212234497, 197.08411598205566, 201.16724371910095, 205.0895175933838, 209.16120409965515, 213.15844130516052, 217.19919109344482, 221.28949785232544, 225.46006798744202, 229.46484923362732, 233.57848739624023, 237.5597279071808, 241.7526502609253, 244.19641017913818, 248.05415630340576, 251.93947768211365, 256.0483136177063, 260.1564178466797, 264.0887222290039, 268.06076169013977, 272.2207021713257, 276.1289222240448, 280.135374546051, 284.0566523075104, 288.04547452926636, 292.06106519699097, 296.0567297935486, 300.1513948440552, 304.07723021507263, 308.1584334373474, 312.15769267082214, 316.0983247756958, 320.04851269721985, 324.14006090164185, 326.67047786712646, 330.6185748577118, 334.5620470046997, 338.37809801101685, 342.42614364624023, 346.36009311676025, 350.37013816833496, 354.2356786727905, 358.1795439720154, 362.33465600013733, 366.0402145385742, 370.24053502082825, 374.4312570095062, 378.5552387237549, 382.6060543060303, 386.79826498031616, 390.6853938102722, 394.7141318321228, 398.8042664527893, 402.80510783195496, 406.73828959465027, 409.39214730262756]
[71.0, 51.5, 71.5, 71.0, 72.0, 69.5, 69.5, 76.0, 76.5, 73.0, 75.0, 72.5, 73.0, 75.5, 76.0, 74.5, 76.0, 75.0, 71.5, 74.0, 74.5, 79.0, 78.75, 75.75, 78.0, 81.75, 80.25, 79.25, 77.0, 82.0, 80.5, 80.5, 78.0, 79.5, 82.25, 80.5, 79.5, 80.5, 82.0, 82.25, 81.75, 81.75, 77.0, 78.5, 77.33333333333333, 81.33333333333333, 78.0, 78.16666666666667, 79.0, 79.66666666666667, 78.66666666666667, 77.66666666666667, 80.0, 80.33333333333333, 81.5, 80.5, 80.0, 79.83333333333333, 80.66666666666667, 80.66666666666667, 80.66666666666667, 80.0, 81.16666666666667, 78.375, 77.625, 78.75, 78.25, 79.0, 80.25, 80.125, 80.0, 79.875, 79.0, 80.125, 80.125, 80.625, 80.0, 80.125, 78.625, 80.625, 79.75, 80.5, 80.5, 80.75, 83.6, 83.3, 83.5, 83.0, 83.7, 84.0, 84.1, 83.8, 82.5, 83.2, 83.3, 83.7, 83.6, 83.6, 83.6, 83.5, 83.8, 83.6, 83.4, 83.6, 83.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.684, Test loss: 0.673, Test accuracy: 73.10 

Round   0, Global train loss: 0.684, Global test loss: 0.759, Global test accuracy: 50.00 

Round   1, Train loss: 0.484, Test loss: 0.691, Test accuracy: 76.50 

Round   1, Global train loss: 0.484, Global test loss: 0.969, Global test accuracy: 50.00 

Round   2, Train loss: 0.392, Test loss: 0.627, Test accuracy: 76.70 

Round   2, Global train loss: 0.392, Global test loss: 0.998, Global test accuracy: 50.00 

Round   3, Train loss: 0.331, Test loss: 0.765, Test accuracy: 77.10 

Round   3, Global train loss: 0.331, Global test loss: 1.090, Global test accuracy: 50.00 

Round   4, Train loss: 0.289, Test loss: 0.555, Test accuracy: 81.20 

Round   4, Global train loss: 0.289, Global test loss: 1.102, Global test accuracy: 50.00 

Round   5, Train loss: 0.218, Test loss: 0.794, Test accuracy: 79.20 

Round   5, Global train loss: 0.218, Global test loss: 1.130, Global test accuracy: 50.00 

Round   6, Train loss: 0.224, Test loss: 0.805, Test accuracy: 78.00 

Round   6, Global train loss: 0.224, Global test loss: 1.186, Global test accuracy: 50.00 

Round   7, Train loss: 0.182, Test loss: 0.635, Test accuracy: 80.60 

Round   7, Global train loss: 0.182, Global test loss: 1.327, Global test accuracy: 50.00 

Round   8, Train loss: 0.179, Test loss: 0.683, Test accuracy: 79.70 

Round   8, Global train loss: 0.179, Global test loss: 1.180, Global test accuracy: 50.00 

Round   9, Train loss: 0.133, Test loss: 0.663, Test accuracy: 79.70 

Round   9, Global train loss: 0.133, Global test loss: 1.224, Global test accuracy: 50.00 

Round  10, Train loss: 0.130, Test loss: 0.737, Test accuracy: 81.40 

Round  10, Global train loss: 0.130, Global test loss: 1.432, Global test accuracy: 50.00 

Round  11, Train loss: 0.117, Test loss: 0.688, Test accuracy: 81.80 

Round  11, Global train loss: 0.117, Global test loss: 1.404, Global test accuracy: 50.00 

Round  12, Train loss: 0.098, Test loss: 0.638, Test accuracy: 83.00 

Round  12, Global train loss: 0.098, Global test loss: 1.199, Global test accuracy: 50.00 

Round  13, Train loss: 0.079, Test loss: 0.726, Test accuracy: 83.00 

Round  13, Global train loss: 0.079, Global test loss: 1.260, Global test accuracy: 50.00 

Round  14, Train loss: 0.067, Test loss: 0.845, Test accuracy: 83.00 

Round  14, Global train loss: 0.067, Global test loss: 1.272, Global test accuracy: 50.00 

Round  15, Train loss: 0.079, Test loss: 0.744, Test accuracy: 84.80 

Round  15, Global train loss: 0.079, Global test loss: 1.159, Global test accuracy: 50.00 

Round  16, Train loss: 0.061, Test loss: 0.640, Test accuracy: 84.50 

Round  16, Global train loss: 0.061, Global test loss: 1.211, Global test accuracy: 50.00 

Round  17, Train loss: 0.066, Test loss: 0.622, Test accuracy: 83.40 

Round  17, Global train loss: 0.066, Global test loss: 1.229, Global test accuracy: 50.00 

Round  18, Train loss: 0.038, Test loss: 0.680, Test accuracy: 82.70 

Round  18, Global train loss: 0.038, Global test loss: 1.203, Global test accuracy: 50.00 

Round  19, Train loss: 0.028, Test loss: 0.669, Test accuracy: 84.10 

Round  19, Global train loss: 0.028, Global test loss: 1.303, Global test accuracy: 50.00 

Round  20, Train loss: 0.034, Test loss: 0.649, Test accuracy: 83.10 

Round  20, Global train loss: 0.034, Global test loss: 1.288, Global test accuracy: 50.00 

Round  21, Train loss: 0.029, Test loss: 0.727, Test accuracy: 84.20 

Round  21, Global train loss: 0.029, Global test loss: 1.397, Global test accuracy: 50.00 

Round  22, Train loss: 0.033, Test loss: 0.792, Test accuracy: 83.40 

Round  22, Global train loss: 0.033, Global test loss: 1.360, Global test accuracy: 50.00 

Round  23, Train loss: 0.031, Test loss: 0.826, Test accuracy: 83.40 

Round  23, Global train loss: 0.031, Global test loss: 1.275, Global test accuracy: 50.00 

Round  24, Train loss: 0.017, Test loss: 0.786, Test accuracy: 83.10 

Round  24, Global train loss: 0.017, Global test loss: 1.395, Global test accuracy: 50.00 

Round  25, Train loss: 0.012, Test loss: 0.619, Test accuracy: 85.60 

Round  25, Global train loss: 0.012, Global test loss: 1.296, Global test accuracy: 50.00 

Round  26, Train loss: 0.042, Test loss: 0.696, Test accuracy: 85.70 

Round  26, Global train loss: 0.042, Global test loss: 1.379, Global test accuracy: 50.00 

Round  27, Train loss: 0.021, Test loss: 0.769, Test accuracy: 83.50 

Round  27, Global train loss: 0.021, Global test loss: 1.402, Global test accuracy: 50.00 

Round  28, Train loss: 0.041, Test loss: 0.602, Test accuracy: 83.70 

Round  28, Global train loss: 0.041, Global test loss: 1.300, Global test accuracy: 50.00 

Round  29, Train loss: 0.020, Test loss: 0.741, Test accuracy: 84.00 

Round  29, Global train loss: 0.020, Global test loss: 1.381, Global test accuracy: 50.00 

Round  30, Train loss: 0.017, Test loss: 0.694, Test accuracy: 83.80 

Round  30, Global train loss: 0.017, Global test loss: 1.410, Global test accuracy: 50.00 

Round  31, Train loss: 0.007, Test loss: 0.655, Test accuracy: 85.10 

Round  31, Global train loss: 0.007, Global test loss: 1.440, Global test accuracy: 50.00 

Round  32, Train loss: 0.008, Test loss: 0.684, Test accuracy: 81.10 

Round  32, Global train loss: 0.008, Global test loss: 1.455, Global test accuracy: 50.00 

Round  33, Train loss: 0.011, Test loss: 0.713, Test accuracy: 84.40 

Round  33, Global train loss: 0.011, Global test loss: 1.455, Global test accuracy: 50.00 

Round  34, Train loss: 0.023, Test loss: 0.635, Test accuracy: 83.80 

Round  34, Global train loss: 0.023, Global test loss: 1.480, Global test accuracy: 50.00 

Final Round, Train loss: 0.016, Test loss: 0.606, Test accuracy: 86.40 

Final Round, Global train loss: 0.016, Global test loss: 1.480, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 84.07 

Average global accuracy final 10 rounds: 50.0 

462.5283486843109
[4.471481561660767, 6.702847003936768, 9.006133556365967, 11.497364521026611, 13.77142882347107, 16.068981170654297, 18.27646780014038, 20.509766340255737, 22.792178869247437, 25.030569791793823, 27.28528070449829, 29.50727605819702, 31.728151559829712, 34.03304147720337, 36.333087682724, 38.52055835723877, 40.77572536468506, 43.033016204833984, 45.28110647201538, 47.53530144691467, 49.75422215461731, 52.11346793174744, 54.373581647872925, 56.630505323410034, 58.90314030647278, 61.15028715133667, 63.4242582321167, 65.78227257728577, 68.02743911743164, 70.23378777503967, 72.51408982276917, 74.75580215454102, 77.01049971580505, 79.21152067184448, 81.50267148017883, 85.77369403839111]
[73.1, 76.5, 76.7, 77.1, 81.2, 79.2, 78.0, 80.6, 79.7, 79.7, 81.4, 81.8, 83.0, 83.0, 83.0, 84.8, 84.5, 83.4, 82.7, 84.1, 83.1, 84.2, 83.4, 83.4, 83.1, 85.6, 85.7, 83.5, 83.7, 84.0, 83.8, 85.1, 81.1, 84.4, 83.8, 86.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.683, Test loss: 0.554, Test accuracy: 76.00 

Round   0, Global train loss: 0.683, Global test loss: 0.897, Global test accuracy: 50.00 

Round   1, Train loss: 0.602, Test loss: 0.702, Test accuracy: 72.80 

Round   1, Global train loss: 0.602, Global test loss: 1.087, Global test accuracy: 50.00 

Round   2, Train loss: 0.534, Test loss: 0.561, Test accuracy: 75.90 

Round   2, Global train loss: 0.534, Global test loss: 0.924, Global test accuracy: 53.80 

Round   3, Train loss: 0.515, Test loss: 0.857, Test accuracy: 75.70 

Round   3, Global train loss: 0.515, Global test loss: 1.010, Global test accuracy: 56.20 

Round   4, Train loss: 0.486, Test loss: 0.571, Test accuracy: 77.60 

Round   4, Global train loss: 0.486, Global test loss: 0.850, Global test accuracy: 59.70 

Round   5, Train loss: 0.461, Test loss: 0.588, Test accuracy: 75.60 

Round   5, Global train loss: 0.461, Global test loss: 0.988, Global test accuracy: 56.00 

Round   6, Train loss: 0.419, Test loss: 0.667, Test accuracy: 78.30 

Round   6, Global train loss: 0.419, Global test loss: 1.117, Global test accuracy: 58.10 

Round   7, Train loss: 0.390, Test loss: 0.697, Test accuracy: 77.10 

Round   7, Global train loss: 0.390, Global test loss: 1.127, Global test accuracy: 57.10 

Round   8, Train loss: 0.366, Test loss: 0.563, Test accuracy: 79.70 

Round   8, Global train loss: 0.366, Global test loss: 0.948, Global test accuracy: 59.60 

Round   9, Train loss: 0.342, Test loss: 0.541, Test accuracy: 80.90 

Round   9, Global train loss: 0.342, Global test loss: 0.883, Global test accuracy: 61.10 

Round  10, Train loss: 0.325, Test loss: 0.586, Test accuracy: 79.90 

Round  10, Global train loss: 0.325, Global test loss: 0.952, Global test accuracy: 60.60 

Round  11, Train loss: 0.307, Test loss: 0.602, Test accuracy: 81.20 

Round  11, Global train loss: 0.307, Global test loss: 1.128, Global test accuracy: 61.40 

Round  12, Train loss: 0.286, Test loss: 0.662, Test accuracy: 81.40 

Round  12, Global train loss: 0.286, Global test loss: 1.022, Global test accuracy: 63.30 

Round  13, Train loss: 0.284, Test loss: 0.737, Test accuracy: 81.40 

Round  13, Global train loss: 0.284, Global test loss: 1.090, Global test accuracy: 61.70 

Round  14, Train loss: 0.261, Test loss: 0.485, Test accuracy: 85.20 

Round  14, Global train loss: 0.261, Global test loss: 0.892, Global test accuracy: 65.50 

Round  15, Train loss: 0.236, Test loss: 0.589, Test accuracy: 81.70 

Round  15, Global train loss: 0.236, Global test loss: 1.000, Global test accuracy: 64.50 

Round  16, Train loss: 0.224, Test loss: 0.551, Test accuracy: 84.50 

Round  16, Global train loss: 0.224, Global test loss: 0.997, Global test accuracy: 64.70 

Round  17, Train loss: 0.208, Test loss: 0.607, Test accuracy: 82.00 

Round  17, Global train loss: 0.208, Global test loss: 1.141, Global test accuracy: 63.20 

Round  18, Train loss: 0.209, Test loss: 0.494, Test accuracy: 84.90 

Round  18, Global train loss: 0.209, Global test loss: 0.927, Global test accuracy: 66.00 

Round  19, Train loss: 0.188, Test loss: 0.596, Test accuracy: 81.50 

Round  19, Global train loss: 0.188, Global test loss: 0.833, Global test accuracy: 67.30 

Round  20, Train loss: 0.180, Test loss: 0.570, Test accuracy: 83.30 

Round  20, Global train loss: 0.180, Global test loss: 1.035, Global test accuracy: 64.70 

Round  21, Train loss: 0.157, Test loss: 0.651, Test accuracy: 82.00 

Round  21, Global train loss: 0.157, Global test loss: 1.002, Global test accuracy: 66.90 

Round  22, Train loss: 0.180, Test loss: 0.485, Test accuracy: 83.20 

Round  22, Global train loss: 0.180, Global test loss: 1.005, Global test accuracy: 66.30 

Round  23, Train loss: 0.163, Test loss: 0.649, Test accuracy: 83.10 

Round  23, Global train loss: 0.163, Global test loss: 0.999, Global test accuracy: 67.30 

Round  24, Train loss: 0.157, Test loss: 0.531, Test accuracy: 84.40 

Round  24, Global train loss: 0.157, Global test loss: 1.089, Global test accuracy: 67.60 

Round  25, Train loss: 0.143, Test loss: 0.431, Test accuracy: 85.40 

Round  25, Global train loss: 0.143, Global test loss: 0.976, Global test accuracy: 67.90 

Round  26, Train loss: 0.129, Test loss: 0.442, Test accuracy: 85.40 

Round  26, Global train loss: 0.129, Global test loss: 0.991, Global test accuracy: 67.00 

Round  27, Train loss: 0.121, Test loss: 0.552, Test accuracy: 83.00 

Round  27, Global train loss: 0.121, Global test loss: 1.095, Global test accuracy: 67.60 

Round  28, Train loss: 0.120, Test loss: 0.619, Test accuracy: 82.00 

Round  28, Global train loss: 0.120, Global test loss: 1.039, Global test accuracy: 66.10 

Round  29, Train loss: 0.113, Test loss: 0.444, Test accuracy: 86.10 

Round  29, Global train loss: 0.113, Global test loss: 1.067, Global test accuracy: 68.00 

Round  30, Train loss: 0.104, Test loss: 0.529, Test accuracy: 85.00 

Round  30, Global train loss: 0.104, Global test loss: 1.187, Global test accuracy: 66.70 

Round  31, Train loss: 0.087, Test loss: 0.421, Test accuracy: 86.70 

Round  31, Global train loss: 0.087, Global test loss: 1.201, Global test accuracy: 67.50 

Round  32, Train loss: 0.088, Test loss: 0.479, Test accuracy: 86.50 

Round  32, Global train loss: 0.088, Global test loss: 1.142, Global test accuracy: 66.20 

Round  33, Train loss: 0.113, Test loss: 0.475, Test accuracy: 85.80 

Round  33, Global train loss: 0.113, Global test loss: 1.282, Global test accuracy: 66.60 

Round  34, Train loss: 0.093, Test loss: 0.454, Test accuracy: 87.50 

Round  34, Global train loss: 0.093, Global test loss: 1.185, Global test accuracy: 66.80 

Final Round, Train loss: 0.073, Test loss: 0.653, Test accuracy: 85.70 

Final Round, Global train loss: 0.073, Global test loss: 1.185, Global test accuracy: 66.80 

Average accuracy final 10 rounds: 85.34 

Average global accuracy final 10 rounds: 67.03999999999999 

459.5772297382355
[4.277183294296265, 6.534693717956543, 8.769542694091797, 10.98317551612854, 13.153313636779785, 15.476133584976196, 17.821927547454834, 20.145187854766846, 22.371424436569214, 24.63572096824646, 26.902427434921265, 29.159191370010376, 31.393906116485596, 33.65893197059631, 35.896219968795776, 38.18539547920227, 40.46683645248413, 42.707003355026245, 45.00825095176697, 47.28161430358887, 49.51607823371887, 51.787431478500366, 54.02055072784424, 56.25618624687195, 58.519498109817505, 60.81993341445923, 63.01419711112976, 65.24485421180725, 67.51630902290344, 69.77661371231079, 72.00635647773743, 74.38988089561462, 76.59746956825256, 78.80463719367981, 81.01994347572327, 85.37889266014099]
[76.0, 72.8, 75.9, 75.7, 77.6, 75.6, 78.3, 77.1, 79.7, 80.9, 79.9, 81.2, 81.4, 81.4, 85.2, 81.7, 84.5, 82.0, 84.9, 81.5, 83.3, 82.0, 83.2, 83.1, 84.4, 85.4, 85.4, 83.0, 82.0, 86.1, 85.0, 86.7, 86.5, 85.8, 87.5, 85.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.733, Test loss: 0.895, Test accuracy: 50.10 

Round   1, Train loss: 0.713, Test loss: 0.818, Test accuracy: 58.30 

Round   2, Train loss: 0.603, Test loss: 0.784, Test accuracy: 58.50 

Round   3, Train loss: 0.584, Test loss: 0.772, Test accuracy: 58.60 

Round   4, Train loss: 0.545, Test loss: 0.838, Test accuracy: 62.70 

Round   5, Train loss: 0.528, Test loss: 0.806, Test accuracy: 65.50 

Round   6, Train loss: 0.502, Test loss: 0.837, Test accuracy: 65.40 

Round   7, Train loss: 0.460, Test loss: 0.537, Test accuracy: 72.80 

Round   8, Train loss: 0.434, Test loss: 0.608, Test accuracy: 72.30 

Round   9, Train loss: 0.433, Test loss: 0.560, Test accuracy: 75.40 

Round  10, Train loss: 0.425, Test loss: 0.591, Test accuracy: 75.20 

Round  11, Train loss: 0.382, Test loss: 0.642, Test accuracy: 74.00 

Round  12, Train loss: 0.375, Test loss: 0.501, Test accuracy: 76.40 

Round  13, Train loss: 0.363, Test loss: 0.589, Test accuracy: 77.10 

Round  14, Train loss: 0.334, Test loss: 0.606, Test accuracy: 76.40 

Round  15, Train loss: 0.327, Test loss: 0.569, Test accuracy: 76.90 

Round  16, Train loss: 0.342, Test loss: 0.738, Test accuracy: 73.10 

Round  17, Train loss: 0.284, Test loss: 0.554, Test accuracy: 77.90 

Round  18, Train loss: 0.279, Test loss: 0.572, Test accuracy: 78.00 

Round  19, Train loss: 0.281, Test loss: 0.712, Test accuracy: 75.10 

Round  20, Train loss: 0.248, Test loss: 0.483, Test accuracy: 80.70 

Round  21, Train loss: 0.246, Test loss: 0.473, Test accuracy: 81.10 

Round  22, Train loss: 0.219, Test loss: 0.562, Test accuracy: 78.40 

Round  23, Train loss: 0.226, Test loss: 0.546, Test accuracy: 80.50 

Round  24, Train loss: 0.207, Test loss: 0.439, Test accuracy: 83.70 

Round  25, Train loss: 0.204, Test loss: 0.489, Test accuracy: 81.50 

Round  26, Train loss: 0.206, Test loss: 0.470, Test accuracy: 81.40 

Round  27, Train loss: 0.176, Test loss: 0.459, Test accuracy: 82.40 

Round  28, Train loss: 0.158, Test loss: 0.431, Test accuracy: 84.00 

Round  29, Train loss: 0.149, Test loss: 0.465, Test accuracy: 82.50 

Round  30, Train loss: 0.147, Test loss: 0.532, Test accuracy: 81.30 

Round  31, Train loss: 0.137, Test loss: 0.447, Test accuracy: 85.50 

Round  32, Train loss: 0.139, Test loss: 0.479, Test accuracy: 83.60 

Round  33, Train loss: 0.140, Test loss: 0.553, Test accuracy: 81.50 

Round  34, Train loss: 0.120, Test loss: 0.566, Test accuracy: 81.70 

Round  35, Train loss: 0.100, Test loss: 0.575, Test accuracy: 81.40 

Round  36, Train loss: 0.103, Test loss: 0.516, Test accuracy: 83.50 

Round  37, Train loss: 0.104, Test loss: 0.515, Test accuracy: 83.70 

Round  38, Train loss: 0.116, Test loss: 0.520, Test accuracy: 82.50 

Round  39, Train loss: 0.091, Test loss: 0.541, Test accuracy: 83.80 

Round  40, Train loss: 0.080, Test loss: 0.473, Test accuracy: 86.00 

Round  41, Train loss: 0.087, Test loss: 0.562, Test accuracy: 82.70 

Round  42, Train loss: 0.073, Test loss: 0.561, Test accuracy: 84.50 

Round  43, Train loss: 0.093, Test loss: 0.546, Test accuracy: 83.50 

Round  44, Train loss: 0.075, Test loss: 0.496, Test accuracy: 84.80 

Round  45, Train loss: 0.062, Test loss: 0.588, Test accuracy: 83.20 

Round  46, Train loss: 0.063, Test loss: 0.567, Test accuracy: 83.50 

Round  47, Train loss: 0.048, Test loss: 0.556, Test accuracy: 84.50 

Round  48, Train loss: 0.054, Test loss: 0.539, Test accuracy: 83.80 

Round  49, Train loss: 0.053, Test loss: 0.481, Test accuracy: 85.50 

Final Round, Train loss: 0.043, Test loss: 0.490, Test accuracy: 85.50 

Average accuracy final 10 rounds: 84.19999999999999 

478.95678544044495
[3.8529515266418457, 5.598806619644165, 7.341428518295288, 9.06523609161377, 10.82580041885376, 12.6123046875, 14.368547916412354, 16.1148099899292, 17.957748889923096, 19.803252696990967, 21.650404691696167, 23.527056217193604, 25.352423191070557, 27.1820068359375, 28.99024200439453, 30.70063614845276, 32.51703333854675, 34.38970589637756, 36.19946241378784, 38.080480098724365, 39.86784243583679, 41.66977381706238, 43.634024143218994, 45.412038803100586, 47.27699685096741, 49.09614944458008, 50.90802764892578, 52.7050359249115, 54.48301553726196, 56.20370936393738, 58.010249376297, 59.83677697181702, 61.61332082748413, 63.36913347244263, 65.12671780586243, 66.89024496078491, 68.66169762611389, 70.4308249950409, 72.20321559906006, 73.92616200447083, 75.73710656166077, 77.51074171066284, 79.29960536956787, 80.9821138381958, 82.77169942855835, 84.49272179603577, 86.22688221931458, 87.98551821708679, 89.7357964515686, 91.53007078170776, 93.24798274040222]
[50.1, 58.3, 58.5, 58.6, 62.7, 65.5, 65.4, 72.8, 72.3, 75.4, 75.2, 74.0, 76.4, 77.1, 76.4, 76.9, 73.1, 77.9, 78.0, 75.1, 80.7, 81.1, 78.4, 80.5, 83.7, 81.5, 81.4, 82.4, 84.0, 82.5, 81.3, 85.5, 83.6, 81.5, 81.7, 81.4, 83.5, 83.7, 82.5, 83.8, 86.0, 82.7, 84.5, 83.5, 84.8, 83.2, 83.5, 84.5, 83.8, 85.5, 85.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.799, Test loss: 0.952, Test accuracy: 50.10
Round   1, Train loss: 0.721, Test loss: 1.045, Test accuracy: 55.10
Round   2, Train loss: 0.598, Test loss: 0.700, Test accuracy: 57.70
Round   3, Train loss: 0.648, Test loss: 1.547, Test accuracy: 52.20
Round   4, Train loss: 0.587, Test loss: 1.059, Test accuracy: 57.50
Round   5, Train loss: 0.520, Test loss: 0.653, Test accuracy: 68.00
Round   6, Train loss: 0.479, Test loss: 0.504, Test accuracy: 76.30
Round   7, Train loss: 0.448, Test loss: 0.686, Test accuracy: 73.60
Round   8, Train loss: 0.422, Test loss: 0.458, Test accuracy: 78.30
Round   9, Train loss: 0.400, Test loss: 0.670, Test accuracy: 72.30
Round  10, Train loss: 0.371, Test loss: 0.755, Test accuracy: 74.70
Round  11, Train loss: 0.354, Test loss: 0.434, Test accuracy: 81.20
Round  12, Train loss: 0.322, Test loss: 0.545, Test accuracy: 75.90
Round  13, Train loss: 0.307, Test loss: 0.514, Test accuracy: 76.70
Round  14, Train loss: 0.295, Test loss: 0.671, Test accuracy: 74.30
Round  15, Train loss: 0.282, Test loss: 0.569, Test accuracy: 77.20
Round  16, Train loss: 0.276, Test loss: 0.547, Test accuracy: 79.00
Round  17, Train loss: 0.242, Test loss: 0.468, Test accuracy: 81.90
Round  18, Train loss: 0.248, Test loss: 0.449, Test accuracy: 81.00
Round  19, Train loss: 0.227, Test loss: 0.468, Test accuracy: 81.30
Round  20, Train loss: 0.203, Test loss: 0.454, Test accuracy: 82.30
Round  21, Train loss: 0.186, Test loss: 0.428, Test accuracy: 83.00
Round  22, Train loss: 0.183, Test loss: 0.549, Test accuracy: 78.90
Round  23, Train loss: 0.167, Test loss: 0.461, Test accuracy: 83.00
Round  24, Train loss: 0.178, Test loss: 0.463, Test accuracy: 83.30
Round  25, Train loss: 0.154, Test loss: 0.454, Test accuracy: 83.00
Round  26, Train loss: 0.140, Test loss: 0.444, Test accuracy: 84.10
Round  27, Train loss: 0.142, Test loss: 0.550, Test accuracy: 81.40
Round  28, Train loss: 0.125, Test loss: 0.468, Test accuracy: 84.30
Round  29, Train loss: 0.127, Test loss: 0.448, Test accuracy: 84.20
Round  30, Train loss: 0.115, Test loss: 0.500, Test accuracy: 83.00
Round  31, Train loss: 0.110, Test loss: 0.409, Test accuracy: 85.90
Round  32, Train loss: 0.094, Test loss: 0.446, Test accuracy: 84.60
Round  33, Train loss: 0.096, Test loss: 0.451, Test accuracy: 85.30
Round  34, Train loss: 0.086, Test loss: 0.483, Test accuracy: 85.20
Round  35, Train loss: 0.095, Test loss: 0.501, Test accuracy: 84.70
Round  36, Train loss: 0.074, Test loss: 0.474, Test accuracy: 84.40
Round  37, Train loss: 0.070, Test loss: 0.448, Test accuracy: 85.50
Round  38, Train loss: 0.079, Test loss: 0.423, Test accuracy: 85.70
Round  39, Train loss: 0.069, Test loss: 0.460, Test accuracy: 85.60
Round  40, Train loss: 0.060, Test loss: 0.469, Test accuracy: 85.50
Round  41, Train loss: 0.061, Test loss: 0.445, Test accuracy: 86.10
Round  42, Train loss: 0.073, Test loss: 0.426, Test accuracy: 86.10
Round  43, Train loss: 0.042, Test loss: 0.421, Test accuracy: 87.20
Round  44, Train loss: 0.048, Test loss: 0.432, Test accuracy: 85.50
Round  45, Train loss: 0.031, Test loss: 0.435, Test accuracy: 86.20
Round  46, Train loss: 0.047, Test loss: 0.465, Test accuracy: 85.10
Round  47, Train loss: 0.047, Test loss: 0.442, Test accuracy: 86.50
Round  48, Train loss: 0.044, Test loss: 0.459, Test accuracy: 86.10
Round  49, Train loss: 0.039, Test loss: 0.453, Test accuracy: 85.90
Final Round, Train loss: 0.019, Test loss: 0.430, Test accuracy: 86.10
Average accuracy final 10 rounds: 86.02000000000001
537.1763246059418
[4.0028300285339355, 5.943973541259766, 7.956387758255005, 9.929825067520142, 11.979201078414917, 13.956309795379639, 15.990736484527588, 18.016249418258667, 19.985235929489136, 21.94647765159607, 23.93762993812561, 25.965794563293457, 28.03079867362976, 30.05504822731018, 32.111231327056885, 34.12956666946411, 36.30396318435669, 38.38954520225525, 40.45467495918274, 42.53696346282959, 44.55579590797424, 46.601481914520264, 48.595558881759644, 50.640198707580566, 52.625256061553955, 54.58955454826355, 56.59438395500183, 58.571330308914185, 60.619404792785645, 62.61574101448059, 64.61188507080078, 66.61532521247864, 68.68210434913635, 70.73196768760681, 72.76045298576355, 74.82062673568726, 76.77293848991394, 78.76312375068665, 80.84305119514465, 82.90489315986633, 84.85310101509094, 86.9288911819458, 88.9332823753357, 91.00458526611328, 93.03801918029785, 95.0669686794281, 97.15620064735413, 99.15522575378418, 101.17587518692017, 103.20958685874939, 105.32546043395996]
[50.1, 55.1, 57.7, 52.2, 57.5, 68.0, 76.3, 73.6, 78.3, 72.3, 74.7, 81.2, 75.9, 76.7, 74.3, 77.2, 79.0, 81.9, 81.0, 81.3, 82.3, 83.0, 78.9, 83.0, 83.3, 83.0, 84.1, 81.4, 84.3, 84.2, 83.0, 85.9, 84.6, 85.3, 85.2, 84.7, 84.4, 85.5, 85.7, 85.6, 85.5, 86.1, 86.1, 87.2, 85.5, 86.2, 85.1, 86.5, 86.1, 85.9, 86.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.236, Train accuracy: 91.500, Test loss: 0.681, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.149, Train accuracy: 92.500, Test loss: 0.611, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.139, Train accuracy: 95.000, Test loss: 0.760, Test accuracy: 72.50 

Round   0, Train loss: 0.139, Test loss: 0.760, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 0.703, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.140, Train accuracy: 92.500, Test loss: 0.734, Test accuracy: 71.00 

Round   1, Train loss: 0.140, Test loss: 0.734, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.075, Train accuracy: 97.500, Test loss: 0.690, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.076, Train accuracy: 97.000, Test loss: 0.627, Test accuracy: 75.50 

Round   2, Train loss: 0.076, Test loss: 0.627, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.104, Train accuracy: 95.500, Test loss: 0.780, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.085, Train accuracy: 96.000, Test loss: 0.814, Test accuracy: 70.00 

Round   3, Train loss: 0.085, Test loss: 0.814, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.000, Test loss: 0.795, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.102, Train accuracy: 94.000, Test loss: 0.930, Test accuracy: 74.50 

Round   4, Train loss: 0.102, Test loss: 0.930, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.052, Train accuracy: 98.500, Test loss: 0.915, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 98.000, Test loss: 0.803, Test accuracy: 76.50 

Round   5, Train loss: 0.050, Test loss: 0.803, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.786, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.843, Test accuracy: 77.50 

Round   6, Train loss: 0.025, Test loss: 0.843, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.389, Train accuracy: 84.000, Test loss: 1.293, Test accuracy: 68.00 

Round   7, Train loss: 0.389, Test loss: 1.293, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.085, Train accuracy: 96.000, Test loss: 0.881, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.707, Test accuracy: 78.00 

Round   8, Train loss: 0.015, Test loss: 0.707, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.699, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.824, Test accuracy: 78.50 

Round   9, Train loss: 0.013, Test loss: 0.824, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.723, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.075, Test accuracy: 75.50 

Round  10, Train loss: 0.009, Test loss: 1.075, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.227, Train accuracy: 92.000, Test loss: 0.978, Test accuracy: 70.50 

Round  11, Train loss: 0.227, Test loss: 0.978, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.052, Train accuracy: 97.500, Test loss: 1.016, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 77.00 

Round  12, Train loss: 0.008, Test loss: 0.826, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.865, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.885, Test accuracy: 76.00 

Round  13, Train loss: 0.002, Test loss: 0.885, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 78.00 

Round  14, Train loss: 0.015, Test loss: 0.718, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.628, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.808, Test accuracy: 76.00 

Round  15, Train loss: 0.015, Test loss: 0.808, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.723, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 77.50 

Round  16, Train loss: 0.005, Test loss: 0.951, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 75.50 

Round  17, Train loss: 0.009, Test loss: 0.915, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.818, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 75.50 

Round  18, Train loss: 0.001, Test loss: 0.930, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 74.50 

Round  19, Train loss: 0.001, Test loss: 1.098, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 77.00 

Final Round, Train loss: 0.002, Test loss: 1.000, Test accuracy: 77.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.500, Test loss: 0.996, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.645, Train accuracy: 71.000, Test loss: 0.643, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   1,  Train loss: 1.662, Train accuracy: 58.000, Test loss: 2.182, Test accuracy: 54.50 

Round   0, Train loss: 0.866, Test loss: 0.741, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 1.012, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.169, Train accuracy: 94.500, Test loss: 0.360, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.089, Train accuracy: 97.500, Test loss: 0.478, Test accuracy: 85.50 

Round   1, Train loss: 0.045, Test loss: 0.725, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.995, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.926, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.081, Train accuracy: 98.000, Test loss: 0.373, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.105, Train accuracy: 94.500, Test loss: 0.484, Test accuracy: 85.00 

Round   2, Train loss: 0.055, Test loss: 0.699, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.057, Train accuracy: 98.500, Test loss: 0.413, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.069, Train accuracy: 98.500, Test loss: 0.363, Test accuracy: 87.50 

Round   3, Train loss: 0.035, Test loss: 0.685, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 1.053, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.715, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.033, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.040, Train accuracy: 99.500, Test loss: 0.468, Test accuracy: 86.00 

Round   4, Train loss: 0.021, Test loss: 0.615, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.191, Train accuracy: 92.000, Test loss: 1.170, Test accuracy: 69.50 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.358, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.431, Test accuracy: 87.00 

Round   5, Train loss: 0.110, Test loss: 0.667, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.033, Train accuracy: 98.000, Test loss: 0.470, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 89.50 

Round   6, Train loss: 0.004, Test loss: 0.655, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.852, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.951, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 98.500, Test loss: 0.397, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 90.00 

Round   7, Train loss: 0.007, Test loss: 0.704, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.759, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.920, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.118, Train accuracy: 96.000, Test loss: 0.645, Test accuracy: 84.00 

Round   8, Train loss: 0.063, Test loss: 0.631, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 91.00 

Round   9, Train loss: 0.009, Test loss: 0.690, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.000, Test loss: 1.345, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.361, Test accuracy: 92.00 

Round  10, Train loss: 0.036, Test loss: 0.689, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.911, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 1.406, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.498, Test accuracy: 90.50 

Round  11, Train loss: 0.017, Test loss: 0.830, Test accuracy: 82.25 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.958, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.428, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 91.00 

Round  12, Train loss: 0.003, Test loss: 0.704, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.042, Train accuracy: 99.000, Test loss: 0.530, Test accuracy: 86.00 

Round  13, Train loss: 0.022, Test loss: 0.778, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.065, Train accuracy: 98.000, Test loss: 1.220, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.388, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 92.00 

Round  14, Train loss: 0.035, Test loss: 0.788, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.131, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.866, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 91.00 

Round  15, Train loss: 0.005, Test loss: 0.623, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.426, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.103, Train accuracy: 95.500, Test loss: 0.447, Test accuracy: 84.50 

Round  16, Train loss: 0.052, Test loss: 0.705, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.012, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.897, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.000, Test loss: 0.378, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 92.00 

Round  17, Train loss: 0.010, Test loss: 0.705, Test accuracy: 83.75 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.983, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 90.00 

Round  18, Train loss: 0.001, Test loss: 0.691, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.500, Test loss: 1.215, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.503, Test accuracy: 87.00 

Round  19, Train loss: 0.037, Test loss: 0.670, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.530, Test accuracy: 88.00 

Final Round, Train loss: 0.006, Test loss: 0.705, Test accuracy: 83.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 0.431, Test accuracy: 88.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.000, Test loss: 0.575, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.945, Train accuracy: 60.500, Test loss: 1.058, Test accuracy: 58.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.259, Train accuracy: 91.000, Test loss: 0.583, Test accuracy: 84.00 

Round   0, Train loss: 0.093, Test loss: 0.716, Test accuracy: 77.17 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.018, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.433, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.317, Train accuracy: 88.500, Test loss: 0.444, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.124, Train accuracy: 97.500, Test loss: 0.499, Test accuracy: 84.50 

Round   1, Train loss: 0.042, Test loss: 0.575, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.814, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.843, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.448, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.175, Train accuracy: 93.500, Test loss: 0.402, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.178, Train accuracy: 94.000, Test loss: 0.911, Test accuracy: 80.50 

Round   2, Train loss: 0.061, Test loss: 0.764, Test accuracy: 78.83 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.947, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.034, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.111, Train accuracy: 95.500, Test loss: 0.430, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.080, Train accuracy: 96.500, Test loss: 0.426, Test accuracy: 83.50 

Round   3, Train loss: 0.030, Test loss: 0.581, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.944, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.092, Train accuracy: 96.000, Test loss: 0.410, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.180, Train accuracy: 93.500, Test loss: 0.927, Test accuracy: 73.00 

Round   4, Train loss: 0.062, Test loss: 0.667, Test accuracy: 81.33 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.942, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.053, Train accuracy: 99.000, Test loss: 0.391, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.088, Train accuracy: 96.500, Test loss: 0.937, Test accuracy: 74.50 

Round   5, Train loss: 0.032, Test loss: 0.603, Test accuracy: 81.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.841, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 0.440, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 0.539, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.634, Test accuracy: 85.00 

Round   6, Train loss: 0.015, Test loss: 0.532, Test accuracy: 84.67 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.867, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.463, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.059, Train accuracy: 99.000, Test loss: 0.527, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.057, Train accuracy: 98.000, Test loss: 0.409, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.108, Train accuracy: 95.000, Test loss: 0.553, Test accuracy: 81.50 

Round   7, Train loss: 0.058, Test loss: 0.588, Test accuracy: 84.17 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.385, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.500, Test loss: 0.361, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.217, Train accuracy: 94.000, Test loss: 0.958, Test accuracy: 77.50 

Round   8, Train loss: 0.073, Test loss: 0.593, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.041, Train accuracy: 99.500, Test loss: 0.397, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.215, Train accuracy: 94.500, Test loss: 0.614, Test accuracy: 87.50 

Round   9, Train loss: 0.072, Test loss: 0.603, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.138, Train accuracy: 94.500, Test loss: 0.934, Test accuracy: 76.00 

Round  10, Train loss: 0.048, Test loss: 0.645, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.343, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.341, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.465, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.534, Test accuracy: 86.00 

Round  11, Train loss: 0.008, Test loss: 0.598, Test accuracy: 83.17 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.896, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.082, Train accuracy: 98.000, Test loss: 1.103, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.121, Train accuracy: 96.500, Test loss: 1.120, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.082, Train accuracy: 97.500, Test loss: 0.539, Test accuracy: 86.00 

Round  12, Train loss: 0.095, Test loss: 0.648, Test accuracy: 82.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.451, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.029, Train accuracy: 98.500, Test loss: 0.391, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.666, Test accuracy: 85.00 

Round  13, Train loss: 0.005, Test loss: 0.596, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 86.00 

Round  14, Train loss: 0.004, Test loss: 0.614, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.838, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.861, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.457, Test accuracy: 88.00 

Round  15, Train loss: 0.007, Test loss: 0.564, Test accuracy: 83.83 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 1.330, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.374, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.367, Train accuracy: 88.000, Test loss: 1.813, Test accuracy: 66.50 

Round  16, Train loss: 0.128, Test loss: 0.623, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.039, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.650, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.553, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 0.746, Test accuracy: 85.50 

Round  17, Train loss: 0.024, Test loss: 0.683, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.610, Test accuracy: 87.00 

Round  18, Train loss: 0.001, Test loss: 0.655, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.409, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.492, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.554, Test accuracy: 87.50 

Round  19, Train loss: 0.003, Test loss: 0.636, Test accuracy: 85.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.511, Test accuracy: 88.50 

Final Round, Train loss: 0.002, Test loss: 0.669, Test accuracy: 85.17 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.506, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.114, Train accuracy: 94.500, Test loss: 1.179, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.446, Train accuracy: 79.500, Test loss: 0.565, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.077, Train accuracy: 98.000, Test loss: 0.242, Test accuracy: 92.50 

Round   0, Train loss: 0.049, Test loss: 0.565, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.995, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.343, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.150, Train accuracy: 96.000, Test loss: 0.535, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.195, Train accuracy: 91.500, Test loss: 0.294, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.191, Train accuracy: 94.500, Test loss: 0.351, Test accuracy: 87.00 

Round   1, Train loss: 0.085, Test loss: 0.560, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.506, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.561, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.534, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.147, Train accuracy: 95.000, Test loss: 0.257, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.152, Train accuracy: 94.000, Test loss: 0.365, Test accuracy: 89.50 

Round   2, Train loss: 0.046, Test loss: 0.511, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.077, Train accuracy: 97.000, Test loss: 1.300, Test accuracy: 75.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.308, Train accuracy: 89.500, Test loss: 0.723, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.091, Train accuracy: 96.500, Test loss: 0.270, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 0.265, Test accuracy: 88.00 

Round   3, Train loss: 0.108, Test loss: 0.567, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.080, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.310, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.072, Train accuracy: 98.000, Test loss: 0.512, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.510, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.086, Train accuracy: 98.000, Test loss: 0.257, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 90.00 

Round   4, Train loss: 0.023, Test loss: 0.515, Test accuracy: 86.88 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.992, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.688, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.745, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.075, Train accuracy: 97.500, Test loss: 0.249, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.393, Train accuracy: 86.500, Test loss: 1.159, Test accuracy: 71.50 

Round   5, Train loss: 0.103, Test loss: 0.585, Test accuracy: 83.62 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.071, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.033, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.510, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.596, Test accuracy: 84.50 

        train local model (freeze embeding):client   3,  Train loss: 0.043, Train accuracy: 99.500, Test loss: 0.233, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.407, Test accuracy: 87.00 

Round   6, Train loss: 0.014, Test loss: 0.526, Test accuracy: 85.88 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.311, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.535, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.500, Test loss: 0.234, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.500, Test loss: 0.340, Test accuracy: 88.00 

Round   7, Train loss: 0.022, Test loss: 0.534, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.834, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.583, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.000, Test loss: 0.649, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.051, Train accuracy: 98.500, Test loss: 0.304, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 91.50 

Round   8, Train loss: 0.018, Test loss: 0.485, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.780, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.489, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.073, Train accuracy: 98.000, Test loss: 0.680, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.272, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

Round   9, Train loss: 0.021, Test loss: 0.480, Test accuracy: 87.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.106, Train accuracy: 95.500, Test loss: 0.842, Test accuracy: 82.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.604, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.271, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.292, Train accuracy: 88.500, Test loss: 1.270, Test accuracy: 72.50 

Round  10, Train loss: 0.102, Test loss: 0.536, Test accuracy: 85.62 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.831, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.813, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.370, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.541, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.055, Train accuracy: 99.000, Test loss: 0.562, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.238, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 92.00 

Round  11, Train loss: 0.016, Test loss: 0.480, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.538, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 89.50 

Round  12, Train loss: 0.004, Test loss: 0.514, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.213, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.405, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.585, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 87.50 

Round  13, Train loss: 0.010, Test loss: 0.516, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.824, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.704, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.396, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.638, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.078, Train accuracy: 97.000, Test loss: 0.401, Test accuracy: 91.00 

Round  14, Train loss: 0.024, Test loss: 0.471, Test accuracy: 86.88 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.307, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.688, Test accuracy: 85.50 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.305, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 92.00 

Round  15, Train loss: 0.002, Test loss: 0.516, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.374, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.604, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.411, Test accuracy: 88.50 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.243, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 88.50 

Round  16, Train loss: 0.008, Test loss: 0.521, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.927, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.549, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.095, Train accuracy: 95.500, Test loss: 0.525, Test accuracy: 85.00 

Round  17, Train loss: 0.024, Test loss: 0.516, Test accuracy: 86.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.359, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.614, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.121, Train accuracy: 95.500, Test loss: 1.782, Test accuracy: 72.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 92.50 

Round  18, Train loss: 0.032, Test loss: 0.577, Test accuracy: 85.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.070, Train accuracy: 97.500, Test loss: 1.753, Test accuracy: 73.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.357, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.261, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.176, Train accuracy: 95.000, Test loss: 0.276, Test accuracy: 91.00 

Round  19, Train loss: 0.063, Test loss: 0.497, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.146, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.355, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.529, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.252, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.258, Test accuracy: 91.00 

Final Round, Train loss: 0.002, Test loss: 0.490, Test accuracy: 87.25 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.587, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.030, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.594, Test accuracy: 87.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.592, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.288, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 89.50 

        train local model (freeze embeding):client   4,  Train loss: 0.652, Train accuracy: 66.500, Test loss: 0.854, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.236, Train accuracy: 91.500, Test loss: 0.694, Test accuracy: 74.00 

Round   0, Train loss: 0.053, Test loss: 0.556, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 1.115, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.536, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.522, Test accuracy: 88.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.259, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 98.000, Test loss: 0.296, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.462, Train accuracy: 76.500, Test loss: 0.726, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.145, Train accuracy: 94.000, Test loss: 0.847, Test accuracy: 75.00 

Round   1, Train loss: 0.040, Test loss: 0.567, Test accuracy: 84.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.894, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.806, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.391, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 87.50 

        train local model (freeze embeding):client   4,  Train loss: 0.278, Train accuracy: 89.500, Test loss: 0.723, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.189, Train accuracy: 93.000, Test loss: 0.859, Test accuracy: 76.00 

Round   2, Train loss: 0.039, Test loss: 0.558, Test accuracy: 83.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.889, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.191, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.514, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.605, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.253, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.333, Train accuracy: 83.000, Test loss: 0.982, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.263, Train accuracy: 90.500, Test loss: 1.028, Test accuracy: 74.50 

Round   3, Train loss: 0.055, Test loss: 0.606, Test accuracy: 83.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.418, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.523, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 0.741, Test accuracy: 82.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.182, Train accuracy: 93.500, Test loss: 0.707, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.109, Train accuracy: 94.500, Test loss: 1.028, Test accuracy: 77.50 

Round   4, Train loss: 0.038, Test loss: 0.565, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.911, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.011, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.000, Test loss: 0.375, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.557, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.066, Train accuracy: 97.500, Test loss: 1.339, Test accuracy: 79.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.149, Train accuracy: 94.500, Test loss: 0.738, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.157, Train accuracy: 93.000, Test loss: 0.763, Test accuracy: 77.00 

Round   5, Train loss: 0.048, Test loss: 0.596, Test accuracy: 84.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.387, Test accuracy: 76.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.364, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.434, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.664, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.563, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.223, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.616, Test accuracy: 89.00 

        train local model (freeze embeding):client   4,  Train loss: 0.136, Train accuracy: 94.500, Test loss: 0.763, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.177, Train accuracy: 92.000, Test loss: 0.819, Test accuracy: 76.00 

Round   6, Train loss: 0.041, Test loss: 0.577, Test accuracy: 83.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 0.753, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.314, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.566, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.261, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.294, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.068, Train accuracy: 98.000, Test loss: 0.764, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.123, Train accuracy: 94.000, Test loss: 0.998, Test accuracy: 74.00 

Round   7, Train loss: 0.041, Test loss: 0.534, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.379, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.109, Train accuracy: 95.500, Test loss: 0.861, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.120, Train accuracy: 95.000, Test loss: 0.900, Test accuracy: 80.50 

Round   8, Train loss: 0.025, Test loss: 0.543, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.359, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 99.000, Test loss: 0.825, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.600, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.221, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.165, Test accuracy: 95.00 

        train local model (freeze embeding):client   4,  Train loss: 0.052, Train accuracy: 99.000, Test loss: 0.845, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 0.911, Test accuracy: 79.00 

Round   9, Train loss: 0.020, Test loss: 0.572, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.771, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.840, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.269, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.500, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.061, Train accuracy: 98.000, Test loss: 0.637, Test accuracy: 84.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 0.829, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.028, Train accuracy: 100.000, Test loss: 0.670, Test accuracy: 82.00 

Round  10, Train loss: 0.019, Test loss: 0.523, Test accuracy: 85.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.060, Train accuracy: 98.500, Test loss: 1.023, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.276, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.444, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.043, Train accuracy: 99.000, Test loss: 0.805, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.920, Test accuracy: 82.00 

Round  11, Train loss: 0.019, Test loss: 0.546, Test accuracy: 84.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.279, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.391, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.259, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 0.847, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.073, Train accuracy: 97.000, Test loss: 0.850, Test accuracy: 79.50 

Round  12, Train loss: 0.017, Test loss: 0.496, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.710, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.773, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.120, Train accuracy: 95.500, Test loss: 0.860, Test accuracy: 85.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.050, Train accuracy: 98.000, Test loss: 0.725, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.023, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.059, Train accuracy: 97.000, Test loss: 0.944, Test accuracy: 79.50 

Round  13, Train loss: 0.046, Test loss: 0.566, Test accuracy: 84.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.730, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.575, Test accuracy: 86.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.179, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.272, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.034, Train accuracy: 99.500, Test loss: 0.983, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.393, Train accuracy: 87.500, Test loss: 1.583, Test accuracy: 74.50 

Round  14, Train loss: 0.080, Test loss: 0.547, Test accuracy: 86.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.097, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.185, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.103, Train accuracy: 96.000, Test loss: 0.716, Test accuracy: 87.50 

        train local model (freeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.897, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 1.106, Test accuracy: 78.00 

Round  15, Train loss: 0.042, Test loss: 0.592, Test accuracy: 84.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.878, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.483, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.433, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.171, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.160, Train accuracy: 91.500, Test loss: 0.461, Test accuracy: 87.50 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.071, Test accuracy: 80.00 

Round  16, Train loss: 0.038, Test loss: 0.579, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.900, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.765, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.451, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.196, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.239, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.000, Test loss: 0.946, Test accuracy: 78.00 

Round  17, Train loss: 0.010, Test loss: 0.545, Test accuracy: 86.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.797, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.772, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.280, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.412, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.552, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.203, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.268, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.872, Test accuracy: 80.00 

Round  18, Train loss: 0.011, Test loss: 0.522, Test accuracy: 87.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.456, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 91.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 93.50 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.172, Train accuracy: 94.000, Test loss: 1.216, Test accuracy: 80.00 

Round  19, Train loss: 0.035, Test loss: 0.522, Test accuracy: 86.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.782, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.713, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.175, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.202, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.861, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.834, Test accuracy: 81.00 

Final Round, Train loss: 0.003, Test loss: 0.511, Test accuracy: 87.40 

Average accuracy final 10 rounds: 414.74000000000007 

1306.5915307998657
[4.14003586769104, 7.986558675765991, 11.777947425842285, 15.64862060546875, 19.40443229675293, 23.10892939567566, 27.142395496368408, 31.193804264068604, 35.04754304885864, 38.834198236465454, 42.79934215545654, 46.43885922431946, 50.331165075302124, 54.16330885887146, 58.00893759727478, 61.978076457977295, 65.5567934513092, 69.28047680854797, 72.77765464782715, 76.75477886199951, 79.60935354232788, 83.5475423336029, 87.35226035118103, 91.12452101707458, 94.973552942276, 98.80802798271179, 102.70317697525024, 106.59814882278442, 110.52767252922058, 114.18822741508484, 118.190927028656, 122.12935018539429, 125.92975091934204, 129.63377451896667, 133.67402267456055, 137.43557620048523, 141.40081024169922, 145.13174104690552, 148.81936717033386, 152.3598599433899, 156.38278245925903, 159.18452191352844, 163.28150939941406, 167.1536259651184, 171.27991366386414, 175.30278205871582, 179.2957956790924, 183.0311803817749, 186.94680070877075, 190.92517852783203, 194.9254071712494, 198.88746738433838, 202.82745814323425, 206.82428646087646, 210.88575768470764, 214.54287195205688, 218.66776847839355, 222.44136142730713, 226.55881071090698, 230.4947485923767, 234.30773901939392, 238.34151124954224, 240.71077728271484, 244.53949284553528, 248.35977959632874, 252.0093777179718, 256.0104486942291, 260.0543761253357, 263.90444779396057, 267.89573097229004, 271.8872127532959, 275.8813908100128, 279.7375783920288, 283.55587816238403, 287.60156536102295, 291.4958305358887, 295.5958971977234, 299.67443084716797, 303.87057971954346, 308.03135561943054, 311.8023359775543, 315.79228162765503, 319.7764675617218, 322.4805681705475, 326.5026340484619, 330.36909008026123, 334.51129961013794, 338.67205715179443, 342.55499625205994, 346.5025432109833, 350.43748807907104, 354.63518714904785, 358.809223651886, 363.1259617805481, 367.06992626190186, 370.98050808906555, 374.81306314468384, 378.6857018470764, 382.6970434188843, 386.76800990104675, 391.00393438339233, 395.0039186477661, 398.994047164917, 403.0324990749359, 405.27863335609436]
[72.5, 71.0, 75.5, 70.0, 74.5, 76.5, 77.5, 68.0, 78.0, 78.5, 75.5, 70.5, 77.0, 76.0, 78.0, 76.0, 77.5, 75.5, 75.5, 74.5, 77.0, 76.75, 81.5, 82.75, 80.0, 82.75, 79.75, 83.75, 82.75, 83.5, 83.0, 82.0, 82.25, 84.0, 83.75, 84.75, 82.5, 81.75, 83.75, 83.5, 82.75, 83.0, 77.16666666666667, 83.5, 78.83333333333333, 82.66666666666667, 81.33333333333333, 81.66666666666667, 84.66666666666667, 84.16666666666667, 83.16666666666667, 83.83333333333333, 82.0, 83.16666666666667, 82.66666666666667, 85.0, 83.83333333333333, 83.83333333333333, 82.5, 85.33333333333333, 85.5, 85.16666666666667, 85.16666666666667, 85.5, 85.25, 86.25, 85.125, 86.875, 83.625, 85.875, 86.5, 87.5, 87.0, 85.625, 86.25, 85.5, 86.25, 86.875, 87.25, 87.25, 86.875, 85.125, 86.5, 87.25, 83.2, 84.2, 83.7, 83.9, 84.5, 84.3, 83.2, 85.0, 85.3, 85.5, 85.1, 84.4, 86.5, 84.9, 86.1, 84.9, 85.5, 86.2, 87.4, 86.9, 87.4]
