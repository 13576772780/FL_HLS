nohup: 忽略输入
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.499, Test loss: 1.470, Test accuracy: 47.48 

Round   0, Global train loss: 1.499, Global test loss: 2.411, Global test accuracy: 16.00 

Round   1, Train loss: 1.210, Test loss: 1.263, Test accuracy: 51.60 

Round   1, Global train loss: 1.210, Global test loss: 2.386, Global test accuracy: 16.00 

Round   2, Train loss: 1.044, Test loss: 1.200, Test accuracy: 57.04 

Round   2, Global train loss: 1.044, Global test loss: 2.417, Global test accuracy: 18.24 

Round   3, Train loss: 0.911, Test loss: 1.488, Test accuracy: 53.60 

Round   3, Global train loss: 0.911, Global test loss: 2.416, Global test accuracy: 16.00 

Round   4, Train loss: 0.770, Test loss: 1.562, Test accuracy: 52.16 

Round   4, Global train loss: 0.770, Global test loss: 2.431, Global test accuracy: 16.24 

Round   5, Train loss: 0.683, Test loss: 1.381, Test accuracy: 59.96 

Round   5, Global train loss: 0.683, Global test loss: 2.405, Global test accuracy: 18.72 

Round   6, Train loss: 0.580, Test loss: 1.449, Test accuracy: 58.40 

Round   6, Global train loss: 0.580, Global test loss: 2.350, Global test accuracy: 17.28 

Round   7, Train loss: 0.478, Test loss: 1.360, Test accuracy: 61.56 

Round   7, Global train loss: 0.478, Global test loss: 2.297, Global test accuracy: 19.48 

Round   8, Train loss: 0.429, Test loss: 1.957, Test accuracy: 56.24 

Round   8, Global train loss: 0.429, Global test loss: 2.308, Global test accuracy: 17.12 

Round   9, Train loss: 0.339, Test loss: 1.364, Test accuracy: 64.12 

Round   9, Global train loss: 0.339, Global test loss: 2.365, Global test accuracy: 18.44 

Round  10, Train loss: 0.314, Test loss: 1.531, Test accuracy: 62.52 

Round  10, Global train loss: 0.314, Global test loss: 2.313, Global test accuracy: 17.80 

Round  11, Train loss: 0.261, Test loss: 1.778, Test accuracy: 59.92 

Round  11, Global train loss: 0.261, Global test loss: 2.330, Global test accuracy: 14.40 

Round  12, Train loss: 0.222, Test loss: 1.816, Test accuracy: 61.16 

Round  12, Global train loss: 0.222, Global test loss: 2.314, Global test accuracy: 12.92 

Round  13, Train loss: 0.182, Test loss: 1.611, Test accuracy: 63.20 

Round  13, Global train loss: 0.182, Global test loss: 2.294, Global test accuracy: 14.56 

Round  14, Train loss: 0.158, Test loss: 1.727, Test accuracy: 64.84 

Round  14, Global train loss: 0.158, Global test loss: 2.317, Global test accuracy: 14.32 

Round  15, Train loss: 0.149, Test loss: 1.964, Test accuracy: 63.16 

Round  15, Global train loss: 0.149, Global test loss: 2.333, Global test accuracy: 12.80 

Round  16, Train loss: 0.121, Test loss: 1.790, Test accuracy: 65.24 

Round  16, Global train loss: 0.121, Global test loss: 2.349, Global test accuracy: 12.32 

Round  17, Train loss: 0.110, Test loss: 1.817, Test accuracy: 65.08 

Round  17, Global train loss: 0.110, Global test loss: 2.297, Global test accuracy: 13.48 

Round  18, Train loss: 0.094, Test loss: 1.857, Test accuracy: 64.40 

Round  18, Global train loss: 0.094, Global test loss: 2.328, Global test accuracy: 12.44 

Round  19, Train loss: 0.089, Test loss: 1.829, Test accuracy: 65.64 

Round  19, Global train loss: 0.089, Global test loss: 2.318, Global test accuracy: 13.36 

Round  20, Train loss: 0.084, Test loss: 1.894, Test accuracy: 64.76 

Round  20, Global train loss: 0.084, Global test loss: 2.336, Global test accuracy: 13.36 

Round  21, Train loss: 0.095, Test loss: 1.814, Test accuracy: 64.32 

Round  21, Global train loss: 0.095, Global test loss: 2.311, Global test accuracy: 13.16 

Round  22, Train loss: 0.077, Test loss: 1.812, Test accuracy: 64.96 

Round  22, Global train loss: 0.077, Global test loss: 2.322, Global test accuracy: 12.28 

Round  23, Train loss: 0.058, Test loss: 1.829, Test accuracy: 66.44 

Round  23, Global train loss: 0.058, Global test loss: 2.309, Global test accuracy: 13.16 

Round  24, Train loss: 0.051, Test loss: 2.001, Test accuracy: 63.84 

Round  24, Global train loss: 0.051, Global test loss: 2.285, Global test accuracy: 13.16 

Round  25, Train loss: 0.059, Test loss: 1.963, Test accuracy: 65.12 

Round  25, Global train loss: 0.059, Global test loss: 2.284, Global test accuracy: 13.12 

Round  26, Train loss: 0.046, Test loss: 1.985, Test accuracy: 64.52 

Round  26, Global train loss: 0.046, Global test loss: 2.275, Global test accuracy: 12.68 

Round  27, Train loss: 0.040, Test loss: 2.140, Test accuracy: 64.52 

Round  27, Global train loss: 0.040, Global test loss: 2.318, Global test accuracy: 12.32 

Round  28, Train loss: 0.043, Test loss: 1.906, Test accuracy: 65.60 

Round  28, Global train loss: 0.043, Global test loss: 2.300, Global test accuracy: 12.20 

Round  29, Train loss: 0.030, Test loss: 1.859, Test accuracy: 66.68 

Round  29, Global train loss: 0.030, Global test loss: 2.311, Global test accuracy: 13.44 

Round  30, Train loss: 0.025, Test loss: 1.924, Test accuracy: 66.04 

Round  30, Global train loss: 0.025, Global test loss: 2.292, Global test accuracy: 13.28 

Round  31, Train loss: 0.022, Test loss: 1.965, Test accuracy: 66.48 

Round  31, Global train loss: 0.022, Global test loss: 2.273, Global test accuracy: 14.56 

Round  32, Train loss: 0.029, Test loss: 2.005, Test accuracy: 66.80 

Round  32, Global train loss: 0.029, Global test loss: 2.292, Global test accuracy: 14.20 

Round  33, Train loss: 0.026, Test loss: 2.008, Test accuracy: 66.88 

Round  33, Global train loss: 0.026, Global test loss: 2.295, Global test accuracy: 12.80 

Round  34, Train loss: 0.024, Test loss: 2.179, Test accuracy: 66.24 

Round  34, Global train loss: 0.024, Global test loss: 2.297, Global test accuracy: 13.44 

Final Round, Train loss: 0.029, Test loss: 1.893, Test accuracy: 67.08 

Final Round, Global train loss: 0.029, Global test loss: 2.297, Global test accuracy: 13.44 

Average accuracy final 10 rounds: 65.888 

Average global accuracy final 10 rounds: 13.203999999999997 

1214.1340816020966
[7.71282172203064, 13.503298997879028, 19.22026515007019, 24.719441175460815, 30.518497228622437, 36.28191590309143, 41.90579843521118, 47.735129833221436, 53.48057460784912, 59.2068030834198, 64.92047381401062, 70.68058490753174, 76.06546330451965, 81.95770001411438, 87.70449566841125, 93.27204036712646, 98.75515222549438, 104.35057234764099, 110.16318559646606, 115.72459030151367, 121.38509368896484, 126.96116662025452, 133.00035881996155, 138.628178358078, 144.3180856704712, 150.02165389060974, 155.7523853778839, 162.1490433216095, 168.07528376579285, 173.99755811691284, 180.75415205955505, 187.71163725852966, 194.93874430656433, 202.0840196609497, 209.84225749969482, 224.001145362854]
[47.48, 51.6, 57.04, 53.6, 52.16, 59.96, 58.4, 61.56, 56.24, 64.12, 62.52, 59.92, 61.16, 63.2, 64.84, 63.16, 65.24, 65.08, 64.4, 65.64, 64.76, 64.32, 64.96, 66.44, 63.84, 65.12, 64.52, 64.52, 65.6, 66.68, 66.04, 66.48, 66.8, 66.88, 66.24, 67.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.520, Test loss: 1.256, Test accuracy: 48.64 

Round   0, Global train loss: 1.520, Global test loss: 2.257, Global test accuracy: 16.60 

Round   1, Train loss: 1.390, Test loss: 1.296, Test accuracy: 50.08 

Round   1, Global train loss: 1.390, Global test loss: 2.185, Global test accuracy: 21.60 

Round   2, Train loss: 1.268, Test loss: 1.222, Test accuracy: 53.16 

Round   2, Global train loss: 1.268, Global test loss: 1.843, Global test accuracy: 36.52 

Round   3, Train loss: 1.169, Test loss: 1.126, Test accuracy: 57.40 

Round   3, Global train loss: 1.169, Global test loss: 1.766, Global test accuracy: 37.36 

Round   4, Train loss: 1.079, Test loss: 1.180, Test accuracy: 56.76 

Round   4, Global train loss: 1.079, Global test loss: 1.602, Global test accuracy: 44.76 

Round   5, Train loss: 0.995, Test loss: 1.296, Test accuracy: 55.16 

Round   5, Global train loss: 0.995, Global test loss: 1.673, Global test accuracy: 39.64 

Round   6, Train loss: 0.928, Test loss: 1.120, Test accuracy: 59.92 

Round   6, Global train loss: 0.928, Global test loss: 1.547, Global test accuracy: 46.64 

Round   7, Train loss: 0.853, Test loss: 1.124, Test accuracy: 62.32 

Round   7, Global train loss: 0.853, Global test loss: 1.548, Global test accuracy: 47.84 

Round   8, Train loss: 0.802, Test loss: 1.309, Test accuracy: 61.60 

Round   8, Global train loss: 0.802, Global test loss: 1.476, Global test accuracy: 50.52 

Round   9, Train loss: 0.757, Test loss: 1.231, Test accuracy: 61.12 

Round   9, Global train loss: 0.757, Global test loss: 1.436, Global test accuracy: 50.72 

Round  10, Train loss: 0.720, Test loss: 1.101, Test accuracy: 63.76 

Round  10, Global train loss: 0.720, Global test loss: 1.480, Global test accuracy: 50.44 

Round  11, Train loss: 0.662, Test loss: 1.179, Test accuracy: 63.28 

Round  11, Global train loss: 0.662, Global test loss: 1.448, Global test accuracy: 52.60 

Round  12, Train loss: 0.615, Test loss: 1.350, Test accuracy: 62.48 

Round  12, Global train loss: 0.615, Global test loss: 1.406, Global test accuracy: 53.40 

Round  13, Train loss: 0.578, Test loss: 1.206, Test accuracy: 65.28 

Round  13, Global train loss: 0.578, Global test loss: 1.405, Global test accuracy: 54.64 

Round  14, Train loss: 0.540, Test loss: 1.337, Test accuracy: 61.44 

Round  14, Global train loss: 0.540, Global test loss: 1.311, Global test accuracy: 56.52 

Round  15, Train loss: 0.510, Test loss: 1.281, Test accuracy: 64.16 

Round  15, Global train loss: 0.510, Global test loss: 1.314, Global test accuracy: 57.52 

Round  16, Train loss: 0.469, Test loss: 1.403, Test accuracy: 64.16 

Round  16, Global train loss: 0.469, Global test loss: 1.281, Global test accuracy: 58.72 

Round  17, Train loss: 0.421, Test loss: 1.223, Test accuracy: 68.00 

Round  17, Global train loss: 0.421, Global test loss: 1.236, Global test accuracy: 59.96 

Round  18, Train loss: 0.424, Test loss: 1.097, Test accuracy: 69.24 

Round  18, Global train loss: 0.424, Global test loss: 1.295, Global test accuracy: 58.80 

Round  19, Train loss: 0.367, Test loss: 1.395, Test accuracy: 66.76 

Round  19, Global train loss: 0.367, Global test loss: 1.313, Global test accuracy: 60.52 

Round  20, Train loss: 0.368, Test loss: 1.198, Test accuracy: 67.52 

Round  20, Global train loss: 0.368, Global test loss: 1.245, Global test accuracy: 61.80 

Round  21, Train loss: 0.350, Test loss: 1.289, Test accuracy: 67.24 

Round  21, Global train loss: 0.350, Global test loss: 1.369, Global test accuracy: 58.76 

Round  22, Train loss: 0.315, Test loss: 1.517, Test accuracy: 64.96 

Round  22, Global train loss: 0.315, Global test loss: 1.220, Global test accuracy: 62.76 

Round  23, Train loss: 0.300, Test loss: 1.231, Test accuracy: 67.32 

Round  23, Global train loss: 0.300, Global test loss: 1.206, Global test accuracy: 62.08 

Round  24, Train loss: 0.266, Test loss: 1.260, Test accuracy: 69.16 

Round  24, Global train loss: 0.266, Global test loss: 1.296, Global test accuracy: 62.12 

Round  25, Train loss: 0.257, Test loss: 1.162, Test accuracy: 70.88 

Round  25, Global train loss: 0.257, Global test loss: 1.230, Global test accuracy: 62.16 

Round  26, Train loss: 0.261, Test loss: 1.254, Test accuracy: 70.16 

Round  26, Global train loss: 0.261, Global test loss: 1.284, Global test accuracy: 62.28 

Round  27, Train loss: 0.230, Test loss: 1.345, Test accuracy: 70.12 

Round  27, Global train loss: 0.230, Global test loss: 1.229, Global test accuracy: 63.28 

Round  28, Train loss: 0.201, Test loss: 1.373, Test accuracy: 68.08 

Round  28, Global train loss: 0.201, Global test loss: 1.304, Global test accuracy: 63.96 

Round  29, Train loss: 0.217, Test loss: 1.490, Test accuracy: 67.52 

Round  29, Global train loss: 0.217, Global test loss: 1.240, Global test accuracy: 63.84 

Round  30, Train loss: 0.181, Test loss: 1.320, Test accuracy: 70.24 

Round  30, Global train loss: 0.181, Global test loss: 1.231, Global test accuracy: 63.80 

Round  31, Train loss: 0.183, Test loss: 1.556, Test accuracy: 67.72 

Round  31, Global train loss: 0.183, Global test loss: 1.371, Global test accuracy: 61.84 

Round  32, Train loss: 0.179, Test loss: 1.406, Test accuracy: 68.56 

Round  32, Global train loss: 0.179, Global test loss: 1.273, Global test accuracy: 64.36 

Round  33, Train loss: 0.173, Test loss: 1.312, Test accuracy: 70.48 

Round  33, Global train loss: 0.173, Global test loss: 1.286, Global test accuracy: 64.04 

Round  34, Train loss: 0.151, Test loss: 1.265, Test accuracy: 71.36 

Round  34, Global train loss: 0.151, Global test loss: 1.232, Global test accuracy: 65.28 

Round  35, Train loss: 0.148, Test loss: 1.418, Test accuracy: 71.28 

Round  35, Global train loss: 0.148, Global test loss: 1.241, Global test accuracy: 65.00 

Round  36, Train loss: 0.161, Test loss: 1.618, Test accuracy: 68.80 

Round  36, Global train loss: 0.161, Global test loss: 1.262, Global test accuracy: 65.60 

Round  37, Train loss: 0.118, Test loss: 1.272, Test accuracy: 72.88 

Round  37, Global train loss: 0.118, Global test loss: 1.221, Global test accuracy: 66.12 

Round  38, Train loss: 0.114, Test loss: 1.290, Test accuracy: 72.44 

Round  38, Global train loss: 0.114, Global test loss: 1.242, Global test accuracy: 65.60 

Round  39, Train loss: 0.112, Test loss: 1.413, Test accuracy: 70.64 

Round  39, Global train loss: 0.112, Global test loss: 1.279, Global test accuracy: 65.40 

Round  40, Train loss: 0.120, Test loss: 1.424, Test accuracy: 70.64 

Round  40, Global train loss: 0.120, Global test loss: 1.223, Global test accuracy: 66.48 

Round  41, Train loss: 0.113, Test loss: 1.544, Test accuracy: 68.68 

Round  41, Global train loss: 0.113, Global test loss: 1.378, Global test accuracy: 64.12 

Round  42, Train loss: 0.103, Test loss: 1.395, Test accuracy: 71.40 

Round  42, Global train loss: 0.103, Global test loss: 1.244, Global test accuracy: 66.52 

Round  43, Train loss: 0.100, Test loss: 1.212, Test accuracy: 73.68 

Round  43, Global train loss: 0.100, Global test loss: 1.257, Global test accuracy: 65.88 

Round  44, Train loss: 0.085, Test loss: 1.538, Test accuracy: 69.28 

Round  44, Global train loss: 0.085, Global test loss: 1.301, Global test accuracy: 65.64 

Round  45, Train loss: 0.063, Test loss: 1.299, Test accuracy: 73.80 

Round  45, Global train loss: 0.063, Global test loss: 1.300, Global test accuracy: 65.40 

Round  46, Train loss: 0.066, Test loss: 1.416, Test accuracy: 72.20 

Round  46, Global train loss: 0.066, Global test loss: 1.313, Global test accuracy: 66.20 

Round  47, Train loss: 0.090, Test loss: 1.338, Test accuracy: 72.76 

Round  47, Global train loss: 0.090, Global test loss: 1.273, Global test accuracy: 66.76 

Round  48, Train loss: 0.054, Test loss: 1.390, Test accuracy: 72.60 

Round  48, Global train loss: 0.054, Global test loss: 1.280, Global test accuracy: 67.20 

Round  49, Train loss: 0.069, Test loss: 1.296, Test accuracy: 74.32 

Round  49, Global train loss: 0.069, Global test loss: 1.236, Global test accuracy: 67.20 

Final Round, Train loss: 0.091, Test loss: 1.382, Test accuracy: 72.04 

Final Round, Global train loss: 0.091, Global test loss: 1.236, Global test accuracy: 67.20 

Average accuracy final 10 rounds: 71.936 

Average global accuracy final 10 rounds: 66.14 

2140.909994363785
[13.455690145492554, 20.552118062973022, 27.73381781578064, 35.04906606674194, 42.24286723136902, 49.21107792854309, 56.16861033439636, 63.40902233123779, 70.40920090675354, 77.39542603492737, 84.52686500549316, 91.55582427978516, 98.65611457824707, 106.19953155517578, 113.26006174087524, 120.32301354408264, 127.33213138580322, 134.46292448043823, 141.36845922470093, 148.4048261642456, 155.44305634498596, 162.6182336807251, 169.52160811424255, 176.56716966629028, 183.57358574867249, 190.62192296981812, 197.76439332962036, 204.84000825881958, 211.93511486053467, 219.15029311180115, 226.15290474891663, 233.261079788208, 240.20929479599, 247.18306183815002, 254.20624995231628, 261.2715673446655, 268.3697340488434, 275.4992866516113, 282.6697189807892, 289.79822158813477, 296.77772855758667, 303.72769689559937, 310.67720222473145, 317.81458711624146, 324.90081787109375, 331.9034743309021, 338.9916481971741, 345.95500779151917, 353.09674739837646, 360.1420352458954, 374.0474154949188]
[48.64, 50.08, 53.16, 57.4, 56.76, 55.16, 59.92, 62.32, 61.6, 61.12, 63.76, 63.28, 62.48, 65.28, 61.44, 64.16, 64.16, 68.0, 69.24, 66.76, 67.52, 67.24, 64.96, 67.32, 69.16, 70.88, 70.16, 70.12, 68.08, 67.52, 70.24, 67.72, 68.56, 70.48, 71.36, 71.28, 68.8, 72.88, 72.44, 70.64, 70.64, 68.68, 71.4, 73.68, 69.28, 73.8, 72.2, 72.76, 72.6, 74.32, 72.04]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.590, Test loss: 1.799, Test accuracy: 22.32 

Round   1, Train loss: 1.440, Test loss: 1.615, Test accuracy: 29.52 

Round   2, Train loss: 1.317, Test loss: 1.319, Test accuracy: 42.08 

Round   3, Train loss: 1.212, Test loss: 1.253, Test accuracy: 47.40 

Round   4, Train loss: 1.141, Test loss: 1.120, Test accuracy: 52.04 

Round   5, Train loss: 1.071, Test loss: 1.095, Test accuracy: 56.16 

Round   6, Train loss: 1.006, Test loss: 1.078, Test accuracy: 55.76 

Round   7, Train loss: 0.967, Test loss: 1.082, Test accuracy: 56.88 

Round   8, Train loss: 0.913, Test loss: 0.975, Test accuracy: 61.40 

Round   9, Train loss: 0.875, Test loss: 0.986, Test accuracy: 61.72 

Round  10, Train loss: 0.830, Test loss: 0.963, Test accuracy: 63.24 

Round  11, Train loss: 0.773, Test loss: 0.980, Test accuracy: 62.88 

Round  12, Train loss: 0.745, Test loss: 0.972, Test accuracy: 63.12 

Round  13, Train loss: 0.710, Test loss: 1.017, Test accuracy: 63.52 

Round  14, Train loss: 0.662, Test loss: 0.970, Test accuracy: 63.80 

Round  15, Train loss: 0.651, Test loss: 0.911, Test accuracy: 66.88 

Round  16, Train loss: 0.608, Test loss: 0.875, Test accuracy: 69.32 

Round  17, Train loss: 0.567, Test loss: 0.805, Test accuracy: 71.60 

Round  18, Train loss: 0.534, Test loss: 0.857, Test accuracy: 69.28 

Round  19, Train loss: 0.514, Test loss: 0.924, Test accuracy: 69.32 

Round  20, Train loss: 0.499, Test loss: 0.864, Test accuracy: 70.00 

Round  21, Train loss: 0.469, Test loss: 0.807, Test accuracy: 71.92 

Round  22, Train loss: 0.431, Test loss: 0.830, Test accuracy: 71.92 

Round  23, Train loss: 0.419, Test loss: 0.824, Test accuracy: 72.40 

Round  24, Train loss: 0.407, Test loss: 0.840, Test accuracy: 71.88 

Round  25, Train loss: 0.372, Test loss: 0.819, Test accuracy: 72.96 

Round  26, Train loss: 0.351, Test loss: 0.795, Test accuracy: 73.88 

Round  27, Train loss: 0.322, Test loss: 0.821, Test accuracy: 73.48 

Round  28, Train loss: 0.332, Test loss: 0.819, Test accuracy: 74.08 

Round  29, Train loss: 0.296, Test loss: 0.872, Test accuracy: 73.08 

Round  30, Train loss: 0.282, Test loss: 0.812, Test accuracy: 74.64 

Round  31, Train loss: 0.258, Test loss: 0.795, Test accuracy: 74.84 

Round  32, Train loss: 0.253, Test loss: 0.835, Test accuracy: 73.44 

Round  33, Train loss: 0.236, Test loss: 0.804, Test accuracy: 75.60 

Round  34, Train loss: 0.210, Test loss: 0.878, Test accuracy: 74.44 

Round  35, Train loss: 0.215, Test loss: 0.839, Test accuracy: 74.24 

Round  36, Train loss: 0.199, Test loss: 0.877, Test accuracy: 74.08 

Round  37, Train loss: 0.198, Test loss: 0.834, Test accuracy: 75.08 

Round  38, Train loss: 0.175, Test loss: 0.893, Test accuracy: 74.40 

Round  39, Train loss: 0.167, Test loss: 0.899, Test accuracy: 74.36 

Round  40, Train loss: 0.156, Test loss: 0.877, Test accuracy: 74.68 

Round  41, Train loss: 0.149, Test loss: 0.897, Test accuracy: 74.00 

Round  42, Train loss: 0.128, Test loss: 0.919, Test accuracy: 75.04 

Round  43, Train loss: 0.145, Test loss: 0.901, Test accuracy: 75.20 

Round  44, Train loss: 0.116, Test loss: 0.877, Test accuracy: 75.92 

Round  45, Train loss: 0.101, Test loss: 0.918, Test accuracy: 75.80 

Round  46, Train loss: 0.125, Test loss: 0.925, Test accuracy: 74.56 

Round  47, Train loss: 0.098, Test loss: 0.922, Test accuracy: 75.48 

Round  48, Train loss: 0.113, Test loss: 0.939, Test accuracy: 74.88 

Round  49, Train loss: 0.103, Test loss: 0.900, Test accuracy: 75.56 

Final Round, Train loss: 0.060, Test loss: 0.905, Test accuracy: 75.68 

Average accuracy final 10 rounds: 75.11200000000001 

1615.985265493393
[11.972287893295288, 17.91390633583069, 23.54450297355652, 29.327345609664917, 34.937615394592285, 40.91490817070007, 46.966747522354126, 52.66570997238159, 58.29170060157776, 63.96067237854004, 69.76731371879578, 75.43147611618042, 81.37871265411377, 87.03101110458374, 92.81778860092163, 98.40532112121582, 104.57603001594543, 110.30534029006958, 116.20631742477417, 122.02371311187744, 127.65579152107239, 133.4296681880951, 139.31291484832764, 144.98803186416626, 150.7972400188446, 156.35238599777222, 162.1813132762909, 168.06900024414062, 173.84883522987366, 179.56767535209656, 185.4217653274536, 191.29404973983765, 197.15727353096008, 202.87321853637695, 208.54605340957642, 214.31268095970154, 220.0289385318756, 225.77521514892578, 231.61374020576477, 237.34149312973022, 242.9919674396515, 248.88725972175598, 254.5988576412201, 260.2550241947174, 266.13092017173767, 271.7508153915405, 277.4422962665558, 283.10473704338074, 288.9872329235077, 294.71144938468933, 302.22760224342346]
[22.32, 29.52, 42.08, 47.4, 52.04, 56.16, 55.76, 56.88, 61.4, 61.72, 63.24, 62.88, 63.12, 63.52, 63.8, 66.88, 69.32, 71.6, 69.28, 69.32, 70.0, 71.92, 71.92, 72.4, 71.88, 72.96, 73.88, 73.48, 74.08, 73.08, 74.64, 74.84, 73.44, 75.6, 74.44, 74.24, 74.08, 75.08, 74.4, 74.36, 74.68, 74.0, 75.04, 75.2, 75.92, 75.8, 74.56, 75.48, 74.88, 75.56, 75.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.604, Test loss: 1.676, Test accuracy: 23.72
Round   1, Train loss: 1.448, Test loss: 1.559, Test accuracy: 34.68
Round   2, Train loss: 1.333, Test loss: 1.411, Test accuracy: 39.12
Round   3, Train loss: 1.211, Test loss: 1.411, Test accuracy: 45.00
Round   4, Train loss: 1.139, Test loss: 1.148, Test accuracy: 53.56
Round   5, Train loss: 1.077, Test loss: 1.183, Test accuracy: 54.04
Round   6, Train loss: 1.016, Test loss: 1.037, Test accuracy: 56.68
Round   7, Train loss: 0.960, Test loss: 1.176, Test accuracy: 54.16
Round   8, Train loss: 0.916, Test loss: 0.972, Test accuracy: 60.88
Round   9, Train loss: 0.863, Test loss: 0.951, Test accuracy: 62.00
Round  10, Train loss: 0.822, Test loss: 1.047, Test accuracy: 59.12
Round  11, Train loss: 0.779, Test loss: 0.878, Test accuracy: 65.80
Round  12, Train loss: 0.743, Test loss: 0.917, Test accuracy: 65.56
Round  13, Train loss: 0.707, Test loss: 0.893, Test accuracy: 66.28
Round  14, Train loss: 0.666, Test loss: 0.876, Test accuracy: 67.84
Round  15, Train loss: 0.640, Test loss: 0.871, Test accuracy: 67.76
Round  16, Train loss: 0.606, Test loss: 0.791, Test accuracy: 71.96
Round  17, Train loss: 0.569, Test loss: 0.832, Test accuracy: 69.80
Round  18, Train loss: 0.553, Test loss: 0.794, Test accuracy: 71.36
Round  19, Train loss: 0.504, Test loss: 0.794, Test accuracy: 72.80
Round  20, Train loss: 0.483, Test loss: 0.787, Test accuracy: 71.88
Round  21, Train loss: 0.472, Test loss: 0.781, Test accuracy: 72.56
Round  22, Train loss: 0.436, Test loss: 0.801, Test accuracy: 72.00
Round  23, Train loss: 0.417, Test loss: 0.834, Test accuracy: 71.40
Round  24, Train loss: 0.393, Test loss: 0.760, Test accuracy: 73.44
Round  25, Train loss: 0.371, Test loss: 0.726, Test accuracy: 74.92
Round  26, Train loss: 0.352, Test loss: 0.735, Test accuracy: 75.04
Round  27, Train loss: 0.325, Test loss: 0.806, Test accuracy: 73.24
Round  28, Train loss: 0.302, Test loss: 0.771, Test accuracy: 74.96
Round  29, Train loss: 0.290, Test loss: 0.816, Test accuracy: 73.72
Round  30, Train loss: 0.287, Test loss: 0.776, Test accuracy: 74.96
Round  31, Train loss: 0.261, Test loss: 0.776, Test accuracy: 74.20
Round  32, Train loss: 0.246, Test loss: 0.759, Test accuracy: 75.68
Round  33, Train loss: 0.232, Test loss: 0.802, Test accuracy: 75.08
Round  34, Train loss: 0.217, Test loss: 0.784, Test accuracy: 75.92
Round  35, Train loss: 0.207, Test loss: 0.782, Test accuracy: 75.52
Round  36, Train loss: 0.202, Test loss: 0.847, Test accuracy: 74.12
Round  37, Train loss: 0.184, Test loss: 0.767, Test accuracy: 76.04
Round  38, Train loss: 0.186, Test loss: 0.785, Test accuracy: 76.08
Round  39, Train loss: 0.162, Test loss: 0.768, Test accuracy: 76.12
Round  40, Train loss: 0.145, Test loss: 0.780, Test accuracy: 77.08
Round  41, Train loss: 0.152, Test loss: 0.809, Test accuracy: 76.12
Round  42, Train loss: 0.139, Test loss: 0.790, Test accuracy: 76.60
Round  43, Train loss: 0.132, Test loss: 0.806, Test accuracy: 76.44
Round  44, Train loss: 0.136, Test loss: 0.787, Test accuracy: 76.40
Round  45, Train loss: 0.108, Test loss: 0.823, Test accuracy: 76.76
Round  46, Train loss: 0.116, Test loss: 0.799, Test accuracy: 77.60
Round  47, Train loss: 0.117, Test loss: 0.810, Test accuracy: 76.52
Round  48, Train loss: 0.098, Test loss: 0.826, Test accuracy: 76.08
Round  49, Train loss: 0.087, Test loss: 0.820, Test accuracy: 76.60
Final Round, Train loss: 0.058, Test loss: 0.827, Test accuracy: 77.12
Average accuracy final 10 rounds: 76.62
1930.5038146972656
[13.159769773483276, 20.35206651687622, 27.435445308685303, 34.282347679138184, 41.181673526763916, 48.08117485046387, 55.05797505378723, 62.215505838394165, 69.16154408454895, 76.0759129524231, 83.01837515830994, 90.0022041797638, 96.92286467552185, 103.70456147193909, 110.86254286766052, 117.90923166275024, 124.88273024559021, 132.02806425094604, 139.15859079360962, 146.01230764389038, 152.9965045452118, 160.18460893630981, 167.34672594070435, 174.76256322860718, 181.84925246238708, 188.9472725391388, 196.1079592704773, 202.994313955307, 210.03401827812195, 217.12138295173645, 224.10298943519592, 230.90565013885498, 237.980895280838, 244.8520793914795, 251.72076296806335, 258.5910656452179, 265.5640959739685, 272.49565720558167, 279.4034905433655, 286.65509271621704, 293.61161065101624, 300.51218700408936, 307.7629563808441, 315.00677156448364, 321.97967505455017, 329.0973081588745, 336.473042011261, 343.49290800094604, 350.4792037010193, 357.4654150009155, 365.6000609397888]
[23.72, 34.68, 39.12, 45.0, 53.56, 54.04, 56.68, 54.16, 60.88, 62.0, 59.12, 65.8, 65.56, 66.28, 67.84, 67.76, 71.96, 69.8, 71.36, 72.8, 71.88, 72.56, 72.0, 71.4, 73.44, 74.92, 75.04, 73.24, 74.96, 73.72, 74.96, 74.2, 75.68, 75.08, 75.92, 75.52, 74.12, 76.04, 76.08, 76.12, 77.08, 76.12, 76.6, 76.44, 76.4, 76.76, 77.6, 76.52, 76.08, 76.6, 77.12]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 1.330, Train accuracy: 42.600, Test loss: 1.569, Test accuracy: 35.00 

        train local model (freeze embeding):client   0,  Train loss: 1.187, Train accuracy: 48.800, Test loss: 1.518, Test accuracy: 41.20 

        train local model (unfreeze embeding):client   0,  Train loss: 1.017, Train accuracy: 59.000, Test loss: 1.276, Test accuracy: 49.60 

Round   0, Train loss: 1.017, Test loss: 1.276, Test accuracy: 49.60 

        train local model (freeze embeding):client   0,  Train loss: 0.975, Train accuracy: 62.600, Test loss: 1.237, Test accuracy: 52.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.918, Train accuracy: 64.400, Test loss: 1.400, Test accuracy: 51.80 

Round   1, Train loss: 0.918, Test loss: 1.400, Test accuracy: 51.80 

        train local model (freeze embeding):client   0,  Train loss: 0.866, Train accuracy: 65.600, Test loss: 1.241, Test accuracy: 51.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.777, Train accuracy: 71.200, Test loss: 1.372, Test accuracy: 53.80 

Round   2, Train loss: 0.777, Test loss: 1.372, Test accuracy: 53.80 

        train local model (freeze embeding):client   0,  Train loss: 0.699, Train accuracy: 73.800, Test loss: 1.318, Test accuracy: 55.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.701, Train accuracy: 72.800, Test loss: 1.259, Test accuracy: 53.80 

Round   3, Train loss: 0.701, Test loss: 1.259, Test accuracy: 53.80 

        train local model (freeze embeding):client   0,  Train loss: 0.577, Train accuracy: 80.000, Test loss: 1.209, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.549, Train accuracy: 80.600, Test loss: 1.441, Test accuracy: 54.40 

Round   4, Train loss: 0.549, Test loss: 1.441, Test accuracy: 54.40 

        train local model (freeze embeding):client   0,  Train loss: 0.453, Train accuracy: 84.000, Test loss: 1.356, Test accuracy: 59.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.555, Train accuracy: 78.400, Test loss: 1.591, Test accuracy: 51.60 

Round   5, Train loss: 0.555, Test loss: 1.591, Test accuracy: 51.60 

        train local model (freeze embeding):client   0,  Train loss: 0.363, Train accuracy: 89.400, Test loss: 1.510, Test accuracy: 56.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.326, Train accuracy: 89.000, Test loss: 1.534, Test accuracy: 58.00 

Round   6, Train loss: 0.326, Test loss: 1.534, Test accuracy: 58.00 

        train local model (freeze embeding):client   0,  Train loss: 0.216, Train accuracy: 93.400, Test loss: 1.517, Test accuracy: 58.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.183, Train accuracy: 94.800, Test loss: 1.523, Test accuracy: 60.60 

Round   7, Train loss: 0.183, Test loss: 1.523, Test accuracy: 60.60 

        train local model (freeze embeding):client   0,  Train loss: 0.152, Train accuracy: 95.200, Test loss: 1.395, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.172, Train accuracy: 93.400, Test loss: 1.648, Test accuracy: 57.00 

Round   8, Train loss: 0.172, Test loss: 1.648, Test accuracy: 57.00 

        train local model (freeze embeding):client   0,  Train loss: 0.105, Train accuracy: 97.000, Test loss: 1.605, Test accuracy: 59.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.263, Train accuracy: 90.800, Test loss: 2.085, Test accuracy: 58.20 

Round   9, Train loss: 0.263, Test loss: 2.085, Test accuracy: 58.20 

        train local model (freeze embeding):client   0,  Train loss: 0.141, Train accuracy: 96.000, Test loss: 1.676, Test accuracy: 59.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.051, Train accuracy: 98.600, Test loss: 1.947, Test accuracy: 58.40 

Round  10, Train loss: 0.051, Test loss: 1.947, Test accuracy: 58.40 

        train local model (freeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.800, Test loss: 1.839, Test accuracy: 59.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.123, Train accuracy: 96.000, Test loss: 1.945, Test accuracy: 59.60 

Round  11, Train loss: 0.123, Test loss: 1.945, Test accuracy: 59.60 

        train local model (freeze embeding):client   0,  Train loss: 0.066, Train accuracy: 97.400, Test loss: 1.723, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.057, Train accuracy: 98.600, Test loss: 2.014, Test accuracy: 61.40 

Round  12, Train loss: 0.057, Test loss: 2.014, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.000, Test loss: 1.802, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.400, Test loss: 1.869, Test accuracy: 61.40 

Round  13, Train loss: 0.036, Test loss: 1.869, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.836, Test accuracy: 61.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.800, Test loss: 2.099, Test accuracy: 60.40 

Round  14, Train loss: 0.044, Test loss: 2.099, Test accuracy: 60.40 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.939, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.800, Test loss: 2.082, Test accuracy: 60.20 

Round  15, Train loss: 0.033, Test loss: 2.082, Test accuracy: 60.20 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 2.020, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 2.200, Test accuracy: 62.40 

Round  16, Train loss: 0.019, Test loss: 2.200, Test accuracy: 62.40 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 2.070, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.038, Train accuracy: 98.400, Test loss: 2.221, Test accuracy: 59.40 

Round  17, Train loss: 0.038, Test loss: 2.221, Test accuracy: 59.40 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.930, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 2.251, Test accuracy: 60.40 

Round  18, Train loss: 0.019, Test loss: 2.251, Test accuracy: 60.40 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 2.215, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 2.165, Test accuracy: 62.80 

Round  19, Train loss: 0.016, Test loss: 2.165, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 2.115, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.999, Test accuracy: 62.40 

Final Round, Train loss: 0.010, Test loss: 2.163, Test accuracy: 62.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 1.024, Train accuracy: 57.600, Test loss: 1.161, Test accuracy: 53.20 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.041, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.208, Test accuracy: 60.00 

        train local model (freeze embeding):client   1,  Train loss: 0.994, Train accuracy: 61.400, Test loss: 1.104, Test accuracy: 54.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.422, Train accuracy: 86.600, Test loss: 1.332, Test accuracy: 61.00 

Round   0, Train loss: 0.213, Test loss: 1.475, Test accuracy: 62.30 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.775, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 2.011, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.502, Train accuracy: 81.400, Test loss: 0.959, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.296, Train accuracy: 88.200, Test loss: 1.540, Test accuracy: 60.00 

Round   1, Train loss: 0.151, Test loss: 1.458, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.755, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.395, Test accuracy: 61.20 

        train local model (freeze embeding):client   1,  Train loss: 0.280, Train accuracy: 89.200, Test loss: 1.088, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.164, Train accuracy: 94.400, Test loss: 1.317, Test accuracy: 64.20 

Round   2, Train loss: 0.084, Test loss: 1.611, Test accuracy: 64.20 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 2.018, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 2.233, Test accuracy: 61.60 

        train local model (freeze embeding):client   1,  Train loss: 0.133, Train accuracy: 96.400, Test loss: 1.215, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.202, Train accuracy: 92.800, Test loss: 1.843, Test accuracy: 59.40 

Round   3, Train loss: 0.109, Test loss: 1.687, Test accuracy: 61.10 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 2.098, Test accuracy: 61.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.240, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.070, Train accuracy: 98.800, Test loss: 1.279, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.121, Train accuracy: 95.600, Test loss: 1.611, Test accuracy: 63.20 

Round   4, Train loss: 0.063, Test loss: 1.651, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.970, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.800, Test loss: 2.095, Test accuracy: 59.80 

        train local model (freeze embeding):client   1,  Train loss: 0.054, Train accuracy: 98.800, Test loss: 1.421, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.099, Train accuracy: 97.000, Test loss: 1.764, Test accuracy: 60.40 

Round   5, Train loss: 0.074, Test loss: 1.601, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.747, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.314, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 1.376, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.054, Train accuracy: 98.400, Test loss: 1.721, Test accuracy: 62.80 

Round   6, Train loss: 0.028, Test loss: 1.684, Test accuracy: 64.10 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.894, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.017, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.526, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.039, Train accuracy: 98.400, Test loss: 1.880, Test accuracy: 64.60 

Round   7, Train loss: 0.022, Test loss: 1.795, Test accuracy: 63.20 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.977, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.054, Train accuracy: 98.200, Test loss: 2.016, Test accuracy: 63.40 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.571, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 99.200, Test loss: 1.674, Test accuracy: 64.40 

Round   8, Train loss: 0.050, Test loss: 1.652, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.766, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 2.236, Test accuracy: 62.40 

        train local model (freeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.464, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.068, Train accuracy: 97.600, Test loss: 1.983, Test accuracy: 62.60 

Round   9, Train loss: 0.041, Test loss: 1.745, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.836, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.281, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.547, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.977, Test accuracy: 62.40 

Round  10, Train loss: 0.019, Test loss: 1.823, Test accuracy: 64.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.005, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 2.384, Test accuracy: 62.20 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.788, Test accuracy: 66.00 

Round  11, Train loss: 0.018, Test loss: 1.863, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.101, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 2.196, Test accuracy: 59.40 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.539, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.780, Test accuracy: 67.00 

Round  12, Train loss: 0.011, Test loss: 1.748, Test accuracy: 65.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.847, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.251, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.441, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.956, Test accuracy: 63.40 

Round  13, Train loss: 0.014, Test loss: 1.825, Test accuracy: 64.50 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 2.021, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 2.151, Test accuracy: 64.60 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.614, Test accuracy: 65.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.061, Train accuracy: 98.000, Test loss: 2.065, Test accuracy: 61.60 

Round  14, Train loss: 0.034, Test loss: 1.834, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.957, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.200, Test loss: 2.467, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.691, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.522, Test accuracy: 66.80 

Round  15, Train loss: 0.017, Test loss: 1.770, Test accuracy: 66.90 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.959, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.354, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.899, Test accuracy: 66.80 

Round  16, Train loss: 0.003, Test loss: 1.959, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.153, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.339, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.756, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.034, Train accuracy: 98.600, Test loss: 2.196, Test accuracy: 63.20 

Round  17, Train loss: 0.018, Test loss: 1.870, Test accuracy: 65.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.044, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.223, Test accuracy: 62.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 2.004, Test accuracy: 65.00 

Round  18, Train loss: 0.003, Test loss: 1.993, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.182, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.357, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.751, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.910, Test accuracy: 66.00 

Round  19, Train loss: 0.010, Test loss: 1.962, Test accuracy: 65.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.204, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.304, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.713, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.681, Test accuracy: 68.40 

Final Round, Train loss: 0.002, Test loss: 1.935, Test accuracy: 65.10 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.623, Train accuracy: 77.400, Test loss: 0.783, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.227, Test accuracy: 63.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 2.256, Test accuracy: 60.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.705, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 2.065, Test accuracy: 65.40 

        train local model (freeze embeding):client   2,  Train loss: 0.722, Train accuracy: 73.400, Test loss: 1.021, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.131, Train accuracy: 95.000, Test loss: 1.004, Test accuracy: 70.00 

Round   0, Train loss: 0.061, Test loss: 1.417, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.809, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 2.090, Test accuracy: 63.80 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.657, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.852, Test accuracy: 68.20 

        train local model (freeze embeding):client   2,  Train loss: 0.311, Train accuracy: 89.800, Test loss: 0.776, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.057, Train accuracy: 98.400, Test loss: 1.084, Test accuracy: 70.00 

Round   1, Train loss: 0.022, Test loss: 1.426, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.897, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.136, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.677, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 98.800, Test loss: 2.120, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.149, Train accuracy: 95.600, Test loss: 0.829, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.101, Train accuracy: 96.200, Test loss: 1.270, Test accuracy: 67.20 

Round   2, Train loss: 0.044, Test loss: 1.473, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.842, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.400, Test loss: 2.160, Test accuracy: 64.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.700, Test accuracy: 65.40 

        train local model (freeze embeding):client   2,  Train loss: 0.090, Train accuracy: 97.600, Test loss: 0.872, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.086, Train accuracy: 97.800, Test loss: 1.251, Test accuracy: 66.40 

Round   3, Train loss: 0.033, Test loss: 1.418, Test accuracy: 68.87 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.762, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 2.218, Test accuracy: 62.80 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.682, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.937, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.057, Train accuracy: 99.000, Test loss: 0.817, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.045, Train accuracy: 99.200, Test loss: 1.105, Test accuracy: 73.40 

Round   4, Train loss: 0.028, Test loss: 1.420, Test accuracy: 69.07 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.797, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 98.800, Test loss: 2.029, Test accuracy: 64.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.635, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.821, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.029, Train accuracy: 99.600, Test loss: 0.935, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.093, Train accuracy: 96.800, Test loss: 1.600, Test accuracy: 69.20 

Round   5, Train loss: 0.043, Test loss: 1.403, Test accuracy: 70.27 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.696, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.037, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.606, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.880, Test accuracy: 66.20 

        train local model (freeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.600, Test loss: 0.962, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.041, Train accuracy: 98.400, Test loss: 1.371, Test accuracy: 70.60 

Round   6, Train loss: 0.018, Test loss: 1.475, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.757, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.945, Test accuracy: 63.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.729, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.018, Train accuracy: 99.200, Test loss: 2.018, Test accuracy: 67.00 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.037, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.092, Train accuracy: 96.600, Test loss: 1.611, Test accuracy: 65.40 

Round   7, Train loss: 0.038, Test loss: 1.425, Test accuracy: 68.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.732, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.989, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.615, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.765, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.131, Train accuracy: 95.600, Test loss: 1.747, Test accuracy: 61.80 

Round   8, Train loss: 0.046, Test loss: 1.492, Test accuracy: 69.13 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.757, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 2.117, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.583, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.400, Test loss: 1.884, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.085, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 97.200, Test loss: 1.440, Test accuracy: 71.60 

Round   9, Train loss: 0.028, Test loss: 1.461, Test accuracy: 70.53 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.765, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 2.250, Test accuracy: 65.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.632, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.052, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 98.800, Test loss: 1.322, Test accuracy: 71.20 

Round  10, Train loss: 0.021, Test loss: 1.486, Test accuracy: 70.27 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.740, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.836, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.622, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.832, Test accuracy: 67.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.317, Test accuracy: 69.60 

Round  11, Train loss: 0.009, Test loss: 1.449, Test accuracy: 70.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.705, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.003, Test accuracy: 65.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.720, Test accuracy: 71.20 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.083, Train accuracy: 96.200, Test loss: 1.434, Test accuracy: 66.20 

Round  12, Train loss: 0.029, Test loss: 1.433, Test accuracy: 70.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.689, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.815, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.565, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.851, Test accuracy: 68.40 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.605, Test accuracy: 67.80 

Round  13, Train loss: 0.004, Test loss: 1.559, Test accuracy: 71.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.751, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.853, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.763, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.801, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.541, Test accuracy: 70.20 

Round  14, Train loss: 0.010, Test loss: 1.474, Test accuracy: 70.27 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.739, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.966, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 71.00 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.160, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.449, Test accuracy: 71.20 

Round  15, Train loss: 0.005, Test loss: 1.549, Test accuracy: 70.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.796, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.814, Test accuracy: 67.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.677, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.709, Test accuracy: 67.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.177, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.507, Test accuracy: 70.60 

Round  16, Train loss: 0.023, Test loss: 1.506, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.711, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.852, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.601, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.679, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.566, Test accuracy: 67.40 

Round  17, Train loss: 0.018, Test loss: 1.416, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.588, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 2.026, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.513, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.737, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.580, Test accuracy: 69.40 

Round  18, Train loss: 0.004, Test loss: 1.512, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.720, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.859, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.579, Test accuracy: 68.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.758, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.186, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.438, Test accuracy: 72.20 

Round  19, Train loss: 0.006, Test loss: 1.511, Test accuracy: 70.53 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.768, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.760, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.548, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.555, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.174, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 74.60 

Final Round, Train loss: 0.001, Test loss: 1.486, Test accuracy: 71.07 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.582, Train accuracy: 78.200, Test loss: 0.860, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.759, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.932, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.558, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.662, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.552, Test accuracy: 69.40 

        train local model (freeze embeding):client   3,  Train loss: 0.585, Train accuracy: 76.800, Test loss: 0.883, Test accuracy: 68.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.090, Train accuracy: 97.200, Test loss: 1.036, Test accuracy: 72.20 

Round   0, Train loss: 0.026, Test loss: 1.335, Test accuracy: 70.45 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.722, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.067, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.536, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.797, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.200, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.345, Test accuracy: 70.60 

        train local model (freeze embeding):client   3,  Train loss: 0.286, Train accuracy: 91.200, Test loss: 0.902, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.083, Train accuracy: 97.400, Test loss: 1.271, Test accuracy: 69.80 

Round   1, Train loss: 0.022, Test loss: 1.346, Test accuracy: 71.55 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.773, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.054, Test accuracy: 64.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.597, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.208, Train accuracy: 94.200, Test loss: 2.546, Test accuracy: 57.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.138, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.122, Train accuracy: 97.800, Test loss: 0.927, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.086, Train accuracy: 98.000, Test loss: 1.120, Test accuracy: 71.20 

Round   2, Train loss: 0.075, Test loss: 1.292, Test accuracy: 71.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.549, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.571, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.160, Train accuracy: 95.200, Test loss: 2.089, Test accuracy: 63.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.061, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.345, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.098, Train accuracy: 97.800, Test loss: 0.877, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.085, Train accuracy: 97.200, Test loss: 1.096, Test accuracy: 73.00 

Round   3, Train loss: 0.065, Test loss: 1.242, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.623, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.925, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.483, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.200, Test loss: 1.850, Test accuracy: 68.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.359, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.055, Train accuracy: 99.200, Test loss: 0.897, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.092, Train accuracy: 96.200, Test loss: 1.320, Test accuracy: 69.60 

Round   4, Train loss: 0.036, Test loss: 1.281, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.618, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 2.150, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 98.600, Test loss: 1.841, Test accuracy: 66.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.064, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.453, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.027, Train accuracy: 99.800, Test loss: 0.952, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.239, Train accuracy: 91.400, Test loss: 1.819, Test accuracy: 63.00 

Round   5, Train loss: 0.072, Test loss: 1.294, Test accuracy: 71.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.649, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.753, Test accuracy: 67.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.454, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.597, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.106, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.590, Test accuracy: 69.40 

        train local model (freeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.600, Test loss: 0.978, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 1.178, Test accuracy: 73.00 

Round   6, Train loss: 0.012, Test loss: 1.315, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.638, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.954, Test accuracy: 67.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.448, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.122, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.035, Train accuracy: 98.600, Test loss: 1.311, Test accuracy: 69.60 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.096, Train accuracy: 96.600, Test loss: 1.270, Test accuracy: 72.60 

Round   7, Train loss: 0.035, Test loss: 1.250, Test accuracy: 72.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.586, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.843, Test accuracy: 68.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.354, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.686, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.100, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.390, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 97.600, Test loss: 1.604, Test accuracy: 70.00 

Round   8, Train loss: 0.022, Test loss: 1.257, Test accuracy: 72.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.564, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.788, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 72.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.029, Train accuracy: 98.200, Test loss: 1.556, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.081, Train accuracy: 97.200, Test loss: 1.723, Test accuracy: 70.60 

Round   9, Train loss: 0.029, Test loss: 1.264, Test accuracy: 72.85 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.648, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.789, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.044, Train accuracy: 98.400, Test loss: 1.714, Test accuracy: 67.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.400, Test loss: 1.360, Test accuracy: 70.20 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.083, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.039, Train accuracy: 98.600, Test loss: 1.403, Test accuracy: 73.60 

Round  10, Train loss: 0.029, Test loss: 1.260, Test accuracy: 72.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.571, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 1.895, Test accuracy: 65.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.422, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.595, Test accuracy: 70.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 74.80 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.000, Test loss: 1.248, Test accuracy: 70.80 

Round  11, Train loss: 0.014, Test loss: 1.239, Test accuracy: 72.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.480, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.872, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.398, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.011, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.200, Test loss: 1.622, Test accuracy: 70.00 

Round  12, Train loss: 0.007, Test loss: 1.304, Test accuracy: 72.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.543, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.829, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.440, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.103, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.105, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.400, Test loss: 1.553, Test accuracy: 72.80 

Round  13, Train loss: 0.009, Test loss: 1.277, Test accuracy: 72.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.553, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.492, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.724, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.048, Train accuracy: 98.800, Test loss: 1.381, Test accuracy: 72.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.170, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.245, Train accuracy: 93.200, Test loss: 2.233, Test accuracy: 66.80 

Round  14, Train loss: 0.075, Test loss: 1.302, Test accuracy: 73.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.702, Test accuracy: 70.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.424, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.750, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.027, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.150, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.039, Train accuracy: 98.400, Test loss: 1.474, Test accuracy: 71.00 

Round  15, Train loss: 0.013, Test loss: 1.240, Test accuracy: 73.65 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.582, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.678, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.378, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.400, Test loss: 1.606, Test accuracy: 69.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.256, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.099, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.222, Test accuracy: 76.20 

Round  16, Train loss: 0.004, Test loss: 1.279, Test accuracy: 74.05 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.550, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.775, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.393, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.469, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.043, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.125, Train accuracy: 96.200, Test loss: 1.421, Test accuracy: 71.40 

Round  17, Train loss: 0.035, Test loss: 1.245, Test accuracy: 73.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.584, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.575, Test accuracy: 70.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.401, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.461, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.047, Train accuracy: 98.600, Test loss: 1.372, Test accuracy: 71.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 76.60 

Round  18, Train loss: 0.012, Test loss: 1.268, Test accuracy: 73.85 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.559, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.784, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.782, Test accuracy: 69.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.210, Test accuracy: 72.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.101, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.058, Train accuracy: 99.000, Test loss: 1.382, Test accuracy: 73.00 

Round  19, Train loss: 0.018, Test loss: 1.286, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.553, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.532, Test accuracy: 72.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.388, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 73.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.042, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.098, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 76.40 

Final Round, Train loss: 0.001, Test loss: 1.256, Test accuracy: 73.60 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.633, Train accuracy: 75.400, Test loss: 0.852, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.709, Test accuracy: 68.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.539, Test accuracy: 72.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 98.800, Test loss: 1.107, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.114, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.434, Test accuracy: 73.20 

        train local model (freeze embeding):client   4,  Train loss: 0.622, Train accuracy: 76.800, Test loss: 0.841, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.102, Train accuracy: 96.000, Test loss: 1.214, Test accuracy: 66.40 

Round   0, Train loss: 0.028, Test loss: 1.131, Test accuracy: 73.72 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.489, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.767, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.302, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.032, Train accuracy: 98.600, Test loss: 1.637, Test accuracy: 70.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.100, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.246, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.348, Train accuracy: 89.200, Test loss: 0.842, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.136, Train accuracy: 95.400, Test loss: 1.281, Test accuracy: 68.20 

Round   1, Train loss: 0.037, Test loss: 1.106, Test accuracy: 74.56 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.622, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.266, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.533, Test accuracy: 70.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.926, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.200, Test loss: 1.186, Test accuracy: 75.60 

        train local model (freeze embeding):client   4,  Train loss: 0.189, Train accuracy: 94.000, Test loss: 0.912, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.054, Train accuracy: 98.400, Test loss: 1.446, Test accuracy: 66.80 

Round   2, Train loss: 0.018, Test loss: 1.125, Test accuracy: 74.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.973, Test accuracy: 66.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.293, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.633, Test accuracy: 68.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.042, Train accuracy: 98.400, Test loss: 1.313, Test accuracy: 71.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.217, Test accuracy: 75.80 

        train local model (freeze embeding):client   4,  Train loss: 0.096, Train accuracy: 97.200, Test loss: 0.993, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.048, Train accuracy: 98.600, Test loss: 1.350, Test accuracy: 65.60 

Round   3, Train loss: 0.021, Test loss: 1.085, Test accuracy: 73.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.456, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.747, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.402, Test accuracy: 69.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 77.00 

        train local model (freeze embeding):client   4,  Train loss: 0.073, Train accuracy: 98.400, Test loss: 1.022, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.081, Train accuracy: 97.400, Test loss: 1.487, Test accuracy: 69.20 

Round   4, Train loss: 0.017, Test loss: 1.147, Test accuracy: 74.08 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.482, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.745, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.291, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.629, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 77.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.400, Test loss: 1.116, Test accuracy: 75.40 

        train local model (freeze embeding):client   4,  Train loss: 0.044, Train accuracy: 98.600, Test loss: 1.098, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.053, Train accuracy: 98.200, Test loss: 1.538, Test accuracy: 64.60 

Round   5, Train loss: 0.017, Test loss: 1.149, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.537, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.037, Train accuracy: 98.800, Test loss: 1.924, Test accuracy: 65.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.310, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.422, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.483, Test accuracy: 70.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.991, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.244, Test accuracy: 74.00 

        train local model (freeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.123, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.035, Train accuracy: 99.200, Test loss: 1.504, Test accuracy: 70.00 

Round   6, Train loss: 0.028, Test loss: 1.072, Test accuracy: 74.24 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.578, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.621, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.288, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 76.00 

        train local model (freeze embeding):client   4,  Train loss: 0.033, Train accuracy: 99.600, Test loss: 1.117, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.103, Train accuracy: 96.800, Test loss: 1.752, Test accuracy: 64.00 

Round   7, Train loss: 0.030, Test loss: 1.128, Test accuracy: 73.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.336, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.664, Test accuracy: 70.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.400, Test loss: 1.769, Test accuracy: 68.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.034, Test accuracy: 75.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 75.20 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.051, Train accuracy: 97.800, Test loss: 1.512, Test accuracy: 68.60 

Round   8, Train loss: 0.016, Test loss: 1.151, Test accuracy: 74.52 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.778, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.800, Test loss: 1.938, Test accuracy: 66.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 77.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.320, Test accuracy: 72.40 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.485, Test accuracy: 68.00 

Round   9, Train loss: 0.029, Test loss: 1.117, Test accuracy: 74.68 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.371, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 72.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.129, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.230, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.066, Train accuracy: 98.000, Test loss: 1.637, Test accuracy: 67.60 

Round  10, Train loss: 0.014, Test loss: 1.170, Test accuracy: 74.64 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.437, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.608, Test accuracy: 69.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.325, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 71.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 99.200, Test loss: 1.375, Test accuracy: 74.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 74.60 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.040, Train accuracy: 98.600, Test loss: 1.696, Test accuracy: 67.00 

Round  11, Train loss: 0.016, Test loss: 1.143, Test accuracy: 74.48 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.395, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.718, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.639, Test accuracy: 69.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.872, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.400, Test loss: 1.231, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.272, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.022, Train accuracy: 99.200, Test loss: 1.732, Test accuracy: 69.60 

Round  12, Train loss: 0.019, Test loss: 1.178, Test accuracy: 74.56 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.641, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.311, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.376, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 0.864, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 75.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.193, Test accuracy: 76.40 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.157, Train accuracy: 95.000, Test loss: 2.034, Test accuracy: 59.80 

Round  13, Train loss: 0.033, Test loss: 1.120, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.584, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.269, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.580, Test accuracy: 67.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.074, Train accuracy: 97.000, Test loss: 1.247, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.299, Test accuracy: 75.40 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.309, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.047, Train accuracy: 98.400, Test loss: 1.873, Test accuracy: 65.60 

Round  14, Train loss: 0.029, Test loss: 1.157, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.360, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.587, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.291, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.597, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 78.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 76.20 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.329, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.047, Train accuracy: 98.800, Test loss: 1.461, Test accuracy: 69.60 

Round  15, Train loss: 0.010, Test loss: 1.169, Test accuracy: 75.12 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.384, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.551, Test accuracy: 72.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.298, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.051, Train accuracy: 98.200, Test loss: 1.753, Test accuracy: 63.80 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.470, Test accuracy: 72.80 

Round  16, Train loss: 0.011, Test loss: 1.154, Test accuracy: 75.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.391, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.759, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.339, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.122, Train accuracy: 95.000, Test loss: 2.035, Test accuracy: 62.20 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.827, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 78.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.004, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.221, Train accuracy: 92.400, Test loss: 2.168, Test accuracy: 66.80 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.050, Train accuracy: 98.400, Test loss: 1.416, Test accuracy: 69.40 

Round  17, Train loss: 0.082, Test loss: 1.119, Test accuracy: 74.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.546, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.439, Test accuracy: 69.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.803, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.897, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.114, Test accuracy: 76.40 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.248, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 2.061, Test accuracy: 68.00 

Round  18, Train loss: 0.012, Test loss: 1.159, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.488, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.349, Test accuracy: 74.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.842, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 77.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.983, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.001, Test accuracy: 78.80 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 1.666, Test accuracy: 68.40 

Round  19, Train loss: 0.006, Test loss: 1.174, Test accuracy: 75.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.388, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.255, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.242, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.851, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 78.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.973, Test accuracy: 77.60 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.322, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 74.20 

Final Round, Train loss: 0.001, Test loss: 1.161, Test accuracy: 75.76 

Average accuracy final 10 rounds: 344.35299999999995 

6468.7721536159515
[20.008403301239014, 39.634440183639526, 59.759987115859985, 80.11190032958984, 100.27674603462219, 120.11138844490051, 140.42968082427979, 160.74899911880493, 180.92534971237183, 201.01739263534546, 221.42856812477112, 241.9934437274933, 261.97574377059937, 282.75602769851685, 302.8861815929413, 323.216068983078, 343.15155363082886, 363.1573100090027, 382.98757910728455, 403.0277199745178, 416.7829203605652, 437.36474680900574, 457.5089154243469, 477.86321926116943, 498.03198528289795, 518.2724468708038, 538.6372354030609, 558.7861926555634, 578.6828758716583, 599.1646955013275, 619.2332141399384, 639.1808109283447, 659.3080198764801, 679.4172253608704, 700.1008036136627, 720.3931884765625, 740.8063023090363, 761.1921348571777, 781.5661835670471, 802.1928627490997, 821.961309671402, 835.3856346607208, 856.180104970932, 875.9329717159271, 895.9822862148285, 916.4674603939056, 936.6866767406464, 957.0919632911682, 977.2845470905304, 997.8190219402313, 1018.4460990428925, 1038.8364069461823, 1058.8042430877686, 1077.6644494533539, 1096.7084925174713, 1115.6686918735504, 1134.6952021121979, 1153.5576465129852, 1172.8115742206573, 1192.498679637909, 1213.0004999637604, 1233.4521653652191, 1247.5154721736908, 1267.727635383606, 1287.8010783195496, 1308.139153957367, 1328.2156376838684, 1348.267338514328, 1368.6836173534393, 1389.0627048015594, 1409.986457824707, 1430.3362805843353, 1451.0703675746918, 1471.1476736068726, 1491.1264855861664, 1511.1201798915863, 1530.9948284626007, 1551.2157969474792, 1571.319000005722, 1591.642238855362, 1612.357091665268, 1632.962673664093, 1653.3260960578918, 1666.5892663002014, 1686.9446487426758, 1707.4806790351868, 1727.9614703655243, 1747.9849517345428, 1768.4007596969604, 1788.3939316272736, 1808.4551327228546, 1828.939539194107, 1849.2401130199432, 1869.6213219165802, 1890.085881471634, 1910.347653388977, 1930.475970029831, 1950.6944580078125, 1970.9561100006104, 1991.1280887126923, 2011.496113061905, 2031.7856333255768, 2052.12722492218, 2072.6049015522003, 2086.0413496494293]
[49.6, 51.8, 53.8, 53.8, 54.4, 51.6, 58.0, 60.6, 57.0, 58.2, 58.4, 59.6, 61.4, 61.4, 60.4, 60.2, 62.4, 59.4, 60.4, 62.8, 62.6, 62.3, 62.8, 64.2, 61.1, 63.0, 61.4, 64.1, 63.2, 66.6, 65.2, 64.9, 64.6, 65.0, 64.5, 64.0, 66.9, 66.2, 65.2, 65.6, 65.6, 65.1, 68.0, 68.8, 70.0, 68.86666666666666, 69.06666666666666, 70.26666666666667, 69.8, 68.66666666666667, 69.13333333333334, 70.53333333333333, 70.26666666666667, 70.73333333333333, 70.66666666666667, 71.66666666666667, 70.26666666666667, 70.66666666666667, 69.2, 71.6, 70.4, 70.53333333333333, 71.06666666666666, 70.45, 71.55, 71.35, 72.5, 72.6, 71.2, 71.6, 72.8, 72.65, 72.85, 72.65, 72.3, 72.7, 72.6, 73.1, 73.65, 74.05, 73.35, 73.85, 72.5, 73.6, 73.72, 74.56, 74.04, 73.96, 74.08, 73.8, 74.24, 73.96, 74.52, 74.68, 74.64, 74.48, 74.56, 75.0, 75.4, 75.12, 75.04, 74.12, 74.4, 75.12, 75.76]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.444, Test loss: 1.422, Test accuracy: 46.40 

Round   0, Global train loss: 1.444, Global test loss: 2.530, Global test accuracy: 16.00 

Round   1, Train loss: 1.134, Test loss: 1.257, Test accuracy: 55.40 

Round   1, Global train loss: 1.134, Global test loss: 2.754, Global test accuracy: 16.00 

Round   2, Train loss: 0.974, Test loss: 1.280, Test accuracy: 55.80 

Round   2, Global train loss: 0.974, Global test loss: 2.858, Global test accuracy: 16.00 

Round   3, Train loss: 0.822, Test loss: 1.121, Test accuracy: 59.88 

Round   3, Global train loss: 0.822, Global test loss: 2.888, Global test accuracy: 16.00 

Round   4, Train loss: 0.708, Test loss: 1.300, Test accuracy: 57.52 

Round   4, Global train loss: 0.708, Global test loss: 2.920, Global test accuracy: 16.00 

Round   5, Train loss: 0.606, Test loss: 1.449, Test accuracy: 57.80 

Round   5, Global train loss: 0.606, Global test loss: 3.022, Global test accuracy: 16.00 

Round   6, Train loss: 0.498, Test loss: 1.510, Test accuracy: 59.40 

Round   6, Global train loss: 0.498, Global test loss: 3.156, Global test accuracy: 16.00 

Round   7, Train loss: 0.433, Test loss: 1.410, Test accuracy: 61.44 

Round   7, Global train loss: 0.433, Global test loss: 3.151, Global test accuracy: 16.00 

Round   8, Train loss: 0.363, Test loss: 1.414, Test accuracy: 62.76 

Round   8, Global train loss: 0.363, Global test loss: 2.972, Global test accuracy: 16.00 

Round   9, Train loss: 0.299, Test loss: 1.490, Test accuracy: 61.96 

Round   9, Global train loss: 0.299, Global test loss: 3.432, Global test accuracy: 16.00 

Round  10, Train loss: 0.246, Test loss: 1.505, Test accuracy: 63.00 

Round  10, Global train loss: 0.246, Global test loss: 3.275, Global test accuracy: 16.00 

Round  11, Train loss: 0.219, Test loss: 1.552, Test accuracy: 63.44 

Round  11, Global train loss: 0.219, Global test loss: 3.191, Global test accuracy: 16.00 

Round  12, Train loss: 0.206, Test loss: 1.663, Test accuracy: 63.48 

Round  12, Global train loss: 0.206, Global test loss: 3.288, Global test accuracy: 16.00 

Round  13, Train loss: 0.143, Test loss: 1.516, Test accuracy: 65.16 

Round  13, Global train loss: 0.143, Global test loss: 3.248, Global test accuracy: 16.00 

Round  14, Train loss: 0.122, Test loss: 1.715, Test accuracy: 64.08 

Round  14, Global train loss: 0.122, Global test loss: 3.323, Global test accuracy: 16.00 

Round  15, Train loss: 0.123, Test loss: 1.620, Test accuracy: 65.52 

Round  15, Global train loss: 0.123, Global test loss: 3.285, Global test accuracy: 16.00 

Round  16, Train loss: 0.090, Test loss: 1.754, Test accuracy: 65.40 

Round  16, Global train loss: 0.090, Global test loss: 3.365, Global test accuracy: 16.00 

Round  17, Train loss: 0.085, Test loss: 1.633, Test accuracy: 65.64 

Round  17, Global train loss: 0.085, Global test loss: 3.293, Global test accuracy: 16.00 

Round  18, Train loss: 0.069, Test loss: 1.630, Test accuracy: 66.08 

Round  18, Global train loss: 0.069, Global test loss: 3.302, Global test accuracy: 16.00 

Round  19, Train loss: 0.086, Test loss: 2.034, Test accuracy: 63.20 

Round  19, Global train loss: 0.086, Global test loss: 3.343, Global test accuracy: 16.00 

Round  20, Train loss: 0.093, Test loss: 1.641, Test accuracy: 66.16 

Round  20, Global train loss: 0.093, Global test loss: 3.402, Global test accuracy: 16.00 

Round  21, Train loss: 0.066, Test loss: 1.710, Test accuracy: 66.68 

Round  21, Global train loss: 0.066, Global test loss: 3.457, Global test accuracy: 16.00 

Round  22, Train loss: 0.060, Test loss: 1.706, Test accuracy: 67.52 

Round  22, Global train loss: 0.060, Global test loss: 3.268, Global test accuracy: 16.00 

Round  23, Train loss: 0.047, Test loss: 1.840, Test accuracy: 65.20 

Round  23, Global train loss: 0.047, Global test loss: 3.294, Global test accuracy: 16.00 

Round  24, Train loss: 0.049, Test loss: 1.728, Test accuracy: 67.64 

Round  24, Global train loss: 0.049, Global test loss: 3.270, Global test accuracy: 16.00 

Round  25, Train loss: 0.035, Test loss: 1.686, Test accuracy: 67.56 

Round  25, Global train loss: 0.035, Global test loss: 3.283, Global test accuracy: 16.00 

Round  26, Train loss: 0.026, Test loss: 1.573, Test accuracy: 69.76 

Round  26, Global train loss: 0.026, Global test loss: 3.303, Global test accuracy: 16.00 

Round  27, Train loss: 0.028, Test loss: 1.650, Test accuracy: 68.96 

Round  27, Global train loss: 0.028, Global test loss: 3.505, Global test accuracy: 16.00 

Round  28, Train loss: 0.023, Test loss: 1.652, Test accuracy: 68.32 

Round  28, Global train loss: 0.023, Global test loss: 3.399, Global test accuracy: 16.00 

Round  29, Train loss: 0.026, Test loss: 1.778, Test accuracy: 66.92 

Round  29, Global train loss: 0.026, Global test loss: 3.297, Global test accuracy: 16.00 

Round  30, Train loss: 0.038, Test loss: 1.762, Test accuracy: 67.80 

Round  30, Global train loss: 0.038, Global test loss: 3.432, Global test accuracy: 16.00 

Round  31, Train loss: 0.020, Test loss: 1.833, Test accuracy: 66.80 

Round  31, Global train loss: 0.020, Global test loss: 3.296, Global test accuracy: 16.00 

Round  32, Train loss: 0.027, Test loss: 1.874, Test accuracy: 67.36 

Round  32, Global train loss: 0.027, Global test loss: 3.370, Global test accuracy: 16.00 

Round  33, Train loss: 0.032, Test loss: 2.040, Test accuracy: 65.76 

Round  33, Global train loss: 0.032, Global test loss: 3.302, Global test accuracy: 16.00 

Round  34, Train loss: 0.034, Test loss: 1.866, Test accuracy: 67.56 

Round  34, Global train loss: 0.034, Global test loss: 3.257, Global test accuracy: 16.00 

Final Round, Train loss: 0.024, Test loss: 1.587, Test accuracy: 69.52 

Final Round, Global train loss: 0.024, Global test loss: 3.257, Global test accuracy: 16.00 

Average accuracy final 10 rounds: 67.68 

Average global accuracy final 10 rounds: 15.999999999999998 

1511.3631629943848
[13.458695888519287, 20.543551445007324, 27.58025312423706, 34.76209568977356, 42.05883717536926, 49.39590549468994, 56.39799451828003, 63.51191329956055, 70.4826557636261, 77.42251944541931, 84.33454751968384, 91.18126225471497, 98.04221153259277, 104.96867847442627, 112.43243050575256, 119.66175889968872, 126.56434226036072, 133.416095495224, 140.59896540641785, 147.64452576637268, 154.46329259872437, 161.37104606628418, 168.4499077796936, 175.67972326278687, 182.84417581558228, 190.00290632247925, 196.91874814033508, 204.13766479492188, 211.25353145599365, 218.10157775878906, 225.22838306427002, 232.28527665138245, 239.4736204147339, 246.40296697616577, 253.14663982391357, 267.0479803085327]
[46.4, 55.4, 55.8, 59.88, 57.52, 57.8, 59.4, 61.44, 62.76, 61.96, 63.0, 63.44, 63.48, 65.16, 64.08, 65.52, 65.4, 65.64, 66.08, 63.2, 66.16, 66.68, 67.52, 65.2, 67.64, 67.56, 69.76, 68.96, 68.32, 66.92, 67.8, 66.8, 67.36, 65.76, 67.56, 69.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.469, Test loss: 1.390, Test accuracy: 47.28 

Round   0, Global train loss: 1.469, Global test loss: 2.387, Global test accuracy: 16.00 

Round   1, Train loss: 1.344, Test loss: 1.311, Test accuracy: 51.16 

Round   1, Global train loss: 1.344, Global test loss: 2.036, Global test accuracy: 32.16 

Round   2, Train loss: 1.188, Test loss: 1.335, Test accuracy: 52.76 

Round   2, Global train loss: 1.188, Global test loss: 1.727, Global test accuracy: 43.20 

Round   3, Train loss: 1.073, Test loss: 1.250, Test accuracy: 56.96 

Round   3, Global train loss: 1.073, Global test loss: 1.814, Global test accuracy: 44.44 

Round   4, Train loss: 0.967, Test loss: 1.357, Test accuracy: 55.12 

Round   4, Global train loss: 0.967, Global test loss: 1.778, Global test accuracy: 46.20 

Round   5, Train loss: 0.887, Test loss: 1.244, Test accuracy: 58.88 

Round   5, Global train loss: 0.887, Global test loss: 1.613, Global test accuracy: 48.12 

Round   6, Train loss: 0.821, Test loss: 1.085, Test accuracy: 61.96 

Round   6, Global train loss: 0.821, Global test loss: 1.571, Global test accuracy: 49.36 

Round   7, Train loss: 0.736, Test loss: 1.153, Test accuracy: 61.72 

Round   7, Global train loss: 0.736, Global test loss: 1.513, Global test accuracy: 51.64 

Round   8, Train loss: 0.680, Test loss: 0.945, Test accuracy: 68.44 

Round   8, Global train loss: 0.680, Global test loss: 1.464, Global test accuracy: 54.92 

Round   9, Train loss: 0.621, Test loss: 1.051, Test accuracy: 65.36 

Round   9, Global train loss: 0.621, Global test loss: 1.313, Global test accuracy: 58.28 

Round  10, Train loss: 0.560, Test loss: 1.000, Test accuracy: 68.36 

Round  10, Global train loss: 0.560, Global test loss: 1.443, Global test accuracy: 56.56 

Round  11, Train loss: 0.517, Test loss: 0.962, Test accuracy: 69.44 

Round  11, Global train loss: 0.517, Global test loss: 1.318, Global test accuracy: 60.24 

Round  12, Train loss: 0.481, Test loss: 0.874, Test accuracy: 71.12 

Round  12, Global train loss: 0.481, Global test loss: 1.279, Global test accuracy: 61.48 

Round  13, Train loss: 0.433, Test loss: 0.936, Test accuracy: 72.32 

Round  13, Global train loss: 0.433, Global test loss: 1.261, Global test accuracy: 61.32 

Round  14, Train loss: 0.403, Test loss: 0.926, Test accuracy: 72.04 

Round  14, Global train loss: 0.403, Global test loss: 1.230, Global test accuracy: 63.32 

Round  15, Train loss: 0.382, Test loss: 0.996, Test accuracy: 71.08 

Round  15, Global train loss: 0.382, Global test loss: 1.280, Global test accuracy: 62.44 

Round  16, Train loss: 0.343, Test loss: 1.026, Test accuracy: 72.52 

Round  16, Global train loss: 0.343, Global test loss: 1.263, Global test accuracy: 63.32 

Round  17, Train loss: 0.321, Test loss: 0.989, Test accuracy: 72.96 

Round  17, Global train loss: 0.321, Global test loss: 1.158, Global test accuracy: 65.60 

Round  18, Train loss: 0.299, Test loss: 0.975, Test accuracy: 72.72 

Round  18, Global train loss: 0.299, Global test loss: 1.254, Global test accuracy: 63.52 

Round  19, Train loss: 0.277, Test loss: 0.891, Test accuracy: 74.80 

Round  19, Global train loss: 0.277, Global test loss: 1.242, Global test accuracy: 64.96 

Round  20, Train loss: 0.262, Test loss: 0.918, Test accuracy: 74.60 

Round  20, Global train loss: 0.262, Global test loss: 1.176, Global test accuracy: 66.40 

Round  21, Train loss: 0.235, Test loss: 1.109, Test accuracy: 72.64 

Round  21, Global train loss: 0.235, Global test loss: 1.179, Global test accuracy: 66.28 

Round  22, Train loss: 0.215, Test loss: 1.033, Test accuracy: 73.96 

Round  22, Global train loss: 0.215, Global test loss: 1.157, Global test accuracy: 68.20 

Round  23, Train loss: 0.203, Test loss: 1.044, Test accuracy: 73.92 

Round  23, Global train loss: 0.203, Global test loss: 1.213, Global test accuracy: 66.56 

Round  24, Train loss: 0.195, Test loss: 0.931, Test accuracy: 75.08 

Round  24, Global train loss: 0.195, Global test loss: 1.115, Global test accuracy: 67.76 

Round  25, Train loss: 0.192, Test loss: 0.944, Test accuracy: 75.04 

Round  25, Global train loss: 0.192, Global test loss: 1.064, Global test accuracy: 68.80 

Round  26, Train loss: 0.169, Test loss: 0.968, Test accuracy: 76.84 

Round  26, Global train loss: 0.169, Global test loss: 1.122, Global test accuracy: 69.12 

Round  27, Train loss: 0.159, Test loss: 0.941, Test accuracy: 75.92 

Round  27, Global train loss: 0.159, Global test loss: 1.060, Global test accuracy: 70.24 

Round  28, Train loss: 0.152, Test loss: 1.123, Test accuracy: 73.80 

Round  28, Global train loss: 0.152, Global test loss: 1.130, Global test accuracy: 68.80 

Round  29, Train loss: 0.144, Test loss: 1.064, Test accuracy: 75.88 

Round  29, Global train loss: 0.144, Global test loss: 1.113, Global test accuracy: 70.00 

Round  30, Train loss: 0.117, Test loss: 1.049, Test accuracy: 75.92 

Round  30, Global train loss: 0.117, Global test loss: 1.108, Global test accuracy: 69.44 

Round  31, Train loss: 0.128, Test loss: 0.949, Test accuracy: 76.60 

Round  31, Global train loss: 0.128, Global test loss: 1.075, Global test accuracy: 71.16 

Round  32, Train loss: 0.112, Test loss: 1.276, Test accuracy: 72.76 

Round  32, Global train loss: 0.112, Global test loss: 1.099, Global test accuracy: 71.12 

Round  33, Train loss: 0.103, Test loss: 1.108, Test accuracy: 74.96 

Round  33, Global train loss: 0.103, Global test loss: 1.129, Global test accuracy: 69.60 

Round  34, Train loss: 0.111, Test loss: 0.917, Test accuracy: 77.08 

Round  34, Global train loss: 0.111, Global test loss: 1.064, Global test accuracy: 71.32 

Round  35, Train loss: 0.088, Test loss: 1.142, Test accuracy: 75.00 

Round  35, Global train loss: 0.088, Global test loss: 1.105, Global test accuracy: 70.48 

Round  36, Train loss: 0.095, Test loss: 1.174, Test accuracy: 74.64 

Round  36, Global train loss: 0.095, Global test loss: 1.113, Global test accuracy: 71.00 

Round  37, Train loss: 0.086, Test loss: 0.975, Test accuracy: 77.84 

Round  37, Global train loss: 0.086, Global test loss: 1.037, Global test accuracy: 71.96 

Round  38, Train loss: 0.084, Test loss: 1.244, Test accuracy: 73.36 

Round  38, Global train loss: 0.084, Global test loss: 1.054, Global test accuracy: 71.64 

Round  39, Train loss: 0.079, Test loss: 1.012, Test accuracy: 76.88 

Round  39, Global train loss: 0.079, Global test loss: 1.125, Global test accuracy: 70.28 

Round  40, Train loss: 0.075, Test loss: 0.992, Test accuracy: 78.04 

Round  40, Global train loss: 0.075, Global test loss: 1.137, Global test accuracy: 71.36 

Round  41, Train loss: 0.061, Test loss: 1.144, Test accuracy: 76.32 

Round  41, Global train loss: 0.061, Global test loss: 1.117, Global test accuracy: 70.84 

Round  42, Train loss: 0.046, Test loss: 0.938, Test accuracy: 79.20 

Round  42, Global train loss: 0.046, Global test loss: 1.074, Global test accuracy: 71.64 

Round  43, Train loss: 0.081, Test loss: 1.503, Test accuracy: 72.56 

Round  43, Global train loss: 0.081, Global test loss: 1.190, Global test accuracy: 70.60 

Round  44, Train loss: 0.065, Test loss: 0.891, Test accuracy: 79.20 

Round  44, Global train loss: 0.065, Global test loss: 1.088, Global test accuracy: 71.64 

Round  45, Train loss: 0.032, Test loss: 0.892, Test accuracy: 79.40 

Round  45, Global train loss: 0.032, Global test loss: 1.079, Global test accuracy: 72.20 

Round  46, Train loss: 0.090, Test loss: 1.089, Test accuracy: 76.04 

Round  46, Global train loss: 0.090, Global test loss: 1.086, Global test accuracy: 71.84 

Round  47, Train loss: 0.068, Test loss: 0.981, Test accuracy: 77.36 

Round  47, Global train loss: 0.068, Global test loss: 1.163, Global test accuracy: 70.80 

Round  48, Train loss: 0.043, Test loss: 0.885, Test accuracy: 79.00 

Round  48, Global train loss: 0.043, Global test loss: 1.045, Global test accuracy: 73.04 

Round  49, Train loss: 0.052, Test loss: 1.187, Test accuracy: 75.80 

Round  49, Global train loss: 0.052, Global test loss: 1.024, Global test accuracy: 73.04 

Final Round, Train loss: 0.035, Test loss: 0.958, Test accuracy: 79.68 

Final Round, Global train loss: 0.035, Global test loss: 1.024, Global test accuracy: 73.04 

Average accuracy final 10 rounds: 77.292 

Average global accuracy final 10 rounds: 71.69999999999999 

2139.877591609955
[13.196738004684448, 20.31197214126587, 27.40113401412964, 34.34852719306946, 41.40763592720032, 48.47623658180237, 55.647027015686035, 62.774380683898926, 69.74127888679504, 76.83673524856567, 83.71313047409058, 90.75294280052185, 98.05997586250305, 105.24763631820679, 112.40401077270508, 119.48842334747314, 126.46522736549377, 133.41917204856873, 140.64821028709412, 147.72334575653076, 154.94784355163574, 161.89306950569153, 168.84804272651672, 175.88248872756958, 183.230961561203, 190.47922563552856, 197.51395726203918, 204.58429074287415, 211.53677535057068, 218.75461673736572, 225.74390625953674, 232.74154829978943, 239.91126084327698, 246.9170413017273, 253.95283150672913, 261.14695978164673, 268.15103363990784, 275.34354162216187, 282.517049074173, 289.4717617034912, 296.4734444618225, 303.37265944480896, 310.2462842464447, 317.5819993019104, 324.5722167491913, 331.6906592845917, 338.943332195282, 346.1633474826813, 353.27108001708984, 360.47872495651245, 375.06842613220215]
[47.28, 51.16, 52.76, 56.96, 55.12, 58.88, 61.96, 61.72, 68.44, 65.36, 68.36, 69.44, 71.12, 72.32, 72.04, 71.08, 72.52, 72.96, 72.72, 74.8, 74.6, 72.64, 73.96, 73.92, 75.08, 75.04, 76.84, 75.92, 73.8, 75.88, 75.92, 76.6, 72.76, 74.96, 77.08, 75.0, 74.64, 77.84, 73.36, 76.88, 78.04, 76.32, 79.2, 72.56, 79.2, 79.4, 76.04, 77.36, 79.0, 75.8, 79.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.604, Test loss: 1.792, Test accuracy: 25.60 

Round   1, Train loss: 1.369, Test loss: 1.393, Test accuracy: 39.08 

Round   2, Train loss: 1.228, Test loss: 1.171, Test accuracy: 48.92 

Round   3, Train loss: 1.137, Test loss: 1.066, Test accuracy: 55.60 

Round   4, Train loss: 1.069, Test loss: 1.215, Test accuracy: 51.92 

Round   5, Train loss: 1.002, Test loss: 1.075, Test accuracy: 54.88 

Round   6, Train loss: 0.928, Test loss: 0.891, Test accuracy: 63.04 

Round   7, Train loss: 0.872, Test loss: 0.961, Test accuracy: 62.36 

Round   8, Train loss: 0.814, Test loss: 0.920, Test accuracy: 64.60 

Round   9, Train loss: 0.772, Test loss: 0.832, Test accuracy: 66.88 

Round  10, Train loss: 0.725, Test loss: 0.835, Test accuracy: 66.36 

Round  11, Train loss: 0.686, Test loss: 0.804, Test accuracy: 67.56 

Round  12, Train loss: 0.619, Test loss: 0.698, Test accuracy: 72.32 

Round  13, Train loss: 0.593, Test loss: 0.742, Test accuracy: 70.96 

Round  14, Train loss: 0.557, Test loss: 0.697, Test accuracy: 72.40 

Round  15, Train loss: 0.521, Test loss: 0.717, Test accuracy: 72.72 

Round  16, Train loss: 0.488, Test loss: 0.696, Test accuracy: 74.08 

Round  17, Train loss: 0.448, Test loss: 0.712, Test accuracy: 72.92 

Round  18, Train loss: 0.433, Test loss: 0.680, Test accuracy: 74.52 

Round  19, Train loss: 0.407, Test loss: 0.692, Test accuracy: 73.76 

Round  20, Train loss: 0.394, Test loss: 0.661, Test accuracy: 75.68 

Round  21, Train loss: 0.357, Test loss: 0.690, Test accuracy: 75.48 

Round  22, Train loss: 0.333, Test loss: 0.629, Test accuracy: 76.68 

Round  23, Train loss: 0.313, Test loss: 0.716, Test accuracy: 75.44 

Round  24, Train loss: 0.294, Test loss: 0.633, Test accuracy: 77.24 

Round  25, Train loss: 0.284, Test loss: 0.679, Test accuracy: 75.36 

Round  26, Train loss: 0.257, Test loss: 0.631, Test accuracy: 78.48 

Round  27, Train loss: 0.237, Test loss: 0.653, Test accuracy: 78.24 

Round  28, Train loss: 0.230, Test loss: 0.624, Test accuracy: 78.72 

Round  29, Train loss: 0.216, Test loss: 0.662, Test accuracy: 77.96 

Round  30, Train loss: 0.193, Test loss: 0.661, Test accuracy: 77.92 

Round  31, Train loss: 0.186, Test loss: 0.636, Test accuracy: 78.80 

Round  32, Train loss: 0.174, Test loss: 0.647, Test accuracy: 78.80 

Round  33, Train loss: 0.173, Test loss: 0.660, Test accuracy: 78.36 

Round  34, Train loss: 0.153, Test loss: 0.635, Test accuracy: 78.96 

Round  35, Train loss: 0.153, Test loss: 0.616, Test accuracy: 80.40 

Round  36, Train loss: 0.139, Test loss: 0.628, Test accuracy: 79.56 

Round  37, Train loss: 0.132, Test loss: 0.642, Test accuracy: 79.48 

Round  38, Train loss: 0.116, Test loss: 0.650, Test accuracy: 80.52 

Round  39, Train loss: 0.105, Test loss: 0.680, Test accuracy: 79.48 

Round  40, Train loss: 0.114, Test loss: 0.669, Test accuracy: 79.48 

Round  41, Train loss: 0.100, Test loss: 0.705, Test accuracy: 78.76 

Round  42, Train loss: 0.085, Test loss: 0.676, Test accuracy: 80.48 

Round  43, Train loss: 0.087, Test loss: 0.659, Test accuracy: 80.92 

Round  44, Train loss: 0.083, Test loss: 0.644, Test accuracy: 80.96 

Round  45, Train loss: 0.082, Test loss: 0.658, Test accuracy: 80.12 

Round  46, Train loss: 0.082, Test loss: 0.682, Test accuracy: 80.84 

Round  47, Train loss: 0.071, Test loss: 0.682, Test accuracy: 80.56 

Round  48, Train loss: 0.080, Test loss: 0.682, Test accuracy: 79.56 

Round  49, Train loss: 0.069, Test loss: 0.675, Test accuracy: 80.16 

Final Round, Train loss: 0.039, Test loss: 0.684, Test accuracy: 80.44 

Average accuracy final 10 rounds: 80.18400000000001 

1573.1305367946625
[11.974170446395874, 17.792924642562866, 23.624735355377197, 29.090686559677124, 34.35148644447327, 39.769864082336426, 45.05594611167908, 50.582823514938354, 56.189008474349976, 61.57732129096985, 67.02877235412598, 72.58911728858948, 78.00308084487915, 83.38798761367798, 88.75976300239563, 94.8618733882904, 100.54892587661743, 106.41359615325928, 112.24428963661194, 118.06109499931335, 123.92061877250671, 129.65372705459595, 135.54229140281677, 141.3975727558136, 146.91215538978577, 152.88776993751526, 158.5041081905365, 163.95595598220825, 169.6452658176422, 175.37261319160461, 181.16468405723572, 187.12975573539734, 192.96383118629456, 198.77358984947205, 204.5579206943512, 210.286301612854, 216.08801889419556, 222.04651999473572, 227.9790608882904, 233.59493708610535, 238.96763443946838, 244.58358907699585, 250.1763198375702, 255.7162902355194, 261.55726313591003, 267.5064754486084, 273.1444866657257, 278.83274722099304, 284.6590714454651, 290.46299743652344, 298.28098368644714]
[25.6, 39.08, 48.92, 55.6, 51.92, 54.88, 63.04, 62.36, 64.6, 66.88, 66.36, 67.56, 72.32, 70.96, 72.4, 72.72, 74.08, 72.92, 74.52, 73.76, 75.68, 75.48, 76.68, 75.44, 77.24, 75.36, 78.48, 78.24, 78.72, 77.96, 77.92, 78.8, 78.8, 78.36, 78.96, 80.4, 79.56, 79.48, 80.52, 79.48, 79.48, 78.76, 80.48, 80.92, 80.96, 80.12, 80.84, 80.56, 79.56, 80.16, 80.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
Round   0, Train loss: 1.589, Test loss: 2.116, Test accuracy: 22.96
Round   1, Train loss: 1.349, Test loss: 1.528, Test accuracy: 32.76
Round   2, Train loss: 1.243, Test loss: 1.422, Test accuracy: 40.08
Round   3, Train loss: 1.133, Test loss: 1.138, Test accuracy: 53.24
Round   4, Train loss: 1.056, Test loss: 1.128, Test accuracy: 53.72
Round   5, Train loss: 0.992, Test loss: 1.001, Test accuracy: 57.32
Round   6, Train loss: 0.923, Test loss: 0.964, Test accuracy: 60.12
Round   7, Train loss: 0.863, Test loss: 0.929, Test accuracy: 62.72
Round   8, Train loss: 0.824, Test loss: 0.909, Test accuracy: 63.00
Round   9, Train loss: 0.758, Test loss: 0.866, Test accuracy: 64.48
Round  10, Train loss: 0.713, Test loss: 0.781, Test accuracy: 67.84
Round  11, Train loss: 0.666, Test loss: 0.770, Test accuracy: 68.76
Round  12, Train loss: 0.617, Test loss: 0.781, Test accuracy: 69.48
Round  13, Train loss: 0.587, Test loss: 0.798, Test accuracy: 69.68
Round  14, Train loss: 0.545, Test loss: 0.762, Test accuracy: 70.16
Round  15, Train loss: 0.494, Test loss: 0.662, Test accuracy: 74.76
Round  16, Train loss: 0.469, Test loss: 0.645, Test accuracy: 74.92
Round  17, Train loss: 0.425, Test loss: 0.645, Test accuracy: 75.68
Round  18, Train loss: 0.416, Test loss: 0.647, Test accuracy: 75.96
Round  19, Train loss: 0.378, Test loss: 0.646, Test accuracy: 75.76
Round  20, Train loss: 0.354, Test loss: 0.648, Test accuracy: 76.56
Round  21, Train loss: 0.342, Test loss: 0.614, Test accuracy: 77.88
Round  22, Train loss: 0.313, Test loss: 0.596, Test accuracy: 78.24
Round  23, Train loss: 0.301, Test loss: 0.630, Test accuracy: 77.56
Round  24, Train loss: 0.267, Test loss: 0.617, Test accuracy: 77.44
Round  25, Train loss: 0.273, Test loss: 0.619, Test accuracy: 78.12
Round  26, Train loss: 0.252, Test loss: 0.627, Test accuracy: 77.20
Round  27, Train loss: 0.231, Test loss: 0.607, Test accuracy: 79.00
Round  28, Train loss: 0.215, Test loss: 0.615, Test accuracy: 78.68
Round  29, Train loss: 0.203, Test loss: 0.622, Test accuracy: 79.04
Round  30, Train loss: 0.185, Test loss: 0.621, Test accuracy: 78.64
Round  31, Train loss: 0.171, Test loss: 0.592, Test accuracy: 80.04
Round  32, Train loss: 0.160, Test loss: 0.619, Test accuracy: 80.12
Round  33, Train loss: 0.156, Test loss: 0.623, Test accuracy: 79.80
Round  34, Train loss: 0.155, Test loss: 0.626, Test accuracy: 80.00
Round  35, Train loss: 0.141, Test loss: 0.633, Test accuracy: 80.04
Round  36, Train loss: 0.131, Test loss: 0.640, Test accuracy: 79.00
Round  37, Train loss: 0.120, Test loss: 0.671, Test accuracy: 78.88
Round  38, Train loss: 0.116, Test loss: 0.623, Test accuracy: 79.96
Round  39, Train loss: 0.109, Test loss: 0.642, Test accuracy: 80.04
Round  40, Train loss: 0.098, Test loss: 0.627, Test accuracy: 80.16
Round  41, Train loss: 0.089, Test loss: 0.646, Test accuracy: 80.28
Round  42, Train loss: 0.086, Test loss: 0.629, Test accuracy: 80.92
Round  43, Train loss: 0.078, Test loss: 0.681, Test accuracy: 80.16
Round  44, Train loss: 0.079, Test loss: 0.641, Test accuracy: 80.56
Round  45, Train loss: 0.100, Test loss: 0.642, Test accuracy: 81.04
Round  46, Train loss: 0.073, Test loss: 0.635, Test accuracy: 80.60
Round  47, Train loss: 0.061, Test loss: 0.669, Test accuracy: 80.56
Round  48, Train loss: 0.057, Test loss: 0.652, Test accuracy: 80.92
Round  49, Train loss: 0.051, Test loss: 0.663, Test accuracy: 80.80
Final Round, Train loss: 0.028, Test loss: 0.640, Test accuracy: 81.24
Average accuracy final 10 rounds: 80.6
1885.6671233177185
[12.355080842971802, 19.05093216896057, 26.03346037864685, 32.89363145828247, 39.56584978103638, 46.56693363189697, 53.459129333496094, 60.16650319099426, 67.10943818092346, 74.37244939804077, 81.56829452514648, 88.39140129089355, 95.39095163345337, 102.57537388801575, 109.44185972213745, 116.18688702583313, 123.07869219779968, 129.9495141506195, 136.85038828849792, 143.60427594184875, 150.43680143356323, 157.3351287841797, 164.3973741531372, 171.10092949867249, 177.77156972885132, 184.64317846298218, 191.6412456035614, 198.4340877532959, 205.7505795955658, 212.84360146522522, 219.9155979156494, 227.10822463035583, 234.20615530014038, 241.31971669197083, 248.1249566078186, 255.42850732803345, 262.0771646499634, 269.02579832077026, 276.10190892219543, 283.4998321533203, 290.72280168533325, 297.88054513931274, 304.94640016555786, 311.89385294914246, 318.9270529747009, 326.00382900238037, 333.2212426662445, 340.1884639263153, 347.1352334022522, 354.0920329093933, 361.9077260494232]
[22.96, 32.76, 40.08, 53.24, 53.72, 57.32, 60.12, 62.72, 63.0, 64.48, 67.84, 68.76, 69.48, 69.68, 70.16, 74.76, 74.92, 75.68, 75.96, 75.76, 76.56, 77.88, 78.24, 77.56, 77.44, 78.12, 77.2, 79.0, 78.68, 79.04, 78.64, 80.04, 80.12, 79.8, 80.0, 80.04, 79.0, 78.88, 79.96, 80.04, 80.16, 80.28, 80.92, 80.16, 80.56, 81.04, 80.6, 80.56, 80.92, 80.8, 81.24]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11183582 (local), 11178452 (global); Percentage 99.95 (11178452/11183582 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.906, Train accuracy: 62.200, Test loss: 0.989, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.786, Train accuracy: 64.400, Test loss: 1.001, Test accuracy: 60.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.767, Train accuracy: 69.400, Test loss: 1.116, Test accuracy: 58.80 

Round   0, Train loss: 0.767, Test loss: 1.116, Test accuracy: 58.80 

        train local model (freeze embeding):client   0,  Train loss: 0.661, Train accuracy: 74.200, Test loss: 1.045, Test accuracy: 62.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.649, Train accuracy: 74.000, Test loss: 1.092, Test accuracy: 62.80 

Round   1, Train loss: 0.649, Test loss: 1.092, Test accuracy: 62.80 

        train local model (freeze embeding):client   0,  Train loss: 0.515, Train accuracy: 82.200, Test loss: 0.969, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.459, Train accuracy: 83.600, Test loss: 1.029, Test accuracy: 65.40 

Round   2, Train loss: 0.459, Test loss: 1.029, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.368, Train accuracy: 85.800, Test loss: 1.031, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.309, Train accuracy: 89.200, Test loss: 1.148, Test accuracy: 65.40 

Round   3, Train loss: 0.309, Test loss: 1.148, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.275, Train accuracy: 89.400, Test loss: 1.119, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.340, Train accuracy: 87.600, Test loss: 1.377, Test accuracy: 64.00 

Round   4, Train loss: 0.340, Test loss: 1.377, Test accuracy: 64.00 

        train local model (freeze embeding):client   0,  Train loss: 0.197, Train accuracy: 92.000, Test loss: 1.212, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.299, Train accuracy: 89.200, Test loss: 1.454, Test accuracy: 64.60 

Round   5, Train loss: 0.299, Test loss: 1.454, Test accuracy: 64.60 

        train local model (freeze embeding):client   0,  Train loss: 0.132, Train accuracy: 94.600, Test loss: 1.207, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.185, Train accuracy: 94.200, Test loss: 1.486, Test accuracy: 61.80 

Round   6, Train loss: 0.185, Test loss: 1.486, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.093, Train accuracy: 97.200, Test loss: 1.227, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.081, Train accuracy: 98.000, Test loss: 1.164, Test accuracy: 70.20 

Round   7, Train loss: 0.081, Test loss: 1.164, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.055, Train accuracy: 98.400, Test loss: 1.188, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 97.800, Test loss: 1.534, Test accuracy: 69.40 

Round   8, Train loss: 0.064, Test loss: 1.534, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.071, Train accuracy: 97.000, Test loss: 1.432, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.064, Train accuracy: 97.800, Test loss: 1.618, Test accuracy: 67.60 

Round   9, Train loss: 0.064, Test loss: 1.618, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.479, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 1.552, Test accuracy: 70.80 

Round  10, Train loss: 0.015, Test loss: 1.552, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.566, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.587, Test accuracy: 68.80 

Round  11, Train loss: 0.021, Test loss: 1.587, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.457, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.800, Test loss: 1.607, Test accuracy: 69.60 

Round  12, Train loss: 0.039, Test loss: 1.607, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.407, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.060, Train accuracy: 97.600, Test loss: 1.472, Test accuracy: 69.80 

Round  13, Train loss: 0.060, Test loss: 1.472, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.430, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.778, Test accuracy: 67.80 

Round  14, Train loss: 0.006, Test loss: 1.778, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.725, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.558, Test accuracy: 69.40 

Round  15, Train loss: 0.018, Test loss: 1.558, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.568, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.600, Test loss: 1.773, Test accuracy: 69.20 

Round  16, Train loss: 0.036, Test loss: 1.773, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.400, Test loss: 1.608, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.635, Test accuracy: 72.20 

Round  17, Train loss: 0.003, Test loss: 1.635, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.588, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.809, Test accuracy: 67.80 

Round  18, Train loss: 0.007, Test loss: 1.809, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.708, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.867, Test accuracy: 72.20 

Round  19, Train loss: 0.002, Test loss: 1.867, Test accuracy: 72.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.938, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.886, Test accuracy: 71.00 

Final Round, Train loss: 0.002, Test loss: 1.816, Test accuracy: 70.80 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.622, Train accuracy: 76.000, Test loss: 0.748, Test accuracy: 70.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.850, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.699, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.590, Train accuracy: 78.000, Test loss: 0.712, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.307, Train accuracy: 87.600, Test loss: 1.292, Test accuracy: 64.80 

Round   0, Train loss: 0.154, Test loss: 1.148, Test accuracy: 73.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.471, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.549, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.280, Train accuracy: 89.800, Test loss: 0.812, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.121, Train accuracy: 95.400, Test loss: 1.036, Test accuracy: 72.80 

Round   1, Train loss: 0.063, Test loss: 1.130, Test accuracy: 74.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.335, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.150, Train accuracy: 95.000, Test loss: 0.832, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.086, Train accuracy: 97.200, Test loss: 0.899, Test accuracy: 74.00 

Round   2, Train loss: 0.044, Test loss: 0.978, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.217, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.531, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.134, Train accuracy: 95.400, Test loss: 0.903, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.150, Train accuracy: 95.000, Test loss: 1.510, Test accuracy: 66.40 

Round   3, Train loss: 0.076, Test loss: 1.217, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.294, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.027, Train accuracy: 98.800, Test loss: 1.639, Test accuracy: 71.00 

        train local model (freeze embeding):client   1,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 0.989, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.042, Train accuracy: 98.800, Test loss: 1.122, Test accuracy: 71.20 

Round   4, Train loss: 0.035, Test loss: 1.060, Test accuracy: 75.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.185, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 74.60 

        train local model (freeze embeding):client   1,  Train loss: 0.030, Train accuracy: 99.800, Test loss: 0.907, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.400, Test loss: 1.176, Test accuracy: 73.40 

Round   5, Train loss: 0.015, Test loss: 1.057, Test accuracy: 77.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.147, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.435, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.400, Test loss: 1.010, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.084, Train accuracy: 98.000, Test loss: 1.348, Test accuracy: 69.80 

Round   6, Train loss: 0.044, Test loss: 1.085, Test accuracy: 76.30 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.288, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 0.969, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.093, Train accuracy: 96.000, Test loss: 1.663, Test accuracy: 69.20 

Round   7, Train loss: 0.048, Test loss: 1.202, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.203, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.085, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 1.451, Test accuracy: 73.20 

Round   8, Train loss: 0.019, Test loss: 1.148, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.056, Train accuracy: 98.000, Test loss: 1.870, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.333, Test accuracy: 74.00 

Round   9, Train loss: 0.030, Test loss: 1.255, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.291, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.381, Test accuracy: 74.80 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.141, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.500, Test accuracy: 73.60 

Round  10, Train loss: 0.010, Test loss: 1.188, Test accuracy: 77.30 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.211, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.453, Test accuracy: 74.60 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.186, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.688, Test accuracy: 72.60 

Round  11, Train loss: 0.010, Test loss: 1.248, Test accuracy: 76.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.278, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.327, Test accuracy: 75.20 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.176, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.278, Test accuracy: 75.60 

Round  12, Train loss: 0.007, Test loss: 1.161, Test accuracy: 77.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.203, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.346, Test accuracy: 75.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.183, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.200, Test loss: 1.491, Test accuracy: 71.80 

Round  13, Train loss: 0.010, Test loss: 1.235, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.230, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.396, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.078, Train accuracy: 97.000, Test loss: 1.687, Test accuracy: 71.00 

Round  14, Train loss: 0.039, Test loss: 1.257, Test accuracy: 76.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.298, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 98.600, Test loss: 1.541, Test accuracy: 72.00 

Round  15, Train loss: 0.022, Test loss: 1.161, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.562, Test accuracy: 71.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.225, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 74.60 

Round  16, Train loss: 0.006, Test loss: 1.227, Test accuracy: 76.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.253, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.553, Test accuracy: 70.80 

Round  17, Train loss: 0.005, Test loss: 1.223, Test accuracy: 76.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.242, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.494, Test accuracy: 76.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.262, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 73.60 

Round  18, Train loss: 0.001, Test loss: 1.312, Test accuracy: 75.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.408, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.307, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.200, Test loss: 1.956, Test accuracy: 67.60 

Round  19, Train loss: 0.013, Test loss: 1.303, Test accuracy: 75.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.179, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 76.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.276, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.283, Test accuracy: 75.00 

Final Round, Train loss: 0.002, Test loss: 1.251, Test accuracy: 75.50 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.751, Train accuracy: 70.600, Test loss: 1.039, Test accuracy: 63.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.162, Test accuracy: 77.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.330, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.400, Test loss: 1.590, Test accuracy: 70.60 

        train local model (freeze embeding):client   2,  Train loss: 0.748, Train accuracy: 69.800, Test loss: 0.996, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.228, Train accuracy: 92.200, Test loss: 1.146, Test accuracy: 66.20 

Round   0, Train loss: 0.083, Test loss: 1.093, Test accuracy: 74.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.223, Test accuracy: 76.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.233, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.348, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.396, Train accuracy: 84.800, Test loss: 0.966, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.128, Train accuracy: 96.600, Test loss: 1.153, Test accuracy: 68.40 

Round   1, Train loss: 0.050, Test loss: 1.060, Test accuracy: 74.07 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.168, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.200, Test loss: 1.286, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.199, Train accuracy: 93.800, Test loss: 0.990, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.103, Train accuracy: 96.400, Test loss: 1.306, Test accuracy: 70.20 

Round   2, Train loss: 0.043, Test loss: 0.988, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.119, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.013, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.454, Test accuracy: 73.20 

        train local model (freeze embeding):client   2,  Train loss: 0.121, Train accuracy: 96.600, Test loss: 1.013, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.227, Train accuracy: 92.200, Test loss: 1.576, Test accuracy: 67.60 

Round   3, Train loss: 0.078, Test loss: 1.056, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.351, Test accuracy: 74.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.035, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.227, Test accuracy: 75.60 

        train local model (freeze embeding):client   2,  Train loss: 0.074, Train accuracy: 98.400, Test loss: 1.101, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.046, Train accuracy: 98.600, Test loss: 1.406, Test accuracy: 66.60 

Round   4, Train loss: 0.017, Test loss: 1.077, Test accuracy: 75.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.988, Test accuracy: 77.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.244, Test accuracy: 76.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 77.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.278, Test accuracy: 75.00 

        train local model (freeze embeding):client   2,  Train loss: 0.044, Train accuracy: 99.200, Test loss: 1.148, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.053, Train accuracy: 98.600, Test loss: 1.269, Test accuracy: 67.80 

Round   5, Train loss: 0.019, Test loss: 1.110, Test accuracy: 74.13 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.302, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.600, Test loss: 1.157, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.069, Train accuracy: 97.400, Test loss: 1.509, Test accuracy: 70.00 

Round   6, Train loss: 0.030, Test loss: 1.044, Test accuracy: 74.47 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.149, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 98.800, Test loss: 1.195, Test accuracy: 72.80 

        train local model (freeze embeding):client   2,  Train loss: 0.032, Train accuracy: 99.200, Test loss: 1.117, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.479, Test accuracy: 70.40 

Round   7, Train loss: 0.013, Test loss: 1.063, Test accuracy: 76.07 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.120, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 76.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 76.80 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.220, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 96.800, Test loss: 1.578, Test accuracy: 69.80 

Round   8, Train loss: 0.027, Test loss: 1.079, Test accuracy: 76.93 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.218, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.418, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.213, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.432, Test accuracy: 69.80 

Round   9, Train loss: 0.022, Test loss: 1.119, Test accuracy: 76.47 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.049, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.027, Train accuracy: 99.200, Test loss: 1.274, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.240, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.468, Test accuracy: 71.60 

Round  10, Train loss: 0.015, Test loss: 1.088, Test accuracy: 77.47 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.293, Test accuracy: 75.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 75.80 

        train local model (freeze embeding):client   2,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.342, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.062, Train accuracy: 98.200, Test loss: 1.497, Test accuracy: 68.80 

Round  11, Train loss: 0.021, Test loss: 1.092, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.160, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.209, Test accuracy: 75.80 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.675, Test accuracy: 71.00 

Round  12, Train loss: 0.006, Test loss: 1.095, Test accuracy: 76.93 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 76.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.377, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.665, Test accuracy: 72.00 

Round  13, Train loss: 0.005, Test loss: 1.134, Test accuracy: 76.93 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.400, Test loss: 1.133, Test accuracy: 77.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.115, Test accuracy: 76.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.418, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.571, Test accuracy: 70.80 

Round  14, Train loss: 0.008, Test loss: 1.125, Test accuracy: 77.07 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.038, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.121, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 98.400, Test loss: 1.454, Test accuracy: 70.80 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 1.658, Test accuracy: 71.20 

Round  15, Train loss: 0.023, Test loss: 1.107, Test accuracy: 76.33 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.935, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.024, Test accuracy: 77.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.076, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.379, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.412, Test accuracy: 73.80 

Round  16, Train loss: 0.000, Test loss: 1.118, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.219, Test accuracy: 77.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.167, Test accuracy: 76.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.440, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.508, Test accuracy: 72.60 

Round  17, Train loss: 0.001, Test loss: 1.153, Test accuracy: 77.07 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.040, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 79.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.271, Test accuracy: 74.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.480, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 73.60 

Round  18, Train loss: 0.004, Test loss: 1.146, Test accuracy: 77.73 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 77.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.466, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.618, Test accuracy: 70.40 

Round  19, Train loss: 0.004, Test loss: 1.121, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.010, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.014, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.421, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 73.20 

Final Round, Train loss: 0.001, Test loss: 1.106, Test accuracy: 76.93 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.632, Train accuracy: 72.800, Test loss: 0.898, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.976, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 80.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.031, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.800, Test loss: 1.249, Test accuracy: 73.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.151, Train accuracy: 95.000, Test loss: 2.224, Test accuracy: 66.00 

        train local model (freeze embeding):client   3,  Train loss: 0.616, Train accuracy: 76.600, Test loss: 0.885, Test accuracy: 65.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.160, Train accuracy: 94.200, Test loss: 1.125, Test accuracy: 64.60 

Round   0, Train loss: 0.087, Test loss: 1.024, Test accuracy: 74.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 78.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.160, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.335, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.412, Test accuracy: 70.40 

        train local model (freeze embeding):client   3,  Train loss: 0.397, Train accuracy: 84.200, Test loss: 0.941, Test accuracy: 66.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.147, Train accuracy: 95.200, Test loss: 1.306, Test accuracy: 67.20 

Round   1, Train loss: 0.044, Test loss: 1.009, Test accuracy: 74.95 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.948, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 76.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.235, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.475, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.182, Train accuracy: 95.800, Test loss: 0.906, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.159, Train accuracy: 94.600, Test loss: 1.303, Test accuracy: 67.40 

Round   2, Train loss: 0.045, Test loss: 0.995, Test accuracy: 75.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.931, Test accuracy: 80.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.210, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.276, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.195, Test accuracy: 70.80 

        train local model (freeze embeding):client   3,  Train loss: 0.097, Train accuracy: 98.000, Test loss: 0.927, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.069, Train accuracy: 98.600, Test loss: 1.263, Test accuracy: 71.40 

Round   3, Train loss: 0.029, Test loss: 0.950, Test accuracy: 76.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 78.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.364, Test accuracy: 72.20 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.389, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.086, Train accuracy: 98.600, Test loss: 0.946, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.074, Train accuracy: 97.200, Test loss: 1.549, Test accuracy: 66.40 

Round   4, Train loss: 0.029, Test loss: 1.032, Test accuracy: 75.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.032, Train accuracy: 98.800, Test loss: 1.270, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.921, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.591, Test accuracy: 72.60 

        train local model (freeze embeding):client   3,  Train loss: 0.041, Train accuracy: 99.600, Test loss: 1.038, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.091, Train accuracy: 96.800, Test loss: 1.578, Test accuracy: 69.00 

Round   5, Train loss: 0.038, Test loss: 1.022, Test accuracy: 75.95 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.918, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 79.60 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.106, Train accuracy: 95.600, Test loss: 1.758, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 100.000, Test loss: 1.037, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.113, Train accuracy: 95.200, Test loss: 1.538, Test accuracy: 66.80 

Round   6, Train loss: 0.055, Test loss: 1.045, Test accuracy: 75.95 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.942, Test accuracy: 80.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.088, Test accuracy: 78.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.400, Test loss: 1.482, Test accuracy: 73.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.091, Train accuracy: 96.800, Test loss: 1.578, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 99.800, Test loss: 1.114, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.125, Train accuracy: 95.400, Test loss: 1.480, Test accuracy: 68.00 

Round   7, Train loss: 0.058, Test loss: 1.049, Test accuracy: 75.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.918, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 78.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.234, Test accuracy: 76.40 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 98.800, Test loss: 1.434, Test accuracy: 67.40 

Round   8, Train loss: 0.012, Test loss: 1.045, Test accuracy: 76.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.013, Test accuracy: 79.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.964, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.178, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.518, Test accuracy: 71.00 

        train local model (freeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.182, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.080, Train accuracy: 96.800, Test loss: 1.658, Test accuracy: 63.40 

Round   9, Train loss: 0.022, Test loss: 1.028, Test accuracy: 76.35 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 79.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.169, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.411, Test accuracy: 72.80 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.497, Test accuracy: 72.00 

Round  10, Train loss: 0.004, Test loss: 1.036, Test accuracy: 77.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.128, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.353, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.226, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.800, Test loss: 1.383, Test accuracy: 69.00 

Round  11, Train loss: 0.005, Test loss: 1.079, Test accuracy: 76.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.953, Test accuracy: 82.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.800, Test loss: 1.056, Test accuracy: 76.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 98.800, Test loss: 1.386, Test accuracy: 68.80 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.190, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.182, Train accuracy: 94.600, Test loss: 1.834, Test accuracy: 66.80 

Round  12, Train loss: 0.058, Test loss: 0.982, Test accuracy: 76.10 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.821, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.243, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.043, Train accuracy: 98.400, Test loss: 1.500, Test accuracy: 67.20 

Round  13, Train loss: 0.011, Test loss: 1.002, Test accuracy: 76.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.863, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.017, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.879, Test accuracy: 78.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.053, Test accuracy: 78.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.214, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.101, Train accuracy: 96.600, Test loss: 1.600, Test accuracy: 66.60 

Round  14, Train loss: 0.026, Test loss: 1.047, Test accuracy: 76.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 79.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.268, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.340, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.184, Test accuracy: 71.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.365, Test accuracy: 74.00 

Round  15, Train loss: 0.002, Test loss: 1.054, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.892, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.094, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 78.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.109, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.279, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.399, Test accuracy: 73.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 99.200, Test loss: 1.686, Test accuracy: 70.60 

Round  16, Train loss: 0.015, Test loss: 1.066, Test accuracy: 76.80 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.884, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.958, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 79.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.950, Test accuracy: 79.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.309, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 1.332, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.198, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.600, Test loss: 1.572, Test accuracy: 66.60 

Round  17, Train loss: 0.005, Test loss: 1.057, Test accuracy: 77.65 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.877, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.932, Test accuracy: 79.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.974, Test accuracy: 80.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.290, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.282, Test accuracy: 73.40 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.184, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.571, Test accuracy: 70.80 

Round  18, Train loss: 0.002, Test loss: 1.076, Test accuracy: 76.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.091, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.200, Test loss: 1.469, Test accuracy: 72.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.296, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.177, Train accuracy: 94.800, Test loss: 2.093, Test accuracy: 64.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.561, Test accuracy: 68.60 

Round  19, Train loss: 0.058, Test loss: 1.058, Test accuracy: 75.20 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.833, Test accuracy: 80.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.959, Test accuracy: 78.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.928, Test accuracy: 78.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 74.80 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.175, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.174, Test accuracy: 71.60 

Final Round, Train loss: 0.002, Test loss: 1.029, Test accuracy: 76.25 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.557, Train accuracy: 79.600, Test loss: 0.810, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.824, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.963, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.986, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.490, Test accuracy: 72.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.192, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 99.400, Test loss: 1.605, Test accuracy: 68.80 

        train local model (freeze embeding):client   4,  Train loss: 0.544, Train accuracy: 79.800, Test loss: 0.778, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.123, Train accuracy: 96.400, Test loss: 1.221, Test accuracy: 66.60 

Round   0, Train loss: 0.033, Test loss: 0.927, Test accuracy: 77.16 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.901, Test accuracy: 80.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.852, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.176, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.302, Test accuracy: 74.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.165, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.369, Test accuracy: 73.20 

        train local model (freeze embeding):client   4,  Train loss: 0.333, Train accuracy: 86.600, Test loss: 0.790, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.129, Train accuracy: 95.600, Test loss: 1.302, Test accuracy: 70.20 

Round   1, Train loss: 0.027, Test loss: 0.946, Test accuracy: 76.44 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.784, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.600, Test loss: 1.095, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 79.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.231, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.270, Test accuracy: 76.20 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.201, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.159, Train accuracy: 95.000, Test loss: 1.818, Test accuracy: 63.00 

        train local model (freeze embeding):client   4,  Train loss: 0.176, Train accuracy: 95.800, Test loss: 0.794, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.141, Train accuracy: 96.000, Test loss: 1.310, Test accuracy: 65.20 

Round   2, Train loss: 0.062, Test loss: 0.965, Test accuracy: 76.84 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.053, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.898, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.972, Test accuracy: 79.80 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.321, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 1.314, Test accuracy: 73.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.367, Test accuracy: 73.60 

        train local model (freeze embeding):client   4,  Train loss: 0.118, Train accuracy: 96.800, Test loss: 0.865, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.060, Train accuracy: 97.800, Test loss: 1.254, Test accuracy: 71.00 

Round   3, Train loss: 0.018, Test loss: 0.942, Test accuracy: 76.48 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.792, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 0.992, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 79.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.930, Test accuracy: 79.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.403, Test accuracy: 73.20 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.148, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.600, Test loss: 1.566, Test accuracy: 69.00 

        train local model (freeze embeding):client   4,  Train loss: 0.074, Train accuracy: 98.600, Test loss: 0.883, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.038, Train accuracy: 99.400, Test loss: 1.210, Test accuracy: 69.20 

Round   4, Train loss: 0.013, Test loss: 0.963, Test accuracy: 77.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 99.800, Test loss: 0.813, Test accuracy: 81.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.914, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.925, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.153, Test accuracy: 75.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.172, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.644, Test accuracy: 69.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.135, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.434, Test accuracy: 72.80 

        train local model (freeze embeding):client   4,  Train loss: 0.045, Train accuracy: 99.400, Test loss: 0.955, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.192, Train accuracy: 93.200, Test loss: 1.718, Test accuracy: 63.80 

Round   5, Train loss: 0.045, Test loss: 0.954, Test accuracy: 76.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.079, Test accuracy: 78.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.848, Test accuracy: 79.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.916, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.259, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.024, Train accuracy: 99.200, Test loss: 1.484, Test accuracy: 70.20 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.090, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.476, Test accuracy: 71.40 

        train local model (freeze embeding):client   4,  Train loss: 0.036, Train accuracy: 99.400, Test loss: 0.945, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 71.40 

Round   6, Train loss: 0.012, Test loss: 0.936, Test accuracy: 78.04 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.845, Test accuracy: 79.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 81.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 0.975, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.137, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.234, Test accuracy: 75.20 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 75.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.049, Train accuracy: 97.600, Test loss: 1.643, Test accuracy: 65.80 

        train local model (freeze embeding):client   4,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 0.931, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.142, Train accuracy: 94.000, Test loss: 1.426, Test accuracy: 68.80 

Round   7, Train loss: 0.040, Test loss: 0.951, Test accuracy: 77.84 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.778, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.890, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.832, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.371, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.034, Train accuracy: 98.800, Test loss: 1.482, Test accuracy: 69.80 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 0.988, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 98.800, Test loss: 1.553, Test accuracy: 68.80 

Round   8, Train loss: 0.023, Test loss: 0.920, Test accuracy: 78.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 83.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.781, Test accuracy: 82.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.835, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.069, Test accuracy: 77.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.131, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.262, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.077, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.200, Test accuracy: 74.20 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.109, Train accuracy: 95.600, Test loss: 1.808, Test accuracy: 64.20 

Round   9, Train loss: 0.027, Test loss: 0.915, Test accuracy: 77.88 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.725, Test accuracy: 83.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.829, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.839, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.003, Test accuracy: 79.60 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.066, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.215, Test accuracy: 76.60 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.073, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.126, Train accuracy: 95.200, Test loss: 1.518, Test accuracy: 64.60 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 0.957, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.247, Train accuracy: 93.000, Test loss: 2.017, Test accuracy: 63.80 

Round  10, Train loss: 0.075, Test loss: 0.945, Test accuracy: 77.28 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.779, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 80.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 78.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.133, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.291, Test accuracy: 74.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.254, Test accuracy: 74.80 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 0.992, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.066, Train accuracy: 98.400, Test loss: 1.261, Test accuracy: 70.00 

Round  11, Train loss: 0.014, Test loss: 0.962, Test accuracy: 77.92 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.789, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 0.889, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.904, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 0.963, Test accuracy: 79.40 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.136, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.237, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.157, Train accuracy: 94.400, Test loss: 1.752, Test accuracy: 64.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 75.80 

Round  12, Train loss: 0.037, Test loss: 0.957, Test accuracy: 77.44 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.757, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 81.60 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.788, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.817, Test accuracy: 81.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.140, Test accuracy: 75.80 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.122, Test accuracy: 76.80 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 71.80 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.018, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.036, Train accuracy: 99.200, Test loss: 1.478, Test accuracy: 70.20 

Round  13, Train loss: 0.009, Test loss: 0.963, Test accuracy: 77.92 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.746, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.862, Test accuracy: 81.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.855, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.200, Test loss: 1.109, Test accuracy: 77.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 99.400, Test loss: 1.380, Test accuracy: 73.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.111, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.205, Test accuracy: 75.60 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.021, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.077, Train accuracy: 97.800, Test loss: 1.494, Test accuracy: 67.80 

Round  14, Train loss: 0.026, Test loss: 0.943, Test accuracy: 77.92 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 81.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 81.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.832, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.099, Test accuracy: 78.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.104, Test accuracy: 76.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 76.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.087, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.277, Test accuracy: 71.80 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.059, Train accuracy: 97.600, Test loss: 1.462, Test accuracy: 68.00 

Round  15, Train loss: 0.013, Test loss: 0.988, Test accuracy: 77.96 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.776, Test accuracy: 82.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.811, Test accuracy: 82.80 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 80.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.142, Test accuracy: 76.60 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.177, Test accuracy: 75.60 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.275, Test accuracy: 74.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.065, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.172, Train accuracy: 95.200, Test loss: 1.637, Test accuracy: 68.80 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.053, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.240, Test accuracy: 73.20 

Round  16, Train loss: 0.036, Test loss: 0.979, Test accuracy: 77.88 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 82.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.819, Test accuracy: 82.40 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 80.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.960, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.133, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.260, Test accuracy: 75.60 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 76.40 

        train local model (unfreeze embeding):client   3,  Train loss: 0.109, Train accuracy: 95.800, Test loss: 1.708, Test accuracy: 67.60 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.050, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.229, Test accuracy: 77.20 

Round  17, Train loss: 0.023, Test loss: 0.995, Test accuracy: 78.04 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 84.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.799, Test accuracy: 83.80 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 82.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 81.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.163, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.047, Train accuracy: 98.400, Test loss: 1.641, Test accuracy: 71.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.139, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.558, Test accuracy: 72.60 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.033, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   4,  Train loss: 0.008, Train accuracy: 99.600, Test loss: 1.425, Test accuracy: 72.60 

Round  18, Train loss: 0.011, Test loss: 1.019, Test accuracy: 77.72 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 84.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.851, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.903, Test accuracy: 82.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 81.20 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.233, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.264, Test accuracy: 74.40 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.173, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.081, Train accuracy: 98.000, Test loss: 1.581, Test accuracy: 66.40 

        train local model (freeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.086, Test accuracy: 75.20 

        train local model (unfreeze embeding):client   4,  Train loss: 0.047, Train accuracy: 97.800, Test loss: 1.417, Test accuracy: 70.00 

Round  19, Train loss: 0.026, Test loss: 0.924, Test accuracy: 78.16 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.739, Test accuracy: 83.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.732, Test accuracy: 83.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.886, Test accuracy: 81.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.849, Test accuracy: 80.80 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.108, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 75.80 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.022, Test accuracy: 76.60 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.023, Test accuracy: 76.80 

        train local model (freeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.032, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   4,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 74.20 

Final Round, Train loss: 0.001, Test loss: 0.924, Test accuracy: 78.20 

Average accuracy final 10 rounds: 377.5873333333331 

6056.696576833725
[18.969250440597534, 37.66043949127197, 56.73605537414551, 75.44078707695007, 94.33837246894836, 112.92577481269836, 131.8568663597107, 150.6256115436554, 169.4116714000702, 188.24819111824036, 206.72787857055664, 225.32734036445618, 244.23230624198914, 262.8818311691284, 281.4814393520355, 300.3271019458771, 318.9366271495819, 337.2546875476837, 356.0345869064331, 374.7208571434021, 388.04964208602905, 406.9659094810486, 425.4373731613159, 444.3696162700653, 463.2013602256775, 481.9419538974762, 501.0143632888794, 520.2201766967773, 538.7443151473999, 557.2575454711914, 576.0260322093964, 594.8679993152618, 613.2035374641418, 631.7775328159332, 650.2201282978058, 668.8348405361176, 687.79669880867, 706.3035068511963, 725.1157629489899, 743.599627494812, 762.0591468811035, 775.1458413600922, 793.8208963871002, 812.3964092731476, 831.1084153652191, 849.7926151752472, 868.5724041461945, 887.4706764221191, 906.0639419555664, 924.7156121730804, 943.3090145587921, 961.9563229084015, 981.0707581043243, 999.7090375423431, 1018.3938970565796, 1036.9222450256348, 1055.4353244304657, 1073.932632446289, 1092.5645060539246, 1111.2965681552887, 1129.8635663986206, 1148.6006255149841, 1161.9751353263855, 1180.6613681316376, 1199.4370715618134, 1218.186057806015, 1236.7068979740143, 1255.686444759369, 1274.424310684204, 1293.1500315666199, 1311.8211741447449, 1330.5686676502228, 1349.1880140304565, 1367.927615404129, 1386.606384754181, 1405.4196548461914, 1424.075401544571, 1442.5908417701721, 1461.0815958976746, 1479.6063044071198, 1498.14186835289, 1516.620764017105, 1535.2475156784058, 1548.6003534793854, 1567.0981268882751, 1585.9359056949615, 1604.8049490451813, 1623.6150116920471, 1642.3147420883179, 1660.9962434768677, 1679.5853922367096, 1698.3180708885193, 1717.4594702720642, 1736.4719297885895, 1755.2764842510223, 1774.0852088928223, 1792.7012598514557, 1811.459457397461, 1830.2007625102997, 1848.6431107521057, 1867.4261140823364, 1886.897085905075, 1905.4839673042297, 1924.1085367202759, 1937.4503979682922]
[58.8, 62.8, 65.4, 65.4, 64.0, 64.6, 61.8, 70.2, 69.4, 67.6, 70.8, 68.8, 69.6, 69.8, 67.8, 69.4, 69.2, 72.2, 67.8, 72.2, 70.8, 73.1, 74.4, 76.8, 74.5, 75.6, 77.1, 76.3, 75.0, 76.6, 74.3, 77.3, 76.2, 77.4, 75.4, 76.9, 76.6, 76.6, 76.3, 75.7, 75.1, 75.5, 74.2, 74.06666666666666, 74.6, 75.4, 75.4, 74.13333333333334, 74.46666666666667, 76.06666666666666, 76.93333333333334, 76.46666666666667, 77.46666666666667, 75.8, 76.93333333333334, 76.93333333333334, 77.06666666666666, 76.33333333333333, 77.2, 77.06666666666666, 77.73333333333333, 76.8, 76.93333333333334, 74.3, 74.95, 75.75, 76.1, 75.25, 75.95, 75.95, 75.8, 76.7, 76.35, 77.65, 76.7, 76.1, 76.65, 76.75, 76.8, 76.8, 77.65, 76.9, 75.2, 76.25, 77.16, 76.44, 76.84, 76.48, 77.2, 76.96, 78.04, 77.84, 78.8, 77.88, 77.28, 77.92, 77.44, 77.92, 77.92, 77.96, 77.88, 78.04, 77.72, 78.16, 78.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.449, Test loss: 1.203, Test accuracy: 54.50 

Round   0, Global train loss: 1.449, Global test loss: 1.643, Global test accuracy: 28.40 

Round   1, Train loss: 1.126, Test loss: 1.383, Test accuracy: 53.40 

Round   1, Global train loss: 1.126, Global test loss: 1.920, Global test accuracy: 28.40 

Round   2, Train loss: 0.963, Test loss: 1.185, Test accuracy: 56.30 

Round   2, Global train loss: 0.963, Global test loss: 1.809, Global test accuracy: 29.60 

Round   3, Train loss: 0.847, Test loss: 1.050, Test accuracy: 60.90 

Round   3, Global train loss: 0.847, Global test loss: 1.868, Global test accuracy: 20.80 

Round   4, Train loss: 0.738, Test loss: 1.238, Test accuracy: 61.80 

Round   4, Global train loss: 0.738, Global test loss: 2.326, Global test accuracy: 20.40 

Round   5, Train loss: 0.642, Test loss: 1.359, Test accuracy: 57.80 

Round   5, Global train loss: 0.642, Global test loss: 2.234, Global test accuracy: 24.10 

Round   6, Train loss: 0.531, Test loss: 1.264, Test accuracy: 64.00 

Round   6, Global train loss: 0.531, Global test loss: 2.521, Global test accuracy: 21.10 

Round   7, Train loss: 0.509, Test loss: 1.253, Test accuracy: 67.80 

Round   7, Global train loss: 0.509, Global test loss: 2.342, Global test accuracy: 21.80 

Round   8, Train loss: 0.391, Test loss: 1.590, Test accuracy: 62.10 

Round   8, Global train loss: 0.391, Global test loss: 2.843, Global test accuracy: 20.50 

Round   9, Train loss: 0.327, Test loss: 1.361, Test accuracy: 65.90 

Round   9, Global train loss: 0.327, Global test loss: 2.709, Global test accuracy: 20.40 

Round  10, Train loss: 0.271, Test loss: 1.541, Test accuracy: 65.90 

Round  10, Global train loss: 0.271, Global test loss: 2.943, Global test accuracy: 20.60 

Round  11, Train loss: 0.236, Test loss: 1.471, Test accuracy: 66.20 

Round  11, Global train loss: 0.236, Global test loss: 3.117, Global test accuracy: 20.30 

Round  12, Train loss: 0.187, Test loss: 1.515, Test accuracy: 69.50 

Round  12, Global train loss: 0.187, Global test loss: 2.875, Global test accuracy: 20.60 

Round  13, Train loss: 0.161, Test loss: 1.427, Test accuracy: 69.30 

Round  13, Global train loss: 0.161, Global test loss: 3.022, Global test accuracy: 20.40 

Round  14, Train loss: 0.168, Test loss: 1.568, Test accuracy: 68.40 

Round  14, Global train loss: 0.168, Global test loss: 2.911, Global test accuracy: 20.50 

Round  15, Train loss: 0.148, Test loss: 1.415, Test accuracy: 71.00 

Round  15, Global train loss: 0.148, Global test loss: 3.238, Global test accuracy: 20.50 

Round  16, Train loss: 0.132, Test loss: 1.567, Test accuracy: 68.50 

Round  16, Global train loss: 0.132, Global test loss: 3.515, Global test accuracy: 20.50 

Round  17, Train loss: 0.103, Test loss: 1.404, Test accuracy: 70.50 

Round  17, Global train loss: 0.103, Global test loss: 3.483, Global test accuracy: 20.40 

Round  18, Train loss: 0.099, Test loss: 1.565, Test accuracy: 66.70 

Round  18, Global train loss: 0.099, Global test loss: 3.155, Global test accuracy: 20.30 

Round  19, Train loss: 0.076, Test loss: 2.007, Test accuracy: 64.20 

Round  19, Global train loss: 0.076, Global test loss: 3.249, Global test accuracy: 20.80 

Round  20, Train loss: 0.074, Test loss: 1.604, Test accuracy: 69.10 

Round  20, Global train loss: 0.074, Global test loss: 3.314, Global test accuracy: 20.40 

Round  21, Train loss: 0.061, Test loss: 1.765, Test accuracy: 67.90 

Round  21, Global train loss: 0.061, Global test loss: 3.659, Global test accuracy: 20.40 

Round  22, Train loss: 0.082, Test loss: 1.688, Test accuracy: 68.40 

Round  22, Global train loss: 0.082, Global test loss: 4.054, Global test accuracy: 20.30 

Round  23, Train loss: 0.069, Test loss: 1.683, Test accuracy: 70.90 

Round  23, Global train loss: 0.069, Global test loss: 3.646, Global test accuracy: 20.30 

Round  24, Train loss: 0.057, Test loss: 1.683, Test accuracy: 70.00 

Round  24, Global train loss: 0.057, Global test loss: 3.766, Global test accuracy: 20.30 

Round  25, Train loss: 0.040, Test loss: 1.606, Test accuracy: 71.30 

Round  25, Global train loss: 0.040, Global test loss: 3.719, Global test accuracy: 20.50 

Round  26, Train loss: 0.056, Test loss: 1.651, Test accuracy: 69.50 

Round  26, Global train loss: 0.056, Global test loss: 3.443, Global test accuracy: 20.40 

Round  27, Train loss: 0.027, Test loss: 1.501, Test accuracy: 71.50 

Round  27, Global train loss: 0.027, Global test loss: 3.937, Global test accuracy: 20.40 

Round  28, Train loss: 0.018, Test loss: 1.689, Test accuracy: 69.10 

Round  28, Global train loss: 0.018, Global test loss: 4.098, Global test accuracy: 20.60 

Round  29, Train loss: 0.033, Test loss: 1.688, Test accuracy: 70.90 

Round  29, Global train loss: 0.033, Global test loss: 4.271, Global test accuracy: 20.10 

Round  30, Train loss: 0.016, Test loss: 1.657, Test accuracy: 72.10 

Round  30, Global train loss: 0.016, Global test loss: 3.965, Global test accuracy: 20.40 

Round  31, Train loss: 0.038, Test loss: 1.709, Test accuracy: 69.30 

Round  31, Global train loss: 0.038, Global test loss: 4.378, Global test accuracy: 20.30 

Round  32, Train loss: 0.023, Test loss: 1.870, Test accuracy: 68.10 

Round  32, Global train loss: 0.023, Global test loss: 4.544, Global test accuracy: 20.00 

Round  33, Train loss: 0.027, Test loss: 1.681, Test accuracy: 71.50 

Round  33, Global train loss: 0.027, Global test loss: 4.416, Global test accuracy: 20.00 

Round  34, Train loss: 0.023, Test loss: 2.020, Test accuracy: 68.80 

Round  34, Global train loss: 0.023, Global test loss: 4.179, Global test accuracy: 20.20 

Final Round, Train loss: 0.037, Test loss: 1.749, Test accuracy: 69.20 

Final Round, Global train loss: 0.037, Global test loss: 4.179, Global test accuracy: 20.20 

Average accuracy final 10 rounds: 70.21000000000001 

Average global accuracy final 10 rounds: 20.29 

591.468857049942
[13.213895082473755, 19.712193250656128, 26.32083010673523, 32.86696481704712, 39.52303647994995, 46.152385234832764, 52.94987344741821, 60.116448640823364, 66.51773309707642, 73.10953140258789, 79.9734160900116, 86.64062356948853, 93.3700840473175, 100.31898188591003, 107.19946455955505, 113.88579630851746, 120.46698451042175, 127.4633207321167, 134.27042269706726, 140.99676299095154, 147.92663717269897, 154.65110540390015, 161.47517275810242, 168.15333008766174, 175.08679056167603, 181.812020778656, 188.58805060386658, 195.46497654914856, 202.36719465255737, 209.1462972164154, 216.0063316822052, 222.7689507007599, 229.72365546226501, 236.1917953491211, 243.0905601978302, 256.4581117630005]
[54.5, 53.4, 56.3, 60.9, 61.8, 57.8, 64.0, 67.8, 62.1, 65.9, 65.9, 66.2, 69.5, 69.3, 68.4, 71.0, 68.5, 70.5, 66.7, 64.2, 69.1, 67.9, 68.4, 70.9, 70.0, 71.3, 69.5, 71.5, 69.1, 70.9, 72.1, 69.3, 68.1, 71.5, 68.8, 69.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.451, Test loss: 1.165, Test accuracy: 51.50 

Round   0, Global train loss: 1.451, Global test loss: 1.756, Global test accuracy: 27.80 

Round   1, Train loss: 1.242, Test loss: 1.104, Test accuracy: 58.00 

Round   1, Global train loss: 1.242, Global test loss: 1.462, Global test accuracy: 40.80 

Round   2, Train loss: 1.085, Test loss: 1.204, Test accuracy: 56.70 

Round   2, Global train loss: 1.085, Global test loss: 1.361, Global test accuracy: 47.40 

Round   3, Train loss: 1.003, Test loss: 1.103, Test accuracy: 58.60 

Round   3, Global train loss: 1.003, Global test loss: 1.312, Global test accuracy: 47.60 

Round   4, Train loss: 0.901, Test loss: 1.209, Test accuracy: 59.80 

Round   4, Global train loss: 0.901, Global test loss: 1.376, Global test accuracy: 47.20 

Round   5, Train loss: 0.821, Test loss: 0.991, Test accuracy: 65.90 

Round   5, Global train loss: 0.821, Global test loss: 1.388, Global test accuracy: 50.20 

Round   6, Train loss: 0.713, Test loss: 1.277, Test accuracy: 60.10 

Round   6, Global train loss: 0.713, Global test loss: 1.398, Global test accuracy: 48.60 

Round   7, Train loss: 0.663, Test loss: 1.178, Test accuracy: 65.30 

Round   7, Global train loss: 0.663, Global test loss: 1.291, Global test accuracy: 52.20 

Round   8, Train loss: 0.594, Test loss: 1.068, Test accuracy: 66.20 

Round   8, Global train loss: 0.594, Global test loss: 1.642, Global test accuracy: 47.80 

Round   9, Train loss: 0.527, Test loss: 1.478, Test accuracy: 59.90 

Round   9, Global train loss: 0.527, Global test loss: 1.709, Global test accuracy: 49.40 

Round  10, Train loss: 0.499, Test loss: 1.484, Test accuracy: 61.80 

Round  10, Global train loss: 0.499, Global test loss: 1.651, Global test accuracy: 49.10 

Round  11, Train loss: 0.406, Test loss: 1.394, Test accuracy: 62.20 

Round  11, Global train loss: 0.406, Global test loss: 2.011, Global test accuracy: 49.10 

Round  12, Train loss: 0.374, Test loss: 1.289, Test accuracy: 66.60 

Round  12, Global train loss: 0.374, Global test loss: 1.670, Global test accuracy: 51.80 

Round  13, Train loss: 0.364, Test loss: 1.140, Test accuracy: 67.30 

Round  13, Global train loss: 0.364, Global test loss: 1.818, Global test accuracy: 51.60 

Round  14, Train loss: 0.304, Test loss: 1.329, Test accuracy: 64.10 

Round  14, Global train loss: 0.304, Global test loss: 1.803, Global test accuracy: 50.30 

Round  15, Train loss: 0.278, Test loss: 1.347, Test accuracy: 66.80 

Round  15, Global train loss: 0.278, Global test loss: 1.825, Global test accuracy: 52.70 

Round  16, Train loss: 0.219, Test loss: 1.353, Test accuracy: 66.20 

Round  16, Global train loss: 0.219, Global test loss: 1.747, Global test accuracy: 53.10 

Round  17, Train loss: 0.266, Test loss: 1.926, Test accuracy: 61.90 

Round  17, Global train loss: 0.266, Global test loss: 2.122, Global test accuracy: 50.90 

Round  18, Train loss: 0.218, Test loss: 1.336, Test accuracy: 68.40 

Round  18, Global train loss: 0.218, Global test loss: 1.741, Global test accuracy: 55.60 

Round  19, Train loss: 0.155, Test loss: 1.524, Test accuracy: 67.30 

Round  19, Global train loss: 0.155, Global test loss: 2.009, Global test accuracy: 54.00 

Round  20, Train loss: 0.157, Test loss: 1.609, Test accuracy: 68.00 

Round  20, Global train loss: 0.157, Global test loss: 2.117, Global test accuracy: 53.60 

Round  21, Train loss: 0.156, Test loss: 1.483, Test accuracy: 68.00 

Round  21, Global train loss: 0.156, Global test loss: 2.082, Global test accuracy: 56.40 

Round  22, Train loss: 0.119, Test loss: 1.524, Test accuracy: 66.30 

Round  22, Global train loss: 0.119, Global test loss: 2.174, Global test accuracy: 54.00 

Round  23, Train loss: 0.176, Test loss: 1.372, Test accuracy: 69.10 

Round  23, Global train loss: 0.176, Global test loss: 2.032, Global test accuracy: 53.60 

Round  24, Train loss: 0.102, Test loss: 1.755, Test accuracy: 67.10 

Round  24, Global train loss: 0.102, Global test loss: 2.189, Global test accuracy: 55.00 

Round  25, Train loss: 0.079, Test loss: 1.626, Test accuracy: 67.10 

Round  25, Global train loss: 0.079, Global test loss: 2.163, Global test accuracy: 55.30 

Round  26, Train loss: 0.107, Test loss: 1.672, Test accuracy: 66.90 

Round  26, Global train loss: 0.107, Global test loss: 2.157, Global test accuracy: 54.90 

Round  27, Train loss: 0.094, Test loss: 1.523, Test accuracy: 69.90 

Round  27, Global train loss: 0.094, Global test loss: 2.263, Global test accuracy: 57.70 

Round  28, Train loss: 0.126, Test loss: 1.683, Test accuracy: 67.70 

Round  28, Global train loss: 0.126, Global test loss: 2.416, Global test accuracy: 52.40 

Round  29, Train loss: 0.087, Test loss: 1.375, Test accuracy: 70.40 

Round  29, Global train loss: 0.087, Global test loss: 2.033, Global test accuracy: 55.80 

Round  30, Train loss: 0.056, Test loss: 1.569, Test accuracy: 67.60 

Round  30, Global train loss: 0.056, Global test loss: 2.046, Global test accuracy: 56.40 

Round  31, Train loss: 0.055, Test loss: 1.663, Test accuracy: 69.20 

Round  31, Global train loss: 0.055, Global test loss: 2.203, Global test accuracy: 57.50 

Round  32, Train loss: 0.050, Test loss: 1.582, Test accuracy: 68.80 

Round  32, Global train loss: 0.050, Global test loss: 2.284, Global test accuracy: 55.20 

Round  33, Train loss: 0.063, Test loss: 1.710, Test accuracy: 67.10 

Round  33, Global train loss: 0.063, Global test loss: 2.430, Global test accuracy: 53.90 

Round  34, Train loss: 0.072, Test loss: 1.465, Test accuracy: 70.70 

Round  34, Global train loss: 0.072, Global test loss: 2.227, Global test accuracy: 53.40 

Final Round, Train loss: 0.044, Test loss: 1.554, Test accuracy: 71.80 

Final Round, Global train loss: 0.044, Global test loss: 2.227, Global test accuracy: 53.40 

Average accuracy final 10 rounds: 68.54 

Average global accuracy final 10 rounds: 55.25 

590.5558161735535
[12.337636470794678, 19.097439527511597, 25.849406242370605, 32.43816137313843, 39.200419425964355, 45.80290746688843, 52.62715244293213, 59.347509145736694, 66.14643907546997, 73.04972004890442, 79.96768140792847, 86.50003910064697, 93.32806730270386, 99.86012268066406, 106.31174993515015, 113.07702493667603, 119.61366748809814, 126.13792991638184, 133.0386164188385, 139.72097635269165, 146.4507064819336, 152.9545841217041, 159.49941754341125, 166.48404669761658, 173.42480564117432, 180.13455605506897, 186.92400288581848, 193.69216537475586, 200.5200493335724, 207.19138741493225, 213.82231259346008, 220.48443245887756, 227.42748594284058, 234.05101871490479, 241.00254034996033, 254.76393961906433]
[51.5, 58.0, 56.7, 58.6, 59.8, 65.9, 60.1, 65.3, 66.2, 59.9, 61.8, 62.2, 66.6, 67.3, 64.1, 66.8, 66.2, 61.9, 68.4, 67.3, 68.0, 68.0, 66.3, 69.1, 67.1, 67.1, 66.9, 69.9, 67.7, 70.4, 67.6, 69.2, 68.8, 67.1, 70.7, 71.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.518, Test loss: 1.735, Test accuracy: 25.30 

Round   1, Train loss: 1.299, Test loss: 1.210, Test accuracy: 49.40 

Round   2, Train loss: 1.164, Test loss: 1.163, Test accuracy: 48.00 

Round   3, Train loss: 1.056, Test loss: 1.030, Test accuracy: 57.70 

Round   4, Train loss: 0.948, Test loss: 0.929, Test accuracy: 61.50 

Round   5, Train loss: 0.880, Test loss: 1.011, Test accuracy: 59.10 

Round   6, Train loss: 0.811, Test loss: 0.917, Test accuracy: 64.40 

Round   7, Train loss: 0.753, Test loss: 0.906, Test accuracy: 65.50 

Round   8, Train loss: 0.692, Test loss: 0.908, Test accuracy: 66.40 

Round   9, Train loss: 0.642, Test loss: 0.921, Test accuracy: 66.50 

Round  10, Train loss: 0.611, Test loss: 0.908, Test accuracy: 67.00 

Round  11, Train loss: 0.554, Test loss: 0.969, Test accuracy: 65.70 

Round  12, Train loss: 0.480, Test loss: 0.922, Test accuracy: 67.10 

Round  13, Train loss: 0.458, Test loss: 0.881, Test accuracy: 69.50 

Round  14, Train loss: 0.439, Test loss: 0.915, Test accuracy: 69.80 

Round  15, Train loss: 0.369, Test loss: 0.976, Test accuracy: 67.30 

Round  16, Train loss: 0.333, Test loss: 1.046, Test accuracy: 67.40 

Round  17, Train loss: 0.324, Test loss: 1.002, Test accuracy: 70.70 

Round  18, Train loss: 0.292, Test loss: 0.993, Test accuracy: 68.20 

Round  19, Train loss: 0.274, Test loss: 1.054, Test accuracy: 67.60 

Round  20, Train loss: 0.239, Test loss: 1.108, Test accuracy: 66.30 

Round  21, Train loss: 0.216, Test loss: 1.095, Test accuracy: 67.20 

Round  22, Train loss: 0.190, Test loss: 1.140, Test accuracy: 67.70 

Round  23, Train loss: 0.182, Test loss: 1.073, Test accuracy: 70.30 

Round  24, Train loss: 0.156, Test loss: 1.109, Test accuracy: 70.80 

Round  25, Train loss: 0.157, Test loss: 1.284, Test accuracy: 68.30 

Round  26, Train loss: 0.140, Test loss: 1.106, Test accuracy: 70.40 

Round  27, Train loss: 0.152, Test loss: 1.143, Test accuracy: 69.80 

Round  28, Train loss: 0.135, Test loss: 1.083, Test accuracy: 72.00 

Round  29, Train loss: 0.123, Test loss: 1.099, Test accuracy: 70.30 

Round  30, Train loss: 0.106, Test loss: 1.164, Test accuracy: 69.00 

Round  31, Train loss: 0.116, Test loss: 1.143, Test accuracy: 70.90 

Round  32, Train loss: 0.088, Test loss: 1.163, Test accuracy: 71.40 

Round  33, Train loss: 0.057, Test loss: 1.080, Test accuracy: 72.40 

Round  34, Train loss: 0.057, Test loss: 1.123, Test accuracy: 72.30 

Round  35, Train loss: 0.069, Test loss: 1.231, Test accuracy: 70.10 

Round  36, Train loss: 0.083, Test loss: 1.171, Test accuracy: 70.60 

Round  37, Train loss: 0.057, Test loss: 1.178, Test accuracy: 71.60 

Round  38, Train loss: 0.063, Test loss: 1.169, Test accuracy: 72.10 

Round  39, Train loss: 0.065, Test loss: 1.117, Test accuracy: 73.50 

Final Round, Train loss: 0.037, Test loss: 1.140, Test accuracy: 73.60 

Average accuracy final 10 rounds: 71.38999999999999 

479.55547070503235
[10.981539487838745, 16.210487842559814, 21.233028650283813, 26.33411741256714, 31.82084822654724, 36.94462537765503, 42.0650429725647, 47.40141558647156, 52.6493866443634, 57.950236558914185, 63.0109384059906, 68.23814225196838, 73.52744007110596, 78.75173377990723, 84.3070387840271, 89.44637942314148, 94.59910011291504, 99.84532904624939, 105.06002044677734, 110.2304790019989, 115.50188517570496, 120.71518564224243, 125.74268078804016, 130.93136072158813, 136.319993019104, 141.51404285430908, 146.61913108825684, 151.9515860080719, 156.81979060173035, 162.1856849193573, 167.41247129440308, 173.01990342140198, 178.25191187858582, 183.60747051239014, 188.86616921424866, 194.0179922580719, 199.21926259994507, 204.37780117988586, 209.3859691619873, 214.44924235343933, 220.04881644248962]
[25.3, 49.4, 48.0, 57.7, 61.5, 59.1, 64.4, 65.5, 66.4, 66.5, 67.0, 65.7, 67.1, 69.5, 69.8, 67.3, 67.4, 70.7, 68.2, 67.6, 66.3, 67.2, 67.7, 70.3, 70.8, 68.3, 70.4, 69.8, 72.0, 70.3, 69.0, 70.9, 71.4, 72.4, 72.3, 70.1, 70.6, 71.6, 72.1, 73.5, 73.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.563, Test loss: 1.522, Test accuracy: 33.80
Round   1, Train loss: 1.328, Test loss: 1.321, Test accuracy: 44.00
Round   2, Train loss: 1.160, Test loss: 1.089, Test accuracy: 55.60
Round   3, Train loss: 1.077, Test loss: 1.149, Test accuracy: 53.30
Round   4, Train loss: 0.985, Test loss: 1.001, Test accuracy: 59.10
Round   5, Train loss: 0.906, Test loss: 0.922, Test accuracy: 63.20
Round   6, Train loss: 0.832, Test loss: 0.936, Test accuracy: 63.40
Round   7, Train loss: 0.788, Test loss: 0.842, Test accuracy: 68.50
Round   8, Train loss: 0.705, Test loss: 0.933, Test accuracy: 64.40
Round   9, Train loss: 0.656, Test loss: 0.834, Test accuracy: 70.10
Round  10, Train loss: 0.578, Test loss: 0.875, Test accuracy: 68.70
Round  11, Train loss: 0.546, Test loss: 0.897, Test accuracy: 69.10
Round  12, Train loss: 0.489, Test loss: 0.931, Test accuracy: 66.80
Round  13, Train loss: 0.468, Test loss: 0.952, Test accuracy: 66.20
Round  14, Train loss: 0.441, Test loss: 0.923, Test accuracy: 68.30
Round  15, Train loss: 0.393, Test loss: 0.876, Test accuracy: 69.70
Round  16, Train loss: 0.357, Test loss: 0.875, Test accuracy: 70.50
Round  17, Train loss: 0.321, Test loss: 0.927, Test accuracy: 70.00
Round  18, Train loss: 0.298, Test loss: 0.966, Test accuracy: 70.40
Round  19, Train loss: 0.271, Test loss: 0.984, Test accuracy: 67.80
Round  20, Train loss: 0.256, Test loss: 0.991, Test accuracy: 70.60
Round  21, Train loss: 0.235, Test loss: 0.992, Test accuracy: 70.40
Round  22, Train loss: 0.214, Test loss: 0.995, Test accuracy: 70.80
Round  23, Train loss: 0.172, Test loss: 1.162, Test accuracy: 68.40
Round  24, Train loss: 0.145, Test loss: 1.062, Test accuracy: 72.00
Round  25, Train loss: 0.168, Test loss: 1.096, Test accuracy: 69.60
Round  26, Train loss: 0.152, Test loss: 1.121, Test accuracy: 70.60
Round  27, Train loss: 0.129, Test loss: 1.099, Test accuracy: 69.50
Round  28, Train loss: 0.149, Test loss: 1.070, Test accuracy: 71.50
Round  29, Train loss: 0.097, Test loss: 1.182, Test accuracy: 71.50
Round  30, Train loss: 0.104, Test loss: 1.234, Test accuracy: 70.10
Round  31, Train loss: 0.096, Test loss: 1.145, Test accuracy: 71.00
Round  32, Train loss: 0.074, Test loss: 1.192, Test accuracy: 71.70
Round  33, Train loss: 0.074, Test loss: 1.186, Test accuracy: 71.30
Round  34, Train loss: 0.078, Test loss: 1.187, Test accuracy: 70.60
Round  35, Train loss: 0.083, Test loss: 1.175, Test accuracy: 71.70
Round  36, Train loss: 0.071, Test loss: 1.190, Test accuracy: 71.30
Round  37, Train loss: 0.061, Test loss: 1.174, Test accuracy: 72.10
Round  38, Train loss: 0.057, Test loss: 1.133, Test accuracy: 72.70
Round  39, Train loss: 0.036, Test loss: 1.205, Test accuracy: 71.90
Final Round, Train loss: 0.025, Test loss: 1.224, Test accuracy: 72.50
Average accuracy final 10 rounds: 71.44
562.7712943553925
[12.060453414916992, 18.07397222518921, 24.544405221939087, 30.82674264907837, 36.89687514305115, 43.15607786178589, 49.503581047058105, 55.78527235984802, 62.18640398979187, 68.84702324867249, 75.23777890205383, 81.34085369110107, 87.50038003921509, 93.66667675971985, 99.82866907119751, 106.07988357543945, 112.33084487915039, 118.5421724319458, 124.91203236579895, 131.0724503993988, 137.5520157814026, 143.69581127166748, 150.06712293624878, 156.1286358833313, 162.35764026641846, 168.558452129364, 174.77888083457947, 180.92716240882874, 187.1526002883911, 193.33011102676392, 199.4205424785614, 205.55718183517456, 211.8656404018402, 218.11209797859192, 224.28012704849243, 230.4646692276001, 237.03790187835693, 243.255943775177, 249.2772135734558, 255.35794925689697, 261.61850929260254]
[33.8, 44.0, 55.6, 53.3, 59.1, 63.2, 63.4, 68.5, 64.4, 70.1, 68.7, 69.1, 66.8, 66.2, 68.3, 69.7, 70.5, 70.0, 70.4, 67.8, 70.6, 70.4, 70.8, 68.4, 72.0, 69.6, 70.6, 69.5, 71.5, 71.5, 70.1, 71.0, 71.7, 71.3, 70.6, 71.7, 71.3, 72.1, 72.7, 71.9, 72.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.818, Train accuracy: 61.800, Test loss: 1.024, Test accuracy: 55.40 

        train local model (freeze embeding):client   0,  Train loss: 0.772, Train accuracy: 67.800, Test loss: 1.003, Test accuracy: 58.40 

        train local model (unfreeze embeding):client   0,  Train loss: 1.264, Train accuracy: 59.600, Test loss: 1.742, Test accuracy: 53.60 

Round   0, Train loss: 1.264, Test loss: 1.742, Test accuracy: 53.60 

        train local model (freeze embeding):client   0,  Train loss: 0.668, Train accuracy: 71.400, Test loss: 1.048, Test accuracy: 58.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.574, Train accuracy: 75.400, Test loss: 1.057, Test accuracy: 60.80 

Round   1, Train loss: 0.574, Test loss: 1.057, Test accuracy: 60.80 

        train local model (freeze embeding):client   0,  Train loss: 0.505, Train accuracy: 78.000, Test loss: 1.023, Test accuracy: 63.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.618, Train accuracy: 76.200, Test loss: 1.162, Test accuracy: 60.00 

Round   2, Train loss: 0.618, Test loss: 1.162, Test accuracy: 60.00 

        train local model (freeze embeding):client   0,  Train loss: 0.444, Train accuracy: 83.400, Test loss: 0.987, Test accuracy: 64.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.512, Train accuracy: 81.600, Test loss: 1.337, Test accuracy: 61.80 

Round   3, Train loss: 0.512, Test loss: 1.337, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.298, Train accuracy: 88.600, Test loss: 1.097, Test accuracy: 66.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.286, Train accuracy: 90.600, Test loss: 1.173, Test accuracy: 61.80 

Round   4, Train loss: 0.286, Test loss: 1.173, Test accuracy: 61.80 

        train local model (freeze embeding):client   0,  Train loss: 0.244, Train accuracy: 92.400, Test loss: 1.148, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.227, Train accuracy: 90.200, Test loss: 1.351, Test accuracy: 62.00 

Round   5, Train loss: 0.227, Test loss: 1.351, Test accuracy: 62.00 

        train local model (freeze embeding):client   0,  Train loss: 0.153, Train accuracy: 95.400, Test loss: 1.241, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.168, Train accuracy: 95.600, Test loss: 1.418, Test accuracy: 67.80 

Round   6, Train loss: 0.168, Test loss: 1.418, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.094, Train accuracy: 97.400, Test loss: 1.312, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.108, Train accuracy: 96.200, Test loss: 1.429, Test accuracy: 66.60 

Round   7, Train loss: 0.108, Test loss: 1.429, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.051, Train accuracy: 99.000, Test loss: 1.508, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.070, Train accuracy: 98.000, Test loss: 1.656, Test accuracy: 63.80 

Round   8, Train loss: 0.070, Test loss: 1.656, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.069, Train accuracy: 97.800, Test loss: 1.642, Test accuracy: 66.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.081, Train accuracy: 97.600, Test loss: 1.493, Test accuracy: 67.80 

Round   9, Train loss: 0.081, Test loss: 1.493, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 1.451, Test accuracy: 67.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.046, Train accuracy: 98.400, Test loss: 1.855, Test accuracy: 66.60 

Round  10, Train loss: 0.046, Test loss: 1.855, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.714, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.048, Train accuracy: 97.600, Test loss: 1.747, Test accuracy: 63.80 

Round  11, Train loss: 0.048, Test loss: 1.747, Test accuracy: 63.80 

        train local model (freeze embeding):client   0,  Train loss: 0.040, Train accuracy: 98.800, Test loss: 1.705, Test accuracy: 66.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.800, Test loss: 1.789, Test accuracy: 66.20 

Round  12, Train loss: 0.020, Test loss: 1.789, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.200, Test loss: 1.800, Test accuracy: 65.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.400, Test loss: 1.810, Test accuracy: 66.80 

Round  13, Train loss: 0.018, Test loss: 1.810, Test accuracy: 66.80 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.600, Test loss: 1.832, Test accuracy: 66.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.691, Test accuracy: 67.40 

Round  14, Train loss: 0.038, Test loss: 1.691, Test accuracy: 67.40 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.600, Test loss: 1.628, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.790, Test accuracy: 70.60 

Round  15, Train loss: 0.007, Test loss: 1.790, Test accuracy: 70.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.717, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.096, Train accuracy: 97.000, Test loss: 2.292, Test accuracy: 66.60 

Round  16, Train loss: 0.096, Test loss: 2.292, Test accuracy: 66.60 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.888, Test accuracy: 68.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.903, Test accuracy: 68.00 

Round  17, Train loss: 0.006, Test loss: 1.903, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.800, Test loss: 1.803, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.200, Test loss: 1.923, Test accuracy: 69.20 

Round  18, Train loss: 0.042, Test loss: 1.923, Test accuracy: 69.20 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.200, Test loss: 1.862, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.960, Test accuracy: 68.80 

Round  19, Train loss: 0.012, Test loss: 1.960, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.826, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.802, Test accuracy: 69.80 

Final Round, Train loss: 0.005, Test loss: 1.843, Test accuracy: 69.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.875, Train accuracy: 64.600, Test loss: 1.003, Test accuracy: 61.40 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.854, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.605, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.888, Train accuracy: 66.000, Test loss: 1.078, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.342, Train accuracy: 87.600, Test loss: 1.031, Test accuracy: 68.00 

Round   0, Train loss: 0.176, Test loss: 1.211, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.430, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.946, Test accuracy: 66.80 

        train local model (freeze embeding):client   1,  Train loss: 0.414, Train accuracy: 85.800, Test loss: 0.969, Test accuracy: 67.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.241, Train accuracy: 92.000, Test loss: 1.199, Test accuracy: 69.60 

Round   1, Train loss: 0.134, Test loss: 1.301, Test accuracy: 70.90 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.613, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 2.087, Test accuracy: 65.40 

        train local model (freeze embeding):client   1,  Train loss: 0.195, Train accuracy: 94.400, Test loss: 1.062, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.137, Train accuracy: 95.800, Test loss: 1.267, Test accuracy: 68.20 

Round   2, Train loss: 0.074, Test loss: 1.377, Test accuracy: 69.40 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.573, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 1.898, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.099, Train accuracy: 97.600, Test loss: 1.105, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.114, Train accuracy: 96.000, Test loss: 1.132, Test accuracy: 69.40 

Round   3, Train loss: 0.079, Test loss: 1.281, Test accuracy: 70.30 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.400, Test loss: 1.483, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 2.004, Test accuracy: 68.00 

        train local model (freeze embeding):client   1,  Train loss: 0.063, Train accuracy: 98.600, Test loss: 1.142, Test accuracy: 69.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.156, Train accuracy: 94.000, Test loss: 1.579, Test accuracy: 69.60 

Round   4, Train loss: 0.083, Test loss: 1.465, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.653, Test accuracy: 68.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.971, Test accuracy: 70.20 

        train local model (freeze embeding):client   1,  Train loss: 0.048, Train accuracy: 99.200, Test loss: 1.124, Test accuracy: 69.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.083, Train accuracy: 97.000, Test loss: 1.178, Test accuracy: 71.60 

Round   5, Train loss: 0.042, Test loss: 1.407, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.593, Test accuracy: 67.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.914, Test accuracy: 71.20 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 99.600, Test loss: 1.222, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.066, Train accuracy: 97.800, Test loss: 1.320, Test accuracy: 71.00 

Round   6, Train loss: 0.036, Test loss: 1.401, Test accuracy: 71.10 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.600, Test loss: 1.592, Test accuracy: 71.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.600, Test loss: 1.648, Test accuracy: 67.00 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.800, Test loss: 1.243, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.115, Train accuracy: 95.800, Test loss: 1.594, Test accuracy: 70.60 

Round   7, Train loss: 0.067, Test loss: 1.432, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.200, Test loss: 1.586, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.854, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.600, Test loss: 1.194, Test accuracy: 68.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.144, Train accuracy: 95.400, Test loss: 1.987, Test accuracy: 66.80 

Round   8, Train loss: 0.077, Test loss: 1.567, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.800, Test loss: 1.650, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.200, Test loss: 1.984, Test accuracy: 67.80 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.340, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.800, Test loss: 1.173, Test accuracy: 74.00 

Round   9, Train loss: 0.015, Test loss: 1.397, Test accuracy: 70.90 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.400, Test loss: 1.558, Test accuracy: 70.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.400, Test loss: 2.251, Test accuracy: 63.40 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.313, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.024, Train accuracy: 99.400, Test loss: 1.473, Test accuracy: 71.60 

Round  10, Train loss: 0.034, Test loss: 1.697, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.723, Test accuracy: 69.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.877, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.371, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.292, Test accuracy: 74.20 

Round  11, Train loss: 0.009, Test loss: 1.361, Test accuracy: 73.10 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.503, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.006, Test accuracy: 67.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.358, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 98.600, Test loss: 1.686, Test accuracy: 70.80 

Round  12, Train loss: 0.018, Test loss: 1.626, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.655, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.600, Test loss: 1.669, Test accuracy: 69.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.426, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 1.759, Test accuracy: 69.80 

Round  13, Train loss: 0.026, Test loss: 1.415, Test accuracy: 70.40 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.625, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.318, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.462, Test accuracy: 71.40 

Round  14, Train loss: 0.021, Test loss: 1.356, Test accuracy: 71.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.541, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 99.800, Test loss: 1.668, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.273, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.552, Test accuracy: 73.40 

Round  15, Train loss: 0.006, Test loss: 1.417, Test accuracy: 72.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.519, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 2.011, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.366, Test accuracy: 73.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.567, Test accuracy: 71.00 

Round  16, Train loss: 0.003, Test loss: 1.652, Test accuracy: 71.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.768, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.860, Test accuracy: 69.80 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.442, Test accuracy: 74.20 

Round  17, Train loss: 0.002, Test loss: 1.571, Test accuracy: 71.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.686, Test accuracy: 70.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.047, Test accuracy: 68.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.416, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.529, Test accuracy: 73.60 

Round  18, Train loss: 0.003, Test loss: 1.612, Test accuracy: 72.10 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.777, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.200, Test loss: 1.916, Test accuracy: 68.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.455, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.445, Test accuracy: 74.40 

Round  19, Train loss: 0.007, Test loss: 1.631, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.832, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.931, Test accuracy: 69.20 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.363, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.456, Test accuracy: 74.20 

Final Round, Train loss: 0.002, Test loss: 1.602, Test accuracy: 72.00 

Average accuracy final 10 rounds: 138.53 

1241.599219083786
[19.05531930923462, 37.946035623550415, 56.27341604232788, 74.38218593597412, 93.23967289924622, 111.74430584907532, 130.74297976493835, 149.08465242385864, 168.12200713157654, 187.90373420715332, 206.71097445487976, 225.96447324752808, 244.19545769691467, 263.2245364189148, 281.91079902648926, 300.90339970588684, 319.9039075374603, 338.56507086753845, 357.23417115211487, 376.26850962638855, 386.9351589679718, 405.6428978443146, 424.5708451271057, 443.2325346469879, 461.7889368534088, 480.4733679294586, 499.6578793525696, 518.3296105861664, 537.3692252635956, 556.5327427387238, 575.4369351863861, 594.1141679286957, 612.9309384822845, 632.6023178100586, 652.2633187770844, 670.7771368026733, 690.0040469169617, 708.4662184715271, 727.1692388057709, 745.9337966442108, 764.7918508052826, 775.7180902957916]
[53.6, 60.8, 60.0, 61.8, 61.8, 62.0, 67.8, 66.6, 63.8, 67.8, 66.6, 63.8, 66.2, 66.8, 67.4, 70.6, 66.6, 68.0, 69.2, 68.8, 69.0, 68.8, 70.9, 69.4, 70.3, 70.4, 69.5, 71.1, 69.5, 70.0, 70.9, 67.8, 73.1, 68.6, 70.4, 71.4, 72.4, 71.7, 71.8, 72.1, 72.0, 72.0]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.399, Test loss: 1.568, Test accuracy: 43.70 

Round   0, Global train loss: 1.399, Global test loss: 1.776, Global test accuracy: 27.50 

Round   1, Train loss: 1.135, Test loss: 1.238, Test accuracy: 52.80 

Round   1, Global train loss: 1.135, Global test loss: 1.881, Global test accuracy: 27.40 

Round   2, Train loss: 0.961, Test loss: 1.241, Test accuracy: 56.70 

Round   2, Global train loss: 0.961, Global test loss: 1.873, Global test accuracy: 26.90 

Round   3, Train loss: 0.833, Test loss: 1.289, Test accuracy: 54.90 

Round   3, Global train loss: 0.833, Global test loss: 2.001, Global test accuracy: 27.40 

Round   4, Train loss: 0.703, Test loss: 1.234, Test accuracy: 62.80 

Round   4, Global train loss: 0.703, Global test loss: 2.171, Global test accuracy: 26.40 

Round   5, Train loss: 0.609, Test loss: 1.231, Test accuracy: 66.30 

Round   5, Global train loss: 0.609, Global test loss: 2.618, Global test accuracy: 22.40 

Round   6, Train loss: 0.516, Test loss: 1.493, Test accuracy: 60.50 

Round   6, Global train loss: 0.516, Global test loss: 2.492, Global test accuracy: 26.40 

Round   7, Train loss: 0.433, Test loss: 1.874, Test accuracy: 57.90 

Round   7, Global train loss: 0.433, Global test loss: 2.579, Global test accuracy: 21.30 

Round   8, Train loss: 0.343, Test loss: 1.777, Test accuracy: 61.00 

Round   8, Global train loss: 0.343, Global test loss: 3.247, Global test accuracy: 21.20 

Round   9, Train loss: 0.315, Test loss: 1.457, Test accuracy: 66.00 

Round   9, Global train loss: 0.315, Global test loss: 2.762, Global test accuracy: 24.70 

Round  10, Train loss: 0.297, Test loss: 1.578, Test accuracy: 63.80 

Round  10, Global train loss: 0.297, Global test loss: 2.908, Global test accuracy: 22.70 

Round  11, Train loss: 0.211, Test loss: 1.624, Test accuracy: 65.20 

Round  11, Global train loss: 0.211, Global test loss: 3.212, Global test accuracy: 20.90 

Round  12, Train loss: 0.202, Test loss: 1.604, Test accuracy: 67.30 

Round  12, Global train loss: 0.202, Global test loss: 3.308, Global test accuracy: 21.10 

Round  13, Train loss: 0.157, Test loss: 1.601, Test accuracy: 67.80 

Round  13, Global train loss: 0.157, Global test loss: 3.688, Global test accuracy: 21.90 

Round  14, Train loss: 0.127, Test loss: 2.081, Test accuracy: 63.60 

Round  14, Global train loss: 0.127, Global test loss: 3.484, Global test accuracy: 24.80 

Round  15, Train loss: 0.134, Test loss: 1.992, Test accuracy: 64.90 

Round  15, Global train loss: 0.134, Global test loss: 3.386, Global test accuracy: 23.20 

Round  16, Train loss: 0.104, Test loss: 1.696, Test accuracy: 68.80 

Round  16, Global train loss: 0.104, Global test loss: 3.395, Global test accuracy: 22.30 

Round  17, Train loss: 0.108, Test loss: 1.738, Test accuracy: 67.80 

Round  17, Global train loss: 0.108, Global test loss: 3.141, Global test accuracy: 25.00 

Round  18, Train loss: 0.085, Test loss: 1.936, Test accuracy: 65.60 

Round  18, Global train loss: 0.085, Global test loss: 3.272, Global test accuracy: 20.90 

Round  19, Train loss: 0.079, Test loss: 1.626, Test accuracy: 69.50 

Round  19, Global train loss: 0.079, Global test loss: 3.085, Global test accuracy: 22.80 

Round  20, Train loss: 0.075, Test loss: 1.818, Test accuracy: 68.90 

Round  20, Global train loss: 0.075, Global test loss: 3.050, Global test accuracy: 24.60 

Round  21, Train loss: 0.081, Test loss: 1.718, Test accuracy: 68.10 

Round  21, Global train loss: 0.081, Global test loss: 3.033, Global test accuracy: 26.90 

Round  22, Train loss: 0.051, Test loss: 1.806, Test accuracy: 69.80 

Round  22, Global train loss: 0.051, Global test loss: 3.194, Global test accuracy: 24.80 

Round  23, Train loss: 0.048, Test loss: 1.831, Test accuracy: 69.10 

Round  23, Global train loss: 0.048, Global test loss: 3.885, Global test accuracy: 20.90 

Round  24, Train loss: 0.036, Test loss: 2.060, Test accuracy: 67.70 

Round  24, Global train loss: 0.036, Global test loss: 2.883, Global test accuracy: 27.00 

Round  25, Train loss: 0.038, Test loss: 1.802, Test accuracy: 69.80 

Round  25, Global train loss: 0.038, Global test loss: 3.971, Global test accuracy: 20.50 

Round  26, Train loss: 0.038, Test loss: 2.101, Test accuracy: 68.30 

Round  26, Global train loss: 0.038, Global test loss: 4.668, Global test accuracy: 20.10 

Round  27, Train loss: 0.042, Test loss: 2.183, Test accuracy: 66.40 

Round  27, Global train loss: 0.042, Global test loss: 3.498, Global test accuracy: 23.30 

Round  28, Train loss: 0.031, Test loss: 1.799, Test accuracy: 71.40 

Round  28, Global train loss: 0.031, Global test loss: 3.547, Global test accuracy: 21.80 

Round  29, Train loss: 0.041, Test loss: 1.898, Test accuracy: 65.90 

Round  29, Global train loss: 0.041, Global test loss: 3.035, Global test accuracy: 26.00 

Round  30, Train loss: 0.045, Test loss: 1.834, Test accuracy: 69.80 

Round  30, Global train loss: 0.045, Global test loss: 3.817, Global test accuracy: 23.10 

Round  31, Train loss: 0.024, Test loss: 1.862, Test accuracy: 71.40 

Round  31, Global train loss: 0.024, Global test loss: 3.295, Global test accuracy: 27.10 

Round  32, Train loss: 0.018, Test loss: 1.825, Test accuracy: 68.80 

Round  32, Global train loss: 0.018, Global test loss: 3.294, Global test accuracy: 23.50 

Round  33, Train loss: 0.018, Test loss: 1.925, Test accuracy: 69.70 

Round  33, Global train loss: 0.018, Global test loss: 3.445, Global test accuracy: 26.30 

Round  34, Train loss: 0.025, Test loss: 1.760, Test accuracy: 71.80 

Round  34, Global train loss: 0.025, Global test loss: 3.577, Global test accuracy: 24.50 

Final Round, Train loss: 0.032, Test loss: 2.024, Test accuracy: 67.60 

Final Round, Global train loss: 0.032, Global test loss: 3.577, Global test accuracy: 24.50 

Average accuracy final 10 rounds: 69.33 

Average global accuracy final 10 rounds: 23.62 

588.4635851383209
[12.604750633239746, 19.264033555984497, 26.114128589630127, 32.598888874053955, 39.279900550842285, 46.13501596450806, 52.72514629364014, 59.18812918663025, 65.99496412277222, 72.73821067810059, 79.68543243408203, 86.38370418548584, 93.15891575813293, 100.08065700531006, 106.93527245521545, 113.91263508796692, 120.55130505561829, 127.25983238220215, 133.68474578857422, 140.65533757209778, 147.6814467906952, 154.37343764305115, 161.12478113174438, 167.7159731388092, 174.479900598526, 180.9985270500183, 187.8991527557373, 194.43806552886963, 201.15575981140137, 208.0462965965271, 214.81589818000793, 221.18794679641724, 228.08089327812195, 234.73066401481628, 241.6225802898407, 255.0497534275055]
[43.7, 52.8, 56.7, 54.9, 62.8, 66.3, 60.5, 57.9, 61.0, 66.0, 63.8, 65.2, 67.3, 67.8, 63.6, 64.9, 68.8, 67.8, 65.6, 69.5, 68.9, 68.1, 69.8, 69.1, 67.7, 69.8, 68.3, 66.4, 71.4, 65.9, 69.8, 71.4, 68.8, 69.7, 71.8, 67.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.400, Test loss: 1.349, Test accuracy: 50.90 

Round   0, Global train loss: 1.400, Global test loss: 1.892, Global test accuracy: 24.40 

Round   1, Train loss: 1.219, Test loss: 1.357, Test accuracy: 49.10 

Round   1, Global train loss: 1.219, Global test loss: 1.350, Global test accuracy: 42.70 

Round   2, Train loss: 1.097, Test loss: 1.204, Test accuracy: 55.50 

Round   2, Global train loss: 1.097, Global test loss: 1.304, Global test accuracy: 45.60 

Round   3, Train loss: 0.964, Test loss: 1.395, Test accuracy: 58.10 

Round   3, Global train loss: 0.964, Global test loss: 1.511, Global test accuracy: 47.20 

Round   4, Train loss: 0.875, Test loss: 1.043, Test accuracy: 63.00 

Round   4, Global train loss: 0.875, Global test loss: 1.354, Global test accuracy: 50.40 

Round   5, Train loss: 0.813, Test loss: 1.143, Test accuracy: 62.30 

Round   5, Global train loss: 0.813, Global test loss: 1.339, Global test accuracy: 53.80 

Round   6, Train loss: 0.731, Test loss: 1.012, Test accuracy: 67.00 

Round   6, Global train loss: 0.731, Global test loss: 1.280, Global test accuracy: 55.90 

Round   7, Train loss: 0.647, Test loss: 1.168, Test accuracy: 60.90 

Round   7, Global train loss: 0.647, Global test loss: 1.466, Global test accuracy: 49.60 

Round   8, Train loss: 0.589, Test loss: 1.481, Test accuracy: 61.90 

Round   8, Global train loss: 0.589, Global test loss: 1.286, Global test accuracy: 56.00 

Round   9, Train loss: 0.527, Test loss: 1.315, Test accuracy: 63.00 

Round   9, Global train loss: 0.527, Global test loss: 1.495, Global test accuracy: 52.60 

Round  10, Train loss: 0.465, Test loss: 1.280, Test accuracy: 65.60 

Round  10, Global train loss: 0.465, Global test loss: 1.469, Global test accuracy: 55.60 

Round  11, Train loss: 0.433, Test loss: 1.193, Test accuracy: 67.70 

Round  11, Global train loss: 0.433, Global test loss: 1.673, Global test accuracy: 54.70 

Round  12, Train loss: 0.385, Test loss: 1.350, Test accuracy: 64.30 

Round  12, Global train loss: 0.385, Global test loss: 1.549, Global test accuracy: 55.70 

Round  13, Train loss: 0.370, Test loss: 1.659, Test accuracy: 63.10 

Round  13, Global train loss: 0.370, Global test loss: 1.570, Global test accuracy: 53.70 

Round  14, Train loss: 0.296, Test loss: 1.433, Test accuracy: 66.40 

Round  14, Global train loss: 0.296, Global test loss: 1.622, Global test accuracy: 55.20 

Round  15, Train loss: 0.290, Test loss: 1.489, Test accuracy: 63.60 

Round  15, Global train loss: 0.290, Global test loss: 1.794, Global test accuracy: 55.10 

Round  16, Train loss: 0.236, Test loss: 1.643, Test accuracy: 64.70 

Round  16, Global train loss: 0.236, Global test loss: 1.906, Global test accuracy: 53.10 

Round  17, Train loss: 0.232, Test loss: 1.572, Test accuracy: 66.40 

Round  17, Global train loss: 0.232, Global test loss: 1.716, Global test accuracy: 55.80 

Round  18, Train loss: 0.202, Test loss: 1.855, Test accuracy: 62.40 

Round  18, Global train loss: 0.202, Global test loss: 1.878, Global test accuracy: 55.00 

Round  19, Train loss: 0.205, Test loss: 1.502, Test accuracy: 67.60 

Round  19, Global train loss: 0.205, Global test loss: 1.794, Global test accuracy: 56.30 

Round  20, Train loss: 0.144, Test loss: 1.693, Test accuracy: 66.10 

Round  20, Global train loss: 0.144, Global test loss: 1.936, Global test accuracy: 57.90 

Round  21, Train loss: 0.142, Test loss: 1.715, Test accuracy: 66.10 

Round  21, Global train loss: 0.142, Global test loss: 2.019, Global test accuracy: 55.40 

Round  22, Train loss: 0.132, Test loss: 1.765, Test accuracy: 66.10 

Round  22, Global train loss: 0.132, Global test loss: 2.090, Global test accuracy: 54.60 

Round  23, Train loss: 0.149, Test loss: 1.821, Test accuracy: 65.40 

Round  23, Global train loss: 0.149, Global test loss: 2.086, Global test accuracy: 56.00 

Round  24, Train loss: 0.108, Test loss: 1.939, Test accuracy: 65.20 

Round  24, Global train loss: 0.108, Global test loss: 2.217, Global test accuracy: 56.80 

Round  25, Train loss: 0.121, Test loss: 1.669, Test accuracy: 67.70 

Round  25, Global train loss: 0.121, Global test loss: 1.863, Global test accuracy: 58.20 

Round  26, Train loss: 0.086, Test loss: 1.614, Test accuracy: 68.30 

Round  26, Global train loss: 0.086, Global test loss: 1.870, Global test accuracy: 58.90 

Round  27, Train loss: 0.100, Test loss: 1.639, Test accuracy: 67.70 

Round  27, Global train loss: 0.100, Global test loss: 1.979, Global test accuracy: 57.10 

Round  28, Train loss: 0.058, Test loss: 1.635, Test accuracy: 70.50 

Round  28, Global train loss: 0.058, Global test loss: 2.038, Global test accuracy: 58.50 

Round  29, Train loss: 0.079, Test loss: 2.139, Test accuracy: 65.80 

Round  29, Global train loss: 0.079, Global test loss: 2.684, Global test accuracy: 54.80 

Round  30, Train loss: 0.043, Test loss: 1.758, Test accuracy: 66.90 

Round  30, Global train loss: 0.043, Global test loss: 2.270, Global test accuracy: 58.30 

Round  31, Train loss: 0.122, Test loss: 2.036, Test accuracy: 66.20 

Round  31, Global train loss: 0.122, Global test loss: 2.272, Global test accuracy: 57.40 

Round  32, Train loss: 0.042, Test loss: 1.662, Test accuracy: 69.40 

Round  32, Global train loss: 0.042, Global test loss: 2.128, Global test accuracy: 59.10 

Round  33, Train loss: 0.031, Test loss: 1.858, Test accuracy: 68.90 

Round  33, Global train loss: 0.031, Global test loss: 2.289, Global test accuracy: 56.40 

Round  34, Train loss: 0.048, Test loss: 1.833, Test accuracy: 67.40 

Round  34, Global train loss: 0.048, Global test loss: 2.291, Global test accuracy: 57.10 

Final Round, Train loss: 0.053, Test loss: 1.781, Test accuracy: 67.60 

Final Round, Global train loss: 0.053, Global test loss: 2.291, Global test accuracy: 57.10 

Average accuracy final 10 rounds: 67.88 

Average global accuracy final 10 rounds: 57.580000000000005 

593.8309030532837
[12.888758420944214, 19.450777530670166, 26.317939281463623, 33.306867837905884, 40.385019063949585, 47.301276206970215, 54.26315140724182, 61.19398641586304, 68.1080994606018, 74.61730146408081, 81.79281044006348, 88.74097013473511, 95.59724164009094, 102.33710217475891, 109.207510471344, 115.86469173431396, 122.66180443763733, 129.47786164283752, 136.23027634620667, 143.14091396331787, 150.03380465507507, 156.64882040023804, 163.46990609169006, 170.12312054634094, 176.97981595993042, 183.7829933166504, 190.48917627334595, 197.2505748271942, 204.14784455299377, 210.9322371482849, 217.94475483894348, 224.55251908302307, 231.38547134399414, 238.28289103507996, 245.03175139427185, 258.31575179100037]
[50.9, 49.1, 55.5, 58.1, 63.0, 62.3, 67.0, 60.9, 61.9, 63.0, 65.6, 67.7, 64.3, 63.1, 66.4, 63.6, 64.7, 66.4, 62.4, 67.6, 66.1, 66.1, 66.1, 65.4, 65.2, 67.7, 68.3, 67.7, 70.5, 65.8, 66.9, 66.2, 69.4, 68.9, 67.4, 67.6]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.532, Test loss: 1.859, Test accuracy: 26.60 

Round   1, Train loss: 1.291, Test loss: 1.256, Test accuracy: 45.60 

Round   2, Train loss: 1.140, Test loss: 1.305, Test accuracy: 48.40 

Round   3, Train loss: 1.055, Test loss: 1.250, Test accuracy: 50.40 

Round   4, Train loss: 0.973, Test loss: 1.081, Test accuracy: 57.70 

Round   5, Train loss: 0.911, Test loss: 1.054, Test accuracy: 59.90 

Round   6, Train loss: 0.843, Test loss: 0.988, Test accuracy: 62.70 

Round   7, Train loss: 0.776, Test loss: 1.134, Test accuracy: 59.80 

Round   8, Train loss: 0.725, Test loss: 1.053, Test accuracy: 61.80 

Round   9, Train loss: 0.646, Test loss: 1.064, Test accuracy: 64.70 

Round  10, Train loss: 0.619, Test loss: 0.928, Test accuracy: 66.90 

Round  11, Train loss: 0.545, Test loss: 0.982, Test accuracy: 65.60 

Round  12, Train loss: 0.526, Test loss: 1.107, Test accuracy: 65.40 

Round  13, Train loss: 0.472, Test loss: 1.036, Test accuracy: 66.30 

Round  14, Train loss: 0.443, Test loss: 1.244, Test accuracy: 64.00 

Round  15, Train loss: 0.399, Test loss: 1.109, Test accuracy: 64.70 

Round  16, Train loss: 0.349, Test loss: 1.143, Test accuracy: 67.70 

Round  17, Train loss: 0.341, Test loss: 1.124, Test accuracy: 67.00 

Round  18, Train loss: 0.313, Test loss: 1.120, Test accuracy: 68.70 

Round  19, Train loss: 0.291, Test loss: 1.026, Test accuracy: 69.00 

Round  20, Train loss: 0.259, Test loss: 1.158, Test accuracy: 67.50 

Round  21, Train loss: 0.241, Test loss: 1.108, Test accuracy: 68.00 

Round  22, Train loss: 0.200, Test loss: 1.257, Test accuracy: 65.80 

Round  23, Train loss: 0.196, Test loss: 1.253, Test accuracy: 67.10 

Round  24, Train loss: 0.172, Test loss: 1.261, Test accuracy: 66.80 

Round  25, Train loss: 0.163, Test loss: 1.213, Test accuracy: 69.00 

Round  26, Train loss: 0.173, Test loss: 1.256, Test accuracy: 66.70 

Round  27, Train loss: 0.147, Test loss: 1.201, Test accuracy: 68.60 

Round  28, Train loss: 0.131, Test loss: 1.205, Test accuracy: 69.50 

Round  29, Train loss: 0.104, Test loss: 1.271, Test accuracy: 68.20 

Round  30, Train loss: 0.119, Test loss: 1.338, Test accuracy: 69.30 

Round  31, Train loss: 0.105, Test loss: 1.252, Test accuracy: 70.00 

Round  32, Train loss: 0.088, Test loss: 1.334, Test accuracy: 70.10 

Round  33, Train loss: 0.079, Test loss: 1.274, Test accuracy: 71.40 

Round  34, Train loss: 0.060, Test loss: 1.387, Test accuracy: 69.70 

Round  35, Train loss: 0.093, Test loss: 1.356, Test accuracy: 69.60 

Round  36, Train loss: 0.082, Test loss: 1.341, Test accuracy: 71.60 

Round  37, Train loss: 0.046, Test loss: 1.609, Test accuracy: 67.40 

Round  38, Train loss: 0.080, Test loss: 1.373, Test accuracy: 70.60 

Round  39, Train loss: 0.052, Test loss: 1.294, Test accuracy: 71.30 

Final Round, Train loss: 0.032, Test loss: 1.286, Test accuracy: 71.10 

Average accuracy final 10 rounds: 70.1 

479.2437837123871
[11.065621137619019, 16.339935541152954, 21.377102375030518, 26.782538652420044, 31.927136659622192, 37.122458934783936, 42.56594467163086, 47.589927196502686, 52.54822492599487, 57.62421798706055, 62.763710498809814, 67.85705614089966, 73.14664769172668, 78.46945834159851, 83.57381081581116, 88.6523129940033, 93.95381546020508, 99.43732213973999, 104.53682541847229, 109.85812163352966, 115.05053544044495, 120.21374249458313, 125.50476408004761, 130.58743500709534, 135.87668752670288, 141.07539105415344, 146.54248094558716, 151.48509240150452, 156.58464789390564, 161.84138798713684, 167.0424268245697, 172.152973651886, 177.34346437454224, 182.70128989219666, 187.73883700370789, 193.1063995361328, 198.19246244430542, 203.25002789497375, 208.70106053352356, 213.9287919998169, 219.57591724395752]
[26.6, 45.6, 48.4, 50.4, 57.7, 59.9, 62.7, 59.8, 61.8, 64.7, 66.9, 65.6, 65.4, 66.3, 64.0, 64.7, 67.7, 67.0, 68.7, 69.0, 67.5, 68.0, 65.8, 67.1, 66.8, 69.0, 66.7, 68.6, 69.5, 68.2, 69.3, 70.0, 70.1, 71.4, 69.7, 69.6, 71.6, 67.4, 70.6, 71.3, 71.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 40, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
Round   0, Train loss: 1.515, Test loss: 1.583, Test accuracy: 32.40
Round   1, Train loss: 1.285, Test loss: 1.395, Test accuracy: 41.50
Round   2, Train loss: 1.171, Test loss: 1.161, Test accuracy: 53.60
Round   3, Train loss: 1.047, Test loss: 1.052, Test accuracy: 56.90
Round   4, Train loss: 0.955, Test loss: 1.014, Test accuracy: 60.20
Round   5, Train loss: 0.890, Test loss: 0.995, Test accuracy: 59.70
Round   6, Train loss: 0.834, Test loss: 0.997, Test accuracy: 60.40
Round   7, Train loss: 0.763, Test loss: 1.001, Test accuracy: 60.30
Round   8, Train loss: 0.714, Test loss: 0.978, Test accuracy: 64.20
Round   9, Train loss: 0.659, Test loss: 1.092, Test accuracy: 63.00
Round  10, Train loss: 0.603, Test loss: 0.962, Test accuracy: 66.70
Round  11, Train loss: 0.571, Test loss: 0.984, Test accuracy: 66.60
Round  12, Train loss: 0.536, Test loss: 0.987, Test accuracy: 65.60
Round  13, Train loss: 0.474, Test loss: 0.978, Test accuracy: 68.00
Round  14, Train loss: 0.438, Test loss: 0.997, Test accuracy: 66.80
Round  15, Train loss: 0.396, Test loss: 0.993, Test accuracy: 67.30
Round  16, Train loss: 0.375, Test loss: 0.982, Test accuracy: 67.30
Round  17, Train loss: 0.319, Test loss: 1.071, Test accuracy: 66.60
Round  18, Train loss: 0.311, Test loss: 1.026, Test accuracy: 66.40
Round  19, Train loss: 0.269, Test loss: 1.046, Test accuracy: 67.80
Round  20, Train loss: 0.258, Test loss: 1.056, Test accuracy: 68.10
Round  21, Train loss: 0.241, Test loss: 1.097, Test accuracy: 68.10
Round  22, Train loss: 0.212, Test loss: 1.127, Test accuracy: 69.40
Round  23, Train loss: 0.229, Test loss: 1.115, Test accuracy: 67.90
Round  24, Train loss: 0.190, Test loss: 1.053, Test accuracy: 70.20
Round  25, Train loss: 0.160, Test loss: 1.124, Test accuracy: 70.80
Round  26, Train loss: 0.176, Test loss: 1.157, Test accuracy: 68.40
Round  27, Train loss: 0.147, Test loss: 1.133, Test accuracy: 68.90
Round  28, Train loss: 0.121, Test loss: 1.180, Test accuracy: 70.30
Round  29, Train loss: 0.131, Test loss: 1.149, Test accuracy: 70.00
Round  30, Train loss: 0.106, Test loss: 1.213, Test accuracy: 68.90
Round  31, Train loss: 0.115, Test loss: 1.252, Test accuracy: 68.70
Round  32, Train loss: 0.085, Test loss: 1.289, Test accuracy: 69.20
Round  33, Train loss: 0.075, Test loss: 1.297, Test accuracy: 70.50
Round  34, Train loss: 0.090, Test loss: 1.292, Test accuracy: 68.20
Round  35, Train loss: 0.079, Test loss: 1.302, Test accuracy: 68.70
Round  36, Train loss: 0.082, Test loss: 1.249, Test accuracy: 71.20
Round  37, Train loss: 0.073, Test loss: 1.276, Test accuracy: 69.80
Round  38, Train loss: 0.054, Test loss: 1.246, Test accuracy: 72.40
Round  39, Train loss: 0.055, Test loss: 1.307, Test accuracy: 70.40
Final Round, Train loss: 0.035, Test loss: 1.345, Test accuracy: 70.30
Average accuracy final 10 rounds: 69.8
564.0262882709503
[12.247488498687744, 18.553801774978638, 24.88978934288025, 31.132110595703125, 37.377336502075195, 43.90639877319336, 50.053261518478394, 56.30641579627991, 62.59581446647644, 68.80286574363708, 75.08785390853882, 81.37324595451355, 87.86088252067566, 94.34634375572205, 100.42538118362427, 106.94049978256226, 112.94065141677856, 119.15813660621643, 125.42868280410767, 131.69298434257507, 137.86741471290588, 144.13845038414001, 150.46183586120605, 156.87066268920898, 163.00760746002197, 169.4356827735901, 176.02230095863342, 182.10679650306702, 188.256094455719, 194.49063992500305, 200.63432502746582, 206.77147316932678, 212.85775518417358, 218.96732020378113, 225.07300853729248, 231.20775055885315, 237.65492916107178, 243.8820230960846, 250.14859199523926, 256.29767966270447, 262.23377895355225]
[32.4, 41.5, 53.6, 56.9, 60.2, 59.7, 60.4, 60.3, 64.2, 63.0, 66.7, 66.6, 65.6, 68.0, 66.8, 67.3, 67.3, 66.6, 66.4, 67.8, 68.1, 68.1, 69.4, 67.9, 70.2, 70.8, 68.4, 68.9, 70.3, 70.0, 68.9, 68.7, 69.2, 70.5, 68.2, 68.7, 71.2, 69.8, 72.4, 70.4, 70.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 5, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=5, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11181017 (local), 11178452 (global); Percentage 99.98 (11178452/11181017 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.820, Train accuracy: 66.800, Test loss: 1.061, Test accuracy: 57.60 

        train local model (freeze embeding):client   0,  Train loss: 0.697, Train accuracy: 73.000, Test loss: 0.910, Test accuracy: 63.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.659, Train accuracy: 76.200, Test loss: 0.928, Test accuracy: 65.40 

Round   0, Train loss: 0.659, Test loss: 0.928, Test accuracy: 65.40 

        train local model (freeze embeding):client   0,  Train loss: 0.595, Train accuracy: 77.800, Test loss: 0.913, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.457, Train accuracy: 84.600, Test loss: 0.836, Test accuracy: 68.80 

Round   1, Train loss: 0.457, Test loss: 0.836, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.365, Train accuracy: 86.800, Test loss: 0.828, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.262, Train accuracy: 90.600, Test loss: 0.999, Test accuracy: 68.40 

Round   2, Train loss: 0.262, Test loss: 0.999, Test accuracy: 68.40 

        train local model (freeze embeding):client   0,  Train loss: 0.231, Train accuracy: 91.200, Test loss: 0.965, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.181, Train accuracy: 94.600, Test loss: 0.829, Test accuracy: 71.60 

Round   3, Train loss: 0.181, Test loss: 0.829, Test accuracy: 71.60 

        train local model (freeze embeding):client   0,  Train loss: 0.148, Train accuracy: 95.000, Test loss: 0.903, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.125, Train accuracy: 95.200, Test loss: 1.135, Test accuracy: 69.80 

Round   4, Train loss: 0.125, Test loss: 1.135, Test accuracy: 69.80 

        train local model (freeze embeding):client   0,  Train loss: 0.091, Train accuracy: 97.600, Test loss: 1.166, Test accuracy: 70.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.091, Train accuracy: 96.400, Test loss: 1.185, Test accuracy: 68.20 

Round   5, Train loss: 0.091, Test loss: 1.185, Test accuracy: 68.20 

        train local model (freeze embeding):client   0,  Train loss: 0.061, Train accuracy: 98.000, Test loss: 1.256, Test accuracy: 69.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.060, Train accuracy: 98.000, Test loss: 1.378, Test accuracy: 71.00 

Round   6, Train loss: 0.060, Test loss: 1.378, Test accuracy: 71.00 

        train local model (freeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.331, Test accuracy: 74.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.043, Train accuracy: 98.800, Test loss: 1.525, Test accuracy: 69.60 

Round   7, Train loss: 0.043, Test loss: 1.525, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.800, Test loss: 1.298, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.041, Train accuracy: 98.600, Test loss: 1.414, Test accuracy: 69.60 

Round   8, Train loss: 0.041, Test loss: 1.414, Test accuracy: 69.60 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.800, Test loss: 1.290, Test accuracy: 69.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.016, Train accuracy: 99.800, Test loss: 1.213, Test accuracy: 73.80 

Round   9, Train loss: 0.016, Test loss: 1.213, Test accuracy: 73.80 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.204, Test accuracy: 73.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 98.400, Test loss: 1.602, Test accuracy: 70.00 

Round  10, Train loss: 0.045, Test loss: 1.602, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.200, Test loss: 1.459, Test accuracy: 70.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.600, Test loss: 1.623, Test accuracy: 72.00 

Round  11, Train loss: 0.019, Test loss: 1.623, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.516, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.424, Test accuracy: 73.20 

Round  12, Train loss: 0.008, Test loss: 1.424, Test accuracy: 73.20 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.417, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 1.551, Test accuracy: 70.00 

Round  13, Train loss: 0.025, Test loss: 1.551, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.474, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.400, Test loss: 1.649, Test accuracy: 70.20 

Round  14, Train loss: 0.019, Test loss: 1.649, Test accuracy: 70.20 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.600, Test loss: 1.613, Test accuracy: 71.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.616, Test accuracy: 74.60 

Round  15, Train loss: 0.001, Test loss: 1.616, Test accuracy: 74.60 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.612, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 73.60 

Round  16, Train loss: 0.000, Test loss: 1.570, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.563, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.700, Test accuracy: 73.60 

Round  17, Train loss: 0.001, Test loss: 1.700, Test accuracy: 73.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.639, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 73.00 

Round  18, Train loss: 0.005, Test loss: 1.600, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.578, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.600, Test loss: 1.689, Test accuracy: 72.00 

Round  19, Train loss: 0.021, Test loss: 1.689, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 1.583, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.581, Test accuracy: 73.00 

Final Round, Train loss: 0.002, Test loss: 1.591, Test accuracy: 74.60 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 1.018, Train accuracy: 59.000, Test loss: 1.221, Test accuracy: 53.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.570, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.534, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.927, Train accuracy: 64.600, Test loss: 1.173, Test accuracy: 55.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.307, Train accuracy: 89.200, Test loss: 1.313, Test accuracy: 59.40 

Round   0, Train loss: 0.155, Test loss: 1.247, Test accuracy: 66.20 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 1.376, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.600, Test loss: 1.409, Test accuracy: 73.00 

        train local model (freeze embeding):client   1,  Train loss: 0.451, Train accuracy: 85.800, Test loss: 1.246, Test accuracy: 60.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.311, Train accuracy: 87.200, Test loss: 1.592, Test accuracy: 59.20 

Round   1, Train loss: 0.159, Test loss: 1.438, Test accuracy: 64.80 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.294, Test accuracy: 74.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.600, Test loss: 1.672, Test accuracy: 71.80 

        train local model (freeze embeding):client   1,  Train loss: 0.226, Train accuracy: 93.200, Test loss: 1.278, Test accuracy: 62.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.341, Train accuracy: 88.400, Test loss: 1.908, Test accuracy: 58.60 

Round   2, Train loss: 0.180, Test loss: 1.455, Test accuracy: 66.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.319, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.458, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.118, Train accuracy: 96.600, Test loss: 1.581, Test accuracy: 61.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.149, Train accuracy: 95.000, Test loss: 1.745, Test accuracy: 65.40 

Round   3, Train loss: 0.075, Test loss: 1.409, Test accuracy: 69.30 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 1.432, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.400, Test loss: 1.468, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.065, Train accuracy: 98.600, Test loss: 1.569, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.075, Train accuracy: 97.800, Test loss: 1.823, Test accuracy: 61.40 

Round   4, Train loss: 0.050, Test loss: 1.430, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.800, Test loss: 1.275, Test accuracy: 72.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.611, Test accuracy: 74.40 

        train local model (freeze embeding):client   1,  Train loss: 0.040, Train accuracy: 99.600, Test loss: 1.543, Test accuracy: 65.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.182, Train accuracy: 92.200, Test loss: 2.234, Test accuracy: 59.60 

Round   5, Train loss: 0.093, Test loss: 1.607, Test accuracy: 68.00 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.600, Test loss: 1.415, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.560, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.800, Test loss: 1.716, Test accuracy: 62.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.186, Train accuracy: 93.400, Test loss: 2.057, Test accuracy: 58.20 

Round   6, Train loss: 0.093, Test loss: 1.565, Test accuracy: 67.40 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.348, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.400, Test loss: 1.561, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.029, Train accuracy: 99.800, Test loss: 1.723, Test accuracy: 62.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 2.144, Test accuracy: 62.20 

Round   7, Train loss: 0.033, Test loss: 1.573, Test accuracy: 68.80 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.365, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.480, Test accuracy: 73.40 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.745, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.064, Train accuracy: 98.800, Test loss: 2.110, Test accuracy: 62.00 

Round   8, Train loss: 0.033, Test loss: 1.602, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.445, Test accuracy: 72.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.800, Test loss: 1.630, Test accuracy: 69.60 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.800, Test loss: 1.724, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 98.600, Test loss: 2.063, Test accuracy: 61.20 

Round   9, Train loss: 0.022, Test loss: 1.663, Test accuracy: 66.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.437, Test accuracy: 72.20 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.600, Test accuracy: 73.20 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.932, Test accuracy: 64.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.200, Test loss: 2.467, Test accuracy: 61.00 

Round  10, Train loss: 0.019, Test loss: 1.615, Test accuracy: 69.70 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.374, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.431, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.800, Test loss: 1.846, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.073, Train accuracy: 97.000, Test loss: 2.482, Test accuracy: 61.40 

Round  11, Train loss: 0.038, Test loss: 1.615, Test accuracy: 68.60 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.345, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.382, Test accuracy: 74.40 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.825, Test accuracy: 64.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.069, Train accuracy: 97.200, Test loss: 2.681, Test accuracy: 62.20 

Round  12, Train loss: 0.035, Test loss: 1.721, Test accuracy: 67.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.375, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.047, Train accuracy: 99.400, Test loss: 1.500, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.968, Test accuracy: 63.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.038, Train accuracy: 98.800, Test loss: 2.033, Test accuracy: 64.60 

Round  13, Train loss: 0.042, Test loss: 1.565, Test accuracy: 69.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.267, Test accuracy: 74.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.646, Test accuracy: 73.60 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.865, Test accuracy: 65.60 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 2.310, Test accuracy: 61.20 

Round  14, Train loss: 0.005, Test loss: 1.690, Test accuracy: 69.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.510, Test accuracy: 73.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 74.20 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.967, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 2.580, Test accuracy: 59.60 

Round  15, Train loss: 0.004, Test loss: 1.833, Test accuracy: 67.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.505, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.600, Test loss: 1.614, Test accuracy: 72.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 2.112, Test accuracy: 62.80 

        train local model (unfreeze embeding):client   1,  Train loss: 0.043, Train accuracy: 98.600, Test loss: 2.594, Test accuracy: 61.60 

Round  16, Train loss: 0.027, Test loss: 1.743, Test accuracy: 67.80 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.457, Test accuracy: 73.40 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.605, Test accuracy: 71.60 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.800, Test loss: 2.031, Test accuracy: 64.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.329, Test accuracy: 61.80 

Round  17, Train loss: 0.002, Test loss: 1.787, Test accuracy: 68.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.493, Test accuracy: 71.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.495, Test accuracy: 71.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.166, Test accuracy: 64.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.400, Test loss: 2.327, Test accuracy: 61.80 

Round  18, Train loss: 0.010, Test loss: 1.726, Test accuracy: 67.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.800, Test loss: 1.523, Test accuracy: 72.80 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.447, Test accuracy: 75.40 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 2.098, Test accuracy: 63.40 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 99.800, Test loss: 2.241, Test accuracy: 64.20 

Round  19, Train loss: 0.003, Test loss: 1.678, Test accuracy: 70.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.410, Test accuracy: 74.60 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.392, Test accuracy: 74.40 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 2.018, Test accuracy: 67.20 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.950, Test accuracy: 66.00 

Final Round, Train loss: 0.001, Test loss: 1.657, Test accuracy: 70.50 

Average accuracy final 10 rounds: 140.77 

1243.0528664588928
[18.09320044517517, 36.951311111450195, 55.50520133972168, 73.9908356666565, 93.70959067344666, 112.07047843933105, 131.90506672859192, 150.4257471561432, 169.70071029663086, 188.38471579551697, 207.0021047592163, 225.80257868766785, 245.2173092365265, 263.62624335289, 282.28314304351807, 300.8304557800293, 319.39728021621704, 338.2901792526245, 356.57785177230835, 375.5221109390259, 386.55953884124756, 406.47820472717285, 425.2035074234009, 443.88198375701904, 462.779616355896, 481.7719633579254, 500.5782732963562, 519.3490025997162, 538.6331045627594, 557.722517490387, 576.7447538375854, 595.6492300033569, 614.1433246135712, 633.477885723114, 652.6656663417816, 671.3826298713684, 690.9024858474731, 709.6290788650513, 728.9739747047424, 747.6384453773499, 765.6264736652374, 775.7121231555939]
[65.4, 68.8, 68.4, 71.6, 69.8, 68.2, 71.0, 69.6, 69.6, 73.8, 70.0, 72.0, 73.2, 70.0, 70.2, 74.6, 73.6, 73.6, 73.0, 72.0, 74.6, 66.2, 64.8, 66.0, 69.3, 67.2, 68.0, 67.4, 68.8, 68.6, 66.7, 69.7, 68.6, 67.6, 69.5, 69.3, 67.2, 67.8, 68.3, 67.0, 70.5, 70.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.695, Test loss: 0.770, Test accuracy: 78.10 

Round   0, Global train loss: 0.695, Global test loss: 0.691, Global test accuracy: 50.60 

Round   1, Train loss: 0.485, Test loss: 0.653, Test accuracy: 76.00 

Round   1, Global train loss: 0.485, Global test loss: 0.667, Global test accuracy: 56.30 

Round   2, Train loss: 0.396, Test loss: 0.547, Test accuracy: 77.70 

Round   2, Global train loss: 0.396, Global test loss: 0.673, Global test accuracy: 52.60 

Round   3, Train loss: 0.356, Test loss: 0.495, Test accuracy: 81.60 

Round   3, Global train loss: 0.356, Global test loss: 0.681, Global test accuracy: 50.50 

Round   4, Train loss: 0.279, Test loss: 0.619, Test accuracy: 79.40 

Round   4, Global train loss: 0.279, Global test loss: 0.668, Global test accuracy: 57.60 

Round   5, Train loss: 0.257, Test loss: 0.496, Test accuracy: 80.20 

Round   5, Global train loss: 0.257, Global test loss: 0.673, Global test accuracy: 51.90 

Round   6, Train loss: 0.222, Test loss: 0.509, Test accuracy: 81.70 

Round   6, Global train loss: 0.222, Global test loss: 0.671, Global test accuracy: 61.90 

Round   7, Train loss: 0.230, Test loss: 0.511, Test accuracy: 82.50 

Round   7, Global train loss: 0.230, Global test loss: 0.673, Global test accuracy: 57.60 

Round   8, Train loss: 0.161, Test loss: 0.619, Test accuracy: 82.10 

Round   8, Global train loss: 0.161, Global test loss: 0.673, Global test accuracy: 55.60 

Round   9, Train loss: 0.155, Test loss: 0.794, Test accuracy: 80.20 

Round   9, Global train loss: 0.155, Global test loss: 0.667, Global test accuracy: 58.00 

Round  10, Train loss: 0.150, Test loss: 0.663, Test accuracy: 82.90 

Round  10, Global train loss: 0.150, Global test loss: 0.701, Global test accuracy: 50.00 

Round  11, Train loss: 0.120, Test loss: 0.539, Test accuracy: 84.70 

Round  11, Global train loss: 0.120, Global test loss: 0.673, Global test accuracy: 54.20 

Round  12, Train loss: 0.140, Test loss: 0.541, Test accuracy: 83.70 

Round  12, Global train loss: 0.140, Global test loss: 0.675, Global test accuracy: 54.40 

Round  13, Train loss: 0.116, Test loss: 0.623, Test accuracy: 80.80 

Round  13, Global train loss: 0.116, Global test loss: 0.678, Global test accuracy: 52.20 

Round  14, Train loss: 0.074, Test loss: 0.688, Test accuracy: 82.60 

Round  14, Global train loss: 0.074, Global test loss: 0.669, Global test accuracy: 60.90 

Round  15, Train loss: 0.068, Test loss: 0.724, Test accuracy: 82.30 

Round  15, Global train loss: 0.068, Global test loss: 0.681, Global test accuracy: 50.70 

Round  16, Train loss: 0.082, Test loss: 0.591, Test accuracy: 83.60 

Round  16, Global train loss: 0.082, Global test loss: 0.683, Global test accuracy: 50.50 

Round  17, Train loss: 0.058, Test loss: 0.650, Test accuracy: 84.40 

Round  17, Global train loss: 0.058, Global test loss: 0.666, Global test accuracy: 57.90 

Round  18, Train loss: 0.069, Test loss: 0.715, Test accuracy: 83.90 

Round  18, Global train loss: 0.069, Global test loss: 0.665, Global test accuracy: 62.10 

Round  19, Train loss: 0.033, Test loss: 0.727, Test accuracy: 83.80 

Round  19, Global train loss: 0.033, Global test loss: 0.664, Global test accuracy: 59.20 

Round  20, Train loss: 0.040, Test loss: 0.599, Test accuracy: 84.30 

Round  20, Global train loss: 0.040, Global test loss: 0.670, Global test accuracy: 57.40 

Round  21, Train loss: 0.043, Test loss: 0.686, Test accuracy: 84.70 

Round  21, Global train loss: 0.043, Global test loss: 0.678, Global test accuracy: 51.60 

Round  22, Train loss: 0.053, Test loss: 0.619, Test accuracy: 84.60 

Round  22, Global train loss: 0.053, Global test loss: 0.683, Global test accuracy: 50.50 

Round  23, Train loss: 0.036, Test loss: 0.627, Test accuracy: 84.40 

Round  23, Global train loss: 0.036, Global test loss: 0.666, Global test accuracy: 59.50 

Round  24, Train loss: 0.034, Test loss: 0.616, Test accuracy: 85.30 

Round  24, Global train loss: 0.034, Global test loss: 0.669, Global test accuracy: 60.70 

Round  25, Train loss: 0.031, Test loss: 0.616, Test accuracy: 86.30 

Round  25, Global train loss: 0.031, Global test loss: 0.674, Global test accuracy: 53.80 

Round  26, Train loss: 0.030, Test loss: 0.686, Test accuracy: 84.10 

Round  26, Global train loss: 0.030, Global test loss: 0.680, Global test accuracy: 51.20 

Round  27, Train loss: 0.031, Test loss: 0.521, Test accuracy: 87.40 

Round  27, Global train loss: 0.031, Global test loss: 0.675, Global test accuracy: 54.60 

Round  28, Train loss: 0.030, Test loss: 0.563, Test accuracy: 85.60 

Round  28, Global train loss: 0.030, Global test loss: 0.682, Global test accuracy: 50.50 

Round  29, Train loss: 0.017, Test loss: 0.557, Test accuracy: 86.30 

Round  29, Global train loss: 0.017, Global test loss: 0.697, Global test accuracy: 50.00 

Round  30, Train loss: 0.031, Test loss: 0.598, Test accuracy: 85.30 

Round  30, Global train loss: 0.031, Global test loss: 0.682, Global test accuracy: 50.90 

Round  31, Train loss: 0.029, Test loss: 0.630, Test accuracy: 86.10 

Round  31, Global train loss: 0.029, Global test loss: 0.680, Global test accuracy: 51.50 

Round  32, Train loss: 0.027, Test loss: 0.715, Test accuracy: 83.70 

Round  32, Global train loss: 0.027, Global test loss: 0.694, Global test accuracy: 50.10 

Round  33, Train loss: 0.020, Test loss: 0.621, Test accuracy: 85.90 

Round  33, Global train loss: 0.020, Global test loss: 0.677, Global test accuracy: 51.70 

Round  34, Train loss: 0.007, Test loss: 0.605, Test accuracy: 85.70 

Round  34, Global train loss: 0.007, Global test loss: 0.681, Global test accuracy: 50.90 

Final Round, Train loss: 0.017, Test loss: 0.594, Test accuracy: 86.20 

Final Round, Global train loss: 0.017, Global test loss: 0.681, Global test accuracy: 50.90 

Average accuracy final 10 rounds: 85.64000000000001 

Average global accuracy final 10 rounds: 51.519999999999996 

595.2012860774994
[9.069551944732666, 11.796330451965332, 14.533654928207397, 17.318360567092896, 20.06758451461792, 22.811336517333984, 25.55043315887451, 28.275203466415405, 30.99640393257141, 33.7343213558197, 36.47089076042175, 39.20536923408508, 41.96297478675842, 44.692784547805786, 47.42331027984619, 50.15755367279053, 52.89181303977966, 55.611908197402954, 58.668747425079346, 61.38941502571106, 64.2138261795044, 67.06261825561523, 69.77312088012695, 72.45478081703186, 75.2059063911438, 77.88070631027222, 80.64132118225098, 83.51366758346558, 86.16119074821472, 88.92063570022583, 92.15749287605286, 95.18421292304993, 97.89860558509827, 100.67410826683044, 103.43595743179321, 108.92159056663513]
[78.1, 76.0, 77.7, 81.6, 79.4, 80.2, 81.7, 82.5, 82.1, 80.2, 82.9, 84.7, 83.7, 80.8, 82.6, 82.3, 83.6, 84.4, 83.9, 83.8, 84.3, 84.7, 84.6, 84.4, 85.3, 86.3, 84.1, 87.4, 85.6, 86.3, 85.3, 86.1, 83.7, 85.9, 85.7, 86.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.704, Test loss: 0.894, Test accuracy: 74.40 

Round   0, Global train loss: 0.704, Global test loss: 0.686, Global test accuracy: 52.00 

Round   1, Train loss: 0.587, Test loss: 0.647, Test accuracy: 73.70 

Round   1, Global train loss: 0.587, Global test loss: 0.670, Global test accuracy: 62.30 

Round   2, Train loss: 0.546, Test loss: 0.571, Test accuracy: 75.60 

Round   2, Global train loss: 0.546, Global test loss: 0.642, Global test accuracy: 61.90 

Round   3, Train loss: 0.502, Test loss: 0.513, Test accuracy: 79.00 

Round   3, Global train loss: 0.502, Global test loss: 0.658, Global test accuracy: 61.20 

Round   4, Train loss: 0.486, Test loss: 0.564, Test accuracy: 76.30 

Round   4, Global train loss: 0.486, Global test loss: 0.711, Global test accuracy: 59.40 

Round   5, Train loss: 0.441, Test loss: 0.606, Test accuracy: 77.60 

Round   5, Global train loss: 0.441, Global test loss: 0.714, Global test accuracy: 61.00 

Round   6, Train loss: 0.406, Test loss: 0.774, Test accuracy: 73.40 

Round   6, Global train loss: 0.406, Global test loss: 0.617, Global test accuracy: 65.60 

Round   7, Train loss: 0.386, Test loss: 0.577, Test accuracy: 81.30 

Round   7, Global train loss: 0.386, Global test loss: 0.692, Global test accuracy: 63.60 

Round   8, Train loss: 0.358, Test loss: 0.524, Test accuracy: 81.20 

Round   8, Global train loss: 0.358, Global test loss: 0.717, Global test accuracy: 66.00 

Round   9, Train loss: 0.353, Test loss: 0.468, Test accuracy: 82.30 

Round   9, Global train loss: 0.353, Global test loss: 0.703, Global test accuracy: 65.60 

Round  10, Train loss: 0.343, Test loss: 0.418, Test accuracy: 81.90 

Round  10, Global train loss: 0.343, Global test loss: 0.688, Global test accuracy: 64.50 

Round  11, Train loss: 0.300, Test loss: 0.592, Test accuracy: 79.60 

Round  11, Global train loss: 0.300, Global test loss: 0.709, Global test accuracy: 64.00 

Round  12, Train loss: 0.279, Test loss: 0.642, Test accuracy: 77.90 

Round  12, Global train loss: 0.279, Global test loss: 0.760, Global test accuracy: 66.50 

Round  13, Train loss: 0.316, Test loss: 0.567, Test accuracy: 79.10 

Round  13, Global train loss: 0.316, Global test loss: 0.696, Global test accuracy: 66.20 

Round  14, Train loss: 0.265, Test loss: 0.602, Test accuracy: 81.60 

Round  14, Global train loss: 0.265, Global test loss: 0.751, Global test accuracy: 66.40 

Round  15, Train loss: 0.241, Test loss: 0.468, Test accuracy: 83.60 

Round  15, Global train loss: 0.241, Global test loss: 0.773, Global test accuracy: 66.50 

Round  16, Train loss: 0.244, Test loss: 0.883, Test accuracy: 79.70 

Round  16, Global train loss: 0.244, Global test loss: 0.775, Global test accuracy: 67.90 

Round  17, Train loss: 0.246, Test loss: 0.640, Test accuracy: 82.70 

Round  17, Global train loss: 0.246, Global test loss: 0.796, Global test accuracy: 64.40 

Round  18, Train loss: 0.214, Test loss: 0.537, Test accuracy: 82.90 

Round  18, Global train loss: 0.214, Global test loss: 0.802, Global test accuracy: 65.00 

Round  19, Train loss: 0.218, Test loss: 0.664, Test accuracy: 80.50 

Round  19, Global train loss: 0.218, Global test loss: 0.780, Global test accuracy: 65.50 

Round  20, Train loss: 0.202, Test loss: 0.581, Test accuracy: 82.10 

Round  20, Global train loss: 0.202, Global test loss: 0.816, Global test accuracy: 65.70 

Round  21, Train loss: 0.179, Test loss: 0.547, Test accuracy: 82.70 

Round  21, Global train loss: 0.179, Global test loss: 0.861, Global test accuracy: 67.10 

Round  22, Train loss: 0.197, Test loss: 0.516, Test accuracy: 84.50 

Round  22, Global train loss: 0.197, Global test loss: 0.849, Global test accuracy: 67.40 

Round  23, Train loss: 0.172, Test loss: 0.701, Test accuracy: 82.60 

Round  23, Global train loss: 0.172, Global test loss: 0.882, Global test accuracy: 66.30 

Round  24, Train loss: 0.177, Test loss: 0.470, Test accuracy: 84.80 

Round  24, Global train loss: 0.177, Global test loss: 0.854, Global test accuracy: 66.30 

Round  25, Train loss: 0.147, Test loss: 0.507, Test accuracy: 83.50 

Round  25, Global train loss: 0.147, Global test loss: 0.875, Global test accuracy: 66.10 

Round  26, Train loss: 0.140, Test loss: 0.602, Test accuracy: 83.90 

Round  26, Global train loss: 0.140, Global test loss: 0.897, Global test accuracy: 66.90 

Round  27, Train loss: 0.147, Test loss: 0.592, Test accuracy: 81.90 

Round  27, Global train loss: 0.147, Global test loss: 0.896, Global test accuracy: 66.20 

Round  28, Train loss: 0.133, Test loss: 0.582, Test accuracy: 82.20 

Round  28, Global train loss: 0.133, Global test loss: 0.896, Global test accuracy: 67.90 

Round  29, Train loss: 0.131, Test loss: 0.603, Test accuracy: 81.90 

Round  29, Global train loss: 0.131, Global test loss: 0.902, Global test accuracy: 66.80 

Round  30, Train loss: 0.122, Test loss: 0.823, Test accuracy: 81.50 

Round  30, Global train loss: 0.122, Global test loss: 0.988, Global test accuracy: 67.20 

Round  31, Train loss: 0.136, Test loss: 0.666, Test accuracy: 81.10 

Round  31, Global train loss: 0.136, Global test loss: 0.888, Global test accuracy: 67.30 

Round  32, Train loss: 0.091, Test loss: 0.582, Test accuracy: 83.90 

Round  32, Global train loss: 0.091, Global test loss: 0.953, Global test accuracy: 67.20 

Round  33, Train loss: 0.090, Test loss: 0.671, Test accuracy: 82.60 

Round  33, Global train loss: 0.090, Global test loss: 0.966, Global test accuracy: 67.50 

Round  34, Train loss: 0.115, Test loss: 0.570, Test accuracy: 82.80 

Round  34, Global train loss: 0.115, Global test loss: 0.952, Global test accuracy: 65.70 

Final Round, Train loss: 0.095, Test loss: 0.560, Test accuracy: 84.20 

Final Round, Global train loss: 0.095, Global test loss: 0.952, Global test accuracy: 65.70 

Average accuracy final 10 rounds: 82.53000000000002 

Average global accuracy final 10 rounds: 66.88 

593.822478055954
[8.497586488723755, 11.259533882141113, 14.00003433227539, 16.741908073425293, 19.42473554611206, 22.355353116989136, 25.091557502746582, 27.862398147583008, 30.643768310546875, 33.41120266914368, 36.10450005531311, 38.848897218704224, 41.62471842765808, 44.4352343082428, 47.24811387062073, 49.938743114471436, 52.70457887649536, 55.54289197921753, 58.33358860015869, 61.221561670303345, 63.999361753463745, 66.70679092407227, 69.5221300125122, 72.23902320861816, 75.0667576789856, 77.95940113067627, 80.64613890647888, 83.2791895866394, 86.0546383857727, 88.80597853660583, 91.53603482246399, 94.25925469398499, 97.06006407737732, 99.94591021537781, 102.7553448677063, 108.24615550041199]
[74.4, 73.7, 75.6, 79.0, 76.3, 77.6, 73.4, 81.3, 81.2, 82.3, 81.9, 79.6, 77.9, 79.1, 81.6, 83.6, 79.7, 82.7, 82.9, 80.5, 82.1, 82.7, 84.5, 82.6, 84.8, 83.5, 83.9, 81.9, 82.2, 81.9, 81.5, 81.1, 83.9, 82.6, 82.8, 84.2]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.714, Test loss: 1.002, Test accuracy: 50.00 

Round   1, Train loss: 0.644, Test loss: 0.964, Test accuracy: 53.50 

Round   2, Train loss: 0.619, Test loss: 1.069, Test accuracy: 52.00 

Round   3, Train loss: 0.574, Test loss: 0.934, Test accuracy: 58.90 

Round   4, Train loss: 0.540, Test loss: 0.784, Test accuracy: 58.60 

Round   5, Train loss: 0.529, Test loss: 0.717, Test accuracy: 69.40 

Round   6, Train loss: 0.484, Test loss: 0.486, Test accuracy: 76.30 

Round   7, Train loss: 0.466, Test loss: 0.418, Test accuracy: 79.90 

Round   8, Train loss: 0.439, Test loss: 0.748, Test accuracy: 68.70 

Round   9, Train loss: 0.410, Test loss: 0.526, Test accuracy: 76.30 

Round  10, Train loss: 0.385, Test loss: 0.537, Test accuracy: 77.40 

Round  11, Train loss: 0.377, Test loss: 0.466, Test accuracy: 79.50 

Round  12, Train loss: 0.355, Test loss: 0.483, Test accuracy: 79.30 

Round  13, Train loss: 0.334, Test loss: 0.492, Test accuracy: 80.00 

Round  14, Train loss: 0.341, Test loss: 0.456, Test accuracy: 81.30 

Round  15, Train loss: 0.323, Test loss: 0.506, Test accuracy: 81.20 

Round  16, Train loss: 0.296, Test loss: 0.513, Test accuracy: 79.00 

Round  17, Train loss: 0.287, Test loss: 0.543, Test accuracy: 80.20 

Round  18, Train loss: 0.266, Test loss: 0.399, Test accuracy: 83.80 

Round  19, Train loss: 0.285, Test loss: 0.515, Test accuracy: 80.70 

Round  20, Train loss: 0.266, Test loss: 0.441, Test accuracy: 81.70 

Round  21, Train loss: 0.224, Test loss: 0.375, Test accuracy: 83.90 

Round  22, Train loss: 0.238, Test loss: 0.548, Test accuracy: 80.40 

Round  23, Train loss: 0.226, Test loss: 0.442, Test accuracy: 81.60 

Round  24, Train loss: 0.206, Test loss: 0.421, Test accuracy: 83.40 

Round  25, Train loss: 0.219, Test loss: 0.623, Test accuracy: 80.50 

Round  26, Train loss: 0.194, Test loss: 0.456, Test accuracy: 82.20 

Round  27, Train loss: 0.188, Test loss: 0.466, Test accuracy: 82.50 

Round  28, Train loss: 0.163, Test loss: 0.513, Test accuracy: 81.60 

Round  29, Train loss: 0.153, Test loss: 0.417, Test accuracy: 84.30 

Round  30, Train loss: 0.134, Test loss: 0.405, Test accuracy: 85.20 

Round  31, Train loss: 0.126, Test loss: 0.442, Test accuracy: 83.80 

Round  32, Train loss: 0.143, Test loss: 0.456, Test accuracy: 84.40 

Round  33, Train loss: 0.127, Test loss: 0.456, Test accuracy: 83.90 

Round  34, Train loss: 0.135, Test loss: 0.431, Test accuracy: 84.80 

Round  35, Train loss: 0.115, Test loss: 0.459, Test accuracy: 83.90 

Round  36, Train loss: 0.095, Test loss: 0.423, Test accuracy: 85.50 

Round  37, Train loss: 0.113, Test loss: 0.504, Test accuracy: 83.50 

Round  38, Train loss: 0.093, Test loss: 0.457, Test accuracy: 85.10 

Round  39, Train loss: 0.096, Test loss: 0.485, Test accuracy: 84.30 

Round  40, Train loss: 0.098, Test loss: 0.428, Test accuracy: 84.80 

Round  41, Train loss: 0.084, Test loss: 0.511, Test accuracy: 82.40 

Round  42, Train loss: 0.080, Test loss: 0.456, Test accuracy: 84.80 

Round  43, Train loss: 0.080, Test loss: 0.462, Test accuracy: 84.50 

Round  44, Train loss: 0.059, Test loss: 0.490, Test accuracy: 83.20 

Round  45, Train loss: 0.094, Test loss: 0.557, Test accuracy: 82.30 

Round  46, Train loss: 0.077, Test loss: 0.490, Test accuracy: 84.20 

Round  47, Train loss: 0.079, Test loss: 0.465, Test accuracy: 84.00 

Round  48, Train loss: 0.073, Test loss: 0.476, Test accuracy: 85.40 

Round  49, Train loss: 0.051, Test loss: 0.498, Test accuracy: 85.00 

Final Round, Train loss: 0.038, Test loss: 0.482, Test accuracy: 85.50 

Average accuracy final 10 rounds: 84.06000000000002 

608.2137491703033
[7.8931474685668945, 10.08344554901123, 12.40223217010498, 14.603985786437988, 16.829492807388306, 18.955327033996582, 21.019318342208862, 23.13862895965576, 25.30118989944458, 27.472004413604736, 29.910903692245483, 32.049869537353516, 34.228463649749756, 36.32095694541931, 38.428186893463135, 40.554174184799194, 42.83789277076721, 45.03710722923279, 47.26057529449463, 49.466410875320435, 51.647605180740356, 53.81967258453369, 56.054532527923584, 58.1528856754303, 60.20080637931824, 62.41097640991211, 64.71487021446228, 66.93910193443298, 69.16130828857422, 71.36160945892334, 73.473801612854, 75.55399298667908, 77.80515027046204, 79.97840189933777, 82.09696388244629, 84.34255576133728, 86.48310375213623, 88.74893927574158, 90.88890099525452, 93.23529815673828, 95.31643176078796, 97.52665519714355, 99.72285294532776, 101.95785880088806, 104.24999737739563, 106.38411617279053, 108.62801432609558, 110.83886075019836, 113.08381152153015, 115.33524084091187, 118.05009007453918]
[50.0, 53.5, 52.0, 58.9, 58.6, 69.4, 76.3, 79.9, 68.7, 76.3, 77.4, 79.5, 79.3, 80.0, 81.3, 81.2, 79.0, 80.2, 83.8, 80.7, 81.7, 83.9, 80.4, 81.6, 83.4, 80.5, 82.2, 82.5, 81.6, 84.3, 85.2, 83.8, 84.4, 83.9, 84.8, 83.9, 85.5, 83.5, 85.1, 84.3, 84.8, 82.4, 84.8, 84.5, 83.2, 82.3, 84.2, 84.0, 85.4, 85.0, 85.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.740, Test loss: 0.759, Test accuracy: 55.60
Round   1, Train loss: 0.690, Test loss: 1.408, Test accuracy: 50.90
Round   2, Train loss: 0.630, Test loss: 1.292, Test accuracy: 51.40
Round   3, Train loss: 0.593, Test loss: 1.246, Test accuracy: 56.60
Round   4, Train loss: 0.578, Test loss: 0.933, Test accuracy: 64.00
Round   5, Train loss: 0.484, Test loss: 0.844, Test accuracy: 62.30
Round   6, Train loss: 0.471, Test loss: 0.488, Test accuracy: 77.20
Round   7, Train loss: 0.436, Test loss: 0.459, Test accuracy: 79.00
Round   8, Train loss: 0.415, Test loss: 0.439, Test accuracy: 79.30
Round   9, Train loss: 0.407, Test loss: 0.462, Test accuracy: 79.90
Round  10, Train loss: 0.394, Test loss: 0.488, Test accuracy: 79.70
Round  11, Train loss: 0.374, Test loss: 0.493, Test accuracy: 78.30
Round  12, Train loss: 0.357, Test loss: 0.447, Test accuracy: 80.30
Round  13, Train loss: 0.324, Test loss: 0.447, Test accuracy: 79.60
Round  14, Train loss: 0.336, Test loss: 0.508, Test accuracy: 79.90
Round  15, Train loss: 0.284, Test loss: 0.392, Test accuracy: 84.50
Round  16, Train loss: 0.282, Test loss: 0.360, Test accuracy: 84.70
Round  17, Train loss: 0.282, Test loss: 0.454, Test accuracy: 81.30
Round  18, Train loss: 0.265, Test loss: 0.390, Test accuracy: 84.10
Round  19, Train loss: 0.240, Test loss: 0.398, Test accuracy: 82.40
Round  20, Train loss: 0.233, Test loss: 0.395, Test accuracy: 84.70
Round  21, Train loss: 0.224, Test loss: 0.417, Test accuracy: 83.30
Round  22, Train loss: 0.205, Test loss: 0.366, Test accuracy: 85.30
Round  23, Train loss: 0.198, Test loss: 0.396, Test accuracy: 83.80
Round  24, Train loss: 0.191, Test loss: 0.433, Test accuracy: 83.20
Round  25, Train loss: 0.189, Test loss: 0.616, Test accuracy: 81.40
Round  26, Train loss: 0.173, Test loss: 0.403, Test accuracy: 84.60
Round  27, Train loss: 0.157, Test loss: 0.473, Test accuracy: 81.70
Round  28, Train loss: 0.135, Test loss: 0.393, Test accuracy: 85.10
Round  29, Train loss: 0.143, Test loss: 0.414, Test accuracy: 84.20
Round  30, Train loss: 0.156, Test loss: 0.567, Test accuracy: 81.00
Round  31, Train loss: 0.139, Test loss: 0.388, Test accuracy: 84.30
Round  32, Train loss: 0.147, Test loss: 0.408, Test accuracy: 83.50
Round  33, Train loss: 0.121, Test loss: 0.448, Test accuracy: 84.80
Round  34, Train loss: 0.113, Test loss: 0.428, Test accuracy: 85.60
Round  35, Train loss: 0.115, Test loss: 0.427, Test accuracy: 83.80
Round  36, Train loss: 0.096, Test loss: 0.465, Test accuracy: 83.10
Round  37, Train loss: 0.094, Test loss: 0.429, Test accuracy: 84.00
Round  38, Train loss: 0.084, Test loss: 0.459, Test accuracy: 84.20
Round  39, Train loss: 0.080, Test loss: 0.474, Test accuracy: 83.80
Round  40, Train loss: 0.096, Test loss: 0.440, Test accuracy: 85.10
Round  41, Train loss: 0.091, Test loss: 0.477, Test accuracy: 83.90
Round  42, Train loss: 0.081, Test loss: 0.500, Test accuracy: 83.40
Round  43, Train loss: 0.074, Test loss: 0.454, Test accuracy: 85.90
Round  44, Train loss: 0.067, Test loss: 0.479, Test accuracy: 84.40
Round  45, Train loss: 0.069, Test loss: 0.485, Test accuracy: 84.70
Round  46, Train loss: 0.084, Test loss: 0.469, Test accuracy: 85.00
Round  47, Train loss: 0.056, Test loss: 0.451, Test accuracy: 84.40
Round  48, Train loss: 0.061, Test loss: 0.443, Test accuracy: 85.10
Round  49, Train loss: 0.045, Test loss: 0.522, Test accuracy: 83.90
Final Round, Train loss: 0.032, Test loss: 0.501, Test accuracy: 83.90
Average accuracy final 10 rounds: 84.58
712.2314882278442
[8.4803626537323, 11.145479679107666, 13.71046495437622, 16.333115339279175, 18.931036949157715, 21.47473454475403, 24.11432957649231, 26.634836196899414, 29.341597318649292, 31.98932671546936, 34.61014151573181, 37.217979192733765, 40.05414700508118, 42.792815923690796, 45.363720655441284, 47.935819149017334, 50.48944354057312, 53.29405379295349, 55.89922499656677, 58.55268621444702, 61.06468200683594, 63.926936626434326, 66.52865815162659, 69.0721960067749, 71.63334083557129, 74.56649160385132, 77.33534860610962, 79.87450289726257, 82.57291913032532, 85.1386148929596, 87.72801566123962, 90.30236721038818, 92.76544666290283, 95.41050744056702, 97.88540053367615, 100.42447209358215, 102.95374751091003, 105.563072681427, 108.16519165039062, 110.79836010932922, 113.54491853713989, 116.19207382202148, 118.95968222618103, 121.7616856098175, 124.3600664138794, 126.82950210571289, 129.67694425582886, 132.3691017627716, 135.00949811935425, 137.57747435569763, 140.12867093086243]
[55.6, 50.9, 51.4, 56.6, 64.0, 62.3, 77.2, 79.0, 79.3, 79.9, 79.7, 78.3, 80.3, 79.6, 79.9, 84.5, 84.7, 81.3, 84.1, 82.4, 84.7, 83.3, 85.3, 83.8, 83.2, 81.4, 84.6, 81.7, 85.1, 84.2, 81.0, 84.3, 83.5, 84.8, 85.6, 83.8, 83.1, 84.0, 84.2, 83.8, 85.1, 83.9, 83.4, 85.9, 84.4, 84.7, 85.0, 84.4, 85.1, 83.9, 83.9]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.429, Train accuracy: 81.000, Test loss: 0.670, Test accuracy: 76.00 

        train local model (freeze embeding):client   0,  Train loss: 0.368, Train accuracy: 85.500, Test loss: 0.500, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.367, Train accuracy: 86.000, Test loss: 0.491, Test accuracy: 77.50 

Round   0, Train loss: 0.367, Test loss: 0.491, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.307, Train accuracy: 88.500, Test loss: 0.477, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.303, Train accuracy: 87.500, Test loss: 0.630, Test accuracy: 75.50 

Round   1, Train loss: 0.303, Test loss: 0.630, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.361, Train accuracy: 83.000, Test loss: 0.765, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.304, Train accuracy: 88.500, Test loss: 0.548, Test accuracy: 74.50 

Round   2, Train loss: 0.304, Test loss: 0.548, Test accuracy: 74.50 

        train local model (freeze embeding):client   0,  Train loss: 0.243, Train accuracy: 92.000, Test loss: 0.541, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.269, Train accuracy: 90.000, Test loss: 0.721, Test accuracy: 72.50 

Round   3, Train loss: 0.269, Test loss: 0.721, Test accuracy: 72.50 

        train local model (freeze embeding):client   0,  Train loss: 0.215, Train accuracy: 90.500, Test loss: 0.585, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.172, Train accuracy: 92.000, Test loss: 0.600, Test accuracy: 76.50 

Round   4, Train loss: 0.172, Test loss: 0.600, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.210, Train accuracy: 92.000, Test loss: 0.537, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.190, Train accuracy: 93.500, Test loss: 0.833, Test accuracy: 71.50 

Round   5, Train loss: 0.190, Test loss: 0.833, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.201, Train accuracy: 91.500, Test loss: 0.744, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.198, Train accuracy: 93.000, Test loss: 0.527, Test accuracy: 79.00 

Round   6, Train loss: 0.198, Test loss: 0.527, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.194, Train accuracy: 92.000, Test loss: 0.570, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.132, Train accuracy: 95.000, Test loss: 0.683, Test accuracy: 75.50 

Round   7, Train loss: 0.132, Test loss: 0.683, Test accuracy: 75.50 

        train local model (freeze embeding):client   0,  Train loss: 0.111, Train accuracy: 94.500, Test loss: 0.679, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.531, Train accuracy: 86.000, Test loss: 1.237, Test accuracy: 72.00 

Round   8, Train loss: 0.531, Test loss: 1.237, Test accuracy: 72.00 

        train local model (freeze embeding):client   0,  Train loss: 0.108, Train accuracy: 97.000, Test loss: 0.602, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.120, Train accuracy: 96.500, Test loss: 0.518, Test accuracy: 81.00 

Round   9, Train loss: 0.120, Test loss: 0.518, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.094, Train accuracy: 96.000, Test loss: 0.662, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.156, Train accuracy: 95.000, Test loss: 0.975, Test accuracy: 73.00 

Round  10, Train loss: 0.156, Test loss: 0.975, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.061, Train accuracy: 98.500, Test loss: 0.742, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.940, Test accuracy: 78.50 

Round  11, Train loss: 0.050, Test loss: 0.940, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 98.500, Test loss: 0.899, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.229, Train accuracy: 92.500, Test loss: 0.950, Test accuracy: 71.50 

Round  12, Train loss: 0.229, Test loss: 0.950, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.081, Train accuracy: 97.500, Test loss: 0.664, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.087, Train accuracy: 98.500, Test loss: 0.937, Test accuracy: 77.50 

Round  13, Train loss: 0.087, Test loss: 0.937, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.044, Train accuracy: 99.000, Test loss: 0.910, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.056, Train accuracy: 98.500, Test loss: 0.799, Test accuracy: 79.00 

Round  14, Train loss: 0.056, Test loss: 0.799, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.732, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 1.055, Test accuracy: 74.00 

Round  15, Train loss: 0.036, Test loss: 1.055, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.993, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 1.104, Test accuracy: 76.50 

Round  16, Train loss: 0.029, Test loss: 1.104, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 0.898, Test accuracy: 77.00 

Round  17, Train loss: 0.045, Test loss: 0.898, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.500, Test loss: 0.879, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.757, Test accuracy: 80.50 

Round  18, Train loss: 0.021, Test loss: 0.757, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.799, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.147, Train accuracy: 94.500, Test loss: 0.834, Test accuracy: 73.50 

Round  19, Train loss: 0.147, Test loss: 0.834, Test accuracy: 73.50 

        train local model (freeze embeding):client   0,  Train loss: 0.101, Train accuracy: 96.500, Test loss: 0.895, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.043, Train accuracy: 98.500, Test loss: 1.003, Test accuracy: 75.50 

Final Round, Train loss: 0.043, Test loss: 0.991, Test accuracy: 77.50 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.386, Train accuracy: 82.500, Test loss: 0.361, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.042, Train accuracy: 98.500, Test loss: 1.002, Test accuracy: 76.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.190, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.344, Train accuracy: 86.500, Test loss: 0.339, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.148, Train accuracy: 95.000, Test loss: 0.261, Test accuracy: 88.00 

Round   0, Train loss: 0.076, Test loss: 0.587, Test accuracy: 80.25 

        train local model (freeze embeding):client   0,  Train loss: 0.064, Train accuracy: 98.000, Test loss: 0.895, Test accuracy: 75.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 100.000, Test loss: 1.118, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.225, Train accuracy: 92.000, Test loss: 0.330, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.388, Train accuracy: 82.500, Test loss: 0.552, Test accuracy: 79.00 

Round   1, Train loss: 0.204, Test loss: 0.825, Test accuracy: 74.00 

        train local model (freeze embeding):client   0,  Train loss: 0.049, Train accuracy: 98.500, Test loss: 0.823, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.092, Train accuracy: 97.500, Test loss: 0.783, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.202, Train accuracy: 93.000, Test loss: 0.368, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.074, Train accuracy: 97.500, Test loss: 0.322, Test accuracy: 86.50 

Round   2, Train loss: 0.083, Test loss: 0.579, Test accuracy: 81.25 

        train local model (freeze embeding):client   0,  Train loss: 0.050, Train accuracy: 99.000, Test loss: 0.865, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 98.500, Test loss: 0.820, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.110, Train accuracy: 95.500, Test loss: 0.300, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.080, Train accuracy: 97.500, Test loss: 0.234, Test accuracy: 94.00 

Round   3, Train loss: 0.055, Test loss: 0.566, Test accuracy: 83.00 

        train local model (freeze embeding):client   0,  Train loss: 0.040, Train accuracy: 99.000, Test loss: 0.813, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.060, Train accuracy: 98.500, Test loss: 0.297, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.073, Train accuracy: 98.000, Test loss: 0.403, Test accuracy: 87.50 

Round   4, Train loss: 0.041, Test loss: 0.613, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.500, Test loss: 0.849, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 1.055, Test accuracy: 76.50 

        train local model (freeze embeding):client   1,  Train loss: 0.095, Train accuracy: 97.000, Test loss: 0.290, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 0.351, Test accuracy: 89.00 

Round   5, Train loss: 0.036, Test loss: 0.696, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.948, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.096, Train accuracy: 97.000, Test loss: 0.408, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.392, Test accuracy: 90.50 

Round   6, Train loss: 0.023, Test loss: 0.605, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.887, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.055, Train accuracy: 98.000, Test loss: 1.233, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.063, Train accuracy: 97.500, Test loss: 0.433, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.035, Train accuracy: 99.000, Test loss: 0.303, Test accuracy: 89.00 

Round   7, Train loss: 0.045, Test loss: 0.546, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.844, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.002, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.057, Train accuracy: 97.500, Test loss: 0.292, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.233, Train accuracy: 90.500, Test loss: 0.618, Test accuracy: 84.00 

Round   8, Train loss: 0.122, Test loss: 0.558, Test accuracy: 85.25 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.814, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.284, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.289, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.136, Train accuracy: 95.000, Test loss: 0.483, Test accuracy: 86.50 

Round   9, Train loss: 0.073, Test loss: 0.601, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 1.007, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 0.961, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.025, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 97.500, Test loss: 0.511, Test accuracy: 92.00 

Round  10, Train loss: 0.030, Test loss: 0.601, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.897, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 1.048, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.288, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.086, Train accuracy: 97.500, Test loss: 0.396, Test accuracy: 89.00 

Round  11, Train loss: 0.048, Test loss: 0.565, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.818, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.330, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.064, Train accuracy: 98.500, Test loss: 0.542, Test accuracy: 88.50 

Round  12, Train loss: 0.035, Test loss: 0.690, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.941, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 1.481, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 0.339, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.337, Test accuracy: 91.00 

Round  13, Train loss: 0.027, Test loss: 0.659, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.000, Test loss: 1.104, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 1.142, Test accuracy: 74.50 

        train local model (freeze embeding):client   1,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 0.314, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 0.383, Test accuracy: 90.50 

Round  14, Train loss: 0.026, Test loss: 0.595, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.036, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 1.086, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.273, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 93.50 

Round  15, Train loss: 0.012, Test loss: 0.674, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.102, Train accuracy: 96.500, Test loss: 1.537, Test accuracy: 69.50 

        train local model (freeze embeding):client   1,  Train loss: 0.020, Train accuracy: 99.500, Test loss: 0.321, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.072, Train accuracy: 97.500, Test loss: 0.560, Test accuracy: 92.00 

Round  16, Train loss: 0.087, Test loss: 0.725, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.909, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.034, Train accuracy: 99.000, Test loss: 0.403, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.324, Test accuracy: 90.50 

Round  17, Train loss: 0.006, Test loss: 0.644, Test accuracy: 84.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.101, Train accuracy: 96.000, Test loss: 0.370, Test accuracy: 91.50 

Round  18, Train loss: 0.051, Test loss: 0.675, Test accuracy: 86.25 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.053, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.028, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.309, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 92.00 

Round  19, Train loss: 0.001, Test loss: 0.616, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.905, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.946, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.320, Test accuracy: 92.00 

Final Round, Train loss: 0.002, Test loss: 0.607, Test accuracy: 86.00 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.652, Train accuracy: 69.500, Test loss: 0.671, Test accuracy: 71.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.980, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 1.318, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.308, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.526, Train accuracy: 76.000, Test loss: 0.466, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.290, Train accuracy: 88.000, Test loss: 0.466, Test accuracy: 84.00 

Round   0, Train loss: 0.108, Test loss: 0.443, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.700, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.157, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.413, Test accuracy: 86.00 

        train local model (freeze embeding):client   2,  Train loss: 0.305, Train accuracy: 84.000, Test loss: 0.505, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.206, Train accuracy: 91.000, Test loss: 0.437, Test accuracy: 81.50 

Round   1, Train loss: 0.075, Test loss: 0.488, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.744, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.151, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.370, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.175, Train accuracy: 91.000, Test loss: 0.393, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.123, Train accuracy: 96.000, Test loss: 0.432, Test accuracy: 84.00 

Round   2, Train loss: 0.046, Test loss: 0.449, Test accuracy: 84.83 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.000, Test loss: 0.958, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.331, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.156, Train accuracy: 94.500, Test loss: 0.400, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.045, Train accuracy: 98.000, Test loss: 0.337, Test accuracy: 88.00 

Round   3, Train loss: 0.021, Test loss: 0.449, Test accuracy: 86.67 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.721, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.304, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.088, Train accuracy: 97.000, Test loss: 0.392, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.053, Train accuracy: 98.500, Test loss: 0.476, Test accuracy: 83.50 

Round   4, Train loss: 0.018, Test loss: 0.458, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.743, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.071, Train accuracy: 97.000, Test loss: 0.604, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.043, Train accuracy: 99.500, Test loss: 0.387, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.081, Train accuracy: 96.500, Test loss: 0.488, Test accuracy: 81.00 

Round   5, Train loss: 0.053, Test loss: 0.520, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.217, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.311, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.424, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.068, Train accuracy: 96.500, Test loss: 0.389, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.532, Test accuracy: 83.50 

Round   6, Train loss: 0.013, Test loss: 0.529, Test accuracy: 84.83 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.727, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.097, Train accuracy: 96.000, Test loss: 1.108, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.342, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.031, Train accuracy: 99.500, Test loss: 0.387, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.168, Train accuracy: 94.500, Test loss: 0.597, Test accuracy: 80.50 

Round   7, Train loss: 0.089, Test loss: 0.538, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.188, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.322, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.508, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 0.478, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.593, Test accuracy: 86.00 

Round   8, Train loss: 0.007, Test loss: 0.516, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.815, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.133, Train accuracy: 95.500, Test loss: 1.256, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.353, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.044, Train accuracy: 98.000, Test loss: 0.414, Test accuracy: 84.00 

Round   9, Train loss: 0.059, Test loss: 0.520, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.728, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 1.028, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.408, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 0.409, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.425, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.757, Test accuracy: 83.00 

Round  10, Train loss: 0.028, Test loss: 0.540, Test accuracy: 85.33 

        train local model (freeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.733, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 1.213, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 0.467, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.058, Train accuracy: 97.500, Test loss: 0.643, Test accuracy: 84.50 

Round  11, Train loss: 0.021, Test loss: 0.510, Test accuracy: 86.33 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.793, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.000, Test loss: 1.204, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.300, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.611, Test accuracy: 83.50 

Round  12, Train loss: 0.007, Test loss: 0.575, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.832, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.228, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.448, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.505, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.049, Train accuracy: 98.500, Test loss: 0.629, Test accuracy: 84.50 

Round  13, Train loss: 0.021, Test loss: 0.538, Test accuracy: 86.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.854, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.046, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.328, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 0.583, Test accuracy: 87.00 

Round  14, Train loss: 0.012, Test loss: 0.553, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.870, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.531, Test accuracy: 88.00 

Round  15, Train loss: 0.000, Test loss: 0.541, Test accuracy: 86.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.860, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.325, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.657, Test accuracy: 86.50 

Round  16, Train loss: 0.002, Test loss: 0.577, Test accuracy: 86.83 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.837, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.936, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.102, Train accuracy: 97.000, Test loss: 0.612, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.608, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.554, Test accuracy: 87.50 

Round  17, Train loss: 0.036, Test loss: 0.605, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.148, Train accuracy: 96.000, Test loss: 0.772, Test accuracy: 84.50 

Round  18, Train loss: 0.049, Test loss: 0.529, Test accuracy: 87.17 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.748, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.107, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.480, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.275, Train accuracy: 92.000, Test loss: 0.608, Test accuracy: 84.50 

Round  19, Train loss: 0.092, Test loss: 0.514, Test accuracy: 87.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.735, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.787, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 88.50 

Final Round, Train loss: 0.002, Test loss: 0.472, Test accuracy: 89.17 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.363, Train accuracy: 83.000, Test loss: 0.519, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.753, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.169, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.365, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.412, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 87.50 

        train local model (freeze embeding):client   3,  Train loss: 0.338, Train accuracy: 87.000, Test loss: 0.426, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.055, Train accuracy: 97.000, Test loss: 0.342, Test accuracy: 91.00 

Round   0, Train loss: 0.016, Test loss: 0.453, Test accuracy: 87.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.749, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.296, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.502, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.218, Train accuracy: 91.000, Test loss: 0.482, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.265, Test accuracy: 93.50 

Round   1, Train loss: 0.009, Test loss: 0.462, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.729, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.888, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.439, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.565, Test accuracy: 87.50 

        train local model (freeze embeding):client   3,  Train loss: 0.092, Train accuracy: 98.000, Test loss: 0.343, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 0.325, Test accuracy: 91.50 

Round   2, Train loss: 0.009, Test loss: 0.479, Test accuracy: 86.12 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.790, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.918, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.476, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 87.50 

        train local model (freeze embeding):client   3,  Train loss: 0.083, Train accuracy: 97.500, Test loss: 0.318, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.082, Train accuracy: 95.500, Test loss: 0.401, Test accuracy: 87.50 

Round   3, Train loss: 0.024, Test loss: 0.502, Test accuracy: 86.62 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.754, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.316, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.472, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.115, Train accuracy: 97.000, Test loss: 0.714, Test accuracy: 82.50 

        train local model (freeze embeding):client   3,  Train loss: 0.087, Train accuracy: 95.500, Test loss: 0.398, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.096, Train accuracy: 97.000, Test loss: 0.383, Test accuracy: 88.00 

Round   4, Train loss: 0.054, Test loss: 0.486, Test accuracy: 87.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.794, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.102, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.470, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.092, Train accuracy: 96.000, Test loss: 0.426, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 0.404, Test accuracy: 91.00 

Round   5, Train loss: 0.006, Test loss: 0.485, Test accuracy: 87.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.858, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.285, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.338, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.133, Train accuracy: 95.500, Test loss: 0.553, Test accuracy: 89.50 

Round   6, Train loss: 0.034, Test loss: 0.544, Test accuracy: 86.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.893, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.428, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.360, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.329, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.669, Test accuracy: 83.00 

        train local model (freeze embeding):client   3,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 0.361, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 93.00 

Round   7, Train loss: 0.003, Test loss: 0.489, Test accuracy: 87.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.998, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.516, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.036, Train accuracy: 99.500, Test loss: 0.370, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.038, Train accuracy: 98.500, Test loss: 0.657, Test accuracy: 86.00 

Round   8, Train loss: 0.022, Test loss: 0.488, Test accuracy: 87.38 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.805, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.837, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.512, Test accuracy: 85.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.056, Train accuracy: 98.000, Test loss: 0.679, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.340, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.646, Test accuracy: 89.50 

Round   9, Train loss: 0.027, Test loss: 0.555, Test accuracy: 85.62 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.810, Test accuracy: 84.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.539, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.066, Train accuracy: 97.500, Test loss: 0.969, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.447, Test accuracy: 90.00 

Round  10, Train loss: 0.025, Test loss: 0.607, Test accuracy: 86.38 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.184, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.336, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.463, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.596, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 0.445, Test accuracy: 91.00 

Round  11, Train loss: 0.012, Test loss: 0.511, Test accuracy: 86.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.874, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.511, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.338, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.497, Test accuracy: 89.50 

Round  12, Train loss: 0.004, Test loss: 0.557, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.807, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 1.257, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.347, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.315, Test accuracy: 95.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.556, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.452, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.322, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 91.50 

Round  13, Train loss: 0.006, Test loss: 0.482, Test accuracy: 88.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.761, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.908, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.543, Test accuracy: 85.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 89.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.414, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.772, Train accuracy: 84.500, Test loss: 1.567, Test accuracy: 83.00 

Round  14, Train loss: 0.194, Test loss: 0.604, Test accuracy: 86.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.873, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.450, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 95.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.572, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.533, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 92.00 

Round  15, Train loss: 0.002, Test loss: 0.545, Test accuracy: 87.38 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.317, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.518, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.526, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.375, Test accuracy: 94.00 

Round  16, Train loss: 0.002, Test loss: 0.561, Test accuracy: 86.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.919, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.019, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.521, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.185, Train accuracy: 94.500, Test loss: 0.668, Test accuracy: 88.00 

Round  17, Train loss: 0.047, Test loss: 0.550, Test accuracy: 87.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.880, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.984, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.286, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.510, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.516, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.393, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.109, Train accuracy: 94.500, Test loss: 0.813, Test accuracy: 87.00 

Round  18, Train loss: 0.027, Test loss: 0.595, Test accuracy: 87.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.955, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.970, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.329, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.291, Test accuracy: 95.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.542, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.768, Test accuracy: 85.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.504, Test accuracy: 90.50 

Round  19, Train loss: 0.002, Test loss: 0.570, Test accuracy: 87.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.859, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.871, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.321, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.581, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.456, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 91.50 

Final Round, Train loss: 0.001, Test loss: 0.547, Test accuracy: 87.62 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.476, Train accuracy: 75.500, Test loss: 0.594, Test accuracy: 70.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.312, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.313, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.559, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.444, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.593, Test accuracy: 88.50 

        train local model (freeze embeding):client   4,  Train loss: 0.512, Train accuracy: 76.000, Test loss: 0.635, Test accuracy: 71.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.124, Train accuracy: 97.000, Test loss: 0.881, Test accuracy: 75.00 

Round   0, Train loss: 0.027, Test loss: 0.563, Test accuracy: 84.30 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.929, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.272, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.285, Test accuracy: 95.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.593, Test accuracy: 87.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.064, Train accuracy: 97.500, Test loss: 0.759, Test accuracy: 86.00 

        train local model (freeze embeding):client   4,  Train loss: 0.359, Train accuracy: 83.500, Test loss: 0.603, Test accuracy: 70.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.148, Train accuracy: 94.000, Test loss: 0.965, Test accuracy: 68.00 

Round   1, Train loss: 0.042, Test loss: 0.555, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.934, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.558, Test accuracy: 87.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.484, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.531, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.311, Train accuracy: 86.000, Test loss: 0.658, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.076, Train accuracy: 97.500, Test loss: 0.951, Test accuracy: 74.00 

Round   2, Train loss: 0.016, Test loss: 0.578, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.323, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.364, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.606, Test accuracy: 86.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.413, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 0.730, Test accuracy: 89.50 

        train local model (freeze embeding):client   4,  Train loss: 0.239, Train accuracy: 90.500, Test loss: 0.717, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.047, Train accuracy: 99.000, Test loss: 1.140, Test accuracy: 75.00 

Round   3, Train loss: 0.014, Test loss: 0.619, Test accuracy: 84.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.975, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.910, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.183, Train accuracy: 89.500, Test loss: 0.816, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.137, Train accuracy: 94.000, Test loss: 1.006, Test accuracy: 72.00 

Round   4, Train loss: 0.029, Test loss: 0.593, Test accuracy: 84.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.956, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.122, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.361, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.481, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.465, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.413, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.147, Train accuracy: 96.000, Test loss: 0.762, Test accuracy: 71.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.186, Train accuracy: 93.500, Test loss: 1.517, Test accuracy: 69.00 

Round   5, Train loss: 0.038, Test loss: 0.575, Test accuracy: 85.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.097, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.357, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.493, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.721, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.185, Train accuracy: 94.500, Test loss: 0.580, Test accuracy: 87.50 

        train local model (freeze embeding):client   4,  Train loss: 0.090, Train accuracy: 98.500, Test loss: 0.732, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.078, Train accuracy: 98.000, Test loss: 1.056, Test accuracy: 69.50 

Round   6, Train loss: 0.055, Test loss: 0.584, Test accuracy: 84.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.891, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.236, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.356, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.538, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.373, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.000, Test loss: 0.413, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.080, Train accuracy: 98.500, Test loss: 0.767, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.121, Train accuracy: 96.000, Test loss: 1.514, Test accuracy: 67.50 

Round   7, Train loss: 0.029, Test loss: 0.583, Test accuracy: 84.70 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.082, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.358, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.450, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.482, Test accuracy: 91.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.494, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.058, Train accuracy: 99.500, Test loss: 0.825, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.100, Train accuracy: 96.500, Test loss: 1.006, Test accuracy: 79.00 

Round   8, Train loss: 0.021, Test loss: 0.622, Test accuracy: 84.60 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.990, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.239, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 94.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.464, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.161, Train accuracy: 95.500, Test loss: 0.933, Test accuracy: 80.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 0.597, Test accuracy: 89.00 

        train local model (freeze embeding):client   4,  Train loss: 0.052, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.060, Train accuracy: 97.500, Test loss: 1.374, Test accuracy: 76.50 

Round   9, Train loss: 0.049, Test loss: 0.596, Test accuracy: 84.20 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.979, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.389, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.423, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.437, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.085, Train accuracy: 96.000, Test loss: 0.723, Test accuracy: 88.00 

        train local model (freeze embeding):client   4,  Train loss: 0.046, Train accuracy: 98.500, Test loss: 0.891, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.304, Train accuracy: 89.000, Test loss: 2.049, Test accuracy: 61.50 

Round  10, Train loss: 0.079, Test loss: 0.610, Test accuracy: 85.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.095, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.337, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.479, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.044, Train accuracy: 98.000, Test loss: 0.607, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.386, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 99.500, Test loss: 0.424, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.964, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.033, Train accuracy: 98.000, Test loss: 1.631, Test accuracy: 67.50 

Round  11, Train loss: 0.017, Test loss: 0.630, Test accuracy: 84.30 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.962, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.378, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.352, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.530, Test accuracy: 88.50 

        train local model (freeze embeding):client   3,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.418, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.032, Train accuracy: 98.500, Test loss: 0.693, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.039, Train accuracy: 99.500, Test loss: 1.064, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.089, Train accuracy: 96.000, Test loss: 1.505, Test accuracy: 67.50 

Round  12, Train loss: 0.025, Test loss: 0.666, Test accuracy: 84.20 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.036, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.503, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.181, Train accuracy: 90.000, Test loss: 1.190, Test accuracy: 73.00 

Round  13, Train loss: 0.038, Test loss: 0.607, Test accuracy: 84.80 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.158, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.367, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.247, Train accuracy: 93.500, Test loss: 0.911, Test accuracy: 80.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.427, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.513, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.969, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.189, Train accuracy: 95.500, Test loss: 1.736, Test accuracy: 71.00 

Round  14, Train loss: 0.087, Test loss: 0.633, Test accuracy: 84.40 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.233, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.405, Test accuracy: 88.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.535, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.017, Train accuracy: 100.000, Test loss: 1.078, Test accuracy: 70.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.065, Train accuracy: 97.000, Test loss: 1.476, Test accuracy: 76.00 

Round  15, Train loss: 0.014, Test loss: 0.699, Test accuracy: 83.60 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.075, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 98.500, Test loss: 1.813, Test accuracy: 72.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.293, Test accuracy: 94.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.647, Test accuracy: 88.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.460, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.769, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 99.000, Test loss: 1.189, Test accuracy: 73.50 

Round  16, Train loss: 0.018, Test loss: 0.631, Test accuracy: 85.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.052, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.509, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.309, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.362, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.577, Test accuracy: 87.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.413, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 95.00 

        train local model (freeze embeding):client   4,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.180, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.041, Train accuracy: 99.000, Test loss: 1.428, Test accuracy: 75.00 

Round  17, Train loss: 0.012, Test loss: 0.616, Test accuracy: 85.40 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.059, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.488, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.402, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.436, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 1.005, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 1.653, Test accuracy: 70.50 

Round  18, Train loss: 0.006, Test loss: 0.647, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.015, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.335, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.348, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.424, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 0.502, Test accuracy: 88.00 

        train local model (freeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.100, Test accuracy: 72.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.045, Train accuracy: 98.000, Test loss: 1.585, Test accuracy: 72.00 

Round  19, Train loss: 0.015, Test loss: 0.660, Test accuracy: 84.10 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.985, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.349, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 90.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.398, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.399, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.203, Test accuracy: 74.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.079, Test accuracy: 74.00 

Final Round, Train loss: 0.002, Test loss: 0.657, Test accuracy: 84.10 

Average accuracy final 10 rounds: 418.9616666666667 

2475.1227555274963
[7.605195760726929, 15.3624906539917, 22.62748408317566, 30.073588371276855, 37.631412982940674, 45.39073085784912, 52.52760624885559, 60.15827465057373, 67.27387070655823, 74.8487753868103, 82.27536511421204, 90.29756331443787, 97.99883389472961, 105.47477674484253, 113.15976333618164, 120.64131832122803, 128.72249841690063, 136.24157977104187, 144.06883263587952, 151.51653289794922, 155.9720642566681, 163.84374451637268, 171.7980146408081, 179.31148529052734, 187.4561414718628, 195.06125903129578, 202.61603045463562, 210.4343614578247, 218.18661046028137, 225.7579481601715, 233.5882692337036, 241.7786967754364, 249.49952578544617, 257.0164053440094, 264.47849011421204, 272.1647582054138, 279.96185660362244, 287.7932538986206, 295.45578169822693, 303.3915057182312, 311.0218369960785, 315.33359694480896, 322.8995101451874, 330.4660875797272, 338.64949345588684, 346.1192708015442, 354.4259400367737, 362.07352447509766, 369.63401770591736, 377.3155634403229, 385.06030678749084, 393.00444078445435, 400.9208550453186, 408.5656635761261, 416.41039180755615, 423.9645457267761, 431.94462513923645, 439.5840587615967, 447.4294455051422, 455.3414993286133, 463.528244972229, 471.21522331237793, 475.56492280960083, 483.45053815841675, 491.3100380897522, 499.4501442909241, 507.38530445098877, 515.1057040691376, 523.1043722629547, 531.1362993717194, 539.0118978023529, 546.7841002941132, 554.7306444644928, 562.737343788147, 570.5089354515076, 578.286545753479, 586.1940059661865, 593.6863024234772, 601.9176239967346, 609.3519222736359, 617.3399181365967, 624.8225662708282, 632.8674032688141, 637.8008298873901, 646.1104516983032, 654.0828776359558, 661.9844057559967, 669.7829566001892, 677.3902025222778, 685.2228169441223, 693.2975251674652, 701.2304637432098, 708.9010992050171, 716.6470427513123, 724.295328617096, 732.0145902633667, 739.7130794525146, 747.8352143764496, 755.6261301040649, 763.4543766975403, 771.2819535732269, 779.4059641361237, 787.4665086269379, 795.008026599884, 800.1622507572174]
[77.5, 75.5, 74.5, 72.5, 76.5, 71.5, 79.0, 75.5, 72.0, 81.0, 73.0, 78.5, 71.5, 77.5, 79.0, 74.0, 76.5, 77.0, 80.5, 73.5, 77.5, 80.25, 74.0, 81.25, 83.0, 82.75, 81.0, 84.25, 84.5, 85.25, 84.5, 86.0, 84.25, 84.5, 84.75, 86.25, 84.25, 82.0, 84.75, 86.25, 84.5, 86.0, 85.66666666666667, 84.0, 84.83333333333333, 86.66666666666667, 85.66666666666667, 85.33333333333333, 84.83333333333333, 85.66666666666667, 86.0, 86.5, 85.33333333333333, 86.33333333333333, 85.66666666666667, 86.66666666666667, 87.5, 86.83333333333333, 86.83333333333333, 85.66666666666667, 87.16666666666667, 87.66666666666667, 89.16666666666667, 87.5, 87.25, 86.125, 86.625, 87.125, 87.125, 86.625, 87.125, 87.375, 85.625, 86.375, 86.75, 86.5, 88.125, 86.0, 87.375, 86.625, 87.125, 87.25, 87.125, 87.625, 84.3, 85.0, 84.0, 84.1, 84.3, 85.2, 84.2, 84.7, 84.6, 84.2, 85.3, 84.3, 84.2, 84.8, 84.4, 83.6, 85.1, 85.4, 85.0, 84.1, 84.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.552, Test loss: 0.484, Test accuracy: 83.60 

Round   0, Global train loss: 0.552, Global test loss: 0.701, Global test accuracy: 52.00 

Round   1, Train loss: 0.343, Test loss: 0.373, Test accuracy: 87.70 

Round   1, Global train loss: 0.343, Global test loss: 0.859, Global test accuracy: 50.00 

Round   2, Train loss: 0.276, Test loss: 0.442, Test accuracy: 84.80 

Round   2, Global train loss: 0.276, Global test loss: 0.915, Global test accuracy: 50.00 

Round   3, Train loss: 0.240, Test loss: 0.363, Test accuracy: 89.70 

Round   3, Global train loss: 0.240, Global test loss: 0.814, Global test accuracy: 50.00 

Round   4, Train loss: 0.222, Test loss: 0.518, Test accuracy: 87.70 

Round   4, Global train loss: 0.222, Global test loss: 0.812, Global test accuracy: 50.00 

Round   5, Train loss: 0.166, Test loss: 0.422, Test accuracy: 87.40 

Round   5, Global train loss: 0.166, Global test loss: 0.843, Global test accuracy: 50.00 

Round   6, Train loss: 0.143, Test loss: 0.429, Test accuracy: 87.00 

Round   6, Global train loss: 0.143, Global test loss: 0.885, Global test accuracy: 50.00 

Round   7, Train loss: 0.112, Test loss: 0.474, Test accuracy: 87.40 

Round   7, Global train loss: 0.112, Global test loss: 0.881, Global test accuracy: 50.00 

Round   8, Train loss: 0.116, Test loss: 0.391, Test accuracy: 90.60 

Round   8, Global train loss: 0.116, Global test loss: 0.872, Global test accuracy: 50.00 

Round   9, Train loss: 0.091, Test loss: 0.495, Test accuracy: 89.20 

Round   9, Global train loss: 0.091, Global test loss: 1.058, Global test accuracy: 50.00 

Round  10, Train loss: 0.085, Test loss: 0.737, Test accuracy: 84.50 

Round  10, Global train loss: 0.085, Global test loss: 0.988, Global test accuracy: 50.00 

Round  11, Train loss: 0.107, Test loss: 0.362, Test accuracy: 90.70 

Round  11, Global train loss: 0.107, Global test loss: 1.081, Global test accuracy: 50.00 

Round  12, Train loss: 0.077, Test loss: 0.418, Test accuracy: 90.80 

Round  12, Global train loss: 0.077, Global test loss: 1.000, Global test accuracy: 50.00 

Round  13, Train loss: 0.060, Test loss: 0.430, Test accuracy: 90.00 

Round  13, Global train loss: 0.060, Global test loss: 1.014, Global test accuracy: 50.00 

Round  14, Train loss: 0.053, Test loss: 0.405, Test accuracy: 89.20 

Round  14, Global train loss: 0.053, Global test loss: 0.997, Global test accuracy: 50.00 

Round  15, Train loss: 0.041, Test loss: 0.452, Test accuracy: 90.70 

Round  15, Global train loss: 0.041, Global test loss: 1.082, Global test accuracy: 50.00 

Round  16, Train loss: 0.063, Test loss: 0.440, Test accuracy: 88.30 

Round  16, Global train loss: 0.063, Global test loss: 1.113, Global test accuracy: 50.00 

Round  17, Train loss: 0.042, Test loss: 0.479, Test accuracy: 89.10 

Round  17, Global train loss: 0.042, Global test loss: 1.191, Global test accuracy: 50.00 

Round  18, Train loss: 0.052, Test loss: 0.427, Test accuracy: 87.90 

Round  18, Global train loss: 0.052, Global test loss: 0.970, Global test accuracy: 50.00 

Round  19, Train loss: 0.030, Test loss: 0.381, Test accuracy: 90.50 

Round  19, Global train loss: 0.030, Global test loss: 1.091, Global test accuracy: 50.00 

Round  20, Train loss: 0.032, Test loss: 0.427, Test accuracy: 90.40 

Round  20, Global train loss: 0.032, Global test loss: 1.072, Global test accuracy: 50.00 

Round  21, Train loss: 0.041, Test loss: 0.428, Test accuracy: 89.60 

Round  21, Global train loss: 0.041, Global test loss: 1.093, Global test accuracy: 50.00 

Round  22, Train loss: 0.021, Test loss: 0.419, Test accuracy: 91.10 

Round  22, Global train loss: 0.021, Global test loss: 1.252, Global test accuracy: 50.00 

Round  23, Train loss: 0.012, Test loss: 0.403, Test accuracy: 91.80 

Round  23, Global train loss: 0.012, Global test loss: 1.209, Global test accuracy: 50.00 

Round  24, Train loss: 0.046, Test loss: 0.439, Test accuracy: 90.60 

Round  24, Global train loss: 0.046, Global test loss: 1.040, Global test accuracy: 50.00 

Round  25, Train loss: 0.024, Test loss: 0.401, Test accuracy: 91.60 

Round  25, Global train loss: 0.024, Global test loss: 1.137, Global test accuracy: 50.00 

Round  26, Train loss: 0.024, Test loss: 0.446, Test accuracy: 91.20 

Round  26, Global train loss: 0.024, Global test loss: 1.217, Global test accuracy: 50.00 

Round  27, Train loss: 0.011, Test loss: 0.501, Test accuracy: 90.00 

Round  27, Global train loss: 0.011, Global test loss: 1.265, Global test accuracy: 50.00 

Round  28, Train loss: 0.020, Test loss: 0.462, Test accuracy: 90.20 

Round  28, Global train loss: 0.020, Global test loss: 1.241, Global test accuracy: 50.00 

Round  29, Train loss: 0.027, Test loss: 0.402, Test accuracy: 90.10 

Round  29, Global train loss: 0.027, Global test loss: 1.038, Global test accuracy: 50.00 

Round  30, Train loss: 0.014, Test loss: 0.480, Test accuracy: 88.20 

Round  30, Global train loss: 0.014, Global test loss: 1.112, Global test accuracy: 50.00 

Round  31, Train loss: 0.019, Test loss: 0.456, Test accuracy: 91.00 

Round  31, Global train loss: 0.019, Global test loss: 1.276, Global test accuracy: 50.00 

Round  32, Train loss: 0.016, Test loss: 0.438, Test accuracy: 91.10 

Round  32, Global train loss: 0.016, Global test loss: 1.293, Global test accuracy: 50.00 

Round  33, Train loss: 0.004, Test loss: 0.458, Test accuracy: 91.00 

Round  33, Global train loss: 0.004, Global test loss: 1.384, Global test accuracy: 50.00 

Round  34, Train loss: 0.009, Test loss: 0.488, Test accuracy: 91.20 

Round  34, Global train loss: 0.009, Global test loss: 1.302, Global test accuracy: 50.00 

Final Round, Train loss: 0.006, Test loss: 0.445, Test accuracy: 91.30 

Final Round, Global train loss: 0.006, Global test loss: 1.302, Global test accuracy: 50.00 

Average accuracy final 10 rounds: 90.56 

Average global accuracy final 10 rounds: 50.0 

594.0814137458801
[8.702467441558838, 11.410030126571655, 14.179051637649536, 16.958858251571655, 19.69211483001709, 22.4199435710907, 25.153571605682373, 27.97272777557373, 30.815521001815796, 33.65510392189026, 36.297494411468506, 39.21811580657959, 41.92388844490051, 44.73634433746338, 47.462488889694214, 50.19408082962036, 52.90517973899841, 55.66642880439758, 58.407840728759766, 61.30178451538086, 64.06675386428833, 66.76907110214233, 69.48633432388306, 72.23345160484314, 74.89637637138367, 77.70863652229309, 80.39624214172363, 83.10805201530457, 85.8582398891449, 88.67304730415344, 91.52753639221191, 94.28607964515686, 97.0098397731781, 99.63135290145874, 102.3644003868103, 107.8654556274414]
[83.6, 87.7, 84.8, 89.7, 87.7, 87.4, 87.0, 87.4, 90.6, 89.2, 84.5, 90.7, 90.8, 90.0, 89.2, 90.7, 88.3, 89.1, 87.9, 90.5, 90.4, 89.6, 91.1, 91.8, 90.6, 91.6, 91.2, 90.0, 90.2, 90.1, 88.2, 91.0, 91.1, 91.0, 91.2, 91.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 35, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedavg
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
[]
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.538, Test loss: 0.451, Test accuracy: 83.30 

Round   0, Global train loss: 0.538, Global test loss: 0.651, Global test accuracy: 64.80 

Round   1, Train loss: 0.470, Test loss: 0.367, Test accuracy: 84.80 

Round   1, Global train loss: 0.470, Global test loss: 0.667, Global test accuracy: 65.30 

Round   2, Train loss: 0.413, Test loss: 0.388, Test accuracy: 85.90 

Round   2, Global train loss: 0.413, Global test loss: 0.730, Global test accuracy: 65.00 

Round   3, Train loss: 0.387, Test loss: 0.311, Test accuracy: 87.70 

Round   3, Global train loss: 0.387, Global test loss: 0.683, Global test accuracy: 67.00 

Round   4, Train loss: 0.356, Test loss: 0.411, Test accuracy: 81.90 

Round   4, Global train loss: 0.356, Global test loss: 0.706, Global test accuracy: 66.00 

Round   5, Train loss: 0.338, Test loss: 0.353, Test accuracy: 85.70 

Round   5, Global train loss: 0.338, Global test loss: 0.667, Global test accuracy: 66.70 

Round   6, Train loss: 0.302, Test loss: 0.754, Test accuracy: 84.70 

Round   6, Global train loss: 0.302, Global test loss: 0.636, Global test accuracy: 67.00 

Round   7, Train loss: 0.275, Test loss: 0.301, Test accuracy: 90.30 

Round   7, Global train loss: 0.275, Global test loss: 0.689, Global test accuracy: 68.20 

Round   8, Train loss: 0.273, Test loss: 0.264, Test accuracy: 90.30 

Round   8, Global train loss: 0.273, Global test loss: 0.659, Global test accuracy: 71.90 

Round   9, Train loss: 0.246, Test loss: 0.254, Test accuracy: 90.50 

Round   9, Global train loss: 0.246, Global test loss: 0.651, Global test accuracy: 70.20 

Round  10, Train loss: 0.256, Test loss: 0.281, Test accuracy: 89.20 

Round  10, Global train loss: 0.256, Global test loss: 0.663, Global test accuracy: 70.70 

Round  11, Train loss: 0.230, Test loss: 0.414, Test accuracy: 88.90 

Round  11, Global train loss: 0.230, Global test loss: 0.649, Global test accuracy: 70.90 

Round  12, Train loss: 0.225, Test loss: 0.292, Test accuracy: 90.00 

Round  12, Global train loss: 0.225, Global test loss: 0.672, Global test accuracy: 70.60 

Round  13, Train loss: 0.211, Test loss: 0.446, Test accuracy: 89.80 

Round  13, Global train loss: 0.211, Global test loss: 0.690, Global test accuracy: 71.50 

Round  14, Train loss: 0.209, Test loss: 0.303, Test accuracy: 91.00 

Round  14, Global train loss: 0.209, Global test loss: 0.640, Global test accuracy: 70.30 

Round  15, Train loss: 0.179, Test loss: 0.306, Test accuracy: 90.60 

Round  15, Global train loss: 0.179, Global test loss: 0.677, Global test accuracy: 72.10 

Round  16, Train loss: 0.173, Test loss: 0.359, Test accuracy: 90.10 

Round  16, Global train loss: 0.173, Global test loss: 0.685, Global test accuracy: 70.90 

Round  17, Train loss: 0.178, Test loss: 0.376, Test accuracy: 89.00 

Round  17, Global train loss: 0.178, Global test loss: 0.773, Global test accuracy: 72.80 

Round  18, Train loss: 0.149, Test loss: 0.377, Test accuracy: 90.00 

Round  18, Global train loss: 0.149, Global test loss: 0.701, Global test accuracy: 70.30 

Round  19, Train loss: 0.162, Test loss: 0.489, Test accuracy: 88.30 

Round  19, Global train loss: 0.162, Global test loss: 0.721, Global test accuracy: 70.20 

Round  20, Train loss: 0.147, Test loss: 0.320, Test accuracy: 90.10 

Round  20, Global train loss: 0.147, Global test loss: 0.667, Global test accuracy: 70.70 

Round  21, Train loss: 0.161, Test loss: 0.324, Test accuracy: 90.50 

Round  21, Global train loss: 0.161, Global test loss: 0.773, Global test accuracy: 71.00 

Round  22, Train loss: 0.119, Test loss: 0.496, Test accuracy: 88.30 

Round  22, Global train loss: 0.119, Global test loss: 0.750, Global test accuracy: 71.10 

Round  23, Train loss: 0.134, Test loss: 0.328, Test accuracy: 90.90 

Round  23, Global train loss: 0.134, Global test loss: 0.775, Global test accuracy: 69.70 

Round  24, Train loss: 0.123, Test loss: 0.423, Test accuracy: 89.70 

Round  24, Global train loss: 0.123, Global test loss: 0.789, Global test accuracy: 70.60 

Round  25, Train loss: 0.101, Test loss: 0.383, Test accuracy: 90.20 

Round  25, Global train loss: 0.101, Global test loss: 0.796, Global test accuracy: 70.30 

Round  26, Train loss: 0.117, Test loss: 0.323, Test accuracy: 90.60 

Round  26, Global train loss: 0.117, Global test loss: 0.781, Global test accuracy: 71.50 

Round  27, Train loss: 0.116, Test loss: 0.309, Test accuracy: 90.60 

Round  27, Global train loss: 0.116, Global test loss: 0.677, Global test accuracy: 72.30 

Round  28, Train loss: 0.091, Test loss: 0.314, Test accuracy: 90.90 

Round  28, Global train loss: 0.091, Global test loss: 0.715, Global test accuracy: 71.80 

Round  29, Train loss: 0.094, Test loss: 0.540, Test accuracy: 86.90 

Round  29, Global train loss: 0.094, Global test loss: 0.764, Global test accuracy: 69.90 

Round  30, Train loss: 0.097, Test loss: 0.321, Test accuracy: 91.70 

Round  30, Global train loss: 0.097, Global test loss: 0.737, Global test accuracy: 71.30 

Round  31, Train loss: 0.088, Test loss: 0.445, Test accuracy: 87.30 

Round  31, Global train loss: 0.088, Global test loss: 0.708, Global test accuracy: 71.30 

Round  32, Train loss: 0.064, Test loss: 0.323, Test accuracy: 91.40 

Round  32, Global train loss: 0.064, Global test loss: 0.771, Global test accuracy: 72.10 

Round  33, Train loss: 0.086, Test loss: 0.460, Test accuracy: 87.80 

Round  33, Global train loss: 0.086, Global test loss: 0.669, Global test accuracy: 72.70 

Round  34, Train loss: 0.078, Test loss: 0.411, Test accuracy: 88.30 

Round  34, Global train loss: 0.078, Global test loss: 0.803, Global test accuracy: 70.70 

Final Round, Train loss: 0.077, Test loss: 0.375, Test accuracy: 90.80 

Final Round, Global train loss: 0.077, Global test loss: 0.803, Global test accuracy: 70.70 

Average accuracy final 10 rounds: 89.57000000000001 

Average global accuracy final 10 rounds: 71.39000000000001 

597.2632555961609
[8.783314228057861, 11.562445163726807, 14.344982624053955, 17.167664527893066, 19.992266416549683, 22.713441371917725, 25.43025016784668, 28.253018379211426, 31.00036883354187, 33.64553666114807, 36.43585658073425, 39.20417857170105, 42.1122043132782, 44.860658168792725, 47.62308120727539, 50.414223194122314, 53.248274087905884, 56.00091791152954, 58.65280485153198, 61.376325845718384, 64.11550068855286, 66.87749290466309, 69.68359208106995, 72.48783540725708, 75.66183257102966, 78.41421747207642, 81.24387621879578, 84.01338911056519, 86.78510093688965, 89.53138184547424, 92.29296350479126, 95.02395582199097, 97.75212860107422, 100.49700880050659, 103.30104207992554, 108.81383013725281]
[83.3, 84.8, 85.9, 87.7, 81.9, 85.7, 84.7, 90.3, 90.3, 90.5, 89.2, 88.9, 90.0, 89.8, 91.0, 90.6, 90.1, 89.0, 90.0, 88.3, 90.1, 90.5, 88.3, 90.9, 89.7, 90.2, 90.6, 90.6, 90.9, 86.9, 91.7, 87.3, 91.4, 87.8, 88.3, 90.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedrep  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 0.674, Test loss: 0.916, Test accuracy: 53.50 

Round   1, Train loss: 0.543, Test loss: 1.049, Test accuracy: 56.70 

Round   2, Train loss: 0.499, Test loss: 0.715, Test accuracy: 68.10 

Round   3, Train loss: 0.443, Test loss: 0.520, Test accuracy: 74.20 

Round   4, Train loss: 0.388, Test loss: 0.404, Test accuracy: 81.30 

Round   5, Train loss: 0.380, Test loss: 0.378, Test accuracy: 83.30 

Round   6, Train loss: 0.369, Test loss: 0.392, Test accuracy: 85.10 

Round   7, Train loss: 0.359, Test loss: 0.512, Test accuracy: 76.60 

Round   8, Train loss: 0.333, Test loss: 0.333, Test accuracy: 85.20 

Round   9, Train loss: 0.326, Test loss: 0.365, Test accuracy: 84.00 

Round  10, Train loss: 0.296, Test loss: 0.311, Test accuracy: 85.80 

Round  11, Train loss: 0.275, Test loss: 0.286, Test accuracy: 87.80 

Round  12, Train loss: 0.276, Test loss: 0.278, Test accuracy: 88.70 

Round  13, Train loss: 0.283, Test loss: 0.453, Test accuracy: 80.90 

Round  14, Train loss: 0.238, Test loss: 0.327, Test accuracy: 87.90 

Round  15, Train loss: 0.251, Test loss: 0.307, Test accuracy: 89.50 

Round  16, Train loss: 0.218, Test loss: 0.269, Test accuracy: 89.60 

Round  17, Train loss: 0.203, Test loss: 0.250, Test accuracy: 90.20 

Round  18, Train loss: 0.187, Test loss: 0.266, Test accuracy: 89.10 

Round  19, Train loss: 0.210, Test loss: 0.249, Test accuracy: 89.90 

Round  20, Train loss: 0.173, Test loss: 0.252, Test accuracy: 91.00 

Round  21, Train loss: 0.187, Test loss: 0.337, Test accuracy: 88.60 

Round  22, Train loss: 0.177, Test loss: 0.252, Test accuracy: 89.70 

Round  23, Train loss: 0.158, Test loss: 0.251, Test accuracy: 90.70 

Round  24, Train loss: 0.145, Test loss: 0.295, Test accuracy: 89.70 

Round  25, Train loss: 0.133, Test loss: 0.236, Test accuracy: 90.70 

Round  26, Train loss: 0.142, Test loss: 0.302, Test accuracy: 89.30 

Round  27, Train loss: 0.113, Test loss: 0.268, Test accuracy: 89.60 

Round  28, Train loss: 0.126, Test loss: 0.278, Test accuracy: 90.60 

Round  29, Train loss: 0.140, Test loss: 0.292, Test accuracy: 89.50 

Round  30, Train loss: 0.114, Test loss: 0.270, Test accuracy: 91.70 

Round  31, Train loss: 0.091, Test loss: 0.268, Test accuracy: 90.90 

Round  32, Train loss: 0.099, Test loss: 0.278, Test accuracy: 91.50 

Round  33, Train loss: 0.091, Test loss: 0.276, Test accuracy: 90.20 

Round  34, Train loss: 0.080, Test loss: 0.286, Test accuracy: 90.70 

Round  35, Train loss: 0.090, Test loss: 0.271, Test accuracy: 91.10 

Round  36, Train loss: 0.090, Test loss: 0.275, Test accuracy: 90.30 

Round  37, Train loss: 0.090, Test loss: 0.277, Test accuracy: 90.90 

Round  38, Train loss: 0.085, Test loss: 0.276, Test accuracy: 91.20 

Round  39, Train loss: 0.072, Test loss: 0.282, Test accuracy: 90.60 

Round  40, Train loss: 0.066, Test loss: 0.279, Test accuracy: 91.10 

Round  41, Train loss: 0.053, Test loss: 0.283, Test accuracy: 91.30 

Round  42, Train loss: 0.056, Test loss: 0.302, Test accuracy: 91.00 

Round  43, Train loss: 0.046, Test loss: 0.292, Test accuracy: 91.60 

Round  44, Train loss: 0.053, Test loss: 0.281, Test accuracy: 91.10 

Round  45, Train loss: 0.038, Test loss: 0.291, Test accuracy: 92.00 

Round  46, Train loss: 0.058, Test loss: 0.302, Test accuracy: 91.30 

Round  47, Train loss: 0.066, Test loss: 0.281, Test accuracy: 90.80 

Round  48, Train loss: 0.052, Test loss: 0.283, Test accuracy: 90.80 

Round  49, Train loss: 0.038, Test loss: 0.315, Test accuracy: 90.60 

Final Round, Train loss: 0.028, Test loss: 0.309, Test accuracy: 90.80 

Average accuracy final 10 rounds: 91.16 

606.5340695381165
[7.99664831161499, 10.086795806884766, 12.275632381439209, 14.408143997192383, 16.56453537940979, 18.757887601852417, 21.031039714813232, 23.19981813430786, 25.39603877067566, 27.623584270477295, 29.832993268966675, 32.12833619117737, 34.33748769760132, 36.51817464828491, 38.669081926345825, 40.94135141372681, 43.080281496047974, 45.16640329360962, 47.42796993255615, 49.690120458602905, 51.85296940803528, 54.04928374290466, 56.22413945198059, 58.449864864349365, 60.55282664299011, 62.81919622421265, 64.89022374153137, 66.95732975006104, 69.21838712692261, 71.3562707901001, 73.48928451538086, 75.79535174369812, 77.84882736206055, 79.96367597579956, 82.15731644630432, 84.2581033706665, 86.54751753807068, 88.65618348121643, 90.87836718559265, 93.03389430046082, 95.17504930496216, 97.42873549461365, 99.62997794151306, 101.7712950706482, 103.94585299491882, 106.09766221046448, 108.34483313560486, 110.56307244300842, 112.69351267814636, 114.80781626701355, 117.24129295349121]
[53.5, 56.7, 68.1, 74.2, 81.3, 83.3, 85.1, 76.6, 85.2, 84.0, 85.8, 87.8, 88.7, 80.9, 87.9, 89.5, 89.6, 90.2, 89.1, 89.9, 91.0, 88.6, 89.7, 90.7, 89.7, 90.7, 89.3, 89.6, 90.6, 89.5, 91.7, 90.9, 91.5, 90.2, 90.7, 91.1, 90.3, 90.9, 91.2, 90.6, 91.1, 91.3, 91.0, 91.6, 91.1, 92.0, 91.3, 90.8, 90.8, 90.6, 90.8]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 50, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478)
learning rate, batch size: 0.01, 10
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
Round   0, Train loss: 0.675, Test loss: 0.918, Test accuracy: 60.00
Round   1, Train loss: 0.561, Test loss: 0.948, Test accuracy: 57.70
Round   2, Train loss: 0.495, Test loss: 0.787, Test accuracy: 62.40
Round   3, Train loss: 0.477, Test loss: 0.689, Test accuracy: 68.30
Round   4, Train loss: 0.414, Test loss: 0.469, Test accuracy: 80.80
Round   5, Train loss: 0.365, Test loss: 0.443, Test accuracy: 79.40
Round   6, Train loss: 0.369, Test loss: 0.604, Test accuracy: 79.20
Round   7, Train loss: 0.357, Test loss: 0.393, Test accuracy: 82.90
Round   8, Train loss: 0.331, Test loss: 0.342, Test accuracy: 86.10
Round   9, Train loss: 0.306, Test loss: 0.579, Test accuracy: 81.60
Round  10, Train loss: 0.312, Test loss: 0.299, Test accuracy: 88.50
Round  11, Train loss: 0.300, Test loss: 0.257, Test accuracy: 89.40
Round  12, Train loss: 0.264, Test loss: 0.288, Test accuracy: 88.70
Round  13, Train loss: 0.251, Test loss: 0.263, Test accuracy: 89.40
Round  14, Train loss: 0.246, Test loss: 0.271, Test accuracy: 89.00
Round  15, Train loss: 0.233, Test loss: 0.245, Test accuracy: 90.50
Round  16, Train loss: 0.208, Test loss: 0.262, Test accuracy: 89.20
Round  17, Train loss: 0.205, Test loss: 0.261, Test accuracy: 90.40
Round  18, Train loss: 0.185, Test loss: 0.285, Test accuracy: 89.30
Round  19, Train loss: 0.184, Test loss: 0.271, Test accuracy: 88.60
Round  20, Train loss: 0.169, Test loss: 0.259, Test accuracy: 90.80
Round  21, Train loss: 0.180, Test loss: 0.225, Test accuracy: 90.70
Round  22, Train loss: 0.154, Test loss: 0.294, Test accuracy: 89.10
Round  23, Train loss: 0.159, Test loss: 0.244, Test accuracy: 90.80
Round  24, Train loss: 0.137, Test loss: 0.304, Test accuracy: 88.50
Round  25, Train loss: 0.147, Test loss: 0.264, Test accuracy: 89.60
Round  26, Train loss: 0.121, Test loss: 0.243, Test accuracy: 90.80
Round  27, Train loss: 0.117, Test loss: 0.272, Test accuracy: 90.40
Round  28, Train loss: 0.120, Test loss: 0.260, Test accuracy: 90.10
Round  29, Train loss: 0.117, Test loss: 0.256, Test accuracy: 91.00
Round  30, Train loss: 0.095, Test loss: 0.256, Test accuracy: 90.60
Round  31, Train loss: 0.101, Test loss: 0.260, Test accuracy: 90.90
Round  32, Train loss: 0.088, Test loss: 0.280, Test accuracy: 90.10
Round  33, Train loss: 0.074, Test loss: 0.256, Test accuracy: 90.30
Round  34, Train loss: 0.073, Test loss: 0.258, Test accuracy: 91.50
Round  35, Train loss: 0.091, Test loss: 0.262, Test accuracy: 90.40
Round  36, Train loss: 0.067, Test loss: 0.255, Test accuracy: 91.60
Round  37, Train loss: 0.060, Test loss: 0.244, Test accuracy: 91.60
Round  38, Train loss: 0.074, Test loss: 0.253, Test accuracy: 91.30
Round  39, Train loss: 0.075, Test loss: 0.255, Test accuracy: 90.40
Round  40, Train loss: 0.069, Test loss: 0.241, Test accuracy: 91.50
Round  41, Train loss: 0.047, Test loss: 0.247, Test accuracy: 91.80
Round  42, Train loss: 0.057, Test loss: 0.262, Test accuracy: 91.70
Round  43, Train loss: 0.033, Test loss: 0.253, Test accuracy: 91.40
Round  44, Train loss: 0.055, Test loss: 0.258, Test accuracy: 91.20
Round  45, Train loss: 0.038, Test loss: 0.257, Test accuracy: 91.90
Round  46, Train loss: 0.032, Test loss: 0.247, Test accuracy: 91.90
Round  47, Train loss: 0.032, Test loss: 0.252, Test accuracy: 91.80
Round  48, Train loss: 0.032, Test loss: 0.265, Test accuracy: 91.10
Round  49, Train loss: 0.032, Test loss: 0.267, Test accuracy: 91.70
Final Round, Train loss: 0.024, Test loss: 0.274, Test accuracy: 91.50
Average accuracy final 10 rounds: 91.6
714.3565309047699
[8.553197383880615, 11.277876377105713, 13.890225172042847, 16.78780484199524, 19.3202805519104, 22.143775463104248, 24.621224641799927, 27.352936267852783, 30.12699317932129, 32.68330454826355, 35.420817852020264, 38.17082667350769, 40.70392036437988, 43.531960248947144, 46.50591516494751, 49.12644290924072, 51.691468238830566, 54.548062324523926, 57.11751127243042, 59.68371891975403, 62.21454906463623, 64.87447214126587, 67.66311621665955, 70.3812038898468, 73.015634059906, 75.59320259094238, 78.15652680397034, 80.7390468120575, 83.3441870212555, 85.96540307998657, 88.47520732879639, 91.05603170394897, 93.6487307548523, 96.30568838119507, 98.96998929977417, 101.46260619163513, 103.95818424224854, 106.71346497535706, 109.29868698120117, 111.94202208518982, 114.62868189811707, 117.12712359428406, 119.66334962844849, 122.21079158782959, 124.93163537979126, 127.5468521118164, 130.16598963737488, 132.86669373512268, 135.52204012870789, 138.32933449745178, 140.8387885093689]
[60.0, 57.7, 62.4, 68.3, 80.8, 79.4, 79.2, 82.9, 86.1, 81.6, 88.5, 89.4, 88.7, 89.4, 89.0, 90.5, 89.2, 90.4, 89.3, 88.6, 90.8, 90.7, 89.1, 90.8, 88.5, 89.6, 90.8, 90.4, 90.1, 91.0, 90.6, 90.9, 90.1, 90.3, 91.5, 90.4, 91.6, 91.6, 91.3, 90.4, 91.5, 91.8, 91.7, 91.4, 91.2, 91.9, 91.9, 91.8, 91.1, 91.7, 91.5]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedIncrement%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 20, shard_per_user: 2, limit_local_output: 1, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
fedrep
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): BatchNorm2d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=2, bias=True)
)
odict_keys(['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias'])
122
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked']
['conv1.weight', 'bn1.weight', 'bn1.bias', 'bn1.running_mean', 'bn1.running_var', 'bn1.num_batches_tracked', 'layer1.0.conv1.weight', 'layer1.0.bn1.weight', 'layer1.0.bn1.bias', 'layer1.0.bn1.running_mean', 'layer1.0.bn1.running_var', 'layer1.0.bn1.num_batches_tracked', 'layer1.0.conv2.weight', 'layer1.0.bn2.weight', 'layer1.0.bn2.bias', 'layer1.0.bn2.running_mean', 'layer1.0.bn2.running_var', 'layer1.0.bn2.num_batches_tracked', 'layer1.1.conv1.weight', 'layer1.1.bn1.weight', 'layer1.1.bn1.bias', 'layer1.1.bn1.running_mean', 'layer1.1.bn1.running_var', 'layer1.1.bn1.num_batches_tracked', 'layer1.1.conv2.weight', 'layer1.1.bn2.weight', 'layer1.1.bn2.bias', 'layer1.1.bn2.running_mean', 'layer1.1.bn2.running_var', 'layer1.1.bn2.num_batches_tracked', 'layer2.0.conv1.weight', 'layer2.0.bn1.weight', 'layer2.0.bn1.bias', 'layer2.0.bn1.running_mean', 'layer2.0.bn1.running_var', 'layer2.0.bn1.num_batches_tracked', 'layer2.0.conv2.weight', 'layer2.0.bn2.weight', 'layer2.0.bn2.bias', 'layer2.0.bn2.running_mean', 'layer2.0.bn2.running_var', 'layer2.0.bn2.num_batches_tracked', 'layer2.0.shortcut.0.weight', 'layer2.0.shortcut.1.weight', 'layer2.0.shortcut.1.bias', 'layer2.0.shortcut.1.running_mean', 'layer2.0.shortcut.1.running_var', 'layer2.0.shortcut.1.num_batches_tracked', 'layer2.1.conv1.weight', 'layer2.1.bn1.weight', 'layer2.1.bn1.bias', 'layer2.1.bn1.running_mean', 'layer2.1.bn1.running_var', 'layer2.1.bn1.num_batches_tracked', 'layer2.1.conv2.weight', 'layer2.1.bn2.weight', 'layer2.1.bn2.bias', 'layer2.1.bn2.running_mean', 'layer2.1.bn2.running_var', 'layer2.1.bn2.num_batches_tracked', 'layer3.0.conv1.weight', 'layer3.0.bn1.weight', 'layer3.0.bn1.bias', 'layer3.0.bn1.running_mean', 'layer3.0.bn1.running_var', 'layer3.0.bn1.num_batches_tracked', 'layer3.0.conv2.weight', 'layer3.0.bn2.weight', 'layer3.0.bn2.bias', 'layer3.0.bn2.running_mean', 'layer3.0.bn2.running_var', 'layer3.0.bn2.num_batches_tracked', 'layer3.0.shortcut.0.weight', 'layer3.0.shortcut.1.weight', 'layer3.0.shortcut.1.bias', 'layer3.0.shortcut.1.running_mean', 'layer3.0.shortcut.1.running_var', 'layer3.0.shortcut.1.num_batches_tracked', 'layer3.1.conv1.weight', 'layer3.1.bn1.weight', 'layer3.1.bn1.bias', 'layer3.1.bn1.running_mean', 'layer3.1.bn1.running_var', 'layer3.1.bn1.num_batches_tracked', 'layer3.1.conv2.weight', 'layer3.1.bn2.weight', 'layer3.1.bn2.bias', 'layer3.1.bn2.running_mean', 'layer3.1.bn2.running_var', 'layer3.1.bn2.num_batches_tracked', 'layer4.0.conv1.weight', 'layer4.0.bn1.weight', 'layer4.0.bn1.bias', 'layer4.0.bn1.running_mean', 'layer4.0.bn1.running_var', 'layer4.0.bn1.num_batches_tracked', 'layer4.0.conv2.weight', 'layer4.0.bn2.weight', 'layer4.0.bn2.bias', 'layer4.0.bn2.running_mean', 'layer4.0.bn2.running_var', 'layer4.0.bn2.num_batches_tracked', 'layer4.0.shortcut.0.weight', 'layer4.0.shortcut.1.weight', 'layer4.0.shortcut.1.bias', 'layer4.0.shortcut.1.running_mean', 'layer4.0.shortcut.1.running_var', 'layer4.0.shortcut.1.num_batches_tracked', 'layer4.1.conv1.weight', 'layer4.1.bn1.weight', 'layer4.1.bn1.bias', 'layer4.1.bn1.running_mean', 'layer4.1.bn1.running_var', 'layer4.1.bn1.num_batches_tracked', 'layer4.1.conv2.weight', 'layer4.1.bn2.weight', 'layer4.1.bn2.bias', 'layer4.1.bn2.running_mean', 'layer4.1.bn2.running_var', 'layer4.1.bn2.num_batches_tracked', 'linear.weight', 'linear.bias']
# Params: 11179478 (local), 11178452 (global); Percentage 99.99 (11178452/11179478 
)
learning rate, batch size: 0.01, 10 

---------------------------------------------train_client: [0] 

        init --> train local model(freeze embeding):client   0,  Train loss: 0.857, Train accuracy: 72.000, Test loss: 0.849, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.466, Train accuracy: 81.000, Test loss: 0.597, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.345, Train accuracy: 87.000, Test loss: 0.547, Test accuracy: 77.50 

Round   0, Train loss: 0.345, Test loss: 0.547, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.403, Train accuracy: 80.000, Test loss: 0.625, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.199, Train accuracy: 91.500, Test loss: 0.630, Test accuracy: 76.50 

Round   1, Train loss: 0.199, Test loss: 0.630, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.212, Train accuracy: 92.500, Test loss: 0.818, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.442, Train accuracy: 90.000, Test loss: 0.829, Test accuracy: 80.00 

Round   2, Train loss: 0.442, Test loss: 0.829, Test accuracy: 80.00 

        train local model (freeze embeding):client   0,  Train loss: 0.169, Train accuracy: 94.500, Test loss: 0.695, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.220, Train accuracy: 89.500, Test loss: 0.920, Test accuracy: 75.00 

Round   3, Train loss: 0.220, Test loss: 0.920, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.147, Train accuracy: 93.500, Test loss: 0.694, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.398, Train accuracy: 90.000, Test loss: 0.805, Test accuracy: 81.00 

Round   4, Train loss: 0.398, Test loss: 0.805, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.238, Train accuracy: 94.000, Test loss: 0.586, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.312, Train accuracy: 88.500, Test loss: 0.721, Test accuracy: 77.00 

Round   5, Train loss: 0.312, Test loss: 0.721, Test accuracy: 77.00 

        train local model (freeze embeding):client   0,  Train loss: 0.201, Train accuracy: 91.500, Test loss: 0.764, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.138, Train accuracy: 95.500, Test loss: 0.788, Test accuracy: 77.50 

Round   6, Train loss: 0.138, Test loss: 0.788, Test accuracy: 77.50 

        train local model (freeze embeding):client   0,  Train loss: 0.096, Train accuracy: 94.500, Test loss: 0.614, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.119, Train accuracy: 96.500, Test loss: 0.902, Test accuracy: 78.50 

Round   7, Train loss: 0.119, Test loss: 0.902, Test accuracy: 78.50 

        train local model (freeze embeding):client   0,  Train loss: 0.039, Train accuracy: 99.000, Test loss: 0.776, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.897, Test accuracy: 80.50 

Round   8, Train loss: 0.033, Test loss: 0.897, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.058, Train accuracy: 98.000, Test loss: 0.809, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 100.000, Test loss: 0.907, Test accuracy: 83.50 

Round   9, Train loss: 0.011, Test loss: 0.907, Test accuracy: 83.50 

        train local model (freeze embeding):client   0,  Train loss: 0.084, Train accuracy: 97.500, Test loss: 1.002, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.060, Train accuracy: 97.500, Test loss: 0.874, Test accuracy: 79.50 

Round  10, Train loss: 0.060, Test loss: 0.874, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 0.812, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 0.704, Test accuracy: 79.50 

Round  11, Train loss: 0.044, Test loss: 0.704, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.710, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.070, Train accuracy: 98.500, Test loss: 1.035, Test accuracy: 78.00 

Round  12, Train loss: 0.070, Test loss: 1.035, Test accuracy: 78.00 

        train local model (freeze embeding):client   0,  Train loss: 0.028, Train accuracy: 99.000, Test loss: 0.772, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.071, Train accuracy: 97.000, Test loss: 1.108, Test accuracy: 73.50 

Round  13, Train loss: 0.071, Test loss: 1.108, Test accuracy: 73.50 

        train local model (freeze embeding):client   0,  Train loss: 0.035, Train accuracy: 98.500, Test loss: 0.982, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.980, Test accuracy: 81.50 

Round  14, Train loss: 0.017, Test loss: 0.980, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.000, Test loss: 0.655, Test accuracy: 82.50 

Round  15, Train loss: 0.029, Test loss: 0.655, Test accuracy: 82.50 

        train local model (freeze embeding):client   0,  Train loss: 0.062, Train accuracy: 98.500, Test loss: 0.722, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.031, Train accuracy: 99.000, Test loss: 1.018, Test accuracy: 82.00 

Round  16, Train loss: 0.031, Test loss: 1.018, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 0.917, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.706, Test accuracy: 84.00 

Round  17, Train loss: 0.023, Test loss: 0.706, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.736, Test accuracy: 84.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.906, Test accuracy: 81.00 

Round  18, Train loss: 0.002, Test loss: 0.906, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.912, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 1.262, Test accuracy: 76.50 

Round  19, Train loss: 0.010, Test loss: 1.262, Test accuracy: 76.50 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.000, Test loss: 1.168, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 80.00 

Final Round, Train loss: 0.002, Test loss: 1.126, Test accuracy: 79.00 

---------------------------------------------train_client: [0, 1] 

        init --> train local model(freeze embeding):client   1,  Train loss: 0.503, Train accuracy: 78.000, Test loss: 0.565, Test accuracy: 73.00 

        train local model (freeze embeding):client   0,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 1.137, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.034, Train accuracy: 98.500, Test loss: 0.985, Test accuracy: 78.50 

        train local model (freeze embeding):client   1,  Train loss: 0.625, Train accuracy: 72.500, Test loss: 0.706, Test accuracy: 68.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.124, Train accuracy: 95.000, Test loss: 0.372, Test accuracy: 86.50 

Round   0, Train loss: 0.079, Test loss: 0.600, Test accuracy: 75.00 

        train local model (freeze embeding):client   0,  Train loss: 0.162, Train accuracy: 93.000, Test loss: 0.830, Test accuracy: 72.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.807, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.171, Train accuracy: 94.000, Test loss: 0.498, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.085, Train accuracy: 97.000, Test loss: 0.417, Test accuracy: 86.50 

Round   1, Train loss: 0.057, Test loss: 0.652, Test accuracy: 77.75 

        train local model (freeze embeding):client   0,  Train loss: 0.048, Train accuracy: 98.500, Test loss: 0.775, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.876, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.226, Train accuracy: 90.500, Test loss: 0.560, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.060, Train accuracy: 98.000, Test loss: 0.439, Test accuracy: 88.50 

Round   2, Train loss: 0.034, Test loss: 0.617, Test accuracy: 78.25 

        train local model (freeze embeding):client   0,  Train loss: 0.080, Train accuracy: 96.500, Test loss: 0.859, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.161, Train accuracy: 94.500, Test loss: 0.693, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.094, Train accuracy: 95.500, Test loss: 0.471, Test accuracy: 88.00 

Round   3, Train loss: 0.050, Test loss: 0.654, Test accuracy: 78.75 

        train local model (freeze embeding):client   0,  Train loss: 0.052, Train accuracy: 98.000, Test loss: 0.871, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.996, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.069, Train accuracy: 97.500, Test loss: 0.549, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.030, Train accuracy: 98.500, Test loss: 0.565, Test accuracy: 90.00 

Round   4, Train loss: 0.017, Test loss: 0.799, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.131, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.944, Test accuracy: 78.00 

        train local model (freeze embeding):client   1,  Train loss: 0.049, Train accuracy: 98.000, Test loss: 0.646, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 97.500, Test loss: 0.504, Test accuracy: 87.00 

Round   5, Train loss: 0.025, Test loss: 0.660, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.033, Train accuracy: 98.000, Test loss: 1.099, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 1.006, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.108, Train accuracy: 96.500, Test loss: 0.752, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 0.500, Test accuracy: 86.50 

Round   6, Train loss: 0.029, Test loss: 0.714, Test accuracy: 79.50 

        train local model (freeze embeding):client   0,  Train loss: 0.121, Train accuracy: 98.000, Test loss: 1.240, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.923, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.593, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.036, Train accuracy: 98.500, Test loss: 0.624, Test accuracy: 86.50 

Round   7, Train loss: 0.020, Test loss: 0.750, Test accuracy: 81.50 

        train local model (freeze embeding):client   0,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 1.121, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.070, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.105, Train accuracy: 97.000, Test loss: 0.667, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.455, Test accuracy: 89.50 

Round   8, Train loss: 0.011, Test loss: 0.875, Test accuracy: 80.50 

        train local model (freeze embeding):client   0,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.999, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.893, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.736, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 0.465, Test accuracy: 89.50 

Round   9, Train loss: 0.012, Test loss: 0.626, Test accuracy: 84.25 

        train local model (freeze embeding):client   0,  Train loss: 0.058, Train accuracy: 99.000, Test loss: 0.884, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.590, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 89.00 

Round  10, Train loss: 0.004, Test loss: 0.705, Test accuracy: 82.75 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.141, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.189, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.623, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.421, Test accuracy: 88.00 

Round  11, Train loss: 0.029, Test loss: 0.750, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.036, Train accuracy: 99.500, Test loss: 1.087, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.087, Train accuracy: 98.500, Test loss: 0.572, Test accuracy: 86.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.404, Test accuracy: 91.00 

Round  12, Train loss: 0.004, Test loss: 0.709, Test accuracy: 81.25 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.152, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.689, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 91.00 

Round  13, Train loss: 0.005, Test loss: 0.874, Test accuracy: 82.00 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.470, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.086, Train accuracy: 98.500, Test loss: 1.762, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.637, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.509, Test accuracy: 91.00 

Round  14, Train loss: 0.047, Test loss: 0.929, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.409, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.055, Test accuracy: 77.50 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.641, Test accuracy: 86.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.327, Test accuracy: 91.50 

Round  15, Train loss: 0.005, Test loss: 0.697, Test accuracy: 79.75 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.000, Test loss: 1.023, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 1.091, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.353, Test accuracy: 92.50 

Round  16, Train loss: 0.005, Test loss: 0.699, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 1.063, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.057, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.589, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.498, Test accuracy: 89.50 

Round  17, Train loss: 0.002, Test loss: 0.759, Test accuracy: 81.75 

        train local model (freeze embeding):client   0,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 1.032, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.060, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.694, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.602, Test accuracy: 88.00 

Round  18, Train loss: 0.005, Test loss: 1.047, Test accuracy: 81.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 1.245, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.584, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 92.50 

Round  19, Train loss: 0.001, Test loss: 0.707, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.020, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.012, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.678, Test accuracy: 87.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.663, Test accuracy: 88.50 

Final Round, Train loss: 0.006, Test loss: 0.689, Test accuracy: 84.50 

---------------------------------------------train_client: [0, 1, 2] 

        init --> train local model(freeze embeding):client   2,  Train loss: 0.355, Train accuracy: 86.000, Test loss: 0.347, Test accuracy: 84.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.016, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.029, Train accuracy: 98.500, Test loss: 1.045, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.610, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.389, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.374, Train accuracy: 83.500, Test loss: 0.787, Test accuracy: 73.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.123, Train accuracy: 95.000, Test loss: 0.209, Test accuracy: 93.50 

Round   0, Train loss: 0.053, Test loss: 0.632, Test accuracy: 82.83 

        train local model (freeze embeding):client   0,  Train loss: 0.038, Train accuracy: 99.000, Test loss: 1.146, Test accuracy: 75.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 1.329, Test accuracy: 80.00 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.550, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.303, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.179, Train accuracy: 93.000, Test loss: 0.177, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.111, Train accuracy: 96.000, Test loss: 0.387, Test accuracy: 89.00 

Round   1, Train loss: 0.041, Test loss: 0.693, Test accuracy: 85.17 

        train local model (freeze embeding):client   0,  Train loss: 0.038, Train accuracy: 99.500, Test loss: 1.173, Test accuracy: 74.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.613, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.364, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.077, Train accuracy: 97.500, Test loss: 0.161, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 100.000, Test loss: 0.195, Test accuracy: 92.50 

Round   2, Train loss: 0.011, Test loss: 0.633, Test accuracy: 84.83 

        train local model (freeze embeding):client   0,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 1.018, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.187, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.591, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.333, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.056, Train accuracy: 99.000, Test loss: 0.139, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.037, Train accuracy: 99.000, Test loss: 0.377, Test accuracy: 91.00 

Round   3, Train loss: 0.018, Test loss: 0.616, Test accuracy: 85.67 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 77.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.777, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.546, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.467, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.058, Train accuracy: 99.000, Test loss: 0.148, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 100.000, Test loss: 0.145, Test accuracy: 96.50 

Round   4, Train loss: 0.010, Test loss: 0.508, Test accuracy: 87.67 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.092, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.251, Train accuracy: 94.500, Test loss: 1.565, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.618, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.050, Train accuracy: 98.500, Test loss: 0.167, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.084, Train accuracy: 98.000, Test loss: 0.218, Test accuracy: 94.50 

Round   5, Train loss: 0.112, Test loss: 0.581, Test accuracy: 86.33 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.049, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.156, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.537, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.487, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.045, Train accuracy: 99.500, Test loss: 0.138, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.178, Test accuracy: 93.50 

Round   6, Train loss: 0.005, Test loss: 0.623, Test accuracy: 87.17 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.132, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.737, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.160, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.021, Train accuracy: 99.000, Test loss: 0.381, Test accuracy: 90.00 

Round   7, Train loss: 0.008, Test loss: 0.654, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 1.166, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.600, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.551, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.018, Train accuracy: 100.000, Test loss: 0.163, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.301, Test accuracy: 94.50 

Round   8, Train loss: 0.005, Test loss: 0.658, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.079, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.146, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.000, Test loss: 0.616, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.193, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 0.133, Test accuracy: 96.00 

Round   9, Train loss: 0.011, Test loss: 0.471, Test accuracy: 88.67 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 1.144, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.000, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.540, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.489, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.012, Train accuracy: 100.000, Test loss: 0.101, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.120, Test accuracy: 97.00 

Round  10, Train loss: 0.006, Test loss: 0.606, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 1.068, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.917, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.497, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.047, Train accuracy: 98.500, Test loss: 0.332, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.137, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.251, Test accuracy: 94.00 

Round  11, Train loss: 0.017, Test loss: 0.554, Test accuracy: 87.67 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.997, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.967, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.590, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.194, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.210, Test accuracy: 95.00 

Round  12, Train loss: 0.001, Test loss: 0.622, Test accuracy: 87.67 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 99.500, Test loss: 0.993, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 1.014, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.671, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.565, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.185, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.166, Test accuracy: 97.00 

Round  13, Train loss: 0.004, Test loss: 0.505, Test accuracy: 87.67 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.047, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.019, Train accuracy: 99.000, Test loss: 1.337, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.606, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.585, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.146, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 90.50 

Round  14, Train loss: 0.008, Test loss: 0.727, Test accuracy: 86.17 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.161, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.013, Train accuracy: 99.500, Test loss: 1.341, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.737, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.589, Test accuracy: 87.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.279, Test accuracy: 94.00 

Round  15, Train loss: 0.012, Test loss: 0.609, Test accuracy: 87.67 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.134, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.094, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.628, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.464, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.079, Train accuracy: 98.000, Test loss: 0.378, Test accuracy: 94.50 

Round  16, Train loss: 0.031, Test loss: 0.887, Test accuracy: 84.00 

        train local model (freeze embeding):client   0,  Train loss: 0.084, Train accuracy: 97.000, Test loss: 1.322, Test accuracy: 73.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.020, Train accuracy: 99.000, Test loss: 1.134, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.431, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.186, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.245, Test accuracy: 94.00 

Round  17, Train loss: 0.008, Test loss: 0.695, Test accuracy: 85.00 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.969, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.920, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.554, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.219, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.343, Test accuracy: 94.00 

Round  18, Train loss: 0.004, Test loss: 0.584, Test accuracy: 85.50 

        train local model (freeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.987, Test accuracy: 78.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.966, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.571, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.469, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.306, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.228, Test accuracy: 95.00 

Round  19, Train loss: 0.002, Test loss: 0.598, Test accuracy: 86.50 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.054, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.949, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.639, Test accuracy: 88.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.290, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.181, Test accuracy: 94.00 

Final Round, Train loss: 0.003, Test loss: 0.566, Test accuracy: 88.33 

---------------------------------------------train_client: [0, 1, 2, 3] 

        init --> train local model(freeze embeding):client   3,  Train loss: 0.418, Train accuracy: 82.500, Test loss: 0.542, Test accuracy: 79.00 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.026, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.663, Test accuracy: 88.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.616, Test accuracy: 90.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.192, Test accuracy: 95.50 

        train local model (freeze embeding):client   3,  Train loss: 0.286, Train accuracy: 86.000, Test loss: 0.344, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.076, Train accuracy: 97.500, Test loss: 0.252, Test accuracy: 92.50 

Round   0, Train loss: 0.021, Test loss: 0.385, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.867, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.127, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.507, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.265, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.211, Test accuracy: 94.00 

        train local model (freeze embeding):client   3,  Train loss: 0.166, Train accuracy: 94.000, Test loss: 0.219, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.251, Test accuracy: 93.00 

Round   1, Train loss: 0.008, Test loss: 0.408, Test accuracy: 88.62 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.977, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.044, Train accuracy: 98.500, Test loss: 1.771, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.544, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.138, Train accuracy: 95.500, Test loss: 1.409, Test accuracy: 80.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.267, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.158, Test accuracy: 95.50 

        train local model (freeze embeding):client   3,  Train loss: 0.091, Train accuracy: 97.500, Test loss: 0.271, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.025, Train accuracy: 100.000, Test loss: 0.311, Test accuracy: 92.50 

Round   2, Train loss: 0.052, Test loss: 0.480, Test accuracy: 88.12 

        train local model (freeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.239, Test accuracy: 76.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 1.362, Test accuracy: 79.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.545, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.480, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.208, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.297, Test accuracy: 94.00 

        train local model (freeze embeding):client   3,  Train loss: 0.066, Train accuracy: 97.000, Test loss: 0.272, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.341, Test accuracy: 91.00 

Round   3, Train loss: 0.006, Test loss: 0.483, Test accuracy: 88.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.164, Test accuracy: 79.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.221, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.514, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.515, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.176, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.033, Train accuracy: 98.500, Test loss: 0.363, Test accuracy: 89.00 

        train local model (freeze embeding):client   3,  Train loss: 0.038, Train accuracy: 100.000, Test loss: 0.338, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 0.382, Test accuracy: 90.50 

Round   4, Train loss: 0.020, Test loss: 0.486, Test accuracy: 89.62 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 1.145, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.930, Test accuracy: 81.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.537, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.370, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.175, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.183, Test accuracy: 95.00 

        train local model (freeze embeding):client   3,  Train loss: 0.022, Train accuracy: 100.000, Test loss: 0.324, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.022, Train accuracy: 99.000, Test loss: 0.336, Test accuracy: 90.00 

Round   5, Train loss: 0.010, Test loss: 0.403, Test accuracy: 88.38 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.998, Test accuracy: 77.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.198, Train accuracy: 95.000, Test loss: 1.456, Test accuracy: 74.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.398, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.173, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.118, Test accuracy: 97.50 

        train local model (freeze embeding):client   3,  Train loss: 0.028, Train accuracy: 99.500, Test loss: 0.348, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.474, Test accuracy: 93.00 

Round   6, Train loss: 0.055, Test loss: 0.464, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.029, Train accuracy: 99.500, Test loss: 0.980, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.922, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.590, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.332, Test accuracy: 89.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.115, Test accuracy: 97.00 

        train local model (freeze embeding):client   3,  Train loss: 0.033, Train accuracy: 99.500, Test loss: 0.448, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.010, Train accuracy: 100.000, Test loss: 0.420, Test accuracy: 89.50 

Round   7, Train loss: 0.003, Test loss: 0.444, Test accuracy: 89.00 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.947, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 99.500, Test loss: 1.705, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.434, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.248, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.123, Test accuracy: 97.50 

        train local model (freeze embeding):client   3,  Train loss: 0.014, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.045, Train accuracy: 98.500, Test loss: 0.671, Test accuracy: 87.50 

Round   8, Train loss: 0.018, Test loss: 0.495, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.008, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 1.096, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.473, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.350, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.293, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.175, Test accuracy: 94.50 

        train local model (freeze embeding):client   3,  Train loss: 0.025, Train accuracy: 99.000, Test loss: 0.517, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.618, Test accuracy: 87.50 

Round   9, Train loss: 0.009, Test loss: 0.448, Test accuracy: 87.75 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.952, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.074, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.531, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.319, Test accuracy: 93.00 

        train local model (freeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.247, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.200, Test accuracy: 95.00 

        train local model (freeze embeding):client   3,  Train loss: 0.026, Train accuracy: 99.500, Test loss: 0.471, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.036, Train accuracy: 99.000, Test loss: 0.722, Test accuracy: 90.50 

Round  10, Train loss: 0.010, Test loss: 0.438, Test accuracy: 87.75 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.875, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.018, Train accuracy: 99.500, Test loss: 1.654, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.560, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.155, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.294, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.500, Test loss: 0.385, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.381, Test accuracy: 93.50 

Round  11, Train loss: 0.005, Test loss: 0.458, Test accuracy: 88.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.977, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.034, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.501, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.394, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.195, Test accuracy: 94.50 

        train local model (freeze embeding):client   3,  Train loss: 0.011, Train accuracy: 99.500, Test loss: 0.329, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.323, Test accuracy: 91.50 

Round  12, Train loss: 0.005, Test loss: 0.415, Test accuracy: 89.12 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.878, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.971, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.569, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.299, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.433, Test accuracy: 95.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.078, Train accuracy: 98.000, Test loss: 0.379, Test accuracy: 91.00 

Round  13, Train loss: 0.022, Test loss: 0.436, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.895, Test accuracy: 80.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.081, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.416, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.223, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.50 

        train local model (freeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.376, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.372, Test accuracy: 92.50 

Round  14, Train loss: 0.004, Test loss: 0.481, Test accuracy: 89.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.113, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.089, Test accuracy: 82.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.496, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.662, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 95.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.419, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 0.323, Test accuracy: 94.00 

Round  15, Train loss: 0.004, Test loss: 0.434, Test accuracy: 90.25 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.968, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.014, Train accuracy: 99.500, Test loss: 1.590, Test accuracy: 79.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.477, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.415, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.293, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.183, Test accuracy: 95.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.500, Test loss: 0.409, Test accuracy: 92.50 

Round  16, Train loss: 0.008, Test loss: 0.490, Test accuracy: 89.75 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.940, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.617, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.499, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.229, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.440, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.400, Test accuracy: 91.00 

Round  17, Train loss: 0.002, Test loss: 0.457, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.866, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.218, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.592, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.433, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.213, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.009, Train accuracy: 99.500, Test loss: 0.459, Test accuracy: 90.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.417, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.490, Test accuracy: 91.00 

Round  18, Train loss: 0.002, Test loss: 0.521, Test accuracy: 88.62 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.939, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.695, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.555, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.227, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.236, Test accuracy: 94.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.446, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 93.50 

Round  19, Train loss: 0.000, Test loss: 0.505, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 1.084, Test accuracy: 81.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.937, Test accuracy: 81.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.625, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.625, Test accuracy: 89.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.188, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.470, Test accuracy: 90.00 

Final Round, Train loss: 0.000, Test loss: 0.502, Test accuracy: 89.12 

---------------------------------------------train_client: [0, 1, 2, 3, 4] 

        init --> train local model(freeze embeding):client   4,  Train loss: 0.358, Train accuracy: 84.500, Test loss: 0.239, Test accuracy: 92.50 

        train local model (freeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 1.044, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.899, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.597, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.519, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.429, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.157, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.585, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.401, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.435, Train accuracy: 87.000, Test loss: 0.321, Test accuracy: 89.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.080, Train accuracy: 96.500, Test loss: 0.325, Test accuracy: 93.50 

Round   0, Train loss: 0.016, Test loss: 0.411, Test accuracy: 89.90 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.978, Test accuracy: 79.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.022, Train accuracy: 98.500, Test loss: 0.857, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.527, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.441, Test accuracy: 88.00 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.263, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.173, Test accuracy: 94.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.474, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.423, Test accuracy: 93.50 

        train local model (freeze embeding):client   4,  Train loss: 0.200, Train accuracy: 92.500, Test loss: 0.212, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.064, Train accuracy: 98.500, Test loss: 0.188, Test accuracy: 96.00 

Round   1, Train loss: 0.022, Test loss: 0.414, Test accuracy: 87.60 

        train local model (freeze embeding):client   0,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.763, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.354, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 0.162, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.133, Test accuracy: 97.00 

        train local model (freeze embeding):client   3,  Train loss: 0.023, Train accuracy: 99.000, Test loss: 0.502, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.564, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.190, Train accuracy: 91.000, Test loss: 0.219, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.019, Train accuracy: 99.500, Test loss: 0.265, Test accuracy: 96.50 

Round   2, Train loss: 0.005, Test loss: 0.365, Test accuracy: 91.10 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.780, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.943, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.363, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.411, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.194, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.010, Train accuracy: 99.500, Test loss: 0.129, Test accuracy: 96.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.462, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.073, Train accuracy: 96.500, Test loss: 0.414, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.122, Train accuracy: 96.000, Test loss: 0.169, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.015, Train accuracy: 99.500, Test loss: 0.230, Test accuracy: 96.00 

Round   3, Train loss: 0.020, Test loss: 0.324, Test accuracy: 90.80 

        train local model (freeze embeding):client   0,  Train loss: 0.064, Train accuracy: 98.000, Test loss: 0.923, Test accuracy: 78.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.766, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.457, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.138, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.216, Test accuracy: 93.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.094, Train accuracy: 95.500, Test loss: 0.961, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.109, Train accuracy: 96.500, Test loss: 0.164, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.215, Test accuracy: 95.00 

Round   4, Train loss: 0.025, Test loss: 0.387, Test accuracy: 89.80 

        train local model (freeze embeding):client   0,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.733, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.915, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.459, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.390, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.182, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.214, Test accuracy: 94.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.432, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.621, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.082, Train accuracy: 97.000, Test loss: 0.161, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.293, Train accuracy: 91.000, Test loss: 0.395, Test accuracy: 86.00 

Round   5, Train loss: 0.060, Test loss: 0.361, Test accuracy: 91.20 

        train local model (freeze embeding):client   0,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.749, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.856, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.397, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.150, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 99.000, Test loss: 0.101, Test accuracy: 97.00 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.403, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.368, Test accuracy: 91.50 

        train local model (freeze embeding):client   4,  Train loss: 0.072, Train accuracy: 98.000, Test loss: 0.200, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.007, Train accuracy: 100.000, Test loss: 0.217, Test accuracy: 95.50 

Round   6, Train loss: 0.005, Test loss: 0.330, Test accuracy: 91.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.714, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.994, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.485, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.466, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.121, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.016, Train accuracy: 100.000, Test loss: 0.251, Test accuracy: 92.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.316, Test accuracy: 94.00 

        train local model (freeze embeding):client   4,  Train loss: 0.024, Train accuracy: 100.000, Test loss: 0.220, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.135, Train accuracy: 95.500, Test loss: 0.425, Test accuracy: 91.00 

Round   7, Train loss: 0.031, Test loss: 0.374, Test accuracy: 91.20 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.708, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.987, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.463, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.418, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.246, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.447, Test accuracy: 92.00 

        train local model (freeze embeding):client   4,  Train loss: 0.037, Train accuracy: 98.500, Test loss: 0.266, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.054, Train accuracy: 98.000, Test loss: 0.268, Test accuracy: 94.50 

Round   8, Train loss: 0.012, Test loss: 0.355, Test accuracy: 90.30 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.718, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 1.126, Test accuracy: 80.50 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.458, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.371, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.159, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.182, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.433, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.019, Train accuracy: 100.000, Test loss: 0.212, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.452, Train accuracy: 87.500, Test loss: 0.558, Test accuracy: 84.00 

Round   9, Train loss: 0.091, Test loss: 0.434, Test accuracy: 89.50 

        train local model (freeze embeding):client   0,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.711, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 1.083, Test accuracy: 85.50 

        train local model (freeze embeding):client   1,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 88.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.422, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.295, Test accuracy: 92.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.270, Test accuracy: 95.50 

        train local model (freeze embeding):client   3,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.031, Train accuracy: 98.500, Test loss: 0.825, Test accuracy: 86.50 

        train local model (freeze embeding):client   4,  Train loss: 0.056, Train accuracy: 97.500, Test loss: 0.238, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.021, Train accuracy: 99.500, Test loss: 0.349, Test accuracy: 95.50 

Round  10, Train loss: 0.011, Test loss: 0.415, Test accuracy: 90.50 

        train local model (freeze embeding):client   0,  Train loss: 0.008, Train accuracy: 99.500, Test loss: 0.773, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.993, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.468, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.435, Test accuracy: 92.00 

        train local model (freeze embeding):client   2,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.181, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.454, Test accuracy: 95.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.380, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.283, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.013, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.254, Test accuracy: 96.00 

Round  11, Train loss: 0.002, Test loss: 0.367, Test accuracy: 91.30 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.758, Test accuracy: 83.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.898, Test accuracy: 84.50 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.581, Test accuracy: 87.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.389, Test accuracy: 93.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.231, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.201, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.377, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.017, Train accuracy: 99.000, Test loss: 0.514, Test accuracy: 91.00 

        train local model (freeze embeding):client   4,  Train loss: 0.024, Train accuracy: 99.500, Test loss: 0.188, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.027, Train accuracy: 99.500, Test loss: 0.359, Test accuracy: 93.00 

Round  12, Train loss: 0.009, Test loss: 0.366, Test accuracy: 90.90 

        train local model (freeze embeding):client   0,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.814, Test accuracy: 82.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.887, Test accuracy: 82.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.491, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.262, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.194, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.135, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.359, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.436, Test accuracy: 93.00 

        train local model (freeze embeding):client   4,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.276, Test accuracy: 95.00 

Round  13, Train loss: 0.004, Test loss: 0.391, Test accuracy: 91.20 

        train local model (freeze embeding):client   0,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.760, Test accuracy: 80.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.981, Test accuracy: 86.00 

        train local model (freeze embeding):client   1,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 92.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.532, Test accuracy: 91.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.204, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.205, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.384, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.382, Test accuracy: 90.00 

        train local model (freeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.208, Test accuracy: 95.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.289, Test accuracy: 95.50 

Round  14, Train loss: 0.002, Test loss: 0.364, Test accuracy: 91.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.767, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.957, Test accuracy: 83.50 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.407, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.344, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.275, Test accuracy: 95.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.445, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.172, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.046, Train accuracy: 98.000, Test loss: 0.199, Test accuracy: 94.00 

Round  15, Train loss: 0.010, Test loss: 0.366, Test accuracy: 91.10 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.751, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.092, Train accuracy: 97.000, Test loss: 2.664, Test accuracy: 77.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.392, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.175, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.225, Test accuracy: 94.00 

        train local model (freeze embeding):client   3,  Train loss: 0.005, Train accuracy: 100.000, Test loss: 0.453, Test accuracy: 91.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.016, Train accuracy: 99.500, Test loss: 0.224, Test accuracy: 94.50 

        train local model (freeze embeding):client   4,  Train loss: 0.009, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.278, Test accuracy: 95.00 

Round  16, Train loss: 0.022, Test loss: 0.316, Test accuracy: 91.00 

        train local model (freeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.774, Test accuracy: 83.00 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.828, Test accuracy: 84.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.430, Test accuracy: 90.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.339, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.153, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.152, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.395, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.024, Train accuracy: 99.000, Test loss: 0.297, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.032, Train accuracy: 99.500, Test loss: 0.228, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.330, Test accuracy: 95.50 

Round  17, Train loss: 0.006, Test loss: 0.341, Test accuracy: 90.90 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.826, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.750, Train accuracy: 77.000, Test loss: 1.274, Test accuracy: 75.00 

        train local model (freeze embeding):client   1,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.396, Test accuracy: 91.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.318, Test accuracy: 91.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.201, Test accuracy: 95.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.156, Test accuracy: 96.00 

        train local model (freeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.351, Test accuracy: 94.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.345, Test accuracy: 92.50 

        train local model (freeze embeding):client   4,  Train loss: 0.006, Train accuracy: 100.000, Test loss: 0.209, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.027, Train accuracy: 99.000, Test loss: 0.316, Test accuracy: 94.00 

Round  18, Train loss: 0.156, Test loss: 0.339, Test accuracy: 91.30 

        train local model (freeze embeding):client   0,  Train loss: 0.006, Train accuracy: 99.500, Test loss: 0.679, Test accuracy: 81.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.836, Test accuracy: 85.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.449, Test accuracy: 89.50 

        train local model (unfreeze embeding):client   1,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.438, Test accuracy: 92.50 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.266, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.250, Test accuracy: 93.50 

        train local model (freeze embeding):client   3,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.369, Test accuracy: 93.00 

        train local model (unfreeze embeding):client   3,  Train loss: 0.000, Train accuracy: 100.000, Test loss: 0.406, Test accuracy: 93.00 

        train local model (freeze embeding):client   4,  Train loss: 0.004, Train accuracy: 100.000, Test loss: 0.167, Test accuracy: 96.50 

        train local model (unfreeze embeding):client   4,  Train loss: 0.012, Train accuracy: 99.500, Test loss: 0.703, Test accuracy: 90.00 

Round  19, Train loss: 0.003, Test loss: 0.351, Test accuracy: 91.70 

        train local model (freeze embeding):client   0,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.654, Test accuracy: 82.50 

        train local model (unfreeze embeding):client   0,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.665, Test accuracy: 83.00 

        train local model (freeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.443, Test accuracy: 90.00 

        train local model (unfreeze embeding):client   1,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.520, Test accuracy: 90.00 

        train local model (freeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.240, Test accuracy: 94.50 

        train local model (unfreeze embeding):client   2,  Train loss: 0.001, Train accuracy: 100.000, Test loss: 0.256, Test accuracy: 94.50 

        train local model (freeze embeding):client   3,  Train loss: 0.002, Train accuracy: 100.000, Test loss: 0.346, Test accuracy: 93.50 

        train local model (unfreeze embeding):client   3,  Train loss: 0.008, Train accuracy: 100.000, Test loss: 0.425, Test accuracy: 90.50 

        train local model (freeze embeding):client   4,  Train loss: 0.005, Train accuracy: 99.500, Test loss: 0.198, Test accuracy: 96.00 

        train local model (unfreeze embeding):client   4,  Train loss: 0.003, Train accuracy: 100.000, Test loss: 0.197, Test accuracy: 96.00 

Final Round, Train loss: 0.003, Test loss: 0.357, Test accuracy: 91.50 

Average accuracy final 10 rounds: 428.2433333333335 

2447.0903146266937
[7.353283882141113, 15.358932971954346, 22.926173448562622, 30.305097818374634, 37.97927522659302, 45.76064372062683, 53.66469144821167, 61.52438521385193, 69.10800695419312, 76.62834429740906, 84.30333304405212, 91.94757342338562, 99.42952394485474, 106.75893187522888, 114.14320421218872, 121.89446091651917, 129.28905296325684, 136.95606207847595, 144.5538227558136, 151.87262749671936, 156.46939206123352, 163.99599266052246, 171.84208703041077, 179.45530700683594, 187.15388655662537, 194.90841579437256, 202.58563876152039, 210.42497062683105, 218.33299040794373, 225.938898563385, 233.352370262146, 240.87189245224, 248.2423985004425, 256.06479716300964, 263.72288179397583, 271.6116774082184, 279.5247015953064, 287.18325662612915, 295.2214951515198, 302.7986190319061, 310.3971197605133, 315.0806624889374, 322.8596887588501, 330.20198130607605, 337.2696762084961, 345.5601534843445, 351.54605197906494, 358.9651143550873, 366.34998321533203, 374.01889157295227, 381.68097281455994, 389.00053191185, 396.59175157546997, 404.00519609451294, 411.1556327342987, 419.2079179286957, 426.3700797557831, 433.7532012462616, 441.4577085971832, 449.7767684459686, 457.8367965221405, 465.4362120628357, 470.109445810318, 478.07292222976685, 486.29917192459106, 494.2459890842438, 502.22439455986023, 509.87433671951294, 517.7108836174011, 525.6486103534698, 533.7448658943176, 541.4271728992462, 549.2014009952545, 556.7962749004364, 564.771247625351, 572.5513830184937, 580.5146548748016, 588.3025677204132, 595.9743690490723, 603.8973896503448, 611.6369802951813, 619.3847620487213, 627.596620798111, 632.4087083339691, 640.2870995998383, 648.3755307197571, 656.3014657497406, 664.060430765152, 671.9913456439972, 679.9788398742676, 687.6163012981415, 695.5058536529541, 703.6100473403931, 711.5485441684723, 719.9220843315125, 727.6266329288483, 735.388167142868, 743.088663816452, 750.9013621807098, 758.5356469154358, 766.192182302475, 774.3254427909851, 782.1904442310333, 789.9971964359283, 794.6715152263641]
[77.5, 76.5, 80.0, 75.0, 81.0, 77.0, 77.5, 78.5, 80.5, 83.5, 79.5, 79.5, 78.0, 73.5, 81.5, 82.5, 82.0, 84.0, 81.0, 76.5, 79.0, 75.0, 77.75, 78.25, 78.75, 81.75, 82.0, 79.5, 81.5, 80.5, 84.25, 82.75, 79.75, 81.25, 82.0, 81.75, 79.75, 81.75, 81.75, 81.0, 84.0, 84.5, 82.83333333333333, 85.16666666666667, 84.83333333333333, 85.66666666666667, 87.66666666666667, 86.33333333333333, 87.16666666666667, 86.5, 88.0, 88.66666666666667, 86.5, 87.66666666666667, 87.66666666666667, 87.66666666666667, 86.16666666666667, 87.66666666666667, 84.0, 85.0, 85.5, 86.5, 88.33333333333333, 89.25, 88.625, 88.125, 88.0, 89.625, 88.375, 88.75, 89.0, 88.75, 87.75, 87.75, 88.75, 89.125, 89.25, 89.25, 90.25, 89.75, 90.5, 88.625, 89.5, 89.125, 89.9, 87.6, 91.1, 90.8, 89.8, 91.2, 91.5, 91.2, 90.3, 89.5, 90.5, 91.3, 90.9, 91.2, 91.7, 91.1, 91.0, 90.9, 91.3, 91.7, 91.5]
