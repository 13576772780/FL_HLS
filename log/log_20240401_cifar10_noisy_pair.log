nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.595, Test loss: 1.998, Test accuracy: 24.95
Round   0, Global train loss: 1.595, Global test loss: 2.175, Global test accuracy: 21.26
Round   1, Train loss: 1.388, Test loss: 1.713, Test accuracy: 34.56
Round   1, Global train loss: 1.388, Global test loss: 2.104, Global test accuracy: 25.22
Round   2, Train loss: 1.289, Test loss: 1.679, Test accuracy: 39.61
Round   2, Global train loss: 1.289, Global test loss: 2.245, Global test accuracy: 28.20
Round   3, Train loss: 1.274, Test loss: 1.315, Test accuracy: 47.53
Round   3, Global train loss: 1.274, Global test loss: 1.860, Global test accuracy: 34.77
Round   4, Train loss: 1.152, Test loss: 1.187, Test accuracy: 51.88
Round   4, Global train loss: 1.152, Global test loss: 1.857, Global test accuracy: 32.73
Round   5, Train loss: 1.125, Test loss: 1.130, Test accuracy: 53.44
Round   5, Global train loss: 1.125, Global test loss: 1.968, Global test accuracy: 29.54
Round   6, Train loss: 1.085, Test loss: 1.112, Test accuracy: 54.58
Round   6, Global train loss: 1.085, Global test loss: 1.893, Global test accuracy: 32.17
Round   7, Train loss: 1.020, Test loss: 1.089, Test accuracy: 55.90
Round   7, Global train loss: 1.020, Global test loss: 1.859, Global test accuracy: 35.54
Round   8, Train loss: 0.952, Test loss: 1.065, Test accuracy: 56.66
Round   8, Global train loss: 0.952, Global test loss: 1.854, Global test accuracy: 34.18
Round   9, Train loss: 1.061, Test loss: 1.050, Test accuracy: 57.56
Round   9, Global train loss: 1.061, Global test loss: 1.931, Global test accuracy: 34.98
Round  10, Train loss: 0.960, Test loss: 1.044, Test accuracy: 58.23
Round  10, Global train loss: 0.960, Global test loss: 2.000, Global test accuracy: 32.08
Round  11, Train loss: 0.915, Test loss: 1.054, Test accuracy: 58.04
Round  11, Global train loss: 0.915, Global test loss: 1.884, Global test accuracy: 32.84
Round  12, Train loss: 0.827, Test loss: 1.037, Test accuracy: 58.87
Round  12, Global train loss: 0.827, Global test loss: 1.805, Global test accuracy: 32.97
Round  13, Train loss: 0.964, Test loss: 1.024, Test accuracy: 59.86
Round  13, Global train loss: 0.964, Global test loss: 1.960, Global test accuracy: 29.95
Round  14, Train loss: 0.793, Test loss: 0.997, Test accuracy: 61.10
Round  14, Global train loss: 0.793, Global test loss: 1.857, Global test accuracy: 34.79
Round  15, Train loss: 0.859, Test loss: 0.992, Test accuracy: 61.66
Round  15, Global train loss: 0.859, Global test loss: 1.785, Global test accuracy: 40.41
Round  16, Train loss: 0.882, Test loss: 0.985, Test accuracy: 61.84
Round  16, Global train loss: 0.882, Global test loss: 1.908, Global test accuracy: 38.77
Round  17, Train loss: 0.730, Test loss: 0.993, Test accuracy: 61.96
Round  17, Global train loss: 0.730, Global test loss: 1.845, Global test accuracy: 34.52
Round  18, Train loss: 0.763, Test loss: 1.002, Test accuracy: 62.11
Round  18, Global train loss: 0.763, Global test loss: 1.985, Global test accuracy: 31.67
Round  19, Train loss: 0.644, Test loss: 0.998, Test accuracy: 62.39
Round  19, Global train loss: 0.644, Global test loss: 1.781, Global test accuracy: 41.42
Round  20, Train loss: 0.833, Test loss: 0.997, Test accuracy: 62.20
Round  20, Global train loss: 0.833, Global test loss: 1.769, Global test accuracy: 33.45
Round  21, Train loss: 0.724, Test loss: 0.999, Test accuracy: 62.52
Round  21, Global train loss: 0.724, Global test loss: 1.940, Global test accuracy: 32.54
Round  22, Train loss: 0.596, Test loss: 0.993, Test accuracy: 63.01
Round  22, Global train loss: 0.596, Global test loss: 1.809, Global test accuracy: 39.68
Round  23, Train loss: 0.677, Test loss: 0.995, Test accuracy: 63.13
Round  23, Global train loss: 0.677, Global test loss: 1.730, Global test accuracy: 45.14
Round  24, Train loss: 0.664, Test loss: 0.998, Test accuracy: 63.01
Round  24, Global train loss: 0.664, Global test loss: 1.917, Global test accuracy: 28.52
Round  25, Train loss: 0.651, Test loss: 0.999, Test accuracy: 63.40
Round  25, Global train loss: 0.651, Global test loss: 1.773, Global test accuracy: 39.00
Round  26, Train loss: 0.645, Test loss: 0.989, Test accuracy: 63.90
Round  26, Global train loss: 0.645, Global test loss: 1.827, Global test accuracy: 40.08
Round  27, Train loss: 0.743, Test loss: 0.978, Test accuracy: 64.21
Round  27, Global train loss: 0.743, Global test loss: 2.049, Global test accuracy: 32.79
Round  28, Train loss: 0.619, Test loss: 1.005, Test accuracy: 63.93
Round  28, Global train loss: 0.619, Global test loss: 1.708, Global test accuracy: 41.61
Round  29, Train loss: 0.590, Test loss: 1.031, Test accuracy: 63.28
Round  29, Global train loss: 0.590, Global test loss: 1.945, Global test accuracy: 40.21
Round  30, Train loss: 0.558, Test loss: 1.055, Test accuracy: 63.49
Round  30, Global train loss: 0.558, Global test loss: 1.816, Global test accuracy: 35.62
Round  31, Train loss: 0.459, Test loss: 1.051, Test accuracy: 64.01
Round  31, Global train loss: 0.459, Global test loss: 2.006, Global test accuracy: 29.58
Round  32, Train loss: 0.567, Test loss: 1.048, Test accuracy: 63.96
Round  32, Global train loss: 0.567, Global test loss: 1.914, Global test accuracy: 32.52
Round  33, Train loss: 0.446, Test loss: 1.080, Test accuracy: 63.70
Round  33, Global train loss: 0.446, Global test loss: 1.764, Global test accuracy: 38.02
Round  34, Train loss: 0.536, Test loss: 1.110, Test accuracy: 63.48
Round  34, Global train loss: 0.536, Global test loss: 1.915, Global test accuracy: 31.62
Round  35, Train loss: 0.450, Test loss: 1.113, Test accuracy: 63.55
Round  35, Global train loss: 0.450, Global test loss: 1.835, Global test accuracy: 37.66
Round  36, Train loss: 0.491, Test loss: 1.122, Test accuracy: 63.78
Round  36, Global train loss: 0.491, Global test loss: 1.736, Global test accuracy: 39.00
Round  37, Train loss: 0.463, Test loss: 1.124, Test accuracy: 64.01
Round  37, Global train loss: 0.463, Global test loss: 1.850, Global test accuracy: 37.33
Round  38, Train loss: 0.370, Test loss: 1.165, Test accuracy: 63.47
Round  38, Global train loss: 0.370, Global test loss: 1.758, Global test accuracy: 37.66
Round  39, Train loss: 0.434, Test loss: 1.172, Test accuracy: 63.82
Round  39, Global train loss: 0.434, Global test loss: 1.887, Global test accuracy: 38.02
Round  40, Train loss: 0.353, Test loss: 1.211, Test accuracy: 63.24
Round  40, Global train loss: 0.353, Global test loss: 1.738, Global test accuracy: 39.92
Round  41, Train loss: 0.535, Test loss: 1.233, Test accuracy: 63.40
Round  41, Global train loss: 0.535, Global test loss: 1.891, Global test accuracy: 34.25
Round  42, Train loss: 0.409, Test loss: 1.238, Test accuracy: 63.40
Round  42, Global train loss: 0.409, Global test loss: 1.820, Global test accuracy: 36.96
Round  43, Train loss: 0.312, Test loss: 1.241, Test accuracy: 63.86
Round  43, Global train loss: 0.312, Global test loss: 1.719, Global test accuracy: 39.28
Round  44, Train loss: 0.289, Test loss: 1.274, Test accuracy: 63.66
Round  44, Global train loss: 0.289, Global test loss: 1.734, Global test accuracy: 39.97
Round  45, Train loss: 0.396, Test loss: 1.276, Test accuracy: 64.11
Round  45, Global train loss: 0.396, Global test loss: 1.866, Global test accuracy: 41.39
Round  46, Train loss: 0.339, Test loss: 1.283, Test accuracy: 64.46
Round  46, Global train loss: 0.339, Global test loss: 1.792, Global test accuracy: 33.92
Round  47, Train loss: 0.396, Test loss: 1.279, Test accuracy: 64.99
Round  47, Global train loss: 0.396, Global test loss: 1.824, Global test accuracy: 38.96
Round  48, Train loss: 0.288, Test loss: 1.309, Test accuracy: 64.98
Round  48, Global train loss: 0.288, Global test loss: 1.863, Global test accuracy: 39.59
Round  49, Train loss: 0.297, Test loss: 1.338, Test accuracy: 64.22
Round  49, Global train loss: 0.297, Global test loss: 2.076, Global test accuracy: 29.57
Round  50, Train loss: 0.246, Test loss: 1.350, Test accuracy: 64.42
Round  50, Global train loss: 0.246, Global test loss: 1.776, Global test accuracy: 36.00
Round  51, Train loss: 0.265, Test loss: 1.367, Test accuracy: 64.71
Round  51, Global train loss: 0.265, Global test loss: 1.915, Global test accuracy: 33.64
Round  52, Train loss: 0.283, Test loss: 1.388, Test accuracy: 64.42
Round  52, Global train loss: 0.283, Global test loss: 1.857, Global test accuracy: 38.81
Round  53, Train loss: 0.239, Test loss: 1.348, Test accuracy: 64.74
Round  53, Global train loss: 0.239, Global test loss: 2.016, Global test accuracy: 35.66
Round  54, Train loss: 0.283, Test loss: 1.386, Test accuracy: 64.75
Round  54, Global train loss: 0.283, Global test loss: 1.935, Global test accuracy: 31.06
Round  55, Train loss: 0.244, Test loss: 1.432, Test accuracy: 64.54
Round  55, Global train loss: 0.244, Global test loss: 1.860, Global test accuracy: 41.60
Round  56, Train loss: 0.262, Test loss: 1.428, Test accuracy: 64.49
Round  56, Global train loss: 0.262, Global test loss: 1.870, Global test accuracy: 42.41
Round  57, Train loss: 0.256, Test loss: 1.461, Test accuracy: 64.75
Round  57, Global train loss: 0.256, Global test loss: 1.826, Global test accuracy: 38.83
Round  58, Train loss: 0.221, Test loss: 1.435, Test accuracy: 65.03
Round  58, Global train loss: 0.221, Global test loss: 1.916, Global test accuracy: 37.21
Round  59, Train loss: 0.210, Test loss: 1.448, Test accuracy: 64.56
Round  59, Global train loss: 0.210, Global test loss: 1.915, Global test accuracy: 37.00
Round  60, Train loss: 0.202, Test loss: 1.442, Test accuracy: 64.36
Round  60, Global train loss: 0.202, Global test loss: 1.930, Global test accuracy: 36.93
Round  61, Train loss: 0.178, Test loss: 1.463, Test accuracy: 64.72
Round  61, Global train loss: 0.178, Global test loss: 2.033, Global test accuracy: 39.42
Round  62, Train loss: 0.234, Test loss: 1.478, Test accuracy: 65.09
Round  62, Global train loss: 0.234, Global test loss: 1.783, Global test accuracy: 32.90
Round  63, Train loss: 0.250, Test loss: 1.491, Test accuracy: 65.37
Round  63, Global train loss: 0.250, Global test loss: 1.734, Global test accuracy: 41.26
Round  64, Train loss: 0.174, Test loss: 1.531, Test accuracy: 64.98
Round  64, Global train loss: 0.174, Global test loss: 1.839, Global test accuracy: 38.43
Round  65, Train loss: 0.207, Test loss: 1.529, Test accuracy: 65.47
Round  65, Global train loss: 0.207, Global test loss: 2.077, Global test accuracy: 40.16
Round  66, Train loss: 0.222, Test loss: 1.552, Test accuracy: 65.24
Round  66, Global train loss: 0.222, Global test loss: 1.881, Global test accuracy: 37.62
Round  67, Train loss: 0.224, Test loss: 1.541, Test accuracy: 65.69
Round  67, Global train loss: 0.224, Global test loss: 1.873, Global test accuracy: 38.43
Round  68, Train loss: 0.199, Test loss: 1.558, Test accuracy: 65.78
Round  68, Global train loss: 0.199, Global test loss: 1.882, Global test accuracy: 32.36
Round  69, Train loss: 0.133, Test loss: 1.608, Test accuracy: 65.33
Round  69, Global train loss: 0.133, Global test loss: 1.737, Global test accuracy: 39.37
Round  70, Train loss: 0.150, Test loss: 1.608, Test accuracy: 65.50
Round  70, Global train loss: 0.150, Global test loss: 1.829, Global test accuracy: 39.78
Round  71, Train loss: 0.153, Test loss: 1.619, Test accuracy: 66.02
Round  71, Global train loss: 0.153, Global test loss: 2.303, Global test accuracy: 28.61
Round  72, Train loss: 0.148, Test loss: 1.645, Test accuracy: 65.91
Round  72, Global train loss: 0.148, Global test loss: 1.832, Global test accuracy: 37.42
Round  73, Train loss: 0.145, Test loss: 1.681, Test accuracy: 65.61
Round  73, Global train loss: 0.145, Global test loss: 2.015, Global test accuracy: 37.21
Round  74, Train loss: 0.122, Test loss: 1.731, Test accuracy: 65.10
Round  74, Global train loss: 0.122, Global test loss: 1.928, Global test accuracy: 40.47
Round  75, Train loss: 0.166, Test loss: 1.720, Test accuracy: 65.25
Round  75, Global train loss: 0.166, Global test loss: 1.845, Global test accuracy: 34.94
Round  76, Train loss: 0.163, Test loss: 1.724, Test accuracy: 65.37
Round  76, Global train loss: 0.163, Global test loss: 1.770, Global test accuracy: 39.35
Round  77, Train loss: 0.135, Test loss: 1.738, Test accuracy: 65.33
Round  77, Global train loss: 0.135, Global test loss: 1.752, Global test accuracy: 43.72
Round  78, Train loss: 0.134, Test loss: 1.720, Test accuracy: 65.35
Round  78, Global train loss: 0.134, Global test loss: 1.972, Global test accuracy: 34.37
Round  79, Train loss: 0.188, Test loss: 1.719, Test accuracy: 65.30
Round  79, Global train loss: 0.188, Global test loss: 1.720, Global test accuracy: 41.02
Round  80, Train loss: 0.121, Test loss: 1.742, Test accuracy: 65.54
Round  80, Global train loss: 0.121, Global test loss: 1.761, Global test accuracy: 38.89
Round  81, Train loss: 0.121, Test loss: 1.739, Test accuracy: 65.85
Round  81, Global train loss: 0.121, Global test loss: 2.123, Global test accuracy: 32.32
Round  82, Train loss: 0.148, Test loss: 1.737, Test accuracy: 65.28
Round  82, Global train loss: 0.148, Global test loss: 1.809, Global test accuracy: 36.88
Round  83, Train loss: 0.097, Test loss: 1.749, Test accuracy: 65.56
Round  83, Global train loss: 0.097, Global test loss: 1.932, Global test accuracy: 33.81
Round  84, Train loss: 0.126, Test loss: 1.777, Test accuracy: 64.98
Round  84, Global train loss: 0.126, Global test loss: 1.897, Global test accuracy: 30.42
Round  85, Train loss: 0.115, Test loss: 1.824, Test accuracy: 65.03
Round  85, Global train loss: 0.115, Global test loss: 1.881, Global test accuracy: 36.38
Round  86, Train loss: 0.109, Test loss: 1.804, Test accuracy: 65.17
Round  86, Global train loss: 0.109, Global test loss: 1.874, Global test accuracy: 35.88
Round  87, Train loss: 0.113, Test loss: 1.809, Test accuracy: 65.55
Round  87, Global train loss: 0.113, Global test loss: 1.894, Global test accuracy: 38.47
Round  88, Train loss: 0.117, Test loss: 1.863, Test accuracy: 65.05
Round  88, Global train loss: 0.117, Global test loss: 2.105, Global test accuracy: 32.66
Round  89, Train loss: 0.122, Test loss: 1.861, Test accuracy: 65.28
Round  89, Global train loss: 0.122, Global test loss: 1.849, Global test accuracy: 30.71
Round  90, Train loss: 0.115, Test loss: 1.879, Test accuracy: 64.91
Round  90, Global train loss: 0.115, Global test loss: 2.073, Global test accuracy: 37.89
Round  91, Train loss: 0.083, Test loss: 1.939, Test accuracy: 64.54
Round  91, Global train loss: 0.083, Global test loss: 1.759, Global test accuracy: 42.24
Round  92, Train loss: 0.100, Test loss: 1.977, Test accuracy: 64.80
Round  92, Global train loss: 0.100, Global test loss: 1.856, Global test accuracy: 39.93
Round  93, Train loss: 0.112, Test loss: 1.956, Test accuracy: 65.08
Round  93, Global train loss: 0.112, Global test loss: 1.872, Global test accuracy: 34.49
Round  94, Train loss: 0.111, Test loss: 1.942, Test accuracy: 65.27
Round  94, Global train loss: 0.111, Global test loss: 1.971, Global test accuracy: 39.07
Round  95, Train loss: 0.139, Test loss: 1.952, Test accuracy: 65.02
Round  95, Global train loss: 0.139, Global test loss: 1.833, Global test accuracy: 38.74
Round  96, Train loss: 0.065, Test loss: 1.953, Test accuracy: 65.05
Round  96, Global train loss: 0.065, Global test loss: 1.733, Global test accuracy: 40.60
Round  97, Train loss: 0.071, Test loss: 2.001, Test accuracy: 65.50
Round  97, Global train loss: 0.071, Global test loss: 1.750, Global test accuracy: 37.54
Round  98, Train loss: 0.129, Test loss: 2.026, Test accuracy: 65.26
Round  98, Global train loss: 0.129, Global test loss: 1.776, Global test accuracy: 42.50
Round  99, Train loss: 0.099, Test loss: 2.038, Test accuracy: 65.14
Round  99, Global train loss: 0.099, Global test loss: 2.090, Global test accuracy: 39.24
Final Round, Train loss: 0.099, Test loss: 1.982, Test accuracy: 65.01
Final Round, Global train loss: 0.099, Global test loss: 2.090, Global test accuracy: 39.24
Average accuracy final 10 rounds: 65.057 

Average global accuracy final 10 rounds: 39.224 

1713.2524750232697
[1.7649173736572266, 3.529834747314453, 4.853400468826294, 6.176966190338135, 7.479952335357666, 8.782938480377197, 10.077287197113037, 11.371635913848877, 12.698599100112915, 14.025562286376953, 15.362998723983765, 16.700435161590576, 18.008288621902466, 19.316142082214355, 20.67495346069336, 22.033764839172363, 23.31765079498291, 24.601536750793457, 25.932296752929688, 27.263056755065918, 28.663921117782593, 30.064785480499268, 31.434677839279175, 32.80457019805908, 34.09794306755066, 35.391315937042236, 36.520140171051025, 37.648964405059814, 39.01871204376221, 40.3884596824646, 41.72250509262085, 43.0565505027771, 44.34112882614136, 45.625707149505615, 46.942909717559814, 48.260112285614014, 49.607617139816284, 50.955121994018555, 52.29774618148804, 53.64037036895752, 54.964667320251465, 56.28896427154541, 57.66689133644104, 59.04481840133667, 60.39800715446472, 61.75119590759277, 63.05148267745972, 64.35176944732666, 65.6300859451294, 66.90840244293213, 68.26140022277832, 69.61439800262451, 70.91189885139465, 72.2093997001648, 73.27944922447205, 74.3494987487793, 75.76815938949585, 77.1868200302124, 78.50175023078918, 79.81668043136597, 81.22305822372437, 82.62943601608276, 83.9551420211792, 85.28084802627563, 86.56472706794739, 87.84860610961914, 89.17879438400269, 90.50898265838623, 91.97015047073364, 93.43131828308105, 94.85315823554993, 96.2749981880188, 97.63405919075012, 98.99312019348145, 100.49071955680847, 101.9883189201355, 103.24931502342224, 104.51031112670898, 105.83185577392578, 107.15340042114258, 108.4777307510376, 109.80206108093262, 111.1450846195221, 112.48810815811157, 113.8284080028534, 115.16870784759521, 116.4984028339386, 117.82809782028198, 119.12166047096252, 120.41522312164307, 121.85437989234924, 123.29353666305542, 124.50828909873962, 125.72304153442383, 127.06152606010437, 128.4000105857849, 129.7611494064331, 131.1222882270813, 132.3981010913849, 133.67391395568848, 135.0026421546936, 136.33137035369873, 137.71272897720337, 139.094087600708, 140.23212575912476, 141.3701639175415, 142.71000623703003, 144.04984855651855, 145.44830894470215, 146.84676933288574, 148.1991856098175, 149.55160188674927, 150.87906432151794, 152.20652675628662, 153.52441120147705, 154.84229564666748, 156.1249167919159, 157.4075379371643, 158.7358591556549, 160.0641803741455, 161.5314977169037, 162.99881505966187, 164.3282985687256, 165.6577820777893, 166.98041081428528, 168.30303955078125, 169.77565050125122, 171.2482614517212, 172.55532217025757, 173.86238288879395, 175.04339718818665, 176.22441148757935, 177.63010787963867, 179.035804271698, 180.38992595672607, 181.74404764175415, 183.04876971244812, 184.3534917831421, 185.69539284706116, 187.03729391098022, 188.55942583084106, 190.0815577507019, 191.4531762599945, 192.8247947692871, 194.25891041755676, 195.69302606582642, 197.1248517036438, 198.55667734146118, 199.78899002075195, 201.02130270004272, 202.46723461151123, 203.91316652297974, 205.21199107170105, 206.51081562042236, 207.81302762031555, 209.11523962020874, 210.56506443023682, 212.0148892402649, 213.37203359603882, 214.72917795181274, 216.18913221359253, 217.64908647537231, 219.020934343338, 220.3927822113037, 221.692768573761, 222.99275493621826, 224.30400681495667, 225.61525869369507, 226.78410005569458, 227.9529414176941, 229.34496593475342, 230.73699045181274, 232.14742231369019, 233.55785417556763, 234.8985915184021, 236.23932886123657, 237.545170545578, 238.85101222991943, 240.24138855934143, 241.63176488876343, 242.96290493011475, 244.29404497146606, 245.74775385856628, 247.2014627456665, 248.3690745830536, 249.53668642044067, 250.9622278213501, 252.38776922225952, 253.8194215297699, 255.25107383728027, 256.589382648468, 257.92769145965576, 259.2989990711212, 260.67030668258667, 262.0022990703583, 263.3342914581299, 264.6731984615326, 266.0121054649353, 267.37413215637207, 268.73615884780884, 271.61923241615295, 274.50230598449707]
[24.95, 24.95, 34.56, 34.56, 39.61, 39.61, 47.53, 47.53, 51.88, 51.88, 53.44, 53.44, 54.58, 54.58, 55.9, 55.9, 56.66, 56.66, 57.56, 57.56, 58.23, 58.23, 58.04, 58.04, 58.87, 58.87, 59.86, 59.86, 61.1, 61.1, 61.66, 61.66, 61.84, 61.84, 61.96, 61.96, 62.11, 62.11, 62.39, 62.39, 62.2, 62.2, 62.52, 62.52, 63.01, 63.01, 63.13, 63.13, 63.01, 63.01, 63.4, 63.4, 63.9, 63.9, 64.21, 64.21, 63.93, 63.93, 63.28, 63.28, 63.49, 63.49, 64.01, 64.01, 63.96, 63.96, 63.7, 63.7, 63.48, 63.48, 63.55, 63.55, 63.78, 63.78, 64.01, 64.01, 63.47, 63.47, 63.82, 63.82, 63.24, 63.24, 63.4, 63.4, 63.4, 63.4, 63.86, 63.86, 63.66, 63.66, 64.11, 64.11, 64.46, 64.46, 64.99, 64.99, 64.98, 64.98, 64.22, 64.22, 64.42, 64.42, 64.71, 64.71, 64.42, 64.42, 64.74, 64.74, 64.75, 64.75, 64.54, 64.54, 64.49, 64.49, 64.75, 64.75, 65.03, 65.03, 64.56, 64.56, 64.36, 64.36, 64.72, 64.72, 65.09, 65.09, 65.37, 65.37, 64.98, 64.98, 65.47, 65.47, 65.24, 65.24, 65.69, 65.69, 65.78, 65.78, 65.33, 65.33, 65.5, 65.5, 66.02, 66.02, 65.91, 65.91, 65.61, 65.61, 65.1, 65.1, 65.25, 65.25, 65.37, 65.37, 65.33, 65.33, 65.35, 65.35, 65.3, 65.3, 65.54, 65.54, 65.85, 65.85, 65.28, 65.28, 65.56, 65.56, 64.98, 64.98, 65.03, 65.03, 65.17, 65.17, 65.55, 65.55, 65.05, 65.05, 65.28, 65.28, 64.91, 64.91, 64.54, 64.54, 64.8, 64.8, 65.08, 65.08, 65.27, 65.27, 65.02, 65.02, 65.05, 65.05, 65.5, 65.5, 65.26, 65.26, 65.14, 65.14, 65.01, 65.01]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.627, Test loss: 2.032, Test accuracy: 18.39
Round   0, Global train loss: 1.627, Global test loss: 2.254, Global test accuracy: 13.15
Round   1, Train loss: 1.415, Test loss: 1.772, Test accuracy: 31.95
Round   1, Global train loss: 1.415, Global test loss: 2.095, Global test accuracy: 23.58
Round   2, Train loss: 1.315, Test loss: 1.600, Test accuracy: 37.29
Round   2, Global train loss: 1.315, Global test loss: 2.052, Global test accuracy: 26.06
Round   3, Train loss: 1.217, Test loss: 1.358, Test accuracy: 46.87
Round   3, Global train loss: 1.217, Global test loss: 1.755, Global test accuracy: 36.55
Round   4, Train loss: 1.156, Test loss: 1.337, Test accuracy: 47.82
Round   4, Global train loss: 1.156, Global test loss: 1.949, Global test accuracy: 33.52
Round   5, Train loss: 1.157, Test loss: 1.207, Test accuracy: 53.48
Round   5, Global train loss: 1.157, Global test loss: 1.752, Global test accuracy: 36.71
Round   6, Train loss: 1.078, Test loss: 1.096, Test accuracy: 57.03
Round   6, Global train loss: 1.078, Global test loss: 1.533, Global test accuracy: 46.97
Round   7, Train loss: 1.066, Test loss: 1.041, Test accuracy: 59.24
Round   7, Global train loss: 1.066, Global test loss: 1.660, Global test accuracy: 42.09
Round   8, Train loss: 1.055, Test loss: 1.039, Test accuracy: 59.62
Round   8, Global train loss: 1.055, Global test loss: 1.505, Global test accuracy: 45.94
Round   9, Train loss: 0.998, Test loss: 1.000, Test accuracy: 60.92
Round   9, Global train loss: 0.998, Global test loss: 1.740, Global test accuracy: 42.23
Round  10, Train loss: 0.985, Test loss: 0.977, Test accuracy: 61.75
Round  10, Global train loss: 0.985, Global test loss: 1.603, Global test accuracy: 40.31
Round  11, Train loss: 0.930, Test loss: 0.952, Test accuracy: 62.70
Round  11, Global train loss: 0.930, Global test loss: 1.546, Global test accuracy: 46.38
Round  12, Train loss: 0.931, Test loss: 0.936, Test accuracy: 63.29
Round  12, Global train loss: 0.931, Global test loss: 1.517, Global test accuracy: 45.26
Round  13, Train loss: 0.929, Test loss: 0.920, Test accuracy: 63.95
Round  13, Global train loss: 0.929, Global test loss: 1.332, Global test accuracy: 52.09
Round  14, Train loss: 0.877, Test loss: 0.922, Test accuracy: 64.10
Round  14, Global train loss: 0.877, Global test loss: 1.380, Global test accuracy: 50.23
Round  15, Train loss: 0.806, Test loss: 0.907, Test accuracy: 64.87
Round  15, Global train loss: 0.806, Global test loss: 1.416, Global test accuracy: 49.11
Round  16, Train loss: 0.821, Test loss: 0.895, Test accuracy: 65.43
Round  16, Global train loss: 0.821, Global test loss: 1.260, Global test accuracy: 55.51
Round  17, Train loss: 0.786, Test loss: 0.876, Test accuracy: 66.34
Round  17, Global train loss: 0.786, Global test loss: 1.500, Global test accuracy: 47.50
Round  18, Train loss: 0.827, Test loss: 0.870, Test accuracy: 66.50
Round  18, Global train loss: 0.827, Global test loss: 1.399, Global test accuracy: 52.36
Round  19, Train loss: 0.851, Test loss: 0.857, Test accuracy: 66.97
Round  19, Global train loss: 0.851, Global test loss: 1.476, Global test accuracy: 50.32
Round  20, Train loss: 0.766, Test loss: 0.860, Test accuracy: 66.91
Round  20, Global train loss: 0.766, Global test loss: 1.390, Global test accuracy: 52.06
Round  21, Train loss: 0.776, Test loss: 0.853, Test accuracy: 66.99
Round  21, Global train loss: 0.776, Global test loss: 1.336, Global test accuracy: 53.67
Round  22, Train loss: 0.792, Test loss: 0.840, Test accuracy: 67.59
Round  22, Global train loss: 0.792, Global test loss: 1.443, Global test accuracy: 49.08
Round  23, Train loss: 0.748, Test loss: 0.833, Test accuracy: 68.17
Round  23, Global train loss: 0.748, Global test loss: 1.322, Global test accuracy: 55.57
Round  24, Train loss: 0.689, Test loss: 0.820, Test accuracy: 69.01
Round  24, Global train loss: 0.689, Global test loss: 1.411, Global test accuracy: 50.99
Round  25, Train loss: 0.730, Test loss: 0.823, Test accuracy: 68.85
Round  25, Global train loss: 0.730, Global test loss: 1.238, Global test accuracy: 59.31
Round  26, Train loss: 0.704, Test loss: 0.816, Test accuracy: 69.15
Round  26, Global train loss: 0.704, Global test loss: 1.418, Global test accuracy: 51.95
Round  27, Train loss: 0.697, Test loss: 0.800, Test accuracy: 69.89
Round  27, Global train loss: 0.697, Global test loss: 1.232, Global test accuracy: 57.06
Round  28, Train loss: 0.633, Test loss: 0.811, Test accuracy: 69.60
Round  28, Global train loss: 0.633, Global test loss: 1.393, Global test accuracy: 52.86
Round  29, Train loss: 0.661, Test loss: 0.790, Test accuracy: 70.41
Round  29, Global train loss: 0.661, Global test loss: 1.240, Global test accuracy: 58.01
Round  30, Train loss: 0.604, Test loss: 0.777, Test accuracy: 71.00
Round  30, Global train loss: 0.604, Global test loss: 1.198, Global test accuracy: 58.20
Round  31, Train loss: 0.653, Test loss: 0.774, Test accuracy: 71.40
Round  31, Global train loss: 0.653, Global test loss: 1.221, Global test accuracy: 59.56
Round  32, Train loss: 0.603, Test loss: 0.768, Test accuracy: 71.74
Round  32, Global train loss: 0.603, Global test loss: 1.196, Global test accuracy: 60.22
Round  33, Train loss: 0.588, Test loss: 0.773, Test accuracy: 71.56
Round  33, Global train loss: 0.588, Global test loss: 1.260, Global test accuracy: 57.89
Round  34, Train loss: 0.607, Test loss: 0.782, Test accuracy: 71.36
Round  34, Global train loss: 0.607, Global test loss: 1.379, Global test accuracy: 53.76
Round  35, Train loss: 0.587, Test loss: 0.784, Test accuracy: 71.45
Round  35, Global train loss: 0.587, Global test loss: 1.311, Global test accuracy: 57.40
Round  36, Train loss: 0.555, Test loss: 0.792, Test accuracy: 71.72
Round  36, Global train loss: 0.555, Global test loss: 1.333, Global test accuracy: 56.70
Round  37, Train loss: 0.612, Test loss: 0.779, Test accuracy: 72.24
Round  37, Global train loss: 0.612, Global test loss: 1.117, Global test accuracy: 60.85
Round  38, Train loss: 0.550, Test loss: 0.787, Test accuracy: 72.00
Round  38, Global train loss: 0.550, Global test loss: 1.267, Global test accuracy: 58.23
Round  39, Train loss: 0.586, Test loss: 0.776, Test accuracy: 72.34
Round  39, Global train loss: 0.586, Global test loss: 1.101, Global test accuracy: 62.30
Round  40, Train loss: 0.556, Test loss: 0.773, Test accuracy: 72.48
Round  40, Global train loss: 0.556, Global test loss: 1.241, Global test accuracy: 58.45
Round  41, Train loss: 0.497, Test loss: 0.775, Test accuracy: 72.59
Round  41, Global train loss: 0.497, Global test loss: 1.174, Global test accuracy: 60.71
Round  42, Train loss: 0.476, Test loss: 0.782, Test accuracy: 72.58
Round  42, Global train loss: 0.476, Global test loss: 1.103, Global test accuracy: 63.41
Round  43, Train loss: 0.487, Test loss: 0.776, Test accuracy: 72.67
Round  43, Global train loss: 0.487, Global test loss: 1.288, Global test accuracy: 58.25
Round  44, Train loss: 0.566, Test loss: 0.770, Test accuracy: 73.00
Round  44, Global train loss: 0.566, Global test loss: 1.457, Global test accuracy: 50.58
Round  45, Train loss: 0.510, Test loss: 0.768, Test accuracy: 73.08
Round  45, Global train loss: 0.510, Global test loss: 1.132, Global test accuracy: 61.77
Round  46, Train loss: 0.534, Test loss: 0.765, Test accuracy: 73.33
Round  46, Global train loss: 0.534, Global test loss: 1.095, Global test accuracy: 62.51
Round  47, Train loss: 0.526, Test loss: 0.777, Test accuracy: 73.04
Round  47, Global train loss: 0.526, Global test loss: 1.234, Global test accuracy: 59.28
Round  48, Train loss: 0.481, Test loss: 0.782, Test accuracy: 73.25
Round  48, Global train loss: 0.481, Global test loss: 1.215, Global test accuracy: 60.30
Round  49, Train loss: 0.502, Test loss: 0.764, Test accuracy: 73.52
Round  49, Global train loss: 0.502, Global test loss: 1.040, Global test accuracy: 64.96
Round  50, Train loss: 0.445, Test loss: 0.777, Test accuracy: 73.54
Round  50, Global train loss: 0.445, Global test loss: 1.159, Global test accuracy: 62.75
Round  51, Train loss: 0.447, Test loss: 0.772, Test accuracy: 73.81
Round  51, Global train loss: 0.447, Global test loss: 1.203, Global test accuracy: 61.11
Round  52, Train loss: 0.512, Test loss: 0.795, Test accuracy: 73.24
Round  52, Global train loss: 0.512, Global test loss: 1.212, Global test accuracy: 60.47
Round  53, Train loss: 0.431, Test loss: 0.812, Test accuracy: 73.36
Round  53, Global train loss: 0.431, Global test loss: 1.248, Global test accuracy: 60.05
Round  54, Train loss: 0.452, Test loss: 0.798, Test accuracy: 73.94
Round  54, Global train loss: 0.452, Global test loss: 1.247, Global test accuracy: 60.22
Round  55, Train loss: 0.407, Test loss: 0.789, Test accuracy: 73.86
Round  55, Global train loss: 0.407, Global test loss: 1.096, Global test accuracy: 64.51
Round  56, Train loss: 0.426, Test loss: 0.777, Test accuracy: 74.37
Round  56, Global train loss: 0.426, Global test loss: 1.286, Global test accuracy: 59.09
Round  57, Train loss: 0.462, Test loss: 0.789, Test accuracy: 74.23
Round  57, Global train loss: 0.462, Global test loss: 1.212, Global test accuracy: 62.44
Round  58, Train loss: 0.378, Test loss: 0.796, Test accuracy: 74.06
Round  58, Global train loss: 0.378, Global test loss: 1.256, Global test accuracy: 60.64
Round  59, Train loss: 0.446, Test loss: 0.823, Test accuracy: 73.36
Round  59, Global train loss: 0.446, Global test loss: 1.242, Global test accuracy: 60.87
Round  60, Train loss: 0.438, Test loss: 0.831, Test accuracy: 73.30
Round  60, Global train loss: 0.438, Global test loss: 1.091, Global test accuracy: 63.92
Round  61, Train loss: 0.454, Test loss: 0.853, Test accuracy: 72.96
Round  61, Global train loss: 0.454, Global test loss: 1.112, Global test accuracy: 62.69
Round  62, Train loss: 0.408, Test loss: 0.856, Test accuracy: 73.19
Round  62, Global train loss: 0.408, Global test loss: 1.433, Global test accuracy: 57.64
Round  63, Train loss: 0.358, Test loss: 0.852, Test accuracy: 73.42
Round  63, Global train loss: 0.358, Global test loss: 1.290, Global test accuracy: 59.91
Round  64, Train loss: 0.409, Test loss: 0.835, Test accuracy: 73.74
Round  64, Global train loss: 0.409, Global test loss: 1.241, Global test accuracy: 60.73
Round  65, Train loss: 0.398, Test loss: 0.849, Test accuracy: 73.52
Round  65, Global train loss: 0.398, Global test loss: 1.267, Global test accuracy: 61.65
Round  66, Train loss: 0.377, Test loss: 0.857, Test accuracy: 73.64
Round  66, Global train loss: 0.377, Global test loss: 1.343, Global test accuracy: 60.76
Round  67, Train loss: 0.386, Test loss: 0.856, Test accuracy: 73.87
Round  67, Global train loss: 0.386, Global test loss: 1.244, Global test accuracy: 61.12
Round  68, Train loss: 0.385, Test loss: 0.847, Test accuracy: 73.83
Round  68, Global train loss: 0.385, Global test loss: 1.151, Global test accuracy: 62.50
Round  69, Train loss: 0.336, Test loss: 0.832, Test accuracy: 73.91
Round  69, Global train loss: 0.336, Global test loss: 1.322, Global test accuracy: 61.34
Round  70, Train loss: 0.337, Test loss: 0.815, Test accuracy: 74.46
Round  70, Global train loss: 0.337, Global test loss: 1.228, Global test accuracy: 62.96
Round  71, Train loss: 0.366, Test loss: 0.793, Test accuracy: 75.27
Round  71, Global train loss: 0.366, Global test loss: 1.269, Global test accuracy: 60.53
Round  72, Train loss: 0.328, Test loss: 0.806, Test accuracy: 74.96
Round  72, Global train loss: 0.328, Global test loss: 1.337, Global test accuracy: 60.92
Round  73, Train loss: 0.406, Test loss: 0.806, Test accuracy: 75.43
Round  73, Global train loss: 0.406, Global test loss: 1.093, Global test accuracy: 64.88
Round  74, Train loss: 0.375, Test loss: 0.825, Test accuracy: 74.99
Round  74, Global train loss: 0.375, Global test loss: 1.156, Global test accuracy: 63.25
Round  75, Train loss: 0.330, Test loss: 0.818, Test accuracy: 75.42
Round  75, Global train loss: 0.330, Global test loss: 1.234, Global test accuracy: 62.53
Round  76, Train loss: 0.318, Test loss: 0.813, Test accuracy: 75.57
Round  76, Global train loss: 0.318, Global test loss: 1.244, Global test accuracy: 62.87
Round  77, Train loss: 0.380, Test loss: 0.806, Test accuracy: 75.79
Round  77, Global train loss: 0.380, Global test loss: 1.161, Global test accuracy: 63.36
Round  78, Train loss: 0.366, Test loss: 0.820, Test accuracy: 75.71
Round  78, Global train loss: 0.366, Global test loss: 1.299, Global test accuracy: 61.61
Round  79, Train loss: 0.322, Test loss: 0.828, Test accuracy: 75.27
Round  79, Global train loss: 0.322, Global test loss: 1.130, Global test accuracy: 64.97
Round  80, Train loss: 0.362, Test loss: 0.822, Test accuracy: 75.25
Round  80, Global train loss: 0.362, Global test loss: 1.158, Global test accuracy: 63.58
Round  81, Train loss: 0.336, Test loss: 0.827, Test accuracy: 75.37
Round  81, Global train loss: 0.336, Global test loss: 1.340, Global test accuracy: 61.81
Round  82, Train loss: 0.365, Test loss: 0.848, Test accuracy: 75.08
Round  82, Global train loss: 0.365, Global test loss: 1.245, Global test accuracy: 62.90
Round  83, Train loss: 0.358, Test loss: 0.873, Test accuracy: 74.61
Round  83, Global train loss: 0.358, Global test loss: 1.312, Global test accuracy: 62.07
Round  84, Train loss: 0.352, Test loss: 0.852, Test accuracy: 74.78
Round  84, Global train loss: 0.352, Global test loss: 1.179, Global test accuracy: 64.18
Round  85, Train loss: 0.290, Test loss: 0.878, Test accuracy: 74.64
Round  85, Global train loss: 0.290, Global test loss: 1.305, Global test accuracy: 62.34
Round  86, Train loss: 0.345, Test loss: 0.875, Test accuracy: 75.06
Round  86, Global train loss: 0.345, Global test loss: 1.184, Global test accuracy: 64.61
Round  87, Train loss: 0.298, Test loss: 0.886, Test accuracy: 74.94
Round  87, Global train loss: 0.298, Global test loss: 1.269, Global test accuracy: 63.67
Round  88, Train loss: 0.339, Test loss: 0.886, Test accuracy: 74.69
Round  88, Global train loss: 0.339, Global test loss: 1.073, Global test accuracy: 66.64
Round  89, Train loss: 0.323, Test loss: 0.900, Test accuracy: 74.81
Round  89, Global train loss: 0.323, Global test loss: 1.267, Global test accuracy: 61.88
Round  90, Train loss: 0.278, Test loss: 0.887, Test accuracy: 74.94
Round  90, Global train loss: 0.278, Global test loss: 1.303, Global test accuracy: 65.21
Round  91, Train loss: 0.341, Test loss: 0.864, Test accuracy: 75.66
Round  91, Global train loss: 0.341, Global test loss: 1.235, Global test accuracy: 63.35
Round  92, Train loss: 0.304, Test loss: 0.848, Test accuracy: 76.11
Round  92, Global train loss: 0.304, Global test loss: 1.179, Global test accuracy: 65.36
Round  93, Train loss: 0.281, Test loss: 0.853, Test accuracy: 75.98
Round  93, Global train loss: 0.281, Global test loss: 1.167, Global test accuracy: 65.10
Round  94, Train loss: 0.267, Test loss: 0.854, Test accuracy: 76.01
Round  94, Global train loss: 0.267, Global test loss: 1.150, Global test accuracy: 67.06
Round  95, Train loss: 0.320, Test loss: 0.842, Test accuracy: 76.13
Round  95, Global train loss: 0.320, Global test loss: 1.158, Global test accuracy: 66.36
Round  96, Train loss: 0.289, Test loss: 0.853, Test accuracy: 75.97
Round  96, Global train loss: 0.289, Global test loss: 1.077, Global test accuracy: 68.06
Round  97, Train loss: 0.330, Test loss: 0.848, Test accuracy: 76.13
Round  97, Global train loss: 0.330, Global test loss: 1.385, Global test accuracy: 62.99
Round  98, Train loss: 0.273, Test loss: 0.844, Test accuracy: 76.26
Round  98, Global train loss: 0.273, Global test loss: 1.473, Global test accuracy: 62.18
Round  99, Train loss: 0.270, Test loss: 0.863, Test accuracy: 76.17
Round  99, Global train loss: 0.270, Global test loss: 1.392, Global test accuracy: 62.68
Final Round, Train loss: 0.228, Test loss: 0.930, Test accuracy: 76.64
Final Round, Global train loss: 0.228, Global test loss: 1.392, Global test accuracy: 62.68
Average accuracy final 10 rounds: 75.936 

Average global accuracy final 10 rounds: 64.835 

1728.0250961780548
[1.6537806987762451, 3.3075613975524902, 4.7893266677856445, 6.271091938018799, 7.7514941692352295, 9.23189640045166, 10.578153133392334, 11.924409866333008, 13.285010814666748, 14.645611763000488, 15.94274640083313, 17.23988103866577, 18.53350019454956, 19.82711935043335, 21.139816522598267, 22.452513694763184, 23.77859663963318, 25.104679584503174, 26.475839376449585, 27.846999168395996, 29.167627573013306, 30.488255977630615, 31.832435369491577, 33.17661476135254, 34.59909653663635, 36.021578311920166, 37.43343710899353, 38.845295906066895, 40.257079124450684, 41.66886234283447, 42.99839544296265, 44.32792854309082, 45.73400831222534, 47.14008808135986, 48.45924401283264, 49.77839994430542, 51.14576601982117, 52.513132095336914, 53.814327001571655, 55.1155219078064, 56.4816038608551, 57.84768581390381, 59.169010639190674, 60.49033546447754, 61.747833490371704, 63.00533151626587, 64.3167712688446, 65.62821102142334, 67.00058889389038, 68.37296676635742, 69.58729147911072, 70.80161619186401, 71.97976422309875, 73.1579122543335, 74.45532631874084, 75.7527403831482, 77.07478189468384, 78.39682340621948, 79.69989109039307, 81.00295877456665, 82.29628038406372, 83.58960199356079, 84.89629626274109, 86.20299053192139, 87.70814251899719, 89.213294506073, 90.60971546173096, 92.00613641738892, 93.51388430595398, 95.02163219451904, 96.33351755142212, 97.6454029083252, 98.78967428207397, 99.93394565582275, 101.25116610527039, 102.56838655471802, 103.8622350692749, 105.15608358383179, 106.4729835987091, 107.78988361358643, 108.87265396118164, 109.95542430877686, 111.28294157981873, 112.6104588508606, 113.92002725601196, 115.22959566116333, 116.52137660980225, 117.81315755844116, 119.1487078666687, 120.48425817489624, 121.78020977973938, 123.07616138458252, 124.47610282897949, 125.87604427337646, 127.3115816116333, 128.74711894989014, 130.05264949798584, 131.35818004608154, 132.4458773136139, 133.53357458114624, 134.8080940246582, 136.08261346817017, 137.3485722541809, 138.61453104019165, 139.79139184951782, 140.968252658844, 142.1386260986328, 143.30899953842163, 144.41426396369934, 145.51952838897705, 146.8599932193756, 148.20045804977417, 149.7718231678009, 151.34318828582764, 152.7557713985443, 154.168354511261, 155.57085466384888, 156.97335481643677, 158.59552788734436, 160.21770095825195, 161.66722655296326, 163.11675214767456, 164.6068787574768, 166.09700536727905, 167.57252144813538, 169.0480375289917, 170.54355144500732, 172.03906536102295, 173.45581102371216, 174.87255668640137, 176.20136976242065, 177.53018283843994, 178.86078548431396, 180.191388130188, 181.50143694877625, 182.8114857673645, 184.15282273292542, 185.49415969848633, 186.81075072288513, 188.12734174728394, 189.55956602096558, 190.99179029464722, 192.355366230011, 193.71894216537476, 195.2284562587738, 196.73797035217285, 198.18896794319153, 199.6399655342102, 201.05054712295532, 202.46112871170044, 203.7775275707245, 205.09392642974854, 206.52302813529968, 207.95212984085083, 209.32937455177307, 210.7066192626953, 212.0275022983551, 213.3483853340149, 214.67894530296326, 216.00950527191162, 217.37208700180054, 218.73466873168945, 220.21239852905273, 221.69012832641602, 223.00870299339294, 224.32727766036987, 225.68384885787964, 227.0404200553894, 228.53197622299194, 230.02353239059448, 231.39385509490967, 232.76417779922485, 234.13579058647156, 235.50740337371826, 236.9225721359253, 238.33774089813232, 239.6519386768341, 240.9661364555359, 242.4278702735901, 243.8896040916443, 245.2675838470459, 246.6455636024475, 248.1222927570343, 249.5990219116211, 251.02423286437988, 252.44944381713867, 253.85805821418762, 255.26667261123657, 256.69882345199585, 258.1309742927551, 259.50026750564575, 260.8695607185364, 262.2073826789856, 263.5452046394348, 264.7987072467804, 266.052209854126, 267.3283267021179, 268.60444355010986, 270.12229919433594, 271.640154838562, 274.5082926750183, 277.3764305114746]
[18.39, 18.39, 31.95, 31.95, 37.29, 37.29, 46.87, 46.87, 47.82, 47.82, 53.48, 53.48, 57.03, 57.03, 59.24, 59.24, 59.62, 59.62, 60.92, 60.92, 61.75, 61.75, 62.7, 62.7, 63.29, 63.29, 63.95, 63.95, 64.1, 64.1, 64.87, 64.87, 65.43, 65.43, 66.34, 66.34, 66.5, 66.5, 66.97, 66.97, 66.91, 66.91, 66.99, 66.99, 67.59, 67.59, 68.17, 68.17, 69.01, 69.01, 68.85, 68.85, 69.15, 69.15, 69.89, 69.89, 69.6, 69.6, 70.41, 70.41, 71.0, 71.0, 71.4, 71.4, 71.74, 71.74, 71.56, 71.56, 71.36, 71.36, 71.45, 71.45, 71.72, 71.72, 72.24, 72.24, 72.0, 72.0, 72.34, 72.34, 72.48, 72.48, 72.59, 72.59, 72.58, 72.58, 72.67, 72.67, 73.0, 73.0, 73.08, 73.08, 73.33, 73.33, 73.04, 73.04, 73.25, 73.25, 73.52, 73.52, 73.54, 73.54, 73.81, 73.81, 73.24, 73.24, 73.36, 73.36, 73.94, 73.94, 73.86, 73.86, 74.37, 74.37, 74.23, 74.23, 74.06, 74.06, 73.36, 73.36, 73.3, 73.3, 72.96, 72.96, 73.19, 73.19, 73.42, 73.42, 73.74, 73.74, 73.52, 73.52, 73.64, 73.64, 73.87, 73.87, 73.83, 73.83, 73.91, 73.91, 74.46, 74.46, 75.27, 75.27, 74.96, 74.96, 75.43, 75.43, 74.99, 74.99, 75.42, 75.42, 75.57, 75.57, 75.79, 75.79, 75.71, 75.71, 75.27, 75.27, 75.25, 75.25, 75.37, 75.37, 75.08, 75.08, 74.61, 74.61, 74.78, 74.78, 74.64, 74.64, 75.06, 75.06, 74.94, 74.94, 74.69, 74.69, 74.81, 74.81, 74.94, 74.94, 75.66, 75.66, 76.11, 76.11, 75.98, 75.98, 76.01, 76.01, 76.13, 76.13, 75.97, 75.97, 76.13, 76.13, 76.26, 76.26, 76.17, 76.17, 76.64, 76.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.592, Test loss: 2.092, Test accuracy: 18.80
Round   0, Global train loss: 1.592, Global test loss: 2.324, Global test accuracy: 12.15
Round   1, Train loss: 1.454, Test loss: 2.005, Test accuracy: 24.91
Round   1, Global train loss: 1.454, Global test loss: 2.403, Global test accuracy: 14.49
Round   2, Train loss: 1.358, Test loss: 1.572, Test accuracy: 39.88
Round   2, Global train loss: 1.358, Global test loss: 1.961, Global test accuracy: 30.14
Round   3, Train loss: 1.261, Test loss: 1.474, Test accuracy: 44.53
Round   3, Global train loss: 1.261, Global test loss: 1.783, Global test accuracy: 38.06
Round   4, Train loss: 1.220, Test loss: 1.283, Test accuracy: 49.72
Round   4, Global train loss: 1.220, Global test loss: 1.886, Global test accuracy: 32.32
Round   5, Train loss: 1.190, Test loss: 1.224, Test accuracy: 51.27
Round   5, Global train loss: 1.190, Global test loss: 1.777, Global test accuracy: 36.63
Round   6, Train loss: 1.115, Test loss: 1.120, Test accuracy: 55.43
Round   6, Global train loss: 1.115, Global test loss: 1.645, Global test accuracy: 40.76
Round   7, Train loss: 1.100, Test loss: 1.107, Test accuracy: 55.70
Round   7, Global train loss: 1.100, Global test loss: 1.654, Global test accuracy: 39.73
Round   8, Train loss: 1.053, Test loss: 1.092, Test accuracy: 57.73
Round   8, Global train loss: 1.053, Global test loss: 1.723, Global test accuracy: 40.87
Round   9, Train loss: 1.034, Test loss: 1.001, Test accuracy: 59.87
Round   9, Global train loss: 1.034, Global test loss: 1.717, Global test accuracy: 40.64
Round  10, Train loss: 1.016, Test loss: 0.972, Test accuracy: 60.91
Round  10, Global train loss: 1.016, Global test loss: 1.482, Global test accuracy: 45.60
Round  11, Train loss: 1.000, Test loss: 0.963, Test accuracy: 61.72
Round  11, Global train loss: 1.000, Global test loss: 1.636, Global test accuracy: 42.74
Round  12, Train loss: 0.951, Test loss: 0.965, Test accuracy: 61.62
Round  12, Global train loss: 0.951, Global test loss: 1.530, Global test accuracy: 47.14
Round  13, Train loss: 0.950, Test loss: 0.942, Test accuracy: 62.63
Round  13, Global train loss: 0.950, Global test loss: 1.396, Global test accuracy: 50.09
Round  14, Train loss: 0.953, Test loss: 0.935, Test accuracy: 63.13
Round  14, Global train loss: 0.953, Global test loss: 1.561, Global test accuracy: 46.21
Round  15, Train loss: 0.948, Test loss: 0.914, Test accuracy: 64.35
Round  15, Global train loss: 0.948, Global test loss: 1.427, Global test accuracy: 50.93
Round  16, Train loss: 0.923, Test loss: 0.909, Test accuracy: 64.83
Round  16, Global train loss: 0.923, Global test loss: 1.377, Global test accuracy: 50.50
Round  17, Train loss: 0.837, Test loss: 0.902, Test accuracy: 65.16
Round  17, Global train loss: 0.837, Global test loss: 1.354, Global test accuracy: 53.71
Round  18, Train loss: 0.792, Test loss: 0.877, Test accuracy: 66.12
Round  18, Global train loss: 0.792, Global test loss: 1.424, Global test accuracy: 51.94
Round  19, Train loss: 0.840, Test loss: 0.877, Test accuracy: 66.39
Round  19, Global train loss: 0.840, Global test loss: 1.352, Global test accuracy: 54.25
Round  20, Train loss: 0.821, Test loss: 0.883, Test accuracy: 65.84
Round  20, Global train loss: 0.821, Global test loss: 1.525, Global test accuracy: 48.54
Round  21, Train loss: 0.812, Test loss: 0.860, Test accuracy: 66.87
Round  21, Global train loss: 0.812, Global test loss: 1.339, Global test accuracy: 52.86
Round  22, Train loss: 0.860, Test loss: 0.849, Test accuracy: 67.49
Round  22, Global train loss: 0.860, Global test loss: 1.273, Global test accuracy: 52.74
Round  23, Train loss: 0.820, Test loss: 0.857, Test accuracy: 67.14
Round  23, Global train loss: 0.820, Global test loss: 1.308, Global test accuracy: 55.23
Round  24, Train loss: 0.813, Test loss: 0.833, Test accuracy: 68.09
Round  24, Global train loss: 0.813, Global test loss: 1.321, Global test accuracy: 54.25
Round  25, Train loss: 0.763, Test loss: 0.824, Test accuracy: 68.76
Round  25, Global train loss: 0.763, Global test loss: 1.183, Global test accuracy: 58.99
Round  26, Train loss: 0.774, Test loss: 0.823, Test accuracy: 68.40
Round  26, Global train loss: 0.774, Global test loss: 1.214, Global test accuracy: 57.13
Round  27, Train loss: 0.703, Test loss: 0.830, Test accuracy: 68.48
Round  27, Global train loss: 0.703, Global test loss: 1.337, Global test accuracy: 54.57
Round  28, Train loss: 0.746, Test loss: 0.825, Test accuracy: 68.95
Round  28, Global train loss: 0.746, Global test loss: 1.268, Global test accuracy: 56.72
Round  29, Train loss: 0.773, Test loss: 0.792, Test accuracy: 70.21
Round  29, Global train loss: 0.773, Global test loss: 1.224, Global test accuracy: 56.21
Round  30, Train loss: 0.656, Test loss: 0.791, Test accuracy: 70.49
Round  30, Global train loss: 0.656, Global test loss: 1.344, Global test accuracy: 54.87
Round  31, Train loss: 0.710, Test loss: 0.791, Test accuracy: 70.78
Round  31, Global train loss: 0.710, Global test loss: 1.171, Global test accuracy: 59.25
Round  32, Train loss: 0.717, Test loss: 0.775, Test accuracy: 71.06
Round  32, Global train loss: 0.717, Global test loss: 1.168, Global test accuracy: 60.06
Round  33, Train loss: 0.665, Test loss: 0.777, Test accuracy: 71.26
Round  33, Global train loss: 0.665, Global test loss: 1.115, Global test accuracy: 61.77
Round  34, Train loss: 0.622, Test loss: 0.783, Test accuracy: 71.14
Round  34, Global train loss: 0.622, Global test loss: 1.112, Global test accuracy: 61.48
Round  35, Train loss: 0.625, Test loss: 0.796, Test accuracy: 70.86
Round  35, Global train loss: 0.625, Global test loss: 1.208, Global test accuracy: 58.24
Round  36, Train loss: 0.648, Test loss: 0.800, Test accuracy: 71.02
Round  36, Global train loss: 0.648, Global test loss: 1.210, Global test accuracy: 57.87
Round  37, Train loss: 0.642, Test loss: 0.772, Test accuracy: 71.99
Round  37, Global train loss: 0.642, Global test loss: 1.119, Global test accuracy: 60.60
Round  38, Train loss: 0.589, Test loss: 0.759, Test accuracy: 72.40
Round  38, Global train loss: 0.589, Global test loss: 1.150, Global test accuracy: 60.70
Round  39, Train loss: 0.581, Test loss: 0.761, Test accuracy: 72.45
Round  39, Global train loss: 0.581, Global test loss: 1.162, Global test accuracy: 61.27
Round  40, Train loss: 0.581, Test loss: 0.779, Test accuracy: 71.98
Round  40, Global train loss: 0.581, Global test loss: 1.428, Global test accuracy: 54.95
Round  41, Train loss: 0.645, Test loss: 0.779, Test accuracy: 72.14
Round  41, Global train loss: 0.645, Global test loss: 1.263, Global test accuracy: 56.38
Round  42, Train loss: 0.543, Test loss: 0.778, Test accuracy: 72.32
Round  42, Global train loss: 0.543, Global test loss: 1.323, Global test accuracy: 60.90
Round  43, Train loss: 0.552, Test loss: 0.806, Test accuracy: 71.47
Round  43, Global train loss: 0.552, Global test loss: 1.355, Global test accuracy: 59.53
Round  44, Train loss: 0.595, Test loss: 0.795, Test accuracy: 71.97
Round  44, Global train loss: 0.595, Global test loss: 1.119, Global test accuracy: 62.53
Round  45, Train loss: 0.553, Test loss: 0.771, Test accuracy: 72.67
Round  45, Global train loss: 0.553, Global test loss: 1.266, Global test accuracy: 57.34
Round  46, Train loss: 0.586, Test loss: 0.768, Test accuracy: 72.66
Round  46, Global train loss: 0.586, Global test loss: 1.133, Global test accuracy: 62.38
Round  47, Train loss: 0.580, Test loss: 0.787, Test accuracy: 72.44
Round  47, Global train loss: 0.580, Global test loss: 1.229, Global test accuracy: 59.41
Round  48, Train loss: 0.512, Test loss: 0.768, Test accuracy: 72.90
Round  48, Global train loss: 0.512, Global test loss: 1.216, Global test accuracy: 61.56
Round  49, Train loss: 0.554, Test loss: 0.789, Test accuracy: 72.17
Round  49, Global train loss: 0.554, Global test loss: 1.277, Global test accuracy: 57.53
Round  50, Train loss: 0.529, Test loss: 0.784, Test accuracy: 72.70
Round  50, Global train loss: 0.529, Global test loss: 1.311, Global test accuracy: 57.47
Round  51, Train loss: 0.574, Test loss: 0.770, Test accuracy: 73.09
Round  51, Global train loss: 0.574, Global test loss: 1.111, Global test accuracy: 63.24
Round  52, Train loss: 0.524, Test loss: 0.762, Test accuracy: 73.51
Round  52, Global train loss: 0.524, Global test loss: 1.103, Global test accuracy: 63.49
Round  53, Train loss: 0.543, Test loss: 0.761, Test accuracy: 73.97
Round  53, Global train loss: 0.543, Global test loss: 1.190, Global test accuracy: 61.37
Round  54, Train loss: 0.525, Test loss: 0.768, Test accuracy: 74.08
Round  54, Global train loss: 0.525, Global test loss: 1.197, Global test accuracy: 60.69
Round  55, Train loss: 0.503, Test loss: 0.788, Test accuracy: 73.67
Round  55, Global train loss: 0.503, Global test loss: 1.118, Global test accuracy: 63.27
Round  56, Train loss: 0.525, Test loss: 0.782, Test accuracy: 73.58
Round  56, Global train loss: 0.525, Global test loss: 1.076, Global test accuracy: 63.50
Round  57, Train loss: 0.515, Test loss: 0.784, Test accuracy: 73.63
Round  57, Global train loss: 0.515, Global test loss: 1.121, Global test accuracy: 62.52
Round  58, Train loss: 0.476, Test loss: 0.777, Test accuracy: 73.94
Round  58, Global train loss: 0.476, Global test loss: 1.261, Global test accuracy: 60.03
Round  59, Train loss: 0.477, Test loss: 0.771, Test accuracy: 74.37
Round  59, Global train loss: 0.477, Global test loss: 1.208, Global test accuracy: 61.37
Round  60, Train loss: 0.508, Test loss: 0.782, Test accuracy: 73.99
Round  60, Global train loss: 0.508, Global test loss: 1.167, Global test accuracy: 61.24
Round  61, Train loss: 0.438, Test loss: 0.782, Test accuracy: 73.94
Round  61, Global train loss: 0.438, Global test loss: 1.146, Global test accuracy: 62.77
Round  62, Train loss: 0.441, Test loss: 0.794, Test accuracy: 73.65
Round  62, Global train loss: 0.441, Global test loss: 1.313, Global test accuracy: 58.59
Round  63, Train loss: 0.448, Test loss: 0.785, Test accuracy: 73.88
Round  63, Global train loss: 0.448, Global test loss: 1.149, Global test accuracy: 62.41
Round  64, Train loss: 0.452, Test loss: 0.779, Test accuracy: 74.00
Round  64, Global train loss: 0.452, Global test loss: 1.044, Global test accuracy: 65.53
Round  65, Train loss: 0.505, Test loss: 0.768, Test accuracy: 74.78
Round  65, Global train loss: 0.505, Global test loss: 1.177, Global test accuracy: 62.09
Round  66, Train loss: 0.472, Test loss: 0.778, Test accuracy: 74.43
Round  66, Global train loss: 0.472, Global test loss: 1.040, Global test accuracy: 65.36
Round  67, Train loss: 0.446, Test loss: 0.802, Test accuracy: 73.77
Round  67, Global train loss: 0.446, Global test loss: 1.108, Global test accuracy: 63.92
Round  68, Train loss: 0.443, Test loss: 0.774, Test accuracy: 74.71
Round  68, Global train loss: 0.443, Global test loss: 1.094, Global test accuracy: 65.17
Round  69, Train loss: 0.481, Test loss: 0.778, Test accuracy: 74.71
Round  69, Global train loss: 0.481, Global test loss: 1.057, Global test accuracy: 65.10
Round  70, Train loss: 0.425, Test loss: 0.794, Test accuracy: 74.30
Round  70, Global train loss: 0.425, Global test loss: 1.090, Global test accuracy: 64.28
Round  71, Train loss: 0.447, Test loss: 0.793, Test accuracy: 74.40
Round  71, Global train loss: 0.447, Global test loss: 1.102, Global test accuracy: 63.83
Round  72, Train loss: 0.442, Test loss: 0.790, Test accuracy: 75.00
Round  72, Global train loss: 0.442, Global test loss: 1.171, Global test accuracy: 63.58
Round  73, Train loss: 0.403, Test loss: 0.808, Test accuracy: 74.45
Round  73, Global train loss: 0.403, Global test loss: 1.253, Global test accuracy: 63.56
Round  74, Train loss: 0.466, Test loss: 0.816, Test accuracy: 74.00
Round  74, Global train loss: 0.466, Global test loss: 1.285, Global test accuracy: 61.26
Round  75, Train loss: 0.424, Test loss: 0.795, Test accuracy: 74.44
Round  75, Global train loss: 0.424, Global test loss: 1.073, Global test accuracy: 65.15
Round  76, Train loss: 0.428, Test loss: 0.808, Test accuracy: 74.70
Round  76, Global train loss: 0.428, Global test loss: 1.181, Global test accuracy: 62.81
Round  77, Train loss: 0.393, Test loss: 0.796, Test accuracy: 74.97
Round  77, Global train loss: 0.393, Global test loss: 1.076, Global test accuracy: 65.44
Round  78, Train loss: 0.379, Test loss: 0.818, Test accuracy: 74.64
Round  78, Global train loss: 0.379, Global test loss: 1.204, Global test accuracy: 64.80
Round  79, Train loss: 0.395, Test loss: 0.812, Test accuracy: 74.96
Round  79, Global train loss: 0.395, Global test loss: 1.163, Global test accuracy: 64.09
Round  80, Train loss: 0.418, Test loss: 0.809, Test accuracy: 75.17
Round  80, Global train loss: 0.418, Global test loss: 1.256, Global test accuracy: 62.27
Round  81, Train loss: 0.416, Test loss: 0.816, Test accuracy: 74.78
Round  81, Global train loss: 0.416, Global test loss: 1.222, Global test accuracy: 62.09
Round  82, Train loss: 0.386, Test loss: 0.793, Test accuracy: 75.18
Round  82, Global train loss: 0.386, Global test loss: 1.159, Global test accuracy: 64.35
Round  83, Train loss: 0.363, Test loss: 0.790, Test accuracy: 75.31
Round  83, Global train loss: 0.363, Global test loss: 1.087, Global test accuracy: 65.40
Round  84, Train loss: 0.381, Test loss: 0.797, Test accuracy: 74.90
Round  84, Global train loss: 0.381, Global test loss: 1.175, Global test accuracy: 65.53
Round  85, Train loss: 0.390, Test loss: 0.793, Test accuracy: 74.98
Round  85, Global train loss: 0.390, Global test loss: 1.312, Global test accuracy: 60.57
Round  86, Train loss: 0.352, Test loss: 0.796, Test accuracy: 74.77
Round  86, Global train loss: 0.352, Global test loss: 1.081, Global test accuracy: 66.29
Round  87, Train loss: 0.398, Test loss: 0.798, Test accuracy: 74.82
Round  87, Global train loss: 0.398, Global test loss: 1.155, Global test accuracy: 64.06
Round  88, Train loss: 0.390, Test loss: 0.794, Test accuracy: 75.07
Round  88, Global train loss: 0.390, Global test loss: 1.016, Global test accuracy: 67.24
Round  89, Train loss: 0.398, Test loss: 0.806, Test accuracy: 74.97
Round  89, Global train loss: 0.398, Global test loss: 1.054, Global test accuracy: 66.45
Round  90, Train loss: 0.402, Test loss: 0.820, Test accuracy: 74.77
Round  90, Global train loss: 0.402, Global test loss: 1.137, Global test accuracy: 64.27
Round  91, Train loss: 0.353, Test loss: 0.819, Test accuracy: 74.92
Round  91, Global train loss: 0.353, Global test loss: 1.243, Global test accuracy: 62.68
Round  92, Train loss: 0.371, Test loss: 0.846, Test accuracy: 74.34
Round  92, Global train loss: 0.371, Global test loss: 1.172, Global test accuracy: 64.00
Round  93, Train loss: 0.375, Test loss: 0.828, Test accuracy: 74.92
Round  93, Global train loss: 0.375, Global test loss: 1.216, Global test accuracy: 64.24
Round  94, Train loss: 0.363, Test loss: 0.833, Test accuracy: 74.62
Round  94, Global train loss: 0.363, Global test loss: 1.177, Global test accuracy: 64.46
Round  95, Train loss: 0.346, Test loss: 0.859, Test accuracy: 74.35
Round  95, Global train loss: 0.346, Global test loss: 1.193, Global test accuracy: 63.89/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.355, Test loss: 0.841, Test accuracy: 75.04
Round  96, Global train loss: 0.355, Global test loss: 1.090, Global test accuracy: 66.60
Round  97, Train loss: 0.355, Test loss: 0.847, Test accuracy: 74.75
Round  97, Global train loss: 0.355, Global test loss: 1.195, Global test accuracy: 65.26
Round  98, Train loss: 0.342, Test loss: 0.844, Test accuracy: 74.82
Round  98, Global train loss: 0.342, Global test loss: 1.178, Global test accuracy: 64.94
Round  99, Train loss: 0.310, Test loss: 0.853, Test accuracy: 74.82
Round  99, Global train loss: 0.310, Global test loss: 1.214, Global test accuracy: 65.80
Final Round, Train loss: 0.276, Test loss: 0.855, Test accuracy: 76.57
Final Round, Global train loss: 0.276, Global test loss: 1.214, Global test accuracy: 65.80
Average accuracy final 10 rounds: 74.735 

Average global accuracy final 10 rounds: 64.614 

1759.2372601032257
[1.8479623794555664, 3.695924758911133, 5.157376289367676, 6.618827819824219, 8.043002128601074, 9.46717643737793, 11.077566146850586, 12.687955856323242, 14.217662811279297, 15.747369766235352, 17.172346591949463, 18.597323417663574, 19.84179449081421, 21.086265563964844, 22.562657833099365, 24.039050102233887, 25.535658359527588, 27.03226661682129, 28.73762083053589, 30.44297504425049, 32.00459313392639, 33.566211223602295, 35.08801317214966, 36.60981512069702, 38.0123565196991, 39.41489791870117, 40.81104636192322, 42.207194805145264, 43.46042609214783, 44.71365737915039, 46.117709159851074, 47.52176094055176, 49.04810357093811, 50.57444620132446, 52.10811638832092, 53.64178657531738, 55.081809997558594, 56.521833419799805, 58.05588364601135, 59.5899338722229, 61.15578866004944, 62.72164344787598, 64.39774942398071, 66.07385540008545, 67.48294520378113, 68.8920350074768, 70.29151320457458, 71.69099140167236, 73.01489686965942, 74.33880233764648, 75.74841785430908, 77.15803337097168, 78.56497001647949, 79.9719066619873, 81.40717649459839, 82.84244632720947, 84.28674149513245, 85.73103666305542, 87.12172055244446, 88.5124044418335, 89.85657596588135, 91.2007474899292, 92.63333368301392, 94.06591987609863, 95.67411231994629, 97.28230476379395, 98.74884724617004, 100.21538972854614, 101.71458411216736, 103.21377849578857, 104.67698335647583, 106.14018821716309, 107.73815059661865, 109.33611297607422, 110.84189438819885, 112.34767580032349, 113.98876714706421, 115.62985849380493, 117.10418629646301, 118.5785140991211, 120.00807666778564, 121.4376392364502, 123.11815595626831, 124.79867267608643, 126.15878343582153, 127.51889419555664, 128.8672227859497, 130.21555137634277, 131.64183497428894, 133.0681185722351, 134.45875692367554, 135.84939527511597, 137.02726864814758, 138.2051420211792, 139.60727787017822, 141.00941371917725, 142.64414429664612, 144.278874874115, 145.66771626472473, 147.05655765533447, 148.5910336971283, 150.12550973892212, 151.75146079063416, 153.3774118423462, 154.78662037849426, 156.19582891464233, 157.7570447921753, 159.31826066970825, 160.78064489364624, 162.24302911758423, 163.66308975219727, 165.0831503868103, 166.9984850883484, 168.91381978988647, 170.4035563468933, 171.89329290390015, 173.3355052471161, 174.77771759033203, 176.02026963233948, 177.26282167434692, 178.89011549949646, 180.517409324646, 182.1921730041504, 183.86693668365479, 185.39441347122192, 186.92189025878906, 188.42944312095642, 189.93699598312378, 191.53595161437988, 193.134907245636, 194.85057044029236, 196.56623363494873, 197.85787105560303, 199.14950847625732, 200.69436192512512, 202.23921537399292, 203.76175141334534, 205.28428745269775, 206.75873184204102, 208.23317623138428, 209.71882677078247, 211.20447731018066, 212.70462155342102, 214.20476579666138, 215.873517036438, 217.5422682762146, 218.88321709632874, 220.22416591644287, 221.6216917037964, 223.0192174911499, 224.47247099876404, 225.92572450637817, 227.34534668922424, 228.7649688720703, 230.29236888885498, 231.81976890563965, 233.54174637794495, 235.26372385025024, 236.6653871536255, 238.06705045700073, 239.54099035263062, 241.0149302482605, 242.49268865585327, 243.97044706344604, 245.38266825675964, 246.79488945007324, 248.21141839027405, 249.62794733047485, 251.1176633834839, 252.60737943649292, 253.9870502948761, 255.36672115325928, 256.77943682670593, 258.1921525001526, 259.61273288726807, 261.03331327438354, 262.45765376091003, 263.8819942474365, 265.39816069602966, 266.9143271446228, 268.32165455818176, 269.7289819717407, 270.97519278526306, 272.2214035987854, 273.61698627471924, 275.0125689506531, 276.4350337982178, 277.85749864578247, 279.2746374607086, 280.69177627563477, 282.11464285850525, 283.53750944137573, 284.9291138648987, 286.32071828842163, 287.73702096939087, 289.1533236503601, 290.57558393478394, 291.99784421920776, 293.44455575942993, 294.8912672996521, 297.98276925086975, 301.0742712020874]
[18.8, 18.8, 24.91, 24.91, 39.88, 39.88, 44.53, 44.53, 49.72, 49.72, 51.27, 51.27, 55.43, 55.43, 55.7, 55.7, 57.73, 57.73, 59.87, 59.87, 60.91, 60.91, 61.72, 61.72, 61.62, 61.62, 62.63, 62.63, 63.13, 63.13, 64.35, 64.35, 64.83, 64.83, 65.16, 65.16, 66.12, 66.12, 66.39, 66.39, 65.84, 65.84, 66.87, 66.87, 67.49, 67.49, 67.14, 67.14, 68.09, 68.09, 68.76, 68.76, 68.4, 68.4, 68.48, 68.48, 68.95, 68.95, 70.21, 70.21, 70.49, 70.49, 70.78, 70.78, 71.06, 71.06, 71.26, 71.26, 71.14, 71.14, 70.86, 70.86, 71.02, 71.02, 71.99, 71.99, 72.4, 72.4, 72.45, 72.45, 71.98, 71.98, 72.14, 72.14, 72.32, 72.32, 71.47, 71.47, 71.97, 71.97, 72.67, 72.67, 72.66, 72.66, 72.44, 72.44, 72.9, 72.9, 72.17, 72.17, 72.7, 72.7, 73.09, 73.09, 73.51, 73.51, 73.97, 73.97, 74.08, 74.08, 73.67, 73.67, 73.58, 73.58, 73.63, 73.63, 73.94, 73.94, 74.37, 74.37, 73.99, 73.99, 73.94, 73.94, 73.65, 73.65, 73.88, 73.88, 74.0, 74.0, 74.78, 74.78, 74.43, 74.43, 73.77, 73.77, 74.71, 74.71, 74.71, 74.71, 74.3, 74.3, 74.4, 74.4, 75.0, 75.0, 74.45, 74.45, 74.0, 74.0, 74.44, 74.44, 74.7, 74.7, 74.97, 74.97, 74.64, 74.64, 74.96, 74.96, 75.17, 75.17, 74.78, 74.78, 75.18, 75.18, 75.31, 75.31, 74.9, 74.9, 74.98, 74.98, 74.77, 74.77, 74.82, 74.82, 75.07, 75.07, 74.97, 74.97, 74.77, 74.77, 74.92, 74.92, 74.34, 74.34, 74.92, 74.92, 74.62, 74.62, 74.35, 74.35, 75.04, 75.04, 74.75, 74.75, 74.82, 74.82, 74.82, 74.82, 76.57, 76.57]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.584, Test loss: 2.026, Test accuracy: 26.98
Round   0, Global train loss: 1.584, Global test loss: 2.214, Global test accuracy: 23.47
Round   1, Train loss: 1.441, Test loss: 1.881, Test accuracy: 30.16
Round   1, Global train loss: 1.441, Global test loss: 2.150, Global test accuracy: 23.25
Round   2, Train loss: 1.311, Test loss: 1.552, Test accuracy: 40.81
Round   2, Global train loss: 1.311, Global test loss: 1.910, Global test accuracy: 33.61
Round   3, Train loss: 1.234, Test loss: 1.430, Test accuracy: 43.76
Round   3, Global train loss: 1.234, Global test loss: 2.015, Global test accuracy: 26.95
Round   4, Train loss: 1.190, Test loss: 1.389, Test accuracy: 47.48
Round   4, Global train loss: 1.190, Global test loss: 1.963, Global test accuracy: 32.38
Round   5, Train loss: 1.110, Test loss: 1.189, Test accuracy: 53.81
Round   5, Global train loss: 1.110, Global test loss: 1.693, Global test accuracy: 40.92
Round   6, Train loss: 1.071, Test loss: 1.175, Test accuracy: 54.72
Round   6, Global train loss: 1.071, Global test loss: 2.137, Global test accuracy: 35.65
Round   7, Train loss: 1.034, Test loss: 1.137, Test accuracy: 55.33
Round   7, Global train loss: 1.034, Global test loss: 1.794, Global test accuracy: 36.95
Round   8, Train loss: 1.030, Test loss: 1.123, Test accuracy: 57.03
Round   8, Global train loss: 1.030, Global test loss: 1.605, Global test accuracy: 44.05
Round   9, Train loss: 0.996, Test loss: 1.091, Test accuracy: 58.36
Round   9, Global train loss: 0.996, Global test loss: 1.536, Global test accuracy: 45.39
Round  10, Train loss: 0.939, Test loss: 1.088, Test accuracy: 58.46
Round  10, Global train loss: 0.939, Global test loss: 1.519, Global test accuracy: 46.95
Round  11, Train loss: 0.947, Test loss: 1.065, Test accuracy: 59.81
Round  11, Global train loss: 0.947, Global test loss: 1.456, Global test accuracy: 49.73
Round  12, Train loss: 0.912, Test loss: 1.026, Test accuracy: 60.91
Round  12, Global train loss: 0.912, Global test loss: 1.639, Global test accuracy: 45.02
Round  13, Train loss: 0.899, Test loss: 1.006, Test accuracy: 61.61
Round  13, Global train loss: 0.899, Global test loss: 1.414, Global test accuracy: 51.05
Round  14, Train loss: 0.890, Test loss: 0.980, Test accuracy: 62.81
Round  14, Global train loss: 0.890, Global test loss: 1.562, Global test accuracy: 47.07
Round  15, Train loss: 0.868, Test loss: 0.964, Test accuracy: 62.98
Round  15, Global train loss: 0.868, Global test loss: 1.593, Global test accuracy: 44.81
Round  16, Train loss: 0.792, Test loss: 0.954, Test accuracy: 63.99
Round  16, Global train loss: 0.792, Global test loss: 1.407, Global test accuracy: 50.32
Round  17, Train loss: 0.831, Test loss: 0.930, Test accuracy: 65.27
Round  17, Global train loss: 0.831, Global test loss: 1.500, Global test accuracy: 51.58
Round  18, Train loss: 0.761, Test loss: 0.913, Test accuracy: 66.12
Round  18, Global train loss: 0.761, Global test loss: 1.471, Global test accuracy: 49.71
Round  19, Train loss: 0.831, Test loss: 0.891, Test accuracy: 66.95
Round  19, Global train loss: 0.831, Global test loss: 1.647, Global test accuracy: 46.18
Round  20, Train loss: 0.751, Test loss: 0.896, Test accuracy: 67.22
Round  20, Global train loss: 0.751, Global test loss: 1.579, Global test accuracy: 48.42
Round  21, Train loss: 0.731, Test loss: 0.913, Test accuracy: 66.85
Round  21, Global train loss: 0.731, Global test loss: 1.483, Global test accuracy: 51.55
Round  22, Train loss: 0.702, Test loss: 0.923, Test accuracy: 66.43
Round  22, Global train loss: 0.702, Global test loss: 1.417, Global test accuracy: 50.12
Round  23, Train loss: 0.712, Test loss: 0.880, Test accuracy: 68.10
Round  23, Global train loss: 0.712, Global test loss: 1.532, Global test accuracy: 52.40
Round  24, Train loss: 0.740, Test loss: 0.883, Test accuracy: 67.67
Round  24, Global train loss: 0.740, Global test loss: 1.431, Global test accuracy: 52.12
Round  25, Train loss: 0.687, Test loss: 0.869, Test accuracy: 68.46
Round  25, Global train loss: 0.687, Global test loss: 1.518, Global test accuracy: 51.48
Round  26, Train loss: 0.688, Test loss: 0.852, Test accuracy: 68.94
Round  26, Global train loss: 0.688, Global test loss: 1.374, Global test accuracy: 52.56
Round  27, Train loss: 0.625, Test loss: 0.825, Test accuracy: 69.77
Round  27, Global train loss: 0.625, Global test loss: 1.457, Global test accuracy: 51.87
Round  28, Train loss: 0.639, Test loss: 0.845, Test accuracy: 69.41
Round  28, Global train loss: 0.639, Global test loss: 1.485, Global test accuracy: 52.48
Round  29, Train loss: 0.636, Test loss: 0.837, Test accuracy: 69.97
Round  29, Global train loss: 0.636, Global test loss: 1.301, Global test accuracy: 55.64
Round  30, Train loss: 0.580, Test loss: 0.854, Test accuracy: 69.62
Round  30, Global train loss: 0.580, Global test loss: 1.350, Global test accuracy: 56.04
Round  31, Train loss: 0.604, Test loss: 0.824, Test accuracy: 70.03
Round  31, Global train loss: 0.604, Global test loss: 1.511, Global test accuracy: 52.47
Round  32, Train loss: 0.611, Test loss: 0.830, Test accuracy: 70.04
Round  32, Global train loss: 0.611, Global test loss: 1.279, Global test accuracy: 58.23
Round  33, Train loss: 0.623, Test loss: 0.826, Test accuracy: 70.51
Round  33, Global train loss: 0.623, Global test loss: 1.229, Global test accuracy: 58.20
Round  34, Train loss: 0.597, Test loss: 0.841, Test accuracy: 70.61
Round  34, Global train loss: 0.597, Global test loss: 1.195, Global test accuracy: 59.68
Round  35, Train loss: 0.585, Test loss: 0.853, Test accuracy: 70.30
Round  35, Global train loss: 0.585, Global test loss: 1.288, Global test accuracy: 56.23
Round  36, Train loss: 0.580, Test loss: 0.822, Test accuracy: 71.29
Round  36, Global train loss: 0.580, Global test loss: 1.236, Global test accuracy: 60.21
Round  37, Train loss: 0.532, Test loss: 0.829, Test accuracy: 71.24
Round  37, Global train loss: 0.532, Global test loss: 1.184, Global test accuracy: 61.17
Round  38, Train loss: 0.548, Test loss: 0.835, Test accuracy: 71.20
Round  38, Global train loss: 0.548, Global test loss: 1.269, Global test accuracy: 59.37
Round  39, Train loss: 0.502, Test loss: 0.824, Test accuracy: 71.62
Round  39, Global train loss: 0.502, Global test loss: 1.236, Global test accuracy: 59.95
Round  40, Train loss: 0.508, Test loss: 0.822, Test accuracy: 71.52
Round  40, Global train loss: 0.508, Global test loss: 1.251, Global test accuracy: 60.19
Round  41, Train loss: 0.603, Test loss: 0.812, Test accuracy: 71.64
Round  41, Global train loss: 0.603, Global test loss: 1.199, Global test accuracy: 60.64
Round  42, Train loss: 0.491, Test loss: 0.802, Test accuracy: 71.84
Round  42, Global train loss: 0.491, Global test loss: 1.243, Global test accuracy: 61.41
Round  43, Train loss: 0.486, Test loss: 0.803, Test accuracy: 71.92
Round  43, Global train loss: 0.486, Global test loss: 1.235, Global test accuracy: 58.61
Round  44, Train loss: 0.524, Test loss: 0.815, Test accuracy: 71.55
Round  44, Global train loss: 0.524, Global test loss: 1.166, Global test accuracy: 61.45
Round  45, Train loss: 0.571, Test loss: 0.811, Test accuracy: 71.78
Round  45, Global train loss: 0.571, Global test loss: 1.046, Global test accuracy: 64.17
Round  46, Train loss: 0.510, Test loss: 0.784, Test accuracy: 72.68
Round  46, Global train loss: 0.510, Global test loss: 1.219, Global test accuracy: 59.59
Round  47, Train loss: 0.480, Test loss: 0.807, Test accuracy: 72.33
Round  47, Global train loss: 0.480, Global test loss: 1.215, Global test accuracy: 60.03
Round  48, Train loss: 0.486, Test loss: 0.839, Test accuracy: 71.81
Round  48, Global train loss: 0.486, Global test loss: 1.056, Global test accuracy: 64.58
Round  49, Train loss: 0.485, Test loss: 0.843, Test accuracy: 72.08
Round  49, Global train loss: 0.485, Global test loss: 1.148, Global test accuracy: 62.47
Round  50, Train loss: 0.483, Test loss: 0.861, Test accuracy: 72.05
Round  50, Global train loss: 0.483, Global test loss: 1.361, Global test accuracy: 58.99
Round  51, Train loss: 0.474, Test loss: 0.842, Test accuracy: 72.68
Round  51, Global train loss: 0.474, Global test loss: 1.151, Global test accuracy: 63.57
Round  52, Train loss: 0.472, Test loss: 0.843, Test accuracy: 72.27
Round  52, Global train loss: 0.472, Global test loss: 1.224, Global test accuracy: 60.28
Round  53, Train loss: 0.449, Test loss: 0.845, Test accuracy: 72.21
Round  53, Global train loss: 0.449, Global test loss: 1.324, Global test accuracy: 60.57
Round  54, Train loss: 0.464, Test loss: 0.838, Test accuracy: 72.39
Round  54, Global train loss: 0.464, Global test loss: 1.165, Global test accuracy: 62.70
Round  55, Train loss: 0.427, Test loss: 0.844, Test accuracy: 72.63
Round  55, Global train loss: 0.427, Global test loss: 1.163, Global test accuracy: 63.06
Round  56, Train loss: 0.447, Test loss: 0.858, Test accuracy: 72.60
Round  56, Global train loss: 0.447, Global test loss: 1.333, Global test accuracy: 61.28
Round  57, Train loss: 0.413, Test loss: 0.851, Test accuracy: 73.03
Round  57, Global train loss: 0.413, Global test loss: 1.332, Global test accuracy: 59.68
Round  58, Train loss: 0.421, Test loss: 0.822, Test accuracy: 73.67
Round  58, Global train loss: 0.421, Global test loss: 1.356, Global test accuracy: 59.13
Round  59, Train loss: 0.388, Test loss: 0.831, Test accuracy: 73.47
Round  59, Global train loss: 0.388, Global test loss: 1.157, Global test accuracy: 63.60
Round  60, Train loss: 0.425, Test loss: 0.845, Test accuracy: 73.35
Round  60, Global train loss: 0.425, Global test loss: 1.047, Global test accuracy: 65.33
Round  61, Train loss: 0.418, Test loss: 0.852, Test accuracy: 73.56
Round  61, Global train loss: 0.418, Global test loss: 1.063, Global test accuracy: 65.28
Round  62, Train loss: 0.375, Test loss: 0.832, Test accuracy: 74.33
Round  62, Global train loss: 0.375, Global test loss: 1.326, Global test accuracy: 59.33
Round  63, Train loss: 0.355, Test loss: 0.839, Test accuracy: 74.10
Round  63, Global train loss: 0.355, Global test loss: 1.355, Global test accuracy: 58.90
Round  64, Train loss: 0.455, Test loss: 0.859, Test accuracy: 73.87
Round  64, Global train loss: 0.455, Global test loss: 1.176, Global test accuracy: 62.23
Round  65, Train loss: 0.374, Test loss: 0.855, Test accuracy: 73.84
Round  65, Global train loss: 0.374, Global test loss: 1.184, Global test accuracy: 62.56
Round  66, Train loss: 0.412, Test loss: 0.850, Test accuracy: 73.80
Round  66, Global train loss: 0.412, Global test loss: 1.208, Global test accuracy: 62.03
Round  67, Train loss: 0.402, Test loss: 0.854, Test accuracy: 73.91
Round  67, Global train loss: 0.402, Global test loss: 1.301, Global test accuracy: 61.24
Round  68, Train loss: 0.369, Test loss: 0.847, Test accuracy: 74.07
Round  68, Global train loss: 0.369, Global test loss: 1.088, Global test accuracy: 64.74
Round  69, Train loss: 0.360, Test loss: 0.849, Test accuracy: 74.14
Round  69, Global train loss: 0.360, Global test loss: 1.187, Global test accuracy: 63.55
Round  70, Train loss: 0.388, Test loss: 0.865, Test accuracy: 73.70
Round  70, Global train loss: 0.388, Global test loss: 1.227, Global test accuracy: 62.48
Round  71, Train loss: 0.367, Test loss: 0.867, Test accuracy: 74.07
Round  71, Global train loss: 0.367, Global test loss: 1.085, Global test accuracy: 65.73
Round  72, Train loss: 0.352, Test loss: 0.863, Test accuracy: 74.50
Round  72, Global train loss: 0.352, Global test loss: 1.171, Global test accuracy: 64.64
Round  73, Train loss: 0.335, Test loss: 0.862, Test accuracy: 74.47
Round  73, Global train loss: 0.335, Global test loss: 1.248, Global test accuracy: 62.52
Round  74, Train loss: 0.321, Test loss: 0.846, Test accuracy: 74.93
Round  74, Global train loss: 0.321, Global test loss: 1.338, Global test accuracy: 61.19
Round  75, Train loss: 0.389, Test loss: 0.852, Test accuracy: 74.73
Round  75, Global train loss: 0.389, Global test loss: 1.453, Global test accuracy: 57.03
Round  76, Train loss: 0.336, Test loss: 0.860, Test accuracy: 74.42
Round  76, Global train loss: 0.336, Global test loss: 1.178, Global test accuracy: 64.36
Round  77, Train loss: 0.331, Test loss: 0.857, Test accuracy: 74.55
Round  77, Global train loss: 0.331, Global test loss: 1.229, Global test accuracy: 64.38
Round  78, Train loss: 0.310, Test loss: 0.850, Test accuracy: 75.10
Round  78, Global train loss: 0.310, Global test loss: 1.317, Global test accuracy: 62.72
Round  79, Train loss: 0.337, Test loss: 0.844, Test accuracy: 75.24
Round  79, Global train loss: 0.337, Global test loss: 1.517, Global test accuracy: 58.53
Round  80, Train loss: 0.367, Test loss: 0.852, Test accuracy: 75.23
Round  80, Global train loss: 0.367, Global test loss: 1.079, Global test accuracy: 65.80
Round  81, Train loss: 0.349, Test loss: 0.853, Test accuracy: 75.09
Round  81, Global train loss: 0.349, Global test loss: 1.090, Global test accuracy: 65.48
Round  82, Train loss: 0.334, Test loss: 0.848, Test accuracy: 74.99
Round  82, Global train loss: 0.334, Global test loss: 1.196, Global test accuracy: 63.96
Round  83, Train loss: 0.325, Test loss: 0.874, Test accuracy: 74.34
Round  83, Global train loss: 0.325, Global test loss: 1.142, Global test accuracy: 65.50
Round  84, Train loss: 0.339, Test loss: 0.876, Test accuracy: 74.61
Round  84, Global train loss: 0.339, Global test loss: 1.113, Global test accuracy: 65.17
Round  85, Train loss: 0.312, Test loss: 0.896, Test accuracy: 74.39
Round  85, Global train loss: 0.312, Global test loss: 1.508, Global test accuracy: 57.89
Round  86, Train loss: 0.334, Test loss: 0.875, Test accuracy: 74.80
Round  86, Global train loss: 0.334, Global test loss: 1.220, Global test accuracy: 63.00
Round  87, Train loss: 0.271, Test loss: 0.871, Test accuracy: 74.85
Round  87, Global train loss: 0.271, Global test loss: 1.296, Global test accuracy: 63.26
Round  88, Train loss: 0.290, Test loss: 0.864, Test accuracy: 74.63
Round  88, Global train loss: 0.290, Global test loss: 1.163, Global test accuracy: 65.59
Round  89, Train loss: 0.266, Test loss: 0.867, Test accuracy: 75.21
Round  89, Global train loss: 0.266, Global test loss: 1.241, Global test accuracy: 64.68
Round  90, Train loss: 0.320, Test loss: 0.881, Test accuracy: 75.10
Round  90, Global train loss: 0.320, Global test loss: 1.413, Global test accuracy: 61.04
Round  91, Train loss: 0.260, Test loss: 0.878, Test accuracy: 75.28
Round  91, Global train loss: 0.260, Global test loss: 1.221, Global test accuracy: 64.94
Round  92, Train loss: 0.302, Test loss: 0.880, Test accuracy: 75.21
Round  92, Global train loss: 0.302, Global test loss: 1.142, Global test accuracy: 65.97
Round  93, Train loss: 0.268, Test loss: 0.889, Test accuracy: 75.33
Round  93, Global train loss: 0.268, Global test loss: 1.298, Global test accuracy: 65.31
Round  94, Train loss: 0.310, Test loss: 0.879, Test accuracy: 75.39
Round  94, Global train loss: 0.310, Global test loss: 1.094, Global test accuracy: 66.99
Round  95, Train loss: 0.285, Test loss: 0.868, Test accuracy: 75.32
Round  95, Global train loss: 0.285, Global test loss: 1.206, Global test accuracy: 65.45
Round  96, Train loss: 0.289, Test loss: 0.865, Test accuracy: 75.31
Round  96, Global train loss: 0.289, Global test loss: 1.144, Global test accuracy: 66.82
Round  97, Train loss: 0.325, Test loss: 0.850, Test accuracy: 75.63
Round  97, Global train loss: 0.325, Global test loss: 1.201, Global test accuracy: 63.61
Round  98, Train loss: 0.311, Test loss: 0.876, Test accuracy: 75.68
Round  98, Global train loss: 0.311, Global test loss: 1.356, Global test accuracy: 62.01
Round  99, Train loss: 0.292, Test loss: 0.866, Test accuracy: 75.88
Round  99, Global train loss: 0.292, Global test loss: 1.236, Global test accuracy: 64.87
Final Round, Train loss: 0.225, Test loss: 0.949, Test accuracy: 75.36
Final Round, Global train loss: 0.225, Global test loss: 1.236, Global test accuracy: 64.87
Average accuracy final 10 rounds: 75.413
Average global accuracy final 10 rounds: 64.701
2527.475188970566
[3.3620450496673584, 6.684105634689331, 9.924485921859741, 13.097814559936523, 16.479332208633423, 19.527405261993408, 22.748125076293945, 26.00176167488098, 29.30484104156494, 32.37729549407959, 35.32843375205994, 38.551189661026, 41.711952924728394, 45.0581476688385, 48.17866492271423, 51.23138427734375, 54.628767013549805, 58.02008104324341, 61.453031063079834, 64.75119853019714, 67.74784970283508, 70.75649881362915, 73.7191321849823, 76.91922402381897, 80.05977129936218, 83.08792567253113, 86.0631308555603, 89.17429065704346, 92.24723958969116, 95.26902961730957, 98.67344737052917, 101.60026335716248, 105.15891098976135, 108.30110692977905, 111.34886860847473, 114.46710801124573, 117.43284225463867, 120.77010011672974, 123.79659509658813, 127.023677110672, 130.10228967666626, 133.30198979377747, 136.55017709732056, 139.80967569351196, 143.11522006988525, 146.20533418655396, 149.39091444015503, 152.5265610218048, 155.94364714622498, 158.90331530570984, 162.0998980998993, 165.04958629608154, 168.14809155464172, 171.30560159683228, 174.56530618667603, 177.52884483337402, 180.70187425613403, 183.7188754081726, 186.83043146133423, 190.0988748073578, 193.1556453704834, 196.43756341934204, 199.41768431663513, 202.81681060791016, 206.20457649230957, 209.53633904457092, 212.62587666511536, 215.81156468391418, 218.86037015914917, 221.91001439094543, 224.88281559944153, 228.31717658042908, 231.30213117599487, 234.57679843902588, 237.66590404510498, 240.67305397987366, 243.69089102745056, 246.9315905570984, 249.94082641601562, 253.09661030769348, 256.0330014228821, 259.09976720809937, 262.495863199234, 265.860249042511, 269.08282828330994, 272.295946598053, 275.34003233909607, 278.85406374931335, 282.0343840122223, 285.14835500717163, 288.2526316642761, 291.37154507637024, 294.67956733703613, 297.94272017478943, 300.99274611473083, 303.9814863204956, 307.21993350982666, 310.4088935852051, 313.41940450668335, 316.5155100822449, 322.37353897094727]
[26.98, 30.16, 40.81, 43.76, 47.48, 53.81, 54.72, 55.33, 57.03, 58.36, 58.46, 59.81, 60.91, 61.61, 62.81, 62.98, 63.99, 65.27, 66.12, 66.95, 67.22, 66.85, 66.43, 68.1, 67.67, 68.46, 68.94, 69.77, 69.41, 69.97, 69.62, 70.03, 70.04, 70.51, 70.61, 70.3, 71.29, 71.24, 71.2, 71.62, 71.52, 71.64, 71.84, 71.92, 71.55, 71.78, 72.68, 72.33, 71.81, 72.08, 72.05, 72.68, 72.27, 72.21, 72.39, 72.63, 72.6, 73.03, 73.67, 73.47, 73.35, 73.56, 74.33, 74.1, 73.87, 73.84, 73.8, 73.91, 74.07, 74.14, 73.7, 74.07, 74.5, 74.47, 74.93, 74.73, 74.42, 74.55, 75.1, 75.24, 75.23, 75.09, 74.99, 74.34, 74.61, 74.39, 74.8, 74.85, 74.63, 75.21, 75.1, 75.28, 75.21, 75.33, 75.39, 75.32, 75.31, 75.63, 75.68, 75.88, 75.36]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.942, Test loss: 2.210, Test accuracy: 19.40
Round   1, Train loss: 1.515, Test loss: 1.987, Test accuracy: 22.34
Round   2, Train loss: 1.372, Test loss: 1.572, Test accuracy: 40.90
Round   3, Train loss: 1.280, Test loss: 1.472, Test accuracy: 47.27
Round   4, Train loss: 1.249, Test loss: 1.466, Test accuracy: 46.61
Round   5, Train loss: 1.154, Test loss: 1.333, Test accuracy: 50.01
Round   6, Train loss: 1.114, Test loss: 1.167, Test accuracy: 55.94
Round   7, Train loss: 1.109, Test loss: 1.240, Test accuracy: 53.60
Round   8, Train loss: 1.074, Test loss: 1.240, Test accuracy: 53.11
Round   9, Train loss: 1.056, Test loss: 1.048, Test accuracy: 58.80
Round  10, Train loss: 0.968, Test loss: 1.023, Test accuracy: 60.11
Round  11, Train loss: 0.987, Test loss: 1.069, Test accuracy: 58.33
Round  12, Train loss: 0.971, Test loss: 0.986, Test accuracy: 61.73
Round  13, Train loss: 1.004, Test loss: 0.945, Test accuracy: 62.70
Round  14, Train loss: 0.953, Test loss: 0.888, Test accuracy: 64.71
Round  15, Train loss: 0.898, Test loss: 0.856, Test accuracy: 66.76
Round  16, Train loss: 0.922, Test loss: 0.845, Test accuracy: 67.46
Round  17, Train loss: 0.858, Test loss: 0.819, Test accuracy: 67.79
Round  18, Train loss: 0.859, Test loss: 0.817, Test accuracy: 68.43
Round  19, Train loss: 0.883, Test loss: 0.803, Test accuracy: 69.18
Round  20, Train loss: 0.835, Test loss: 0.800, Test accuracy: 69.11
Round  21, Train loss: 0.866, Test loss: 0.778, Test accuracy: 70.09
Round  22, Train loss: 0.808, Test loss: 0.769, Test accuracy: 70.49
Round  23, Train loss: 0.858, Test loss: 0.742, Test accuracy: 71.04
Round  24, Train loss: 0.784, Test loss: 0.730, Test accuracy: 72.57
Round  25, Train loss: 0.810, Test loss: 0.734, Test accuracy: 72.49
Round  26, Train loss: 0.791, Test loss: 0.724, Test accuracy: 72.19
Round  27, Train loss: 0.758, Test loss: 0.721, Test accuracy: 72.37
Round  28, Train loss: 0.739, Test loss: 0.721, Test accuracy: 72.69
Round  29, Train loss: 0.776, Test loss: 0.697, Test accuracy: 73.80
Round  30, Train loss: 0.712, Test loss: 0.700, Test accuracy: 73.55
Round  31, Train loss: 0.728, Test loss: 0.681, Test accuracy: 73.96
Round  32, Train loss: 0.660, Test loss: 0.692, Test accuracy: 73.76
Round  33, Train loss: 0.664, Test loss: 0.700, Test accuracy: 73.26
Round  34, Train loss: 0.683, Test loss: 0.677, Test accuracy: 74.58
Round  35, Train loss: 0.663, Test loss: 0.674, Test accuracy: 74.38
Round  36, Train loss: 0.700, Test loss: 0.667, Test accuracy: 74.36
Round  37, Train loss: 0.712, Test loss: 0.675, Test accuracy: 74.36
Round  38, Train loss: 0.664, Test loss: 0.666, Test accuracy: 74.61
Round  39, Train loss: 0.616, Test loss: 0.656, Test accuracy: 75.25
Round  40, Train loss: 0.655, Test loss: 0.653, Test accuracy: 75.36
Round  41, Train loss: 0.655, Test loss: 0.644, Test accuracy: 75.99
Round  42, Train loss: 0.627, Test loss: 0.641, Test accuracy: 76.16
Round  43, Train loss: 0.650, Test loss: 0.633, Test accuracy: 76.16
Round  44, Train loss: 0.618, Test loss: 0.629, Test accuracy: 76.39
Round  45, Train loss: 0.618, Test loss: 0.627, Test accuracy: 76.60
Round  46, Train loss: 0.633, Test loss: 0.624, Test accuracy: 76.40
Round  47, Train loss: 0.550, Test loss: 0.623, Test accuracy: 76.65
Round  48, Train loss: 0.572, Test loss: 0.614, Test accuracy: 77.08
Round  49, Train loss: 0.572, Test loss: 0.619, Test accuracy: 76.61
Round  50, Train loss: 0.543, Test loss: 0.602, Test accuracy: 77.53
Round  51, Train loss: 0.566, Test loss: 0.602, Test accuracy: 77.42
Round  52, Train loss: 0.532, Test loss: 0.605, Test accuracy: 76.96
Round  53, Train loss: 0.519, Test loss: 0.612, Test accuracy: 76.90
Round  54, Train loss: 0.562, Test loss: 0.603, Test accuracy: 77.14
Round  55, Train loss: 0.541, Test loss: 0.600, Test accuracy: 77.32
Round  56, Train loss: 0.490, Test loss: 0.598, Test accuracy: 76.98
Round  57, Train loss: 0.517, Test loss: 0.591, Test accuracy: 77.65
Round  58, Train loss: 0.482, Test loss: 0.598, Test accuracy: 77.69
Round  59, Train loss: 0.541, Test loss: 0.591, Test accuracy: 77.43
Round  60, Train loss: 0.537, Test loss: 0.591, Test accuracy: 77.90
Round  61, Train loss: 0.541, Test loss: 0.587, Test accuracy: 78.08
Round  62, Train loss: 0.476, Test loss: 0.590, Test accuracy: 77.55
Round  63, Train loss: 0.459, Test loss: 0.579, Test accuracy: 78.50
Round  64, Train loss: 0.466, Test loss: 0.573, Test accuracy: 78.44
Round  65, Train loss: 0.501, Test loss: 0.586, Test accuracy: 78.25
Round  66, Train loss: 0.451, Test loss: 0.581, Test accuracy: 78.50
Round  67, Train loss: 0.444, Test loss: 0.588, Test accuracy: 78.05
Round  68, Train loss: 0.481, Test loss: 0.580, Test accuracy: 78.65
Round  69, Train loss: 0.413, Test loss: 0.580, Test accuracy: 78.70
Round  70, Train loss: 0.466, Test loss: 0.576, Test accuracy: 78.83
Round  71, Train loss: 0.531, Test loss: 0.565, Test accuracy: 79.23
Round  72, Train loss: 0.430, Test loss: 0.565, Test accuracy: 79.05
Round  73, Train loss: 0.461, Test loss: 0.560, Test accuracy: 79.78
Round  74, Train loss: 0.462, Test loss: 0.563, Test accuracy: 79.38
Round  75, Train loss: 0.419, Test loss: 0.568, Test accuracy: 79.09
Round  76, Train loss: 0.454, Test loss: 0.567, Test accuracy: 79.26
Round  77, Train loss: 0.444, Test loss: 0.574, Test accuracy: 78.83
Round  78, Train loss: 0.464, Test loss: 0.562, Test accuracy: 79.06
Round  79, Train loss: 0.405, Test loss: 0.565, Test accuracy: 79.13
Round  80, Train loss: 0.448, Test loss: 0.569, Test accuracy: 79.04
Round  81, Train loss: 0.383, Test loss: 0.573, Test accuracy: 78.99
Round  82, Train loss: 0.479, Test loss: 0.566, Test accuracy: 78.98
Round  83, Train loss: 0.377, Test loss: 0.571, Test accuracy: 79.16
Round  84, Train loss: 0.380, Test loss: 0.574, Test accuracy: 78.49
Round  85, Train loss: 0.392, Test loss: 0.565, Test accuracy: 79.05
Round  86, Train loss: 0.411, Test loss: 0.568, Test accuracy: 78.88
Round  87, Train loss: 0.348, Test loss: 0.568, Test accuracy: 78.88
Round  88, Train loss: 0.389, Test loss: 0.559, Test accuracy: 79.11
Round  89, Train loss: 0.424, Test loss: 0.563, Test accuracy: 79.09
Round  90, Train loss: 0.418, Test loss: 0.566, Test accuracy: 79.02
Round  91, Train loss: 0.382, Test loss: 0.559, Test accuracy: 79.37
Round  92, Train loss: 0.355, Test loss: 0.563, Test accuracy: 79.24
Round  93, Train loss: 0.413, Test loss: 0.561, Test accuracy: 79.61
Round  94, Train loss: 0.328, Test loss: 0.566, Test accuracy: 79.20
Round  95, Train loss: 0.342, Test loss: 0.565, Test accuracy: 79.42
Round  96, Train loss: 0.362, Test loss: 0.568, Test accuracy: 79.45
Round  97, Train loss: 0.368, Test loss: 0.565, Test accuracy: 79.74
Round  98, Train loss: 0.340, Test loss: 0.558, Test accuracy: 79.63
Round  99, Train loss: 0.418, Test loss: 0.564, Test accuracy: 79.53
Final Round, Train loss: 0.312, Test loss: 0.564, Test accuracy: 79.79
Average accuracy final 10 rounds: 79.42099999999999
1281.844333410263
[1.9095430374145508, 3.6268506050109863, 5.15239143371582, 6.8637378215789795, 8.483229875564575, 10.194202423095703, 11.895110607147217, 13.550147294998169, 15.213142156600952, 16.82748818397522, 18.448596477508545, 20.07381582260132, 21.74899172782898, 23.435028076171875, 25.05044674873352, 26.71731734275818, 28.519498348236084, 30.036117792129517, 31.728394031524658, 33.29702377319336, 34.893208265304565, 36.514779806137085, 38.156662940979004, 39.822335958480835, 41.41953134536743, 43.110058307647705, 44.82314348220825, 46.35173797607422, 48.03801941871643, 49.64639616012573, 51.322837591171265, 53.163304805755615, 54.83583188056946, 56.36800241470337, 57.87173342704773, 59.52976632118225, 61.147979736328125, 62.904396772384644, 64.57899451255798, 66.31902694702148, 67.81170749664307, 69.61730694770813, 71.37190771102905, 72.98344945907593, 74.59616184234619, 76.1227970123291, 77.72210693359375, 79.39239621162415, 81.07458329200745, 82.7026424407959, 84.32866954803467, 85.90933465957642, 87.46490931510925, 89.15844321250916, 90.92907285690308, 92.6400146484375, 94.26206398010254, 95.84925961494446, 97.44240427017212, 99.23826956748962, 100.77140808105469, 102.33438205718994, 103.88045644760132, 105.40726017951965, 106.97724413871765, 108.67398643493652, 110.35803651809692, 111.96497130393982, 113.56652116775513, 115.09927487373352, 116.70312309265137, 118.34182524681091, 119.95193219184875, 121.67141199111938, 123.2496542930603, 124.84183526039124, 126.46109461784363, 128.24470162391663, 129.83458590507507, 131.41140031814575, 133.0537588596344, 134.65807843208313, 136.27461910247803, 138.0897204875946, 139.66358375549316, 141.1791296005249, 142.80322527885437, 144.46304440498352, 146.23525476455688, 147.94971990585327, 149.59500646591187, 151.08751583099365, 152.8163025379181, 154.64840483665466, 156.63766241073608, 158.31475973129272, 159.88678693771362, 161.42560029029846, 163.0245876312256, 164.62698030471802, 167.45614194869995]
[19.4, 22.34, 40.9, 47.27, 46.61, 50.01, 55.94, 53.6, 53.11, 58.8, 60.11, 58.33, 61.73, 62.7, 64.71, 66.76, 67.46, 67.79, 68.43, 69.18, 69.11, 70.09, 70.49, 71.04, 72.57, 72.49, 72.19, 72.37, 72.69, 73.8, 73.55, 73.96, 73.76, 73.26, 74.58, 74.38, 74.36, 74.36, 74.61, 75.25, 75.36, 75.99, 76.16, 76.16, 76.39, 76.6, 76.4, 76.65, 77.08, 76.61, 77.53, 77.42, 76.96, 76.9, 77.14, 77.32, 76.98, 77.65, 77.69, 77.43, 77.9, 78.08, 77.55, 78.5, 78.44, 78.25, 78.5, 78.05, 78.65, 78.7, 78.83, 79.23, 79.05, 79.78, 79.38, 79.09, 79.26, 78.83, 79.06, 79.13, 79.04, 78.99, 78.98, 79.16, 78.49, 79.05, 78.88, 78.88, 79.11, 79.09, 79.02, 79.37, 79.24, 79.61, 79.2, 79.42, 79.45, 79.74, 79.63, 79.53, 79.79]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.695, Test loss: 2.013, Test accuracy: 25.20
Round   1, Train loss: 1.292, Test loss: 1.728, Test accuracy: 39.60
Round   2, Train loss: 1.129, Test loss: 1.628, Test accuracy: 44.40
Round   3, Train loss: 1.079, Test loss: 1.283, Test accuracy: 51.23
Round   4, Train loss: 1.016, Test loss: 1.073, Test accuracy: 58.14
Round   5, Train loss: 0.948, Test loss: 1.168, Test accuracy: 56.19
Round   6, Train loss: 0.950, Test loss: 1.032, Test accuracy: 60.55
Round   7, Train loss: 0.915, Test loss: 0.930, Test accuracy: 64.46
Round   8, Train loss: 0.872, Test loss: 0.880, Test accuracy: 66.57
Round   9, Train loss: 0.838, Test loss: 0.909, Test accuracy: 65.44
Round  10, Train loss: 0.776, Test loss: 0.833, Test accuracy: 68.13
Round  11, Train loss: 0.723, Test loss: 0.824, Test accuracy: 68.41
Round  12, Train loss: 0.749, Test loss: 0.850, Test accuracy: 68.91
Round  13, Train loss: 0.692, Test loss: 0.801, Test accuracy: 69.71
Round  14, Train loss: 0.708, Test loss: 0.738, Test accuracy: 71.38
Round  15, Train loss: 0.698, Test loss: 0.725, Test accuracy: 71.95
Round  16, Train loss: 0.678, Test loss: 0.716, Test accuracy: 72.48
Round  17, Train loss: 0.626, Test loss: 0.720, Test accuracy: 72.29
Round  18, Train loss: 0.591, Test loss: 0.688, Test accuracy: 73.79
Round  19, Train loss: 0.600, Test loss: 0.688, Test accuracy: 73.59
Round  20, Train loss: 0.540, Test loss: 0.683, Test accuracy: 74.19
Round  21, Train loss: 0.506, Test loss: 0.690, Test accuracy: 73.92
Round  22, Train loss: 0.562, Test loss: 0.670, Test accuracy: 74.55
Round  23, Train loss: 0.523, Test loss: 0.654, Test accuracy: 75.43
Round  24, Train loss: 0.570, Test loss: 0.655, Test accuracy: 75.26
Round  25, Train loss: 0.533, Test loss: 0.643, Test accuracy: 75.70
Round  26, Train loss: 0.527, Test loss: 0.638, Test accuracy: 76.06
Round  27, Train loss: 0.455, Test loss: 0.632, Test accuracy: 76.26
Round  28, Train loss: 0.504, Test loss: 0.645, Test accuracy: 75.86
Round  29, Train loss: 0.508, Test loss: 0.627, Test accuracy: 76.52
Round  30, Train loss: 0.454, Test loss: 0.620, Test accuracy: 76.58
Round  31, Train loss: 0.420, Test loss: 0.632, Test accuracy: 76.02
Round  32, Train loss: 0.423, Test loss: 0.627, Test accuracy: 76.35
Round  33, Train loss: 0.463, Test loss: 0.629, Test accuracy: 76.51
Round  34, Train loss: 0.442, Test loss: 0.625, Test accuracy: 76.80
Round  35, Train loss: 0.399, Test loss: 0.620, Test accuracy: 77.19
Round  36, Train loss: 0.381, Test loss: 0.628, Test accuracy: 77.08
Round  37, Train loss: 0.384, Test loss: 0.615, Test accuracy: 77.59
Round  38, Train loss: 0.418, Test loss: 0.607, Test accuracy: 78.04
Round  39, Train loss: 0.381, Test loss: 0.613, Test accuracy: 77.82
Round  40, Train loss: 0.407, Test loss: 0.621, Test accuracy: 77.86
Round  41, Train loss: 0.358, Test loss: 0.637, Test accuracy: 77.09
Round  42, Train loss: 0.382, Test loss: 0.627, Test accuracy: 77.19
Round  43, Train loss: 0.357, Test loss: 0.641, Test accuracy: 77.34
Round  44, Train loss: 0.348, Test loss: 0.641, Test accuracy: 77.00
Round  45, Train loss: 0.352, Test loss: 0.620, Test accuracy: 77.69
Round  46, Train loss: 0.348, Test loss: 0.631, Test accuracy: 77.73
Round  47, Train loss: 0.361, Test loss: 0.655, Test accuracy: 76.88
Round  48, Train loss: 0.339, Test loss: 0.659, Test accuracy: 77.36
Round  49, Train loss: 0.348, Test loss: 0.646, Test accuracy: 77.68
Round  50, Train loss: 0.340, Test loss: 0.652, Test accuracy: 77.49
Round  51, Train loss: 0.323, Test loss: 0.648, Test accuracy: 77.56
Round  52, Train loss: 0.275, Test loss: 0.657, Test accuracy: 77.36
Round  53, Train loss: 0.280, Test loss: 0.633, Test accuracy: 78.11
Round  54, Train loss: 0.290, Test loss: 0.644, Test accuracy: 78.13
Round  55, Train loss: 0.269, Test loss: 0.628, Test accuracy: 78.75
Round  56, Train loss: 0.296, Test loss: 0.632, Test accuracy: 78.17
Round  57, Train loss: 0.320, Test loss: 0.616, Test accuracy: 78.73
Round  58, Train loss: 0.287, Test loss: 0.623, Test accuracy: 78.64
Round  59, Train loss: 0.280, Test loss: 0.629, Test accuracy: 77.98
Round  60, Train loss: 0.303, Test loss: 0.629, Test accuracy: 78.52
Round  61, Train loss: 0.276, Test loss: 0.625, Test accuracy: 78.55
Round  62, Train loss: 0.276, Test loss: 0.620, Test accuracy: 79.04
Round  63, Train loss: 0.288, Test loss: 0.626, Test accuracy: 78.55
Round  64, Train loss: 0.278, Test loss: 0.626, Test accuracy: 78.55
Round  65, Train loss: 0.300, Test loss: 0.637, Test accuracy: 78.45
Round  66, Train loss: 0.266, Test loss: 0.642, Test accuracy: 77.97
Round  67, Train loss: 0.264, Test loss: 0.633, Test accuracy: 78.32
Round  68, Train loss: 0.257, Test loss: 0.622, Test accuracy: 78.39
Round  69, Train loss: 0.229, Test loss: 0.629, Test accuracy: 78.79
Round  70, Train loss: 0.305, Test loss: 0.630, Test accuracy: 78.64
Round  71, Train loss: 0.246, Test loss: 0.626, Test accuracy: 79.09
Round  72, Train loss: 0.249, Test loss: 0.645, Test accuracy: 78.92
Round  73, Train loss: 0.249, Test loss: 0.642, Test accuracy: 78.86
Round  74, Train loss: 0.220, Test loss: 0.629, Test accuracy: 79.16
Round  75, Train loss: 0.219, Test loss: 0.632, Test accuracy: 79.11
Round  76, Train loss: 0.227, Test loss: 0.633, Test accuracy: 79.07
Round  77, Train loss: 0.200, Test loss: 0.631, Test accuracy: 79.49
Round  78, Train loss: 0.231, Test loss: 0.637, Test accuracy: 79.54
Round  79, Train loss: 0.191, Test loss: 0.637, Test accuracy: 79.35
Round  80, Train loss: 0.214, Test loss: 0.647, Test accuracy: 79.17
Round  81, Train loss: 0.211, Test loss: 0.644, Test accuracy: 79.14
Round  82, Train loss: 0.246, Test loss: 0.655, Test accuracy: 78.94
Round  83, Train loss: 0.202, Test loss: 0.638, Test accuracy: 79.43
Round  84, Train loss: 0.218, Test loss: 0.642, Test accuracy: 79.45
Round  85, Train loss: 0.216, Test loss: 0.649, Test accuracy: 78.80
Round  86, Train loss: 0.219, Test loss: 0.653, Test accuracy: 79.15
Round  87, Train loss: 0.225, Test loss: 0.642, Test accuracy: 79.40
Round  88, Train loss: 0.218, Test loss: 0.645, Test accuracy: 79.00
Round  89, Train loss: 0.222, Test loss: 0.645, Test accuracy: 79.16
Round  90, Train loss: 0.191, Test loss: 0.645, Test accuracy: 79.24
Round  91, Train loss: 0.169, Test loss: 0.644, Test accuracy: 79.51
Round  92, Train loss: 0.194, Test loss: 0.655, Test accuracy: 78.91
Round  93, Train loss: 0.172, Test loss: 0.652, Test accuracy: 78.91
Round  94, Train loss: 0.171, Test loss: 0.655, Test accuracy: 78.91
Round  95, Train loss: 0.201, Test loss: 0.653, Test accuracy: 79.59
Round  96, Train loss: 0.173, Test loss: 0.655, Test accuracy: 79.04
Round  97, Train loss: 0.198, Test loss: 0.659, Test accuracy: 78.91
Round  98, Train loss: 0.187, Test loss: 0.654, Test accuracy: 78.85
Round  99, Train loss: 0.201, Test loss: 0.659, Test accuracy: 78.89
Final Round, Train loss: 0.174, Test loss: 0.647, Test accuracy: 79.33
Average accuracy final 10 rounds: 79.076
2235.568165540695
[3.3173160552978516, 6.41613507270813, 9.73123812675476, 12.902746200561523, 16.096168279647827, 19.332579135894775, 22.623687982559204, 25.984596490859985, 29.015402793884277, 32.3031210899353, 35.36010932922363, 38.4518187046051, 41.69031357765198, 45.005555391311646, 48.039629220962524, 51.22339200973511, 54.70306038856506, 57.84614324569702, 60.912395000457764, 64.0464973449707, 67.12366700172424, 70.1727397441864, 73.37722253799438, 76.76799726486206, 79.81002473831177, 82.85595464706421, 85.97036075592041, 89.26065635681152, 92.41172623634338, 95.51228618621826, 98.78218150138855, 101.92528510093689, 105.09369492530823, 108.27617383003235, 111.4249267578125, 114.5657320022583, 117.72911548614502, 121.0646870136261, 124.12655973434448, 127.17042016983032, 130.42968034744263, 133.75820970535278, 136.95822548866272, 140.15926694869995, 143.39138054847717, 146.61059975624084, 149.76939487457275, 153.08487105369568, 156.32662677764893, 159.65057134628296, 162.87515473365784, 166.13920307159424, 169.21932315826416, 172.68756937980652, 175.81981801986694, 179.070378780365, 182.2333984375, 185.32732439041138, 188.3766496181488, 191.50723719596863, 194.73885488510132, 197.80869817733765, 201.03910994529724, 204.18064856529236, 207.30005264282227, 210.3857409954071, 213.6349995136261, 216.7583887577057, 219.88772225379944, 223.08185172080994, 226.136456489563, 229.2447578907013, 232.46610927581787, 235.54046082496643, 238.69059109687805, 241.89889192581177, 245.29626560211182, 248.54064011573792, 251.5807342529297, 254.7584855556488, 257.9553952217102, 261.10918140411377, 264.1719138622284, 267.62880635261536, 270.8583962917328, 274.04087805747986, 277.24310207366943, 280.43157267570496, 283.8469662666321, 287.2638804912567, 290.4000771045685, 293.52008748054504, 296.68314385414124, 299.9931001663208, 303.2349214553833, 306.3721652030945, 309.51775908470154, 312.63465332984924, 316.00226855278015, 319.2606689929962, 324.39780020713806]
[25.2, 39.6, 44.4, 51.23, 58.14, 56.19, 60.55, 64.46, 66.57, 65.44, 68.13, 68.41, 68.91, 69.71, 71.38, 71.95, 72.48, 72.29, 73.79, 73.59, 74.19, 73.92, 74.55, 75.43, 75.26, 75.7, 76.06, 76.26, 75.86, 76.52, 76.58, 76.02, 76.35, 76.51, 76.8, 77.19, 77.08, 77.59, 78.04, 77.82, 77.86, 77.09, 77.19, 77.34, 77.0, 77.69, 77.73, 76.88, 77.36, 77.68, 77.49, 77.56, 77.36, 78.11, 78.13, 78.75, 78.17, 78.73, 78.64, 77.98, 78.52, 78.55, 79.04, 78.55, 78.55, 78.45, 77.97, 78.32, 78.39, 78.79, 78.64, 79.09, 78.92, 78.86, 79.16, 79.11, 79.07, 79.49, 79.54, 79.35, 79.17, 79.14, 78.94, 79.43, 79.45, 78.8, 79.15, 79.4, 79.0, 79.16, 79.24, 79.51, 78.91, 78.91, 78.91, 79.59, 79.04, 78.91, 78.85, 78.89, 79.33]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.704, Test loss: 2.017, Test accuracy: 28.24
Round   1, Train loss: 1.364, Test loss: 1.815, Test accuracy: 36.30
Round   2, Train loss: 1.203, Test loss: 1.350, Test accuracy: 49.64
Round   3, Train loss: 1.079, Test loss: 1.213, Test accuracy: 53.62
Round   4, Train loss: 1.011, Test loss: 1.087, Test accuracy: 57.31
Round   5, Train loss: 0.900, Test loss: 1.039, Test accuracy: 59.73
Round   6, Train loss: 0.909, Test loss: 0.915, Test accuracy: 64.80
Round   7, Train loss: 0.888, Test loss: 0.887, Test accuracy: 65.37
Round   8, Train loss: 0.827, Test loss: 0.883, Test accuracy: 66.05
Round   9, Train loss: 0.802, Test loss: 0.843, Test accuracy: 67.56
Round  10, Train loss: 0.845, Test loss: 0.814, Test accuracy: 67.86
Round  11, Train loss: 0.806, Test loss: 0.815, Test accuracy: 68.29
Round  12, Train loss: 0.730, Test loss: 0.762, Test accuracy: 70.97
Round  13, Train loss: 0.665, Test loss: 0.760, Test accuracy: 70.94
Round  14, Train loss: 0.689, Test loss: 0.737, Test accuracy: 71.54
Round  15, Train loss: 0.697, Test loss: 0.717, Test accuracy: 72.60
Round  16, Train loss: 0.674, Test loss: 0.699, Test accuracy: 73.01
Round  17, Train loss: 0.628, Test loss: 0.699, Test accuracy: 73.23
Round  18, Train loss: 0.579, Test loss: 0.697, Test accuracy: 73.16
Round  19, Train loss: 0.535, Test loss: 0.686, Test accuracy: 73.45
Round  20, Train loss: 0.600, Test loss: 0.673, Test accuracy: 73.96
Round  21, Train loss: 0.544, Test loss: 0.677, Test accuracy: 73.83
Round  22, Train loss: 0.557, Test loss: 0.650, Test accuracy: 75.55
Round  23, Train loss: 0.526, Test loss: 0.654, Test accuracy: 75.02
Round  24, Train loss: 0.542, Test loss: 0.656, Test accuracy: 75.25
Round  25, Train loss: 0.528, Test loss: 0.656, Test accuracy: 75.40
Round  26, Train loss: 0.543, Test loss: 0.651, Test accuracy: 75.36
Round  27, Train loss: 0.520, Test loss: 0.649, Test accuracy: 75.90
Round  28, Train loss: 0.471, Test loss: 0.657, Test accuracy: 75.38
Round  29, Train loss: 0.517, Test loss: 0.644, Test accuracy: 75.82
Round  30, Train loss: 0.464, Test loss: 0.625, Test accuracy: 76.72
Round  31, Train loss: 0.474, Test loss: 0.621, Test accuracy: 76.72
Round  32, Train loss: 0.412, Test loss: 0.638, Test accuracy: 76.25
Round  33, Train loss: 0.443, Test loss: 0.626, Test accuracy: 77.29
Round  34, Train loss: 0.414, Test loss: 0.604, Test accuracy: 77.86
Round  35, Train loss: 0.389, Test loss: 0.615, Test accuracy: 77.27
Round  36, Train loss: 0.381, Test loss: 0.610, Test accuracy: 77.50
Round  37, Train loss: 0.408, Test loss: 0.616, Test accuracy: 77.19
Round  38, Train loss: 0.382, Test loss: 0.598, Test accuracy: 77.92
Round  39, Train loss: 0.357, Test loss: 0.589, Test accuracy: 78.21
Round  40, Train loss: 0.365, Test loss: 0.578, Test accuracy: 78.54
Round  41, Train loss: 0.386, Test loss: 0.597, Test accuracy: 77.83
Round  42, Train loss: 0.401, Test loss: 0.586, Test accuracy: 78.49
Round  43, Train loss: 0.350, Test loss: 0.590, Test accuracy: 78.06
Round  44, Train loss: 0.365, Test loss: 0.593, Test accuracy: 78.12
Round  45, Train loss: 0.360, Test loss: 0.592, Test accuracy: 78.41
Round  46, Train loss: 0.321, Test loss: 0.611, Test accuracy: 77.92
Round  47, Train loss: 0.352, Test loss: 0.608, Test accuracy: 77.97
Round  48, Train loss: 0.297, Test loss: 0.606, Test accuracy: 77.88
Round  49, Train loss: 0.333, Test loss: 0.610, Test accuracy: 77.98
Round  50, Train loss: 0.304, Test loss: 0.609, Test accuracy: 78.11
Round  51, Train loss: 0.312, Test loss: 0.607, Test accuracy: 78.15
Round  52, Train loss: 0.299, Test loss: 0.605, Test accuracy: 78.45
Round  53, Train loss: 0.270, Test loss: 0.610, Test accuracy: 78.19
Round  54, Train loss: 0.313, Test loss: 0.602, Test accuracy: 78.53
Round  55, Train loss: 0.278, Test loss: 0.613, Test accuracy: 78.44
Round  56, Train loss: 0.306, Test loss: 0.633, Test accuracy: 78.36
Round  57, Train loss: 0.338, Test loss: 0.607, Test accuracy: 78.72
Round  58, Train loss: 0.333, Test loss: 0.605, Test accuracy: 78.86
Round  59, Train loss: 0.261, Test loss: 0.609, Test accuracy: 78.71
Round  60, Train loss: 0.283, Test loss: 0.610, Test accuracy: 78.80
Round  61, Train loss: 0.280, Test loss: 0.613, Test accuracy: 78.25
Round  62, Train loss: 0.302, Test loss: 0.596, Test accuracy: 78.90
Round  63, Train loss: 0.241, Test loss: 0.594, Test accuracy: 79.15
Round  64, Train loss: 0.242, Test loss: 0.602, Test accuracy: 79.03
Round  65, Train loss: 0.286, Test loss: 0.602, Test accuracy: 79.16
Round  66, Train loss: 0.286, Test loss: 0.598, Test accuracy: 79.60
Round  67, Train loss: 0.277, Test loss: 0.610, Test accuracy: 79.22
Round  68, Train loss: 0.297, Test loss: 0.608, Test accuracy: 78.70
Round  69, Train loss: 0.231, Test loss: 0.602, Test accuracy: 79.73
Round  70, Train loss: 0.266, Test loss: 0.597, Test accuracy: 79.21
Round  71, Train loss: 0.232, Test loss: 0.601, Test accuracy: 79.48
Round  72, Train loss: 0.270, Test loss: 0.596, Test accuracy: 79.47
Round  73, Train loss: 0.249, Test loss: 0.603, Test accuracy: 79.14
Round  74, Train loss: 0.257, Test loss: 0.605, Test accuracy: 79.32
Round  75, Train loss: 0.230, Test loss: 0.593, Test accuracy: 79.42
Round  76, Train loss: 0.269, Test loss: 0.608, Test accuracy: 79.24
Round  77, Train loss: 0.280, Test loss: 0.604, Test accuracy: 79.41
Round  78, Train loss: 0.246, Test loss: 0.600, Test accuracy: 79.77
Round  79, Train loss: 0.245, Test loss: 0.605, Test accuracy: 79.92
Round  80, Train loss: 0.244, Test loss: 0.604, Test accuracy: 79.72
Round  81, Train loss: 0.236, Test loss: 0.606, Test accuracy: 79.59
Round  82, Train loss: 0.220, Test loss: 0.607, Test accuracy: 79.75
Round  83, Train loss: 0.228, Test loss: 0.609, Test accuracy: 79.84
Round  84, Train loss: 0.238, Test loss: 0.600, Test accuracy: 80.01
Round  85, Train loss: 0.204, Test loss: 0.610, Test accuracy: 80.01
Round  86, Train loss: 0.207, Test loss: 0.615, Test accuracy: 79.83
Round  87, Train loss: 0.231, Test loss: 0.606, Test accuracy: 80.09
Round  88, Train loss: 0.258, Test loss: 0.601, Test accuracy: 80.23
Round  89, Train loss: 0.189, Test loss: 0.606, Test accuracy: 80.24
Round  90, Train loss: 0.211, Test loss: 0.599, Test accuracy: 79.98
Round  91, Train loss: 0.196, Test loss: 0.606, Test accuracy: 80.14
Round  92, Train loss: 0.217, Test loss: 0.618, Test accuracy: 79.82
Round  93, Train loss: 0.226, Test loss: 0.611, Test accuracy: 79.89
Round  94, Train loss: 0.222, Test loss: 0.627, Test accuracy: 79.65
Round  95, Train loss: 0.182, Test loss: 0.613, Test accuracy: 79.97
Round  96, Train loss: 0.197, Test loss: 0.607, Test accuracy: 80.17
Round  97, Train loss: 0.193, Test loss: 0.610, Test accuracy: 79.99
Round  98, Train loss: 0.212, Test loss: 0.613, Test accuracy: 80.11
Round  99, Train loss: 0.186, Test loss: 0.622, Test accuracy: 80.04
Final Round, Train loss: 0.179, Test loss: 0.613, Test accuracy: 80.66
Average accuracy final 10 rounds: 79.97600000000001
3394.380954504013
[3.197453022003174, 6.323638439178467, 9.510727167129517, 12.604509830474854, 15.69467830657959, 18.88955020904541, 22.007188320159912, 25.027042865753174, 28.311486959457397, 31.577913522720337, 34.86842465400696, 38.04261827468872, 41.2204532623291, 44.33879470825195, 47.655675411224365, 50.862608671188354, 54.20005917549133, 57.42619872093201, 60.57914161682129, 63.71095013618469, 67.02823758125305, 72.93211245536804, 78.51660966873169, 84.38099408149719, 89.83916068077087, 95.8310194015503, 101.84979677200317, 107.56823778152466, 112.97961664199829, 118.62153363227844, 124.14020276069641, 129.5594985485077, 135.09091305732727, 141.0307013988495, 146.52369832992554, 152.37005758285522, 158.0849540233612, 164.748521566391, 171.30923557281494, 177.20592069625854, 182.6060175895691, 188.1631166934967, 193.80599403381348, 199.32165598869324, 205.0939428806305, 210.74742317199707, 216.42031288146973, 221.87578296661377, 227.31631708145142, 232.625821352005, 238.13650107383728, 243.6188395023346, 249.09238362312317, 254.8443956375122, 260.5828936100006, 266.4045207500458, 272.1512670516968, 277.97689151763916, 283.78342938423157, 289.61188197135925, 295.3112120628357, 301.47088646888733, 307.1963560581207, 313.1619961261749, 319.21736431121826, 325.2225682735443, 330.96454882621765, 336.5216574668884, 342.24190282821655, 348.06167244911194, 353.7437307834625, 359.4534044265747, 365.0818772315979, 370.73802280426025, 376.5210208892822, 382.10232639312744, 387.93281626701355, 393.55609679222107, 399.2450170516968, 404.8201434612274, 410.3450813293457, 416.0373101234436, 421.64249992370605, 427.52772784233093, 433.2698812484741, 438.8004882335663, 444.60795855522156, 450.2729215621948, 455.8587021827698, 461.5539689064026, 467.12643790245056, 473.37962317466736, 479.004093170166, 484.62994480133057, 490.0500907897949, 495.8705036640167, 501.59988379478455, 507.20655846595764, 512.9508640766144, 518.6013023853302, 523.614001750946]
[28.24, 36.3, 49.64, 53.62, 57.31, 59.73, 64.8, 65.37, 66.05, 67.56, 67.86, 68.29, 70.97, 70.94, 71.54, 72.6, 73.01, 73.23, 73.16, 73.45, 73.96, 73.83, 75.55, 75.02, 75.25, 75.4, 75.36, 75.9, 75.38, 75.82, 76.72, 76.72, 76.25, 77.29, 77.86, 77.27, 77.5, 77.19, 77.92, 78.21, 78.54, 77.83, 78.49, 78.06, 78.12, 78.41, 77.92, 77.97, 77.88, 77.98, 78.11, 78.15, 78.45, 78.19, 78.53, 78.44, 78.36, 78.72, 78.86, 78.71, 78.8, 78.25, 78.9, 79.15, 79.03, 79.16, 79.6, 79.22, 78.7, 79.73, 79.21, 79.48, 79.47, 79.14, 79.32, 79.42, 79.24, 79.41, 79.77, 79.92, 79.72, 79.59, 79.75, 79.84, 80.01, 80.01, 79.83, 80.09, 80.23, 80.24, 79.98, 80.14, 79.82, 79.89, 79.65, 79.97, 80.17, 79.99, 80.11, 80.04, 80.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.691, Test loss: 2.058, Test accuracy: 25.53
Round   1, Train loss: 1.363, Test loss: 1.808, Test accuracy: 35.29
Round   2, Train loss: 1.150, Test loss: 1.589, Test accuracy: 45.80
Round   3, Train loss: 1.072, Test loss: 1.466, Test accuracy: 48.15
Round   4, Train loss: 1.037, Test loss: 1.279, Test accuracy: 55.51
Round   5, Train loss: 0.989, Test loss: 1.044, Test accuracy: 59.73
Round   6, Train loss: 0.904, Test loss: 0.955, Test accuracy: 63.71
Round   7, Train loss: 0.905, Test loss: 0.939, Test accuracy: 64.04
Round   8, Train loss: 0.840, Test loss: 0.905, Test accuracy: 64.54
Round   9, Train loss: 0.814, Test loss: 0.856, Test accuracy: 66.75
Round  10, Train loss: 0.763, Test loss: 0.841, Test accuracy: 66.97
Round  11, Train loss: 0.753, Test loss: 0.800, Test accuracy: 68.50
Round  12, Train loss: 0.763, Test loss: 0.772, Test accuracy: 70.16
Round  13, Train loss: 0.711, Test loss: 0.744, Test accuracy: 71.40
Round  14, Train loss: 0.720, Test loss: 0.734, Test accuracy: 71.37
Round  15, Train loss: 0.695, Test loss: 0.725, Test accuracy: 72.44
Round  16, Train loss: 0.641, Test loss: 0.710, Test accuracy: 72.42
Round  17, Train loss: 0.631, Test loss: 0.709, Test accuracy: 71.98
Round  18, Train loss: 0.662, Test loss: 0.709, Test accuracy: 71.75
Round  19, Train loss: 0.601, Test loss: 0.672, Test accuracy: 74.08
Round  20, Train loss: 0.556, Test loss: 0.667, Test accuracy: 74.58
Round  21, Train loss: 0.609, Test loss: 0.664, Test accuracy: 74.20
Round  22, Train loss: 0.557, Test loss: 0.664, Test accuracy: 74.41
Round  23, Train loss: 0.498, Test loss: 0.667, Test accuracy: 74.35
Round  24, Train loss: 0.523, Test loss: 0.648, Test accuracy: 75.74
Round  25, Train loss: 0.537, Test loss: 0.647, Test accuracy: 75.67
Round  26, Train loss: 0.538, Test loss: 0.650, Test accuracy: 75.65
Round  27, Train loss: 0.430, Test loss: 0.653, Test accuracy: 75.64
Round  28, Train loss: 0.457, Test loss: 0.651, Test accuracy: 75.87
Round  29, Train loss: 0.492, Test loss: 0.637, Test accuracy: 76.33
Round  30, Train loss: 0.513, Test loss: 0.634, Test accuracy: 76.33
Round  31, Train loss: 0.476, Test loss: 0.634, Test accuracy: 76.39
Round  32, Train loss: 0.426, Test loss: 0.623, Test accuracy: 77.05
Round  33, Train loss: 0.413, Test loss: 0.632, Test accuracy: 76.96
Round  34, Train loss: 0.416, Test loss: 0.614, Test accuracy: 77.73
Round  35, Train loss: 0.476, Test loss: 0.611, Test accuracy: 77.85
Round  36, Train loss: 0.341, Test loss: 0.610, Test accuracy: 77.81
Round  37, Train loss: 0.391, Test loss: 0.617, Test accuracy: 77.29
Round  38, Train loss: 0.375, Test loss: 0.616, Test accuracy: 77.51
Round  39, Train loss: 0.414, Test loss: 0.592, Test accuracy: 78.25
Round  40, Train loss: 0.377, Test loss: 0.597, Test accuracy: 78.46
Round  41, Train loss: 0.433, Test loss: 0.600, Test accuracy: 78.37
Round  42, Train loss: 0.387, Test loss: 0.606, Test accuracy: 78.32
Round  43, Train loss: 0.385, Test loss: 0.599, Test accuracy: 78.41
Round  44, Train loss: 0.325, Test loss: 0.597, Test accuracy: 78.31
Round  45, Train loss: 0.363, Test loss: 0.598, Test accuracy: 78.15
Round  46, Train loss: 0.323, Test loss: 0.590, Test accuracy: 78.85
Round  47, Train loss: 0.320, Test loss: 0.588, Test accuracy: 78.62
Round  48, Train loss: 0.346, Test loss: 0.596, Test accuracy: 78.47
Round  49, Train loss: 0.313, Test loss: 0.592, Test accuracy: 78.81
Round  50, Train loss: 0.341, Test loss: 0.600, Test accuracy: 78.56
Round  51, Train loss: 0.292, Test loss: 0.608, Test accuracy: 78.55
Round  52, Train loss: 0.351, Test loss: 0.603, Test accuracy: 78.72
Round  53, Train loss: 0.310, Test loss: 0.592, Test accuracy: 79.17
Round  54, Train loss: 0.314, Test loss: 0.593, Test accuracy: 79.16
Round  55, Train loss: 0.311, Test loss: 0.626, Test accuracy: 78.61
Round  56, Train loss: 0.356, Test loss: 0.604, Test accuracy: 78.89
Round  57, Train loss: 0.307, Test loss: 0.600, Test accuracy: 79.45
Round  58, Train loss: 0.320, Test loss: 0.596, Test accuracy: 78.97
Round  59, Train loss: 0.278, Test loss: 0.611, Test accuracy: 78.56
Round  60, Train loss: 0.269, Test loss: 0.621, Test accuracy: 78.21
Round  61, Train loss: 0.304, Test loss: 0.613, Test accuracy: 78.84
Round  62, Train loss: 0.354, Test loss: 0.612, Test accuracy: 78.68
Round  63, Train loss: 0.279, Test loss: 0.626, Test accuracy: 78.49
Round  64, Train loss: 0.236, Test loss: 0.629, Test accuracy: 78.21
Round  65, Train loss: 0.345, Test loss: 0.623, Test accuracy: 78.68
Round  66, Train loss: 0.262, Test loss: 0.626, Test accuracy: 78.45
Round  67, Train loss: 0.275, Test loss: 0.630, Test accuracy: 78.75
Round  68, Train loss: 0.222, Test loss: 0.617, Test accuracy: 78.78
Round  69, Train loss: 0.283, Test loss: 0.615, Test accuracy: 78.79
Round  70, Train loss: 0.259, Test loss: 0.615, Test accuracy: 79.06
Round  71, Train loss: 0.245, Test loss: 0.620, Test accuracy: 79.08
Round  72, Train loss: 0.289, Test loss: 0.611, Test accuracy: 79.30
Round  73, Train loss: 0.276, Test loss: 0.613, Test accuracy: 79.57
Round  74, Train loss: 0.267, Test loss: 0.617, Test accuracy: 79.02
Round  75, Train loss: 0.243, Test loss: 0.603, Test accuracy: 79.67
Round  76, Train loss: 0.217, Test loss: 0.606, Test accuracy: 79.70
Round  77, Train loss: 0.247, Test loss: 0.610, Test accuracy: 79.39
Round  78, Train loss: 0.244, Test loss: 0.609, Test accuracy: 79.78
Round  79, Train loss: 0.248, Test loss: 0.612, Test accuracy: 79.65
Round  80, Train loss: 0.229, Test loss: 0.617, Test accuracy: 79.33
Round  81, Train loss: 0.220, Test loss: 0.616, Test accuracy: 79.35
Round  82, Train loss: 0.223, Test loss: 0.618, Test accuracy: 79.36
Round  83, Train loss: 0.211, Test loss: 0.616, Test accuracy: 79.52
Round  84, Train loss: 0.192, Test loss: 0.622, Test accuracy: 79.88
Round  85, Train loss: 0.237, Test loss: 0.612, Test accuracy: 79.95
Round  86, Train loss: 0.206, Test loss: 0.612, Test accuracy: 79.90
Round  87, Train loss: 0.224, Test loss: 0.623, Test accuracy: 79.88
Round  88, Train loss: 0.187, Test loss: 0.621, Test accuracy: 79.25
Round  89, Train loss: 0.169, Test loss: 0.617, Test accuracy: 79.74
Round  90, Train loss: 0.162, Test loss: 0.624, Test accuracy: 79.79
Round  91, Train loss: 0.232, Test loss: 0.616, Test accuracy: 79.87
Round  92, Train loss: 0.206, Test loss: 0.624, Test accuracy: 79.73
Round  93, Train loss: 0.239, Test loss: 0.613, Test accuracy: 79.57
Round  94, Train loss: 0.201, Test loss: 0.627, Test accuracy: 79.64
Round  95, Train loss: 0.173, Test loss: 0.632, Test accuracy: 79.36
Round  96, Train loss: 0.205, Test loss: 0.620, Test accuracy: 79.82
Round  97, Train loss: 0.217, Test loss: 0.623, Test accuracy: 80.01
Round  98, Train loss: 0.183, Test loss: 0.618, Test accuracy: 79.48
Round  99, Train loss: 0.202, Test loss: 0.626, Test accuracy: 79.41
Final Round, Train loss: 0.180, Test loss: 0.612, Test accuracy: 80.11
Average accuracy final 10 rounds: 79.668
3337.733694076538
[3.371872663497925, 6.540046453475952, 9.633572101593018, 12.777661800384521, 15.828851461410522, 18.86566972732544, 21.904188632965088, 24.957602739334106, 28.038042306900024, 31.088730812072754, 34.1412136554718, 36.68951416015625, 39.25368523597717, 41.89483141899109, 44.621551275253296, 47.55147361755371, 50.579044580459595, 53.539302825927734, 56.58185124397278, 59.71256422996521, 62.72385811805725, 68.29484438896179, 73.93875885009766, 79.74299693107605, 85.68863821029663, 91.08168268203735, 96.82696866989136, 102.3942129611969, 108.03034925460815, 113.63671588897705, 119.02735042572021, 125.06508231163025, 130.54088521003723, 136.1213138103485, 141.85079073905945, 147.34263062477112, 152.86153554916382, 158.22175288200378, 163.63658905029297, 169.00771021842957, 174.38494491577148, 179.81588292121887, 185.2375829219818, 190.66807293891907, 196.0658392906189, 201.55483865737915, 206.99713516235352, 212.64175248146057, 217.98671913146973, 223.44782376289368, 229.1131191253662, 234.70884323120117, 240.16129446029663, 245.5918378829956, 250.97375655174255, 256.37013006210327, 262.0877184867859, 267.60429406166077, 273.0374298095703, 278.4612238407135, 283.8846399784088, 289.3203830718994, 294.72865056991577, 300.1411325931549, 305.5893111228943, 310.99691367149353, 316.4437885284424, 321.8893783092499, 327.32318687438965, 332.7122082710266, 338.1599304676056, 343.6190917491913, 349.01775670051575, 354.51922154426575, 359.98849654197693, 365.44410276412964, 370.91874742507935, 376.3000774383545, 381.7608439922333, 387.35132575035095, 392.8407554626465, 398.4046905040741, 405.9847502708435, 413.5226881504059, 419.44758653640747, 424.9627630710602, 430.60275888442993, 436.26629114151, 441.9130976200104, 447.53682565689087, 453.31899762153625, 458.9424889087677, 464.662052154541, 470.3307249546051, 475.9830627441406, 481.95153522491455, 487.5797874927521, 493.23605489730835, 499.0182628631592, 504.6348788738251, 509.8860397338867]
[25.53, 35.29, 45.8, 48.15, 55.51, 59.73, 63.71, 64.04, 64.54, 66.75, 66.97, 68.5, 70.16, 71.4, 71.37, 72.44, 72.42, 71.98, 71.75, 74.08, 74.58, 74.2, 74.41, 74.35, 75.74, 75.67, 75.65, 75.64, 75.87, 76.33, 76.33, 76.39, 77.05, 76.96, 77.73, 77.85, 77.81, 77.29, 77.51, 78.25, 78.46, 78.37, 78.32, 78.41, 78.31, 78.15, 78.85, 78.62, 78.47, 78.81, 78.56, 78.55, 78.72, 79.17, 79.16, 78.61, 78.89, 79.45, 78.97, 78.56, 78.21, 78.84, 78.68, 78.49, 78.21, 78.68, 78.45, 78.75, 78.78, 78.79, 79.06, 79.08, 79.3, 79.57, 79.02, 79.67, 79.7, 79.39, 79.78, 79.65, 79.33, 79.35, 79.36, 79.52, 79.88, 79.95, 79.9, 79.88, 79.25, 79.74, 79.79, 79.87, 79.73, 79.57, 79.64, 79.36, 79.82, 80.01, 79.48, 79.41, 80.11]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.590, Test loss: 2.153, Test accuracy: 28.34
Round   1, Train loss: 1.306, Test loss: 1.644, Test accuracy: 38.75
Round   2, Train loss: 1.117, Test loss: 1.643, Test accuracy: 44.91
Round   3, Train loss: 1.109, Test loss: 1.383, Test accuracy: 49.37
Round   4, Train loss: 0.981, Test loss: 1.179, Test accuracy: 53.44
Round   5, Train loss: 0.933, Test loss: 1.163, Test accuracy: 54.52
Round   6, Train loss: 0.917, Test loss: 1.026, Test accuracy: 60.06
Round   7, Train loss: 0.948, Test loss: 0.928, Test accuracy: 63.06
Round   8, Train loss: 0.846, Test loss: 0.866, Test accuracy: 66.28
Round   9, Train loss: 0.807, Test loss: 0.835, Test accuracy: 67.10
Round  10, Train loss: 0.820, Test loss: 0.827, Test accuracy: 67.52
Round  11, Train loss: 0.701, Test loss: 0.777, Test accuracy: 69.55
Round  12, Train loss: 0.688, Test loss: 0.772, Test accuracy: 69.67
Round  13, Train loss: 0.617, Test loss: 0.752, Test accuracy: 71.08
Round  14, Train loss: 0.608, Test loss: 0.736, Test accuracy: 71.44
Round  15, Train loss: 0.658, Test loss: 0.713, Test accuracy: 72.66
Round  16, Train loss: 0.581, Test loss: 0.721, Test accuracy: 71.78
Round  17, Train loss: 0.626, Test loss: 0.699, Test accuracy: 72.92
Round  18, Train loss: 0.574, Test loss: 0.682, Test accuracy: 73.55
Round  19, Train loss: 0.522, Test loss: 0.671, Test accuracy: 74.23
Round  20, Train loss: 0.474, Test loss: 0.669, Test accuracy: 74.29
Round  21, Train loss: 0.485, Test loss: 0.652, Test accuracy: 75.46
Round  22, Train loss: 0.400, Test loss: 0.642, Test accuracy: 75.69
Round  23, Train loss: 0.495, Test loss: 0.636, Test accuracy: 75.69
Round  24, Train loss: 0.471, Test loss: 0.635, Test accuracy: 76.19
Round  25, Train loss: 0.451, Test loss: 0.644, Test accuracy: 75.17
Round  26, Train loss: 0.432, Test loss: 0.640, Test accuracy: 75.62
Round  27, Train loss: 0.518, Test loss: 0.641, Test accuracy: 76.02
Round  28, Train loss: 0.392, Test loss: 0.652, Test accuracy: 75.80
Round  29, Train loss: 0.404, Test loss: 0.633, Test accuracy: 76.61
Round  30, Train loss: 0.349, Test loss: 0.643, Test accuracy: 76.03
Round  31, Train loss: 0.388, Test loss: 0.638, Test accuracy: 76.56
Round  32, Train loss: 0.389, Test loss: 0.637, Test accuracy: 76.58
Round  33, Train loss: 0.365, Test loss: 0.639, Test accuracy: 76.61
Round  34, Train loss: 0.393, Test loss: 0.647, Test accuracy: 76.58
Round  35, Train loss: 0.322, Test loss: 0.643, Test accuracy: 77.07
Round  36, Train loss: 0.337, Test loss: 0.625, Test accuracy: 77.41
Round  37, Train loss: 0.313, Test loss: 0.618, Test accuracy: 77.63
Round  38, Train loss: 0.366, Test loss: 0.605, Test accuracy: 78.34
Round  39, Train loss: 0.342, Test loss: 0.604, Test accuracy: 78.04
Round  40, Train loss: 0.293, Test loss: 0.617, Test accuracy: 77.31
Round  41, Train loss: 0.314, Test loss: 0.618, Test accuracy: 77.77
Round  42, Train loss: 0.315, Test loss: 0.617, Test accuracy: 78.23
Round  43, Train loss: 0.293, Test loss: 0.607, Test accuracy: 78.26
Round  44, Train loss: 0.285, Test loss: 0.615, Test accuracy: 77.95
Round  45, Train loss: 0.279, Test loss: 0.601, Test accuracy: 78.58
Round  46, Train loss: 0.313, Test loss: 0.614, Test accuracy: 77.95
Round  47, Train loss: 0.285, Test loss: 0.609, Test accuracy: 78.96
Round  48, Train loss: 0.265, Test loss: 0.610, Test accuracy: 78.41
Round  49, Train loss: 0.295, Test loss: 0.615, Test accuracy: 78.16
Round  50, Train loss: 0.279, Test loss: 0.623, Test accuracy: 78.24
Round  51, Train loss: 0.288, Test loss: 0.614, Test accuracy: 78.09
Round  52, Train loss: 0.293, Test loss: 0.617, Test accuracy: 78.21
Round  53, Train loss: 0.251, Test loss: 0.622, Test accuracy: 78.48
Round  54, Train loss: 0.259, Test loss: 0.615, Test accuracy: 78.61
Round  55, Train loss: 0.226, Test loss: 0.620, Test accuracy: 78.37
Round  56, Train loss: 0.263, Test loss: 0.613, Test accuracy: 78.82
Round  57, Train loss: 0.251, Test loss: 0.602, Test accuracy: 79.13
Round  58, Train loss: 0.260, Test loss: 0.601, Test accuracy: 79.10
Round  59, Train loss: 0.229, Test loss: 0.602, Test accuracy: 79.20
Round  60, Train loss: 0.253, Test loss: 0.607, Test accuracy: 79.35
Round  61, Train loss: 0.210, Test loss: 0.607, Test accuracy: 78.99
Round  62, Train loss: 0.248, Test loss: 0.594, Test accuracy: 79.33
Round  63, Train loss: 0.211, Test loss: 0.600, Test accuracy: 79.08
Round  64, Train loss: 0.211, Test loss: 0.604, Test accuracy: 79.40
Round  65, Train loss: 0.174, Test loss: 0.618, Test accuracy: 78.81
Round  66, Train loss: 0.182, Test loss: 0.620, Test accuracy: 78.82
Round  67, Train loss: 0.251, Test loss: 0.623, Test accuracy: 78.59
Round  68, Train loss: 0.216, Test loss: 0.619, Test accuracy: 78.87
Round  69, Train loss: 0.186, Test loss: 0.636, Test accuracy: 78.53
Round  70, Train loss: 0.188, Test loss: 0.638, Test accuracy: 78.82
Round  71, Train loss: 0.218, Test loss: 0.641, Test accuracy: 78.32
Round  72, Train loss: 0.208, Test loss: 0.615, Test accuracy: 79.47
Round  73, Train loss: 0.189, Test loss: 0.621, Test accuracy: 79.08
Round  74, Train loss: 0.171, Test loss: 0.619, Test accuracy: 79.55
Round  75, Train loss: 0.190, Test loss: 0.640, Test accuracy: 78.72
Round  76, Train loss: 0.201, Test loss: 0.630, Test accuracy: 79.17
Round  77, Train loss: 0.174, Test loss: 0.632, Test accuracy: 79.03
Round  78, Train loss: 0.203, Test loss: 0.630, Test accuracy: 79.25
Round  79, Train loss: 0.185, Test loss: 0.629, Test accuracy: 79.24
Round  80, Train loss: 0.187, Test loss: 0.627, Test accuracy: 79.27
Traceback (most recent call last):
  File "main_fedpac_copsl.py", line 261, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_glob, idx=idx, w_glob_keys=w_glob_keys,
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2509, in train
    self.filter_data(net, local_net, iter2-head_eps+1, local_eps-head_eps, concept_matrix_local)
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2398, in filter_data
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * iter_num / local_eps))]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2398, in <listcomp>
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * iter_num / local_eps))]
IndexError: list index out of range
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.682, Test loss: 1.984, Test accuracy: 22.34
Round   0, Global train loss: 1.682, Global test loss: 2.187, Global test accuracy: 18.32
Round   1, Train loss: 1.433, Test loss: 1.779, Test accuracy: 32.57
Round   1, Global train loss: 1.433, Global test loss: 2.203, Global test accuracy: 22.22
Round   2, Train loss: 1.443, Test loss: 1.523, Test accuracy: 41.10
Round   2, Global train loss: 1.443, Global test loss: 1.986, Global test accuracy: 32.50
Round   3, Train loss: 1.305, Test loss: 1.388, Test accuracy: 43.71
Round   3, Global train loss: 1.305, Global test loss: 1.943, Global test accuracy: 29.87
Round   4, Train loss: 1.401, Test loss: 1.322, Test accuracy: 45.12
Round   4, Global train loss: 1.401, Global test loss: 2.064, Global test accuracy: 19.74
Round   5, Train loss: 1.214, Test loss: 1.211, Test accuracy: 49.42
Round   5, Global train loss: 1.214, Global test loss: 1.966, Global test accuracy: 36.47
Round   6, Train loss: 1.321, Test loss: 1.185, Test accuracy: 51.06
Round   6, Global train loss: 1.321, Global test loss: 1.944, Global test accuracy: 34.26
Round   7, Train loss: 1.249, Test loss: 1.171, Test accuracy: 52.20
Round   7, Global train loss: 1.249, Global test loss: 2.001, Global test accuracy: 29.29
Round   8, Train loss: 1.156, Test loss: 1.169, Test accuracy: 52.30
Round   8, Global train loss: 1.156, Global test loss: 1.928, Global test accuracy: 27.29
Round   9, Train loss: 1.036, Test loss: 1.151, Test accuracy: 53.16
Round   9, Global train loss: 1.036, Global test loss: 1.909, Global test accuracy: 33.29
Round  10, Train loss: 1.038, Test loss: 1.123, Test accuracy: 54.33
Round  10, Global train loss: 1.038, Global test loss: 1.947, Global test accuracy: 29.88
Round  11, Train loss: 1.051, Test loss: 1.089, Test accuracy: 56.24
Round  11, Global train loss: 1.051, Global test loss: 1.905, Global test accuracy: 31.79
Round  12, Train loss: 0.966, Test loss: 1.088, Test accuracy: 56.49
Round  12, Global train loss: 0.966, Global test loss: 2.023, Global test accuracy: 30.30
Round  13, Train loss: 0.932, Test loss: 1.092, Test accuracy: 56.67
Round  13, Global train loss: 0.932, Global test loss: 1.830, Global test accuracy: 39.81
Round  14, Train loss: 1.005, Test loss: 1.078, Test accuracy: 58.11
Round  14, Global train loss: 1.005, Global test loss: 1.889, Global test accuracy: 31.03
Round  15, Train loss: 0.835, Test loss: 1.082, Test accuracy: 57.64
Round  15, Global train loss: 0.835, Global test loss: 1.913, Global test accuracy: 29.62
Round  16, Train loss: 0.945, Test loss: 1.093, Test accuracy: 57.34
Round  16, Global train loss: 0.945, Global test loss: 1.863, Global test accuracy: 32.21
Round  17, Train loss: 0.872, Test loss: 1.077, Test accuracy: 58.05
Round  17, Global train loss: 0.872, Global test loss: 1.845, Global test accuracy: 35.31
Round  18, Train loss: 0.990, Test loss: 1.077, Test accuracy: 58.59
Round  18, Global train loss: 0.990, Global test loss: 2.031, Global test accuracy: 26.90
Round  19, Train loss: 0.877, Test loss: 1.065, Test accuracy: 59.41
Round  19, Global train loss: 0.877, Global test loss: 1.949, Global test accuracy: 33.29
Round  20, Train loss: 0.730, Test loss: 1.070, Test accuracy: 59.42
Round  20, Global train loss: 0.730, Global test loss: 1.782, Global test accuracy: 39.48
Round  21, Train loss: 0.767, Test loss: 1.080, Test accuracy: 59.66
Round  21, Global train loss: 0.767, Global test loss: 2.082, Global test accuracy: 37.10
Round  22, Train loss: 0.897, Test loss: 1.098, Test accuracy: 58.98
Round  22, Global train loss: 0.897, Global test loss: 1.944, Global test accuracy: 32.68
Round  23, Train loss: 0.776, Test loss: 1.102, Test accuracy: 59.67
Round  23, Global train loss: 0.776, Global test loss: 1.924, Global test accuracy: 38.45
Round  24, Train loss: 0.683, Test loss: 1.117, Test accuracy: 59.40
Round  24, Global train loss: 0.683, Global test loss: 1.808, Global test accuracy: 36.23
Round  25, Train loss: 0.791, Test loss: 1.113, Test accuracy: 59.25
Round  25, Global train loss: 0.791, Global test loss: 1.893, Global test accuracy: 32.96
Round  26, Train loss: 0.796, Test loss: 1.134, Test accuracy: 58.89
Round  26, Global train loss: 0.796, Global test loss: 1.927, Global test accuracy: 34.28
Round  27, Train loss: 0.784, Test loss: 1.120, Test accuracy: 59.63
Round  27, Global train loss: 0.784, Global test loss: 1.957, Global test accuracy: 31.40
Round  28, Train loss: 0.765, Test loss: 1.131, Test accuracy: 59.73
Round  28, Global train loss: 0.765, Global test loss: 1.995, Global test accuracy: 28.07
Round  29, Train loss: 0.686, Test loss: 1.147, Test accuracy: 59.36
Round  29, Global train loss: 0.686, Global test loss: 1.923, Global test accuracy: 31.98
Round  30, Train loss: 0.712, Test loss: 1.155, Test accuracy: 59.89
Round  30, Global train loss: 0.712, Global test loss: 2.072, Global test accuracy: 33.40
Round  31, Train loss: 0.625, Test loss: 1.153, Test accuracy: 60.11
Round  31, Global train loss: 0.625, Global test loss: 2.032, Global test accuracy: 24.58
Round  32, Train loss: 0.744, Test loss: 1.156, Test accuracy: 59.83
Round  32, Global train loss: 0.744, Global test loss: 1.933, Global test accuracy: 34.84
Round  33, Train loss: 0.724, Test loss: 1.156, Test accuracy: 60.30
Round  33, Global train loss: 0.724, Global test loss: 1.891, Global test accuracy: 32.14
Round  34, Train loss: 0.683, Test loss: 1.199, Test accuracy: 59.13
Round  34, Global train loss: 0.683, Global test loss: 1.949, Global test accuracy: 28.00
Round  35, Train loss: 0.597, Test loss: 1.211, Test accuracy: 59.36
Round  35, Global train loss: 0.597, Global test loss: 1.897, Global test accuracy: 34.36
Round  36, Train loss: 0.530, Test loss: 1.222, Test accuracy: 59.50
Round  36, Global train loss: 0.530, Global test loss: 1.972, Global test accuracy: 30.56
Round  37, Train loss: 0.510, Test loss: 1.234, Test accuracy: 59.99
Round  37, Global train loss: 0.510, Global test loss: 1.902, Global test accuracy: 30.84
Round  38, Train loss: 0.546, Test loss: 1.252, Test accuracy: 59.95
Round  38, Global train loss: 0.546, Global test loss: 1.898, Global test accuracy: 36.84
Round  39, Train loss: 0.463, Test loss: 1.285, Test accuracy: 59.66
Round  39, Global train loss: 0.463, Global test loss: 1.806, Global test accuracy: 33.57
Round  40, Train loss: 0.411, Test loss: 1.322, Test accuracy: 59.54
Round  40, Global train loss: 0.411, Global test loss: 1.877, Global test accuracy: 37.98
Round  41, Train loss: 0.458, Test loss: 1.301, Test accuracy: 60.12
Round  41, Global train loss: 0.458, Global test loss: 1.913, Global test accuracy: 33.76
Round  42, Train loss: 0.423, Test loss: 1.359, Test accuracy: 59.84
Round  42, Global train loss: 0.423, Global test loss: 1.797, Global test accuracy: 40.09
Round  43, Train loss: 0.434, Test loss: 1.376, Test accuracy: 59.85
Round  43, Global train loss: 0.434, Global test loss: 2.011, Global test accuracy: 25.04
Round  44, Train loss: 0.401, Test loss: 1.402, Test accuracy: 60.11
Round  44, Global train loss: 0.401, Global test loss: 1.821, Global test accuracy: 38.31
Round  45, Train loss: 0.439, Test loss: 1.407, Test accuracy: 60.19
Round  45, Global train loss: 0.439, Global test loss: 2.025, Global test accuracy: 37.03
Round  46, Train loss: 0.403, Test loss: 1.396, Test accuracy: 60.26
Round  46, Global train loss: 0.403, Global test loss: 1.860, Global test accuracy: 35.86
Round  47, Train loss: 0.347, Test loss: 1.429, Test accuracy: 60.60
Round  47, Global train loss: 0.347, Global test loss: 1.888, Global test accuracy: 37.39
Round  48, Train loss: 0.345, Test loss: 1.469, Test accuracy: 60.81
Round  48, Global train loss: 0.345, Global test loss: 1.890, Global test accuracy: 34.17
Round  49, Train loss: 0.423, Test loss: 1.470, Test accuracy: 60.88
Round  49, Global train loss: 0.423, Global test loss: 1.929, Global test accuracy: 34.06
Round  50, Train loss: 0.462, Test loss: 1.524, Test accuracy: 60.72
Round  50, Global train loss: 0.462, Global test loss: 1.934, Global test accuracy: 31.80
Round  51, Train loss: 0.391, Test loss: 1.482, Test accuracy: 60.62
Round  51, Global train loss: 0.391, Global test loss: 1.812, Global test accuracy: 36.36
Round  52, Train loss: 0.300, Test loss: 1.493, Test accuracy: 60.82
Round  52, Global train loss: 0.300, Global test loss: 1.868, Global test accuracy: 34.49
Round  53, Train loss: 0.445, Test loss: 1.491, Test accuracy: 61.00
Round  53, Global train loss: 0.445, Global test loss: 1.967, Global test accuracy: 33.77
Round  54, Train loss: 0.337, Test loss: 1.462, Test accuracy: 61.65
Round  54, Global train loss: 0.337, Global test loss: 2.011, Global test accuracy: 26.94
Round  55, Train loss: 0.274, Test loss: 1.504, Test accuracy: 61.49
Round  55, Global train loss: 0.274, Global test loss: 1.955, Global test accuracy: 26.09
Round  56, Train loss: 0.347, Test loss: 1.512, Test accuracy: 61.55
Round  56, Global train loss: 0.347, Global test loss: 1.951, Global test accuracy: 27.11
Round  57, Train loss: 0.310, Test loss: 1.527, Test accuracy: 61.55
Round  57, Global train loss: 0.310, Global test loss: 1.741, Global test accuracy: 39.49
Round  58, Train loss: 0.234, Test loss: 1.535, Test accuracy: 61.66
Round  58, Global train loss: 0.234, Global test loss: 1.990, Global test accuracy: 33.32
Round  59, Train loss: 0.368, Test loss: 1.586, Test accuracy: 61.36
Round  59, Global train loss: 0.368, Global test loss: 1.941, Global test accuracy: 36.39
Round  60, Train loss: 0.224, Test loss: 1.610, Test accuracy: 61.37
Round  60, Global train loss: 0.224, Global test loss: 1.746, Global test accuracy: 41.08
Round  61, Train loss: 0.321, Test loss: 1.659, Test accuracy: 61.67
Round  61, Global train loss: 0.321, Global test loss: 1.918, Global test accuracy: 31.34
Round  62, Train loss: 0.257, Test loss: 1.691, Test accuracy: 61.25
Round  62, Global train loss: 0.257, Global test loss: 1.787, Global test accuracy: 37.32
Round  63, Train loss: 0.246, Test loss: 1.669, Test accuracy: 61.54
Round  63, Global train loss: 0.246, Global test loss: 1.874, Global test accuracy: 35.26
Round  64, Train loss: 0.233, Test loss: 1.624, Test accuracy: 61.97
Round  64, Global train loss: 0.233, Global test loss: 1.819, Global test accuracy: 36.61
Round  65, Train loss: 0.278, Test loss: 1.632, Test accuracy: 62.48
Round  65, Global train loss: 0.278, Global test loss: 1.932, Global test accuracy: 30.70
Round  66, Train loss: 0.215, Test loss: 1.727, Test accuracy: 61.84
Round  66, Global train loss: 0.215, Global test loss: 1.939, Global test accuracy: 32.30
Round  67, Train loss: 0.196, Test loss: 1.776, Test accuracy: 61.32
Round  67, Global train loss: 0.196, Global test loss: 2.182, Global test accuracy: 28.03
Round  68, Train loss: 0.297, Test loss: 1.791, Test accuracy: 61.38
Round  68, Global train loss: 0.297, Global test loss: 1.957, Global test accuracy: 32.72
Round  69, Train loss: 0.213, Test loss: 1.813, Test accuracy: 61.22
Round  69, Global train loss: 0.213, Global test loss: 1.907, Global test accuracy: 30.65
Round  70, Train loss: 0.254, Test loss: 1.802, Test accuracy: 60.99
Round  70, Global train loss: 0.254, Global test loss: 2.026, Global test accuracy: 26.48
Round  71, Train loss: 0.238, Test loss: 1.802, Test accuracy: 60.74
Round  71, Global train loss: 0.238, Global test loss: 1.927, Global test accuracy: 38.09
Round  72, Train loss: 0.176, Test loss: 1.808, Test accuracy: 61.33
Round  72, Global train loss: 0.176, Global test loss: 1.893, Global test accuracy: 38.42
Round  73, Train loss: 0.193, Test loss: 1.846, Test accuracy: 61.04
Round  73, Global train loss: 0.193, Global test loss: 1.904, Global test accuracy: 37.69
Round  74, Train loss: 0.216, Test loss: 1.891, Test accuracy: 61.45
Round  74, Global train loss: 0.216, Global test loss: 2.111, Global test accuracy: 34.89
Round  75, Train loss: 0.201, Test loss: 1.911, Test accuracy: 61.25
Round  75, Global train loss: 0.201, Global test loss: 1.955, Global test accuracy: 30.57
Round  76, Train loss: 0.187, Test loss: 1.930, Test accuracy: 61.60
Round  76, Global train loss: 0.187, Global test loss: 1.929, Global test accuracy: 34.60
Round  77, Train loss: 0.205, Test loss: 1.928, Test accuracy: 61.91
Round  77, Global train loss: 0.205, Global test loss: 1.785, Global test accuracy: 40.15
Round  78, Train loss: 0.236, Test loss: 1.924, Test accuracy: 61.53
Round  78, Global train loss: 0.236, Global test loss: 1.931, Global test accuracy: 28.81
Round  79, Train loss: 0.138, Test loss: 1.938, Test accuracy: 61.42
Round  79, Global train loss: 0.138, Global test loss: 1.888, Global test accuracy: 36.92
Round  80, Train loss: 0.184, Test loss: 1.948, Test accuracy: 61.10
Round  80, Global train loss: 0.184, Global test loss: 1.970, Global test accuracy: 36.72
Round  81, Train loss: 0.186, Test loss: 1.956, Test accuracy: 61.23
Round  81, Global train loss: 0.186, Global test loss: 1.928, Global test accuracy: 37.28
Round  82, Train loss: 0.153, Test loss: 1.997, Test accuracy: 61.46
Round  82, Global train loss: 0.153, Global test loss: 2.234, Global test accuracy: 26.01
Round  83, Train loss: 0.132, Test loss: 1.986, Test accuracy: 61.40
Round  83, Global train loss: 0.132, Global test loss: 1.914, Global test accuracy: 35.56
Round  84, Train loss: 0.130, Test loss: 2.000, Test accuracy: 61.54
Round  84, Global train loss: 0.130, Global test loss: 2.009, Global test accuracy: 25.05
Round  85, Train loss: 0.129, Test loss: 2.012, Test accuracy: 61.63
Round  85, Global train loss: 0.129, Global test loss: 2.025, Global test accuracy: 35.08
Round  86, Train loss: 0.161, Test loss: 2.043, Test accuracy: 61.30
Round  86, Global train loss: 0.161, Global test loss: 1.768, Global test accuracy: 39.87
Round  87, Train loss: 0.125, Test loss: 2.058, Test accuracy: 61.70
Round  87, Global train loss: 0.125, Global test loss: 1.894, Global test accuracy: 37.94
Round  88, Train loss: 0.137, Test loss: 2.075, Test accuracy: 61.80
Round  88, Global train loss: 0.137, Global test loss: 2.126, Global test accuracy: 27.66
Round  89, Train loss: 0.135, Test loss: 2.091, Test accuracy: 61.75
Round  89, Global train loss: 0.135, Global test loss: 2.004, Global test accuracy: 26.93
Round  90, Train loss: 0.109, Test loss: 2.097, Test accuracy: 61.74
Round  90, Global train loss: 0.109, Global test loss: 2.133, Global test accuracy: 24.51
Round  91, Train loss: 0.144, Test loss: 2.098, Test accuracy: 61.57
Round  91, Global train loss: 0.144, Global test loss: 1.828, Global test accuracy: 34.11
Round  92, Train loss: 0.134, Test loss: 2.108, Test accuracy: 61.33
Round  92, Global train loss: 0.134, Global test loss: 1.936, Global test accuracy: 35.73
Round  93, Train loss: 0.112, Test loss: 2.104, Test accuracy: 61.94
Round  93, Global train loss: 0.112, Global test loss: 1.940, Global test accuracy: 34.55
Round  94, Train loss: 0.145, Test loss: 2.136, Test accuracy: 61.49
Round  94, Global train loss: 0.145, Global test loss: 1.909, Global test accuracy: 35.63
Round  95, Train loss: 0.110, Test loss: 2.210, Test accuracy: 61.00
Round  95, Global train loss: 0.110, Global test loss: 1.903, Global test accuracy: 39.50
Round  96, Train loss: 0.129, Test loss: 2.151, Test accuracy: 61.89
Round  96, Global train loss: 0.129, Global test loss: 1.737, Global test accuracy: 40.13
Round  97, Train loss: 0.132, Test loss: 2.185, Test accuracy: 61.38
Round  97, Global train loss: 0.132, Global test loss: 1.902, Global test accuracy: 35.89
Round  98, Train loss: 0.096, Test loss: 2.188, Test accuracy: 61.27
Round  98, Global train loss: 0.096, Global test loss: 2.046, Global test accuracy: 31.14
Round  99, Train loss: 0.102, Test loss: 2.216, Test accuracy: 61.30
Round  99, Global train loss: 0.102, Global test loss: 2.009, Global test accuracy: 31.61
Final Round, Train loss: 0.116, Test loss: 2.205, Test accuracy: 61.63
Final Round, Global train loss: 0.116, Global test loss: 2.009, Global test accuracy: 31.61
Average accuracy final 10 rounds: 61.491 

Average global accuracy final 10 rounds: 34.279999999999994 

1479.7424516677856
[1.3815314769744873, 2.7630629539489746, 3.914299488067627, 5.065536022186279, 6.214921236038208, 7.364306449890137, 8.527820110321045, 9.691333770751953, 10.795417070388794, 11.899500370025635, 13.073032140731812, 14.246563911437988, 15.40951132774353, 16.572458744049072, 17.700966358184814, 18.829473972320557, 19.992125034332275, 21.154776096343994, 22.283406972885132, 23.41203784942627, 24.48307490348816, 25.55411195755005, 26.686439752578735, 27.818767547607422, 28.960100412368774, 30.101433277130127, 31.264442205429077, 32.42745113372803, 33.58008933067322, 34.73272752761841, 35.90523099899292, 37.07773447036743, 38.24235010147095, 39.40696573257446, 40.68361282348633, 41.96025991439819, 43.13180732727051, 44.30335474014282, 45.45162081718445, 46.599886894226074, 47.79347085952759, 48.9870548248291, 50.22022771835327, 51.45340061187744, 52.562010765075684, 53.670620918273926, 54.817346811294556, 55.964072704315186, 57.189054012298584, 58.41403532028198, 59.52840328216553, 60.64277124404907, 61.71989107131958, 62.79701089859009, 63.88264799118042, 64.96828508377075, 66.06611490249634, 67.16394472122192, 68.4215612411499, 69.67917776107788, 70.75238251686096, 71.82558727264404, 72.93114471435547, 74.0367021560669, 75.1393973827362, 76.24209260940552, 77.46996545791626, 78.697838306427, 79.87060618400574, 81.04337406158447, 82.1430869102478, 83.24279975891113, 84.40584945678711, 85.56889915466309, 86.64943408966064, 87.7299690246582, 88.81455516815186, 89.89914131164551, 91.02098727226257, 92.14283323287964, 93.32767987251282, 94.512526512146, 95.69307851791382, 96.87363052368164, 98.06192302703857, 99.25021553039551, 100.42032194137573, 101.59042835235596, 102.7845151424408, 103.97860193252563, 105.06620478630066, 106.15380764007568, 107.28385305404663, 108.41389846801758, 109.58678221702576, 110.75966596603394, 111.93247699737549, 113.10528802871704, 114.29724359512329, 115.48919916152954, 116.68956708908081, 117.88993501663208, 119.07387661933899, 120.2578182220459, 121.46256899833679, 122.66731977462769, 123.84721994400024, 125.0271201133728, 126.16741728782654, 127.30771446228027, 128.3819715976715, 129.45622873306274, 130.57700729370117, 131.6977858543396, 132.92710852622986, 134.15643119812012, 135.23298907279968, 136.30954694747925, 137.4354133605957, 138.56127977371216, 139.67969155311584, 140.79810333251953, 141.93630528450012, 143.0745072364807, 144.20677280426025, 145.3390383720398, 146.538715839386, 147.73839330673218, 148.89514708518982, 150.05190086364746, 151.20658254623413, 152.3612642288208, 153.57565116882324, 154.79003810882568, 155.97622919082642, 157.16242027282715, 158.37541365623474, 159.58840703964233, 160.66080594062805, 161.73320484161377, 163.02331495285034, 164.3134250640869, 165.45596146583557, 166.59849786758423, 167.84251832962036, 169.0865387916565, 170.25480151176453, 171.42306423187256, 172.59255957603455, 173.76205492019653, 174.92593932151794, 176.08982372283936, 177.22519302368164, 178.36056232452393, 179.6467432975769, 180.93292427062988, 182.0551860332489, 183.17744779586792, 184.28747749328613, 185.39750719070435, 186.65249752998352, 187.9074878692627, 189.1411416530609, 190.37479543685913, 191.50007438659668, 192.62535333633423, 193.7224202156067, 194.81948709487915, 195.90460515022278, 196.9897232055664, 198.1371932029724, 199.28466320037842, 200.4319076538086, 201.57915210723877, 202.70723867416382, 203.83532524108887, 205.0352213382721, 206.23511743545532, 207.36221027374268, 208.48930311203003, 209.60110878944397, 210.7129144668579, 211.83194303512573, 212.95097160339355, 214.11257028579712, 215.27416896820068, 216.35881781578064, 217.4434666633606, 218.5884087085724, 219.73335075378418, 220.88606929779053, 222.03878784179688, 223.19199991226196, 224.34521198272705, 225.56122279167175, 226.77723360061646, 228.00542330741882, 229.2336130142212, 230.44225931167603, 231.65090560913086, 234.0933017730713, 236.53569793701172]
[22.34, 22.34, 32.57, 32.57, 41.1, 41.1, 43.71, 43.71, 45.12, 45.12, 49.42, 49.42, 51.06, 51.06, 52.2, 52.2, 52.3, 52.3, 53.16, 53.16, 54.33, 54.33, 56.24, 56.24, 56.49, 56.49, 56.67, 56.67, 58.11, 58.11, 57.64, 57.64, 57.34, 57.34, 58.05, 58.05, 58.59, 58.59, 59.41, 59.41, 59.42, 59.42, 59.66, 59.66, 58.98, 58.98, 59.67, 59.67, 59.4, 59.4, 59.25, 59.25, 58.89, 58.89, 59.63, 59.63, 59.73, 59.73, 59.36, 59.36, 59.89, 59.89, 60.11, 60.11, 59.83, 59.83, 60.3, 60.3, 59.13, 59.13, 59.36, 59.36, 59.5, 59.5, 59.99, 59.99, 59.95, 59.95, 59.66, 59.66, 59.54, 59.54, 60.12, 60.12, 59.84, 59.84, 59.85, 59.85, 60.11, 60.11, 60.19, 60.19, 60.26, 60.26, 60.6, 60.6, 60.81, 60.81, 60.88, 60.88, 60.72, 60.72, 60.62, 60.62, 60.82, 60.82, 61.0, 61.0, 61.65, 61.65, 61.49, 61.49, 61.55, 61.55, 61.55, 61.55, 61.66, 61.66, 61.36, 61.36, 61.37, 61.37, 61.67, 61.67, 61.25, 61.25, 61.54, 61.54, 61.97, 61.97, 62.48, 62.48, 61.84, 61.84, 61.32, 61.32, 61.38, 61.38, 61.22, 61.22, 60.99, 60.99, 60.74, 60.74, 61.33, 61.33, 61.04, 61.04, 61.45, 61.45, 61.25, 61.25, 61.6, 61.6, 61.91, 61.91, 61.53, 61.53, 61.42, 61.42, 61.1, 61.1, 61.23, 61.23, 61.46, 61.46, 61.4, 61.4, 61.54, 61.54, 61.63, 61.63, 61.3, 61.3, 61.7, 61.7, 61.8, 61.8, 61.75, 61.75, 61.74, 61.74, 61.57, 61.57, 61.33, 61.33, 61.94, 61.94, 61.49, 61.49, 61.0, 61.0, 61.89, 61.89, 61.38, 61.38, 61.27, 61.27, 61.3, 61.3, 61.63, 61.63]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.774, Test loss: 2.043, Test accuracy: 17.99
Round   0, Global train loss: 1.774, Global test loss: 2.233, Global test accuracy: 12.92
Round   1, Train loss: 1.452, Test loss: 1.828, Test accuracy: 31.11
Round   1, Global train loss: 1.452, Global test loss: 2.261, Global test accuracy: 20.74
Round   2, Train loss: 1.515, Test loss: 1.552, Test accuracy: 38.81
Round   2, Global train loss: 1.515, Global test loss: 1.957, Global test accuracy: 29.59
Round   3, Train loss: 1.316, Test loss: 1.402, Test accuracy: 43.43
Round   3, Global train loss: 1.316, Global test loss: 1.826, Global test accuracy: 32.14
Round   4, Train loss: 1.270, Test loss: 1.302, Test accuracy: 47.59
Round   4, Global train loss: 1.270, Global test loss: 1.918, Global test accuracy: 27.13
Round   5, Train loss: 1.336, Test loss: 1.201, Test accuracy: 51.81
Round   5, Global train loss: 1.336, Global test loss: 1.679, Global test accuracy: 41.46
Round   6, Train loss: 1.213, Test loss: 1.160, Test accuracy: 53.86
Round   6, Global train loss: 1.213, Global test loss: 1.660, Global test accuracy: 41.37
Round   7, Train loss: 1.255, Test loss: 1.128, Test accuracy: 55.54
Round   7, Global train loss: 1.255, Global test loss: 1.657, Global test accuracy: 41.86
Round   8, Train loss: 1.161, Test loss: 1.110, Test accuracy: 56.59
Round   8, Global train loss: 1.161, Global test loss: 1.590, Global test accuracy: 42.53
Round   9, Train loss: 1.073, Test loss: 1.088, Test accuracy: 58.02
Round   9, Global train loss: 1.073, Global test loss: 1.645, Global test accuracy: 42.64
Round  10, Train loss: 1.160, Test loss: 1.081, Test accuracy: 58.39
Round  10, Global train loss: 1.160, Global test loss: 1.560, Global test accuracy: 45.15
Round  11, Train loss: 1.045, Test loss: 1.044, Test accuracy: 59.90
Round  11, Global train loss: 1.045, Global test loss: 1.558, Global test accuracy: 45.69
Round  12, Train loss: 1.074, Test loss: 1.042, Test accuracy: 59.64
Round  12, Global train loss: 1.074, Global test loss: 1.655, Global test accuracy: 45.68
Round  13, Train loss: 1.128, Test loss: 1.039, Test accuracy: 59.18
Round  13, Global train loss: 1.128, Global test loss: 1.482, Global test accuracy: 48.23
Round  14, Train loss: 0.941, Test loss: 1.041, Test accuracy: 58.70
Round  14, Global train loss: 0.941, Global test loss: 1.492, Global test accuracy: 44.67
Round  15, Train loss: 0.976, Test loss: 1.024, Test accuracy: 60.10
Round  15, Global train loss: 0.976, Global test loss: 1.549, Global test accuracy: 47.81
Round  16, Train loss: 0.966, Test loss: 0.973, Test accuracy: 62.53
Round  16, Global train loss: 0.966, Global test loss: 1.384, Global test accuracy: 50.61
Round  17, Train loss: 0.860, Test loss: 0.971, Test accuracy: 62.77
Round  17, Global train loss: 0.860, Global test loss: 1.354, Global test accuracy: 52.44
Round  18, Train loss: 0.967, Test loss: 0.962, Test accuracy: 63.39
Round  18, Global train loss: 0.967, Global test loss: 1.547, Global test accuracy: 47.76
Round  19, Train loss: 0.991, Test loss: 0.972, Test accuracy: 62.40
Round  19, Global train loss: 0.991, Global test loss: 1.459, Global test accuracy: 50.02
Round  20, Train loss: 0.897, Test loss: 0.974, Test accuracy: 62.45
Round  20, Global train loss: 0.897, Global test loss: 1.346, Global test accuracy: 53.05
Round  21, Train loss: 0.835, Test loss: 0.978, Test accuracy: 61.68
Round  21, Global train loss: 0.835, Global test loss: 1.563, Global test accuracy: 49.17
Round  22, Train loss: 0.985, Test loss: 0.981, Test accuracy: 61.78
Round  22, Global train loss: 0.985, Global test loss: 1.428, Global test accuracy: 48.16
Round  23, Train loss: 0.883, Test loss: 0.967, Test accuracy: 62.56
Round  23, Global train loss: 0.883, Global test loss: 1.397, Global test accuracy: 55.69
Round  24, Train loss: 0.792, Test loss: 0.968, Test accuracy: 61.63
Round  24, Global train loss: 0.792, Global test loss: 1.293, Global test accuracy: 56.28
Round  25, Train loss: 0.812, Test loss: 0.963, Test accuracy: 61.97
Round  25, Global train loss: 0.812, Global test loss: 1.253, Global test accuracy: 56.88
Round  26, Train loss: 0.901, Test loss: 0.940, Test accuracy: 63.44
Round  26, Global train loss: 0.901, Global test loss: 1.229, Global test accuracy: 56.85
Round  27, Train loss: 0.837, Test loss: 0.949, Test accuracy: 63.15
Round  27, Global train loss: 0.837, Global test loss: 1.376, Global test accuracy: 51.62
Round  28, Train loss: 0.815, Test loss: 0.959, Test accuracy: 62.54
Round  28, Global train loss: 0.815, Global test loss: 1.307, Global test accuracy: 55.18
Round  29, Train loss: 0.901, Test loss: 0.940, Test accuracy: 63.45
Round  29, Global train loss: 0.901, Global test loss: 1.381, Global test accuracy: 52.10
Round  30, Train loss: 0.789, Test loss: 0.925, Test accuracy: 64.52
Round  30, Global train loss: 0.789, Global test loss: 1.448, Global test accuracy: 52.65
Round  31, Train loss: 0.802, Test loss: 0.906, Test accuracy: 65.18
Round  31, Global train loss: 0.802, Global test loss: 1.433, Global test accuracy: 55.39
Round  32, Train loss: 0.791, Test loss: 0.883, Test accuracy: 66.51
Round  32, Global train loss: 0.791, Global test loss: 1.296, Global test accuracy: 55.21
Round  33, Train loss: 0.783, Test loss: 0.905, Test accuracy: 65.55
Round  33, Global train loss: 0.783, Global test loss: 1.255, Global test accuracy: 56.35
Round  34, Train loss: 0.728, Test loss: 0.910, Test accuracy: 66.01
Round  34, Global train loss: 0.728, Global test loss: 1.198, Global test accuracy: 58.46
Round  35, Train loss: 0.817, Test loss: 0.929, Test accuracy: 65.34
Round  35, Global train loss: 0.817, Global test loss: 1.232, Global test accuracy: 57.35
Round  36, Train loss: 0.727, Test loss: 0.933, Test accuracy: 65.18
Round  36, Global train loss: 0.727, Global test loss: 1.308, Global test accuracy: 58.13
Round  37, Train loss: 0.595, Test loss: 0.932, Test accuracy: 65.58
Round  37, Global train loss: 0.595, Global test loss: 1.251, Global test accuracy: 58.91
Round  38, Train loss: 0.752, Test loss: 0.925, Test accuracy: 65.44
Round  38, Global train loss: 0.752, Global test loss: 1.212, Global test accuracy: 59.40
Round  39, Train loss: 0.649, Test loss: 0.913, Test accuracy: 66.18
Round  39, Global train loss: 0.649, Global test loss: 1.211, Global test accuracy: 59.05
Round  40, Train loss: 0.622, Test loss: 0.920, Test accuracy: 66.02
Round  40, Global train loss: 0.622, Global test loss: 1.250, Global test accuracy: 59.52
Round  41, Train loss: 0.673, Test loss: 0.950, Test accuracy: 65.29
Round  41, Global train loss: 0.673, Global test loss: 1.351, Global test accuracy: 57.42
Round  42, Train loss: 0.696, Test loss: 0.952, Test accuracy: 65.13
Round  42, Global train loss: 0.696, Global test loss: 1.358, Global test accuracy: 57.31
Round  43, Train loss: 0.555, Test loss: 0.941, Test accuracy: 65.66
Round  43, Global train loss: 0.555, Global test loss: 1.341, Global test accuracy: 55.46
Round  44, Train loss: 0.640, Test loss: 0.908, Test accuracy: 66.58
Round  44, Global train loss: 0.640, Global test loss: 1.242, Global test accuracy: 59.18
Round  45, Train loss: 0.735, Test loss: 0.936, Test accuracy: 66.02
Round  45, Global train loss: 0.735, Global test loss: 1.381, Global test accuracy: 55.29
Round  46, Train loss: 0.642, Test loss: 0.946, Test accuracy: 65.65
Round  46, Global train loss: 0.642, Global test loss: 1.199, Global test accuracy: 60.09
Round  47, Train loss: 0.543, Test loss: 0.932, Test accuracy: 66.27
Round  47, Global train loss: 0.543, Global test loss: 1.225, Global test accuracy: 60.23
Round  48, Train loss: 0.625, Test loss: 0.949, Test accuracy: 66.22
Round  48, Global train loss: 0.625, Global test loss: 1.188, Global test accuracy: 59.50
Round  49, Train loss: 0.568, Test loss: 0.952, Test accuracy: 66.67
Round  49, Global train loss: 0.568, Global test loss: 1.236, Global test accuracy: 59.37
Round  50, Train loss: 0.698, Test loss: 0.923, Test accuracy: 68.16
Round  50, Global train loss: 0.698, Global test loss: 1.243, Global test accuracy: 58.39
Round  51, Train loss: 0.607, Test loss: 0.944, Test accuracy: 67.33
Round  51, Global train loss: 0.607, Global test loss: 1.178, Global test accuracy: 60.74
Round  52, Train loss: 0.583, Test loss: 0.959, Test accuracy: 67.19
Round  52, Global train loss: 0.583, Global test loss: 1.247, Global test accuracy: 58.49
Round  53, Train loss: 0.638, Test loss: 0.951, Test accuracy: 67.33
Round  53, Global train loss: 0.638, Global test loss: 1.254, Global test accuracy: 59.10
Round  54, Train loss: 0.556, Test loss: 0.956, Test accuracy: 67.30
Round  54, Global train loss: 0.556, Global test loss: 1.237, Global test accuracy: 58.82
Round  55, Train loss: 0.529, Test loss: 0.982, Test accuracy: 66.64
Round  55, Global train loss: 0.529, Global test loss: 1.170, Global test accuracy: 60.94
Round  56, Train loss: 0.647, Test loss: 0.957, Test accuracy: 67.65
Round  56, Global train loss: 0.647, Global test loss: 1.232, Global test accuracy: 60.10
Round  57, Train loss: 0.544, Test loss: 0.933, Test accuracy: 68.19
Round  57, Global train loss: 0.544, Global test loss: 1.116, Global test accuracy: 63.25
Round  58, Train loss: 0.549, Test loss: 0.942, Test accuracy: 68.13
Round  58, Global train loss: 0.549, Global test loss: 1.337, Global test accuracy: 60.00
Round  59, Train loss: 0.711, Test loss: 0.970, Test accuracy: 67.47
Round  59, Global train loss: 0.711, Global test loss: 1.279, Global test accuracy: 56.97
Round  60, Train loss: 0.590, Test loss: 0.997, Test accuracy: 66.47
Round  60, Global train loss: 0.590, Global test loss: 1.207, Global test accuracy: 59.95
Round  61, Train loss: 0.499, Test loss: 1.015, Test accuracy: 65.89
Round  61, Global train loss: 0.499, Global test loss: 1.176, Global test accuracy: 61.62
Round  62, Train loss: 0.510, Test loss: 0.990, Test accuracy: 66.70
Round  62, Global train loss: 0.510, Global test loss: 1.189, Global test accuracy: 62.61
Round  63, Train loss: 0.480, Test loss: 0.965, Test accuracy: 67.48
Round  63, Global train loss: 0.480, Global test loss: 1.211, Global test accuracy: 63.27
Round  64, Train loss: 0.607, Test loss: 0.963, Test accuracy: 67.46
Round  64, Global train loss: 0.607, Global test loss: 1.211, Global test accuracy: 60.26
Round  65, Train loss: 0.452, Test loss: 0.961, Test accuracy: 68.09
Round  65, Global train loss: 0.452, Global test loss: 1.208, Global test accuracy: 61.96
Round  66, Train loss: 0.476, Test loss: 0.975, Test accuracy: 67.86
Round  66, Global train loss: 0.476, Global test loss: 1.257, Global test accuracy: 59.81
Round  67, Train loss: 0.520, Test loss: 0.976, Test accuracy: 67.87
Round  67, Global train loss: 0.520, Global test loss: 1.426, Global test accuracy: 56.40
Round  68, Train loss: 0.538, Test loss: 0.979, Test accuracy: 68.14
Round  68, Global train loss: 0.538, Global test loss: 1.309, Global test accuracy: 57.62
Round  69, Train loss: 0.461, Test loss: 0.990, Test accuracy: 67.62
Round  69, Global train loss: 0.461, Global test loss: 1.131, Global test accuracy: 63.24
Round  70, Train loss: 0.463, Test loss: 0.985, Test accuracy: 67.94
Round  70, Global train loss: 0.463, Global test loss: 1.233, Global test accuracy: 60.79
Round  71, Train loss: 0.405, Test loss: 0.993, Test accuracy: 67.98
Round  71, Global train loss: 0.405, Global test loss: 1.354, Global test accuracy: 59.84
Round  72, Train loss: 0.541, Test loss: 1.002, Test accuracy: 68.05
Round  72, Global train loss: 0.541, Global test loss: 1.219, Global test accuracy: 61.74
Round  73, Train loss: 0.530, Test loss: 0.998, Test accuracy: 68.41
Round  73, Global train loss: 0.530, Global test loss: 1.213, Global test accuracy: 61.97
Round  74, Train loss: 0.443, Test loss: 1.030, Test accuracy: 67.89
Round  74, Global train loss: 0.443, Global test loss: 1.475, Global test accuracy: 56.85
Round  75, Train loss: 0.396, Test loss: 1.008, Test accuracy: 68.18
Round  75, Global train loss: 0.396, Global test loss: 1.369, Global test accuracy: 59.34
Round  76, Train loss: 0.384, Test loss: 1.019, Test accuracy: 68.01
Round  76, Global train loss: 0.384, Global test loss: 1.368, Global test accuracy: 58.99
Round  77, Train loss: 0.499, Test loss: 1.047, Test accuracy: 67.95
Round  77, Global train loss: 0.499, Global test loss: 1.328, Global test accuracy: 59.83
Round  78, Train loss: 0.587, Test loss: 1.028, Test accuracy: 68.86
Round  78, Global train loss: 0.587, Global test loss: 1.239, Global test accuracy: 60.54
Round  79, Train loss: 0.577, Test loss: 1.012, Test accuracy: 69.57
Round  79, Global train loss: 0.577, Global test loss: 1.314, Global test accuracy: 59.52
Round  80, Train loss: 0.472, Test loss: 1.039, Test accuracy: 68.39
Round  80, Global train loss: 0.472, Global test loss: 1.406, Global test accuracy: 57.38
Round  81, Train loss: 0.450, Test loss: 1.028, Test accuracy: 68.83
Round  81, Global train loss: 0.450, Global test loss: 1.336, Global test accuracy: 59.60
Round  82, Train loss: 0.461, Test loss: 1.020, Test accuracy: 69.17
Round  82, Global train loss: 0.461, Global test loss: 1.466, Global test accuracy: 58.18
Round  83, Train loss: 0.406, Test loss: 1.040, Test accuracy: 68.72
Round  83, Global train loss: 0.406, Global test loss: 1.389, Global test accuracy: 60.31
Round  84, Train loss: 0.367, Test loss: 1.056, Test accuracy: 68.30
Round  84, Global train loss: 0.367, Global test loss: 1.280, Global test accuracy: 63.01
Round  85, Train loss: 0.487, Test loss: 1.083, Test accuracy: 67.81
Round  85, Global train loss: 0.487, Global test loss: 1.420, Global test accuracy: 58.09
Round  86, Train loss: 0.434, Test loss: 1.068, Test accuracy: 68.38
Round  86, Global train loss: 0.434, Global test loss: 1.276, Global test accuracy: 61.15
Round  87, Train loss: 0.397, Test loss: 1.059, Test accuracy: 68.94
Round  87, Global train loss: 0.397, Global test loss: 1.340, Global test accuracy: 60.46
Round  88, Train loss: 0.454, Test loss: 1.071, Test accuracy: 68.35
Round  88, Global train loss: 0.454, Global test loss: 1.500, Global test accuracy: 56.57
Round  89, Train loss: 0.352, Test loss: 1.052, Test accuracy: 68.80
Round  89, Global train loss: 0.352, Global test loss: 1.402, Global test accuracy: 59.60
Round  90, Train loss: 0.389, Test loss: 1.062, Test accuracy: 68.80
Round  90, Global train loss: 0.389, Global test loss: 1.437, Global test accuracy: 58.67
Round  91, Train loss: 0.401, Test loss: 1.056, Test accuracy: 68.77
Round  91, Global train loss: 0.401, Global test loss: 1.219, Global test accuracy: 63.83
Round  92, Train loss: 0.396, Test loss: 1.087, Test accuracy: 68.16
Round  92, Global train loss: 0.396, Global test loss: 1.360, Global test accuracy: 60.33
Round  93, Train loss: 0.492, Test loss: 1.121, Test accuracy: 67.60
Round  93, Global train loss: 0.492, Global test loss: 1.432, Global test accuracy: 56.87
Round  94, Train loss: 0.409, Test loss: 1.119, Test accuracy: 67.71
Round  94, Global train loss: 0.409, Global test loss: 1.540, Global test accuracy: 60.22
Round  95, Train loss: 0.376, Test loss: 1.099, Test accuracy: 68.34
Round  95, Global train loss: 0.376, Global test loss: 1.215, Global test accuracy: 63.04
Round  96, Train loss: 0.468, Test loss: 1.116, Test accuracy: 67.50
Round  96, Global train loss: 0.468, Global test loss: 1.211, Global test accuracy: 62.71
Round  97, Train loss: 0.455, Test loss: 1.094, Test accuracy: 68.52
Round  97, Global train loss: 0.455, Global test loss: 1.273, Global test accuracy: 60.76
Round  98, Train loss: 0.368, Test loss: 1.107, Test accuracy: 67.91
Round  98, Global train loss: 0.368, Global test loss: 1.545, Global test accuracy: 58.57
Round  99, Train loss: 0.287, Test loss: 1.103, Test accuracy: 68.05
Round  99, Global train loss: 0.287, Global test loss: 1.448, Global test accuracy: 60.42
Final Round, Train loss: 0.319, Test loss: 1.244, Test accuracy: 67.87
Final Round, Global train loss: 0.319, Global test loss: 1.448, Global test accuracy: 60.42
Average accuracy final 10 rounds: 68.136 

Average global accuracy final 10 rounds: 60.542 

1495.8651733398438
[1.368971586227417, 2.737943172454834, 3.8772106170654297, 5.016478061676025, 6.150886535644531, 7.285295009613037, 8.456172943115234, 9.627050876617432, 10.762401342391968, 11.897751808166504, 13.071877479553223, 14.246003150939941, 15.390733003616333, 16.535462856292725, 17.73149800300598, 18.92753314971924, 20.116734981536865, 21.305936813354492, 22.593601942062378, 23.881267070770264, 25.158892393112183, 26.4365177154541, 27.6279878616333, 28.8194580078125, 29.997040033340454, 31.174622058868408, 32.37282371520996, 33.571025371551514, 34.691487550735474, 35.811949729919434, 36.94197130203247, 38.07199287414551, 39.25138282775879, 40.43077278137207, 41.61127781867981, 42.79178285598755, 43.99042510986328, 45.189067363739014, 46.374852895736694, 47.560638427734375, 48.69903802871704, 49.83743762969971, 50.986756801605225, 52.13607597351074, 53.32310247421265, 54.51012897491455, 55.57695245742798, 56.643775939941406, 57.76811599731445, 58.8924560546875, 59.99766230583191, 61.10286855697632, 62.2392098903656, 63.37555122375488, 64.49197316169739, 65.60839509963989, 66.68223118782043, 67.75606727600098, 68.822669506073, 69.88927173614502, 71.00508284568787, 72.12089395523071, 73.25866293907166, 74.3964319229126, 75.57501578330994, 76.75359964370728, 78.04793381690979, 79.3422679901123, 80.46009755134583, 81.57792711257935, 82.77303957939148, 83.96815204620361, 85.12515211105347, 86.28215217590332, 87.39239168167114, 88.50263118743896, 89.63279223442078, 90.76295328140259, 91.90550422668457, 93.04805517196655, 94.17169213294983, 95.2953290939331, 96.42028594017029, 97.54524278640747, 98.68384861946106, 99.82245445251465, 100.96235346794128, 102.10225248336792, 103.22954893112183, 104.35684537887573, 105.50533485412598, 106.65382432937622, 107.81634998321533, 108.97887563705444, 110.29026889801025, 111.60166215896606, 112.73016428947449, 113.85866641998291, 114.98536920547485, 116.1120719909668, 117.1715476512909, 118.23102331161499, 119.36045384407043, 120.48988437652588, 121.67226457595825, 122.85464477539062, 123.99898290634155, 125.14332103729248, 126.30498504638672, 127.46664905548096, 128.62694549560547, 129.78724193572998, 130.9098837375641, 132.0325255393982, 133.1618049144745, 134.29108428955078, 135.4171450138092, 136.54320573806763, 137.6252613067627, 138.70731687545776, 139.89855861663818, 141.0898003578186, 142.28419041633606, 143.47858047485352, 144.63101887702942, 145.78345727920532, 146.9330756664276, 148.0826940536499, 149.26378083229065, 150.4448676109314, 151.6123423576355, 152.7798171043396, 153.9108452796936, 155.0418734550476, 156.1076364517212, 157.17339944839478, 158.29687428474426, 159.42034912109375, 160.54316306114197, 161.66597700119019, 162.76679348945618, 163.86760997772217, 164.98751544952393, 166.10742092132568, 167.23078989982605, 168.35415887832642, 169.55347084999084, 170.75278282165527, 171.94243931770325, 173.13209581375122, 174.30997967720032, 175.4878635406494, 176.61982250213623, 177.75178146362305, 178.88289785385132, 180.0140142440796, 181.1282181739807, 182.24242210388184, 183.37717270851135, 184.51192331314087, 185.64051604270935, 186.76910877227783, 187.90573143959045, 189.04235410690308, 190.1803092956543, 191.31826448440552, 192.43571639060974, 193.55316829681396, 194.7021369934082, 195.85110569000244, 197.01322221755981, 198.1753387451172, 199.3703637123108, 200.5653886795044, 201.75934720039368, 202.95330572128296, 204.1064019203186, 205.25949811935425, 206.4140112400055, 207.56852436065674, 208.681658744812, 209.79479312896729, 210.96274781227112, 212.13070249557495, 213.29185605049133, 214.45300960540771, 215.52190041542053, 216.59079122543335, 217.72946953773499, 218.86814785003662, 220.0441153049469, 221.22008275985718, 222.4009792804718, 223.58187580108643, 224.76142477989197, 225.9409737586975, 227.1492178440094, 228.3574619293213, 229.48614764213562, 230.61483335494995, 233.00111532211304, 235.38739728927612]
[17.99, 17.99, 31.11, 31.11, 38.81, 38.81, 43.43, 43.43, 47.59, 47.59, 51.81, 51.81, 53.86, 53.86, 55.54, 55.54, 56.59, 56.59, 58.02, 58.02, 58.39, 58.39, 59.9, 59.9, 59.64, 59.64, 59.18, 59.18, 58.7, 58.7, 60.1, 60.1, 62.53, 62.53, 62.77, 62.77, 63.39, 63.39, 62.4, 62.4, 62.45, 62.45, 61.68, 61.68, 61.78, 61.78, 62.56, 62.56, 61.63, 61.63, 61.97, 61.97, 63.44, 63.44, 63.15, 63.15, 62.54, 62.54, 63.45, 63.45, 64.52, 64.52, 65.18, 65.18, 66.51, 66.51, 65.55, 65.55, 66.01, 66.01, 65.34, 65.34, 65.18, 65.18, 65.58, 65.58, 65.44, 65.44, 66.18, 66.18, 66.02, 66.02, 65.29, 65.29, 65.13, 65.13, 65.66, 65.66, 66.58, 66.58, 66.02, 66.02, 65.65, 65.65, 66.27, 66.27, 66.22, 66.22, 66.67, 66.67, 68.16, 68.16, 67.33, 67.33, 67.19, 67.19, 67.33, 67.33, 67.3, 67.3, 66.64, 66.64, 67.65, 67.65, 68.19, 68.19, 68.13, 68.13, 67.47, 67.47, 66.47, 66.47, 65.89, 65.89, 66.7, 66.7, 67.48, 67.48, 67.46, 67.46, 68.09, 68.09, 67.86, 67.86, 67.87, 67.87, 68.14, 68.14, 67.62, 67.62, 67.94, 67.94, 67.98, 67.98, 68.05, 68.05, 68.41, 68.41, 67.89, 67.89, 68.18, 68.18, 68.01, 68.01, 67.95, 67.95, 68.86, 68.86, 69.57, 69.57, 68.39, 68.39, 68.83, 68.83, 69.17, 69.17, 68.72, 68.72, 68.3, 68.3, 67.81, 67.81, 68.38, 68.38, 68.94, 68.94, 68.35, 68.35, 68.8, 68.8, 68.8, 68.8, 68.77, 68.77, 68.16, 68.16, 67.6, 67.6, 67.71, 67.71, 68.34, 68.34, 67.5, 67.5, 68.52, 68.52, 67.91, 67.91, 68.05, 68.05, 67.87, 67.87]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.900, Test loss: 2.060, Test accuracy: 20.66
Round   0, Global train loss: 1.900, Global test loss: 2.213, Global test accuracy: 17.17
Round   1, Train loss: 1.466, Test loss: 1.868, Test accuracy: 31.06
Round   1, Global train loss: 1.466, Global test loss: 2.232, Global test accuracy: 22.06
Round   2, Train loss: 1.517, Test loss: 1.578, Test accuracy: 39.13
Round   2, Global train loss: 1.517, Global test loss: 1.901, Global test accuracy: 30.83
Round   3, Train loss: 1.405, Test loss: 1.436, Test accuracy: 43.06
Round   3, Global train loss: 1.405, Global test loss: 1.856, Global test accuracy: 32.13
Round   4, Train loss: 1.380, Test loss: 1.352, Test accuracy: 46.22
Round   4, Global train loss: 1.380, Global test loss: 1.940, Global test accuracy: 22.98
Round   5, Train loss: 1.482, Test loss: 1.277, Test accuracy: 49.72
Round   5, Global train loss: 1.482, Global test loss: 1.728, Global test accuracy: 39.52
Round   6, Train loss: 1.168, Test loss: 1.241, Test accuracy: 51.87
Round   6, Global train loss: 1.168, Global test loss: 1.706, Global test accuracy: 39.09
Round   7, Train loss: 1.263, Test loss: 1.198, Test accuracy: 53.99
Round   7, Global train loss: 1.263, Global test loss: 1.622, Global test accuracy: 42.27
Round   8, Train loss: 1.108, Test loss: 1.193, Test accuracy: 53.19
Round   8, Global train loss: 1.108, Global test loss: 1.593, Global test accuracy: 40.20
Round   9, Train loss: 1.156, Test loss: 1.155, Test accuracy: 55.27
Round   9, Global train loss: 1.156, Global test loss: 1.619, Global test accuracy: 41.90
Round  10, Train loss: 1.179, Test loss: 1.156, Test accuracy: 55.55
Round  10, Global train loss: 1.179, Global test loss: 1.633, Global test accuracy: 38.40
Round  11, Train loss: 1.145, Test loss: 1.137, Test accuracy: 55.79
Round  11, Global train loss: 1.145, Global test loss: 1.569, Global test accuracy: 44.01
Round  12, Train loss: 1.187, Test loss: 1.128, Test accuracy: 56.73
Round  12, Global train loss: 1.187, Global test loss: 1.606, Global test accuracy: 46.81
Round  13, Train loss: 1.023, Test loss: 1.101, Test accuracy: 57.61
Round  13, Global train loss: 1.023, Global test loss: 1.440, Global test accuracy: 50.07
Round  14, Train loss: 1.048, Test loss: 1.061, Test accuracy: 59.16
Round  14, Global train loss: 1.048, Global test loss: 1.382, Global test accuracy: 49.93
Round  15, Train loss: 1.095, Test loss: 1.074, Test accuracy: 58.71
Round  15, Global train loss: 1.095, Global test loss: 1.428, Global test accuracy: 50.44
Round  16, Train loss: 1.031, Test loss: 1.016, Test accuracy: 61.28
Round  16, Global train loss: 1.031, Global test loss: 1.448, Global test accuracy: 46.77
Round  17, Train loss: 1.066, Test loss: 1.018, Test accuracy: 61.27
Round  17, Global train loss: 1.066, Global test loss: 1.432, Global test accuracy: 50.16
Round  18, Train loss: 0.967, Test loss: 1.018, Test accuracy: 60.97
Round  18, Global train loss: 0.967, Global test loss: 1.423, Global test accuracy: 48.08
Round  19, Train loss: 1.022, Test loss: 1.022, Test accuracy: 61.18
Round  19, Global train loss: 1.022, Global test loss: 1.401, Global test accuracy: 50.42
Round  20, Train loss: 0.893, Test loss: 1.014, Test accuracy: 61.41
Round  20, Global train loss: 0.893, Global test loss: 1.354, Global test accuracy: 52.92
Round  21, Train loss: 0.957, Test loss: 0.996, Test accuracy: 61.53
Round  21, Global train loss: 0.957, Global test loss: 1.497, Global test accuracy: 48.98
Round  22, Train loss: 1.218, Test loss: 0.990, Test accuracy: 61.69
Round  22, Global train loss: 1.218, Global test loss: 1.365, Global test accuracy: 54.41
Round  23, Train loss: 1.031, Test loss: 0.989, Test accuracy: 62.01
Round  23, Global train loss: 1.031, Global test loss: 1.359, Global test accuracy: 54.26
Round  24, Train loss: 1.003, Test loss: 0.979, Test accuracy: 62.50
Round  24, Global train loss: 1.003, Global test loss: 1.348, Global test accuracy: 53.36
Round  25, Train loss: 0.962, Test loss: 0.963, Test accuracy: 63.11
Round  25, Global train loss: 0.962, Global test loss: 1.246, Global test accuracy: 57.02
Round  26, Train loss: 0.998, Test loss: 1.001, Test accuracy: 61.36
Round  26, Global train loss: 0.998, Global test loss: 1.277, Global test accuracy: 54.87
Round  27, Train loss: 0.965, Test loss: 0.977, Test accuracy: 62.48
Round  27, Global train loss: 0.965, Global test loss: 1.337, Global test accuracy: 52.47
Round  28, Train loss: 0.948, Test loss: 0.974, Test accuracy: 62.71
Round  28, Global train loss: 0.948, Global test loss: 1.254, Global test accuracy: 56.04
Round  29, Train loss: 1.045, Test loss: 0.957, Test accuracy: 63.37
Round  29, Global train loss: 1.045, Global test loss: 1.309, Global test accuracy: 54.55
Round  30, Train loss: 0.792, Test loss: 0.968, Test accuracy: 63.17
Round  30, Global train loss: 0.792, Global test loss: 1.451, Global test accuracy: 52.18
Round  31, Train loss: 0.961, Test loss: 0.969, Test accuracy: 62.44
Round  31, Global train loss: 0.961, Global test loss: 1.312, Global test accuracy: 53.30
Round  32, Train loss: 0.789, Test loss: 0.933, Test accuracy: 64.38
Round  32, Global train loss: 0.789, Global test loss: 1.235, Global test accuracy: 56.14
Round  33, Train loss: 0.967, Test loss: 0.958, Test accuracy: 64.07
Round  33, Global train loss: 0.967, Global test loss: 1.239, Global test accuracy: 57.19
Round  34, Train loss: 0.719, Test loss: 0.950, Test accuracy: 64.21
Round  34, Global train loss: 0.719, Global test loss: 1.223, Global test accuracy: 56.38
Round  35, Train loss: 0.992, Test loss: 0.936, Test accuracy: 65.29
Round  35, Global train loss: 0.992, Global test loss: 1.201, Global test accuracy: 59.69
Round  36, Train loss: 0.779, Test loss: 0.937, Test accuracy: 65.02
Round  36, Global train loss: 0.779, Global test loss: 1.207, Global test accuracy: 56.61
Round  37, Train loss: 0.695, Test loss: 0.934, Test accuracy: 65.37
Round  37, Global train loss: 0.695, Global test loss: 1.221, Global test accuracy: 57.32
Round  38, Train loss: 0.990, Test loss: 0.929, Test accuracy: 65.03
Round  38, Global train loss: 0.990, Global test loss: 1.282, Global test accuracy: 57.88
Round  39, Train loss: 0.855, Test loss: 0.941, Test accuracy: 64.45
Round  39, Global train loss: 0.855, Global test loss: 1.286, Global test accuracy: 57.44
Round  40, Train loss: 0.716, Test loss: 0.916, Test accuracy: 65.26
Round  40, Global train loss: 0.716, Global test loss: 1.293, Global test accuracy: 58.13
Round  41, Train loss: 0.798, Test loss: 0.907, Test accuracy: 65.96
Round  41, Global train loss: 0.798, Global test loss: 1.356, Global test accuracy: 57.43
Round  42, Train loss: 0.685, Test loss: 0.906, Test accuracy: 65.91
Round  42, Global train loss: 0.685, Global test loss: 1.280, Global test accuracy: 59.25
Round  43, Train loss: 0.649, Test loss: 0.905, Test accuracy: 66.00
Round  43, Global train loss: 0.649, Global test loss: 1.321, Global test accuracy: 54.86
Round  44, Train loss: 0.772, Test loss: 0.909, Test accuracy: 66.03
Round  44, Global train loss: 0.772, Global test loss: 1.230, Global test accuracy: 58.09
Round  45, Train loss: 0.856, Test loss: 0.907, Test accuracy: 66.59
Round  45, Global train loss: 0.856, Global test loss: 1.315, Global test accuracy: 55.32
Round  46, Train loss: 0.631, Test loss: 0.900, Test accuracy: 67.33
Round  46, Global train loss: 0.631, Global test loss: 1.166, Global test accuracy: 61.08
Round  47, Train loss: 0.608, Test loss: 0.921, Test accuracy: 66.75
Round  47, Global train loss: 0.608, Global test loss: 1.183, Global test accuracy: 59.72
Round  48, Train loss: 0.717, Test loss: 0.936, Test accuracy: 66.97
Round  48, Global train loss: 0.717, Global test loss: 1.180, Global test accuracy: 60.98
Round  49, Train loss: 0.775, Test loss: 0.949, Test accuracy: 66.25
Round  49, Global train loss: 0.775, Global test loss: 1.215, Global test accuracy: 58.60
Round  50, Train loss: 0.724, Test loss: 0.974, Test accuracy: 65.38
Round  50, Global train loss: 0.724, Global test loss: 1.230, Global test accuracy: 59.61
Round  51, Train loss: 0.593, Test loss: 0.928, Test accuracy: 66.68
Round  51, Global train loss: 0.593, Global test loss: 1.170, Global test accuracy: 62.31
Round  52, Train loss: 0.575, Test loss: 0.930, Test accuracy: 66.48
Round  52, Global train loss: 0.575, Global test loss: 1.169, Global test accuracy: 60.81
Round  53, Train loss: 0.788, Test loss: 0.956, Test accuracy: 65.84
Round  53, Global train loss: 0.788, Global test loss: 1.183, Global test accuracy: 59.77
Round  54, Train loss: 0.763, Test loss: 0.955, Test accuracy: 66.05
Round  54, Global train loss: 0.763, Global test loss: 1.163, Global test accuracy: 61.14
Round  55, Train loss: 0.620, Test loss: 0.969, Test accuracy: 65.50
Round  55, Global train loss: 0.620, Global test loss: 1.163, Global test accuracy: 60.65
Round  56, Train loss: 0.680, Test loss: 0.944, Test accuracy: 66.73
Round  56, Global train loss: 0.680, Global test loss: 1.201, Global test accuracy: 59.94
Round  57, Train loss: 0.504, Test loss: 0.956, Test accuracy: 66.96
Round  57, Global train loss: 0.504, Global test loss: 1.072, Global test accuracy: 64.53
Round  58, Train loss: 0.702, Test loss: 0.914, Test accuracy: 68.25
Round  58, Global train loss: 0.702, Global test loss: 1.192, Global test accuracy: 60.06
Round  59, Train loss: 0.637, Test loss: 0.934, Test accuracy: 67.40
Round  59, Global train loss: 0.637, Global test loss: 1.259, Global test accuracy: 58.50
Round  60, Train loss: 0.600, Test loss: 0.921, Test accuracy: 67.22
Round  60, Global train loss: 0.600, Global test loss: 1.190, Global test accuracy: 61.16
Round  61, Train loss: 0.619, Test loss: 0.911, Test accuracy: 67.92
Round  61, Global train loss: 0.619, Global test loss: 1.112, Global test accuracy: 62.59
Round  62, Train loss: 0.613, Test loss: 0.908, Test accuracy: 68.87
Round  62, Global train loss: 0.613, Global test loss: 1.174, Global test accuracy: 61.35
Round  63, Train loss: 0.571, Test loss: 0.905, Test accuracy: 68.91
Round  63, Global train loss: 0.571, Global test loss: 1.233, Global test accuracy: 61.80
Round  64, Train loss: 0.698, Test loss: 0.941, Test accuracy: 67.80
Round  64, Global train loss: 0.698, Global test loss: 1.135, Global test accuracy: 62.82
Round  65, Train loss: 0.563, Test loss: 0.963, Test accuracy: 67.45
Round  65, Global train loss: 0.563, Global test loss: 1.165, Global test accuracy: 62.18
Round  66, Train loss: 0.646, Test loss: 0.954, Test accuracy: 67.86
Round  66, Global train loss: 0.646, Global test loss: 1.184, Global test accuracy: 61.54
Round  67, Train loss: 0.596, Test loss: 0.970, Test accuracy: 67.75
Round  67, Global train loss: 0.596, Global test loss: 1.279, Global test accuracy: 58.83
Round  68, Train loss: 0.522, Test loss: 0.956, Test accuracy: 68.53
Round  68, Global train loss: 0.522, Global test loss: 1.258, Global test accuracy: 58.52
Round  69, Train loss: 0.684, Test loss: 0.967, Test accuracy: 67.97
Round  69, Global train loss: 0.684, Global test loss: 1.126, Global test accuracy: 62.09
Round  70, Train loss: 0.556, Test loss: 0.945, Test accuracy: 68.73
Round  70, Global train loss: 0.556, Global test loss: 1.211, Global test accuracy: 61.56
Round  71, Train loss: 0.570, Test loss: 0.967, Test accuracy: 68.15
Round  71, Global train loss: 0.570, Global test loss: 1.246, Global test accuracy: 59.44
Round  72, Train loss: 0.678, Test loss: 0.998, Test accuracy: 67.62
Round  72, Global train loss: 0.678, Global test loss: 1.269, Global test accuracy: 60.17
Round  73, Train loss: 0.630, Test loss: 1.002, Test accuracy: 67.82
Round  73, Global train loss: 0.630, Global test loss: 1.140, Global test accuracy: 63.25
Round  74, Train loss: 0.552, Test loss: 0.990, Test accuracy: 68.40
Round  74, Global train loss: 0.552, Global test loss: 1.291, Global test accuracy: 58.70
Round  75, Train loss: 0.465, Test loss: 0.970, Test accuracy: 68.97
Round  75, Global train loss: 0.465, Global test loss: 1.316, Global test accuracy: 60.20
Round  76, Train loss: 0.544, Test loss: 0.965, Test accuracy: 68.73
Round  76, Global train loss: 0.544, Global test loss: 1.292, Global test accuracy: 58.41
Round  77, Train loss: 0.481, Test loss: 0.977, Test accuracy: 68.57
Round  77, Global train loss: 0.481, Global test loss: 1.232, Global test accuracy: 61.03
Round  78, Train loss: 0.527, Test loss: 0.976, Test accuracy: 68.80
Round  78, Global train loss: 0.527, Global test loss: 1.196, Global test accuracy: 62.81
Round  79, Train loss: 0.745, Test loss: 0.978, Test accuracy: 68.48
Round  79, Global train loss: 0.745, Global test loss: 1.255, Global test accuracy: 60.03
Round  80, Train loss: 0.587, Test loss: 1.012, Test accuracy: 67.67
Round  80, Global train loss: 0.587, Global test loss: 1.307, Global test accuracy: 57.96
Round  81, Train loss: 0.620, Test loss: 1.069, Test accuracy: 66.20
Round  81, Global train loss: 0.620, Global test loss: 1.340, Global test accuracy: 57.38
Round  82, Train loss: 0.491, Test loss: 1.066, Test accuracy: 65.93
Round  82, Global train loss: 0.491, Global test loss: 1.468, Global test accuracy: 55.33
Round  83, Train loss: 0.545, Test loss: 1.073, Test accuracy: 65.86
Round  83, Global train loss: 0.545, Global test loss: 1.239, Global test accuracy: 60.31
Round  84, Train loss: 0.540, Test loss: 1.077, Test accuracy: 66.09
Round  84, Global train loss: 0.540, Global test loss: 1.248, Global test accuracy: 60.42
Round  85, Train loss: 0.601, Test loss: 1.052, Test accuracy: 67.18
Round  85, Global train loss: 0.601, Global test loss: 1.349, Global test accuracy: 58.34
Round  86, Train loss: 0.517, Test loss: 1.052, Test accuracy: 67.42
Round  86, Global train loss: 0.517, Global test loss: 1.243, Global test accuracy: 60.54
Round  87, Train loss: 0.460, Test loss: 1.040, Test accuracy: 67.41
Round  87, Global train loss: 0.460, Global test loss: 1.303, Global test accuracy: 60.30
Round  88, Train loss: 0.544, Test loss: 1.046, Test accuracy: 67.54
Round  88, Global train loss: 0.544, Global test loss: 1.294, Global test accuracy: 59.83
Round  89, Train loss: 0.506, Test loss: 1.077, Test accuracy: 67.16
Round  89, Global train loss: 0.506, Global test loss: 1.269, Global test accuracy: 61.46
Round  90, Train loss: 0.487, Test loss: 1.094, Test accuracy: 66.53
Round  90, Global train loss: 0.487, Global test loss: 1.246, Global test accuracy: 60.29
Round  91, Train loss: 0.450, Test loss: 1.091, Test accuracy: 66.25
Round  91, Global train loss: 0.450, Global test loss: 1.241, Global test accuracy: 61.48
Round  92, Train loss: 0.477, Test loss: 1.080, Test accuracy: 66.98
Round  92, Global train loss: 0.477, Global test loss: 1.242, Global test accuracy: 62.74
Round  93, Train loss: 0.461, Test loss: 1.093, Test accuracy: 66.86
Round  93, Global train loss: 0.461, Global test loss: 1.336, Global test accuracy: 61.39
Round  94, Train loss: 0.510, Test loss: 1.085, Test accuracy: 66.45
Round  94, Global train loss: 0.510, Global test loss: 1.321, Global test accuracy: 62.12/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.473, Test loss: 1.097, Test accuracy: 66.51
Round  95, Global train loss: 0.473, Global test loss: 1.294, Global test accuracy: 61.05
Round  96, Train loss: 0.460, Test loss: 1.094, Test accuracy: 67.32
Round  96, Global train loss: 0.460, Global test loss: 1.192, Global test accuracy: 64.12
Round  97, Train loss: 0.440, Test loss: 1.079, Test accuracy: 67.43
Round  97, Global train loss: 0.440, Global test loss: 1.175, Global test accuracy: 63.10
Round  98, Train loss: 0.487, Test loss: 1.049, Test accuracy: 68.44
Round  98, Global train loss: 0.487, Global test loss: 1.313, Global test accuracy: 61.37
Round  99, Train loss: 0.346, Test loss: 1.050, Test accuracy: 68.66
Round  99, Global train loss: 0.346, Global test loss: 1.384, Global test accuracy: 60.70
Final Round, Train loss: 0.382, Test loss: 1.100, Test accuracy: 68.54
Final Round, Global train loss: 0.382, Global test loss: 1.384, Global test accuracy: 60.70
Average accuracy final 10 rounds: 67.143 

Average global accuracy final 10 rounds: 61.836 

1517.2520899772644
[1.5115952491760254, 3.023190498352051, 4.246395587921143, 5.469600677490234, 6.708957195281982, 7.9483137130737305, 9.223831176757812, 10.499348640441895, 11.737292528152466, 12.975236415863037, 14.2545006275177, 15.533764839172363, 16.807307720184326, 18.08085060119629, 19.30492901802063, 20.52900743484497, 21.83630657196045, 23.143605709075928, 24.43738579750061, 25.731165885925293, 27.03750729560852, 28.343848705291748, 29.643851041793823, 30.9438533782959, 32.1900532245636, 33.4362530708313, 34.593355655670166, 35.75045824050903, 36.989588260650635, 38.228718280792236, 39.46249580383301, 40.69627332687378, 41.93830680847168, 43.18034029006958, 44.46522498130798, 45.75010967254639, 46.961387395858765, 48.17266511917114, 49.408952951431274, 50.645240783691406, 51.930593729019165, 53.215946674346924, 54.44974684715271, 55.683547019958496, 56.846357107162476, 58.009167194366455, 59.202104568481445, 60.395041942596436, 61.640026569366455, 62.885011196136475, 64.05722689628601, 65.22944259643555, 66.47870635986328, 67.72797012329102, 68.89617443084717, 70.06437873840332, 71.23180222511292, 72.39922571182251, 73.5578145980835, 74.71640348434448, 76.05558586120605, 77.39476823806763, 78.60883927345276, 79.82291030883789, 81.08916640281677, 82.35542249679565, 83.52091073989868, 84.68639898300171, 85.97122359275818, 87.25604820251465, 88.58740472793579, 89.91876125335693, 91.15801453590393, 92.39726781845093, 93.65845346450806, 94.91963911056519, 96.23941087722778, 97.55918264389038, 98.73777866363525, 99.91637468338013, 101.09192252159119, 102.26747035980225, 103.48663401603699, 104.70579767227173, 105.92465496063232, 107.14351224899292, 108.41377687454224, 109.68404150009155, 110.9729859828949, 112.26193046569824, 113.55609345436096, 114.85025644302368, 116.08988857269287, 117.32952070236206, 118.5705497264862, 119.81157875061035, 121.08098411560059, 122.35038948059082, 123.62317132949829, 124.89595317840576, 126.18379259109497, 127.47163200378418, 128.71921849250793, 129.9668049812317, 131.27148342132568, 132.57616186141968, 133.8108012676239, 135.04544067382812, 136.2192256450653, 137.3930106163025, 138.63402605056763, 139.87504148483276, 140.99819421768188, 142.121346950531, 143.25921821594238, 144.39708948135376, 145.51597380638123, 146.6348581314087, 147.7883162498474, 148.94177436828613, 150.14030957221985, 151.33884477615356, 152.5563600063324, 153.77387523651123, 154.94125962257385, 156.10864400863647, 157.39949107170105, 158.69033813476562, 159.90273475646973, 161.11513137817383, 162.3382694721222, 163.56140756607056, 164.78655743598938, 166.0117073059082, 167.21748399734497, 168.42326068878174, 169.66383528709412, 170.9044098854065, 172.12000584602356, 173.33560180664062, 174.58403873443604, 175.83247566223145, 177.04923915863037, 178.2660026550293, 179.42680525779724, 180.58760786056519, 181.83001923561096, 183.07243061065674, 184.27923154830933, 185.4860324859619, 186.69580030441284, 187.90556812286377, 189.1231575012207, 190.34074687957764, 191.58377265930176, 192.82679843902588, 193.96524310112, 195.1036877632141, 196.22887063026428, 197.35405349731445, 198.49520897865295, 199.63636445999146, 200.7581009864807, 201.87983751296997, 203.0854754447937, 204.29111337661743, 205.5406379699707, 206.79016256332397, 208.05581092834473, 209.32145929336548, 210.565114736557, 211.80877017974854, 213.00181913375854, 214.19486808776855, 215.42113208770752, 216.64739608764648, 217.84934306144714, 219.0512900352478, 220.30282950401306, 221.55436897277832, 222.788800239563, 224.02323150634766, 225.24753546714783, 226.471839427948, 227.63688397407532, 228.80192852020264, 229.96116280555725, 231.12039709091187, 232.28727650642395, 233.45415592193604, 234.6333453655243, 235.81253480911255, 237.0460057258606, 238.27947664260864, 239.50119614601135, 240.72291564941406, 241.98265290260315, 243.24239015579224, 244.45886874198914, 245.67534732818604, 248.15791130065918, 250.64047527313232]
[20.66, 20.66, 31.06, 31.06, 39.13, 39.13, 43.06, 43.06, 46.22, 46.22, 49.72, 49.72, 51.87, 51.87, 53.99, 53.99, 53.19, 53.19, 55.27, 55.27, 55.55, 55.55, 55.79, 55.79, 56.73, 56.73, 57.61, 57.61, 59.16, 59.16, 58.71, 58.71, 61.28, 61.28, 61.27, 61.27, 60.97, 60.97, 61.18, 61.18, 61.41, 61.41, 61.53, 61.53, 61.69, 61.69, 62.01, 62.01, 62.5, 62.5, 63.11, 63.11, 61.36, 61.36, 62.48, 62.48, 62.71, 62.71, 63.37, 63.37, 63.17, 63.17, 62.44, 62.44, 64.38, 64.38, 64.07, 64.07, 64.21, 64.21, 65.29, 65.29, 65.02, 65.02, 65.37, 65.37, 65.03, 65.03, 64.45, 64.45, 65.26, 65.26, 65.96, 65.96, 65.91, 65.91, 66.0, 66.0, 66.03, 66.03, 66.59, 66.59, 67.33, 67.33, 66.75, 66.75, 66.97, 66.97, 66.25, 66.25, 65.38, 65.38, 66.68, 66.68, 66.48, 66.48, 65.84, 65.84, 66.05, 66.05, 65.5, 65.5, 66.73, 66.73, 66.96, 66.96, 68.25, 68.25, 67.4, 67.4, 67.22, 67.22, 67.92, 67.92, 68.87, 68.87, 68.91, 68.91, 67.8, 67.8, 67.45, 67.45, 67.86, 67.86, 67.75, 67.75, 68.53, 68.53, 67.97, 67.97, 68.73, 68.73, 68.15, 68.15, 67.62, 67.62, 67.82, 67.82, 68.4, 68.4, 68.97, 68.97, 68.73, 68.73, 68.57, 68.57, 68.8, 68.8, 68.48, 68.48, 67.67, 67.67, 66.2, 66.2, 65.93, 65.93, 65.86, 65.86, 66.09, 66.09, 67.18, 67.18, 67.42, 67.42, 67.41, 67.41, 67.54, 67.54, 67.16, 67.16, 66.53, 66.53, 66.25, 66.25, 66.98, 66.98, 66.86, 66.86, 66.45, 66.45, 66.51, 66.51, 67.32, 67.32, 67.43, 67.43, 68.44, 68.44, 68.66, 68.66, 68.54, 68.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.627, Test loss: 2.012, Test accuracy: 25.11
Round   0, Global train loss: 1.627, Global test loss: 2.211, Global test accuracy: 21.09
Round   1, Train loss: 1.579, Test loss: 1.873, Test accuracy: 31.60
Round   1, Global train loss: 1.579, Global test loss: 2.226, Global test accuracy: 22.80
Round   2, Train loss: 1.345, Test loss: 1.601, Test accuracy: 39.65
Round   2, Global train loss: 1.345, Global test loss: 1.987, Global test accuracy: 31.80
Round   3, Train loss: 1.400, Test loss: 1.442, Test accuracy: 43.38
Round   3, Global train loss: 1.400, Global test loss: 1.893, Global test accuracy: 33.13
Round   4, Train loss: 1.284, Test loss: 1.372, Test accuracy: 45.05
Round   4, Global train loss: 1.284, Global test loss: 1.968, Global test accuracy: 24.18
Round   5, Train loss: 1.244, Test loss: 1.284, Test accuracy: 49.21
Round   5, Global train loss: 1.244, Global test loss: 1.804, Global test accuracy: 39.27
Round   6, Train loss: 1.329, Test loss: 1.228, Test accuracy: 51.44
Round   6, Global train loss: 1.329, Global test loss: 1.767, Global test accuracy: 38.77
Round   7, Train loss: 1.186, Test loss: 1.218, Test accuracy: 51.65
Round   7, Global train loss: 1.186, Global test loss: 1.664, Global test accuracy: 41.25
Round   8, Train loss: 1.221, Test loss: 1.189, Test accuracy: 52.90
Round   8, Global train loss: 1.221, Global test loss: 1.718, Global test accuracy: 38.22
Round   9, Train loss: 1.154, Test loss: 1.171, Test accuracy: 53.94
Round   9, Global train loss: 1.154, Global test loss: 1.797, Global test accuracy: 36.97
Round  10, Train loss: 1.093, Test loss: 1.144, Test accuracy: 55.22
Round  10, Global train loss: 1.093, Global test loss: 1.654, Global test accuracy: 39.65
Round  11, Train loss: 1.120, Test loss: 1.121, Test accuracy: 56.33
Round  11, Global train loss: 1.120, Global test loss: 1.601, Global test accuracy: 44.55
Round  12, Train loss: 0.986, Test loss: 1.111, Test accuracy: 57.01
Round  12, Global train loss: 0.986, Global test loss: 1.710, Global test accuracy: 43.48
Round  13, Train loss: 1.102, Test loss: 1.105, Test accuracy: 57.54
Round  13, Global train loss: 1.102, Global test loss: 1.576, Global test accuracy: 46.07
Round  14, Train loss: 1.057, Test loss: 1.083, Test accuracy: 58.64
Round  14, Global train loss: 1.057, Global test loss: 1.462, Global test accuracy: 47.86
Round  15, Train loss: 0.950, Test loss: 1.071, Test accuracy: 58.71
Round  15, Global train loss: 0.950, Global test loss: 1.512, Global test accuracy: 47.46
Round  16, Train loss: 1.104, Test loss: 1.023, Test accuracy: 60.50
Round  16, Global train loss: 1.104, Global test loss: 1.480, Global test accuracy: 47.14
Round  17, Train loss: 0.920, Test loss: 1.024, Test accuracy: 61.09
Round  17, Global train loss: 0.920, Global test loss: 1.387, Global test accuracy: 50.87
Round  18, Train loss: 1.061, Test loss: 1.023, Test accuracy: 61.00
Round  18, Global train loss: 1.061, Global test loss: 1.391, Global test accuracy: 50.34
Round  19, Train loss: 0.808, Test loss: 1.026, Test accuracy: 61.16
Round  19, Global train loss: 0.808, Global test loss: 1.542, Global test accuracy: 47.59
Round  20, Train loss: 0.940, Test loss: 0.994, Test accuracy: 61.71
Round  20, Global train loss: 0.940, Global test loss: 1.316, Global test accuracy: 54.15
Round  21, Train loss: 0.808, Test loss: 0.977, Test accuracy: 62.68
Round  21, Global train loss: 0.808, Global test loss: 1.586, Global test accuracy: 48.17
Round  22, Train loss: 0.823, Test loss: 0.985, Test accuracy: 63.20
Round  22, Global train loss: 0.823, Global test loss: 1.321, Global test accuracy: 54.11
Round  23, Train loss: 0.863, Test loss: 0.977, Test accuracy: 63.43
Round  23, Global train loss: 0.863, Global test loss: 1.281, Global test accuracy: 55.84
Round  24, Train loss: 0.834, Test loss: 0.977, Test accuracy: 64.01
Round  24, Global train loss: 0.834, Global test loss: 1.268, Global test accuracy: 55.84
Round  25, Train loss: 0.874, Test loss: 0.968, Test accuracy: 64.49
Round  25, Global train loss: 0.874, Global test loss: 1.313, Global test accuracy: 53.44
Round  26, Train loss: 0.877, Test loss: 0.978, Test accuracy: 63.62
Round  26, Global train loss: 0.877, Global test loss: 1.235, Global test accuracy: 57.31
Round  27, Train loss: 0.704, Test loss: 0.968, Test accuracy: 64.03
Round  27, Global train loss: 0.704, Global test loss: 1.339, Global test accuracy: 53.64
Round  28, Train loss: 0.927, Test loss: 0.941, Test accuracy: 64.69
Round  28, Global train loss: 0.927, Global test loss: 1.246, Global test accuracy: 55.71
Round  29, Train loss: 0.711, Test loss: 0.941, Test accuracy: 65.00
Round  29, Global train loss: 0.711, Global test loss: 1.275, Global test accuracy: 55.65
Round  30, Train loss: 0.841, Test loss: 0.936, Test accuracy: 65.40
Round  30, Global train loss: 0.841, Global test loss: 1.405, Global test accuracy: 51.42
Round  31, Train loss: 0.689, Test loss: 0.936, Test accuracy: 65.38
Round  31, Global train loss: 0.689, Global test loss: 1.352, Global test accuracy: 55.02
Round  32, Train loss: 0.864, Test loss: 0.954, Test accuracy: 65.25
Round  32, Global train loss: 0.864, Global test loss: 1.317, Global test accuracy: 55.02
Round  33, Train loss: 0.771, Test loss: 0.929, Test accuracy: 65.71
Round  33, Global train loss: 0.771, Global test loss: 1.191, Global test accuracy: 58.51
Round  34, Train loss: 0.725, Test loss: 0.913, Test accuracy: 66.42
Round  34, Global train loss: 0.725, Global test loss: 1.245, Global test accuracy: 56.87
Round  35, Train loss: 0.760, Test loss: 0.918, Test accuracy: 66.68
Round  35, Global train loss: 0.760, Global test loss: 1.297, Global test accuracy: 55.52
Round  36, Train loss: 0.725, Test loss: 0.930, Test accuracy: 66.09
Round  36, Global train loss: 0.725, Global test loss: 1.362, Global test accuracy: 53.52
Round  37, Train loss: 0.675, Test loss: 0.947, Test accuracy: 65.64
Round  37, Global train loss: 0.675, Global test loss: 1.353, Global test accuracy: 52.21
Round  38, Train loss: 0.638, Test loss: 0.943, Test accuracy: 65.66
Round  38, Global train loss: 0.638, Global test loss: 1.245, Global test accuracy: 58.31
Round  39, Train loss: 0.703, Test loss: 0.937, Test accuracy: 66.13
Round  39, Global train loss: 0.703, Global test loss: 1.199, Global test accuracy: 58.90
Round  40, Train loss: 0.650, Test loss: 0.925, Test accuracy: 66.81
Round  40, Global train loss: 0.650, Global test loss: 1.180, Global test accuracy: 60.27
Round  41, Train loss: 0.554, Test loss: 0.939, Test accuracy: 66.60
Round  41, Global train loss: 0.554, Global test loss: 1.281, Global test accuracy: 58.71
Round  42, Train loss: 0.613, Test loss: 0.937, Test accuracy: 66.73
Round  42, Global train loss: 0.613, Global test loss: 1.197, Global test accuracy: 60.00
Round  43, Train loss: 0.624, Test loss: 0.936, Test accuracy: 66.60
Round  43, Global train loss: 0.624, Global test loss: 1.384, Global test accuracy: 52.18
Round  44, Train loss: 0.736, Test loss: 0.959, Test accuracy: 65.91
Round  44, Global train loss: 0.736, Global test loss: 1.200, Global test accuracy: 59.04
Round  45, Train loss: 0.748, Test loss: 0.927, Test accuracy: 67.03
Round  45, Global train loss: 0.748, Global test loss: 1.351, Global test accuracy: 54.53
Round  46, Train loss: 0.733, Test loss: 0.932, Test accuracy: 66.57
Round  46, Global train loss: 0.733, Global test loss: 1.193, Global test accuracy: 61.04
Round  47, Train loss: 0.516, Test loss: 0.943, Test accuracy: 66.66
Round  47, Global train loss: 0.516, Global test loss: 1.192, Global test accuracy: 60.60
Round  48, Train loss: 0.653, Test loss: 0.948, Test accuracy: 66.55
Round  48, Global train loss: 0.653, Global test loss: 1.185, Global test accuracy: 60.23
Round  49, Train loss: 0.502, Test loss: 0.954, Test accuracy: 66.51
Round  49, Global train loss: 0.502, Global test loss: 1.297, Global test accuracy: 57.17
Round  50, Train loss: 0.724, Test loss: 0.974, Test accuracy: 65.39
Round  50, Global train loss: 0.724, Global test loss: 1.363, Global test accuracy: 55.33
Round  51, Train loss: 0.706, Test loss: 0.980, Test accuracy: 65.75
Round  51, Global train loss: 0.706, Global test loss: 1.279, Global test accuracy: 58.89
Round  52, Train loss: 0.576, Test loss: 0.997, Test accuracy: 65.91
Round  52, Global train loss: 0.576, Global test loss: 1.221, Global test accuracy: 60.02
Round  53, Train loss: 0.628, Test loss: 1.000, Test accuracy: 66.49
Round  53, Global train loss: 0.628, Global test loss: 1.274, Global test accuracy: 59.35
Round  54, Train loss: 0.501, Test loss: 0.984, Test accuracy: 67.13
Round  54, Global train loss: 0.501, Global test loss: 1.191, Global test accuracy: 60.83
Round  55, Train loss: 0.601, Test loss: 0.977, Test accuracy: 67.77
Round  55, Global train loss: 0.601, Global test loss: 1.299, Global test accuracy: 58.31
Round  56, Train loss: 0.652, Test loss: 0.999, Test accuracy: 66.56
Round  56, Global train loss: 0.652, Global test loss: 1.204, Global test accuracy: 60.14
Round  57, Train loss: 0.649, Test loss: 0.987, Test accuracy: 66.77
Round  57, Global train loss: 0.649, Global test loss: 1.156, Global test accuracy: 62.26
Round  58, Train loss: 0.506, Test loss: 1.012, Test accuracy: 66.76
Round  58, Global train loss: 0.506, Global test loss: 1.351, Global test accuracy: 57.39
Round  59, Train loss: 0.617, Test loss: 1.039, Test accuracy: 66.22
Round  59, Global train loss: 0.617, Global test loss: 1.304, Global test accuracy: 57.82
Round  60, Train loss: 0.535, Test loss: 1.022, Test accuracy: 66.35
Round  60, Global train loss: 0.535, Global test loss: 1.239, Global test accuracy: 60.83
Round  61, Train loss: 0.512, Test loss: 1.032, Test accuracy: 66.13
Round  61, Global train loss: 0.512, Global test loss: 1.127, Global test accuracy: 63.57
Round  62, Train loss: 0.593, Test loss: 1.030, Test accuracy: 66.21
Round  62, Global train loss: 0.593, Global test loss: 1.238, Global test accuracy: 60.90
Round  63, Train loss: 0.573, Test loss: 1.019, Test accuracy: 66.13
Round  63, Global train loss: 0.573, Global test loss: 1.293, Global test accuracy: 60.15
Round  64, Train loss: 0.516, Test loss: 1.018, Test accuracy: 66.27
Round  64, Global train loss: 0.516, Global test loss: 1.140, Global test accuracy: 62.51
Round  65, Train loss: 0.496, Test loss: 1.009, Test accuracy: 66.93
Round  65, Global train loss: 0.496, Global test loss: 1.217, Global test accuracy: 60.97
Round  66, Train loss: 0.477, Test loss: 1.045, Test accuracy: 66.29
Round  66, Global train loss: 0.477, Global test loss: 1.319, Global test accuracy: 58.67
Round  67, Train loss: 0.456, Test loss: 1.046, Test accuracy: 66.64
Round  67, Global train loss: 0.456, Global test loss: 1.372, Global test accuracy: 58.03
Round  68, Train loss: 0.513, Test loss: 1.044, Test accuracy: 66.97
Round  68, Global train loss: 0.513, Global test loss: 1.352, Global test accuracy: 58.71
Round  69, Train loss: 0.667, Test loss: 1.019, Test accuracy: 67.53
Round  69, Global train loss: 0.667, Global test loss: 1.243, Global test accuracy: 58.50
Round  70, Train loss: 0.443, Test loss: 1.035, Test accuracy: 67.24
Round  70, Global train loss: 0.443, Global test loss: 1.251, Global test accuracy: 60.44
Round  71, Train loss: 0.494, Test loss: 1.067, Test accuracy: 66.92
Round  71, Global train loss: 0.494, Global test loss: 1.381, Global test accuracy: 57.71
Round  72, Train loss: 0.467, Test loss: 1.042, Test accuracy: 67.04
Round  72, Global train loss: 0.467, Global test loss: 1.235, Global test accuracy: 62.52
Round  73, Train loss: 0.395, Test loss: 1.057, Test accuracy: 67.06
Round  73, Global train loss: 0.395, Global test loss: 1.308, Global test accuracy: 60.50
Round  74, Train loss: 0.447, Test loss: 1.069, Test accuracy: 66.98
Round  74, Global train loss: 0.447, Global test loss: 1.419, Global test accuracy: 57.97
Round  75, Train loss: 0.456, Test loss: 1.066, Test accuracy: 66.51
Round  75, Global train loss: 0.456, Global test loss: 1.347, Global test accuracy: 59.26
Round  76, Train loss: 0.455, Test loss: 1.068, Test accuracy: 66.94
Round  76, Global train loss: 0.455, Global test loss: 1.304, Global test accuracy: 59.55
Round  77, Train loss: 0.473, Test loss: 1.063, Test accuracy: 67.57
Round  77, Global train loss: 0.473, Global test loss: 1.234, Global test accuracy: 62.17
Round  78, Train loss: 0.553, Test loss: 1.067, Test accuracy: 67.71
Round  78, Global train loss: 0.553, Global test loss: 1.296, Global test accuracy: 60.37
Round  79, Train loss: 0.378, Test loss: 1.076, Test accuracy: 67.75
Round  79, Global train loss: 0.378, Global test loss: 1.397, Global test accuracy: 59.56
Round  80, Train loss: 0.390, Test loss: 1.070, Test accuracy: 67.59
Round  80, Global train loss: 0.390, Global test loss: 1.510, Global test accuracy: 57.04
Round  81, Train loss: 0.450, Test loss: 1.063, Test accuracy: 67.62
Round  81, Global train loss: 0.450, Global test loss: 1.365, Global test accuracy: 59.49
Round  82, Train loss: 0.516, Test loss: 1.060, Test accuracy: 68.27
Round  82, Global train loss: 0.516, Global test loss: 1.294, Global test accuracy: 59.32
Round  83, Train loss: 0.530, Test loss: 1.046, Test accuracy: 67.53
Round  83, Global train loss: 0.530, Global test loss: 1.262, Global test accuracy: 61.08
Round  84, Train loss: 0.423, Test loss: 1.066, Test accuracy: 67.08
Round  84, Global train loss: 0.423, Global test loss: 1.193, Global test accuracy: 63.37
Round  85, Train loss: 0.352, Test loss: 1.064, Test accuracy: 67.16
Round  85, Global train loss: 0.352, Global test loss: 1.517, Global test accuracy: 57.20
Round  86, Train loss: 0.428, Test loss: 1.076, Test accuracy: 66.94
Round  86, Global train loss: 0.428, Global test loss: 1.256, Global test accuracy: 62.43
Round  87, Train loss: 0.383, Test loss: 1.076, Test accuracy: 67.11
Round  87, Global train loss: 0.383, Global test loss: 1.494, Global test accuracy: 57.83
Round  88, Train loss: 0.332, Test loss: 1.065, Test accuracy: 67.43
Round  88, Global train loss: 0.332, Global test loss: 1.526, Global test accuracy: 57.77
Round  89, Train loss: 0.473, Test loss: 1.079, Test accuracy: 67.86
Round  89, Global train loss: 0.473, Global test loss: 1.296, Global test accuracy: 60.40
Round  90, Train loss: 0.300, Test loss: 1.144, Test accuracy: 66.73
Round  90, Global train loss: 0.300, Global test loss: 1.362, Global test accuracy: 60.41
Round  91, Train loss: 0.448, Test loss: 1.142, Test accuracy: 67.10
Round  91, Global train loss: 0.448, Global test loss: 1.291, Global test accuracy: 61.67
Round  92, Train loss: 0.415, Test loss: 1.126, Test accuracy: 67.74
Round  92, Global train loss: 0.415, Global test loss: 1.342, Global test accuracy: 60.65
Round  93, Train loss: 0.505, Test loss: 1.095, Test accuracy: 68.57
Round  93, Global train loss: 0.505, Global test loss: 1.408, Global test accuracy: 59.44
Round  94, Train loss: 0.438, Test loss: 1.093, Test accuracy: 68.59
Round  94, Global train loss: 0.438, Global test loss: 1.468, Global test accuracy: 59.48
Round  95, Train loss: 0.389, Test loss: 1.086, Test accuracy: 68.87
Round  95, Global train loss: 0.389, Global test loss: 1.254, Global test accuracy: 62.25
Round  96, Train loss: 0.437, Test loss: 1.055, Test accuracy: 69.53
Round  96, Global train loss: 0.437, Global test loss: 1.172, Global test accuracy: 64.74
Round  97, Train loss: 0.410, Test loss: 1.070, Test accuracy: 69.52
Round  97, Global train loss: 0.410, Global test loss: 1.236, Global test accuracy: 63.61
Round  98, Train loss: 0.314, Test loss: 1.062, Test accuracy: 69.76
Round  98, Global train loss: 0.314, Global test loss: 1.553, Global test accuracy: 59.86
Round  99, Train loss: 0.295, Test loss: 1.062, Test accuracy: 69.75
Round  99, Global train loss: 0.295, Global test loss: 1.514, Global test accuracy: 59.95
Final Round, Train loss: 0.327, Test loss: 1.227, Test accuracy: 68.40
Final Round, Global train loss: 0.327, Global test loss: 1.514, Global test accuracy: 59.95
Average accuracy final 10 rounds: 68.616
Average global accuracy final 10 rounds: 61.20599999999998
2091.8788216114044
[2.8594143390655518, 5.2530517578125, 7.862825155258179, 10.450039863586426, 13.004526853561401, 15.703693628311157, 18.37049651145935, 20.938724994659424, 23.536210298538208, 26.130629539489746, 28.605757236480713, 31.135429859161377, 33.756072998046875, 36.326634645462036, 38.9403977394104, 41.4497287273407, 44.11904692649841, 46.778916358947754, 49.439329385757446, 52.08812165260315, 54.72815012931824, 57.310542345047, 59.84879946708679, 62.50459933280945, 65.11414933204651, 67.75736284255981, 70.4101734161377, 72.99357438087463, 75.62414336204529, 78.32537579536438, 81.02702498435974, 83.74556875228882, 86.63588571548462, 89.38487076759338, 92.06718564033508, 94.53443169593811, 96.924391746521, 99.45105123519897, 102.12683844566345, 104.82684063911438, 107.56605505943298, 110.2527666091919, 112.89942002296448, 115.60756254196167, 118.31771230697632, 120.8941798210144, 123.451345205307, 125.97099781036377, 128.56262731552124, 131.0368368625641, 133.396249294281, 135.8223648071289, 138.18733143806458, 140.6371774673462, 143.2488181591034, 145.73454761505127, 148.31346368789673, 150.94683575630188, 153.59002017974854, 156.20769476890564, 158.8107569217682, 161.46645069122314, 164.00834393501282, 166.46346592903137, 169.13425970077515, 171.69485425949097, 174.32589054107666, 177.02177739143372, 179.48889541625977, 181.88082933425903, 184.30615615844727, 186.76724910736084, 189.4010488986969, 192.0421106815338, 194.5628628730774, 197.26950192451477, 199.90676617622375, 202.47607040405273, 204.97615551948547, 207.60104322433472, 210.22040915489197, 212.8018033504486, 215.32186365127563, 217.80133485794067, 220.27792048454285, 222.7115454673767, 225.29324984550476, 227.92654013633728, 230.47345614433289, 233.04250144958496, 235.52633833885193, 238.10968136787415, 240.71736121177673, 243.38342022895813, 245.98221564292908, 248.45593571662903, 251.10638427734375, 253.75331854820251, 256.50463676452637, 259.08135962486267, 263.745480298996]
[25.11, 31.6, 39.65, 43.38, 45.05, 49.21, 51.44, 51.65, 52.9, 53.94, 55.22, 56.33, 57.01, 57.54, 58.64, 58.71, 60.5, 61.09, 61.0, 61.16, 61.71, 62.68, 63.2, 63.43, 64.01, 64.49, 63.62, 64.03, 64.69, 65.0, 65.4, 65.38, 65.25, 65.71, 66.42, 66.68, 66.09, 65.64, 65.66, 66.13, 66.81, 66.6, 66.73, 66.6, 65.91, 67.03, 66.57, 66.66, 66.55, 66.51, 65.39, 65.75, 65.91, 66.49, 67.13, 67.77, 66.56, 66.77, 66.76, 66.22, 66.35, 66.13, 66.21, 66.13, 66.27, 66.93, 66.29, 66.64, 66.97, 67.53, 67.24, 66.92, 67.04, 67.06, 66.98, 66.51, 66.94, 67.57, 67.71, 67.75, 67.59, 67.62, 68.27, 67.53, 67.08, 67.16, 66.94, 67.11, 67.43, 67.86, 66.73, 67.1, 67.74, 68.57, 68.59, 68.87, 69.53, 69.52, 69.76, 69.75, 68.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.024, Test loss: 2.232, Test accuracy: 17.63
Round   1, Train loss: 1.581, Test loss: 2.105, Test accuracy: 27.54
Round   2, Train loss: 1.571, Test loss: 1.652, Test accuracy: 38.29
Round   3, Train loss: 1.384, Test loss: 1.440, Test accuracy: 44.67
Round   4, Train loss: 1.391, Test loss: 1.319, Test accuracy: 49.97
Round   5, Train loss: 1.296, Test loss: 1.178, Test accuracy: 55.64
Round   6, Train loss: 1.226, Test loss: 1.126, Test accuracy: 57.26
Round   7, Train loss: 1.333, Test loss: 1.097, Test accuracy: 57.70
Round   8, Train loss: 1.248, Test loss: 1.066, Test accuracy: 58.83
Round   9, Train loss: 1.020, Test loss: 1.055, Test accuracy: 58.93
Round  10, Train loss: 1.237, Test loss: 1.035, Test accuracy: 60.73
Round  11, Train loss: 1.097, Test loss: 1.032, Test accuracy: 60.56
Round  12, Train loss: 1.059, Test loss: 1.009, Test accuracy: 62.30
Round  13, Train loss: 1.200, Test loss: 0.984, Test accuracy: 63.01
Round  14, Train loss: 0.991, Test loss: 0.979, Test accuracy: 63.68
Round  15, Train loss: 1.118, Test loss: 0.974, Test accuracy: 63.69
Round  16, Train loss: 1.023, Test loss: 0.928, Test accuracy: 65.24
Round  17, Train loss: 0.926, Test loss: 0.915, Test accuracy: 65.25
Round  18, Train loss: 1.015, Test loss: 0.916, Test accuracy: 64.55
Round  19, Train loss: 1.046, Test loss: 0.903, Test accuracy: 65.48
Round  20, Train loss: 1.014, Test loss: 0.904, Test accuracy: 66.56
Round  21, Train loss: 0.840, Test loss: 0.888, Test accuracy: 66.24
Round  22, Train loss: 1.054, Test loss: 0.874, Test accuracy: 67.43
Round  23, Train loss: 0.958, Test loss: 0.877, Test accuracy: 67.22
Round  24, Train loss: 0.801, Test loss: 0.862, Test accuracy: 67.98
Round  25, Train loss: 0.972, Test loss: 0.847, Test accuracy: 68.69
Round  26, Train loss: 0.968, Test loss: 0.850, Test accuracy: 69.56
Round  27, Train loss: 0.859, Test loss: 0.842, Test accuracy: 69.29
Round  28, Train loss: 0.892, Test loss: 0.828, Test accuracy: 69.43
Round  29, Train loss: 1.044, Test loss: 0.816, Test accuracy: 70.16
Round  30, Train loss: 0.875, Test loss: 0.807, Test accuracy: 69.88
Round  31, Train loss: 0.880, Test loss: 0.813, Test accuracy: 69.68
Round  32, Train loss: 0.934, Test loss: 0.786, Test accuracy: 70.69
Round  33, Train loss: 0.882, Test loss: 0.779, Test accuracy: 70.95
Round  34, Train loss: 0.875, Test loss: 0.774, Test accuracy: 71.64
Round  35, Train loss: 0.819, Test loss: 0.775, Test accuracy: 71.89
Round  36, Train loss: 0.891, Test loss: 0.764, Test accuracy: 72.31
Round  37, Train loss: 0.767, Test loss: 0.753, Test accuracy: 72.86
Round  38, Train loss: 0.763, Test loss: 0.757, Test accuracy: 71.96
Round  39, Train loss: 0.754, Test loss: 0.757, Test accuracy: 71.93
Round  40, Train loss: 0.645, Test loss: 0.746, Test accuracy: 72.46
Round  41, Train loss: 0.711, Test loss: 0.741, Test accuracy: 72.81
Round  42, Train loss: 0.686, Test loss: 0.732, Test accuracy: 73.53
Round  43, Train loss: 0.733, Test loss: 0.732, Test accuracy: 73.51
Round  44, Train loss: 0.740, Test loss: 0.721, Test accuracy: 73.36
Round  45, Train loss: 0.814, Test loss: 0.722, Test accuracy: 73.36
Round  46, Train loss: 0.783, Test loss: 0.717, Test accuracy: 73.46
Round  47, Train loss: 0.714, Test loss: 0.722, Test accuracy: 73.36
Round  48, Train loss: 0.783, Test loss: 0.712, Test accuracy: 74.22
Round  49, Train loss: 0.587, Test loss: 0.703, Test accuracy: 74.49
Round  50, Train loss: 0.761, Test loss: 0.702, Test accuracy: 74.45
Round  51, Train loss: 0.761, Test loss: 0.702, Test accuracy: 74.25
Round  52, Train loss: 0.741, Test loss: 0.704, Test accuracy: 73.70
Round  53, Train loss: 0.741, Test loss: 0.691, Test accuracy: 74.79
Round  54, Train loss: 0.650, Test loss: 0.692, Test accuracy: 74.77
Round  55, Train loss: 0.694, Test loss: 0.694, Test accuracy: 74.88
Round  56, Train loss: 0.790, Test loss: 0.683, Test accuracy: 75.56
Round  57, Train loss: 0.614, Test loss: 0.685, Test accuracy: 75.52
Round  58, Train loss: 0.641, Test loss: 0.677, Test accuracy: 75.45
Round  59, Train loss: 0.787, Test loss: 0.693, Test accuracy: 74.95
Round  60, Train loss: 0.676, Test loss: 0.696, Test accuracy: 74.06
Round  61, Train loss: 0.596, Test loss: 0.693, Test accuracy: 74.40
Round  62, Train loss: 0.608, Test loss: 0.690, Test accuracy: 74.69
Round  63, Train loss: 0.480, Test loss: 0.684, Test accuracy: 74.61
Round  64, Train loss: 0.682, Test loss: 0.689, Test accuracy: 74.34
Round  65, Train loss: 0.545, Test loss: 0.696, Test accuracy: 73.98
Round  66, Train loss: 0.483, Test loss: 0.694, Test accuracy: 74.28
Round  67, Train loss: 0.701, Test loss: 0.690, Test accuracy: 74.61
Round  68, Train loss: 0.686, Test loss: 0.686, Test accuracy: 74.31
Round  69, Train loss: 0.638, Test loss: 0.686, Test accuracy: 74.63
Round  70, Train loss: 0.629, Test loss: 0.698, Test accuracy: 73.90
Round  71, Train loss: 0.508, Test loss: 0.690, Test accuracy: 74.27
Round  72, Train loss: 0.572, Test loss: 0.678, Test accuracy: 75.02
Round  73, Train loss: 0.523, Test loss: 0.694, Test accuracy: 74.21
Round  74, Train loss: 0.562, Test loss: 0.691, Test accuracy: 74.10
Round  75, Train loss: 0.539, Test loss: 0.692, Test accuracy: 74.04
Round  76, Train loss: 0.476, Test loss: 0.702, Test accuracy: 73.69
Round  77, Train loss: 0.626, Test loss: 0.680, Test accuracy: 74.61
Round  78, Train loss: 0.646, Test loss: 0.680, Test accuracy: 75.10
Round  79, Train loss: 0.619, Test loss: 0.672, Test accuracy: 75.19
Round  80, Train loss: 0.558, Test loss: 0.676, Test accuracy: 75.20
Round  81, Train loss: 0.546, Test loss: 0.680, Test accuracy: 74.65
Round  82, Train loss: 0.533, Test loss: 0.676, Test accuracy: 75.14
Round  83, Train loss: 0.435, Test loss: 0.669, Test accuracy: 75.30
Round  84, Train loss: 0.522, Test loss: 0.674, Test accuracy: 74.95
Round  85, Train loss: 0.504, Test loss: 0.671, Test accuracy: 75.13
Round  86, Train loss: 0.516, Test loss: 0.681, Test accuracy: 74.78
Round  87, Train loss: 0.473, Test loss: 0.680, Test accuracy: 74.79
Round  88, Train loss: 0.535, Test loss: 0.674, Test accuracy: 74.90
Round  89, Train loss: 0.421, Test loss: 0.678, Test accuracy: 74.93
Round  90, Train loss: 0.456, Test loss: 0.687, Test accuracy: 74.58
Round  91, Train loss: 0.516, Test loss: 0.669, Test accuracy: 75.26
Round  92, Train loss: 0.500, Test loss: 0.671, Test accuracy: 74.93
Round  93, Train loss: 0.642, Test loss: 0.678, Test accuracy: 74.88
Round  94, Train loss: 0.395, Test loss: 0.672, Test accuracy: 75.10
Round  95, Train loss: 0.404, Test loss: 0.664, Test accuracy: 75.57
Round  96, Train loss: 0.547, Test loss: 0.678, Test accuracy: 75.12
Round  97, Train loss: 0.531, Test loss: 0.675, Test accuracy: 74.91
Round  98, Train loss: 0.396, Test loss: 0.678, Test accuracy: 75.26
Round  99, Train loss: 0.346, Test loss: 0.671, Test accuracy: 74.95
Final Round, Train loss: 0.418, Test loss: 0.677, Test accuracy: 75.01
Average accuracy final 10 rounds: 75.05600000000001
1036.738929271698
[1.6195220947265625, 2.831693649291992, 4.062496662139893, 5.31461501121521, 6.561799049377441, 7.829294443130493, 9.074226140975952, 10.35760760307312, 11.604626893997192, 12.854567527770996, 14.110975742340088, 15.390162944793701, 16.633697032928467, 17.875356674194336, 19.26924777030945, 20.548054933547974, 21.83082914352417, 23.088497400283813, 24.422931909561157, 25.76879119873047, 27.0455265045166, 28.330607652664185, 29.69845700263977, 30.98072600364685, 32.24965000152588, 33.49956727027893, 34.777705669403076, 36.03196978569031, 37.32608938217163, 38.624626874923706, 39.91196036338806, 41.19079065322876, 42.42055583000183, 43.662065744400024, 44.96621584892273, 46.268059968948364, 47.53243637084961, 48.784733295440674, 50.02768087387085, 51.284488677978516, 52.5212881565094, 53.810935258865356, 55.107447385787964, 56.41343140602112, 57.72640776634216, 59.013357162475586, 60.27653431892395, 61.55567455291748, 62.87559390068054, 64.21051716804504, 65.49708771705627, 66.80578875541687, 68.05907917022705, 69.34563088417053, 70.59163761138916, 71.85414838790894, 73.11858439445496, 74.40181016921997, 75.73877906799316, 77.11537384986877, 78.40495467185974, 79.69918060302734, 80.9398763179779, 82.22891998291016, 83.47451877593994, 84.74175643920898, 86.00172352790833, 87.28087377548218, 88.50750398635864, 89.73969435691833, 90.96334481239319, 92.19575023651123, 93.42976403236389, 94.66822910308838, 95.91708970069885, 97.15368962287903, 98.45858669281006, 99.74571824073792, 101.10585927963257, 102.39873218536377, 103.7731282711029, 105.0609381198883, 106.38070273399353, 107.64610290527344, 108.98158478736877, 110.34573698043823, 111.67231106758118, 112.97798109054565, 114.34439826011658, 115.62680697441101, 116.9128828048706, 118.16415548324585, 119.41383242607117, 120.66626286506653, 121.95038366317749, 123.20331621170044, 124.48534870147705, 125.75347375869751, 127.02807259559631, 128.27891635894775, 130.32452869415283]
[17.63, 27.54, 38.29, 44.67, 49.97, 55.64, 57.26, 57.7, 58.83, 58.93, 60.73, 60.56, 62.3, 63.01, 63.68, 63.69, 65.24, 65.25, 64.55, 65.48, 66.56, 66.24, 67.43, 67.22, 67.98, 68.69, 69.56, 69.29, 69.43, 70.16, 69.88, 69.68, 70.69, 70.95, 71.64, 71.89, 72.31, 72.86, 71.96, 71.93, 72.46, 72.81, 73.53, 73.51, 73.36, 73.36, 73.46, 73.36, 74.22, 74.49, 74.45, 74.25, 73.7, 74.79, 74.77, 74.88, 75.56, 75.52, 75.45, 74.95, 74.06, 74.4, 74.69, 74.61, 74.34, 73.98, 74.28, 74.61, 74.31, 74.63, 73.9, 74.27, 75.02, 74.21, 74.1, 74.04, 73.69, 74.61, 75.1, 75.19, 75.2, 74.65, 75.14, 75.3, 74.95, 75.13, 74.78, 74.79, 74.9, 74.93, 74.58, 75.26, 74.93, 74.88, 75.1, 75.57, 75.12, 74.91, 75.26, 74.95, 75.01]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.759, Test loss: 2.061, Test accuracy: 21.66
Round   1, Train loss: 1.560, Test loss: 1.775, Test accuracy: 37.67
Round   2, Train loss: 1.234, Test loss: 1.436, Test accuracy: 47.45
Round   3, Train loss: 1.284, Test loss: 1.282, Test accuracy: 51.91
Round   4, Train loss: 1.140, Test loss: 1.240, Test accuracy: 53.21
Round   5, Train loss: 1.152, Test loss: 1.064, Test accuracy: 59.72
Round   6, Train loss: 1.163, Test loss: 1.026, Test accuracy: 61.34
Round   7, Train loss: 1.105, Test loss: 1.008, Test accuracy: 61.44
Round   8, Train loss: 0.973, Test loss: 0.971, Test accuracy: 63.11
Round   9, Train loss: 0.936, Test loss: 0.966, Test accuracy: 62.81
Round  10, Train loss: 0.988, Test loss: 0.955, Test accuracy: 63.60
Round  11, Train loss: 0.874, Test loss: 0.940, Test accuracy: 63.74
Round  12, Train loss: 0.806, Test loss: 0.913, Test accuracy: 65.53
Round  13, Train loss: 0.920, Test loss: 0.881, Test accuracy: 67.31
Round  14, Train loss: 0.859, Test loss: 0.894, Test accuracy: 66.29
Round  15, Train loss: 0.794, Test loss: 0.877, Test accuracy: 66.37
Round  16, Train loss: 0.830, Test loss: 0.846, Test accuracy: 67.16
Round  17, Train loss: 0.761, Test loss: 0.836, Test accuracy: 68.16
Round  18, Train loss: 0.886, Test loss: 0.826, Test accuracy: 68.62
Round  19, Train loss: 0.650, Test loss: 0.812, Test accuracy: 69.62
Round  20, Train loss: 0.684, Test loss: 0.810, Test accuracy: 69.87
Round  21, Train loss: 0.621, Test loss: 0.790, Test accuracy: 70.64
Round  22, Train loss: 0.637, Test loss: 0.771, Test accuracy: 71.39
Round  23, Train loss: 0.727, Test loss: 0.793, Test accuracy: 70.16
Round  24, Train loss: 0.558, Test loss: 0.784, Test accuracy: 71.11
Round  25, Train loss: 0.745, Test loss: 0.799, Test accuracy: 70.59
Round  26, Train loss: 0.655, Test loss: 0.791, Test accuracy: 69.47
Round  27, Train loss: 0.529, Test loss: 0.784, Test accuracy: 70.02
Round  28, Train loss: 0.743, Test loss: 0.771, Test accuracy: 71.41
Round  29, Train loss: 0.566, Test loss: 0.765, Test accuracy: 72.06
Round  30, Train loss: 0.610, Test loss: 0.771, Test accuracy: 71.21
Round  31, Train loss: 0.578, Test loss: 0.770, Test accuracy: 71.10
Round  32, Train loss: 0.696, Test loss: 0.759, Test accuracy: 72.06
Round  33, Train loss: 0.675, Test loss: 0.773, Test accuracy: 71.83
Round  34, Train loss: 0.524, Test loss: 0.770, Test accuracy: 71.70
Round  35, Train loss: 0.625, Test loss: 0.755, Test accuracy: 71.99
Round  36, Train loss: 0.566, Test loss: 0.759, Test accuracy: 71.94
Round  37, Train loss: 0.506, Test loss: 0.763, Test accuracy: 71.84
Round  38, Train loss: 0.470, Test loss: 0.751, Test accuracy: 72.79
Round  39, Train loss: 0.438, Test loss: 0.772, Test accuracy: 72.04
Round  40, Train loss: 0.468, Test loss: 0.783, Test accuracy: 71.83
Round  41, Train loss: 0.379, Test loss: 0.755, Test accuracy: 72.88
Round  42, Train loss: 0.363, Test loss: 0.746, Test accuracy: 72.54
Round  43, Train loss: 0.395, Test loss: 0.764, Test accuracy: 71.89
Round  44, Train loss: 0.497, Test loss: 0.760, Test accuracy: 72.45
Round  45, Train loss: 0.585, Test loss: 0.750, Test accuracy: 72.44
Round  46, Train loss: 0.516, Test loss: 0.747, Test accuracy: 72.72
Round  47, Train loss: 0.362, Test loss: 0.731, Test accuracy: 73.35
Round  48, Train loss: 0.474, Test loss: 0.764, Test accuracy: 72.14
Round  49, Train loss: 0.384, Test loss: 0.736, Test accuracy: 73.29
Round  50, Train loss: 0.574, Test loss: 0.765, Test accuracy: 72.84
Round  51, Train loss: 0.441, Test loss: 0.773, Test accuracy: 71.48
Round  52, Train loss: 0.404, Test loss: 0.765, Test accuracy: 71.82
Round  53, Train loss: 0.517, Test loss: 0.728, Test accuracy: 73.57
Round  54, Train loss: 0.352, Test loss: 0.739, Test accuracy: 73.70
Round  55, Train loss: 0.429, Test loss: 0.760, Test accuracy: 73.45
Round  56, Train loss: 0.534, Test loss: 0.769, Test accuracy: 72.72
Round  57, Train loss: 0.381, Test loss: 0.752, Test accuracy: 73.08
Round  58, Train loss: 0.393, Test loss: 0.779, Test accuracy: 72.78
Round  59, Train loss: 0.467, Test loss: 0.800, Test accuracy: 72.10
Round  60, Train loss: 0.360, Test loss: 0.783, Test accuracy: 72.48
Round  61, Train loss: 0.390, Test loss: 0.772, Test accuracy: 73.08
Round  62, Train loss: 0.382, Test loss: 0.766, Test accuracy: 73.42
Round  63, Train loss: 0.349, Test loss: 0.792, Test accuracy: 72.90
Round  64, Train loss: 0.331, Test loss: 0.756, Test accuracy: 73.48
Round  65, Train loss: 0.338, Test loss: 0.761, Test accuracy: 74.15
Round  66, Train loss: 0.342, Test loss: 0.750, Test accuracy: 73.98
Round  67, Train loss: 0.294, Test loss: 0.740, Test accuracy: 74.11
Round  68, Train loss: 0.381, Test loss: 0.753, Test accuracy: 74.25
Round  69, Train loss: 0.458, Test loss: 0.767, Test accuracy: 73.35
Round  70, Train loss: 0.334, Test loss: 0.762, Test accuracy: 73.24
Round  71, Train loss: 0.376, Test loss: 0.769, Test accuracy: 73.47
Round  72, Train loss: 0.338, Test loss: 0.783, Test accuracy: 73.28
Round  73, Train loss: 0.287, Test loss: 0.800, Test accuracy: 73.33
Round  74, Train loss: 0.332, Test loss: 0.768, Test accuracy: 73.91
Round  75, Train loss: 0.312, Test loss: 0.788, Test accuracy: 73.46
Round  76, Train loss: 0.342, Test loss: 0.796, Test accuracy: 73.85
Round  77, Train loss: 0.337, Test loss: 0.815, Test accuracy: 73.46
Round  78, Train loss: 0.445, Test loss: 0.793, Test accuracy: 72.93
Round  79, Train loss: 0.287, Test loss: 0.800, Test accuracy: 72.96
Round  80, Train loss: 0.307, Test loss: 0.795, Test accuracy: 73.45
Round  81, Train loss: 0.313, Test loss: 0.825, Test accuracy: 73.08
Round  82, Train loss: 0.378, Test loss: 0.810, Test accuracy: 73.13
Round  83, Train loss: 0.363, Test loss: 0.814, Test accuracy: 72.78
Round  84, Train loss: 0.313, Test loss: 0.847, Test accuracy: 72.52
Round  85, Train loss: 0.264, Test loss: 0.847, Test accuracy: 72.41
Round  86, Train loss: 0.298, Test loss: 0.806, Test accuracy: 73.57
Round  87, Train loss: 0.267, Test loss: 0.821, Test accuracy: 73.04
Round  88, Train loss: 0.230, Test loss: 0.801, Test accuracy: 73.28
Round  89, Train loss: 0.297, Test loss: 0.823, Test accuracy: 72.58
Round  90, Train loss: 0.238, Test loss: 0.838, Test accuracy: 72.31
Round  91, Train loss: 0.271, Test loss: 0.819, Test accuracy: 73.21
Round  92, Train loss: 0.232, Test loss: 0.819, Test accuracy: 73.12
Round  93, Train loss: 0.314, Test loss: 0.823, Test accuracy: 73.09
Round  94, Train loss: 0.252, Test loss: 0.825, Test accuracy: 73.36
Round  95, Train loss: 0.279, Test loss: 0.819, Test accuracy: 73.13
Round  96, Train loss: 0.281, Test loss: 0.825, Test accuracy: 72.86
Round  97, Train loss: 0.259, Test loss: 0.817, Test accuracy: 73.59
Round  98, Train loss: 0.219, Test loss: 0.822, Test accuracy: 73.21
Round  99, Train loss: 0.187, Test loss: 0.831, Test accuracy: 73.47
Final Round, Train loss: 0.250, Test loss: 0.822, Test accuracy: 73.39
Average accuracy final 10 rounds: 73.135
1879.2901797294617
[3.015962839126587, 5.489455938339233, 8.18730616569519, 10.880439758300781, 13.46269679069519, 16.122772693634033, 18.637230396270752, 21.35362458229065, 23.873236656188965, 26.384210348129272, 28.896294355392456, 31.563334941864014, 34.2728316783905, 36.78888654708862, 39.314722299575806, 42.01731014251709, 44.54054594039917, 47.21094250679016, 49.87435960769653, 52.55376100540161, 55.24134349822998, 57.93191361427307, 60.47678327560425, 63.058159828186035, 65.7754955291748, 68.46897983551025, 71.15448307991028, 73.88070034980774, 76.56210613250732, 79.19552373886108, 81.9129867553711, 84.48433756828308, 87.14857029914856, 89.81691479682922, 92.4733054637909, 95.1160364151001, 97.74352836608887, 100.3555977344513, 103.03585171699524, 105.51508498191833, 107.9823317527771, 110.42589139938354, 113.11868977546692, 115.78726816177368, 118.42641282081604, 121.13569927215576, 123.82104516029358, 126.85234665870667, 129.37763810157776, 131.9262034893036, 134.4254810810089, 136.9557855129242, 139.55676651000977, 142.18655467033386, 144.830872297287, 147.5062861442566, 150.1250240802765, 152.7006540298462, 155.21240854263306, 157.73937559127808, 160.22986674308777, 162.69139671325684, 165.12544870376587, 167.84063339233398, 170.51848459243774, 173.15720558166504, 175.79529356956482, 178.35008883476257, 180.89596796035767, 183.41951823234558, 186.0786371231079, 188.64197897911072, 191.382958650589, 194.12383198738098, 196.777898311615, 199.37061619758606, 201.99830436706543, 204.6137092113495, 207.14681911468506, 209.59576034545898, 212.30937123298645, 214.8148558139801, 217.64423823356628, 220.48873114585876, 223.30883121490479, 226.10663628578186, 229.02811980247498, 231.84545922279358, 234.57378602027893, 237.31958603858948, 240.12141346931458, 242.95066452026367, 245.96445655822754, 248.81770777702332, 251.58732795715332, 254.34338855743408, 257.1186993122101, 259.8461124897003, 262.5631182193756, 265.3420419692993, 269.9254717826843]
[21.66, 37.67, 47.45, 51.91, 53.21, 59.72, 61.34, 61.44, 63.11, 62.81, 63.6, 63.74, 65.53, 67.31, 66.29, 66.37, 67.16, 68.16, 68.62, 69.62, 69.87, 70.64, 71.39, 70.16, 71.11, 70.59, 69.47, 70.02, 71.41, 72.06, 71.21, 71.1, 72.06, 71.83, 71.7, 71.99, 71.94, 71.84, 72.79, 72.04, 71.83, 72.88, 72.54, 71.89, 72.45, 72.44, 72.72, 73.35, 72.14, 73.29, 72.84, 71.48, 71.82, 73.57, 73.7, 73.45, 72.72, 73.08, 72.78, 72.1, 72.48, 73.08, 73.42, 72.9, 73.48, 74.15, 73.98, 74.11, 74.25, 73.35, 73.24, 73.47, 73.28, 73.33, 73.91, 73.46, 73.85, 73.46, 72.93, 72.96, 73.45, 73.08, 73.13, 72.78, 72.52, 72.41, 73.57, 73.04, 73.28, 72.58, 72.31, 73.21, 73.12, 73.09, 73.36, 73.13, 72.86, 73.59, 73.21, 73.47, 73.39]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.810, Test loss: 2.105, Test accuracy: 22.09
Round   1, Train loss: 1.376, Test loss: 1.877, Test accuracy: 35.31
Round   2, Train loss: 1.304, Test loss: 1.408, Test accuracy: 46.17
Round   3, Train loss: 1.156, Test loss: 1.250, Test accuracy: 50.92
Round   4, Train loss: 1.294, Test loss: 1.193, Test accuracy: 52.24
Round   5, Train loss: 1.101, Test loss: 1.050, Test accuracy: 58.62
Round   6, Train loss: 0.957, Test loss: 1.006, Test accuracy: 60.18
Round   7, Train loss: 1.104, Test loss: 0.990, Test accuracy: 60.97
Round   8, Train loss: 0.929, Test loss: 0.965, Test accuracy: 62.48
Round   9, Train loss: 0.897, Test loss: 0.938, Test accuracy: 63.31
Round  10, Train loss: 0.979, Test loss: 0.937, Test accuracy: 63.75
Round  11, Train loss: 0.886, Test loss: 0.888, Test accuracy: 65.97
Round  12, Train loss: 0.733, Test loss: 0.856, Test accuracy: 66.95
Round  13, Train loss: 0.837, Test loss: 0.851, Test accuracy: 67.67
Round  14, Train loss: 0.740, Test loss: 0.852, Test accuracy: 67.40
Round  15, Train loss: 0.808, Test loss: 0.845, Test accuracy: 67.69
Round  16, Train loss: 0.757, Test loss: 0.803, Test accuracy: 68.89
Round  17, Train loss: 0.823, Test loss: 0.799, Test accuracy: 69.23
Round  18, Train loss: 0.746, Test loss: 0.787, Test accuracy: 70.33
Round  19, Train loss: 0.771, Test loss: 0.773, Test accuracy: 70.64
Round  20, Train loss: 0.726, Test loss: 0.775, Test accuracy: 70.59
Round  21, Train loss: 0.660, Test loss: 0.764, Test accuracy: 71.06
Round  22, Train loss: 0.758, Test loss: 0.754, Test accuracy: 71.49
Round  23, Train loss: 0.718, Test loss: 0.755, Test accuracy: 71.55
Round  24, Train loss: 0.543, Test loss: 0.759, Test accuracy: 71.28
Round  25, Train loss: 0.730, Test loss: 0.761, Test accuracy: 71.30
Round  26, Train loss: 0.656, Test loss: 0.763, Test accuracy: 70.87
Round  27, Train loss: 0.508, Test loss: 0.751, Test accuracy: 70.73
Round  28, Train loss: 0.600, Test loss: 0.750, Test accuracy: 71.31
Round  29, Train loss: 0.698, Test loss: 0.748, Test accuracy: 71.83
Round  30, Train loss: 0.521, Test loss: 0.745, Test accuracy: 72.08
Round  31, Train loss: 0.692, Test loss: 0.743, Test accuracy: 72.13
Round  32, Train loss: 0.613, Test loss: 0.730, Test accuracy: 73.01
Round  33, Train loss: 0.653, Test loss: 0.742, Test accuracy: 72.39
Round  34, Train loss: 0.604, Test loss: 0.753, Test accuracy: 72.10
Round  35, Train loss: 0.462, Test loss: 0.748, Test accuracy: 72.08
Round  36, Train loss: 0.528, Test loss: 0.746, Test accuracy: 72.13
Round  37, Train loss: 0.584, Test loss: 0.755, Test accuracy: 71.62
Round  38, Train loss: 0.503, Test loss: 0.754, Test accuracy: 71.62
Round  39, Train loss: 0.412, Test loss: 0.740, Test accuracy: 72.81
Round  40, Train loss: 0.542, Test loss: 0.720, Test accuracy: 73.03
Round  41, Train loss: 0.450, Test loss: 0.713, Test accuracy: 73.40
Round  42, Train loss: 0.423, Test loss: 0.713, Test accuracy: 73.96
Round  43, Train loss: 0.476, Test loss: 0.730, Test accuracy: 73.42
Round  44, Train loss: 0.390, Test loss: 0.720, Test accuracy: 73.84
Round  45, Train loss: 0.402, Test loss: 0.732, Test accuracy: 73.86
Round  46, Train loss: 0.518, Test loss: 0.728, Test accuracy: 73.24
Round  47, Train loss: 0.528, Test loss: 0.760, Test accuracy: 72.14
Round  48, Train loss: 0.436, Test loss: 0.755, Test accuracy: 72.58
Round  49, Train loss: 0.402, Test loss: 0.755, Test accuracy: 72.94
Round  50, Train loss: 0.401, Test loss: 0.756, Test accuracy: 73.04
Round  51, Train loss: 0.375, Test loss: 0.765, Test accuracy: 72.71
Round  52, Train loss: 0.534, Test loss: 0.757, Test accuracy: 73.11
Round  53, Train loss: 0.404, Test loss: 0.750, Test accuracy: 73.34
Round  54, Train loss: 0.460, Test loss: 0.743, Test accuracy: 73.94
Round  55, Train loss: 0.372, Test loss: 0.747, Test accuracy: 73.97
Round  56, Train loss: 0.385, Test loss: 0.742, Test accuracy: 74.22
Round  57, Train loss: 0.389, Test loss: 0.742, Test accuracy: 74.04
Round  58, Train loss: 0.370, Test loss: 0.759, Test accuracy: 73.45
Round  59, Train loss: 0.330, Test loss: 0.774, Test accuracy: 72.86
Round  60, Train loss: 0.406, Test loss: 0.757, Test accuracy: 72.94
Round  61, Train loss: 0.473, Test loss: 0.767, Test accuracy: 72.93
Round  62, Train loss: 0.401, Test loss: 0.758, Test accuracy: 73.54
Round  63, Train loss: 0.322, Test loss: 0.744, Test accuracy: 73.69
Round  64, Train loss: 0.408, Test loss: 0.757, Test accuracy: 73.39
Round  65, Train loss: 0.369, Test loss: 0.773, Test accuracy: 73.16
Round  66, Train loss: 0.330, Test loss: 0.765, Test accuracy: 73.41
Round  67, Train loss: 0.375, Test loss: 0.766, Test accuracy: 73.44
Round  68, Train loss: 0.373, Test loss: 0.770, Test accuracy: 73.55
Round  69, Train loss: 0.340, Test loss: 0.773, Test accuracy: 73.63
Round  70, Train loss: 0.391, Test loss: 0.777, Test accuracy: 73.51
Round  71, Train loss: 0.348, Test loss: 0.775, Test accuracy: 73.56
Round  72, Train loss: 0.282, Test loss: 0.761, Test accuracy: 73.70
Round  73, Train loss: 0.302, Test loss: 0.743, Test accuracy: 73.74
Round  74, Train loss: 0.308, Test loss: 0.765, Test accuracy: 73.55
Round  75, Train loss: 0.311, Test loss: 0.759, Test accuracy: 74.09
Round  76, Train loss: 0.325, Test loss: 0.759, Test accuracy: 74.05
Round  77, Train loss: 0.338, Test loss: 0.765, Test accuracy: 73.69
Round  78, Train loss: 0.341, Test loss: 0.767, Test accuracy: 74.17
Round  79, Train loss: 0.251, Test loss: 0.782, Test accuracy: 73.75
Round  80, Train loss: 0.264, Test loss: 0.774, Test accuracy: 74.51
Round  81, Train loss: 0.280, Test loss: 0.778, Test accuracy: 74.17
Round  82, Train loss: 0.317, Test loss: 0.788, Test accuracy: 74.06
Round  83, Train loss: 0.281, Test loss: 0.797, Test accuracy: 73.62
Round  84, Train loss: 0.307, Test loss: 0.753, Test accuracy: 74.75
Round  85, Train loss: 0.226, Test loss: 0.765, Test accuracy: 74.50
Round  86, Train loss: 0.300, Test loss: 0.766, Test accuracy: 74.42
Round  87, Train loss: 0.264, Test loss: 0.775, Test accuracy: 74.24
Round  88, Train loss: 0.254, Test loss: 0.789, Test accuracy: 73.89
Round  89, Train loss: 0.284, Test loss: 0.816, Test accuracy: 73.40
Round  90, Train loss: 0.271, Test loss: 0.833, Test accuracy: 72.87
Round  91, Train loss: 0.315, Test loss: 0.843, Test accuracy: 72.80
Round  92, Train loss: 0.287, Test loss: 0.809, Test accuracy: 73.55
Round  93, Train loss: 0.234, Test loss: 0.808, Test accuracy: 73.61
Round  94, Train loss: 0.326, Test loss: 0.810, Test accuracy: 73.58
Round  95, Train loss: 0.308, Test loss: 0.825, Test accuracy: 73.18
Round  96, Train loss: 0.303, Test loss: 0.828, Test accuracy: 73.38
Round  97, Train loss: 0.272, Test loss: 0.827, Test accuracy: 73.05
Round  98, Train loss: 0.286, Test loss: 0.834, Test accuracy: 73.18
Round  99, Train loss: 0.295, Test loss: 0.854, Test accuracy: 72.95
Final Round, Train loss: 0.247, Test loss: 0.835, Test accuracy: 74.10
Average accuracy final 10 rounds: 73.215
3006.866429567337
[3.027792453765869, 5.845005035400391, 8.587249517440796, 11.735613107681274, 14.51380443572998, 17.382042407989502, 20.121717929840088, 22.890483140945435, 25.702799081802368, 28.500360012054443, 31.32638931274414, 34.12690091133118, 37.01403522491455, 39.803353786468506, 42.56552052497864, 45.363160848617554, 48.213186502456665, 51.063984394073486, 53.84019374847412, 56.576274394989014, 59.2752366065979, 63.98125123977661, 68.86963200569153, 73.69125390052795, 78.6722764968872, 83.67828583717346, 88.45458745956421, 93.31503748893738, 98.1863660812378, 103.03287029266357, 107.94030928611755, 113.01243805885315, 117.91477560997009, 122.77299070358276, 127.51907587051392, 132.3791947364807, 137.25708079338074, 142.21559739112854, 147.2089283466339, 152.08405566215515, 156.98421168327332, 161.8438491821289, 166.6891167163849, 171.56136441230774, 176.3723587989807, 181.1412034034729, 186.0199317932129, 190.88918209075928, 195.56899785995483, 200.3902885913849, 205.24849557876587, 210.0279335975647, 214.85626101493835, 220.29896116256714, 225.2139437198639, 230.09591221809387, 235.08098769187927, 239.93909883499146, 244.71208262443542, 249.61191153526306, 254.78666257858276, 259.80380630493164, 264.81005597114563, 269.5217583179474, 274.3924071788788, 279.35202622413635, 284.15510296821594, 289.0599763393402, 293.9988877773285, 298.8477611541748, 303.6951913833618, 308.69156980514526, 313.5823757648468, 318.6119647026062, 323.6748011112213, 328.80793833732605, 333.8254337310791, 338.9422311782837, 344.31085562705994, 349.5703799724579, 354.8700385093689, 360.1455943584442, 365.3190152645111, 370.4450857639313, 375.5903694629669, 380.61196064949036, 385.712158203125, 390.7294406890869, 395.99224400520325, 401.10421538352966, 406.1714813709259, 410.95292115211487, 415.7608621120453, 420.83864092826843, 426.03077602386475, 431.22249126434326, 436.4241087436676, 441.7964780330658, 446.99407148361206, 452.6294984817505, 457.97994232177734]
[22.09, 35.31, 46.17, 50.92, 52.24, 58.62, 60.18, 60.97, 62.48, 63.31, 63.75, 65.97, 66.95, 67.67, 67.4, 67.69, 68.89, 69.23, 70.33, 70.64, 70.59, 71.06, 71.49, 71.55, 71.28, 71.3, 70.87, 70.73, 71.31, 71.83, 72.08, 72.13, 73.01, 72.39, 72.1, 72.08, 72.13, 71.62, 71.62, 72.81, 73.03, 73.4, 73.96, 73.42, 73.84, 73.86, 73.24, 72.14, 72.58, 72.94, 73.04, 72.71, 73.11, 73.34, 73.94, 73.97, 74.22, 74.04, 73.45, 72.86, 72.94, 72.93, 73.54, 73.69, 73.39, 73.16, 73.41, 73.44, 73.55, 73.63, 73.51, 73.56, 73.7, 73.74, 73.55, 74.09, 74.05, 73.69, 74.17, 73.75, 74.51, 74.17, 74.06, 73.62, 74.75, 74.5, 74.42, 74.24, 73.89, 73.4, 72.87, 72.8, 73.55, 73.61, 73.58, 73.18, 73.38, 73.05, 73.18, 72.95, 74.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.772, Test loss: 2.114, Test accuracy: 22.62
Round   1, Train loss: 1.438, Test loss: 1.837, Test accuracy: 35.66
Round   2, Train loss: 1.277, Test loss: 1.401, Test accuracy: 47.37
Round   3, Train loss: 1.131, Test loss: 1.246, Test accuracy: 53.87
Round   4, Train loss: 1.175, Test loss: 1.201, Test accuracy: 55.41
Round   5, Train loss: 1.172, Test loss: 1.064, Test accuracy: 59.91
Round   6, Train loss: 1.150, Test loss: 1.047, Test accuracy: 60.01
Round   7, Train loss: 1.075, Test loss: 1.021, Test accuracy: 60.90
Round   8, Train loss: 0.970, Test loss: 0.986, Test accuracy: 62.81
Round   9, Train loss: 1.035, Test loss: 0.952, Test accuracy: 63.68
Round  10, Train loss: 1.022, Test loss: 0.948, Test accuracy: 63.41
Round  11, Train loss: 0.895, Test loss: 0.928, Test accuracy: 63.87
Round  12, Train loss: 0.834, Test loss: 0.907, Test accuracy: 65.60
Round  13, Train loss: 0.707, Test loss: 0.900, Test accuracy: 65.76
Round  14, Train loss: 0.836, Test loss: 0.882, Test accuracy: 66.93
Round  15, Train loss: 0.766, Test loss: 0.881, Test accuracy: 66.80
Round  16, Train loss: 0.812, Test loss: 0.843, Test accuracy: 67.82
Round  17, Train loss: 0.814, Test loss: 0.842, Test accuracy: 67.84
Round  18, Train loss: 0.845, Test loss: 0.819, Test accuracy: 68.49
Round  19, Train loss: 0.790, Test loss: 0.803, Test accuracy: 69.46
Round  20, Train loss: 0.688, Test loss: 0.806, Test accuracy: 68.78
Round  21, Train loss: 0.705, Test loss: 0.788, Test accuracy: 69.66
Round  22, Train loss: 0.766, Test loss: 0.779, Test accuracy: 70.09
Round  23, Train loss: 0.681, Test loss: 0.803, Test accuracy: 70.02
Round  24, Train loss: 0.645, Test loss: 0.765, Test accuracy: 71.71
Round  25, Train loss: 0.718, Test loss: 0.780, Test accuracy: 70.16
Round  26, Train loss: 0.644, Test loss: 0.771, Test accuracy: 70.93
Round  27, Train loss: 0.608, Test loss: 0.768, Test accuracy: 70.63
Round  28, Train loss: 0.713, Test loss: 0.795, Test accuracy: 69.60
Round  29, Train loss: 0.616, Test loss: 0.775, Test accuracy: 70.85
Round  30, Train loss: 0.523, Test loss: 0.767, Test accuracy: 70.81
Round  31, Train loss: 0.676, Test loss: 0.798, Test accuracy: 69.68
Round  32, Train loss: 0.594, Test loss: 0.782, Test accuracy: 70.59
Round  33, Train loss: 0.670, Test loss: 0.786, Test accuracy: 69.76
Round  34, Train loss: 0.524, Test loss: 0.782, Test accuracy: 70.24
Round  35, Train loss: 0.572, Test loss: 0.773, Test accuracy: 70.83
Round  36, Train loss: 0.418, Test loss: 0.769, Test accuracy: 70.55
Round  37, Train loss: 0.510, Test loss: 0.766, Test accuracy: 71.01
Round  38, Train loss: 0.559, Test loss: 0.781, Test accuracy: 70.95
Round  39, Train loss: 0.500, Test loss: 0.763, Test accuracy: 70.76
Round  40, Train loss: 0.633, Test loss: 0.771, Test accuracy: 70.30
Round  41, Train loss: 0.468, Test loss: 0.754, Test accuracy: 71.37
Round  42, Train loss: 0.502, Test loss: 0.774, Test accuracy: 70.44
Round  43, Train loss: 0.446, Test loss: 0.777, Test accuracy: 70.38
Round  44, Train loss: 0.372, Test loss: 0.778, Test accuracy: 70.62
Round  45, Train loss: 0.483, Test loss: 0.785, Test accuracy: 70.33
Round  46, Train loss: 0.455, Test loss: 0.772, Test accuracy: 70.39
Round  47, Train loss: 0.592, Test loss: 0.762, Test accuracy: 71.57
Round  48, Train loss: 0.372, Test loss: 0.767, Test accuracy: 71.55
Round  49, Train loss: 0.387, Test loss: 0.756, Test accuracy: 71.86
Round  50, Train loss: 0.446, Test loss: 0.770, Test accuracy: 72.03
Round  51, Train loss: 0.376, Test loss: 0.749, Test accuracy: 73.19
Round  52, Train loss: 0.502, Test loss: 0.759, Test accuracy: 72.84
Round  53, Train loss: 0.524, Test loss: 0.759, Test accuracy: 72.55
Round  54, Train loss: 0.410, Test loss: 0.757, Test accuracy: 72.30
Round  55, Train loss: 0.309, Test loss: 0.755, Test accuracy: 72.36
Round  56, Train loss: 0.470, Test loss: 0.745, Test accuracy: 72.83
Round  57, Train loss: 0.417, Test loss: 0.750, Test accuracy: 72.96
Round  58, Train loss: 0.310, Test loss: 0.753, Test accuracy: 73.16
Round  59, Train loss: 0.366, Test loss: 0.773, Test accuracy: 72.48
Round  60, Train loss: 0.367, Test loss: 0.770, Test accuracy: 72.91
Round  61, Train loss: 0.480, Test loss: 0.785, Test accuracy: 72.03
Round  62, Train loss: 0.435, Test loss: 0.778, Test accuracy: 72.85
Round  63, Train loss: 0.289, Test loss: 0.757, Test accuracy: 72.90
Round  64, Train loss: 0.432, Test loss: 0.774, Test accuracy: 72.51
Round  65, Train loss: 0.379, Test loss: 0.781, Test accuracy: 72.37
Round  66, Train loss: 0.422, Test loss: 0.785, Test accuracy: 72.69
Round  67, Train loss: 0.373, Test loss: 0.778, Test accuracy: 73.05
Round  68, Train loss: 0.420, Test loss: 0.790, Test accuracy: 71.97
Round  69, Train loss: 0.362, Test loss: 0.788, Test accuracy: 72.01
Round  70, Train loss: 0.416, Test loss: 0.792, Test accuracy: 72.00
Round  71, Train loss: 0.422, Test loss: 0.807, Test accuracy: 71.50
Round  72, Train loss: 0.255, Test loss: 0.804, Test accuracy: 71.84
Round  73, Train loss: 0.260, Test loss: 0.800, Test accuracy: 71.88
Round  74, Train loss: 0.321, Test loss: 0.828, Test accuracy: 71.19
Round  75, Train loss: 0.363, Test loss: 0.809, Test accuracy: 71.54
Round  76, Train loss: 0.385, Test loss: 0.833, Test accuracy: 71.50
Round  77, Train loss: 0.372, Test loss: 0.839, Test accuracy: 71.98
Round  78, Train loss: 0.437, Test loss: 0.832, Test accuracy: 71.43
Round  79, Train loss: 0.245, Test loss: 0.807, Test accuracy: 71.95
Round  80, Train loss: 0.270, Test loss: 0.822, Test accuracy: 71.96
Round  81, Train loss: 0.304, Test loss: 0.832, Test accuracy: 71.82
Round  82, Train loss: 0.347, Test loss: 0.826, Test accuracy: 71.78
Round  83, Train loss: 0.263, Test loss: 0.809, Test accuracy: 72.32
Round  84, Train loss: 0.295, Test loss: 0.843, Test accuracy: 70.78
Round  85, Train loss: 0.235, Test loss: 0.838, Test accuracy: 71.20
Round  86, Train loss: 0.311, Test loss: 0.854, Test accuracy: 70.95
Round  87, Train loss: 0.280, Test loss: 0.839, Test accuracy: 71.26
Round  88, Train loss: 0.266, Test loss: 0.838, Test accuracy: 71.59
Round  89, Train loss: 0.336, Test loss: 0.824, Test accuracy: 72.18
Round  90, Train loss: 0.250, Test loss: 0.829, Test accuracy: 72.45
Round  91, Train loss: 0.307, Test loss: 0.804, Test accuracy: 73.19
Round  92, Train loss: 0.286, Test loss: 0.828, Test accuracy: 72.68
Round  93, Train loss: 0.219, Test loss: 0.832, Test accuracy: 72.29
Round  94, Train loss: 0.299, Test loss: 0.830, Test accuracy: 72.89
Round  95, Train loss: 0.313, Test loss: 0.847, Test accuracy: 72.24
Round  96, Train loss: 0.317, Test loss: 0.856, Test accuracy: 72.25
Round  97, Train loss: 0.265, Test loss: 0.851, Test accuracy: 72.22
Round  98, Train loss: 0.300, Test loss: 0.862, Test accuracy: 71.99
Round  99, Train loss: 0.285, Test loss: 0.879, Test accuracy: 72.24
Final Round, Train loss: 0.258, Test loss: 0.887, Test accuracy: 71.85
Average accuracy final 10 rounds: 72.444
3540.8919768333435
[3.089049816131592, 6.240123748779297, 9.43732738494873, 12.560868263244629, 15.488178253173828, 18.591161727905273, 21.4874587059021, 24.448012828826904, 27.715027332305908, 30.826035022735596, 33.89551830291748, 37.20464015007019, 40.33561158180237, 43.62485337257385, 46.8602249622345, 50.145869970321655, 53.40270018577576, 56.7232506275177, 59.983492851257324, 63.252419233322144, 66.51365613937378, 72.31188416481018, 78.35644149780273, 84.17249917984009, 90.12771081924438, 96.06608366966248, 101.90845251083374, 107.97239542007446, 113.89412999153137, 119.90344381332397, 125.88340401649475, 131.8157639503479, 138.03978323936462, 144.22152757644653, 150.46192574501038, 156.5233781337738, 163.04642391204834, 169.00898265838623, 175.10378980636597, 181.24038195610046, 187.34857058525085, 193.68371605873108, 199.52253890037537, 205.77014660835266, 211.60197591781616, 217.55195784568787, 223.6337230205536, 229.59096765518188, 235.763516664505, 241.67697978019714, 247.7214949131012, 253.90000462532043, 260.25643587112427, 266.05631613731384, 271.91235971450806, 277.8532409667969, 283.86563515663147, 290.1924080848694, 296.4564769268036, 302.51418447494507, 308.4640679359436, 314.30915212631226, 320.36037135124207, 326.2635266780853, 332.29171204566956, 338.12632036209106, 344.09479904174805, 350.088077545166, 356.2017946243286, 362.6978876590729, 368.50883984565735, 374.8866720199585, 380.73565578460693, 386.6829755306244, 392.7255835533142, 399.11693692207336, 404.93438839912415, 410.79235887527466, 416.6318783760071, 422.3728232383728, 428.4601182937622, 434.35657835006714, 440.32602882385254, 446.2239565849304, 452.9247214794159, 458.741651058197, 464.60468554496765, 470.599240064621, 477.0034625530243, 482.7234802246094, 488.6740200519562, 494.7997992038727, 500.6234939098358, 506.537939786911, 512.4498226642609, 518.5137841701508, 524.4364831447601, 530.2720422744751, 536.5592470169067, 542.3422031402588, 547.997594833374]
[22.62, 35.66, 47.37, 53.87, 55.41, 59.91, 60.01, 60.9, 62.81, 63.68, 63.41, 63.87, 65.6, 65.76, 66.93, 66.8, 67.82, 67.84, 68.49, 69.46, 68.78, 69.66, 70.09, 70.02, 71.71, 70.16, 70.93, 70.63, 69.6, 70.85, 70.81, 69.68, 70.59, 69.76, 70.24, 70.83, 70.55, 71.01, 70.95, 70.76, 70.3, 71.37, 70.44, 70.38, 70.62, 70.33, 70.39, 71.57, 71.55, 71.86, 72.03, 73.19, 72.84, 72.55, 72.3, 72.36, 72.83, 72.96, 73.16, 72.48, 72.91, 72.03, 72.85, 72.9, 72.51, 72.37, 72.69, 73.05, 71.97, 72.01, 72.0, 71.5, 71.84, 71.88, 71.19, 71.54, 71.5, 71.98, 71.43, 71.95, 71.96, 71.82, 71.78, 72.32, 70.78, 71.2, 70.95, 71.26, 71.59, 72.18, 72.45, 73.19, 72.68, 72.29, 72.89, 72.24, 72.25, 72.22, 71.99, 72.24, 71.85]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.638, Test loss: 2.105, Test accuracy: 18.83
Round   1, Train loss: 1.374, Test loss: 1.909, Test accuracy: 34.88
Round   2, Train loss: 1.322, Test loss: 1.436, Test accuracy: 47.51
Round   3, Train loss: 1.181, Test loss: 1.270, Test accuracy: 51.13
Round   4, Train loss: 1.093, Test loss: 1.210, Test accuracy: 53.47
Round   5, Train loss: 1.134, Test loss: 1.071, Test accuracy: 58.79
Round   6, Train loss: 1.131, Test loss: 1.034, Test accuracy: 60.08
Round   7, Train loss: 1.062, Test loss: 1.002, Test accuracy: 61.91
Round   8, Train loss: 0.927, Test loss: 0.987, Test accuracy: 61.91
Round   9, Train loss: 1.025, Test loss: 0.962, Test accuracy: 62.49
Round  10, Train loss: 1.034, Test loss: 0.944, Test accuracy: 63.64
Round  11, Train loss: 0.758, Test loss: 0.904, Test accuracy: 65.45
Round  12, Train loss: 0.767, Test loss: 0.902, Test accuracy: 65.86
Round  13, Train loss: 0.771, Test loss: 0.891, Test accuracy: 65.96
Round  14, Train loss: 0.775, Test loss: 0.852, Test accuracy: 68.26
Round  15, Train loss: 0.686, Test loss: 0.857, Test accuracy: 68.26
Round  16, Train loss: 0.801, Test loss: 0.837, Test accuracy: 68.14
Round  17, Train loss: 0.813, Test loss: 0.841, Test accuracy: 68.41
Round  18, Train loss: 0.658, Test loss: 0.829, Test accuracy: 68.64
Round  19, Train loss: 0.687, Test loss: 0.837, Test accuracy: 68.77
Round  20, Train loss: 0.614, Test loss: 0.817, Test accuracy: 69.26
Round  21, Train loss: 0.705, Test loss: 0.801, Test accuracy: 69.22
Round  22, Train loss: 0.610, Test loss: 0.804, Test accuracy: 68.68
Round  23, Train loss: 0.517, Test loss: 0.803, Test accuracy: 69.35
Round  24, Train loss: 0.545, Test loss: 0.782, Test accuracy: 70.07
Round  25, Train loss: 0.696, Test loss: 0.778, Test accuracy: 69.88
Round  26, Train loss: 0.489, Test loss: 0.772, Test accuracy: 70.19
Round  27, Train loss: 0.520, Test loss: 0.764, Test accuracy: 71.24
Round  28, Train loss: 0.513, Test loss: 0.762, Test accuracy: 71.71
Round  29, Train loss: 0.540, Test loss: 0.759, Test accuracy: 71.63
Round  30, Train loss: 0.374, Test loss: 0.765, Test accuracy: 70.86
Round  31, Train loss: 0.476, Test loss: 0.766, Test accuracy: 71.34
Round  32, Train loss: 0.509, Test loss: 0.759, Test accuracy: 71.58
Round  33, Train loss: 0.527, Test loss: 0.774, Test accuracy: 70.89
Round  34, Train loss: 0.373, Test loss: 0.781, Test accuracy: 70.65
Round  35, Train loss: 0.520, Test loss: 0.756, Test accuracy: 71.87
Round  36, Train loss: 0.354, Test loss: 0.750, Test accuracy: 72.18
Round  37, Train loss: 0.434, Test loss: 0.730, Test accuracy: 72.81
Round  38, Train loss: 0.517, Test loss: 0.737, Test accuracy: 72.70
Round  39, Train loss: 0.403, Test loss: 0.723, Test accuracy: 73.04
Round  40, Train loss: 0.462, Test loss: 0.726, Test accuracy: 73.05
Round  41, Train loss: 0.324, Test loss: 0.749, Test accuracy: 72.52
Round  42, Train loss: 0.413, Test loss: 0.730, Test accuracy: 73.03
Round  43, Train loss: 0.351, Test loss: 0.738, Test accuracy: 72.77
Round  44, Train loss: 0.307, Test loss: 0.728, Test accuracy: 73.10
Round  45, Train loss: 0.432, Test loss: 0.740, Test accuracy: 72.98
Round  46, Train loss: 0.362, Test loss: 0.744, Test accuracy: 72.57
Round  47, Train loss: 0.419, Test loss: 0.760, Test accuracy: 71.92
Round  48, Train loss: 0.305, Test loss: 0.764, Test accuracy: 71.80
Round  49, Train loss: 0.327, Test loss: 0.745, Test accuracy: 72.20
Round  50, Train loss: 0.443, Test loss: 0.761, Test accuracy: 72.67
Round  51, Train loss: 0.353, Test loss: 0.756, Test accuracy: 73.28
Round  52, Train loss: 0.345, Test loss: 0.751, Test accuracy: 72.66
Round  53, Train loss: 0.378, Test loss: 0.734, Test accuracy: 73.33
Round  54, Train loss: 0.274, Test loss: 0.735, Test accuracy: 73.14
Round  55, Train loss: 0.266, Test loss: 0.741, Test accuracy: 73.67
Round  56, Train loss: 0.399, Test loss: 0.744, Test accuracy: 72.97
Round  57, Train loss: 0.325, Test loss: 0.737, Test accuracy: 73.44
Round  58, Train loss: 0.258, Test loss: 0.736, Test accuracy: 73.36
Round  59, Train loss: 0.325, Test loss: 0.746, Test accuracy: 73.80
Round  60, Train loss: 0.297, Test loss: 0.748, Test accuracy: 73.37
Round  61, Train loss: 0.339, Test loss: 0.735, Test accuracy: 73.86
Round  62, Train loss: 0.306, Test loss: 0.750, Test accuracy: 73.51
Round  63, Train loss: 0.277, Test loss: 0.746, Test accuracy: 73.82
Round  64, Train loss: 0.364, Test loss: 0.760, Test accuracy: 73.94
Round  65, Train loss: 0.303, Test loss: 0.765, Test accuracy: 73.55
Round  66, Train loss: 0.328, Test loss: 0.778, Test accuracy: 73.59
Round  67, Train loss: 0.255, Test loss: 0.750, Test accuracy: 73.81
Round  68, Train loss: 0.352, Test loss: 0.779, Test accuracy: 72.60
Round  69, Train loss: 0.257, Test loss: 0.764, Test accuracy: 73.06
Round  70, Train loss: 0.273, Test loss: 0.782, Test accuracy: 72.56
Round  71, Train loss: 0.258, Test loss: 0.780, Test accuracy: 72.70
Round  72, Train loss: 0.206, Test loss: 0.779, Test accuracy: 72.59
Round  73, Train loss: 0.273, Test loss: 0.788, Test accuracy: 72.40
Round  74, Train loss: 0.230, Test loss: 0.798, Test accuracy: 72.02
Round  75, Train loss: 0.256, Test loss: 0.799, Test accuracy: 72.25
Round  76, Train loss: 0.285, Test loss: 0.786, Test accuracy: 72.86
Round  77, Train loss: 0.377, Test loss: 0.792, Test accuracy: 73.08
Round  78, Train loss: 0.302, Test loss: 0.788, Test accuracy: 73.18
Round  79, Train loss: 0.249, Test loss: 0.793, Test accuracy: 73.01
Round  80, Train loss: 0.313, Test loss: 0.806, Test accuracy: 73.05
Traceback (most recent call last):
  File "main_fedpac_copsl.py", line 261, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_glob, idx=idx, w_glob_keys=w_glob_keys,
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2509, in train
    self.filter_data(net, local_net, iter2-head_eps+1, local_eps-head_eps, concept_matrix_local)
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2398, in filter_data
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * iter_num / local_eps))]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2398, in <listcomp>
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * iter_num / local_eps))]
IndexError: list index out of range
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.653, Test loss: 2.130, Test accuracy: 20.17
Round   0, Global train loss: 1.653, Global test loss: 2.280, Global test accuracy: 16.91
Round   1, Train loss: 1.470, Test loss: 1.865, Test accuracy: 32.33
Round   1, Global train loss: 1.470, Global test loss: 2.235, Global test accuracy: 21.93
Round   2, Train loss: 1.406, Test loss: 1.675, Test accuracy: 35.84
Round   2, Global train loss: 1.406, Global test loss: 2.071, Global test accuracy: 27.52
Round   3, Train loss: 1.253, Test loss: 1.494, Test accuracy: 42.08
Round   3, Global train loss: 1.253, Global test loss: 1.937, Global test accuracy: 31.28
Round   4, Train loss: 1.292, Test loss: 1.442, Test accuracy: 42.08
Round   4, Global train loss: 1.292, Global test loss: 2.202, Global test accuracy: 12.58
Round   5, Train loss: 1.345, Test loss: 1.426, Test accuracy: 42.16
Round   5, Global train loss: 1.345, Global test loss: 2.098, Global test accuracy: 33.36
Round   6, Train loss: 1.123, Test loss: 1.398, Test accuracy: 43.30
Round   6, Global train loss: 1.123, Global test loss: 1.913, Global test accuracy: 36.26
Round   7, Train loss: 1.317, Test loss: 1.379, Test accuracy: 44.06
Round   7, Global train loss: 1.317, Global test loss: 2.143, Global test accuracy: 24.69
Round   8, Train loss: 1.049, Test loss: 1.364, Test accuracy: 44.66
Round   8, Global train loss: 1.049, Global test loss: 1.886, Global test accuracy: 30.51
Round   9, Train loss: 1.073, Test loss: 1.354, Test accuracy: 44.99
Round   9, Global train loss: 1.073, Global test loss: 1.899, Global test accuracy: 34.32
Round  10, Train loss: 1.135, Test loss: 1.365, Test accuracy: 44.93
Round  10, Global train loss: 1.135, Global test loss: 2.116, Global test accuracy: 22.91
Round  11, Train loss: 1.118, Test loss: 1.358, Test accuracy: 46.10
Round  11, Global train loss: 1.118, Global test loss: 1.956, Global test accuracy: 30.39
Round  12, Train loss: 0.970, Test loss: 1.353, Test accuracy: 45.43
Round  12, Global train loss: 0.970, Global test loss: 2.182, Global test accuracy: 25.28
Round  13, Train loss: 0.929, Test loss: 1.349, Test accuracy: 45.41
Round  13, Global train loss: 0.929, Global test loss: 1.891, Global test accuracy: 40.69
Round  14, Train loss: 0.832, Test loss: 1.339, Test accuracy: 46.36
Round  14, Global train loss: 0.832, Global test loss: 2.001, Global test accuracy: 26.07
Round  15, Train loss: 0.851, Test loss: 1.334, Test accuracy: 47.17
Round  15, Global train loss: 0.851, Global test loss: 1.926, Global test accuracy: 34.38
Round  16, Train loss: 0.947, Test loss: 1.347, Test accuracy: 47.54
Round  16, Global train loss: 0.947, Global test loss: 2.011, Global test accuracy: 27.41
Round  17, Train loss: 0.960, Test loss: 1.329, Test accuracy: 48.39
Round  17, Global train loss: 0.960, Global test loss: 1.897, Global test accuracy: 35.16
Round  18, Train loss: 0.864, Test loss: 1.362, Test accuracy: 47.96
Round  18, Global train loss: 0.864, Global test loss: 1.990, Global test accuracy: 26.07
Round  19, Train loss: 0.946, Test loss: 1.361, Test accuracy: 47.78
Round  19, Global train loss: 0.946, Global test loss: 1.966, Global test accuracy: 31.98
Round  20, Train loss: 0.828, Test loss: 1.404, Test accuracy: 47.95
Round  20, Global train loss: 0.828, Global test loss: 1.951, Global test accuracy: 34.55
Round  21, Train loss: 0.843, Test loss: 1.382, Test accuracy: 48.80
Round  21, Global train loss: 0.843, Global test loss: 2.002, Global test accuracy: 37.32
Round  22, Train loss: 0.979, Test loss: 1.416, Test accuracy: 48.50
Round  22, Global train loss: 0.979, Global test loss: 2.115, Global test accuracy: 22.99
Round  23, Train loss: 0.819, Test loss: 1.405, Test accuracy: 49.29
Round  23, Global train loss: 0.819, Global test loss: 2.056, Global test accuracy: 30.59
Round  24, Train loss: 0.624, Test loss: 1.423, Test accuracy: 49.14
Round  24, Global train loss: 0.624, Global test loss: 1.834, Global test accuracy: 37.47
Round  25, Train loss: 0.803, Test loss: 1.446, Test accuracy: 48.77
Round  25, Global train loss: 0.803, Global test loss: 1.948, Global test accuracy: 26.43
Round  26, Train loss: 0.758, Test loss: 1.431, Test accuracy: 49.14
Round  26, Global train loss: 0.758, Global test loss: 2.089, Global test accuracy: 27.17
Round  27, Train loss: 0.690, Test loss: 1.429, Test accuracy: 49.75
Round  27, Global train loss: 0.690, Global test loss: 1.912, Global test accuracy: 34.37
Round  28, Train loss: 0.637, Test loss: 1.456, Test accuracy: 49.83
Round  28, Global train loss: 0.637, Global test loss: 2.013, Global test accuracy: 27.63
Round  29, Train loss: 0.829, Test loss: 1.450, Test accuracy: 51.00
Round  29, Global train loss: 0.829, Global test loss: 2.165, Global test accuracy: 14.52
Round  30, Train loss: 0.609, Test loss: 1.439, Test accuracy: 51.12
Round  30, Global train loss: 0.609, Global test loss: 1.925, Global test accuracy: 32.79
Round  31, Train loss: 0.613, Test loss: 1.474, Test accuracy: 50.65
Round  31, Global train loss: 0.613, Global test loss: 2.113, Global test accuracy: 26.41
Round  32, Train loss: 0.676, Test loss: 1.472, Test accuracy: 51.01
Round  32, Global train loss: 0.676, Global test loss: 1.924, Global test accuracy: 36.87
Round  33, Train loss: 0.772, Test loss: 1.536, Test accuracy: 50.67
Round  33, Global train loss: 0.772, Global test loss: 2.033, Global test accuracy: 22.63
Round  34, Train loss: 0.554, Test loss: 1.597, Test accuracy: 50.48
Round  34, Global train loss: 0.554, Global test loss: 1.996, Global test accuracy: 26.22
Round  35, Train loss: 0.491, Test loss: 1.584, Test accuracy: 51.22
Round  35, Global train loss: 0.491, Global test loss: 1.901, Global test accuracy: 33.77
Round  36, Train loss: 0.494, Test loss: 1.645, Test accuracy: 50.97
Round  36, Global train loss: 0.494, Global test loss: 1.973, Global test accuracy: 34.40
Round  37, Train loss: 0.522, Test loss: 1.625, Test accuracy: 51.51
Round  37, Global train loss: 0.522, Global test loss: 1.936, Global test accuracy: 31.36
Round  38, Train loss: 0.581, Test loss: 1.674, Test accuracy: 51.11
Round  38, Global train loss: 0.581, Global test loss: 1.932, Global test accuracy: 34.58
Round  39, Train loss: 0.470, Test loss: 1.654, Test accuracy: 51.82
Round  39, Global train loss: 0.470, Global test loss: 1.873, Global test accuracy: 32.87
Round  40, Train loss: 0.446, Test loss: 1.628, Test accuracy: 52.20
Round  40, Global train loss: 0.446, Global test loss: 1.878, Global test accuracy: 39.06
Round  41, Train loss: 0.490, Test loss: 1.696, Test accuracy: 52.07
Round  41, Global train loss: 0.490, Global test loss: 1.964, Global test accuracy: 32.90
Round  42, Train loss: 0.474, Test loss: 1.720, Test accuracy: 51.67
Round  42, Global train loss: 0.474, Global test loss: 1.886, Global test accuracy: 39.30
Round  43, Train loss: 0.337, Test loss: 1.717, Test accuracy: 52.26
Round  43, Global train loss: 0.337, Global test loss: 2.073, Global test accuracy: 24.31
Round  44, Train loss: 0.380, Test loss: 1.733, Test accuracy: 52.51
Round  44, Global train loss: 0.380, Global test loss: 1.802, Global test accuracy: 37.87
Round  45, Train loss: 0.521, Test loss: 1.757, Test accuracy: 52.72
Round  45, Global train loss: 0.521, Global test loss: 1.972, Global test accuracy: 33.37
Round  46, Train loss: 0.353, Test loss: 1.784, Test accuracy: 53.29
Round  46, Global train loss: 0.353, Global test loss: 1.890, Global test accuracy: 36.69
Round  47, Train loss: 0.396, Test loss: 1.826, Test accuracy: 53.06
Round  47, Global train loss: 0.396, Global test loss: 2.011, Global test accuracy: 33.62
Round  48, Train loss: 0.305, Test loss: 1.834, Test accuracy: 52.98
Round  48, Global train loss: 0.305, Global test loss: 1.925, Global test accuracy: 35.03
Round  49, Train loss: 0.329, Test loss: 1.844, Test accuracy: 53.15
Round  49, Global train loss: 0.329, Global test loss: 2.015, Global test accuracy: 30.93
Round  50, Train loss: 0.463, Test loss: 1.857, Test accuracy: 52.98
Round  50, Global train loss: 0.463, Global test loss: 1.915, Global test accuracy: 31.89
Round  51, Train loss: 0.339, Test loss: 1.848, Test accuracy: 53.29
Round  51, Global train loss: 0.339, Global test loss: 1.777, Global test accuracy: 38.04
Round  52, Train loss: 0.326, Test loss: 1.937, Test accuracy: 53.01
Round  52, Global train loss: 0.326, Global test loss: 2.078, Global test accuracy: 25.38
Round  53, Train loss: 0.432, Test loss: 1.921, Test accuracy: 53.09
Round  53, Global train loss: 0.432, Global test loss: 2.017, Global test accuracy: 32.28
Round  54, Train loss: 0.267, Test loss: 1.935, Test accuracy: 53.13
Round  54, Global train loss: 0.267, Global test loss: 2.152, Global test accuracy: 17.49
Round  55, Train loss: 0.236, Test loss: 1.939, Test accuracy: 53.72
Round  55, Global train loss: 0.236, Global test loss: 1.982, Global test accuracy: 28.70
Round  56, Train loss: 0.389, Test loss: 2.083, Test accuracy: 52.84
Round  56, Global train loss: 0.389, Global test loss: 2.027, Global test accuracy: 26.91
Round  57, Train loss: 0.303, Test loss: 2.130, Test accuracy: 52.43
Round  57, Global train loss: 0.303, Global test loss: 1.714, Global test accuracy: 40.44
Round  58, Train loss: 0.224, Test loss: 2.080, Test accuracy: 52.82
Round  58, Global train loss: 0.224, Global test loss: 2.095, Global test accuracy: 30.01
Round  59, Train loss: 0.333, Test loss: 2.027, Test accuracy: 53.68
Round  59, Global train loss: 0.333, Global test loss: 2.010, Global test accuracy: 32.82
Round  60, Train loss: 0.249, Test loss: 2.124, Test accuracy: 53.33
Round  60, Global train loss: 0.249, Global test loss: 1.768, Global test accuracy: 41.41
Round  61, Train loss: 0.311, Test loss: 2.158, Test accuracy: 53.48
Round  61, Global train loss: 0.311, Global test loss: 2.077, Global test accuracy: 22.55
Round  62, Train loss: 0.312, Test loss: 2.206, Test accuracy: 53.59
Round  62, Global train loss: 0.312, Global test loss: 1.973, Global test accuracy: 34.12
Round  63, Train loss: 0.212, Test loss: 2.201, Test accuracy: 53.38
Round  63, Global train loss: 0.212, Global test loss: 1.839, Global test accuracy: 36.80
Round  64, Train loss: 0.366, Test loss: 2.247, Test accuracy: 53.07
Round  64, Global train loss: 0.366, Global test loss: 2.088, Global test accuracy: 23.99
Round  65, Train loss: 0.258, Test loss: 2.289, Test accuracy: 52.96
Round  65, Global train loss: 0.258, Global test loss: 2.069, Global test accuracy: 22.21
Round  66, Train loss: 0.213, Test loss: 2.313, Test accuracy: 53.30
Round  66, Global train loss: 0.213, Global test loss: 1.977, Global test accuracy: 30.63
Round  67, Train loss: 0.246, Test loss: 2.441, Test accuracy: 52.20
Round  67, Global train loss: 0.246, Global test loss: 2.148, Global test accuracy: 23.78
Round  68, Train loss: 0.320, Test loss: 2.431, Test accuracy: 53.13
Round  68, Global train loss: 0.320, Global test loss: 2.170, Global test accuracy: 26.89
Round  69, Train loss: 0.243, Test loss: 2.430, Test accuracy: 52.77
Round  69, Global train loss: 0.243, Global test loss: 2.066, Global test accuracy: 22.22
Round  70, Train loss: 0.200, Test loss: 2.448, Test accuracy: 52.63
Round  70, Global train loss: 0.200, Global test loss: 2.139, Global test accuracy: 20.80
Round  71, Train loss: 0.224, Test loss: 2.424, Test accuracy: 52.99
Round  71, Global train loss: 0.224, Global test loss: 2.024, Global test accuracy: 32.61
Round  72, Train loss: 0.166, Test loss: 2.484, Test accuracy: 53.02
Round  72, Global train loss: 0.166, Global test loss: 1.882, Global test accuracy: 37.72
Round  73, Train loss: 0.198, Test loss: 2.550, Test accuracy: 52.92
Round  73, Global train loss: 0.198, Global test loss: 1.947, Global test accuracy: 33.67
Round  74, Train loss: 0.201, Test loss: 2.573, Test accuracy: 52.98
Round  74, Global train loss: 0.201, Global test loss: 1.945, Global test accuracy: 38.07
Round  75, Train loss: 0.166, Test loss: 2.583, Test accuracy: 53.09
Round  75, Global train loss: 0.166, Global test loss: 1.979, Global test accuracy: 30.98
Round  76, Train loss: 0.197, Test loss: 2.596, Test accuracy: 53.81
Round  76, Global train loss: 0.197, Global test loss: 2.007, Global test accuracy: 30.93
Round  77, Train loss: 0.253, Test loss: 2.683, Test accuracy: 53.74
Round  77, Global train loss: 0.253, Global test loss: 1.869, Global test accuracy: 38.16
Round  78, Train loss: 0.230, Test loss: 2.602, Test accuracy: 54.21
Round  78, Global train loss: 0.230, Global test loss: 1.993, Global test accuracy: 32.14
Round  79, Train loss: 0.196, Test loss: 2.672, Test accuracy: 53.62
Round  79, Global train loss: 0.196, Global test loss: 1.992, Global test accuracy: 33.45
Round  80, Train loss: 0.207, Test loss: 2.706, Test accuracy: 53.77
Round  80, Global train loss: 0.207, Global test loss: 2.048, Global test accuracy: 32.71
Round  81, Train loss: 0.160, Test loss: 2.711, Test accuracy: 53.82
Round  81, Global train loss: 0.160, Global test loss: 1.984, Global test accuracy: 33.92
Round  82, Train loss: 0.190, Test loss: 2.707, Test accuracy: 53.92
Round  82, Global train loss: 0.190, Global test loss: 2.062, Global test accuracy: 25.10
Round  83, Train loss: 0.122, Test loss: 2.731, Test accuracy: 53.91
Round  83, Global train loss: 0.122, Global test loss: 1.928, Global test accuracy: 36.44
Round  84, Train loss: 0.112, Test loss: 2.804, Test accuracy: 53.70
Round  84, Global train loss: 0.112, Global test loss: 2.193, Global test accuracy: 15.42
Round  85, Train loss: 0.145, Test loss: 2.825, Test accuracy: 53.75
Round  85, Global train loss: 0.145, Global test loss: 2.080, Global test accuracy: 32.67
Round  86, Train loss: 0.160, Test loss: 2.884, Test accuracy: 53.56
Round  86, Global train loss: 0.160, Global test loss: 1.832, Global test accuracy: 39.15
Round  87, Train loss: 0.139, Test loss: 3.034, Test accuracy: 53.69
Round  87, Global train loss: 0.139, Global test loss: 2.017, Global test accuracy: 32.85
Round  88, Train loss: 0.147, Test loss: 3.009, Test accuracy: 53.85
Round  88, Global train loss: 0.147, Global test loss: 2.204, Global test accuracy: 27.00
Round  89, Train loss: 0.140, Test loss: 2.921, Test accuracy: 54.48
Round  89, Global train loss: 0.140, Global test loss: 2.122, Global test accuracy: 23.22
Round  90, Train loss: 0.129, Test loss: 2.886, Test accuracy: 54.33
Round  90, Global train loss: 0.129, Global test loss: 2.337, Global test accuracy: 19.18
Round  91, Train loss: 0.138, Test loss: 2.987, Test accuracy: 53.90
Round  91, Global train loss: 0.138, Global test loss: 1.877, Global test accuracy: 33.35
Round  92, Train loss: 0.120, Test loss: 3.031, Test accuracy: 53.76
Round  92, Global train loss: 0.120, Global test loss: 1.935, Global test accuracy: 34.56
Round  93, Train loss: 0.116, Test loss: 2.975, Test accuracy: 53.94
Round  93, Global train loss: 0.116, Global test loss: 1.953, Global test accuracy: 38.37
Round  94, Train loss: 0.136, Test loss: 3.026, Test accuracy: 54.04
Round  94, Global train loss: 0.136, Global test loss: 2.006, Global test accuracy: 33.91
Round  95, Train loss: 0.118, Test loss: 2.994, Test accuracy: 54.10
Round  95, Global train loss: 0.118, Global test loss: 1.889, Global test accuracy: 40.12
Round  96, Train loss: 0.142, Test loss: 2.972, Test accuracy: 54.07
Round  96, Global train loss: 0.142, Global test loss: 1.901, Global test accuracy: 35.27
Round  97, Train loss: 0.096, Test loss: 3.046, Test accuracy: 54.47
Round  97, Global train loss: 0.096, Global test loss: 2.077, Global test accuracy: 27.29
Round  98, Train loss: 0.116, Test loss: 3.205, Test accuracy: 54.30
Round  98, Global train loss: 0.116, Global test loss: 2.086, Global test accuracy: 26.59
Round  99, Train loss: 0.124, Test loss: 3.193, Test accuracy: 53.97
Round  99, Global train loss: 0.124, Global test loss: 1.992, Global test accuracy: 31.63
Final Round, Train loss: 0.109, Test loss: 3.247, Test accuracy: 53.42
Final Round, Global train loss: 0.109, Global test loss: 1.992, Global test accuracy: 31.63
Average accuracy final 10 rounds: 54.087999999999994 

Average global accuracy final 10 rounds: 32.026999999999994 

1800.7587308883667
[1.7079849243164062, 3.4159698486328125, 4.7399163246154785, 6.0638628005981445, 7.414947509765625, 8.766032218933105, 10.118213653564453, 11.4703950881958, 12.804692029953003, 14.138988971710205, 15.488207578659058, 16.83742618560791, 18.172325372695923, 19.507224559783936, 20.908698320388794, 22.310172080993652, 23.696335077285767, 25.08249807357788, 26.46729278564453, 27.85208749771118, 29.218491315841675, 30.584895133972168, 31.970738887786865, 33.35658264160156, 34.76393437385559, 36.17128610610962, 37.52960658073425, 38.88792705535889, 40.2180380821228, 41.54814910888672, 42.910853147506714, 44.27355718612671, 45.618478775024414, 46.96340036392212, 48.32452344894409, 49.685646533966064, 51.08210301399231, 52.478559494018555, 53.79532766342163, 55.11209583282471, 56.44494891166687, 57.77780199050903, 59.126962661743164, 60.476123332977295, 61.823705196380615, 63.171287059783936, 64.5542221069336, 65.93715715408325, 67.28185153007507, 68.6265459060669, 69.96477341651917, 71.30300092697144, 72.63415384292603, 73.96530675888062, 75.4489278793335, 76.93254899978638, 78.43670773506165, 79.94086647033691, 81.35056138038635, 82.76025629043579, 84.18912434577942, 85.61799240112305, 87.12917304039001, 88.64035367965698, 90.03186535835266, 91.42337703704834, 92.78904366493225, 94.15471029281616, 95.59881043434143, 97.0429105758667, 98.38581156730652, 99.72871255874634, 101.09220838546753, 102.45570421218872, 103.96059250831604, 105.46548080444336, 106.86230564117432, 108.25913047790527, 109.74196720123291, 111.22480392456055, 112.59378552436829, 113.96276712417603, 115.3071608543396, 116.65155458450317, 118.13284397125244, 119.61413335800171, 121.03038430213928, 122.44663524627686, 123.82035040855408, 125.1940655708313, 126.53260970115662, 127.87115383148193, 129.25345373153687, 130.6357536315918, 131.9923391342163, 133.34892463684082, 134.72911024093628, 136.10929584503174, 137.46993970870972, 138.8305835723877, 140.21173238754272, 141.59288120269775, 142.9805257320404, 144.36817026138306, 145.72742986679077, 147.0866894721985, 148.54163265228271, 149.99657583236694, 151.37848901748657, 152.7604022026062, 154.13680911064148, 155.51321601867676, 156.90453910827637, 158.29586219787598, 159.6293969154358, 160.9629316329956, 162.31824135780334, 163.67355108261108, 165.06712174415588, 166.46069240570068, 167.80059361457825, 169.1404948234558, 170.5052626132965, 171.8700304031372, 173.23091554641724, 174.59180068969727, 175.9985089302063, 177.40521717071533, 178.7998607158661, 180.19450426101685, 181.63011932373047, 183.0657343864441, 184.43681859970093, 185.80790281295776, 187.2309386730194, 188.65397453308105, 190.0527102947235, 191.45144605636597, 192.81710124015808, 194.1827564239502, 195.5490963459015, 196.91543626785278, 198.31308269500732, 199.71072912216187, 201.19990301132202, 202.68907690048218, 204.0766942501068, 205.46431159973145, 206.80718350410461, 208.15005540847778, 209.49434185028076, 210.83862829208374, 212.2276737689972, 213.61671924591064, 215.0037133693695, 216.39070749282837, 217.75086641311646, 219.11102533340454, 220.50903797149658, 221.90705060958862, 223.2723879814148, 224.63772535324097, 226.0161349773407, 227.39454460144043, 228.74601984024048, 230.09749507904053, 231.49419617652893, 232.89089727401733, 234.25509881973267, 235.619300365448, 236.97000360488892, 238.32070684432983, 239.67291712760925, 241.02512741088867, 242.3714416027069, 243.71775579452515, 245.06517720222473, 246.41259860992432, 247.96847438812256, 249.5243501663208, 250.87252473831177, 252.22069931030273, 253.61011481285095, 254.99953031539917, 256.3531906604767, 257.7068510055542, 259.09589076042175, 260.4849305152893, 261.8640697002411, 263.24320888519287, 264.6131901741028, 265.9831714630127, 267.3648419380188, 268.7465124130249, 270.10716104507446, 271.467809677124, 272.8716506958008, 274.27549171447754, 275.6907320022583, 277.10597229003906, 279.9452657699585, 282.78455924987793]
[20.17, 20.17, 32.33, 32.33, 35.84, 35.84, 42.08, 42.08, 42.08, 42.08, 42.16, 42.16, 43.3, 43.3, 44.06, 44.06, 44.66, 44.66, 44.99, 44.99, 44.93, 44.93, 46.1, 46.1, 45.43, 45.43, 45.41, 45.41, 46.36, 46.36, 47.17, 47.17, 47.54, 47.54, 48.39, 48.39, 47.96, 47.96, 47.78, 47.78, 47.95, 47.95, 48.8, 48.8, 48.5, 48.5, 49.29, 49.29, 49.14, 49.14, 48.77, 48.77, 49.14, 49.14, 49.75, 49.75, 49.83, 49.83, 51.0, 51.0, 51.12, 51.12, 50.65, 50.65, 51.01, 51.01, 50.67, 50.67, 50.48, 50.48, 51.22, 51.22, 50.97, 50.97, 51.51, 51.51, 51.11, 51.11, 51.82, 51.82, 52.2, 52.2, 52.07, 52.07, 51.67, 51.67, 52.26, 52.26, 52.51, 52.51, 52.72, 52.72, 53.29, 53.29, 53.06, 53.06, 52.98, 52.98, 53.15, 53.15, 52.98, 52.98, 53.29, 53.29, 53.01, 53.01, 53.09, 53.09, 53.13, 53.13, 53.72, 53.72, 52.84, 52.84, 52.43, 52.43, 52.82, 52.82, 53.68, 53.68, 53.33, 53.33, 53.48, 53.48, 53.59, 53.59, 53.38, 53.38, 53.07, 53.07, 52.96, 52.96, 53.3, 53.3, 52.2, 52.2, 53.13, 53.13, 52.77, 52.77, 52.63, 52.63, 52.99, 52.99, 53.02, 53.02, 52.92, 52.92, 52.98, 52.98, 53.09, 53.09, 53.81, 53.81, 53.74, 53.74, 54.21, 54.21, 53.62, 53.62, 53.77, 53.77, 53.82, 53.82, 53.92, 53.92, 53.91, 53.91, 53.7, 53.7, 53.75, 53.75, 53.56, 53.56, 53.69, 53.69, 53.85, 53.85, 54.48, 54.48, 54.33, 54.33, 53.9, 53.9, 53.76, 53.76, 53.94, 53.94, 54.04, 54.04, 54.1, 54.1, 54.07, 54.07, 54.47, 54.47, 54.3, 54.3, 53.97, 53.97, 53.42, 53.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.686, Test loss: 2.084, Test accuracy: 20.47
Round   0, Global train loss: 1.686, Global test loss: 2.227, Global test accuracy: 17.98
Round   1, Train loss: 1.458, Test loss: 1.941, Test accuracy: 29.48
Round   1, Global train loss: 1.458, Global test loss: 2.228, Global test accuracy: 22.84
Round   2, Train loss: 1.353, Test loss: 1.681, Test accuracy: 36.76
Round   2, Global train loss: 1.353, Global test loss: 1.932, Global test accuracy: 31.48
Round   3, Train loss: 1.204, Test loss: 1.480, Test accuracy: 41.54
Round   3, Global train loss: 1.204, Global test loss: 1.830, Global test accuracy: 32.09
Round   4, Train loss: 1.372, Test loss: 1.491, Test accuracy: 42.57
Round   4, Global train loss: 1.372, Global test loss: 1.800, Global test accuracy: 35.50
Round   5, Train loss: 1.207, Test loss: 1.379, Test accuracy: 45.44
Round   5, Global train loss: 1.207, Global test loss: 1.776, Global test accuracy: 37.62
Round   6, Train loss: 1.106, Test loss: 1.335, Test accuracy: 47.69
Round   6, Global train loss: 1.106, Global test loss: 1.644, Global test accuracy: 41.42
Round   7, Train loss: 1.257, Test loss: 1.290, Test accuracy: 49.07
Round   7, Global train loss: 1.257, Global test loss: 1.711, Global test accuracy: 39.79
Round   8, Train loss: 1.126, Test loss: 1.247, Test accuracy: 50.86
Round   8, Global train loss: 1.126, Global test loss: 1.576, Global test accuracy: 42.19
Round   9, Train loss: 1.214, Test loss: 1.280, Test accuracy: 50.02
Round   9, Global train loss: 1.214, Global test loss: 1.679, Global test accuracy: 40.56
Round  10, Train loss: 1.071, Test loss: 1.272, Test accuracy: 50.29
Round  10, Global train loss: 1.071, Global test loss: 1.601, Global test accuracy: 43.81
Round  11, Train loss: 1.203, Test loss: 1.242, Test accuracy: 50.56
Round  11, Global train loss: 1.203, Global test loss: 1.524, Global test accuracy: 48.93
Round  12, Train loss: 1.058, Test loss: 1.267, Test accuracy: 50.51
Round  12, Global train loss: 1.058, Global test loss: 1.628, Global test accuracy: 46.34
Round  13, Train loss: 0.970, Test loss: 1.245, Test accuracy: 51.09
Round  13, Global train loss: 0.970, Global test loss: 1.486, Global test accuracy: 50.49
Round  14, Train loss: 1.062, Test loss: 1.245, Test accuracy: 51.35
Round  14, Global train loss: 1.062, Global test loss: 1.537, Global test accuracy: 45.18
Round  15, Train loss: 0.935, Test loss: 1.277, Test accuracy: 51.67
Round  15, Global train loss: 0.935, Global test loss: 1.521, Global test accuracy: 49.25
Round  16, Train loss: 0.944, Test loss: 1.246, Test accuracy: 52.33
Round  16, Global train loss: 0.944, Global test loss: 1.480, Global test accuracy: 46.29
Round  17, Train loss: 0.853, Test loss: 1.261, Test accuracy: 52.25
Round  17, Global train loss: 0.853, Global test loss: 1.407, Global test accuracy: 50.24
Round  18, Train loss: 0.994, Test loss: 1.205, Test accuracy: 53.36
Round  18, Global train loss: 0.994, Global test loss: 1.371, Global test accuracy: 51.94
Round  19, Train loss: 0.893, Test loss: 1.210, Test accuracy: 53.42
Round  19, Global train loss: 0.893, Global test loss: 1.406, Global test accuracy: 52.81
Round  20, Train loss: 1.029, Test loss: 1.236, Test accuracy: 53.30
Round  20, Global train loss: 1.029, Global test loss: 1.463, Global test accuracy: 50.55
Round  21, Train loss: 0.841, Test loss: 1.197, Test accuracy: 54.29
Round  21, Global train loss: 0.841, Global test loss: 1.554, Global test accuracy: 49.50
Round  22, Train loss: 0.969, Test loss: 1.196, Test accuracy: 54.83
Round  22, Global train loss: 0.969, Global test loss: 1.414, Global test accuracy: 51.93
Round  23, Train loss: 0.990, Test loss: 1.234, Test accuracy: 54.60
Round  23, Global train loss: 0.990, Global test loss: 1.350, Global test accuracy: 55.76
Round  24, Train loss: 0.891, Test loss: 1.205, Test accuracy: 55.32
Round  24, Global train loss: 0.891, Global test loss: 1.342, Global test accuracy: 55.40
Round  25, Train loss: 0.840, Test loss: 1.178, Test accuracy: 56.02
Round  25, Global train loss: 0.840, Global test loss: 1.369, Global test accuracy: 52.30
Round  26, Train loss: 0.865, Test loss: 1.160, Test accuracy: 56.38
Round  26, Global train loss: 0.865, Global test loss: 1.438, Global test accuracy: 50.62
Round  27, Train loss: 0.743, Test loss: 1.131, Test accuracy: 57.25
Round  27, Global train loss: 0.743, Global test loss: 1.348, Global test accuracy: 54.44
Round  28, Train loss: 0.854, Test loss: 1.125, Test accuracy: 57.13
Round  28, Global train loss: 0.854, Global test loss: 1.312, Global test accuracy: 54.03
Round  29, Train loss: 0.777, Test loss: 1.147, Test accuracy: 56.91
Round  29, Global train loss: 0.777, Global test loss: 1.417, Global test accuracy: 53.09
Round  30, Train loss: 0.766, Test loss: 1.145, Test accuracy: 57.14
Round  30, Global train loss: 0.766, Global test loss: 1.653, Global test accuracy: 47.84
Round  31, Train loss: 0.842, Test loss: 1.159, Test accuracy: 56.88
Round  31, Global train loss: 0.842, Global test loss: 1.426, Global test accuracy: 53.41
Round  32, Train loss: 0.674, Test loss: 1.147, Test accuracy: 57.74
Round  32, Global train loss: 0.674, Global test loss: 1.289, Global test accuracy: 57.88
Round  33, Train loss: 0.676, Test loss: 1.162, Test accuracy: 57.38
Round  33, Global train loss: 0.676, Global test loss: 1.195, Global test accuracy: 58.87
Round  34, Train loss: 0.699, Test loss: 1.164, Test accuracy: 56.97
Round  34, Global train loss: 0.699, Global test loss: 1.269, Global test accuracy: 55.99
Round  35, Train loss: 0.691, Test loss: 1.145, Test accuracy: 57.49
Round  35, Global train loss: 0.691, Global test loss: 1.148, Global test accuracy: 60.92
Round  36, Train loss: 0.595, Test loss: 1.135, Test accuracy: 58.10
Round  36, Global train loss: 0.595, Global test loss: 1.316, Global test accuracy: 56.75
Round  37, Train loss: 0.661, Test loss: 1.147, Test accuracy: 58.08
Round  37, Global train loss: 0.661, Global test loss: 1.331, Global test accuracy: 55.70
Round  38, Train loss: 0.668, Test loss: 1.156, Test accuracy: 58.37
Round  38, Global train loss: 0.668, Global test loss: 1.193, Global test accuracy: 59.70
Round  39, Train loss: 0.670, Test loss: 1.175, Test accuracy: 57.95
Round  39, Global train loss: 0.670, Global test loss: 1.190, Global test accuracy: 60.99
Round  40, Train loss: 0.788, Test loss: 1.173, Test accuracy: 58.24
Round  40, Global train loss: 0.788, Global test loss: 1.210, Global test accuracy: 58.67
Round  41, Train loss: 0.663, Test loss: 1.186, Test accuracy: 58.45
Round  41, Global train loss: 0.663, Global test loss: 1.326, Global test accuracy: 57.17
Round  42, Train loss: 0.749, Test loss: 1.207, Test accuracy: 58.61
Round  42, Global train loss: 0.749, Global test loss: 1.348, Global test accuracy: 56.29
Round  43, Train loss: 0.622, Test loss: 1.237, Test accuracy: 58.61
Round  43, Global train loss: 0.622, Global test loss: 1.383, Global test accuracy: 54.78
Round  44, Train loss: 0.689, Test loss: 1.259, Test accuracy: 58.56
Round  44, Global train loss: 0.689, Global test loss: 1.358, Global test accuracy: 55.69
Round  45, Train loss: 0.640, Test loss: 1.254, Test accuracy: 59.17
Round  45, Global train loss: 0.640, Global test loss: 1.441, Global test accuracy: 55.18
Round  46, Train loss: 0.667, Test loss: 1.261, Test accuracy: 59.36
Round  46, Global train loss: 0.667, Global test loss: 1.185, Global test accuracy: 60.36
Round  47, Train loss: 0.602, Test loss: 1.260, Test accuracy: 59.87
Round  47, Global train loss: 0.602, Global test loss: 1.236, Global test accuracy: 59.18
Round  48, Train loss: 0.505, Test loss: 1.239, Test accuracy: 60.00
Round  48, Global train loss: 0.505, Global test loss: 1.283, Global test accuracy: 59.25
Round  49, Train loss: 0.566, Test loss: 1.229, Test accuracy: 59.95
Round  49, Global train loss: 0.566, Global test loss: 1.265, Global test accuracy: 58.71
Round  50, Train loss: 0.494, Test loss: 1.242, Test accuracy: 59.83
Round  50, Global train loss: 0.494, Global test loss: 1.406, Global test accuracy: 56.41
Round  51, Train loss: 0.582, Test loss: 1.250, Test accuracy: 59.96
Round  51, Global train loss: 0.582, Global test loss: 1.239, Global test accuracy: 60.57
Round  52, Train loss: 0.557, Test loss: 1.255, Test accuracy: 59.72
Round  52, Global train loss: 0.557, Global test loss: 1.283, Global test accuracy: 58.85
Round  53, Train loss: 0.517, Test loss: 1.233, Test accuracy: 60.12
Round  53, Global train loss: 0.517, Global test loss: 1.266, Global test accuracy: 60.08
Round  54, Train loss: 0.612, Test loss: 1.205, Test accuracy: 60.52
Round  54, Global train loss: 0.612, Global test loss: 1.237, Global test accuracy: 58.90
Round  55, Train loss: 0.500, Test loss: 1.229, Test accuracy: 60.29
Round  55, Global train loss: 0.500, Global test loss: 1.305, Global test accuracy: 58.50
Round  56, Train loss: 0.559, Test loss: 1.242, Test accuracy: 60.57
Round  56, Global train loss: 0.559, Global test loss: 1.256, Global test accuracy: 59.31
Round  57, Train loss: 0.541, Test loss: 1.253, Test accuracy: 60.53
Round  57, Global train loss: 0.541, Global test loss: 1.159, Global test accuracy: 62.10
Round  58, Train loss: 0.572, Test loss: 1.218, Test accuracy: 60.65
Round  58, Global train loss: 0.572, Global test loss: 1.375, Global test accuracy: 57.13
Round  59, Train loss: 0.497, Test loss: 1.247, Test accuracy: 60.36
Round  59, Global train loss: 0.497, Global test loss: 1.437, Global test accuracy: 56.11
Round  60, Train loss: 0.416, Test loss: 1.259, Test accuracy: 60.26
Round  60, Global train loss: 0.416, Global test loss: 1.212, Global test accuracy: 62.65
Round  61, Train loss: 0.549, Test loss: 1.344, Test accuracy: 59.76
Round  61, Global train loss: 0.549, Global test loss: 1.207, Global test accuracy: 61.28
Round  62, Train loss: 0.519, Test loss: 1.330, Test accuracy: 60.31
Round  62, Global train loss: 0.519, Global test loss: 1.301, Global test accuracy: 59.76
Round  63, Train loss: 0.621, Test loss: 1.316, Test accuracy: 60.63
Round  63, Global train loss: 0.621, Global test loss: 1.268, Global test accuracy: 60.16
Round  64, Train loss: 0.570, Test loss: 1.332, Test accuracy: 60.51
Round  64, Global train loss: 0.570, Global test loss: 1.236, Global test accuracy: 60.77
Round  65, Train loss: 0.506, Test loss: 1.316, Test accuracy: 60.57
Round  65, Global train loss: 0.506, Global test loss: 1.382, Global test accuracy: 57.66
Round  66, Train loss: 0.523, Test loss: 1.370, Test accuracy: 60.38
Round  66, Global train loss: 0.523, Global test loss: 1.318, Global test accuracy: 57.89
Round  67, Train loss: 0.491, Test loss: 1.352, Test accuracy: 60.60
Round  67, Global train loss: 0.491, Global test loss: 1.456, Global test accuracy: 57.90
Round  68, Train loss: 0.411, Test loss: 1.350, Test accuracy: 60.86
Round  68, Global train loss: 0.411, Global test loss: 1.448, Global test accuracy: 57.78
Round  69, Train loss: 0.570, Test loss: 1.359, Test accuracy: 60.80
Round  69, Global train loss: 0.570, Global test loss: 1.235, Global test accuracy: 60.20
Round  70, Train loss: 0.495, Test loss: 1.368, Test accuracy: 60.88
Round  70, Global train loss: 0.495, Global test loss: 1.322, Global test accuracy: 58.33
Round  71, Train loss: 0.482, Test loss: 1.359, Test accuracy: 61.08
Round  71, Global train loss: 0.482, Global test loss: 1.461, Global test accuracy: 57.20
Round  72, Train loss: 0.496, Test loss: 1.324, Test accuracy: 61.50
Round  72, Global train loss: 0.496, Global test loss: 1.313, Global test accuracy: 59.02
Round  73, Train loss: 0.441, Test loss: 1.358, Test accuracy: 60.94
Round  73, Global train loss: 0.441, Global test loss: 1.238, Global test accuracy: 60.86
Round  74, Train loss: 0.373, Test loss: 1.402, Test accuracy: 60.25
Round  74, Global train loss: 0.373, Global test loss: 1.428, Global test accuracy: 57.67
Round  75, Train loss: 0.365, Test loss: 1.388, Test accuracy: 60.78
Round  75, Global train loss: 0.365, Global test loss: 1.316, Global test accuracy: 61.03
Round  76, Train loss: 0.380, Test loss: 1.382, Test accuracy: 60.83
Round  76, Global train loss: 0.380, Global test loss: 1.279, Global test accuracy: 61.55
Round  77, Train loss: 0.377, Test loss: 1.386, Test accuracy: 61.00
Round  77, Global train loss: 0.377, Global test loss: 1.252, Global test accuracy: 62.86
Round  78, Train loss: 0.456, Test loss: 1.374, Test accuracy: 61.39
Round  78, Global train loss: 0.456, Global test loss: 1.256, Global test accuracy: 62.13
Round  79, Train loss: 0.421, Test loss: 1.364, Test accuracy: 61.63
Round  79, Global train loss: 0.421, Global test loss: 1.281, Global test accuracy: 61.38
Round  80, Train loss: 0.356, Test loss: 1.388, Test accuracy: 61.54
Round  80, Global train loss: 0.356, Global test loss: 1.392, Global test accuracy: 59.36
Round  81, Train loss: 0.412, Test loss: 1.381, Test accuracy: 61.78
Round  81, Global train loss: 0.412, Global test loss: 1.334, Global test accuracy: 59.12
Round  82, Train loss: 0.487, Test loss: 1.397, Test accuracy: 61.06
Round  82, Global train loss: 0.487, Global test loss: 1.371, Global test accuracy: 58.74
Round  83, Train loss: 0.532, Test loss: 1.435, Test accuracy: 60.22
Round  83, Global train loss: 0.532, Global test loss: 1.388, Global test accuracy: 57.37
Round  84, Train loss: 0.462, Test loss: 1.413, Test accuracy: 60.58
Round  84, Global train loss: 0.462, Global test loss: 1.361, Global test accuracy: 57.98
Round  85, Train loss: 0.380, Test loss: 1.393, Test accuracy: 61.10
Round  85, Global train loss: 0.380, Global test loss: 1.466, Global test accuracy: 57.27
Round  86, Train loss: 0.412, Test loss: 1.405, Test accuracy: 61.19
Round  86, Global train loss: 0.412, Global test loss: 1.293, Global test accuracy: 61.13
Round  87, Train loss: 0.355, Test loss: 1.432, Test accuracy: 60.88
Round  87, Global train loss: 0.355, Global test loss: 1.456, Global test accuracy: 58.26
Round  88, Train loss: 0.311, Test loss: 1.402, Test accuracy: 61.20
Round  88, Global train loss: 0.311, Global test loss: 1.487, Global test accuracy: 59.72
Round  89, Train loss: 0.542, Test loss: 1.436, Test accuracy: 61.09
Round  89, Global train loss: 0.542, Global test loss: 1.395, Global test accuracy: 57.25
Round  90, Train loss: 0.282, Test loss: 1.422, Test accuracy: 61.56
Round  90, Global train loss: 0.282, Global test loss: 1.547, Global test accuracy: 58.15
Round  91, Train loss: 0.444, Test loss: 1.422, Test accuracy: 61.58
Round  91, Global train loss: 0.444, Global test loss: 1.265, Global test accuracy: 62.38
Round  92, Train loss: 0.470, Test loss: 1.436, Test accuracy: 61.48
Round  92, Global train loss: 0.470, Global test loss: 1.462, Global test accuracy: 57.59
Round  93, Train loss: 0.371, Test loss: 1.429, Test accuracy: 61.52
Round  93, Global train loss: 0.371, Global test loss: 1.451, Global test accuracy: 59.64
Round  94, Train loss: 0.560, Test loss: 1.438, Test accuracy: 61.65
Round  94, Global train loss: 0.560, Global test loss: 1.372, Global test accuracy: 59.19
Round  95, Train loss: 0.383, Test loss: 1.413, Test accuracy: 62.06
Round  95, Global train loss: 0.383, Global test loss: 1.269, Global test accuracy: 61.47
Round  96, Train loss: 0.392, Test loss: 1.443, Test accuracy: 61.50
Round  96, Global train loss: 0.392, Global test loss: 1.239, Global test accuracy: 63.25
Round  97, Train loss: 0.422, Test loss: 1.491, Test accuracy: 61.23
Round  97, Global train loss: 0.422, Global test loss: 1.313, Global test accuracy: 60.30
Round  98, Train loss: 0.409, Test loss: 1.506, Test accuracy: 61.25
Round  98, Global train loss: 0.409, Global test loss: 1.525, Global test accuracy: 57.58
Round  99, Train loss: 0.340, Test loss: 1.494, Test accuracy: 61.35
Round  99, Global train loss: 0.340, Global test loss: 1.568, Global test accuracy: 57.55
Final Round, Train loss: 0.305, Test loss: 1.699, Test accuracy: 61.64
Final Round, Global train loss: 0.305, Global test loss: 1.568, Global test accuracy: 57.55
Average accuracy final 10 rounds: 61.517999999999994 

Average global accuracy final 10 rounds: 59.710000000000015 

1769.115916967392
[1.6864635944366455, 3.372927188873291, 4.770805597305298, 6.168684005737305, 7.501973867416382, 8.835263729095459, 10.21056056022644, 11.585857391357422, 12.92784309387207, 14.269828796386719, 15.634976387023926, 17.000123977661133, 18.407118320465088, 19.814112663269043, 21.183319568634033, 22.552526473999023, 23.931042194366455, 25.309557914733887, 26.709765195846558, 28.10997247695923, 29.50855588912964, 30.90713930130005, 32.232670307159424, 33.5582013130188, 34.93222141265869, 36.306241512298584, 37.76597547531128, 39.225709438323975, 40.59543585777283, 41.96516227722168, 43.30482864379883, 44.64449501037598, 46.002060890197754, 47.35962677001953, 48.69472646713257, 50.029826164245605, 51.394747734069824, 52.75966930389404, 54.09020757675171, 55.420745849609375, 56.76506519317627, 58.109384536743164, 59.53699088096619, 60.96459722518921, 62.32965421676636, 63.694711208343506, 65.06816363334656, 66.44161605834961, 67.74530410766602, 69.04899215698242, 70.4090929031372, 71.76919364929199, 73.16259407997131, 74.55599451065063, 75.87708759307861, 77.19818067550659, 78.55161690711975, 79.90505313873291, 81.2581057548523, 82.61115837097168, 83.95739769935608, 85.30363702774048, 86.65518498420715, 88.00673294067383, 89.33741021156311, 90.66808748245239, 91.99920558929443, 93.33032369613647, 94.68776202201843, 96.04520034790039, 97.3896644115448, 98.73412847518921, 100.07937479019165, 101.42462110519409, 102.7709972858429, 104.1173734664917, 105.46904397010803, 106.82071447372437, 108.17219400405884, 109.52367353439331, 110.85788297653198, 112.19209241867065, 113.51067352294922, 114.82925462722778, 116.18989777565002, 117.55054092407227, 118.91105890274048, 120.27157688140869, 121.61117720603943, 122.95077753067017, 124.27711772918701, 125.60345792770386, 126.92130827903748, 128.2391586303711, 129.61139678955078, 130.98363494873047, 132.36118960380554, 133.73874425888062, 135.0842089653015, 136.4296736717224, 137.77799725532532, 139.12632083892822, 140.47937989234924, 141.83243894577026, 143.16643047332764, 144.500422000885, 145.84901428222656, 147.19760656356812, 148.5538513660431, 149.91009616851807, 151.21184992790222, 152.51360368728638, 153.8517370223999, 155.18987035751343, 156.51311874389648, 157.83636713027954, 159.24038100242615, 160.64439487457275, 161.99080181121826, 163.33720874786377, 164.7214653491974, 166.105721950531, 167.44847965240479, 168.79123735427856, 170.17838096618652, 171.56552457809448, 172.93269062042236, 174.29985666275024, 175.63798117637634, 176.97610569000244, 178.2803544998169, 179.58460330963135, 180.89746832847595, 182.21033334732056, 183.57055377960205, 184.93077421188354, 186.26880550384521, 187.60683679580688, 188.99605441093445, 190.385272026062, 191.73541474342346, 193.0855574607849, 194.4181969165802, 195.7508363723755, 197.13322925567627, 198.51562213897705, 199.9066457748413, 201.29766941070557, 202.63157892227173, 203.9654884338379, 205.30897998809814, 206.6524715423584, 207.97732210159302, 209.30217266082764, 210.62386965751648, 211.94556665420532, 213.27989387512207, 214.61422109603882, 215.97759127616882, 217.34096145629883, 218.7268738746643, 220.11278629302979, 221.45224452018738, 222.79170274734497, 224.12104558944702, 225.45038843154907, 226.84000611305237, 228.22962379455566, 229.55637001991272, 230.88311624526978, 232.3049008846283, 233.72668552398682, 235.05335760116577, 236.38002967834473, 237.72903561592102, 239.07804155349731, 240.4236557483673, 241.7692699432373, 243.12217545509338, 244.47508096694946, 245.81480145454407, 247.15452194213867, 248.51445841789246, 249.87439489364624, 251.20150184631348, 252.5286087989807, 253.85445880889893, 255.18030881881714, 256.5439786911011, 257.907648563385, 259.24043011665344, 260.5732116699219, 261.9448137283325, 263.31641578674316, 264.61898040771484, 265.9215450286865, 267.26404881477356, 268.6065526008606, 269.95047903060913, 271.29440546035767, 273.9847273826599, 276.67504930496216]
[20.47, 20.47, 29.48, 29.48, 36.76, 36.76, 41.54, 41.54, 42.57, 42.57, 45.44, 45.44, 47.69, 47.69, 49.07, 49.07, 50.86, 50.86, 50.02, 50.02, 50.29, 50.29, 50.56, 50.56, 50.51, 50.51, 51.09, 51.09, 51.35, 51.35, 51.67, 51.67, 52.33, 52.33, 52.25, 52.25, 53.36, 53.36, 53.42, 53.42, 53.3, 53.3, 54.29, 54.29, 54.83, 54.83, 54.6, 54.6, 55.32, 55.32, 56.02, 56.02, 56.38, 56.38, 57.25, 57.25, 57.13, 57.13, 56.91, 56.91, 57.14, 57.14, 56.88, 56.88, 57.74, 57.74, 57.38, 57.38, 56.97, 56.97, 57.49, 57.49, 58.1, 58.1, 58.08, 58.08, 58.37, 58.37, 57.95, 57.95, 58.24, 58.24, 58.45, 58.45, 58.61, 58.61, 58.61, 58.61, 58.56, 58.56, 59.17, 59.17, 59.36, 59.36, 59.87, 59.87, 60.0, 60.0, 59.95, 59.95, 59.83, 59.83, 59.96, 59.96, 59.72, 59.72, 60.12, 60.12, 60.52, 60.52, 60.29, 60.29, 60.57, 60.57, 60.53, 60.53, 60.65, 60.65, 60.36, 60.36, 60.26, 60.26, 59.76, 59.76, 60.31, 60.31, 60.63, 60.63, 60.51, 60.51, 60.57, 60.57, 60.38, 60.38, 60.6, 60.6, 60.86, 60.86, 60.8, 60.8, 60.88, 60.88, 61.08, 61.08, 61.5, 61.5, 60.94, 60.94, 60.25, 60.25, 60.78, 60.78, 60.83, 60.83, 61.0, 61.0, 61.39, 61.39, 61.63, 61.63, 61.54, 61.54, 61.78, 61.78, 61.06, 61.06, 60.22, 60.22, 60.58, 60.58, 61.1, 61.1, 61.19, 61.19, 60.88, 60.88, 61.2, 61.2, 61.09, 61.09, 61.56, 61.56, 61.58, 61.58, 61.48, 61.48, 61.52, 61.52, 61.65, 61.65, 62.06, 62.06, 61.5, 61.5, 61.23, 61.23, 61.25, 61.25, 61.35, 61.35, 61.64, 61.64]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.716, Test loss: 2.069, Test accuracy: 21.26
Round   0, Global train loss: 1.716, Global test loss: 2.250, Global test accuracy: 16.09
Round   1, Train loss: 1.459, Test loss: 1.827, Test accuracy: 32.64
Round   1, Global train loss: 1.459, Global test loss: 2.199, Global test accuracy: 23.83
Round   2, Train loss: 1.404, Test loss: 1.544, Test accuracy: 42.41
Round   2, Global train loss: 1.404, Global test loss: 1.927, Global test accuracy: 34.37
Round   3, Train loss: 1.244, Test loss: 1.369, Test accuracy: 45.70
Round   3, Global train loss: 1.244, Global test loss: 1.796, Global test accuracy: 33.98
Round   4, Train loss: 1.362, Test loss: 1.341, Test accuracy: 46.62
Round   4, Global train loss: 1.362, Global test loss: 1.859, Global test accuracy: 27.11
Round   5, Train loss: 1.281, Test loss: 1.307, Test accuracy: 48.07
Round   5, Global train loss: 1.281, Global test loss: 1.791, Global test accuracy: 39.31
Round   6, Train loss: 1.144, Test loss: 1.262, Test accuracy: 50.45
Round   6, Global train loss: 1.144, Global test loss: 1.669, Global test accuracy: 39.68
Round   7, Train loss: 1.201, Test loss: 1.231, Test accuracy: 51.07
Round   7, Global train loss: 1.201, Global test loss: 1.720, Global test accuracy: 40.78
Round   8, Train loss: 1.189, Test loss: 1.198, Test accuracy: 52.07
Round   8, Global train loss: 1.189, Global test loss: 1.581, Global test accuracy: 43.25
Round   9, Train loss: 1.117, Test loss: 1.176, Test accuracy: 53.66
Round   9, Global train loss: 1.117, Global test loss: 1.631, Global test accuracy: 42.28
Round  10, Train loss: 1.151, Test loss: 1.174, Test accuracy: 53.01
Round  10, Global train loss: 1.151, Global test loss: 1.664, Global test accuracy: 41.62
Round  11, Train loss: 1.115, Test loss: 1.158, Test accuracy: 53.39
Round  11, Global train loss: 1.115, Global test loss: 1.645, Global test accuracy: 43.08
Round  12, Train loss: 1.022, Test loss: 1.155, Test accuracy: 53.05
Round  12, Global train loss: 1.022, Global test loss: 1.640, Global test accuracy: 45.06
Round  13, Train loss: 1.011, Test loss: 1.160, Test accuracy: 53.92
Round  13, Global train loss: 1.011, Global test loss: 1.484, Global test accuracy: 49.57
Round  14, Train loss: 1.022, Test loss: 1.149, Test accuracy: 54.63
Round  14, Global train loss: 1.022, Global test loss: 1.465, Global test accuracy: 48.16
Round  15, Train loss: 1.069, Test loss: 1.147, Test accuracy: 54.48
Round  15, Global train loss: 1.069, Global test loss: 1.505, Global test accuracy: 49.28
Round  16, Train loss: 1.009, Test loss: 1.093, Test accuracy: 57.05
Round  16, Global train loss: 1.009, Global test loss: 1.408, Global test accuracy: 48.85
Round  17, Train loss: 0.970, Test loss: 1.096, Test accuracy: 56.73
Round  17, Global train loss: 0.970, Global test loss: 1.402, Global test accuracy: 48.58
Round  18, Train loss: 0.895, Test loss: 1.089, Test accuracy: 56.85
Round  18, Global train loss: 0.895, Global test loss: 1.473, Global test accuracy: 48.21
Round  19, Train loss: 0.942, Test loss: 1.070, Test accuracy: 58.20
Round  19, Global train loss: 0.942, Global test loss: 1.410, Global test accuracy: 52.03
Round  20, Train loss: 0.970, Test loss: 1.080, Test accuracy: 57.95
Round  20, Global train loss: 0.970, Global test loss: 1.399, Global test accuracy: 51.82
Round  21, Train loss: 0.876, Test loss: 1.058, Test accuracy: 58.24
Round  21, Global train loss: 0.876, Global test loss: 1.595, Global test accuracy: 47.44
Round  22, Train loss: 1.020, Test loss: 1.050, Test accuracy: 58.68
Round  22, Global train loss: 1.020, Global test loss: 1.309, Global test accuracy: 53.51
Round  23, Train loss: 0.902, Test loss: 1.059, Test accuracy: 58.17
Round  23, Global train loss: 0.902, Global test loss: 1.438, Global test accuracy: 53.48
Round  24, Train loss: 0.838, Test loss: 1.042, Test accuracy: 59.34
Round  24, Global train loss: 0.838, Global test loss: 1.294, Global test accuracy: 54.50
Round  25, Train loss: 0.960, Test loss: 1.066, Test accuracy: 59.31
Round  25, Global train loss: 0.960, Global test loss: 1.303, Global test accuracy: 52.74
Round  26, Train loss: 0.847, Test loss: 1.048, Test accuracy: 60.46
Round  26, Global train loss: 0.847, Global test loss: 1.229, Global test accuracy: 55.51
Round  27, Train loss: 0.826, Test loss: 1.056, Test accuracy: 60.58
Round  27, Global train loss: 0.826, Global test loss: 1.272, Global test accuracy: 54.17
Round  28, Train loss: 0.761, Test loss: 1.070, Test accuracy: 60.11
Round  28, Global train loss: 0.761, Global test loss: 1.260, Global test accuracy: 54.86
Round  29, Train loss: 0.909, Test loss: 1.038, Test accuracy: 60.73
Round  29, Global train loss: 0.909, Global test loss: 1.272, Global test accuracy: 54.14
Round  30, Train loss: 0.758, Test loss: 1.041, Test accuracy: 60.69
Round  30, Global train loss: 0.758, Global test loss: 1.426, Global test accuracy: 51.10
Round  31, Train loss: 0.831, Test loss: 1.046, Test accuracy: 61.22
Round  31, Global train loss: 0.831, Global test loss: 1.369, Global test accuracy: 55.20
Round  32, Train loss: 0.805, Test loss: 1.007, Test accuracy: 62.39
Round  32, Global train loss: 0.805, Global test loss: 1.246, Global test accuracy: 57.41
Round  33, Train loss: 0.879, Test loss: 1.007, Test accuracy: 63.00
Round  33, Global train loss: 0.879, Global test loss: 1.242, Global test accuracy: 57.53
Round  34, Train loss: 0.760, Test loss: 1.018, Test accuracy: 62.84
Round  34, Global train loss: 0.760, Global test loss: 1.170, Global test accuracy: 59.12
Round  35, Train loss: 0.691, Test loss: 0.998, Test accuracy: 63.58
Round  35, Global train loss: 0.691, Global test loss: 1.168, Global test accuracy: 58.36
Round  36, Train loss: 0.738, Test loss: 1.007, Test accuracy: 63.02
Round  36, Global train loss: 0.738, Global test loss: 1.280, Global test accuracy: 54.79
Round  37, Train loss: 0.783, Test loss: 0.989, Test accuracy: 63.54
Round  37, Global train loss: 0.783, Global test loss: 1.312, Global test accuracy: 55.22
Round  38, Train loss: 0.791, Test loss: 0.957, Test accuracy: 63.68
Round  38, Global train loss: 0.791, Global test loss: 1.259, Global test accuracy: 55.74
Round  39, Train loss: 0.777, Test loss: 0.978, Test accuracy: 63.26
Round  39, Global train loss: 0.777, Global test loss: 1.170, Global test accuracy: 60.28
Round  40, Train loss: 0.673, Test loss: 1.008, Test accuracy: 62.57
Round  40, Global train loss: 0.673, Global test loss: 1.255, Global test accuracy: 57.85
Round  41, Train loss: 0.667, Test loss: 0.995, Test accuracy: 62.73
Round  41, Global train loss: 0.667, Global test loss: 1.274, Global test accuracy: 58.40
Round  42, Train loss: 0.633, Test loss: 0.979, Test accuracy: 63.45
Round  42, Global train loss: 0.633, Global test loss: 1.195, Global test accuracy: 60.32
Round  43, Train loss: 0.743, Test loss: 1.022, Test accuracy: 62.81
Round  43, Global train loss: 0.743, Global test loss: 1.334, Global test accuracy: 53.34
Round  44, Train loss: 0.739, Test loss: 1.002, Test accuracy: 63.22
Round  44, Global train loss: 0.739, Global test loss: 1.187, Global test accuracy: 59.77
Round  45, Train loss: 0.698, Test loss: 1.008, Test accuracy: 63.42
Round  45, Global train loss: 0.698, Global test loss: 1.256, Global test accuracy: 56.50
Round  46, Train loss: 0.647, Test loss: 1.034, Test accuracy: 63.33
Round  46, Global train loss: 0.647, Global test loss: 1.153, Global test accuracy: 60.67
Round  47, Train loss: 0.713, Test loss: 0.985, Test accuracy: 64.20
Round  47, Global train loss: 0.713, Global test loss: 1.327, Global test accuracy: 55.74
Round  48, Train loss: 0.641, Test loss: 0.989, Test accuracy: 64.11
Round  48, Global train loss: 0.641, Global test loss: 1.112, Global test accuracy: 61.53
Round  49, Train loss: 0.562, Test loss: 0.970, Test accuracy: 64.97
Round  49, Global train loss: 0.562, Global test loss: 1.208, Global test accuracy: 59.25
Round  50, Train loss: 0.561, Test loss: 0.964, Test accuracy: 65.19
Round  50, Global train loss: 0.561, Global test loss: 1.299, Global test accuracy: 56.87
Round  51, Train loss: 0.681, Test loss: 0.987, Test accuracy: 65.18
Round  51, Global train loss: 0.681, Global test loss: 1.099, Global test accuracy: 61.51
Round  52, Train loss: 0.662, Test loss: 0.997, Test accuracy: 64.58
Round  52, Global train loss: 0.662, Global test loss: 1.141, Global test accuracy: 61.18
Round  53, Train loss: 0.673, Test loss: 0.976, Test accuracy: 65.14
Round  53, Global train loss: 0.673, Global test loss: 1.173, Global test accuracy: 59.93
Round  54, Train loss: 0.602, Test loss: 1.019, Test accuracy: 64.81
Round  54, Global train loss: 0.602, Global test loss: 1.127, Global test accuracy: 61.36
Round  55, Train loss: 0.554, Test loss: 1.012, Test accuracy: 64.59
Round  55, Global train loss: 0.554, Global test loss: 1.153, Global test accuracy: 60.62
Round  56, Train loss: 0.618, Test loss: 0.999, Test accuracy: 64.78
Round  56, Global train loss: 0.618, Global test loss: 1.283, Global test accuracy: 57.80
Round  57, Train loss: 0.611, Test loss: 1.001, Test accuracy: 64.97
Round  57, Global train loss: 0.611, Global test loss: 1.114, Global test accuracy: 61.67
Round  58, Train loss: 0.566, Test loss: 1.014, Test accuracy: 65.25
Round  58, Global train loss: 0.566, Global test loss: 1.307, Global test accuracy: 59.14
Round  59, Train loss: 0.563, Test loss: 1.030, Test accuracy: 64.82
Round  59, Global train loss: 0.563, Global test loss: 1.240, Global test accuracy: 58.47
Round  60, Train loss: 0.601, Test loss: 1.075, Test accuracy: 64.26
Round  60, Global train loss: 0.601, Global test loss: 1.255, Global test accuracy: 58.61
Round  61, Train loss: 0.591, Test loss: 1.073, Test accuracy: 64.54
Round  61, Global train loss: 0.591, Global test loss: 1.137, Global test accuracy: 61.36
Round  62, Train loss: 0.674, Test loss: 1.062, Test accuracy: 65.22
Round  62, Global train loss: 0.674, Global test loss: 1.231, Global test accuracy: 59.12
Round  63, Train loss: 0.513, Test loss: 1.074, Test accuracy: 65.32
Round  63, Global train loss: 0.513, Global test loss: 1.160, Global test accuracy: 62.38
Round  64, Train loss: 0.657, Test loss: 1.063, Test accuracy: 65.63
Round  64, Global train loss: 0.657, Global test loss: 1.178, Global test accuracy: 60.45
Round  65, Train loss: 0.593, Test loss: 1.022, Test accuracy: 66.22
Round  65, Global train loss: 0.593, Global test loss: 1.126, Global test accuracy: 62.39
Round  66, Train loss: 0.495, Test loss: 1.027, Test accuracy: 66.21
Round  66, Global train loss: 0.495, Global test loss: 1.241, Global test accuracy: 59.59
Round  67, Train loss: 0.629, Test loss: 1.019, Test accuracy: 65.71
Round  67, Global train loss: 0.629, Global test loss: 1.229, Global test accuracy: 58.99
Round  68, Train loss: 0.586, Test loss: 1.009, Test accuracy: 65.91
Round  68, Global train loss: 0.586, Global test loss: 1.301, Global test accuracy: 56.82
Round  69, Train loss: 0.614, Test loss: 1.021, Test accuracy: 65.84
Round  69, Global train loss: 0.614, Global test loss: 1.212, Global test accuracy: 58.87
Round  70, Train loss: 0.559, Test loss: 1.015, Test accuracy: 65.81
Round  70, Global train loss: 0.559, Global test loss: 1.245, Global test accuracy: 57.79
Round  71, Train loss: 0.475, Test loss: 1.016, Test accuracy: 65.80
Round  71, Global train loss: 0.475, Global test loss: 1.300, Global test accuracy: 58.29
Round  72, Train loss: 0.506, Test loss: 1.047, Test accuracy: 65.29
Round  72, Global train loss: 0.506, Global test loss: 1.238, Global test accuracy: 60.45
Round  73, Train loss: 0.442, Test loss: 1.058, Test accuracy: 65.18
Round  73, Global train loss: 0.442, Global test loss: 1.208, Global test accuracy: 61.49
Round  74, Train loss: 0.520, Test loss: 1.048, Test accuracy: 65.67
Round  74, Global train loss: 0.520, Global test loss: 1.185, Global test accuracy: 60.78
Round  75, Train loss: 0.477, Test loss: 1.050, Test accuracy: 66.15
Round  75, Global train loss: 0.477, Global test loss: 1.261, Global test accuracy: 61.11
Round  76, Train loss: 0.493, Test loss: 1.075, Test accuracy: 66.00
Round  76, Global train loss: 0.493, Global test loss: 1.293, Global test accuracy: 58.42
Round  77, Train loss: 0.524, Test loss: 1.096, Test accuracy: 65.68
Round  77, Global train loss: 0.524, Global test loss: 1.319, Global test accuracy: 58.54
Round  78, Train loss: 0.454, Test loss: 1.089, Test accuracy: 65.84
Round  78, Global train loss: 0.454, Global test loss: 1.199, Global test accuracy: 61.67
Round  79, Train loss: 0.487, Test loss: 1.097, Test accuracy: 65.97
Round  79, Global train loss: 0.487, Global test loss: 1.247, Global test accuracy: 60.49
Round  80, Train loss: 0.413, Test loss: 1.096, Test accuracy: 66.21
Round  80, Global train loss: 0.413, Global test loss: 1.401, Global test accuracy: 57.58
Round  81, Train loss: 0.484, Test loss: 1.062, Test accuracy: 67.02
Round  81, Global train loss: 0.484, Global test loss: 1.325, Global test accuracy: 58.49
Round  82, Train loss: 0.408, Test loss: 1.059, Test accuracy: 67.08
Round  82, Global train loss: 0.408, Global test loss: 1.328, Global test accuracy: 60.03
Round  83, Train loss: 0.448, Test loss: 1.056, Test accuracy: 67.06
Round  83, Global train loss: 0.448, Global test loss: 1.293, Global test accuracy: 61.83
Round  84, Train loss: 0.461, Test loss: 1.081, Test accuracy: 66.86
Round  84, Global train loss: 0.461, Global test loss: 1.354, Global test accuracy: 60.11
Round  85, Train loss: 0.385, Test loss: 1.068, Test accuracy: 67.18
Round  85, Global train loss: 0.385, Global test loss: 1.396, Global test accuracy: 58.58
Round  86, Train loss: 0.509, Test loss: 1.085, Test accuracy: 66.79
Round  86, Global train loss: 0.509, Global test loss: 1.201, Global test accuracy: 61.39
Round  87, Train loss: 0.402, Test loss: 1.096, Test accuracy: 66.58
Round  87, Global train loss: 0.402, Global test loss: 1.300, Global test accuracy: 60.55
Round  88, Train loss: 0.431, Test loss: 1.112, Test accuracy: 66.31
Round  88, Global train loss: 0.431, Global test loss: 1.289, Global test accuracy: 60.79
Round  89, Train loss: 0.452, Test loss: 1.115, Test accuracy: 66.45
Round  89, Global train loss: 0.452, Global test loss: 1.256, Global test accuracy: 60.51
Round  90, Train loss: 0.378, Test loss: 1.103, Test accuracy: 66.87
Round  90, Global train loss: 0.378, Global test loss: 1.311, Global test accuracy: 59.91
Round  91, Train loss: 0.562, Test loss: 1.093, Test accuracy: 67.50
Round  91, Global train loss: 0.562, Global test loss: 1.113, Global test accuracy: 63.75
Round  92, Train loss: 0.502, Test loss: 1.095, Test accuracy: 67.47
Round  92, Global train loss: 0.502, Global test loss: 1.265, Global test accuracy: 60.25
Round  93, Train loss: 0.476, Test loss: 1.167, Test accuracy: 66.54
Round  93, Global train loss: 0.476, Global test loss: 1.247, Global test accuracy: 60.24
Round  94, Train loss: 0.441, Test loss: 1.150, Test accuracy: 66.21
Round  94, Global train loss: 0.441, Global test loss: 1.237, Global test accuracy: 61.90/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.417, Test loss: 1.123, Test accuracy: 66.51
Round  95, Global train loss: 0.417, Global test loss: 1.245, Global test accuracy: 61.12
Round  96, Train loss: 0.472, Test loss: 1.157, Test accuracy: 66.49
Round  96, Global train loss: 0.472, Global test loss: 1.225, Global test accuracy: 61.28
Round  97, Train loss: 0.416, Test loss: 1.152, Test accuracy: 66.62
Round  97, Global train loss: 0.416, Global test loss: 1.149, Global test accuracy: 64.30
Round  98, Train loss: 0.392, Test loss: 1.162, Test accuracy: 66.70
Round  98, Global train loss: 0.392, Global test loss: 1.414, Global test accuracy: 60.27
Round  99, Train loss: 0.384, Test loss: 1.178, Test accuracy: 66.65
Round  99, Global train loss: 0.384, Global test loss: 1.473, Global test accuracy: 58.92
Final Round, Train loss: 0.347, Test loss: 1.223, Test accuracy: 67.54
Final Round, Global train loss: 0.347, Global test loss: 1.473, Global test accuracy: 58.92
Average accuracy final 10 rounds: 66.75600000000001 

Average global accuracy final 10 rounds: 61.194 

1866.1787109375
[1.849898099899292, 3.699796199798584, 5.189856767654419, 6.679917335510254, 8.18959665298462, 9.699275970458984, 11.206519365310669, 12.713762760162354, 14.217610597610474, 15.721458435058594, 17.207123517990112, 18.69278860092163, 20.1660475730896, 21.63930654525757, 23.101574659347534, 24.5638427734375, 26.060485124588013, 27.557127475738525, 29.034687995910645, 30.512248516082764, 31.981840133666992, 33.45143175125122, 34.898903608322144, 36.346375465393066, 37.84129571914673, 39.33621597290039, 40.82059121131897, 42.30496644973755, 43.77098989486694, 45.23701333999634, 46.73861050605774, 48.24020767211914, 49.73665452003479, 51.23310136795044, 52.69688820838928, 54.160675048828125, 55.65474510192871, 57.1488151550293, 58.6327543258667, 60.1166934967041, 61.61396527290344, 63.11123704910278, 64.59293556213379, 66.0746340751648, 67.5839011669159, 69.09316825866699, 70.58082628250122, 72.06848430633545, 73.54523539543152, 75.02198648452759, 76.51261115074158, 78.00323581695557, 79.5203766822815, 81.03751754760742, 82.5089840888977, 83.98045063018799, 85.47633838653564, 86.9722261428833, 88.47050285339355, 89.96877956390381, 91.4692234992981, 92.96966743469238, 94.51254510879517, 96.05542278289795, 97.5267288684845, 98.99803495407104, 100.54515361785889, 102.09227228164673, 103.57666778564453, 105.06106328964233, 106.56210207939148, 108.06314086914062, 109.55069947242737, 111.03825807571411, 112.55122804641724, 114.06419801712036, 115.58307552337646, 117.10195302963257, 118.59065771102905, 120.07936239242554, 121.57921314239502, 123.0790638923645, 124.54385471343994, 126.00864553451538, 127.47536659240723, 128.94208765029907, 130.45712637901306, 131.97216510772705, 133.46326208114624, 134.95435905456543, 136.46204924583435, 137.96973943710327, 139.4672725200653, 140.96480560302734, 142.4382450580597, 143.91168451309204, 145.4386432170868, 146.96560192108154, 148.46795654296875, 149.97031116485596, 151.46247601509094, 152.95464086532593, 154.46384978294373, 155.97305870056152, 157.4781928062439, 158.98332691192627, 160.5168948173523, 162.05046272277832, 163.53956270217896, 165.0286626815796, 166.49923706054688, 167.96981143951416, 169.47143268585205, 170.97305393218994, 172.49530267715454, 174.01755142211914, 175.48345971107483, 176.94936800003052, 178.44969391822815, 179.95001983642578, 181.43069648742676, 182.91137313842773, 184.4241292476654, 185.93688535690308, 187.45621991157532, 188.97555446624756, 190.4467875957489, 191.91802072525024, 193.4500916004181, 194.98216247558594, 196.4729573726654, 197.96375226974487, 199.45582127571106, 200.94789028167725, 202.41938424110413, 203.890878200531, 205.35783004760742, 206.82478189468384, 208.31944227218628, 209.81410264968872, 211.2822151184082, 212.75032758712769, 214.26734256744385, 215.78435754776, 217.3063943386078, 218.82843112945557, 220.33891034126282, 221.84938955307007, 223.31146478652954, 224.773540019989, 226.25496292114258, 227.73638582229614, 229.23932933807373, 230.74227285385132, 232.20440292358398, 233.66653299331665, 235.1658537387848, 236.66517448425293, 238.1664125919342, 239.66765069961548, 241.13648676872253, 242.6053228378296, 244.11985564231873, 245.63438844680786, 247.10765075683594, 248.580913066864, 250.07840037345886, 251.5758876800537, 253.07995295524597, 254.58401823043823, 256.0813822746277, 257.57874631881714, 259.0554344654083, 260.5321226119995, 262.01130080223083, 263.49047899246216, 264.9437208175659, 266.3969626426697, 267.8994631767273, 269.4019637107849, 270.8710424900055, 272.3401212692261, 273.81614208221436, 275.29216289520264, 276.8103256225586, 278.32848834991455, 279.7989718914032, 281.26945543289185, 282.81466150283813, 284.3598675727844, 285.8383207321167, 287.316773891449, 288.8353478908539, 290.3539218902588, 291.8785467147827, 293.40317153930664, 294.8956913948059, 296.3882112503052, 297.94088888168335, 299.4935665130615, 302.5652163028717, 305.6368660926819]
[21.26, 21.26, 32.64, 32.64, 42.41, 42.41, 45.7, 45.7, 46.62, 46.62, 48.07, 48.07, 50.45, 50.45, 51.07, 51.07, 52.07, 52.07, 53.66, 53.66, 53.01, 53.01, 53.39, 53.39, 53.05, 53.05, 53.92, 53.92, 54.63, 54.63, 54.48, 54.48, 57.05, 57.05, 56.73, 56.73, 56.85, 56.85, 58.2, 58.2, 57.95, 57.95, 58.24, 58.24, 58.68, 58.68, 58.17, 58.17, 59.34, 59.34, 59.31, 59.31, 60.46, 60.46, 60.58, 60.58, 60.11, 60.11, 60.73, 60.73, 60.69, 60.69, 61.22, 61.22, 62.39, 62.39, 63.0, 63.0, 62.84, 62.84, 63.58, 63.58, 63.02, 63.02, 63.54, 63.54, 63.68, 63.68, 63.26, 63.26, 62.57, 62.57, 62.73, 62.73, 63.45, 63.45, 62.81, 62.81, 63.22, 63.22, 63.42, 63.42, 63.33, 63.33, 64.2, 64.2, 64.11, 64.11, 64.97, 64.97, 65.19, 65.19, 65.18, 65.18, 64.58, 64.58, 65.14, 65.14, 64.81, 64.81, 64.59, 64.59, 64.78, 64.78, 64.97, 64.97, 65.25, 65.25, 64.82, 64.82, 64.26, 64.26, 64.54, 64.54, 65.22, 65.22, 65.32, 65.32, 65.63, 65.63, 66.22, 66.22, 66.21, 66.21, 65.71, 65.71, 65.91, 65.91, 65.84, 65.84, 65.81, 65.81, 65.8, 65.8, 65.29, 65.29, 65.18, 65.18, 65.67, 65.67, 66.15, 66.15, 66.0, 66.0, 65.68, 65.68, 65.84, 65.84, 65.97, 65.97, 66.21, 66.21, 67.02, 67.02, 67.08, 67.08, 67.06, 67.06, 66.86, 66.86, 67.18, 67.18, 66.79, 66.79, 66.58, 66.58, 66.31, 66.31, 66.45, 66.45, 66.87, 66.87, 67.5, 67.5, 67.47, 67.47, 66.54, 66.54, 66.21, 66.21, 66.51, 66.51, 66.49, 66.49, 66.62, 66.62, 66.7, 66.7, 66.65, 66.65, 67.54, 67.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.638, Test loss: 2.116, Test accuracy: 23.93
Round   0, Global train loss: 1.638, Global test loss: 2.263, Global test accuracy: 20.33
Round   1, Train loss: 1.430, Test loss: 1.909, Test accuracy: 32.80
Round   1, Global train loss: 1.430, Global test loss: 2.268, Global test accuracy: 23.43
Round   2, Train loss: 1.386, Test loss: 1.715, Test accuracy: 38.35
Round   2, Global train loss: 1.386, Global test loss: 2.054, Global test accuracy: 29.78
Round   3, Train loss: 1.368, Test loss: 1.615, Test accuracy: 39.88
Round   3, Global train loss: 1.368, Global test loss: 1.817, Global test accuracy: 34.59
Round   4, Train loss: 1.348, Test loss: 1.502, Test accuracy: 41.81
Round   4, Global train loss: 1.348, Global test loss: 2.049, Global test accuracy: 26.48
Round   5, Train loss: 1.126, Test loss: 1.402, Test accuracy: 46.00
Round   5, Global train loss: 1.126, Global test loss: 1.816, Global test accuracy: 37.99
Round   6, Train loss: 1.280, Test loss: 1.384, Test accuracy: 47.14
Round   6, Global train loss: 1.280, Global test loss: 1.895, Global test accuracy: 32.43
Round   7, Train loss: 1.172, Test loss: 1.362, Test accuracy: 47.10
Round   7, Global train loss: 1.172, Global test loss: 1.698, Global test accuracy: 40.29
Round   8, Train loss: 1.127, Test loss: 1.351, Test accuracy: 47.51
Round   8, Global train loss: 1.127, Global test loss: 1.683, Global test accuracy: 39.92
Round   9, Train loss: 1.048, Test loss: 1.312, Test accuracy: 48.42
Round   9, Global train loss: 1.048, Global test loss: 1.743, Global test accuracy: 39.44
Round  10, Train loss: 1.012, Test loss: 1.303, Test accuracy: 48.77
Round  10, Global train loss: 1.012, Global test loss: 1.683, Global test accuracy: 41.88
Round  11, Train loss: 1.064, Test loss: 1.312, Test accuracy: 49.48
Round  11, Global train loss: 1.064, Global test loss: 1.647, Global test accuracy: 44.17
Round  12, Train loss: 0.906, Test loss: 1.306, Test accuracy: 49.54
Round  12, Global train loss: 0.906, Global test loss: 1.763, Global test accuracy: 43.53
Round  13, Train loss: 0.999, Test loss: 1.263, Test accuracy: 50.72
Round  13, Global train loss: 0.999, Global test loss: 1.523, Global test accuracy: 48.25
Round  14, Train loss: 0.980, Test loss: 1.256, Test accuracy: 50.46
Round  14, Global train loss: 0.980, Global test loss: 1.620, Global test accuracy: 43.88
Round  15, Train loss: 0.881, Test loss: 1.257, Test accuracy: 50.82
Round  15, Global train loss: 0.881, Global test loss: 1.622, Global test accuracy: 45.27
Round  16, Train loss: 0.968, Test loss: 1.245, Test accuracy: 52.23
Round  16, Global train loss: 0.968, Global test loss: 1.376, Global test accuracy: 51.18
Round  17, Train loss: 0.935, Test loss: 1.246, Test accuracy: 52.62
Round  17, Global train loss: 0.935, Global test loss: 1.376, Global test accuracy: 50.82
Round  18, Train loss: 1.035, Test loss: 1.203, Test accuracy: 53.59
Round  18, Global train loss: 1.035, Global test loss: 1.629, Global test accuracy: 43.37
Round  19, Train loss: 0.898, Test loss: 1.197, Test accuracy: 53.82
Round  19, Global train loss: 0.898, Global test loss: 1.513, Global test accuracy: 49.37
Round  20, Train loss: 0.870, Test loss: 1.214, Test accuracy: 53.90
Round  20, Global train loss: 0.870, Global test loss: 1.432, Global test accuracy: 51.03
Round  21, Train loss: 0.857, Test loss: 1.211, Test accuracy: 54.29
Round  21, Global train loss: 0.857, Global test loss: 1.551, Global test accuracy: 50.19
Round  22, Train loss: 0.878, Test loss: 1.194, Test accuracy: 54.74
Round  22, Global train loss: 0.878, Global test loss: 1.424, Global test accuracy: 53.17
Round  23, Train loss: 0.851, Test loss: 1.205, Test accuracy: 54.07
Round  23, Global train loss: 0.851, Global test loss: 1.442, Global test accuracy: 53.74
Round  24, Train loss: 0.744, Test loss: 1.201, Test accuracy: 53.84
Round  24, Global train loss: 0.744, Global test loss: 1.329, Global test accuracy: 54.57
Round  25, Train loss: 0.910, Test loss: 1.195, Test accuracy: 54.82
Round  25, Global train loss: 0.910, Global test loss: 1.482, Global test accuracy: 49.23
Round  26, Train loss: 0.930, Test loss: 1.187, Test accuracy: 55.23
Round  26, Global train loss: 0.930, Global test loss: 1.275, Global test accuracy: 55.33
Round  27, Train loss: 0.761, Test loss: 1.142, Test accuracy: 56.35
Round  27, Global train loss: 0.761, Global test loss: 1.423, Global test accuracy: 51.53
Round  28, Train loss: 0.898, Test loss: 1.148, Test accuracy: 56.48
Round  28, Global train loss: 0.898, Global test loss: 1.413, Global test accuracy: 51.13
Round  29, Train loss: 0.790, Test loss: 1.150, Test accuracy: 56.55
Round  29, Global train loss: 0.790, Global test loss: 1.360, Global test accuracy: 53.34
Round  30, Train loss: 0.888, Test loss: 1.164, Test accuracy: 56.61
Round  30, Global train loss: 0.888, Global test loss: 1.431, Global test accuracy: 51.92
Round  31, Train loss: 0.767, Test loss: 1.161, Test accuracy: 56.61
Round  31, Global train loss: 0.767, Global test loss: 1.479, Global test accuracy: 54.50
Round  32, Train loss: 0.784, Test loss: 1.146, Test accuracy: 56.67
Round  32, Global train loss: 0.784, Global test loss: 1.355, Global test accuracy: 55.36
Round  33, Train loss: 0.750, Test loss: 1.140, Test accuracy: 57.78
Round  33, Global train loss: 0.750, Global test loss: 1.360, Global test accuracy: 54.49
Round  34, Train loss: 0.878, Test loss: 1.135, Test accuracy: 57.29
Round  34, Global train loss: 0.878, Global test loss: 1.331, Global test accuracy: 54.94
Round  35, Train loss: 0.791, Test loss: 1.193, Test accuracy: 57.64
Round  35, Global train loss: 0.791, Global test loss: 1.327, Global test accuracy: 53.64
Round  36, Train loss: 0.709, Test loss: 1.220, Test accuracy: 57.08
Round  36, Global train loss: 0.709, Global test loss: 1.348, Global test accuracy: 56.96
Round  37, Train loss: 0.669, Test loss: 1.213, Test accuracy: 57.42
Round  37, Global train loss: 0.669, Global test loss: 1.386, Global test accuracy: 54.18
Round  38, Train loss: 0.729, Test loss: 1.172, Test accuracy: 57.18
Round  38, Global train loss: 0.729, Global test loss: 1.397, Global test accuracy: 53.06
Round  39, Train loss: 0.599, Test loss: 1.159, Test accuracy: 57.67
Round  39, Global train loss: 0.599, Global test loss: 1.204, Global test accuracy: 60.39
Round  40, Train loss: 0.664, Test loss: 1.154, Test accuracy: 58.23
Round  40, Global train loss: 0.664, Global test loss: 1.308, Global test accuracy: 57.40
Round  41, Train loss: 0.631, Test loss: 1.157, Test accuracy: 58.91
Round  41, Global train loss: 0.631, Global test loss: 1.374, Global test accuracy: 57.35
Round  42, Train loss: 0.599, Test loss: 1.168, Test accuracy: 58.92
Round  42, Global train loss: 0.599, Global test loss: 1.298, Global test accuracy: 59.02
Round  43, Train loss: 0.626, Test loss: 1.145, Test accuracy: 59.28
Round  43, Global train loss: 0.626, Global test loss: 1.382, Global test accuracy: 54.42
Round  44, Train loss: 0.615, Test loss: 1.150, Test accuracy: 59.26
Round  44, Global train loss: 0.615, Global test loss: 1.258, Global test accuracy: 59.40
Round  45, Train loss: 0.577, Test loss: 1.165, Test accuracy: 59.14
Round  45, Global train loss: 0.577, Global test loss: 1.338, Global test accuracy: 55.76
Round  46, Train loss: 0.778, Test loss: 1.143, Test accuracy: 60.07
Round  46, Global train loss: 0.778, Global test loss: 1.214, Global test accuracy: 59.86
Round  47, Train loss: 0.627, Test loss: 1.221, Test accuracy: 59.00
Round  47, Global train loss: 0.627, Global test loss: 1.318, Global test accuracy: 56.75
Round  48, Train loss: 0.611, Test loss: 1.199, Test accuracy: 59.61
Round  48, Global train loss: 0.611, Global test loss: 1.162, Global test accuracy: 59.98
Round  49, Train loss: 0.570, Test loss: 1.182, Test accuracy: 59.95
Round  49, Global train loss: 0.570, Global test loss: 1.406, Global test accuracy: 54.70
Round  50, Train loss: 0.680, Test loss: 1.199, Test accuracy: 59.58
Round  50, Global train loss: 0.680, Global test loss: 1.421, Global test accuracy: 49.64
Round  51, Train loss: 0.660, Test loss: 1.210, Test accuracy: 60.28
Round  51, Global train loss: 0.660, Global test loss: 1.170, Global test accuracy: 60.45
Round  52, Train loss: 0.654, Test loss: 1.175, Test accuracy: 60.35
Round  52, Global train loss: 0.654, Global test loss: 1.260, Global test accuracy: 57.74
Round  53, Train loss: 0.570, Test loss: 1.181, Test accuracy: 60.23
Round  53, Global train loss: 0.570, Global test loss: 1.262, Global test accuracy: 59.07
Round  54, Train loss: 0.642, Test loss: 1.205, Test accuracy: 60.16
Round  54, Global train loss: 0.642, Global test loss: 1.289, Global test accuracy: 58.17
Round  55, Train loss: 0.525, Test loss: 1.189, Test accuracy: 60.91
Round  55, Global train loss: 0.525, Global test loss: 1.248, Global test accuracy: 58.19
Round  56, Train loss: 0.514, Test loss: 1.207, Test accuracy: 60.62
Round  56, Global train loss: 0.514, Global test loss: 1.324, Global test accuracy: 59.39
Round  57, Train loss: 0.538, Test loss: 1.207, Test accuracy: 60.76
Round  57, Global train loss: 0.538, Global test loss: 1.129, Global test accuracy: 63.38
Round  58, Train loss: 0.452, Test loss: 1.201, Test accuracy: 61.18
Round  58, Global train loss: 0.452, Global test loss: 1.382, Global test accuracy: 58.46
Round  59, Train loss: 0.593, Test loss: 1.245, Test accuracy: 61.02
Round  59, Global train loss: 0.593, Global test loss: 1.316, Global test accuracy: 57.12
Round  60, Train loss: 0.511, Test loss: 1.214, Test accuracy: 61.39
Round  60, Global train loss: 0.511, Global test loss: 1.229, Global test accuracy: 61.05
Round  61, Train loss: 0.646, Test loss: 1.266, Test accuracy: 60.65
Round  61, Global train loss: 0.646, Global test loss: 1.262, Global test accuracy: 59.33
Round  62, Train loss: 0.456, Test loss: 1.259, Test accuracy: 60.70
Round  62, Global train loss: 0.456, Global test loss: 1.207, Global test accuracy: 62.60
Round  63, Train loss: 0.550, Test loss: 1.233, Test accuracy: 61.37
Round  63, Global train loss: 0.550, Global test loss: 1.322, Global test accuracy: 58.59
Round  64, Train loss: 0.523, Test loss: 1.202, Test accuracy: 61.44
Round  64, Global train loss: 0.523, Global test loss: 1.211, Global test accuracy: 61.49
Round  65, Train loss: 0.509, Test loss: 1.181, Test accuracy: 61.73
Round  65, Global train loss: 0.509, Global test loss: 1.342, Global test accuracy: 57.47
Round  66, Train loss: 0.409, Test loss: 1.182, Test accuracy: 61.76
Round  66, Global train loss: 0.409, Global test loss: 1.295, Global test accuracy: 59.31
Round  67, Train loss: 0.529, Test loss: 1.156, Test accuracy: 62.31
Round  67, Global train loss: 0.529, Global test loss: 1.311, Global test accuracy: 58.67
Round  68, Train loss: 0.488, Test loss: 1.187, Test accuracy: 61.91
Round  68, Global train loss: 0.488, Global test loss: 1.384, Global test accuracy: 56.43
Round  69, Train loss: 0.450, Test loss: 1.194, Test accuracy: 62.16
Round  69, Global train loss: 0.450, Global test loss: 1.138, Global test accuracy: 62.16
Round  70, Train loss: 0.594, Test loss: 1.259, Test accuracy: 62.04
Round  70, Global train loss: 0.594, Global test loss: 1.262, Global test accuracy: 59.76
Round  71, Train loss: 0.486, Test loss: 1.292, Test accuracy: 62.01
Round  71, Global train loss: 0.486, Global test loss: 1.330, Global test accuracy: 57.35
Round  72, Train loss: 0.451, Test loss: 1.284, Test accuracy: 61.69
Round  72, Global train loss: 0.451, Global test loss: 1.361, Global test accuracy: 60.05
Round  73, Train loss: 0.440, Test loss: 1.285, Test accuracy: 61.80
Round  73, Global train loss: 0.440, Global test loss: 1.389, Global test accuracy: 57.76
Round  74, Train loss: 0.437, Test loss: 1.259, Test accuracy: 62.02
Round  74, Global train loss: 0.437, Global test loss: 1.399, Global test accuracy: 57.88
Round  75, Train loss: 0.385, Test loss: 1.269, Test accuracy: 62.23
Round  75, Global train loss: 0.385, Global test loss: 1.380, Global test accuracy: 59.08
Round  76, Train loss: 0.385, Test loss: 1.300, Test accuracy: 61.63
Round  76, Global train loss: 0.385, Global test loss: 1.420, Global test accuracy: 54.76
Round  77, Train loss: 0.458, Test loss: 1.271, Test accuracy: 61.85
Round  77, Global train loss: 0.458, Global test loss: 1.252, Global test accuracy: 59.39
Round  78, Train loss: 0.566, Test loss: 1.302, Test accuracy: 61.34
Round  78, Global train loss: 0.566, Global test loss: 1.307, Global test accuracy: 57.23
Round  79, Train loss: 0.359, Test loss: 1.282, Test accuracy: 61.34
Round  79, Global train loss: 0.359, Global test loss: 1.341, Global test accuracy: 60.04
Round  80, Train loss: 0.423, Test loss: 1.305, Test accuracy: 61.22
Round  80, Global train loss: 0.423, Global test loss: 1.486, Global test accuracy: 53.13
Round  81, Train loss: 0.491, Test loss: 1.295, Test accuracy: 61.69
Round  81, Global train loss: 0.491, Global test loss: 1.453, Global test accuracy: 53.65
Round  82, Train loss: 0.439, Test loss: 1.265, Test accuracy: 62.14
Round  82, Global train loss: 0.439, Global test loss: 1.501, Global test accuracy: 57.26
Round  83, Train loss: 0.359, Test loss: 1.278, Test accuracy: 62.45
Round  83, Global train loss: 0.359, Global test loss: 1.377, Global test accuracy: 60.96
Round  84, Train loss: 0.432, Test loss: 1.284, Test accuracy: 62.31
Round  84, Global train loss: 0.432, Global test loss: 1.297, Global test accuracy: 61.73
Round  85, Train loss: 0.331, Test loss: 1.277, Test accuracy: 62.55
Round  85, Global train loss: 0.331, Global test loss: 1.508, Global test accuracy: 57.33
Round  86, Train loss: 0.474, Test loss: 1.319, Test accuracy: 62.37
Round  86, Global train loss: 0.474, Global test loss: 1.287, Global test accuracy: 59.85
Round  87, Train loss: 0.368, Test loss: 1.385, Test accuracy: 61.72
Round  87, Global train loss: 0.368, Global test loss: 1.376, Global test accuracy: 58.29
Round  88, Train loss: 0.334, Test loss: 1.375, Test accuracy: 61.72
Round  88, Global train loss: 0.334, Global test loss: 1.500, Global test accuracy: 57.69
Round  89, Train loss: 0.419, Test loss: 1.417, Test accuracy: 61.65
Round  89, Global train loss: 0.419, Global test loss: 1.281, Global test accuracy: 61.80
Round  90, Train loss: 0.290, Test loss: 1.450, Test accuracy: 60.95
Round  90, Global train loss: 0.290, Global test loss: 1.463, Global test accuracy: 56.81
Round  91, Train loss: 0.496, Test loss: 1.452, Test accuracy: 61.41
Round  91, Global train loss: 0.496, Global test loss: 1.286, Global test accuracy: 60.71
Round  92, Train loss: 0.413, Test loss: 1.423, Test accuracy: 61.42
Round  92, Global train loss: 0.413, Global test loss: 1.287, Global test accuracy: 61.56
Round  93, Train loss: 0.407, Test loss: 1.422, Test accuracy: 62.03
Round  93, Global train loss: 0.407, Global test loss: 1.298, Global test accuracy: 61.01
Round  94, Train loss: 0.477, Test loss: 1.466, Test accuracy: 62.02
Round  94, Global train loss: 0.477, Global test loss: 1.553, Global test accuracy: 58.08
Round  95, Train loss: 0.391, Test loss: 1.488, Test accuracy: 61.40
Round  95, Global train loss: 0.391, Global test loss: 1.483, Global test accuracy: 57.26
Round  96, Train loss: 0.470, Test loss: 1.518, Test accuracy: 61.23
Round  96, Global train loss: 0.470, Global test loss: 1.352, Global test accuracy: 59.95
Round  97, Train loss: 0.461, Test loss: 1.475, Test accuracy: 61.59
Round  97, Global train loss: 0.461, Global test loss: 1.359, Global test accuracy: 59.13
Round  98, Train loss: 0.370, Test loss: 1.482, Test accuracy: 61.34
Round  98, Global train loss: 0.370, Global test loss: 1.708, Global test accuracy: 55.95
Round  99, Train loss: 0.399, Test loss: 1.510, Test accuracy: 60.83
Round  99, Global train loss: 0.399, Global test loss: 1.642, Global test accuracy: 54.72
Final Round, Train loss: 0.306, Test loss: 1.669, Test accuracy: 61.89
Final Round, Global train loss: 0.306, Global test loss: 1.642, Global test accuracy: 54.72
Average accuracy final 10 rounds: 61.422
Average global accuracy final 10 rounds: 58.517999999999994
2537.6443779468536
[3.450688123703003, 6.527843475341797, 9.743983268737793, 12.798343420028687, 16.1642165184021, 19.48311161994934, 22.839812994003296, 26.23820996284485, 29.64117431640625, 32.966357707977295, 36.22990345954895, 39.8000066280365, 43.04625654220581, 46.45360517501831, 49.67364025115967, 52.73646330833435, 55.8797287940979, 58.948840379714966, 62.0805938243866, 65.13653445243835, 68.20185327529907, 71.25123023986816, 74.37499189376831, 77.43112015724182, 80.4883382320404, 83.69723296165466, 86.7579185962677, 89.81121897697449, 92.83137059211731, 95.8483190536499, 98.93133521080017, 101.97557926177979, 105.01456451416016, 108.14011073112488, 111.22739219665527, 114.26379418373108, 117.34081029891968, 120.42864441871643, 123.54954528808594, 126.64607405662537, 129.8158175945282, 132.89442777633667, 135.99864840507507, 139.04614114761353, 142.1614339351654, 145.3035979270935, 148.43234705924988, 151.5248692035675, 154.66007494926453, 157.68844556808472, 160.74736166000366, 163.86128854751587, 167.01210618019104, 170.1138379573822, 173.26587200164795, 176.42077016830444, 179.47784876823425, 182.53458714485168, 185.6320869922638, 188.77074027061462, 191.86072492599487, 194.94574213027954, 197.98979902267456, 201.0892026424408, 204.1577250957489, 207.26249170303345, 210.4501016139984, 213.54336285591125, 216.5792043209076, 219.66264033317566, 222.7899751663208, 225.86567306518555, 228.9864022731781, 232.06532192230225, 235.12608742713928, 238.16894602775574, 241.2699010372162, 244.45425581932068, 247.51133108139038, 250.59765601158142, 253.73202276229858, 256.9236466884613, 260.0157823562622, 263.1309871673584, 266.21314883232117, 269.3250107765198, 272.39761686325073, 275.49906873703003, 278.6027612686157, 281.6869387626648, 284.74913454055786, 287.8231978416443, 290.97693371772766, 294.09778666496277, 297.1896924972534, 300.21154522895813, 303.32629799842834, 306.42177414894104, 309.5483283996582, 312.66536712646484, 318.1235864162445]
[23.93, 32.8, 38.35, 39.88, 41.81, 46.0, 47.14, 47.1, 47.51, 48.42, 48.77, 49.48, 49.54, 50.72, 50.46, 50.82, 52.23, 52.62, 53.59, 53.82, 53.9, 54.29, 54.74, 54.07, 53.84, 54.82, 55.23, 56.35, 56.48, 56.55, 56.61, 56.61, 56.67, 57.78, 57.29, 57.64, 57.08, 57.42, 57.18, 57.67, 58.23, 58.91, 58.92, 59.28, 59.26, 59.14, 60.07, 59.0, 59.61, 59.95, 59.58, 60.28, 60.35, 60.23, 60.16, 60.91, 60.62, 60.76, 61.18, 61.02, 61.39, 60.65, 60.7, 61.37, 61.44, 61.73, 61.76, 62.31, 61.91, 62.16, 62.04, 62.01, 61.69, 61.8, 62.02, 62.23, 61.63, 61.85, 61.34, 61.34, 61.22, 61.69, 62.14, 62.45, 62.31, 62.55, 62.37, 61.72, 61.72, 61.65, 60.95, 61.41, 61.42, 62.03, 62.02, 61.4, 61.23, 61.59, 61.34, 60.83, 61.89]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 0, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 2.009, Test loss: 2.174, Test accuracy: 23.96
Round   1, Train loss: 1.631, Test loss: 2.051, Test accuracy: 24.36
Round   2, Train loss: 1.593, Test loss: 1.805, Test accuracy: 33.72
Round   3, Train loss: 1.378, Test loss: 1.678, Test accuracy: 36.52
Round   4, Train loss: 1.441, Test loss: 1.532, Test accuracy: 40.24
Round   5, Train loss: 1.256, Test loss: 1.408, Test accuracy: 44.42
Round   6, Train loss: 1.267, Test loss: 1.350, Test accuracy: 46.84
Round   7, Train loss: 1.301, Test loss: 1.302, Test accuracy: 48.19
Round   8, Train loss: 1.192, Test loss: 1.263, Test accuracy: 50.05
Round   9, Train loss: 1.089, Test loss: 1.226, Test accuracy: 52.20
Round  10, Train loss: 1.185, Test loss: 1.216, Test accuracy: 52.63
Round  11, Train loss: 1.033, Test loss: 1.201, Test accuracy: 52.96
Round  12, Train loss: 1.104, Test loss: 1.199, Test accuracy: 52.32
Round  13, Train loss: 1.074, Test loss: 1.191, Test accuracy: 52.63
Round  14, Train loss: 1.120, Test loss: 1.164, Test accuracy: 55.10
Round  15, Train loss: 1.137, Test loss: 1.167, Test accuracy: 54.97
Round  16, Train loss: 0.917, Test loss: 1.139, Test accuracy: 55.25
Round  17, Train loss: 0.996, Test loss: 1.128, Test accuracy: 55.55
Round  18, Train loss: 0.975, Test loss: 1.118, Test accuracy: 56.12
Round  19, Train loss: 1.023, Test loss: 1.112, Test accuracy: 56.39
Round  20, Train loss: 0.901, Test loss: 1.108, Test accuracy: 56.29
Round  21, Train loss: 0.851, Test loss: 1.085, Test accuracy: 57.00
Round  22, Train loss: 1.011, Test loss: 1.072, Test accuracy: 57.42
Round  23, Train loss: 0.918, Test loss: 1.070, Test accuracy: 57.08
Round  24, Train loss: 0.862, Test loss: 1.050, Test accuracy: 58.19
Round  25, Train loss: 0.938, Test loss: 1.041, Test accuracy: 58.37
Round  26, Train loss: 0.842, Test loss: 1.040, Test accuracy: 58.41
Round  27, Train loss: 0.906, Test loss: 1.035, Test accuracy: 58.75
Round  28, Train loss: 0.863, Test loss: 1.017, Test accuracy: 59.32
Round  29, Train loss: 0.938, Test loss: 1.022, Test accuracy: 59.11
Round  30, Train loss: 0.710, Test loss: 1.026, Test accuracy: 58.98
Round  31, Train loss: 1.005, Test loss: 1.023, Test accuracy: 59.47
Round  32, Train loss: 0.975, Test loss: 1.011, Test accuracy: 59.57
Round  33, Train loss: 0.883, Test loss: 1.008, Test accuracy: 59.99
Round  34, Train loss: 0.842, Test loss: 1.013, Test accuracy: 60.10
Round  35, Train loss: 0.810, Test loss: 1.001, Test accuracy: 60.52
Round  36, Train loss: 0.863, Test loss: 1.010, Test accuracy: 60.67
Round  37, Train loss: 0.827, Test loss: 1.005, Test accuracy: 60.92
Round  38, Train loss: 0.688, Test loss: 1.011, Test accuracy: 60.71
Round  39, Train loss: 0.742, Test loss: 0.992, Test accuracy: 61.16
Round  40, Train loss: 0.704, Test loss: 0.991, Test accuracy: 61.35
Round  41, Train loss: 0.701, Test loss: 0.996, Test accuracy: 60.84
Round  42, Train loss: 0.664, Test loss: 0.988, Test accuracy: 61.15
Round  43, Train loss: 0.853, Test loss: 0.981, Test accuracy: 61.42
Round  44, Train loss: 0.653, Test loss: 0.973, Test accuracy: 61.45
Round  45, Train loss: 0.646, Test loss: 0.963, Test accuracy: 61.98
Round  46, Train loss: 0.748, Test loss: 0.952, Test accuracy: 62.31
Round  47, Train loss: 0.764, Test loss: 0.947, Test accuracy: 62.87
Round  48, Train loss: 0.754, Test loss: 0.960, Test accuracy: 62.81
Round  49, Train loss: 0.741, Test loss: 0.944, Test accuracy: 62.91
Round  50, Train loss: 0.667, Test loss: 0.950, Test accuracy: 62.75
Round  51, Train loss: 0.726, Test loss: 0.961, Test accuracy: 62.80
Round  52, Train loss: 0.718, Test loss: 0.946, Test accuracy: 62.82
Round  53, Train loss: 0.798, Test loss: 0.934, Test accuracy: 63.30
Round  54, Train loss: 0.726, Test loss: 0.924, Test accuracy: 63.45
Round  55, Train loss: 0.742, Test loss: 0.947, Test accuracy: 63.21
Round  56, Train loss: 0.746, Test loss: 0.942, Test accuracy: 63.05
Round  57, Train loss: 0.601, Test loss: 0.950, Test accuracy: 63.32
Round  58, Train loss: 0.769, Test loss: 0.938, Test accuracy: 63.41
Round  59, Train loss: 0.599, Test loss: 0.951, Test accuracy: 63.29
Round  60, Train loss: 0.590, Test loss: 0.936, Test accuracy: 63.57
Round  61, Train loss: 0.600, Test loss: 0.934, Test accuracy: 63.60
Round  62, Train loss: 0.606, Test loss: 0.924, Test accuracy: 64.15
Round  63, Train loss: 0.556, Test loss: 0.920, Test accuracy: 64.55
Round  64, Train loss: 0.517, Test loss: 0.942, Test accuracy: 64.01
Round  65, Train loss: 0.630, Test loss: 0.933, Test accuracy: 64.29
Round  66, Train loss: 0.625, Test loss: 0.932, Test accuracy: 63.98
Round  67, Train loss: 0.674, Test loss: 0.924, Test accuracy: 64.24
Round  68, Train loss: 0.645, Test loss: 0.939, Test accuracy: 64.08
Round  69, Train loss: 0.606, Test loss: 0.928, Test accuracy: 64.31
Round  70, Train loss: 0.677, Test loss: 0.942, Test accuracy: 64.19
Round  71, Train loss: 0.572, Test loss: 0.936, Test accuracy: 64.01
Round  72, Train loss: 0.494, Test loss: 0.947, Test accuracy: 64.24
Round  73, Train loss: 0.521, Test loss: 0.936, Test accuracy: 64.51
Round  74, Train loss: 0.624, Test loss: 0.927, Test accuracy: 64.80
Round  75, Train loss: 0.729, Test loss: 0.933, Test accuracy: 64.50
Round  76, Train loss: 0.540, Test loss: 0.937, Test accuracy: 65.21
Round  77, Train loss: 0.519, Test loss: 0.934, Test accuracy: 64.75
Round  78, Train loss: 0.548, Test loss: 0.929, Test accuracy: 64.76
Round  79, Train loss: 0.455, Test loss: 0.921, Test accuracy: 64.95
Round  80, Train loss: 0.539, Test loss: 0.926, Test accuracy: 64.69
Round  81, Train loss: 0.517, Test loss: 0.926, Test accuracy: 64.86
Round  82, Train loss: 0.445, Test loss: 0.939, Test accuracy: 64.63
Round  83, Train loss: 0.505, Test loss: 0.930, Test accuracy: 64.57
Round  84, Train loss: 0.518, Test loss: 0.932, Test accuracy: 64.81
Round  85, Train loss: 0.494, Test loss: 0.944, Test accuracy: 64.58
Round  86, Train loss: 0.496, Test loss: 0.929, Test accuracy: 65.30
Round  87, Train loss: 0.389, Test loss: 0.926, Test accuracy: 65.05
Round  88, Train loss: 0.595, Test loss: 0.920, Test accuracy: 64.92
Round  89, Train loss: 0.487, Test loss: 0.923, Test accuracy: 65.65
Round  90, Train loss: 0.516, Test loss: 0.935, Test accuracy: 65.12
Round  91, Train loss: 0.511, Test loss: 0.946, Test accuracy: 64.99
Round  92, Train loss: 0.470, Test loss: 0.951, Test accuracy: 65.31
Round  93, Train loss: 0.507, Test loss: 0.961, Test accuracy: 64.91
Round  94, Train loss: 0.473, Test loss: 0.927, Test accuracy: 65.47
Round  95, Train loss: 0.472, Test loss: 0.931, Test accuracy: 65.55
Round  96, Train loss: 0.391, Test loss: 0.953, Test accuracy: 65.11
Round  97, Train loss: 0.500, Test loss: 0.946, Test accuracy: 65.51
Round  98, Train loss: 0.388, Test loss: 0.938, Test accuracy: 65.78
Round  99, Train loss: 0.481, Test loss: 0.929, Test accuracy: 66.09
Final Round, Train loss: 0.400, Test loss: 0.956, Test accuracy: 66.08
Average accuracy final 10 rounds: 65.384
1261.6395318508148
[2.0124239921569824, 3.5475218296051025, 5.147130012512207, 6.706775665283203, 8.286038398742676, 9.85530710220337, 11.391937017440796, 12.920318603515625, 14.469418048858643, 15.998065710067749, 17.513341188430786, 19.1148841381073, 20.6569766998291, 22.201892852783203, 23.741007804870605, 25.35381269454956, 26.894298315048218, 28.434686183929443, 30.027490377426147, 31.562241077423096, 33.10003185272217, 34.65024542808533, 36.22390365600586, 37.74615979194641, 39.2779335975647, 40.83151149749756, 42.42526078224182, 43.9422562122345, 45.483994245529175, 47.02411651611328, 48.56670951843262, 50.11874008178711, 51.66088366508484, 53.21708798408508, 54.74563145637512, 56.30049204826355, 57.89873266220093, 59.46338224411011, 61.0079984664917, 62.54866147041321, 64.0944995880127, 65.62627983093262, 67.17398238182068, 68.71530628204346, 70.26925539970398, 71.8231348991394, 73.3345935344696, 74.92143034934998, 76.4693992137909, 78.02755784988403, 79.56455326080322, 81.10418248176575, 82.68268299102783, 84.22490239143372, 85.79046154022217, 87.35184907913208, 88.90668749809265, 90.4619493484497, 92.00053715705872, 93.52811908721924, 95.05424976348877, 96.63365173339844, 98.20873761177063, 99.74015974998474, 101.29169011116028, 102.84033179283142, 104.36603236198425, 105.91955399513245, 107.44504904747009, 108.97666835784912, 110.51922845840454, 112.05412936210632, 113.58926391601562, 115.1144449710846, 116.63289093971252, 118.19123888015747, 119.77531361579895, 121.31354928016663, 122.82837986946106, 124.37437009811401, 125.89625072479248, 127.53465366363525, 129.0976481437683, 130.67486429214478, 132.2213180065155, 133.8175082206726, 135.37040734291077, 136.94517350196838, 138.52119159698486, 140.0915925502777, 141.6786916255951, 143.20378494262695, 144.7549011707306, 146.3130326271057, 147.87746500968933, 149.4229040145874, 150.9608871936798, 152.5307698249817, 154.08474206924438, 155.6241056919098, 158.12029504776]
[23.96, 24.36, 33.72, 36.52, 40.24, 44.42, 46.84, 48.19, 50.05, 52.2, 52.63, 52.96, 52.32, 52.63, 55.1, 54.97, 55.25, 55.55, 56.12, 56.39, 56.29, 57.0, 57.42, 57.08, 58.19, 58.37, 58.41, 58.75, 59.32, 59.11, 58.98, 59.47, 59.57, 59.99, 60.1, 60.52, 60.67, 60.92, 60.71, 61.16, 61.35, 60.84, 61.15, 61.42, 61.45, 61.98, 62.31, 62.87, 62.81, 62.91, 62.75, 62.8, 62.82, 63.3, 63.45, 63.21, 63.05, 63.32, 63.41, 63.29, 63.57, 63.6, 64.15, 64.55, 64.01, 64.29, 63.98, 64.24, 64.08, 64.31, 64.19, 64.01, 64.24, 64.51, 64.8, 64.5, 65.21, 64.75, 64.76, 64.95, 64.69, 64.86, 64.63, 64.57, 64.81, 64.58, 65.3, 65.05, 64.92, 65.65, 65.12, 64.99, 65.31, 64.91, 65.47, 65.55, 65.11, 65.51, 65.78, 66.09, 66.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.963, Test loss: 2.183, Test accuracy: 17.62
Round   1, Train loss: 1.589, Test loss: 2.036, Test accuracy: 28.74
Round   2, Train loss: 1.513, Test loss: 1.763, Test accuracy: 36.86
Round   3, Train loss: 1.313, Test loss: 1.520, Test accuracy: 41.76
Round   4, Train loss: 1.393, Test loss: 1.430, Test accuracy: 45.89
Round   5, Train loss: 1.285, Test loss: 1.295, Test accuracy: 50.00
Round   6, Train loss: 1.218, Test loss: 1.255, Test accuracy: 50.90
Round   7, Train loss: 1.242, Test loss: 1.229, Test accuracy: 51.28
Round   8, Train loss: 1.104, Test loss: 1.182, Test accuracy: 53.68
Round   9, Train loss: 1.156, Test loss: 1.177, Test accuracy: 53.07
Round  10, Train loss: 1.212, Test loss: 1.179, Test accuracy: 53.17
Round  11, Train loss: 1.062, Test loss: 1.153, Test accuracy: 53.34
Round  12, Train loss: 1.012, Test loss: 1.140, Test accuracy: 54.56
Round  13, Train loss: 1.032, Test loss: 1.116, Test accuracy: 55.84
Round  14, Train loss: 1.108, Test loss: 1.123, Test accuracy: 55.01
Round  15, Train loss: 1.019, Test loss: 1.095, Test accuracy: 56.12
Round  16, Train loss: 0.995, Test loss: 1.073, Test accuracy: 56.81
Round  17, Train loss: 1.007, Test loss: 1.065, Test accuracy: 56.74
Round  18, Train loss: 0.969, Test loss: 1.072, Test accuracy: 57.30
Round  19, Train loss: 0.877, Test loss: 1.049, Test accuracy: 58.42
Round  20, Train loss: 0.942, Test loss: 1.045, Test accuracy: 58.75
Round  21, Train loss: 0.922, Test loss: 1.034, Test accuracy: 59.23
Round  22, Train loss: 0.910, Test loss: 1.021, Test accuracy: 59.34
Round  23, Train loss: 0.946, Test loss: 1.013, Test accuracy: 59.72
Round  24, Train loss: 0.805, Test loss: 1.014, Test accuracy: 59.70
Round  25, Train loss: 1.130, Test loss: 0.987, Test accuracy: 60.12
Round  26, Train loss: 0.824, Test loss: 0.986, Test accuracy: 60.76
Round  27, Train loss: 0.848, Test loss: 0.974, Test accuracy: 61.83
Round  28, Train loss: 0.861, Test loss: 0.992, Test accuracy: 61.33
Round  29, Train loss: 0.827, Test loss: 0.994, Test accuracy: 61.53
Round  30, Train loss: 0.859, Test loss: 0.971, Test accuracy: 61.60
Round  31, Train loss: 0.828, Test loss: 0.971, Test accuracy: 61.24
Round  32, Train loss: 0.810, Test loss: 0.956, Test accuracy: 62.64
Round  33, Train loss: 0.938, Test loss: 0.951, Test accuracy: 62.73
Round  34, Train loss: 0.826, Test loss: 0.958, Test accuracy: 62.34
Round  35, Train loss: 0.731, Test loss: 0.941, Test accuracy: 63.18
Round  36, Train loss: 0.749, Test loss: 0.939, Test accuracy: 63.39
Round  37, Train loss: 0.954, Test loss: 0.922, Test accuracy: 64.08
Round  38, Train loss: 0.840, Test loss: 0.908, Test accuracy: 64.20
Round  39, Train loss: 0.671, Test loss: 0.910, Test accuracy: 63.77
Round  40, Train loss: 0.801, Test loss: 0.899, Test accuracy: 64.42
Round  41, Train loss: 0.629, Test loss: 0.903, Test accuracy: 63.82
Round  42, Train loss: 0.618, Test loss: 0.895, Test accuracy: 64.70
Round  43, Train loss: 0.762, Test loss: 0.890, Test accuracy: 64.90
Round  44, Train loss: 0.769, Test loss: 0.901, Test accuracy: 64.55
Round  45, Train loss: 0.706, Test loss: 0.901, Test accuracy: 64.42
Round  46, Train loss: 0.711, Test loss: 0.894, Test accuracy: 65.01
Round  47, Train loss: 0.764, Test loss: 0.889, Test accuracy: 64.90
Round  48, Train loss: 0.656, Test loss: 0.890, Test accuracy: 64.87
Round  49, Train loss: 0.665, Test loss: 0.894, Test accuracy: 64.85
Round  50, Train loss: 0.601, Test loss: 0.892, Test accuracy: 64.86
Round  51, Train loss: 0.638, Test loss: 0.884, Test accuracy: 65.20
Round  52, Train loss: 0.708, Test loss: 0.869, Test accuracy: 65.66
Round  53, Train loss: 0.626, Test loss: 0.872, Test accuracy: 65.56
Round  54, Train loss: 0.693, Test loss: 0.859, Test accuracy: 66.02
Round  55, Train loss: 0.642, Test loss: 0.858, Test accuracy: 65.66
Round  56, Train loss: 0.705, Test loss: 0.854, Test accuracy: 66.26
Round  57, Train loss: 0.626, Test loss: 0.855, Test accuracy: 66.03
Round  58, Train loss: 0.651, Test loss: 0.872, Test accuracy: 65.88
Round  59, Train loss: 0.648, Test loss: 0.875, Test accuracy: 65.66
Round  60, Train loss: 0.587, Test loss: 0.878, Test accuracy: 65.57
Round  61, Train loss: 0.741, Test loss: 0.870, Test accuracy: 66.22
Round  62, Train loss: 0.602, Test loss: 0.868, Test accuracy: 66.70
Round  63, Train loss: 0.624, Test loss: 0.862, Test accuracy: 66.64
Round  64, Train loss: 0.593, Test loss: 0.857, Test accuracy: 66.55
Round  65, Train loss: 0.696, Test loss: 0.852, Test accuracy: 67.07
Round  66, Train loss: 0.627, Test loss: 0.845, Test accuracy: 67.27
Round  67, Train loss: 0.571, Test loss: 0.852, Test accuracy: 67.06
Round  68, Train loss: 0.716, Test loss: 0.854, Test accuracy: 67.15
Round  69, Train loss: 0.633, Test loss: 0.858, Test accuracy: 66.47
Round  70, Train loss: 0.646, Test loss: 0.842, Test accuracy: 67.15
Round  71, Train loss: 0.516, Test loss: 0.851, Test accuracy: 67.46
Round  72, Train loss: 0.590, Test loss: 0.836, Test accuracy: 67.63
Round  73, Train loss: 0.511, Test loss: 0.847, Test accuracy: 67.41
Round  74, Train loss: 0.538, Test loss: 0.848, Test accuracy: 67.14
Round  75, Train loss: 0.514, Test loss: 0.852, Test accuracy: 67.51
Round  76, Train loss: 0.558, Test loss: 0.846, Test accuracy: 67.88
Round  77, Train loss: 0.583, Test loss: 0.835, Test accuracy: 67.63
Round  78, Train loss: 0.484, Test loss: 0.831, Test accuracy: 67.64
Round  79, Train loss: 0.436, Test loss: 0.826, Test accuracy: 67.94
Round  80, Train loss: 0.467, Test loss: 0.841, Test accuracy: 67.30
Round  81, Train loss: 0.561, Test loss: 0.848, Test accuracy: 67.54
Round  82, Train loss: 0.506, Test loss: 0.847, Test accuracy: 67.64
Round  83, Train loss: 0.483, Test loss: 0.846, Test accuracy: 67.26
Round  84, Train loss: 0.546, Test loss: 0.830, Test accuracy: 68.09
Round  85, Train loss: 0.431, Test loss: 0.832, Test accuracy: 67.99
Round  86, Train loss: 0.633, Test loss: 0.854, Test accuracy: 67.72
Round  87, Train loss: 0.597, Test loss: 0.846, Test accuracy: 68.00
Round  88, Train loss: 0.390, Test loss: 0.861, Test accuracy: 67.73
Round  89, Train loss: 0.478, Test loss: 0.856, Test accuracy: 67.80
Round  90, Train loss: 0.453, Test loss: 0.863, Test accuracy: 68.04
Round  91, Train loss: 0.613, Test loss: 0.858, Test accuracy: 67.95
Round  92, Train loss: 0.405, Test loss: 0.867, Test accuracy: 67.95
Round  93, Train loss: 0.485, Test loss: 0.863, Test accuracy: 68.04
Round  94, Train loss: 0.406, Test loss: 0.854, Test accuracy: 68.24
Round  95, Train loss: 0.539, Test loss: 0.840, Test accuracy: 68.41
Round  96, Train loss: 0.459, Test loss: 0.835, Test accuracy: 68.51
Round  97, Train loss: 0.424, Test loss: 0.841, Test accuracy: 68.69
Round  98, Train loss: 0.456, Test loss: 0.847, Test accuracy: 68.44
Round  99, Train loss: 0.414, Test loss: 0.860, Test accuracy: 68.24
Final Round, Train loss: 0.391, Test loss: 0.867, Test accuracy: 68.54
Average accuracy final 10 rounds: 68.251
1746.7960090637207
[1.8941035270690918, 3.416980028152466, 4.9406726360321045, 6.476947069168091, 8.008538246154785, 9.50564455986023, 11.066484451293945, 12.634109020233154, 14.143712282180786, 15.704204797744751, 17.23017907142639, 18.737346410751343, 20.278295755386353, 21.815749883651733, 23.40064239501953, 24.935789585113525, 26.464473962783813, 28.001800298690796, 29.504806995391846, 31.052043437957764, 32.559810400009155, 35.28485035896301, 37.86369252204895, 40.53514885902405, 43.14567041397095, 45.84147763252258, 48.48636841773987, 51.11881113052368, 53.747188568115234, 56.44051957130432, 59.14230465888977, 61.800130128860474, 64.42890405654907, 67.09745025634766, 69.72848176956177, 72.43499183654785, 74.99820446968079, 77.61094355583191, 80.20405673980713, 82.87609505653381, 85.52407383918762, 88.23233342170715, 90.91013169288635, 93.59742569923401, 96.20931506156921, 98.93952202796936, 101.60472583770752, 104.18108701705933, 106.84033060073853, 109.43422269821167, 112.11025834083557, 114.6737310886383, 117.30738115310669, 119.96043634414673, 122.65552949905396, 125.34707045555115, 127.99857354164124, 130.63424158096313, 133.34047055244446, 136.07209300994873, 138.66024208068848, 141.33671736717224, 144.03320980072021, 146.64620637893677, 149.42911744117737, 152.07920932769775, 154.7656979560852, 157.40363907814026, 160.04149413108826, 162.6895785331726, 165.33757138252258, 167.99262499809265, 170.54447627067566, 173.21088433265686, 175.82993364334106, 178.48033165931702, 181.11145758628845, 183.83117651939392, 186.4910786151886, 189.20639777183533, 191.8560652732849, 194.54124307632446, 197.2056758403778, 199.9759225845337, 202.66211462020874, 205.2684624195099, 207.9553349018097, 210.63898158073425, 213.34207344055176, 215.91220378875732, 218.55708360671997, 221.151704788208, 223.81893873214722, 226.49287581443787, 229.10486793518066, 231.77749967575073, 234.50016450881958, 237.29787492752075, 240.05215883255005, 242.71838974952698, 245.16946291923523]
[17.62, 28.74, 36.86, 41.76, 45.89, 50.0, 50.9, 51.28, 53.68, 53.07, 53.17, 53.34, 54.56, 55.84, 55.01, 56.12, 56.81, 56.74, 57.3, 58.42, 58.75, 59.23, 59.34, 59.72, 59.7, 60.12, 60.76, 61.83, 61.33, 61.53, 61.6, 61.24, 62.64, 62.73, 62.34, 63.18, 63.39, 64.08, 64.2, 63.77, 64.42, 63.82, 64.7, 64.9, 64.55, 64.42, 65.01, 64.9, 64.87, 64.85, 64.86, 65.2, 65.66, 65.56, 66.02, 65.66, 66.26, 66.03, 65.88, 65.66, 65.57, 66.22, 66.7, 66.64, 66.55, 67.07, 67.27, 67.06, 67.15, 66.47, 67.15, 67.46, 67.63, 67.41, 67.14, 67.51, 67.88, 67.63, 67.64, 67.94, 67.3, 67.54, 67.64, 67.26, 68.09, 67.99, 67.72, 68.0, 67.73, 67.8, 68.04, 67.95, 67.95, 68.04, 68.24, 68.41, 68.51, 68.69, 68.44, 68.24, 68.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.733, Test loss: 2.137, Test accuracy: 13.70
Round   1, Train loss: 1.467, Test loss: 1.904, Test accuracy: 31.26
Round   2, Train loss: 1.265, Test loss: 1.572, Test accuracy: 38.03
Round   3, Train loss: 1.099, Test loss: 1.358, Test accuracy: 47.06
Round   4, Train loss: 1.099, Test loss: 1.296, Test accuracy: 48.90
Round   5, Train loss: 1.154, Test loss: 1.223, Test accuracy: 50.56
Round   6, Train loss: 1.018, Test loss: 1.201, Test accuracy: 51.91
Round   7, Train loss: 1.099, Test loss: 1.179, Test accuracy: 52.35
Round   8, Train loss: 0.903, Test loss: 1.153, Test accuracy: 52.97
Round   9, Train loss: 0.942, Test loss: 1.144, Test accuracy: 53.81
Round  10, Train loss: 0.915, Test loss: 1.134, Test accuracy: 54.81
Round  11, Train loss: 0.921, Test loss: 1.129, Test accuracy: 54.50
Round  12, Train loss: 0.982, Test loss: 1.120, Test accuracy: 54.69
Round  13, Train loss: 0.779, Test loss: 1.101, Test accuracy: 55.68
Round  14, Train loss: 0.846, Test loss: 1.061, Test accuracy: 56.32
Round  15, Train loss: 0.820, Test loss: 1.052, Test accuracy: 57.04
Round  16, Train loss: 0.692, Test loss: 1.036, Test accuracy: 57.87
Round  17, Train loss: 0.690, Test loss: 1.020, Test accuracy: 58.58
Round  18, Train loss: 0.693, Test loss: 1.025, Test accuracy: 58.36
Round  19, Train loss: 0.696, Test loss: 1.020, Test accuracy: 59.34
Round  20, Train loss: 0.649, Test loss: 1.005, Test accuracy: 60.32
Round  21, Train loss: 0.656, Test loss: 1.014, Test accuracy: 60.15
Round  22, Train loss: 0.850, Test loss: 1.013, Test accuracy: 59.96
Round  23, Train loss: 0.699, Test loss: 1.006, Test accuracy: 59.91
Round  24, Train loss: 0.597, Test loss: 1.010, Test accuracy: 60.89
Round  25, Train loss: 0.653, Test loss: 0.999, Test accuracy: 61.07
Round  26, Train loss: 0.603, Test loss: 1.011, Test accuracy: 60.56
Round  27, Train loss: 0.712, Test loss: 1.070, Test accuracy: 60.56
Round  28, Train loss: 0.568, Test loss: 1.043, Test accuracy: 60.91
Round  29, Train loss: 0.600, Test loss: 1.036, Test accuracy: 60.84
Round  30, Train loss: 0.563, Test loss: 1.006, Test accuracy: 61.86
Round  31, Train loss: 0.573, Test loss: 1.006, Test accuracy: 61.67
Round  32, Train loss: 0.579, Test loss: 1.052, Test accuracy: 60.98
Round  33, Train loss: 0.592, Test loss: 1.055, Test accuracy: 61.74
Round  34, Train loss: 0.444, Test loss: 1.065, Test accuracy: 61.35
Round  35, Train loss: 0.516, Test loss: 1.028, Test accuracy: 62.35
Round  36, Train loss: 0.431, Test loss: 1.037, Test accuracy: 62.42
Round  37, Train loss: 0.464, Test loss: 1.038, Test accuracy: 62.51
Round  38, Train loss: 0.558, Test loss: 1.012, Test accuracy: 62.40
Round  39, Train loss: 0.480, Test loss: 1.039, Test accuracy: 62.72
Round  40, Train loss: 0.499, Test loss: 1.002, Test accuracy: 63.17
Round  41, Train loss: 0.550, Test loss: 1.009, Test accuracy: 62.79
Round  42, Train loss: 0.414, Test loss: 1.015, Test accuracy: 63.20
Round  43, Train loss: 0.393, Test loss: 1.015, Test accuracy: 63.19
Round  44, Train loss: 0.477, Test loss: 1.002, Test accuracy: 63.12
Round  45, Train loss: 0.488, Test loss: 1.015, Test accuracy: 63.38
Round  46, Train loss: 0.396, Test loss: 0.980, Test accuracy: 64.20
Round  47, Train loss: 0.389, Test loss: 0.999, Test accuracy: 63.75
Round  48, Train loss: 0.367, Test loss: 1.008, Test accuracy: 63.53
Round  49, Train loss: 0.472, Test loss: 1.012, Test accuracy: 64.13
Round  50, Train loss: 0.356, Test loss: 1.006, Test accuracy: 63.96
Round  51, Train loss: 0.418, Test loss: 1.017, Test accuracy: 64.82
Round  52, Train loss: 0.341, Test loss: 1.012, Test accuracy: 64.37
Round  53, Train loss: 0.515, Test loss: 1.042, Test accuracy: 63.51
Round  54, Train loss: 0.384, Test loss: 1.025, Test accuracy: 64.01
Round  55, Train loss: 0.383, Test loss: 1.037, Test accuracy: 63.84
Round  56, Train loss: 0.396, Test loss: 1.030, Test accuracy: 64.21
Round  57, Train loss: 0.377, Test loss: 1.075, Test accuracy: 64.10
Round  58, Train loss: 0.428, Test loss: 1.044, Test accuracy: 64.34
Round  59, Train loss: 0.361, Test loss: 1.062, Test accuracy: 64.21
Round  60, Train loss: 0.356, Test loss: 1.059, Test accuracy: 64.68
Round  61, Train loss: 0.341, Test loss: 1.054, Test accuracy: 64.70
Round  62, Train loss: 0.353, Test loss: 1.049, Test accuracy: 64.73
Round  63, Train loss: 0.361, Test loss: 1.048, Test accuracy: 64.66
Round  64, Train loss: 0.340, Test loss: 1.055, Test accuracy: 65.11
Round  65, Train loss: 0.362, Test loss: 1.095, Test accuracy: 64.80
Round  66, Train loss: 0.402, Test loss: 1.091, Test accuracy: 64.56
Round  67, Train loss: 0.396, Test loss: 1.075, Test accuracy: 64.91
Round  68, Train loss: 0.346, Test loss: 1.106, Test accuracy: 64.30
Round  69, Train loss: 0.332, Test loss: 1.106, Test accuracy: 64.34
Round  70, Train loss: 0.301, Test loss: 1.096, Test accuracy: 64.39
Round  71, Train loss: 0.335, Test loss: 1.124, Test accuracy: 63.85
Round  72, Train loss: 0.387, Test loss: 1.122, Test accuracy: 63.79
Round  73, Train loss: 0.299, Test loss: 1.086, Test accuracy: 64.42
Round  74, Train loss: 0.357, Test loss: 1.115, Test accuracy: 64.60
Round  75, Train loss: 0.304, Test loss: 1.115, Test accuracy: 63.76
Round  76, Train loss: 0.314, Test loss: 1.107, Test accuracy: 64.69
Round  77, Train loss: 0.273, Test loss: 1.127, Test accuracy: 64.75
Round  78, Train loss: 0.291, Test loss: 1.100, Test accuracy: 65.14
Round  79, Train loss: 0.324, Test loss: 1.116, Test accuracy: 64.65
Round  80, Train loss: 0.296, Test loss: 1.157, Test accuracy: 64.25
Round  81, Train loss: 0.299, Test loss: 1.142, Test accuracy: 64.62
Round  82, Train loss: 0.287, Test loss: 1.135, Test accuracy: 64.60
Round  83, Train loss: 0.293, Test loss: 1.121, Test accuracy: 65.11
Round  84, Train loss: 0.263, Test loss: 1.148, Test accuracy: 64.50
Round  85, Train loss: 0.306, Test loss: 1.206, Test accuracy: 64.68
Round  86, Train loss: 0.360, Test loss: 1.205, Test accuracy: 64.21
Round  87, Train loss: 0.236, Test loss: 1.197, Test accuracy: 63.81
Round  88, Train loss: 0.291, Test loss: 1.180, Test accuracy: 64.35
Round  89, Train loss: 0.260, Test loss: 1.147, Test accuracy: 64.98
Round  90, Train loss: 0.227, Test loss: 1.158, Test accuracy: 64.40
Round  91, Train loss: 0.259, Test loss: 1.172, Test accuracy: 64.75
Round  92, Train loss: 0.301, Test loss: 1.180, Test accuracy: 64.90
Round  93, Train loss: 0.308, Test loss: 1.138, Test accuracy: 64.99
Round  94, Train loss: 0.284, Test loss: 1.104, Test accuracy: 65.50
Round  95, Train loss: 0.266, Test loss: 1.104, Test accuracy: 65.44
Round  96, Train loss: 0.249, Test loss: 1.137, Test accuracy: 65.63
Round  97, Train loss: 0.282, Test loss: 1.144, Test accuracy: 65.40
Round  98, Train loss: 0.240, Test loss: 1.180, Test accuracy: 65.12
Round  99, Train loss: 0.232, Test loss: 1.202, Test accuracy: 64.63
Final Round, Train loss: 0.242, Test loss: 1.184, Test accuracy: 65.26
Average accuracy final 10 rounds: 65.076
2306.282892227173
[3.7574679851531982, 6.939037084579468, 10.109402179718018, 13.365112543106079, 16.550386667251587, 19.730777263641357, 22.985750675201416, 26.267150402069092, 29.546414613723755, 32.747931480407715, 36.01181435585022, 39.26530170440674, 42.56186366081238, 45.84117865562439, 49.096693992614746, 52.673932790756226, 55.89608287811279, 59.11124849319458, 62.312033891677856, 65.57520532608032, 68.75852799415588, 71.99097895622253, 75.21101808547974, 78.54959797859192, 81.76202487945557, 84.97508120536804, 88.233473777771, 91.48288321495056, 94.7358078956604, 97.96466302871704, 101.16822719573975, 104.46392035484314, 107.71010994911194, 110.97109794616699, 114.24153161048889, 117.50141549110413, 120.68658804893494, 123.88202905654907, 127.13460445404053, 130.41887068748474, 133.6834580898285, 136.8988800048828, 140.10223627090454, 143.44106483459473, 146.64858222007751, 149.97157502174377, 153.43680357933044, 157.06668734550476, 160.5182695388794, 164.00908255577087, 167.1843843460083, 170.47694659233093, 173.7057752609253, 176.86211109161377, 180.02728843688965, 183.25443387031555, 186.35670018196106, 189.5246045589447, 192.69308876991272, 195.967346906662, 199.08882665634155, 202.22631978988647, 205.36038208007812, 208.64262008666992, 211.80231618881226, 214.87405061721802, 217.99270462989807, 221.1416211128235, 224.274582862854, 227.48434209823608, 230.6160831451416, 233.8911693096161, 237.12896919250488, 240.30716800689697, 243.46788620948792, 246.72969460487366, 249.92362642288208, 253.08720064163208, 256.3120756149292, 259.6191248893738, 262.91231656074524, 266.0659348964691, 269.2432441711426, 272.42170095443726, 275.64760732650757, 278.8198323249817, 281.9358620643616, 285.074511051178, 288.2469747066498, 291.38249802589417, 294.635778427124, 297.8346827030182, 301.07793641090393, 304.185968875885, 307.3734610080719, 310.4995827674866, 313.73122000694275, 316.8705520629883, 320.0214068889618, 323.2138903141022, 328.4324417114258]
[13.7, 31.26, 38.03, 47.06, 48.9, 50.56, 51.91, 52.35, 52.97, 53.81, 54.81, 54.5, 54.69, 55.68, 56.32, 57.04, 57.87, 58.58, 58.36, 59.34, 60.32, 60.15, 59.96, 59.91, 60.89, 61.07, 60.56, 60.56, 60.91, 60.84, 61.86, 61.67, 60.98, 61.74, 61.35, 62.35, 62.42, 62.51, 62.4, 62.72, 63.17, 62.79, 63.2, 63.19, 63.12, 63.38, 64.2, 63.75, 63.53, 64.13, 63.96, 64.82, 64.37, 63.51, 64.01, 63.84, 64.21, 64.1, 64.34, 64.21, 64.68, 64.7, 64.73, 64.66, 65.11, 64.8, 64.56, 64.91, 64.3, 64.34, 64.39, 63.85, 63.79, 64.42, 64.6, 63.76, 64.69, 64.75, 65.14, 64.65, 64.25, 64.62, 64.6, 65.11, 64.5, 64.68, 64.21, 63.81, 64.35, 64.98, 64.4, 64.75, 64.9, 64.99, 65.5, 65.44, 65.63, 65.4, 65.12, 64.63, 65.26]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.729, Test loss: 2.072, Test accuracy: 16.58
Round   1, Train loss: 1.494, Test loss: 1.959, Test accuracy: 29.28
Round   2, Train loss: 1.242, Test loss: 1.582, Test accuracy: 42.52
Round   3, Train loss: 1.192, Test loss: 1.443, Test accuracy: 42.90
Round   4, Train loss: 1.146, Test loss: 1.349, Test accuracy: 46.50
Round   5, Train loss: 1.094, Test loss: 1.173, Test accuracy: 53.57
Round   6, Train loss: 1.021, Test loss: 1.156, Test accuracy: 54.35
Round   7, Train loss: 1.050, Test loss: 1.131, Test accuracy: 55.73
Round   8, Train loss: 0.997, Test loss: 1.146, Test accuracy: 54.51
Round   9, Train loss: 0.835, Test loss: 1.108, Test accuracy: 55.56
Round  10, Train loss: 0.864, Test loss: 1.083, Test accuracy: 56.84
Round  11, Train loss: 0.913, Test loss: 1.086, Test accuracy: 57.29
Round  12, Train loss: 0.868, Test loss: 1.057, Test accuracy: 58.00
Round  13, Train loss: 0.820, Test loss: 1.055, Test accuracy: 58.00
Round  14, Train loss: 0.820, Test loss: 1.052, Test accuracy: 58.10
Round  15, Train loss: 0.787, Test loss: 1.043, Test accuracy: 58.34
Round  16, Train loss: 0.740, Test loss: 1.015, Test accuracy: 59.82
Round  17, Train loss: 0.781, Test loss: 1.023, Test accuracy: 59.64
Round  18, Train loss: 0.670, Test loss: 1.040, Test accuracy: 59.39
Round  19, Train loss: 0.715, Test loss: 1.028, Test accuracy: 59.25
Round  20, Train loss: 0.643, Test loss: 0.992, Test accuracy: 60.77
Round  21, Train loss: 0.706, Test loss: 0.977, Test accuracy: 61.78
Round  22, Train loss: 0.690, Test loss: 0.979, Test accuracy: 62.10
Round  23, Train loss: 0.599, Test loss: 0.955, Test accuracy: 62.53
Round  24, Train loss: 0.668, Test loss: 0.954, Test accuracy: 62.58
Round  25, Train loss: 0.618, Test loss: 0.948, Test accuracy: 63.80
Round  26, Train loss: 0.525, Test loss: 0.965, Test accuracy: 63.49
Round  27, Train loss: 0.581, Test loss: 0.947, Test accuracy: 63.68
Round  28, Train loss: 0.528, Test loss: 0.926, Test accuracy: 64.61
Round  29, Train loss: 0.543, Test loss: 0.925, Test accuracy: 64.97
Round  30, Train loss: 0.435, Test loss: 0.909, Test accuracy: 65.28
Round  31, Train loss: 0.561, Test loss: 0.929, Test accuracy: 65.06
Round  32, Train loss: 0.676, Test loss: 0.939, Test accuracy: 64.50
Round  33, Train loss: 0.556, Test loss: 0.927, Test accuracy: 64.61
Round  34, Train loss: 0.533, Test loss: 0.941, Test accuracy: 64.51
Round  35, Train loss: 0.475, Test loss: 0.930, Test accuracy: 64.77
Round  36, Train loss: 0.532, Test loss: 0.952, Test accuracy: 64.88
Round  37, Train loss: 0.516, Test loss: 0.949, Test accuracy: 64.25
Round  38, Train loss: 0.435, Test loss: 0.958, Test accuracy: 64.03
Round  39, Train loss: 0.466, Test loss: 0.923, Test accuracy: 65.32
Round  40, Train loss: 0.443, Test loss: 0.935, Test accuracy: 64.82
Round  41, Train loss: 0.484, Test loss: 0.951, Test accuracy: 64.75
Round  42, Train loss: 0.411, Test loss: 0.955, Test accuracy: 64.96
Round  43, Train loss: 0.483, Test loss: 0.954, Test accuracy: 65.01
Round  44, Train loss: 0.392, Test loss: 0.948, Test accuracy: 65.61
Round  45, Train loss: 0.435, Test loss: 0.965, Test accuracy: 64.90
Round  46, Train loss: 0.390, Test loss: 0.937, Test accuracy: 65.70
Round  47, Train loss: 0.466, Test loss: 0.959, Test accuracy: 65.43
Round  48, Train loss: 0.431, Test loss: 0.976, Test accuracy: 65.54
Round  49, Train loss: 0.502, Test loss: 0.981, Test accuracy: 65.56
Round  50, Train loss: 0.379, Test loss: 0.981, Test accuracy: 65.82
Round  51, Train loss: 0.405, Test loss: 0.977, Test accuracy: 66.07
Round  52, Train loss: 0.389, Test loss: 0.989, Test accuracy: 65.71
Round  53, Train loss: 0.461, Test loss: 1.015, Test accuracy: 65.93
Round  54, Train loss: 0.346, Test loss: 1.003, Test accuracy: 65.86
Round  55, Train loss: 0.361, Test loss: 1.008, Test accuracy: 65.92
Round  56, Train loss: 0.364, Test loss: 1.001, Test accuracy: 65.79
Round  57, Train loss: 0.416, Test loss: 0.969, Test accuracy: 66.72
Round  58, Train loss: 0.375, Test loss: 0.998, Test accuracy: 66.19
Round  59, Train loss: 0.305, Test loss: 0.998, Test accuracy: 66.14
Round  60, Train loss: 0.346, Test loss: 0.986, Test accuracy: 66.60
Round  61, Train loss: 0.381, Test loss: 0.985, Test accuracy: 66.93
Round  62, Train loss: 0.378, Test loss: 0.961, Test accuracy: 66.56
Round  63, Train loss: 0.293, Test loss: 0.979, Test accuracy: 66.53
Round  64, Train loss: 0.282, Test loss: 1.008, Test accuracy: 66.49
Round  65, Train loss: 0.419, Test loss: 1.022, Test accuracy: 66.40
Round  66, Train loss: 0.327, Test loss: 1.028, Test accuracy: 66.22
Round  67, Train loss: 0.371, Test loss: 0.995, Test accuracy: 67.01
Round  68, Train loss: 0.341, Test loss: 1.029, Test accuracy: 66.86
Round  69, Train loss: 0.310, Test loss: 1.029, Test accuracy: 66.72
Round  70, Train loss: 0.299, Test loss: 1.037, Test accuracy: 66.29
Round  71, Train loss: 0.354, Test loss: 1.020, Test accuracy: 66.67
Round  72, Train loss: 0.265, Test loss: 1.010, Test accuracy: 66.87
Round  73, Train loss: 0.338, Test loss: 1.017, Test accuracy: 66.34
Round  74, Train loss: 0.355, Test loss: 1.049, Test accuracy: 66.54
Round  75, Train loss: 0.307, Test loss: 1.031, Test accuracy: 66.77
Round  76, Train loss: 0.383, Test loss: 1.051, Test accuracy: 66.17
Round  77, Train loss: 0.260, Test loss: 1.010, Test accuracy: 67.09
Round  78, Train loss: 0.277, Test loss: 1.024, Test accuracy: 67.22
Round  79, Train loss: 0.242, Test loss: 1.007, Test accuracy: 67.46
Round  80, Train loss: 0.327, Test loss: 1.037, Test accuracy: 67.35
Round  81, Train loss: 0.267, Test loss: 1.004, Test accuracy: 67.19
Round  82, Train loss: 0.304, Test loss: 1.024, Test accuracy: 67.42
Round  83, Train loss: 0.253, Test loss: 1.022, Test accuracy: 67.39
Round  84, Train loss: 0.220, Test loss: 1.048, Test accuracy: 67.10
Round  85, Train loss: 0.286, Test loss: 1.081, Test accuracy: 66.78
Round  86, Train loss: 0.276, Test loss: 1.038, Test accuracy: 66.98
Round  87, Train loss: 0.239, Test loss: 1.057, Test accuracy: 67.28
Round  88, Train loss: 0.265, Test loss: 1.056, Test accuracy: 66.70
Round  89, Train loss: 0.229, Test loss: 1.053, Test accuracy: 66.51
Round  90, Train loss: 0.247, Test loss: 1.074, Test accuracy: 66.86
Round  91, Train loss: 0.254, Test loss: 1.051, Test accuracy: 67.29
Round  92, Train loss: 0.283, Test loss: 1.079, Test accuracy: 67.10
Round  93, Train loss: 0.258, Test loss: 1.078, Test accuracy: 67.08
Round  94, Train loss: 0.303, Test loss: 1.046, Test accuracy: 67.40
Round  95, Train loss: 0.273, Test loss: 1.029, Test accuracy: 68.05
Round  96, Train loss: 0.280, Test loss: 1.037, Test accuracy: 67.69
Round  97, Train loss: 0.272, Test loss: 1.090, Test accuracy: 67.11
Round  98, Train loss: 0.267, Test loss: 1.038, Test accuracy: 67.93
Round  99, Train loss: 0.282, Test loss: 1.070, Test accuracy: 67.02
Final Round, Train loss: 0.230, Test loss: 1.088, Test accuracy: 67.66
Average accuracy final 10 rounds: 67.353
3415.94260931015
[3.375882625579834, 6.422253608703613, 9.467468023300171, 12.45784592628479, 15.520478248596191, 18.592998266220093, 21.67125415802002, 24.72943663597107, 27.87584090232849, 30.896297693252563, 34.04315757751465, 37.08797645568848, 40.480684995651245, 44.11767840385437, 47.54141449928284, 50.92557454109192, 54.31487321853638, 57.52724647521973, 60.917473554611206, 64.078195810318, 67.23697233200073, 72.69930839538574, 78.24429988861084, 83.94316625595093, 89.4905219078064, 95.11973452568054, 100.7323067188263, 106.30143022537231, 112.2653169631958, 117.7737250328064, 123.50682663917542, 129.1978096961975, 134.78927493095398, 140.50534772872925, 145.98500108718872, 151.62286114692688, 157.26646208763123, 162.887131690979, 168.52696108818054, 174.14658379554749, 179.77592945098877, 185.37789940834045, 191.03835320472717, 196.83079028129578, 202.47455668449402, 208.21374106407166, 214.01070547103882, 219.6423740386963, 225.32980155944824, 230.89676427841187, 236.5680239200592, 242.05842781066895, 247.58040356636047, 253.2970633506775, 258.98556208610535, 264.6840319633484, 270.2180368900299, 275.82986998558044, 281.54162549972534, 287.10961842536926, 292.8764798641205, 298.6333153247833, 304.67911434173584, 310.90955424308777, 316.67182517051697, 322.5835301876068, 328.1943187713623, 333.8720483779907, 339.69003081321716, 345.3296356201172, 351.01972699165344, 356.6051504611969, 362.19017338752747, 367.8472852706909, 373.40074396133423, 379.02209520339966, 384.6228642463684, 390.38648986816406, 396.199312210083, 401.8466410636902, 407.73726081848145, 413.38800144195557, 419.28093242645264, 424.8260905742645, 430.4110550880432, 436.15888381004333, 441.77967619895935, 447.4775483608246, 453.09397649765015, 458.817343711853, 464.68282175064087, 470.2282612323761, 475.9959704875946, 481.55048298835754, 487.1359221935272, 492.7667033672333, 498.46613478660583, 504.3101623058319, 509.9052355289459, 515.5626666545868, 520.7516760826111]
[16.58, 29.28, 42.52, 42.9, 46.5, 53.57, 54.35, 55.73, 54.51, 55.56, 56.84, 57.29, 58.0, 58.0, 58.1, 58.34, 59.82, 59.64, 59.39, 59.25, 60.77, 61.78, 62.1, 62.53, 62.58, 63.8, 63.49, 63.68, 64.61, 64.97, 65.28, 65.06, 64.5, 64.61, 64.51, 64.77, 64.88, 64.25, 64.03, 65.32, 64.82, 64.75, 64.96, 65.01, 65.61, 64.9, 65.7, 65.43, 65.54, 65.56, 65.82, 66.07, 65.71, 65.93, 65.86, 65.92, 65.79, 66.72, 66.19, 66.14, 66.6, 66.93, 66.56, 66.53, 66.49, 66.4, 66.22, 67.01, 66.86, 66.72, 66.29, 66.67, 66.87, 66.34, 66.54, 66.77, 66.17, 67.09, 67.22, 67.46, 67.35, 67.19, 67.42, 67.39, 67.1, 66.78, 66.98, 67.28, 66.7, 66.51, 66.86, 67.29, 67.1, 67.08, 67.4, 68.05, 67.69, 67.11, 67.93, 67.02, 67.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Fedpac_copsl%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.740, Test loss: 2.173, Test accuracy: 24.38
Round   1, Train loss: 1.371, Test loss: 1.911, Test accuracy: 32.66
Round   2, Train loss: 1.345, Test loss: 1.613, Test accuracy: 42.09
Round   3, Train loss: 1.214, Test loss: 1.490, Test accuracy: 43.32
Round   4, Train loss: 1.340, Test loss: 1.410, Test accuracy: 45.74
Round   5, Train loss: 1.032, Test loss: 1.252, Test accuracy: 50.60
Round   6, Train loss: 1.025, Test loss: 1.206, Test accuracy: 52.62
Round   7, Train loss: 1.043, Test loss: 1.198, Test accuracy: 53.11
Round   8, Train loss: 0.882, Test loss: 1.152, Test accuracy: 54.71
Round   9, Train loss: 0.793, Test loss: 1.130, Test accuracy: 55.15
Round  10, Train loss: 0.814, Test loss: 1.107, Test accuracy: 56.28
Round  11, Train loss: 0.827, Test loss: 1.082, Test accuracy: 57.03
Round  12, Train loss: 0.676, Test loss: 1.073, Test accuracy: 57.57
Round  13, Train loss: 0.768, Test loss: 1.065, Test accuracy: 57.42
Round  14, Train loss: 0.777, Test loss: 1.048, Test accuracy: 57.89
Round  15, Train loss: 0.696, Test loss: 1.023, Test accuracy: 58.12
Round  16, Train loss: 0.747, Test loss: 1.027, Test accuracy: 57.95
Round  17, Train loss: 0.763, Test loss: 1.034, Test accuracy: 57.86
Round  18, Train loss: 0.746, Test loss: 1.028, Test accuracy: 58.90
Round  19, Train loss: 0.700, Test loss: 1.027, Test accuracy: 59.19
Round  20, Train loss: 0.601, Test loss: 1.053, Test accuracy: 58.66
Round  21, Train loss: 0.607, Test loss: 1.035, Test accuracy: 59.85
Round  22, Train loss: 0.627, Test loss: 1.014, Test accuracy: 60.38
Round  23, Train loss: 0.658, Test loss: 1.004, Test accuracy: 60.21
Round  24, Train loss: 0.469, Test loss: 0.993, Test accuracy: 60.79
Round  25, Train loss: 0.614, Test loss: 0.986, Test accuracy: 61.36
Round  26, Train loss: 0.589, Test loss: 1.016, Test accuracy: 60.19
Round  27, Train loss: 0.569, Test loss: 1.004, Test accuracy: 60.46
Round  28, Train loss: 0.520, Test loss: 1.034, Test accuracy: 60.25
Round  29, Train loss: 0.581, Test loss: 1.024, Test accuracy: 60.69
Round  30, Train loss: 0.559, Test loss: 1.019, Test accuracy: 60.72
Round  31, Train loss: 0.575, Test loss: 1.028, Test accuracy: 60.81
Round  32, Train loss: 0.529, Test loss: 1.022, Test accuracy: 60.68
Round  33, Train loss: 0.573, Test loss: 1.048, Test accuracy: 61.11
Round  34, Train loss: 0.547, Test loss: 1.041, Test accuracy: 60.41
Round  35, Train loss: 0.393, Test loss: 1.009, Test accuracy: 61.53
Round  36, Train loss: 0.479, Test loss: 1.004, Test accuracy: 61.37
Round  37, Train loss: 0.465, Test loss: 1.020, Test accuracy: 61.12
Round  38, Train loss: 0.415, Test loss: 1.020, Test accuracy: 61.37
Round  39, Train loss: 0.398, Test loss: 1.003, Test accuracy: 62.23
Round  40, Train loss: 0.394, Test loss: 1.004, Test accuracy: 62.41
Round  41, Train loss: 0.417, Test loss: 1.020, Test accuracy: 62.18
Round  42, Train loss: 0.353, Test loss: 1.007, Test accuracy: 62.40
Round  43, Train loss: 0.424, Test loss: 1.016, Test accuracy: 62.34
Round  44, Train loss: 0.418, Test loss: 1.018, Test accuracy: 63.05
Round  45, Train loss: 0.325, Test loss: 0.981, Test accuracy: 63.82
Round  46, Train loss: 0.403, Test loss: 1.007, Test accuracy: 63.55
Round  47, Train loss: 0.356, Test loss: 0.955, Test accuracy: 63.98
Round  48, Train loss: 0.382, Test loss: 0.985, Test accuracy: 64.34
Round  49, Train loss: 0.384, Test loss: 0.995, Test accuracy: 63.91
Round  50, Train loss: 0.332, Test loss: 1.003, Test accuracy: 63.99
Round  51, Train loss: 0.330, Test loss: 0.989, Test accuracy: 63.86
Round  52, Train loss: 0.358, Test loss: 1.028, Test accuracy: 63.34
Round  53, Train loss: 0.365, Test loss: 1.027, Test accuracy: 63.64
Round  54, Train loss: 0.397, Test loss: 1.035, Test accuracy: 63.49
Round  55, Train loss: 0.274, Test loss: 1.041, Test accuracy: 63.77
Round  56, Train loss: 0.296, Test loss: 1.031, Test accuracy: 63.62
Round  57, Train loss: 0.295, Test loss: 1.024, Test accuracy: 63.92
Round  58, Train loss: 0.289, Test loss: 1.026, Test accuracy: 63.73
Round  59, Train loss: 0.297, Test loss: 1.018, Test accuracy: 64.45
Round  60, Train loss: 0.318, Test loss: 1.031, Test accuracy: 64.07
Round  61, Train loss: 0.416, Test loss: 1.053, Test accuracy: 63.74
Round  62, Train loss: 0.288, Test loss: 1.054, Test accuracy: 63.83
Round  63, Train loss: 0.297, Test loss: 1.066, Test accuracy: 63.55
Round  64, Train loss: 0.278, Test loss: 1.057, Test accuracy: 64.18
Round  65, Train loss: 0.291, Test loss: 1.071, Test accuracy: 64.50
Round  66, Train loss: 0.225, Test loss: 1.035, Test accuracy: 64.78
Round  67, Train loss: 0.317, Test loss: 1.042, Test accuracy: 64.19
Round  68, Train loss: 0.276, Test loss: 1.081, Test accuracy: 64.73
Round  69, Train loss: 0.242, Test loss: 1.052, Test accuracy: 65.06
Round  70, Train loss: 0.365, Test loss: 1.056, Test accuracy: 64.63
Round  71, Train loss: 0.304, Test loss: 1.058, Test accuracy: 64.32
Round  72, Train loss: 0.279, Test loss: 1.065, Test accuracy: 64.30
Round  73, Train loss: 0.274, Test loss: 1.098, Test accuracy: 63.59
Round  74, Train loss: 0.276, Test loss: 1.131, Test accuracy: 63.31
Round  75, Train loss: 0.278, Test loss: 1.139, Test accuracy: 63.30
Round  76, Train loss: 0.217, Test loss: 1.098, Test accuracy: 64.34
Round  77, Train loss: 0.251, Test loss: 1.077, Test accuracy: 64.63
Round  78, Train loss: 0.259, Test loss: 1.112, Test accuracy: 64.60
Round  79, Train loss: 0.220, Test loss: 1.130, Test accuracy: 64.54
Round  80, Train loss: 0.211, Test loss: 1.152, Test accuracy: 64.46
Traceback (most recent call last):
  File "main_fedpac_copsl.py", line 261, in <module>
    w_local, loss, indd, class_center_local, class_num = local.train(net=net_local.to(args.device), class_center_glob=class_center_glob, idx=idx, w_glob_keys=w_glob_keys,
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2509, in train
    self.filter_data(net, local_net, iter2-head_eps+1, local_eps-head_eps, concept_matrix_local)
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2398, in filter_data
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * iter_num / local_eps))]
  File "/home/ChenSM/code/FL_HLS/models/Update.py", line 2398, in <listcomp>
    filter_idxs1 = [sort_distance_tmp1[i][0] for i in range(math.floor(self.args.shard_per_user * self.args.nums_per_class * iter_num / local_eps))]
IndexError: list index out of range
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.901, Test loss: 2.059, Test accuracy: 20.82
Round   0, Global train loss: 1.901, Global test loss: 2.226, Global test accuracy: 15.79
Round   1, Train loss: 1.648, Test loss: 1.861, Test accuracy: 29.89
Round   1, Global train loss: 1.648, Global test loss: 2.186, Global test accuracy: 22.60
Round   2, Train loss: 1.453, Test loss: 1.628, Test accuracy: 36.78
Round   2, Global train loss: 1.453, Global test loss: 2.007, Global test accuracy: 30.82
Round   3, Train loss: 1.471, Test loss: 1.521, Test accuracy: 40.24
Round   3, Global train loss: 1.471, Global test loss: 2.084, Global test accuracy: 26.32
Round   4, Train loss: 1.484, Test loss: 1.454, Test accuracy: 42.66
Round   4, Global train loss: 1.484, Global test loss: 2.117, Global test accuracy: 18.23
Round   5, Train loss: 1.430, Test loss: 1.335, Test accuracy: 46.98
Round   5, Global train loss: 1.430, Global test loss: 2.029, Global test accuracy: 33.45
Round   6, Train loss: 1.144, Test loss: 1.290, Test accuracy: 49.61
Round   6, Global train loss: 1.144, Global test loss: 1.967, Global test accuracy: 30.83
Round   7, Train loss: 1.459, Test loss: 1.260, Test accuracy: 51.09
Round   7, Global train loss: 1.459, Global test loss: 2.056, Global test accuracy: 30.77
Round   8, Train loss: 1.166, Test loss: 1.239, Test accuracy: 52.46
Round   8, Global train loss: 1.166, Global test loss: 2.083, Global test accuracy: 22.84
Round   9, Train loss: 1.241, Test loss: 1.228, Test accuracy: 52.25
Round   9, Global train loss: 1.241, Global test loss: 1.888, Global test accuracy: 35.74
Round  10, Train loss: 1.189, Test loss: 1.212, Test accuracy: 53.70
Round  10, Global train loss: 1.189, Global test loss: 1.940, Global test accuracy: 31.27
Round  11, Train loss: 1.272, Test loss: 1.186, Test accuracy: 54.82
Round  11, Global train loss: 1.272, Global test loss: 2.037, Global test accuracy: 26.27
Round  12, Train loss: 1.077, Test loss: 1.206, Test accuracy: 53.98
Round  12, Global train loss: 1.077, Global test loss: 2.017, Global test accuracy: 30.47
Round  13, Train loss: 1.039, Test loss: 1.200, Test accuracy: 54.08
Round  13, Global train loss: 1.039, Global test loss: 1.963, Global test accuracy: 32.32
Round  14, Train loss: 1.069, Test loss: 1.202, Test accuracy: 54.08
Round  14, Global train loss: 1.069, Global test loss: 1.873, Global test accuracy: 36.90
Round  15, Train loss: 0.939, Test loss: 1.198, Test accuracy: 54.40
Round  15, Global train loss: 0.939, Global test loss: 2.009, Global test accuracy: 31.52
Round  16, Train loss: 1.117, Test loss: 1.189, Test accuracy: 54.54
Round  16, Global train loss: 1.117, Global test loss: 2.150, Global test accuracy: 26.49
Round  17, Train loss: 1.119, Test loss: 1.175, Test accuracy: 55.76
Round  17, Global train loss: 1.119, Global test loss: 1.944, Global test accuracy: 38.22
Round  18, Train loss: 1.136, Test loss: 1.180, Test accuracy: 55.94
Round  18, Global train loss: 1.136, Global test loss: 1.934, Global test accuracy: 35.30
Round  19, Train loss: 0.930, Test loss: 1.181, Test accuracy: 56.03
Round  19, Global train loss: 0.930, Global test loss: 1.919, Global test accuracy: 34.23
Round  20, Train loss: 0.959, Test loss: 1.182, Test accuracy: 56.38
Round  20, Global train loss: 0.959, Global test loss: 1.976, Global test accuracy: 30.02
Round  21, Train loss: 0.986, Test loss: 1.167, Test accuracy: 56.79
Round  21, Global train loss: 0.986, Global test loss: 2.049, Global test accuracy: 35.11
Round  22, Train loss: 1.057, Test loss: 1.154, Test accuracy: 58.39
Round  22, Global train loss: 1.057, Global test loss: 2.034, Global test accuracy: 28.59
Round  23, Train loss: 1.128, Test loss: 1.181, Test accuracy: 56.89
Round  23, Global train loss: 1.128, Global test loss: 2.010, Global test accuracy: 33.66
Round  24, Train loss: 0.865, Test loss: 1.217, Test accuracy: 55.50
Round  24, Global train loss: 0.865, Global test loss: 1.868, Global test accuracy: 36.60
Round  25, Train loss: 0.880, Test loss: 1.190, Test accuracy: 56.60
Round  25, Global train loss: 0.880, Global test loss: 1.890, Global test accuracy: 31.19
Round  26, Train loss: 0.981, Test loss: 1.211, Test accuracy: 56.24
Round  26, Global train loss: 0.981, Global test loss: 1.999, Global test accuracy: 30.08
Round  27, Train loss: 0.780, Test loss: 1.227, Test accuracy: 55.84
Round  27, Global train loss: 0.780, Global test loss: 1.876, Global test accuracy: 35.55
Round  28, Train loss: 0.885, Test loss: 1.216, Test accuracy: 56.50
Round  28, Global train loss: 0.885, Global test loss: 1.906, Global test accuracy: 40.55
Round  29, Train loss: 0.812, Test loss: 1.249, Test accuracy: 56.16
Round  29, Global train loss: 0.812, Global test loss: 1.961, Global test accuracy: 33.97
Round  30, Train loss: 0.709, Test loss: 1.280, Test accuracy: 56.04
Round  30, Global train loss: 0.709, Global test loss: 2.076, Global test accuracy: 31.49
Round  31, Train loss: 0.783, Test loss: 1.279, Test accuracy: 56.48
Round  31, Global train loss: 0.783, Global test loss: 1.965, Global test accuracy: 30.76
Round  32, Train loss: 0.693, Test loss: 1.296, Test accuracy: 56.83
Round  32, Global train loss: 0.693, Global test loss: 1.850, Global test accuracy: 36.37
Round  33, Train loss: 0.748, Test loss: 1.329, Test accuracy: 56.22
Round  33, Global train loss: 0.748, Global test loss: 1.821, Global test accuracy: 39.65
Round  34, Train loss: 0.570, Test loss: 1.327, Test accuracy: 56.08
Round  34, Global train loss: 0.570, Global test loss: 1.926, Global test accuracy: 31.92
Round  35, Train loss: 0.710, Test loss: 1.344, Test accuracy: 55.67
Round  35, Global train loss: 0.710, Global test loss: 1.913, Global test accuracy: 37.31
Round  36, Train loss: 0.636, Test loss: 1.347, Test accuracy: 56.61
Round  36, Global train loss: 0.636, Global test loss: 1.870, Global test accuracy: 35.12
Round  37, Train loss: 0.503, Test loss: 1.409, Test accuracy: 55.93
Round  37, Global train loss: 0.503, Global test loss: 1.822, Global test accuracy: 34.81
Round  38, Train loss: 0.617, Test loss: 1.450, Test accuracy: 55.88
Round  38, Global train loss: 0.617, Global test loss: 1.955, Global test accuracy: 31.47
Round  39, Train loss: 0.615, Test loss: 1.406, Test accuracy: 57.02
Round  39, Global train loss: 0.615, Global test loss: 1.838, Global test accuracy: 37.10
Round  40, Train loss: 0.537, Test loss: 1.425, Test accuracy: 57.09
Round  40, Global train loss: 0.537, Global test loss: 1.866, Global test accuracy: 39.00
Round  41, Train loss: 0.580, Test loss: 1.472, Test accuracy: 56.26
Round  41, Global train loss: 0.580, Global test loss: 1.969, Global test accuracy: 33.44
Round  42, Train loss: 0.521, Test loss: 1.493, Test accuracy: 56.13
Round  42, Global train loss: 0.521, Global test loss: 1.849, Global test accuracy: 37.97
Round  43, Train loss: 0.382, Test loss: 1.505, Test accuracy: 56.16
Round  43, Global train loss: 0.382, Global test loss: 1.988, Global test accuracy: 24.79
Round  44, Train loss: 0.555, Test loss: 1.518, Test accuracy: 56.22
Round  44, Global train loss: 0.555, Global test loss: 1.875, Global test accuracy: 36.85
Round  45, Train loss: 0.582, Test loss: 1.526, Test accuracy: 56.81
Round  45, Global train loss: 0.582, Global test loss: 2.026, Global test accuracy: 36.19
Round  46, Train loss: 0.412, Test loss: 1.567, Test accuracy: 56.63
Round  46, Global train loss: 0.412, Global test loss: 1.890, Global test accuracy: 36.10
Round  47, Train loss: 0.359, Test loss: 1.586, Test accuracy: 56.60
Round  47, Global train loss: 0.359, Global test loss: 1.908, Global test accuracy: 31.89
Round  48, Train loss: 0.437, Test loss: 1.579, Test accuracy: 57.15
Round  48, Global train loss: 0.437, Global test loss: 1.914, Global test accuracy: 34.59
Round  49, Train loss: 0.447, Test loss: 1.607, Test accuracy: 56.37
Round  49, Global train loss: 0.447, Global test loss: 1.920, Global test accuracy: 36.39
Round  50, Train loss: 0.504, Test loss: 1.618, Test accuracy: 56.61
Round  50, Global train loss: 0.504, Global test loss: 1.986, Global test accuracy: 37.13
Round  51, Train loss: 0.419, Test loss: 1.653, Test accuracy: 56.34
Round  51, Global train loss: 0.419, Global test loss: 1.875, Global test accuracy: 33.78
Round  52, Train loss: 0.312, Test loss: 1.697, Test accuracy: 55.94
Round  52, Global train loss: 0.312, Global test loss: 1.904, Global test accuracy: 31.12
Round  53, Train loss: 0.511, Test loss: 1.702, Test accuracy: 55.85
Round  53, Global train loss: 0.511, Global test loss: 1.879, Global test accuracy: 36.88
Round  54, Train loss: 0.355, Test loss: 1.693, Test accuracy: 56.84
Round  54, Global train loss: 0.355, Global test loss: 1.980, Global test accuracy: 32.78
Round  55, Train loss: 0.304, Test loss: 1.683, Test accuracy: 57.35
Round  55, Global train loss: 0.304, Global test loss: 1.907, Global test accuracy: 38.40
Round  56, Train loss: 0.443, Test loss: 1.725, Test accuracy: 56.82
Round  56, Global train loss: 0.443, Global test loss: 1.870, Global test accuracy: 38.27
Round  57, Train loss: 0.330, Test loss: 1.726, Test accuracy: 57.22
Round  57, Global train loss: 0.330, Global test loss: 1.756, Global test accuracy: 35.33
Round  58, Train loss: 0.358, Test loss: 1.794, Test accuracy: 56.73
Round  58, Global train loss: 0.358, Global test loss: 1.932, Global test accuracy: 37.74
Round  59, Train loss: 0.335, Test loss: 1.804, Test accuracy: 56.88
Round  59, Global train loss: 0.335, Global test loss: 1.897, Global test accuracy: 36.16
Round  60, Train loss: 0.271, Test loss: 1.897, Test accuracy: 56.14
Round  60, Global train loss: 0.271, Global test loss: 1.898, Global test accuracy: 36.54
Round  61, Train loss: 0.382, Test loss: 1.902, Test accuracy: 56.00
Round  61, Global train loss: 0.382, Global test loss: 2.027, Global test accuracy: 25.31
Round  62, Train loss: 0.300, Test loss: 1.893, Test accuracy: 56.45
Round  62, Global train loss: 0.300, Global test loss: 1.724, Global test accuracy: 42.09
Round  63, Train loss: 0.281, Test loss: 1.916, Test accuracy: 57.20
Round  63, Global train loss: 0.281, Global test loss: 1.842, Global test accuracy: 37.49
Round  64, Train loss: 0.325, Test loss: 1.913, Test accuracy: 57.24
Round  64, Global train loss: 0.325, Global test loss: 1.830, Global test accuracy: 37.36
Round  65, Train loss: 0.290, Test loss: 1.960, Test accuracy: 57.20
Round  65, Global train loss: 0.290, Global test loss: 1.873, Global test accuracy: 32.61
Round  66, Train loss: 0.271, Test loss: 2.049, Test accuracy: 56.89
Round  66, Global train loss: 0.271, Global test loss: 1.922, Global test accuracy: 32.04
Round  67, Train loss: 0.275, Test loss: 2.066, Test accuracy: 56.94
Round  67, Global train loss: 0.275, Global test loss: 2.092, Global test accuracy: 32.07
Round  68, Train loss: 0.279, Test loss: 2.048, Test accuracy: 56.98
Round  68, Global train loss: 0.279, Global test loss: 1.987, Global test accuracy: 33.96
Round  69, Train loss: 0.336, Test loss: 2.048, Test accuracy: 56.74
Round  69, Global train loss: 0.336, Global test loss: 1.979, Global test accuracy: 32.96
Round  70, Train loss: 0.262, Test loss: 2.088, Test accuracy: 56.32
Round  70, Global train loss: 0.262, Global test loss: 1.966, Global test accuracy: 30.99
Round  71, Train loss: 0.305, Test loss: 2.156, Test accuracy: 56.34
Round  71, Global train loss: 0.305, Global test loss: 2.019, Global test accuracy: 33.00
Round  72, Train loss: 0.246, Test loss: 2.206, Test accuracy: 56.71
Round  72, Global train loss: 0.246, Global test loss: 1.959, Global test accuracy: 33.81
Round  73, Train loss: 0.237, Test loss: 2.195, Test accuracy: 56.36
Round  73, Global train loss: 0.237, Global test loss: 1.882, Global test accuracy: 38.78
Round  74, Train loss: 0.196, Test loss: 2.292, Test accuracy: 56.16
Round  74, Global train loss: 0.196, Global test loss: 1.953, Global test accuracy: 37.04
Round  75, Train loss: 0.198, Test loss: 2.258, Test accuracy: 56.59
Round  75, Global train loss: 0.198, Global test loss: 1.923, Global test accuracy: 32.32
Round  76, Train loss: 0.213, Test loss: 2.280, Test accuracy: 56.28
Round  76, Global train loss: 0.213, Global test loss: 1.955, Global test accuracy: 34.58
Round  77, Train loss: 0.231, Test loss: 2.344, Test accuracy: 55.86
Round  77, Global train loss: 0.231, Global test loss: 1.835, Global test accuracy: 39.11
Round  78, Train loss: 0.228, Test loss: 2.386, Test accuracy: 55.58
Round  78, Global train loss: 0.228, Global test loss: 1.870, Global test accuracy: 38.37
Round  79, Train loss: 0.245, Test loss: 2.419, Test accuracy: 55.86
Round  79, Global train loss: 0.245, Global test loss: 2.072, Global test accuracy: 32.39
Round  80, Train loss: 0.253, Test loss: 2.400, Test accuracy: 55.84
Round  80, Global train loss: 0.253, Global test loss: 2.055, Global test accuracy: 37.86
Round  81, Train loss: 0.208, Test loss: 2.414, Test accuracy: 55.48
Round  81, Global train loss: 0.208, Global test loss: 1.939, Global test accuracy: 37.55
Round  82, Train loss: 0.214, Test loss: 2.447, Test accuracy: 54.80
Round  82, Global train loss: 0.214, Global test loss: 2.028, Global test accuracy: 32.00
Round  83, Train loss: 0.200, Test loss: 2.433, Test accuracy: 55.72
Round  83, Global train loss: 0.200, Global test loss: 1.915, Global test accuracy: 35.57
Round  84, Train loss: 0.203, Test loss: 2.527, Test accuracy: 55.34
Round  84, Global train loss: 0.203, Global test loss: 2.056, Global test accuracy: 29.72
Round  85, Train loss: 0.189, Test loss: 2.473, Test accuracy: 56.15
Round  85, Global train loss: 0.189, Global test loss: 2.093, Global test accuracy: 36.31
Round  86, Train loss: 0.164, Test loss: 2.448, Test accuracy: 56.15
Round  86, Global train loss: 0.164, Global test loss: 1.733, Global test accuracy: 40.36
Round  87, Train loss: 0.162, Test loss: 2.461, Test accuracy: 56.46
Round  87, Global train loss: 0.162, Global test loss: 2.025, Global test accuracy: 35.34
Round  88, Train loss: 0.116, Test loss: 2.432, Test accuracy: 56.89
Round  88, Global train loss: 0.116, Global test loss: 2.070, Global test accuracy: 34.24
Round  89, Train loss: 0.180, Test loss: 2.386, Test accuracy: 57.29
Round  89, Global train loss: 0.180, Global test loss: 1.973, Global test accuracy: 32.34
Round  90, Train loss: 0.142, Test loss: 2.430, Test accuracy: 56.78
Round  90, Global train loss: 0.142, Global test loss: 2.037, Global test accuracy: 31.77
Round  91, Train loss: 0.156, Test loss: 2.437, Test accuracy: 56.49
Round  91, Global train loss: 0.156, Global test loss: 2.058, Global test accuracy: 29.08
Round  92, Train loss: 0.157, Test loss: 2.460, Test accuracy: 56.82
Round  92, Global train loss: 0.157, Global test loss: 2.022, Global test accuracy: 35.50
Round  93, Train loss: 0.117, Test loss: 2.459, Test accuracy: 56.69
Round  93, Global train loss: 0.117, Global test loss: 2.005, Global test accuracy: 31.75
Round  94, Train loss: 0.177, Test loss: 2.447, Test accuracy: 56.72
Round  94, Global train loss: 0.177, Global test loss: 1.913, Global test accuracy: 36.17
Round  95, Train loss: 0.138, Test loss: 2.502, Test accuracy: 56.87
Round  95, Global train loss: 0.138, Global test loss: 1.893, Global test accuracy: 40.29
Round  96, Train loss: 0.105, Test loss: 2.551, Test accuracy: 56.51
Round  96, Global train loss: 0.105, Global test loss: 1.802, Global test accuracy: 37.03
Round  97, Train loss: 0.114, Test loss: 2.635, Test accuracy: 56.36
Round  97, Global train loss: 0.114, Global test loss: 1.948, Global test accuracy: 28.20
Round  98, Train loss: 0.139, Test loss: 2.623, Test accuracy: 57.29
Round  98, Global train loss: 0.139, Global test loss: 1.986, Global test accuracy: 32.51
Round  99, Train loss: 0.116, Test loss: 2.560, Test accuracy: 57.70
Round  99, Global train loss: 0.116, Global test loss: 1.970, Global test accuracy: 32.19
Final Round, Train loss: 0.129, Test loss: 2.670, Test accuracy: 56.75
Final Round, Global train loss: 0.129, Global test loss: 1.970, Global test accuracy: 32.19
Average accuracy final 10 rounds: 56.82300000000001 

Average global accuracy final 10 rounds: 33.449 

1620.7077984809875
[1.5944645404815674, 3.1889290809631348, 4.411438226699829, 5.633947372436523, 6.951291084289551, 8.268634796142578, 9.50380802154541, 10.738981246948242, 11.959945917129517, 13.180910587310791, 14.410717248916626, 15.640523910522461, 16.89448070526123, 18.1484375, 19.38472628593445, 20.621015071868896, 21.848535776138306, 23.076056480407715, 24.2973210811615, 25.518585681915283, 26.73377513885498, 27.948964595794678, 29.17654514312744, 30.404125690460205, 31.631221771240234, 32.858317852020264, 34.088966608047485, 35.31961536407471, 36.54999279975891, 37.780370235443115, 38.99628949165344, 40.21220874786377, 41.43041801452637, 42.648627281188965, 43.87397122383118, 45.09931516647339, 46.32553720474243, 47.551759243011475, 48.78901743888855, 50.026275634765625, 51.25263857841492, 52.47900152206421, 53.70382261276245, 54.92864370346069, 56.14602184295654, 57.36339998245239, 58.58424258232117, 59.80508518218994, 61.62119269371033, 63.43730020523071, 64.67767000198364, 65.91803979873657, 67.24021410942078, 68.56238842010498, 69.845468044281, 71.12854766845703, 72.48468494415283, 73.84082221984863, 75.12484312057495, 76.40886402130127, 77.77052211761475, 79.13218021392822, 80.4251298904419, 81.71807956695557, 82.94592881202698, 84.17377805709839, 85.40324640274048, 86.63271474838257, 87.8547215461731, 89.07672834396362, 90.30208849906921, 91.5274486541748, 92.75777006149292, 93.98809146881104, 95.21137595176697, 96.4346604347229, 97.6578586101532, 98.8810567855835, 100.106369972229, 101.33168315887451, 102.55976033210754, 103.78783750534058, 105.01428461074829, 106.240731716156, 107.46548652648926, 108.69024133682251, 109.91020083427429, 111.13016033172607, 112.35771608352661, 113.58527183532715, 114.81186938285828, 116.0384669303894, 117.26514339447021, 118.49181985855103, 119.72451639175415, 120.95721292495728, 122.19100093841553, 123.42478895187378, 124.6471848487854, 125.86958074569702, 127.09717082977295, 128.32476091384888, 129.55229210853577, 130.77982330322266, 132.02952432632446, 133.27922534942627, 134.50242805480957, 135.72563076019287, 136.952241897583, 138.17885303497314, 139.40251421928406, 140.62617540359497, 141.85223603248596, 143.07829666137695, 144.29776859283447, 145.517240524292, 146.7469687461853, 147.9766969680786, 149.2028043270111, 150.4289116859436, 151.6565010547638, 152.88409042358398, 154.10842037200928, 155.33275032043457, 156.55561900138855, 157.77848768234253, 159.00211381912231, 160.2257399559021, 161.464581489563, 162.70342302322388, 163.9348909854889, 165.1663589477539, 166.39435839653015, 167.6223578453064, 168.84724831581116, 170.07213878631592, 171.3068630695343, 172.54158735275269, 173.77804732322693, 175.01450729370117, 176.2474012374878, 177.4802951812744, 178.70959734916687, 179.93889951705933, 181.16797280311584, 182.39704608917236, 183.619642496109, 184.84223890304565, 186.07510471343994, 187.30797052383423, 188.53673911094666, 189.76550769805908, 190.98835945129395, 192.2112112045288, 193.4316439628601, 194.6520767211914, 195.8740177154541, 197.0959587097168, 198.3162019252777, 199.53644514083862, 200.7627818584442, 201.9891185760498, 203.21008038520813, 204.43104219436646, 206.24651646614075, 208.06199073791504, 209.2831084728241, 210.50422620773315, 211.73742198944092, 212.97061777114868, 214.20246481895447, 215.43431186676025, 216.66129207611084, 217.88827228546143, 219.0982277393341, 220.3081831932068, 221.53431844711304, 222.7604537010193, 223.9989776611328, 225.23750162124634, 226.46473789215088, 227.69197416305542, 228.92945432662964, 230.16693449020386, 231.39528965950012, 232.6236448287964, 233.8545219898224, 235.0853991508484, 236.31964945793152, 237.55389976501465, 238.7992753982544, 240.04465103149414, 241.27505230903625, 242.50545358657837, 243.73661065101624, 244.9677677154541, 246.20713877677917, 247.44650983810425, 248.68025469779968, 249.91399955749512, 252.78116989135742, 255.64834022521973]
[20.82, 20.82, 29.89, 29.89, 36.78, 36.78, 40.24, 40.24, 42.66, 42.66, 46.98, 46.98, 49.61, 49.61, 51.09, 51.09, 52.46, 52.46, 52.25, 52.25, 53.7, 53.7, 54.82, 54.82, 53.98, 53.98, 54.08, 54.08, 54.08, 54.08, 54.4, 54.4, 54.54, 54.54, 55.76, 55.76, 55.94, 55.94, 56.03, 56.03, 56.38, 56.38, 56.79, 56.79, 58.39, 58.39, 56.89, 56.89, 55.5, 55.5, 56.6, 56.6, 56.24, 56.24, 55.84, 55.84, 56.5, 56.5, 56.16, 56.16, 56.04, 56.04, 56.48, 56.48, 56.83, 56.83, 56.22, 56.22, 56.08, 56.08, 55.67, 55.67, 56.61, 56.61, 55.93, 55.93, 55.88, 55.88, 57.02, 57.02, 57.09, 57.09, 56.26, 56.26, 56.13, 56.13, 56.16, 56.16, 56.22, 56.22, 56.81, 56.81, 56.63, 56.63, 56.6, 56.6, 57.15, 57.15, 56.37, 56.37, 56.61, 56.61, 56.34, 56.34, 55.94, 55.94, 55.85, 55.85, 56.84, 56.84, 57.35, 57.35, 56.82, 56.82, 57.22, 57.22, 56.73, 56.73, 56.88, 56.88, 56.14, 56.14, 56.0, 56.0, 56.45, 56.45, 57.2, 57.2, 57.24, 57.24, 57.2, 57.2, 56.89, 56.89, 56.94, 56.94, 56.98, 56.98, 56.74, 56.74, 56.32, 56.32, 56.34, 56.34, 56.71, 56.71, 56.36, 56.36, 56.16, 56.16, 56.59, 56.59, 56.28, 56.28, 55.86, 55.86, 55.58, 55.58, 55.86, 55.86, 55.84, 55.84, 55.48, 55.48, 54.8, 54.8, 55.72, 55.72, 55.34, 55.34, 56.15, 56.15, 56.15, 56.15, 56.46, 56.46, 56.89, 56.89, 57.29, 57.29, 56.78, 56.78, 56.49, 56.49, 56.82, 56.82, 56.69, 56.69, 56.72, 56.72, 56.87, 56.87, 56.51, 56.51, 56.36, 56.36, 57.29, 57.29, 57.7, 57.7, 56.75, 56.75]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.756, Test loss: 2.074, Test accuracy: 27.16
Round   0, Global train loss: 1.756, Global test loss: 2.271, Global test accuracy: 22.54
Round   1, Train loss: 1.622, Test loss: 1.882, Test accuracy: 31.76
Round   1, Global train loss: 1.622, Global test loss: 2.267, Global test accuracy: 22.71
Round   2, Train loss: 1.499, Test loss: 1.628, Test accuracy: 39.77
Round   2, Global train loss: 1.499, Global test loss: 1.973, Global test accuracy: 31.63
Round   3, Train loss: 1.499, Test loss: 1.449, Test accuracy: 44.23
Round   3, Global train loss: 1.499, Global test loss: 1.828, Global test accuracy: 38.12
Round   4, Train loss: 1.412, Test loss: 1.387, Test accuracy: 46.51
Round   4, Global train loss: 1.412, Global test loss: 2.054, Global test accuracy: 23.30
Round   5, Train loss: 1.501, Test loss: 1.291, Test accuracy: 50.35
Round   5, Global train loss: 1.501, Global test loss: 1.809, Global test accuracy: 38.92
Round   6, Train loss: 1.436, Test loss: 1.262, Test accuracy: 51.49
Round   6, Global train loss: 1.436, Global test loss: 1.704, Global test accuracy: 42.16
Round   7, Train loss: 1.304, Test loss: 1.233, Test accuracy: 52.24
Round   7, Global train loss: 1.304, Global test loss: 1.686, Global test accuracy: 42.96
Round   8, Train loss: 1.181, Test loss: 1.203, Test accuracy: 53.52
Round   8, Global train loss: 1.181, Global test loss: 1.686, Global test accuracy: 36.27
Round   9, Train loss: 1.180, Test loss: 1.176, Test accuracy: 55.08
Round   9, Global train loss: 1.180, Global test loss: 1.650, Global test accuracy: 43.91
Round  10, Train loss: 1.226, Test loss: 1.177, Test accuracy: 55.31
Round  10, Global train loss: 1.226, Global test loss: 1.644, Global test accuracy: 43.97
Round  11, Train loss: 1.151, Test loss: 1.155, Test accuracy: 56.80
Round  11, Global train loss: 1.151, Global test loss: 1.669, Global test accuracy: 42.89
Round  12, Train loss: 1.115, Test loss: 1.153, Test accuracy: 57.21
Round  12, Global train loss: 1.115, Global test loss: 1.670, Global test accuracy: 45.83
Round  13, Train loss: 1.053, Test loss: 1.128, Test accuracy: 58.43
Round  13, Global train loss: 1.053, Global test loss: 1.498, Global test accuracy: 49.28
Round  14, Train loss: 1.200, Test loss: 1.101, Test accuracy: 59.52
Round  14, Global train loss: 1.200, Global test loss: 1.512, Global test accuracy: 47.56
Round  15, Train loss: 1.105, Test loss: 1.100, Test accuracy: 59.06
Round  15, Global train loss: 1.105, Global test loss: 1.562, Global test accuracy: 48.57
Round  16, Train loss: 1.173, Test loss: 1.066, Test accuracy: 60.56
Round  16, Global train loss: 1.173, Global test loss: 1.566, Global test accuracy: 43.16
Round  17, Train loss: 1.254, Test loss: 1.070, Test accuracy: 60.16
Round  17, Global train loss: 1.254, Global test loss: 1.482, Global test accuracy: 50.66
Round  18, Train loss: 0.930, Test loss: 1.068, Test accuracy: 60.23
Round  18, Global train loss: 0.930, Global test loss: 1.610, Global test accuracy: 46.69
Round  19, Train loss: 1.051, Test loss: 1.056, Test accuracy: 60.74
Round  19, Global train loss: 1.051, Global test loss: 1.529, Global test accuracy: 49.45
Round  20, Train loss: 0.932, Test loss: 1.069, Test accuracy: 60.57
Round  20, Global train loss: 0.932, Global test loss: 1.409, Global test accuracy: 52.13
Round  21, Train loss: 1.065, Test loss: 1.054, Test accuracy: 61.11
Round  21, Global train loss: 1.065, Global test loss: 1.500, Global test accuracy: 48.78
Round  22, Train loss: 1.145, Test loss: 1.059, Test accuracy: 60.76
Round  22, Global train loss: 1.145, Global test loss: 1.369, Global test accuracy: 52.02
Round  23, Train loss: 0.867, Test loss: 1.053, Test accuracy: 60.86
Round  23, Global train loss: 0.867, Global test loss: 1.409, Global test accuracy: 55.73
Round  24, Train loss: 0.964, Test loss: 1.049, Test accuracy: 60.94
Round  24, Global train loss: 0.964, Global test loss: 1.356, Global test accuracy: 54.75
Round  25, Train loss: 1.165, Test loss: 1.064, Test accuracy: 59.93
Round  25, Global train loss: 1.165, Global test loss: 1.362, Global test accuracy: 54.92
Round  26, Train loss: 0.855, Test loss: 1.072, Test accuracy: 59.58
Round  26, Global train loss: 0.855, Global test loss: 1.264, Global test accuracy: 57.09
Round  27, Train loss: 1.019, Test loss: 1.071, Test accuracy: 58.65
Round  27, Global train loss: 1.019, Global test loss: 1.329, Global test accuracy: 55.27
Round  28, Train loss: 0.895, Test loss: 1.085, Test accuracy: 58.07
Round  28, Global train loss: 0.895, Global test loss: 1.301, Global test accuracy: 56.45
Round  29, Train loss: 0.955, Test loss: 1.061, Test accuracy: 59.62
Round  29, Global train loss: 0.955, Global test loss: 1.354, Global test accuracy: 53.82
Round  30, Train loss: 0.833, Test loss: 1.058, Test accuracy: 60.34
Round  30, Global train loss: 0.833, Global test loss: 1.474, Global test accuracy: 49.25
Round  31, Train loss: 0.795, Test loss: 1.060, Test accuracy: 60.01
Round  31, Global train loss: 0.795, Global test loss: 1.408, Global test accuracy: 55.31
Round  32, Train loss: 0.838, Test loss: 1.036, Test accuracy: 60.89
Round  32, Global train loss: 0.838, Global test loss: 1.319, Global test accuracy: 54.94
Round  33, Train loss: 1.073, Test loss: 1.028, Test accuracy: 61.48
Round  33, Global train loss: 1.073, Global test loss: 1.302, Global test accuracy: 55.87
Round  34, Train loss: 0.749, Test loss: 1.033, Test accuracy: 62.10
Round  34, Global train loss: 0.749, Global test loss: 1.224, Global test accuracy: 56.78
Round  35, Train loss: 0.918, Test loss: 1.023, Test accuracy: 63.01
Round  35, Global train loss: 0.918, Global test loss: 1.190, Global test accuracy: 61.05
Round  36, Train loss: 0.676, Test loss: 0.997, Test accuracy: 64.19
Round  36, Global train loss: 0.676, Global test loss: 1.289, Global test accuracy: 56.26
Round  37, Train loss: 0.805, Test loss: 1.010, Test accuracy: 63.04
Round  37, Global train loss: 0.805, Global test loss: 1.260, Global test accuracy: 56.56
Round  38, Train loss: 1.077, Test loss: 1.025, Test accuracy: 62.19
Round  38, Global train loss: 1.077, Global test loss: 1.375, Global test accuracy: 55.60
Round  39, Train loss: 0.784, Test loss: 1.044, Test accuracy: 61.47
Round  39, Global train loss: 0.784, Global test loss: 1.284, Global test accuracy: 58.61
Round  40, Train loss: 0.769, Test loss: 1.037, Test accuracy: 61.56
Round  40, Global train loss: 0.769, Global test loss: 1.287, Global test accuracy: 58.18
Round  41, Train loss: 0.718, Test loss: 1.026, Test accuracy: 61.92
Round  41, Global train loss: 0.718, Global test loss: 1.385, Global test accuracy: 57.07
Round  42, Train loss: 0.556, Test loss: 1.055, Test accuracy: 61.13
Round  42, Global train loss: 0.556, Global test loss: 1.308, Global test accuracy: 60.21
Round  43, Train loss: 0.677, Test loss: 1.015, Test accuracy: 62.77
Round  43, Global train loss: 0.677, Global test loss: 1.328, Global test accuracy: 56.63
Round  44, Train loss: 0.791, Test loss: 1.040, Test accuracy: 62.32
Round  44, Global train loss: 0.791, Global test loss: 1.220, Global test accuracy: 59.95
Round  45, Train loss: 0.902, Test loss: 0.995, Test accuracy: 64.60
Round  45, Global train loss: 0.902, Global test loss: 1.329, Global test accuracy: 55.28
Round  46, Train loss: 0.630, Test loss: 1.014, Test accuracy: 64.01
Round  46, Global train loss: 0.630, Global test loss: 1.194, Global test accuracy: 60.84
Round  47, Train loss: 0.749, Test loss: 1.059, Test accuracy: 62.53
Round  47, Global train loss: 0.749, Global test loss: 1.278, Global test accuracy: 57.44
Round  48, Train loss: 0.734, Test loss: 1.068, Test accuracy: 62.00
Round  48, Global train loss: 0.734, Global test loss: 1.222, Global test accuracy: 58.90
Round  49, Train loss: 0.789, Test loss: 1.064, Test accuracy: 62.03
Round  49, Global train loss: 0.789, Global test loss: 1.268, Global test accuracy: 56.67
Round  50, Train loss: 0.749, Test loss: 1.090, Test accuracy: 61.13
Round  50, Global train loss: 0.749, Global test loss: 1.312, Global test accuracy: 56.28
Round  51, Train loss: 0.703, Test loss: 1.098, Test accuracy: 61.05
Round  51, Global train loss: 0.703, Global test loss: 1.216, Global test accuracy: 58.99
Round  52, Train loss: 0.681, Test loss: 1.097, Test accuracy: 61.32
Round  52, Global train loss: 0.681, Global test loss: 1.205, Global test accuracy: 58.69
Round  53, Train loss: 0.816, Test loss: 1.091, Test accuracy: 61.52
Round  53, Global train loss: 0.816, Global test loss: 1.326, Global test accuracy: 56.46
Round  54, Train loss: 0.686, Test loss: 1.077, Test accuracy: 62.14
Round  54, Global train loss: 0.686, Global test loss: 1.201, Global test accuracy: 59.58
Round  55, Train loss: 0.625, Test loss: 1.073, Test accuracy: 62.39
Round  55, Global train loss: 0.625, Global test loss: 1.198, Global test accuracy: 59.52
Round  56, Train loss: 0.633, Test loss: 1.079, Test accuracy: 62.49
Round  56, Global train loss: 0.633, Global test loss: 1.392, Global test accuracy: 56.71
Round  57, Train loss: 0.620, Test loss: 1.099, Test accuracy: 62.41
Round  57, Global train loss: 0.620, Global test loss: 1.157, Global test accuracy: 60.87
Round  58, Train loss: 0.596, Test loss: 1.106, Test accuracy: 62.69
Round  58, Global train loss: 0.596, Global test loss: 1.442, Global test accuracy: 58.29
Round  59, Train loss: 0.610, Test loss: 1.101, Test accuracy: 62.78
Round  59, Global train loss: 0.610, Global test loss: 1.417, Global test accuracy: 54.02
Round  60, Train loss: 0.699, Test loss: 1.080, Test accuracy: 63.21
Round  60, Global train loss: 0.699, Global test loss: 1.193, Global test accuracy: 61.80
Round  61, Train loss: 0.798, Test loss: 1.072, Test accuracy: 63.96
Round  61, Global train loss: 0.798, Global test loss: 1.245, Global test accuracy: 59.07
Round  62, Train loss: 0.619, Test loss: 1.099, Test accuracy: 63.11
Round  62, Global train loss: 0.619, Global test loss: 1.324, Global test accuracy: 58.22
Round  63, Train loss: 0.582, Test loss: 1.094, Test accuracy: 63.28
Round  63, Global train loss: 0.582, Global test loss: 1.334, Global test accuracy: 60.08
Round  64, Train loss: 0.686, Test loss: 1.087, Test accuracy: 63.63
Round  64, Global train loss: 0.686, Global test loss: 1.232, Global test accuracy: 61.42
Round  65, Train loss: 0.732, Test loss: 1.104, Test accuracy: 63.18
Round  65, Global train loss: 0.732, Global test loss: 1.414, Global test accuracy: 54.79
Round  66, Train loss: 0.658, Test loss: 1.112, Test accuracy: 63.40
Round  66, Global train loss: 0.658, Global test loss: 1.342, Global test accuracy: 58.11
Round  67, Train loss: 0.698, Test loss: 1.110, Test accuracy: 63.65
Round  67, Global train loss: 0.698, Global test loss: 1.364, Global test accuracy: 57.17
Round  68, Train loss: 0.707, Test loss: 1.118, Test accuracy: 63.69
Round  68, Global train loss: 0.707, Global test loss: 1.371, Global test accuracy: 54.06
Round  69, Train loss: 0.606, Test loss: 1.144, Test accuracy: 63.31
Round  69, Global train loss: 0.606, Global test loss: 1.221, Global test accuracy: 61.20
Round  70, Train loss: 0.595, Test loss: 1.134, Test accuracy: 63.08
Round  70, Global train loss: 0.595, Global test loss: 1.335, Global test accuracy: 59.09
Round  71, Train loss: 0.689, Test loss: 1.100, Test accuracy: 64.13
Round  71, Global train loss: 0.689, Global test loss: 1.333, Global test accuracy: 57.30
Round  72, Train loss: 0.594, Test loss: 1.135, Test accuracy: 63.38
Round  72, Global train loss: 0.594, Global test loss: 1.335, Global test accuracy: 59.79
Round  73, Train loss: 0.562, Test loss: 1.136, Test accuracy: 63.12
Round  73, Global train loss: 0.562, Global test loss: 1.357, Global test accuracy: 58.62
Round  74, Train loss: 0.714, Test loss: 1.161, Test accuracy: 62.82
Round  74, Global train loss: 0.714, Global test loss: 1.359, Global test accuracy: 55.89
Round  75, Train loss: 0.487, Test loss: 1.163, Test accuracy: 62.53
Round  75, Global train loss: 0.487, Global test loss: 1.497, Global test accuracy: 58.13
Round  76, Train loss: 0.720, Test loss: 1.154, Test accuracy: 62.86
Round  76, Global train loss: 0.720, Global test loss: 1.471, Global test accuracy: 52.77
Round  77, Train loss: 0.587, Test loss: 1.191, Test accuracy: 62.35
Round  77, Global train loss: 0.587, Global test loss: 1.410, Global test accuracy: 56.35
Round  78, Train loss: 0.489, Test loss: 1.190, Test accuracy: 62.34
Round  78, Global train loss: 0.489, Global test loss: 1.295, Global test accuracy: 60.72
Round  79, Train loss: 0.564, Test loss: 1.205, Test accuracy: 62.21
Round  79, Global train loss: 0.564, Global test loss: 1.451, Global test accuracy: 58.04
Round  80, Train loss: 0.750, Test loss: 1.206, Test accuracy: 62.90
Round  80, Global train loss: 0.750, Global test loss: 1.488, Global test accuracy: 54.20
Round  81, Train loss: 0.623, Test loss: 1.204, Test accuracy: 63.34
Round  81, Global train loss: 0.623, Global test loss: 1.548, Global test accuracy: 53.46
Round  82, Train loss: 0.442, Test loss: 1.227, Test accuracy: 63.15
Round  82, Global train loss: 0.442, Global test loss: 1.563, Global test accuracy: 56.40
Round  83, Train loss: 0.386, Test loss: 1.223, Test accuracy: 63.28
Round  83, Global train loss: 0.386, Global test loss: 1.491, Global test accuracy: 58.95
Round  84, Train loss: 0.469, Test loss: 1.198, Test accuracy: 63.23
Round  84, Global train loss: 0.469, Global test loss: 1.312, Global test accuracy: 62.21
Round  85, Train loss: 0.608, Test loss: 1.209, Test accuracy: 63.21
Round  85, Global train loss: 0.608, Global test loss: 1.481, Global test accuracy: 56.33
Round  86, Train loss: 0.736, Test loss: 1.215, Test accuracy: 63.28
Round  86, Global train loss: 0.736, Global test loss: 1.275, Global test accuracy: 59.64
Round  87, Train loss: 0.616, Test loss: 1.235, Test accuracy: 63.21
Round  87, Global train loss: 0.616, Global test loss: 1.411, Global test accuracy: 56.31
Round  88, Train loss: 0.555, Test loss: 1.243, Test accuracy: 62.50
Round  88, Global train loss: 0.555, Global test loss: 1.387, Global test accuracy: 57.68
Round  89, Train loss: 0.454, Test loss: 1.238, Test accuracy: 62.52
Round  89, Global train loss: 0.454, Global test loss: 1.425, Global test accuracy: 58.55
Round  90, Train loss: 0.532, Test loss: 1.271, Test accuracy: 62.15
Round  90, Global train loss: 0.532, Global test loss: 1.491, Global test accuracy: 56.24
Round  91, Train loss: 0.608, Test loss: 1.296, Test accuracy: 61.71
Round  91, Global train loss: 0.608, Global test loss: 1.350, Global test accuracy: 58.94
Round  92, Train loss: 0.575, Test loss: 1.301, Test accuracy: 61.86
Round  92, Global train loss: 0.575, Global test loss: 1.375, Global test accuracy: 59.85
Round  93, Train loss: 0.533, Test loss: 1.264, Test accuracy: 63.44
Round  93, Global train loss: 0.533, Global test loss: 1.357, Global test accuracy: 58.65
Round  94, Train loss: 0.446, Test loss: 1.259, Test accuracy: 63.71
Round  94, Global train loss: 0.446, Global test loss: 1.501, Global test accuracy: 59.39
Round  95, Train loss: 0.552, Test loss: 1.278, Test accuracy: 63.27
Round  95, Global train loss: 0.552, Global test loss: 1.454, Global test accuracy: 56.71
Round  96, Train loss: 0.538, Test loss: 1.275, Test accuracy: 63.79
Round  96, Global train loss: 0.538, Global test loss: 1.245, Global test accuracy: 62.46
Round  97, Train loss: 0.397, Test loss: 1.275, Test accuracy: 63.50
Round  97, Global train loss: 0.397, Global test loss: 1.257, Global test accuracy: 62.92
Round  98, Train loss: 0.480, Test loss: 1.255, Test accuracy: 64.06
Round  98, Global train loss: 0.480, Global test loss: 1.510, Global test accuracy: 59.15
Round  99, Train loss: 0.491, Test loss: 1.244, Test accuracy: 63.97
Round  99, Global train loss: 0.491, Global test loss: 1.546, Global test accuracy: 57.28
Final Round, Train loss: 0.390, Test loss: 1.427, Test accuracy: 62.48
Final Round, Global train loss: 0.390, Global test loss: 1.546, Global test accuracy: 57.28
Average accuracy final 10 rounds: 63.145999999999994 

Average global accuracy final 10 rounds: 59.159000000000006 

1699.931386232376
[1.664505958557129, 3.329011917114258, 4.6729676723480225, 6.016923427581787, 7.357201337814331, 8.697479248046875, 10.027643918991089, 11.357808589935303, 12.668161392211914, 13.978514194488525, 15.309860706329346, 16.641207218170166, 17.946596145629883, 19.2519850730896, 20.53826880455017, 21.824552536010742, 23.143869400024414, 24.463186264038086, 25.77022361755371, 27.077260971069336, 28.422348976135254, 29.767436981201172, 31.071229219436646, 32.37502145767212, 33.70331645011902, 35.03161144256592, 36.37710452079773, 37.72259759902954, 39.016682624816895, 40.31076765060425, 41.6701123714447, 43.029457092285156, 44.32265281677246, 45.615848541259766, 47.06034302711487, 48.50483751296997, 49.86573386192322, 51.226630210876465, 52.69275641441345, 54.15888261795044, 55.53633522987366, 56.913787841796875, 58.358399629592896, 59.803011417388916, 61.15791726112366, 62.5128231048584, 63.80269384384155, 65.0925645828247, 66.42592334747314, 67.75928211212158, 69.09018731117249, 70.42109251022339, 71.73245739936829, 73.04382228851318, 74.31219696998596, 75.58057165145874, 76.89402532577515, 78.20747900009155, 79.51766729354858, 80.82785558700562, 82.1470799446106, 83.46630430221558, 84.7531065940857, 86.03990888595581, 87.32264423370361, 88.60537958145142, 90.01680111885071, 91.42822265625, 92.75315308570862, 94.07808351516724, 95.40911841392517, 96.7401533126831, 98.09383201599121, 99.44751071929932, 100.74451351165771, 102.04151630401611, 103.38712096214294, 104.73272562026978, 106.04848599433899, 107.3642463684082, 108.69339537620544, 110.02254438400269, 111.3161244392395, 112.60970449447632, 113.92670273780823, 115.24370098114014, 116.55833435058594, 117.87296772003174, 119.21208620071411, 120.55120468139648, 121.8663022518158, 123.18139982223511, 124.51198482513428, 125.84256982803345, 127.18797898292542, 128.53338813781738, 129.87414264678955, 131.21489715576172, 132.52320337295532, 133.83150959014893, 135.18191170692444, 136.53231382369995, 137.84653306007385, 139.16075229644775, 140.43417954444885, 141.70760679244995, 142.98717856407166, 144.26675033569336, 145.5814254283905, 146.89610052108765, 148.15386319160461, 149.41162586212158, 150.71005058288574, 152.0084753036499, 153.30494117736816, 154.60140705108643, 155.92992854118347, 157.25845003128052, 158.54708981513977, 159.83572959899902, 161.11630749702454, 162.39688539505005, 163.75940871238708, 165.12193202972412, 166.37479448318481, 167.6276569366455, 168.98776412010193, 170.34787130355835, 171.64190101623535, 172.93593072891235, 174.23958921432495, 175.54324769973755, 176.87783527374268, 178.2124228477478, 179.4976818561554, 180.782940864563, 182.09088945388794, 183.3988380432129, 184.68455266952515, 185.9702672958374, 187.26709127426147, 188.56391525268555, 189.87712216377258, 191.19032907485962, 192.47338485717773, 193.75644063949585, 195.0189290046692, 196.28141736984253, 197.65613436698914, 199.03085136413574, 200.34967279434204, 201.66849422454834, 203.00891947746277, 204.3493447303772, 205.70174384117126, 207.05414295196533, 208.38257694244385, 209.71101093292236, 211.05453205108643, 212.3980531692505, 213.71975326538086, 215.04145336151123, 216.32224011421204, 217.60302686691284, 218.9327790737152, 220.26253128051758, 221.57566595077515, 222.88880062103271, 224.21345591545105, 225.53811120986938, 226.95572543144226, 228.37333965301514, 229.7454960346222, 231.11765241622925, 232.4364321231842, 233.75521183013916, 235.06512260437012, 236.37503337860107, 237.70206212997437, 239.02909088134766, 240.35139966011047, 241.6737084388733, 243.0460240840912, 244.41833972930908, 245.7984437942505, 247.1785478591919, 248.52681732177734, 249.8750867843628, 251.21284818649292, 252.55060958862305, 253.8501842021942, 255.14975881576538, 256.4817969799042, 257.81383514404297, 259.1319799423218, 260.4501247406006, 261.75366735458374, 263.0572099685669, 264.3583767414093, 265.6595435142517, 268.35773253440857, 271.05592155456543]
[27.16, 27.16, 31.76, 31.76, 39.77, 39.77, 44.23, 44.23, 46.51, 46.51, 50.35, 50.35, 51.49, 51.49, 52.24, 52.24, 53.52, 53.52, 55.08, 55.08, 55.31, 55.31, 56.8, 56.8, 57.21, 57.21, 58.43, 58.43, 59.52, 59.52, 59.06, 59.06, 60.56, 60.56, 60.16, 60.16, 60.23, 60.23, 60.74, 60.74, 60.57, 60.57, 61.11, 61.11, 60.76, 60.76, 60.86, 60.86, 60.94, 60.94, 59.93, 59.93, 59.58, 59.58, 58.65, 58.65, 58.07, 58.07, 59.62, 59.62, 60.34, 60.34, 60.01, 60.01, 60.89, 60.89, 61.48, 61.48, 62.1, 62.1, 63.01, 63.01, 64.19, 64.19, 63.04, 63.04, 62.19, 62.19, 61.47, 61.47, 61.56, 61.56, 61.92, 61.92, 61.13, 61.13, 62.77, 62.77, 62.32, 62.32, 64.6, 64.6, 64.01, 64.01, 62.53, 62.53, 62.0, 62.0, 62.03, 62.03, 61.13, 61.13, 61.05, 61.05, 61.32, 61.32, 61.52, 61.52, 62.14, 62.14, 62.39, 62.39, 62.49, 62.49, 62.41, 62.41, 62.69, 62.69, 62.78, 62.78, 63.21, 63.21, 63.96, 63.96, 63.11, 63.11, 63.28, 63.28, 63.63, 63.63, 63.18, 63.18, 63.4, 63.4, 63.65, 63.65, 63.69, 63.69, 63.31, 63.31, 63.08, 63.08, 64.13, 64.13, 63.38, 63.38, 63.12, 63.12, 62.82, 62.82, 62.53, 62.53, 62.86, 62.86, 62.35, 62.35, 62.34, 62.34, 62.21, 62.21, 62.9, 62.9, 63.34, 63.34, 63.15, 63.15, 63.28, 63.28, 63.23, 63.23, 63.21, 63.21, 63.28, 63.28, 63.21, 63.21, 62.5, 62.5, 62.52, 62.52, 62.15, 62.15, 61.71, 61.71, 61.86, 61.86, 63.44, 63.44, 63.71, 63.71, 63.27, 63.27, 63.79, 63.79, 63.5, 63.5, 64.06, 64.06, 63.97, 63.97, 62.48, 62.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.797, Test loss: 2.058, Test accuracy: 19.52
Round   0, Global train loss: 1.797, Global test loss: 2.245, Global test accuracy: 16.27
Round   1, Train loss: 1.550, Test loss: 1.807, Test accuracy: 31.67
Round   1, Global train loss: 1.550, Global test loss: 2.136, Global test accuracy: 24.18
Round   2, Train loss: 1.477, Test loss: 1.614, Test accuracy: 38.81
Round   2, Global train loss: 1.477, Global test loss: 1.992, Global test accuracy: 28.84
Round   3, Train loss: 1.472, Test loss: 1.467, Test accuracy: 43.16
Round   3, Global train loss: 1.472, Global test loss: 1.808, Global test accuracy: 35.09
Round   4, Train loss: 1.521, Test loss: 1.383, Test accuracy: 45.01
Round   4, Global train loss: 1.521, Global test loss: 1.862, Global test accuracy: 26.67
Round   5, Train loss: 1.347, Test loss: 1.326, Test accuracy: 48.23
Round   5, Global train loss: 1.347, Global test loss: 1.820, Global test accuracy: 37.85
Round   6, Train loss: 1.361, Test loss: 1.292, Test accuracy: 49.84
Round   6, Global train loss: 1.361, Global test loss: 1.759, Global test accuracy: 36.83
Round   7, Train loss: 1.380, Test loss: 1.267, Test accuracy: 51.08
Round   7, Global train loss: 1.380, Global test loss: 1.737, Global test accuracy: 39.08
Round   8, Train loss: 1.348, Test loss: 1.229, Test accuracy: 52.72
Round   8, Global train loss: 1.348, Global test loss: 1.611, Global test accuracy: 40.24
Round   9, Train loss: 1.222, Test loss: 1.188, Test accuracy: 54.67
Round   9, Global train loss: 1.222, Global test loss: 1.704, Global test accuracy: 39.23
Round  10, Train loss: 1.222, Test loss: 1.169, Test accuracy: 55.85
Round  10, Global train loss: 1.222, Global test loss: 1.618, Global test accuracy: 40.03
Round  11, Train loss: 1.371, Test loss: 1.166, Test accuracy: 56.09
Round  11, Global train loss: 1.371, Global test loss: 1.574, Global test accuracy: 42.15
Round  12, Train loss: 1.164, Test loss: 1.162, Test accuracy: 55.73
Round  12, Global train loss: 1.164, Global test loss: 1.720, Global test accuracy: 41.34
Round  13, Train loss: 1.220, Test loss: 1.159, Test accuracy: 55.15
Round  13, Global train loss: 1.220, Global test loss: 1.515, Global test accuracy: 45.74
Round  14, Train loss: 1.190, Test loss: 1.108, Test accuracy: 57.87
Round  14, Global train loss: 1.190, Global test loss: 1.535, Global test accuracy: 45.85
Round  15, Train loss: 1.214, Test loss: 1.122, Test accuracy: 56.95
Round  15, Global train loss: 1.214, Global test loss: 1.511, Global test accuracy: 45.12
Round  16, Train loss: 1.206, Test loss: 1.121, Test accuracy: 56.54
Round  16, Global train loss: 1.206, Global test loss: 1.416, Global test accuracy: 49.30
Round  17, Train loss: 1.044, Test loss: 1.095, Test accuracy: 57.83
Round  17, Global train loss: 1.044, Global test loss: 1.397, Global test accuracy: 48.59
Round  18, Train loss: 1.205, Test loss: 1.090, Test accuracy: 57.66
Round  18, Global train loss: 1.205, Global test loss: 1.458, Global test accuracy: 47.52
Round  19, Train loss: 1.094, Test loss: 1.096, Test accuracy: 57.38
Round  19, Global train loss: 1.094, Global test loss: 1.496, Global test accuracy: 48.60
Round  20, Train loss: 1.191, Test loss: 1.081, Test accuracy: 58.20
Round  20, Global train loss: 1.191, Global test loss: 1.398, Global test accuracy: 49.45
Round  21, Train loss: 0.900, Test loss: 1.055, Test accuracy: 59.28
Round  21, Global train loss: 0.900, Global test loss: 1.599, Global test accuracy: 46.06
Round  22, Train loss: 1.235, Test loss: 1.048, Test accuracy: 59.85
Round  22, Global train loss: 1.235, Global test loss: 1.445, Global test accuracy: 47.97
Round  23, Train loss: 1.111, Test loss: 1.055, Test accuracy: 58.88
Round  23, Global train loss: 1.111, Global test loss: 1.371, Global test accuracy: 53.49
Round  24, Train loss: 0.955, Test loss: 1.052, Test accuracy: 58.92
Round  24, Global train loss: 0.955, Global test loss: 1.342, Global test accuracy: 53.02
Round  25, Train loss: 1.083, Test loss: 1.048, Test accuracy: 59.18
Round  25, Global train loss: 1.083, Global test loss: 1.359, Global test accuracy: 52.32
Round  26, Train loss: 1.155, Test loss: 1.029, Test accuracy: 61.34
Round  26, Global train loss: 1.155, Global test loss: 1.316, Global test accuracy: 53.86
Round  27, Train loss: 0.945, Test loss: 1.011, Test accuracy: 61.51
Round  27, Global train loss: 0.945, Global test loss: 1.374, Global test accuracy: 51.02
Round  28, Train loss: 1.125, Test loss: 1.040, Test accuracy: 59.76
Round  28, Global train loss: 1.125, Global test loss: 1.426, Global test accuracy: 50.39
Round  29, Train loss: 1.134, Test loss: 1.026, Test accuracy: 60.89
Round  29, Global train loss: 1.134, Global test loss: 1.304, Global test accuracy: 54.09
Round  30, Train loss: 1.154, Test loss: 1.014, Test accuracy: 60.81
Round  30, Global train loss: 1.154, Global test loss: 1.455, Global test accuracy: 51.68
Round  31, Train loss: 0.946, Test loss: 0.998, Test accuracy: 61.65
Round  31, Global train loss: 0.946, Global test loss: 1.379, Global test accuracy: 54.24
Round  32, Train loss: 0.967, Test loss: 0.992, Test accuracy: 61.84
Round  32, Global train loss: 0.967, Global test loss: 1.368, Global test accuracy: 53.08
Round  33, Train loss: 0.949, Test loss: 1.000, Test accuracy: 61.51
Round  33, Global train loss: 0.949, Global test loss: 1.298, Global test accuracy: 54.61
Round  34, Train loss: 1.022, Test loss: 1.005, Test accuracy: 61.79
Round  34, Global train loss: 1.022, Global test loss: 1.261, Global test accuracy: 56.75
Round  35, Train loss: 0.890, Test loss: 1.038, Test accuracy: 60.60
Round  35, Global train loss: 0.890, Global test loss: 1.333, Global test accuracy: 54.05
Round  36, Train loss: 0.887, Test loss: 1.034, Test accuracy: 60.56
Round  36, Global train loss: 0.887, Global test loss: 1.320, Global test accuracy: 53.70
Round  37, Train loss: 0.874, Test loss: 1.040, Test accuracy: 60.30
Round  37, Global train loss: 0.874, Global test loss: 1.336, Global test accuracy: 53.37
Round  38, Train loss: 0.908, Test loss: 1.013, Test accuracy: 61.71
Round  38, Global train loss: 0.908, Global test loss: 1.394, Global test accuracy: 52.23
Round  39, Train loss: 0.939, Test loss: 1.007, Test accuracy: 62.72
Round  39, Global train loss: 0.939, Global test loss: 1.235, Global test accuracy: 58.66
Round  40, Train loss: 0.810, Test loss: 1.011, Test accuracy: 62.15
Round  40, Global train loss: 0.810, Global test loss: 1.257, Global test accuracy: 56.52
Round  41, Train loss: 0.829, Test loss: 0.986, Test accuracy: 62.54
Round  41, Global train loss: 0.829, Global test loss: 1.330, Global test accuracy: 56.62
Round  42, Train loss: 0.791, Test loss: 0.989, Test accuracy: 62.82
Round  42, Global train loss: 0.791, Global test loss: 1.352, Global test accuracy: 57.32
Round  43, Train loss: 0.843, Test loss: 1.003, Test accuracy: 62.31
Round  43, Global train loss: 0.843, Global test loss: 1.329, Global test accuracy: 54.78
Round  44, Train loss: 0.956, Test loss: 1.047, Test accuracy: 60.24
Round  44, Global train loss: 0.956, Global test loss: 1.229, Global test accuracy: 58.14
Round  45, Train loss: 0.882, Test loss: 1.001, Test accuracy: 62.72
Round  45, Global train loss: 0.882, Global test loss: 1.378, Global test accuracy: 53.46
Round  46, Train loss: 0.971, Test loss: 0.989, Test accuracy: 63.27
Round  46, Global train loss: 0.971, Global test loss: 1.218, Global test accuracy: 58.44
Round  47, Train loss: 0.783, Test loss: 0.977, Test accuracy: 63.84
Round  47, Global train loss: 0.783, Global test loss: 1.303, Global test accuracy: 54.33
Round  48, Train loss: 0.861, Test loss: 0.966, Test accuracy: 64.60
Round  48, Global train loss: 0.861, Global test loss: 1.200, Global test accuracy: 58.85
Round  49, Train loss: 0.679, Test loss: 0.967, Test accuracy: 64.36
Round  49, Global train loss: 0.679, Global test loss: 1.217, Global test accuracy: 58.37
Round  50, Train loss: 0.779, Test loss: 0.963, Test accuracy: 64.57
Round  50, Global train loss: 0.779, Global test loss: 1.279, Global test accuracy: 56.63
Round  51, Train loss: 0.889, Test loss: 0.944, Test accuracy: 65.29
Round  51, Global train loss: 0.889, Global test loss: 1.219, Global test accuracy: 57.76
Round  52, Train loss: 0.823, Test loss: 0.947, Test accuracy: 64.96
Round  52, Global train loss: 0.823, Global test loss: 1.200, Global test accuracy: 58.05
Round  53, Train loss: 0.739, Test loss: 0.981, Test accuracy: 64.13
Round  53, Global train loss: 0.739, Global test loss: 1.377, Global test accuracy: 54.17
Round  54, Train loss: 0.816, Test loss: 1.016, Test accuracy: 63.79
Round  54, Global train loss: 0.816, Global test loss: 1.227, Global test accuracy: 57.75
Round  55, Train loss: 0.802, Test loss: 1.020, Test accuracy: 62.93
Round  55, Global train loss: 0.802, Global test loss: 1.245, Global test accuracy: 57.10
Round  56, Train loss: 0.733, Test loss: 1.000, Test accuracy: 64.06
Round  56, Global train loss: 0.733, Global test loss: 1.351, Global test accuracy: 55.16
Round  57, Train loss: 0.755, Test loss: 0.991, Test accuracy: 64.02
Round  57, Global train loss: 0.755, Global test loss: 1.179, Global test accuracy: 59.89
Round  58, Train loss: 0.659, Test loss: 1.029, Test accuracy: 62.68
Round  58, Global train loss: 0.659, Global test loss: 1.306, Global test accuracy: 56.64
Round  59, Train loss: 0.746, Test loss: 1.022, Test accuracy: 63.20
Round  59, Global train loss: 0.746, Global test loss: 1.354, Global test accuracy: 54.15
Round  60, Train loss: 0.716, Test loss: 1.036, Test accuracy: 62.46
Round  60, Global train loss: 0.716, Global test loss: 1.232, Global test accuracy: 57.72
Round  61, Train loss: 0.711, Test loss: 1.033, Test accuracy: 62.36
Round  61, Global train loss: 0.711, Global test loss: 1.202, Global test accuracy: 59.40
Round  62, Train loss: 0.733, Test loss: 1.025, Test accuracy: 62.80
Round  62, Global train loss: 0.733, Global test loss: 1.223, Global test accuracy: 58.59
Round  63, Train loss: 0.692, Test loss: 1.022, Test accuracy: 63.34
Round  63, Global train loss: 0.692, Global test loss: 1.275, Global test accuracy: 58.94
Round  64, Train loss: 0.830, Test loss: 1.032, Test accuracy: 63.47
Round  64, Global train loss: 0.830, Global test loss: 1.201, Global test accuracy: 59.25
Round  65, Train loss: 0.641, Test loss: 1.038, Test accuracy: 63.48
Round  65, Global train loss: 0.641, Global test loss: 1.275, Global test accuracy: 58.24
Round  66, Train loss: 0.597, Test loss: 1.013, Test accuracy: 64.16
Round  66, Global train loss: 0.597, Global test loss: 1.309, Global test accuracy: 56.68
Round  67, Train loss: 0.767, Test loss: 1.024, Test accuracy: 64.29
Round  67, Global train loss: 0.767, Global test loss: 1.355, Global test accuracy: 55.92
Round  68, Train loss: 0.624, Test loss: 1.030, Test accuracy: 63.99
Round  68, Global train loss: 0.624, Global test loss: 1.425, Global test accuracy: 53.03
Round  69, Train loss: 0.796, Test loss: 1.040, Test accuracy: 63.63
Round  69, Global train loss: 0.796, Global test loss: 1.235, Global test accuracy: 56.86
Round  70, Train loss: 0.705, Test loss: 1.058, Test accuracy: 63.76
Round  70, Global train loss: 0.705, Global test loss: 1.300, Global test accuracy: 56.61
Round  71, Train loss: 0.651, Test loss: 1.065, Test accuracy: 63.17
Round  71, Global train loss: 0.651, Global test loss: 1.457, Global test accuracy: 55.04
Round  72, Train loss: 0.660, Test loss: 1.078, Test accuracy: 63.06
Round  72, Global train loss: 0.660, Global test loss: 1.334, Global test accuracy: 57.66
Round  73, Train loss: 0.531, Test loss: 1.072, Test accuracy: 63.72
Round  73, Global train loss: 0.531, Global test loss: 1.310, Global test accuracy: 58.88
Round  74, Train loss: 0.593, Test loss: 1.081, Test accuracy: 63.76
Round  74, Global train loss: 0.593, Global test loss: 1.441, Global test accuracy: 56.41
Round  75, Train loss: 0.541, Test loss: 1.073, Test accuracy: 64.02
Round  75, Global train loss: 0.541, Global test loss: 1.424, Global test accuracy: 56.33
Round  76, Train loss: 0.537, Test loss: 1.110, Test accuracy: 63.22
Round  76, Global train loss: 0.537, Global test loss: 1.318, Global test accuracy: 57.45
Round  77, Train loss: 0.561, Test loss: 1.101, Test accuracy: 63.39
Round  77, Global train loss: 0.561, Global test loss: 1.301, Global test accuracy: 58.28
Round  78, Train loss: 0.665, Test loss: 1.098, Test accuracy: 63.78
Round  78, Global train loss: 0.665, Global test loss: 1.335, Global test accuracy: 56.76
Round  79, Train loss: 0.556, Test loss: 1.083, Test accuracy: 64.15
Round  79, Global train loss: 0.556, Global test loss: 1.407, Global test accuracy: 56.92
Round  80, Train loss: 0.494, Test loss: 1.101, Test accuracy: 63.73
Round  80, Global train loss: 0.494, Global test loss: 1.466, Global test accuracy: 55.22
Round  81, Train loss: 0.597, Test loss: 1.069, Test accuracy: 64.39
Round  81, Global train loss: 0.597, Global test loss: 1.358, Global test accuracy: 57.00
Round  82, Train loss: 0.595, Test loss: 1.086, Test accuracy: 63.94
Round  82, Global train loss: 0.595, Global test loss: 1.476, Global test accuracy: 54.08
Round  83, Train loss: 0.572, Test loss: 1.094, Test accuracy: 64.09
Round  83, Global train loss: 0.572, Global test loss: 1.366, Global test accuracy: 57.98
Round  84, Train loss: 0.677, Test loss: 1.091, Test accuracy: 63.91
Round  84, Global train loss: 0.677, Global test loss: 1.294, Global test accuracy: 58.37
Round  85, Train loss: 0.432, Test loss: 1.111, Test accuracy: 63.31
Round  85, Global train loss: 0.432, Global test loss: 1.511, Global test accuracy: 54.66
Round  86, Train loss: 0.624, Test loss: 1.153, Test accuracy: 62.88
Round  86, Global train loss: 0.624, Global test loss: 1.363, Global test accuracy: 56.56
Round  87, Train loss: 0.504, Test loss: 1.145, Test accuracy: 62.99
Round  87, Global train loss: 0.504, Global test loss: 1.474, Global test accuracy: 55.11
Round  88, Train loss: 0.503, Test loss: 1.121, Test accuracy: 63.83
Round  88, Global train loss: 0.503, Global test loss: 1.425, Global test accuracy: 56.51
Round  89, Train loss: 0.664, Test loss: 1.101, Test accuracy: 65.18
Round  89, Global train loss: 0.664, Global test loss: 1.348, Global test accuracy: 57.00
Round  90, Train loss: 0.388, Test loss: 1.105, Test accuracy: 65.16
Round  90, Global train loss: 0.388, Global test loss: 1.400, Global test accuracy: 56.59
Round  91, Train loss: 0.655, Test loss: 1.109, Test accuracy: 64.71
Round  91, Global train loss: 0.655, Global test loss: 1.263, Global test accuracy: 58.73
Round  92, Train loss: 0.663, Test loss: 1.106, Test accuracy: 65.13
Round  92, Global train loss: 0.663, Global test loss: 1.404, Global test accuracy: 56.19
Round  93, Train loss: 0.688, Test loss: 1.112, Test accuracy: 64.32
Round  93, Global train loss: 0.688, Global test loss: 1.407, Global test accuracy: 55.93/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.573, Test loss: 1.128, Test accuracy: 63.44
Round  94, Global train loss: 0.573, Global test loss: 1.485, Global test accuracy: 57.02
Round  95, Train loss: 0.437, Test loss: 1.120, Test accuracy: 63.53
Round  95, Global train loss: 0.437, Global test loss: 1.365, Global test accuracy: 58.57
Round  96, Train loss: 0.640, Test loss: 1.105, Test accuracy: 64.14
Round  96, Global train loss: 0.640, Global test loss: 1.242, Global test accuracy: 60.84
Round  97, Train loss: 0.608, Test loss: 1.092, Test accuracy: 64.81
Round  97, Global train loss: 0.608, Global test loss: 1.277, Global test accuracy: 59.49
Round  98, Train loss: 0.439, Test loss: 1.115, Test accuracy: 64.02
Round  98, Global train loss: 0.439, Global test loss: 1.528, Global test accuracy: 56.38
Round  99, Train loss: 0.429, Test loss: 1.090, Test accuracy: 65.00
Round  99, Global train loss: 0.429, Global test loss: 1.552, Global test accuracy: 56.40
Final Round, Train loss: 0.456, Test loss: 1.251, Test accuracy: 62.44
Final Round, Global train loss: 0.456, Global test loss: 1.552, Global test accuracy: 56.40
Average accuracy final 10 rounds: 64.426 

Average global accuracy final 10 rounds: 57.614 

1704.7452828884125
[1.695683240890503, 3.391366481781006, 4.761303424835205, 6.131240367889404, 7.550604581832886, 8.969968795776367, 10.387588739395142, 11.805208683013916, 13.217780351638794, 14.630352020263672, 16.07792067527771, 17.525489330291748, 18.95530128479004, 20.38511323928833, 21.776877403259277, 23.168641567230225, 24.6460120677948, 26.123382568359375, 27.47400403022766, 28.824625492095947, 30.18702483177185, 31.549424171447754, 32.91229462623596, 34.27516508102417, 35.60769963264465, 36.94023418426514, 38.30152368545532, 39.66281318664551, 41.04503536224365, 42.4272575378418, 43.78892779350281, 45.15059804916382, 46.51233649253845, 47.874074935913086, 49.23709177970886, 50.60010862350464, 51.96433734893799, 53.32856607437134, 54.69111347198486, 56.05366086959839, 57.41168546676636, 58.769710063934326, 60.12935400009155, 61.48899793624878, 62.85311436653137, 64.21723079681396, 65.576087474823, 66.93494415283203, 68.29039478302002, 69.64584541320801, 71.0020866394043, 72.35832786560059, 73.71202874183655, 75.06572961807251, 76.42044687271118, 77.77516412734985, 79.13641476631165, 80.49766540527344, 81.84369826316833, 83.18973112106323, 84.54407286643982, 85.8984146118164, 87.24252033233643, 88.58662605285645, 89.94669246673584, 91.30675888061523, 92.67340135574341, 94.04004383087158, 95.39616227149963, 96.75228071212769, 98.11023449897766, 99.46818828582764, 100.81736373901367, 102.1665391921997, 103.52194046974182, 104.87734174728394, 106.23518466949463, 107.59302759170532, 108.94564747810364, 110.29826736450195, 111.6534833908081, 113.00869941711426, 114.36145567893982, 115.71421194076538, 117.06981658935547, 118.42542123794556, 119.8768560886383, 121.32829093933105, 122.69471073150635, 124.06113052368164, 125.42090678215027, 126.7806830406189, 128.1443784236908, 129.5080738067627, 130.87454104423523, 132.24100828170776, 133.60229969024658, 134.9635910987854, 136.39310455322266, 137.8226180076599, 139.1985375881195, 140.5744571685791, 141.94607090950012, 143.31768465042114, 144.67778325080872, 146.0378818511963, 147.40667629241943, 148.77547073364258, 150.13728165626526, 151.49909257888794, 152.86386036872864, 154.22862815856934, 155.5881905555725, 156.94775295257568, 158.3085253238678, 159.6692976951599, 161.02127480506897, 162.37325191497803, 163.72412824630737, 165.07500457763672, 166.42834854125977, 167.7816925048828, 169.14001202583313, 170.49833154678345, 171.85806488990784, 173.21779823303223, 174.57733511924744, 175.93687200546265, 177.29356694221497, 178.65026187896729, 180.00955724716187, 181.36885261535645, 182.72940802574158, 184.0899634361267, 185.44826745986938, 186.80657148361206, 188.16639304161072, 189.52621459960938, 190.8879873752594, 192.24976015090942, 193.61656141281128, 194.98336267471313, 196.3540289402008, 197.72469520568848, 199.08070635795593, 200.4367175102234, 201.7933430671692, 203.149968624115, 204.50650906562805, 205.8630495071411, 207.22917485237122, 208.59530019760132, 209.95526480674744, 211.31522941589355, 212.66476941108704, 214.01430940628052, 215.38068532943726, 216.747061252594, 218.11902165412903, 219.49098205566406, 220.84926891326904, 222.20755577087402, 223.5764355659485, 224.94531536102295, 226.30809664726257, 227.6708779335022, 229.0191342830658, 230.3673906326294, 231.73038172721863, 233.09337282180786, 234.44969391822815, 235.80601501464844, 237.15978479385376, 238.51355457305908, 239.86835050582886, 241.22314643859863, 242.58785200119019, 243.95255756378174, 245.31014132499695, 246.66772508621216, 248.02480006217957, 249.38187503814697, 250.74320554733276, 252.10453605651855, 253.462890625, 254.82124519348145, 256.1782832145691, 257.53532123565674, 258.89744997024536, 260.259578704834, 261.6207630634308, 262.9819474220276, 264.3351037502289, 265.6882600784302, 267.0487017631531, 268.409143447876, 269.8464856147766, 271.28382778167725, 272.7081127166748, 274.13239765167236, 277.0020582675934, 279.8717188835144]
[19.52, 19.52, 31.67, 31.67, 38.81, 38.81, 43.16, 43.16, 45.01, 45.01, 48.23, 48.23, 49.84, 49.84, 51.08, 51.08, 52.72, 52.72, 54.67, 54.67, 55.85, 55.85, 56.09, 56.09, 55.73, 55.73, 55.15, 55.15, 57.87, 57.87, 56.95, 56.95, 56.54, 56.54, 57.83, 57.83, 57.66, 57.66, 57.38, 57.38, 58.2, 58.2, 59.28, 59.28, 59.85, 59.85, 58.88, 58.88, 58.92, 58.92, 59.18, 59.18, 61.34, 61.34, 61.51, 61.51, 59.76, 59.76, 60.89, 60.89, 60.81, 60.81, 61.65, 61.65, 61.84, 61.84, 61.51, 61.51, 61.79, 61.79, 60.6, 60.6, 60.56, 60.56, 60.3, 60.3, 61.71, 61.71, 62.72, 62.72, 62.15, 62.15, 62.54, 62.54, 62.82, 62.82, 62.31, 62.31, 60.24, 60.24, 62.72, 62.72, 63.27, 63.27, 63.84, 63.84, 64.6, 64.6, 64.36, 64.36, 64.57, 64.57, 65.29, 65.29, 64.96, 64.96, 64.13, 64.13, 63.79, 63.79, 62.93, 62.93, 64.06, 64.06, 64.02, 64.02, 62.68, 62.68, 63.2, 63.2, 62.46, 62.46, 62.36, 62.36, 62.8, 62.8, 63.34, 63.34, 63.47, 63.47, 63.48, 63.48, 64.16, 64.16, 64.29, 64.29, 63.99, 63.99, 63.63, 63.63, 63.76, 63.76, 63.17, 63.17, 63.06, 63.06, 63.72, 63.72, 63.76, 63.76, 64.02, 64.02, 63.22, 63.22, 63.39, 63.39, 63.78, 63.78, 64.15, 64.15, 63.73, 63.73, 64.39, 64.39, 63.94, 63.94, 64.09, 64.09, 63.91, 63.91, 63.31, 63.31, 62.88, 62.88, 62.99, 62.99, 63.83, 63.83, 65.18, 65.18, 65.16, 65.16, 64.71, 64.71, 65.13, 65.13, 64.32, 64.32, 63.44, 63.44, 63.53, 63.53, 64.14, 64.14, 64.81, 64.81, 64.02, 64.02, 65.0, 65.0, 62.44, 62.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.725, Test loss: 2.031, Test accuracy: 22.65
Round   0, Global train loss: 1.725, Global test loss: 2.219, Global test accuracy: 18.43
Round   1, Train loss: 1.655, Test loss: 1.905, Test accuracy: 30.59
Round   1, Global train loss: 1.655, Global test loss: 2.264, Global test accuracy: 24.79
Round   2, Train loss: 1.553, Test loss: 1.686, Test accuracy: 36.97
Round   2, Global train loss: 1.553, Global test loss: 1.966, Global test accuracy: 32.82
Round   3, Train loss: 1.517, Test loss: 1.536, Test accuracy: 41.63
Round   3, Global train loss: 1.517, Global test loss: 1.954, Global test accuracy: 32.82
Round   4, Train loss: 1.385, Test loss: 1.463, Test accuracy: 43.80
Round   4, Global train loss: 1.385, Global test loss: 2.070, Global test accuracy: 20.85
Round   5, Train loss: 1.371, Test loss: 1.353, Test accuracy: 48.44
Round   5, Global train loss: 1.371, Global test loss: 1.835, Global test accuracy: 37.53
Round   6, Train loss: 1.278, Test loss: 1.341, Test accuracy: 49.07
Round   6, Global train loss: 1.278, Global test loss: 1.817, Global test accuracy: 37.44
Round   7, Train loss: 1.346, Test loss: 1.292, Test accuracy: 50.49
Round   7, Global train loss: 1.346, Global test loss: 1.727, Global test accuracy: 38.53
Round   8, Train loss: 1.311, Test loss: 1.247, Test accuracy: 51.36
Round   8, Global train loss: 1.311, Global test loss: 1.748, Global test accuracy: 36.13
Round   9, Train loss: 1.174, Test loss: 1.223, Test accuracy: 52.51
Round   9, Global train loss: 1.174, Global test loss: 1.798, Global test accuracy: 40.14
Round  10, Train loss: 1.320, Test loss: 1.262, Test accuracy: 51.73
Round  10, Global train loss: 1.320, Global test loss: 1.748, Global test accuracy: 38.18
Round  11, Train loss: 1.180, Test loss: 1.267, Test accuracy: 51.32
Round  11, Global train loss: 1.180, Global test loss: 1.774, Global test accuracy: 41.87
Round  12, Train loss: 1.075, Test loss: 1.247, Test accuracy: 51.67
Round  12, Global train loss: 1.075, Global test loss: 1.687, Global test accuracy: 44.94
Round  13, Train loss: 1.168, Test loss: 1.207, Test accuracy: 53.41
Round  13, Global train loss: 1.168, Global test loss: 1.557, Global test accuracy: 47.37
Round  14, Train loss: 1.204, Test loss: 1.213, Test accuracy: 53.97
Round  14, Global train loss: 1.204, Global test loss: 1.598, Global test accuracy: 43.37
Round  15, Train loss: 1.081, Test loss: 1.240, Test accuracy: 53.65
Round  15, Global train loss: 1.081, Global test loss: 1.735, Global test accuracy: 45.72
Round  16, Train loss: 1.187, Test loss: 1.208, Test accuracy: 55.08
Round  16, Global train loss: 1.187, Global test loss: 1.578, Global test accuracy: 45.20
Round  17, Train loss: 1.120, Test loss: 1.232, Test accuracy: 54.48
Round  17, Global train loss: 1.120, Global test loss: 1.667, Global test accuracy: 45.74
Round  18, Train loss: 1.151, Test loss: 1.258, Test accuracy: 53.45
Round  18, Global train loss: 1.151, Global test loss: 1.618, Global test accuracy: 44.83
Round  19, Train loss: 1.148, Test loss: 1.215, Test accuracy: 54.28
Round  19, Global train loss: 1.148, Global test loss: 1.576, Global test accuracy: 45.48
Round  20, Train loss: 1.090, Test loss: 1.212, Test accuracy: 54.39
Round  20, Global train loss: 1.090, Global test loss: 1.489, Global test accuracy: 48.94
Round  21, Train loss: 1.073, Test loss: 1.188, Test accuracy: 55.51
Round  21, Global train loss: 1.073, Global test loss: 1.748, Global test accuracy: 46.05
Round  22, Train loss: 0.875, Test loss: 1.122, Test accuracy: 57.77
Round  22, Global train loss: 0.875, Global test loss: 1.470, Global test accuracy: 49.31
Round  23, Train loss: 1.017, Test loss: 1.116, Test accuracy: 58.26
Round  23, Global train loss: 1.017, Global test loss: 1.479, Global test accuracy: 53.10
Round  24, Train loss: 1.065, Test loss: 1.126, Test accuracy: 57.73
Round  24, Global train loss: 1.065, Global test loss: 1.382, Global test accuracy: 53.26
Round  25, Train loss: 0.929, Test loss: 1.117, Test accuracy: 58.36
Round  25, Global train loss: 0.929, Global test loss: 1.395, Global test accuracy: 53.20
Round  26, Train loss: 0.861, Test loss: 1.117, Test accuracy: 58.60
Round  26, Global train loss: 0.861, Global test loss: 1.309, Global test accuracy: 54.13
Round  27, Train loss: 0.915, Test loss: 1.112, Test accuracy: 58.25
Round  27, Global train loss: 0.915, Global test loss: 1.371, Global test accuracy: 51.93
Round  28, Train loss: 0.929, Test loss: 1.110, Test accuracy: 57.84
Round  28, Global train loss: 0.929, Global test loss: 1.391, Global test accuracy: 52.73
Round  29, Train loss: 0.890, Test loss: 1.117, Test accuracy: 58.18
Round  29, Global train loss: 0.890, Global test loss: 1.499, Global test accuracy: 48.01
Round  30, Train loss: 0.763, Test loss: 1.135, Test accuracy: 57.86
Round  30, Global train loss: 0.763, Global test loss: 1.544, Global test accuracy: 48.65
Round  31, Train loss: 0.920, Test loss: 1.094, Test accuracy: 59.52
Round  31, Global train loss: 0.920, Global test loss: 1.447, Global test accuracy: 53.27
Round  32, Train loss: 0.845, Test loss: 1.106, Test accuracy: 59.99
Round  32, Global train loss: 0.845, Global test loss: 1.282, Global test accuracy: 56.87
Round  33, Train loss: 0.874, Test loss: 1.086, Test accuracy: 60.39
Round  33, Global train loss: 0.874, Global test loss: 1.253, Global test accuracy: 57.04
Round  34, Train loss: 0.719, Test loss: 1.082, Test accuracy: 60.72
Round  34, Global train loss: 0.719, Global test loss: 1.355, Global test accuracy: 53.01
Round  35, Train loss: 0.871, Test loss: 1.088, Test accuracy: 60.45
Round  35, Global train loss: 0.871, Global test loss: 1.270, Global test accuracy: 57.95
Round  36, Train loss: 0.896, Test loss: 1.099, Test accuracy: 60.05
Round  36, Global train loss: 0.896, Global test loss: 1.406, Global test accuracy: 53.79
Round  37, Train loss: 0.700, Test loss: 1.106, Test accuracy: 59.73
Round  37, Global train loss: 0.700, Global test loss: 1.319, Global test accuracy: 55.74
Round  38, Train loss: 0.658, Test loss: 1.108, Test accuracy: 59.76
Round  38, Global train loss: 0.658, Global test loss: 1.293, Global test accuracy: 58.30
Round  39, Train loss: 0.929, Test loss: 1.085, Test accuracy: 61.19
Round  39, Global train loss: 0.929, Global test loss: 1.314, Global test accuracy: 55.97
Round  40, Train loss: 0.753, Test loss: 1.065, Test accuracy: 61.83
Round  40, Global train loss: 0.753, Global test loss: 1.280, Global test accuracy: 58.78
Round  41, Train loss: 0.712, Test loss: 1.079, Test accuracy: 61.34
Round  41, Global train loss: 0.712, Global test loss: 1.421, Global test accuracy: 55.71
Round  42, Train loss: 0.857, Test loss: 1.069, Test accuracy: 61.80
Round  42, Global train loss: 0.857, Global test loss: 1.364, Global test accuracy: 57.72
Round  43, Train loss: 0.765, Test loss: 1.083, Test accuracy: 61.67
Round  43, Global train loss: 0.765, Global test loss: 1.371, Global test accuracy: 54.38
Round  44, Train loss: 0.831, Test loss: 1.071, Test accuracy: 62.08
Round  44, Global train loss: 0.831, Global test loss: 1.376, Global test accuracy: 56.17
Round  45, Train loss: 0.871, Test loss: 1.078, Test accuracy: 62.49
Round  45, Global train loss: 0.871, Global test loss: 1.416, Global test accuracy: 54.04
Round  46, Train loss: 0.569, Test loss: 1.040, Test accuracy: 63.87
Round  46, Global train loss: 0.569, Global test loss: 1.231, Global test accuracy: 60.27
Round  47, Train loss: 0.772, Test loss: 1.034, Test accuracy: 63.72
Round  47, Global train loss: 0.772, Global test loss: 1.245, Global test accuracy: 59.11
Round  48, Train loss: 0.753, Test loss: 1.042, Test accuracy: 63.72
Round  48, Global train loss: 0.753, Global test loss: 1.250, Global test accuracy: 59.22
Round  49, Train loss: 0.605, Test loss: 1.038, Test accuracy: 64.10
Round  49, Global train loss: 0.605, Global test loss: 1.276, Global test accuracy: 59.76
Round  50, Train loss: 0.745, Test loss: 1.058, Test accuracy: 63.44
Round  50, Global train loss: 0.745, Global test loss: 1.326, Global test accuracy: 57.32
Round  51, Train loss: 0.704, Test loss: 1.058, Test accuracy: 62.96
Round  51, Global train loss: 0.704, Global test loss: 1.207, Global test accuracy: 60.38
Round  52, Train loss: 0.604, Test loss: 1.077, Test accuracy: 62.41
Round  52, Global train loss: 0.604, Global test loss: 1.221, Global test accuracy: 60.10
Round  53, Train loss: 0.884, Test loss: 1.079, Test accuracy: 62.75
Round  53, Global train loss: 0.884, Global test loss: 1.356, Global test accuracy: 56.57
Round  54, Train loss: 0.535, Test loss: 1.081, Test accuracy: 62.58
Round  54, Global train loss: 0.535, Global test loss: 1.264, Global test accuracy: 60.34
Round  55, Train loss: 0.495, Test loss: 1.079, Test accuracy: 62.89
Round  55, Global train loss: 0.495, Global test loss: 1.324, Global test accuracy: 59.19
Round  56, Train loss: 0.860, Test loss: 1.108, Test accuracy: 62.35
Round  56, Global train loss: 0.860, Global test loss: 1.330, Global test accuracy: 56.98
Round  57, Train loss: 0.688, Test loss: 1.118, Test accuracy: 62.43
Round  57, Global train loss: 0.688, Global test loss: 1.198, Global test accuracy: 60.47
Round  58, Train loss: 0.577, Test loss: 1.134, Test accuracy: 61.69
Round  58, Global train loss: 0.577, Global test loss: 1.450, Global test accuracy: 57.49
Round  59, Train loss: 0.641, Test loss: 1.147, Test accuracy: 61.82
Round  59, Global train loss: 0.641, Global test loss: 1.339, Global test accuracy: 58.48
Round  60, Train loss: 0.643, Test loss: 1.129, Test accuracy: 62.75
Round  60, Global train loss: 0.643, Global test loss: 1.287, Global test accuracy: 60.40
Round  61, Train loss: 0.770, Test loss: 1.144, Test accuracy: 62.17
Round  61, Global train loss: 0.770, Global test loss: 1.211, Global test accuracy: 61.31
Round  62, Train loss: 0.621, Test loss: 1.159, Test accuracy: 60.99
Round  62, Global train loss: 0.621, Global test loss: 1.276, Global test accuracy: 60.47
Round  63, Train loss: 0.505, Test loss: 1.171, Test accuracy: 60.91
Round  63, Global train loss: 0.505, Global test loss: 1.391, Global test accuracy: 60.10
Round  64, Train loss: 0.615, Test loss: 1.170, Test accuracy: 60.98
Round  64, Global train loss: 0.615, Global test loss: 1.280, Global test accuracy: 59.82
Round  65, Train loss: 0.657, Test loss: 1.160, Test accuracy: 62.24
Round  65, Global train loss: 0.657, Global test loss: 1.236, Global test accuracy: 61.16
Round  66, Train loss: 0.528, Test loss: 1.153, Test accuracy: 61.86
Round  66, Global train loss: 0.528, Global test loss: 1.289, Global test accuracy: 59.71
Round  67, Train loss: 0.636, Test loss: 1.182, Test accuracy: 61.22
Round  67, Global train loss: 0.636, Global test loss: 1.349, Global test accuracy: 56.98
Round  68, Train loss: 0.610, Test loss: 1.180, Test accuracy: 61.60
Round  68, Global train loss: 0.610, Global test loss: 1.259, Global test accuracy: 59.69
Round  69, Train loss: 0.660, Test loss: 1.192, Test accuracy: 61.66
Round  69, Global train loss: 0.660, Global test loss: 1.279, Global test accuracy: 57.96
Round  70, Train loss: 0.674, Test loss: 1.196, Test accuracy: 62.30
Round  70, Global train loss: 0.674, Global test loss: 1.382, Global test accuracy: 56.04
Round  71, Train loss: 0.655, Test loss: 1.209, Test accuracy: 61.80
Round  71, Global train loss: 0.655, Global test loss: 1.401, Global test accuracy: 55.46
Round  72, Train loss: 0.551, Test loss: 1.173, Test accuracy: 63.40
Round  72, Global train loss: 0.551, Global test loss: 1.335, Global test accuracy: 59.43
Round  73, Train loss: 0.575, Test loss: 1.162, Test accuracy: 63.81
Round  73, Global train loss: 0.575, Global test loss: 1.293, Global test accuracy: 60.14
Round  74, Train loss: 0.535, Test loss: 1.141, Test accuracy: 64.36
Round  74, Global train loss: 0.535, Global test loss: 1.458, Global test accuracy: 57.19
Round  75, Train loss: 0.587, Test loss: 1.198, Test accuracy: 63.12
Round  75, Global train loss: 0.587, Global test loss: 1.405, Global test accuracy: 56.53
Round  76, Train loss: 0.589, Test loss: 1.209, Test accuracy: 62.61
Round  76, Global train loss: 0.589, Global test loss: 1.391, Global test accuracy: 55.89
Round  77, Train loss: 0.636, Test loss: 1.180, Test accuracy: 63.24
Round  77, Global train loss: 0.636, Global test loss: 1.297, Global test accuracy: 58.30
Round  78, Train loss: 0.694, Test loss: 1.192, Test accuracy: 63.04
Round  78, Global train loss: 0.694, Global test loss: 1.381, Global test accuracy: 56.48
Round  79, Train loss: 0.623, Test loss: 1.178, Test accuracy: 63.59
Round  79, Global train loss: 0.623, Global test loss: 1.342, Global test accuracy: 58.84
Round  80, Train loss: 0.655, Test loss: 1.238, Test accuracy: 61.94
Round  80, Global train loss: 0.655, Global test loss: 1.469, Global test accuracy: 53.88
Round  81, Train loss: 0.429, Test loss: 1.279, Test accuracy: 61.51
Round  81, Global train loss: 0.429, Global test loss: 1.467, Global test accuracy: 56.88
Round  82, Train loss: 0.637, Test loss: 1.243, Test accuracy: 63.00
Round  82, Global train loss: 0.637, Global test loss: 1.593, Global test accuracy: 52.81
Round  83, Train loss: 0.555, Test loss: 1.207, Test accuracy: 63.23
Round  83, Global train loss: 0.555, Global test loss: 1.479, Global test accuracy: 57.07
Round  84, Train loss: 0.513, Test loss: 1.242, Test accuracy: 62.57
Round  84, Global train loss: 0.513, Global test loss: 1.419, Global test accuracy: 57.33
Round  85, Train loss: 0.596, Test loss: 1.251, Test accuracy: 62.62
Round  85, Global train loss: 0.596, Global test loss: 1.530, Global test accuracy: 54.80
Round  86, Train loss: 0.393, Test loss: 1.233, Test accuracy: 63.21
Round  86, Global train loss: 0.393, Global test loss: 1.344, Global test accuracy: 60.15
Round  87, Train loss: 0.522, Test loss: 1.254, Test accuracy: 62.81
Round  87, Global train loss: 0.522, Global test loss: 1.420, Global test accuracy: 56.75
Round  88, Train loss: 0.525, Test loss: 1.272, Test accuracy: 62.28
Round  88, Global train loss: 0.525, Global test loss: 1.567, Global test accuracy: 55.17
Round  89, Train loss: 0.556, Test loss: 1.244, Test accuracy: 63.19
Round  89, Global train loss: 0.556, Global test loss: 1.530, Global test accuracy: 55.07
Round  90, Train loss: 0.477, Test loss: 1.228, Test accuracy: 63.80
Round  90, Global train loss: 0.477, Global test loss: 1.475, Global test accuracy: 56.06
Round  91, Train loss: 0.545, Test loss: 1.245, Test accuracy: 63.43
Round  91, Global train loss: 0.545, Global test loss: 1.369, Global test accuracy: 58.10
Round  92, Train loss: 0.585, Test loss: 1.248, Test accuracy: 63.56
Round  92, Global train loss: 0.585, Global test loss: 1.424, Global test accuracy: 57.08
Round  93, Train loss: 0.426, Test loss: 1.245, Test accuracy: 63.26
Round  93, Global train loss: 0.426, Global test loss: 1.500, Global test accuracy: 57.68
Round  94, Train loss: 0.498, Test loss: 1.271, Test accuracy: 62.90
Round  94, Global train loss: 0.498, Global test loss: 1.576, Global test accuracy: 58.69
Round  95, Train loss: 0.485, Test loss: 1.270, Test accuracy: 62.77
Round  95, Global train loss: 0.485, Global test loss: 1.419, Global test accuracy: 58.77
Round  96, Train loss: 0.483, Test loss: 1.273, Test accuracy: 63.11
Round  96, Global train loss: 0.483, Global test loss: 1.329, Global test accuracy: 61.04
Round  97, Train loss: 0.404, Test loss: 1.262, Test accuracy: 63.39
Round  97, Global train loss: 0.404, Global test loss: 1.352, Global test accuracy: 61.76
Round  98, Train loss: 0.513, Test loss: 1.304, Test accuracy: 62.53
Round  98, Global train loss: 0.513, Global test loss: 1.562, Global test accuracy: 58.06
Round  99, Train loss: 0.391, Test loss: 1.272, Test accuracy: 63.05
Round  99, Global train loss: 0.391, Global test loss: 1.495, Global test accuracy: 59.21
Final Round, Train loss: 0.396, Test loss: 1.373, Test accuracy: 63.19
Final Round, Global train loss: 0.396, Global test loss: 1.495, Global test accuracy: 59.21
Average accuracy final 10 rounds: 63.18
Average global accuracy final 10 rounds: 58.645
2411.984956264496
[3.117182731628418, 5.906717538833618, 8.690619945526123, 11.490078926086426, 14.287520408630371, 17.099186658859253, 19.895631074905396, 22.71554183959961, 25.50331997871399, 28.313596725463867, 31.109187602996826, 33.89738345146179, 36.6981463432312, 39.50045919418335, 42.303471326828, 45.082825899124146, 47.87777781486511, 50.68978214263916, 53.48228693008423, 56.313812255859375, 59.11117243766785, 61.900479316711426, 64.69268107414246, 67.49583697319031, 70.29189729690552, 73.07128262519836, 75.87694358825684, 78.71407270431519, 81.55304193496704, 84.44060826301575, 87.31311631202698, 90.17290997505188, 93.02505540847778, 95.8626320362091, 98.69089126586914, 101.54246926307678, 104.59369421005249, 107.63027620315552, 110.6508994102478, 113.66335105895996, 116.69108009338379, 119.70654821395874, 122.71416640281677, 125.72997903823853, 128.80843687057495, 131.847350358963, 134.865385055542, 137.9155251979828, 140.95343828201294, 143.97222685813904, 146.95528888702393, 149.9598033428192, 152.98624897003174, 155.9782211780548, 158.99531745910645, 161.9928994178772, 164.99406576156616, 168.014502286911, 171.00729751586914, 174.02143788337708, 177.01908779144287, 180.02625632286072, 183.02536416053772, 186.01491951942444, 189.04692459106445, 191.93830585479736, 194.8122274875641, 197.66374611854553, 200.50892329216003, 203.3408191204071, 206.26070284843445, 209.12546396255493, 212.10094213485718, 214.97010564804077, 217.92555809020996, 220.81914567947388, 223.80568385124207, 226.78595089912415, 229.7521231174469, 232.83779525756836, 235.80584836006165, 238.80342078208923, 241.75704526901245, 244.68583631515503, 247.62643957138062, 250.6271195411682, 253.59469556808472, 256.83594393730164, 259.77632451057434, 262.7786557674408, 265.946426153183, 268.903048992157, 271.8560104370117, 274.8823654651642, 277.9421091079712, 280.9221656322479, 283.79054975509644, 286.6227035522461, 289.43838143348694, 292.37997126579285, 297.7396547794342]
[22.65, 30.59, 36.97, 41.63, 43.8, 48.44, 49.07, 50.49, 51.36, 52.51, 51.73, 51.32, 51.67, 53.41, 53.97, 53.65, 55.08, 54.48, 53.45, 54.28, 54.39, 55.51, 57.77, 58.26, 57.73, 58.36, 58.6, 58.25, 57.84, 58.18, 57.86, 59.52, 59.99, 60.39, 60.72, 60.45, 60.05, 59.73, 59.76, 61.19, 61.83, 61.34, 61.8, 61.67, 62.08, 62.49, 63.87, 63.72, 63.72, 64.1, 63.44, 62.96, 62.41, 62.75, 62.58, 62.89, 62.35, 62.43, 61.69, 61.82, 62.75, 62.17, 60.99, 60.91, 60.98, 62.24, 61.86, 61.22, 61.6, 61.66, 62.3, 61.8, 63.4, 63.81, 64.36, 63.12, 62.61, 63.24, 63.04, 63.59, 61.94, 61.51, 63.0, 63.23, 62.57, 62.62, 63.21, 62.81, 62.28, 63.19, 63.8, 63.43, 63.56, 63.26, 62.9, 62.77, 63.11, 63.39, 62.53, 63.05, 63.19]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.972, Test loss: 2.173, Test accuracy: 18.92
Round   1, Train loss: 1.705, Test loss: 1.922, Test accuracy: 30.24
Round   2, Train loss: 1.524, Test loss: 1.637, Test accuracy: 39.14
Round   3, Train loss: 1.415, Test loss: 1.481, Test accuracy: 43.64
Round   4, Train loss: 1.494, Test loss: 1.400, Test accuracy: 46.92
Round   5, Train loss: 1.203, Test loss: 1.241, Test accuracy: 52.94
Round   6, Train loss: 1.337, Test loss: 1.212, Test accuracy: 54.10
Round   7, Train loss: 1.388, Test loss: 1.170, Test accuracy: 56.22
Round   8, Train loss: 1.352, Test loss: 1.136, Test accuracy: 58.34
Round   9, Train loss: 1.295, Test loss: 1.110, Test accuracy: 59.52
Round  10, Train loss: 1.209, Test loss: 1.121, Test accuracy: 59.35
Round  11, Train loss: 1.317, Test loss: 1.089, Test accuracy: 61.17
Round  12, Train loss: 1.213, Test loss: 1.077, Test accuracy: 62.29
Round  13, Train loss: 1.033, Test loss: 1.057, Test accuracy: 63.05
Round  14, Train loss: 1.263, Test loss: 1.039, Test accuracy: 63.09
Round  15, Train loss: 1.024, Test loss: 1.035, Test accuracy: 63.59
Round  16, Train loss: 1.128, Test loss: 1.014, Test accuracy: 63.05
Round  17, Train loss: 1.083, Test loss: 1.024, Test accuracy: 62.75
Round  18, Train loss: 1.183, Test loss: 1.006, Test accuracy: 63.17
Round  19, Train loss: 1.120, Test loss: 1.003, Test accuracy: 62.54
Round  20, Train loss: 1.143, Test loss: 0.975, Test accuracy: 63.99
Round  21, Train loss: 1.072, Test loss: 0.973, Test accuracy: 63.81
Round  22, Train loss: 1.050, Test loss: 0.950, Test accuracy: 64.12
Round  23, Train loss: 1.043, Test loss: 0.958, Test accuracy: 63.70
Round  24, Train loss: 1.083, Test loss: 0.943, Test accuracy: 64.85
Round  25, Train loss: 0.943, Test loss: 0.933, Test accuracy: 65.58
Round  26, Train loss: 0.986, Test loss: 0.942, Test accuracy: 65.00
Round  27, Train loss: 1.031, Test loss: 0.923, Test accuracy: 65.75
Round  28, Train loss: 0.995, Test loss: 0.919, Test accuracy: 65.81
Round  29, Train loss: 0.957, Test loss: 0.904, Test accuracy: 66.55
Round  30, Train loss: 0.918, Test loss: 0.897, Test accuracy: 66.65
Round  31, Train loss: 0.965, Test loss: 0.891, Test accuracy: 66.99
Round  32, Train loss: 0.931, Test loss: 0.876, Test accuracy: 67.57
Round  33, Train loss: 0.790, Test loss: 0.881, Test accuracy: 66.89
Round  34, Train loss: 0.895, Test loss: 0.873, Test accuracy: 67.29
Round  35, Train loss: 0.882, Test loss: 0.863, Test accuracy: 67.49
Round  36, Train loss: 0.891, Test loss: 0.859, Test accuracy: 68.90
Round  37, Train loss: 0.792, Test loss: 0.859, Test accuracy: 69.00
Round  38, Train loss: 0.755, Test loss: 0.845, Test accuracy: 69.54
Round  39, Train loss: 1.039, Test loss: 0.837, Test accuracy: 69.39
Round  40, Train loss: 0.848, Test loss: 0.849, Test accuracy: 69.01
Round  41, Train loss: 0.981, Test loss: 0.837, Test accuracy: 69.13
Round  42, Train loss: 1.042, Test loss: 0.833, Test accuracy: 68.83
Round  43, Train loss: 0.929, Test loss: 0.828, Test accuracy: 69.09
Round  44, Train loss: 0.873, Test loss: 0.836, Test accuracy: 69.08
Round  45, Train loss: 0.741, Test loss: 0.822, Test accuracy: 69.89
Round  46, Train loss: 0.800, Test loss: 0.828, Test accuracy: 69.04
Round  47, Train loss: 0.910, Test loss: 0.826, Test accuracy: 69.36
Round  48, Train loss: 0.719, Test loss: 0.823, Test accuracy: 69.18
Round  49, Train loss: 0.765, Test loss: 0.823, Test accuracy: 69.30
Round  50, Train loss: 0.739, Test loss: 0.819, Test accuracy: 68.56
Round  51, Train loss: 0.959, Test loss: 0.817, Test accuracy: 68.41
Round  52, Train loss: 0.687, Test loss: 0.817, Test accuracy: 68.77
Round  53, Train loss: 0.900, Test loss: 0.823, Test accuracy: 68.26
Round  54, Train loss: 0.680, Test loss: 0.828, Test accuracy: 68.15
Round  55, Train loss: 0.657, Test loss: 0.822, Test accuracy: 68.55
Round  56, Train loss: 0.786, Test loss: 0.805, Test accuracy: 70.37
Round  57, Train loss: 0.918, Test loss: 0.801, Test accuracy: 69.64
Round  58, Train loss: 0.660, Test loss: 0.800, Test accuracy: 69.92
Round  59, Train loss: 0.617, Test loss: 0.801, Test accuracy: 69.96
Round  60, Train loss: 0.608, Test loss: 0.799, Test accuracy: 70.15
Round  61, Train loss: 0.786, Test loss: 0.800, Test accuracy: 70.05
Round  62, Train loss: 0.719, Test loss: 0.786, Test accuracy: 70.78
Round  63, Train loss: 0.692, Test loss: 0.791, Test accuracy: 70.83
Round  64, Train loss: 0.780, Test loss: 0.791, Test accuracy: 70.78
Round  65, Train loss: 0.817, Test loss: 0.789, Test accuracy: 70.56
Round  66, Train loss: 0.682, Test loss: 0.790, Test accuracy: 70.17
Round  67, Train loss: 0.805, Test loss: 0.790, Test accuracy: 70.21
Round  68, Train loss: 0.683, Test loss: 0.798, Test accuracy: 69.43
Round  69, Train loss: 0.679, Test loss: 0.803, Test accuracy: 69.30
Round  70, Train loss: 0.817, Test loss: 0.791, Test accuracy: 70.18
Round  71, Train loss: 0.777, Test loss: 0.787, Test accuracy: 70.37
Round  72, Train loss: 0.584, Test loss: 0.789, Test accuracy: 70.44
Round  73, Train loss: 0.615, Test loss: 0.788, Test accuracy: 70.48
Round  74, Train loss: 0.569, Test loss: 0.791, Test accuracy: 70.50
Round  75, Train loss: 0.728, Test loss: 0.790, Test accuracy: 70.31
Round  76, Train loss: 0.644, Test loss: 0.795, Test accuracy: 69.77
Round  77, Train loss: 0.699, Test loss: 0.807, Test accuracy: 69.36
Round  78, Train loss: 0.734, Test loss: 0.804, Test accuracy: 69.95
Round  79, Train loss: 0.600, Test loss: 0.792, Test accuracy: 70.24
Round  80, Train loss: 0.690, Test loss: 0.794, Test accuracy: 69.92
Round  81, Train loss: 0.533, Test loss: 0.790, Test accuracy: 70.64
Round  82, Train loss: 0.702, Test loss: 0.785, Test accuracy: 70.91
Round  83, Train loss: 0.555, Test loss: 0.791, Test accuracy: 70.64
Round  84, Train loss: 0.651, Test loss: 0.791, Test accuracy: 70.90
Round  85, Train loss: 0.573, Test loss: 0.796, Test accuracy: 70.59
Round  86, Train loss: 0.599, Test loss: 0.786, Test accuracy: 70.52
Round  87, Train loss: 0.479, Test loss: 0.802, Test accuracy: 70.37
Round  88, Train loss: 0.617, Test loss: 0.797, Test accuracy: 70.09
Round  89, Train loss: 0.724, Test loss: 0.795, Test accuracy: 69.69
Round  90, Train loss: 0.527, Test loss: 0.793, Test accuracy: 70.56
Round  91, Train loss: 0.705, Test loss: 0.801, Test accuracy: 69.65
Round  92, Train loss: 0.767, Test loss: 0.800, Test accuracy: 70.26
Round  93, Train loss: 0.493, Test loss: 0.794, Test accuracy: 69.74
Round  94, Train loss: 0.749, Test loss: 0.792, Test accuracy: 69.96
Round  95, Train loss: 0.413, Test loss: 0.778, Test accuracy: 70.69
Round  96, Train loss: 0.562, Test loss: 0.782, Test accuracy: 70.50
Round  97, Train loss: 0.628, Test loss: 0.790, Test accuracy: 70.26
Round  98, Train loss: 0.555, Test loss: 0.789, Test accuracy: 70.11
Round  99, Train loss: 0.660, Test loss: 0.799, Test accuracy: 70.60
Final Round, Train loss: 0.530, Test loss: 0.796, Test accuracy: 70.44
Average accuracy final 10 rounds: 70.233
1218.0983300209045
[1.8833916187286377, 3.3811423778533936, 4.861590147018433, 6.3369410037994385, 7.7836973667144775, 9.241604089736938, 10.70818042755127, 12.171562910079956, 13.603609323501587, 15.058161735534668, 16.51773953437805, 17.97259783744812, 19.416011095046997, 20.8922278881073, 22.422703981399536, 23.91971468925476, 25.361096382141113, 26.818649768829346, 28.295170068740845, 29.799091577529907, 31.2721209526062, 32.759197473526, 34.2124137878418, 35.74520134925842, 37.20672631263733, 38.65588164329529, 40.14361643791199, 41.64495086669922, 43.09061074256897, 44.65098571777344, 46.11964702606201, 47.570778131484985, 49.105294942855835, 50.63032865524292, 52.18855857849121, 53.74480152130127, 55.255539655685425, 56.753989934921265, 58.29076361656189, 59.8093159198761, 61.31167507171631, 62.834195375442505, 64.38374924659729, 66.01342368125916, 67.53276228904724, 69.04889106750488, 70.56437230110168, 72.1143069267273, 73.58680820465088, 75.06803321838379, 76.57458901405334, 78.07345747947693, 79.58875489234924, 81.11219143867493, 82.64181208610535, 84.1594934463501, 85.68852543830872, 87.19787287712097, 88.70634865760803, 90.37184929847717, 91.88284587860107, 93.42653489112854, 95.0727927684784, 96.85785484313965, 98.63679718971252, 100.23472714424133, 101.77024507522583, 103.27032089233398, 104.78728604316711, 106.33416271209717, 107.95842456817627, 109.49337816238403, 110.95859408378601, 112.43858003616333, 113.90386080741882, 115.34799242019653, 116.7971670627594, 118.26475405693054, 119.71144461631775, 121.19915914535522, 122.68672037124634, 124.11843419075012, 125.60965943336487, 127.10889315605164, 128.56052541732788, 130.00807452201843, 131.47512674331665, 132.9576392173767, 134.44608736038208, 135.9271981716156, 137.40663504600525, 138.85976576805115, 140.33821654319763, 141.78447198867798, 143.26090478897095, 144.71408104896545, 146.20521020889282, 147.68880605697632, 149.1462264060974, 150.5995852947235, 153.0362048149109]
[18.92, 30.24, 39.14, 43.64, 46.92, 52.94, 54.1, 56.22, 58.34, 59.52, 59.35, 61.17, 62.29, 63.05, 63.09, 63.59, 63.05, 62.75, 63.17, 62.54, 63.99, 63.81, 64.12, 63.7, 64.85, 65.58, 65.0, 65.75, 65.81, 66.55, 66.65, 66.99, 67.57, 66.89, 67.29, 67.49, 68.9, 69.0, 69.54, 69.39, 69.01, 69.13, 68.83, 69.09, 69.08, 69.89, 69.04, 69.36, 69.18, 69.3, 68.56, 68.41, 68.77, 68.26, 68.15, 68.55, 70.37, 69.64, 69.92, 69.96, 70.15, 70.05, 70.78, 70.83, 70.78, 70.56, 70.17, 70.21, 69.43, 69.3, 70.18, 70.37, 70.44, 70.48, 70.5, 70.31, 69.77, 69.36, 69.95, 70.24, 69.92, 70.64, 70.91, 70.64, 70.9, 70.59, 70.52, 70.37, 70.09, 69.69, 70.56, 69.65, 70.26, 69.74, 69.96, 70.69, 70.5, 70.26, 70.11, 70.6, 70.44]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.977, Test loss: 2.181, Test accuracy: 12.80
Round   1, Train loss: 1.770, Test loss: 1.982, Test accuracy: 28.52
Round   2, Train loss: 1.537, Test loss: 1.636, Test accuracy: 40.38
Round   3, Train loss: 1.555, Test loss: 1.497, Test accuracy: 43.07
Round   4, Train loss: 1.381, Test loss: 1.392, Test accuracy: 47.54
Round   5, Train loss: 1.417, Test loss: 1.255, Test accuracy: 51.25
Round   6, Train loss: 1.594, Test loss: 1.233, Test accuracy: 52.87
Round   7, Train loss: 1.267, Test loss: 1.192, Test accuracy: 55.33
Round   8, Train loss: 1.459, Test loss: 1.175, Test accuracy: 56.03
Round   9, Train loss: 1.343, Test loss: 1.146, Test accuracy: 56.18
Round  10, Train loss: 1.206, Test loss: 1.133, Test accuracy: 57.33
Round  11, Train loss: 1.200, Test loss: 1.118, Test accuracy: 58.54
Round  12, Train loss: 1.172, Test loss: 1.119, Test accuracy: 58.46
Round  13, Train loss: 1.149, Test loss: 1.087, Test accuracy: 59.07
Round  14, Train loss: 1.280, Test loss: 1.081, Test accuracy: 59.14
Round  15, Train loss: 1.115, Test loss: 1.090, Test accuracy: 58.61
Round  16, Train loss: 1.320, Test loss: 1.055, Test accuracy: 59.49
Round  17, Train loss: 1.179, Test loss: 1.048, Test accuracy: 59.74
Round  18, Train loss: 1.117, Test loss: 1.024, Test accuracy: 60.90
Round  19, Train loss: 1.068, Test loss: 1.035, Test accuracy: 60.24
Round  20, Train loss: 1.046, Test loss: 1.028, Test accuracy: 61.45
Round  21, Train loss: 1.074, Test loss: 1.010, Test accuracy: 61.45
Round  22, Train loss: 1.029, Test loss: 1.004, Test accuracy: 61.35
Round  23, Train loss: 0.854, Test loss: 1.005, Test accuracy: 60.87
Round  24, Train loss: 1.148, Test loss: 0.982, Test accuracy: 62.94
Round  25, Train loss: 0.995, Test loss: 0.966, Test accuracy: 63.92
Round  26, Train loss: 0.956, Test loss: 0.952, Test accuracy: 64.69
Round  27, Train loss: 0.983, Test loss: 0.941, Test accuracy: 64.98
Round  28, Train loss: 1.046, Test loss: 0.947, Test accuracy: 65.43
Round  29, Train loss: 0.851, Test loss: 0.938, Test accuracy: 65.94
Round  30, Train loss: 0.832, Test loss: 0.923, Test accuracy: 65.98
Round  31, Train loss: 0.888, Test loss: 0.921, Test accuracy: 65.89
Round  32, Train loss: 1.086, Test loss: 0.910, Test accuracy: 65.03
Round  33, Train loss: 0.940, Test loss: 0.903, Test accuracy: 65.78
Round  34, Train loss: 0.835, Test loss: 0.904, Test accuracy: 65.68
Round  35, Train loss: 1.061, Test loss: 0.894, Test accuracy: 65.96
Round  36, Train loss: 0.826, Test loss: 0.896, Test accuracy: 65.49
Round  37, Train loss: 0.746, Test loss: 0.889, Test accuracy: 66.60
Round  38, Train loss: 0.870, Test loss: 0.881, Test accuracy: 66.99
Round  39, Train loss: 0.931, Test loss: 0.876, Test accuracy: 66.46
Round  40, Train loss: 0.892, Test loss: 0.880, Test accuracy: 66.12
Round  41, Train loss: 0.743, Test loss: 0.875, Test accuracy: 66.10
Round  42, Train loss: 0.829, Test loss: 0.863, Test accuracy: 66.61
Round  43, Train loss: 0.864, Test loss: 0.865, Test accuracy: 66.74
Round  44, Train loss: 0.747, Test loss: 0.860, Test accuracy: 67.84
Round  45, Train loss: 0.887, Test loss: 0.850, Test accuracy: 67.99
Round  46, Train loss: 0.814, Test loss: 0.855, Test accuracy: 67.20
Round  47, Train loss: 0.889, Test loss: 0.841, Test accuracy: 67.80
Round  48, Train loss: 0.873, Test loss: 0.854, Test accuracy: 67.78
Round  49, Train loss: 0.755, Test loss: 0.845, Test accuracy: 67.99
Round  50, Train loss: 0.952, Test loss: 0.848, Test accuracy: 67.83
Round  51, Train loss: 1.012, Test loss: 0.838, Test accuracy: 67.50
Round  52, Train loss: 0.834, Test loss: 0.841, Test accuracy: 68.27
Round  53, Train loss: 0.935, Test loss: 0.828, Test accuracy: 68.46
Round  54, Train loss: 0.644, Test loss: 0.827, Test accuracy: 68.61
Round  55, Train loss: 0.796, Test loss: 0.826, Test accuracy: 68.57
Round  56, Train loss: 0.814, Test loss: 0.822, Test accuracy: 68.68
Round  57, Train loss: 0.912, Test loss: 0.824, Test accuracy: 68.31
Round  58, Train loss: 0.657, Test loss: 0.819, Test accuracy: 68.74
Round  59, Train loss: 0.754, Test loss: 0.815, Test accuracy: 69.14
Round  60, Train loss: 0.758, Test loss: 0.804, Test accuracy: 69.61
Round  61, Train loss: 0.733, Test loss: 0.807, Test accuracy: 69.42
Round  62, Train loss: 0.794, Test loss: 0.809, Test accuracy: 69.55
Round  63, Train loss: 0.702, Test loss: 0.814, Test accuracy: 69.48
Round  64, Train loss: 0.714, Test loss: 0.807, Test accuracy: 69.29
Round  65, Train loss: 0.796, Test loss: 0.805, Test accuracy: 69.67
Round  66, Train loss: 0.775, Test loss: 0.810, Test accuracy: 69.26
Round  67, Train loss: 0.732, Test loss: 0.809, Test accuracy: 68.85
Round  68, Train loss: 0.777, Test loss: 0.804, Test accuracy: 69.25
Round  69, Train loss: 0.802, Test loss: 0.797, Test accuracy: 70.13
Round  70, Train loss: 0.630, Test loss: 0.795, Test accuracy: 69.96
Round  71, Train loss: 0.854, Test loss: 0.809, Test accuracy: 68.91
Round  72, Train loss: 0.474, Test loss: 0.810, Test accuracy: 69.08
Round  73, Train loss: 0.515, Test loss: 0.814, Test accuracy: 69.00
Round  74, Train loss: 0.775, Test loss: 0.816, Test accuracy: 69.05
Round  75, Train loss: 0.769, Test loss: 0.803, Test accuracy: 69.58
Round  76, Train loss: 0.860, Test loss: 0.803, Test accuracy: 69.57
Round  77, Train loss: 0.717, Test loss: 0.813, Test accuracy: 69.20
Round  78, Train loss: 0.789, Test loss: 0.816, Test accuracy: 69.12
Round  79, Train loss: 0.487, Test loss: 0.804, Test accuracy: 69.65
Round  80, Train loss: 0.791, Test loss: 0.810, Test accuracy: 69.39
Round  81, Train loss: 0.691, Test loss: 0.803, Test accuracy: 69.55
Round  82, Train loss: 0.559, Test loss: 0.800, Test accuracy: 69.78
Round  83, Train loss: 0.644, Test loss: 0.799, Test accuracy: 69.79
Round  84, Train loss: 0.495, Test loss: 0.794, Test accuracy: 70.22
Round  85, Train loss: 0.654, Test loss: 0.803, Test accuracy: 69.48
Round  86, Train loss: 0.660, Test loss: 0.799, Test accuracy: 69.60
Round  87, Train loss: 0.576, Test loss: 0.804, Test accuracy: 69.43
Round  88, Train loss: 0.607, Test loss: 0.809, Test accuracy: 69.30
Round  89, Train loss: 0.653, Test loss: 0.806, Test accuracy: 69.41
Round  90, Train loss: 0.567, Test loss: 0.804, Test accuracy: 69.65
Round  91, Train loss: 0.687, Test loss: 0.800, Test accuracy: 69.86
Round  92, Train loss: 0.695, Test loss: 0.795, Test accuracy: 70.20
Round  93, Train loss: 0.676, Test loss: 0.801, Test accuracy: 69.74
Round  94, Train loss: 0.607, Test loss: 0.806, Test accuracy: 69.11
Round  95, Train loss: 0.635, Test loss: 0.813, Test accuracy: 68.96
Round  96, Train loss: 0.625, Test loss: 0.812, Test accuracy: 69.36
Round  97, Train loss: 0.589, Test loss: 0.815, Test accuracy: 69.15
Round  98, Train loss: 0.530, Test loss: 0.831, Test accuracy: 68.40
Round  99, Train loss: 0.577, Test loss: 0.818, Test accuracy: 69.23
Final Round, Train loss: 0.549, Test loss: 0.828, Test accuracy: 68.68
Average accuracy final 10 rounds: 69.366
1627.0293176174164
[1.8837814331054688, 3.338256359100342, 4.755596399307251, 6.207197904586792, 7.7156336307525635, 9.180701732635498, 10.644344568252563, 12.105618000030518, 13.596266031265259, 15.0344557762146, 16.507120609283447, 17.984949111938477, 19.46111536026001, 20.899896383285522, 22.348423957824707, 23.815106630325317, 25.358423709869385, 26.827637910842896, 28.29272723197937, 29.762008905410767, 31.243654251098633, 33.605430364608765, 35.9446017742157, 38.31465220451355, 40.66470694541931, 43.07484793663025, 45.45585513114929, 47.84272599220276, 50.216095209121704, 52.59976291656494, 55.01553416252136, 57.43341374397278, 59.83963704109192, 62.25148296356201, 64.65882658958435, 67.06454658508301, 69.46119093894958, 72.05514168739319, 74.73274946212769, 77.1703999042511, 79.5822811126709, 81.97927403450012, 84.4075448513031, 86.78794264793396, 89.1684935092926, 91.55585718154907, 93.87186098098755, 96.32526731491089, 98.65606713294983, 101.1260015964508, 103.50055718421936, 105.89512133598328, 108.2753746509552, 110.68237328529358, 113.08099102973938, 115.42888236045837, 117.76266241073608, 120.13086009025574, 122.51693677902222, 124.87728524208069, 127.25767779350281, 129.75381517410278, 132.11531352996826, 134.49561166763306, 136.83855891227722, 139.16590094566345, 141.57470750808716, 143.98958468437195, 146.38684391975403, 148.74732661247253, 151.13889360427856, 153.51274061203003, 155.89063167572021, 158.27113485336304, 160.6662516593933, 163.04191374778748, 165.44738221168518, 167.79488492012024, 170.1998255252838, 172.54109907150269, 174.9604868888855, 177.35075306892395, 179.7071888446808, 182.05270981788635, 184.40821766853333, 186.77170753479004, 189.13127636909485, 191.52109360694885, 193.86506843566895, 196.26702904701233, 198.65185379981995, 201.2155659198761, 203.56708598136902, 205.92914414405823, 208.31714630126953, 210.70688247680664, 213.08490300178528, 215.54523015022278, 217.9150424003601, 220.2526421546936, 222.67177987098694]
[12.8, 28.52, 40.38, 43.07, 47.54, 51.25, 52.87, 55.33, 56.03, 56.18, 57.33, 58.54, 58.46, 59.07, 59.14, 58.61, 59.49, 59.74, 60.9, 60.24, 61.45, 61.45, 61.35, 60.87, 62.94, 63.92, 64.69, 64.98, 65.43, 65.94, 65.98, 65.89, 65.03, 65.78, 65.68, 65.96, 65.49, 66.6, 66.99, 66.46, 66.12, 66.1, 66.61, 66.74, 67.84, 67.99, 67.2, 67.8, 67.78, 67.99, 67.83, 67.5, 68.27, 68.46, 68.61, 68.57, 68.68, 68.31, 68.74, 69.14, 69.61, 69.42, 69.55, 69.48, 69.29, 69.67, 69.26, 68.85, 69.25, 70.13, 69.96, 68.91, 69.08, 69.0, 69.05, 69.58, 69.57, 69.2, 69.12, 69.65, 69.39, 69.55, 69.78, 69.79, 70.22, 69.48, 69.6, 69.43, 69.3, 69.41, 69.65, 69.86, 70.2, 69.74, 69.11, 68.96, 69.36, 69.15, 68.4, 69.23, 68.68]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.867, Test loss: 2.155, Test accuracy: 16.14
Round   1, Train loss: 1.669, Test loss: 1.886, Test accuracy: 31.51
Round   2, Train loss: 1.418, Test loss: 1.547, Test accuracy: 43.74
Round   3, Train loss: 1.344, Test loss: 1.382, Test accuracy: 48.29
Round   4, Train loss: 1.220, Test loss: 1.304, Test accuracy: 51.92
Round   5, Train loss: 1.146, Test loss: 1.157, Test accuracy: 56.79
Round   6, Train loss: 1.204, Test loss: 1.135, Test accuracy: 58.30
Round   7, Train loss: 1.331, Test loss: 1.108, Test accuracy: 60.54
Round   8, Train loss: 1.116, Test loss: 1.130, Test accuracy: 58.65
Round   9, Train loss: 0.976, Test loss: 1.077, Test accuracy: 60.70
Round  10, Train loss: 1.093, Test loss: 1.039, Test accuracy: 62.90
Round  11, Train loss: 1.114, Test loss: 1.025, Test accuracy: 62.53
Round  12, Train loss: 1.155, Test loss: 1.004, Test accuracy: 63.66
Round  13, Train loss: 0.867, Test loss: 0.979, Test accuracy: 64.94
Round  14, Train loss: 0.996, Test loss: 0.956, Test accuracy: 66.25
Round  15, Train loss: 0.911, Test loss: 0.967, Test accuracy: 65.26
Round  16, Train loss: 0.912, Test loss: 0.959, Test accuracy: 64.99
Round  17, Train loss: 0.928, Test loss: 0.949, Test accuracy: 65.55
Round  18, Train loss: 0.988, Test loss: 0.948, Test accuracy: 65.09
Round  19, Train loss: 1.001, Test loss: 0.930, Test accuracy: 65.62
Round  20, Train loss: 0.840, Test loss: 0.926, Test accuracy: 66.08
Round  21, Train loss: 0.837, Test loss: 0.918, Test accuracy: 66.43
Round  22, Train loss: 1.068, Test loss: 0.909, Test accuracy: 66.11
Round  23, Train loss: 0.843, Test loss: 0.911, Test accuracy: 66.58
Round  24, Train loss: 0.843, Test loss: 0.926, Test accuracy: 65.71
Round  25, Train loss: 0.691, Test loss: 0.898, Test accuracy: 66.29
Round  26, Train loss: 0.849, Test loss: 0.920, Test accuracy: 65.13
Round  27, Train loss: 0.911, Test loss: 0.915, Test accuracy: 64.95
Round  28, Train loss: 0.837, Test loss: 0.936, Test accuracy: 64.91
Round  29, Train loss: 0.903, Test loss: 0.927, Test accuracy: 65.13
Round  30, Train loss: 0.727, Test loss: 0.913, Test accuracy: 64.93
Round  31, Train loss: 0.729, Test loss: 0.913, Test accuracy: 64.85
Round  32, Train loss: 0.774, Test loss: 0.917, Test accuracy: 65.53
Round  33, Train loss: 0.651, Test loss: 0.911, Test accuracy: 65.98
Round  34, Train loss: 0.658, Test loss: 0.898, Test accuracy: 67.03
Round  35, Train loss: 0.695, Test loss: 0.903, Test accuracy: 66.92
Round  36, Train loss: 0.659, Test loss: 0.903, Test accuracy: 66.72
Round  37, Train loss: 0.560, Test loss: 0.913, Test accuracy: 66.73
Round  38, Train loss: 0.639, Test loss: 0.914, Test accuracy: 66.07
Round  39, Train loss: 0.829, Test loss: 0.939, Test accuracy: 65.45
Round  40, Train loss: 0.600, Test loss: 0.913, Test accuracy: 65.67
Round  41, Train loss: 0.814, Test loss: 0.922, Test accuracy: 65.30
Round  42, Train loss: 0.700, Test loss: 0.917, Test accuracy: 66.15
Round  43, Train loss: 0.568, Test loss: 0.933, Test accuracy: 65.31
Round  44, Train loss: 0.576, Test loss: 0.927, Test accuracy: 65.66
Round  45, Train loss: 0.674, Test loss: 0.910, Test accuracy: 65.77
Round  46, Train loss: 0.504, Test loss: 0.914, Test accuracy: 65.86
Round  47, Train loss: 0.621, Test loss: 0.928, Test accuracy: 65.32
Round  48, Train loss: 0.547, Test loss: 0.938, Test accuracy: 64.87
Round  49, Train loss: 0.652, Test loss: 0.937, Test accuracy: 65.61
Round  50, Train loss: 0.562, Test loss: 0.960, Test accuracy: 65.53
Round  51, Train loss: 0.572, Test loss: 0.961, Test accuracy: 65.21
Round  52, Train loss: 0.440, Test loss: 0.955, Test accuracy: 65.05
Round  53, Train loss: 0.730, Test loss: 0.954, Test accuracy: 65.22
Round  54, Train loss: 0.498, Test loss: 0.960, Test accuracy: 65.24
Round  55, Train loss: 0.489, Test loss: 0.977, Test accuracy: 65.82
Round  56, Train loss: 0.566, Test loss: 0.966, Test accuracy: 65.30
Round  57, Train loss: 0.575, Test loss: 0.936, Test accuracy: 66.39
Round  58, Train loss: 0.451, Test loss: 0.966, Test accuracy: 65.13
Round  59, Train loss: 0.436, Test loss: 0.958, Test accuracy: 65.35
Round  60, Train loss: 0.436, Test loss: 0.923, Test accuracy: 66.63
Round  61, Train loss: 0.519, Test loss: 0.931, Test accuracy: 66.50
Round  62, Train loss: 0.453, Test loss: 0.939, Test accuracy: 66.14
Round  63, Train loss: 0.322, Test loss: 0.944, Test accuracy: 66.63
Round  64, Train loss: 0.582, Test loss: 0.962, Test accuracy: 66.31
Round  65, Train loss: 0.498, Test loss: 0.975, Test accuracy: 65.96
Round  66, Train loss: 0.524, Test loss: 0.977, Test accuracy: 66.62
Round  67, Train loss: 0.585, Test loss: 0.967, Test accuracy: 66.10
Round  68, Train loss: 0.485, Test loss: 1.000, Test accuracy: 66.15
Round  69, Train loss: 0.422, Test loss: 0.988, Test accuracy: 65.65
Round  70, Train loss: 0.527, Test loss: 0.964, Test accuracy: 66.98
Round  71, Train loss: 0.566, Test loss: 0.951, Test accuracy: 67.00
Round  72, Train loss: 0.406, Test loss: 0.934, Test accuracy: 67.92
Round  73, Train loss: 0.476, Test loss: 0.950, Test accuracy: 67.07
Round  74, Train loss: 0.422, Test loss: 0.952, Test accuracy: 67.24
Round  75, Train loss: 0.457, Test loss: 0.984, Test accuracy: 65.61
Round  76, Train loss: 0.490, Test loss: 0.979, Test accuracy: 66.47
Round  77, Train loss: 0.434, Test loss: 0.974, Test accuracy: 66.72
Round  78, Train loss: 0.495, Test loss: 0.970, Test accuracy: 66.57
Round  79, Train loss: 0.482, Test loss: 0.994, Test accuracy: 65.91
Round  80, Train loss: 0.471, Test loss: 1.039, Test accuracy: 65.36
Round  81, Train loss: 0.364, Test loss: 1.051, Test accuracy: 64.80
Round  82, Train loss: 0.463, Test loss: 1.050, Test accuracy: 64.13
Round  83, Train loss: 0.282, Test loss: 1.022, Test accuracy: 64.78
Round  84, Train loss: 0.427, Test loss: 1.039, Test accuracy: 65.01
Round  85, Train loss: 0.421, Test loss: 1.016, Test accuracy: 65.86
Round  86, Train loss: 0.399, Test loss: 1.024, Test accuracy: 65.76
Round  87, Train loss: 0.328, Test loss: 1.048, Test accuracy: 65.67
Round  88, Train loss: 0.494, Test loss: 1.039, Test accuracy: 65.85
Round  89, Train loss: 0.410, Test loss: 1.033, Test accuracy: 65.76
Round  90, Train loss: 0.356, Test loss: 1.049, Test accuracy: 65.56
Round  91, Train loss: 0.363, Test loss: 1.027, Test accuracy: 65.40
Round  92, Train loss: 0.460, Test loss: 1.019, Test accuracy: 65.59
Round  93, Train loss: 0.344, Test loss: 1.033, Test accuracy: 65.78
Round  94, Train loss: 0.394, Test loss: 1.018, Test accuracy: 65.95
Round  95, Train loss: 0.264, Test loss: 1.000, Test accuracy: 66.71
Round  96, Train loss: 0.406, Test loss: 1.044, Test accuracy: 65.87
Round  97, Train loss: 0.396, Test loss: 1.058, Test accuracy: 65.47
Round  98, Train loss: 0.330, Test loss: 1.041, Test accuracy: 66.14
Round  99, Train loss: 0.367, Test loss: 1.066, Test accuracy: 65.42
Final Round, Train loss: 0.353, Test loss: 1.064, Test accuracy: 65.74
Average accuracy final 10 rounds: 65.789
2148.6360096931458
[3.3185315132141113, 6.356981992721558, 9.2882661819458, 12.264419078826904, 15.241440534591675, 18.22026824951172, 21.209447145462036, 24.134684562683105, 27.09334373474121, 29.973958015441895, 32.97180676460266, 35.8874716758728, 38.857635736465454, 41.855013847351074, 44.847689628601074, 47.7715802192688, 50.75673031806946, 53.75203037261963, 56.74234414100647, 59.7185800075531, 62.701801776885986, 65.70509767532349, 68.62211036682129, 71.57618451118469, 74.6039297580719, 77.5927472114563, 80.57083201408386, 83.60875964164734, 86.56305718421936, 89.53193211555481, 92.51175284385681, 95.50209498405457, 98.49891376495361, 101.57377076148987, 104.55008387565613, 107.52108263969421, 110.4554591178894, 113.4618673324585, 116.36543655395508, 119.30404710769653, 122.2451000213623, 125.20811438560486, 128.12534737586975, 131.11422491073608, 134.07247257232666, 137.0006148815155, 139.91786694526672, 142.9224829673767, 145.92871856689453, 148.91798973083496, 151.86791157722473, 154.80978322029114, 157.79516768455505, 160.83790707588196, 164.03387141227722, 167.09001421928406, 170.10697221755981, 173.12526679039001, 176.0502371788025, 179.11256098747253, 182.10594201087952, 185.09864854812622, 188.11237025260925, 191.12136888504028, 194.12329816818237, 197.04953694343567, 200.04088926315308, 203.0521936416626, 205.9902400970459, 208.9599838256836, 211.93011593818665, 214.91134667396545, 217.86076378822327, 220.90010142326355, 223.87541913986206, 226.9758882522583, 229.93393898010254, 233.07774424552917, 236.20061492919922, 239.33529496192932, 242.40543961524963, 245.6219620704651, 248.67926669120789, 251.7543375492096, 254.95389556884766, 258.169713973999, 261.2061505317688, 264.3071553707123, 267.563725233078, 270.5826816558838, 273.5143756866455, 276.4379515647888, 279.37021946907043, 282.52613401412964, 285.43422055244446, 288.4604935646057, 291.47003841400146, 294.4784333705902, 297.3993525505066, 300.3613555431366, 305.2513210773468]
[16.14, 31.51, 43.74, 48.29, 51.92, 56.79, 58.3, 60.54, 58.65, 60.7, 62.9, 62.53, 63.66, 64.94, 66.25, 65.26, 64.99, 65.55, 65.09, 65.62, 66.08, 66.43, 66.11, 66.58, 65.71, 66.29, 65.13, 64.95, 64.91, 65.13, 64.93, 64.85, 65.53, 65.98, 67.03, 66.92, 66.72, 66.73, 66.07, 65.45, 65.67, 65.3, 66.15, 65.31, 65.66, 65.77, 65.86, 65.32, 64.87, 65.61, 65.53, 65.21, 65.05, 65.22, 65.24, 65.82, 65.3, 66.39, 65.13, 65.35, 66.63, 66.5, 66.14, 66.63, 66.31, 65.96, 66.62, 66.1, 66.15, 65.65, 66.98, 67.0, 67.92, 67.07, 67.24, 65.61, 66.47, 66.72, 66.57, 65.91, 65.36, 64.8, 64.13, 64.78, 65.01, 65.86, 65.76, 65.67, 65.85, 65.76, 65.56, 65.4, 65.59, 65.78, 65.95, 66.71, 65.87, 65.47, 66.14, 65.42, 65.74]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.795, Test loss: 2.168, Test accuracy: 18.27
Round   1, Train loss: 1.557, Test loss: 1.947, Test accuracy: 32.93
Round   2, Train loss: 1.400, Test loss: 1.534, Test accuracy: 43.21
Round   3, Train loss: 1.493, Test loss: 1.343, Test accuracy: 51.97
Round   4, Train loss: 1.174, Test loss: 1.300, Test accuracy: 50.87
Round   5, Train loss: 1.149, Test loss: 1.134, Test accuracy: 57.66
Round   6, Train loss: 1.350, Test loss: 1.120, Test accuracy: 57.93
Round   7, Train loss: 1.172, Test loss: 1.073, Test accuracy: 60.00
Round   8, Train loss: 1.117, Test loss: 1.053, Test accuracy: 60.23
Round   9, Train loss: 0.958, Test loss: 1.029, Test accuracy: 60.96
Round  10, Train loss: 0.996, Test loss: 1.025, Test accuracy: 61.72
Round  11, Train loss: 0.893, Test loss: 0.985, Test accuracy: 64.37
Round  12, Train loss: 0.855, Test loss: 0.973, Test accuracy: 64.98
Round  13, Train loss: 1.059, Test loss: 0.942, Test accuracy: 64.24
Round  14, Train loss: 0.921, Test loss: 0.952, Test accuracy: 64.82
Round  15, Train loss: 0.843, Test loss: 0.964, Test accuracy: 63.46
Round  16, Train loss: 1.007, Test loss: 0.919, Test accuracy: 65.32
Round  17, Train loss: 0.994, Test loss: 0.927, Test accuracy: 64.82
Round  18, Train loss: 0.796, Test loss: 0.915, Test accuracy: 65.18
Round  19, Train loss: 0.876, Test loss: 0.908, Test accuracy: 64.83
Round  20, Train loss: 0.794, Test loss: 0.899, Test accuracy: 65.66
Round  21, Train loss: 0.776, Test loss: 0.885, Test accuracy: 66.37
Round  22, Train loss: 0.823, Test loss: 0.900, Test accuracy: 65.64
Round  23, Train loss: 0.600, Test loss: 0.893, Test accuracy: 65.42
Round  24, Train loss: 0.746, Test loss: 0.879, Test accuracy: 66.82
Round  25, Train loss: 0.766, Test loss: 0.857, Test accuracy: 67.62
Round  26, Train loss: 0.732, Test loss: 0.839, Test accuracy: 68.62
Round  27, Train loss: 0.694, Test loss: 0.854, Test accuracy: 67.83
Round  28, Train loss: 0.742, Test loss: 0.840, Test accuracy: 68.48
Round  29, Train loss: 0.732, Test loss: 0.832, Test accuracy: 68.06
Round  30, Train loss: 0.619, Test loss: 0.849, Test accuracy: 67.60
Round  31, Train loss: 0.564, Test loss: 0.837, Test accuracy: 68.14
Round  32, Train loss: 0.757, Test loss: 0.840, Test accuracy: 68.46
Round  33, Train loss: 0.658, Test loss: 0.842, Test accuracy: 68.22
Round  34, Train loss: 0.642, Test loss: 0.822, Test accuracy: 69.77
Round  35, Train loss: 0.744, Test loss: 0.840, Test accuracy: 68.53
Round  36, Train loss: 0.559, Test loss: 0.827, Test accuracy: 69.14
Round  37, Train loss: 0.527, Test loss: 0.858, Test accuracy: 67.75
Round  38, Train loss: 0.657, Test loss: 0.828, Test accuracy: 69.39
Round  39, Train loss: 0.493, Test loss: 0.842, Test accuracy: 68.68
Round  40, Train loss: 0.509, Test loss: 0.829, Test accuracy: 68.07
Round  41, Train loss: 0.467, Test loss: 0.837, Test accuracy: 68.20
Round  42, Train loss: 0.477, Test loss: 0.821, Test accuracy: 69.12
Round  43, Train loss: 0.492, Test loss: 0.831, Test accuracy: 69.33
Round  44, Train loss: 0.467, Test loss: 0.809, Test accuracy: 70.01
Round  45, Train loss: 0.682, Test loss: 0.821, Test accuracy: 69.89
Round  46, Train loss: 0.565, Test loss: 0.829, Test accuracy: 69.42
Round  47, Train loss: 0.471, Test loss: 0.830, Test accuracy: 69.29
Round  48, Train loss: 0.628, Test loss: 0.859, Test accuracy: 68.90
Round  49, Train loss: 0.597, Test loss: 0.872, Test accuracy: 67.76
Round  50, Train loss: 0.715, Test loss: 0.870, Test accuracy: 68.41
Round  51, Train loss: 0.585, Test loss: 0.870, Test accuracy: 68.42
Round  52, Train loss: 0.521, Test loss: 0.880, Test accuracy: 67.06
Round  53, Train loss: 0.513, Test loss: 0.842, Test accuracy: 69.02
Round  54, Train loss: 0.478, Test loss: 0.846, Test accuracy: 68.64
Round  55, Train loss: 0.529, Test loss: 0.817, Test accuracy: 69.73
Round  56, Train loss: 0.486, Test loss: 0.816, Test accuracy: 70.11
Round  57, Train loss: 0.470, Test loss: 0.818, Test accuracy: 70.28
Round  58, Train loss: 0.415, Test loss: 0.845, Test accuracy: 68.81
Round  59, Train loss: 0.562, Test loss: 0.854, Test accuracy: 68.80
Round  60, Train loss: 0.479, Test loss: 0.857, Test accuracy: 67.96
Round  61, Train loss: 0.489, Test loss: 0.845, Test accuracy: 68.90
Round  62, Train loss: 0.349, Test loss: 0.835, Test accuracy: 69.39
Round  63, Train loss: 0.429, Test loss: 0.843, Test accuracy: 68.46
Round  64, Train loss: 0.450, Test loss: 0.840, Test accuracy: 68.38
Round  65, Train loss: 0.450, Test loss: 0.865, Test accuracy: 68.25
Round  66, Train loss: 0.418, Test loss: 0.858, Test accuracy: 68.28
Round  67, Train loss: 0.451, Test loss: 0.855, Test accuracy: 68.57
Round  68, Train loss: 0.508, Test loss: 0.871, Test accuracy: 69.34
Round  69, Train loss: 0.381, Test loss: 0.855, Test accuracy: 69.20
Round  70, Train loss: 0.367, Test loss: 0.859, Test accuracy: 68.94
Round  71, Train loss: 0.476, Test loss: 0.881, Test accuracy: 68.56
Round  72, Train loss: 0.327, Test loss: 0.886, Test accuracy: 68.27
Round  73, Train loss: 0.472, Test loss: 0.877, Test accuracy: 68.65
Round  74, Train loss: 0.471, Test loss: 0.900, Test accuracy: 68.15
Round  75, Train loss: 0.357, Test loss: 0.887, Test accuracy: 68.31
Round  76, Train loss: 0.436, Test loss: 0.913, Test accuracy: 68.29
Round  77, Train loss: 0.439, Test loss: 0.905, Test accuracy: 68.69
Round  78, Train loss: 0.463, Test loss: 0.906, Test accuracy: 68.33
Round  79, Train loss: 0.372, Test loss: 0.886, Test accuracy: 68.79
Round  80, Train loss: 0.553, Test loss: 0.925, Test accuracy: 68.40
Round  81, Train loss: 0.406, Test loss: 0.930, Test accuracy: 67.96
Round  82, Train loss: 0.331, Test loss: 0.920, Test accuracy: 68.15
Round  83, Train loss: 0.280, Test loss: 0.899, Test accuracy: 69.01
Round  84, Train loss: 0.279, Test loss: 0.933, Test accuracy: 68.56
Round  85, Train loss: 0.457, Test loss: 0.933, Test accuracy: 68.96
Round  86, Train loss: 0.413, Test loss: 0.900, Test accuracy: 69.53
Round  87, Train loss: 0.430, Test loss: 0.924, Test accuracy: 69.21
Round  88, Train loss: 0.394, Test loss: 0.934, Test accuracy: 68.68