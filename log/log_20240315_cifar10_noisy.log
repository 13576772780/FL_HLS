nohup: ignoring input
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.615, Test loss: 1.953, Test accuracy: 26.86
Round   0, Global train loss: 1.615, Global test loss: 2.189, Global test accuracy: 20.83
Round   1, Train loss: 1.384, Test loss: 1.734, Test accuracy: 35.66
Round   1, Global train loss: 1.384, Global test loss: 2.131, Global test accuracy: 27.59
Round   2, Train loss: 1.291, Test loss: 1.531, Test accuracy: 40.54
Round   2, Global train loss: 1.291, Global test loss: 2.067, Global test accuracy: 28.40
Round   3, Train loss: 1.246, Test loss: 1.344, Test accuracy: 46.97
Round   3, Global train loss: 1.246, Global test loss: 2.047, Global test accuracy: 29.15
Round   4, Train loss: 1.148, Test loss: 1.271, Test accuracy: 48.96
Round   4, Global train loss: 1.148, Global test loss: 2.207, Global test accuracy: 30.78
Round   5, Train loss: 1.112, Test loss: 1.212, Test accuracy: 51.36
Round   5, Global train loss: 1.112, Global test loss: 1.912, Global test accuracy: 32.61
Round   6, Train loss: 1.041, Test loss: 1.188, Test accuracy: 52.77
Round   6, Global train loss: 1.041, Global test loss: 2.231, Global test accuracy: 29.50
Round   7, Train loss: 1.146, Test loss: 1.111, Test accuracy: 54.97
Round   7, Global train loss: 1.146, Global test loss: 2.187, Global test accuracy: 31.63
Round   8, Train loss: 1.004, Test loss: 1.085, Test accuracy: 56.24
Round   8, Global train loss: 1.004, Global test loss: 2.201, Global test accuracy: 31.01
Round   9, Train loss: 0.960, Test loss: 1.079, Test accuracy: 56.39
Round   9, Global train loss: 0.960, Global test loss: 1.923, Global test accuracy: 32.46
Round  10, Train loss: 1.012, Test loss: 1.061, Test accuracy: 57.08
Round  10, Global train loss: 1.012, Global test loss: 1.983, Global test accuracy: 33.03
Round  11, Train loss: 0.906, Test loss: 1.071, Test accuracy: 56.85
Round  11, Global train loss: 0.906, Global test loss: 1.828, Global test accuracy: 33.20
Round  12, Train loss: 0.963, Test loss: 1.049, Test accuracy: 57.78
Round  12, Global train loss: 0.963, Global test loss: 2.019, Global test accuracy: 24.68
Round  13, Train loss: 0.932, Test loss: 1.051, Test accuracy: 57.91
Round  13, Global train loss: 0.932, Global test loss: 2.045, Global test accuracy: 29.14
Round  14, Train loss: 0.950, Test loss: 1.028, Test accuracy: 59.00
Round  14, Global train loss: 0.950, Global test loss: 1.923, Global test accuracy: 31.15
Round  15, Train loss: 0.905, Test loss: 1.020, Test accuracy: 59.64
Round  15, Global train loss: 0.905, Global test loss: 1.882, Global test accuracy: 37.27
Round  16, Train loss: 0.826, Test loss: 1.028, Test accuracy: 59.81
Round  16, Global train loss: 0.826, Global test loss: 1.973, Global test accuracy: 27.14
Round  17, Train loss: 0.762, Test loss: 1.026, Test accuracy: 59.96
Round  17, Global train loss: 0.762, Global test loss: 1.876, Global test accuracy: 35.66
Round  18, Train loss: 0.791, Test loss: 1.032, Test accuracy: 60.02
Round  18, Global train loss: 0.791, Global test loss: 2.143, Global test accuracy: 33.28
Round  19, Train loss: 0.779, Test loss: 1.043, Test accuracy: 59.75
Round  19, Global train loss: 0.779, Global test loss: 2.217, Global test accuracy: 32.40
Round  20, Train loss: 0.675, Test loss: 1.052, Test accuracy: 60.26
Round  20, Global train loss: 0.675, Global test loss: 1.801, Global test accuracy: 36.91
Round  21, Train loss: 0.685, Test loss: 1.054, Test accuracy: 60.84
Round  21, Global train loss: 0.685, Global test loss: 1.990, Global test accuracy: 30.27
Round  22, Train loss: 0.596, Test loss: 1.057, Test accuracy: 60.83
Round  22, Global train loss: 0.596, Global test loss: 2.126, Global test accuracy: 34.58
Round  23, Train loss: 0.687, Test loss: 1.077, Test accuracy: 60.98
Round  23, Global train loss: 0.687, Global test loss: 2.142, Global test accuracy: 36.69
Round  24, Train loss: 0.537, Test loss: 1.062, Test accuracy: 61.47
Round  24, Global train loss: 0.537, Global test loss: 2.059, Global test accuracy: 30.54
Round  25, Train loss: 0.664, Test loss: 1.079, Test accuracy: 61.11
Round  25, Global train loss: 0.664, Global test loss: 1.959, Global test accuracy: 33.98
Round  26, Train loss: 0.730, Test loss: 1.082, Test accuracy: 61.66
Round  26, Global train loss: 0.730, Global test loss: 2.078, Global test accuracy: 35.73
Round  27, Train loss: 0.591, Test loss: 1.076, Test accuracy: 62.50
Round  27, Global train loss: 0.591, Global test loss: 2.010, Global test accuracy: 33.80
Round  28, Train loss: 0.721, Test loss: 1.098, Test accuracy: 62.01
Round  28, Global train loss: 0.721, Global test loss: 1.886, Global test accuracy: 31.10
Round  29, Train loss: 0.565, Test loss: 1.126, Test accuracy: 61.79
Round  29, Global train loss: 0.565, Global test loss: 2.036, Global test accuracy: 31.39
Round  30, Train loss: 0.491, Test loss: 1.137, Test accuracy: 61.80
Round  30, Global train loss: 0.491, Global test loss: 2.045, Global test accuracy: 36.36
Round  31, Train loss: 0.499, Test loss: 1.171, Test accuracy: 61.37
Round  31, Global train loss: 0.499, Global test loss: 1.816, Global test accuracy: 35.96
Round  32, Train loss: 0.592, Test loss: 1.172, Test accuracy: 61.73
Round  32, Global train loss: 0.592, Global test loss: 1.930, Global test accuracy: 34.52
Round  33, Train loss: 0.515, Test loss: 1.168, Test accuracy: 62.16
Round  33, Global train loss: 0.515, Global test loss: 1.977, Global test accuracy: 32.71
Round  34, Train loss: 0.491, Test loss: 1.164, Test accuracy: 62.30
Round  34, Global train loss: 0.491, Global test loss: 1.882, Global test accuracy: 34.53
Round  35, Train loss: 0.610, Test loss: 1.164, Test accuracy: 62.64
Round  35, Global train loss: 0.610, Global test loss: 1.825, Global test accuracy: 32.10
Round  36, Train loss: 0.546, Test loss: 1.173, Test accuracy: 63.20
Round  36, Global train loss: 0.546, Global test loss: 1.888, Global test accuracy: 34.93
Round  37, Train loss: 0.479, Test loss: 1.189, Test accuracy: 63.00
Round  37, Global train loss: 0.479, Global test loss: 1.955, Global test accuracy: 34.86
Round  38, Train loss: 0.422, Test loss: 1.230, Test accuracy: 63.01
Round  38, Global train loss: 0.422, Global test loss: 2.007, Global test accuracy: 34.86
Round  39, Train loss: 0.368, Test loss: 1.243, Test accuracy: 63.05
Round  39, Global train loss: 0.368, Global test loss: 2.098, Global test accuracy: 31.25
Round  40, Train loss: 0.424, Test loss: 1.245, Test accuracy: 63.47
Round  40, Global train loss: 0.424, Global test loss: 2.048, Global test accuracy: 33.39
Round  41, Train loss: 0.464, Test loss: 1.244, Test accuracy: 63.22
Round  41, Global train loss: 0.464, Global test loss: 1.844, Global test accuracy: 32.70
Round  42, Train loss: 0.365, Test loss: 1.291, Test accuracy: 63.06
Round  42, Global train loss: 0.365, Global test loss: 1.973, Global test accuracy: 32.39
Round  43, Train loss: 0.344, Test loss: 1.304, Test accuracy: 63.64
Round  43, Global train loss: 0.344, Global test loss: 1.994, Global test accuracy: 36.20
Round  44, Train loss: 0.317, Test loss: 1.338, Test accuracy: 63.23
Round  44, Global train loss: 0.317, Global test loss: 1.829, Global test accuracy: 38.44
Round  45, Train loss: 0.318, Test loss: 1.349, Test accuracy: 63.01
Round  45, Global train loss: 0.318, Global test loss: 2.028, Global test accuracy: 37.70
Round  46, Train loss: 0.329, Test loss: 1.384, Test accuracy: 62.86
Round  46, Global train loss: 0.329, Global test loss: 1.803, Global test accuracy: 35.11
Round  47, Train loss: 0.394, Test loss: 1.391, Test accuracy: 62.89
Round  47, Global train loss: 0.394, Global test loss: 1.833, Global test accuracy: 36.26
Round  48, Train loss: 0.356, Test loss: 1.408, Test accuracy: 62.68
Round  48, Global train loss: 0.356, Global test loss: 1.894, Global test accuracy: 30.46
Round  49, Train loss: 0.306, Test loss: 1.382, Test accuracy: 63.32
Round  49, Global train loss: 0.306, Global test loss: 1.856, Global test accuracy: 36.40
Round  50, Train loss: 0.323, Test loss: 1.424, Test accuracy: 63.17
Round  50, Global train loss: 0.323, Global test loss: 1.868, Global test accuracy: 35.30
Round  51, Train loss: 0.281, Test loss: 1.430, Test accuracy: 63.32
Round  51, Global train loss: 0.281, Global test loss: 1.985, Global test accuracy: 33.62
Round  52, Train loss: 0.277, Test loss: 1.469, Test accuracy: 63.14
Round  52, Global train loss: 0.277, Global test loss: 2.111, Global test accuracy: 34.39
Round  53, Train loss: 0.290, Test loss: 1.445, Test accuracy: 63.39
Round  53, Global train loss: 0.290, Global test loss: 2.103, Global test accuracy: 35.73
Round  54, Train loss: 0.222, Test loss: 1.476, Test accuracy: 63.00
Round  54, Global train loss: 0.222, Global test loss: 1.685, Global test accuracy: 39.31
Round  55, Train loss: 0.265, Test loss: 1.492, Test accuracy: 62.87
Round  55, Global train loss: 0.265, Global test loss: 1.786, Global test accuracy: 38.36
Round  56, Train loss: 0.266, Test loss: 1.505, Test accuracy: 62.78
Round  56, Global train loss: 0.266, Global test loss: 1.955, Global test accuracy: 34.36
Round  57, Train loss: 0.217, Test loss: 1.571, Test accuracy: 62.71
Round  57, Global train loss: 0.217, Global test loss: 2.009, Global test accuracy: 36.53
Round  58, Train loss: 0.215, Test loss: 1.566, Test accuracy: 63.19
Round  58, Global train loss: 0.215, Global test loss: 2.232, Global test accuracy: 32.29
Round  59, Train loss: 0.209, Test loss: 1.578, Test accuracy: 63.14
Round  59, Global train loss: 0.209, Global test loss: 1.915, Global test accuracy: 33.16
Round  60, Train loss: 0.237, Test loss: 1.593, Test accuracy: 63.52
Round  60, Global train loss: 0.237, Global test loss: 2.170, Global test accuracy: 32.50
Round  61, Train loss: 0.182, Test loss: 1.611, Test accuracy: 63.55
Round  61, Global train loss: 0.182, Global test loss: 2.324, Global test accuracy: 32.02
Round  62, Train loss: 0.227, Test loss: 1.625, Test accuracy: 63.74
Round  62, Global train loss: 0.227, Global test loss: 1.876, Global test accuracy: 36.86
Round  63, Train loss: 0.186, Test loss: 1.583, Test accuracy: 63.81
Round  63, Global train loss: 0.186, Global test loss: 1.837, Global test accuracy: 37.16
Round  64, Train loss: 0.186, Test loss: 1.603, Test accuracy: 63.74
Round  64, Global train loss: 0.186, Global test loss: 1.840, Global test accuracy: 37.56
Round  65, Train loss: 0.217, Test loss: 1.613, Test accuracy: 64.00
Round  65, Global train loss: 0.217, Global test loss: 2.216, Global test accuracy: 37.16
Round  66, Train loss: 0.233, Test loss: 1.621, Test accuracy: 63.89
Round  66, Global train loss: 0.233, Global test loss: 2.018, Global test accuracy: 31.95
Round  67, Train loss: 0.181, Test loss: 1.630, Test accuracy: 64.23
Round  67, Global train loss: 0.181, Global test loss: 1.923, Global test accuracy: 35.30
Round  68, Train loss: 0.189, Test loss: 1.627, Test accuracy: 64.06
Round  68, Global train loss: 0.189, Global test loss: 2.092, Global test accuracy: 26.27
Round  69, Train loss: 0.161, Test loss: 1.655, Test accuracy: 63.82
Round  69, Global train loss: 0.161, Global test loss: 1.960, Global test accuracy: 35.75
Round  70, Train loss: 0.176, Test loss: 1.669, Test accuracy: 64.27
Round  70, Global train loss: 0.176, Global test loss: 2.189, Global test accuracy: 37.70
Round  71, Train loss: 0.152, Test loss: 1.715, Test accuracy: 64.39
Round  71, Global train loss: 0.152, Global test loss: 1.889, Global test accuracy: 36.25
Round  72, Train loss: 0.144, Test loss: 1.726, Test accuracy: 63.79
Round  72, Global train loss: 0.144, Global test loss: 1.852, Global test accuracy: 33.97
Round  73, Train loss: 0.183, Test loss: 1.713, Test accuracy: 64.05
Round  73, Global train loss: 0.183, Global test loss: 2.052, Global test accuracy: 32.96
Round  74, Train loss: 0.157, Test loss: 1.722, Test accuracy: 64.24
Round  74, Global train loss: 0.157, Global test loss: 2.057, Global test accuracy: 31.61
Round  75, Train loss: 0.153, Test loss: 1.792, Test accuracy: 63.84
Round  75, Global train loss: 0.153, Global test loss: 1.964, Global test accuracy: 37.03
Round  76, Train loss: 0.172, Test loss: 1.809, Test accuracy: 64.17
Round  76, Global train loss: 0.172, Global test loss: 2.133, Global test accuracy: 35.13
Round  77, Train loss: 0.146, Test loss: 1.816, Test accuracy: 64.25
Round  77, Global train loss: 0.146, Global test loss: 1.995, Global test accuracy: 36.63
Round  78, Train loss: 0.141, Test loss: 1.853, Test accuracy: 64.21
Round  78, Global train loss: 0.141, Global test loss: 2.030, Global test accuracy: 33.97
Round  79, Train loss: 0.126, Test loss: 1.912, Test accuracy: 63.70
Round  79, Global train loss: 0.126, Global test loss: 1.842, Global test accuracy: 38.29
Round  80, Train loss: 0.134, Test loss: 1.876, Test accuracy: 64.13
Round  80, Global train loss: 0.134, Global test loss: 2.301, Global test accuracy: 37.83
Round  81, Train loss: 0.136, Test loss: 1.845, Test accuracy: 63.94
Round  81, Global train loss: 0.136, Global test loss: 1.986, Global test accuracy: 37.38
Round  82, Train loss: 0.157, Test loss: 1.843, Test accuracy: 64.26
Round  82, Global train loss: 0.157, Global test loss: 2.073, Global test accuracy: 32.88
Round  83, Train loss: 0.127, Test loss: 1.915, Test accuracy: 63.96
Round  83, Global train loss: 0.127, Global test loss: 2.100, Global test accuracy: 28.12
Round  84, Train loss: 0.140, Test loss: 1.883, Test accuracy: 64.46
Round  84, Global train loss: 0.140, Global test loss: 1.895, Global test accuracy: 30.16
Round  85, Train loss: 0.128, Test loss: 1.905, Test accuracy: 64.31
Round  85, Global train loss: 0.128, Global test loss: 2.044, Global test accuracy: 35.84
Round  86, Train loss: 0.117, Test loss: 1.933, Test accuracy: 64.01
Round  86, Global train loss: 0.117, Global test loss: 2.093, Global test accuracy: 36.95
Round  87, Train loss: 0.109, Test loss: 1.881, Test accuracy: 64.32
Round  87, Global train loss: 0.109, Global test loss: 2.240, Global test accuracy: 37.33
Round  88, Train loss: 0.100, Test loss: 1.929, Test accuracy: 64.42
Round  88, Global train loss: 0.100, Global test loss: 1.771, Global test accuracy: 36.75
Round  89, Train loss: 0.105, Test loss: 1.942, Test accuracy: 64.39
Round  89, Global train loss: 0.105, Global test loss: 1.962, Global test accuracy: 36.60
Round  90, Train loss: 0.100, Test loss: 1.977, Test accuracy: 64.10
Round  90, Global train loss: 0.100, Global test loss: 1.934, Global test accuracy: 32.13
Round  91, Train loss: 0.099, Test loss: 1.982, Test accuracy: 64.10
Round  91, Global train loss: 0.099, Global test loss: 2.010, Global test accuracy: 37.68
Round  92, Train loss: 0.093, Test loss: 1.991, Test accuracy: 63.94
Round  92, Global train loss: 0.093, Global test loss: 1.956, Global test accuracy: 37.12
Round  93, Train loss: 0.126, Test loss: 2.024, Test accuracy: 63.39
Round  93, Global train loss: 0.126, Global test loss: 1.908, Global test accuracy: 34.11
Round  94, Train loss: 0.114, Test loss: 2.054, Test accuracy: 63.94
Round  94, Global train loss: 0.114, Global test loss: 1.881, Global test accuracy: 36.08
Round  95, Train loss: 0.126, Test loss: 2.007, Test accuracy: 63.97
Round  95, Global train loss: 0.126, Global test loss: 1.945, Global test accuracy: 31.80
Round  96, Train loss: 0.096, Test loss: 1.988, Test accuracy: 64.07
Round  96, Global train loss: 0.096, Global test loss: 2.023, Global test accuracy: 35.44
Round  97, Train loss: 0.100, Test loss: 1.992, Test accuracy: 64.39
Round  97, Global train loss: 0.100, Global test loss: 2.131, Global test accuracy: 23.08
Round  98, Train loss: 0.091, Test loss: 2.005, Test accuracy: 64.47
Round  98, Global train loss: 0.091, Global test loss: 2.233, Global test accuracy: 36.17
Round  99, Train loss: 0.108, Test loss: 2.041, Test accuracy: 64.13
Round  99, Global train loss: 0.108, Global test loss: 1.934, Global test accuracy: 34.61
Final Round, Train loss: 0.089, Test loss: 2.053, Test accuracy: 64.59
Final Round, Global train loss: 0.089, Global test loss: 1.934, Global test accuracy: 34.61
Average accuracy final 10 rounds: 64.05 

Average global accuracy final 10 rounds: 33.822 

1456.5839936733246
[1.406078815460205, 2.81215763092041, 4.023809909820557, 5.235462188720703, 6.456127643585205, 7.676793098449707, 8.8853440284729, 10.093894958496094, 11.316105127334595, 12.538315296173096, 13.750236511230469, 14.962157726287842, 16.174617290496826, 17.38707685470581, 18.59403705596924, 19.800997257232666, 21.011435985565186, 22.221874713897705, 23.43038010597229, 24.638885498046875, 25.846039533615112, 27.05319356918335, 28.260477781295776, 29.467761993408203, 30.675312757492065, 31.882863521575928, 33.105703353881836, 34.328543186187744, 35.538204193115234, 36.747865200042725, 37.96158790588379, 39.17531061172485, 40.38734245300293, 41.599374294281006, 42.81026315689087, 44.02115201950073, 45.23457717895508, 46.448002338409424, 47.66217827796936, 48.8763542175293, 50.085456132888794, 51.29455804824829, 52.50835561752319, 53.722153186798096, 54.934667110443115, 56.147181034088135, 57.369635581970215, 58.592090129852295, 59.80319690704346, 61.01430368423462, 62.226269245147705, 63.43823480606079, 64.64666104316711, 65.85508728027344, 67.07177662849426, 68.28846597671509, 69.50998735427856, 70.73150873184204, 71.96154427528381, 73.19157981872559, 74.40880513191223, 75.62603044509888, 76.83197903633118, 78.03792762756348, 79.25616192817688, 80.47439622879028, 81.6877875328064, 82.90117883682251, 84.12327742576599, 85.34537601470947, 86.5540246963501, 87.76267337799072, 88.97923398017883, 90.19579458236694, 91.40746593475342, 92.61913728713989, 93.82879972457886, 95.03846216201782, 96.26595425605774, 97.49344635009766, 98.71547222137451, 99.93749809265137, 101.15036654472351, 102.36323499679565, 103.57149243354797, 104.7797498703003, 105.99715447425842, 107.21455907821655, 108.42525029182434, 109.63594150543213, 110.85183048248291, 112.06771945953369, 113.29019403457642, 114.51266860961914, 115.74197196960449, 116.97127532958984, 118.1875638961792, 119.40385246276855, 120.62520003318787, 121.84654760360718, 123.06010341644287, 124.27365922927856, 125.49431562423706, 126.71497201919556, 127.92949914932251, 129.14402627944946, 130.35777831077576, 131.57153034210205, 132.78055095672607, 133.9895715713501, 135.2100043296814, 136.4304370880127, 137.647540807724, 138.8646445274353, 140.0826849937439, 141.3007254600525, 142.52326703071594, 143.7458086013794, 144.9556324481964, 146.16545629501343, 147.39493060112, 148.62440490722656, 149.8427631855011, 151.06112146377563, 152.2805688381195, 153.50001621246338, 154.72205686569214, 155.9440975189209, 157.1718235015869, 158.39954948425293, 159.61376667022705, 160.82798385620117, 162.04550504684448, 163.2630262374878, 164.48415064811707, 165.70527505874634, 166.92421078681946, 168.14314651489258, 169.35609769821167, 170.56904888153076, 171.7815396785736, 172.99403047561646, 174.19969606399536, 175.40536165237427, 176.61222219467163, 177.819082736969, 179.04150891304016, 180.26393508911133, 181.47459197044373, 182.68524885177612, 183.9061143398285, 185.12697982788086, 186.34430718421936, 187.56163454055786, 188.79063987731934, 190.0196452140808, 191.2391254901886, 192.4586057662964, 193.69216632843018, 194.92572689056396, 196.15691924095154, 197.3881115913391, 198.61092233657837, 199.83373308181763, 201.06291794776917, 202.2921028137207, 203.51254844665527, 204.73299407958984, 205.95962476730347, 207.1862554550171, 208.41548776626587, 209.64472007751465, 210.87290120124817, 212.1010823249817, 213.31545758247375, 214.52983283996582, 215.7563455104828, 216.98285818099976, 218.20058274269104, 219.41830730438232, 220.64227056503296, 221.8662338256836, 223.08276748657227, 224.29930114746094, 225.52218890190125, 226.74507665634155, 227.96526193618774, 229.18544721603394, 230.3732511997223, 231.56105518341064, 232.73882603645325, 233.91659688949585, 235.1021466255188, 236.28769636154175, 237.47196674346924, 238.65623712539673, 239.82536840438843, 240.99449968338013, 242.1748776435852, 243.35525560379028, 245.71571111679077, 248.07616662979126]
[26.86, 26.86, 35.66, 35.66, 40.54, 40.54, 46.97, 46.97, 48.96, 48.96, 51.36, 51.36, 52.77, 52.77, 54.97, 54.97, 56.24, 56.24, 56.39, 56.39, 57.08, 57.08, 56.85, 56.85, 57.78, 57.78, 57.91, 57.91, 59.0, 59.0, 59.64, 59.64, 59.81, 59.81, 59.96, 59.96, 60.02, 60.02, 59.75, 59.75, 60.26, 60.26, 60.84, 60.84, 60.83, 60.83, 60.98, 60.98, 61.47, 61.47, 61.11, 61.11, 61.66, 61.66, 62.5, 62.5, 62.01, 62.01, 61.79, 61.79, 61.8, 61.8, 61.37, 61.37, 61.73, 61.73, 62.16, 62.16, 62.3, 62.3, 62.64, 62.64, 63.2, 63.2, 63.0, 63.0, 63.01, 63.01, 63.05, 63.05, 63.47, 63.47, 63.22, 63.22, 63.06, 63.06, 63.64, 63.64, 63.23, 63.23, 63.01, 63.01, 62.86, 62.86, 62.89, 62.89, 62.68, 62.68, 63.32, 63.32, 63.17, 63.17, 63.32, 63.32, 63.14, 63.14, 63.39, 63.39, 63.0, 63.0, 62.87, 62.87, 62.78, 62.78, 62.71, 62.71, 63.19, 63.19, 63.14, 63.14, 63.52, 63.52, 63.55, 63.55, 63.74, 63.74, 63.81, 63.81, 63.74, 63.74, 64.0, 64.0, 63.89, 63.89, 64.23, 64.23, 64.06, 64.06, 63.82, 63.82, 64.27, 64.27, 64.39, 64.39, 63.79, 63.79, 64.05, 64.05, 64.24, 64.24, 63.84, 63.84, 64.17, 64.17, 64.25, 64.25, 64.21, 64.21, 63.7, 63.7, 64.13, 64.13, 63.94, 63.94, 64.26, 64.26, 63.96, 63.96, 64.46, 64.46, 64.31, 64.31, 64.01, 64.01, 64.32, 64.32, 64.42, 64.42, 64.39, 64.39, 64.1, 64.1, 64.1, 64.1, 63.94, 63.94, 63.39, 63.39, 63.94, 63.94, 63.97, 63.97, 64.07, 64.07, 64.39, 64.39, 64.47, 64.47, 64.13, 64.13, 64.59, 64.59]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.631, Test loss: 2.122, Test accuracy: 25.49
Round   0, Global train loss: 1.631, Global test loss: 2.305, Global test accuracy: 22.51
Round   1, Train loss: 1.391, Test loss: 1.680, Test accuracy: 36.19
Round   1, Global train loss: 1.391, Global test loss: 2.006, Global test accuracy: 30.31
Round   2, Train loss: 1.290, Test loss: 1.532, Test accuracy: 40.68
Round   2, Global train loss: 1.290, Global test loss: 1.960, Global test accuracy: 32.85
Round   3, Train loss: 1.207, Test loss: 1.433, Test accuracy: 43.17
Round   3, Global train loss: 1.207, Global test loss: 1.930, Global test accuracy: 29.31
Round   4, Train loss: 1.166, Test loss: 1.305, Test accuracy: 46.59
Round   4, Global train loss: 1.166, Global test loss: 1.772, Global test accuracy: 35.82
Round   5, Train loss: 1.120, Test loss: 1.159, Test accuracy: 51.92
Round   5, Global train loss: 1.120, Global test loss: 1.783, Global test accuracy: 40.51
Round   6, Train loss: 1.095, Test loss: 1.167, Test accuracy: 53.46
Round   6, Global train loss: 1.095, Global test loss: 1.770, Global test accuracy: 36.88
Round   7, Train loss: 1.054, Test loss: 1.083, Test accuracy: 57.21
Round   7, Global train loss: 1.054, Global test loss: 1.767, Global test accuracy: 36.78
Round   8, Train loss: 1.001, Test loss: 1.064, Test accuracy: 58.05
Round   8, Global train loss: 1.001, Global test loss: 1.846, Global test accuracy: 36.40
Round   9, Train loss: 1.028, Test loss: 1.009, Test accuracy: 59.63
Round   9, Global train loss: 1.028, Global test loss: 1.518, Global test accuracy: 43.99
Round  10, Train loss: 0.966, Test loss: 0.996, Test accuracy: 60.32
Round  10, Global train loss: 0.966, Global test loss: 1.520, Global test accuracy: 42.92
Round  11, Train loss: 0.917, Test loss: 0.962, Test accuracy: 61.90
Round  11, Global train loss: 0.917, Global test loss: 1.654, Global test accuracy: 42.24
Round  12, Train loss: 0.933, Test loss: 0.958, Test accuracy: 62.02
Round  12, Global train loss: 0.933, Global test loss: 1.867, Global test accuracy: 40.34
Round  13, Train loss: 0.932, Test loss: 0.953, Test accuracy: 62.26
Round  13, Global train loss: 0.932, Global test loss: 1.617, Global test accuracy: 41.89
Round  14, Train loss: 0.885, Test loss: 0.918, Test accuracy: 63.78
Round  14, Global train loss: 0.885, Global test loss: 1.457, Global test accuracy: 47.38
Round  15, Train loss: 0.916, Test loss: 0.906, Test accuracy: 64.33
Round  15, Global train loss: 0.916, Global test loss: 1.552, Global test accuracy: 46.08
Round  16, Train loss: 0.842, Test loss: 0.884, Test accuracy: 65.34
Round  16, Global train loss: 0.842, Global test loss: 1.892, Global test accuracy: 42.80
Round  17, Train loss: 0.840, Test loss: 0.879, Test accuracy: 65.56
Round  17, Global train loss: 0.840, Global test loss: 1.694, Global test accuracy: 43.76
Round  18, Train loss: 0.786, Test loss: 0.880, Test accuracy: 65.81
Round  18, Global train loss: 0.786, Global test loss: 1.404, Global test accuracy: 47.70
Round  19, Train loss: 0.788, Test loss: 0.858, Test accuracy: 66.68
Round  19, Global train loss: 0.788, Global test loss: 1.444, Global test accuracy: 49.59
Round  20, Train loss: 0.762, Test loss: 0.864, Test accuracy: 66.95
Round  20, Global train loss: 0.762, Global test loss: 1.280, Global test accuracy: 52.71
Round  21, Train loss: 0.735, Test loss: 0.856, Test accuracy: 67.37
Round  21, Global train loss: 0.735, Global test loss: 1.452, Global test accuracy: 50.36
Round  22, Train loss: 0.739, Test loss: 0.843, Test accuracy: 67.88
Round  22, Global train loss: 0.739, Global test loss: 1.324, Global test accuracy: 53.40
Round  23, Train loss: 0.719, Test loss: 0.841, Test accuracy: 67.97
Round  23, Global train loss: 0.719, Global test loss: 1.257, Global test accuracy: 55.64
Round  24, Train loss: 0.722, Test loss: 0.838, Test accuracy: 68.28
Round  24, Global train loss: 0.722, Global test loss: 1.367, Global test accuracy: 50.73
Round  25, Train loss: 0.696, Test loss: 0.831, Test accuracy: 68.68
Round  25, Global train loss: 0.696, Global test loss: 1.338, Global test accuracy: 52.88
Round  26, Train loss: 0.712, Test loss: 0.818, Test accuracy: 69.14
Round  26, Global train loss: 0.712, Global test loss: 1.156, Global test accuracy: 58.82
Round  27, Train loss: 0.664, Test loss: 0.818, Test accuracy: 69.19
Round  27, Global train loss: 0.664, Global test loss: 1.336, Global test accuracy: 53.28
Round  28, Train loss: 0.640, Test loss: 0.813, Test accuracy: 69.77
Round  28, Global train loss: 0.640, Global test loss: 1.339, Global test accuracy: 53.47
Round  29, Train loss: 0.620, Test loss: 0.824, Test accuracy: 69.95
Round  29, Global train loss: 0.620, Global test loss: 1.313, Global test accuracy: 53.53
Round  30, Train loss: 0.620, Test loss: 0.830, Test accuracy: 70.27
Round  30, Global train loss: 0.620, Global test loss: 1.357, Global test accuracy: 53.28
Round  31, Train loss: 0.594, Test loss: 0.863, Test accuracy: 69.64
Round  31, Global train loss: 0.594, Global test loss: 1.295, Global test accuracy: 55.66
Round  32, Train loss: 0.645, Test loss: 0.860, Test accuracy: 69.76
Round  32, Global train loss: 0.645, Global test loss: 1.340, Global test accuracy: 53.42
Round  33, Train loss: 0.623, Test loss: 0.851, Test accuracy: 69.86
Round  33, Global train loss: 0.623, Global test loss: 1.138, Global test accuracy: 59.62
Round  34, Train loss: 0.639, Test loss: 0.855, Test accuracy: 70.11
Round  34, Global train loss: 0.639, Global test loss: 1.214, Global test accuracy: 57.51
Round  35, Train loss: 0.606, Test loss: 0.852, Test accuracy: 70.26
Round  35, Global train loss: 0.606, Global test loss: 1.215, Global test accuracy: 56.79
Round  36, Train loss: 0.614, Test loss: 0.837, Test accuracy: 70.37
Round  36, Global train loss: 0.614, Global test loss: 1.269, Global test accuracy: 54.93
Round  37, Train loss: 0.582, Test loss: 0.817, Test accuracy: 70.78
Round  37, Global train loss: 0.582, Global test loss: 1.119, Global test accuracy: 60.92
Round  38, Train loss: 0.543, Test loss: 0.831, Test accuracy: 70.52
Round  38, Global train loss: 0.543, Global test loss: 1.469, Global test accuracy: 52.97
Round  39, Train loss: 0.516, Test loss: 0.841, Test accuracy: 70.10
Round  39, Global train loss: 0.516, Global test loss: 1.369, Global test accuracy: 54.47
Round  40, Train loss: 0.557, Test loss: 0.859, Test accuracy: 69.75
Round  40, Global train loss: 0.557, Global test loss: 1.191, Global test accuracy: 59.25
Round  41, Train loss: 0.534, Test loss: 0.854, Test accuracy: 70.24
Round  41, Global train loss: 0.534, Global test loss: 1.310, Global test accuracy: 57.12
Round  42, Train loss: 0.507, Test loss: 0.817, Test accuracy: 71.41
Round  42, Global train loss: 0.507, Global test loss: 1.213, Global test accuracy: 58.94
Round  43, Train loss: 0.485, Test loss: 0.829, Test accuracy: 71.59
Round  43, Global train loss: 0.485, Global test loss: 1.248, Global test accuracy: 58.58
Round  44, Train loss: 0.520, Test loss: 0.825, Test accuracy: 72.24
Round  44, Global train loss: 0.520, Global test loss: 1.272, Global test accuracy: 57.52
Round  45, Train loss: 0.520, Test loss: 0.833, Test accuracy: 72.32
Round  45, Global train loss: 0.520, Global test loss: 1.219, Global test accuracy: 60.23
Round  46, Train loss: 0.474, Test loss: 0.846, Test accuracy: 71.64
Round  46, Global train loss: 0.474, Global test loss: 1.482, Global test accuracy: 56.23
Round  47, Train loss: 0.480, Test loss: 0.852, Test accuracy: 71.52
Round  47, Global train loss: 0.480, Global test loss: 1.214, Global test accuracy: 59.37
Round  48, Train loss: 0.482, Test loss: 0.860, Test accuracy: 71.39
Round  48, Global train loss: 0.482, Global test loss: 1.315, Global test accuracy: 58.10
Round  49, Train loss: 0.506, Test loss: 0.871, Test accuracy: 71.52
Round  49, Global train loss: 0.506, Global test loss: 1.107, Global test accuracy: 62.14
Round  50, Train loss: 0.495, Test loss: 0.854, Test accuracy: 71.97
Round  50, Global train loss: 0.495, Global test loss: 1.305, Global test accuracy: 57.71
Round  51, Train loss: 0.445, Test loss: 0.850, Test accuracy: 72.00
Round  51, Global train loss: 0.445, Global test loss: 1.274, Global test accuracy: 59.99
Round  52, Train loss: 0.451, Test loss: 0.843, Test accuracy: 72.13
Round  52, Global train loss: 0.451, Global test loss: 1.293, Global test accuracy: 58.17
Round  53, Train loss: 0.443, Test loss: 0.837, Test accuracy: 72.31
Round  53, Global train loss: 0.443, Global test loss: 1.428, Global test accuracy: 55.64
Round  54, Train loss: 0.447, Test loss: 0.823, Test accuracy: 72.88
Round  54, Global train loss: 0.447, Global test loss: 1.169, Global test accuracy: 61.77
Round  55, Train loss: 0.489, Test loss: 0.845, Test accuracy: 72.63
Round  55, Global train loss: 0.489, Global test loss: 1.228, Global test accuracy: 60.36
Round  56, Train loss: 0.432, Test loss: 0.825, Test accuracy: 73.33
Round  56, Global train loss: 0.432, Global test loss: 1.339, Global test accuracy: 58.10
Round  57, Train loss: 0.439, Test loss: 0.835, Test accuracy: 73.13
Round  57, Global train loss: 0.439, Global test loss: 1.164, Global test accuracy: 61.93
Round  58, Train loss: 0.466, Test loss: 0.858, Test accuracy: 73.12
Round  58, Global train loss: 0.466, Global test loss: 1.075, Global test accuracy: 63.04
Round  59, Train loss: 0.438, Test loss: 0.886, Test accuracy: 72.63
Round  59, Global train loss: 0.438, Global test loss: 1.346, Global test accuracy: 57.96
Round  60, Train loss: 0.453, Test loss: 0.898, Test accuracy: 72.74
Round  60, Global train loss: 0.453, Global test loss: 1.162, Global test accuracy: 61.98
Round  61, Train loss: 0.388, Test loss: 0.887, Test accuracy: 73.19
Round  61, Global train loss: 0.388, Global test loss: 1.395, Global test accuracy: 57.29
Round  62, Train loss: 0.447, Test loss: 0.897, Test accuracy: 72.61
Round  62, Global train loss: 0.447, Global test loss: 1.509, Global test accuracy: 54.28
Round  63, Train loss: 0.397, Test loss: 0.902, Test accuracy: 72.20
Round  63, Global train loss: 0.397, Global test loss: 1.238, Global test accuracy: 60.99
Round  64, Train loss: 0.386, Test loss: 0.889, Test accuracy: 72.64
Round  64, Global train loss: 0.386, Global test loss: 1.524, Global test accuracy: 55.41
Round  65, Train loss: 0.401, Test loss: 0.873, Test accuracy: 72.58
Round  65, Global train loss: 0.401, Global test loss: 1.124, Global test accuracy: 62.84
Round  66, Train loss: 0.409, Test loss: 0.872, Test accuracy: 72.71
Round  66, Global train loss: 0.409, Global test loss: 1.384, Global test accuracy: 57.23
Round  67, Train loss: 0.385, Test loss: 0.868, Test accuracy: 73.41
Round  67, Global train loss: 0.385, Global test loss: 1.265, Global test accuracy: 60.72
Round  68, Train loss: 0.368, Test loss: 0.886, Test accuracy: 72.97
Round  68, Global train loss: 0.368, Global test loss: 1.386, Global test accuracy: 58.28
Round  69, Train loss: 0.402, Test loss: 0.906, Test accuracy: 72.96
Round  69, Global train loss: 0.402, Global test loss: 1.962, Global test accuracy: 52.08
Round  70, Train loss: 0.416, Test loss: 0.871, Test accuracy: 73.31
Round  70, Global train loss: 0.416, Global test loss: 1.276, Global test accuracy: 60.46
Round  71, Train loss: 0.355, Test loss: 0.882, Test accuracy: 73.29
Round  71, Global train loss: 0.355, Global test loss: 1.525, Global test accuracy: 57.24
Round  72, Train loss: 0.421, Test loss: 0.893, Test accuracy: 73.42
Round  72, Global train loss: 0.421, Global test loss: 1.308, Global test accuracy: 58.83
Round  73, Train loss: 0.351, Test loss: 0.901, Test accuracy: 73.52
Round  73, Global train loss: 0.351, Global test loss: 1.374, Global test accuracy: 58.96
Round  74, Train loss: 0.373, Test loss: 0.909, Test accuracy: 73.55
Round  74, Global train loss: 0.373, Global test loss: 1.246, Global test accuracy: 60.78
Round  75, Train loss: 0.328, Test loss: 0.918, Test accuracy: 73.16
Round  75, Global train loss: 0.328, Global test loss: 1.297, Global test accuracy: 60.46
Round  76, Train loss: 0.360, Test loss: 0.901, Test accuracy: 73.36
Round  76, Global train loss: 0.360, Global test loss: 1.263, Global test accuracy: 60.25
Round  77, Train loss: 0.390, Test loss: 0.891, Test accuracy: 73.60
Round  77, Global train loss: 0.390, Global test loss: 1.321, Global test accuracy: 58.16
Round  78, Train loss: 0.364, Test loss: 0.870, Test accuracy: 74.22
Round  78, Global train loss: 0.364, Global test loss: 1.462, Global test accuracy: 57.61
Round  79, Train loss: 0.377, Test loss: 0.875, Test accuracy: 74.05
Round  79, Global train loss: 0.377, Global test loss: 1.332, Global test accuracy: 60.53
Round  80, Train loss: 0.360, Test loss: 0.910, Test accuracy: 73.63
Round  80, Global train loss: 0.360, Global test loss: 1.235, Global test accuracy: 62.05
Round  81, Train loss: 0.339, Test loss: 0.920, Test accuracy: 73.58
Round  81, Global train loss: 0.339, Global test loss: 1.244, Global test accuracy: 61.76
Round  82, Train loss: 0.338, Test loss: 0.899, Test accuracy: 73.98
Round  82, Global train loss: 0.338, Global test loss: 1.246, Global test accuracy: 61.41
Round  83, Train loss: 0.328, Test loss: 0.882, Test accuracy: 74.49
Round  83, Global train loss: 0.328, Global test loss: 1.335, Global test accuracy: 60.26
Round  84, Train loss: 0.324, Test loss: 0.895, Test accuracy: 74.10
Round  84, Global train loss: 0.324, Global test loss: 1.185, Global test accuracy: 62.69
Round  85, Train loss: 0.307, Test loss: 0.891, Test accuracy: 74.11
Round  85, Global train loss: 0.307, Global test loss: 1.585, Global test accuracy: 56.56
Round  86, Train loss: 0.327, Test loss: 0.892, Test accuracy: 74.63
Round  86, Global train loss: 0.327, Global test loss: 1.210, Global test accuracy: 62.86
Round  87, Train loss: 0.323, Test loss: 0.890, Test accuracy: 74.51
Round  87, Global train loss: 0.323, Global test loss: 1.259, Global test accuracy: 61.37
Round  88, Train loss: 0.313, Test loss: 0.905, Test accuracy: 74.17
Round  88, Global train loss: 0.313, Global test loss: 1.154, Global test accuracy: 64.46
Round  89, Train loss: 0.312, Test loss: 0.915, Test accuracy: 73.76
Round  89, Global train loss: 0.312, Global test loss: 1.258, Global test accuracy: 61.88
Round  90, Train loss: 0.321, Test loss: 0.921, Test accuracy: 73.79
Round  90, Global train loss: 0.321, Global test loss: 1.333, Global test accuracy: 60.60
Round  91, Train loss: 0.296, Test loss: 0.912, Test accuracy: 74.17
Round  91, Global train loss: 0.296, Global test loss: 1.458, Global test accuracy: 58.64
Round  92, Train loss: 0.329, Test loss: 0.906, Test accuracy: 74.53
Round  92, Global train loss: 0.329, Global test loss: 1.459, Global test accuracy: 58.21
Round  93, Train loss: 0.284, Test loss: 0.910, Test accuracy: 74.63
Round  93, Global train loss: 0.284, Global test loss: 1.296, Global test accuracy: 62.24
Round  94, Train loss: 0.284, Test loss: 0.903, Test accuracy: 74.28
Round  94, Global train loss: 0.284, Global test loss: 1.245, Global test accuracy: 63.90
Round  95, Train loss: 0.296, Test loss: 0.892, Test accuracy: 74.84
Round  95, Global train loss: 0.296, Global test loss: 1.386, Global test accuracy: 60.41
Round  96, Train loss: 0.274, Test loss: 0.898, Test accuracy: 74.50
Round  96, Global train loss: 0.274, Global test loss: 1.421, Global test accuracy: 61.36
Round  97, Train loss: 0.297, Test loss: 0.912, Test accuracy: 74.32
Round  97, Global train loss: 0.297, Global test loss: 1.255, Global test accuracy: 62.87
Round  98, Train loss: 0.306, Test loss: 0.915, Test accuracy: 74.46
Round  98, Global train loss: 0.306, Global test loss: 1.715, Global test accuracy: 55.49
Round  99, Train loss: 0.272, Test loss: 0.920, Test accuracy: 74.54
Round  99, Global train loss: 0.272, Global test loss: 1.330, Global test accuracy: 61.52
Final Round, Train loss: 0.233, Test loss: 1.026, Test accuracy: 74.07
Final Round, Global train loss: 0.233, Global test loss: 1.330, Global test accuracy: 61.52
Average accuracy final 10 rounds: 74.406 

Average global accuracy final 10 rounds: 60.524 

1334.1054933071136
[1.4654877185821533, 2.9309754371643066, 4.069503307342529, 5.208031177520752, 6.33941125869751, 7.470791339874268, 8.613895177841187, 9.756999015808105, 10.899985313415527, 12.04297161102295, 13.1802978515625, 14.31762409210205, 15.45530366897583, 16.59298324584961, 17.735687971115112, 18.878392696380615, 20.030510902404785, 21.182629108428955, 22.328445196151733, 23.47426128387451, 24.62016487121582, 25.76606845855713, 26.91204047203064, 28.05801248550415, 29.20647692680359, 30.354941368103027, 31.498903512954712, 32.6428656578064, 33.78663182258606, 34.93039798736572, 36.077860593795776, 37.22532320022583, 38.36580538749695, 39.506287574768066, 40.648157596588135, 41.7900276184082, 42.937963008880615, 44.08589839935303, 45.23137450218201, 46.376850605010986, 47.419931411743164, 48.46301221847534, 49.4501473903656, 50.43728256225586, 51.42793345451355, 52.41858434677124, 53.4037070274353, 54.388829708099365, 55.378602027893066, 56.36837434768677, 57.356266021728516, 58.344157695770264, 59.33276152610779, 60.32136535644531, 61.31268930435181, 62.3040132522583, 63.291940450668335, 64.27986764907837, 65.27124261856079, 66.26261758804321, 67.24570870399475, 68.22879981994629, 69.21000671386719, 70.19121360778809, 71.17713904380798, 72.16306447982788, 73.15658617019653, 74.15010786056519, 75.13968801498413, 76.12926816940308, 77.12650203704834, 78.1237359046936, 79.12181901931763, 80.11990213394165, 81.11863827705383, 82.11737442016602, 83.11730551719666, 84.1172366142273, 85.11741423606873, 86.11759185791016, 87.11793875694275, 88.11828565597534, 89.11885261535645, 90.11941957473755, 91.11645174026489, 92.11348390579224, 93.11330485343933, 94.11312580108643, 95.11350417137146, 96.1138825416565, 97.11340188980103, 98.11292123794556, 99.11355829238892, 100.11419534683228, 101.11208510398865, 102.10997486114502, 103.11053228378296, 104.1110897064209, 105.10899186134338, 106.10689401626587, 107.09479665756226, 108.08269929885864, 109.0757417678833, 110.06878423690796, 111.06480026245117, 112.06081628799438, 113.0545289516449, 114.04824161529541, 115.04292368888855, 116.03760576248169, 117.03166365623474, 118.0257215499878, 119.02283453941345, 120.01994752883911, 121.0152599811554, 122.01057243347168, 123.00291609764099, 123.9952597618103, 124.98742461204529, 125.97958946228027, 126.97372221946716, 127.96785497665405, 128.9608325958252, 129.95381021499634, 130.9494707584381, 131.94513130187988, 132.93921065330505, 133.93329000473022, 134.92866349220276, 135.9240369796753, 136.9159004688263, 137.9077639579773, 138.8925642967224, 139.87736463546753, 140.8665874004364, 141.85581016540527, 142.8447892665863, 143.83376836776733, 144.8193838596344, 145.80499935150146, 146.7918689250946, 147.77873849868774, 148.76685523986816, 149.75497198104858, 150.74976778030396, 151.74456357955933, 152.73544478416443, 153.72632598876953, 154.71636867523193, 155.70641136169434, 156.70473432540894, 157.70305728912354, 158.69614005088806, 159.6892228126526, 160.6776087284088, 161.66599464416504, 162.66288900375366, 163.65978336334229, 164.6533977985382, 165.64701223373413, 166.64031314849854, 167.63361406326294, 168.62797951698303, 169.62234497070312, 170.61471247673035, 171.60707998275757, 172.60041117668152, 173.59374237060547, 174.584125995636, 175.5745096206665, 176.56681966781616, 177.55912971496582, 178.55222916603088, 179.54532861709595, 180.5377049446106, 181.53008127212524, 182.51986360549927, 183.5096459388733, 184.5010757446289, 185.49250555038452, 186.48334407806396, 187.4741826057434, 188.46901035308838, 189.46383810043335, 190.45582914352417, 191.447820186615, 192.43986892700195, 193.43191766738892, 194.42597222328186, 195.4200267791748, 196.41698455810547, 197.41394233703613, 198.40315985679626, 199.3923773765564, 200.3681526184082, 201.34392786026, 202.320720911026, 203.297513961792, 204.27499914169312, 205.25248432159424, 207.20512652397156, 209.15776872634888]
[25.49, 25.49, 36.19, 36.19, 40.68, 40.68, 43.17, 43.17, 46.59, 46.59, 51.92, 51.92, 53.46, 53.46, 57.21, 57.21, 58.05, 58.05, 59.63, 59.63, 60.32, 60.32, 61.9, 61.9, 62.02, 62.02, 62.26, 62.26, 63.78, 63.78, 64.33, 64.33, 65.34, 65.34, 65.56, 65.56, 65.81, 65.81, 66.68, 66.68, 66.95, 66.95, 67.37, 67.37, 67.88, 67.88, 67.97, 67.97, 68.28, 68.28, 68.68, 68.68, 69.14, 69.14, 69.19, 69.19, 69.77, 69.77, 69.95, 69.95, 70.27, 70.27, 69.64, 69.64, 69.76, 69.76, 69.86, 69.86, 70.11, 70.11, 70.26, 70.26, 70.37, 70.37, 70.78, 70.78, 70.52, 70.52, 70.1, 70.1, 69.75, 69.75, 70.24, 70.24, 71.41, 71.41, 71.59, 71.59, 72.24, 72.24, 72.32, 72.32, 71.64, 71.64, 71.52, 71.52, 71.39, 71.39, 71.52, 71.52, 71.97, 71.97, 72.0, 72.0, 72.13, 72.13, 72.31, 72.31, 72.88, 72.88, 72.63, 72.63, 73.33, 73.33, 73.13, 73.13, 73.12, 73.12, 72.63, 72.63, 72.74, 72.74, 73.19, 73.19, 72.61, 72.61, 72.2, 72.2, 72.64, 72.64, 72.58, 72.58, 72.71, 72.71, 73.41, 73.41, 72.97, 72.97, 72.96, 72.96, 73.31, 73.31, 73.29, 73.29, 73.42, 73.42, 73.52, 73.52, 73.55, 73.55, 73.16, 73.16, 73.36, 73.36, 73.6, 73.6, 74.22, 74.22, 74.05, 74.05, 73.63, 73.63, 73.58, 73.58, 73.98, 73.98, 74.49, 74.49, 74.1, 74.1, 74.11, 74.11, 74.63, 74.63, 74.51, 74.51, 74.17, 74.17, 73.76, 73.76, 73.79, 73.79, 74.17, 74.17, 74.53, 74.53, 74.63, 74.63, 74.28, 74.28, 74.84, 74.84, 74.5, 74.5, 74.32, 74.32, 74.46, 74.46, 74.54, 74.54, 74.07, 74.07]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.603, Test loss: 2.049, Test accuracy: 27.34
Round   0, Global train loss: 1.603, Global test loss: 2.237, Global test accuracy: 23.46
Round   1, Train loss: 1.421, Test loss: 1.675, Test accuracy: 36.02
Round   1, Global train loss: 1.421, Global test loss: 2.014, Global test accuracy: 29.33
Round   2, Train loss: 1.318, Test loss: 1.545, Test accuracy: 39.11
Round   2, Global train loss: 1.318, Global test loss: 1.908, Global test accuracy: 29.60
Round   3, Train loss: 1.246, Test loss: 1.387, Test accuracy: 44.34
Round   3, Global train loss: 1.246, Global test loss: 1.838, Global test accuracy: 34.01
Round   4, Train loss: 1.190, Test loss: 1.361, Test accuracy: 46.50
Round   4, Global train loss: 1.190, Global test loss: 1.841, Global test accuracy: 36.40
Round   5, Train loss: 1.161, Test loss: 1.269, Test accuracy: 48.74
Round   5, Global train loss: 1.161, Global test loss: 1.883, Global test accuracy: 32.84
Round   6, Train loss: 1.075, Test loss: 1.243, Test accuracy: 51.17
Round   6, Global train loss: 1.075, Global test loss: 1.749, Global test accuracy: 38.84
Round   7, Train loss: 1.077, Test loss: 1.163, Test accuracy: 54.00
Round   7, Global train loss: 1.077, Global test loss: 1.730, Global test accuracy: 41.06
Round   8, Train loss: 1.054, Test loss: 1.147, Test accuracy: 53.42
Round   8, Global train loss: 1.054, Global test loss: 1.590, Global test accuracy: 39.70
Round   9, Train loss: 1.058, Test loss: 1.082, Test accuracy: 56.35
Round   9, Global train loss: 1.058, Global test loss: 1.657, Global test accuracy: 39.10
Round  10, Train loss: 0.984, Test loss: 1.040, Test accuracy: 58.41
Round  10, Global train loss: 0.984, Global test loss: 1.620, Global test accuracy: 40.78
Round  11, Train loss: 0.987, Test loss: 1.054, Test accuracy: 57.93
Round  11, Global train loss: 0.987, Global test loss: 1.592, Global test accuracy: 40.32
Round  12, Train loss: 0.951, Test loss: 1.020, Test accuracy: 59.34
Round  12, Global train loss: 0.951, Global test loss: 1.625, Global test accuracy: 44.07
Round  13, Train loss: 0.930, Test loss: 0.979, Test accuracy: 60.57
Round  13, Global train loss: 0.930, Global test loss: 1.658, Global test accuracy: 41.50
Round  14, Train loss: 0.925, Test loss: 0.982, Test accuracy: 60.86
Round  14, Global train loss: 0.925, Global test loss: 1.435, Global test accuracy: 46.74
Round  15, Train loss: 0.900, Test loss: 0.967, Test accuracy: 62.09
Round  15, Global train loss: 0.900, Global test loss: 1.456, Global test accuracy: 47.79
Round  16, Train loss: 0.870, Test loss: 0.955, Test accuracy: 62.57
Round  16, Global train loss: 0.870, Global test loss: 1.579, Global test accuracy: 45.01
Round  17, Train loss: 0.912, Test loss: 0.924, Test accuracy: 63.84
Round  17, Global train loss: 0.912, Global test loss: 1.406, Global test accuracy: 48.38
Round  18, Train loss: 0.859, Test loss: 0.919, Test accuracy: 64.42
Round  18, Global train loss: 0.859, Global test loss: 1.471, Global test accuracy: 46.19
Round  19, Train loss: 0.821, Test loss: 0.913, Test accuracy: 64.83
Round  19, Global train loss: 0.821, Global test loss: 1.459, Global test accuracy: 47.26
Round  20, Train loss: 0.846, Test loss: 0.906, Test accuracy: 65.23
Round  20, Global train loss: 0.846, Global test loss: 1.509, Global test accuracy: 45.75
Round  21, Train loss: 0.789, Test loss: 0.898, Test accuracy: 65.55
Round  21, Global train loss: 0.789, Global test loss: 1.533, Global test accuracy: 48.42
Round  22, Train loss: 0.806, Test loss: 0.887, Test accuracy: 66.02
Round  22, Global train loss: 0.806, Global test loss: 1.539, Global test accuracy: 47.58
Round  23, Train loss: 0.843, Test loss: 0.885, Test accuracy: 66.08
Round  23, Global train loss: 0.843, Global test loss: 1.298, Global test accuracy: 51.63
Round  24, Train loss: 0.791, Test loss: 0.875, Test accuracy: 66.19
Round  24, Global train loss: 0.791, Global test loss: 1.446, Global test accuracy: 49.78
Round  25, Train loss: 0.785, Test loss: 0.866, Test accuracy: 66.76
Round  25, Global train loss: 0.785, Global test loss: 1.291, Global test accuracy: 53.64
Round  26, Train loss: 0.758, Test loss: 0.859, Test accuracy: 67.20
Round  26, Global train loss: 0.758, Global test loss: 1.274, Global test accuracy: 53.50
Round  27, Train loss: 0.773, Test loss: 0.853, Test accuracy: 67.83
Round  27, Global train loss: 0.773, Global test loss: 1.872, Global test accuracy: 45.18
Round  28, Train loss: 0.719, Test loss: 0.842, Test accuracy: 67.93
Round  28, Global train loss: 0.719, Global test loss: 1.502, Global test accuracy: 49.81
Round  29, Train loss: 0.733, Test loss: 0.842, Test accuracy: 68.43
Round  29, Global train loss: 0.733, Global test loss: 1.333, Global test accuracy: 54.82
Round  30, Train loss: 0.770, Test loss: 0.841, Test accuracy: 68.45
Round  30, Global train loss: 0.770, Global test loss: 1.232, Global test accuracy: 54.29
Round  31, Train loss: 0.701, Test loss: 0.836, Test accuracy: 68.82
Round  31, Global train loss: 0.701, Global test loss: 1.629, Global test accuracy: 48.33
Round  32, Train loss: 0.702, Test loss: 0.835, Test accuracy: 68.62
Round  32, Global train loss: 0.702, Global test loss: 1.301, Global test accuracy: 52.35
Round  33, Train loss: 0.656, Test loss: 0.844, Test accuracy: 68.57
Round  33, Global train loss: 0.656, Global test loss: 1.376, Global test accuracy: 53.01
Round  34, Train loss: 0.674, Test loss: 0.829, Test accuracy: 69.31
Round  34, Global train loss: 0.674, Global test loss: 1.523, Global test accuracy: 51.16
Round  35, Train loss: 0.722, Test loss: 0.849, Test accuracy: 69.01
Round  35, Global train loss: 0.722, Global test loss: 1.226, Global test accuracy: 56.23
Round  36, Train loss: 0.682, Test loss: 0.844, Test accuracy: 69.24
Round  36, Global train loss: 0.682, Global test loss: 1.405, Global test accuracy: 52.19
Round  37, Train loss: 0.674, Test loss: 0.819, Test accuracy: 69.85
Round  37, Global train loss: 0.674, Global test loss: 1.243, Global test accuracy: 57.94
Round  38, Train loss: 0.688, Test loss: 0.824, Test accuracy: 69.87
Round  38, Global train loss: 0.688, Global test loss: 1.139, Global test accuracy: 59.93
Round  39, Train loss: 0.669, Test loss: 0.824, Test accuracy: 70.18
Round  39, Global train loss: 0.669, Global test loss: 1.290, Global test accuracy: 54.84
Round  40, Train loss: 0.624, Test loss: 0.828, Test accuracy: 70.15
Round  40, Global train loss: 0.624, Global test loss: 1.563, Global test accuracy: 50.69
Round  41, Train loss: 0.627, Test loss: 0.834, Test accuracy: 70.37
Round  41, Global train loss: 0.627, Global test loss: 1.266, Global test accuracy: 55.40
Round  42, Train loss: 0.597, Test loss: 0.833, Test accuracy: 70.31
Round  42, Global train loss: 0.597, Global test loss: 1.227, Global test accuracy: 57.30
Round  43, Train loss: 0.587, Test loss: 0.838, Test accuracy: 70.41
Round  43, Global train loss: 0.587, Global test loss: 1.158, Global test accuracy: 60.08
Round  44, Train loss: 0.630, Test loss: 0.824, Test accuracy: 70.68
Round  44, Global train loss: 0.630, Global test loss: 1.192, Global test accuracy: 58.33
Round  45, Train loss: 0.610, Test loss: 0.838, Test accuracy: 70.29
Round  45, Global train loss: 0.610, Global test loss: 1.165, Global test accuracy: 60.52
Round  46, Train loss: 0.583, Test loss: 0.821, Test accuracy: 71.13
Round  46, Global train loss: 0.583, Global test loss: 1.489, Global test accuracy: 53.45
Round  47, Train loss: 0.553, Test loss: 0.825, Test accuracy: 70.69
Round  47, Global train loss: 0.553, Global test loss: 1.209, Global test accuracy: 59.05
Round  48, Train loss: 0.565, Test loss: 0.844, Test accuracy: 70.08
Round  48, Global train loss: 0.565, Global test loss: 1.402, Global test accuracy: 53.91
Round  49, Train loss: 0.562, Test loss: 0.851, Test accuracy: 70.37
Round  49, Global train loss: 0.562, Global test loss: 1.369, Global test accuracy: 55.33
Round  50, Train loss: 0.544, Test loss: 0.856, Test accuracy: 70.74
Round  50, Global train loss: 0.544, Global test loss: 1.264, Global test accuracy: 58.92
Round  51, Train loss: 0.545, Test loss: 0.849, Test accuracy: 71.02
Round  51, Global train loss: 0.545, Global test loss: 1.204, Global test accuracy: 59.94
Round  52, Train loss: 0.549, Test loss: 0.859, Test accuracy: 70.73
Round  52, Global train loss: 0.549, Global test loss: 1.484, Global test accuracy: 54.68
Round  53, Train loss: 0.552, Test loss: 0.853, Test accuracy: 70.78
Round  53, Global train loss: 0.552, Global test loss: 1.454, Global test accuracy: 54.69
Round  54, Train loss: 0.528, Test loss: 0.859, Test accuracy: 70.53
Round  54, Global train loss: 0.528, Global test loss: 1.092, Global test accuracy: 62.29
Round  55, Train loss: 0.509, Test loss: 0.843, Test accuracy: 70.85
Round  55, Global train loss: 0.509, Global test loss: 1.146, Global test accuracy: 61.73
Round  56, Train loss: 0.533, Test loss: 0.820, Test accuracy: 71.34
Round  56, Global train loss: 0.533, Global test loss: 1.166, Global test accuracy: 60.70
Round  57, Train loss: 0.532, Test loss: 0.813, Test accuracy: 71.60
Round  57, Global train loss: 0.532, Global test loss: 1.152, Global test accuracy: 61.61
Round  58, Train loss: 0.506, Test loss: 0.839, Test accuracy: 71.26
Round  58, Global train loss: 0.506, Global test loss: 1.108, Global test accuracy: 62.45
Round  59, Train loss: 0.511, Test loss: 0.831, Test accuracy: 71.52
Round  59, Global train loss: 0.511, Global test loss: 1.282, Global test accuracy: 58.34
Round  60, Train loss: 0.494, Test loss: 0.845, Test accuracy: 71.54
Round  60, Global train loss: 0.494, Global test loss: 1.192, Global test accuracy: 61.21
Round  61, Train loss: 0.501, Test loss: 0.854, Test accuracy: 71.47
Round  61, Global train loss: 0.501, Global test loss: 1.243, Global test accuracy: 59.18
Round  62, Train loss: 0.503, Test loss: 0.830, Test accuracy: 71.81
Round  62, Global train loss: 0.503, Global test loss: 1.369, Global test accuracy: 55.74
Round  63, Train loss: 0.465, Test loss: 0.833, Test accuracy: 72.13
Round  63, Global train loss: 0.465, Global test loss: 1.351, Global test accuracy: 57.17
Round  64, Train loss: 0.484, Test loss: 0.838, Test accuracy: 72.17
Round  64, Global train loss: 0.484, Global test loss: 1.094, Global test accuracy: 63.86
Round  65, Train loss: 0.479, Test loss: 0.832, Test accuracy: 71.98
Round  65, Global train loss: 0.479, Global test loss: 1.064, Global test accuracy: 63.57
Round  66, Train loss: 0.474, Test loss: 0.829, Test accuracy: 72.33
Round  66, Global train loss: 0.474, Global test loss: 1.149, Global test accuracy: 62.15
Round  67, Train loss: 0.433, Test loss: 0.855, Test accuracy: 71.88
Round  67, Global train loss: 0.433, Global test loss: 1.108, Global test accuracy: 62.88
Round  68, Train loss: 0.421, Test loss: 0.840, Test accuracy: 72.47
Round  68, Global train loss: 0.421, Global test loss: 1.104, Global test accuracy: 63.29
Round  69, Train loss: 0.451, Test loss: 0.835, Test accuracy: 72.48
Round  69, Global train loss: 0.451, Global test loss: 1.242, Global test accuracy: 59.50
Round  70, Train loss: 0.461, Test loss: 0.833, Test accuracy: 72.84
Round  70, Global train loss: 0.461, Global test loss: 1.141, Global test accuracy: 62.24
Round  71, Train loss: 0.416, Test loss: 0.818, Test accuracy: 73.16
Round  71, Global train loss: 0.416, Global test loss: 1.208, Global test accuracy: 61.27
Round  72, Train loss: 0.409, Test loss: 0.852, Test accuracy: 72.47
Round  72, Global train loss: 0.409, Global test loss: 1.299, Global test accuracy: 58.69
Round  73, Train loss: 0.441, Test loss: 0.839, Test accuracy: 72.95
Round  73, Global train loss: 0.441, Global test loss: 1.408, Global test accuracy: 57.82
Round  74, Train loss: 0.407, Test loss: 0.853, Test accuracy: 72.94
Round  74, Global train loss: 0.407, Global test loss: 1.185, Global test accuracy: 62.03
Round  75, Train loss: 0.430, Test loss: 0.846, Test accuracy: 72.80
Round  75, Global train loss: 0.430, Global test loss: 1.088, Global test accuracy: 64.03
Round  76, Train loss: 0.413, Test loss: 0.868, Test accuracy: 72.42
Round  76, Global train loss: 0.413, Global test loss: 1.238, Global test accuracy: 61.72
Round  77, Train loss: 0.446, Test loss: 0.872, Test accuracy: 72.47
Round  77, Global train loss: 0.446, Global test loss: 1.124, Global test accuracy: 63.56
Round  78, Train loss: 0.385, Test loss: 0.885, Test accuracy: 72.13
Round  78, Global train loss: 0.385, Global test loss: 1.356, Global test accuracy: 59.08
Round  79, Train loss: 0.383, Test loss: 0.870, Test accuracy: 72.50
Round  79, Global train loss: 0.383, Global test loss: 1.338, Global test accuracy: 60.01
Round  80, Train loss: 0.418, Test loss: 0.853, Test accuracy: 72.59
Round  80, Global train loss: 0.418, Global test loss: 1.266, Global test accuracy: 60.23
Round  81, Train loss: 0.373, Test loss: 0.855, Test accuracy: 72.54
Round  81, Global train loss: 0.373, Global test loss: 1.243, Global test accuracy: 61.30
Round  82, Train loss: 0.441, Test loss: 0.857, Test accuracy: 72.72
Round  82, Global train loss: 0.441, Global test loss: 1.238, Global test accuracy: 61.68
Round  83, Train loss: 0.423, Test loss: 0.862, Test accuracy: 72.40
Round  83, Global train loss: 0.423, Global test loss: 1.310, Global test accuracy: 60.04
Round  84, Train loss: 0.392, Test loss: 0.875, Test accuracy: 72.77
Round  84, Global train loss: 0.392, Global test loss: 1.322, Global test accuracy: 60.65
Round  85, Train loss: 0.388, Test loss: 0.876, Test accuracy: 72.98
Round  85, Global train loss: 0.388, Global test loss: 1.249, Global test accuracy: 61.70
Round  86, Train loss: 0.380, Test loss: 0.872, Test accuracy: 72.98
Round  86, Global train loss: 0.380, Global test loss: 1.340, Global test accuracy: 60.01
Round  87, Train loss: 0.395, Test loss: 0.867, Test accuracy: 73.35
Round  87, Global train loss: 0.395, Global test loss: 1.900, Global test accuracy: 53.04
Round  88, Train loss: 0.398, Test loss: 0.876, Test accuracy: 73.30
Round  88, Global train loss: 0.398, Global test loss: 1.360, Global test accuracy: 59.69
Round  89, Train loss: 0.372, Test loss: 0.902, Test accuracy: 72.77
Round  89, Global train loss: 0.372, Global test loss: 1.390, Global test accuracy: 59.49
Round  90, Train loss: 0.400, Test loss: 0.894, Test accuracy: 72.97
Round  90, Global train loss: 0.400, Global test loss: 1.387, Global test accuracy: 59.51
Round  91, Train loss: 0.350, Test loss: 0.892, Test accuracy: 73.06
Round  91, Global train loss: 0.350, Global test loss: 1.587, Global test accuracy: 57.15
Round  92, Train loss: 0.383, Test loss: 0.889, Test accuracy: 72.97
Round  92, Global train loss: 0.383, Global test loss: 1.266, Global test accuracy: 61.67
Round  93, Train loss: 0.367, Test loss: 0.883, Test accuracy: 73.18
Round  93, Global train loss: 0.367, Global test loss: 1.626, Global test accuracy: 57.17
Round  94, Train loss: 0.323, Test loss: 0.878, Test accuracy: 73.81
Round  94, Global train loss: 0.323, Global test loss: 1.342, Global test accuracy: 61.11
Round  95, Train loss: 0.379, Test loss: 0.875, Test accuracy: 74.11
Round  95, Global train loss: 0.379, Global test loss: 1.183, Global test accuracy: 63.87/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  96, Train loss: 0.354, Test loss: 0.895, Test accuracy: 74.00
Round  96, Global train loss: 0.354, Global test loss: 1.237, Global test accuracy: 62.86
Round  97, Train loss: 0.355, Test loss: 0.908, Test accuracy: 73.53
Round  97, Global train loss: 0.355, Global test loss: 1.244, Global test accuracy: 62.84
Round  98, Train loss: 0.376, Test loss: 0.878, Test accuracy: 73.81
Round  98, Global train loss: 0.376, Global test loss: 1.138, Global test accuracy: 64.80
Round  99, Train loss: 0.353, Test loss: 0.894, Test accuracy: 73.51
Round  99, Global train loss: 0.353, Global test loss: 1.244, Global test accuracy: 62.50
Final Round, Train loss: 0.286, Test loss: 0.926, Test accuracy: 73.55
Final Round, Global train loss: 0.286, Global test loss: 1.244, Global test accuracy: 62.50
Average accuracy final 10 rounds: 73.495 

Average global accuracy final 10 rounds: 61.34799999999999 

1510.0541179180145
[1.5319654941558838, 3.0639309883117676, 4.354197263717651, 5.644463539123535, 6.935909748077393, 8.22735595703125, 9.517481327056885, 10.80760669708252, 12.098405122756958, 13.389203548431396, 14.672242879867554, 15.955282211303711, 17.250037908554077, 18.544793605804443, 19.84390902519226, 21.143024444580078, 22.437984228134155, 23.732944011688232, 25.035761833190918, 26.338579654693604, 27.64158535003662, 28.94459104537964, 30.24313712120056, 31.541683197021484, 32.819844484329224, 34.09800577163696, 35.37255501747131, 36.647104263305664, 37.94346594810486, 39.23982763290405, 40.53373908996582, 41.82765054702759, 43.12421202659607, 44.42077350616455, 45.71852231025696, 47.016271114349365, 48.31217002868652, 49.60806894302368, 50.90798854827881, 52.207908153533936, 53.510831356048584, 54.81375455856323, 56.114224433898926, 57.41469430923462, 58.71172261238098, 60.008750915527344, 61.30553078651428, 62.60231065750122, 63.90634322166443, 65.21037578582764, 66.5086760520935, 67.80697631835938, 69.11238193511963, 70.41778755187988, 71.71453213691711, 73.01127672195435, 74.31207656860352, 75.61287641525269, 76.91506743431091, 78.21725845336914, 79.5161681175232, 80.81507778167725, 82.11694264411926, 83.41880750656128, 84.71991920471191, 86.02103090286255, 87.32334232330322, 88.6256537437439, 89.92796802520752, 91.23028230667114, 92.53193259239197, 93.8335828781128, 95.13874077796936, 96.44389867782593, 97.74619722366333, 99.04849576950073, 100.35193800926208, 101.65538024902344, 102.96236300468445, 104.26934576034546, 105.57358717918396, 106.87782859802246, 108.18009066581726, 109.48235273361206, 110.78101229667664, 112.07967185974121, 113.37899136543274, 114.67831087112427, 115.97937297821045, 117.28043508529663, 118.58395099639893, 119.88746690750122, 121.18151068687439, 122.47555446624756, 123.77563786506653, 125.0757212638855, 126.37279009819031, 127.66985893249512, 128.96678376197815, 130.26370859146118, 131.5575385093689, 132.8513684272766, 134.1723656654358, 135.49336290359497, 136.79508113861084, 138.0967993736267, 139.4060070514679, 140.71521472930908, 142.02191281318665, 143.3286108970642, 144.63054633140564, 145.93248176574707, 147.23649668693542, 148.54051160812378, 149.84449124336243, 151.14847087860107, 152.4587368965149, 153.7690029144287, 155.07348251342773, 156.37796211242676, 157.68088603019714, 158.98380994796753, 160.28677320480347, 161.5897364616394, 162.8993182182312, 164.208899974823, 165.5140483379364, 166.8191967010498, 168.1248927116394, 169.430588722229, 170.7334909439087, 172.03639316558838, 173.3456997871399, 174.6550064086914, 175.95767879486084, 177.26035118103027, 178.56265354156494, 179.8649559020996, 181.17742133140564, 182.48988676071167, 183.7968442440033, 185.10380172729492, 186.41071605682373, 187.71763038635254, 189.02169060707092, 190.3257508277893, 191.6291344165802, 192.9325180053711, 194.24065327644348, 195.54878854751587, 196.85556435585022, 198.16234016418457, 199.46664309501648, 200.7709460258484, 202.07495546340942, 203.37896490097046, 204.68247485160828, 205.9859848022461, 207.28885102272034, 208.59171724319458, 209.89692449569702, 211.20213174819946, 212.5071496963501, 213.81216764450073, 215.11973071098328, 216.42729377746582, 217.7353572845459, 219.04342079162598, 220.35151600837708, 221.65961122512817, 222.95672082901, 224.25383043289185, 225.56358075141907, 226.8733310699463, 228.1709201335907, 229.4685091972351, 230.775004863739, 232.08150053024292, 233.38566541671753, 234.68983030319214, 235.99396395683289, 237.29809761047363, 238.60206842422485, 239.90603923797607, 241.2107253074646, 242.51541137695312, 243.82316255569458, 245.13091373443604, 246.43645811080933, 247.74200248718262, 249.04792022705078, 250.35383796691895, 251.65655207633972, 252.9592661857605, 254.26529908180237, 255.57133197784424, 256.8774254322052, 258.18351888656616, 259.4869763851166, 260.790433883667, 263.3703751564026, 265.9503164291382]
[27.34, 27.34, 36.02, 36.02, 39.11, 39.11, 44.34, 44.34, 46.5, 46.5, 48.74, 48.74, 51.17, 51.17, 54.0, 54.0, 53.42, 53.42, 56.35, 56.35, 58.41, 58.41, 57.93, 57.93, 59.34, 59.34, 60.57, 60.57, 60.86, 60.86, 62.09, 62.09, 62.57, 62.57, 63.84, 63.84, 64.42, 64.42, 64.83, 64.83, 65.23, 65.23, 65.55, 65.55, 66.02, 66.02, 66.08, 66.08, 66.19, 66.19, 66.76, 66.76, 67.2, 67.2, 67.83, 67.83, 67.93, 67.93, 68.43, 68.43, 68.45, 68.45, 68.82, 68.82, 68.62, 68.62, 68.57, 68.57, 69.31, 69.31, 69.01, 69.01, 69.24, 69.24, 69.85, 69.85, 69.87, 69.87, 70.18, 70.18, 70.15, 70.15, 70.37, 70.37, 70.31, 70.31, 70.41, 70.41, 70.68, 70.68, 70.29, 70.29, 71.13, 71.13, 70.69, 70.69, 70.08, 70.08, 70.37, 70.37, 70.74, 70.74, 71.02, 71.02, 70.73, 70.73, 70.78, 70.78, 70.53, 70.53, 70.85, 70.85, 71.34, 71.34, 71.6, 71.6, 71.26, 71.26, 71.52, 71.52, 71.54, 71.54, 71.47, 71.47, 71.81, 71.81, 72.13, 72.13, 72.17, 72.17, 71.98, 71.98, 72.33, 72.33, 71.88, 71.88, 72.47, 72.47, 72.48, 72.48, 72.84, 72.84, 73.16, 73.16, 72.47, 72.47, 72.95, 72.95, 72.94, 72.94, 72.8, 72.8, 72.42, 72.42, 72.47, 72.47, 72.13, 72.13, 72.5, 72.5, 72.59, 72.59, 72.54, 72.54, 72.72, 72.72, 72.4, 72.4, 72.77, 72.77, 72.98, 72.98, 72.98, 72.98, 73.35, 73.35, 73.3, 73.3, 72.77, 72.77, 72.97, 72.97, 73.06, 73.06, 72.97, 72.97, 73.18, 73.18, 73.81, 73.81, 74.11, 74.11, 74.0, 74.0, 73.53, 73.53, 73.81, 73.81, 73.51, 73.51, 73.55, 73.55]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.580, Test loss: 1.961, Test accuracy: 27.79
Round   0, Global train loss: 1.580, Global test loss: 2.162, Global test accuracy: 23.57
Round   1, Train loss: 1.411, Test loss: 1.731, Test accuracy: 36.53
Round   1, Global train loss: 1.411, Global test loss: 2.112, Global test accuracy: 28.64
Round   2, Train loss: 1.276, Test loss: 1.643, Test accuracy: 38.43
Round   2, Global train loss: 1.276, Global test loss: 1.972, Global test accuracy: 30.66
Round   3, Train loss: 1.211, Test loss: 1.472, Test accuracy: 44.22
Round   3, Global train loss: 1.211, Global test loss: 1.947, Global test accuracy: 33.92
Round   4, Train loss: 1.087, Test loss: 1.358, Test accuracy: 47.54
Round   4, Global train loss: 1.087, Global test loss: 1.942, Global test accuracy: 31.83
Round   5, Train loss: 1.145, Test loss: 1.219, Test accuracy: 52.11
Round   5, Global train loss: 1.145, Global test loss: 1.875, Global test accuracy: 33.06
Round   6, Train loss: 1.023, Test loss: 1.221, Test accuracy: 52.89
Round   6, Global train loss: 1.023, Global test loss: 1.826, Global test accuracy: 36.22
Round   7, Train loss: 1.021, Test loss: 1.156, Test accuracy: 54.49
Round   7, Global train loss: 1.021, Global test loss: 1.755, Global test accuracy: 39.56
Round   8, Train loss: 1.005, Test loss: 1.144, Test accuracy: 55.78
Round   8, Global train loss: 1.005, Global test loss: 1.656, Global test accuracy: 43.66
Round   9, Train loss: 1.012, Test loss: 1.114, Test accuracy: 56.58
Round   9, Global train loss: 1.012, Global test loss: 1.667, Global test accuracy: 41.24
Round  10, Train loss: 0.953, Test loss: 1.089, Test accuracy: 57.42
Round  10, Global train loss: 0.953, Global test loss: 1.464, Global test accuracy: 45.94
Round  11, Train loss: 0.944, Test loss: 1.051, Test accuracy: 58.90
Round  11, Global train loss: 0.944, Global test loss: 1.480, Global test accuracy: 46.39
Round  12, Train loss: 0.923, Test loss: 1.054, Test accuracy: 59.01
Round  12, Global train loss: 0.923, Global test loss: 1.498, Global test accuracy: 44.48
Round  13, Train loss: 0.902, Test loss: 1.035, Test accuracy: 59.63
Round  13, Global train loss: 0.902, Global test loss: 1.534, Global test accuracy: 43.87
Round  14, Train loss: 0.894, Test loss: 1.015, Test accuracy: 60.64
Round  14, Global train loss: 0.894, Global test loss: 1.461, Global test accuracy: 45.95
Round  15, Train loss: 0.872, Test loss: 0.974, Test accuracy: 62.85
Round  15, Global train loss: 0.872, Global test loss: 1.665, Global test accuracy: 43.11
Round  16, Train loss: 0.827, Test loss: 0.953, Test accuracy: 63.54
Round  16, Global train loss: 0.827, Global test loss: 1.745, Global test accuracy: 41.75
Round  17, Train loss: 0.791, Test loss: 0.962, Test accuracy: 63.56
Round  17, Global train loss: 0.791, Global test loss: 1.390, Global test accuracy: 49.27
Round  18, Train loss: 0.817, Test loss: 0.945, Test accuracy: 64.26
Round  18, Global train loss: 0.817, Global test loss: 1.546, Global test accuracy: 46.29
Round  19, Train loss: 0.858, Test loss: 0.932, Test accuracy: 64.70
Round  19, Global train loss: 0.858, Global test loss: 1.389, Global test accuracy: 48.96
Round  20, Train loss: 0.787, Test loss: 0.915, Test accuracy: 65.25
Round  20, Global train loss: 0.787, Global test loss: 1.398, Global test accuracy: 49.74
Round  21, Train loss: 0.777, Test loss: 0.912, Test accuracy: 65.25
Round  21, Global train loss: 0.777, Global test loss: 1.431, Global test accuracy: 48.62
Round  22, Train loss: 0.789, Test loss: 0.915, Test accuracy: 65.29
Round  22, Global train loss: 0.789, Global test loss: 1.416, Global test accuracy: 48.94
Round  23, Train loss: 0.738, Test loss: 0.913, Test accuracy: 65.69
Round  23, Global train loss: 0.738, Global test loss: 1.458, Global test accuracy: 48.60
Round  24, Train loss: 0.734, Test loss: 0.907, Test accuracy: 66.25
Round  24, Global train loss: 0.734, Global test loss: 1.390, Global test accuracy: 51.66
Round  25, Train loss: 0.750, Test loss: 0.904, Test accuracy: 66.15
Round  25, Global train loss: 0.750, Global test loss: 1.318, Global test accuracy: 52.02
Round  26, Train loss: 0.706, Test loss: 0.889, Test accuracy: 66.52
Round  26, Global train loss: 0.706, Global test loss: 1.579, Global test accuracy: 46.24
Round  27, Train loss: 0.729, Test loss: 0.879, Test accuracy: 66.80
Round  27, Global train loss: 0.729, Global test loss: 1.307, Global test accuracy: 53.27
Round  28, Train loss: 0.671, Test loss: 0.901, Test accuracy: 66.24
Round  28, Global train loss: 0.671, Global test loss: 1.560, Global test accuracy: 50.89
Round  29, Train loss: 0.673, Test loss: 0.911, Test accuracy: 66.58
Round  29, Global train loss: 0.673, Global test loss: 1.540, Global test accuracy: 47.28
Round  30, Train loss: 0.677, Test loss: 0.882, Test accuracy: 67.56
Round  30, Global train loss: 0.677, Global test loss: 1.381, Global test accuracy: 52.99
Round  31, Train loss: 0.635, Test loss: 0.871, Test accuracy: 67.64
Round  31, Global train loss: 0.635, Global test loss: 1.244, Global test accuracy: 55.97
Round  32, Train loss: 0.612, Test loss: 0.883, Test accuracy: 67.94
Round  32, Global train loss: 0.612, Global test loss: 1.336, Global test accuracy: 54.63
Round  33, Train loss: 0.592, Test loss: 0.867, Test accuracy: 68.48
Round  33, Global train loss: 0.592, Global test loss: 1.230, Global test accuracy: 57.81
Round  34, Train loss: 0.593, Test loss: 0.855, Test accuracy: 69.12
Round  34, Global train loss: 0.593, Global test loss: 1.322, Global test accuracy: 55.14
Round  35, Train loss: 0.601, Test loss: 0.879, Test accuracy: 68.98
Round  35, Global train loss: 0.601, Global test loss: 1.320, Global test accuracy: 54.30
Round  36, Train loss: 0.618, Test loss: 0.885, Test accuracy: 69.03
Round  36, Global train loss: 0.618, Global test loss: 1.513, Global test accuracy: 52.18
Round  37, Train loss: 0.611, Test loss: 0.878, Test accuracy: 69.27
Round  37, Global train loss: 0.611, Global test loss: 1.380, Global test accuracy: 54.88
Round  38, Train loss: 0.618, Test loss: 0.864, Test accuracy: 69.77
Round  38, Global train loss: 0.618, Global test loss: 1.345, Global test accuracy: 54.05
Round  39, Train loss: 0.555, Test loss: 0.864, Test accuracy: 70.32
Round  39, Global train loss: 0.555, Global test loss: 1.346, Global test accuracy: 53.95
Round  40, Train loss: 0.582, Test loss: 0.880, Test accuracy: 69.96
Round  40, Global train loss: 0.582, Global test loss: 1.159, Global test accuracy: 60.23
Round  41, Train loss: 0.569, Test loss: 0.880, Test accuracy: 70.10
Round  41, Global train loss: 0.569, Global test loss: 1.226, Global test accuracy: 57.20
Round  42, Train loss: 0.563, Test loss: 0.877, Test accuracy: 70.08
Round  42, Global train loss: 0.563, Global test loss: 1.596, Global test accuracy: 50.92
Round  43, Train loss: 0.558, Test loss: 0.875, Test accuracy: 70.44
Round  43, Global train loss: 0.558, Global test loss: 1.632, Global test accuracy: 52.14
Round  44, Train loss: 0.545, Test loss: 0.890, Test accuracy: 70.33
Round  44, Global train loss: 0.545, Global test loss: 1.351, Global test accuracy: 55.08
Round  45, Train loss: 0.496, Test loss: 0.878, Test accuracy: 70.53
Round  45, Global train loss: 0.496, Global test loss: 1.313, Global test accuracy: 57.04
Round  46, Train loss: 0.484, Test loss: 0.882, Test accuracy: 70.55
Round  46, Global train loss: 0.484, Global test loss: 1.180, Global test accuracy: 60.18
Round  47, Train loss: 0.523, Test loss: 0.872, Test accuracy: 70.72
Round  47, Global train loss: 0.523, Global test loss: 1.367, Global test accuracy: 56.30
Round  48, Train loss: 0.556, Test loss: 0.897, Test accuracy: 70.38
Round  48, Global train loss: 0.556, Global test loss: 1.581, Global test accuracy: 51.47
Round  49, Train loss: 0.539, Test loss: 0.899, Test accuracy: 70.16
Round  49, Global train loss: 0.539, Global test loss: 1.433, Global test accuracy: 53.92
Round  50, Train loss: 0.529, Test loss: 0.900, Test accuracy: 70.86
Round  50, Global train loss: 0.529, Global test loss: 1.254, Global test accuracy: 58.42
Round  51, Train loss: 0.489, Test loss: 0.881, Test accuracy: 71.47
Round  51, Global train loss: 0.489, Global test loss: 1.207, Global test accuracy: 59.65
Round  52, Train loss: 0.470, Test loss: 0.898, Test accuracy: 70.78
Round  52, Global train loss: 0.470, Global test loss: 1.376, Global test accuracy: 57.15
Round  53, Train loss: 0.502, Test loss: 0.900, Test accuracy: 70.77
Round  53, Global train loss: 0.502, Global test loss: 1.276, Global test accuracy: 58.12
Round  54, Train loss: 0.514, Test loss: 0.886, Test accuracy: 70.97
Round  54, Global train loss: 0.514, Global test loss: 1.462, Global test accuracy: 52.67
Round  55, Train loss: 0.464, Test loss: 0.879, Test accuracy: 71.68
Round  55, Global train loss: 0.464, Global test loss: 1.507, Global test accuracy: 54.69
Round  56, Train loss: 0.478, Test loss: 0.895, Test accuracy: 71.57
Round  56, Global train loss: 0.478, Global test loss: 1.232, Global test accuracy: 58.90
Round  57, Train loss: 0.449, Test loss: 0.877, Test accuracy: 71.93
Round  57, Global train loss: 0.449, Global test loss: 1.582, Global test accuracy: 52.83
Round  58, Train loss: 0.421, Test loss: 0.886, Test accuracy: 71.39
Round  58, Global train loss: 0.421, Global test loss: 1.287, Global test accuracy: 58.89
Round  59, Train loss: 0.482, Test loss: 0.897, Test accuracy: 71.47
Round  59, Global train loss: 0.482, Global test loss: 1.339, Global test accuracy: 57.02
Round  60, Train loss: 0.469, Test loss: 0.912, Test accuracy: 70.83
Round  60, Global train loss: 0.469, Global test loss: 1.192, Global test accuracy: 59.67
Round  61, Train loss: 0.413, Test loss: 0.883, Test accuracy: 71.71
Round  61, Global train loss: 0.413, Global test loss: 1.249, Global test accuracy: 60.06
Round  62, Train loss: 0.475, Test loss: 0.888, Test accuracy: 71.63
Round  62, Global train loss: 0.475, Global test loss: 1.470, Global test accuracy: 55.70
Round  63, Train loss: 0.444, Test loss: 0.874, Test accuracy: 72.03
Round  63, Global train loss: 0.444, Global test loss: 1.127, Global test accuracy: 61.23
Round  64, Train loss: 0.419, Test loss: 0.881, Test accuracy: 72.32
Round  64, Global train loss: 0.419, Global test loss: 1.565, Global test accuracy: 53.73
Round  65, Train loss: 0.417, Test loss: 0.874, Test accuracy: 72.73
Round  65, Global train loss: 0.417, Global test loss: 1.248, Global test accuracy: 59.53
Round  66, Train loss: 0.418, Test loss: 0.878, Test accuracy: 72.71
Round  66, Global train loss: 0.418, Global test loss: 1.417, Global test accuracy: 58.02
Round  67, Train loss: 0.436, Test loss: 0.893, Test accuracy: 72.52
Round  67, Global train loss: 0.436, Global test loss: 1.238, Global test accuracy: 60.00
Round  68, Train loss: 0.411, Test loss: 0.897, Test accuracy: 72.93
Round  68, Global train loss: 0.411, Global test loss: 1.211, Global test accuracy: 60.77
Round  69, Train loss: 0.393, Test loss: 0.892, Test accuracy: 73.44
Round  69, Global train loss: 0.393, Global test loss: 1.204, Global test accuracy: 61.49
Round  70, Train loss: 0.395, Test loss: 0.890, Test accuracy: 73.27
Round  70, Global train loss: 0.395, Global test loss: 1.324, Global test accuracy: 58.36
Round  71, Train loss: 0.362, Test loss: 0.905, Test accuracy: 72.74
Round  71, Global train loss: 0.362, Global test loss: 1.339, Global test accuracy: 59.50
Round  72, Train loss: 0.440, Test loss: 0.893, Test accuracy: 72.68
Round  72, Global train loss: 0.440, Global test loss: 1.360, Global test accuracy: 57.54
Round  73, Train loss: 0.373, Test loss: 0.913, Test accuracy: 72.72
Round  73, Global train loss: 0.373, Global test loss: 1.695, Global test accuracy: 54.42
Round  74, Train loss: 0.393, Test loss: 0.888, Test accuracy: 73.05
Round  74, Global train loss: 0.393, Global test loss: 1.249, Global test accuracy: 61.92
Round  75, Train loss: 0.354, Test loss: 0.875, Test accuracy: 73.35
Round  75, Global train loss: 0.354, Global test loss: 1.443, Global test accuracy: 58.13
Round  76, Train loss: 0.362, Test loss: 0.885, Test accuracy: 73.12
Round  76, Global train loss: 0.362, Global test loss: 1.496, Global test accuracy: 58.27
Round  77, Train loss: 0.387, Test loss: 0.888, Test accuracy: 73.09
Round  77, Global train loss: 0.387, Global test loss: 1.388, Global test accuracy: 58.93
Round  78, Train loss: 0.365, Test loss: 0.896, Test accuracy: 73.04
Round  78, Global train loss: 0.365, Global test loss: 1.464, Global test accuracy: 57.05
Round  79, Train loss: 0.394, Test loss: 0.905, Test accuracy: 72.51
Round  79, Global train loss: 0.394, Global test loss: 1.200, Global test accuracy: 61.51
Round  80, Train loss: 0.355, Test loss: 0.907, Test accuracy: 72.69
Round  80, Global train loss: 0.355, Global test loss: 1.429, Global test accuracy: 57.60
Round  81, Train loss: 0.316, Test loss: 0.913, Test accuracy: 72.51
Round  81, Global train loss: 0.316, Global test loss: 1.345, Global test accuracy: 60.28
Round  82, Train loss: 0.339, Test loss: 0.918, Test accuracy: 72.41
Round  82, Global train loss: 0.339, Global test loss: 1.508, Global test accuracy: 56.26
Round  83, Train loss: 0.327, Test loss: 0.909, Test accuracy: 72.83
Round  83, Global train loss: 0.327, Global test loss: 1.310, Global test accuracy: 61.05
Round  84, Train loss: 0.356, Test loss: 0.900, Test accuracy: 72.81
Round  84, Global train loss: 0.356, Global test loss: 1.200, Global test accuracy: 61.97
Round  85, Train loss: 0.340, Test loss: 0.926, Test accuracy: 72.52
Round  85, Global train loss: 0.340, Global test loss: 1.419, Global test accuracy: 58.13
Round  86, Train loss: 0.333, Test loss: 0.920, Test accuracy: 73.02
Round  86, Global train loss: 0.333, Global test loss: 1.226, Global test accuracy: 61.61
Round  87, Train loss: 0.336, Test loss: 0.920, Test accuracy: 73.31
Round  87, Global train loss: 0.336, Global test loss: 1.411, Global test accuracy: 59.56
Round  88, Train loss: 0.343, Test loss: 0.942, Test accuracy: 72.97
Round  88, Global train loss: 0.343, Global test loss: 1.320, Global test accuracy: 60.82
Round  89, Train loss: 0.320, Test loss: 0.950, Test accuracy: 73.48
Round  89, Global train loss: 0.320, Global test loss: 1.500, Global test accuracy: 58.43
Round  90, Train loss: 0.313, Test loss: 0.947, Test accuracy: 73.09
Round  90, Global train loss: 0.313, Global test loss: 1.660, Global test accuracy: 56.12
Round  91, Train loss: 0.287, Test loss: 0.953, Test accuracy: 73.32
Round  91, Global train loss: 0.287, Global test loss: 1.710, Global test accuracy: 56.31
Round  92, Train loss: 0.275, Test loss: 0.959, Test accuracy: 73.36
Round  92, Global train loss: 0.275, Global test loss: 1.585, Global test accuracy: 57.10
Round  93, Train loss: 0.318, Test loss: 0.953, Test accuracy: 73.17
Round  93, Global train loss: 0.318, Global test loss: 1.383, Global test accuracy: 60.00
Round  94, Train loss: 0.348, Test loss: 0.947, Test accuracy: 73.32
Round  94, Global train loss: 0.348, Global test loss: 1.247, Global test accuracy: 61.95
Round  95, Train loss: 0.347, Test loss: 0.934, Test accuracy: 73.50
Round  95, Global train loss: 0.347, Global test loss: 1.360, Global test accuracy: 60.16
Round  96, Train loss: 0.319, Test loss: 0.934, Test accuracy: 73.38
Round  96, Global train loss: 0.319, Global test loss: 1.439, Global test accuracy: 59.10
Round  97, Train loss: 0.312, Test loss: 0.942, Test accuracy: 73.28
Round  97, Global train loss: 0.312, Global test loss: 1.570, Global test accuracy: 56.80
Round  98, Train loss: 0.360, Test loss: 0.950, Test accuracy: 73.41
Round  98, Global train loss: 0.360, Global test loss: 1.466, Global test accuracy: 58.37
Round  99, Train loss: 0.298, Test loss: 0.941, Test accuracy: 73.88
Round  99, Global train loss: 0.298, Global test loss: 1.168, Global test accuracy: 64.43
Final Round, Train loss: 0.241, Test loss: 1.071, Test accuracy: 73.36
Final Round, Global train loss: 0.241, Global test loss: 1.168, Global test accuracy: 64.43
Average accuracy final 10 rounds: 73.37100000000001
Average global accuracy final 10 rounds: 59.03399999999999
2065.6614558696747
[2.7769949436187744, 5.326980113983154, 7.880780220031738, 10.5156991481781, 13.061900854110718, 15.615802764892578, 18.23873472213745, 20.763219833374023, 23.3554208278656, 25.87972116470337, 28.432496547698975, 31.040711402893066, 33.590710401535034, 36.201186418533325, 38.78127193450928, 41.345272064208984, 43.97658181190491, 46.53195858001709, 49.079848766326904, 51.70498728752136, 54.24206852912903, 56.82487416267395, 59.34997248649597, 61.964898347854614, 64.49723529815674, 67.11374473571777, 69.67354345321655, 72.21973323822021, 74.8226957321167, 77.36736273765564, 80.00966429710388, 82.56488823890686, 85.19993352890015, 87.72849202156067, 90.34503388404846, 92.87402963638306, 95.49773120880127, 98.03087329864502, 100.66626143455505, 103.20789122581482, 105.84584975242615, 108.41031384468079, 110.96375608444214, 113.5392096042633, 116.09702038764954, 118.74669432640076, 121.29865789413452, 123.86356019973755, 126.46166634559631, 129.01939368247986, 131.66364216804504, 134.22127103805542, 136.77971029281616, 139.4159836769104, 141.9629466533661, 144.51980686187744, 147.09699368476868, 149.6502344608307, 152.29528713226318, 154.85301852226257, 157.41818737983704, 160.0592646598816, 162.6034758090973, 165.19132232666016, 167.764306306839, 170.32178592681885, 172.9542579650879, 175.50490975379944, 178.07037925720215, 180.712899684906, 183.26263737678528, 185.8460874557495, 188.44588971138, 191.00297713279724, 193.63049006462097, 196.18863248825073, 198.70385122299194, 201.23490738868713, 203.741797208786, 206.26872277259827, 208.77841782569885, 211.28701043128967, 213.7909438610077, 216.31141257286072, 218.8326735496521, 221.3527569770813, 223.89485025405884, 226.41103959083557, 228.92199039459229, 231.43545365333557, 233.93601608276367, 236.47125244140625, 238.9749619960785, 241.51734685897827, 244.08233833312988, 246.64288711547852, 249.20426225662231, 251.7725145816803, 254.335120677948, 256.8995416164398, 261.4738233089447]
[27.79, 36.53, 38.43, 44.22, 47.54, 52.11, 52.89, 54.49, 55.78, 56.58, 57.42, 58.9, 59.01, 59.63, 60.64, 62.85, 63.54, 63.56, 64.26, 64.7, 65.25, 65.25, 65.29, 65.69, 66.25, 66.15, 66.52, 66.8, 66.24, 66.58, 67.56, 67.64, 67.94, 68.48, 69.12, 68.98, 69.03, 69.27, 69.77, 70.32, 69.96, 70.1, 70.08, 70.44, 70.33, 70.53, 70.55, 70.72, 70.38, 70.16, 70.86, 71.47, 70.78, 70.77, 70.97, 71.68, 71.57, 71.93, 71.39, 71.47, 70.83, 71.71, 71.63, 72.03, 72.32, 72.73, 72.71, 72.52, 72.93, 73.44, 73.27, 72.74, 72.68, 72.72, 73.05, 73.35, 73.12, 73.09, 73.04, 72.51, 72.69, 72.51, 72.41, 72.83, 72.81, 72.52, 73.02, 73.31, 72.97, 73.48, 73.09, 73.32, 73.36, 73.17, 73.32, 73.5, 73.38, 73.28, 73.41, 73.88, 73.36]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  14.9400
Round 1 global test acc  16.6200
Round 2 global test acc  20.6300
Round 3 global test acc  25.7900
Round 4 global test acc  27.9500
Round 5 global test acc  27.1600
Round 6 global test acc  31.1000
Round 7 global test acc  34.2400
Round 8 global test acc  31.5500
Round 9 global test acc  29.2400
Round 10 global test acc  33.6400
Round 11 global test acc  30.6200
Round 12 global test acc  30.1100
Round 13 global test acc  29.8700
Round 14 global test acc  37.7800
Round 15 global test acc  29.7400
Round 16 global test acc  32.9600
Round 17 global test acc  33.7100
Round 18 global test acc  31.5100
Round 19 global test acc  32.7300
Round 20 global test acc  34.6100
Round 21 global test acc  35.6300
Round 22 global test acc  32.2900
Round 23 global test acc  37.6400
Round 24 global test acc  40.6300
Round 25 global test acc  33.4800
Round 26 global test acc  33.7000
Round 27 global test acc  34.6200
Round 28 global test acc  33.5000
Round 29 global test acc  36.6200
Round 30 global test acc  36.6300
Round 31 global test acc  43.9500
Round 32 global test acc  36.3400
Round 33 global test acc  37.3400
Round 34 global test acc  37.3400
Round 35 global test acc  38.0500
Round 36 global test acc  42.8300
Round 37 global test acc  38.3900
Round 38 global test acc  35.0600
Round 39 global test acc  41.1300
Round 40 global test acc  42.7900
Round 41 global test acc  37.9900
Round 42 global test acc  33.8600
Round 43 global test acc  44.3500
Round 44 global test acc  35.2800
Round 45 global test acc  40.8300
Round 46 global test acc  39.5700
Round 47 global test acc  37.5800
Round 48 global test acc  37.8100
Round 49 global test acc  41.4900
Round 50 global test acc  39.7900
Round 51 global test acc  40.4000
Round 52 global test acc  38.8800
Round 53 global test acc  35.3500
Round 54 global test acc  40.8100
Round 55 global test acc  34.1600
Round 56 global test acc  35.1900
Round 57 global test acc  38.7500
Round 58 global test acc  41.3800
Round 59 global test acc  42.2800
Round 60 global test acc  38.8400
Round 61 global test acc  42.0600
Round 62 global test acc  40.5400
Round 63 global test acc  42.9900
Round 64 global test acc  39.7900
Round 65 global test acc  37.8400
Round 66 global test acc  41.3300
Round 67 global test acc  41.7600
Round 68 global test acc  41.2300
Round 69 global test acc  42.8400
Round 70 global test acc  38.6000
Round 71 global test acc  44.5700
Round 72 global test acc  44.6700
Round 73 global test acc  49.1100
Round 74 global test acc  45.9200
Round 75 global test acc  41.1200
Round 76 global test acc  44.1900
Round 77 global test acc  40.3200
Round 78 global test acc  45.6300
Round 79 global test acc  44.2900
Round 80 global test acc  38.4900
Round 81 global test acc  33.0100
Round 82 global test acc  31.3400
Round 83 global test acc  29.4500
Round 84 global test acc  29.8100
Round 85 global test acc  28.9100
Round 86 global test acc  28.6000
Round 87 global test acc  28.1300
Round 88 global test acc  27.6600
Round 89 global test acc  28.2100
Round 90 global test acc  26.9200
Round 91 global test acc  26.9700
Round 92 global test acc  27.3900
Round 93 global test acc  27.1800
Round 94 global test acc  26.6900
Round 95 global test acc  26.3000
Round 96 global test acc  25.6300
Round 97 global test acc  25.1500
Round 98 global test acc  25.0300
Round 99 global test acc  25.0200
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.944, Test loss: 2.072, Test accuracy: 28.48
Round   1, Train loss: 1.522, Test loss: 1.867, Test accuracy: 34.24
Round   2, Train loss: 1.412, Test loss: 1.660, Test accuracy: 37.96
Round   3, Train loss: 1.306, Test loss: 1.574, Test accuracy: 42.62
Round   4, Train loss: 1.234, Test loss: 1.436, Test accuracy: 46.45
Round   5, Train loss: 1.193, Test loss: 1.288, Test accuracy: 49.79
Round   6, Train loss: 1.102, Test loss: 1.192, Test accuracy: 53.69
Round   7, Train loss: 1.097, Test loss: 1.104, Test accuracy: 56.40
Round   8, Train loss: 1.053, Test loss: 0.987, Test accuracy: 59.85
Round   9, Train loss: 1.019, Test loss: 0.969, Test accuracy: 60.32
Round  10, Train loss: 1.034, Test loss: 0.940, Test accuracy: 61.66
Round  11, Train loss: 0.946, Test loss: 0.920, Test accuracy: 62.86
Round  12, Train loss: 0.982, Test loss: 0.907, Test accuracy: 63.56
Round  13, Train loss: 0.943, Test loss: 0.902, Test accuracy: 64.08
Round  14, Train loss: 0.962, Test loss: 0.897, Test accuracy: 64.28
Round  15, Train loss: 0.920, Test loss: 0.870, Test accuracy: 65.48
Round  16, Train loss: 0.865, Test loss: 0.850, Test accuracy: 66.29
Round  17, Train loss: 0.870, Test loss: 0.835, Test accuracy: 66.94
Round  18, Train loss: 0.860, Test loss: 0.837, Test accuracy: 67.06
Round  19, Train loss: 0.887, Test loss: 0.823, Test accuracy: 66.92
Round  20, Train loss: 0.852, Test loss: 0.822, Test accuracy: 67.36
Round  21, Train loss: 0.823, Test loss: 0.811, Test accuracy: 68.56
Round  22, Train loss: 0.862, Test loss: 0.785, Test accuracy: 69.23
Round  23, Train loss: 0.797, Test loss: 0.781, Test accuracy: 68.92
Round  24, Train loss: 0.749, Test loss: 0.774, Test accuracy: 69.57
Round  25, Train loss: 0.789, Test loss: 0.765, Test accuracy: 69.64
Round  26, Train loss: 0.806, Test loss: 0.762, Test accuracy: 69.68
Round  27, Train loss: 0.728, Test loss: 0.758, Test accuracy: 69.95
Round  28, Train loss: 0.817, Test loss: 0.760, Test accuracy: 69.81
Round  29, Train loss: 0.733, Test loss: 0.746, Test accuracy: 70.51
Round  30, Train loss: 0.775, Test loss: 0.743, Test accuracy: 71.40
Round  31, Train loss: 0.723, Test loss: 0.736, Test accuracy: 71.36
Round  32, Train loss: 0.698, Test loss: 0.720, Test accuracy: 72.53
Round  33, Train loss: 0.701, Test loss: 0.722, Test accuracy: 72.23
Round  34, Train loss: 0.704, Test loss: 0.714, Test accuracy: 72.87
Round  35, Train loss: 0.638, Test loss: 0.699, Test accuracy: 73.80
Round  36, Train loss: 0.688, Test loss: 0.707, Test accuracy: 72.92
Round  37, Train loss: 0.725, Test loss: 0.713, Test accuracy: 72.60
Round  38, Train loss: 0.739, Test loss: 0.706, Test accuracy: 72.91
Round  39, Train loss: 0.691, Test loss: 0.699, Test accuracy: 73.05
Round  40, Train loss: 0.650, Test loss: 0.683, Test accuracy: 73.40
Round  41, Train loss: 0.694, Test loss: 0.679, Test accuracy: 74.00
Round  42, Train loss: 0.649, Test loss: 0.683, Test accuracy: 73.76
Round  43, Train loss: 0.602, Test loss: 0.671, Test accuracy: 74.45
Round  44, Train loss: 0.695, Test loss: 0.670, Test accuracy: 74.39
Round  45, Train loss: 0.607, Test loss: 0.662, Test accuracy: 74.52
Round  46, Train loss: 0.650, Test loss: 0.661, Test accuracy: 74.68
Round  47, Train loss: 0.633, Test loss: 0.651, Test accuracy: 75.42
Round  48, Train loss: 0.592, Test loss: 0.665, Test accuracy: 74.93
Round  49, Train loss: 0.601, Test loss: 0.659, Test accuracy: 74.72
Round  50, Train loss: 0.559, Test loss: 0.649, Test accuracy: 75.03
Round  51, Train loss: 0.560, Test loss: 0.648, Test accuracy: 75.24
Round  52, Train loss: 0.600, Test loss: 0.642, Test accuracy: 75.40
Round  53, Train loss: 0.589, Test loss: 0.634, Test accuracy: 76.21
Round  54, Train loss: 0.626, Test loss: 0.634, Test accuracy: 76.27
Round  55, Train loss: 0.566, Test loss: 0.627, Test accuracy: 76.66
Round  56, Train loss: 0.602, Test loss: 0.639, Test accuracy: 75.97
Round  57, Train loss: 0.562, Test loss: 0.632, Test accuracy: 76.07
Round  58, Train loss: 0.541, Test loss: 0.632, Test accuracy: 76.02
Round  59, Train loss: 0.563, Test loss: 0.641, Test accuracy: 75.46
Round  60, Train loss: 0.509, Test loss: 0.634, Test accuracy: 75.85
Round  61, Train loss: 0.540, Test loss: 0.628, Test accuracy: 76.61
Round  62, Train loss: 0.564, Test loss: 0.625, Test accuracy: 76.69
Round  63, Train loss: 0.554, Test loss: 0.620, Test accuracy: 76.81
Round  64, Train loss: 0.506, Test loss: 0.623, Test accuracy: 76.56
Round  65, Train loss: 0.487, Test loss: 0.615, Test accuracy: 76.81
Round  66, Train loss: 0.492, Test loss: 0.617, Test accuracy: 76.94
Round  67, Train loss: 0.538, Test loss: 0.611, Test accuracy: 77.01
Round  68, Train loss: 0.470, Test loss: 0.608, Test accuracy: 77.11
Round  69, Train loss: 0.489, Test loss: 0.625, Test accuracy: 76.32
Round  70, Train loss: 0.455, Test loss: 0.612, Test accuracy: 77.02
Round  71, Train loss: 0.463, Test loss: 0.617, Test accuracy: 76.77
Round  72, Train loss: 0.483, Test loss: 0.613, Test accuracy: 77.01
Round  73, Train loss: 0.481, Test loss: 0.621, Test accuracy: 76.92
Round  74, Train loss: 0.484, Test loss: 0.614, Test accuracy: 76.94
Round  75, Train loss: 0.456, Test loss: 0.604, Test accuracy: 77.26
Round  76, Train loss: 0.481, Test loss: 0.610, Test accuracy: 77.00
Round  77, Train loss: 0.483, Test loss: 0.607, Test accuracy: 77.21
Round  78, Train loss: 0.483, Test loss: 0.600, Test accuracy: 77.95
Round  79, Train loss: 0.424, Test loss: 0.606, Test accuracy: 77.46
Round  80, Train loss: 0.496, Test loss: 0.606, Test accuracy: 77.30
Round  81, Train loss: 0.452, Test loss: 0.604, Test accuracy: 77.76
Round  82, Train loss: 0.390, Test loss: 0.603, Test accuracy: 77.93
Round  83, Train loss: 0.441, Test loss: 0.608, Test accuracy: 77.52
Round  84, Train loss: 0.448, Test loss: 0.604, Test accuracy: 77.60
Round  85, Train loss: 0.441, Test loss: 0.595, Test accuracy: 77.77
Round  86, Train loss: 0.391, Test loss: 0.595, Test accuracy: 77.90
Round  87, Train loss: 0.429, Test loss: 0.598, Test accuracy: 77.71
Round  88, Train loss: 0.422, Test loss: 0.602, Test accuracy: 77.77
Round  89, Train loss: 0.443, Test loss: 0.603, Test accuracy: 77.71
Round  90, Train loss: 0.409, Test loss: 0.604, Test accuracy: 77.67
Round  91, Train loss: 0.420, Test loss: 0.597, Test accuracy: 77.76
Round  92, Train loss: 0.379, Test loss: 0.598, Test accuracy: 77.95
Round  93, Train loss: 0.420, Test loss: 0.595, Test accuracy: 77.82
Round  94, Train loss: 0.384, Test loss: 0.609, Test accuracy: 77.64
Round  95, Train loss: 0.370, Test loss: 0.593, Test accuracy: 77.96
Round  96, Train loss: 0.375, Test loss: 0.598, Test accuracy: 77.92
Round  97, Train loss: 0.366, Test loss: 0.590, Test accuracy: 78.11
Round  98, Train loss: 0.361, Test loss: 0.588, Test accuracy: 78.60
Round  99, Train loss: 0.413, Test loss: 0.596, Test accuracy: 78.03
Final Round, Train loss: 0.338, Test loss: 0.594, Test accuracy: 78.40
Average accuracy final 10 rounds: 77.946
1023.146576166153
[1.6097006797790527, 2.9039196968078613, 4.2606987953186035, 5.557528495788574, 6.854650020599365, 8.146257638931274, 9.450440645217896, 10.75892972946167, 12.06992483139038, 13.375275373458862, 14.67961049079895, 15.983139753341675, 17.287519931793213, 18.59104013442993, 19.880964517593384, 21.172646284103394, 22.464673042297363, 23.756684064865112, 25.049927711486816, 26.339587688446045, 27.632394313812256, 28.923931121826172, 30.214696168899536, 31.504651069641113, 32.79803776741028, 34.08600211143494, 35.376954793930054, 36.66978120803833, 37.9752562046051, 39.28273677825928, 40.58915400505066, 41.893306016922, 43.19649791717529, 44.497552156448364, 45.80213475227356, 47.101218700408936, 48.40413236618042, 49.70528435707092, 51.00754904747009, 52.31015658378601, 53.61373972892761, 54.9193971157074, 56.221001863479614, 57.52585530281067, 58.828723192214966, 60.13449048995972, 61.43910074234009, 62.740105390548706, 64.03957056999207, 65.34069490432739, 66.6438958644867, 67.94581699371338, 69.24801635742188, 70.55000567436218, 71.85244703292847, 73.158132314682, 74.45818829536438, 75.76144647598267, 77.06389570236206, 78.36312413215637, 79.66369771957397, 80.96811008453369, 82.27220106124878, 83.57154202461243, 84.874027967453, 86.16996717453003, 87.32804298400879, 88.47782468795776, 89.62881803512573, 90.79130697250366, 91.95328092575073, 93.11214709281921, 94.26716208457947, 95.42545342445374, 96.58383107185364, 97.7450225353241, 98.90612363815308, 100.06934976577759, 101.23310494422913, 102.3943419456482, 103.55691885948181, 104.72306895256042, 105.89101338386536, 107.05231046676636, 108.21573615074158, 109.38011312484741, 110.54386806488037, 111.69726490974426, 112.8517017364502, 114.00939106941223, 115.17194199562073, 116.32911396026611, 117.48170948028564, 118.63845467567444, 119.93509268760681, 121.23118352890015, 122.53387331962585, 123.83205580711365, 125.13410902023315, 126.4320936203003, 128.52753162384033]
[28.48, 34.24, 37.96, 42.62, 46.45, 49.79, 53.69, 56.4, 59.85, 60.32, 61.66, 62.86, 63.56, 64.08, 64.28, 65.48, 66.29, 66.94, 67.06, 66.92, 67.36, 68.56, 69.23, 68.92, 69.57, 69.64, 69.68, 69.95, 69.81, 70.51, 71.4, 71.36, 72.53, 72.23, 72.87, 73.8, 72.92, 72.6, 72.91, 73.05, 73.4, 74.0, 73.76, 74.45, 74.39, 74.52, 74.68, 75.42, 74.93, 74.72, 75.03, 75.24, 75.4, 76.21, 76.27, 76.66, 75.97, 76.07, 76.02, 75.46, 75.85, 76.61, 76.69, 76.81, 76.56, 76.81, 76.94, 77.01, 77.11, 76.32, 77.02, 76.77, 77.01, 76.92, 76.94, 77.26, 77.0, 77.21, 77.95, 77.46, 77.3, 77.76, 77.93, 77.52, 77.6, 77.77, 77.9, 77.71, 77.77, 77.71, 77.67, 77.76, 77.95, 77.82, 77.64, 77.96, 77.92, 78.11, 78.6, 78.03, 78.4]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.669, Test loss: 1.980, Test accuracy: 29.17
Round   1, Train loss: 1.292, Test loss: 1.657, Test accuracy: 38.17
Round   2, Train loss: 1.195, Test loss: 1.506, Test accuracy: 43.22
Round   3, Train loss: 1.027, Test loss: 1.310, Test accuracy: 49.88
Round   4, Train loss: 1.016, Test loss: 1.101, Test accuracy: 55.52
Round   5, Train loss: 0.957, Test loss: 1.034, Test accuracy: 57.77
Round   6, Train loss: 0.922, Test loss: 1.013, Test accuracy: 59.02
Round   7, Train loss: 0.875, Test loss: 1.005, Test accuracy: 60.03
Round   8, Train loss: 0.828, Test loss: 0.959, Test accuracy: 62.10
Round   9, Train loss: 0.861, Test loss: 0.972, Test accuracy: 63.24
Round  10, Train loss: 0.785, Test loss: 0.902, Test accuracy: 64.77
Round  11, Train loss: 0.750, Test loss: 0.903, Test accuracy: 64.83
Round  12, Train loss: 0.774, Test loss: 0.814, Test accuracy: 67.28
Round  13, Train loss: 0.707, Test loss: 0.815, Test accuracy: 67.31
Round  14, Train loss: 0.687, Test loss: 0.789, Test accuracy: 68.74
Round  15, Train loss: 0.686, Test loss: 0.783, Test accuracy: 68.60
Round  16, Train loss: 0.657, Test loss: 0.779, Test accuracy: 68.36
Round  17, Train loss: 0.572, Test loss: 0.775, Test accuracy: 68.73
Round  18, Train loss: 0.634, Test loss: 0.745, Test accuracy: 70.68
Round  19, Train loss: 0.555, Test loss: 0.760, Test accuracy: 70.09
Round  20, Train loss: 0.626, Test loss: 0.753, Test accuracy: 70.62
Round  21, Train loss: 0.551, Test loss: 0.738, Test accuracy: 71.09
Round  22, Train loss: 0.601, Test loss: 0.727, Test accuracy: 72.03
Round  23, Train loss: 0.563, Test loss: 0.715, Test accuracy: 72.43
Round  24, Train loss: 0.573, Test loss: 0.719, Test accuracy: 72.24
Round  25, Train loss: 0.456, Test loss: 0.707, Test accuracy: 72.68
Round  26, Train loss: 0.598, Test loss: 0.692, Test accuracy: 73.43
Round  27, Train loss: 0.464, Test loss: 0.701, Test accuracy: 73.09
Round  28, Train loss: 0.471, Test loss: 0.701, Test accuracy: 73.54
Round  29, Train loss: 0.510, Test loss: 0.696, Test accuracy: 73.91
Round  30, Train loss: 0.484, Test loss: 0.699, Test accuracy: 73.98
Round  31, Train loss: 0.428, Test loss: 0.693, Test accuracy: 73.82
Round  32, Train loss: 0.485, Test loss: 0.696, Test accuracy: 74.05
Round  33, Train loss: 0.465, Test loss: 0.689, Test accuracy: 73.87
Round  34, Train loss: 0.483, Test loss: 0.677, Test accuracy: 74.80
Round  35, Train loss: 0.431, Test loss: 0.684, Test accuracy: 74.53
Round  36, Train loss: 0.421, Test loss: 0.677, Test accuracy: 74.55
Round  37, Train loss: 0.409, Test loss: 0.672, Test accuracy: 75.31
Round  38, Train loss: 0.423, Test loss: 0.659, Test accuracy: 75.40
Round  39, Train loss: 0.464, Test loss: 0.676, Test accuracy: 74.70
Round  40, Train loss: 0.411, Test loss: 0.670, Test accuracy: 75.33
Round  41, Train loss: 0.376, Test loss: 0.680, Test accuracy: 74.96
Round  42, Train loss: 0.395, Test loss: 0.650, Test accuracy: 75.83
Round  43, Train loss: 0.356, Test loss: 0.655, Test accuracy: 75.89
Round  44, Train loss: 0.350, Test loss: 0.653, Test accuracy: 75.89
Round  45, Train loss: 0.414, Test loss: 0.669, Test accuracy: 75.60
Round  46, Train loss: 0.336, Test loss: 0.662, Test accuracy: 75.97
Round  47, Train loss: 0.385, Test loss: 0.675, Test accuracy: 75.64
Round  48, Train loss: 0.355, Test loss: 0.667, Test accuracy: 75.60
Round  49, Train loss: 0.356, Test loss: 0.668, Test accuracy: 75.64
Round  50, Train loss: 0.367, Test loss: 0.672, Test accuracy: 75.82
Round  51, Train loss: 0.354, Test loss: 0.662, Test accuracy: 76.46
Round  52, Train loss: 0.312, Test loss: 0.662, Test accuracy: 76.38
Round  53, Train loss: 0.278, Test loss: 0.655, Test accuracy: 76.78
Round  54, Train loss: 0.330, Test loss: 0.648, Test accuracy: 76.51
Round  55, Train loss: 0.325, Test loss: 0.650, Test accuracy: 77.27
Round  56, Train loss: 0.317, Test loss: 0.659, Test accuracy: 76.51
Round  57, Train loss: 0.323, Test loss: 0.661, Test accuracy: 76.66
Round  58, Train loss: 0.265, Test loss: 0.647, Test accuracy: 77.17
Round  59, Train loss: 0.362, Test loss: 0.662, Test accuracy: 76.79
Round  60, Train loss: 0.292, Test loss: 0.676, Test accuracy: 76.46
Round  61, Train loss: 0.317, Test loss: 0.665, Test accuracy: 76.35
Round  62, Train loss: 0.300, Test loss: 0.657, Test accuracy: 76.35
Round  63, Train loss: 0.303, Test loss: 0.664, Test accuracy: 76.82
Round  64, Train loss: 0.278, Test loss: 0.644, Test accuracy: 77.42
Round  65, Train loss: 0.282, Test loss: 0.653, Test accuracy: 77.22
Round  66, Train loss: 0.289, Test loss: 0.656, Test accuracy: 77.06
Round  67, Train loss: 0.265, Test loss: 0.647, Test accuracy: 77.31
Round  68, Train loss: 0.256, Test loss: 0.658, Test accuracy: 77.13
Round  69, Train loss: 0.278, Test loss: 0.666, Test accuracy: 77.09
Round  70, Train loss: 0.287, Test loss: 0.673, Test accuracy: 76.90
Round  71, Train loss: 0.272, Test loss: 0.662, Test accuracy: 77.03
Round  72, Train loss: 0.250, Test loss: 0.651, Test accuracy: 77.50
Round  73, Train loss: 0.242, Test loss: 0.660, Test accuracy: 77.18
Round  74, Train loss: 0.245, Test loss: 0.658, Test accuracy: 77.54
Round  75, Train loss: 0.279, Test loss: 0.651, Test accuracy: 77.19
Round  76, Train loss: 0.282, Test loss: 0.658, Test accuracy: 77.58
Round  77, Train loss: 0.226, Test loss: 0.650, Test accuracy: 77.65
Round  78, Train loss: 0.232, Test loss: 0.657, Test accuracy: 77.66
Round  79, Train loss: 0.233, Test loss: 0.691, Test accuracy: 77.15
Round  80, Train loss: 0.225, Test loss: 0.679, Test accuracy: 77.29
Round  81, Train loss: 0.237, Test loss: 0.664, Test accuracy: 77.39
Round  82, Train loss: 0.217, Test loss: 0.673, Test accuracy: 77.37
Round  83, Train loss: 0.211, Test loss: 0.674, Test accuracy: 77.30
Round  84, Train loss: 0.191, Test loss: 0.672, Test accuracy: 77.33
Round  85, Train loss: 0.184, Test loss: 0.679, Test accuracy: 77.26
Round  86, Train loss: 0.210, Test loss: 0.680, Test accuracy: 77.53
Round  87, Train loss: 0.206, Test loss: 0.680, Test accuracy: 77.66
Round  88, Train loss: 0.225, Test loss: 0.658, Test accuracy: 78.19
Round  89, Train loss: 0.224, Test loss: 0.662, Test accuracy: 77.81
Round  90, Train loss: 0.242, Test loss: 0.672, Test accuracy: 78.22
Round  91, Train loss: 0.229, Test loss: 0.698, Test accuracy: 77.33
Round  92, Train loss: 0.194, Test loss: 0.707, Test accuracy: 76.82
Round  93, Train loss: 0.194, Test loss: 0.687, Test accuracy: 77.55
Round  94, Train loss: 0.186, Test loss: 0.717, Test accuracy: 77.32
Round  95, Train loss: 0.181, Test loss: 0.694, Test accuracy: 77.49
Round  96, Train loss: 0.184, Test loss: 0.691, Test accuracy: 77.96
Round  97, Train loss: 0.192, Test loss: 0.703, Test accuracy: 77.63
Round  98, Train loss: 0.230, Test loss: 0.677, Test accuracy: 77.75
Round  99, Train loss: 0.199, Test loss: 0.683, Test accuracy: 77.96
Final Round, Train loss: 0.188, Test loss: 0.677, Test accuracy: 78.08
Average accuracy final 10 rounds: 77.60300000000001
2619.1024742126465
[2.88720965385437, 5.4686689376831055, 8.077620029449463, 10.68129849433899, 13.288961172103882, 15.891801118850708, 18.493353128433228, 21.10718035697937, 23.715511798858643, 26.31595778465271, 28.920283555984497, 31.51937699317932, 34.12484335899353, 36.723963260650635, 39.31367087364197, 41.91271710395813, 44.51262426376343, 47.109434366226196, 49.686782360076904, 52.260756731033325, 54.83473086357117, 59.39932465553284, 63.87051486968994, 68.41050100326538, 72.86984348297119, 77.41562604904175, 82.05262184143066, 86.63188028335571, 91.11616945266724, 95.68829846382141, 100.34623908996582, 104.88510060310364, 109.31768846511841, 113.82857704162598, 118.27428102493286, 122.80053210258484, 127.25038623809814, 131.78466057777405, 136.28274774551392, 140.70890164375305, 145.0108711719513, 149.35410523414612, 153.79124450683594, 158.0065279006958, 162.19253063201904, 166.334064245224, 170.5725507736206, 174.80071663856506, 179.19043278694153, 183.4125018119812, 187.62701106071472, 191.72651433944702, 195.9482398033142, 200.23020243644714, 204.4128246307373, 208.54339337348938, 212.9543435573578, 217.40081667900085, 221.83145880699158, 226.04033875465393, 230.21448349952698, 234.4008002281189, 238.60162544250488, 242.7613275051117, 246.879230260849, 251.16639757156372, 255.6007969379425, 259.7792019844055, 264.07838916778564, 268.25660848617554, 272.4455564022064, 276.6725194454193, 280.94037079811096, 285.067809343338, 289.37258315086365, 293.8078947067261, 298.1021716594696, 302.2152032852173, 306.3323872089386, 310.6020269393921, 314.72355246543884, 319.1431884765625, 323.3718070983887, 327.53138041496277, 331.6139717102051, 335.86347556114197, 340.1021680831909, 344.24794459342957, 348.1612591743469, 352.0928475856781, 356.11259293556213, 360.13189601898193, 364.13106966018677, 368.1428897380829, 372.1426377296448, 376.15745401382446, 380.1634428501129, 384.16729044914246, 388.22604966163635, 392.2498495578766, 395.9987826347351]
[29.17, 38.17, 43.22, 49.88, 55.52, 57.77, 59.02, 60.03, 62.1, 63.24, 64.77, 64.83, 67.28, 67.31, 68.74, 68.6, 68.36, 68.73, 70.68, 70.09, 70.62, 71.09, 72.03, 72.43, 72.24, 72.68, 73.43, 73.09, 73.54, 73.91, 73.98, 73.82, 74.05, 73.87, 74.8, 74.53, 74.55, 75.31, 75.4, 74.7, 75.33, 74.96, 75.83, 75.89, 75.89, 75.6, 75.97, 75.64, 75.6, 75.64, 75.82, 76.46, 76.38, 76.78, 76.51, 77.27, 76.51, 76.66, 77.17, 76.79, 76.46, 76.35, 76.35, 76.82, 77.42, 77.22, 77.06, 77.31, 77.13, 77.09, 76.9, 77.03, 77.5, 77.18, 77.54, 77.19, 77.58, 77.65, 77.66, 77.15, 77.29, 77.39, 77.37, 77.3, 77.33, 77.26, 77.53, 77.66, 78.19, 77.81, 78.22, 77.33, 76.82, 77.55, 77.32, 77.49, 77.96, 77.63, 77.75, 77.96, 78.08]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.698, Test loss: 1.626, Test accuracy: 36.49
Round   1, Train loss: 1.304, Test loss: 1.230, Test accuracy: 47.97
Round   2, Train loss: 1.135, Test loss: 1.101, Test accuracy: 54.82
Round   3, Train loss: 1.044, Test loss: 1.018, Test accuracy: 58.18
Round   4, Train loss: 0.984, Test loss: 0.971, Test accuracy: 60.19
Round   5, Train loss: 0.940, Test loss: 0.938, Test accuracy: 61.86
Round   6, Train loss: 0.897, Test loss: 0.892, Test accuracy: 64.07
Round   7, Train loss: 0.860, Test loss: 0.846, Test accuracy: 66.34
Round   8, Train loss: 0.827, Test loss: 0.839, Test accuracy: 66.51
Round   9, Train loss: 0.795, Test loss: 0.817, Test accuracy: 67.68
Round  10, Train loss: 0.770, Test loss: 0.797, Test accuracy: 68.16
Round  11, Train loss: 0.743, Test loss: 0.765, Test accuracy: 69.82
Round  12, Train loss: 0.714, Test loss: 0.753, Test accuracy: 70.23
Round  13, Train loss: 0.692, Test loss: 0.750, Test accuracy: 70.37
Round  14, Train loss: 0.673, Test loss: 0.744, Test accuracy: 70.63
Round  15, Train loss: 0.651, Test loss: 0.729, Test accuracy: 71.64
Round  16, Train loss: 0.630, Test loss: 0.712, Test accuracy: 72.24
Round  17, Train loss: 0.609, Test loss: 0.694, Test accuracy: 73.15
Round  18, Train loss: 0.594, Test loss: 0.701, Test accuracy: 72.95
Round  19, Train loss: 0.580, Test loss: 0.685, Test accuracy: 73.61
Round  20, Train loss: 0.544, Test loss: 0.690, Test accuracy: 73.22
Round  21, Train loss: 0.567, Test loss: 0.690, Test accuracy: 73.41
Round  22, Train loss: 0.554, Test loss: 0.692, Test accuracy: 73.72
Round  23, Train loss: 0.489, Test loss: 0.684, Test accuracy: 73.66
Round  24, Train loss: 0.486, Test loss: 0.691, Test accuracy: 73.59
Round  25, Train loss: 0.570, Test loss: 0.688, Test accuracy: 73.74
Round  26, Train loss: 0.521, Test loss: 0.689, Test accuracy: 74.02
Round  27, Train loss: 0.475, Test loss: 0.677, Test accuracy: 74.28
Round  28, Train loss: 0.480, Test loss: 0.671, Test accuracy: 74.86
Round  29, Train loss: 0.440, Test loss: 0.648, Test accuracy: 75.54
Round  30, Train loss: 0.439, Test loss: 0.652, Test accuracy: 75.38
Round  31, Train loss: 0.406, Test loss: 0.655, Test accuracy: 75.52
Round  32, Train loss: 0.454, Test loss: 0.671, Test accuracy: 74.78
Round  33, Train loss: 0.422, Test loss: 0.667, Test accuracy: 75.62
Round  34, Train loss: 0.452, Test loss: 0.675, Test accuracy: 75.27
Round  35, Train loss: 0.413, Test loss: 0.664, Test accuracy: 76.13
Round  36, Train loss: 0.359, Test loss: 0.664, Test accuracy: 75.97
Round  37, Train loss: 0.434, Test loss: 0.649, Test accuracy: 76.21
Round  38, Train loss: 0.368, Test loss: 0.662, Test accuracy: 75.96
Round  39, Train loss: 0.385, Test loss: 0.667, Test accuracy: 76.04
Round  40, Train loss: 0.420, Test loss: 0.666, Test accuracy: 75.83
Round  41, Train loss: 0.367, Test loss: 0.654, Test accuracy: 76.52
Round  42, Train loss: 0.400, Test loss: 0.661, Test accuracy: 76.21
Round  43, Train loss: 0.370, Test loss: 0.658, Test accuracy: 76.54
Round  44, Train loss: 0.371, Test loss: 0.652, Test accuracy: 76.97
Round  45, Train loss: 0.342, Test loss: 0.654, Test accuracy: 76.58
Round  46, Train loss: 0.353, Test loss: 0.652, Test accuracy: 76.93
Round  47, Train loss: 0.323, Test loss: 0.663, Test accuracy: 76.58
Round  48, Train loss: 0.264, Test loss: 0.660, Test accuracy: 76.58
Round  49, Train loss: 0.341, Test loss: 0.657, Test accuracy: 76.81
Round  50, Train loss: 0.302, Test loss: 0.664, Test accuracy: 76.60
Round  51, Train loss: 0.346, Test loss: 0.655, Test accuracy: 76.70
Round  52, Train loss: 0.320, Test loss: 0.678, Test accuracy: 76.29
Round  53, Train loss: 0.324, Test loss: 0.665, Test accuracy: 76.55
Round  54, Train loss: 0.300, Test loss: 0.654, Test accuracy: 76.85
Round  55, Train loss: 0.341, Test loss: 0.657, Test accuracy: 77.02
Round  56, Train loss: 0.287, Test loss: 0.676, Test accuracy: 76.52
Round  57, Train loss: 0.308, Test loss: 0.666, Test accuracy: 76.43
Round  58, Train loss: 0.262, Test loss: 0.670, Test accuracy: 76.55
Round  59, Train loss: 0.311, Test loss: 0.666, Test accuracy: 76.58
Round  60, Train loss: 0.316, Test loss: 0.664, Test accuracy: 76.83
Round  61, Train loss: 0.320, Test loss: 0.671, Test accuracy: 76.83
Round  62, Train loss: 0.313, Test loss: 0.666, Test accuracy: 76.72
Round  63, Train loss: 0.267, Test loss: 0.674, Test accuracy: 76.77
Round  64, Train loss: 0.291, Test loss: 0.673, Test accuracy: 77.10
Round  65, Train loss: 0.282, Test loss: 0.690, Test accuracy: 76.58
Round  66, Train loss: 0.237, Test loss: 0.680, Test accuracy: 77.03
Round  67, Train loss: 0.239, Test loss: 0.684, Test accuracy: 77.11
Round  68, Train loss: 0.258, Test loss: 0.678, Test accuracy: 76.81
Round  69, Train loss: 0.285, Test loss: 0.673, Test accuracy: 77.36
Round  70, Train loss: 0.242, Test loss: 0.678, Test accuracy: 77.31
Round  71, Train loss: 0.248, Test loss: 0.676, Test accuracy: 77.24
Round  72, Train loss: 0.249, Test loss: 0.690, Test accuracy: 77.11
Round  73, Train loss: 0.214, Test loss: 0.701, Test accuracy: 76.84
Round  74, Train loss: 0.195, Test loss: 0.690, Test accuracy: 77.04
Round  75, Train loss: 0.201, Test loss: 0.698, Test accuracy: 77.02
Round  76, Train loss: 0.189, Test loss: 0.703, Test accuracy: 76.72
Round  77, Train loss: 0.231, Test loss: 0.689, Test accuracy: 76.89
Round  78, Train loss: 0.199, Test loss: 0.701, Test accuracy: 76.72
Round  79, Train loss: 0.218, Test loss: 0.699, Test accuracy: 76.84
Round  80, Train loss: 0.236, Test loss: 0.684, Test accuracy: 77.34
Round  81, Train loss: 0.220, Test loss: 0.686, Test accuracy: 77.56
Round  82, Train loss: 0.220, Test loss: 0.680, Test accuracy: 77.88
Round  83, Train loss: 0.213, Test loss: 0.687, Test accuracy: 77.41
Round  84, Train loss: 0.213, Test loss: 0.674, Test accuracy: 77.90
Round  85, Train loss: 0.205, Test loss: 0.673, Test accuracy: 77.83
Round  86, Train loss: 0.202, Test loss: 0.697, Test accuracy: 77.45
Round  87, Train loss: 0.200, Test loss: 0.683, Test accuracy: 77.49
Round  88, Train loss: 0.203, Test loss: 0.684, Test accuracy: 77.80
Round  89, Train loss: 0.196, Test loss: 0.680, Test accuracy: 77.49
Round  90, Train loss: 0.200, Test loss: 0.679, Test accuracy: 77.87
Round  91, Train loss: 0.198, Test loss: 0.695, Test accuracy: 77.65
Round  92, Train loss: 0.193, Test loss: 0.695, Test accuracy: 77.58
Round  93, Train loss: 0.190, Test loss: 0.697, Test accuracy: 77.65
Round  94, Train loss: 0.196, Test loss: 0.700, Test accuracy: 77.72
Round  95, Train loss: 0.189, Test loss: 0.696, Test accuracy: 77.68
Round  96, Train loss: 0.185, Test loss: 0.698, Test accuracy: 77.68
Round  97, Train loss: 0.183, Test loss: 0.712, Test accuracy: 77.65
Round  98, Train loss: 0.176, Test loss: 0.689, Test accuracy: 78.16
Round  99, Train loss: 0.183, Test loss: 0.696, Test accuracy: 78.06
Final Round, Train loss: 0.147, Test loss: 0.692, Test accuracy: 78.46
Average accuracy final 10 rounds: 77.77
3059.5593535900116
[2.899210214614868, 5.503633975982666, 8.11605429649353, 10.70916223526001, 13.300439834594727, 15.895668983459473, 18.477999687194824, 21.069128036499023, 23.663557767868042, 26.2558696269989, 28.83860206604004, 31.423000812530518, 34.00714921951294, 36.59425210952759, 39.18174743652344, 41.50014853477478, 43.82101392745972, 46.14394402503967, 48.47213006019592, 50.81066012382507, 53.14017391204834, 55.466156005859375, 57.793232917785645, 60.14620232582092, 62.481943130493164, 64.80810022354126, 67.1539409160614, 69.47958898544312, 71.80364990234375, 74.1448621749878, 76.48468327522278, 78.83045196533203, 81.17270278930664, 83.50907230377197, 85.86294078826904, 88.20256733894348, 90.54020142555237, 92.8820149898529, 95.20708799362183, 97.54155564308167, 99.87695503234863, 102.22122931480408, 104.56972575187683, 106.90424275398254, 109.22564888000488, 111.54671263694763, 113.8754210472107, 116.20318269729614, 118.5234739780426, 120.86482071876526, 123.18259191513062, 125.50381875038147, 127.82828402519226, 130.15959453582764, 132.49329328536987, 134.84838390350342, 137.1738793849945, 139.49705505371094, 141.8307867050171, 144.15921139717102, 146.50183844566345, 148.84334754943848, 151.18758916854858, 153.50538420677185, 155.8168773651123, 158.14219784736633, 160.47213912010193, 162.79575848579407, 165.12564945220947, 167.4548144340515, 169.76861596107483, 172.08092379570007, 174.40633940696716, 176.72364830970764, 179.0428113937378, 181.35082983970642, 183.67792677879333, 185.99605870246887, 188.3146107196808, 190.6261909008026, 192.94490313529968, 195.26058435440063, 197.5788221359253, 199.9002115726471, 202.2202627658844, 204.56069135665894, 206.88978028297424, 209.20107579231262, 211.51465463638306, 213.84256887435913, 216.1718714237213, 218.4951252937317, 220.812575340271, 223.11948919296265, 225.43116879463196, 227.7527813911438, 230.07740426063538, 232.39830875396729, 234.71684885025024, 237.04506492614746, 240.8766496181488]
[36.49, 47.97, 54.82, 58.18, 60.19, 61.86, 64.07, 66.34, 66.51, 67.68, 68.16, 69.82, 70.23, 70.37, 70.63, 71.64, 72.24, 73.15, 72.95, 73.61, 73.22, 73.41, 73.72, 73.66, 73.59, 73.74, 74.02, 74.28, 74.86, 75.54, 75.38, 75.52, 74.78, 75.62, 75.27, 76.13, 75.97, 76.21, 75.96, 76.04, 75.83, 76.52, 76.21, 76.54, 76.97, 76.58, 76.93, 76.58, 76.58, 76.81, 76.6, 76.7, 76.29, 76.55, 76.85, 77.02, 76.52, 76.43, 76.55, 76.58, 76.83, 76.83, 76.72, 76.77, 77.1, 76.58, 77.03, 77.11, 76.81, 77.36, 77.31, 77.24, 77.11, 76.84, 77.04, 77.02, 76.72, 76.89, 76.72, 76.84, 77.34, 77.56, 77.88, 77.41, 77.9, 77.83, 77.45, 77.49, 77.8, 77.49, 77.87, 77.65, 77.58, 77.65, 77.72, 77.68, 77.68, 77.65, 78.16, 78.06, 78.46]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.0 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.667, Test loss: 1.557, Test accuracy: 38.04
Round   1, Train loss: 1.285, Test loss: 1.212, Test accuracy: 47.52
Round   2, Train loss: 1.127, Test loss: 1.096, Test accuracy: 52.75
Round   3, Train loss: 1.042, Test loss: 1.015, Test accuracy: 58.63
Round   4, Train loss: 0.984, Test loss: 0.974, Test accuracy: 60.08
Round   5, Train loss: 0.940, Test loss: 0.934, Test accuracy: 61.94
Round   6, Train loss: 0.901, Test loss: 0.905, Test accuracy: 63.37
Round   7, Train loss: 0.863, Test loss: 0.879, Test accuracy: 64.99
Round   8, Train loss: 0.835, Test loss: 0.850, Test accuracy: 66.06
Round   9, Train loss: 0.803, Test loss: 0.830, Test accuracy: 66.70
Round  10, Train loss: 0.773, Test loss: 0.796, Test accuracy: 68.42
Round  11, Train loss: 0.751, Test loss: 0.788, Test accuracy: 68.67
Round  12, Train loss: 0.725, Test loss: 0.780, Test accuracy: 69.28
Round  13, Train loss: 0.701, Test loss: 0.764, Test accuracy: 70.21
Round  14, Train loss: 0.680, Test loss: 0.759, Test accuracy: 70.18
Round  15, Train loss: 0.657, Test loss: 0.742, Test accuracy: 70.54
Round  16, Train loss: 0.633, Test loss: 0.729, Test accuracy: 71.63
Round  17, Train loss: 0.617, Test loss: 0.712, Test accuracy: 71.95
Round  18, Train loss: 0.600, Test loss: 0.722, Test accuracy: 71.75
Round  19, Train loss: 0.577, Test loss: 0.708, Test accuracy: 72.29
Round  20, Train loss: 0.598, Test loss: 0.729, Test accuracy: 72.04
Round  21, Train loss: 0.550, Test loss: 0.716, Test accuracy: 72.45
Round  22, Train loss: 0.494, Test loss: 0.715, Test accuracy: 72.03
Round  23, Train loss: 0.554, Test loss: 0.720, Test accuracy: 72.45
Round  24, Train loss: 0.568, Test loss: 0.711, Test accuracy: 72.85
Round  25, Train loss: 0.511, Test loss: 0.714, Test accuracy: 73.41
Round  26, Train loss: 0.510, Test loss: 0.714, Test accuracy: 72.96
Round  27, Train loss: 0.488, Test loss: 0.700, Test accuracy: 73.66
Round  28, Train loss: 0.482, Test loss: 0.715, Test accuracy: 73.17
Round  29, Train loss: 0.484, Test loss: 0.710, Test accuracy: 73.39
Round  30, Train loss: 0.454, Test loss: 0.710, Test accuracy: 73.41
Round  31, Train loss: 0.495, Test loss: 0.685, Test accuracy: 74.44
Round  32, Train loss: 0.429, Test loss: 0.689, Test accuracy: 74.30
Round  33, Train loss: 0.430, Test loss: 0.694, Test accuracy: 74.47
Round  34, Train loss: 0.393, Test loss: 0.703, Test accuracy: 74.05
Round  35, Train loss: 0.474, Test loss: 0.694, Test accuracy: 74.59
Round  36, Train loss: 0.379, Test loss: 0.698, Test accuracy: 74.12
Round  37, Train loss: 0.432, Test loss: 0.702, Test accuracy: 73.94
Round  38, Train loss: 0.390, Test loss: 0.707, Test accuracy: 74.74
Round  39, Train loss: 0.388, Test loss: 0.713, Test accuracy: 74.28
Round  40, Train loss: 0.388, Test loss: 0.724, Test accuracy: 74.01
Round  41, Train loss: 0.411, Test loss: 0.704, Test accuracy: 75.03
Round  42, Train loss: 0.404, Test loss: 0.697, Test accuracy: 75.51
Round  43, Train loss: 0.373, Test loss: 0.698, Test accuracy: 75.47
Round  44, Train loss: 0.375, Test loss: 0.694, Test accuracy: 75.84
Round  45, Train loss: 0.361, Test loss: 0.696, Test accuracy: 75.17
Round  46, Train loss: 0.356, Test loss: 0.707, Test accuracy: 75.11
Round  47, Train loss: 0.359, Test loss: 0.688, Test accuracy: 75.62
Round  48, Train loss: 0.329, Test loss: 0.689, Test accuracy: 75.56
Round  49, Train loss: 0.370, Test loss: 0.707, Test accuracy: 75.35
Round  50, Train loss: 0.365, Test loss: 0.710, Test accuracy: 75.26
Round  51, Train loss: 0.323, Test loss: 0.689, Test accuracy: 75.95
Round  52, Train loss: 0.332, Test loss: 0.704, Test accuracy: 75.28
Round  53, Train loss: 0.306, Test loss: 0.684, Test accuracy: 75.95
Round  54, Train loss: 0.348, Test loss: 0.692, Test accuracy: 75.97
Round  55, Train loss: 0.311, Test loss: 0.698, Test accuracy: 76.12
Round  56, Train loss: 0.321, Test loss: 0.695, Test accuracy: 75.93
Round  57, Train loss: 0.291, Test loss: 0.702, Test accuracy: 75.89
Round  58, Train loss: 0.279, Test loss: 0.685, Test accuracy: 76.22
Round  59, Train loss: 0.268, Test loss: 0.707, Test accuracy: 76.18
Round  60, Train loss: 0.251, Test loss: 0.703, Test accuracy: 76.17
Round  61, Train loss: 0.310, Test loss: 0.694, Test accuracy: 76.61
Round  62, Train loss: 0.263, Test loss: 0.708, Test accuracy: 76.54
Round  63, Train loss: 0.296, Test loss: 0.704, Test accuracy: 76.40
Round  64, Train loss: 0.244, Test loss: 0.712, Test accuracy: 76.04
Round  65, Train loss: 0.280, Test loss: 0.705, Test accuracy: 76.37
Round  66, Train loss: 0.247, Test loss: 0.726, Test accuracy: 75.82
Round  67, Train loss: 0.279, Test loss: 0.714, Test accuracy: 75.87
Round  68, Train loss: 0.246, Test loss: 0.700, Test accuracy: 76.13
Round  69, Train loss: 0.247, Test loss: 0.705, Test accuracy: 75.78
Round  70, Train loss: 0.285, Test loss: 0.717, Test accuracy: 75.69
Round  71, Train loss: 0.242, Test loss: 0.720, Test accuracy: 75.38
Round  72, Train loss: 0.241, Test loss: 0.720, Test accuracy: 76.30
Round  73, Train loss: 0.284, Test loss: 0.720, Test accuracy: 76.17
Round  74, Train loss: 0.256, Test loss: 0.695, Test accuracy: 76.49
Round  75, Train loss: 0.297, Test loss: 0.716, Test accuracy: 76.10
Round  76, Train loss: 0.252, Test loss: 0.695, Test accuracy: 76.45
Round  77, Train loss: 0.211, Test loss: 0.690, Test accuracy: 76.64
Round  78, Train loss: 0.271, Test loss: 0.690, Test accuracy: 77.03
Round  79, Train loss: 0.214, Test loss: 0.713, Test accuracy: 76.95
Round  80, Train loss: 0.230, Test loss: 0.702, Test accuracy: 77.03
Round  81, Train loss: 0.218, Test loss: 0.691, Test accuracy: 77.14
Round  82, Train loss: 0.215, Test loss: 0.701, Test accuracy: 77.23
Round  83, Train loss: 0.215, Test loss: 0.702, Test accuracy: 77.15
Round  84, Train loss: 0.208, Test loss: 0.702, Test accuracy: 77.66
Round  85, Train loss: 0.211, Test loss: 0.694, Test accuracy: 77.55
Round  86, Train loss: 0.204, Test loss: 0.708, Test accuracy: 76.98
Round  87, Train loss: 0.201, Test loss: 0.713, Test accuracy: 77.27
Round  88, Train loss: 0.197, Test loss: 0.702, Test accuracy: 77.49
Round  89, Train loss: 0.199, Test loss: 0.709, Test accuracy: 77.19
Round  90, Train loss: 0.192, Test loss: 0.714, Test accuracy: 77.51
Round  91, Train loss: 0.191, Test loss: 0.725, Test accuracy: 77.11
Round  92, Train loss: 0.194, Test loss: 0.710, Test accuracy: 77.56
Round  93, Train loss: 0.195, Test loss: 0.723, Test accuracy: 77.05
Round  94, Train loss: 0.191, Test loss: 0.718, Test accuracy: 77.12
Round  95, Train loss: 0.187, Test loss: 0.720, Test accuracy: 77.44
Round  96, Train loss: 0.181, Test loss: 0.715, Test accuracy: 77.60
Round  97, Train loss: 0.185, Test loss: 0.719, Test accuracy: 77.28
Round  98, Train loss: 0.178, Test loss: 0.731, Test accuracy: 77.45
Round  99, Train loss: 0.184, Test loss: 0.729, Test accuracy: 77.06
Final Round, Train loss: 0.146, Test loss: 0.717, Test accuracy: 77.88
Average accuracy final 10 rounds: 77.31800000000001
4661.462536811829
[2.8383805751800537, 5.4208691120147705, 8.005737543106079, 10.589573860168457, 13.172044515609741, 15.752743482589722, 18.334944248199463, 20.912373542785645, 23.47343897819519, 26.0354061126709, 28.597043991088867, 31.160298824310303, 33.738096952438354, 36.31736898422241, 38.91477012634277, 41.51726675033569, 44.119940757751465, 46.72532939910889, 49.32778310775757, 51.928956031799316, 54.52557921409607, 59.04207134246826, 63.57172966003418, 68.17977213859558, 72.77442741394043, 77.34323072433472, 81.86637020111084, 86.36893200874329, 90.99548172950745, 95.62948727607727, 100.26009964942932, 104.79948019981384, 109.4022581577301, 113.93438267707825, 118.47300744056702, 123.09941411018372, 127.68867373466492, 132.2766888141632, 136.88787460327148, 141.41126656532288, 145.93869876861572, 150.53485012054443, 155.13529229164124, 159.61572861671448, 164.23762249946594, 168.85239934921265, 173.4051525592804, 177.86212420463562, 182.4219994544983, 187.0353546142578, 191.5021255016327, 196.01553201675415, 200.6019721031189, 205.22154760360718, 209.83119583129883, 214.32594227790833, 218.89802384376526, 223.48452377319336, 227.96511006355286, 232.52325797080994, 237.05602645874023, 241.6169044971466, 246.09236645698547, 250.5546486377716, 255.153728723526, 259.76947140693665, 264.35773491859436, 268.97763752937317, 273.43095660209656, 277.8990159034729, 282.4124689102173, 287.0029547214508, 291.6333763599396, 296.252290725708, 300.8841471672058, 305.5174067020416, 310.1632556915283, 314.82455563545227, 319.3580460548401, 323.84139466285706, 328.4525246620178, 333.0791630744934, 337.6233286857605, 342.256817817688, 346.87407660484314, 351.49814200401306, 356.17299127578735, 360.8096408843994, 365.3629221916199, 369.9298300743103, 374.55799436569214, 379.21747279167175, 383.8423054218292, 388.1108696460724, 392.24048376083374, 396.36191606521606, 400.48890805244446, 404.61146354675293, 408.734073638916, 412.8569118976593, 416.6770758628845]
[38.04, 47.52, 52.75, 58.63, 60.08, 61.94, 63.37, 64.99, 66.06, 66.7, 68.42, 68.67, 69.28, 70.21, 70.18, 70.54, 71.63, 71.95, 71.75, 72.29, 72.04, 72.45, 72.03, 72.45, 72.85, 73.41, 72.96, 73.66, 73.17, 73.39, 73.41, 74.44, 74.3, 74.47, 74.05, 74.59, 74.12, 73.94, 74.74, 74.28, 74.01, 75.03, 75.51, 75.47, 75.84, 75.17, 75.11, 75.62, 75.56, 75.35, 75.26, 75.95, 75.28, 75.95, 75.97, 76.12, 75.93, 75.89, 76.22, 76.18, 76.17, 76.61, 76.54, 76.4, 76.04, 76.37, 75.82, 75.87, 76.13, 75.78, 75.69, 75.38, 76.3, 76.17, 76.49, 76.1, 76.45, 76.64, 77.03, 76.95, 77.03, 77.14, 77.23, 77.15, 77.66, 77.55, 76.98, 77.27, 77.49, 77.19, 77.51, 77.11, 77.56, 77.05, 77.12, 77.44, 77.6, 77.28, 77.45, 77.06, 77.88]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.651, Test loss: 2.017, Test accuracy: 23.48
Round   0, Global train loss: 1.651, Global test loss: 2.227, Global test accuracy: 20.40
Round   1, Train loss: 1.478, Test loss: 1.871, Test accuracy: 33.38
Round   1, Global train loss: 1.478, Global test loss: 2.216, Global test accuracy: 26.28
Round   2, Train loss: 1.336, Test loss: 1.565, Test accuracy: 40.84
Round   2, Global train loss: 1.336, Global test loss: 2.128, Global test accuracy: 26.92
Round   3, Train loss: 1.220, Test loss: 1.407, Test accuracy: 44.27
Round   3, Global train loss: 1.220, Global test loss: 2.054, Global test accuracy: 27.68
Round   4, Train loss: 1.200, Test loss: 1.359, Test accuracy: 47.21
Round   4, Global train loss: 1.200, Global test loss: 2.004, Global test accuracy: 32.74
Round   5, Train loss: 1.188, Test loss: 1.319, Test accuracy: 46.94
Round   5, Global train loss: 1.188, Global test loss: 1.961, Global test accuracy: 29.13
Round   6, Train loss: 1.189, Test loss: 1.314, Test accuracy: 48.23
Round   6, Global train loss: 1.189, Global test loss: 2.134, Global test accuracy: 28.81
Round   7, Train loss: 1.178, Test loss: 1.197, Test accuracy: 52.04
Round   7, Global train loss: 1.178, Global test loss: 1.910, Global test accuracy: 34.11
Round   8, Train loss: 1.137, Test loss: 1.140, Test accuracy: 54.22
Round   8, Global train loss: 1.137, Global test loss: 1.904, Global test accuracy: 30.88
Round   9, Train loss: 1.016, Test loss: 1.139, Test accuracy: 54.27
Round   9, Global train loss: 1.016, Global test loss: 2.054, Global test accuracy: 27.49
Round  10, Train loss: 1.032, Test loss: 1.130, Test accuracy: 54.90
Round  10, Global train loss: 1.032, Global test loss: 1.962, Global test accuracy: 32.32
Round  11, Train loss: 1.064, Test loss: 1.117, Test accuracy: 55.29
Round  11, Global train loss: 1.064, Global test loss: 1.960, Global test accuracy: 29.02
Round  12, Train loss: 1.219, Test loss: 1.103, Test accuracy: 55.86
Round  12, Global train loss: 1.219, Global test loss: 1.974, Global test accuracy: 32.59
Round  13, Train loss: 0.908, Test loss: 1.077, Test accuracy: 56.93
Round  13, Global train loss: 0.908, Global test loss: 1.922, Global test accuracy: 31.61
Round  14, Train loss: 1.011, Test loss: 1.067, Test accuracy: 57.83
Round  14, Global train loss: 1.011, Global test loss: 2.041, Global test accuracy: 23.89
Round  15, Train loss: 0.901, Test loss: 1.067, Test accuracy: 58.22
Round  15, Global train loss: 0.901, Global test loss: 2.045, Global test accuracy: 34.51
Round  16, Train loss: 0.893, Test loss: 1.084, Test accuracy: 57.42
Round  16, Global train loss: 0.893, Global test loss: 1.843, Global test accuracy: 35.72
Round  17, Train loss: 0.955, Test loss: 1.085, Test accuracy: 57.03
Round  17, Global train loss: 0.955, Global test loss: 2.010, Global test accuracy: 32.75
Round  18, Train loss: 0.919, Test loss: 1.089, Test accuracy: 57.19
Round  18, Global train loss: 0.919, Global test loss: 2.046, Global test accuracy: 32.47
Round  19, Train loss: 0.928, Test loss: 1.094, Test accuracy: 57.04
Round  19, Global train loss: 0.928, Global test loss: 2.078, Global test accuracy: 28.67
Round  20, Train loss: 1.070, Test loss: 1.085, Test accuracy: 58.03
Round  20, Global train loss: 1.070, Global test loss: 2.066, Global test accuracy: 25.58
Round  21, Train loss: 0.876, Test loss: 1.081, Test accuracy: 58.68
Round  21, Global train loss: 0.876, Global test loss: 2.121, Global test accuracy: 29.09
Round  22, Train loss: 1.036, Test loss: 1.080, Test accuracy: 59.08
Round  22, Global train loss: 1.036, Global test loss: 2.005, Global test accuracy: 30.20
Round  23, Train loss: 0.833, Test loss: 1.093, Test accuracy: 59.54
Round  23, Global train loss: 0.833, Global test loss: 1.868, Global test accuracy: 37.18
Round  24, Train loss: 0.800, Test loss: 1.103, Test accuracy: 59.60
Round  24, Global train loss: 0.800, Global test loss: 2.110, Global test accuracy: 28.05
Round  25, Train loss: 0.701, Test loss: 1.139, Test accuracy: 59.10
Round  25, Global train loss: 0.701, Global test loss: 1.945, Global test accuracy: 32.83
Round  26, Train loss: 0.751, Test loss: 1.125, Test accuracy: 59.15
Round  26, Global train loss: 0.751, Global test loss: 1.948, Global test accuracy: 31.34
Round  27, Train loss: 0.730, Test loss: 1.110, Test accuracy: 59.35
Round  27, Global train loss: 0.730, Global test loss: 1.909, Global test accuracy: 31.46
Round  28, Train loss: 0.683, Test loss: 1.104, Test accuracy: 59.68
Round  28, Global train loss: 0.683, Global test loss: 2.067, Global test accuracy: 28.90
Round  29, Train loss: 0.699, Test loss: 1.106, Test accuracy: 60.13
Round  29, Global train loss: 0.699, Global test loss: 2.044, Global test accuracy: 31.00
Round  30, Train loss: 0.634, Test loss: 1.125, Test accuracy: 60.26
Round  30, Global train loss: 0.634, Global test loss: 2.239, Global test accuracy: 31.38
Round  31, Train loss: 0.758, Test loss: 1.120, Test accuracy: 60.46
Round  31, Global train loss: 0.758, Global test loss: 1.989, Global test accuracy: 32.25
Round  32, Train loss: 0.905, Test loss: 1.140, Test accuracy: 60.04
Round  32, Global train loss: 0.905, Global test loss: 2.017, Global test accuracy: 35.25
Round  33, Train loss: 0.719, Test loss: 1.155, Test accuracy: 60.39
Round  33, Global train loss: 0.719, Global test loss: 2.072, Global test accuracy: 33.43
Round  34, Train loss: 0.761, Test loss: 1.167, Test accuracy: 60.89
Round  34, Global train loss: 0.761, Global test loss: 2.135, Global test accuracy: 31.81
Round  35, Train loss: 0.557, Test loss: 1.167, Test accuracy: 61.10
Round  35, Global train loss: 0.557, Global test loss: 1.849, Global test accuracy: 33.53
Round  36, Train loss: 0.576, Test loss: 1.198, Test accuracy: 60.18
Round  36, Global train loss: 0.576, Global test loss: 1.980, Global test accuracy: 34.93
Round  37, Train loss: 0.701, Test loss: 1.219, Test accuracy: 59.89
Round  37, Global train loss: 0.701, Global test loss: 2.064, Global test accuracy: 28.27
Round  38, Train loss: 0.585, Test loss: 1.230, Test accuracy: 59.96
Round  38, Global train loss: 0.585, Global test loss: 1.839, Global test accuracy: 36.76
Round  39, Train loss: 0.602, Test loss: 1.225, Test accuracy: 59.79
Round  39, Global train loss: 0.602, Global test loss: 1.939, Global test accuracy: 30.62
Round  40, Train loss: 0.585, Test loss: 1.227, Test accuracy: 60.93
Round  40, Global train loss: 0.585, Global test loss: 2.032, Global test accuracy: 31.83
Round  41, Train loss: 0.422, Test loss: 1.247, Test accuracy: 60.29
Round  41, Global train loss: 0.422, Global test loss: 1.885, Global test accuracy: 31.94
Round  42, Train loss: 0.456, Test loss: 1.286, Test accuracy: 60.81
Round  42, Global train loss: 0.456, Global test loss: 1.861, Global test accuracy: 36.51
Round  43, Train loss: 0.402, Test loss: 1.293, Test accuracy: 60.62
Round  43, Global train loss: 0.402, Global test loss: 1.923, Global test accuracy: 33.22
Round  44, Train loss: 0.472, Test loss: 1.328, Test accuracy: 60.07
Round  44, Global train loss: 0.472, Global test loss: 1.927, Global test accuracy: 35.66
Round  45, Train loss: 0.497, Test loss: 1.349, Test accuracy: 59.78
Round  45, Global train loss: 0.497, Global test loss: 1.895, Global test accuracy: 36.13
Round  46, Train loss: 0.502, Test loss: 1.360, Test accuracy: 59.65
Round  46, Global train loss: 0.502, Global test loss: 1.932, Global test accuracy: 35.69
Round  47, Train loss: 0.356, Test loss: 1.367, Test accuracy: 60.12
Round  47, Global train loss: 0.356, Global test loss: 2.121, Global test accuracy: 29.88
Round  48, Train loss: 0.343, Test loss: 1.359, Test accuracy: 60.31
Round  48, Global train loss: 0.343, Global test loss: 2.099, Global test accuracy: 25.31
Round  49, Train loss: 0.344, Test loss: 1.382, Test accuracy: 59.86
Round  49, Global train loss: 0.344, Global test loss: 2.253, Global test accuracy: 25.66
Round  50, Train loss: 0.493, Test loss: 1.439, Test accuracy: 59.39
Round  50, Global train loss: 0.493, Global test loss: 2.053, Global test accuracy: 30.33
Round  51, Train loss: 0.402, Test loss: 1.465, Test accuracy: 59.09
Round  51, Global train loss: 0.402, Global test loss: 1.849, Global test accuracy: 39.21
Round  52, Train loss: 0.377, Test loss: 1.474, Test accuracy: 59.81
Round  52, Global train loss: 0.377, Global test loss: 2.170, Global test accuracy: 28.08
Round  53, Train loss: 0.266, Test loss: 1.479, Test accuracy: 60.18
Round  53, Global train loss: 0.266, Global test loss: 1.914, Global test accuracy: 34.91
Round  54, Train loss: 0.488, Test loss: 1.460, Test accuracy: 60.89
Round  54, Global train loss: 0.488, Global test loss: 2.077, Global test accuracy: 31.95
Round  55, Train loss: 0.242, Test loss: 1.464, Test accuracy: 61.08
Round  55, Global train loss: 0.242, Global test loss: 2.150, Global test accuracy: 30.69
Round  56, Train loss: 0.283, Test loss: 1.501, Test accuracy: 60.80
Round  56, Global train loss: 0.283, Global test loss: 1.949, Global test accuracy: 33.48
Round  57, Train loss: 0.369, Test loss: 1.519, Test accuracy: 60.70
Round  57, Global train loss: 0.369, Global test loss: 2.009, Global test accuracy: 31.99
Round  58, Train loss: 0.331, Test loss: 1.551, Test accuracy: 60.75
Round  58, Global train loss: 0.331, Global test loss: 1.914, Global test accuracy: 33.88
Round  59, Train loss: 0.320, Test loss: 1.563, Test accuracy: 60.53
Round  59, Global train loss: 0.320, Global test loss: 2.010, Global test accuracy: 29.77
Round  60, Train loss: 0.345, Test loss: 1.599, Test accuracy: 60.44
Round  60, Global train loss: 0.345, Global test loss: 1.855, Global test accuracy: 35.36
Round  61, Train loss: 0.296, Test loss: 1.622, Test accuracy: 60.48
Round  61, Global train loss: 0.296, Global test loss: 1.951, Global test accuracy: 29.85
Round  62, Train loss: 0.262, Test loss: 1.659, Test accuracy: 59.68
Round  62, Global train loss: 0.262, Global test loss: 1.920, Global test accuracy: 32.83
Round  63, Train loss: 0.240, Test loss: 1.649, Test accuracy: 60.39
Round  63, Global train loss: 0.240, Global test loss: 1.804, Global test accuracy: 33.70
Round  64, Train loss: 0.389, Test loss: 1.629, Test accuracy: 61.03
Round  64, Global train loss: 0.389, Global test loss: 2.081, Global test accuracy: 26.84
Round  65, Train loss: 0.270, Test loss: 1.674, Test accuracy: 61.09
Round  65, Global train loss: 0.270, Global test loss: 1.897, Global test accuracy: 35.91
Round  66, Train loss: 0.202, Test loss: 1.684, Test accuracy: 60.67
Round  66, Global train loss: 0.202, Global test loss: 1.831, Global test accuracy: 37.42
Round  67, Train loss: 0.261, Test loss: 1.736, Test accuracy: 60.44
Round  67, Global train loss: 0.261, Global test loss: 1.998, Global test accuracy: 33.88
Round  68, Train loss: 0.236, Test loss: 1.736, Test accuracy: 61.10
Round  68, Global train loss: 0.236, Global test loss: 2.016, Global test accuracy: 37.16
Round  69, Train loss: 0.273, Test loss: 1.743, Test accuracy: 60.88
Round  69, Global train loss: 0.273, Global test loss: 1.961, Global test accuracy: 31.78
Round  70, Train loss: 0.210, Test loss: 1.741, Test accuracy: 60.82
Round  70, Global train loss: 0.210, Global test loss: 1.979, Global test accuracy: 33.65
Round  71, Train loss: 0.206, Test loss: 1.759, Test accuracy: 60.53
Round  71, Global train loss: 0.206, Global test loss: 2.281, Global test accuracy: 29.66
Round  72, Train loss: 0.301, Test loss: 1.780, Test accuracy: 60.59
Round  72, Global train loss: 0.301, Global test loss: 2.046, Global test accuracy: 27.20
Round  73, Train loss: 0.187, Test loss: 1.821, Test accuracy: 60.53
Round  73, Global train loss: 0.187, Global test loss: 2.004, Global test accuracy: 29.90
Round  74, Train loss: 0.218, Test loss: 1.833, Test accuracy: 60.97
Round  74, Global train loss: 0.218, Global test loss: 1.857, Global test accuracy: 36.25
Round  75, Train loss: 0.217, Test loss: 1.787, Test accuracy: 60.98
Round  75, Global train loss: 0.217, Global test loss: 2.044, Global test accuracy: 25.83
Round  76, Train loss: 0.159, Test loss: 1.812, Test accuracy: 60.87
Round  76, Global train loss: 0.159, Global test loss: 2.082, Global test accuracy: 35.66
Round  77, Train loss: 0.168, Test loss: 1.864, Test accuracy: 60.78
Round  77, Global train loss: 0.168, Global test loss: 1.974, Global test accuracy: 25.88
Round  78, Train loss: 0.259, Test loss: 1.898, Test accuracy: 60.48
Round  78, Global train loss: 0.259, Global test loss: 1.893, Global test accuracy: 37.46
Round  79, Train loss: 0.154, Test loss: 1.939, Test accuracy: 60.68
Round  79, Global train loss: 0.154, Global test loss: 2.054, Global test accuracy: 34.38
Round  80, Train loss: 0.215, Test loss: 1.870, Test accuracy: 60.95
Round  80, Global train loss: 0.215, Global test loss: 1.955, Global test accuracy: 34.24
Round  81, Train loss: 0.181, Test loss: 1.878, Test accuracy: 61.06
Round  81, Global train loss: 0.181, Global test loss: 1.903, Global test accuracy: 31.52
Round  82, Train loss: 0.206, Test loss: 1.949, Test accuracy: 61.21
Round  82, Global train loss: 0.206, Global test loss: 2.019, Global test accuracy: 34.30
Round  83, Train loss: 0.194, Test loss: 1.986, Test accuracy: 61.03
Round  83, Global train loss: 0.194, Global test loss: 2.009, Global test accuracy: 30.15
Round  84, Train loss: 0.187, Test loss: 2.000, Test accuracy: 60.90
Round  84, Global train loss: 0.187, Global test loss: 1.953, Global test accuracy: 29.56
Round  85, Train loss: 0.167, Test loss: 2.000, Test accuracy: 60.76
Round  85, Global train loss: 0.167, Global test loss: 2.045, Global test accuracy: 30.64
Round  86, Train loss: 0.202, Test loss: 2.036, Test accuracy: 60.62
Round  86, Global train loss: 0.202, Global test loss: 1.913, Global test accuracy: 32.12
Round  87, Train loss: 0.148, Test loss: 2.050, Test accuracy: 59.76
Round  87, Global train loss: 0.148, Global test loss: 1.904, Global test accuracy: 32.73
Round  88, Train loss: 0.167, Test loss: 2.026, Test accuracy: 60.61
Round  88, Global train loss: 0.167, Global test loss: 2.024, Global test accuracy: 32.60
Round  89, Train loss: 0.148, Test loss: 2.055, Test accuracy: 60.22
Round  89, Global train loss: 0.148, Global test loss: 1.957, Global test accuracy: 34.01
Round  90, Train loss: 0.205, Test loss: 2.083, Test accuracy: 60.16
Round  90, Global train loss: 0.205, Global test loss: 2.058, Global test accuracy: 29.94
Round  91, Train loss: 0.134, Test loss: 2.104, Test accuracy: 59.97
Round  91, Global train loss: 0.134, Global test loss: 2.076, Global test accuracy: 28.22
Round  92, Train loss: 0.145, Test loss: 2.084, Test accuracy: 60.15
Round  92, Global train loss: 0.145, Global test loss: 1.975, Global test accuracy: 29.19
Round  93, Train loss: 0.101, Test loss: 2.045, Test accuracy: 60.62
Round  93, Global train loss: 0.101, Global test loss: 1.741, Global test accuracy: 40.91
Round  94, Train loss: 0.164, Test loss: 2.059, Test accuracy: 60.96
Round  94, Global train loss: 0.164, Global test loss: 2.197, Global test accuracy: 32.32
Round  95, Train loss: 0.144, Test loss: 2.089, Test accuracy: 61.00
Round  95, Global train loss: 0.144, Global test loss: 2.202, Global test accuracy: 27.61
Round  96, Train loss: 0.119, Test loss: 2.128, Test accuracy: 61.52
Round  96, Global train loss: 0.119, Global test loss: 1.966, Global test accuracy: 31.53
Round  97, Train loss: 0.171, Test loss: 2.117, Test accuracy: 61.50
Round  97, Global train loss: 0.171, Global test loss: 2.072, Global test accuracy: 26.59
Round  98, Train loss: 0.130, Test loss: 2.174, Test accuracy: 60.97
Round  98, Global train loss: 0.130, Global test loss: 1.894, Global test accuracy: 34.90
Round  99, Train loss: 0.101, Test loss: 2.238, Test accuracy: 60.94
Round  99, Global train loss: 0.101, Global test loss: 2.141, Global test accuracy: 33.22
Final Round, Train loss: 0.115, Test loss: 2.167, Test accuracy: 61.52
Final Round, Global train loss: 0.115, Global test loss: 2.141, Global test accuracy: 33.22
Average accuracy final 10 rounds: 60.778999999999996 

Average global accuracy final 10 rounds: 31.442999999999994 

1409.8564109802246
[1.4115626811981201, 2.8231253623962402, 3.9757556915283203, 5.1283860206604, 6.284695625305176, 7.441005229949951, 8.601212978363037, 9.761420726776123, 10.919047832489014, 12.076674938201904, 13.231056928634644, 14.385438919067383, 15.531401872634888, 16.677364826202393, 17.825058221817017, 18.97275161743164, 20.121623516082764, 21.270495414733887, 22.419780254364014, 23.56906509399414, 24.71810817718506, 25.867151260375977, 27.020996809005737, 28.174842357635498, 29.325546503067017, 30.476250648498535, 31.619543313980103, 32.76283597946167, 33.90632128715515, 35.04980659484863, 36.19815182685852, 37.34649705886841, 38.49315571784973, 39.639814376831055, 40.783923625946045, 41.928032875061035, 43.086963415145874, 44.24589395523071, 45.401888608932495, 46.55788326263428, 47.712961196899414, 48.86803913116455, 50.018884897232056, 51.16973066329956, 52.324987173080444, 53.48024368286133, 54.63166904449463, 55.78309440612793, 56.937657833099365, 58.0922212600708, 59.246097564697266, 60.39997386932373, 61.55095839500427, 62.701942920684814, 63.85245418548584, 65.00296545028687, 66.15748476982117, 67.31200408935547, 68.46668124198914, 69.6213583946228, 70.77243208885193, 71.92350578308105, 73.0739483833313, 74.22439098358154, 75.37666869163513, 76.52894639968872, 77.68143773078918, 78.83392906188965, 79.98501825332642, 81.13610744476318, 82.29434061050415, 83.45257377624512, 84.60502576828003, 85.75747776031494, 86.91147375106812, 88.06546974182129, 89.21955275535583, 90.37363576889038, 91.52608966827393, 92.67854356765747, 93.8305881023407, 94.98263263702393, 96.13997054100037, 97.2973084449768, 98.45403504371643, 99.61076164245605, 100.75470280647278, 101.8986439704895, 103.0499496459961, 104.20125532150269, 105.34941053390503, 106.49756574630737, 107.64718723297119, 108.79680871963501, 109.95171928405762, 111.10662984848022, 112.25427651405334, 113.40192317962646, 114.5467677116394, 115.69161224365234, 116.83890771865845, 117.98620319366455, 119.13344144821167, 120.28067970275879, 121.43230390548706, 122.58392810821533, 123.73103189468384, 124.87813568115234, 126.0276288986206, 127.17712211608887, 128.3321177959442, 129.48711347579956, 130.63393664360046, 131.78075981140137, 132.92779350280762, 134.07482719421387, 135.22261023521423, 136.3703932762146, 137.515127658844, 138.6598620414734, 139.8141679763794, 140.9684739112854, 142.11346626281738, 143.25845861434937, 144.417715549469, 145.57697248458862, 146.7224690914154, 147.8679656982422, 149.01977682113647, 150.17158794403076, 151.31521034240723, 152.4588327407837, 153.6051218509674, 154.75141096115112, 155.89989399909973, 157.04837703704834, 158.1933515071869, 159.33832597732544, 160.48443746566772, 161.63054895401, 162.77688264846802, 163.92321634292603, 165.06768918037415, 166.21216201782227, 167.36781430244446, 168.52346658706665, 169.66862034797668, 170.81377410888672, 171.9687476158142, 173.1237211227417, 174.26706314086914, 175.41040515899658, 176.55614924430847, 177.70189332962036, 178.84765720367432, 179.99342107772827, 181.1438546180725, 182.29428815841675, 183.44725847244263, 184.6002287864685, 185.75312042236328, 186.90601205825806, 188.05797791481018, 189.2099437713623, 190.35838985443115, 191.5068359375, 192.66183376312256, 193.81683158874512, 194.97626638412476, 196.1357011795044, 197.29520750045776, 198.45471382141113, 199.61778235435486, 200.78085088729858, 201.9355537891388, 203.090256690979, 204.24939441680908, 205.40853214263916, 206.56728291511536, 207.72603368759155, 208.88104009628296, 210.03604650497437, 211.18987607955933, 212.3437056541443, 213.4998013973236, 214.65589714050293, 215.79750156402588, 216.93910598754883, 218.08282470703125, 219.22654342651367, 220.37776613235474, 221.5289888381958, 222.6895787715912, 223.85016870498657, 225.0003969669342, 226.15062522888184, 227.2988784313202, 228.44713163375854, 229.59506940841675, 230.74300718307495, 233.03417658805847, 235.325345993042]
[23.48, 23.48, 33.38, 33.38, 40.84, 40.84, 44.27, 44.27, 47.21, 47.21, 46.94, 46.94, 48.23, 48.23, 52.04, 52.04, 54.22, 54.22, 54.27, 54.27, 54.9, 54.9, 55.29, 55.29, 55.86, 55.86, 56.93, 56.93, 57.83, 57.83, 58.22, 58.22, 57.42, 57.42, 57.03, 57.03, 57.19, 57.19, 57.04, 57.04, 58.03, 58.03, 58.68, 58.68, 59.08, 59.08, 59.54, 59.54, 59.6, 59.6, 59.1, 59.1, 59.15, 59.15, 59.35, 59.35, 59.68, 59.68, 60.13, 60.13, 60.26, 60.26, 60.46, 60.46, 60.04, 60.04, 60.39, 60.39, 60.89, 60.89, 61.1, 61.1, 60.18, 60.18, 59.89, 59.89, 59.96, 59.96, 59.79, 59.79, 60.93, 60.93, 60.29, 60.29, 60.81, 60.81, 60.62, 60.62, 60.07, 60.07, 59.78, 59.78, 59.65, 59.65, 60.12, 60.12, 60.31, 60.31, 59.86, 59.86, 59.39, 59.39, 59.09, 59.09, 59.81, 59.81, 60.18, 60.18, 60.89, 60.89, 61.08, 61.08, 60.8, 60.8, 60.7, 60.7, 60.75, 60.75, 60.53, 60.53, 60.44, 60.44, 60.48, 60.48, 59.68, 59.68, 60.39, 60.39, 61.03, 61.03, 61.09, 61.09, 60.67, 60.67, 60.44, 60.44, 61.1, 61.1, 60.88, 60.88, 60.82, 60.82, 60.53, 60.53, 60.59, 60.59, 60.53, 60.53, 60.97, 60.97, 60.98, 60.98, 60.87, 60.87, 60.78, 60.78, 60.48, 60.48, 60.68, 60.68, 60.95, 60.95, 61.06, 61.06, 61.21, 61.21, 61.03, 61.03, 60.9, 60.9, 60.76, 60.76, 60.62, 60.62, 59.76, 59.76, 60.61, 60.61, 60.22, 60.22, 60.16, 60.16, 59.97, 59.97, 60.15, 60.15, 60.62, 60.62, 60.96, 60.96, 61.0, 61.0, 61.52, 61.52, 61.5, 61.5, 60.97, 60.97, 60.94, 60.94, 61.52, 61.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.629, Test loss: 1.975, Test accuracy: 28.74
Round   0, Global train loss: 1.629, Global test loss: 2.183, Global test accuracy: 25.55
Round   1, Train loss: 1.452, Test loss: 1.755, Test accuracy: 33.59
Round   1, Global train loss: 1.452, Global test loss: 2.023, Global test accuracy: 27.85
Round   2, Train loss: 1.328, Test loss: 1.505, Test accuracy: 42.11
Round   2, Global train loss: 1.328, Global test loss: 1.941, Global test accuracy: 32.53
Round   3, Train loss: 1.212, Test loss: 1.350, Test accuracy: 47.65
Round   3, Global train loss: 1.212, Global test loss: 1.864, Global test accuracy: 36.69
Round   4, Train loss: 1.186, Test loss: 1.246, Test accuracy: 51.20
Round   4, Global train loss: 1.186, Global test loss: 1.701, Global test accuracy: 38.08
Round   5, Train loss: 1.100, Test loss: 1.208, Test accuracy: 51.89
Round   5, Global train loss: 1.100, Global test loss: 1.681, Global test accuracy: 39.45
Round   6, Train loss: 1.145, Test loss: 1.178, Test accuracy: 53.53
Round   6, Global train loss: 1.145, Global test loss: 1.692, Global test accuracy: 40.38
Round   7, Train loss: 1.061, Test loss: 1.077, Test accuracy: 57.14
Round   7, Global train loss: 1.061, Global test loss: 1.561, Global test accuracy: 44.60
Round   8, Train loss: 1.018, Test loss: 1.023, Test accuracy: 59.79
Round   8, Global train loss: 1.018, Global test loss: 1.488, Global test accuracy: 46.11
Round   9, Train loss: 1.020, Test loss: 0.988, Test accuracy: 61.29
Round   9, Global train loss: 1.020, Global test loss: 1.782, Global test accuracy: 44.20
Round  10, Train loss: 1.007, Test loss: 0.983, Test accuracy: 61.64
Round  10, Global train loss: 1.007, Global test loss: 1.569, Global test accuracy: 45.34
Round  11, Train loss: 0.979, Test loss: 0.960, Test accuracy: 62.44
Round  11, Global train loss: 0.979, Global test loss: 1.448, Global test accuracy: 47.84
Round  12, Train loss: 0.995, Test loss: 0.952, Test accuracy: 63.12
Round  12, Global train loss: 0.995, Global test loss: 1.455, Global test accuracy: 49.43
Round  13, Train loss: 0.921, Test loss: 0.952, Test accuracy: 63.26
Round  13, Global train loss: 0.921, Global test loss: 1.434, Global test accuracy: 49.72
Round  14, Train loss: 0.872, Test loss: 0.944, Test accuracy: 63.61
Round  14, Global train loss: 0.872, Global test loss: 1.454, Global test accuracy: 49.71
Round  15, Train loss: 0.921, Test loss: 0.927, Test accuracy: 64.61
Round  15, Global train loss: 0.921, Global test loss: 1.413, Global test accuracy: 50.78
Round  16, Train loss: 0.844, Test loss: 0.941, Test accuracy: 64.44
Round  16, Global train loss: 0.844, Global test loss: 1.461, Global test accuracy: 50.54
Round  17, Train loss: 0.893, Test loss: 0.926, Test accuracy: 64.87
Round  17, Global train loss: 0.893, Global test loss: 1.414, Global test accuracy: 51.32
Round  18, Train loss: 0.829, Test loss: 0.918, Test accuracy: 65.35
Round  18, Global train loss: 0.829, Global test loss: 1.568, Global test accuracy: 51.33
Round  19, Train loss: 0.866, Test loss: 0.906, Test accuracy: 65.34
Round  19, Global train loss: 0.866, Global test loss: 1.462, Global test accuracy: 46.91
Round  20, Train loss: 0.837, Test loss: 0.898, Test accuracy: 65.48
Round  20, Global train loss: 0.837, Global test loss: 1.312, Global test accuracy: 52.61
Round  21, Train loss: 0.763, Test loss: 0.887, Test accuracy: 66.24
Round  21, Global train loss: 0.763, Global test loss: 1.504, Global test accuracy: 48.26
Round  22, Train loss: 0.839, Test loss: 0.902, Test accuracy: 65.88
Round  22, Global train loss: 0.839, Global test loss: 1.279, Global test accuracy: 55.33
Round  23, Train loss: 0.721, Test loss: 0.905, Test accuracy: 66.25
Round  23, Global train loss: 0.721, Global test loss: 1.355, Global test accuracy: 52.40
Round  24, Train loss: 0.849, Test loss: 0.874, Test accuracy: 67.43
Round  24, Global train loss: 0.849, Global test loss: 1.391, Global test accuracy: 50.61
Round  25, Train loss: 0.722, Test loss: 0.871, Test accuracy: 67.74
Round  25, Global train loss: 0.722, Global test loss: 1.291, Global test accuracy: 55.66
Round  26, Train loss: 0.700, Test loss: 0.873, Test accuracy: 67.66
Round  26, Global train loss: 0.700, Global test loss: 1.224, Global test accuracy: 56.19
Round  27, Train loss: 0.667, Test loss: 0.844, Test accuracy: 68.69
Round  27, Global train loss: 0.667, Global test loss: 1.182, Global test accuracy: 57.66
Round  28, Train loss: 0.694, Test loss: 0.843, Test accuracy: 68.68
Round  28, Global train loss: 0.694, Global test loss: 1.330, Global test accuracy: 52.62
Round  29, Train loss: 0.609, Test loss: 0.846, Test accuracy: 68.71
Round  29, Global train loss: 0.609, Global test loss: 1.344, Global test accuracy: 53.59
Round  30, Train loss: 0.686, Test loss: 0.865, Test accuracy: 68.54
Round  30, Global train loss: 0.686, Global test loss: 1.499, Global test accuracy: 51.39
Round  31, Train loss: 0.680, Test loss: 0.839, Test accuracy: 69.41
Round  31, Global train loss: 0.680, Global test loss: 1.399, Global test accuracy: 51.77
Round  32, Train loss: 0.657, Test loss: 0.851, Test accuracy: 68.94
Round  32, Global train loss: 0.657, Global test loss: 1.294, Global test accuracy: 54.99
Round  33, Train loss: 0.706, Test loss: 0.857, Test accuracy: 69.10
Round  33, Global train loss: 0.706, Global test loss: 1.344, Global test accuracy: 54.53
Round  34, Train loss: 0.730, Test loss: 0.865, Test accuracy: 69.08
Round  34, Global train loss: 0.730, Global test loss: 1.585, Global test accuracy: 50.18
Round  35, Train loss: 0.596, Test loss: 0.864, Test accuracy: 69.55
Round  35, Global train loss: 0.596, Global test loss: 1.253, Global test accuracy: 59.17
Round  36, Train loss: 0.614, Test loss: 0.860, Test accuracy: 69.57
Round  36, Global train loss: 0.614, Global test loss: 1.371, Global test accuracy: 57.81
Round  37, Train loss: 0.691, Test loss: 0.894, Test accuracy: 68.58
Round  37, Global train loss: 0.691, Global test loss: 1.426, Global test accuracy: 52.99
Round  38, Train loss: 0.584, Test loss: 0.894, Test accuracy: 68.61
Round  38, Global train loss: 0.584, Global test loss: 1.137, Global test accuracy: 60.14
Round  39, Train loss: 0.677, Test loss: 0.879, Test accuracy: 69.24
Round  39, Global train loss: 0.677, Global test loss: 1.171, Global test accuracy: 59.30
Round  40, Train loss: 0.627, Test loss: 0.862, Test accuracy: 69.90
Round  40, Global train loss: 0.627, Global test loss: 1.186, Global test accuracy: 59.24
Round  41, Train loss: 0.554, Test loss: 0.847, Test accuracy: 70.51
Round  41, Global train loss: 0.554, Global test loss: 1.122, Global test accuracy: 61.38
Round  42, Train loss: 0.557, Test loss: 0.844, Test accuracy: 70.72
Round  42, Global train loss: 0.557, Global test loss: 1.203, Global test accuracy: 60.69
Round  43, Train loss: 0.554, Test loss: 0.842, Test accuracy: 71.26
Round  43, Global train loss: 0.554, Global test loss: 1.313, Global test accuracy: 56.43
Round  44, Train loss: 0.588, Test loss: 0.838, Test accuracy: 70.96
Round  44, Global train loss: 0.588, Global test loss: 1.342, Global test accuracy: 56.07
Round  45, Train loss: 0.573, Test loss: 0.855, Test accuracy: 70.23
Round  45, Global train loss: 0.573, Global test loss: 1.215, Global test accuracy: 60.64
Round  46, Train loss: 0.545, Test loss: 0.845, Test accuracy: 70.60
Round  46, Global train loss: 0.545, Global test loss: 1.298, Global test accuracy: 57.91
Round  47, Train loss: 0.547, Test loss: 0.838, Test accuracy: 70.84
Round  47, Global train loss: 0.547, Global test loss: 1.172, Global test accuracy: 60.42
Round  48, Train loss: 0.529, Test loss: 0.843, Test accuracy: 71.11
Round  48, Global train loss: 0.529, Global test loss: 1.225, Global test accuracy: 59.27
Round  49, Train loss: 0.491, Test loss: 0.839, Test accuracy: 71.28
Round  49, Global train loss: 0.491, Global test loss: 1.601, Global test accuracy: 54.34
Round  50, Train loss: 0.535, Test loss: 0.857, Test accuracy: 70.89
Round  50, Global train loss: 0.535, Global test loss: 1.308, Global test accuracy: 57.15
Round  51, Train loss: 0.461, Test loss: 0.866, Test accuracy: 70.93
Round  51, Global train loss: 0.461, Global test loss: 1.199, Global test accuracy: 60.82
Round  52, Train loss: 0.470, Test loss: 0.873, Test accuracy: 70.99
Round  52, Global train loss: 0.470, Global test loss: 1.254, Global test accuracy: 59.29
Round  53, Train loss: 0.483, Test loss: 0.874, Test accuracy: 70.87
Round  53, Global train loss: 0.483, Global test loss: 1.213, Global test accuracy: 61.09
Round  54, Train loss: 0.510, Test loss: 0.861, Test accuracy: 71.28
Round  54, Global train loss: 0.510, Global test loss: 1.281, Global test accuracy: 59.64
Round  55, Train loss: 0.487, Test loss: 0.893, Test accuracy: 70.81
Round  55, Global train loss: 0.487, Global test loss: 1.220, Global test accuracy: 60.75
Round  56, Train loss: 0.472, Test loss: 0.869, Test accuracy: 71.71
Round  56, Global train loss: 0.472, Global test loss: 1.112, Global test accuracy: 62.09
Round  57, Train loss: 0.501, Test loss: 0.867, Test accuracy: 71.90
Round  57, Global train loss: 0.501, Global test loss: 1.187, Global test accuracy: 60.71
Round  58, Train loss: 0.443, Test loss: 0.887, Test accuracy: 71.23
Round  58, Global train loss: 0.443, Global test loss: 1.138, Global test accuracy: 62.55
Round  59, Train loss: 0.493, Test loss: 0.871, Test accuracy: 72.31
Round  59, Global train loss: 0.493, Global test loss: 1.337, Global test accuracy: 58.99
Round  60, Train loss: 0.461, Test loss: 0.880, Test accuracy: 72.26
Round  60, Global train loss: 0.461, Global test loss: 1.109, Global test accuracy: 63.55
Round  61, Train loss: 0.417, Test loss: 0.871, Test accuracy: 72.77
Round  61, Global train loss: 0.417, Global test loss: 1.161, Global test accuracy: 62.55
Round  62, Train loss: 0.451, Test loss: 0.851, Test accuracy: 73.41
Round  62, Global train loss: 0.451, Global test loss: 1.147, Global test accuracy: 62.76
Round  63, Train loss: 0.385, Test loss: 0.848, Test accuracy: 73.39
Round  63, Global train loss: 0.385, Global test loss: 1.238, Global test accuracy: 62.02
Round  64, Train loss: 0.510, Test loss: 0.842, Test accuracy: 73.79
Round  64, Global train loss: 0.510, Global test loss: 1.323, Global test accuracy: 58.86
Round  65, Train loss: 0.419, Test loss: 0.840, Test accuracy: 73.57
Round  65, Global train loss: 0.419, Global test loss: 1.188, Global test accuracy: 62.63
Round  66, Train loss: 0.406, Test loss: 0.834, Test accuracy: 73.76
Round  66, Global train loss: 0.406, Global test loss: 1.205, Global test accuracy: 62.96
Round  67, Train loss: 0.408, Test loss: 0.849, Test accuracy: 73.08
Round  67, Global train loss: 0.408, Global test loss: 1.270, Global test accuracy: 60.49
Round  68, Train loss: 0.374, Test loss: 0.851, Test accuracy: 73.78
Round  68, Global train loss: 0.374, Global test loss: 1.235, Global test accuracy: 62.47
Round  69, Train loss: 0.414, Test loss: 0.849, Test accuracy: 73.56
Round  69, Global train loss: 0.414, Global test loss: 1.166, Global test accuracy: 62.66
Round  70, Train loss: 0.399, Test loss: 0.882, Test accuracy: 72.75
Round  70, Global train loss: 0.399, Global test loss: 1.257, Global test accuracy: 61.72
Round  71, Train loss: 0.431, Test loss: 0.890, Test accuracy: 73.01
Round  71, Global train loss: 0.431, Global test loss: 1.380, Global test accuracy: 58.87
Round  72, Train loss: 0.478, Test loss: 0.883, Test accuracy: 72.68
Round  72, Global train loss: 0.478, Global test loss: 1.239, Global test accuracy: 61.24
Round  73, Train loss: 0.371, Test loss: 0.895, Test accuracy: 72.78
Round  73, Global train loss: 0.371, Global test loss: 1.206, Global test accuracy: 62.96
Round  74, Train loss: 0.397, Test loss: 0.890, Test accuracy: 72.91
Round  74, Global train loss: 0.397, Global test loss: 1.177, Global test accuracy: 62.75
Round  75, Train loss: 0.326, Test loss: 0.872, Test accuracy: 73.02
Round  75, Global train loss: 0.326, Global test loss: 1.191, Global test accuracy: 62.85
Round  76, Train loss: 0.295, Test loss: 0.866, Test accuracy: 73.32
Round  76, Global train loss: 0.295, Global test loss: 1.320, Global test accuracy: 60.74
Round  77, Train loss: 0.390, Test loss: 0.885, Test accuracy: 73.53
Round  77, Global train loss: 0.390, Global test loss: 1.166, Global test accuracy: 64.03
Round  78, Train loss: 0.388, Test loss: 0.884, Test accuracy: 73.54
Round  78, Global train loss: 0.388, Global test loss: 1.208, Global test accuracy: 62.48
Round  79, Train loss: 0.350, Test loss: 0.891, Test accuracy: 73.37
Round  79, Global train loss: 0.350, Global test loss: 1.260, Global test accuracy: 62.36
Round  80, Train loss: 0.418, Test loss: 0.896, Test accuracy: 73.04
Round  80, Global train loss: 0.418, Global test loss: 1.197, Global test accuracy: 63.01
Round  81, Train loss: 0.393, Test loss: 0.909, Test accuracy: 72.57
Round  81, Global train loss: 0.393, Global test loss: 1.267, Global test accuracy: 62.77
Round  82, Train loss: 0.338, Test loss: 0.911, Test accuracy: 72.82
Round  82, Global train loss: 0.338, Global test loss: 1.316, Global test accuracy: 62.28
Round  83, Train loss: 0.408, Test loss: 0.913, Test accuracy: 72.67
Round  83, Global train loss: 0.408, Global test loss: 1.305, Global test accuracy: 61.15
Round  84, Train loss: 0.394, Test loss: 0.900, Test accuracy: 73.31
Round  84, Global train loss: 0.394, Global test loss: 1.328, Global test accuracy: 61.80
Round  85, Train loss: 0.305, Test loss: 0.925, Test accuracy: 72.91
Round  85, Global train loss: 0.305, Global test loss: 1.261, Global test accuracy: 64.49
Round  86, Train loss: 0.349, Test loss: 0.931, Test accuracy: 72.91
Round  86, Global train loss: 0.349, Global test loss: 1.291, Global test accuracy: 63.16
Round  87, Train loss: 0.320, Test loss: 0.913, Test accuracy: 73.41
Round  87, Global train loss: 0.320, Global test loss: 1.215, Global test accuracy: 64.10
Round  88, Train loss: 0.345, Test loss: 0.927, Test accuracy: 72.86
Round  88, Global train loss: 0.345, Global test loss: 1.324, Global test accuracy: 61.31
Round  89, Train loss: 0.319, Test loss: 0.922, Test accuracy: 72.99
Round  89, Global train loss: 0.319, Global test loss: 1.203, Global test accuracy: 64.65
Round  90, Train loss: 0.400, Test loss: 0.926, Test accuracy: 73.01
Round  90, Global train loss: 0.400, Global test loss: 1.263, Global test accuracy: 62.01
Round  91, Train loss: 0.362, Test loss: 0.917, Test accuracy: 73.42
Round  91, Global train loss: 0.362, Global test loss: 1.449, Global test accuracy: 60.43
Round  92, Train loss: 0.341, Test loss: 0.926, Test accuracy: 73.43
Round  92, Global train loss: 0.341, Global test loss: 1.127, Global test accuracy: 64.83
Round  93, Train loss: 0.315, Test loss: 0.918, Test accuracy: 73.59
Round  93, Global train loss: 0.315, Global test loss: 1.217, Global test accuracy: 63.84
Round  94, Train loss: 0.329, Test loss: 0.935, Test accuracy: 73.44
Round  94, Global train loss: 0.329, Global test loss: 1.362, Global test accuracy: 61.68
Round  95, Train loss: 0.364, Test loss: 0.929, Test accuracy: 73.82
Round  95, Global train loss: 0.364, Global test loss: 1.485, Global test accuracy: 58.90
Round  96, Train loss: 0.385, Test loss: 0.922, Test accuracy: 73.74
Round  96, Global train loss: 0.385, Global test loss: 1.317, Global test accuracy: 61.71
Round  97, Train loss: 0.361, Test loss: 0.904, Test accuracy: 73.96
Round  97, Global train loss: 0.361, Global test loss: 1.281, Global test accuracy: 62.33
Round  98, Train loss: 0.298, Test loss: 0.916, Test accuracy: 73.68
Round  98, Global train loss: 0.298, Global test loss: 1.205, Global test accuracy: 64.15
Round  99, Train loss: 0.316, Test loss: 0.932, Test accuracy: 73.46
Round  99, Global train loss: 0.316, Global test loss: 1.346, Global test accuracy: 61.79
Final Round, Train loss: 0.259, Test loss: 1.025, Test accuracy: 73.66
Final Round, Global train loss: 0.259, Global test loss: 1.346, Global test accuracy: 61.79
Average accuracy final 10 rounds: 73.555 

Average global accuracy final 10 rounds: 62.166999999999994 

1405.0809619426727
[1.3554670810699463, 2.7109341621398926, 3.869279384613037, 5.027624607086182, 6.179906368255615, 7.332188129425049, 8.483940839767456, 9.635693550109863, 10.806787729263306, 11.977881908416748, 13.142953634262085, 14.308025360107422, 15.463753461837769, 16.619481563568115, 17.767767667770386, 18.916053771972656, 20.06601119041443, 21.2159686088562, 22.366007328033447, 23.516046047210693, 24.6683349609375, 25.820623874664307, 26.972904682159424, 28.12518548965454, 29.276304960250854, 30.427424430847168, 31.590476989746094, 32.75352954864502, 33.903268814086914, 35.05300807952881, 36.20351719856262, 37.354026317596436, 38.50861477851868, 39.66320323944092, 40.81628751754761, 41.9693717956543, 43.12182402610779, 44.27427625656128, 45.42758750915527, 46.58089876174927, 47.733673095703125, 48.88644742965698, 50.03773856163025, 51.189029693603516, 52.34343910217285, 53.49784851074219, 54.654956102371216, 55.812063694000244, 56.95883131027222, 58.10559892654419, 59.250513315200806, 60.39542770385742, 61.53544282913208, 62.67545795440674, 63.81727433204651, 64.95909070968628, 66.09423685073853, 67.22938299179077, 68.37556576728821, 69.52174854278564, 70.66260576248169, 71.80346298217773, 72.93864727020264, 74.07383155822754, 75.21170949935913, 76.34958744049072, 77.48949599266052, 78.62940454483032, 79.7736086845398, 80.91781282424927, 82.06821012496948, 83.2186074256897, 84.36102151870728, 85.50343561172485, 86.64760279655457, 87.79176998138428, 88.93850064277649, 90.0852313041687, 91.22539234161377, 92.36555337905884, 93.51382398605347, 94.6620945930481, 95.80213260650635, 96.9421706199646, 98.0852472782135, 99.2283239364624, 100.37417602539062, 101.52002811431885, 102.65727710723877, 103.79452610015869, 104.93510460853577, 106.07568311691284, 107.22471046447754, 108.37373781204224, 109.5124659538269, 110.65119409561157, 111.79129266738892, 112.93139123916626, 114.07655501365662, 115.22171878814697, 116.37142395973206, 117.52112913131714, 118.65666937828064, 119.79220962524414, 120.93044376373291, 122.06867790222168, 123.21472978591919, 124.3607816696167, 125.50811624526978, 126.65545082092285, 127.79870820045471, 128.94196557998657, 130.07765102386475, 131.21333646774292, 132.34652948379517, 133.4797224998474, 134.62491059303284, 135.77009868621826, 136.91772198677063, 138.065345287323, 139.20687174797058, 140.34839820861816, 141.4837143421173, 142.61903047561646, 143.76289629936218, 144.9067621231079, 146.04528880119324, 147.18381547927856, 148.3209593296051, 149.45810317993164, 150.60177946090698, 151.74545574188232, 152.8879041671753, 154.03035259246826, 155.1820158958435, 156.33367919921875, 157.47614121437073, 158.6186032295227, 159.76080870628357, 160.90301418304443, 162.04348516464233, 163.18395614624023, 164.3227550983429, 165.46155405044556, 166.60586810112, 167.75018215179443, 168.89459776878357, 170.0390133857727, 171.1763927936554, 172.3137722015381, 173.45411038398743, 174.59444856643677, 175.74029231071472, 176.88613605499268, 178.0254843235016, 179.1648325920105, 180.3008325099945, 181.43683242797852, 182.57116770744324, 183.70550298690796, 184.83992862701416, 185.97435426712036, 187.11661386489868, 188.258873462677, 189.39846849441528, 190.53806352615356, 191.67589330673218, 192.8137230873108, 193.95019054412842, 195.08665800094604, 196.22304034233093, 197.35942268371582, 198.49054074287415, 199.62165880203247, 200.7525281906128, 201.88339757919312, 203.01089453697205, 204.13839149475098, 205.2692358493805, 206.40008020401, 207.53130912780762, 208.66253805160522, 209.7991328239441, 210.93572759628296, 212.07123064994812, 213.20673370361328, 214.3514440059662, 215.4961543083191, 216.64326310157776, 217.79037189483643, 218.940171957016, 220.08997201919556, 221.22771954536438, 222.3654670715332, 223.50690412521362, 224.64834117889404, 225.79668974876404, 226.94503831863403, 228.08181643486023, 229.21859455108643, 231.50833082199097, 233.7980670928955]
[28.74, 28.74, 33.59, 33.59, 42.11, 42.11, 47.65, 47.65, 51.2, 51.2, 51.89, 51.89, 53.53, 53.53, 57.14, 57.14, 59.79, 59.79, 61.29, 61.29, 61.64, 61.64, 62.44, 62.44, 63.12, 63.12, 63.26, 63.26, 63.61, 63.61, 64.61, 64.61, 64.44, 64.44, 64.87, 64.87, 65.35, 65.35, 65.34, 65.34, 65.48, 65.48, 66.24, 66.24, 65.88, 65.88, 66.25, 66.25, 67.43, 67.43, 67.74, 67.74, 67.66, 67.66, 68.69, 68.69, 68.68, 68.68, 68.71, 68.71, 68.54, 68.54, 69.41, 69.41, 68.94, 68.94, 69.1, 69.1, 69.08, 69.08, 69.55, 69.55, 69.57, 69.57, 68.58, 68.58, 68.61, 68.61, 69.24, 69.24, 69.9, 69.9, 70.51, 70.51, 70.72, 70.72, 71.26, 71.26, 70.96, 70.96, 70.23, 70.23, 70.6, 70.6, 70.84, 70.84, 71.11, 71.11, 71.28, 71.28, 70.89, 70.89, 70.93, 70.93, 70.99, 70.99, 70.87, 70.87, 71.28, 71.28, 70.81, 70.81, 71.71, 71.71, 71.9, 71.9, 71.23, 71.23, 72.31, 72.31, 72.26, 72.26, 72.77, 72.77, 73.41, 73.41, 73.39, 73.39, 73.79, 73.79, 73.57, 73.57, 73.76, 73.76, 73.08, 73.08, 73.78, 73.78, 73.56, 73.56, 72.75, 72.75, 73.01, 73.01, 72.68, 72.68, 72.78, 72.78, 72.91, 72.91, 73.02, 73.02, 73.32, 73.32, 73.53, 73.53, 73.54, 73.54, 73.37, 73.37, 73.04, 73.04, 72.57, 72.57, 72.82, 72.82, 72.67, 72.67, 73.31, 73.31, 72.91, 72.91, 72.91, 72.91, 73.41, 73.41, 72.86, 72.86, 72.99, 72.99, 73.01, 73.01, 73.42, 73.42, 73.43, 73.43, 73.59, 73.59, 73.44, 73.44, 73.82, 73.82, 73.74, 73.74, 73.96, 73.96, 73.68, 73.68, 73.46, 73.46, 73.66, 73.66]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 19, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.611, Test loss: 2.018, Test accuracy: 27.69
Round   0, Global train loss: 1.611, Global test loss: 2.233, Global test accuracy: 24.38
Round   1, Train loss: 1.528, Test loss: 1.843, Test accuracy: 34.49
Round   1, Global train loss: 1.528, Global test loss: 2.124, Global test accuracy: 30.92
Round   2, Train loss: 1.338, Test loss: 1.565, Test accuracy: 39.74
Round   2, Global train loss: 1.338, Global test loss: 2.034, Global test accuracy: 29.06
Round   3, Train loss: 1.331, Test loss: 1.397, Test accuracy: 44.52
Round   3, Global train loss: 1.331, Global test loss: 1.950, Global test accuracy: 30.41
Round   4, Train loss: 1.218, Test loss: 1.310, Test accuracy: 47.77
Round   4, Global train loss: 1.218, Global test loss: 1.751, Global test accuracy: 36.50
Round   5, Train loss: 1.165, Test loss: 1.256, Test accuracy: 49.13
Round   5, Global train loss: 1.165, Global test loss: 1.703, Global test accuracy: 38.06
Round   6, Train loss: 1.121, Test loss: 1.223, Test accuracy: 51.53
Round   6, Global train loss: 1.121, Global test loss: 1.770, Global test accuracy: 39.05
Round   7, Train loss: 1.089, Test loss: 1.140, Test accuracy: 54.69
Round   7, Global train loss: 1.089, Global test loss: 1.628, Global test accuracy: 41.88
Round   8, Train loss: 1.101, Test loss: 1.094, Test accuracy: 56.89
Round   8, Global train loss: 1.101, Global test loss: 1.530, Global test accuracy: 46.42
Round   9, Train loss: 1.122, Test loss: 1.079, Test accuracy: 58.32
Round   9, Global train loss: 1.122, Global test loss: 1.767, Global test accuracy: 40.85
Round  10, Train loss: 1.032, Test loss: 1.047, Test accuracy: 59.49
Round  10, Global train loss: 1.032, Global test loss: 1.583, Global test accuracy: 45.68
Round  11, Train loss: 1.038, Test loss: 1.033, Test accuracy: 59.83
Round  11, Global train loss: 1.038, Global test loss: 1.489, Global test accuracy: 46.04
Round  12, Train loss: 0.989, Test loss: 0.999, Test accuracy: 61.23
Round  12, Global train loss: 0.989, Global test loss: 1.497, Global test accuracy: 47.40
Round  13, Train loss: 1.029, Test loss: 0.970, Test accuracy: 62.46
Round  13, Global train loss: 1.029, Global test loss: 1.473, Global test accuracy: 47.71
Round  14, Train loss: 1.000, Test loss: 0.971, Test accuracy: 62.74
Round  14, Global train loss: 1.000, Global test loss: 1.508, Global test accuracy: 47.30
Round  15, Train loss: 0.904, Test loss: 0.954, Test accuracy: 63.28
Round  15, Global train loss: 0.904, Global test loss: 1.460, Global test accuracy: 48.63
Round  16, Train loss: 0.969, Test loss: 0.965, Test accuracy: 62.87
Round  16, Global train loss: 0.969, Global test loss: 1.433, Global test accuracy: 51.03
Round  17, Train loss: 1.005, Test loss: 0.961, Test accuracy: 63.20
Round  17, Global train loss: 1.005, Global test loss: 1.432, Global test accuracy: 50.01
Round  18, Train loss: 0.973, Test loss: 0.947, Test accuracy: 63.45
Round  18, Global train loss: 0.973, Global test loss: 1.611, Global test accuracy: 48.95
Round  19, Train loss: 1.008, Test loss: 0.936, Test accuracy: 63.81
Round  19, Global train loss: 1.008, Global test loss: 1.543, Global test accuracy: 43.87
Round  20, Train loss: 0.936, Test loss: 0.931, Test accuracy: 64.72
Round  20, Global train loss: 0.936, Global test loss: 1.361, Global test accuracy: 51.07
Round  21, Train loss: 0.805, Test loss: 0.905, Test accuracy: 65.53
Round  21, Global train loss: 0.805, Global test loss: 1.494, Global test accuracy: 48.00
Round  22, Train loss: 0.844, Test loss: 0.892, Test accuracy: 66.01
Round  22, Global train loss: 0.844, Global test loss: 1.325, Global test accuracy: 53.16
Round  23, Train loss: 0.761, Test loss: 0.876, Test accuracy: 66.79
Round  23, Global train loss: 0.761, Global test loss: 1.378, Global test accuracy: 51.12
Round  24, Train loss: 0.835, Test loss: 0.880, Test accuracy: 66.61
Round  24, Global train loss: 0.835, Global test loss: 1.355, Global test accuracy: 52.28
Round  25, Train loss: 0.800, Test loss: 0.874, Test accuracy: 66.67
Round  25, Global train loss: 0.800, Global test loss: 1.249, Global test accuracy: 57.36
Round  26, Train loss: 0.817, Test loss: 0.869, Test accuracy: 67.18
Round  26, Global train loss: 0.817, Global test loss: 1.191, Global test accuracy: 57.27
Round  27, Train loss: 0.717, Test loss: 0.838, Test accuracy: 68.59
Round  27, Global train loss: 0.717, Global test loss: 1.177, Global test accuracy: 57.59
Round  28, Train loss: 0.785, Test loss: 0.836, Test accuracy: 68.27
Round  28, Global train loss: 0.785, Global test loss: 1.304, Global test accuracy: 53.76
Round  29, Train loss: 0.723, Test loss: 0.840, Test accuracy: 68.31
Round  29, Global train loss: 0.723, Global test loss: 1.309, Global test accuracy: 53.87
Round  30, Train loss: 0.734, Test loss: 0.842, Test accuracy: 68.78
Round  30, Global train loss: 0.734, Global test loss: 1.395, Global test accuracy: 52.59
Round  31, Train loss: 0.786, Test loss: 0.835, Test accuracy: 68.78
Round  31, Global train loss: 0.786, Global test loss: 1.318, Global test accuracy: 53.13
Round  32, Train loss: 0.739, Test loss: 0.837, Test accuracy: 69.15
Round  32, Global train loss: 0.739, Global test loss: 1.324, Global test accuracy: 54.22
Round  33, Train loss: 0.786, Test loss: 0.832, Test accuracy: 69.51
Round  33, Global train loss: 0.786, Global test loss: 1.313, Global test accuracy: 54.04
Round  34, Train loss: 0.763, Test loss: 0.824, Test accuracy: 69.57
Round  34, Global train loss: 0.763, Global test loss: 1.418, Global test accuracy: 51.08
Round  35, Train loss: 0.768, Test loss: 0.824, Test accuracy: 69.96
Round  35, Global train loss: 0.768, Global test loss: 1.247, Global test accuracy: 56.88
Round  36, Train loss: 0.659, Test loss: 0.830, Test accuracy: 69.48
Round  36, Global train loss: 0.659, Global test loss: 1.327, Global test accuracy: 57.12
Round  37, Train loss: 0.788, Test loss: 0.827, Test accuracy: 69.55
Round  37, Global train loss: 0.788, Global test loss: 1.289, Global test accuracy: 54.68
Round  38, Train loss: 0.637, Test loss: 0.808, Test accuracy: 70.39
Round  38, Global train loss: 0.637, Global test loss: 1.107, Global test accuracy: 61.07
Round  39, Train loss: 0.785, Test loss: 0.797, Test accuracy: 71.23
Round  39, Global train loss: 0.785, Global test loss: 1.198, Global test accuracy: 57.69
Round  40, Train loss: 0.644, Test loss: 0.795, Test accuracy: 71.22
Round  40, Global train loss: 0.644, Global test loss: 1.134, Global test accuracy: 60.28
Round  41, Train loss: 0.695, Test loss: 0.791, Test accuracy: 71.24
Round  41, Global train loss: 0.695, Global test loss: 1.115, Global test accuracy: 61.25
Round  42, Train loss: 0.665, Test loss: 0.796, Test accuracy: 71.24
Round  42, Global train loss: 0.665, Global test loss: 1.152, Global test accuracy: 60.26
Round  43, Train loss: 0.610, Test loss: 0.804, Test accuracy: 71.12
Round  43, Global train loss: 0.610, Global test loss: 1.219, Global test accuracy: 57.80
Round  44, Train loss: 0.674, Test loss: 0.807, Test accuracy: 71.29
Round  44, Global train loss: 0.674, Global test loss: 1.265, Global test accuracy: 56.12
Round  45, Train loss: 0.622, Test loss: 0.832, Test accuracy: 70.67
Round  45, Global train loss: 0.622, Global test loss: 1.188, Global test accuracy: 60.33
Round  46, Train loss: 0.669, Test loss: 0.857, Test accuracy: 70.09
Round  46, Global train loss: 0.669, Global test loss: 1.275, Global test accuracy: 56.93
Round  47, Train loss: 0.660, Test loss: 0.856, Test accuracy: 69.89
Round  47, Global train loss: 0.660, Global test loss: 1.150, Global test accuracy: 59.65
Round  48, Train loss: 0.588, Test loss: 0.853, Test accuracy: 69.88
Round  48, Global train loss: 0.588, Global test loss: 1.143, Global test accuracy: 60.07
Round  49, Train loss: 0.594, Test loss: 0.847, Test accuracy: 70.13
Round  49, Global train loss: 0.594, Global test loss: 1.537, Global test accuracy: 53.56
Round  50, Train loss: 0.716, Test loss: 0.851, Test accuracy: 70.49
Round  50, Global train loss: 0.716, Global test loss: 1.129, Global test accuracy: 60.21
Round  51, Train loss: 0.572, Test loss: 0.837, Test accuracy: 71.13
Round  51, Global train loss: 0.572, Global test loss: 1.180, Global test accuracy: 60.31
Round  52, Train loss: 0.557, Test loss: 0.838, Test accuracy: 71.32
Round  52, Global train loss: 0.557, Global test loss: 1.214, Global test accuracy: 58.90
Round  53, Train loss: 0.530, Test loss: 0.833, Test accuracy: 71.47
Round  53, Global train loss: 0.530, Global test loss: 1.194, Global test accuracy: 60.61
Round  54, Train loss: 0.511, Test loss: 0.815, Test accuracy: 71.92
Round  54, Global train loss: 0.511, Global test loss: 1.177, Global test accuracy: 61.09
Round  55, Train loss: 0.559, Test loss: 0.814, Test accuracy: 72.62
Round  55, Global train loss: 0.559, Global test loss: 1.249, Global test accuracy: 59.04
Round  56, Train loss: 0.589, Test loss: 0.795, Test accuracy: 72.78
Round  56, Global train loss: 0.589, Global test loss: 1.163, Global test accuracy: 60.30
Round  57, Train loss: 0.532, Test loss: 0.807, Test accuracy: 72.34
Round  57, Global train loss: 0.532, Global test loss: 1.084, Global test accuracy: 62.65
Round  58, Train loss: 0.632, Test loss: 0.777, Test accuracy: 73.09
Round  58, Global train loss: 0.632, Global test loss: 1.049, Global test accuracy: 63.80
Round  59, Train loss: 0.534, Test loss: 0.817, Test accuracy: 72.24
Round  59, Global train loss: 0.534, Global test loss: 1.272, Global test accuracy: 58.77
Round  60, Train loss: 0.530, Test loss: 0.793, Test accuracy: 72.87
Round  60, Global train loss: 0.530, Global test loss: 1.056, Global test accuracy: 64.04
Round  61, Train loss: 0.452, Test loss: 0.796, Test accuracy: 73.27
Round  61, Global train loss: 0.452, Global test loss: 1.135, Global test accuracy: 61.63
Round  62, Train loss: 0.539, Test loss: 0.789, Test accuracy: 73.19
Round  62, Global train loss: 0.539, Global test loss: 1.078, Global test accuracy: 63.45
Round  63, Train loss: 0.418, Test loss: 0.802, Test accuracy: 72.96
Round  63, Global train loss: 0.418, Global test loss: 1.113, Global test accuracy: 63.46
Round  64, Train loss: 0.641, Test loss: 0.810, Test accuracy: 72.91
Round  64, Global train loss: 0.641, Global test loss: 1.194, Global test accuracy: 60.31
Round  65, Train loss: 0.514, Test loss: 0.792, Test accuracy: 73.13
Round  65, Global train loss: 0.514, Global test loss: 1.095, Global test accuracy: 63.03
Round  66, Train loss: 0.530, Test loss: 0.785, Test accuracy: 73.23
Round  66, Global train loss: 0.530, Global test loss: 1.066, Global test accuracy: 64.22
Round  67, Train loss: 0.491, Test loss: 0.793, Test accuracy: 73.44
Round  67, Global train loss: 0.491, Global test loss: 1.200, Global test accuracy: 60.57
Round  68, Train loss: 0.497, Test loss: 0.806, Test accuracy: 72.99
Round  68, Global train loss: 0.497, Global test loss: 1.134, Global test accuracy: 62.35
Round  69, Train loss: 0.480, Test loss: 0.813, Test accuracy: 72.91
Round  69, Global train loss: 0.480, Global test loss: 1.135, Global test accuracy: 62.18
Round  70, Train loss: 0.456, Test loss: 0.798, Test accuracy: 73.50
Round  70, Global train loss: 0.456, Global test loss: 1.193, Global test accuracy: 60.74
Round  71, Train loss: 0.529, Test loss: 0.794, Test accuracy: 73.37
Round  71, Global train loss: 0.529, Global test loss: 1.219, Global test accuracy: 59.31
Round  72, Train loss: 0.568, Test loss: 0.794, Test accuracy: 73.73
Round  72, Global train loss: 0.568, Global test loss: 1.125, Global test accuracy: 62.00
Round  73, Train loss: 0.463, Test loss: 0.798, Test accuracy: 73.92
Round  73, Global train loss: 0.463, Global test loss: 1.120, Global test accuracy: 63.16
Round  74, Train loss: 0.428, Test loss: 0.791, Test accuracy: 74.24
Round  74, Global train loss: 0.428, Global test loss: 1.117, Global test accuracy: 62.33
Round  75, Train loss: 0.418, Test loss: 0.802, Test accuracy: 74.01
Round  75, Global train loss: 0.418, Global test loss: 1.154, Global test accuracy: 62.17
Round  76, Train loss: 0.402, Test loss: 0.802, Test accuracy: 73.72
Round  76, Global train loss: 0.402, Global test loss: 1.300, Global test accuracy: 60.15
Round  77, Train loss: 0.485, Test loss: 0.811, Test accuracy: 73.52
Round  77, Global train loss: 0.485, Global test loss: 1.120, Global test accuracy: 63.10
Round  78, Train loss: 0.462, Test loss: 0.814, Test accuracy: 73.53
Round  78, Global train loss: 0.462, Global test loss: 1.165, Global test accuracy: 62.34
Round  79, Train loss: 0.427, Test loss: 0.812, Test accuracy: 73.51
Round  79, Global train loss: 0.427, Global test loss: 1.169, Global test accuracy: 62.85
Round  80, Train loss: 0.418, Test loss: 0.805, Test accuracy: 73.88
Round  80, Global train loss: 0.418, Global test loss: 1.116, Global test accuracy: 64.60
Round  81, Train loss: 0.485, Test loss: 0.816, Test accuracy: 73.50
Round  81, Global train loss: 0.485, Global test loss: 1.218, Global test accuracy: 61.71
Round  82, Train loss: 0.363, Test loss: 0.843, Test accuracy: 72.98
Round  82, Global train loss: 0.363, Global test loss: 1.205, Global test accuracy: 62.12
Round  83, Train loss: 0.504, Test loss: 0.835, Test accuracy: 73.52
Round  83, Global train loss: 0.504, Global test loss: 1.202, Global test accuracy: 62.23
Round  84, Train loss: 0.441, Test loss: 0.830, Test accuracy: 73.85
Round  84, Global train loss: 0.441, Global test loss: 1.229, Global test accuracy: 62.04
Round  85, Train loss: 0.392, Test loss: 0.833, Test accuracy: 73.39
Round  85, Global train loss: 0.392, Global test loss: 1.176, Global test accuracy: 63.74
Round  86, Train loss: 0.393, Test loss: 0.822, Test accuracy: 73.89
Round  86, Global train loss: 0.393, Global test loss: 1.188, Global test accuracy: 62.40
Round  87, Train loss: 0.349, Test loss: 0.847, Test accuracy: 73.17
Round  87, Global train loss: 0.349, Global test loss: 1.125, Global test accuracy: 64.28
Round  88, Train loss: 0.470, Test loss: 0.863, Test accuracy: 72.92
Round  88, Global train loss: 0.470, Global test loss: 1.202, Global test accuracy: 61.96
Round  89, Train loss: 0.437, Test loss: 0.865, Test accuracy: 73.00
Round  89, Global train loss: 0.437, Global test loss: 1.092, Global test accuracy: 64.99
Round  90, Train loss: 0.451, Test loss: 0.864, Test accuracy: 72.94
Round  90, Global train loss: 0.451, Global test loss: 1.125, Global test accuracy: 63.24
Round  91, Train loss: 0.459, Test loss: 0.850, Test accuracy: 73.38
Round  91, Global train loss: 0.459, Global test loss: 1.323, Global test accuracy: 60.44
Round  92, Train loss: 0.399, Test loss: 0.852, Test accuracy: 72.99
Round  92, Global train loss: 0.399, Global test loss: 1.096, Global test accuracy: 64.04
Round  93, Train loss: 0.415, Test loss: 0.836, Test accuracy: 73.57
Round  93, Global train loss: 0.415, Global test loss: 1.100, Global test accuracy: 65.29
Round  94, Train loss: 0.397, Test loss: 0.832, Test accuracy: 73.73
Round  94, Global train loss: 0.397, Global test loss: 1.304, Global test accuracy: 59.89/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.457, Test loss: 0.857, Test accuracy: 73.39
Round  95, Global train loss: 0.457, Global test loss: 1.304, Global test accuracy: 59.86
Round  96, Train loss: 0.456, Test loss: 0.843, Test accuracy: 73.79
Round  96, Global train loss: 0.456, Global test loss: 1.201, Global test accuracy: 62.46
Round  97, Train loss: 0.411, Test loss: 0.845, Test accuracy: 73.91
Round  97, Global train loss: 0.411, Global test loss: 1.143, Global test accuracy: 63.34
Round  98, Train loss: 0.429, Test loss: 0.836, Test accuracy: 74.52
Round  98, Global train loss: 0.429, Global test loss: 1.164, Global test accuracy: 63.20
Round  99, Train loss: 0.383, Test loss: 0.849, Test accuracy: 74.17
Round  99, Global train loss: 0.383, Global test loss: 1.249, Global test accuracy: 62.28
Final Round, Train loss: 0.315, Test loss: 0.958, Test accuracy: 73.25
Final Round, Global train loss: 0.315, Global test loss: 1.249, Global test accuracy: 62.28
Average accuracy final 10 rounds: 73.639 

Average global accuracy final 10 rounds: 62.404 

1409.8322808742523
[1.464667558670044, 2.929335117340088, 4.135811805725098, 5.342288494110107, 6.549422740936279, 7.756556987762451, 8.972485303878784, 10.188413619995117, 11.395829677581787, 12.603245735168457, 13.814289331436157, 15.025332927703857, 16.22744846343994, 17.429563999176025, 18.645823001861572, 19.86208200454712, 21.075393199920654, 22.28870439529419, 23.501915454864502, 24.715126514434814, 25.928198099136353, 27.14126968383789, 28.353519678115845, 29.5657696723938, 30.777976274490356, 31.990182876586914, 33.205305337905884, 34.42042779922485, 35.63404297828674, 36.84765815734863, 38.05758261680603, 39.26750707626343, 40.47914671897888, 41.690786361694336, 42.899540185928345, 44.10829401016235, 45.32198095321655, 46.53566789627075, 47.743735551834106, 48.95180320739746, 50.164682149887085, 51.37756109237671, 52.58700680732727, 53.79645252227783, 55.0013210773468, 56.20618963241577, 57.41073751449585, 58.61528539657593, 59.827253341674805, 61.03922128677368, 62.24350380897522, 63.44778633117676, 64.65688371658325, 65.86598110198975, 67.06764340400696, 68.26930570602417, 69.473219871521, 70.67713403701782, 71.87985563278198, 73.08257722854614, 74.29540061950684, 75.50822401046753, 76.71866273880005, 77.92910146713257, 79.14938378334045, 80.36966609954834, 81.57834577560425, 82.78702545166016, 84.00025606155396, 85.21348667144775, 86.4160225391388, 87.61855840682983, 88.81997656822205, 90.02139472961426, 91.2286467552185, 92.43589878082275, 93.63578581809998, 94.8356728553772, 96.04049730300903, 97.24532175064087, 98.45478463172913, 99.66424751281738, 100.8790671825409, 102.0938868522644, 103.29548907279968, 104.49709129333496, 105.70410418510437, 106.91111707687378, 108.12694215774536, 109.34276723861694, 110.5511622428894, 111.75955724716187, 112.97365880012512, 114.18776035308838, 115.39717602729797, 116.60659170150757, 117.8128137588501, 119.01903581619263, 120.2249927520752, 121.43094968795776, 122.63131046295166, 123.83167123794556, 125.03388094902039, 126.23609066009521, 127.4430570602417, 128.65002346038818, 129.86149048805237, 131.07295751571655, 132.2812316417694, 133.48950576782227, 134.55397653579712, 135.61844730377197, 136.68057894706726, 137.74271059036255, 138.81064629554749, 139.87858200073242, 140.94501733779907, 142.01145267486572, 143.07736778259277, 144.14328289031982, 145.21051359176636, 146.2777442932129, 147.3444378376007, 148.41113138198853, 149.46635961532593, 150.52158784866333, 151.57249975204468, 152.62341165542603, 153.6773715019226, 154.7313313484192, 155.79829144477844, 156.8652515411377, 157.93076348304749, 158.99627542495728, 160.0610704421997, 161.12586545944214, 162.19229888916016, 163.25873231887817, 164.32448768615723, 165.39024305343628, 166.4590938091278, 167.52794456481934, 168.59870719909668, 169.66946983337402, 170.74001812934875, 171.8105664253235, 172.88410115242004, 173.9576358795166, 175.02776551246643, 176.09789514541626, 177.15968298912048, 178.2214708328247, 179.28979349136353, 180.35811614990234, 181.42951655387878, 182.50091695785522, 183.5719530582428, 184.64298915863037, 185.7137815952301, 186.78457403182983, 187.85383868217468, 188.92310333251953, 189.98966026306152, 191.05621719360352, 192.12718892097473, 193.19816064834595, 194.2567265033722, 195.31529235839844, 196.37514686584473, 197.43500137329102, 198.49356245994568, 199.55212354660034, 200.6137354373932, 201.67534732818604, 202.74086260795593, 203.80637788772583, 204.87555623054504, 205.94473457336426, 207.01470041275024, 208.08466625213623, 209.14840054512024, 210.21213483810425, 211.27901339530945, 212.34589195251465, 213.39739847183228, 214.4489049911499, 215.50302147865295, 216.557137966156, 217.61171960830688, 218.66630125045776, 219.72911190986633, 220.7919225692749, 221.86199045181274, 222.9320583343506, 223.9836390018463, 225.03521966934204, 226.0925714969635, 227.14992332458496, 228.2030153274536, 229.25610733032227, 231.37337017059326, 233.49063301086426]
[27.69, 27.69, 34.49, 34.49, 39.74, 39.74, 44.52, 44.52, 47.77, 47.77, 49.13, 49.13, 51.53, 51.53, 54.69, 54.69, 56.89, 56.89, 58.32, 58.32, 59.49, 59.49, 59.83, 59.83, 61.23, 61.23, 62.46, 62.46, 62.74, 62.74, 63.28, 63.28, 62.87, 62.87, 63.2, 63.2, 63.45, 63.45, 63.81, 63.81, 64.72, 64.72, 65.53, 65.53, 66.01, 66.01, 66.79, 66.79, 66.61, 66.61, 66.67, 66.67, 67.18, 67.18, 68.59, 68.59, 68.27, 68.27, 68.31, 68.31, 68.78, 68.78, 68.78, 68.78, 69.15, 69.15, 69.51, 69.51, 69.57, 69.57, 69.96, 69.96, 69.48, 69.48, 69.55, 69.55, 70.39, 70.39, 71.23, 71.23, 71.22, 71.22, 71.24, 71.24, 71.24, 71.24, 71.12, 71.12, 71.29, 71.29, 70.67, 70.67, 70.09, 70.09, 69.89, 69.89, 69.88, 69.88, 70.13, 70.13, 70.49, 70.49, 71.13, 71.13, 71.32, 71.32, 71.47, 71.47, 71.92, 71.92, 72.62, 72.62, 72.78, 72.78, 72.34, 72.34, 73.09, 73.09, 72.24, 72.24, 72.87, 72.87, 73.27, 73.27, 73.19, 73.19, 72.96, 72.96, 72.91, 72.91, 73.13, 73.13, 73.23, 73.23, 73.44, 73.44, 72.99, 72.99, 72.91, 72.91, 73.5, 73.5, 73.37, 73.37, 73.73, 73.73, 73.92, 73.92, 74.24, 74.24, 74.01, 74.01, 73.72, 73.72, 73.52, 73.52, 73.53, 73.53, 73.51, 73.51, 73.88, 73.88, 73.5, 73.5, 72.98, 72.98, 73.52, 73.52, 73.85, 73.85, 73.39, 73.39, 73.89, 73.89, 73.17, 73.17, 72.92, 72.92, 73.0, 73.0, 72.94, 72.94, 73.38, 73.38, 72.99, 72.99, 73.57, 73.57, 73.73, 73.73, 73.39, 73.39, 73.79, 73.79, 73.91, 73.91, 74.52, 74.52, 74.17, 74.17, 73.25, 73.25]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.614, Test loss: 2.003, Test accuracy: 28.55
Round   0, Global train loss: 1.614, Global test loss: 2.204, Global test accuracy: 25.03
Round   1, Train loss: 1.433, Test loss: 1.862, Test accuracy: 32.76
Round   1, Global train loss: 1.433, Global test loss: 2.153, Global test accuracy: 25.76
Round   2, Train loss: 1.284, Test loss: 1.570, Test accuracy: 41.65
Round   2, Global train loss: 1.284, Global test loss: 2.011, Global test accuracy: 32.88
Round   3, Train loss: 1.287, Test loss: 1.433, Test accuracy: 45.26
Round   3, Global train loss: 1.287, Global test loss: 1.899, Global test accuracy: 35.03
Round   4, Train loss: 1.153, Test loss: 1.347, Test accuracy: 48.35
Round   4, Global train loss: 1.153, Global test loss: 1.771, Global test accuracy: 37.90
Round   5, Train loss: 1.169, Test loss: 1.298, Test accuracy: 48.87
Round   5, Global train loss: 1.169, Global test loss: 1.771, Global test accuracy: 35.98
Round   6, Train loss: 1.132, Test loss: 1.206, Test accuracy: 52.84
Round   6, Global train loss: 1.132, Global test loss: 1.769, Global test accuracy: 37.87
Round   7, Train loss: 1.026, Test loss: 1.112, Test accuracy: 56.25
Round   7, Global train loss: 1.026, Global test loss: 1.596, Global test accuracy: 42.51
Round   8, Train loss: 1.050, Test loss: 1.059, Test accuracy: 58.53
Round   8, Global train loss: 1.050, Global test loss: 1.540, Global test accuracy: 45.20
Round   9, Train loss: 1.080, Test loss: 1.054, Test accuracy: 59.16
Round   9, Global train loss: 1.080, Global test loss: 1.764, Global test accuracy: 43.04
Round  10, Train loss: 0.967, Test loss: 1.035, Test accuracy: 60.44
Round  10, Global train loss: 0.967, Global test loss: 1.628, Global test accuracy: 45.84
Round  11, Train loss: 1.004, Test loss: 1.036, Test accuracy: 60.13
Round  11, Global train loss: 1.004, Global test loss: 1.579, Global test accuracy: 45.07
Round  12, Train loss: 0.945, Test loss: 1.030, Test accuracy: 60.73
Round  12, Global train loss: 0.945, Global test loss: 1.563, Global test accuracy: 46.18
Round  13, Train loss: 0.929, Test loss: 1.025, Test accuracy: 61.12
Round  13, Global train loss: 0.929, Global test loss: 1.514, Global test accuracy: 46.99
Round  14, Train loss: 0.889, Test loss: 1.029, Test accuracy: 61.28
Round  14, Global train loss: 0.889, Global test loss: 1.533, Global test accuracy: 47.02
Round  15, Train loss: 0.851, Test loss: 1.023, Test accuracy: 61.83
Round  15, Global train loss: 0.851, Global test loss: 1.523, Global test accuracy: 48.59
Round  16, Train loss: 0.871, Test loss: 0.993, Test accuracy: 62.58
Round  16, Global train loss: 0.871, Global test loss: 1.470, Global test accuracy: 48.97
Round  17, Train loss: 0.927, Test loss: 0.976, Test accuracy: 63.21
Round  17, Global train loss: 0.927, Global test loss: 1.566, Global test accuracy: 47.06
Round  18, Train loss: 0.935, Test loss: 0.957, Test accuracy: 63.26
Round  18, Global train loss: 0.935, Global test loss: 1.645, Global test accuracy: 46.91
Round  19, Train loss: 0.945, Test loss: 0.961, Test accuracy: 63.88
Round  19, Global train loss: 0.945, Global test loss: 1.642, Global test accuracy: 42.91
Round  20, Train loss: 0.831, Test loss: 0.971, Test accuracy: 63.57
Round  20, Global train loss: 0.831, Global test loss: 1.426, Global test accuracy: 49.55
Round  21, Train loss: 0.842, Test loss: 0.934, Test accuracy: 65.03
Round  21, Global train loss: 0.842, Global test loss: 1.583, Global test accuracy: 44.89
Round  22, Train loss: 0.799, Test loss: 0.922, Test accuracy: 65.32
Round  22, Global train loss: 0.799, Global test loss: 1.397, Global test accuracy: 51.75
Round  23, Train loss: 0.770, Test loss: 0.913, Test accuracy: 66.24
Round  23, Global train loss: 0.770, Global test loss: 1.479, Global test accuracy: 50.21
Round  24, Train loss: 0.777, Test loss: 0.918, Test accuracy: 66.44
Round  24, Global train loss: 0.777, Global test loss: 1.441, Global test accuracy: 50.15
Round  25, Train loss: 0.700, Test loss: 0.922, Test accuracy: 66.45
Round  25, Global train loss: 0.700, Global test loss: 1.305, Global test accuracy: 55.77
Round  26, Train loss: 0.744, Test loss: 0.924, Test accuracy: 66.67
Round  26, Global train loss: 0.744, Global test loss: 1.206, Global test accuracy: 57.12
Round  27, Train loss: 0.714, Test loss: 0.922, Test accuracy: 67.12
Round  27, Global train loss: 0.714, Global test loss: 1.305, Global test accuracy: 53.67
Round  28, Train loss: 0.721, Test loss: 0.905, Test accuracy: 67.22
Round  28, Global train loss: 0.721, Global test loss: 1.352, Global test accuracy: 52.12
Round  29, Train loss: 0.664, Test loss: 0.907, Test accuracy: 67.17
Round  29, Global train loss: 0.664, Global test loss: 1.339, Global test accuracy: 54.73
Round  30, Train loss: 0.694, Test loss: 0.894, Test accuracy: 68.13
Round  30, Global train loss: 0.694, Global test loss: 1.549, Global test accuracy: 49.31
Round  31, Train loss: 0.703, Test loss: 0.892, Test accuracy: 67.75
Round  31, Global train loss: 0.703, Global test loss: 1.361, Global test accuracy: 54.14
Round  32, Train loss: 0.656, Test loss: 0.878, Test accuracy: 68.26
Round  32, Global train loss: 0.656, Global test loss: 1.364, Global test accuracy: 53.64
Round  33, Train loss: 0.698, Test loss: 0.857, Test accuracy: 68.96
Round  33, Global train loss: 0.698, Global test loss: 1.371, Global test accuracy: 52.90
Round  34, Train loss: 0.691, Test loss: 0.869, Test accuracy: 69.03
Round  34, Global train loss: 0.691, Global test loss: 1.537, Global test accuracy: 49.77
Round  35, Train loss: 0.642, Test loss: 0.869, Test accuracy: 69.40
Round  35, Global train loss: 0.642, Global test loss: 1.265, Global test accuracy: 57.54
Round  36, Train loss: 0.666, Test loss: 0.863, Test accuracy: 69.51
Round  36, Global train loss: 0.666, Global test loss: 1.360, Global test accuracy: 56.59
Round  37, Train loss: 0.788, Test loss: 0.870, Test accuracy: 69.87
Round  37, Global train loss: 0.788, Global test loss: 1.447, Global test accuracy: 51.25
Round  38, Train loss: 0.640, Test loss: 0.858, Test accuracy: 70.00
Round  38, Global train loss: 0.640, Global test loss: 1.196, Global test accuracy: 58.65
Round  39, Train loss: 0.719, Test loss: 0.871, Test accuracy: 69.65
Round  39, Global train loss: 0.719, Global test loss: 1.273, Global test accuracy: 55.09
Round  40, Train loss: 0.615, Test loss: 0.865, Test accuracy: 69.32
Round  40, Global train loss: 0.615, Global test loss: 1.236, Global test accuracy: 57.28
Round  41, Train loss: 0.564, Test loss: 0.866, Test accuracy: 69.59
Round  41, Global train loss: 0.564, Global test loss: 1.142, Global test accuracy: 60.46
Round  42, Train loss: 0.606, Test loss: 0.858, Test accuracy: 69.81
Round  42, Global train loss: 0.606, Global test loss: 1.261, Global test accuracy: 59.51
Round  43, Train loss: 0.601, Test loss: 0.858, Test accuracy: 69.81
Round  43, Global train loss: 0.601, Global test loss: 1.269, Global test accuracy: 57.00
Round  44, Train loss: 0.649, Test loss: 0.856, Test accuracy: 70.24
Round  44, Global train loss: 0.649, Global test loss: 1.301, Global test accuracy: 55.65
Round  45, Train loss: 0.581, Test loss: 0.867, Test accuracy: 70.26
Round  45, Global train loss: 0.581, Global test loss: 1.265, Global test accuracy: 59.49
Round  46, Train loss: 0.684, Test loss: 0.869, Test accuracy: 70.76
Round  46, Global train loss: 0.684, Global test loss: 1.323, Global test accuracy: 55.37
Round  47, Train loss: 0.549, Test loss: 0.875, Test accuracy: 70.65
Round  47, Global train loss: 0.549, Global test loss: 1.222, Global test accuracy: 58.78
Round  48, Train loss: 0.524, Test loss: 0.883, Test accuracy: 70.45
Round  48, Global train loss: 0.524, Global test loss: 1.213, Global test accuracy: 58.61
Round  49, Train loss: 0.536, Test loss: 0.888, Test accuracy: 70.74
Round  49, Global train loss: 0.536, Global test loss: 1.500, Global test accuracy: 56.52
Round  50, Train loss: 0.648, Test loss: 0.877, Test accuracy: 70.51
Round  50, Global train loss: 0.648, Global test loss: 1.313, Global test accuracy: 55.78
Round  51, Train loss: 0.538, Test loss: 0.859, Test accuracy: 70.89
Round  51, Global train loss: 0.538, Global test loss: 1.271, Global test accuracy: 58.59
Round  52, Train loss: 0.471, Test loss: 0.881, Test accuracy: 70.60
Round  52, Global train loss: 0.471, Global test loss: 1.343, Global test accuracy: 57.16
Round  53, Train loss: 0.468, Test loss: 0.869, Test accuracy: 71.11
Round  53, Global train loss: 0.468, Global test loss: 1.297, Global test accuracy: 61.00
Round  54, Train loss: 0.527, Test loss: 0.864, Test accuracy: 71.37
Round  54, Global train loss: 0.527, Global test loss: 1.309, Global test accuracy: 58.05
Round  55, Train loss: 0.478, Test loss: 0.851, Test accuracy: 71.95
Round  55, Global train loss: 0.478, Global test loss: 1.424, Global test accuracy: 56.59
Round  56, Train loss: 0.517, Test loss: 0.848, Test accuracy: 71.90
Round  56, Global train loss: 0.517, Global test loss: 1.123, Global test accuracy: 61.89
Round  57, Train loss: 0.500, Test loss: 0.866, Test accuracy: 71.43
Round  57, Global train loss: 0.500, Global test loss: 1.113, Global test accuracy: 62.37
Round  58, Train loss: 0.482, Test loss: 0.859, Test accuracy: 71.96
Round  58, Global train loss: 0.482, Global test loss: 1.182, Global test accuracy: 61.14
Round  59, Train loss: 0.510, Test loss: 0.860, Test accuracy: 71.91
Round  59, Global train loss: 0.510, Global test loss: 1.308, Global test accuracy: 59.39
Round  60, Train loss: 0.448, Test loss: 0.878, Test accuracy: 71.33
Round  60, Global train loss: 0.448, Global test loss: 1.139, Global test accuracy: 63.14
Round  61, Train loss: 0.431, Test loss: 0.883, Test accuracy: 71.39
Round  61, Global train loss: 0.431, Global test loss: 1.140, Global test accuracy: 61.96
Round  62, Train loss: 0.473, Test loss: 0.909, Test accuracy: 71.16
Round  62, Global train loss: 0.473, Global test loss: 1.176, Global test accuracy: 61.29
Round  63, Train loss: 0.361, Test loss: 0.899, Test accuracy: 71.19
Round  63, Global train loss: 0.361, Global test loss: 1.203, Global test accuracy: 62.15
Round  64, Train loss: 0.547, Test loss: 0.898, Test accuracy: 71.00
Round  64, Global train loss: 0.547, Global test loss: 1.380, Global test accuracy: 56.14
Round  65, Train loss: 0.490, Test loss: 0.902, Test accuracy: 71.22
Round  65, Global train loss: 0.490, Global test loss: 1.143, Global test accuracy: 62.09
Round  66, Train loss: 0.412, Test loss: 0.898, Test accuracy: 71.39
Round  66, Global train loss: 0.412, Global test loss: 1.158, Global test accuracy: 62.73
Round  67, Train loss: 0.482, Test loss: 0.886, Test accuracy: 71.75
Round  67, Global train loss: 0.482, Global test loss: 1.322, Global test accuracy: 58.40
Round  68, Train loss: 0.441, Test loss: 0.897, Test accuracy: 71.79
Round  68, Global train loss: 0.441, Global test loss: 1.288, Global test accuracy: 59.49
Round  69, Train loss: 0.472, Test loss: 0.904, Test accuracy: 71.99
Round  69, Global train loss: 0.472, Global test loss: 1.172, Global test accuracy: 61.47
Round  70, Train loss: 0.499, Test loss: 0.912, Test accuracy: 71.79
Round  70, Global train loss: 0.499, Global test loss: 1.329, Global test accuracy: 57.28
Round  71, Train loss: 0.487, Test loss: 0.923, Test accuracy: 71.74
Round  71, Global train loss: 0.487, Global test loss: 1.369, Global test accuracy: 58.61
Round  72, Train loss: 0.497, Test loss: 0.922, Test accuracy: 71.95
Round  72, Global train loss: 0.497, Global test loss: 1.277, Global test accuracy: 59.53
Round  73, Train loss: 0.405, Test loss: 0.924, Test accuracy: 71.78
Round  73, Global train loss: 0.405, Global test loss: 1.270, Global test accuracy: 61.07
Round  74, Train loss: 0.434, Test loss: 0.926, Test accuracy: 71.71
Round  74, Global train loss: 0.434, Global test loss: 1.146, Global test accuracy: 62.62
Round  75, Train loss: 0.357, Test loss: 0.910, Test accuracy: 71.67
Round  75, Global train loss: 0.357, Global test loss: 1.250, Global test accuracy: 60.77
Round  76, Train loss: 0.329, Test loss: 0.913, Test accuracy: 71.70
Round  76, Global train loss: 0.329, Global test loss: 1.369, Global test accuracy: 59.62
Round  77, Train loss: 0.459, Test loss: 0.917, Test accuracy: 72.13
Round  77, Global train loss: 0.459, Global test loss: 1.254, Global test accuracy: 60.67
Round  78, Train loss: 0.388, Test loss: 0.917, Test accuracy: 72.23
Round  78, Global train loss: 0.388, Global test loss: 1.313, Global test accuracy: 59.34
Round  79, Train loss: 0.369, Test loss: 0.911, Test accuracy: 72.29
Round  79, Global train loss: 0.369, Global test loss: 1.294, Global test accuracy: 59.74
Round  80, Train loss: 0.373, Test loss: 0.923, Test accuracy: 72.25
Round  80, Global train loss: 0.373, Global test loss: 1.243, Global test accuracy: 63.17
Round  81, Train loss: 0.412, Test loss: 0.925, Test accuracy: 71.99
Round  81, Global train loss: 0.412, Global test loss: 1.284, Global test accuracy: 61.91
Round  82, Train loss: 0.344, Test loss: 0.908, Test accuracy: 72.47
Round  82, Global train loss: 0.344, Global test loss: 1.325, Global test accuracy: 60.21
Round  83, Train loss: 0.415, Test loss: 0.921, Test accuracy: 72.40
Round  83, Global train loss: 0.415, Global test loss: 1.431, Global test accuracy: 58.70
Round  84, Train loss: 0.404, Test loss: 0.914, Test accuracy: 72.78
Round  84, Global train loss: 0.404, Global test loss: 1.328, Global test accuracy: 61.32
Round  85, Train loss: 0.335, Test loss: 0.930, Test accuracy: 72.53
Round  85, Global train loss: 0.335, Global test loss: 1.245, Global test accuracy: 63.58
Round  86, Train loss: 0.370, Test loss: 0.936, Test accuracy: 72.29
Round  86, Global train loss: 0.370, Global test loss: 1.291, Global test accuracy: 61.15
Round  87, Train loss: 0.337, Test loss: 0.948, Test accuracy: 72.00
Round  87, Global train loss: 0.337, Global test loss: 1.220, Global test accuracy: 62.13
Round  88, Train loss: 0.448, Test loss: 0.919, Test accuracy: 72.07
Round  88, Global train loss: 0.448, Global test loss: 1.310, Global test accuracy: 59.44
Round  89, Train loss: 0.383, Test loss: 0.935, Test accuracy: 72.07
Round  89, Global train loss: 0.383, Global test loss: 1.282, Global test accuracy: 60.33
Round  90, Train loss: 0.424, Test loss: 0.932, Test accuracy: 72.15
Round  90, Global train loss: 0.424, Global test loss: 1.237, Global test accuracy: 62.27
Round  91, Train loss: 0.412, Test loss: 0.933, Test accuracy: 72.41
Round  91, Global train loss: 0.412, Global test loss: 1.468, Global test accuracy: 59.71
Round  92, Train loss: 0.381, Test loss: 0.929, Test accuracy: 72.27
Round  92, Global train loss: 0.381, Global test loss: 1.110, Global test accuracy: 64.24
Round  93, Train loss: 0.358, Test loss: 0.916, Test accuracy: 73.01
Round  93, Global train loss: 0.358, Global test loss: 1.178, Global test accuracy: 63.94
Round  94, Train loss: 0.355, Test loss: 0.904, Test accuracy: 73.45
Round  94, Global train loss: 0.355, Global test loss: 1.451, Global test accuracy: 58.21
Round  95, Train loss: 0.426, Test loss: 0.918, Test accuracy: 73.23
Round  95, Global train loss: 0.426, Global test loss: 1.360, Global test accuracy: 58.99
Round  96, Train loss: 0.434, Test loss: 0.924, Test accuracy: 73.50
Round  96, Global train loss: 0.434, Global test loss: 1.306, Global test accuracy: 60.35
Round  97, Train loss: 0.369, Test loss: 0.939, Test accuracy: 73.07
Round  97, Global train loss: 0.369, Global test loss: 1.235, Global test accuracy: 62.50
Round  98, Train loss: 0.357, Test loss: 0.941, Test accuracy: 72.82
Round  98, Global train loss: 0.357, Global test loss: 1.245, Global test accuracy: 62.11
Round  99, Train loss: 0.350, Test loss: 0.945, Test accuracy: 73.02
Round  99, Global train loss: 0.350, Global test loss: 1.282, Global test accuracy: 61.85
Final Round, Train loss: 0.284, Test loss: 1.047, Test accuracy: 73.01
Final Round, Global train loss: 0.284, Global test loss: 1.282, Global test accuracy: 61.85
Average accuracy final 10 rounds: 72.893
Average global accuracy final 10 rounds: 61.417
2016.4035866260529
[2.789808988571167, 5.351416826248169, 7.918463230133057, 10.468878269195557, 13.041934490203857, 15.608992576599121, 18.17836332321167, 20.748181343078613, 23.310402154922485, 25.859458923339844, 28.405988216400146, 30.950148582458496, 33.510459661483765, 36.075915813446045, 38.63850474357605, 41.20162510871887, 43.76901316642761, 46.33138155937195, 48.89438796043396, 51.468645095825195, 54.03872609138489, 56.60901236534119, 59.174734592437744, 61.74327301979065, 64.30063080787659, 66.84455037117004, 69.39581537246704, 71.95022058486938, 74.50237393379211, 77.0621109008789, 79.63239669799805, 82.20726895332336, 84.77918672561646, 87.3431327342987, 89.90683889389038, 92.47856140136719, 95.04356837272644, 97.60572052001953, 100.16849184036255, 102.7309262752533, 105.30177640914917, 107.86691761016846, 110.42956590652466, 113.00358271598816, 115.57194423675537, 118.14173221588135, 120.7112329006195, 122.97014594078064, 125.22855877876282, 127.49602007865906, 129.75749158859253, 132.0187213420868, 134.27140259742737, 136.52047491073608, 138.7758641242981, 141.00866866111755, 143.2575991153717, 145.52283930778503, 147.78731966018677, 150.01636695861816, 152.2495310306549, 154.50877118110657, 156.73659563064575, 158.97004771232605, 161.20201969146729, 163.43264937400818, 165.68177843093872, 167.93721866607666, 170.18645405769348, 172.44013142585754, 174.69865918159485, 176.94965147972107, 179.23217678070068, 181.5036313533783, 183.74156761169434, 186.0025041103363, 188.26103234291077, 190.5307333469391, 192.79038786888123, 195.05095791816711, 197.303124666214, 199.5761957168579, 201.84809255599976, 204.1129014492035, 206.6774821281433, 209.26650500297546, 211.85166430473328, 214.4314522743225, 217.00768518447876, 219.59474349021912, 222.17361426353455, 224.75181031227112, 227.31955289840698, 229.88185167312622, 232.448734998703, 235.02924799919128, 237.6102306842804, 240.19456481933594, 242.777592420578, 245.36167216300964, 250.0094702243805]
[28.55, 32.76, 41.65, 45.26, 48.35, 48.87, 52.84, 56.25, 58.53, 59.16, 60.44, 60.13, 60.73, 61.12, 61.28, 61.83, 62.58, 63.21, 63.26, 63.88, 63.57, 65.03, 65.32, 66.24, 66.44, 66.45, 66.67, 67.12, 67.22, 67.17, 68.13, 67.75, 68.26, 68.96, 69.03, 69.4, 69.51, 69.87, 70.0, 69.65, 69.32, 69.59, 69.81, 69.81, 70.24, 70.26, 70.76, 70.65, 70.45, 70.74, 70.51, 70.89, 70.6, 71.11, 71.37, 71.95, 71.9, 71.43, 71.96, 71.91, 71.33, 71.39, 71.16, 71.19, 71.0, 71.22, 71.39, 71.75, 71.79, 71.99, 71.79, 71.74, 71.95, 71.78, 71.71, 71.67, 71.7, 72.13, 72.23, 72.29, 72.25, 71.99, 72.47, 72.4, 72.78, 72.53, 72.29, 72.0, 72.07, 72.07, 72.15, 72.41, 72.27, 73.01, 73.45, 73.23, 73.5, 73.07, 72.82, 73.02, 73.01]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  17.4900
Round 1 global test acc  21.0600
Round 2 global test acc  24.1200
Round 3 global test acc  22.5600
Round 4 global test acc  23.6700
Round 5 global test acc  23.3600
Round 6 global test acc  27.9000
Round 7 global test acc  29.5300
Round 8 global test acc  25.1000
Round 9 global test acc  32.9000
Round 10 global test acc  32.3500
Round 11 global test acc  35.9100
Round 12 global test acc  32.3700
Round 13 global test acc  34.8700
Round 14 global test acc  30.6000
Round 15 global test acc  37.8500
Round 16 global test acc  35.0900
Round 17 global test acc  36.2600
Round 18 global test acc  42.0300
Round 19 global test acc  27.7100
Round 20 global test acc  32.2200
Round 21 global test acc  34.2200
Round 22 global test acc  35.7800
Round 23 global test acc  39.3800
Round 24 global test acc  29.8400
Round 25 global test acc  39.5000
Round 26 global test acc  36.9800
Round 27 global test acc  37.9400
Round 28 global test acc  35.4700
Round 29 global test acc  38.0100
Round 30 global test acc  33.0900
Round 31 global test acc  46.5900
Round 32 global test acc  41.6700
Round 33 global test acc  38.7700
Round 34 global test acc  32.3300
Round 35 global test acc  40.3400
Round 36 global test acc  35.4200
Round 37 global test acc  42.3900
Round 38 global test acc  42.1700
Round 39 global test acc  38.1600
Round 40 global test acc  38.5400
Round 41 global test acc  41.1700
Round 42 global test acc  34.4700
Round 43 global test acc  44.3500
Round 44 global test acc  42.6800
Round 45 global test acc  36.3600
Round 46 global test acc  43.7400
Round 47 global test acc  41.8400
Round 48 global test acc  45.3700
Round 49 global test acc  39.9800
Round 50 global test acc  43.9400
Round 51 global test acc  39.7100
Round 52 global test acc  44.7300
Round 53 global test acc  39.1400
Round 54 global test acc  41.4700
Round 55 global test acc  43.6600
Round 56 global test acc  32.1800
Round 57 global test acc  37.5400
Round 58 global test acc  44.5400
Round 59 global test acc  33.4800
Round 60 global test acc  42.6800
Round 61 global test acc  39.6300
Round 62 global test acc  41.1700
Round 63 global test acc  46.2700
Round 64 global test acc  40.6800
Round 65 global test acc  34.6400
Round 66 global test acc  40.8800
Round 67 global test acc  35.2500
Round 68 global test acc  41.2600
Round 69 global test acc  42.3200
Round 70 global test acc  37.0200
Round 71 global test acc  45.7300
Round 72 global test acc  44.4200
Round 73 global test acc  41.1900
Round 74 global test acc  40.1500
Round 75 global test acc  40.1000
Round 76 global test acc  40.0700
Round 77 global test acc  39.4700
Round 78 global test acc  49.5000
Round 79 global test acc  36.7100
Round 80 global test acc  33.4400
Round 81 global test acc  31.4700
Round 82 global test acc  29.4800
Round 83 global test acc  28.7500
Round 84 global test acc  27.6800
Round 85 global test acc  26.6200
Round 86 global test acc  26.0900
Round 87 global test acc  24.8300
Round 88 global test acc  23.9600
Round 89 global test acc  23.0400
Round 90 global test acc  23.0900
Round 91 global test acc  22.1200
Round 92 global test acc  22.0100
Round 93 global test acc  21.3100
Round 94 global test acc  21.1300
Round 95 global test acc  20.7600
Round 96 global test acc  19.7600
Round 97 global test acc  18.8000
Round 98 global test acc  18.7300
Round 99 global test acc  18.8500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.902, Test loss: 2.098, Test accuracy: 25.42
Round   1, Train loss: 1.519, Test loss: 1.999, Test accuracy: 27.04
Round   2, Train loss: 1.376, Test loss: 1.645, Test accuracy: 37.63
Round   3, Train loss: 1.304, Test loss: 1.446, Test accuracy: 43.90
Round   4, Train loss: 1.210, Test loss: 1.361, Test accuracy: 47.77
Round   5, Train loss: 1.178, Test loss: 1.279, Test accuracy: 49.44
Round   6, Train loss: 1.131, Test loss: 1.218, Test accuracy: 52.05
Round   7, Train loss: 1.127, Test loss: 1.060, Test accuracy: 55.88
Round   8, Train loss: 1.082, Test loss: 1.013, Test accuracy: 58.87
Round   9, Train loss: 1.099, Test loss: 0.995, Test accuracy: 59.38
Round  10, Train loss: 1.028, Test loss: 0.976, Test accuracy: 60.68
Round  11, Train loss: 1.020, Test loss: 0.954, Test accuracy: 62.14
Round  12, Train loss: 0.978, Test loss: 0.944, Test accuracy: 62.90
Round  13, Train loss: 1.001, Test loss: 0.913, Test accuracy: 63.93
Round  14, Train loss: 0.934, Test loss: 0.903, Test accuracy: 64.36
Round  15, Train loss: 0.957, Test loss: 0.883, Test accuracy: 65.34
Round  16, Train loss: 0.891, Test loss: 0.876, Test accuracy: 65.54
Round  17, Train loss: 0.956, Test loss: 0.863, Test accuracy: 66.29
Round  18, Train loss: 0.903, Test loss: 0.852, Test accuracy: 66.87
Round  19, Train loss: 0.942, Test loss: 0.860, Test accuracy: 66.74
Round  20, Train loss: 0.879, Test loss: 0.857, Test accuracy: 66.58
Round  21, Train loss: 0.866, Test loss: 0.838, Test accuracy: 67.45
Round  22, Train loss: 0.839, Test loss: 0.846, Test accuracy: 66.74
Round  23, Train loss: 0.792, Test loss: 0.822, Test accuracy: 68.00
Round  24, Train loss: 0.864, Test loss: 0.828, Test accuracy: 68.22
Round  25, Train loss: 0.784, Test loss: 0.796, Test accuracy: 69.29
Round  26, Train loss: 0.791, Test loss: 0.773, Test accuracy: 70.40
Round  27, Train loss: 0.764, Test loss: 0.765, Test accuracy: 70.51
Round  28, Train loss: 0.832, Test loss: 0.754, Test accuracy: 71.19
Round  29, Train loss: 0.694, Test loss: 0.752, Test accuracy: 71.75
Round  30, Train loss: 0.787, Test loss: 0.745, Test accuracy: 72.05
Round  31, Train loss: 0.815, Test loss: 0.747, Test accuracy: 71.99
Round  32, Train loss: 0.756, Test loss: 0.731, Test accuracy: 72.31
Round  33, Train loss: 0.775, Test loss: 0.730, Test accuracy: 72.62
Round  34, Train loss: 0.771, Test loss: 0.729, Test accuracy: 72.60
Round  35, Train loss: 0.697, Test loss: 0.717, Test accuracy: 72.66
Round  36, Train loss: 0.738, Test loss: 0.711, Test accuracy: 73.00
Round  37, Train loss: 0.805, Test loss: 0.709, Test accuracy: 73.12
Round  38, Train loss: 0.684, Test loss: 0.702, Test accuracy: 73.51
Round  39, Train loss: 0.739, Test loss: 0.700, Test accuracy: 73.38
Round  40, Train loss: 0.670, Test loss: 0.714, Test accuracy: 72.90
Round  41, Train loss: 0.631, Test loss: 0.693, Test accuracy: 73.81
Round  42, Train loss: 0.646, Test loss: 0.682, Test accuracy: 74.44
Round  43, Train loss: 0.672, Test loss: 0.679, Test accuracy: 74.51
Round  44, Train loss: 0.746, Test loss: 0.674, Test accuracy: 74.85
Round  45, Train loss: 0.677, Test loss: 0.677, Test accuracy: 74.25
Round  46, Train loss: 0.641, Test loss: 0.671, Test accuracy: 74.95
Round  47, Train loss: 0.621, Test loss: 0.671, Test accuracy: 75.02
Round  48, Train loss: 0.608, Test loss: 0.672, Test accuracy: 74.78
Round  49, Train loss: 0.588, Test loss: 0.671, Test accuracy: 74.27
Round  50, Train loss: 0.655, Test loss: 0.657, Test accuracy: 75.04
Round  51, Train loss: 0.567, Test loss: 0.673, Test accuracy: 74.20
Round  52, Train loss: 0.604, Test loss: 0.662, Test accuracy: 74.99
Round  53, Train loss: 0.560, Test loss: 0.653, Test accuracy: 75.20
Round  54, Train loss: 0.559, Test loss: 0.652, Test accuracy: 75.50
Round  55, Train loss: 0.559, Test loss: 0.648, Test accuracy: 75.93
Round  56, Train loss: 0.581, Test loss: 0.648, Test accuracy: 75.64
Round  57, Train loss: 0.578, Test loss: 0.649, Test accuracy: 75.80
Round  58, Train loss: 0.540, Test loss: 0.645, Test accuracy: 75.92
Round  59, Train loss: 0.600, Test loss: 0.645, Test accuracy: 75.96
Round  60, Train loss: 0.557, Test loss: 0.640, Test accuracy: 76.08
Round  61, Train loss: 0.485, Test loss: 0.631, Test accuracy: 76.65
Round  62, Train loss: 0.524, Test loss: 0.627, Test accuracy: 76.40
Round  63, Train loss: 0.430, Test loss: 0.632, Test accuracy: 76.56
Round  64, Train loss: 0.637, Test loss: 0.625, Test accuracy: 76.70
Round  65, Train loss: 0.504, Test loss: 0.624, Test accuracy: 76.52
Round  66, Train loss: 0.476, Test loss: 0.624, Test accuracy: 77.10
Round  67, Train loss: 0.528, Test loss: 0.625, Test accuracy: 76.57
Round  68, Train loss: 0.473, Test loss: 0.625, Test accuracy: 76.57
Round  69, Train loss: 0.508, Test loss: 0.629, Test accuracy: 77.08
Round  70, Train loss: 0.551, Test loss: 0.630, Test accuracy: 76.94
Round  71, Train loss: 0.516, Test loss: 0.614, Test accuracy: 77.14
Round  72, Train loss: 0.564, Test loss: 0.610, Test accuracy: 77.68
Round  73, Train loss: 0.462, Test loss: 0.610, Test accuracy: 77.62
Round  74, Train loss: 0.502, Test loss: 0.604, Test accuracy: 77.71
Round  75, Train loss: 0.416, Test loss: 0.607, Test accuracy: 77.40
Round  76, Train loss: 0.383, Test loss: 0.613, Test accuracy: 77.33
Round  77, Train loss: 0.500, Test loss: 0.604, Test accuracy: 77.53
Round  78, Train loss: 0.449, Test loss: 0.609, Test accuracy: 77.69
Round  79, Train loss: 0.419, Test loss: 0.608, Test accuracy: 77.57
Round  80, Train loss: 0.446, Test loss: 0.606, Test accuracy: 77.50
Round  81, Train loss: 0.522, Test loss: 0.603, Test accuracy: 77.14
Round  82, Train loss: 0.391, Test loss: 0.600, Test accuracy: 77.88
Round  83, Train loss: 0.492, Test loss: 0.596, Test accuracy: 77.98
Round  84, Train loss: 0.497, Test loss: 0.602, Test accuracy: 78.17
Round  85, Train loss: 0.414, Test loss: 0.619, Test accuracy: 77.57
Round  86, Train loss: 0.416, Test loss: 0.613, Test accuracy: 77.64
Round  87, Train loss: 0.377, Test loss: 0.609, Test accuracy: 77.43
Round  88, Train loss: 0.452, Test loss: 0.610, Test accuracy: 77.52
Round  89, Train loss: 0.424, Test loss: 0.602, Test accuracy: 77.80
Round  90, Train loss: 0.521, Test loss: 0.602, Test accuracy: 78.11
Round  91, Train loss: 0.502, Test loss: 0.598, Test accuracy: 78.02
Round  92, Train loss: 0.420, Test loss: 0.599, Test accuracy: 78.26
Round  93, Train loss: 0.391, Test loss: 0.605, Test accuracy: 78.28
Round  94, Train loss: 0.391, Test loss: 0.608, Test accuracy: 77.73
Round  95, Train loss: 0.510, Test loss: 0.623, Test accuracy: 77.24
Round  96, Train loss: 0.465, Test loss: 0.607, Test accuracy: 77.60
Round  97, Train loss: 0.453, Test loss: 0.602, Test accuracy: 78.14
Round  98, Train loss: 0.423, Test loss: 0.603, Test accuracy: 77.86
Round  99, Train loss: 0.440, Test loss: 0.607, Test accuracy: 77.91
Final Round, Train loss: 0.361, Test loss: 0.608, Test accuracy: 78.23
Average accuracy final 10 rounds: 77.91499999999999
1065.7786383628845
[1.7060306072235107, 3.0384340286254883, 4.375530958175659, 5.733618497848511, 7.110168218612671, 8.47711181640625, 9.856034278869629, 11.226158857345581, 12.608298540115356, 13.96759819984436, 15.317986726760864, 16.66302800178528, 18.011807203292847, 19.349802255630493, 20.701167345046997, 22.04746961593628, 23.38958430290222, 24.73623490333557, 26.082256317138672, 27.432519912719727, 28.78913688659668, 30.131098747253418, 31.48254942893982, 32.83300733566284, 34.18850922584534, 35.533427238464355, 36.87898111343384, 38.222630977630615, 39.57251811027527, 40.91313910484314, 42.26157760620117, 43.61255407333374, 44.957494497299194, 46.321406841278076, 47.67732858657837, 49.02970099449158, 50.386090993881226, 51.73953986167908, 53.09312295913696, 54.446561336517334, 55.8026967048645, 57.152825355529785, 58.50115513801575, 59.85567808151245, 61.21657681465149, 62.57107901573181, 63.931291341781616, 65.28061485290527, 66.63253331184387, 67.977609872818, 69.32661771774292, 70.67930698394775, 72.03521156311035, 73.39380145072937, 74.74501824378967, 76.09124684333801, 77.4382152557373, 78.74086499214172, 80.04799771308899, 81.35094833374023, 82.65490627288818, 83.97874593734741, 85.28630900382996, 86.59228205680847, 87.8910219669342, 89.19808864593506, 90.50282740592957, 91.81964921951294, 93.12714910507202, 94.44391322135925, 95.75131821632385, 97.08139061927795, 98.38074779510498, 99.71071600914001, 101.02114796638489, 102.36654591560364, 103.71286463737488, 105.05306386947632, 106.39184308052063, 107.73772096633911, 109.08423376083374, 110.44355630874634, 111.7832932472229, 113.13951635360718, 114.4810311794281, 115.8305914402008, 117.17171025276184, 118.51837968826294, 119.8599362373352, 121.20508813858032, 122.55292630195618, 123.91645956039429, 125.2833480834961, 126.64590334892273, 128.00752568244934, 129.35683917999268, 130.72036290168762, 132.09056758880615, 133.45899844169617, 134.8178584575653, 136.9189751148224]
[25.42, 27.04, 37.63, 43.9, 47.77, 49.44, 52.05, 55.88, 58.87, 59.38, 60.68, 62.14, 62.9, 63.93, 64.36, 65.34, 65.54, 66.29, 66.87, 66.74, 66.58, 67.45, 66.74, 68.0, 68.22, 69.29, 70.4, 70.51, 71.19, 71.75, 72.05, 71.99, 72.31, 72.62, 72.6, 72.66, 73.0, 73.12, 73.51, 73.38, 72.9, 73.81, 74.44, 74.51, 74.85, 74.25, 74.95, 75.02, 74.78, 74.27, 75.04, 74.2, 74.99, 75.2, 75.5, 75.93, 75.64, 75.8, 75.92, 75.96, 76.08, 76.65, 76.4, 76.56, 76.7, 76.52, 77.1, 76.57, 76.57, 77.08, 76.94, 77.14, 77.68, 77.62, 77.71, 77.4, 77.33, 77.53, 77.69, 77.57, 77.5, 77.14, 77.88, 77.98, 78.17, 77.57, 77.64, 77.43, 77.52, 77.8, 78.11, 78.02, 78.26, 78.28, 77.73, 77.24, 77.6, 78.14, 77.86, 77.91, 78.23]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.705, Test loss: 2.034, Test accuracy: 29.56
Round   1, Train loss: 1.364, Test loss: 1.837, Test accuracy: 35.94
Round   2, Train loss: 1.189, Test loss: 1.482, Test accuracy: 44.89
Round   3, Train loss: 1.093, Test loss: 1.302, Test accuracy: 49.44
Round   4, Train loss: 1.048, Test loss: 1.201, Test accuracy: 54.91
Round   5, Train loss: 0.981, Test loss: 1.131, Test accuracy: 56.60
Round   6, Train loss: 0.984, Test loss: 1.086, Test accuracy: 57.61
Round   7, Train loss: 0.941, Test loss: 0.964, Test accuracy: 61.82
Round   8, Train loss: 0.895, Test loss: 0.913, Test accuracy: 63.70
Round   9, Train loss: 0.872, Test loss: 0.886, Test accuracy: 64.92
Round  10, Train loss: 0.861, Test loss: 0.869, Test accuracy: 65.88
Round  11, Train loss: 0.822, Test loss: 0.856, Test accuracy: 66.61
Round  12, Train loss: 0.805, Test loss: 0.815, Test accuracy: 68.34
Round  13, Train loss: 0.766, Test loss: 0.809, Test accuracy: 68.11
Round  14, Train loss: 0.718, Test loss: 0.798, Test accuracy: 68.94
Round  15, Train loss: 0.723, Test loss: 0.795, Test accuracy: 69.47
Round  16, Train loss: 0.657, Test loss: 0.787, Test accuracy: 69.52
Round  17, Train loss: 0.735, Test loss: 0.777, Test accuracy: 69.68
Round  18, Train loss: 0.662, Test loss: 0.770, Test accuracy: 70.21
Round  19, Train loss: 0.701, Test loss: 0.762, Test accuracy: 71.24
Round  20, Train loss: 0.637, Test loss: 0.760, Test accuracy: 71.22
Round  21, Train loss: 0.595, Test loss: 0.729, Test accuracy: 72.24
Round  22, Train loss: 0.629, Test loss: 0.739, Test accuracy: 72.09
Round  23, Train loss: 0.555, Test loss: 0.725, Test accuracy: 72.56
Round  24, Train loss: 0.632, Test loss: 0.700, Test accuracy: 73.64
Round  25, Train loss: 0.557, Test loss: 0.700, Test accuracy: 73.57
Round  26, Train loss: 0.543, Test loss: 0.688, Test accuracy: 73.85
Round  27, Train loss: 0.512, Test loss: 0.681, Test accuracy: 74.10
Round  28, Train loss: 0.538, Test loss: 0.684, Test accuracy: 74.47
Round  29, Train loss: 0.444, Test loss: 0.678, Test accuracy: 74.68
Round  30, Train loss: 0.526, Test loss: 0.677, Test accuracy: 74.77
Round  31, Train loss: 0.517, Test loss: 0.686, Test accuracy: 74.09
Round  32, Train loss: 0.455, Test loss: 0.693, Test accuracy: 73.70
Round  33, Train loss: 0.537, Test loss: 0.696, Test accuracy: 74.11
Round  34, Train loss: 0.532, Test loss: 0.682, Test accuracy: 74.98
Round  35, Train loss: 0.439, Test loss: 0.661, Test accuracy: 76.01
Round  36, Train loss: 0.462, Test loss: 0.659, Test accuracy: 75.51
Round  37, Train loss: 0.515, Test loss: 0.658, Test accuracy: 75.48
Round  38, Train loss: 0.427, Test loss: 0.662, Test accuracy: 75.89
Round  39, Train loss: 0.510, Test loss: 0.650, Test accuracy: 76.22
Round  40, Train loss: 0.436, Test loss: 0.667, Test accuracy: 75.79
Round  41, Train loss: 0.399, Test loss: 0.658, Test accuracy: 76.27
Round  42, Train loss: 0.392, Test loss: 0.658, Test accuracy: 76.53
Round  43, Train loss: 0.414, Test loss: 0.657, Test accuracy: 76.75
Round  44, Train loss: 0.430, Test loss: 0.651, Test accuracy: 76.73
Round  45, Train loss: 0.385, Test loss: 0.656, Test accuracy: 76.63
Round  46, Train loss: 0.399, Test loss: 0.650, Test accuracy: 76.50
Round  47, Train loss: 0.389, Test loss: 0.649, Test accuracy: 77.19
Round  48, Train loss: 0.383, Test loss: 0.678, Test accuracy: 76.52
Round  49, Train loss: 0.348, Test loss: 0.676, Test accuracy: 76.16
Round  50, Train loss: 0.396, Test loss: 0.677, Test accuracy: 75.91
Round  51, Train loss: 0.339, Test loss: 0.669, Test accuracy: 76.68
Round  52, Train loss: 0.332, Test loss: 0.652, Test accuracy: 76.63
Round  53, Train loss: 0.338, Test loss: 0.648, Test accuracy: 77.43
Round  54, Train loss: 0.349, Test loss: 0.655, Test accuracy: 77.11
Round  55, Train loss: 0.350, Test loss: 0.654, Test accuracy: 77.08
Round  56, Train loss: 0.337, Test loss: 0.658, Test accuracy: 77.29
Round  57, Train loss: 0.333, Test loss: 0.661, Test accuracy: 77.09
Round  58, Train loss: 0.315, Test loss: 0.654, Test accuracy: 77.09
Round  59, Train loss: 0.337, Test loss: 0.642, Test accuracy: 77.65
Round  60, Train loss: 0.319, Test loss: 0.667, Test accuracy: 76.87
Round  61, Train loss: 0.282, Test loss: 0.664, Test accuracy: 77.01
Round  62, Train loss: 0.321, Test loss: 0.661, Test accuracy: 77.40
Round  63, Train loss: 0.254, Test loss: 0.675, Test accuracy: 77.29
Round  64, Train loss: 0.347, Test loss: 0.693, Test accuracy: 76.40
Round  65, Train loss: 0.295, Test loss: 0.690, Test accuracy: 76.98
Round  66, Train loss: 0.274, Test loss: 0.709, Test accuracy: 76.68
Round  67, Train loss: 0.283, Test loss: 0.692, Test accuracy: 76.71
Round  68, Train loss: 0.265, Test loss: 0.686, Test accuracy: 77.10
Round  69, Train loss: 0.288, Test loss: 0.680, Test accuracy: 77.15
Round  70, Train loss: 0.283, Test loss: 0.689, Test accuracy: 76.98
Round  71, Train loss: 0.308, Test loss: 0.684, Test accuracy: 77.24
Round  72, Train loss: 0.310, Test loss: 0.673, Test accuracy: 77.69
Round  73, Train loss: 0.268, Test loss: 0.663, Test accuracy: 77.36
Round  74, Train loss: 0.273, Test loss: 0.672, Test accuracy: 77.62
Round  75, Train loss: 0.221, Test loss: 0.679, Test accuracy: 77.38
Round  76, Train loss: 0.179, Test loss: 0.700, Test accuracy: 77.25
Round  77, Train loss: 0.277, Test loss: 0.675, Test accuracy: 77.11
Round  78, Train loss: 0.250, Test loss: 0.687, Test accuracy: 77.17
Round  79, Train loss: 0.232, Test loss: 0.671, Test accuracy: 76.92
Round  80, Train loss: 0.274, Test loss: 0.674, Test accuracy: 77.15
Round  81, Train loss: 0.278, Test loss: 0.684, Test accuracy: 77.33
Round  82, Train loss: 0.213, Test loss: 0.693, Test accuracy: 77.40
Round  83, Train loss: 0.260, Test loss: 0.691, Test accuracy: 77.38
Round  84, Train loss: 0.258, Test loss: 0.704, Test accuracy: 77.17
Round  85, Train loss: 0.199, Test loss: 0.702, Test accuracy: 77.12
Round  86, Train loss: 0.225, Test loss: 0.696, Test accuracy: 77.30
Round  87, Train loss: 0.222, Test loss: 0.703, Test accuracy: 77.15
Round  88, Train loss: 0.241, Test loss: 0.678, Test accuracy: 77.56
Round  89, Train loss: 0.209, Test loss: 0.695, Test accuracy: 77.29
Round  90, Train loss: 0.244, Test loss: 0.699, Test accuracy: 77.31
Round  91, Train loss: 0.252, Test loss: 0.703, Test accuracy: 77.29
Round  92, Train loss: 0.221, Test loss: 0.690, Test accuracy: 77.42
Round  93, Train loss: 0.210, Test loss: 0.691, Test accuracy: 77.50
Round  94, Train loss: 0.207, Test loss: 0.692, Test accuracy: 77.24
Round  95, Train loss: 0.255, Test loss: 0.700, Test accuracy: 77.11
Round  96, Train loss: 0.282, Test loss: 0.680, Test accuracy: 77.87
Round  97, Train loss: 0.245, Test loss: 0.713, Test accuracy: 77.20
Round  98, Train loss: 0.206, Test loss: 0.701, Test accuracy: 77.34
Round  99, Train loss: 0.215, Test loss: 0.704, Test accuracy: 77.16
Final Round, Train loss: 0.211, Test loss: 0.697, Test accuracy: 77.47
Average accuracy final 10 rounds: 77.344
2805.18484210968
[3.153613328933716, 5.953075408935547, 8.754918098449707, 11.551411151885986, 14.339996576309204, 17.143418073654175, 19.94435143470764, 22.76191234588623, 25.562263011932373, 28.36044454574585, 31.148375749588013, 33.937532901763916, 36.74227809906006, 39.54128694534302, 42.3120481967926, 45.07760572433472, 47.84290623664856, 50.60622596740723, 53.38326978683472, 56.167280197143555, 58.948548555374146, 63.61666655540466, 68.22871494293213, 72.89618635177612, 77.56396746635437, 82.22449159622192, 86.89591026306152, 91.57347679138184, 96.2148847579956, 100.8388659954071, 105.3814058303833, 109.9148952960968, 114.60650753974915, 119.36826705932617, 124.13333415985107, 128.86550998687744, 133.62888479232788, 138.39278435707092, 143.16879773139954, 147.93158316612244, 152.6832616329193, 157.45183300971985, 162.1977961063385, 166.9516794681549, 171.72702646255493, 176.48756670951843, 181.25693702697754, 186.00204968452454, 190.74678683280945, 195.5108253955841, 200.29767441749573, 205.06821417808533, 209.84751844406128, 214.63801407814026, 219.35843467712402, 224.0969054698944, 228.83295893669128, 233.61154294013977, 238.36768198013306, 243.1052122116089, 247.8304455280304, 252.28824591636658, 256.7643973827362, 261.230744600296, 265.70348143577576, 270.16495871543884, 274.63616394996643, 279.1032247543335, 283.587283372879, 288.0564615726471, 292.50366377830505, 296.9426748752594, 301.3946294784546, 305.841267824173, 310.31484746932983, 314.78323435783386, 319.3136441707611, 323.7747268676758, 328.226211309433, 332.69345712661743, 337.145236492157, 341.6040835380554, 346.06161856651306, 350.5373435020447, 355.00358152389526, 359.4564034938812, 363.91524958610535, 368.36302042007446, 372.8174903392792, 377.2915575504303, 381.7634963989258, 386.235714673996, 390.6915695667267, 395.15317034721375, 399.59622836112976, 404.0659968852997, 408.4974431991577, 412.95994567871094, 417.47706031799316, 421.9396777153015, 426.0325927734375]
[29.56, 35.94, 44.89, 49.44, 54.91, 56.6, 57.61, 61.82, 63.7, 64.92, 65.88, 66.61, 68.34, 68.11, 68.94, 69.47, 69.52, 69.68, 70.21, 71.24, 71.22, 72.24, 72.09, 72.56, 73.64, 73.57, 73.85, 74.1, 74.47, 74.68, 74.77, 74.09, 73.7, 74.11, 74.98, 76.01, 75.51, 75.48, 75.89, 76.22, 75.79, 76.27, 76.53, 76.75, 76.73, 76.63, 76.5, 77.19, 76.52, 76.16, 75.91, 76.68, 76.63, 77.43, 77.11, 77.08, 77.29, 77.09, 77.09, 77.65, 76.87, 77.01, 77.4, 77.29, 76.4, 76.98, 76.68, 76.71, 77.1, 77.15, 76.98, 77.24, 77.69, 77.36, 77.62, 77.38, 77.25, 77.11, 77.17, 76.92, 77.15, 77.33, 77.4, 77.38, 77.17, 77.12, 77.3, 77.15, 77.56, 77.29, 77.31, 77.29, 77.42, 77.5, 77.24, 77.11, 77.87, 77.2, 77.34, 77.16, 77.47]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.656, Test loss: 1.579, Test accuracy: 38.34
Round   1, Train loss: 1.281, Test loss: 1.231, Test accuracy: 50.02
Round   2, Train loss: 1.124, Test loss: 1.086, Test accuracy: 56.57
Round   3, Train loss: 1.038, Test loss: 1.017, Test accuracy: 59.51
Round   4, Train loss: 0.989, Test loss: 0.975, Test accuracy: 61.30
Round   5, Train loss: 0.945, Test loss: 0.938, Test accuracy: 62.56
Round   6, Train loss: 0.902, Test loss: 0.904, Test accuracy: 64.44
Round   7, Train loss: 0.867, Test loss: 0.882, Test accuracy: 65.32
Round   8, Train loss: 0.834, Test loss: 0.857, Test accuracy: 66.62
Round   9, Train loss: 0.802, Test loss: 0.824, Test accuracy: 67.82
Round  10, Train loss: 0.771, Test loss: 0.806, Test accuracy: 68.19
Round  11, Train loss: 0.745, Test loss: 0.785, Test accuracy: 69.57
Round  12, Train loss: 0.720, Test loss: 0.771, Test accuracy: 70.41
Round  13, Train loss: 0.698, Test loss: 0.759, Test accuracy: 70.91
Round  14, Train loss: 0.680, Test loss: 0.754, Test accuracy: 70.69
Round  15, Train loss: 0.663, Test loss: 0.745, Test accuracy: 71.24
Round  16, Train loss: 0.639, Test loss: 0.732, Test accuracy: 72.11
Round  17, Train loss: 0.620, Test loss: 0.717, Test accuracy: 72.67
Round  18, Train loss: 0.608, Test loss: 0.716, Test accuracy: 73.19
Round  19, Train loss: 0.590, Test loss: 0.705, Test accuracy: 73.55
Round  20, Train loss: 0.568, Test loss: 0.729, Test accuracy: 72.86
Round  21, Train loss: 0.570, Test loss: 0.748, Test accuracy: 72.04
Round  22, Train loss: 0.568, Test loss: 0.743, Test accuracy: 71.93
Round  23, Train loss: 0.534, Test loss: 0.727, Test accuracy: 73.17
Round  24, Train loss: 0.562, Test loss: 0.704, Test accuracy: 73.71
Round  25, Train loss: 0.498, Test loss: 0.702, Test accuracy: 73.58
Round  26, Train loss: 0.495, Test loss: 0.701, Test accuracy: 73.78
Round  27, Train loss: 0.503, Test loss: 0.690, Test accuracy: 73.99
Round  28, Train loss: 0.494, Test loss: 0.678, Test accuracy: 74.59
Round  29, Train loss: 0.443, Test loss: 0.695, Test accuracy: 74.15
Round  30, Train loss: 0.474, Test loss: 0.668, Test accuracy: 74.85
Round  31, Train loss: 0.502, Test loss: 0.666, Test accuracy: 75.42
Round  32, Train loss: 0.456, Test loss: 0.663, Test accuracy: 75.20
Round  33, Train loss: 0.474, Test loss: 0.671, Test accuracy: 75.07
Round  34, Train loss: 0.471, Test loss: 0.675, Test accuracy: 75.29
Round  35, Train loss: 0.415, Test loss: 0.674, Test accuracy: 75.68
Round  36, Train loss: 0.469, Test loss: 0.660, Test accuracy: 76.01
Round  37, Train loss: 0.492, Test loss: 0.669, Test accuracy: 75.85
Round  38, Train loss: 0.428, Test loss: 0.662, Test accuracy: 76.27
Round  39, Train loss: 0.464, Test loss: 0.671, Test accuracy: 75.51
Round  40, Train loss: 0.384, Test loss: 0.665, Test accuracy: 76.00
Round  41, Train loss: 0.347, Test loss: 0.657, Test accuracy: 76.39
Round  42, Train loss: 0.388, Test loss: 0.649, Test accuracy: 76.72
Round  43, Train loss: 0.393, Test loss: 0.660, Test accuracy: 76.82
Round  44, Train loss: 0.411, Test loss: 0.669, Test accuracy: 76.28
Round  45, Train loss: 0.369, Test loss: 0.658, Test accuracy: 76.92
Round  46, Train loss: 0.403, Test loss: 0.658, Test accuracy: 76.89
Round  47, Train loss: 0.358, Test loss: 0.672, Test accuracy: 76.26
Round  48, Train loss: 0.333, Test loss: 0.650, Test accuracy: 76.86
Round  49, Train loss: 0.324, Test loss: 0.669, Test accuracy: 76.41
Round  50, Train loss: 0.380, Test loss: 0.676, Test accuracy: 76.28
Round  51, Train loss: 0.344, Test loss: 0.673, Test accuracy: 76.35
Round  52, Train loss: 0.337, Test loss: 0.669, Test accuracy: 76.89
Round  53, Train loss: 0.290, Test loss: 0.686, Test accuracy: 76.45
Round  54, Train loss: 0.332, Test loss: 0.692, Test accuracy: 76.34
Round  55, Train loss: 0.321, Test loss: 0.712, Test accuracy: 76.17
Round  56, Train loss: 0.334, Test loss: 0.698, Test accuracy: 76.72
Round  57, Train loss: 0.315, Test loss: 0.691, Test accuracy: 76.59
Round  58, Train loss: 0.296, Test loss: 0.684, Test accuracy: 76.64
Round  59, Train loss: 0.332, Test loss: 0.674, Test accuracy: 76.78
Round  60, Train loss: 0.304, Test loss: 0.667, Test accuracy: 77.02
Round  61, Train loss: 0.284, Test loss: 0.668, Test accuracy: 77.05
Round  62, Train loss: 0.288, Test loss: 0.681, Test accuracy: 77.33
Round  63, Train loss: 0.234, Test loss: 0.677, Test accuracy: 77.15
Round  64, Train loss: 0.338, Test loss: 0.674, Test accuracy: 77.32
Round  65, Train loss: 0.276, Test loss: 0.676, Test accuracy: 77.34
Round  66, Train loss: 0.244, Test loss: 0.683, Test accuracy: 77.20
Round  67, Train loss: 0.266, Test loss: 0.686, Test accuracy: 77.11
Round  68, Train loss: 0.252, Test loss: 0.692, Test accuracy: 76.65
Round  69, Train loss: 0.295, Test loss: 0.689, Test accuracy: 77.07
Round  70, Train loss: 0.281, Test loss: 0.682, Test accuracy: 76.97
Round  71, Train loss: 0.272, Test loss: 0.697, Test accuracy: 77.05
Round  72, Train loss: 0.304, Test loss: 0.710, Test accuracy: 76.37
Round  73, Train loss: 0.260, Test loss: 0.685, Test accuracy: 76.98
Round  74, Train loss: 0.285, Test loss: 0.689, Test accuracy: 77.68
Round  75, Train loss: 0.224, Test loss: 0.696, Test accuracy: 77.29
Round  76, Train loss: 0.196, Test loss: 0.701, Test accuracy: 77.23
Round  77, Train loss: 0.267, Test loss: 0.684, Test accuracy: 77.21
Round  78, Train loss: 0.247, Test loss: 0.700, Test accuracy: 77.16
Round  79, Train loss: 0.221, Test loss: 0.706, Test accuracy: 76.93
Round  80, Train loss: 0.247, Test loss: 0.668, Test accuracy: 77.84
Round  81, Train loss: 0.236, Test loss: 0.685, Test accuracy: 77.68
Round  82, Train loss: 0.234, Test loss: 0.688, Test accuracy: 77.72
Round  83, Train loss: 0.229, Test loss: 0.683, Test accuracy: 77.95
Round  84, Train loss: 0.225, Test loss: 0.689, Test accuracy: 78.03
Round  85, Train loss: 0.221, Test loss: 0.698, Test accuracy: 77.73
Round  86, Train loss: 0.223, Test loss: 0.693, Test accuracy: 77.47
Round  87, Train loss: 0.217, Test loss: 0.697, Test accuracy: 77.66
Round  88, Train loss: 0.217, Test loss: 0.702, Test accuracy: 77.35
Round  89, Train loss: 0.216, Test loss: 0.688, Test accuracy: 78.01
Round  90, Train loss: 0.212, Test loss: 0.696, Test accuracy: 77.80
Round  91, Train loss: 0.210, Test loss: 0.708, Test accuracy: 77.72
Round  92, Train loss: 0.206, Test loss: 0.696, Test accuracy: 77.91
Round  93, Train loss: 0.203, Test loss: 0.701, Test accuracy: 78.37
Round  94, Train loss: 0.201, Test loss: 0.712, Test accuracy: 77.69
Round  95, Train loss: 0.196, Test loss: 0.719, Test accuracy: 77.74
Round  96, Train loss: 0.199, Test loss: 0.715, Test accuracy: 77.60
Round  97, Train loss: 0.198, Test loss: 0.709, Test accuracy: 77.96
Round  98, Train loss: 0.196, Test loss: 0.711, Test accuracy: 77.88
Round  99, Train loss: 0.198, Test loss: 0.724, Test accuracy: 77.76
Final Round, Train loss: 0.163, Test loss: 0.712, Test accuracy: 78.10
Average accuracy final 10 rounds: 77.84299999999999
3171.849135875702
[2.877904176712036, 5.429749488830566, 7.978505611419678, 10.542103052139282, 13.10051441192627, 15.642285823822021, 18.183206796646118, 20.753779649734497, 23.31409764289856, 25.871320724487305, 28.41724729537964, 30.974750757217407, 33.53320384025574, 36.0969500541687, 38.659011363983154, 41.225454568862915, 43.795193910598755, 46.355509996414185, 48.9138617515564, 51.474321603775024, 54.03503608703613, 56.59272480010986, 59.153608083724976, 61.690821409225464, 64.23153233528137, 66.78170657157898, 69.32267594337463, 71.8640558719635, 74.40276193618774, 76.94743251800537, 79.491459608078, 82.05075192451477, 84.60838389396667, 87.16917276382446, 89.72686505317688, 92.28495240211487, 94.83432841300964, 97.3739173412323, 99.91434288024902, 102.46435570716858, 105.00455141067505, 107.5548186302185, 110.09389519691467, 112.6365225315094, 115.17379331588745, 117.71529936790466, 120.25652551651001, 122.80077576637268, 125.34469199180603, 127.89572310447693, 130.43143963813782, 132.96617937088013, 135.50282192230225, 138.0460991859436, 140.59077167510986, 143.1326973438263, 145.6746804714203, 148.2113618850708, 150.75057673454285, 153.3123278617859, 155.87509751319885, 158.4309537410736, 160.9882369041443, 163.55420327186584, 166.11405992507935, 168.67747330665588, 171.23330354690552, 173.7926287651062, 176.35487008094788, 178.92400670051575, 181.48078441619873, 184.02318406105042, 186.56310963630676, 189.10831928253174, 191.64752173423767, 194.19369626045227, 196.7360076904297, 199.2777440547943, 201.81898522377014, 204.3623833656311, 206.90638709068298, 209.46119332313538, 212.0185980796814, 214.57717943191528, 217.1262183189392, 219.67906975746155, 221.9566969871521, 224.23125767707825, 226.50880241394043, 228.78718543052673, 231.07265257835388, 233.35784029960632, 235.64342713356018, 237.92455410957336, 240.2099964618683, 242.4905345439911, 244.78557682037354, 247.07222986221313, 249.34686923027039, 251.6284146308899, 255.33604907989502]
[38.34, 50.02, 56.57, 59.51, 61.3, 62.56, 64.44, 65.32, 66.62, 67.82, 68.19, 69.57, 70.41, 70.91, 70.69, 71.24, 72.11, 72.67, 73.19, 73.55, 72.86, 72.04, 71.93, 73.17, 73.71, 73.58, 73.78, 73.99, 74.59, 74.15, 74.85, 75.42, 75.2, 75.07, 75.29, 75.68, 76.01, 75.85, 76.27, 75.51, 76.0, 76.39, 76.72, 76.82, 76.28, 76.92, 76.89, 76.26, 76.86, 76.41, 76.28, 76.35, 76.89, 76.45, 76.34, 76.17, 76.72, 76.59, 76.64, 76.78, 77.02, 77.05, 77.33, 77.15, 77.32, 77.34, 77.2, 77.11, 76.65, 77.07, 76.97, 77.05, 76.37, 76.98, 77.68, 77.29, 77.23, 77.21, 77.16, 76.93, 77.84, 77.68, 77.72, 77.95, 78.03, 77.73, 77.47, 77.66, 77.35, 78.01, 77.8, 77.72, 77.91, 78.37, 77.69, 77.74, 77.6, 77.96, 77.88, 77.76, 78.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.680, Test loss: 1.601, Test accuracy: 37.69
Round   1, Train loss: 1.317, Test loss: 1.259, Test accuracy: 48.08
Round   2, Train loss: 1.154, Test loss: 1.118, Test accuracy: 53.64
Round   3, Train loss: 1.067, Test loss: 1.016, Test accuracy: 59.37
Round   4, Train loss: 1.010, Test loss: 0.995, Test accuracy: 60.02
Round   5, Train loss: 0.965, Test loss: 0.935, Test accuracy: 62.59
Round   6, Train loss: 0.927, Test loss: 0.914, Test accuracy: 64.33
Round   7, Train loss: 0.898, Test loss: 0.902, Test accuracy: 64.06
Round   8, Train loss: 0.864, Test loss: 0.866, Test accuracy: 66.16
Round   9, Train loss: 0.833, Test loss: 0.851, Test accuracy: 66.67
Round  10, Train loss: 0.808, Test loss: 0.820, Test accuracy: 67.67
Round  11, Train loss: 0.785, Test loss: 0.814, Test accuracy: 68.36
Round  12, Train loss: 0.760, Test loss: 0.787, Test accuracy: 69.43
Round  13, Train loss: 0.740, Test loss: 0.789, Test accuracy: 69.62
Round  14, Train loss: 0.716, Test loss: 0.762, Test accuracy: 70.54
Round  15, Train loss: 0.695, Test loss: 0.761, Test accuracy: 70.36
Round  16, Train loss: 0.677, Test loss: 0.745, Test accuracy: 71.46
Round  17, Train loss: 0.659, Test loss: 0.734, Test accuracy: 71.65
Round  18, Train loss: 0.642, Test loss: 0.723, Test accuracy: 72.35
Round  19, Train loss: 0.628, Test loss: 0.719, Test accuracy: 72.75
Round  20, Train loss: 0.641, Test loss: 0.720, Test accuracy: 72.43
Round  21, Train loss: 0.576, Test loss: 0.709, Test accuracy: 73.42
Round  22, Train loss: 0.618, Test loss: 0.731, Test accuracy: 72.82
Round  23, Train loss: 0.565, Test loss: 0.724, Test accuracy: 73.12
Round  24, Train loss: 0.650, Test loss: 0.714, Test accuracy: 73.46
Round  25, Train loss: 0.525, Test loss: 0.700, Test accuracy: 74.20
Round  26, Train loss: 0.560, Test loss: 0.697, Test accuracy: 74.35
Round  27, Train loss: 0.486, Test loss: 0.691, Test accuracy: 74.30
Round  28, Train loss: 0.561, Test loss: 0.703, Test accuracy: 73.91
Round  29, Train loss: 0.453, Test loss: 0.702, Test accuracy: 74.02
Round  30, Train loss: 0.481, Test loss: 0.697, Test accuracy: 74.48
Round  31, Train loss: 0.509, Test loss: 0.681, Test accuracy: 74.48
Round  32, Train loss: 0.482, Test loss: 0.684, Test accuracy: 74.84
Round  33, Train loss: 0.517, Test loss: 0.683, Test accuracy: 74.87
Round  34, Train loss: 0.540, Test loss: 0.712, Test accuracy: 74.42
Round  35, Train loss: 0.450, Test loss: 0.694, Test accuracy: 74.93
Round  36, Train loss: 0.472, Test loss: 0.686, Test accuracy: 75.70
Round  37, Train loss: 0.570, Test loss: 0.694, Test accuracy: 75.22
Round  38, Train loss: 0.438, Test loss: 0.681, Test accuracy: 75.61
Round  39, Train loss: 0.497, Test loss: 0.692, Test accuracy: 75.24
Round  40, Train loss: 0.433, Test loss: 0.686, Test accuracy: 75.27
Round  41, Train loss: 0.390, Test loss: 0.695, Test accuracy: 75.32
Round  42, Train loss: 0.421, Test loss: 0.673, Test accuracy: 76.02
Round  43, Train loss: 0.457, Test loss: 0.695, Test accuracy: 75.39
Round  44, Train loss: 0.437, Test loss: 0.690, Test accuracy: 75.31
Round  45, Train loss: 0.407, Test loss: 0.699, Test accuracy: 75.31
Round  46, Train loss: 0.428, Test loss: 0.692, Test accuracy: 75.26
Round  47, Train loss: 0.375, Test loss: 0.687, Test accuracy: 75.88
Round  48, Train loss: 0.386, Test loss: 0.698, Test accuracy: 75.88
Round  49, Train loss: 0.340, Test loss: 0.673, Test accuracy: 76.57
Round  50, Train loss: 0.404, Test loss: 0.679, Test accuracy: 76.16
Round  51, Train loss: 0.359, Test loss: 0.688, Test accuracy: 75.94
Round  52, Train loss: 0.347, Test loss: 0.668, Test accuracy: 76.73
Round  53, Train loss: 0.330, Test loss: 0.687, Test accuracy: 76.28
Round  54, Train loss: 0.366, Test loss: 0.695, Test accuracy: 76.09
Round  55, Train loss: 0.342, Test loss: 0.712, Test accuracy: 75.54
Round  56, Train loss: 0.352, Test loss: 0.715, Test accuracy: 75.64
Round  57, Train loss: 0.412, Test loss: 0.728, Test accuracy: 75.64
Round  58, Train loss: 0.313, Test loss: 0.697, Test accuracy: 76.02
Round  59, Train loss: 0.394, Test loss: 0.702, Test accuracy: 76.00
Round  60, Train loss: 0.295, Test loss: 0.698, Test accuracy: 76.30
Round  61, Train loss: 0.309, Test loss: 0.696, Test accuracy: 76.18
Round  62, Train loss: 0.332, Test loss: 0.705, Test accuracy: 76.15
Round  63, Train loss: 0.241, Test loss: 0.708, Test accuracy: 75.93
Round  64, Train loss: 0.394, Test loss: 0.729, Test accuracy: 75.95
Round  65, Train loss: 0.308, Test loss: 0.714, Test accuracy: 75.52
Round  66, Train loss: 0.261, Test loss: 0.713, Test accuracy: 75.76
Round  67, Train loss: 0.308, Test loss: 0.723, Test accuracy: 75.37
Round  68, Train loss: 0.279, Test loss: 0.711, Test accuracy: 76.20
Round  69, Train loss: 0.307, Test loss: 0.703, Test accuracy: 75.98
Round  70, Train loss: 0.297, Test loss: 0.706, Test accuracy: 76.33
Round  71, Train loss: 0.282, Test loss: 0.708, Test accuracy: 75.79
Round  72, Train loss: 0.353, Test loss: 0.716, Test accuracy: 76.22
Round  73, Train loss: 0.304, Test loss: 0.697, Test accuracy: 76.78
Round  74, Train loss: 0.296, Test loss: 0.726, Test accuracy: 76.02
Round  75, Train loss: 0.217, Test loss: 0.756, Test accuracy: 75.58
Round  76, Train loss: 0.199, Test loss: 0.742, Test accuracy: 75.44
Round  77, Train loss: 0.317, Test loss: 0.719, Test accuracy: 75.98
Round  78, Train loss: 0.288, Test loss: 0.728, Test accuracy: 76.00
Round  79, Train loss: 0.232, Test loss: 0.730, Test accuracy: 76.03
Round  80, Train loss: 0.278, Test loss: 0.704, Test accuracy: 76.93
Round  81, Train loss: 0.271, Test loss: 0.718, Test accuracy: 76.50
Round  82, Train loss: 0.263, Test loss: 0.712, Test accuracy: 76.77
Round  83, Train loss: 0.257, Test loss: 0.706, Test accuracy: 76.81
Round  84, Train loss: 0.256, Test loss: 0.700, Test accuracy: 77.04
Round  85, Train loss: 0.249, Test loss: 0.708, Test accuracy: 77.10
Round  86, Train loss: 0.246, Test loss: 0.721, Test accuracy: 76.56
Round  87, Train loss: 0.242, Test loss: 0.719, Test accuracy: 76.96
Round  88, Train loss: 0.242, Test loss: 0.713, Test accuracy: 76.92
Round  89, Train loss: 0.238, Test loss: 0.720, Test accuracy: 76.70
Round  90, Train loss: 0.237, Test loss: 0.714, Test accuracy: 77.15
Round  91, Train loss: 0.234, Test loss: 0.715, Test accuracy: 76.59
Round  92, Train loss: 0.241, Test loss: 0.725, Test accuracy: 76.84
Round  93, Train loss: 0.231, Test loss: 0.729, Test accuracy: 76.82
Round  94, Train loss: 0.227, Test loss: 0.729, Test accuracy: 76.70
Round  95, Train loss: 0.224, Test loss: 0.726, Test accuracy: 76.88
Round  96, Train loss: 0.226, Test loss: 0.728, Test accuracy: 77.05
Round  97, Train loss: 0.222, Test loss: 0.735, Test accuracy: 76.59
Round  98, Train loss: 0.216, Test loss: 0.732, Test accuracy: 77.03
Round  99, Train loss: 0.219, Test loss: 0.750, Test accuracy: 76.64
Final Round, Train loss: 0.193, Test loss: 0.739, Test accuracy: 76.93
Average accuracy final 10 rounds: 76.82900000000001
4490.82200050354
[2.8947789669036865, 5.443880081176758, 7.995021820068359, 10.546672344207764, 13.097217321395874, 15.658146858215332, 18.21925187110901, 20.782147884368896, 23.33097815513611, 25.881850481033325, 28.44670081138611, 31.012723207473755, 33.578930377960205, 36.141764640808105, 38.70829701423645, 41.27077078819275, 43.834519147872925, 46.40290904045105, 48.96473813056946, 51.52833390235901, 54.07594537734985, 58.31315302848816, 62.55163764953613, 66.79162764549255, 71.02143621444702, 75.25357341766357, 79.48728632926941, 83.72812795639038, 87.98182344436646, 92.2515938282013, 96.52672791481018, 100.80588126182556, 105.15054512023926, 109.42521619796753, 113.6965684890747, 117.96839165687561, 122.24909543991089, 126.53644251823425, 130.81346583366394, 135.08929252624512, 139.36532163619995, 143.64691281318665, 147.88503408432007, 152.13135600090027, 156.3616545200348, 160.60385704040527, 164.8485562801361, 169.04289507865906, 173.06864547729492, 177.08265614509583, 181.0964014530182, 185.1190469264984, 189.1322157382965, 193.12114191055298, 197.10880827903748, 201.16123056411743, 205.17039823532104, 209.1903200149536, 213.20374250411987, 217.21041345596313, 221.2305669784546, 225.24704384803772, 229.2533781528473, 233.2647681236267, 237.21938633918762, 241.17974376678467, 245.21354031562805, 249.26646971702576, 253.31560015678406, 257.37450313568115, 261.39625906944275, 265.41259026527405, 269.4287450313568, 273.4086916446686, 277.3957166671753, 281.4099020957947, 285.420138835907, 289.4120104312897, 293.43159341812134, 297.4205732345581, 301.44556999206543, 305.52283811569214, 309.536251783371, 313.55816435813904, 317.58089113235474, 321.58565306663513, 325.6323049068451, 329.7104470729828, 334.2547826766968, 338.7864844799042, 343.28983879089355, 347.8540337085724, 352.45073914527893, 356.9863917827606, 361.541921377182, 366.1261525154114, 370.72451424598694, 375.43590259552, 380.142130613327, 384.86474418640137, 388.95299315452576]
[37.69, 48.08, 53.64, 59.37, 60.02, 62.59, 64.33, 64.06, 66.16, 66.67, 67.67, 68.36, 69.43, 69.62, 70.54, 70.36, 71.46, 71.65, 72.35, 72.75, 72.43, 73.42, 72.82, 73.12, 73.46, 74.2, 74.35, 74.3, 73.91, 74.02, 74.48, 74.48, 74.84, 74.87, 74.42, 74.93, 75.7, 75.22, 75.61, 75.24, 75.27, 75.32, 76.02, 75.39, 75.31, 75.31, 75.26, 75.88, 75.88, 76.57, 76.16, 75.94, 76.73, 76.28, 76.09, 75.54, 75.64, 75.64, 76.02, 76.0, 76.3, 76.18, 76.15, 75.93, 75.95, 75.52, 75.76, 75.37, 76.2, 75.98, 76.33, 75.79, 76.22, 76.78, 76.02, 75.58, 75.44, 75.98, 76.0, 76.03, 76.93, 76.5, 76.77, 76.81, 77.04, 77.1, 76.56, 76.96, 76.92, 76.7, 77.15, 76.59, 76.84, 76.82, 76.7, 76.88, 77.05, 76.59, 77.03, 76.64, 76.93]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.672, Test loss: 2.157, Test accuracy: 20.63
Round   0, Global train loss: 1.672, Global test loss: 2.333, Global test accuracy: 17.13
Round   1, Train loss: 1.505, Test loss: 1.893, Test accuracy: 26.93
Round   1, Global train loss: 1.505, Global test loss: 2.203, Global test accuracy: 22.07
Round   2, Train loss: 1.438, Test loss: 1.630, Test accuracy: 35.06
Round   2, Global train loss: 1.438, Global test loss: 2.052, Global test accuracy: 27.11
Round   3, Train loss: 1.291, Test loss: 1.597, Test accuracy: 37.90
Round   3, Global train loss: 1.291, Global test loss: 2.163, Global test accuracy: 30.60
Round   4, Train loss: 1.227, Test loss: 1.426, Test accuracy: 40.90
Round   4, Global train loss: 1.227, Global test loss: 1.958, Global test accuracy: 27.58
Round   5, Train loss: 1.443, Test loss: 1.423, Test accuracy: 41.69
Round   5, Global train loss: 1.443, Global test loss: 2.072, Global test accuracy: 24.48
Round   6, Train loss: 1.232, Test loss: 1.392, Test accuracy: 43.50
Round   6, Global train loss: 1.232, Global test loss: 2.255, Global test accuracy: 25.05
Round   7, Train loss: 1.330, Test loss: 1.368, Test accuracy: 44.73
Round   7, Global train loss: 1.330, Global test loss: 2.031, Global test accuracy: 29.20
Round   8, Train loss: 1.124, Test loss: 1.333, Test accuracy: 46.77
Round   8, Global train loss: 1.124, Global test loss: 1.911, Global test accuracy: 35.20
Round   9, Train loss: 1.055, Test loss: 1.255, Test accuracy: 49.73
Round   9, Global train loss: 1.055, Global test loss: 1.870, Global test accuracy: 33.54
Round  10, Train loss: 1.203, Test loss: 1.263, Test accuracy: 48.93
Round  10, Global train loss: 1.203, Global test loss: 2.032, Global test accuracy: 26.45
Round  11, Train loss: 1.080, Test loss: 1.276, Test accuracy: 50.06
Round  11, Global train loss: 1.080, Global test loss: 2.101, Global test accuracy: 30.89
Round  12, Train loss: 1.231, Test loss: 1.204, Test accuracy: 51.97
Round  12, Global train loss: 1.231, Global test loss: 2.003, Global test accuracy: 28.53
Round  13, Train loss: 1.106, Test loss: 1.184, Test accuracy: 52.64
Round  13, Global train loss: 1.106, Global test loss: 1.886, Global test accuracy: 35.61
Round  14, Train loss: 1.208, Test loss: 1.174, Test accuracy: 52.95
Round  14, Global train loss: 1.208, Global test loss: 2.078, Global test accuracy: 26.38
Round  15, Train loss: 1.065, Test loss: 1.180, Test accuracy: 53.10
Round  15, Global train loss: 1.065, Global test loss: 1.976, Global test accuracy: 30.76
Round  16, Train loss: 1.003, Test loss: 1.193, Test accuracy: 52.82
Round  16, Global train loss: 1.003, Global test loss: 1.936, Global test accuracy: 33.24
Round  17, Train loss: 1.156, Test loss: 1.195, Test accuracy: 52.73
Round  17, Global train loss: 1.156, Global test loss: 2.035, Global test accuracy: 28.33
Round  18, Train loss: 1.070, Test loss: 1.173, Test accuracy: 53.36
Round  18, Global train loss: 1.070, Global test loss: 1.870, Global test accuracy: 35.12
Round  19, Train loss: 0.764, Test loss: 1.164, Test accuracy: 53.46
Round  19, Global train loss: 0.764, Global test loss: 1.982, Global test accuracy: 31.57
Round  20, Train loss: 0.952, Test loss: 1.182, Test accuracy: 53.32
Round  20, Global train loss: 0.952, Global test loss: 1.913, Global test accuracy: 33.43
Round  21, Train loss: 1.039, Test loss: 1.195, Test accuracy: 53.67
Round  21, Global train loss: 1.039, Global test loss: 1.996, Global test accuracy: 33.17
Round  22, Train loss: 0.956, Test loss: 1.204, Test accuracy: 53.50
Round  22, Global train loss: 0.956, Global test loss: 1.959, Global test accuracy: 28.37
Round  23, Train loss: 0.955, Test loss: 1.196, Test accuracy: 53.64
Round  23, Global train loss: 0.955, Global test loss: 2.138, Global test accuracy: 22.88
Round  24, Train loss: 0.701, Test loss: 1.209, Test accuracy: 53.75
Round  24, Global train loss: 0.701, Global test loss: 1.949, Global test accuracy: 31.57
Round  25, Train loss: 0.861, Test loss: 1.224, Test accuracy: 53.69
Round  25, Global train loss: 0.861, Global test loss: 1.852, Global test accuracy: 32.75
Round  26, Train loss: 0.879, Test loss: 1.252, Test accuracy: 53.27
Round  26, Global train loss: 0.879, Global test loss: 2.186, Global test accuracy: 28.83
Round  27, Train loss: 0.827, Test loss: 1.255, Test accuracy: 53.35
Round  27, Global train loss: 0.827, Global test loss: 2.038, Global test accuracy: 30.71
Round  28, Train loss: 0.719, Test loss: 1.250, Test accuracy: 53.78
Round  28, Global train loss: 0.719, Global test loss: 1.963, Global test accuracy: 28.84
Round  29, Train loss: 0.782, Test loss: 1.249, Test accuracy: 54.15
Round  29, Global train loss: 0.782, Global test loss: 1.985, Global test accuracy: 27.72
Round  30, Train loss: 0.610, Test loss: 1.255, Test accuracy: 53.98
Round  30, Global train loss: 0.610, Global test loss: 1.886, Global test accuracy: 33.98
Round  31, Train loss: 1.014, Test loss: 1.280, Test accuracy: 54.09
Round  31, Global train loss: 1.014, Global test loss: 1.996, Global test accuracy: 31.76
Round  32, Train loss: 0.756, Test loss: 1.284, Test accuracy: 54.17
Round  32, Global train loss: 0.756, Global test loss: 1.918, Global test accuracy: 35.32
Round  33, Train loss: 0.858, Test loss: 1.277, Test accuracy: 54.59
Round  33, Global train loss: 0.858, Global test loss: 2.017, Global test accuracy: 26.81
Round  34, Train loss: 0.700, Test loss: 1.270, Test accuracy: 54.83
Round  34, Global train loss: 0.700, Global test loss: 1.931, Global test accuracy: 34.08
Round  35, Train loss: 0.767, Test loss: 1.277, Test accuracy: 54.97
Round  35, Global train loss: 0.767, Global test loss: 1.876, Global test accuracy: 30.40
Round  36, Train loss: 0.659, Test loss: 1.316, Test accuracy: 54.57
Round  36, Global train loss: 0.659, Global test loss: 1.877, Global test accuracy: 33.20
Round  37, Train loss: 0.712, Test loss: 1.339, Test accuracy: 54.65
Round  37, Global train loss: 0.712, Global test loss: 2.066, Global test accuracy: 33.73
Round  38, Train loss: 0.541, Test loss: 1.383, Test accuracy: 54.36
Round  38, Global train loss: 0.541, Global test loss: 2.003, Global test accuracy: 31.87
Round  39, Train loss: 0.771, Test loss: 1.392, Test accuracy: 54.94
Round  39, Global train loss: 0.771, Global test loss: 1.924, Global test accuracy: 32.49
Round  40, Train loss: 0.677, Test loss: 1.422, Test accuracy: 54.67
Round  40, Global train loss: 0.677, Global test loss: 2.002, Global test accuracy: 28.86
Round  41, Train loss: 0.795, Test loss: 1.418, Test accuracy: 54.95
Round  41, Global train loss: 0.795, Global test loss: 1.894, Global test accuracy: 32.54
Round  42, Train loss: 0.592, Test loss: 1.461, Test accuracy: 54.79
Round  42, Global train loss: 0.592, Global test loss: 1.816, Global test accuracy: 40.40
Round  43, Train loss: 0.899, Test loss: 1.479, Test accuracy: 54.82
Round  43, Global train loss: 0.899, Global test loss: 2.109, Global test accuracy: 23.32
Round  44, Train loss: 0.629, Test loss: 1.495, Test accuracy: 55.32
Round  44, Global train loss: 0.629, Global test loss: 1.884, Global test accuracy: 34.50
Round  45, Train loss: 0.549, Test loss: 1.491, Test accuracy: 55.12
Round  45, Global train loss: 0.549, Global test loss: 1.910, Global test accuracy: 28.36
Round  46, Train loss: 0.317, Test loss: 1.513, Test accuracy: 54.99
Round  46, Global train loss: 0.317, Global test loss: 1.865, Global test accuracy: 38.05
Round  47, Train loss: 0.693, Test loss: 1.522, Test accuracy: 54.99
Round  47, Global train loss: 0.693, Global test loss: 1.867, Global test accuracy: 34.66
Round  48, Train loss: 0.417, Test loss: 1.556, Test accuracy: 55.10
Round  48, Global train loss: 0.417, Global test loss: 1.790, Global test accuracy: 37.08
Round  49, Train loss: 0.524, Test loss: 1.591, Test accuracy: 54.50
Round  49, Global train loss: 0.524, Global test loss: 1.986, Global test accuracy: 34.67
Round  50, Train loss: 0.492, Test loss: 1.594, Test accuracy: 54.13
Round  50, Global train loss: 0.492, Global test loss: 2.042, Global test accuracy: 32.43
Round  51, Train loss: 0.549, Test loss: 1.644, Test accuracy: 53.75
Round  51, Global train loss: 0.549, Global test loss: 2.003, Global test accuracy: 28.51
Round  52, Train loss: 0.330, Test loss: 1.664, Test accuracy: 53.77
Round  52, Global train loss: 0.330, Global test loss: 1.951, Global test accuracy: 30.34
Round  53, Train loss: 0.686, Test loss: 1.646, Test accuracy: 54.28
Round  53, Global train loss: 0.686, Global test loss: 1.996, Global test accuracy: 31.75
Round  54, Train loss: 0.280, Test loss: 1.674, Test accuracy: 54.59
Round  54, Global train loss: 0.280, Global test loss: 2.182, Global test accuracy: 32.21
Round  55, Train loss: 0.563, Test loss: 1.710, Test accuracy: 54.33
Round  55, Global train loss: 0.563, Global test loss: 2.053, Global test accuracy: 27.63
Round  56, Train loss: 0.432, Test loss: 1.703, Test accuracy: 55.08
Round  56, Global train loss: 0.432, Global test loss: 2.191, Global test accuracy: 31.54
Round  57, Train loss: 0.281, Test loss: 1.696, Test accuracy: 55.35
Round  57, Global train loss: 0.281, Global test loss: 1.863, Global test accuracy: 35.65
Round  58, Train loss: 0.388, Test loss: 1.742, Test accuracy: 55.30
Round  58, Global train loss: 0.388, Global test loss: 1.897, Global test accuracy: 36.47
Round  59, Train loss: 0.547, Test loss: 1.777, Test accuracy: 55.28
Round  59, Global train loss: 0.547, Global test loss: 1.963, Global test accuracy: 30.13
Round  60, Train loss: 0.332, Test loss: 1.793, Test accuracy: 55.22
Round  60, Global train loss: 0.332, Global test loss: 1.919, Global test accuracy: 30.46
Round  61, Train loss: 0.357, Test loss: 1.807, Test accuracy: 55.39
Round  61, Global train loss: 0.357, Global test loss: 2.078, Global test accuracy: 27.94
Round  62, Train loss: 0.532, Test loss: 1.864, Test accuracy: 55.08
Round  62, Global train loss: 0.532, Global test loss: 2.120, Global test accuracy: 25.85
Round  63, Train loss: 0.311, Test loss: 1.857, Test accuracy: 55.51
Round  63, Global train loss: 0.311, Global test loss: 1.949, Global test accuracy: 31.01
Round  64, Train loss: 0.444, Test loss: 1.845, Test accuracy: 55.51
Round  64, Global train loss: 0.444, Global test loss: 2.039, Global test accuracy: 26.65
Round  65, Train loss: 0.236, Test loss: 1.856, Test accuracy: 55.15
Round  65, Global train loss: 0.236, Global test loss: 1.760, Global test accuracy: 36.92
Round  66, Train loss: 0.278, Test loss: 1.933, Test accuracy: 54.40
Round  66, Global train loss: 0.278, Global test loss: 1.973, Global test accuracy: 34.57
Round  67, Train loss: 0.294, Test loss: 1.936, Test accuracy: 55.01
Round  67, Global train loss: 0.294, Global test loss: 1.994, Global test accuracy: 26.65
Round  68, Train loss: 0.197, Test loss: 1.944, Test accuracy: 55.17
Round  68, Global train loss: 0.197, Global test loss: 1.933, Global test accuracy: 30.77
Round  69, Train loss: 0.445, Test loss: 1.968, Test accuracy: 54.86
Round  69, Global train loss: 0.445, Global test loss: 1.945, Global test accuracy: 30.92
Round  70, Train loss: 0.257, Test loss: 1.977, Test accuracy: 54.99
Round  70, Global train loss: 0.257, Global test loss: 1.950, Global test accuracy: 33.35
Round  71, Train loss: 0.445, Test loss: 1.962, Test accuracy: 55.28
Round  71, Global train loss: 0.445, Global test loss: 2.009, Global test accuracy: 31.68
Round  72, Train loss: 0.375, Test loss: 2.028, Test accuracy: 54.74
Round  72, Global train loss: 0.375, Global test loss: 2.050, Global test accuracy: 28.75
Round  73, Train loss: 0.213, Test loss: 2.089, Test accuracy: 54.38
Round  73, Global train loss: 0.213, Global test loss: 2.128, Global test accuracy: 29.66
Round  74, Train loss: 0.188, Test loss: 2.075, Test accuracy: 54.75
Round  74, Global train loss: 0.188, Global test loss: 2.010, Global test accuracy: 35.35
Round  75, Train loss: 0.424, Test loss: 2.073, Test accuracy: 55.53
Round  75, Global train loss: 0.424, Global test loss: 1.966, Global test accuracy: 33.23
Round  76, Train loss: 0.211, Test loss: 2.083, Test accuracy: 55.11
Round  76, Global train loss: 0.211, Global test loss: 2.016, Global test accuracy: 33.03
Round  77, Train loss: 0.302, Test loss: 2.128, Test accuracy: 55.08
Round  77, Global train loss: 0.302, Global test loss: 1.917, Global test accuracy: 37.81
Round  78, Train loss: 0.335, Test loss: 2.159, Test accuracy: 54.50
Round  78, Global train loss: 0.335, Global test loss: 1.957, Global test accuracy: 27.30
Round  79, Train loss: 0.365, Test loss: 2.157, Test accuracy: 54.97
Round  79, Global train loss: 0.365, Global test loss: 1.953, Global test accuracy: 35.57
Round  80, Train loss: 0.258, Test loss: 2.197, Test accuracy: 54.85
Round  80, Global train loss: 0.258, Global test loss: 1.909, Global test accuracy: 32.23
Round  81, Train loss: 0.252, Test loss: 2.248, Test accuracy: 54.61
Round  81, Global train loss: 0.252, Global test loss: 2.027, Global test accuracy: 27.26
Round  82, Train loss: 0.258, Test loss: 2.234, Test accuracy: 54.87
Round  82, Global train loss: 0.258, Global test loss: 1.858, Global test accuracy: 35.95
Round  83, Train loss: 0.127, Test loss: 2.283, Test accuracy: 55.14
Round  83, Global train loss: 0.127, Global test loss: 1.829, Global test accuracy: 40.59
Round  84, Train loss: 0.153, Test loss: 2.280, Test accuracy: 55.08
Round  84, Global train loss: 0.153, Global test loss: 2.024, Global test accuracy: 38.60
Round  85, Train loss: 0.177, Test loss: 2.306, Test accuracy: 54.64
Round  85, Global train loss: 0.177, Global test loss: 2.069, Global test accuracy: 29.84
Round  86, Train loss: 0.109, Test loss: 2.331, Test accuracy: 54.85
Round  86, Global train loss: 0.109, Global test loss: 1.916, Global test accuracy: 35.85
Round  87, Train loss: 0.219, Test loss: 2.316, Test accuracy: 54.70
Round  87, Global train loss: 0.219, Global test loss: 1.962, Global test accuracy: 34.70
Round  88, Train loss: 0.089, Test loss: 2.350, Test accuracy: 55.15
Round  88, Global train loss: 0.089, Global test loss: 1.809, Global test accuracy: 39.20
Round  89, Train loss: 0.287, Test loss: 2.404, Test accuracy: 54.72
Round  89, Global train loss: 0.287, Global test loss: 1.956, Global test accuracy: 36.59
Round  90, Train loss: 0.252, Test loss: 2.410, Test accuracy: 55.07
Round  90, Global train loss: 0.252, Global test loss: 2.003, Global test accuracy: 31.22
Round  91, Train loss: 0.104, Test loss: 2.420, Test accuracy: 55.32
Round  91, Global train loss: 0.104, Global test loss: 1.801, Global test accuracy: 37.61
Round  92, Train loss: 0.308, Test loss: 2.461, Test accuracy: 55.00
Round  92, Global train loss: 0.308, Global test loss: 1.975, Global test accuracy: 28.75
Round  93, Train loss: 0.227, Test loss: 2.443, Test accuracy: 55.28
Round  93, Global train loss: 0.227, Global test loss: 1.991, Global test accuracy: 27.61
Round  94, Train loss: 0.151, Test loss: 2.446, Test accuracy: 55.66
Round  94, Global train loss: 0.151, Global test loss: 1.806, Global test accuracy: 34.45
Round  95, Train loss: 0.101, Test loss: 2.442, Test accuracy: 55.73
Round  95, Global train loss: 0.101, Global test loss: 1.951, Global test accuracy: 34.49
Round  96, Train loss: 0.152, Test loss: 2.503, Test accuracy: 55.91
Round  96, Global train loss: 0.152, Global test loss: 1.923, Global test accuracy: 33.47
Round  97, Train loss: 0.261, Test loss: 2.494, Test accuracy: 56.13
Round  97, Global train loss: 0.261, Global test loss: 2.019, Global test accuracy: 32.03
Round  98, Train loss: 0.144, Test loss: 2.511, Test accuracy: 55.96
Round  98, Global train loss: 0.144, Global test loss: 1.948, Global test accuracy: 31.20
Round  99, Train loss: 0.146, Test loss: 2.561, Test accuracy: 55.83
Round  99, Global train loss: 0.146, Global test loss: 1.848, Global test accuracy: 33.89
Final Round, Train loss: 0.164, Test loss: 2.638, Test accuracy: 55.43
Final Round, Global train loss: 0.164, Global test loss: 1.848, Global test accuracy: 33.89
Average accuracy final 10 rounds: 55.589 

Average global accuracy final 10 rounds: 32.472 

1432.1085994243622
[1.445164442062378, 2.890328884124756, 4.059027433395386, 5.227725982666016, 6.394838094711304, 7.561950206756592, 8.72931170463562, 9.896673202514648, 11.070116996765137, 12.243560791015625, 13.419098615646362, 14.5946364402771, 15.758139371871948, 16.921642303466797, 18.091012477874756, 19.260382652282715, 20.426531314849854, 21.592679977416992, 22.766356706619263, 23.940033435821533, 25.10752010345459, 26.275006771087646, 27.443090438842773, 28.6111741065979, 29.776820421218872, 30.942466735839844, 32.10462999343872, 33.2667932510376, 34.43189334869385, 35.5969934463501, 36.762990951538086, 37.928988456726074, 39.09197378158569, 40.25495910644531, 41.42042899131775, 42.585898876190186, 43.74779796600342, 44.90969705581665, 46.06451892852783, 47.219340801239014, 48.379059076309204, 49.538777351379395, 50.69541883468628, 51.852060317993164, 53.016313552856445, 54.18056678771973, 55.3506441116333, 56.520721435546875, 57.69097566604614, 58.86122989654541, 60.03213977813721, 61.203049659729004, 62.35794448852539, 63.51283931732178, 64.66668033599854, 65.8205213546753, 66.98209595680237, 68.14367055892944, 69.30986905097961, 70.47606754302979, 71.6344530582428, 72.79283857345581, 73.94935274124146, 75.1058669090271, 76.25992822647095, 77.4139895439148, 78.57025957107544, 79.72652959823608, 80.88474607467651, 82.04296255111694, 83.20375370979309, 84.36454486846924, 85.52377462387085, 86.68300437927246, 87.83812808990479, 88.99325180053711, 90.14954233169556, 91.305832862854, 92.46329808235168, 93.62076330184937, 94.7772696018219, 95.93377590179443, 97.09237408638, 98.25097227096558, 99.40479063987732, 100.55860900878906, 101.7131278514862, 102.86764669418335, 104.02146673202515, 105.17528676986694, 106.33051347732544, 107.48574018478394, 108.64499759674072, 109.80425500869751, 110.96095991134644, 112.11766481399536, 113.27452898025513, 114.43139314651489, 115.5869665145874, 116.74253988265991, 117.89871668815613, 119.05489349365234, 120.21052813529968, 121.36616277694702, 122.52699565887451, 123.687828540802, 124.84117913246155, 125.9945297241211, 127.15142750740051, 128.30832529067993, 129.46687245368958, 130.62541961669922, 131.78293919563293, 132.94045877456665, 134.0959551334381, 135.25145149230957, 136.4102873802185, 137.56912326812744, 138.7208173274994, 139.87251138687134, 141.02377009391785, 142.17502880096436, 143.33165836334229, 144.48828792572021, 145.64811277389526, 146.8079376220703, 147.96759486198425, 149.1272521018982, 150.2822458744049, 151.43723964691162, 152.5949420928955, 153.7526445388794, 154.9074056148529, 156.06216669082642, 157.21755981445312, 158.37295293807983, 159.52631163597107, 160.6796703338623, 161.83484816551208, 162.99002599716187, 164.14402794837952, 165.29802989959717, 166.45391488075256, 167.60979986190796, 168.76688528060913, 169.9239706993103, 171.0808665752411, 172.23776245117188, 173.3946566581726, 174.55155086517334, 175.71302390098572, 176.8744969367981, 178.04252576828003, 179.21055459976196, 180.377934217453, 181.54531383514404, 182.71517848968506, 183.88504314422607, 185.05157828330994, 186.2181134223938, 187.38471388816833, 188.55131435394287, 189.71783566474915, 190.88435697555542, 192.0516917705536, 193.21902656555176, 194.38410234451294, 195.54917812347412, 196.71458101272583, 197.87998390197754, 199.04961919784546, 200.21925449371338, 201.38766169548035, 202.55606889724731, 203.72656226158142, 204.89705562591553, 206.06668043136597, 207.2363052368164, 208.40180158615112, 209.56729793548584, 210.73780512809753, 211.90831232070923, 213.07604575157166, 214.24377918243408, 215.41204953193665, 216.5803198814392, 217.7460389137268, 218.9117579460144, 220.0781693458557, 221.24458074569702, 222.39996981620789, 223.55535888671875, 224.71378445625305, 225.87221002578735, 227.0269742012024, 228.18173837661743, 229.3353226184845, 230.48890686035156, 231.64901113510132, 232.80911540985107, 235.12613677978516, 237.44315814971924]
[20.63, 20.63, 26.93, 26.93, 35.06, 35.06, 37.9, 37.9, 40.9, 40.9, 41.69, 41.69, 43.5, 43.5, 44.73, 44.73, 46.77, 46.77, 49.73, 49.73, 48.93, 48.93, 50.06, 50.06, 51.97, 51.97, 52.64, 52.64, 52.95, 52.95, 53.1, 53.1, 52.82, 52.82, 52.73, 52.73, 53.36, 53.36, 53.46, 53.46, 53.32, 53.32, 53.67, 53.67, 53.5, 53.5, 53.64, 53.64, 53.75, 53.75, 53.69, 53.69, 53.27, 53.27, 53.35, 53.35, 53.78, 53.78, 54.15, 54.15, 53.98, 53.98, 54.09, 54.09, 54.17, 54.17, 54.59, 54.59, 54.83, 54.83, 54.97, 54.97, 54.57, 54.57, 54.65, 54.65, 54.36, 54.36, 54.94, 54.94, 54.67, 54.67, 54.95, 54.95, 54.79, 54.79, 54.82, 54.82, 55.32, 55.32, 55.12, 55.12, 54.99, 54.99, 54.99, 54.99, 55.1, 55.1, 54.5, 54.5, 54.13, 54.13, 53.75, 53.75, 53.77, 53.77, 54.28, 54.28, 54.59, 54.59, 54.33, 54.33, 55.08, 55.08, 55.35, 55.35, 55.3, 55.3, 55.28, 55.28, 55.22, 55.22, 55.39, 55.39, 55.08, 55.08, 55.51, 55.51, 55.51, 55.51, 55.15, 55.15, 54.4, 54.4, 55.01, 55.01, 55.17, 55.17, 54.86, 54.86, 54.99, 54.99, 55.28, 55.28, 54.74, 54.74, 54.38, 54.38, 54.75, 54.75, 55.53, 55.53, 55.11, 55.11, 55.08, 55.08, 54.5, 54.5, 54.97, 54.97, 54.85, 54.85, 54.61, 54.61, 54.87, 54.87, 55.14, 55.14, 55.08, 55.08, 54.64, 54.64, 54.85, 54.85, 54.7, 54.7, 55.15, 55.15, 54.72, 54.72, 55.07, 55.07, 55.32, 55.32, 55.0, 55.0, 55.28, 55.28, 55.66, 55.66, 55.73, 55.73, 55.91, 55.91, 56.13, 56.13, 55.96, 55.96, 55.83, 55.83, 55.43, 55.43]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.630, Test loss: 2.088, Test accuracy: 24.02
Round   0, Global train loss: 1.630, Global test loss: 2.249, Global test accuracy: 21.84
Round   1, Train loss: 1.410, Test loss: 1.819, Test accuracy: 31.73
Round   1, Global train loss: 1.410, Global test loss: 2.097, Global test accuracy: 24.05
Round   2, Train loss: 1.453, Test loss: 1.570, Test accuracy: 40.81
Round   2, Global train loss: 1.453, Global test loss: 1.951, Global test accuracy: 32.38
Round   3, Train loss: 1.282, Test loss: 1.494, Test accuracy: 44.03
Round   3, Global train loss: 1.282, Global test loss: 2.035, Global test accuracy: 30.12
Round   4, Train loss: 1.293, Test loss: 1.308, Test accuracy: 49.19
Round   4, Global train loss: 1.293, Global test loss: 1.813, Global test accuracy: 31.86
Round   5, Train loss: 1.205, Test loss: 1.251, Test accuracy: 51.53
Round   5, Global train loss: 1.205, Global test loss: 1.648, Global test accuracy: 39.38
Round   6, Train loss: 1.138, Test loss: 1.215, Test accuracy: 53.79
Round   6, Global train loss: 1.138, Global test loss: 1.903, Global test accuracy: 35.89
Round   7, Train loss: 1.157, Test loss: 1.196, Test accuracy: 54.53
Round   7, Global train loss: 1.157, Global test loss: 1.720, Global test accuracy: 40.45
Round   8, Train loss: 1.186, Test loss: 1.165, Test accuracy: 55.23
Round   8, Global train loss: 1.186, Global test loss: 1.592, Global test accuracy: 42.57
Round   9, Train loss: 1.149, Test loss: 1.116, Test accuracy: 56.88
Round   9, Global train loss: 1.149, Global test loss: 1.512, Global test accuracy: 45.41
Round  10, Train loss: 1.153, Test loss: 1.108, Test accuracy: 57.13
Round  10, Global train loss: 1.153, Global test loss: 1.507, Global test accuracy: 45.66
Round  11, Train loss: 1.044, Test loss: 1.122, Test accuracy: 56.64
Round  11, Global train loss: 1.044, Global test loss: 1.638, Global test accuracy: 44.26
Round  12, Train loss: 1.054, Test loss: 1.064, Test accuracy: 58.23
Round  12, Global train loss: 1.054, Global test loss: 1.526, Global test accuracy: 45.80
Round  13, Train loss: 1.003, Test loss: 1.061, Test accuracy: 58.78
Round  13, Global train loss: 1.003, Global test loss: 1.447, Global test accuracy: 46.91
Round  14, Train loss: 1.050, Test loss: 1.051, Test accuracy: 59.42
Round  14, Global train loss: 1.050, Global test loss: 1.444, Global test accuracy: 47.60
Round  15, Train loss: 0.970, Test loss: 1.043, Test accuracy: 60.30
Round  15, Global train loss: 0.970, Global test loss: 1.511, Global test accuracy: 48.58
Round  16, Train loss: 0.964, Test loss: 1.021, Test accuracy: 60.93
Round  16, Global train loss: 0.964, Global test loss: 1.420, Global test accuracy: 49.11
Round  17, Train loss: 0.901, Test loss: 1.017, Test accuracy: 60.99
Round  17, Global train loss: 0.901, Global test loss: 1.411, Global test accuracy: 50.52
Round  18, Train loss: 0.968, Test loss: 0.992, Test accuracy: 62.12
Round  18, Global train loss: 0.968, Global test loss: 1.350, Global test accuracy: 50.59
Round  19, Train loss: 0.877, Test loss: 0.992, Test accuracy: 62.43
Round  19, Global train loss: 0.877, Global test loss: 1.395, Global test accuracy: 50.92
Round  20, Train loss: 0.929, Test loss: 0.986, Test accuracy: 62.87
Round  20, Global train loss: 0.929, Global test loss: 1.331, Global test accuracy: 53.02
Round  21, Train loss: 0.901, Test loss: 1.001, Test accuracy: 62.40
Round  21, Global train loss: 0.901, Global test loss: 1.333, Global test accuracy: 53.51
Round  22, Train loss: 0.912, Test loss: 0.995, Test accuracy: 63.21
Round  22, Global train loss: 0.912, Global test loss: 1.460, Global test accuracy: 47.86
Round  23, Train loss: 0.844, Test loss: 0.996, Test accuracy: 63.82
Round  23, Global train loss: 0.844, Global test loss: 1.361, Global test accuracy: 52.34
Round  24, Train loss: 0.774, Test loss: 1.004, Test accuracy: 63.65
Round  24, Global train loss: 0.774, Global test loss: 1.407, Global test accuracy: 51.82
Round  25, Train loss: 0.812, Test loss: 0.993, Test accuracy: 63.90
Round  25, Global train loss: 0.812, Global test loss: 1.241, Global test accuracy: 56.11
Round  26, Train loss: 0.838, Test loss: 0.995, Test accuracy: 63.90
Round  26, Global train loss: 0.838, Global test loss: 1.569, Global test accuracy: 48.56
Round  27, Train loss: 0.793, Test loss: 0.976, Test accuracy: 64.44
Round  27, Global train loss: 0.793, Global test loss: 1.421, Global test accuracy: 51.51
Round  28, Train loss: 0.730, Test loss: 0.971, Test accuracy: 64.40
Round  28, Global train loss: 0.730, Global test loss: 1.358, Global test accuracy: 52.26
Round  29, Train loss: 0.740, Test loss: 0.979, Test accuracy: 64.38
Round  29, Global train loss: 0.740, Global test loss: 1.323, Global test accuracy: 54.32
Round  30, Train loss: 0.724, Test loss: 0.937, Test accuracy: 65.77
Round  30, Global train loss: 0.724, Global test loss: 1.225, Global test accuracy: 57.84
Round  31, Train loss: 0.750, Test loss: 0.918, Test accuracy: 66.52
Round  31, Global train loss: 0.750, Global test loss: 1.234, Global test accuracy: 57.34
Round  32, Train loss: 0.687, Test loss: 0.914, Test accuracy: 66.48
Round  32, Global train loss: 0.687, Global test loss: 1.213, Global test accuracy: 57.78
Round  33, Train loss: 0.722, Test loss: 0.943, Test accuracy: 65.81
Round  33, Global train loss: 0.722, Global test loss: 1.460, Global test accuracy: 52.06
Round  34, Train loss: 0.751, Test loss: 0.957, Test accuracy: 65.68
Round  34, Global train loss: 0.751, Global test loss: 1.329, Global test accuracy: 54.48
Round  35, Train loss: 0.768, Test loss: 0.936, Test accuracy: 66.58
Round  35, Global train loss: 0.768, Global test loss: 1.246, Global test accuracy: 56.86
Round  36, Train loss: 0.700, Test loss: 0.931, Test accuracy: 66.73
Round  36, Global train loss: 0.700, Global test loss: 1.188, Global test accuracy: 59.52
Round  37, Train loss: 0.663, Test loss: 0.922, Test accuracy: 67.09
Round  37, Global train loss: 0.663, Global test loss: 1.606, Global test accuracy: 52.00
Round  38, Train loss: 0.651, Test loss: 0.922, Test accuracy: 67.13
Round  38, Global train loss: 0.651, Global test loss: 1.334, Global test accuracy: 55.18
Round  39, Train loss: 0.680, Test loss: 0.950, Test accuracy: 66.69
Round  39, Global train loss: 0.680, Global test loss: 1.274, Global test accuracy: 56.46
Round  40, Train loss: 0.649, Test loss: 0.919, Test accuracy: 67.30
Round  40, Global train loss: 0.649, Global test loss: 1.362, Global test accuracy: 53.75
Round  41, Train loss: 0.634, Test loss: 0.926, Test accuracy: 67.36
Round  41, Global train loss: 0.634, Global test loss: 1.238, Global test accuracy: 57.65
Round  42, Train loss: 0.691, Test loss: 0.932, Test accuracy: 67.70
Round  42, Global train loss: 0.691, Global test loss: 1.146, Global test accuracy: 59.99
Round  43, Train loss: 0.704, Test loss: 0.939, Test accuracy: 67.52
Round  43, Global train loss: 0.704, Global test loss: 1.311, Global test accuracy: 55.24
Round  44, Train loss: 0.594, Test loss: 0.932, Test accuracy: 67.75
Round  44, Global train loss: 0.594, Global test loss: 1.137, Global test accuracy: 60.38
Round  45, Train loss: 0.678, Test loss: 0.942, Test accuracy: 67.56
Round  45, Global train loss: 0.678, Global test loss: 1.213, Global test accuracy: 57.77
Round  46, Train loss: 0.596, Test loss: 0.941, Test accuracy: 67.97
Round  46, Global train loss: 0.596, Global test loss: 1.223, Global test accuracy: 59.38
Round  47, Train loss: 0.691, Test loss: 0.955, Test accuracy: 67.84
Round  47, Global train loss: 0.691, Global test loss: 1.208, Global test accuracy: 59.22
Round  48, Train loss: 0.595, Test loss: 0.978, Test accuracy: 67.70
Round  48, Global train loss: 0.595, Global test loss: 1.178, Global test accuracy: 60.06
Round  49, Train loss: 0.581, Test loss: 0.979, Test accuracy: 67.88
Round  49, Global train loss: 0.581, Global test loss: 1.332, Global test accuracy: 56.76
Round  50, Train loss: 0.560, Test loss: 0.975, Test accuracy: 67.90
Round  50, Global train loss: 0.560, Global test loss: 1.314, Global test accuracy: 57.01
Round  51, Train loss: 0.574, Test loss: 0.960, Test accuracy: 68.25
Round  51, Global train loss: 0.574, Global test loss: 1.234, Global test accuracy: 58.42
Round  52, Train loss: 0.552, Test loss: 0.988, Test accuracy: 67.83
Round  52, Global train loss: 0.552, Global test loss: 1.256, Global test accuracy: 58.17
Round  53, Train loss: 0.641, Test loss: 0.972, Test accuracy: 68.24
Round  53, Global train loss: 0.641, Global test loss: 1.208, Global test accuracy: 59.69
Round  54, Train loss: 0.497, Test loss: 0.970, Test accuracy: 68.32
Round  54, Global train loss: 0.497, Global test loss: 1.325, Global test accuracy: 57.58
Round  55, Train loss: 0.572, Test loss: 0.974, Test accuracy: 68.03
Round  55, Global train loss: 0.572, Global test loss: 1.318, Global test accuracy: 56.34
Round  56, Train loss: 0.540, Test loss: 0.949, Test accuracy: 68.76
Round  56, Global train loss: 0.540, Global test loss: 1.357, Global test accuracy: 57.02
Round  57, Train loss: 0.518, Test loss: 0.974, Test accuracy: 68.22
Round  57, Global train loss: 0.518, Global test loss: 1.264, Global test accuracy: 59.62
Round  58, Train loss: 0.538, Test loss: 0.973, Test accuracy: 68.26
Round  58, Global train loss: 0.538, Global test loss: 1.229, Global test accuracy: 60.16
Round  59, Train loss: 0.580, Test loss: 0.978, Test accuracy: 68.55
Round  59, Global train loss: 0.580, Global test loss: 1.273, Global test accuracy: 58.53
Round  60, Train loss: 0.591, Test loss: 0.978, Test accuracy: 68.70
Round  60, Global train loss: 0.591, Global test loss: 1.290, Global test accuracy: 57.42
Round  61, Train loss: 0.571, Test loss: 0.983, Test accuracy: 68.93
Round  61, Global train loss: 0.571, Global test loss: 1.305, Global test accuracy: 56.33
Round  62, Train loss: 0.552, Test loss: 0.991, Test accuracy: 68.33
Round  62, Global train loss: 0.552, Global test loss: 1.367, Global test accuracy: 57.42
Round  63, Train loss: 0.449, Test loss: 0.993, Test accuracy: 68.76
Round  63, Global train loss: 0.449, Global test loss: 1.303, Global test accuracy: 59.56
Round  64, Train loss: 0.479, Test loss: 1.013, Test accuracy: 68.55
Round  64, Global train loss: 0.479, Global test loss: 1.476, Global test accuracy: 57.11
Round  65, Train loss: 0.436, Test loss: 0.996, Test accuracy: 69.45
Round  65, Global train loss: 0.436, Global test loss: 1.161, Global test accuracy: 63.19
Round  66, Train loss: 0.452, Test loss: 1.009, Test accuracy: 69.21
Round  66, Global train loss: 0.452, Global test loss: 1.331, Global test accuracy: 59.69
Round  67, Train loss: 0.369, Test loss: 1.011, Test accuracy: 69.11
Round  67, Global train loss: 0.369, Global test loss: 1.232, Global test accuracy: 61.39
Round  68, Train loss: 0.437, Test loss: 1.018, Test accuracy: 69.37
Round  68, Global train loss: 0.437, Global test loss: 1.208, Global test accuracy: 61.11
Round  69, Train loss: 0.580, Test loss: 1.030, Test accuracy: 69.19
Round  69, Global train loss: 0.580, Global test loss: 1.136, Global test accuracy: 62.29
Round  70, Train loss: 0.410, Test loss: 1.015, Test accuracy: 69.46
Round  70, Global train loss: 0.410, Global test loss: 1.311, Global test accuracy: 60.12
Round  71, Train loss: 0.462, Test loss: 1.000, Test accuracy: 69.28
Round  71, Global train loss: 0.462, Global test loss: 1.193, Global test accuracy: 61.75
Round  72, Train loss: 0.526, Test loss: 1.027, Test accuracy: 69.09
Round  72, Global train loss: 0.526, Global test loss: 1.449, Global test accuracy: 55.44
Round  73, Train loss: 0.383, Test loss: 1.038, Test accuracy: 69.03
Round  73, Global train loss: 0.383, Global test loss: 1.402, Global test accuracy: 58.78
Round  74, Train loss: 0.427, Test loss: 1.044, Test accuracy: 69.11
Round  74, Global train loss: 0.427, Global test loss: 1.357, Global test accuracy: 59.87
Round  75, Train loss: 0.473, Test loss: 1.053, Test accuracy: 68.78
Round  75, Global train loss: 0.473, Global test loss: 1.387, Global test accuracy: 57.95
Round  76, Train loss: 0.517, Test loss: 1.063, Test accuracy: 68.86
Round  76, Global train loss: 0.517, Global test loss: 1.287, Global test accuracy: 60.13
Round  77, Train loss: 0.388, Test loss: 1.048, Test accuracy: 69.22
Round  77, Global train loss: 0.388, Global test loss: 1.339, Global test accuracy: 59.45
Round  78, Train loss: 0.529, Test loss: 1.044, Test accuracy: 69.50
Round  78, Global train loss: 0.529, Global test loss: 1.314, Global test accuracy: 58.01
Round  79, Train loss: 0.472, Test loss: 1.062, Test accuracy: 69.23
Round  79, Global train loss: 0.472, Global test loss: 1.305, Global test accuracy: 59.27
Round  80, Train loss: 0.461, Test loss: 1.062, Test accuracy: 69.43
Round  80, Global train loss: 0.461, Global test loss: 1.295, Global test accuracy: 60.07
Round  81, Train loss: 0.487, Test loss: 1.049, Test accuracy: 69.76
Round  81, Global train loss: 0.487, Global test loss: 1.429, Global test accuracy: 57.34
Round  82, Train loss: 0.435, Test loss: 1.058, Test accuracy: 69.72
Round  82, Global train loss: 0.435, Global test loss: 1.353, Global test accuracy: 59.25
Round  83, Train loss: 0.455, Test loss: 1.025, Test accuracy: 69.59
Round  83, Global train loss: 0.455, Global test loss: 1.238, Global test accuracy: 61.63
Round  84, Train loss: 0.445, Test loss: 1.038, Test accuracy: 69.12
Round  84, Global train loss: 0.445, Global test loss: 1.427, Global test accuracy: 57.49
Round  85, Train loss: 0.399, Test loss: 1.048, Test accuracy: 68.99
Round  85, Global train loss: 0.399, Global test loss: 1.592, Global test accuracy: 55.97
Round  86, Train loss: 0.385, Test loss: 1.074, Test accuracy: 69.34
Round  86, Global train loss: 0.385, Global test loss: 1.353, Global test accuracy: 59.97
Round  87, Train loss: 0.411, Test loss: 1.073, Test accuracy: 69.70
Round  87, Global train loss: 0.411, Global test loss: 1.327, Global test accuracy: 60.75
Round  88, Train loss: 0.374, Test loss: 1.079, Test accuracy: 69.23
Round  88, Global train loss: 0.374, Global test loss: 1.318, Global test accuracy: 61.26
Round  89, Train loss: 0.381, Test loss: 1.086, Test accuracy: 68.97
Round  89, Global train loss: 0.381, Global test loss: 1.430, Global test accuracy: 60.09
Round  90, Train loss: 0.426, Test loss: 1.073, Test accuracy: 69.26
Round  90, Global train loss: 0.426, Global test loss: 1.411, Global test accuracy: 58.92
Round  91, Train loss: 0.350, Test loss: 1.087, Test accuracy: 69.65
Round  91, Global train loss: 0.350, Global test loss: 1.333, Global test accuracy: 61.21
Round  92, Train loss: 0.498, Test loss: 1.091, Test accuracy: 69.47
Round  92, Global train loss: 0.498, Global test loss: 1.326, Global test accuracy: 59.23
Round  93, Train loss: 0.392, Test loss: 1.099, Test accuracy: 69.65
Round  93, Global train loss: 0.392, Global test loss: 1.243, Global test accuracy: 61.84
Round  94, Train loss: 0.407, Test loss: 1.079, Test accuracy: 69.60
Round  94, Global train loss: 0.407, Global test loss: 1.308, Global test accuracy: 60.17
Round  95, Train loss: 0.376, Test loss: 1.113, Test accuracy: 69.38
Round  95, Global train loss: 0.376, Global test loss: 1.458, Global test accuracy: 59.26
Round  96, Train loss: 0.453, Test loss: 1.112, Test accuracy: 69.60
Round  96, Global train loss: 0.453, Global test loss: 1.305, Global test accuracy: 60.86
Round  97, Train loss: 0.405, Test loss: 1.123, Test accuracy: 69.59
Round  97, Global train loss: 0.405, Global test loss: 1.296, Global test accuracy: 61.25
Round  98, Train loss: 0.440, Test loss: 1.099, Test accuracy: 69.41
Round  98, Global train loss: 0.440, Global test loss: 1.260, Global test accuracy: 60.89
Round  99, Train loss: 0.356, Test loss: 1.116, Test accuracy: 69.08
Round  99, Global train loss: 0.356, Global test loss: 1.284, Global test accuracy: 62.24
Final Round, Train loss: 0.314, Test loss: 1.251, Test accuracy: 69.17
Final Round, Global train loss: 0.314, Global test loss: 1.284, Global test accuracy: 62.24
Average accuracy final 10 rounds: 69.46900000000001 

Average global accuracy final 10 rounds: 60.587 

1469.0187513828278
[1.5048131942749023, 3.0096263885498047, 4.263167142868042, 5.516707897186279, 6.768532037734985, 8.020356178283691, 9.270353078842163, 10.520349979400635, 11.770881414413452, 13.02141284942627, 14.274500131607056, 15.527587413787842, 16.77762269973755, 18.027657985687256, 19.279860258102417, 20.532062530517578, 21.77956199645996, 23.027061462402344, 24.27398991584778, 25.520918369293213, 26.764939785003662, 28.00896120071411, 29.25888204574585, 30.508802890777588, 31.758829355239868, 33.00885581970215, 34.263845920562744, 35.51883602142334, 36.763245582580566, 38.00765514373779, 39.2585346698761, 40.509414196014404, 41.75543522834778, 43.00145626068115, 44.24578309059143, 45.49010992050171, 46.735453844070435, 47.98079776763916, 49.22552728652954, 50.47025680541992, 51.71542453765869, 52.96059226989746, 54.206007957458496, 55.45142364501953, 56.69750618934631, 57.943588733673096, 59.18915557861328, 60.43472242355347, 61.67850160598755, 62.92228078842163, 64.16695499420166, 65.41162919998169, 66.66018915176392, 67.90874910354614, 69.15550637245178, 70.40226364135742, 71.65379977226257, 72.90533590316772, 74.15687704086304, 75.40841817855835, 76.65956425666809, 77.91071033477783, 79.15366077423096, 80.39661121368408, 81.64184856414795, 82.88708591461182, 84.12596416473389, 85.36484241485596, 86.60799098014832, 87.85113954544067, 89.09255862236023, 90.33397769927979, 91.57508540153503, 92.81619310379028, 94.05376839637756, 95.29134368896484, 96.52693152427673, 97.76251935958862, 99.00321006774902, 100.24390077590942, 101.48377704620361, 102.7236533164978, 103.96190428733826, 105.20015525817871, 106.43955993652344, 107.67896461486816, 108.91892004013062, 110.15887546539307, 111.3928713798523, 112.62686729431152, 113.86552500724792, 115.10418272018433, 116.34252858161926, 117.5808744430542, 118.82126951217651, 120.06166458129883, 121.30458474159241, 122.54750490188599, 123.79382610321045, 125.04014730453491, 126.23296999931335, 127.4257926940918, 128.62940287590027, 129.83301305770874, 131.06599020957947, 132.2989673614502, 133.50002932548523, 134.70109128952026, 135.9147720336914, 137.12845277786255, 138.33912110328674, 139.54978942871094, 140.76217699050903, 141.97456455230713, 143.18591332435608, 144.39726209640503, 145.60700011253357, 146.8167381286621, 148.02580165863037, 149.23486518859863, 150.45141172409058, 151.66795825958252, 152.88793992996216, 154.1079216003418, 155.331120967865, 156.55432033538818, 157.77718496322632, 159.00004959106445, 160.2181646823883, 161.43627977371216, 162.6418387889862, 163.84739780426025, 165.05518984794617, 166.26298189163208, 167.46411180496216, 168.66524171829224, 169.86957097053528, 171.07390022277832, 172.2903962135315, 173.50689220428467, 174.71395206451416, 175.92101192474365, 177.12482023239136, 178.32862854003906, 179.5462236404419, 180.76381874084473, 181.96840405464172, 183.17298936843872, 184.4020745754242, 185.63115978240967, 186.85607171058655, 188.08098363876343, 189.28149318695068, 190.48200273513794, 191.68472266197205, 192.88744258880615, 194.10159039497375, 195.31573820114136, 196.53533744812012, 197.75493669509888, 198.96649885177612, 200.17806100845337, 201.39355087280273, 202.6090407371521, 203.81778502464294, 205.0265293121338, 206.24570035934448, 207.46487140655518, 208.67672562599182, 209.88857984542847, 211.10153436660767, 212.31448888778687, 213.5233280658722, 214.73216724395752, 215.94675016403198, 217.16133308410645, 218.3850598335266, 219.60878658294678, 220.8215024471283, 222.03421831130981, 223.24321937561035, 224.4522204399109, 225.66159343719482, 226.87096643447876, 228.10018706321716, 229.32940769195557, 230.56573700904846, 231.80206632614136, 233.04515647888184, 234.28824663162231, 235.52623677253723, 236.76422691345215, 238.00056838989258, 239.236909866333, 240.47030234336853, 241.70369482040405, 242.93759179115295, 244.17148876190186, 245.40689158439636, 246.64229440689087, 249.11342549324036, 251.58455657958984]
[24.02, 24.02, 31.73, 31.73, 40.81, 40.81, 44.03, 44.03, 49.19, 49.19, 51.53, 51.53, 53.79, 53.79, 54.53, 54.53, 55.23, 55.23, 56.88, 56.88, 57.13, 57.13, 56.64, 56.64, 58.23, 58.23, 58.78, 58.78, 59.42, 59.42, 60.3, 60.3, 60.93, 60.93, 60.99, 60.99, 62.12, 62.12, 62.43, 62.43, 62.87, 62.87, 62.4, 62.4, 63.21, 63.21, 63.82, 63.82, 63.65, 63.65, 63.9, 63.9, 63.9, 63.9, 64.44, 64.44, 64.4, 64.4, 64.38, 64.38, 65.77, 65.77, 66.52, 66.52, 66.48, 66.48, 65.81, 65.81, 65.68, 65.68, 66.58, 66.58, 66.73, 66.73, 67.09, 67.09, 67.13, 67.13, 66.69, 66.69, 67.3, 67.3, 67.36, 67.36, 67.7, 67.7, 67.52, 67.52, 67.75, 67.75, 67.56, 67.56, 67.97, 67.97, 67.84, 67.84, 67.7, 67.7, 67.88, 67.88, 67.9, 67.9, 68.25, 68.25, 67.83, 67.83, 68.24, 68.24, 68.32, 68.32, 68.03, 68.03, 68.76, 68.76, 68.22, 68.22, 68.26, 68.26, 68.55, 68.55, 68.7, 68.7, 68.93, 68.93, 68.33, 68.33, 68.76, 68.76, 68.55, 68.55, 69.45, 69.45, 69.21, 69.21, 69.11, 69.11, 69.37, 69.37, 69.19, 69.19, 69.46, 69.46, 69.28, 69.28, 69.09, 69.09, 69.03, 69.03, 69.11, 69.11, 68.78, 68.78, 68.86, 68.86, 69.22, 69.22, 69.5, 69.5, 69.23, 69.23, 69.43, 69.43, 69.76, 69.76, 69.72, 69.72, 69.59, 69.59, 69.12, 69.12, 68.99, 68.99, 69.34, 69.34, 69.7, 69.7, 69.23, 69.23, 68.97, 68.97, 69.26, 69.26, 69.65, 69.65, 69.47, 69.47, 69.65, 69.65, 69.6, 69.6, 69.38, 69.38, 69.6, 69.6, 69.59, 69.59, 69.41, 69.41, 69.08, 69.08, 69.17, 69.17]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.641, Test loss: 2.158, Test accuracy: 18.88
Round   0, Global train loss: 1.641, Global test loss: 2.350, Global test accuracy: 14.62
Round   1, Train loss: 1.436, Test loss: 1.872, Test accuracy: 29.13
Round   1, Global train loss: 1.436, Global test loss: 2.173, Global test accuracy: 22.97
Round   2, Train loss: 1.398, Test loss: 1.581, Test accuracy: 37.88
Round   2, Global train loss: 1.398, Global test loss: 2.007, Global test accuracy: 27.63
Round   3, Train loss: 1.242, Test loss: 1.554, Test accuracy: 41.19
Round   3, Global train loss: 1.242, Global test loss: 2.178, Global test accuracy: 28.81
Round   4, Train loss: 1.253, Test loss: 1.343, Test accuracy: 46.20
Round   4, Global train loss: 1.253, Global test loss: 1.870, Global test accuracy: 30.62
Round   5, Train loss: 1.217, Test loss: 1.293, Test accuracy: 48.30
Round   5, Global train loss: 1.217, Global test loss: 1.703, Global test accuracy: 37.22
Round   6, Train loss: 1.125, Test loss: 1.238, Test accuracy: 51.24
Round   6, Global train loss: 1.125, Global test loss: 1.959, Global test accuracy: 34.78
Round   7, Train loss: 1.196, Test loss: 1.206, Test accuracy: 52.69
Round   7, Global train loss: 1.196, Global test loss: 1.760, Global test accuracy: 38.60
Round   8, Train loss: 1.185, Test loss: 1.175, Test accuracy: 53.82
Round   8, Global train loss: 1.185, Global test loss: 1.591, Global test accuracy: 41.74
Round   9, Train loss: 1.083, Test loss: 1.129, Test accuracy: 55.92
Round   9, Global train loss: 1.083, Global test loss: 1.548, Global test accuracy: 43.90
Round  10, Train loss: 1.142, Test loss: 1.124, Test accuracy: 56.46
Round  10, Global train loss: 1.142, Global test loss: 1.569, Global test accuracy: 42.89
Round  11, Train loss: 0.978, Test loss: 1.147, Test accuracy: 56.11
Round  11, Global train loss: 0.978, Global test loss: 1.704, Global test accuracy: 41.64
Round  12, Train loss: 1.016, Test loss: 1.064, Test accuracy: 58.01
Round  12, Global train loss: 1.016, Global test loss: 1.574, Global test accuracy: 44.83
Round  13, Train loss: 0.972, Test loss: 1.061, Test accuracy: 58.20
Round  13, Global train loss: 0.972, Global test loss: 1.422, Global test accuracy: 48.48
Round  14, Train loss: 1.039, Test loss: 1.042, Test accuracy: 59.01
Round  14, Global train loss: 1.039, Global test loss: 1.471, Global test accuracy: 46.31
Round  15, Train loss: 0.925, Test loss: 1.033, Test accuracy: 59.82
Round  15, Global train loss: 0.925, Global test loss: 1.575, Global test accuracy: 46.11
Round  16, Train loss: 1.024, Test loss: 0.991, Test accuracy: 61.26
Round  16, Global train loss: 1.024, Global test loss: 1.432, Global test accuracy: 47.12
Round  17, Train loss: 0.876, Test loss: 0.973, Test accuracy: 61.94
Round  17, Global train loss: 0.876, Global test loss: 1.424, Global test accuracy: 49.42
Round  18, Train loss: 1.021, Test loss: 0.977, Test accuracy: 61.70
Round  18, Global train loss: 1.021, Global test loss: 1.366, Global test accuracy: 50.70
Round  19, Train loss: 0.899, Test loss: 0.972, Test accuracy: 62.10
Round  19, Global train loss: 0.899, Global test loss: 1.450, Global test accuracy: 49.95
Round  20, Train loss: 0.969, Test loss: 0.968, Test accuracy: 62.45
Round  20, Global train loss: 0.969, Global test loss: 1.340, Global test accuracy: 52.87
Round  21, Train loss: 0.927, Test loss: 0.945, Test accuracy: 63.48
Round  21, Global train loss: 0.927, Global test loss: 1.330, Global test accuracy: 53.07
Round  22, Train loss: 0.911, Test loss: 0.927, Test accuracy: 64.21
Round  22, Global train loss: 0.911, Global test loss: 1.334, Global test accuracy: 52.75
Round  23, Train loss: 0.847, Test loss: 0.950, Test accuracy: 63.39
Round  23, Global train loss: 0.847, Global test loss: 1.496, Global test accuracy: 48.01
Round  24, Train loss: 0.787, Test loss: 0.952, Test accuracy: 63.16
Round  24, Global train loss: 0.787, Global test loss: 1.431, Global test accuracy: 50.91
Round  25, Train loss: 0.825, Test loss: 0.940, Test accuracy: 63.73
Round  25, Global train loss: 0.825, Global test loss: 1.264, Global test accuracy: 54.51
Round  26, Train loss: 0.845, Test loss: 0.925, Test accuracy: 64.71
Round  26, Global train loss: 0.845, Global test loss: 1.526, Global test accuracy: 48.51
Round  27, Train loss: 0.797, Test loss: 0.923, Test accuracy: 64.85
Round  27, Global train loss: 0.797, Global test loss: 1.379, Global test accuracy: 50.96
Round  28, Train loss: 0.775, Test loss: 0.915, Test accuracy: 65.30
Round  28, Global train loss: 0.775, Global test loss: 1.378, Global test accuracy: 51.56
Round  29, Train loss: 0.770, Test loss: 0.921, Test accuracy: 65.57
Round  29, Global train loss: 0.770, Global test loss: 1.272, Global test accuracy: 55.06
Round  30, Train loss: 0.731, Test loss: 0.916, Test accuracy: 65.87
Round  30, Global train loss: 0.731, Global test loss: 1.201, Global test accuracy: 58.49
Round  31, Train loss: 0.758, Test loss: 0.903, Test accuracy: 66.43
Round  31, Global train loss: 0.758, Global test loss: 1.201, Global test accuracy: 58.06
Round  32, Train loss: 0.683, Test loss: 0.908, Test accuracy: 66.40
Round  32, Global train loss: 0.683, Global test loss: 1.189, Global test accuracy: 58.28
Round  33, Train loss: 0.740, Test loss: 0.897, Test accuracy: 66.81
Round  33, Global train loss: 0.740, Global test loss: 1.337, Global test accuracy: 53.19
Round  34, Train loss: 0.778, Test loss: 0.891, Test accuracy: 67.61
Round  34, Global train loss: 0.778, Global test loss: 1.279, Global test accuracy: 56.20
Round  35, Train loss: 0.781, Test loss: 0.894, Test accuracy: 67.58
Round  35, Global train loss: 0.781, Global test loss: 1.177, Global test accuracy: 58.22
Round  36, Train loss: 0.674, Test loss: 0.913, Test accuracy: 66.61
Round  36, Global train loss: 0.674, Global test loss: 1.144, Global test accuracy: 59.80
Round  37, Train loss: 0.675, Test loss: 0.905, Test accuracy: 67.00
Round  37, Global train loss: 0.675, Global test loss: 1.536, Global test accuracy: 52.78
Round  38, Train loss: 0.692, Test loss: 0.922, Test accuracy: 66.76
Round  38, Global train loss: 0.692, Global test loss: 1.317, Global test accuracy: 53.64
Round  39, Train loss: 0.666, Test loss: 0.892, Test accuracy: 67.77
Round  39, Global train loss: 0.666, Global test loss: 1.167, Global test accuracy: 59.25
Round  40, Train loss: 0.685, Test loss: 0.875, Test accuracy: 68.35
Round  40, Global train loss: 0.685, Global test loss: 1.277, Global test accuracy: 56.31
Round  41, Train loss: 0.643, Test loss: 0.871, Test accuracy: 68.38
Round  41, Global train loss: 0.643, Global test loss: 1.205, Global test accuracy: 58.82
Round  42, Train loss: 0.730, Test loss: 0.873, Test accuracy: 68.33
Round  42, Global train loss: 0.730, Global test loss: 1.126, Global test accuracy: 60.40
Round  43, Train loss: 0.736, Test loss: 0.884, Test accuracy: 68.56
Round  43, Global train loss: 0.736, Global test loss: 1.294, Global test accuracy: 55.59
Round  44, Train loss: 0.626, Test loss: 0.871, Test accuracy: 68.76
Round  44, Global train loss: 0.626, Global test loss: 1.133, Global test accuracy: 59.80
Round  45, Train loss: 0.708, Test loss: 0.927, Test accuracy: 68.21
Round  45, Global train loss: 0.708, Global test loss: 1.158, Global test accuracy: 59.20
Round  46, Train loss: 0.620, Test loss: 0.913, Test accuracy: 68.49
Round  46, Global train loss: 0.620, Global test loss: 1.134, Global test accuracy: 61.07
Round  47, Train loss: 0.657, Test loss: 0.925, Test accuracy: 68.53
Round  47, Global train loss: 0.657, Global test loss: 1.152, Global test accuracy: 60.93
Round  48, Train loss: 0.616, Test loss: 0.879, Test accuracy: 69.22
Round  48, Global train loss: 0.616, Global test loss: 1.125, Global test accuracy: 61.48
Round  49, Train loss: 0.556, Test loss: 0.868, Test accuracy: 69.38
Round  49, Global train loss: 0.556, Global test loss: 1.222, Global test accuracy: 57.90
Round  50, Train loss: 0.563, Test loss: 0.864, Test accuracy: 69.60
Round  50, Global train loss: 0.563, Global test loss: 1.245, Global test accuracy: 58.70
Round  51, Train loss: 0.574, Test loss: 0.849, Test accuracy: 70.11
Round  51, Global train loss: 0.574, Global test loss: 1.157, Global test accuracy: 60.55
Round  52, Train loss: 0.558, Test loss: 0.842, Test accuracy: 70.49
Round  52, Global train loss: 0.558, Global test loss: 1.117, Global test accuracy: 61.66
Round  53, Train loss: 0.619, Test loss: 0.862, Test accuracy: 70.12
Round  53, Global train loss: 0.619, Global test loss: 1.134, Global test accuracy: 61.13
Round  54, Train loss: 0.516, Test loss: 0.864, Test accuracy: 70.64
Round  54, Global train loss: 0.516, Global test loss: 1.351, Global test accuracy: 58.00
Round  55, Train loss: 0.589, Test loss: 0.865, Test accuracy: 70.59
Round  55, Global train loss: 0.589, Global test loss: 1.187, Global test accuracy: 59.87
Round  56, Train loss: 0.547, Test loss: 0.853, Test accuracy: 70.72
Round  56, Global train loss: 0.547, Global test loss: 1.224, Global test accuracy: 59.36
Round  57, Train loss: 0.539, Test loss: 0.858, Test accuracy: 70.64
Round  57, Global train loss: 0.539, Global test loss: 1.198, Global test accuracy: 59.74
Round  58, Train loss: 0.567, Test loss: 0.856, Test accuracy: 70.63
Round  58, Global train loss: 0.567, Global test loss: 1.117, Global test accuracy: 62.34
Round  59, Train loss: 0.565, Test loss: 0.869, Test accuracy: 70.85
Round  59, Global train loss: 0.565, Global test loss: 1.187, Global test accuracy: 61.10
Round  60, Train loss: 0.576, Test loss: 0.881, Test accuracy: 70.52
Round  60, Global train loss: 0.576, Global test loss: 1.167, Global test accuracy: 60.66
Round  61, Train loss: 0.578, Test loss: 0.888, Test accuracy: 70.52
Round  61, Global train loss: 0.578, Global test loss: 1.238, Global test accuracy: 58.44
Round  62, Train loss: 0.589, Test loss: 0.888, Test accuracy: 70.48
Round  62, Global train loss: 0.589, Global test loss: 1.195, Global test accuracy: 60.26
Round  63, Train loss: 0.504, Test loss: 0.885, Test accuracy: 70.76
Round  63, Global train loss: 0.504, Global test loss: 1.188, Global test accuracy: 61.05
Round  64, Train loss: 0.428, Test loss: 0.880, Test accuracy: 71.00
Round  64, Global train loss: 0.428, Global test loss: 1.361, Global test accuracy: 59.26
Round  65, Train loss: 0.474, Test loss: 0.900, Test accuracy: 70.66
Round  65, Global train loss: 0.474, Global test loss: 1.091, Global test accuracy: 63.32
Round  66, Train loss: 0.484, Test loss: 0.895, Test accuracy: 70.89
Round  66, Global train loss: 0.484, Global test loss: 1.111, Global test accuracy: 63.61
Round  67, Train loss: 0.418, Test loss: 0.874, Test accuracy: 71.54
Round  67, Global train loss: 0.418, Global test loss: 1.164, Global test accuracy: 61.69
Round  68, Train loss: 0.459, Test loss: 0.888, Test accuracy: 71.21
Round  68, Global train loss: 0.459, Global test loss: 1.173, Global test accuracy: 62.23
Round  69, Train loss: 0.540, Test loss: 0.879, Test accuracy: 71.60
Round  69, Global train loss: 0.540, Global test loss: 1.141, Global test accuracy: 61.26
Round  70, Train loss: 0.380, Test loss: 0.887, Test accuracy: 71.37
Round  70, Global train loss: 0.380, Global test loss: 1.296, Global test accuracy: 60.05
Round  71, Train loss: 0.431, Test loss: 0.874, Test accuracy: 71.75
Round  71, Global train loss: 0.431, Global test loss: 1.136, Global test accuracy: 63.56
Round  72, Train loss: 0.531, Test loss: 0.914, Test accuracy: 71.14
Round  72, Global train loss: 0.531, Global test loss: 1.321, Global test accuracy: 59.01
Round  73, Train loss: 0.449, Test loss: 0.908, Test accuracy: 71.07
Round  73, Global train loss: 0.449, Global test loss: 1.258, Global test accuracy: 59.83
Round  74, Train loss: 0.461, Test loss: 0.907, Test accuracy: 71.24
Round  74, Global train loss: 0.461, Global test loss: 1.286, Global test accuracy: 59.72
Round  75, Train loss: 0.536, Test loss: 0.886, Test accuracy: 71.93
Round  75, Global train loss: 0.536, Global test loss: 1.230, Global test accuracy: 60.41
Round  76, Train loss: 0.477, Test loss: 0.894, Test accuracy: 71.55
Round  76, Global train loss: 0.477, Global test loss: 1.197, Global test accuracy: 62.15
Round  77, Train loss: 0.397, Test loss: 0.894, Test accuracy: 72.13
Round  77, Global train loss: 0.397, Global test loss: 1.322, Global test accuracy: 59.79
Round  78, Train loss: 0.525, Test loss: 0.912, Test accuracy: 71.64
Round  78, Global train loss: 0.525, Global test loss: 1.109, Global test accuracy: 63.92
Round  79, Train loss: 0.477, Test loss: 0.904, Test accuracy: 71.82
Round  79, Global train loss: 0.477, Global test loss: 1.169, Global test accuracy: 62.64
Round  80, Train loss: 0.431, Test loss: 0.902, Test accuracy: 71.71
Round  80, Global train loss: 0.431, Global test loss: 1.201, Global test accuracy: 62.69
Round  81, Train loss: 0.490, Test loss: 0.911, Test accuracy: 71.48
Round  81, Global train loss: 0.490, Global test loss: 1.286, Global test accuracy: 59.61
Round  82, Train loss: 0.445, Test loss: 0.895, Test accuracy: 71.92
Round  82, Global train loss: 0.445, Global test loss: 1.172, Global test accuracy: 62.72
Round  83, Train loss: 0.456, Test loss: 0.918, Test accuracy: 71.51
Round  83, Global train loss: 0.456, Global test loss: 1.121, Global test accuracy: 64.39
Round  84, Train loss: 0.384, Test loss: 0.916, Test accuracy: 72.06
Round  84, Global train loss: 0.384, Global test loss: 1.320, Global test accuracy: 61.25
Round  85, Train loss: 0.428, Test loss: 0.900, Test accuracy: 72.34
Round  85, Global train loss: 0.428, Global test loss: 1.318, Global test accuracy: 59.61
Round  86, Train loss: 0.390, Test loss: 0.909, Test accuracy: 72.26
Round  86, Global train loss: 0.390, Global test loss: 1.192, Global test accuracy: 63.29
Round  87, Train loss: 0.419, Test loss: 0.907, Test accuracy: 72.19
Round  87, Global train loss: 0.419, Global test loss: 1.171, Global test accuracy: 63.75
Round  88, Train loss: 0.409, Test loss: 0.909, Test accuracy: 72.29
Round  88, Global train loss: 0.409, Global test loss: 1.129, Global test accuracy: 65.11
Round  89, Train loss: 0.377, Test loss: 0.902, Test accuracy: 72.52
Round  89, Global train loss: 0.377, Global test loss: 1.232, Global test accuracy: 62.80
Round  90, Train loss: 0.438, Test loss: 0.924, Test accuracy: 72.44
Round  90, Global train loss: 0.438, Global test loss: 1.247, Global test accuracy: 61.36
Round  91, Train loss: 0.388, Test loss: 0.937, Test accuracy: 72.42
Round  91, Global train loss: 0.388, Global test loss: 1.176, Global test accuracy: 64.26
Round  92, Train loss: 0.481, Test loss: 0.959, Test accuracy: 71.93
Round  92, Global train loss: 0.481, Global test loss: 1.250, Global test accuracy: 61.33
Round  93, Train loss: 0.410, Test loss: 0.974, Test accuracy: 71.58
Round  93, Global train loss: 0.410, Global test loss: 1.160, Global test accuracy: 63.81
Round  94, Train loss: 0.430, Test loss: 0.968, Test accuracy: 71.83
Round  94, Global train loss: 0.430, Global test loss: 1.159, Global test accuracy: 64.08/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  95, Train loss: 0.366, Test loss: 0.976, Test accuracy: 71.38
Round  95, Global train loss: 0.366, Global test loss: 1.217, Global test accuracy: 63.39
Round  96, Train loss: 0.396, Test loss: 0.975, Test accuracy: 71.47
Round  96, Global train loss: 0.396, Global test loss: 1.159, Global test accuracy: 64.80
Round  97, Train loss: 0.418, Test loss: 0.967, Test accuracy: 71.49
Round  97, Global train loss: 0.418, Global test loss: 1.229, Global test accuracy: 61.80
Round  98, Train loss: 0.363, Test loss: 0.971, Test accuracy: 71.59
Round  98, Global train loss: 0.363, Global test loss: 1.123, Global test accuracy: 65.71
Round  99, Train loss: 0.361, Test loss: 0.960, Test accuracy: 71.81
Round  99, Global train loss: 0.361, Global test loss: 1.142, Global test accuracy: 65.44
Final Round, Train loss: 0.321, Test loss: 0.946, Test accuracy: 73.03
Final Round, Global train loss: 0.321, Global test loss: 1.142, Global test accuracy: 65.44
Average accuracy final 10 rounds: 71.794 

Average global accuracy final 10 rounds: 63.59799999999999 

1540.0828437805176
[1.573429822921753, 3.146859645843506, 4.481857061386108, 5.816854476928711, 7.1574342250823975, 8.498013973236084, 9.8269784450531, 11.155942916870117, 12.509297370910645, 13.862651824951172, 15.204395532608032, 16.546139240264893, 17.888631582260132, 19.23112392425537, 20.577340364456177, 21.923556804656982, 23.275453805923462, 24.62735080718994, 25.977900505065918, 27.328450202941895, 28.672335863113403, 30.016221523284912, 31.355546236038208, 32.694870948791504, 34.027016401290894, 35.35916185379028, 36.68478202819824, 38.0104022026062, 39.33877348899841, 40.667144775390625, 42.00189685821533, 43.33664894104004, 44.66948199272156, 46.002315044403076, 47.344921350479126, 48.687527656555176, 50.014418601989746, 51.341309547424316, 52.678823471069336, 54.016337394714355, 55.35073399543762, 56.68513059616089, 58.015639543533325, 59.34614849090576, 60.682350397109985, 62.01855230331421, 63.35418391227722, 64.68981552124023, 66.02822971343994, 67.36664390563965, 68.7059977054596, 70.04535150527954, 71.37740540504456, 72.70945930480957, 74.04846978187561, 75.38748025894165, 76.72305679321289, 78.05863332748413, 79.39621353149414, 80.73379373550415, 82.07300043106079, 83.41220712661743, 84.74886178970337, 86.0855164527893, 87.41985654830933, 88.75419664382935, 90.08939003944397, 91.4245834350586, 92.76365494728088, 94.10272645950317, 95.43972873687744, 96.77673101425171, 98.11584544181824, 99.45495986938477, 100.79140162467957, 102.12784337997437, 103.46337723731995, 104.79891109466553, 106.13951683044434, 107.48012256622314, 108.81214189529419, 110.14416122436523, 111.47915887832642, 112.8141565322876, 114.14904165267944, 115.48392677307129, 116.8172562122345, 118.1505856513977, 119.4846510887146, 120.8187165260315, 122.14989733695984, 123.48107814788818, 124.8013801574707, 126.12168216705322, 127.45156216621399, 128.78144216537476, 130.12114548683167, 131.46084880828857, 132.7949869632721, 134.12912511825562, 135.44785523414612, 136.76658535003662, 138.10856866836548, 139.45055198669434, 140.7826864719391, 142.11482095718384, 143.4590620994568, 144.80330324172974, 146.13362574577332, 147.4639482498169, 148.79371213912964, 150.12347602844238, 151.44642448425293, 152.76937294006348, 154.09664177894592, 155.42391061782837, 156.74604892730713, 158.0681872367859, 159.4001042842865, 160.7320213317871, 162.04934167861938, 163.36666202545166, 164.69378328323364, 166.02090454101562, 167.3482563495636, 168.67560815811157, 170.01294875144958, 171.3502893447876, 172.69620013237, 174.0421109199524, 175.38127326965332, 176.72043561935425, 178.05898356437683, 179.3975315093994, 180.73603177070618, 182.07453203201294, 183.4109606742859, 184.74738931655884, 186.08421421051025, 187.42103910446167, 188.75804948806763, 190.09505987167358, 191.4294605255127, 192.7638611793518, 194.0994861125946, 195.4351110458374, 196.77178359031677, 198.10845613479614, 199.44318318367004, 200.77791023254395, 202.11293411254883, 203.4479579925537, 204.78208327293396, 206.1162085533142, 207.4595980644226, 208.802987575531, 210.1492211818695, 211.495454788208, 212.83787035942078, 214.18028593063354, 215.5033950805664, 216.82650423049927, 218.14767050743103, 219.4688367843628, 220.80328512191772, 222.13773345947266, 223.4782907962799, 224.81884813308716, 226.1592254638672, 227.49960279464722, 228.84010982513428, 230.18061685562134, 231.50679302215576, 232.83296918869019, 234.1600878238678, 235.4872064590454, 236.82604432106018, 238.16488218307495, 239.5108289718628, 240.85677576065063, 242.20167779922485, 243.54657983779907, 244.89179825782776, 246.23701667785645, 247.56971383094788, 248.9024109840393, 250.23820543289185, 251.57399988174438, 252.89992332458496, 254.22584676742554, 255.55045771598816, 256.8750686645508, 258.2007179260254, 259.5263671875, 260.8476309776306, 262.16889476776123, 263.47511076927185, 264.78132677078247, 266.0910234451294, 267.4007201194763, 270.0487473011017, 272.69677448272705]
[18.88, 18.88, 29.13, 29.13, 37.88, 37.88, 41.19, 41.19, 46.2, 46.2, 48.3, 48.3, 51.24, 51.24, 52.69, 52.69, 53.82, 53.82, 55.92, 55.92, 56.46, 56.46, 56.11, 56.11, 58.01, 58.01, 58.2, 58.2, 59.01, 59.01, 59.82, 59.82, 61.26, 61.26, 61.94, 61.94, 61.7, 61.7, 62.1, 62.1, 62.45, 62.45, 63.48, 63.48, 64.21, 64.21, 63.39, 63.39, 63.16, 63.16, 63.73, 63.73, 64.71, 64.71, 64.85, 64.85, 65.3, 65.3, 65.57, 65.57, 65.87, 65.87, 66.43, 66.43, 66.4, 66.4, 66.81, 66.81, 67.61, 67.61, 67.58, 67.58, 66.61, 66.61, 67.0, 67.0, 66.76, 66.76, 67.77, 67.77, 68.35, 68.35, 68.38, 68.38, 68.33, 68.33, 68.56, 68.56, 68.76, 68.76, 68.21, 68.21, 68.49, 68.49, 68.53, 68.53, 69.22, 69.22, 69.38, 69.38, 69.6, 69.6, 70.11, 70.11, 70.49, 70.49, 70.12, 70.12, 70.64, 70.64, 70.59, 70.59, 70.72, 70.72, 70.64, 70.64, 70.63, 70.63, 70.85, 70.85, 70.52, 70.52, 70.52, 70.52, 70.48, 70.48, 70.76, 70.76, 71.0, 71.0, 70.66, 70.66, 70.89, 70.89, 71.54, 71.54, 71.21, 71.21, 71.6, 71.6, 71.37, 71.37, 71.75, 71.75, 71.14, 71.14, 71.07, 71.07, 71.24, 71.24, 71.93, 71.93, 71.55, 71.55, 72.13, 72.13, 71.64, 71.64, 71.82, 71.82, 71.71, 71.71, 71.48, 71.48, 71.92, 71.92, 71.51, 71.51, 72.06, 72.06, 72.34, 72.34, 72.26, 72.26, 72.19, 72.19, 72.29, 72.29, 72.52, 72.52, 72.44, 72.44, 72.42, 72.42, 71.93, 71.93, 71.58, 71.58, 71.83, 71.83, 71.38, 71.38, 71.47, 71.47, 71.49, 71.49, 71.59, 71.59, 71.81, 71.81, 73.03, 73.03]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.729, Test loss: 2.161, Test accuracy: 15.92
Round   0, Global train loss: 1.729, Global test loss: 2.296, Global test accuracy: 12.01
Round   1, Train loss: 1.535, Test loss: 1.966, Test accuracy: 28.73
Round   1, Global train loss: 1.535, Global test loss: 2.237, Global test accuracy: 23.78
Round   2, Train loss: 1.436, Test loss: 1.752, Test accuracy: 34.66
Round   2, Global train loss: 1.436, Global test loss: 2.107, Global test accuracy: 27.07
Round   3, Train loss: 1.234, Test loss: 1.675, Test accuracy: 39.57
Round   3, Global train loss: 1.234, Global test loss: 2.180, Global test accuracy: 27.30
Round   4, Train loss: 1.267, Test loss: 1.443, Test accuracy: 43.84
Round   4, Global train loss: 1.267, Global test loss: 1.919, Global test accuracy: 29.11
Round   5, Train loss: 1.316, Test loss: 1.398, Test accuracy: 46.04
Round   5, Global train loss: 1.316, Global test loss: 1.788, Global test accuracy: 35.20
Round   6, Train loss: 1.243, Test loss: 1.334, Test accuracy: 49.32
Round   6, Global train loss: 1.243, Global test loss: 1.861, Global test accuracy: 36.30
Round   7, Train loss: 1.182, Test loss: 1.284, Test accuracy: 50.18
Round   7, Global train loss: 1.182, Global test loss: 1.748, Global test accuracy: 38.33
Round   8, Train loss: 1.200, Test loss: 1.263, Test accuracy: 51.16
Round   8, Global train loss: 1.200, Global test loss: 1.634, Global test accuracy: 41.52
Round   9, Train loss: 1.099, Test loss: 1.203, Test accuracy: 54.18
Round   9, Global train loss: 1.099, Global test loss: 1.609, Global test accuracy: 43.51
Round  10, Train loss: 1.151, Test loss: 1.222, Test accuracy: 54.19
Round  10, Global train loss: 1.151, Global test loss: 1.677, Global test accuracy: 42.74
Round  11, Train loss: 0.968, Test loss: 1.239, Test accuracy: 54.12
Round  11, Global train loss: 0.968, Global test loss: 1.786, Global test accuracy: 41.41
Round  12, Train loss: 1.030, Test loss: 1.157, Test accuracy: 56.18
Round  12, Global train loss: 1.030, Global test loss: 1.711, Global test accuracy: 41.34
Round  13, Train loss: 0.925, Test loss: 1.137, Test accuracy: 56.87
Round  13, Global train loss: 0.925, Global test loss: 1.499, Global test accuracy: 46.49
Round  14, Train loss: 1.103, Test loss: 1.105, Test accuracy: 58.29
Round  14, Global train loss: 1.103, Global test loss: 1.521, Global test accuracy: 44.76
Round  15, Train loss: 0.921, Test loss: 1.110, Test accuracy: 58.49
Round  15, Global train loss: 0.921, Global test loss: 1.640, Global test accuracy: 44.33
Round  16, Train loss: 1.013, Test loss: 1.100, Test accuracy: 59.53
Round  16, Global train loss: 1.013, Global test loss: 1.451, Global test accuracy: 48.19
Round  17, Train loss: 0.880, Test loss: 1.105, Test accuracy: 59.61
Round  17, Global train loss: 0.880, Global test loss: 1.611, Global test accuracy: 46.17
Round  18, Train loss: 0.995, Test loss: 1.077, Test accuracy: 60.58
Round  18, Global train loss: 0.995, Global test loss: 1.436, Global test accuracy: 48.07
Round  19, Train loss: 0.804, Test loss: 1.064, Test accuracy: 60.85
Round  19, Global train loss: 0.804, Global test loss: 1.570, Global test accuracy: 48.80
Round  20, Train loss: 0.977, Test loss: 1.049, Test accuracy: 61.01
Round  20, Global train loss: 0.977, Global test loss: 1.437, Global test accuracy: 48.21
Round  21, Train loss: 0.974, Test loss: 1.056, Test accuracy: 61.25
Round  21, Global train loss: 0.974, Global test loss: 1.479, Global test accuracy: 51.72
Round  22, Train loss: 0.881, Test loss: 1.064, Test accuracy: 61.47
Round  22, Global train loss: 0.881, Global test loss: 1.446, Global test accuracy: 48.42
Round  23, Train loss: 0.964, Test loss: 1.065, Test accuracy: 61.41
Round  23, Global train loss: 0.964, Global test loss: 1.580, Global test accuracy: 44.85
Round  24, Train loss: 0.811, Test loss: 1.062, Test accuracy: 61.12
Round  24, Global train loss: 0.811, Global test loss: 1.414, Global test accuracy: 51.11
Round  25, Train loss: 0.854, Test loss: 1.044, Test accuracy: 62.13
Round  25, Global train loss: 0.854, Global test loss: 1.303, Global test accuracy: 54.29
Round  26, Train loss: 0.809, Test loss: 1.011, Test accuracy: 63.35
Round  26, Global train loss: 0.809, Global test loss: 1.747, Global test accuracy: 44.81
Round  27, Train loss: 0.846, Test loss: 1.010, Test accuracy: 63.51
Round  27, Global train loss: 0.846, Global test loss: 1.354, Global test accuracy: 52.76
Round  28, Train loss: 0.779, Test loss: 1.009, Test accuracy: 63.27
Round  28, Global train loss: 0.779, Global test loss: 1.446, Global test accuracy: 48.13
Round  29, Train loss: 0.733, Test loss: 1.037, Test accuracy: 62.76
Round  29, Global train loss: 0.733, Global test loss: 1.306, Global test accuracy: 54.96
Round  30, Train loss: 0.736, Test loss: 1.026, Test accuracy: 63.15
Round  30, Global train loss: 0.736, Global test loss: 1.297, Global test accuracy: 54.07
Round  31, Train loss: 0.846, Test loss: 1.026, Test accuracy: 63.55
Round  31, Global train loss: 0.846, Global test loss: 1.340, Global test accuracy: 54.17
Round  32, Train loss: 0.668, Test loss: 1.033, Test accuracy: 63.97
Round  32, Global train loss: 0.668, Global test loss: 1.316, Global test accuracy: 55.03
Round  33, Train loss: 0.706, Test loss: 1.049, Test accuracy: 63.80
Round  33, Global train loss: 0.706, Global test loss: 1.487, Global test accuracy: 51.30
Round  34, Train loss: 0.797, Test loss: 1.054, Test accuracy: 63.92
Round  34, Global train loss: 0.797, Global test loss: 1.492, Global test accuracy: 50.50
Round  35, Train loss: 0.713, Test loss: 1.021, Test accuracy: 64.71
Round  35, Global train loss: 0.713, Global test loss: 1.292, Global test accuracy: 55.45
Round  36, Train loss: 0.702, Test loss: 1.001, Test accuracy: 65.35
Round  36, Global train loss: 0.702, Global test loss: 1.230, Global test accuracy: 58.19
Round  37, Train loss: 0.700, Test loss: 1.021, Test accuracy: 64.83
Round  37, Global train loss: 0.700, Global test loss: 1.719, Global test accuracy: 50.42
Round  38, Train loss: 0.596, Test loss: 1.043, Test accuracy: 64.54
Round  38, Global train loss: 0.596, Global test loss: 1.458, Global test accuracy: 51.75
Round  39, Train loss: 0.729, Test loss: 1.015, Test accuracy: 65.32
Round  39, Global train loss: 0.729, Global test loss: 1.291, Global test accuracy: 57.35
Round  40, Train loss: 0.714, Test loss: 1.037, Test accuracy: 65.42
Round  40, Global train loss: 0.714, Global test loss: 1.365, Global test accuracy: 54.81
Round  41, Train loss: 0.680, Test loss: 1.012, Test accuracy: 66.39
Round  41, Global train loss: 0.680, Global test loss: 1.276, Global test accuracy: 56.93
Round  42, Train loss: 0.736, Test loss: 1.032, Test accuracy: 65.99
Round  42, Global train loss: 0.736, Global test loss: 1.291, Global test accuracy: 56.08
Round  43, Train loss: 0.784, Test loss: 1.039, Test accuracy: 65.82
Round  43, Global train loss: 0.784, Global test loss: 1.486, Global test accuracy: 50.07
Round  44, Train loss: 0.640, Test loss: 1.081, Test accuracy: 64.94
Round  44, Global train loss: 0.640, Global test loss: 1.318, Global test accuracy: 55.51
Round  45, Train loss: 0.680, Test loss: 1.065, Test accuracy: 65.04
Round  45, Global train loss: 0.680, Global test loss: 1.254, Global test accuracy: 56.47
Round  46, Train loss: 0.566, Test loss: 1.043, Test accuracy: 65.90
Round  46, Global train loss: 0.566, Global test loss: 1.318, Global test accuracy: 57.39
Round  47, Train loss: 0.617, Test loss: 1.054, Test accuracy: 65.91
Round  47, Global train loss: 0.617, Global test loss: 1.352, Global test accuracy: 56.36
Round  48, Train loss: 0.611, Test loss: 1.075, Test accuracy: 65.94
Round  48, Global train loss: 0.611, Global test loss: 1.304, Global test accuracy: 57.32
Round  49, Train loss: 0.548, Test loss: 1.087, Test accuracy: 65.75
Round  49, Global train loss: 0.548, Global test loss: 1.457, Global test accuracy: 53.58
Round  50, Train loss: 0.566, Test loss: 1.076, Test accuracy: 66.43
Round  50, Global train loss: 0.566, Global test loss: 1.317, Global test accuracy: 56.81
Round  51, Train loss: 0.582, Test loss: 1.100, Test accuracy: 66.21
Round  51, Global train loss: 0.582, Global test loss: 1.363, Global test accuracy: 55.41
Round  52, Train loss: 0.552, Test loss: 1.077, Test accuracy: 66.77
Round  52, Global train loss: 0.552, Global test loss: 1.376, Global test accuracy: 54.85
Round  53, Train loss: 0.677, Test loss: 1.069, Test accuracy: 66.78
Round  53, Global train loss: 0.677, Global test loss: 1.276, Global test accuracy: 57.27
Round  54, Train loss: 0.501, Test loss: 1.086, Test accuracy: 66.27
Round  54, Global train loss: 0.501, Global test loss: 1.489, Global test accuracy: 54.81
Round  55, Train loss: 0.586, Test loss: 1.085, Test accuracy: 66.90
Round  55, Global train loss: 0.586, Global test loss: 1.258, Global test accuracy: 58.09
Round  56, Train loss: 0.552, Test loss: 1.089, Test accuracy: 66.99
Round  56, Global train loss: 0.552, Global test loss: 1.391, Global test accuracy: 56.60
Round  57, Train loss: 0.541, Test loss: 1.085, Test accuracy: 66.52
Round  57, Global train loss: 0.541, Global test loss: 1.282, Global test accuracy: 59.00
Round  58, Train loss: 0.522, Test loss: 1.064, Test accuracy: 67.27
Round  58, Global train loss: 0.522, Global test loss: 1.397, Global test accuracy: 57.11
Round  59, Train loss: 0.529, Test loss: 1.039, Test accuracy: 68.02
Round  59, Global train loss: 0.529, Global test loss: 1.383, Global test accuracy: 56.64
Round  60, Train loss: 0.552, Test loss: 1.036, Test accuracy: 67.99
Round  60, Global train loss: 0.552, Global test loss: 1.242, Global test accuracy: 58.52
Round  61, Train loss: 0.578, Test loss: 1.059, Test accuracy: 67.88
Round  61, Global train loss: 0.578, Global test loss: 1.443, Global test accuracy: 53.58
Round  62, Train loss: 0.601, Test loss: 1.049, Test accuracy: 68.04
Round  62, Global train loss: 0.601, Global test loss: 1.408, Global test accuracy: 56.22
Round  63, Train loss: 0.482, Test loss: 1.057, Test accuracy: 67.96
Round  63, Global train loss: 0.482, Global test loss: 1.354, Global test accuracy: 58.17
Round  64, Train loss: 0.445, Test loss: 1.048, Test accuracy: 68.14
Round  64, Global train loss: 0.445, Global test loss: 1.597, Global test accuracy: 54.94
Round  65, Train loss: 0.479, Test loss: 1.078, Test accuracy: 67.75
Round  65, Global train loss: 0.479, Global test loss: 1.191, Global test accuracy: 61.02
Round  66, Train loss: 0.430, Test loss: 1.089, Test accuracy: 67.71
Round  66, Global train loss: 0.430, Global test loss: 1.347, Global test accuracy: 58.81
Round  67, Train loss: 0.451, Test loss: 1.114, Test accuracy: 67.63
Round  67, Global train loss: 0.451, Global test loss: 1.272, Global test accuracy: 59.80
Round  68, Train loss: 0.439, Test loss: 1.129, Test accuracy: 67.40
Round  68, Global train loss: 0.439, Global test loss: 1.373, Global test accuracy: 58.11
Round  69, Train loss: 0.561, Test loss: 1.149, Test accuracy: 67.11
Round  69, Global train loss: 0.561, Global test loss: 1.316, Global test accuracy: 58.09
Round  70, Train loss: 0.386, Test loss: 1.134, Test accuracy: 67.40
Round  70, Global train loss: 0.386, Global test loss: 1.518, Global test accuracy: 56.31
Round  71, Train loss: 0.462, Test loss: 1.122, Test accuracy: 67.66
Round  71, Global train loss: 0.462, Global test loss: 1.207, Global test accuracy: 61.24
Round  72, Train loss: 0.533, Test loss: 1.127, Test accuracy: 67.47
Round  72, Global train loss: 0.533, Global test loss: 1.451, Global test accuracy: 56.56
Round  73, Train loss: 0.431, Test loss: 1.117, Test accuracy: 67.59
Round  73, Global train loss: 0.431, Global test loss: 1.384, Global test accuracy: 57.60
Round  74, Train loss: 0.470, Test loss: 1.104, Test accuracy: 67.78
Round  74, Global train loss: 0.470, Global test loss: 1.456, Global test accuracy: 57.04
Round  75, Train loss: 0.521, Test loss: 1.103, Test accuracy: 67.86
Round  75, Global train loss: 0.521, Global test loss: 1.379, Global test accuracy: 57.52
Round  76, Train loss: 0.463, Test loss: 1.110, Test accuracy: 68.02
Round  76, Global train loss: 0.463, Global test loss: 1.412, Global test accuracy: 57.79
Round  77, Train loss: 0.441, Test loss: 1.121, Test accuracy: 67.90
Round  77, Global train loss: 0.441, Global test loss: 1.439, Global test accuracy: 56.83
Round  78, Train loss: 0.489, Test loss: 1.138, Test accuracy: 67.91
Round  78, Global train loss: 0.489, Global test loss: 1.209, Global test accuracy: 61.35
Round  79, Train loss: 0.506, Test loss: 1.144, Test accuracy: 68.27
Round  79, Global train loss: 0.506, Global test loss: 1.412, Global test accuracy: 57.69
Round  80, Train loss: 0.431, Test loss: 1.158, Test accuracy: 68.00
Round  80, Global train loss: 0.431, Global test loss: 1.506, Global test accuracy: 56.51
Round  81, Train loss: 0.428, Test loss: 1.166, Test accuracy: 67.50
Round  81, Global train loss: 0.428, Global test loss: 1.812, Global test accuracy: 50.67
Round  82, Train loss: 0.430, Test loss: 1.123, Test accuracy: 68.44
Round  82, Global train loss: 0.430, Global test loss: 1.362, Global test accuracy: 59.09
Round  83, Train loss: 0.376, Test loss: 1.158, Test accuracy: 68.69
Round  83, Global train loss: 0.376, Global test loss: 1.410, Global test accuracy: 60.26
Round  84, Train loss: 0.359, Test loss: 1.178, Test accuracy: 68.49
Round  84, Global train loss: 0.359, Global test loss: 1.727, Global test accuracy: 55.79
Round  85, Train loss: 0.379, Test loss: 1.185, Test accuracy: 67.85
Round  85, Global train loss: 0.379, Global test loss: 1.526, Global test accuracy: 57.32
Round  86, Train loss: 0.338, Test loss: 1.184, Test accuracy: 68.37
Round  86, Global train loss: 0.338, Global test loss: 1.456, Global test accuracy: 58.43
Round  87, Train loss: 0.431, Test loss: 1.146, Test accuracy: 68.62
Round  87, Global train loss: 0.431, Global test loss: 1.378, Global test accuracy: 58.81
Round  88, Train loss: 0.365, Test loss: 1.152, Test accuracy: 68.65
Round  88, Global train loss: 0.365, Global test loss: 1.382, Global test accuracy: 59.16
Round  89, Train loss: 0.433, Test loss: 1.146, Test accuracy: 69.04
Round  89, Global train loss: 0.433, Global test loss: 1.469, Global test accuracy: 58.39
Round  90, Train loss: 0.467, Test loss: 1.181, Test accuracy: 68.09
Round  90, Global train loss: 0.467, Global test loss: 1.422, Global test accuracy: 58.64
Round  91, Train loss: 0.335, Test loss: 1.177, Test accuracy: 68.44
Round  91, Global train loss: 0.335, Global test loss: 1.377, Global test accuracy: 59.43
Round  92, Train loss: 0.469, Test loss: 1.202, Test accuracy: 67.90
Round  92, Global train loss: 0.469, Global test loss: 1.334, Global test accuracy: 59.77
Round  93, Train loss: 0.431, Test loss: 1.161, Test accuracy: 68.63
Round  93, Global train loss: 0.431, Global test loss: 1.248, Global test accuracy: 61.06
Round  94, Train loss: 0.376, Test loss: 1.163, Test accuracy: 68.31
Round  94, Global train loss: 0.376, Global test loss: 1.328, Global test accuracy: 59.08
Round  95, Train loss: 0.341, Test loss: 1.190, Test accuracy: 68.28
Round  95, Global train loss: 0.341, Global test loss: 1.383, Global test accuracy: 59.95
Round  96, Train loss: 0.371, Test loss: 1.193, Test accuracy: 67.93
Round  96, Global train loss: 0.371, Global test loss: 1.263, Global test accuracy: 62.39
Round  97, Train loss: 0.481, Test loss: 1.213, Test accuracy: 67.69
Round  97, Global train loss: 0.481, Global test loss: 1.407, Global test accuracy: 57.64
Round  98, Train loss: 0.356, Test loss: 1.175, Test accuracy: 68.68
Round  98, Global train loss: 0.356, Global test loss: 1.250, Global test accuracy: 62.10
Round  99, Train loss: 0.372, Test loss: 1.203, Test accuracy: 68.66
Round  99, Global train loss: 0.372, Global test loss: 1.279, Global test accuracy: 61.53
Final Round, Train loss: 0.307, Test loss: 1.327, Test accuracy: 68.14
Final Round, Global train loss: 0.307, Global test loss: 1.279, Global test accuracy: 61.53
Average accuracy final 10 rounds: 68.261
Average global accuracy final 10 rounds: 60.159
2163.202320098877
[2.8331382274627686, 5.440856218338013, 8.067933082580566, 10.697595357894897, 13.323501825332642, 15.95303201675415, 18.577235221862793, 21.18445873260498, 23.784533262252808, 26.38361096382141, 28.986443758010864, 31.58181595802307, 34.187198877334595, 36.79901456832886, 39.40203022956848, 42.00991606712341, 44.6266450881958, 47.242146253585815, 49.87609648704529, 52.5027220249176, 55.12658953666687, 57.758681774139404, 60.39341616630554, 63.005082845687866, 65.60207962989807, 68.20711302757263, 70.81198358535767, 73.41441297531128, 76.01165795326233, 78.61586475372314, 81.21595191955566, 83.81646513938904, 86.41688132286072, 89.01804256439209, 91.6205186843872, 94.22847533226013, 96.84421682357788, 99.4736270904541, 102.10533308982849, 104.71170687675476, 107.31724762916565, 109.92157196998596, 112.53571057319641, 115.14180445671082, 117.74079918861389, 120.35970211029053, 122.96844840049744, 125.5670554637909, 128.3872275352478, 131.18370032310486, 133.98144817352295, 136.7766227722168, 139.5751829147339, 142.36913585662842, 145.16393876075745, 147.9569776058197, 150.7471740245819, 153.5369358062744, 156.33089017868042, 159.11991596221924, 161.9146807193756, 164.69491839408875, 167.48807883262634, 170.27195072174072, 173.07118463516235, 175.8760507106781, 178.6779465675354, 181.4682581424713, 184.2624876499176, 187.05650210380554, 189.86589694023132, 192.6732623577118, 195.47926115989685, 198.27839350700378, 201.07567954063416, 203.86673784255981, 206.65399837493896, 209.3575096130371, 212.0684459209442, 214.7710964679718, 217.47644329071045, 220.18661904335022, 222.9046437740326, 225.59925651550293, 228.3274712562561, 231.03779363632202, 233.73367619514465, 236.43453812599182, 239.1437544822693, 241.86563849449158, 244.5702850818634, 247.27355551719666, 249.97963643074036, 252.68795728683472, 255.38560318946838, 258.0825400352478, 260.78411769866943, 263.49212861061096, 266.186518907547, 268.8973476886749, 273.84602522850037]
[15.92, 28.73, 34.66, 39.57, 43.84, 46.04, 49.32, 50.18, 51.16, 54.18, 54.19, 54.12, 56.18, 56.87, 58.29, 58.49, 59.53, 59.61, 60.58, 60.85, 61.01, 61.25, 61.47, 61.41, 61.12, 62.13, 63.35, 63.51, 63.27, 62.76, 63.15, 63.55, 63.97, 63.8, 63.92, 64.71, 65.35, 64.83, 64.54, 65.32, 65.42, 66.39, 65.99, 65.82, 64.94, 65.04, 65.9, 65.91, 65.94, 65.75, 66.43, 66.21, 66.77, 66.78, 66.27, 66.9, 66.99, 66.52, 67.27, 68.02, 67.99, 67.88, 68.04, 67.96, 68.14, 67.75, 67.71, 67.63, 67.4, 67.11, 67.4, 67.66, 67.47, 67.59, 67.78, 67.86, 68.02, 67.9, 67.91, 68.27, 68.0, 67.5, 68.44, 68.69, 68.49, 67.85, 68.37, 68.62, 68.65, 69.04, 68.09, 68.44, 67.9, 68.63, 68.31, 68.28, 67.93, 67.69, 68.68, 68.66, 68.14]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  18.8000
Round 1 global test acc  17.9700
Round 2 global test acc  26.2300
Round 3 global test acc  21.9800
Round 4 global test acc  23.1300
Round 5 global test acc  26.0400
Round 6 global test acc  29.0200
Round 7 global test acc  32.6800
Round 8 global test acc  29.9300
Round 9 global test acc  25.7100
Round 10 global test acc  30.9600
Round 11 global test acc  36.1900
Round 12 global test acc  35.8400
Round 13 global test acc  34.8500
Round 14 global test acc  33.5800
Round 15 global test acc  33.7100
Round 16 global test acc  35.8000
Round 17 global test acc  31.0600
Round 18 global test acc  32.5200
Round 19 global test acc  37.5900
Round 20 global test acc  31.5100
Round 21 global test acc  29.8400
Round 22 global test acc  29.8600
Round 23 global test acc  35.0200
Round 24 global test acc  30.6900
Round 25 global test acc  31.5600
Round 26 global test acc  40.6100
Round 27 global test acc  37.6000
Round 28 global test acc  35.0900
Round 29 global test acc  39.0500
Round 30 global test acc  39.6100
Round 31 global test acc  36.6900
Round 32 global test acc  36.8100
Round 33 global test acc  42.3200
Round 34 global test acc  39.0700
Round 35 global test acc  34.8700
Round 36 global test acc  35.3900
Round 37 global test acc  48.6700
Round 38 global test acc  35.2400
Round 39 global test acc  34.7300
Round 40 global test acc  42.2800
Round 41 global test acc  38.9500
Round 42 global test acc  39.2400
Round 43 global test acc  42.0900
Round 44 global test acc  42.9100
Round 45 global test acc  41.6600
Round 46 global test acc  37.2300
Round 47 global test acc  39.5700
Round 48 global test acc  38.7200
Round 49 global test acc  47.9500
Round 50 global test acc  41.6900
Round 51 global test acc  40.9200
Round 52 global test acc  31.5800
Round 53 global test acc  35.3000
Round 54 global test acc  38.8300
Round 55 global test acc  36.3100
Round 56 global test acc  39.1600
Round 57 global test acc  33.3300
Round 58 global test acc  35.3200
Round 59 global test acc  39.2600
Round 60 global test acc  38.5800
Round 61 global test acc  36.2200
Round 62 global test acc  31.9600
Round 63 global test acc  39.3500
Round 64 global test acc  40.3500
Round 65 global test acc  37.0200
Round 66 global test acc  39.2300
Round 67 global test acc  42.4800
Round 68 global test acc  36.4600
Round 69 global test acc  39.5900
Round 70 global test acc  39.2400
Round 71 global test acc  39.1400
Round 72 global test acc  42.7400
Round 73 global test acc  41.0000
Round 74 global test acc  38.0000
Round 75 global test acc  36.5000
Round 76 global test acc  36.4000
Round 77 global test acc  36.2000
Round 78 global test acc  39.8500
Round 79 global test acc  42.5500
Round 80 global test acc  40.3000
Round 81 global test acc  35.0600
Round 82 global test acc  33.3800
Round 83 global test acc  31.0300
Round 84 global test acc  28.4300
Round 85 global test acc  24.9900
Round 86 global test acc  23.9000
Round 87 global test acc  22.6800
Round 88 global test acc  20.2900
Round 89 global test acc  19.1700
Round 90 global test acc  18.8700
Round 91 global test acc  18.5500
Round 92 global test acc  18.5000
Round 93 global test acc  18.2200
Round 94 global test acc  18.6100
Round 95 global test acc  18.1800
Round 96 global test acc  17.5900
Round 97 global test acc  17.4100
Round 98 global test acc  17.1900
Round 99 global test acc  17.7500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.982, Test loss: 2.231, Test accuracy: 15.53
Round   1, Train loss: 1.560, Test loss: 1.964, Test accuracy: 27.25
Round   2, Train loss: 1.441, Test loss: 1.711, Test accuracy: 32.80
Round   3, Train loss: 1.298, Test loss: 1.593, Test accuracy: 41.51
Round   4, Train loss: 1.317, Test loss: 1.310, Test accuracy: 47.55
Round   5, Train loss: 1.226, Test loss: 1.263, Test accuracy: 49.61
Round   6, Train loss: 1.214, Test loss: 1.192, Test accuracy: 52.57
Round   7, Train loss: 1.138, Test loss: 1.167, Test accuracy: 53.82
Round   8, Train loss: 1.134, Test loss: 1.163, Test accuracy: 55.05
Round   9, Train loss: 1.082, Test loss: 1.101, Test accuracy: 56.60
Round  10, Train loss: 1.172, Test loss: 1.101, Test accuracy: 56.60
Round  11, Train loss: 0.983, Test loss: 1.143, Test accuracy: 56.72
Round  12, Train loss: 1.047, Test loss: 1.010, Test accuracy: 59.35
Round  13, Train loss: 0.981, Test loss: 1.011, Test accuracy: 59.15
Round  14, Train loss: 1.134, Test loss: 0.991, Test accuracy: 60.74
Round  15, Train loss: 0.989, Test loss: 0.977, Test accuracy: 61.31
Round  16, Train loss: 1.026, Test loss: 0.947, Test accuracy: 62.40
Round  17, Train loss: 0.901, Test loss: 0.923, Test accuracy: 63.13
Round  18, Train loss: 0.991, Test loss: 0.921, Test accuracy: 63.20
Round  19, Train loss: 0.876, Test loss: 0.909, Test accuracy: 64.24
Round  20, Train loss: 0.940, Test loss: 0.909, Test accuracy: 64.11
Round  21, Train loss: 0.951, Test loss: 0.887, Test accuracy: 65.16
Round  22, Train loss: 0.988, Test loss: 0.874, Test accuracy: 65.42
Round  23, Train loss: 0.920, Test loss: 0.872, Test accuracy: 66.04
Round  24, Train loss: 0.872, Test loss: 0.866, Test accuracy: 65.90
Round  25, Train loss: 0.862, Test loss: 0.869, Test accuracy: 65.35
Round  26, Train loss: 0.848, Test loss: 0.856, Test accuracy: 65.91
Round  27, Train loss: 0.873, Test loss: 0.834, Test accuracy: 67.17
Round  28, Train loss: 0.820, Test loss: 0.844, Test accuracy: 66.87
Round  29, Train loss: 0.756, Test loss: 0.843, Test accuracy: 66.69
Round  30, Train loss: 0.850, Test loss: 0.825, Test accuracy: 67.84
Round  31, Train loss: 0.838, Test loss: 0.809, Test accuracy: 69.00
Round  32, Train loss: 0.734, Test loss: 0.803, Test accuracy: 68.72
Round  33, Train loss: 0.773, Test loss: 0.789, Test accuracy: 69.32
Round  34, Train loss: 0.845, Test loss: 0.795, Test accuracy: 68.75
Round  35, Train loss: 0.811, Test loss: 0.784, Test accuracy: 69.51
Round  36, Train loss: 0.801, Test loss: 0.785, Test accuracy: 69.38
Round  37, Train loss: 0.756, Test loss: 0.789, Test accuracy: 68.50
Round  38, Train loss: 0.692, Test loss: 0.771, Test accuracy: 69.30
Round  39, Train loss: 0.751, Test loss: 0.763, Test accuracy: 70.10
Round  40, Train loss: 0.729, Test loss: 0.750, Test accuracy: 70.67
Round  41, Train loss: 0.699, Test loss: 0.748, Test accuracy: 70.54
Round  42, Train loss: 0.767, Test loss: 0.751, Test accuracy: 70.16
Round  43, Train loss: 0.793, Test loss: 0.752, Test accuracy: 70.46
Round  44, Train loss: 0.668, Test loss: 0.731, Test accuracy: 71.47
Round  45, Train loss: 0.818, Test loss: 0.732, Test accuracy: 71.17
Round  46, Train loss: 0.611, Test loss: 0.719, Test accuracy: 71.82
Round  47, Train loss: 0.655, Test loss: 0.731, Test accuracy: 71.47
Round  48, Train loss: 0.682, Test loss: 0.713, Test accuracy: 72.26
Round  49, Train loss: 0.647, Test loss: 0.711, Test accuracy: 72.47
Round  50, Train loss: 0.664, Test loss: 0.719, Test accuracy: 72.19
Round  51, Train loss: 0.638, Test loss: 0.717, Test accuracy: 72.65
Round  52, Train loss: 0.616, Test loss: 0.705, Test accuracy: 73.05
Round  53, Train loss: 0.718, Test loss: 0.708, Test accuracy: 72.92
Round  54, Train loss: 0.595, Test loss: 0.710, Test accuracy: 73.16
Round  55, Train loss: 0.642, Test loss: 0.697, Test accuracy: 73.07
Round  56, Train loss: 0.648, Test loss: 0.703, Test accuracy: 72.99
Round  57, Train loss: 0.605, Test loss: 0.690, Test accuracy: 73.58
Round  58, Train loss: 0.566, Test loss: 0.692, Test accuracy: 73.30
Round  59, Train loss: 0.611, Test loss: 0.705, Test accuracy: 73.13
Round  60, Train loss: 0.680, Test loss: 0.698, Test accuracy: 73.02
Round  61, Train loss: 0.706, Test loss: 0.698, Test accuracy: 73.39
Round  62, Train loss: 0.643, Test loss: 0.691, Test accuracy: 73.51
Round  63, Train loss: 0.509, Test loss: 0.686, Test accuracy: 73.77
Round  64, Train loss: 0.528, Test loss: 0.688, Test accuracy: 73.73
Round  65, Train loss: 0.540, Test loss: 0.684, Test accuracy: 74.10
Round  66, Train loss: 0.542, Test loss: 0.685, Test accuracy: 73.80
Round  67, Train loss: 0.503, Test loss: 0.673, Test accuracy: 74.36
Round  68, Train loss: 0.571, Test loss: 0.680, Test accuracy: 73.77
Round  69, Train loss: 0.622, Test loss: 0.672, Test accuracy: 74.16
Round  70, Train loss: 0.477, Test loss: 0.680, Test accuracy: 74.18
Round  71, Train loss: 0.492, Test loss: 0.675, Test accuracy: 74.32
Round  72, Train loss: 0.646, Test loss: 0.677, Test accuracy: 74.14
Round  73, Train loss: 0.501, Test loss: 0.681, Test accuracy: 74.20
Round  74, Train loss: 0.557, Test loss: 0.685, Test accuracy: 74.19
Round  75, Train loss: 0.583, Test loss: 0.691, Test accuracy: 74.35
Round  76, Train loss: 0.535, Test loss: 0.679, Test accuracy: 74.48
Round  77, Train loss: 0.491, Test loss: 0.676, Test accuracy: 74.75
Round  78, Train loss: 0.533, Test loss: 0.680, Test accuracy: 74.64
Round  79, Train loss: 0.540, Test loss: 0.681, Test accuracy: 74.34
Round  80, Train loss: 0.539, Test loss: 0.686, Test accuracy: 74.00
Round  81, Train loss: 0.535, Test loss: 0.700, Test accuracy: 73.90
Round  82, Train loss: 0.499, Test loss: 0.688, Test accuracy: 74.21
Round  83, Train loss: 0.477, Test loss: 0.681, Test accuracy: 74.16
Round  84, Train loss: 0.434, Test loss: 0.673, Test accuracy: 74.78
Round  85, Train loss: 0.508, Test loss: 0.677, Test accuracy: 74.89
Round  86, Train loss: 0.424, Test loss: 0.682, Test accuracy: 74.27
Round  87, Train loss: 0.480, Test loss: 0.686, Test accuracy: 73.86
Round  88, Train loss: 0.423, Test loss: 0.687, Test accuracy: 73.96
Round  89, Train loss: 0.469, Test loss: 0.680, Test accuracy: 74.28
Round  90, Train loss: 0.584, Test loss: 0.675, Test accuracy: 74.42
Round  91, Train loss: 0.412, Test loss: 0.675, Test accuracy: 74.77
Round  92, Train loss: 0.540, Test loss: 0.659, Test accuracy: 75.07
Round  93, Train loss: 0.541, Test loss: 0.669, Test accuracy: 74.89
Round  94, Train loss: 0.455, Test loss: 0.670, Test accuracy: 75.00
Round  95, Train loss: 0.466, Test loss: 0.664, Test accuracy: 75.15
Round  96, Train loss: 0.480, Test loss: 0.665, Test accuracy: 75.04
Round  97, Train loss: 0.473, Test loss: 0.657, Test accuracy: 75.77
Round  98, Train loss: 0.502, Test loss: 0.665, Test accuracy: 75.26
Round  99, Train loss: 0.406, Test loss: 0.667, Test accuracy: 75.15
Final Round, Train loss: 0.395, Test loss: 0.669, Test accuracy: 75.27
Average accuracy final 10 rounds: 75.052
1082.4646966457367
[1.6038718223571777, 2.9339587688446045, 4.274264574050903, 5.7007811069488525, 7.117664098739624, 8.528889894485474, 9.942611455917358, 11.355575323104858, 12.766414403915405, 14.177153587341309, 15.580825805664062, 16.96542501449585, 18.344653129577637, 19.723061084747314, 21.120944023132324, 22.52785587310791, 23.94399356842041, 25.34938144683838, 26.756293535232544, 28.13683009147644, 29.520118713378906, 30.916778564453125, 32.32417869567871, 33.74075365066528, 35.14138913154602, 36.54365873336792, 37.94774842262268, 39.35199213027954, 40.74303936958313, 42.15126323699951, 43.558295488357544, 44.96641135215759, 46.37754201889038, 47.77908158302307, 49.17529535293579, 50.57082486152649, 51.97049903869629, 53.35114002227783, 54.72425436973572, 56.124173641204834, 57.52312397956848, 58.90316367149353, 60.291810750961304, 61.6820707321167, 63.07383179664612, 64.46010732650757, 65.85212659835815, 67.21968960762024, 68.58684635162354, 69.95745253562927, 71.34703373908997, 72.72441458702087, 74.09372568130493, 75.4573085308075, 76.82858514785767, 78.20153474807739, 79.56610417366028, 80.932363986969, 82.29536724090576, 83.65906238555908, 85.01934766769409, 86.38647508621216, 87.77154064178467, 89.15490984916687, 90.54799747467041, 91.93539595603943, 93.32663655281067, 94.69993758201599, 96.07566618919373, 97.45677137374878, 98.84075140953064, 100.21625685691833, 101.59441089630127, 102.97324919700623, 104.34137797355652, 105.72203421592712, 107.09636616706848, 108.46850752830505, 109.84409213066101, 111.22059226036072, 112.58198714256287, 113.94186925888062, 115.30651426315308, 116.66602873802185, 118.02593922615051, 119.39327549934387, 120.76919269561768, 122.15669417381287, 123.5306510925293, 124.88974404335022, 126.26249384880066, 127.63100361824036, 129.00807118415833, 130.38079404830933, 131.75185179710388, 133.1220419406891, 134.50180983543396, 135.8773422241211, 137.2612121105194, 138.64676427841187, 140.65996408462524]
[15.53, 27.25, 32.8, 41.51, 47.55, 49.61, 52.57, 53.82, 55.05, 56.6, 56.6, 56.72, 59.35, 59.15, 60.74, 61.31, 62.4, 63.13, 63.2, 64.24, 64.11, 65.16, 65.42, 66.04, 65.9, 65.35, 65.91, 67.17, 66.87, 66.69, 67.84, 69.0, 68.72, 69.32, 68.75, 69.51, 69.38, 68.5, 69.3, 70.1, 70.67, 70.54, 70.16, 70.46, 71.47, 71.17, 71.82, 71.47, 72.26, 72.47, 72.19, 72.65, 73.05, 72.92, 73.16, 73.07, 72.99, 73.58, 73.3, 73.13, 73.02, 73.39, 73.51, 73.77, 73.73, 74.1, 73.8, 74.36, 73.77, 74.16, 74.18, 74.32, 74.14, 74.2, 74.19, 74.35, 74.48, 74.75, 74.64, 74.34, 74.0, 73.9, 74.21, 74.16, 74.78, 74.89, 74.27, 73.86, 73.96, 74.28, 74.42, 74.77, 75.07, 74.89, 75.0, 75.15, 75.04, 75.77, 75.26, 75.15, 75.27]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.706, Test loss: 2.127, Test accuracy: 22.68
Round   1, Train loss: 1.308, Test loss: 1.800, Test accuracy: 33.70
Round   2, Train loss: 1.239, Test loss: 1.529, Test accuracy: 41.30
Round   3, Train loss: 1.075, Test loss: 1.424, Test accuracy: 47.81
Round   4, Train loss: 1.087, Test loss: 1.193, Test accuracy: 53.74
Round   5, Train loss: 1.081, Test loss: 1.147, Test accuracy: 55.87
Round   6, Train loss: 0.955, Test loss: 1.127, Test accuracy: 56.39
Round   7, Train loss: 1.011, Test loss: 1.072, Test accuracy: 57.32
Round   8, Train loss: 0.949, Test loss: 1.071, Test accuracy: 58.55
Round   9, Train loss: 0.897, Test loss: 0.997, Test accuracy: 60.94
Round  10, Train loss: 0.961, Test loss: 0.996, Test accuracy: 60.79
Round  11, Train loss: 0.766, Test loss: 1.005, Test accuracy: 62.69
Round  12, Train loss: 0.832, Test loss: 0.882, Test accuracy: 64.69
Round  13, Train loss: 0.789, Test loss: 0.870, Test accuracy: 65.93
Round  14, Train loss: 0.853, Test loss: 0.853, Test accuracy: 66.53
Round  15, Train loss: 0.742, Test loss: 0.847, Test accuracy: 66.43
Round  16, Train loss: 0.775, Test loss: 0.840, Test accuracy: 66.98
Round  17, Train loss: 0.658, Test loss: 0.831, Test accuracy: 67.48
Round  18, Train loss: 0.749, Test loss: 0.795, Test accuracy: 69.34
Round  19, Train loss: 0.616, Test loss: 0.796, Test accuracy: 69.37
Round  20, Train loss: 0.700, Test loss: 0.794, Test accuracy: 69.36
Round  21, Train loss: 0.631, Test loss: 0.794, Test accuracy: 69.40
Round  22, Train loss: 0.724, Test loss: 0.778, Test accuracy: 70.09
Round  23, Train loss: 0.631, Test loss: 0.782, Test accuracy: 70.08
Round  24, Train loss: 0.555, Test loss: 0.764, Test accuracy: 70.25
Round  25, Train loss: 0.585, Test loss: 0.774, Test accuracy: 70.48
Round  26, Train loss: 0.588, Test loss: 0.756, Test accuracy: 70.93
Round  27, Train loss: 0.604, Test loss: 0.747, Test accuracy: 71.67
Round  28, Train loss: 0.570, Test loss: 0.751, Test accuracy: 71.86
Round  29, Train loss: 0.516, Test loss: 0.757, Test accuracy: 71.72
Round  30, Train loss: 0.507, Test loss: 0.746, Test accuracy: 71.76
Round  31, Train loss: 0.553, Test loss: 0.751, Test accuracy: 71.76
Round  32, Train loss: 0.498, Test loss: 0.733, Test accuracy: 72.90
Round  33, Train loss: 0.474, Test loss: 0.727, Test accuracy: 73.12
Round  34, Train loss: 0.529, Test loss: 0.723, Test accuracy: 73.28
Round  35, Train loss: 0.535, Test loss: 0.727, Test accuracy: 72.86
Round  36, Train loss: 0.449, Test loss: 0.731, Test accuracy: 73.10
Round  37, Train loss: 0.466, Test loss: 0.759, Test accuracy: 72.29
Round  38, Train loss: 0.454, Test loss: 0.735, Test accuracy: 72.85
Round  39, Train loss: 0.463, Test loss: 0.723, Test accuracy: 73.44
Round  40, Train loss: 0.500, Test loss: 0.713, Test accuracy: 74.04
Round  41, Train loss: 0.458, Test loss: 0.719, Test accuracy: 73.42
Round  42, Train loss: 0.440, Test loss: 0.728, Test accuracy: 73.31
Round  43, Train loss: 0.503, Test loss: 0.748, Test accuracy: 72.65
Round  44, Train loss: 0.406, Test loss: 0.727, Test accuracy: 73.20
Round  45, Train loss: 0.504, Test loss: 0.736, Test accuracy: 73.60
Round  46, Train loss: 0.368, Test loss: 0.724, Test accuracy: 74.01
Round  47, Train loss: 0.423, Test loss: 0.723, Test accuracy: 73.94
Round  48, Train loss: 0.411, Test loss: 0.725, Test accuracy: 74.07
Round  49, Train loss: 0.368, Test loss: 0.703, Test accuracy: 74.59
Round  50, Train loss: 0.356, Test loss: 0.721, Test accuracy: 73.94
Round  51, Train loss: 0.385, Test loss: 0.725, Test accuracy: 74.39
Round  52, Train loss: 0.354, Test loss: 0.727, Test accuracy: 74.06
Round  53, Train loss: 0.420, Test loss: 0.732, Test accuracy: 73.99
Round  54, Train loss: 0.329, Test loss: 0.718, Test accuracy: 74.83
Round  55, Train loss: 0.422, Test loss: 0.726, Test accuracy: 74.56
Round  56, Train loss: 0.349, Test loss: 0.749, Test accuracy: 73.83
Round  57, Train loss: 0.363, Test loss: 0.753, Test accuracy: 73.67
Round  58, Train loss: 0.337, Test loss: 0.750, Test accuracy: 73.89
Round  59, Train loss: 0.327, Test loss: 0.748, Test accuracy: 73.87
Round  60, Train loss: 0.393, Test loss: 0.732, Test accuracy: 74.85
Round  61, Train loss: 0.396, Test loss: 0.765, Test accuracy: 74.02
Round  62, Train loss: 0.343, Test loss: 0.770, Test accuracy: 74.06
Round  63, Train loss: 0.282, Test loss: 0.790, Test accuracy: 73.51
Round  64, Train loss: 0.269, Test loss: 0.793, Test accuracy: 73.53
Round  65, Train loss: 0.292, Test loss: 0.762, Test accuracy: 74.60
Round  66, Train loss: 0.262, Test loss: 0.766, Test accuracy: 74.34
Round  67, Train loss: 0.261, Test loss: 0.750, Test accuracy: 74.45
Round  68, Train loss: 0.271, Test loss: 0.763, Test accuracy: 74.62
Round  69, Train loss: 0.362, Test loss: 0.755, Test accuracy: 74.86
Round  70, Train loss: 0.234, Test loss: 0.745, Test accuracy: 74.81
Round  71, Train loss: 0.275, Test loss: 0.744, Test accuracy: 75.16
Round  72, Train loss: 0.336, Test loss: 0.769, Test accuracy: 74.10
Round  73, Train loss: 0.236, Test loss: 0.754, Test accuracy: 74.63
Round  74, Train loss: 0.285, Test loss: 0.747, Test accuracy: 74.27
Round  75, Train loss: 0.314, Test loss: 0.752, Test accuracy: 74.77
Round  76, Train loss: 0.308, Test loss: 0.756, Test accuracy: 74.91
Round  77, Train loss: 0.242, Test loss: 0.761, Test accuracy: 74.90
Round  78, Train loss: 0.337, Test loss: 0.755, Test accuracy: 74.74
Round  79, Train loss: 0.298, Test loss: 0.758, Test accuracy: 74.76
Round  80, Train loss: 0.268, Test loss: 0.776, Test accuracy: 74.99
Round  81, Train loss: 0.271, Test loss: 0.792, Test accuracy: 74.40
Round  82, Train loss: 0.255, Test loss: 0.788, Test accuracy: 74.62
Round  83, Train loss: 0.266, Test loss: 0.780, Test accuracy: 74.45
Round  84, Train loss: 0.244, Test loss: 0.757, Test accuracy: 75.38
Round  85, Train loss: 0.230, Test loss: 0.765, Test accuracy: 75.30
Round  86, Train loss: 0.213, Test loss: 0.772, Test accuracy: 74.70
Round  87, Train loss: 0.262, Test loss: 0.776, Test accuracy: 74.61
Round  88, Train loss: 0.228, Test loss: 0.785, Test accuracy: 74.35
Round  89, Train loss: 0.232, Test loss: 0.778, Test accuracy: 74.87
Round  90, Train loss: 0.264, Test loss: 0.768, Test accuracy: 75.06
Round  91, Train loss: 0.200, Test loss: 0.774, Test accuracy: 74.97
Round  92, Train loss: 0.341, Test loss: 0.772, Test accuracy: 75.02
Round  93, Train loss: 0.278, Test loss: 0.765, Test accuracy: 75.13
Round  94, Train loss: 0.263, Test loss: 0.773, Test accuracy: 75.05
Round  95, Train loss: 0.213, Test loss: 0.764, Test accuracy: 75.38
Round  96, Train loss: 0.278, Test loss: 0.771, Test accuracy: 75.18
Round  97, Train loss: 0.265, Test loss: 0.775, Test accuracy: 75.03
Round  98, Train loss: 0.254, Test loss: 0.779, Test accuracy: 75.21
Round  99, Train loss: 0.236, Test loss: 0.771, Test accuracy: 74.78
Final Round, Train loss: 0.228, Test loss: 0.750, Test accuracy: 75.69
Average accuracy final 10 rounds: 75.08099999999999
2553.5505542755127
[3.070718765258789, 5.854379177093506, 8.635459661483765, 11.42470097541809, 14.179270505905151, 16.91496968269348, 19.645185947418213, 22.379947662353516, 25.135804891586304, 27.913188934326172, 30.6853768825531, 33.47665023803711, 36.25053429603577, 38.99989724159241, 41.76598381996155, 44.57726049423218, 47.40902256965637, 50.21926736831665, 53.003519773483276, 55.77460026741028, 58.53832221031189, 62.778260707855225, 66.87147116661072, 71.07459735870361, 75.3031952381134, 79.54571557044983, 83.78186511993408, 88.05566048622131, 92.29171085357666, 96.54631805419922, 100.83549118041992, 104.99424481391907, 108.86717700958252, 113.13516211509705, 117.32698583602905, 121.50829267501831, 125.65324687957764, 129.80945205688477, 133.92868757247925, 138.02836084365845, 142.1916356086731, 146.36962509155273, 150.5596799850464, 154.72388291358948, 158.91719889640808, 163.11930108070374, 167.19878840446472, 171.42267966270447, 175.64328527450562, 179.85139226913452, 184.0656177997589, 188.29030799865723, 192.51018810272217, 196.6796271800995, 200.8305366039276, 205.03170156478882, 209.2271695137024, 213.403990983963, 217.57558751106262, 221.61282896995544, 225.77325248718262, 229.96761059761047, 234.14398288726807, 238.295330286026, 242.45367407798767, 246.41221237182617, 250.4241533279419, 254.584055185318, 258.7681174278259, 262.93598341941833, 267.10713815689087, 271.29120993614197, 275.4732332229614, 279.65211629867554, 283.8377366065979, 288.0095603466034, 292.0562505722046, 296.18263697624207, 300.30023980140686, 304.44986057281494, 308.60945224761963, 312.77510833740234, 316.91575145721436, 321.05511355400085, 325.2005751132965, 329.3438355922699, 333.46212792396545, 337.62258553504944, 341.75470542907715, 345.9103584289551, 350.0709478855133, 354.2896227836609, 358.50596594810486, 362.82347202301025, 367.12909722328186, 371.42663836479187, 375.7371737957001, 380.0675642490387, 384.46003341674805, 388.79801964759827, 392.8406412601471]
[22.68, 33.7, 41.3, 47.81, 53.74, 55.87, 56.39, 57.32, 58.55, 60.94, 60.79, 62.69, 64.69, 65.93, 66.53, 66.43, 66.98, 67.48, 69.34, 69.37, 69.36, 69.4, 70.09, 70.08, 70.25, 70.48, 70.93, 71.67, 71.86, 71.72, 71.76, 71.76, 72.9, 73.12, 73.28, 72.86, 73.1, 72.29, 72.85, 73.44, 74.04, 73.42, 73.31, 72.65, 73.2, 73.6, 74.01, 73.94, 74.07, 74.59, 73.94, 74.39, 74.06, 73.99, 74.83, 74.56, 73.83, 73.67, 73.89, 73.87, 74.85, 74.02, 74.06, 73.51, 73.53, 74.6, 74.34, 74.45, 74.62, 74.86, 74.81, 75.16, 74.1, 74.63, 74.27, 74.77, 74.91, 74.9, 74.74, 74.76, 74.99, 74.4, 74.62, 74.45, 75.38, 75.3, 74.7, 74.61, 74.35, 74.87, 75.06, 74.97, 75.02, 75.13, 75.05, 75.38, 75.18, 75.03, 75.21, 74.78, 75.69]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.747, Test loss: 1.711, Test accuracy: 35.78
Round   1, Train loss: 1.392, Test loss: 1.323, Test accuracy: 45.44
Round   2, Train loss: 1.235, Test loss: 1.199, Test accuracy: 51.44
Round   3, Train loss: 1.154, Test loss: 1.133, Test accuracy: 54.37
Round   4, Train loss: 1.099, Test loss: 1.079, Test accuracy: 56.21
Round   5, Train loss: 1.055, Test loss: 1.030, Test accuracy: 58.66
Round   6, Train loss: 1.014, Test loss: 1.006, Test accuracy: 60.48
Round   7, Train loss: 0.979, Test loss: 0.984, Test accuracy: 61.22
Round   8, Train loss: 0.945, Test loss: 0.950, Test accuracy: 62.16
Round   9, Train loss: 0.916, Test loss: 0.918, Test accuracy: 64.18
Round  10, Train loss: 0.886, Test loss: 0.901, Test accuracy: 65.34
Round  11, Train loss: 0.858, Test loss: 0.882, Test accuracy: 66.01
Round  12, Train loss: 0.831, Test loss: 0.868, Test accuracy: 66.67
Round  13, Train loss: 0.810, Test loss: 0.854, Test accuracy: 66.39
Round  14, Train loss: 0.780, Test loss: 0.840, Test accuracy: 67.32
Round  15, Train loss: 0.758, Test loss: 0.828, Test accuracy: 67.60
Round  16, Train loss: 0.740, Test loss: 0.824, Test accuracy: 68.12
Round  17, Train loss: 0.720, Test loss: 0.802, Test accuracy: 69.24
Round  18, Train loss: 0.699, Test loss: 0.803, Test accuracy: 69.66
Round  19, Train loss: 0.682, Test loss: 0.800, Test accuracy: 69.73
Round  20, Train loss: 0.650, Test loss: 0.804, Test accuracy: 69.46
Round  21, Train loss: 0.637, Test loss: 0.820, Test accuracy: 69.42
Round  22, Train loss: 0.630, Test loss: 0.787, Test accuracy: 70.44
Round  23, Train loss: 0.606, Test loss: 0.784, Test accuracy: 70.67
Round  24, Train loss: 0.588, Test loss: 0.799, Test accuracy: 70.24
Round  25, Train loss: 0.662, Test loss: 0.797, Test accuracy: 70.33
Round  26, Train loss: 0.564, Test loss: 0.796, Test accuracy: 70.62
Round  27, Train loss: 0.547, Test loss: 0.782, Test accuracy: 71.17
Round  28, Train loss: 0.504, Test loss: 0.783, Test accuracy: 70.98
Round  29, Train loss: 0.449, Test loss: 0.781, Test accuracy: 71.50
Round  30, Train loss: 0.513, Test loss: 0.769, Test accuracy: 71.68
Round  31, Train loss: 0.581, Test loss: 0.782, Test accuracy: 72.01
Round  32, Train loss: 0.482, Test loss: 0.770, Test accuracy: 72.13
Round  33, Train loss: 0.525, Test loss: 0.779, Test accuracy: 72.03
Round  34, Train loss: 0.617, Test loss: 0.778, Test accuracy: 72.14
Round  35, Train loss: 0.507, Test loss: 0.791, Test accuracy: 72.03
Round  36, Train loss: 0.559, Test loss: 0.805, Test accuracy: 72.01
Round  37, Train loss: 0.562, Test loss: 0.808, Test accuracy: 71.74
Round  38, Train loss: 0.396, Test loss: 0.800, Test accuracy: 71.54
Round  39, Train loss: 0.502, Test loss: 0.814, Test accuracy: 71.74
Round  40, Train loss: 0.490, Test loss: 0.798, Test accuracy: 71.85
Round  41, Train loss: 0.398, Test loss: 0.789, Test accuracy: 72.34
Round  42, Train loss: 0.458, Test loss: 0.791, Test accuracy: 71.99
Round  43, Train loss: 0.577, Test loss: 0.813, Test accuracy: 71.26
Round  44, Train loss: 0.440, Test loss: 0.802, Test accuracy: 72.13
Round  45, Train loss: 0.502, Test loss: 0.819, Test accuracy: 71.24
Round  46, Train loss: 0.346, Test loss: 0.790, Test accuracy: 72.17
Round  47, Train loss: 0.428, Test loss: 0.801, Test accuracy: 72.64
Round  48, Train loss: 0.446, Test loss: 0.776, Test accuracy: 72.85
Round  49, Train loss: 0.396, Test loss: 0.756, Test accuracy: 74.11
Round  50, Train loss: 0.396, Test loss: 0.784, Test accuracy: 73.51
Round  51, Train loss: 0.351, Test loss: 0.783, Test accuracy: 73.53
Round  52, Train loss: 0.335, Test loss: 0.778, Test accuracy: 73.39
Round  53, Train loss: 0.503, Test loss: 0.789, Test accuracy: 73.96
Round  54, Train loss: 0.382, Test loss: 0.781, Test accuracy: 73.69
Round  55, Train loss: 0.404, Test loss: 0.772, Test accuracy: 73.88
Round  56, Train loss: 0.447, Test loss: 0.787, Test accuracy: 73.88
Round  57, Train loss: 0.418, Test loss: 0.807, Test accuracy: 72.86
Round  58, Train loss: 0.378, Test loss: 0.800, Test accuracy: 73.09
Round  59, Train loss: 0.320, Test loss: 0.799, Test accuracy: 73.27
Round  60, Train loss: 0.367, Test loss: 0.793, Test accuracy: 73.63
Round  61, Train loss: 0.360, Test loss: 0.783, Test accuracy: 74.32
Round  62, Train loss: 0.356, Test loss: 0.802, Test accuracy: 73.81
Round  63, Train loss: 0.341, Test loss: 0.804, Test accuracy: 73.82
Round  64, Train loss: 0.296, Test loss: 0.806, Test accuracy: 73.88
Round  65, Train loss: 0.376, Test loss: 0.809, Test accuracy: 73.31
Round  66, Train loss: 0.282, Test loss: 0.816, Test accuracy: 73.55
Round  67, Train loss: 0.251, Test loss: 0.835, Test accuracy: 73.14
Round  68, Train loss: 0.311, Test loss: 0.840, Test accuracy: 73.56
Round  69, Train loss: 0.372, Test loss: 0.821, Test accuracy: 73.53
Round  70, Train loss: 0.264, Test loss: 0.821, Test accuracy: 73.62
Round  71, Train loss: 0.293, Test loss: 0.828, Test accuracy: 73.41
Round  72, Train loss: 0.360, Test loss: 0.824, Test accuracy: 73.59
Round  73, Train loss: 0.255, Test loss: 0.801, Test accuracy: 73.90
Round  74, Train loss: 0.301, Test loss: 0.807, Test accuracy: 74.13
Round  75, Train loss: 0.415, Test loss: 0.843, Test accuracy: 73.48
Round  76, Train loss: 0.326, Test loss: 0.836, Test accuracy: 73.43
Round  77, Train loss: 0.323, Test loss: 0.844, Test accuracy: 73.50
Round  78, Train loss: 0.302, Test loss: 0.830, Test accuracy: 73.34
Round  79, Train loss: 0.359, Test loss: 0.833, Test accuracy: 74.25
Round  80, Train loss: 0.299, Test loss: 0.803, Test accuracy: 74.53
Round  81, Train loss: 0.286, Test loss: 0.801, Test accuracy: 74.82
Round  82, Train loss: 0.277, Test loss: 0.807, Test accuracy: 74.21
Round  83, Train loss: 0.274, Test loss: 0.810, Test accuracy: 74.86
Round  84, Train loss: 0.268, Test loss: 0.824, Test accuracy: 74.47
Round  85, Train loss: 0.264, Test loss: 0.805, Test accuracy: 74.84
Round  86, Train loss: 0.263, Test loss: 0.826, Test accuracy: 74.38
Round  87, Train loss: 0.264, Test loss: 0.829, Test accuracy: 74.57
Round  88, Train loss: 0.257, Test loss: 0.832, Test accuracy: 74.20
Round  89, Train loss: 0.255, Test loss: 0.832, Test accuracy: 74.23
Round  90, Train loss: 0.248, Test loss: 0.842, Test accuracy: 74.45
Round  91, Train loss: 0.254, Test loss: 0.833, Test accuracy: 74.59
Round  92, Train loss: 0.244, Test loss: 0.838, Test accuracy: 74.51
Round  93, Train loss: 0.244, Test loss: 0.833, Test accuracy: 74.66
Round  94, Train loss: 0.240, Test loss: 0.829, Test accuracy: 75.00
Round  95, Train loss: 0.247, Test loss: 0.864, Test accuracy: 74.30
Round  96, Train loss: 0.235, Test loss: 0.849, Test accuracy: 74.61
Round  97, Train loss: 0.235, Test loss: 0.858, Test accuracy: 74.19
Round  98, Train loss: 0.233, Test loss: 0.850, Test accuracy: 74.51
Round  99, Train loss: 0.242, Test loss: 0.856, Test accuracy: 74.78
Final Round, Train loss: 0.199, Test loss: 0.841, Test accuracy: 75.23
Average accuracy final 10 rounds: 74.55999999999999
3184.9740495681763
[3.149524688720703, 5.956606149673462, 8.761919021606445, 11.560462236404419, 14.334559440612793, 17.111710786819458, 19.891866445541382, 22.66954255104065, 25.3874831199646, 28.209495782852173, 31.019583225250244, 33.80354189872742, 36.58439493179321, 39.34004306793213, 42.120420932769775, 44.90521812438965, 47.59059929847717, 50.2673921585083, 53.050703048706055, 55.728435039520264, 58.399965047836304, 61.066246509552, 63.74221181869507, 66.446697473526, 69.14093565940857, 71.8364827632904, 74.53441762924194, 77.20828866958618, 79.9188461303711, 82.62496757507324, 85.32061409950256, 88.0121443271637, 90.69896245002747, 93.17357969284058, 95.8646445274353, 98.55061316490173, 101.25498127937317, 103.94016075134277, 106.63342213630676, 109.3342297077179, 111.9685583114624, 114.6845109462738, 117.4017333984375, 120.11023211479187, 122.78759503364563, 125.47989702224731, 128.16491889953613, 130.84848737716675, 133.57750940322876, 136.2770586013794, 138.98012900352478, 141.6795196533203, 144.371098279953, 147.080659866333, 149.78624296188354, 152.487318277359, 155.1876323223114, 157.7330195903778, 160.41367721557617, 163.11638832092285, 165.83677339553833, 168.53606843948364, 171.23547959327698, 173.94357872009277, 176.6509256362915, 179.34404134750366, 182.03061079978943, 184.73481464385986, 187.39074158668518, 190.08440566062927, 192.78289413452148, 195.31846809387207, 197.55549669265747, 199.78835368156433, 202.0248577594757, 204.26255655288696, 206.49828839302063, 208.73682618141174, 210.96857690811157, 213.20523071289062, 215.4405288696289, 217.67497038841248, 219.91166615486145, 222.45610904693604, 225.00293970108032, 227.54838800430298, 230.0807707309723, 232.6145622730255, 235.14515471458435, 237.6769676208496, 240.2072331905365, 242.46564888954163, 244.7230100631714, 246.9821720123291, 249.26831936836243, 251.60962200164795, 254.0131754875183, 256.38650608062744, 258.6870322227478, 261.00597524642944, 264.8361539840698]
[35.78, 45.44, 51.44, 54.37, 56.21, 58.66, 60.48, 61.22, 62.16, 64.18, 65.34, 66.01, 66.67, 66.39, 67.32, 67.6, 68.12, 69.24, 69.66, 69.73, 69.46, 69.42, 70.44, 70.67, 70.24, 70.33, 70.62, 71.17, 70.98, 71.5, 71.68, 72.01, 72.13, 72.03, 72.14, 72.03, 72.01, 71.74, 71.54, 71.74, 71.85, 72.34, 71.99, 71.26, 72.13, 71.24, 72.17, 72.64, 72.85, 74.11, 73.51, 73.53, 73.39, 73.96, 73.69, 73.88, 73.88, 72.86, 73.09, 73.27, 73.63, 74.32, 73.81, 73.82, 73.88, 73.31, 73.55, 73.14, 73.56, 73.53, 73.62, 73.41, 73.59, 73.9, 74.13, 73.48, 73.43, 73.5, 73.34, 74.25, 74.53, 74.82, 74.21, 74.86, 74.47, 74.84, 74.38, 74.57, 74.2, 74.23, 74.45, 74.59, 74.51, 74.66, 75.0, 74.3, 74.61, 74.19, 74.51, 74.78, 75.23]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.2 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 7, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.729, Test loss: 1.670, Test accuracy: 37.06
Round   1, Train loss: 1.393, Test loss: 1.349, Test accuracy: 45.20
Round   2, Train loss: 1.253, Test loss: 1.201, Test accuracy: 51.75
Round   3, Train loss: 1.173, Test loss: 1.144, Test accuracy: 53.77
Round   4, Train loss: 1.119, Test loss: 1.085, Test accuracy: 57.44
Round   5, Train loss: 1.071, Test loss: 1.038, Test accuracy: 58.87
Round   6, Train loss: 1.035, Test loss: 1.004, Test accuracy: 60.10
Round   7, Train loss: 1.001, Test loss: 0.995, Test accuracy: 60.93
Round   8, Train loss: 0.972, Test loss: 0.982, Test accuracy: 61.96
Round   9, Train loss: 0.937, Test loss: 0.950, Test accuracy: 62.62
Round  10, Train loss: 0.912, Test loss: 0.932, Test accuracy: 63.38
Round  11, Train loss: 0.887, Test loss: 0.919, Test accuracy: 63.75
Round  12, Train loss: 0.857, Test loss: 0.909, Test accuracy: 64.30
Round  13, Train loss: 0.838, Test loss: 0.884, Test accuracy: 65.43
Round  14, Train loss: 0.812, Test loss: 0.867, Test accuracy: 66.49
Round  15, Train loss: 0.795, Test loss: 0.861, Test accuracy: 66.47
Round  16, Train loss: 0.768, Test loss: 0.848, Test accuracy: 67.48
Round  17, Train loss: 0.749, Test loss: 0.840, Test accuracy: 67.90
Round  18, Train loss: 0.731, Test loss: 0.836, Test accuracy: 68.05
Round  19, Train loss: 0.714, Test loss: 0.822, Test accuracy: 68.38
Round  20, Train loss: 0.781, Test loss: 0.830, Test accuracy: 68.01
Round  21, Train loss: 0.622, Test loss: 0.830, Test accuracy: 68.33
Round  22, Train loss: 0.785, Test loss: 0.816, Test accuracy: 69.44
Round  23, Train loss: 0.734, Test loss: 0.847, Test accuracy: 68.39
Round  24, Train loss: 0.620, Test loss: 0.841, Test accuracy: 68.90
Round  25, Train loss: 0.639, Test loss: 0.844, Test accuracy: 68.53
Round  26, Train loss: 0.620, Test loss: 0.838, Test accuracy: 68.13
Round  27, Train loss: 0.594, Test loss: 0.821, Test accuracy: 68.45
Round  28, Train loss: 0.635, Test loss: 0.831, Test accuracy: 69.35
Round  29, Train loss: 0.529, Test loss: 0.822, Test accuracy: 69.49
Round  30, Train loss: 0.580, Test loss: 0.812, Test accuracy: 70.24
Round  31, Train loss: 0.506, Test loss: 0.791, Test accuracy: 70.45
Round  32, Train loss: 0.489, Test loss: 0.788, Test accuracy: 70.56
Round  33, Train loss: 0.455, Test loss: 0.794, Test accuracy: 70.69
Round  34, Train loss: 0.616, Test loss: 0.801, Test accuracy: 70.75
Round  35, Train loss: 0.514, Test loss: 0.782, Test accuracy: 71.65
Round  36, Train loss: 0.482, Test loss: 0.803, Test accuracy: 71.17
Round  37, Train loss: 0.481, Test loss: 0.810, Test accuracy: 70.62
Round  38, Train loss: 0.487, Test loss: 0.797, Test accuracy: 71.08
Round  39, Train loss: 0.525, Test loss: 0.801, Test accuracy: 71.50
Round  40, Train loss: 0.521, Test loss: 0.792, Test accuracy: 71.53
Round  41, Train loss: 0.413, Test loss: 0.784, Test accuracy: 71.52
Round  42, Train loss: 0.487, Test loss: 0.795, Test accuracy: 71.21
Round  43, Train loss: 0.565, Test loss: 0.803, Test accuracy: 71.28
Round  44, Train loss: 0.536, Test loss: 0.809, Test accuracy: 71.14
Round  45, Train loss: 0.501, Test loss: 0.798, Test accuracy: 71.91
Round  46, Train loss: 0.415, Test loss: 0.791, Test accuracy: 72.14
Round  47, Train loss: 0.491, Test loss: 0.806, Test accuracy: 71.60
Round  48, Train loss: 0.500, Test loss: 0.798, Test accuracy: 71.76
Round  49, Train loss: 0.405, Test loss: 0.785, Test accuracy: 72.14
Round  50, Train loss: 0.410, Test loss: 0.805, Test accuracy: 71.63
Round  51, Train loss: 0.436, Test loss: 0.812, Test accuracy: 71.58
Round  52, Train loss: 0.506, Test loss: 0.821, Test accuracy: 71.32
Round  53, Train loss: 0.484, Test loss: 0.829, Test accuracy: 71.19
Round  54, Train loss: 0.361, Test loss: 0.801, Test accuracy: 71.83
Round  55, Train loss: 0.475, Test loss: 0.819, Test accuracy: 71.95
Round  56, Train loss: 0.410, Test loss: 0.808, Test accuracy: 72.13
Round  57, Train loss: 0.402, Test loss: 0.822, Test accuracy: 71.94
Round  58, Train loss: 0.334, Test loss: 0.817, Test accuracy: 72.12
Round  59, Train loss: 0.323, Test loss: 0.829, Test accuracy: 72.44
Round  60, Train loss: 0.404, Test loss: 0.810, Test accuracy: 72.94
Round  61, Train loss: 0.418, Test loss: 0.820, Test accuracy: 72.26
Round  62, Train loss: 0.363, Test loss: 0.834, Test accuracy: 72.69
Round  63, Train loss: 0.324, Test loss: 0.842, Test accuracy: 72.81
Round  64, Train loss: 0.300, Test loss: 0.846, Test accuracy: 72.21
Round  65, Train loss: 0.377, Test loss: 0.860, Test accuracy: 71.57
Round  66, Train loss: 0.287, Test loss: 0.832, Test accuracy: 72.68
Round  67, Train loss: 0.290, Test loss: 0.851, Test accuracy: 71.97
Round  68, Train loss: 0.306, Test loss: 0.868, Test accuracy: 71.90
Round  69, Train loss: 0.493, Test loss: 0.835, Test accuracy: 71.90
Round  70, Train loss: 0.260, Test loss: 0.827, Test accuracy: 72.77
Round  71, Train loss: 0.357, Test loss: 0.854, Test accuracy: 72.39
Round  72, Train loss: 0.411, Test loss: 0.880, Test accuracy: 72.00
Round  73, Train loss: 0.277, Test loss: 0.851, Test accuracy: 72.43
Round  74, Train loss: 0.363, Test loss: 0.851, Test accuracy: 72.18
Round  75, Train loss: 0.311, Test loss: 0.858, Test accuracy: 71.95
Round  76, Train loss: 0.353, Test loss: 0.877, Test accuracy: 71.24
Round  77, Train loss: 0.270, Test loss: 0.868, Test accuracy: 72.17
Round  78, Train loss: 0.340, Test loss: 0.837, Test accuracy: 72.83
Round  79, Train loss: 0.356, Test loss: 0.857, Test accuracy: 72.27
Round  80, Train loss: 0.317, Test loss: 0.855, Test accuracy: 72.37
Round  81, Train loss: 0.301, Test loss: 0.842, Test accuracy: 72.65
Round  82, Train loss: 0.296, Test loss: 0.855, Test accuracy: 72.58
Round  83, Train loss: 0.290, Test loss: 0.866, Test accuracy: 72.78
Round  84, Train loss: 0.296, Test loss: 0.859, Test accuracy: 72.78
Round  85, Train loss: 0.290, Test loss: 0.851, Test accuracy: 72.68
Round  86, Train loss: 0.282, Test loss: 0.874, Test accuracy: 72.78
Round  87, Train loss: 0.280, Test loss: 0.856, Test accuracy: 73.09
Round  88, Train loss: 0.278, Test loss: 0.854, Test accuracy: 73.19
Round  89, Train loss: 0.276, Test loss: 0.865, Test accuracy: 72.84
Round  90, Train loss: 0.272, Test loss: 0.853, Test accuracy: 73.42
Round  91, Train loss: 0.266, Test loss: 0.872, Test accuracy: 73.24
Round  92, Train loss: 0.265, Test loss: 0.883, Test accuracy: 73.03
Round  93, Train loss: 0.262, Test loss: 0.882, Test accuracy: 72.76
Round  94, Train loss: 0.265, Test loss: 0.857, Test accuracy: 73.37
Round  95, Train loss: 0.262, Test loss: 0.888, Test accuracy: 72.57
Round  96, Train loss: 0.259, Test loss: 0.879, Test accuracy: 73.23
Round  97, Train loss: 0.256, Test loss: 0.875, Test accuracy: 73.06
Round  98, Train loss: 0.258, Test loss: 0.885, Test accuracy: 73.00
Round  99, Train loss: 0.246, Test loss: 0.886, Test accuracy: 73.35
Final Round, Train loss: 0.216, Test loss: 0.881, Test accuracy: 73.61
Average accuracy final 10 rounds: 73.103
4020.6451823711395
[2.7195281982421875, 5.249173879623413, 7.785446643829346, 10.3176908493042, 12.564739465713501, 14.809417009353638, 17.05655789375305, 19.303823232650757, 21.548157691955566, 23.7929630279541, 26.02989387512207, 28.27332901954651, 30.51804494857788, 32.76782441139221, 35.013423919677734, 37.25925254821777, 39.50270915031433, 41.746450662612915, 43.99031686782837, 46.23643684387207, 48.47820830345154, 52.2241747379303, 55.959020376205444, 59.69772934913635, 63.435508728027344, 67.14226484298706, 70.88350367546082, 74.62342810630798, 78.36678862571716, 82.10763192176819, 85.83622908592224, 89.57205057144165, 93.34131121635437, 97.05293035507202, 100.78283643722534, 104.48902416229248, 108.19216203689575, 111.92355155944824, 115.63189053535461, 119.33938431739807, 123.0534565448761, 126.763986825943, 130.48157215118408, 134.19772958755493, 137.90985822677612, 141.6238236427307, 145.33498978614807, 149.04362535476685, 152.7576243877411, 156.46741914749146, 160.1759433746338, 163.8878629207611, 167.60668563842773, 171.3199212551117, 175.03557705879211, 178.8091504573822, 182.5225224494934, 186.2174882888794, 189.9213888645172, 193.62020349502563, 197.32486605644226, 201.03951168060303, 204.74866604804993, 208.46021151542664, 212.16898226737976, 215.87749195098877, 219.58738327026367, 223.28338527679443, 227.0131242275238, 230.75362586975098, 234.4917733669281, 238.23965644836426, 241.95361495018005, 245.69887137413025, 249.41706252098083, 253.1592972278595, 256.90134477615356, 260.65259623527527, 264.39763259887695, 268.105938911438, 271.8487322330475, 275.6239507198334, 279.35915064811707, 283.1009888648987, 286.8385603427887, 290.58219289779663, 294.38999462127686, 298.1345841884613, 301.8857579231262, 305.6300938129425, 309.37816095352173, 313.12240386009216, 316.8606038093567, 320.6596028804779, 324.4066400527954, 328.1499807834625, 331.8928189277649, 335.62701058387756, 339.3659338951111, 343.1049418449402, 346.80371499061584]
[37.06, 45.2, 51.75, 53.77, 57.44, 58.87, 60.1, 60.93, 61.96, 62.62, 63.38, 63.75, 64.3, 65.43, 66.49, 66.47, 67.48, 67.9, 68.05, 68.38, 68.01, 68.33, 69.44, 68.39, 68.9, 68.53, 68.13, 68.45, 69.35, 69.49, 70.24, 70.45, 70.56, 70.69, 70.75, 71.65, 71.17, 70.62, 71.08, 71.5, 71.53, 71.52, 71.21, 71.28, 71.14, 71.91, 72.14, 71.6, 71.76, 72.14, 71.63, 71.58, 71.32, 71.19, 71.83, 71.95, 72.13, 71.94, 72.12, 72.44, 72.94, 72.26, 72.69, 72.81, 72.21, 71.57, 72.68, 71.97, 71.9, 71.9, 72.77, 72.39, 72.0, 72.43, 72.18, 71.95, 71.24, 72.17, 72.83, 72.27, 72.37, 72.65, 72.58, 72.78, 72.78, 72.68, 72.78, 73.09, 73.19, 72.84, 73.42, 73.24, 73.03, 72.76, 73.37, 72.57, 73.23, 73.06, 73.0, 73.35, 73.61]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.702, Test loss: 2.087, Test accuracy: 17.92
Round   0, Global train loss: 1.702, Global test loss: 2.281, Global test accuracy: 13.99
Round   1, Train loss: 1.455, Test loss: 1.841, Test accuracy: 30.73
Round   1, Global train loss: 1.455, Global test loss: 2.202, Global test accuracy: 23.28
Round   2, Train loss: 1.382, Test loss: 1.588, Test accuracy: 35.24
Round   2, Global train loss: 1.382, Global test loss: 2.054, Global test accuracy: 21.85
Round   3, Train loss: 1.319, Test loss: 1.442, Test accuracy: 41.33
Round   3, Global train loss: 1.319, Global test loss: 1.958, Global test accuracy: 30.82
Round   4, Train loss: 1.356, Test loss: 1.356, Test accuracy: 44.62
Round   4, Global train loss: 1.356, Global test loss: 1.977, Global test accuracy: 29.58
Round   5, Train loss: 1.270, Test loss: 1.331, Test accuracy: 46.53
Round   5, Global train loss: 1.270, Global test loss: 2.050, Global test accuracy: 30.14
Round   6, Train loss: 1.377, Test loss: 1.321, Test accuracy: 47.09
Round   6, Global train loss: 1.377, Global test loss: 2.140, Global test accuracy: 22.40
Round   7, Train loss: 1.279, Test loss: 1.300, Test accuracy: 48.81
Round   7, Global train loss: 1.279, Global test loss: 2.041, Global test accuracy: 30.21
Round   8, Train loss: 1.249, Test loss: 1.283, Test accuracy: 49.16
Round   8, Global train loss: 1.249, Global test loss: 2.111, Global test accuracy: 26.41
Round   9, Train loss: 1.227, Test loss: 1.232, Test accuracy: 50.76
Round   9, Global train loss: 1.227, Global test loss: 1.969, Global test accuracy: 26.27
Round  10, Train loss: 1.291, Test loss: 1.226, Test accuracy: 51.56
Round  10, Global train loss: 1.291, Global test loss: 2.034, Global test accuracy: 24.24
Round  11, Train loss: 1.067, Test loss: 1.211, Test accuracy: 52.69
Round  11, Global train loss: 1.067, Global test loss: 2.041, Global test accuracy: 28.08
Round  12, Train loss: 1.148, Test loss: 1.156, Test accuracy: 54.47
Round  12, Global train loss: 1.148, Global test loss: 1.892, Global test accuracy: 35.13
Round  13, Train loss: 0.986, Test loss: 1.149, Test accuracy: 54.39
Round  13, Global train loss: 0.986, Global test loss: 2.090, Global test accuracy: 24.28
Round  14, Train loss: 1.142, Test loss: 1.149, Test accuracy: 54.44
Round  14, Global train loss: 1.142, Global test loss: 1.986, Global test accuracy: 29.61
Round  15, Train loss: 1.032, Test loss: 1.134, Test accuracy: 54.79
Round  15, Global train loss: 1.032, Global test loss: 2.011, Global test accuracy: 27.28
Round  16, Train loss: 0.989, Test loss: 1.139, Test accuracy: 54.99
Round  16, Global train loss: 0.989, Global test loss: 2.255, Global test accuracy: 27.58
Round  17, Train loss: 1.008, Test loss: 1.158, Test accuracy: 54.84
Round  17, Global train loss: 1.008, Global test loss: 2.191, Global test accuracy: 25.05
Round  18, Train loss: 1.104, Test loss: 1.146, Test accuracy: 55.61
Round  18, Global train loss: 1.104, Global test loss: 1.948, Global test accuracy: 30.42
Round  19, Train loss: 0.841, Test loss: 1.146, Test accuracy: 56.06
Round  19, Global train loss: 0.841, Global test loss: 2.132, Global test accuracy: 29.76
Round  20, Train loss: 1.189, Test loss: 1.154, Test accuracy: 55.59
Round  20, Global train loss: 1.189, Global test loss: 2.037, Global test accuracy: 31.30
Round  21, Train loss: 0.897, Test loss: 1.141, Test accuracy: 56.73
Round  21, Global train loss: 0.897, Global test loss: 2.132, Global test accuracy: 25.77
Round  22, Train loss: 1.125, Test loss: 1.133, Test accuracy: 56.94
Round  22, Global train loss: 1.125, Global test loss: 1.928, Global test accuracy: 31.60
Round  23, Train loss: 1.091, Test loss: 1.130, Test accuracy: 57.12
Round  23, Global train loss: 1.091, Global test loss: 2.093, Global test accuracy: 25.29
Round  24, Train loss: 0.909, Test loss: 1.156, Test accuracy: 57.03
Round  24, Global train loss: 0.909, Global test loss: 2.042, Global test accuracy: 28.72
Round  25, Train loss: 0.886, Test loss: 1.156, Test accuracy: 57.04
Round  25, Global train loss: 0.886, Global test loss: 1.938, Global test accuracy: 28.43
Round  26, Train loss: 0.905, Test loss: 1.171, Test accuracy: 56.48
Round  26, Global train loss: 0.905, Global test loss: 1.996, Global test accuracy: 29.05
Round  27, Train loss: 0.954, Test loss: 1.211, Test accuracy: 55.20
Round  27, Global train loss: 0.954, Global test loss: 2.088, Global test accuracy: 30.10
Round  28, Train loss: 0.839, Test loss: 1.192, Test accuracy: 55.71
Round  28, Global train loss: 0.839, Global test loss: 2.018, Global test accuracy: 28.99
Round  29, Train loss: 0.803, Test loss: 1.230, Test accuracy: 55.27
Round  29, Global train loss: 0.803, Global test loss: 1.955, Global test accuracy: 30.85
Round  30, Train loss: 0.884, Test loss: 1.236, Test accuracy: 55.61
Round  30, Global train loss: 0.884, Global test loss: 1.901, Global test accuracy: 33.42
Round  31, Train loss: 0.613, Test loss: 1.220, Test accuracy: 55.88
Round  31, Global train loss: 0.613, Global test loss: 2.128, Global test accuracy: 24.11
Round  32, Train loss: 0.674, Test loss: 1.237, Test accuracy: 55.50
Round  32, Global train loss: 0.674, Global test loss: 2.018, Global test accuracy: 32.54
Round  33, Train loss: 0.915, Test loss: 1.265, Test accuracy: 55.54
Round  33, Global train loss: 0.915, Global test loss: 2.221, Global test accuracy: 22.13
Round  34, Train loss: 0.602, Test loss: 1.282, Test accuracy: 55.41
Round  34, Global train loss: 0.602, Global test loss: 1.955, Global test accuracy: 34.99
Round  35, Train loss: 0.864, Test loss: 1.300, Test accuracy: 55.58
Round  35, Global train loss: 0.864, Global test loss: 2.031, Global test accuracy: 25.67
Round  36, Train loss: 0.591, Test loss: 1.315, Test accuracy: 55.11
Round  36, Global train loss: 0.591, Global test loss: 1.970, Global test accuracy: 29.98
Round  37, Train loss: 0.624, Test loss: 1.320, Test accuracy: 54.77
Round  37, Global train loss: 0.624, Global test loss: 1.878, Global test accuracy: 33.78
Round  38, Train loss: 0.591, Test loss: 1.356, Test accuracy: 54.78
Round  38, Global train loss: 0.591, Global test loss: 2.255, Global test accuracy: 28.51
Round  39, Train loss: 0.572, Test loss: 1.359, Test accuracy: 55.19
Round  39, Global train loss: 0.572, Global test loss: 1.971, Global test accuracy: 32.04
Round  40, Train loss: 0.629, Test loss: 1.357, Test accuracy: 55.71
Round  40, Global train loss: 0.629, Global test loss: 2.033, Global test accuracy: 26.49
Round  41, Train loss: 0.572, Test loss: 1.373, Test accuracy: 55.40
Round  41, Global train loss: 0.572, Global test loss: 1.961, Global test accuracy: 29.21
Round  42, Train loss: 0.511, Test loss: 1.379, Test accuracy: 55.72
Round  42, Global train loss: 0.511, Global test loss: 1.924, Global test accuracy: 29.78
Round  43, Train loss: 0.526, Test loss: 1.406, Test accuracy: 55.76
Round  43, Global train loss: 0.526, Global test loss: 2.008, Global test accuracy: 24.33
Round  44, Train loss: 0.634, Test loss: 1.420, Test accuracy: 55.66
Round  44, Global train loss: 0.634, Global test loss: 1.983, Global test accuracy: 31.88
Round  45, Train loss: 0.527, Test loss: 1.424, Test accuracy: 56.16
Round  45, Global train loss: 0.527, Global test loss: 2.038, Global test accuracy: 29.88
Round  46, Train loss: 0.662, Test loss: 1.436, Test accuracy: 55.95
Round  46, Global train loss: 0.662, Global test loss: 1.929, Global test accuracy: 29.06
Round  47, Train loss: 0.515, Test loss: 1.456, Test accuracy: 55.79
Round  47, Global train loss: 0.515, Global test loss: 2.147, Global test accuracy: 22.17
Round  48, Train loss: 0.608, Test loss: 1.486, Test accuracy: 56.48
Round  48, Global train loss: 0.608, Global test loss: 2.056, Global test accuracy: 26.05
Round  49, Train loss: 0.662, Test loss: 1.493, Test accuracy: 56.19
Round  49, Global train loss: 0.662, Global test loss: 2.094, Global test accuracy: 32.66
Round  50, Train loss: 0.475, Test loss: 1.518, Test accuracy: 55.93
Round  50, Global train loss: 0.475, Global test loss: 1.905, Global test accuracy: 31.23
Round  51, Train loss: 0.306, Test loss: 1.551, Test accuracy: 55.74
Round  51, Global train loss: 0.306, Global test loss: 1.900, Global test accuracy: 32.30
Round  52, Train loss: 0.605, Test loss: 1.607, Test accuracy: 54.87
Round  52, Global train loss: 0.605, Global test loss: 2.007, Global test accuracy: 28.94
Round  53, Train loss: 0.407, Test loss: 1.617, Test accuracy: 54.63
Round  53, Global train loss: 0.407, Global test loss: 2.040, Global test accuracy: 24.77
Round  54, Train loss: 0.466, Test loss: 1.638, Test accuracy: 54.44
Round  54, Global train loss: 0.466, Global test loss: 2.077, Global test accuracy: 26.07
Round  55, Train loss: 0.460, Test loss: 1.684, Test accuracy: 54.05
Round  55, Global train loss: 0.460, Global test loss: 1.982, Global test accuracy: 33.29
Round  56, Train loss: 0.342, Test loss: 1.677, Test accuracy: 54.27
Round  56, Global train loss: 0.342, Global test loss: 1.937, Global test accuracy: 31.34
Round  57, Train loss: 0.428, Test loss: 1.705, Test accuracy: 54.97
Round  57, Global train loss: 0.428, Global test loss: 1.994, Global test accuracy: 26.66
Round  58, Train loss: 0.378, Test loss: 1.776, Test accuracy: 53.70
Round  58, Global train loss: 0.378, Global test loss: 1.987, Global test accuracy: 30.96
Round  59, Train loss: 0.449, Test loss: 1.817, Test accuracy: 53.65
Round  59, Global train loss: 0.449, Global test loss: 2.143, Global test accuracy: 27.22
Round  60, Train loss: 0.367, Test loss: 1.817, Test accuracy: 53.58
Round  60, Global train loss: 0.367, Global test loss: 1.858, Global test accuracy: 33.10
Round  61, Train loss: 0.456, Test loss: 1.798, Test accuracy: 54.41
Round  61, Global train loss: 0.456, Global test loss: 1.964, Global test accuracy: 29.29
Round  62, Train loss: 0.480, Test loss: 1.820, Test accuracy: 54.17
Round  62, Global train loss: 0.480, Global test loss: 1.993, Global test accuracy: 30.36
Round  63, Train loss: 0.343, Test loss: 1.819, Test accuracy: 54.69
Round  63, Global train loss: 0.343, Global test loss: 2.064, Global test accuracy: 24.89
Round  64, Train loss: 0.314, Test loss: 1.866, Test accuracy: 53.97
Round  64, Global train loss: 0.314, Global test loss: 2.113, Global test accuracy: 28.35
Round  65, Train loss: 0.342, Test loss: 1.841, Test accuracy: 54.90
Round  65, Global train loss: 0.342, Global test loss: 1.960, Global test accuracy: 29.87
Round  66, Train loss: 0.356, Test loss: 1.880, Test accuracy: 54.57
Round  66, Global train loss: 0.356, Global test loss: 2.019, Global test accuracy: 28.89
Round  67, Train loss: 0.213, Test loss: 1.925, Test accuracy: 54.94
Round  67, Global train loss: 0.213, Global test loss: 1.951, Global test accuracy: 34.57
Round  68, Train loss: 0.299, Test loss: 1.932, Test accuracy: 55.02
Round  68, Global train loss: 0.299, Global test loss: 1.920, Global test accuracy: 31.12
Round  69, Train loss: 0.395, Test loss: 1.988, Test accuracy: 54.20
Round  69, Global train loss: 0.395, Global test loss: 1.995, Global test accuracy: 28.47
Round  70, Train loss: 0.278, Test loss: 2.034, Test accuracy: 54.22
Round  70, Global train loss: 0.278, Global test loss: 2.080, Global test accuracy: 28.04
Round  71, Train loss: 0.244, Test loss: 2.058, Test accuracy: 54.50
Round  71, Global train loss: 0.244, Global test loss: 2.044, Global test accuracy: 25.40
Round  72, Train loss: 0.310, Test loss: 2.074, Test accuracy: 54.30
Round  72, Global train loss: 0.310, Global test loss: 2.076, Global test accuracy: 24.00
Round  73, Train loss: 0.270, Test loss: 2.064, Test accuracy: 55.14
Round  73, Global train loss: 0.270, Global test loss: 2.024, Global test accuracy: 28.31
Round  74, Train loss: 0.347, Test loss: 2.074, Test accuracy: 54.66
Round  74, Global train loss: 0.347, Global test loss: 1.979, Global test accuracy: 29.67
Round  75, Train loss: 0.221, Test loss: 2.108, Test accuracy: 54.16
Round  75, Global train loss: 0.221, Global test loss: 2.089, Global test accuracy: 26.49
Round  76, Train loss: 0.287, Test loss: 2.136, Test accuracy: 54.59
Round  76, Global train loss: 0.287, Global test loss: 1.971, Global test accuracy: 28.79
Round  77, Train loss: 0.194, Test loss: 2.148, Test accuracy: 54.91
Round  77, Global train loss: 0.194, Global test loss: 2.257, Global test accuracy: 32.88
Round  78, Train loss: 0.231, Test loss: 2.130, Test accuracy: 54.61
Round  78, Global train loss: 0.231, Global test loss: 1.984, Global test accuracy: 26.78
Round  79, Train loss: 0.247, Test loss: 2.103, Test accuracy: 55.04
Round  79, Global train loss: 0.247, Global test loss: 1.827, Global test accuracy: 34.82
Round  80, Train loss: 0.235, Test loss: 2.109, Test accuracy: 55.05
Round  80, Global train loss: 0.235, Global test loss: 1.883, Global test accuracy: 31.73
Round  81, Train loss: 0.224, Test loss: 2.161, Test accuracy: 54.76
Round  81, Global train loss: 0.224, Global test loss: 1.912, Global test accuracy: 31.91
Round  82, Train loss: 0.206, Test loss: 2.172, Test accuracy: 54.95
Round  82, Global train loss: 0.206, Global test loss: 1.966, Global test accuracy: 27.91
Round  83, Train loss: 0.178, Test loss: 2.219, Test accuracy: 55.24
Round  83, Global train loss: 0.178, Global test loss: 2.045, Global test accuracy: 30.13
Round  84, Train loss: 0.201, Test loss: 2.273, Test accuracy: 55.40
Round  84, Global train loss: 0.201, Global test loss: 1.865, Global test accuracy: 32.61
Round  85, Train loss: 0.224, Test loss: 2.325, Test accuracy: 54.86
Round  85, Global train loss: 0.224, Global test loss: 2.238, Global test accuracy: 20.33
Round  86, Train loss: 0.167, Test loss: 2.314, Test accuracy: 54.78
Round  86, Global train loss: 0.167, Global test loss: 2.115, Global test accuracy: 28.70
Round  87, Train loss: 0.182, Test loss: 2.353, Test accuracy: 54.30
Round  87, Global train loss: 0.182, Global test loss: 1.831, Global test accuracy: 35.36
Round  88, Train loss: 0.197, Test loss: 2.337, Test accuracy: 54.48
Round  88, Global train loss: 0.197, Global test loss: 2.038, Global test accuracy: 29.02
Round  89, Train loss: 0.116, Test loss: 2.356, Test accuracy: 54.47
Round  89, Global train loss: 0.116, Global test loss: 1.853, Global test accuracy: 32.01
Round  90, Train loss: 0.184, Test loss: 2.402, Test accuracy: 54.85
Round  90, Global train loss: 0.184, Global test loss: 2.105, Global test accuracy: 23.78
Round  91, Train loss: 0.160, Test loss: 2.410, Test accuracy: 54.92
Round  91, Global train loss: 0.160, Global test loss: 2.128, Global test accuracy: 26.34
Round  92, Train loss: 0.157, Test loss: 2.421, Test accuracy: 54.29
Round  92, Global train loss: 0.157, Global test loss: 2.064, Global test accuracy: 27.24
Round  93, Train loss: 0.164, Test loss: 2.445, Test accuracy: 54.77
Round  93, Global train loss: 0.164, Global test loss: 2.111, Global test accuracy: 22.76
Round  94, Train loss: 0.162, Test loss: 2.471, Test accuracy: 54.43
Round  94, Global train loss: 0.162, Global test loss: 2.120, Global test accuracy: 26.06
Round  95, Train loss: 0.137, Test loss: 2.483, Test accuracy: 54.67
Round  95, Global train loss: 0.137, Global test loss: 2.186, Global test accuracy: 24.48
Round  96, Train loss: 0.172, Test loss: 2.468, Test accuracy: 54.95
Round  96, Global train loss: 0.172, Global test loss: 2.056, Global test accuracy: 25.57
Round  97, Train loss: 0.183, Test loss: 2.440, Test accuracy: 55.24
Round  97, Global train loss: 0.183, Global test loss: 2.100, Global test accuracy: 22.77
Round  98, Train loss: 0.143, Test loss: 2.507, Test accuracy: 55.12
Round  98, Global train loss: 0.143, Global test loss: 1.902, Global test accuracy: 32.06
Round  99, Train loss: 0.140, Test loss: 2.541, Test accuracy: 54.71
Round  99, Global train loss: 0.140, Global test loss: 1.991, Global test accuracy: 28.77
Final Round, Train loss: 0.147, Test loss: 2.574, Test accuracy: 54.72
Final Round, Global train loss: 0.147, Global test loss: 1.991, Global test accuracy: 28.77
Average accuracy final 10 rounds: 54.795 

Average global accuracy final 10 rounds: 25.983 

1406.8274126052856
[1.4559905529022217, 2.9119811058044434, 4.122071981430054, 5.332162857055664, 6.545499801635742, 7.75883674621582, 8.961976528167725, 10.165116310119629, 11.36689043045044, 12.56866455078125, 13.77785325050354, 14.98704195022583, 16.202566146850586, 17.418090343475342, 18.638654708862305, 19.859219074249268, 21.074421644210815, 22.289624214172363, 23.517541646957397, 24.74545907974243, 25.96407437324524, 27.182689666748047, 28.396167993545532, 29.609646320343018, 30.822149991989136, 32.034653663635254, 33.2501015663147, 34.46554946899414, 35.67674422264099, 36.88793897628784, 38.09028196334839, 39.292624950408936, 40.50704336166382, 41.7214617729187, 42.93526077270508, 44.149059772491455, 45.36225652694702, 46.57545328140259, 47.79271841049194, 49.0099835395813, 50.22046899795532, 51.430954456329346, 52.64043307304382, 53.8499116897583, 55.06558799743652, 56.281264305114746, 57.49918508529663, 58.717105865478516, 59.94297409057617, 61.16884231567383, 62.381173610687256, 63.593504905700684, 64.81037950515747, 66.02725410461426, 67.24934911727905, 68.47144412994385, 69.68998146057129, 70.90851879119873, 72.12232708930969, 73.33613538742065, 74.55342125892639, 75.77070713043213, 76.98755526542664, 78.20440340042114, 79.41082644462585, 80.61724948883057, 81.83126664161682, 83.04528379440308, 84.2577211856842, 85.47015857696533, 86.67954015731812, 87.8889217376709, 89.10505056381226, 90.32117938995361, 91.52343916893005, 92.7256989479065, 93.93271851539612, 95.13973808288574, 96.34514212608337, 97.550546169281, 98.75953340530396, 99.9685206413269, 101.17661046981812, 102.38470029830933, 103.6042230129242, 104.82374572753906, 106.03093767166138, 107.23812961578369, 108.45412635803223, 109.67012310028076, 110.88840007781982, 112.10667705535889, 113.32057571411133, 114.53447437286377, 115.75316834449768, 116.97186231613159, 118.18557667732239, 119.39929103851318, 120.6175549030304, 121.83581876754761, 123.05380034446716, 124.27178192138672, 125.47486162185669, 126.67794132232666, 127.89017987251282, 129.10241842269897, 130.3084011077881, 131.5143837928772, 132.71535086631775, 133.9163179397583, 135.12487506866455, 136.3334321975708, 137.54261589050293, 138.75179958343506, 139.96270418167114, 141.17360877990723, 142.38104057312012, 143.588472366333, 144.80861854553223, 146.02876472473145, 147.23995923995972, 148.451153755188, 149.65840888023376, 150.86566400527954, 152.08170652389526, 153.297749042511, 154.5255205631256, 155.75329208374023, 156.96266746520996, 158.1720428466797, 159.3838129043579, 160.59558296203613, 161.80599570274353, 163.01640844345093, 164.21721124649048, 165.41801404953003, 166.6203577518463, 167.8227014541626, 169.04018831253052, 170.25767517089844, 171.46907591819763, 172.68047666549683, 173.90033626556396, 175.1201958656311, 176.33817434310913, 177.55615282058716, 178.7759656906128, 179.99577856063843, 181.19979166984558, 182.40380477905273, 183.6132526397705, 184.82270050048828, 186.03819847106934, 187.2536964416504, 188.47455763816833, 189.69541883468628, 190.9079234600067, 192.12042808532715, 193.3359808921814, 194.55153369903564, 195.77213740348816, 196.99274110794067, 198.2037718296051, 199.41480255126953, 200.62948179244995, 201.84416103363037, 203.06108212471008, 204.2780032157898, 205.48986649513245, 206.7017297744751, 207.93766808509827, 209.17360639572144, 210.40116596221924, 211.62872552871704, 212.849595785141, 214.07046604156494, 215.26325392723083, 216.45604181289673, 217.67885780334473, 218.90167379379272, 220.13136434555054, 221.36105489730835, 222.5919988155365, 223.82294273376465, 225.04308938980103, 226.2632360458374, 227.46477246284485, 228.6663088798523, 229.8891463279724, 231.11198377609253, 232.33040595054626, 233.548828125, 234.77020621299744, 235.99158430099487, 237.21280360221863, 238.43402290344238, 239.64943170547485, 240.86484050750732, 242.06819486618042, 243.27154922485352, 245.73656702041626, 248.201584815979]
[17.92, 17.92, 30.73, 30.73, 35.24, 35.24, 41.33, 41.33, 44.62, 44.62, 46.53, 46.53, 47.09, 47.09, 48.81, 48.81, 49.16, 49.16, 50.76, 50.76, 51.56, 51.56, 52.69, 52.69, 54.47, 54.47, 54.39, 54.39, 54.44, 54.44, 54.79, 54.79, 54.99, 54.99, 54.84, 54.84, 55.61, 55.61, 56.06, 56.06, 55.59, 55.59, 56.73, 56.73, 56.94, 56.94, 57.12, 57.12, 57.03, 57.03, 57.04, 57.04, 56.48, 56.48, 55.2, 55.2, 55.71, 55.71, 55.27, 55.27, 55.61, 55.61, 55.88, 55.88, 55.5, 55.5, 55.54, 55.54, 55.41, 55.41, 55.58, 55.58, 55.11, 55.11, 54.77, 54.77, 54.78, 54.78, 55.19, 55.19, 55.71, 55.71, 55.4, 55.4, 55.72, 55.72, 55.76, 55.76, 55.66, 55.66, 56.16, 56.16, 55.95, 55.95, 55.79, 55.79, 56.48, 56.48, 56.19, 56.19, 55.93, 55.93, 55.74, 55.74, 54.87, 54.87, 54.63, 54.63, 54.44, 54.44, 54.05, 54.05, 54.27, 54.27, 54.97, 54.97, 53.7, 53.7, 53.65, 53.65, 53.58, 53.58, 54.41, 54.41, 54.17, 54.17, 54.69, 54.69, 53.97, 53.97, 54.9, 54.9, 54.57, 54.57, 54.94, 54.94, 55.02, 55.02, 54.2, 54.2, 54.22, 54.22, 54.5, 54.5, 54.3, 54.3, 55.14, 55.14, 54.66, 54.66, 54.16, 54.16, 54.59, 54.59, 54.91, 54.91, 54.61, 54.61, 55.04, 55.04, 55.05, 55.05, 54.76, 54.76, 54.95, 54.95, 55.24, 55.24, 55.4, 55.4, 54.86, 54.86, 54.78, 54.78, 54.3, 54.3, 54.48, 54.48, 54.47, 54.47, 54.85, 54.85, 54.92, 54.92, 54.29, 54.29, 54.77, 54.77, 54.43, 54.43, 54.67, 54.67, 54.95, 54.95, 55.24, 55.24, 55.12, 55.12, 54.71, 54.71, 54.72, 54.72]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.651, Test loss: 2.122, Test accuracy: 18.22
Round   0, Global train loss: 1.651, Global test loss: 2.332, Global test accuracy: 13.00
Round   1, Train loss: 1.483, Test loss: 1.709, Test accuracy: 31.69
Round   1, Global train loss: 1.483, Global test loss: 2.038, Global test accuracy: 22.72
Round   2, Train loss: 1.351, Test loss: 1.505, Test accuracy: 39.21
Round   2, Global train loss: 1.351, Global test loss: 1.938, Global test accuracy: 28.54
Round   3, Train loss: 1.222, Test loss: 1.354, Test accuracy: 44.40
Round   3, Global train loss: 1.222, Global test loss: 1.777, Global test accuracy: 34.30
Round   4, Train loss: 1.147, Test loss: 1.246, Test accuracy: 49.13
Round   4, Global train loss: 1.147, Global test loss: 1.715, Global test accuracy: 34.89
Round   5, Train loss: 1.137, Test loss: 1.198, Test accuracy: 51.76
Round   5, Global train loss: 1.137, Global test loss: 1.676, Global test accuracy: 40.67
Round   6, Train loss: 1.082, Test loss: 1.170, Test accuracy: 53.07
Round   6, Global train loss: 1.082, Global test loss: 1.596, Global test accuracy: 40.16
Round   7, Train loss: 1.162, Test loss: 1.162, Test accuracy: 54.89
Round   7, Global train loss: 1.162, Global test loss: 1.709, Global test accuracy: 39.94
Round   8, Train loss: 1.050, Test loss: 1.143, Test accuracy: 54.49
Round   8, Global train loss: 1.050, Global test loss: 1.765, Global test accuracy: 36.14
Round   9, Train loss: 1.051, Test loss: 1.072, Test accuracy: 56.82
Round   9, Global train loss: 1.051, Global test loss: 1.507, Global test accuracy: 43.44
Round  10, Train loss: 1.118, Test loss: 1.095, Test accuracy: 56.42
Round  10, Global train loss: 1.118, Global test loss: 1.563, Global test accuracy: 45.27
Round  11, Train loss: 0.936, Test loss: 1.056, Test accuracy: 57.41
Round  11, Global train loss: 0.936, Global test loss: 1.502, Global test accuracy: 45.68
Round  12, Train loss: 1.040, Test loss: 1.000, Test accuracy: 59.88
Round  12, Global train loss: 1.040, Global test loss: 1.462, Global test accuracy: 46.90
Round  13, Train loss: 0.938, Test loss: 0.990, Test accuracy: 60.80
Round  13, Global train loss: 0.938, Global test loss: 1.636, Global test accuracy: 42.62
Round  14, Train loss: 0.916, Test loss: 0.983, Test accuracy: 61.08
Round  14, Global train loss: 0.916, Global test loss: 1.490, Global test accuracy: 47.67
Round  15, Train loss: 0.884, Test loss: 0.957, Test accuracy: 62.23
Round  15, Global train loss: 0.884, Global test loss: 1.381, Global test accuracy: 49.74
Round  16, Train loss: 0.849, Test loss: 0.953, Test accuracy: 62.64
Round  16, Global train loss: 0.849, Global test loss: 1.695, Global test accuracy: 45.63
Round  17, Train loss: 0.937, Test loss: 0.949, Test accuracy: 62.85
Round  17, Global train loss: 0.937, Global test loss: 1.428, Global test accuracy: 47.82
Round  18, Train loss: 0.915, Test loss: 0.931, Test accuracy: 63.87
Round  18, Global train loss: 0.915, Global test loss: 1.383, Global test accuracy: 50.34
Round  19, Train loss: 0.780, Test loss: 0.920, Test accuracy: 64.61
Round  19, Global train loss: 0.780, Global test loss: 1.506, Global test accuracy: 48.31
Round  20, Train loss: 0.884, Test loss: 0.913, Test accuracy: 65.16
Round  20, Global train loss: 0.884, Global test loss: 1.346, Global test accuracy: 50.97
Round  21, Train loss: 0.805, Test loss: 0.920, Test accuracy: 65.48
Round  21, Global train loss: 0.805, Global test loss: 1.377, Global test accuracy: 51.96
Round  22, Train loss: 0.863, Test loss: 0.913, Test accuracy: 65.90
Round  22, Global train loss: 0.863, Global test loss: 1.267, Global test accuracy: 55.92
Round  23, Train loss: 0.850, Test loss: 0.902, Test accuracy: 66.46
Round  23, Global train loss: 0.850, Global test loss: 1.314, Global test accuracy: 53.36
Round  24, Train loss: 0.767, Test loss: 0.923, Test accuracy: 65.84
Round  24, Global train loss: 0.767, Global test loss: 1.267, Global test accuracy: 55.22
Round  25, Train loss: 0.821, Test loss: 0.904, Test accuracy: 66.41
Round  25, Global train loss: 0.821, Global test loss: 1.231, Global test accuracy: 56.27
Round  26, Train loss: 0.739, Test loss: 0.880, Test accuracy: 67.01
Round  26, Global train loss: 0.739, Global test loss: 1.258, Global test accuracy: 56.16
Round  27, Train loss: 0.747, Test loss: 0.873, Test accuracy: 67.49
Round  27, Global train loss: 0.747, Global test loss: 1.439, Global test accuracy: 51.89
Round  28, Train loss: 0.712, Test loss: 0.868, Test accuracy: 67.68
Round  28, Global train loss: 0.712, Global test loss: 1.484, Global test accuracy: 51.17
Round  29, Train loss: 0.670, Test loss: 0.878, Test accuracy: 67.47
Round  29, Global train loss: 0.670, Global test loss: 1.241, Global test accuracy: 56.86
Round  30, Train loss: 0.653, Test loss: 0.880, Test accuracy: 67.68
Round  30, Global train loss: 0.653, Global test loss: 1.264, Global test accuracy: 56.89
Round  31, Train loss: 0.677, Test loss: 0.859, Test accuracy: 68.29
Round  31, Global train loss: 0.677, Global test loss: 1.230, Global test accuracy: 57.16
Round  32, Train loss: 0.624, Test loss: 0.857, Test accuracy: 68.66
Round  32, Global train loss: 0.624, Global test loss: 1.297, Global test accuracy: 56.00
Round  33, Train loss: 0.753, Test loss: 0.856, Test accuracy: 68.97
Round  33, Global train loss: 0.753, Global test loss: 1.382, Global test accuracy: 53.21
Round  34, Train loss: 0.648, Test loss: 0.846, Test accuracy: 69.55
Round  34, Global train loss: 0.648, Global test loss: 1.405, Global test accuracy: 56.28
Round  35, Train loss: 0.713, Test loss: 0.845, Test accuracy: 69.42
Round  35, Global train loss: 0.713, Global test loss: 1.276, Global test accuracy: 57.42
Round  36, Train loss: 0.597, Test loss: 0.851, Test accuracy: 69.54
Round  36, Global train loss: 0.597, Global test loss: 1.229, Global test accuracy: 58.50
Round  37, Train loss: 0.628, Test loss: 0.845, Test accuracy: 69.38
Round  37, Global train loss: 0.628, Global test loss: 1.188, Global test accuracy: 58.94
Round  38, Train loss: 0.612, Test loss: 0.852, Test accuracy: 69.12
Round  38, Global train loss: 0.612, Global test loss: 1.387, Global test accuracy: 54.79
Round  39, Train loss: 0.655, Test loss: 0.861, Test accuracy: 69.11
Round  39, Global train loss: 0.655, Global test loss: 1.177, Global test accuracy: 59.41
Round  40, Train loss: 0.624, Test loss: 0.862, Test accuracy: 69.45
Round  40, Global train loss: 0.624, Global test loss: 1.286, Global test accuracy: 56.01
Round  41, Train loss: 0.633, Test loss: 0.867, Test accuracy: 69.59
Round  41, Global train loss: 0.633, Global test loss: 1.172, Global test accuracy: 59.58
Round  42, Train loss: 0.574, Test loss: 0.855, Test accuracy: 70.39
Round  42, Global train loss: 0.574, Global test loss: 1.172, Global test accuracy: 60.02
Round  43, Train loss: 0.681, Test loss: 0.846, Test accuracy: 70.98
Round  43, Global train loss: 0.681, Global test loss: 1.299, Global test accuracy: 55.73
Round  44, Train loss: 0.583, Test loss: 0.848, Test accuracy: 70.97
Round  44, Global train loss: 0.583, Global test loss: 1.243, Global test accuracy: 57.82
Round  45, Train loss: 0.579, Test loss: 0.864, Test accuracy: 70.81
Round  45, Global train loss: 0.579, Global test loss: 1.552, Global test accuracy: 54.86
Round  46, Train loss: 0.579, Test loss: 0.845, Test accuracy: 71.28
Round  46, Global train loss: 0.579, Global test loss: 1.133, Global test accuracy: 62.04
Round  47, Train loss: 0.613, Test loss: 0.850, Test accuracy: 71.26
Round  47, Global train loss: 0.613, Global test loss: 1.289, Global test accuracy: 58.38
Round  48, Train loss: 0.585, Test loss: 0.865, Test accuracy: 70.97
Round  48, Global train loss: 0.585, Global test loss: 1.234, Global test accuracy: 59.04
Round  49, Train loss: 0.549, Test loss: 0.871, Test accuracy: 70.77
Round  49, Global train loss: 0.549, Global test loss: 1.350, Global test accuracy: 55.51
Round  50, Train loss: 0.557, Test loss: 0.852, Test accuracy: 71.42
Round  50, Global train loss: 0.557, Global test loss: 1.281, Global test accuracy: 58.71
Round  51, Train loss: 0.507, Test loss: 0.821, Test accuracy: 71.91
Round  51, Global train loss: 0.507, Global test loss: 1.094, Global test accuracy: 63.85
Round  52, Train loss: 0.572, Test loss: 0.836, Test accuracy: 71.53
Round  52, Global train loss: 0.572, Global test loss: 1.145, Global test accuracy: 60.72
Round  53, Train loss: 0.547, Test loss: 0.846, Test accuracy: 71.20
Round  53, Global train loss: 0.547, Global test loss: 1.171, Global test accuracy: 61.00
Round  54, Train loss: 0.469, Test loss: 0.868, Test accuracy: 70.91
Round  54, Global train loss: 0.469, Global test loss: 1.136, Global test accuracy: 62.15
Round  55, Train loss: 0.566, Test loss: 0.855, Test accuracy: 71.33
Round  55, Global train loss: 0.566, Global test loss: 1.126, Global test accuracy: 62.57
Round  56, Train loss: 0.467, Test loss: 0.843, Test accuracy: 71.83
Round  56, Global train loss: 0.467, Global test loss: 1.248, Global test accuracy: 61.08
Round  57, Train loss: 0.504, Test loss: 0.836, Test accuracy: 72.33
Round  57, Global train loss: 0.504, Global test loss: 1.160, Global test accuracy: 62.04
Round  58, Train loss: 0.464, Test loss: 0.865, Test accuracy: 72.02
Round  58, Global train loss: 0.464, Global test loss: 1.209, Global test accuracy: 62.23
Round  59, Train loss: 0.467, Test loss: 0.870, Test accuracy: 71.89
Round  59, Global train loss: 0.467, Global test loss: 1.337, Global test accuracy: 58.65
Round  60, Train loss: 0.482, Test loss: 0.880, Test accuracy: 71.89
Round  60, Global train loss: 0.482, Global test loss: 1.248, Global test accuracy: 61.84
Round  61, Train loss: 0.460, Test loss: 0.873, Test accuracy: 72.24
Round  61, Global train loss: 0.460, Global test loss: 1.376, Global test accuracy: 58.34
Round  62, Train loss: 0.506, Test loss: 0.871, Test accuracy: 72.11
Round  62, Global train loss: 0.506, Global test loss: 1.136, Global test accuracy: 62.74
Round  63, Train loss: 0.456, Test loss: 0.870, Test accuracy: 71.81
Round  63, Global train loss: 0.456, Global test loss: 1.293, Global test accuracy: 59.82
Round  64, Train loss: 0.461, Test loss: 0.871, Test accuracy: 71.84
Round  64, Global train loss: 0.461, Global test loss: 1.252, Global test accuracy: 60.52
Round  65, Train loss: 0.417, Test loss: 0.886, Test accuracy: 72.18
Round  65, Global train loss: 0.417, Global test loss: 1.226, Global test accuracy: 62.36
Round  66, Train loss: 0.391, Test loss: 0.869, Test accuracy: 72.47
Round  66, Global train loss: 0.391, Global test loss: 1.105, Global test accuracy: 65.19
Round  67, Train loss: 0.354, Test loss: 0.882, Test accuracy: 72.47
Round  67, Global train loss: 0.354, Global test loss: 1.288, Global test accuracy: 61.65
Round  68, Train loss: 0.347, Test loss: 0.890, Test accuracy: 72.22
Round  68, Global train loss: 0.347, Global test loss: 1.316, Global test accuracy: 60.40
Round  69, Train loss: 0.526, Test loss: 0.880, Test accuracy: 72.78
Round  69, Global train loss: 0.526, Global test loss: 1.196, Global test accuracy: 62.13
Round  70, Train loss: 0.387, Test loss: 0.882, Test accuracy: 72.87
Round  70, Global train loss: 0.387, Global test loss: 1.295, Global test accuracy: 60.59
Round  71, Train loss: 0.441, Test loss: 0.897, Test accuracy: 72.61
Round  71, Global train loss: 0.441, Global test loss: 1.175, Global test accuracy: 62.27
Round  72, Train loss: 0.457, Test loss: 0.885, Test accuracy: 72.83
Round  72, Global train loss: 0.457, Global test loss: 1.178, Global test accuracy: 62.93
Round  73, Train loss: 0.351, Test loss: 0.894, Test accuracy: 72.60
Round  73, Global train loss: 0.351, Global test loss: 1.239, Global test accuracy: 62.18
Round  74, Train loss: 0.455, Test loss: 0.884, Test accuracy: 72.80
Round  74, Global train loss: 0.455, Global test loss: 1.267, Global test accuracy: 61.24
Round  75, Train loss: 0.438, Test loss: 0.876, Test accuracy: 72.84
Round  75, Global train loss: 0.438, Global test loss: 1.343, Global test accuracy: 60.18
Round  76, Train loss: 0.467, Test loss: 0.892, Test accuracy: 72.60
Round  76, Global train loss: 0.467, Global test loss: 1.162, Global test accuracy: 64.25
Round  77, Train loss: 0.378, Test loss: 0.891, Test accuracy: 72.68
Round  77, Global train loss: 0.378, Global test loss: 1.334, Global test accuracy: 59.94
Round  78, Train loss: 0.443, Test loss: 0.909, Test accuracy: 72.28
Round  78, Global train loss: 0.443, Global test loss: 1.237, Global test accuracy: 62.61
Round  79, Train loss: 0.434, Test loss: 0.910, Test accuracy: 72.74
Round  79, Global train loss: 0.434, Global test loss: 1.116, Global test accuracy: 65.25
Round  80, Train loss: 0.408, Test loss: 0.918, Test accuracy: 72.62
Round  80, Global train loss: 0.408, Global test loss: 1.154, Global test accuracy: 64.11
Round  81, Train loss: 0.379, Test loss: 0.914, Test accuracy: 72.64
Round  81, Global train loss: 0.379, Global test loss: 1.244, Global test accuracy: 63.78
Round  82, Train loss: 0.381, Test loss: 0.911, Test accuracy: 73.12
Round  82, Global train loss: 0.381, Global test loss: 1.312, Global test accuracy: 62.74
Round  83, Train loss: 0.334, Test loss: 0.916, Test accuracy: 73.01
Round  83, Global train loss: 0.334, Global test loss: 1.314, Global test accuracy: 61.96
Round  84, Train loss: 0.379, Test loss: 0.916, Test accuracy: 72.74
Round  84, Global train loss: 0.379, Global test loss: 1.165, Global test accuracy: 63.78
Round  85, Train loss: 0.390, Test loss: 0.918, Test accuracy: 72.84
Round  85, Global train loss: 0.390, Global test loss: 1.329, Global test accuracy: 61.22
Round  86, Train loss: 0.339, Test loss: 0.933, Test accuracy: 72.54
Round  86, Global train loss: 0.339, Global test loss: 1.289, Global test accuracy: 62.40
Round  87, Train loss: 0.376, Test loss: 0.934, Test accuracy: 72.80
Round  87, Global train loss: 0.376, Global test loss: 1.278, Global test accuracy: 63.20
Round  88, Train loss: 0.317, Test loss: 0.944, Test accuracy: 73.15
Round  88, Global train loss: 0.317, Global test loss: 1.395, Global test accuracy: 62.23
Round  89, Train loss: 0.330, Test loss: 0.944, Test accuracy: 73.17
Round  89, Global train loss: 0.330, Global test loss: 1.188, Global test accuracy: 65.22
Round  90, Train loss: 0.408, Test loss: 0.953, Test accuracy: 72.75
Round  90, Global train loss: 0.408, Global test loss: 1.295, Global test accuracy: 62.52
Round  91, Train loss: 0.320, Test loss: 0.946, Test accuracy: 72.95
Round  91, Global train loss: 0.320, Global test loss: 1.323, Global test accuracy: 62.74
Round  92, Train loss: 0.411, Test loss: 0.953, Test accuracy: 73.14
Round  92, Global train loss: 0.411, Global test loss: 1.343, Global test accuracy: 60.65
Round  93, Train loss: 0.349, Test loss: 0.986, Test accuracy: 72.75
Round  93, Global train loss: 0.349, Global test loss: 1.309, Global test accuracy: 62.77
Round  94, Train loss: 0.344, Test loss: 0.958, Test accuracy: 73.19
Round  94, Global train loss: 0.344, Global test loss: 1.277, Global test accuracy: 63.38
Round  95, Train loss: 0.267, Test loss: 0.950, Test accuracy: 73.29
Round  95, Global train loss: 0.267, Global test loss: 1.355, Global test accuracy: 62.95
Round  96, Train loss: 0.373, Test loss: 0.964, Test accuracy: 72.91
Round  96, Global train loss: 0.373, Global test loss: 1.243, Global test accuracy: 64.46
Round  97, Train loss: 0.400, Test loss: 0.948, Test accuracy: 73.26
Round  97, Global train loss: 0.400, Global test loss: 1.268, Global test accuracy: 61.36
Round  98, Train loss: 0.304, Test loss: 0.957, Test accuracy: 73.33
Round  98, Global train loss: 0.304, Global test loss: 1.193, Global test accuracy: 65.10
Round  99, Train loss: 0.359, Test loss: 0.961, Test accuracy: 73.47
Round  99, Global train loss: 0.359, Global test loss: 1.142, Global test accuracy: 65.72
Final Round, Train loss: 0.271, Test loss: 1.034, Test accuracy: 72.83
Final Round, Global train loss: 0.271, Global test loss: 1.142, Global test accuracy: 65.72
Average accuracy final 10 rounds: 73.104 

Average global accuracy final 10 rounds: 63.165000000000006 

1422.66148853302
[1.4652538299560547, 2.9305076599121094, 4.1521220207214355, 5.373736381530762, 6.596944808959961, 7.82015323638916, 9.043707132339478, 10.267261028289795, 11.495564460754395, 12.723867893218994, 13.950089454650879, 15.176311016082764, 16.401052951812744, 17.625794887542725, 18.84952449798584, 20.073254108428955, 21.29825448989868, 22.523254871368408, 23.752523183822632, 24.981791496276855, 26.20851421356201, 27.435236930847168, 28.656367540359497, 29.877498149871826, 31.102978706359863, 32.3284592628479, 33.547544956207275, 34.76663064956665, 35.98326539993286, 37.19990015029907, 38.41393208503723, 39.62796401977539, 40.846961975097656, 42.06595993041992, 43.28083038330078, 44.49570083618164, 45.70493268966675, 46.914164543151855, 48.11499214172363, 49.31581974029541, 50.51903772354126, 51.72225570678711, 52.93641781806946, 54.15057992935181, 55.37887787818909, 56.60717582702637, 57.8292510509491, 59.051326274871826, 60.27086281776428, 61.49039936065674, 62.71212029457092, 63.93384122848511, 65.15511584281921, 66.37639045715332, 67.60281252861023, 68.82923460006714, 70.0478367805481, 71.26643896102905, 72.4861249923706, 73.70581102371216, 74.92067790031433, 76.1355447769165, 77.35962462425232, 78.58370447158813, 79.80566334724426, 81.02762222290039, 82.23451018333435, 83.44139814376831, 84.66038870811462, 85.87937927246094, 87.09721398353577, 88.3150486946106, 89.53445410728455, 90.7538595199585, 91.97092175483704, 93.18798398971558, 94.41057515144348, 95.63316631317139, 96.84880828857422, 98.06445026397705, 99.28087830543518, 100.49730634689331, 101.72305059432983, 102.94879484176636, 104.16333103179932, 105.37786722183228, 106.60098075866699, 107.82409429550171, 109.04182887077332, 110.25956344604492, 111.48050260543823, 112.70144176483154, 113.92660236358643, 115.15176296234131, 116.37758302688599, 117.60340309143066, 118.82803344726562, 120.05266380310059, 121.28027319908142, 122.50788259506226, 123.72634196281433, 124.9448013305664, 126.16771101951599, 127.39062070846558, 128.61113119125366, 129.83164167404175, 131.04593181610107, 132.2602219581604, 133.46777367591858, 134.67532539367676, 135.88805031776428, 137.1007752418518, 138.3069372177124, 139.513099193573, 140.7247326374054, 141.9363660812378, 143.151957988739, 144.36754989624023, 145.5724902153015, 146.7774305343628, 147.98070096969604, 149.1839714050293, 150.41023969650269, 151.63650798797607, 152.84175276756287, 154.04699754714966, 155.24996662139893, 156.4529356956482, 157.65799140930176, 158.86304712295532, 160.07022309303284, 161.27739906311035, 162.49058628082275, 163.70377349853516, 164.9115333557129, 166.11929321289062, 167.31941771507263, 168.51954221725464, 169.72653555870056, 170.93352890014648, 172.13516974449158, 173.33681058883667, 174.54521560668945, 175.75362062454224, 176.9605212211609, 178.16742181777954, 179.37404465675354, 180.58066749572754, 181.78358697891235, 182.98650646209717, 184.19517469406128, 185.4038429260254, 186.60784530639648, 187.81184768676758, 189.02434921264648, 190.2368507385254, 191.44488167762756, 192.65291261672974, 193.8621470928192, 195.0713815689087, 196.28084182739258, 197.49030208587646, 198.69913792610168, 199.9079737663269, 201.11601448059082, 202.32405519485474, 203.5323293209076, 204.74060344696045, 205.94269728660583, 207.14479112625122, 208.35481667518616, 209.5648422241211, 210.770977973938, 211.97711372375488, 213.18919372558594, 214.401273727417, 215.61425185203552, 216.82722997665405, 218.0458619594574, 219.26449394226074, 220.47002506256104, 221.67555618286133, 222.88882398605347, 224.1020917892456, 225.31240940093994, 226.52272701263428, 227.73796319961548, 228.95319938659668, 230.1636598110199, 231.37412023544312, 232.58021783828735, 233.7863154411316, 234.9951708316803, 236.204026222229, 237.421480178833, 238.638934135437, 239.8497908115387, 241.06064748764038, 242.27288269996643, 243.48511791229248, 245.91684818267822, 248.34857845306396]
[18.22, 18.22, 31.69, 31.69, 39.21, 39.21, 44.4, 44.4, 49.13, 49.13, 51.76, 51.76, 53.07, 53.07, 54.89, 54.89, 54.49, 54.49, 56.82, 56.82, 56.42, 56.42, 57.41, 57.41, 59.88, 59.88, 60.8, 60.8, 61.08, 61.08, 62.23, 62.23, 62.64, 62.64, 62.85, 62.85, 63.87, 63.87, 64.61, 64.61, 65.16, 65.16, 65.48, 65.48, 65.9, 65.9, 66.46, 66.46, 65.84, 65.84, 66.41, 66.41, 67.01, 67.01, 67.49, 67.49, 67.68, 67.68, 67.47, 67.47, 67.68, 67.68, 68.29, 68.29, 68.66, 68.66, 68.97, 68.97, 69.55, 69.55, 69.42, 69.42, 69.54, 69.54, 69.38, 69.38, 69.12, 69.12, 69.11, 69.11, 69.45, 69.45, 69.59, 69.59, 70.39, 70.39, 70.98, 70.98, 70.97, 70.97, 70.81, 70.81, 71.28, 71.28, 71.26, 71.26, 70.97, 70.97, 70.77, 70.77, 71.42, 71.42, 71.91, 71.91, 71.53, 71.53, 71.2, 71.2, 70.91, 70.91, 71.33, 71.33, 71.83, 71.83, 72.33, 72.33, 72.02, 72.02, 71.89, 71.89, 71.89, 71.89, 72.24, 72.24, 72.11, 72.11, 71.81, 71.81, 71.84, 71.84, 72.18, 72.18, 72.47, 72.47, 72.47, 72.47, 72.22, 72.22, 72.78, 72.78, 72.87, 72.87, 72.61, 72.61, 72.83, 72.83, 72.6, 72.6, 72.8, 72.8, 72.84, 72.84, 72.6, 72.6, 72.68, 72.68, 72.28, 72.28, 72.74, 72.74, 72.62, 72.62, 72.64, 72.64, 73.12, 73.12, 73.01, 73.01, 72.74, 72.74, 72.84, 72.84, 72.54, 72.54, 72.8, 72.8, 73.15, 73.15, 73.17, 73.17, 72.75, 72.75, 72.95, 72.95, 73.14, 73.14, 72.75, 72.75, 73.19, 73.19, 73.29, 73.29, 72.91, 72.91, 73.26, 73.26, 73.33, 73.33, 73.47, 73.47, 72.83, 72.83]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.720, Test loss: 2.112, Test accuracy: 18.53
Round   0, Global train loss: 1.720, Global test loss: 2.324, Global test accuracy: 13.00
Round   1, Train loss: 1.555, Test loss: 1.752, Test accuracy: 33.70
Round   1, Global train loss: 1.555, Global test loss: 2.075, Global test accuracy: 24.02
Round   2, Train loss: 1.370, Test loss: 1.558, Test accuracy: 38.17
Round   2, Global train loss: 1.370, Global test loss: 1.993, Global test accuracy: 25.93
Round   3, Train loss: 1.271, Test loss: 1.419, Test accuracy: 42.68
Round   3, Global train loss: 1.271, Global test loss: 1.852, Global test accuracy: 31.32
Round   4, Train loss: 1.300, Test loss: 1.304, Test accuracy: 47.13
Round   4, Global train loss: 1.300, Global test loss: 1.693, Global test accuracy: 37.89
Round   5, Train loss: 1.141, Test loss: 1.240, Test accuracy: 50.51
Round   5, Global train loss: 1.141, Global test loss: 1.689, Global test accuracy: 40.61
Round   6, Train loss: 1.170, Test loss: 1.226, Test accuracy: 51.48
Round   6, Global train loss: 1.170, Global test loss: 1.634, Global test accuracy: 39.23
Round   7, Train loss: 1.292, Test loss: 1.179, Test accuracy: 52.99
Round   7, Global train loss: 1.292, Global test loss: 1.622, Global test accuracy: 40.40
Round   8, Train loss: 1.089, Test loss: 1.170, Test accuracy: 54.15
Round   8, Global train loss: 1.089, Global test loss: 1.767, Global test accuracy: 36.38
Round   9, Train loss: 1.086, Test loss: 1.101, Test accuracy: 56.54
Round   9, Global train loss: 1.086, Global test loss: 1.584, Global test accuracy: 39.42
Round  10, Train loss: 1.083, Test loss: 1.107, Test accuracy: 56.47
Round  10, Global train loss: 1.083, Global test loss: 1.554, Global test accuracy: 43.74
Round  11, Train loss: 0.959, Test loss: 1.084, Test accuracy: 57.17
Round  11, Global train loss: 0.959, Global test loss: 1.533, Global test accuracy: 43.42
Round  12, Train loss: 1.025, Test loss: 1.022, Test accuracy: 59.48
Round  12, Global train loss: 1.025, Global test loss: 1.481, Global test accuracy: 46.66
Round  13, Train loss: 0.976, Test loss: 1.015, Test accuracy: 60.09
Round  13, Global train loss: 0.976, Global test loss: 1.649, Global test accuracy: 41.30
Round  14, Train loss: 0.970, Test loss: 0.990, Test accuracy: 61.34
Round  14, Global train loss: 0.970, Global test loss: 1.442, Global test accuracy: 48.97
Round  15, Train loss: 0.941, Test loss: 0.996, Test accuracy: 61.27
Round  15, Global train loss: 0.941, Global test loss: 1.416, Global test accuracy: 48.69
Round  16, Train loss: 0.981, Test loss: 0.990, Test accuracy: 61.67
Round  16, Global train loss: 0.981, Global test loss: 1.592, Global test accuracy: 45.18
Round  17, Train loss: 0.982, Test loss: 0.972, Test accuracy: 62.74
Round  17, Global train loss: 0.982, Global test loss: 1.465, Global test accuracy: 45.89
Round  18, Train loss: 1.030, Test loss: 0.972, Test accuracy: 62.90
Round  18, Global train loss: 1.030, Global test loss: 1.386, Global test accuracy: 50.36
Round  19, Train loss: 0.894, Test loss: 0.963, Test accuracy: 63.07
Round  19, Global train loss: 0.894, Global test loss: 1.470, Global test accuracy: 48.21
Round  20, Train loss: 1.029, Test loss: 0.943, Test accuracy: 63.84
Round  20, Global train loss: 1.029, Global test loss: 1.353, Global test accuracy: 50.50
Round  21, Train loss: 1.012, Test loss: 0.936, Test accuracy: 64.55
Round  21, Global train loss: 1.012, Global test loss: 1.408, Global test accuracy: 49.31
Round  22, Train loss: 0.922, Test loss: 0.928, Test accuracy: 65.30
Round  22, Global train loss: 0.922, Global test loss: 1.318, Global test accuracy: 53.93
Round  23, Train loss: 1.026, Test loss: 0.920, Test accuracy: 65.70
Round  23, Global train loss: 1.026, Global test loss: 1.364, Global test accuracy: 50.47
Round  24, Train loss: 0.919, Test loss: 0.911, Test accuracy: 66.19
Round  24, Global train loss: 0.919, Global test loss: 1.287, Global test accuracy: 53.70
Round  25, Train loss: 0.894, Test loss: 0.902, Test accuracy: 66.60
Round  25, Global train loss: 0.894, Global test loss: 1.244, Global test accuracy: 54.35
Round  26, Train loss: 0.809, Test loss: 0.884, Test accuracy: 67.34
Round  26, Global train loss: 0.809, Global test loss: 1.301, Global test accuracy: 53.97
Round  27, Train loss: 0.891, Test loss: 0.900, Test accuracy: 66.57
Round  27, Global train loss: 0.891, Global test loss: 1.491, Global test accuracy: 47.75
Round  28, Train loss: 0.769, Test loss: 0.898, Test accuracy: 66.81
Round  28, Global train loss: 0.769, Global test loss: 1.431, Global test accuracy: 50.55
Round  29, Train loss: 0.772, Test loss: 0.905, Test accuracy: 66.40
Round  29, Global train loss: 0.772, Global test loss: 1.246, Global test accuracy: 55.54
Round  30, Train loss: 0.796, Test loss: 0.883, Test accuracy: 66.89
Round  30, Global train loss: 0.796, Global test loss: 1.247, Global test accuracy: 55.99
Round  31, Train loss: 0.764, Test loss: 0.868, Test accuracy: 67.34
Round  31, Global train loss: 0.764, Global test loss: 1.232, Global test accuracy: 56.48
Round  32, Train loss: 0.686, Test loss: 0.872, Test accuracy: 67.25
Round  32, Global train loss: 0.686, Global test loss: 1.316, Global test accuracy: 53.78
Round  33, Train loss: 0.889, Test loss: 0.879, Test accuracy: 67.31
Round  33, Global train loss: 0.889, Global test loss: 1.347, Global test accuracy: 51.68
Round  34, Train loss: 0.726, Test loss: 0.869, Test accuracy: 67.66
Round  34, Global train loss: 0.726, Global test loss: 1.324, Global test accuracy: 56.64
Round  35, Train loss: 0.835, Test loss: 0.873, Test accuracy: 67.80
Round  35, Global train loss: 0.835, Global test loss: 1.261, Global test accuracy: 57.32
Round  36, Train loss: 0.742, Test loss: 0.889, Test accuracy: 67.26
Round  36, Global train loss: 0.742, Global test loss: 1.234, Global test accuracy: 56.73
Round  37, Train loss: 0.751, Test loss: 0.871, Test accuracy: 67.93
Round  37, Global train loss: 0.751, Global test loss: 1.250, Global test accuracy: 57.02
Round  38, Train loss: 0.745, Test loss: 0.887, Test accuracy: 67.90
Round  38, Global train loss: 0.745, Global test loss: 1.358, Global test accuracy: 54.66
Round  39, Train loss: 0.831, Test loss: 0.890, Test accuracy: 68.05
Round  39, Global train loss: 0.831, Global test loss: 1.188, Global test accuracy: 59.29
Round  40, Train loss: 0.737, Test loss: 0.865, Test accuracy: 69.20
Round  40, Global train loss: 0.737, Global test loss: 1.252, Global test accuracy: 55.98
Round  41, Train loss: 0.788, Test loss: 0.846, Test accuracy: 69.72
Round  41, Global train loss: 0.788, Global test loss: 1.185, Global test accuracy: 58.59
Round  42, Train loss: 0.782, Test loss: 0.860, Test accuracy: 69.52
Round  42, Global train loss: 0.782, Global test loss: 1.211, Global test accuracy: 57.96
Round  43, Train loss: 0.758, Test loss: 0.877, Test accuracy: 69.34
Round  43, Global train loss: 0.758, Global test loss: 1.205, Global test accuracy: 57.77
Round  44, Train loss: 0.665, Test loss: 0.883, Test accuracy: 68.96
Round  44, Global train loss: 0.665, Global test loss: 1.230, Global test accuracy: 56.95
Round  45, Train loss: 0.613, Test loss: 0.864, Test accuracy: 69.59
Round  45, Global train loss: 0.613, Global test loss: 1.341, Global test accuracy: 56.20
Round  46, Train loss: 0.704, Test loss: 0.877, Test accuracy: 69.66
Round  46, Global train loss: 0.704, Global test loss: 1.108, Global test accuracy: 61.12
Round  47, Train loss: 0.774, Test loss: 0.868, Test accuracy: 69.83
Round  47, Global train loss: 0.774, Global test loss: 1.176, Global test accuracy: 59.17
Round  48, Train loss: 0.666, Test loss: 0.867, Test accuracy: 69.87
Round  48, Global train loss: 0.666, Global test loss: 1.243, Global test accuracy: 57.20
Round  49, Train loss: 0.619, Test loss: 0.851, Test accuracy: 70.38
Round  49, Global train loss: 0.619, Global test loss: 1.249, Global test accuracy: 56.36
Round  50, Train loss: 0.698, Test loss: 0.845, Test accuracy: 70.39
Round  50, Global train loss: 0.698, Global test loss: 1.164, Global test accuracy: 59.82
Round  51, Train loss: 0.527, Test loss: 0.867, Test accuracy: 69.63
Round  51, Global train loss: 0.527, Global test loss: 1.087, Global test accuracy: 62.99
Round  52, Train loss: 0.638, Test loss: 0.880, Test accuracy: 69.27
Round  52, Global train loss: 0.638, Global test loss: 1.166, Global test accuracy: 59.67
Round  53, Train loss: 0.733, Test loss: 0.891, Test accuracy: 68.99
Round  53, Global train loss: 0.733, Global test loss: 1.164, Global test accuracy: 59.69
Round  54, Train loss: 0.594, Test loss: 0.895, Test accuracy: 68.78
Round  54, Global train loss: 0.594, Global test loss: 1.156, Global test accuracy: 60.51
Round  55, Train loss: 0.683, Test loss: 0.880, Test accuracy: 69.41
Round  55, Global train loss: 0.683, Global test loss: 1.095, Global test accuracy: 61.78
Round  56, Train loss: 0.581, Test loss: 0.901, Test accuracy: 69.44
Round  56, Global train loss: 0.581, Global test loss: 1.228, Global test accuracy: 58.96
Round  57, Train loss: 0.552, Test loss: 0.885, Test accuracy: 69.57
Round  57, Global train loss: 0.552, Global test loss: 1.140, Global test accuracy: 61.58
Round  58, Train loss: 0.655, Test loss: 0.875, Test accuracy: 70.05
Round  58, Global train loss: 0.655, Global test loss: 1.137, Global test accuracy: 61.33
Round  59, Train loss: 0.662, Test loss: 0.868, Test accuracy: 70.55
Round  59, Global train loss: 0.662, Global test loss: 1.310, Global test accuracy: 56.39
Round  60, Train loss: 0.520, Test loss: 0.878, Test accuracy: 70.17
Round  60, Global train loss: 0.520, Global test loss: 1.132, Global test accuracy: 62.36
Round  61, Train loss: 0.479, Test loss: 0.875, Test accuracy: 70.50
Round  61, Global train loss: 0.479, Global test loss: 1.312, Global test accuracy: 59.33
Round  62, Train loss: 0.588, Test loss: 0.893, Test accuracy: 69.99
Round  62, Global train loss: 0.588, Global test loss: 1.107, Global test accuracy: 63.20
Round  63, Train loss: 0.562, Test loss: 0.887, Test accuracy: 70.09
Round  63, Global train loss: 0.562, Global test loss: 1.158, Global test accuracy: 62.14
Round  64, Train loss: 0.519, Test loss: 0.876, Test accuracy: 70.52
Round  64, Global train loss: 0.519, Global test loss: 1.259, Global test accuracy: 58.79
Round  65, Train loss: 0.487, Test loss: 0.874, Test accuracy: 70.64
Round  65, Global train loss: 0.487, Global test loss: 1.148, Global test accuracy: 62.64
Round  66, Train loss: 0.507, Test loss: 0.880, Test accuracy: 70.88
Round  66, Global train loss: 0.507, Global test loss: 1.111, Global test accuracy: 62.91
Round  67, Train loss: 0.478, Test loss: 0.879, Test accuracy: 70.82
Round  67, Global train loss: 0.478, Global test loss: 1.163, Global test accuracy: 62.24
Round  68, Train loss: 0.427, Test loss: 0.901, Test accuracy: 70.59
Round  68, Global train loss: 0.427, Global test loss: 1.228, Global test accuracy: 61.53
Round  69, Train loss: 0.688, Test loss: 0.918, Test accuracy: 70.13
Round  69, Global train loss: 0.688, Global test loss: 1.136, Global test accuracy: 61.45
Round  70, Train loss: 0.430, Test loss: 0.912, Test accuracy: 70.37
Round  70, Global train loss: 0.430, Global test loss: 1.173, Global test accuracy: 61.48
Round  71, Train loss: 0.577, Test loss: 0.898, Test accuracy: 70.87
Round  71, Global train loss: 0.577, Global test loss: 1.115, Global test accuracy: 62.43
Round  72, Train loss: 0.505, Test loss: 0.913, Test accuracy: 70.64
Round  72, Global train loss: 0.505, Global test loss: 1.157, Global test accuracy: 62.02
Round  73, Train loss: 0.514, Test loss: 0.887, Test accuracy: 71.34
Round  73, Global train loss: 0.514, Global test loss: 1.168, Global test accuracy: 62.40
Round  74, Train loss: 0.555, Test loss: 0.895, Test accuracy: 70.89
Round  74, Global train loss: 0.555, Global test loss: 1.211, Global test accuracy: 61.12
Round  75, Train loss: 0.644, Test loss: 0.906, Test accuracy: 71.08
Round  75, Global train loss: 0.644, Global test loss: 1.164, Global test accuracy: 61.96
Round  76, Train loss: 0.492, Test loss: 0.899, Test accuracy: 71.29
Round  76, Global train loss: 0.492, Global test loss: 1.179, Global test accuracy: 61.82
Round  77, Train loss: 0.490, Test loss: 0.878, Test accuracy: 71.54
Round  77, Global train loss: 0.490, Global test loss: 1.271, Global test accuracy: 59.23
Round  78, Train loss: 0.591, Test loss: 0.906, Test accuracy: 71.28
Round  78, Global train loss: 0.591, Global test loss: 1.174, Global test accuracy: 61.27
Round  79, Train loss: 0.445, Test loss: 0.922, Test accuracy: 71.38
Round  79, Global train loss: 0.445, Global test loss: 1.189, Global test accuracy: 62.53
Round  80, Train loss: 0.414, Test loss: 0.919, Test accuracy: 71.27
Round  80, Global train loss: 0.414, Global test loss: 1.254, Global test accuracy: 61.48
Round  81, Train loss: 0.455, Test loss: 0.896, Test accuracy: 71.55
Round  81, Global train loss: 0.455, Global test loss: 1.169, Global test accuracy: 63.09
Round  82, Train loss: 0.593, Test loss: 0.884, Test accuracy: 71.80
Round  82, Global train loss: 0.593, Global test loss: 1.237, Global test accuracy: 61.27
Round  83, Train loss: 0.391, Test loss: 0.889, Test accuracy: 71.65
Round  83, Global train loss: 0.391, Global test loss: 1.245, Global test accuracy: 61.52
Round  84, Train loss: 0.425, Test loss: 0.926, Test accuracy: 70.76
Round  84, Global train loss: 0.425, Global test loss: 1.208, Global test accuracy: 61.83
Round  85, Train loss: 0.550, Test loss: 0.909, Test accuracy: 71.03
Round  85, Global train loss: 0.550, Global test loss: 1.211, Global test accuracy: 61.01
Round  86, Train loss: 0.477, Test loss: 0.909, Test accuracy: 71.37
Round  86, Global train loss: 0.477, Global test loss: 1.246, Global test accuracy: 61.42
Round  87, Train loss: 0.426, Test loss: 0.896, Test accuracy: 72.11
Round  87, Global train loss: 0.426, Global test loss: 1.268, Global test accuracy: 61.51
Round  88, Train loss: 0.417, Test loss: 0.887, Test accuracy: 72.47
Round  88, Global train loss: 0.417, Global test loss: 1.334, Global test accuracy: 61.13
Round  89, Train loss: 0.491, Test loss: 0.923, Test accuracy: 71.90
Round  89, Global train loss: 0.491, Global test loss: 1.143, Global test accuracy: 64.18
Round  90, Train loss: 0.527, Test loss: 0.918, Test accuracy: 71.87
Round  90, Global train loss: 0.527, Global test loss: 1.259, Global test accuracy: 60.44
Round  91, Train loss: 0.424, Test loss: 0.931, Test accuracy: 72.17
Round  91, Global train loss: 0.424, Global test loss: 1.272, Global test accuracy: 61.91
Round  92, Train loss: 0.525, Test loss: 0.953, Test accuracy: 71.90
Round  92, Global train loss: 0.525, Global test loss: 1.244, Global test accuracy: 61.32
Round  93, Train loss: 0.416, Test loss: 0.929, Test accuracy: 72.15
Round  93, Global train loss: 0.416, Global test loss: 1.243, Global test accuracy: 62.30/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.412, Test loss: 0.938, Test accuracy: 71.68
Round  94, Global train loss: 0.412, Global test loss: 1.248, Global test accuracy: 61.67
Round  95, Train loss: 0.387, Test loss: 0.952, Test accuracy: 71.37
Round  95, Global train loss: 0.387, Global test loss: 1.225, Global test accuracy: 62.86
Round  96, Train loss: 0.405, Test loss: 0.943, Test accuracy: 71.68
Round  96, Global train loss: 0.405, Global test loss: 1.196, Global test accuracy: 63.23
Round  97, Train loss: 0.505, Test loss: 0.935, Test accuracy: 71.49
Round  97, Global train loss: 0.505, Global test loss: 1.225, Global test accuracy: 60.92
Round  98, Train loss: 0.367, Test loss: 0.938, Test accuracy: 71.81
Round  98, Global train loss: 0.367, Global test loss: 1.189, Global test accuracy: 63.90
Round  99, Train loss: 0.418, Test loss: 0.949, Test accuracy: 71.59
Round  99, Global train loss: 0.418, Global test loss: 1.164, Global test accuracy: 64.03
Final Round, Train loss: 0.348, Test loss: 1.013, Test accuracy: 71.14
Final Round, Global train loss: 0.348, Global test loss: 1.164, Global test accuracy: 64.03
Average accuracy final 10 rounds: 71.77100000000002 

Average global accuracy final 10 rounds: 62.257999999999996 

1472.6942541599274
[1.5955712795257568, 3.1911425590515137, 4.543242692947388, 5.895342826843262, 7.234461307525635, 8.573579788208008, 9.889811754226685, 11.206043720245361, 12.508935689926147, 13.811827659606934, 15.117794275283813, 16.423760890960693, 17.725644826889038, 19.027528762817383, 20.33778405189514, 21.6480393409729, 22.938385248184204, 24.228731155395508, 25.541820287704468, 26.854909420013428, 28.15915012359619, 29.463390827178955, 30.767395973205566, 32.07140111923218, 33.37639498710632, 34.68138885498047, 35.98638916015625, 37.29138946533203, 38.59556555747986, 39.899741649627686, 41.21090269088745, 42.52206373214722, 43.81586694717407, 45.10967016220093, 46.406530141830444, 47.70339012145996, 49.01435661315918, 50.3253231048584, 51.62217402458191, 52.91902494430542, 54.22250175476074, 55.525978565216064, 56.83523464202881, 58.14449071884155, 59.49382472038269, 60.84315872192383, 62.181172370910645, 63.51918601989746, 64.8650176525116, 66.21084928512573, 67.54992628097534, 68.88900327682495, 70.22000885009766, 71.55101442337036, 72.8888349533081, 74.22665548324585, 75.56193089485168, 76.89720630645752, 78.24046516418457, 79.58372402191162, 80.93072652816772, 82.27772903442383, 83.61781668663025, 84.95790433883667, 86.2653865814209, 87.57286882400513, 88.89053225517273, 90.20819568634033, 91.51911091804504, 92.83002614974976, 94.14097380638123, 95.4519214630127, 96.78493189811707, 98.11794233322144, 99.44752836227417, 100.7771143913269, 102.12343168258667, 103.46974897384644, 104.81086707115173, 106.15198516845703, 107.48405885696411, 108.81613254547119, 110.1590986251831, 111.50206470489502, 112.8358986377716, 114.1697325706482, 115.50245523452759, 116.83517789840698, 118.16433262825012, 119.49348735809326, 120.83719325065613, 122.180899143219, 123.51930093765259, 124.85770273208618, 126.13997983932495, 127.42225694656372, 128.75268864631653, 130.08312034606934, 131.38596558570862, 132.6888108253479, 134.02422976493835, 135.3596487045288, 136.68440771102905, 138.0091667175293, 139.28309202194214, 140.55701732635498, 141.86216402053833, 143.16731071472168, 144.43523359298706, 145.70315647125244, 146.99642395973206, 148.28969144821167, 149.58651161193848, 150.88333177566528, 152.1919605731964, 153.50058937072754, 154.8040690422058, 156.10754871368408, 157.3903636932373, 158.67317867279053, 159.9504270553589, 161.22767543792725, 162.5098536014557, 163.79203176498413, 165.069917678833, 166.34780359268188, 167.63730096817017, 168.92679834365845, 170.22799158096313, 171.52918481826782, 172.7914526462555, 174.05372047424316, 175.3189492225647, 176.58417797088623, 177.85207986831665, 179.11998176574707, 180.38919734954834, 181.6584129333496, 182.9225878715515, 184.18676280975342, 185.46043515205383, 186.73410749435425, 188.0307378768921, 189.32736825942993, 190.6044716835022, 191.88157510757446, 193.16170382499695, 194.44183254241943, 195.7045509815216, 196.96726942062378, 198.24953317642212, 199.53179693222046, 200.79433298110962, 202.05686902999878, 203.3311026096344, 204.60533618927002, 205.88656067848206, 207.1677851676941, 208.43442749977112, 209.70106983184814, 210.97323632240295, 212.24540281295776, 213.5115954875946, 214.77778816223145, 216.0516586303711, 217.32552909851074, 218.60047149658203, 219.87541389465332, 221.14001870155334, 222.40462350845337, 223.6667959690094, 224.92896842956543, 226.19856476783752, 227.46816110610962, 228.72804760932922, 229.98793411254883, 231.248881816864, 232.5098295211792, 233.7827353477478, 235.0556411743164, 236.33885622024536, 237.62207126617432, 238.87924480438232, 240.13641834259033, 241.40409779548645, 242.67177724838257, 243.93808937072754, 245.2044014930725, 246.48950099945068, 247.77460050582886, 249.05319142341614, 250.33178234100342, 251.61140775680542, 252.89103317260742, 254.17028045654297, 255.44952774047852, 256.73977422714233, 258.03002071380615, 259.3127975463867, 260.5955743789673, 263.11155247688293, 265.6275305747986]
[18.53, 18.53, 33.7, 33.7, 38.17, 38.17, 42.68, 42.68, 47.13, 47.13, 50.51, 50.51, 51.48, 51.48, 52.99, 52.99, 54.15, 54.15, 56.54, 56.54, 56.47, 56.47, 57.17, 57.17, 59.48, 59.48, 60.09, 60.09, 61.34, 61.34, 61.27, 61.27, 61.67, 61.67, 62.74, 62.74, 62.9, 62.9, 63.07, 63.07, 63.84, 63.84, 64.55, 64.55, 65.3, 65.3, 65.7, 65.7, 66.19, 66.19, 66.6, 66.6, 67.34, 67.34, 66.57, 66.57, 66.81, 66.81, 66.4, 66.4, 66.89, 66.89, 67.34, 67.34, 67.25, 67.25, 67.31, 67.31, 67.66, 67.66, 67.8, 67.8, 67.26, 67.26, 67.93, 67.93, 67.9, 67.9, 68.05, 68.05, 69.2, 69.2, 69.72, 69.72, 69.52, 69.52, 69.34, 69.34, 68.96, 68.96, 69.59, 69.59, 69.66, 69.66, 69.83, 69.83, 69.87, 69.87, 70.38, 70.38, 70.39, 70.39, 69.63, 69.63, 69.27, 69.27, 68.99, 68.99, 68.78, 68.78, 69.41, 69.41, 69.44, 69.44, 69.57, 69.57, 70.05, 70.05, 70.55, 70.55, 70.17, 70.17, 70.5, 70.5, 69.99, 69.99, 70.09, 70.09, 70.52, 70.52, 70.64, 70.64, 70.88, 70.88, 70.82, 70.82, 70.59, 70.59, 70.13, 70.13, 70.37, 70.37, 70.87, 70.87, 70.64, 70.64, 71.34, 71.34, 70.89, 70.89, 71.08, 71.08, 71.29, 71.29, 71.54, 71.54, 71.28, 71.28, 71.38, 71.38, 71.27, 71.27, 71.55, 71.55, 71.8, 71.8, 71.65, 71.65, 70.76, 70.76, 71.03, 71.03, 71.37, 71.37, 72.11, 72.11, 72.47, 72.47, 71.9, 71.9, 71.87, 71.87, 72.17, 72.17, 71.9, 71.9, 72.15, 72.15, 71.68, 71.68, 71.37, 71.37, 71.68, 71.68, 71.49, 71.49, 71.81, 71.81, 71.59, 71.59, 71.14, 71.14]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.657, Test loss: 2.121, Test accuracy: 17.41
Round   0, Global train loss: 1.657, Global test loss: 2.334, Global test accuracy: 13.04
Round   1, Train loss: 1.404, Test loss: 1.795, Test accuracy: 32.70
Round   1, Global train loss: 1.404, Global test loss: 2.090, Global test accuracy: 27.50
Round   2, Train loss: 1.297, Test loss: 1.579, Test accuracy: 37.65
Round   2, Global train loss: 1.297, Global test loss: 2.010, Global test accuracy: 26.92
Round   3, Train loss: 1.326, Test loss: 1.384, Test accuracy: 44.22
Round   3, Global train loss: 1.326, Global test loss: 1.812, Global test accuracy: 34.04
Round   4, Train loss: 1.221, Test loss: 1.282, Test accuracy: 48.16
Round   4, Global train loss: 1.221, Global test loss: 1.776, Global test accuracy: 33.26
Round   5, Train loss: 1.171, Test loss: 1.213, Test accuracy: 51.59
Round   5, Global train loss: 1.171, Global test loss: 1.697, Global test accuracy: 40.25
Round   6, Train loss: 1.132, Test loss: 1.201, Test accuracy: 52.95
Round   6, Global train loss: 1.132, Global test loss: 1.650, Global test accuracy: 39.87
Round   7, Train loss: 1.118, Test loss: 1.195, Test accuracy: 54.23
Round   7, Global train loss: 1.118, Global test loss: 1.807, Global test accuracy: 37.50
Round   8, Train loss: 1.071, Test loss: 1.176, Test accuracy: 54.33
Round   8, Global train loss: 1.071, Global test loss: 1.844, Global test accuracy: 35.30
Round   9, Train loss: 1.060, Test loss: 1.110, Test accuracy: 56.16
Round   9, Global train loss: 1.060, Global test loss: 1.597, Global test accuracy: 40.36
Round  10, Train loss: 1.009, Test loss: 1.102, Test accuracy: 56.67
Round  10, Global train loss: 1.009, Global test loss: 1.541, Global test accuracy: 42.22
Round  11, Train loss: 0.978, Test loss: 1.081, Test accuracy: 57.10
Round  11, Global train loss: 0.978, Global test loss: 1.511, Global test accuracy: 44.19
Round  12, Train loss: 0.980, Test loss: 1.037, Test accuracy: 58.79
Round  12, Global train loss: 0.980, Global test loss: 1.479, Global test accuracy: 47.43
Round  13, Train loss: 1.003, Test loss: 1.033, Test accuracy: 59.26
Round  13, Global train loss: 1.003, Global test loss: 1.789, Global test accuracy: 36.86
Round  14, Train loss: 0.918, Test loss: 1.019, Test accuracy: 60.04
Round  14, Global train loss: 0.918, Global test loss: 1.441, Global test accuracy: 48.30
Round  15, Train loss: 0.946, Test loss: 1.006, Test accuracy: 60.53
Round  15, Global train loss: 0.946, Global test loss: 1.455, Global test accuracy: 48.01
Round  16, Train loss: 0.842, Test loss: 0.994, Test accuracy: 61.14
Round  16, Global train loss: 0.842, Global test loss: 1.727, Global test accuracy: 42.82
Round  17, Train loss: 1.016, Test loss: 0.994, Test accuracy: 61.54
Round  17, Global train loss: 1.016, Global test loss: 1.553, Global test accuracy: 43.26
Round  18, Train loss: 0.873, Test loss: 0.988, Test accuracy: 61.82
Round  18, Global train loss: 0.873, Global test loss: 1.408, Global test accuracy: 49.99
Round  19, Train loss: 0.849, Test loss: 0.956, Test accuracy: 62.68
Round  19, Global train loss: 0.849, Global test loss: 1.602, Global test accuracy: 46.87
Round  20, Train loss: 0.909, Test loss: 0.945, Test accuracy: 63.65
Round  20, Global train loss: 0.909, Global test loss: 1.463, Global test accuracy: 47.71
Round  21, Train loss: 0.793, Test loss: 0.960, Test accuracy: 63.30
Round  21, Global train loss: 0.793, Global test loss: 1.487, Global test accuracy: 49.33
Round  22, Train loss: 0.864, Test loss: 0.954, Test accuracy: 64.07
Round  22, Global train loss: 0.864, Global test loss: 1.362, Global test accuracy: 51.41
Round  23, Train loss: 0.885, Test loss: 0.957, Test accuracy: 64.04
Round  23, Global train loss: 0.885, Global test loss: 1.432, Global test accuracy: 49.25
Round  24, Train loss: 0.812, Test loss: 0.959, Test accuracy: 63.77
Round  24, Global train loss: 0.812, Global test loss: 1.434, Global test accuracy: 48.99
Round  25, Train loss: 0.862, Test loss: 0.978, Test accuracy: 63.95
Round  25, Global train loss: 0.862, Global test loss: 1.249, Global test accuracy: 54.82
Round  26, Train loss: 0.763, Test loss: 0.962, Test accuracy: 64.76
Round  26, Global train loss: 0.763, Global test loss: 1.362, Global test accuracy: 52.05
Round  27, Train loss: 0.812, Test loss: 0.935, Test accuracy: 65.63
Round  27, Global train loss: 0.812, Global test loss: 1.606, Global test accuracy: 47.77
Round  28, Train loss: 0.738, Test loss: 0.949, Test accuracy: 65.40
Round  28, Global train loss: 0.738, Global test loss: 1.540, Global test accuracy: 49.24
Round  29, Train loss: 0.710, Test loss: 0.941, Test accuracy: 65.92
Round  29, Global train loss: 0.710, Global test loss: 1.291, Global test accuracy: 55.79
Round  30, Train loss: 0.760, Test loss: 0.934, Test accuracy: 66.41
Round  30, Global train loss: 0.760, Global test loss: 1.373, Global test accuracy: 54.77
Round  31, Train loss: 0.677, Test loss: 0.911, Test accuracy: 66.78
Round  31, Global train loss: 0.677, Global test loss: 1.228, Global test accuracy: 57.21
Round  32, Train loss: 0.654, Test loss: 0.922, Test accuracy: 66.94
Round  32, Global train loss: 0.654, Global test loss: 1.348, Global test accuracy: 55.27
Round  33, Train loss: 0.718, Test loss: 0.934, Test accuracy: 66.60
Round  33, Global train loss: 0.718, Global test loss: 1.475, Global test accuracy: 50.90
Round  34, Train loss: 0.735, Test loss: 0.935, Test accuracy: 66.69
Round  34, Global train loss: 0.735, Global test loss: 1.390, Global test accuracy: 55.76
Round  35, Train loss: 0.641, Test loss: 0.937, Test accuracy: 66.85
Round  35, Global train loss: 0.641, Global test loss: 1.275, Global test accuracy: 58.41
Round  36, Train loss: 0.681, Test loss: 0.928, Test accuracy: 66.97
Round  36, Global train loss: 0.681, Global test loss: 1.195, Global test accuracy: 58.74
Round  37, Train loss: 0.715, Test loss: 0.924, Test accuracy: 67.31
Round  37, Global train loss: 0.715, Global test loss: 1.225, Global test accuracy: 58.72
Round  38, Train loss: 0.662, Test loss: 0.908, Test accuracy: 67.13
Round  38, Global train loss: 0.662, Global test loss: 1.426, Global test accuracy: 54.06
Round  39, Train loss: 0.597, Test loss: 0.904, Test accuracy: 67.71
Round  39, Global train loss: 0.597, Global test loss: 1.286, Global test accuracy: 56.92
Round  40, Train loss: 0.604, Test loss: 0.920, Test accuracy: 67.78
Round  40, Global train loss: 0.604, Global test loss: 1.346, Global test accuracy: 55.48
Round  41, Train loss: 0.635, Test loss: 0.921, Test accuracy: 68.28
Round  41, Global train loss: 0.635, Global test loss: 1.187, Global test accuracy: 59.88
Round  42, Train loss: 0.559, Test loss: 0.919, Test accuracy: 68.43
Round  42, Global train loss: 0.559, Global test loss: 1.223, Global test accuracy: 59.41
Round  43, Train loss: 0.675, Test loss: 0.902, Test accuracy: 68.96
Round  43, Global train loss: 0.675, Global test loss: 1.201, Global test accuracy: 58.54
Round  44, Train loss: 0.718, Test loss: 0.909, Test accuracy: 68.92
Round  44, Global train loss: 0.718, Global test loss: 1.324, Global test accuracy: 54.83
Round  45, Train loss: 0.548, Test loss: 0.910, Test accuracy: 69.13
Round  45, Global train loss: 0.548, Global test loss: 1.449, Global test accuracy: 55.30
Round  46, Train loss: 0.582, Test loss: 0.914, Test accuracy: 69.67
Round  46, Global train loss: 0.582, Global test loss: 1.205, Global test accuracy: 60.36
Round  47, Train loss: 0.549, Test loss: 0.911, Test accuracy: 69.75
Round  47, Global train loss: 0.549, Global test loss: 1.392, Global test accuracy: 55.55
Round  48, Train loss: 0.688, Test loss: 0.883, Test accuracy: 69.95
Round  48, Global train loss: 0.688, Global test loss: 1.360, Global test accuracy: 55.81
Round  49, Train loss: 0.635, Test loss: 0.897, Test accuracy: 69.97
Round  49, Global train loss: 0.635, Global test loss: 1.306, Global test accuracy: 55.77
Round  50, Train loss: 0.584, Test loss: 0.902, Test accuracy: 69.67
Round  50, Global train loss: 0.584, Global test loss: 1.242, Global test accuracy: 60.11
Round  51, Train loss: 0.571, Test loss: 0.895, Test accuracy: 69.76
Round  51, Global train loss: 0.571, Global test loss: 1.148, Global test accuracy: 61.45
Round  52, Train loss: 0.617, Test loss: 0.897, Test accuracy: 69.96
Round  52, Global train loss: 0.617, Global test loss: 1.254, Global test accuracy: 57.68
Round  53, Train loss: 0.533, Test loss: 0.911, Test accuracy: 70.05
Round  53, Global train loss: 0.533, Global test loss: 1.253, Global test accuracy: 59.44
Round  54, Train loss: 0.533, Test loss: 0.905, Test accuracy: 70.27
Round  54, Global train loss: 0.533, Global test loss: 1.248, Global test accuracy: 59.76
Round  55, Train loss: 0.555, Test loss: 0.896, Test accuracy: 70.77
Round  55, Global train loss: 0.555, Global test loss: 1.178, Global test accuracy: 60.25
Round  56, Train loss: 0.532, Test loss: 0.883, Test accuracy: 70.94
Round  56, Global train loss: 0.532, Global test loss: 1.272, Global test accuracy: 59.04
Round  57, Train loss: 0.531, Test loss: 0.902, Test accuracy: 70.76
Round  57, Global train loss: 0.531, Global test loss: 1.191, Global test accuracy: 60.83
Round  58, Train loss: 0.479, Test loss: 0.920, Test accuracy: 70.31
Round  58, Global train loss: 0.479, Global test loss: 1.247, Global test accuracy: 61.11
Round  59, Train loss: 0.524, Test loss: 0.893, Test accuracy: 71.27
Round  59, Global train loss: 0.524, Global test loss: 1.405, Global test accuracy: 56.83
Round  60, Train loss: 0.460, Test loss: 0.904, Test accuracy: 70.98
Round  60, Global train loss: 0.460, Global test loss: 1.187, Global test accuracy: 62.62
Round  61, Train loss: 0.493, Test loss: 0.896, Test accuracy: 71.61
Round  61, Global train loss: 0.493, Global test loss: 1.412, Global test accuracy: 58.27
Round  62, Train loss: 0.512, Test loss: 0.905, Test accuracy: 71.40
Round  62, Global train loss: 0.512, Global test loss: 1.144, Global test accuracy: 62.84
Round  63, Train loss: 0.480, Test loss: 0.904, Test accuracy: 71.72
Round  63, Global train loss: 0.480, Global test loss: 1.302, Global test accuracy: 60.20
Round  64, Train loss: 0.531, Test loss: 0.921, Test accuracy: 71.38
Round  64, Global train loss: 0.531, Global test loss: 1.333, Global test accuracy: 58.35
Round  65, Train loss: 0.502, Test loss: 0.908, Test accuracy: 71.32
Round  65, Global train loss: 0.502, Global test loss: 1.254, Global test accuracy: 60.22
Round  66, Train loss: 0.479, Test loss: 0.936, Test accuracy: 71.10
Round  66, Global train loss: 0.479, Global test loss: 1.208, Global test accuracy: 61.83
Round  67, Train loss: 0.451, Test loss: 0.968, Test accuracy: 70.73
Round  67, Global train loss: 0.451, Global test loss: 1.448, Global test accuracy: 59.02
Round  68, Train loss: 0.437, Test loss: 0.972, Test accuracy: 70.51
Round  68, Global train loss: 0.437, Global test loss: 1.438, Global test accuracy: 58.59
Round  69, Train loss: 0.546, Test loss: 0.989, Test accuracy: 70.56
Round  69, Global train loss: 0.546, Global test loss: 1.276, Global test accuracy: 59.11
Round  70, Train loss: 0.435, Test loss: 0.964, Test accuracy: 70.74
Round  70, Global train loss: 0.435, Global test loss: 1.271, Global test accuracy: 60.55
Round  71, Train loss: 0.496, Test loss: 0.934, Test accuracy: 71.49
Round  71, Global train loss: 0.496, Global test loss: 1.290, Global test accuracy: 58.30
Round  72, Train loss: 0.401, Test loss: 0.939, Test accuracy: 71.56
Round  72, Global train loss: 0.401, Global test loss: 1.254, Global test accuracy: 61.72
Round  73, Train loss: 0.449, Test loss: 0.950, Test accuracy: 71.29
Round  73, Global train loss: 0.449, Global test loss: 1.274, Global test accuracy: 61.36
Round  74, Train loss: 0.477, Test loss: 0.980, Test accuracy: 70.55
Round  74, Global train loss: 0.477, Global test loss: 1.273, Global test accuracy: 60.04
Round  75, Train loss: 0.440, Test loss: 0.989, Test accuracy: 70.61
Round  75, Global train loss: 0.440, Global test loss: 1.387, Global test accuracy: 59.62
Round  76, Train loss: 0.449, Test loss: 0.968, Test accuracy: 71.13
Round  76, Global train loss: 0.449, Global test loss: 1.216, Global test accuracy: 61.98
Round  77, Train loss: 0.439, Test loss: 0.949, Test accuracy: 71.59
Round  77, Global train loss: 0.439, Global test loss: 1.396, Global test accuracy: 57.99
Round  78, Train loss: 0.420, Test loss: 0.920, Test accuracy: 72.01
Round  78, Global train loss: 0.420, Global test loss: 1.243, Global test accuracy: 61.73
Round  79, Train loss: 0.427, Test loss: 0.907, Test accuracy: 72.44
Round  79, Global train loss: 0.427, Global test loss: 1.165, Global test accuracy: 62.78
Round  80, Train loss: 0.355, Test loss: 0.925, Test accuracy: 72.37
Round  80, Global train loss: 0.355, Global test loss: 1.228, Global test accuracy: 62.82
Round  81, Train loss: 0.351, Test loss: 0.914, Test accuracy: 72.40
Round  81, Global train loss: 0.351, Global test loss: 1.202, Global test accuracy: 64.01
Round  82, Train loss: 0.351, Test loss: 0.958, Test accuracy: 71.92
Round  82, Global train loss: 0.351, Global test loss: 1.296, Global test accuracy: 63.31
Round  83, Train loss: 0.368, Test loss: 0.956, Test accuracy: 72.14
Round  83, Global train loss: 0.368, Global test loss: 1.326, Global test accuracy: 61.26
Round  84, Train loss: 0.443, Test loss: 0.949, Test accuracy: 72.16
Round  84, Global train loss: 0.443, Global test loss: 1.300, Global test accuracy: 60.76
Round  85, Train loss: 0.378, Test loss: 0.947, Test accuracy: 72.31
Round  85, Global train loss: 0.378, Global test loss: 1.329, Global test accuracy: 61.42
Round  86, Train loss: 0.381, Test loss: 0.966, Test accuracy: 71.94
Round  86, Global train loss: 0.381, Global test loss: 1.332, Global test accuracy: 61.82
Round  87, Train loss: 0.408, Test loss: 0.978, Test accuracy: 72.09
Round  87, Global train loss: 0.408, Global test loss: 1.292, Global test accuracy: 61.81
Round  88, Train loss: 0.376, Test loss: 0.979, Test accuracy: 72.11
Round  88, Global train loss: 0.376, Global test loss: 1.453, Global test accuracy: 59.86
Round  89, Train loss: 0.368, Test loss: 0.981, Test accuracy: 71.92
Round  89, Global train loss: 0.368, Global test loss: 1.191, Global test accuracy: 64.06
Round  90, Train loss: 0.351, Test loss: 0.982, Test accuracy: 72.07
Round  90, Global train loss: 0.351, Global test loss: 1.376, Global test accuracy: 60.58
Round  91, Train loss: 0.344, Test loss: 0.993, Test accuracy: 71.97
Round  91, Global train loss: 0.344, Global test loss: 1.382, Global test accuracy: 61.08
Round  92, Train loss: 0.458, Test loss: 1.014, Test accuracy: 71.90
Round  92, Global train loss: 0.458, Global test loss: 1.362, Global test accuracy: 59.58
Round  93, Train loss: 0.349, Test loss: 1.005, Test accuracy: 72.30
Round  93, Global train loss: 0.349, Global test loss: 1.338, Global test accuracy: 62.56
Round  94, Train loss: 0.313, Test loss: 0.996, Test accuracy: 72.56
Round  94, Global train loss: 0.313, Global test loss: 1.345, Global test accuracy: 61.90
Round  95, Train loss: 0.293, Test loss: 0.993, Test accuracy: 72.90
Round  95, Global train loss: 0.293, Global test loss: 1.330, Global test accuracy: 63.49
Round  96, Train loss: 0.409, Test loss: 0.990, Test accuracy: 72.49
Round  96, Global train loss: 0.409, Global test loss: 1.239, Global test accuracy: 63.08
Round  97, Train loss: 0.492, Test loss: 1.012, Test accuracy: 72.17
Round  97, Global train loss: 0.492, Global test loss: 1.311, Global test accuracy: 59.33
Round  98, Train loss: 0.311, Test loss: 1.020, Test accuracy: 72.48
Round  98, Global train loss: 0.311, Global test loss: 1.232, Global test accuracy: 64.87
Round  99, Train loss: 0.371, Test loss: 1.006, Test accuracy: 72.50
Round  99, Global train loss: 0.371, Global test loss: 1.207, Global test accuracy: 63.74
Final Round, Train loss: 0.290, Test loss: 1.087, Test accuracy: 72.05
Final Round, Global train loss: 0.290, Global test loss: 1.207, Global test accuracy: 63.74
Average accuracy final 10 rounds: 72.334
Average global accuracy final 10 rounds: 62.021
2089.898152589798
[2.9160921573638916, 5.5613086223602295, 8.209167242050171, 10.869795560836792, 13.519840955734253, 16.17717933654785, 18.846039295196533, 21.50399136543274, 24.17781972885132, 26.855855464935303, 29.541120052337646, 32.23020124435425, 34.919646978378296, 37.585424184799194, 40.24544024467468, 42.92442512512207, 45.60041379928589, 48.26535248756409, 50.921276807785034, 53.570053577423096, 56.188743114471436, 58.801952838897705, 61.404874324798584, 64.03864479064941, 66.64026379585266, 69.25540733337402, 71.89167952537537, 74.49687838554382, 77.11132907867432, 79.72156000137329, 82.32438087463379, 84.94087362289429, 87.54555225372314, 90.16427803039551, 92.79529285430908, 95.4136700630188, 98.01189875602722, 100.62839484214783, 103.24671077728271, 105.86126112937927, 108.49475145339966, 111.12467837333679, 113.7560977935791, 116.35681080818176, 118.961172580719, 121.57046890258789, 124.17776203155518, 126.77734756469727, 129.39101457595825, 132.02479887008667, 134.63339829444885, 137.25376439094543, 139.87682127952576, 142.50581312179565, 145.13192200660706, 147.75814580917358, 150.37118124961853, 152.98534560203552, 155.6000416278839, 158.2124285697937, 160.81804943084717, 163.42303466796875, 166.03568577766418, 168.65062141418457, 171.25543761253357, 173.86547994613647, 176.4981939792633, 179.11328792572021, 181.71722412109375, 184.3323609828949, 186.9780662059784, 189.59619998931885, 192.21623921394348, 194.82018303871155, 197.43239736557007, 200.04848980903625, 202.6683943271637, 205.26814126968384, 207.89975881576538, 210.50303745269775, 213.11777782440186, 215.72440791130066, 218.33276081085205, 220.93187022209167, 223.54823756217957, 226.14798498153687, 228.7705807685852, 231.37374114990234, 233.98431968688965, 236.59235048294067, 239.19911289215088, 241.81744813919067, 244.43078136444092, 247.04797458648682, 249.6546618938446, 252.2867362499237, 254.90667867660522, 257.53465509414673, 260.15165424346924, 262.7758512496948, 267.59914994239807]
[17.41, 32.7, 37.65, 44.22, 48.16, 51.59, 52.95, 54.23, 54.33, 56.16, 56.67, 57.1, 58.79, 59.26, 60.04, 60.53, 61.14, 61.54, 61.82, 62.68, 63.65, 63.3, 64.07, 64.04, 63.77, 63.95, 64.76, 65.63, 65.4, 65.92, 66.41, 66.78, 66.94, 66.6, 66.69, 66.85, 66.97, 67.31, 67.13, 67.71, 67.78, 68.28, 68.43, 68.96, 68.92, 69.13, 69.67, 69.75, 69.95, 69.97, 69.67, 69.76, 69.96, 70.05, 70.27, 70.77, 70.94, 70.76, 70.31, 71.27, 70.98, 71.61, 71.4, 71.72, 71.38, 71.32, 71.1, 70.73, 70.51, 70.56, 70.74, 71.49, 71.56, 71.29, 70.55, 70.61, 71.13, 71.59, 72.01, 72.44, 72.37, 72.4, 71.92, 72.14, 72.16, 72.31, 71.94, 72.09, 72.11, 71.92, 72.07, 71.97, 71.9, 72.3, 72.56, 72.9, 72.49, 72.17, 72.48, 72.5, 72.05]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.1500
Round 1 global test acc  19.0800
Round 2 global test acc  21.8800
Round 3 global test acc  21.5500
Round 4 global test acc  26.4700
Round 5 global test acc  23.9800
Round 6 global test acc  21.4500
Round 7 global test acc  27.4600
Round 8 global test acc  27.5000
Round 9 global test acc  29.8800
Round 10 global test acc  34.5300
Round 11 global test acc  32.0300
Round 12 global test acc  36.2400
Round 13 global test acc  35.8900
Round 14 global test acc  30.2300
Round 15 global test acc  31.9600
Round 16 global test acc  35.6300
Round 17 global test acc  33.2100
Round 18 global test acc  38.4900
Round 19 global test acc  36.4200
Round 20 global test acc  43.9800
Round 21 global test acc  41.8700
Round 22 global test acc  34.0900
Round 23 global test acc  42.1900
Round 24 global test acc  35.2200
Round 25 global test acc  42.0800
Round 26 global test acc  33.0100
Round 27 global test acc  36.7600
Round 28 global test acc  34.2600
Round 29 global test acc  38.6200
Round 30 global test acc  37.6400
Round 31 global test acc  42.4100
Round 32 global test acc  34.7300
Round 33 global test acc  30.8400
Round 34 global test acc  31.5800
Round 35 global test acc  37.6400
Round 36 global test acc  46.0500
Round 37 global test acc  40.2500
Round 38 global test acc  43.6300
Round 39 global test acc  34.8300
Round 40 global test acc  42.7300
Round 41 global test acc  37.7500
Round 42 global test acc  36.0300
Round 43 global test acc  43.6200
Round 44 global test acc  44.5300
Round 45 global test acc  37.3200
Round 46 global test acc  34.8900
Round 47 global test acc  39.5700
Round 48 global test acc  41.7400
Round 49 global test acc  43.2200
Round 50 global test acc  41.7500
Round 51 global test acc  43.6900
Round 52 global test acc  42.4300
Round 53 global test acc  46.8200
Round 54 global test acc  44.7600
Round 55 global test acc  47.8200
Round 56 global test acc  39.9200
Round 57 global test acc  42.1100
Round 58 global test acc  48.4200
Round 59 global test acc  45.3900
Round 60 global test acc  40.6300
Round 61 global test acc  36.5300
Round 62 global test acc  41.4200
Round 63 global test acc  48.1600
Round 64 global test acc  43.1800
Round 65 global test acc  40.6000
Round 66 global test acc  39.2000
Round 67 global test acc  39.7400
Round 68 global test acc  43.6200
Round 69 global test acc  39.5200
Round 70 global test acc  46.5800
Round 71 global test acc  40.9800
Round 72 global test acc  45.5600
Round 73 global test acc  41.8500
Round 74 global test acc  38.8900
Round 75 global test acc  37.3900
Round 76 global test acc  49.4500
Round 77 global test acc  43.1100
Round 78 global test acc  43.9900
Round 79 global test acc  39.8200
Round 80 global test acc  38.5200
Round 81 global test acc  35.8000
Round 82 global test acc  32.1700
Round 83 global test acc  29.8100
Round 84 global test acc  28.6300
Round 85 global test acc  26.3400
Round 86 global test acc  24.5200
Round 87 global test acc  24.2000
Round 88 global test acc  24.3900
Round 89 global test acc  24.9200
Round 90 global test acc  24.6000
Round 91 global test acc  23.9600
Round 92 global test acc  24.0000
Round 93 global test acc  24.5200
Round 94 global test acc  24.4100
Round 95 global test acc  24.4100
Round 96 global test acc  23.7500
Round 97 global test acc  24.0300
Round 98 global test acc  23.7200
Round 99 global test acc  23.1500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.958, Test loss: 2.225, Test accuracy: 14.04
Round   1, Train loss: 1.599, Test loss: 1.949, Test accuracy: 28.26
Round   2, Train loss: 1.419, Test loss: 1.646, Test accuracy: 35.83
Round   3, Train loss: 1.301, Test loss: 1.441, Test accuracy: 43.28
Round   4, Train loss: 1.292, Test loss: 1.282, Test accuracy: 48.60
Round   5, Train loss: 1.174, Test loss: 1.225, Test accuracy: 51.74
Round   6, Train loss: 1.195, Test loss: 1.177, Test accuracy: 53.72
Round   7, Train loss: 1.186, Test loss: 1.170, Test accuracy: 54.77
Round   8, Train loss: 1.096, Test loss: 1.160, Test accuracy: 55.22
Round   9, Train loss: 1.087, Test loss: 1.070, Test accuracy: 56.95
Round  10, Train loss: 1.137, Test loss: 1.065, Test accuracy: 58.72
Round  11, Train loss: 1.009, Test loss: 1.042, Test accuracy: 58.80
Round  12, Train loss: 1.042, Test loss: 0.973, Test accuracy: 61.76
Round  13, Train loss: 0.986, Test loss: 0.963, Test accuracy: 62.31
Round  14, Train loss: 1.012, Test loss: 0.952, Test accuracy: 63.31
Round  15, Train loss: 0.964, Test loss: 0.922, Test accuracy: 64.13
Round  16, Train loss: 0.954, Test loss: 0.921, Test accuracy: 63.88
Round  17, Train loss: 0.976, Test loss: 0.917, Test accuracy: 64.21
Round  18, Train loss: 0.939, Test loss: 0.903, Test accuracy: 64.30
Round  19, Train loss: 0.886, Test loss: 0.903, Test accuracy: 64.40
Round  20, Train loss: 0.961, Test loss: 0.912, Test accuracy: 64.76
Round  21, Train loss: 0.902, Test loss: 0.884, Test accuracy: 65.42
Round  22, Train loss: 0.960, Test loss: 0.855, Test accuracy: 66.10
Round  23, Train loss: 0.937, Test loss: 0.841, Test accuracy: 66.94
Round  24, Train loss: 0.873, Test loss: 0.845, Test accuracy: 67.45
Round  25, Train loss: 0.888, Test loss: 0.832, Test accuracy: 67.74
Round  26, Train loss: 0.819, Test loss: 0.804, Test accuracy: 68.67
Round  27, Train loss: 0.845, Test loss: 0.808, Test accuracy: 68.75
Round  28, Train loss: 0.803, Test loss: 0.803, Test accuracy: 69.48
Round  29, Train loss: 0.816, Test loss: 0.801, Test accuracy: 69.54
Round  30, Train loss: 0.806, Test loss: 0.792, Test accuracy: 69.66
Round  31, Train loss: 0.787, Test loss: 0.783, Test accuracy: 69.56
Round  32, Train loss: 0.754, Test loss: 0.777, Test accuracy: 69.77
Round  33, Train loss: 0.882, Test loss: 0.768, Test accuracy: 70.52
Round  34, Train loss: 0.747, Test loss: 0.774, Test accuracy: 70.27
Round  35, Train loss: 0.868, Test loss: 0.761, Test accuracy: 70.82
Round  36, Train loss: 0.779, Test loss: 0.762, Test accuracy: 70.96
Round  37, Train loss: 0.760, Test loss: 0.757, Test accuracy: 71.02
Round  38, Train loss: 0.739, Test loss: 0.760, Test accuracy: 70.95
Round  39, Train loss: 0.762, Test loss: 0.745, Test accuracy: 71.60
Round  40, Train loss: 0.713, Test loss: 0.740, Test accuracy: 71.87
Round  41, Train loss: 0.708, Test loss: 0.739, Test accuracy: 71.29
Round  42, Train loss: 0.705, Test loss: 0.733, Test accuracy: 71.76
Round  43, Train loss: 0.745, Test loss: 0.727, Test accuracy: 71.77
Round  44, Train loss: 0.707, Test loss: 0.713, Test accuracy: 72.51
Round  45, Train loss: 0.675, Test loss: 0.714, Test accuracy: 72.99
Round  46, Train loss: 0.698, Test loss: 0.711, Test accuracy: 72.74
Round  47, Train loss: 0.747, Test loss: 0.705, Test accuracy: 73.04
Round  48, Train loss: 0.697, Test loss: 0.700, Test accuracy: 73.14
Round  49, Train loss: 0.689, Test loss: 0.689, Test accuracy: 73.41
Round  50, Train loss: 0.694, Test loss: 0.693, Test accuracy: 73.54
Round  51, Train loss: 0.609, Test loss: 0.695, Test accuracy: 73.67
Round  52, Train loss: 0.700, Test loss: 0.693, Test accuracy: 73.00
Round  53, Train loss: 0.685, Test loss: 0.682, Test accuracy: 73.83
Round  54, Train loss: 0.604, Test loss: 0.673, Test accuracy: 74.27
Round  55, Train loss: 0.679, Test loss: 0.672, Test accuracy: 74.38
Round  56, Train loss: 0.628, Test loss: 0.677, Test accuracy: 74.05
Round  57, Train loss: 0.613, Test loss: 0.678, Test accuracy: 74.26
Round  58, Train loss: 0.595, Test loss: 0.671, Test accuracy: 74.38
Round  59, Train loss: 0.626, Test loss: 0.669, Test accuracy: 74.86
Round  60, Train loss: 0.591, Test loss: 0.682, Test accuracy: 74.29
Round  61, Train loss: 0.594, Test loss: 0.675, Test accuracy: 74.46
Round  62, Train loss: 0.676, Test loss: 0.668, Test accuracy: 74.57
Round  63, Train loss: 0.604, Test loss: 0.669, Test accuracy: 74.80
Round  64, Train loss: 0.603, Test loss: 0.667, Test accuracy: 74.89
Round  65, Train loss: 0.540, Test loss: 0.665, Test accuracy: 75.08
Round  66, Train loss: 0.567, Test loss: 0.663, Test accuracy: 75.20
Round  67, Train loss: 0.492, Test loss: 0.670, Test accuracy: 74.83
Round  68, Train loss: 0.500, Test loss: 0.671, Test accuracy: 75.16
Round  69, Train loss: 0.637, Test loss: 0.674, Test accuracy: 74.59
Round  70, Train loss: 0.515, Test loss: 0.659, Test accuracy: 75.13
Round  71, Train loss: 0.537, Test loss: 0.660, Test accuracy: 75.11
Round  72, Train loss: 0.564, Test loss: 0.668, Test accuracy: 74.97
Round  73, Train loss: 0.519, Test loss: 0.662, Test accuracy: 75.01
Round  74, Train loss: 0.586, Test loss: 0.668, Test accuracy: 75.06
Round  75, Train loss: 0.588, Test loss: 0.654, Test accuracy: 75.27
Round  76, Train loss: 0.540, Test loss: 0.653, Test accuracy: 75.77
Round  77, Train loss: 0.521, Test loss: 0.650, Test accuracy: 75.66
Round  78, Train loss: 0.548, Test loss: 0.644, Test accuracy: 75.87
Round  79, Train loss: 0.529, Test loss: 0.654, Test accuracy: 75.84
Round  80, Train loss: 0.523, Test loss: 0.642, Test accuracy: 76.01
Round  81, Train loss: 0.539, Test loss: 0.652, Test accuracy: 76.15
Round  82, Train loss: 0.494, Test loss: 0.661, Test accuracy: 75.75
Round  83, Train loss: 0.490, Test loss: 0.663, Test accuracy: 75.36
Round  84, Train loss: 0.464, Test loss: 0.656, Test accuracy: 75.72
Round  85, Train loss: 0.572, Test loss: 0.659, Test accuracy: 75.89
Round  86, Train loss: 0.487, Test loss: 0.659, Test accuracy: 75.72
Round  87, Train loss: 0.473, Test loss: 0.650, Test accuracy: 76.17
Round  88, Train loss: 0.443, Test loss: 0.671, Test accuracy: 75.28
Round  89, Train loss: 0.407, Test loss: 0.664, Test accuracy: 75.35
Round  90, Train loss: 0.510, Test loss: 0.654, Test accuracy: 75.68
Round  91, Train loss: 0.438, Test loss: 0.665, Test accuracy: 75.53
Round  92, Train loss: 0.488, Test loss: 0.658, Test accuracy: 75.51
Round  93, Train loss: 0.477, Test loss: 0.660, Test accuracy: 75.92
Round  94, Train loss: 0.453, Test loss: 0.648, Test accuracy: 76.36
Round  95, Train loss: 0.433, Test loss: 0.654, Test accuracy: 75.99
Round  96, Train loss: 0.502, Test loss: 0.644, Test accuracy: 76.44
Round  97, Train loss: 0.476, Test loss: 0.653, Test accuracy: 75.90
Round  98, Train loss: 0.457, Test loss: 0.654, Test accuracy: 76.38
Round  99, Train loss: 0.465, Test loss: 0.657, Test accuracy: 75.85
Final Round, Train loss: 0.406, Test loss: 0.657, Test accuracy: 76.01
Average accuracy final 10 rounds: 75.956
1051.8086125850677
[1.7111454010009766, 3.0792505741119385, 4.461021423339844, 5.849821329116821, 7.230928182601929, 8.626588344573975, 10.006802082061768, 11.383073568344116, 12.75899362564087, 14.114436149597168, 15.46416425704956, 16.82789921760559, 18.20213270187378, 19.57140064239502, 20.9506893157959, 22.305437564849854, 23.67183518409729, 25.037704706192017, 26.393337965011597, 27.76519227027893, 29.144153594970703, 30.521753072738647, 31.889196157455444, 33.25981521606445, 34.63524580001831, 36.00824785232544, 37.396310806274414, 38.770495653152466, 40.14074993133545, 41.51429009437561, 42.86256384849548, 44.218103885650635, 45.57160782814026, 46.940094232559204, 48.31498718261719, 49.6824266910553, 51.055296897888184, 52.42669630050659, 53.794270277023315, 55.14079284667969, 56.49923086166382, 57.85765790939331, 59.23565220832825, 60.49824070930481, 61.8215069770813, 63.13693046569824, 64.46828532218933, 65.78756332397461, 67.1523642539978, 68.40651178359985, 69.73041319847107, 71.06500244140625, 72.3975203037262, 73.72643113136292, 75.05292773246765, 76.36607503890991, 77.68533325195312, 78.99973249435425, 80.32078337669373, 81.64200258255005, 82.95502972602844, 84.27972435951233, 85.61555337905884, 86.94734144210815, 88.26609778404236, 89.59389066696167, 90.93504452705383, 92.26403069496155, 93.6048035621643, 94.92909169197083, 96.25872588157654, 97.62416768074036, 98.9805953502655, 100.31218075752258, 101.63198471069336, 102.96841621398926, 104.31487894058228, 105.65864968299866, 107.00012111663818, 108.32971811294556, 109.63049793243408, 110.9622311592102, 112.29361248016357, 113.61394000053406, 114.94701170921326, 116.28717851638794, 117.61843371391296, 118.95392990112305, 120.29568886756897, 121.62735152244568, 122.96596622467041, 124.30720567703247, 125.63992691040039, 126.9676365852356, 128.3011338710785, 129.6492576599121, 130.98386669158936, 132.31296634674072, 133.64085173606873, 134.9706802368164, 136.93042302131653]
[14.04, 28.26, 35.83, 43.28, 48.6, 51.74, 53.72, 54.77, 55.22, 56.95, 58.72, 58.8, 61.76, 62.31, 63.31, 64.13, 63.88, 64.21, 64.3, 64.4, 64.76, 65.42, 66.1, 66.94, 67.45, 67.74, 68.67, 68.75, 69.48, 69.54, 69.66, 69.56, 69.77, 70.52, 70.27, 70.82, 70.96, 71.02, 70.95, 71.6, 71.87, 71.29, 71.76, 71.77, 72.51, 72.99, 72.74, 73.04, 73.14, 73.41, 73.54, 73.67, 73.0, 73.83, 74.27, 74.38, 74.05, 74.26, 74.38, 74.86, 74.29, 74.46, 74.57, 74.8, 74.89, 75.08, 75.2, 74.83, 75.16, 74.59, 75.13, 75.11, 74.97, 75.01, 75.06, 75.27, 75.77, 75.66, 75.87, 75.84, 76.01, 76.15, 75.75, 75.36, 75.72, 75.89, 75.72, 76.17, 75.28, 75.35, 75.68, 75.53, 75.51, 75.92, 76.36, 75.99, 76.44, 75.9, 76.38, 75.85, 76.01]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.732, Test loss: 2.229, Test accuracy: 16.32
Round   1, Train loss: 1.382, Test loss: 1.832, Test accuracy: 30.05
Round   2, Train loss: 1.214, Test loss: 1.527, Test accuracy: 39.67
Round   3, Train loss: 1.144, Test loss: 1.316, Test accuracy: 47.18
Round   4, Train loss: 1.037, Test loss: 1.185, Test accuracy: 53.02
Round   5, Train loss: 1.030, Test loss: 1.116, Test accuracy: 54.68
Round   6, Train loss: 1.020, Test loss: 1.101, Test accuracy: 56.57
Round   7, Train loss: 1.037, Test loss: 1.101, Test accuracy: 57.34
Round   8, Train loss: 0.943, Test loss: 1.093, Test accuracy: 57.83
Round   9, Train loss: 0.965, Test loss: 0.969, Test accuracy: 61.63
Round  10, Train loss: 0.905, Test loss: 0.980, Test accuracy: 61.72
Round  11, Train loss: 0.824, Test loss: 0.949, Test accuracy: 63.48
Round  12, Train loss: 0.896, Test loss: 0.873, Test accuracy: 65.49
Round  13, Train loss: 0.811, Test loss: 0.856, Test accuracy: 66.55
Round  14, Train loss: 0.712, Test loss: 0.837, Test accuracy: 67.52
Round  15, Train loss: 0.767, Test loss: 0.830, Test accuracy: 67.51
Round  16, Train loss: 0.640, Test loss: 0.809, Test accuracy: 68.81
Round  17, Train loss: 0.801, Test loss: 0.802, Test accuracy: 68.47
Round  18, Train loss: 0.679, Test loss: 0.769, Test accuracy: 70.12
Round  19, Train loss: 0.649, Test loss: 0.772, Test accuracy: 70.02
Round  20, Train loss: 0.695, Test loss: 0.752, Test accuracy: 70.90
Round  21, Train loss: 0.583, Test loss: 0.736, Test accuracy: 72.09
Round  22, Train loss: 0.673, Test loss: 0.720, Test accuracy: 72.87
Round  23, Train loss: 0.677, Test loss: 0.712, Test accuracy: 73.15
Round  24, Train loss: 0.626, Test loss: 0.711, Test accuracy: 72.81
Round  25, Train loss: 0.687, Test loss: 0.722, Test accuracy: 73.06
Round  26, Train loss: 0.582, Test loss: 0.687, Test accuracy: 74.82
Round  27, Train loss: 0.599, Test loss: 0.688, Test accuracy: 74.74
Round  28, Train loss: 0.520, Test loss: 0.698, Test accuracy: 73.89
Round  29, Train loss: 0.536, Test loss: 0.709, Test accuracy: 73.69
Round  30, Train loss: 0.512, Test loss: 0.691, Test accuracy: 74.45
Round  31, Train loss: 0.514, Test loss: 0.692, Test accuracy: 74.45
Round  32, Train loss: 0.499, Test loss: 0.703, Test accuracy: 73.98
Round  33, Train loss: 0.617, Test loss: 0.690, Test accuracy: 74.20
Round  34, Train loss: 0.463, Test loss: 0.693, Test accuracy: 74.67
Round  35, Train loss: 0.518, Test loss: 0.683, Test accuracy: 74.80
Round  36, Train loss: 0.482, Test loss: 0.714, Test accuracy: 73.84
Round  37, Train loss: 0.497, Test loss: 0.694, Test accuracy: 74.42
Round  38, Train loss: 0.426, Test loss: 0.691, Test accuracy: 75.07
Round  39, Train loss: 0.473, Test loss: 0.677, Test accuracy: 75.54
Round  40, Train loss: 0.454, Test loss: 0.686, Test accuracy: 75.31
Round  41, Train loss: 0.458, Test loss: 0.662, Test accuracy: 75.78
Round  42, Train loss: 0.352, Test loss: 0.670, Test accuracy: 75.73
Round  43, Train loss: 0.467, Test loss: 0.677, Test accuracy: 75.51
Round  44, Train loss: 0.533, Test loss: 0.685, Test accuracy: 75.33
Round  45, Train loss: 0.381, Test loss: 0.696, Test accuracy: 75.12
Round  46, Train loss: 0.448, Test loss: 0.674, Test accuracy: 75.62
Round  47, Train loss: 0.446, Test loss: 0.678, Test accuracy: 75.81
Round  48, Train loss: 0.452, Test loss: 0.678, Test accuracy: 76.28
Round  49, Train loss: 0.481, Test loss: 0.675, Test accuracy: 76.11
Round  50, Train loss: 0.420, Test loss: 0.677, Test accuracy: 76.25
Round  51, Train loss: 0.345, Test loss: 0.669, Test accuracy: 76.74
Round  52, Train loss: 0.421, Test loss: 0.675, Test accuracy: 76.44
Round  53, Train loss: 0.425, Test loss: 0.681, Test accuracy: 76.56
Round  54, Train loss: 0.370, Test loss: 0.668, Test accuracy: 76.82
Round  55, Train loss: 0.408, Test loss: 0.666, Test accuracy: 76.76
Round  56, Train loss: 0.379, Test loss: 0.679, Test accuracy: 76.90
Round  57, Train loss: 0.390, Test loss: 0.675, Test accuracy: 76.69
Round  58, Train loss: 0.329, Test loss: 0.664, Test accuracy: 77.04
Round  59, Train loss: 0.350, Test loss: 0.681, Test accuracy: 76.67
Round  60, Train loss: 0.298, Test loss: 0.674, Test accuracy: 76.61
Round  61, Train loss: 0.303, Test loss: 0.689, Test accuracy: 76.65
Round  62, Train loss: 0.389, Test loss: 0.692, Test accuracy: 76.54
Round  63, Train loss: 0.350, Test loss: 0.693, Test accuracy: 76.79
Round  64, Train loss: 0.354, Test loss: 0.699, Test accuracy: 76.11
Round  65, Train loss: 0.366, Test loss: 0.692, Test accuracy: 76.22
Round  66, Train loss: 0.318, Test loss: 0.699, Test accuracy: 76.14
Round  67, Train loss: 0.274, Test loss: 0.706, Test accuracy: 76.32
Round  68, Train loss: 0.255, Test loss: 0.708, Test accuracy: 76.25
Round  69, Train loss: 0.406, Test loss: 0.698, Test accuracy: 76.32
Round  70, Train loss: 0.321, Test loss: 0.689, Test accuracy: 76.72
Round  71, Train loss: 0.351, Test loss: 0.710, Test accuracy: 76.42
Round  72, Train loss: 0.267, Test loss: 0.692, Test accuracy: 76.68
Round  73, Train loss: 0.283, Test loss: 0.692, Test accuracy: 77.16
Round  74, Train loss: 0.313, Test loss: 0.696, Test accuracy: 76.73
Round  75, Train loss: 0.325, Test loss: 0.713, Test accuracy: 76.45
Round  76, Train loss: 0.346, Test loss: 0.717, Test accuracy: 76.48
Round  77, Train loss: 0.337, Test loss: 0.724, Test accuracy: 76.05
Round  78, Train loss: 0.276, Test loss: 0.698, Test accuracy: 77.17
Round  79, Train loss: 0.371, Test loss: 0.710, Test accuracy: 77.02
Round  80, Train loss: 0.271, Test loss: 0.717, Test accuracy: 76.51
Round  81, Train loss: 0.274, Test loss: 0.726, Test accuracy: 76.66
Round  82, Train loss: 0.268, Test loss: 0.717, Test accuracy: 76.69
Round  83, Train loss: 0.262, Test loss: 0.719, Test accuracy: 76.28
Round  84, Train loss: 0.302, Test loss: 0.710, Test accuracy: 76.66
Round  85, Train loss: 0.283, Test loss: 0.704, Test accuracy: 76.75
Round  86, Train loss: 0.210, Test loss: 0.709, Test accuracy: 76.67
Round  87, Train loss: 0.284, Test loss: 0.719, Test accuracy: 76.86
Round  88, Train loss: 0.243, Test loss: 0.723, Test accuracy: 76.81
Round  89, Train loss: 0.257, Test loss: 0.726, Test accuracy: 77.16
Round  90, Train loss: 0.239, Test loss: 0.721, Test accuracy: 77.24
Round  91, Train loss: 0.244, Test loss: 0.744, Test accuracy: 76.52
Round  92, Train loss: 0.306, Test loss: 0.721, Test accuracy: 77.00
Round  93, Train loss: 0.229, Test loss: 0.716, Test accuracy: 76.95
Round  94, Train loss: 0.221, Test loss: 0.714, Test accuracy: 77.49
Round  95, Train loss: 0.206, Test loss: 0.719, Test accuracy: 77.04
Round  96, Train loss: 0.245, Test loss: 0.707, Test accuracy: 77.14
Round  97, Train loss: 0.303, Test loss: 0.726, Test accuracy: 76.98
Round  98, Train loss: 0.222, Test loss: 0.720, Test accuracy: 77.02
Round  99, Train loss: 0.280, Test loss: 0.720, Test accuracy: 76.93
Final Round, Train loss: 0.242, Test loss: 0.707, Test accuracy: 77.52
Average accuracy final 10 rounds: 77.03099999999999
2365.9667315483093
[2.849642038345337, 5.3804030418396, 7.911046743392944, 10.4335777759552, 12.956664800643921, 15.483100414276123, 17.99339771270752, 20.493876934051514, 22.99845576286316, 25.502506971359253, 28.003695964813232, 30.50970458984375, 33.018502712249756, 35.52740836143494, 38.03363823890686, 40.54097294807434, 43.048389196395874, 45.5619535446167, 48.072898864746094, 50.58316993713379, 52.8192822933197, 56.530937910079956, 60.2287859916687, 63.9181764125824, 67.61173295974731, 71.30844354629517, 75.00876641273499, 78.70699667930603, 82.40436124801636, 86.10152840614319, 89.80702686309814, 93.51950240135193, 97.23806667327881, 101.00565600395203, 104.72539782524109, 108.43091940879822, 112.13820481300354, 115.83561873435974, 119.54585909843445, 123.2523148059845, 126.96761322021484, 130.67538261413574, 134.42333054542542, 138.16780424118042, 141.90849590301514, 145.65060806274414, 149.39864420890808, 153.14169478416443, 156.85391998291016, 160.59748816490173, 164.34600973129272, 168.09375166893005, 171.80262565612793, 175.548401594162, 179.29579973220825, 183.0415334701538, 186.78292298316956, 190.55538773536682, 194.3052146434784, 198.0567421913147, 201.80850839614868, 205.55735611915588, 209.33338975906372, 213.09448385238647, 216.8160274028778, 220.52861380577087, 224.27785778045654, 228.0324149131775, 231.79945611953735, 235.5498764514923, 239.3543586730957, 243.104918718338, 246.85749006271362, 250.61024379730225, 254.35416650772095, 258.108540058136, 261.92052006721497, 265.67265224456787, 269.4127721786499, 273.1526038646698, 276.88606238365173, 280.63255047798157, 284.3751411437988, 288.1168670654297, 291.82671070098877, 295.57976388931274, 299.3181891441345, 303.0568964481354, 306.79670333862305, 310.53503012657166, 314.2672367095947, 318.00237369537354, 321.7184510231018, 325.4532458782196, 329.1774899959564, 332.8903377056122, 336.63916301727295, 340.371639251709, 344.16817593574524, 347.9415092468262, 351.7476692199707]
[16.32, 30.05, 39.67, 47.18, 53.02, 54.68, 56.57, 57.34, 57.83, 61.63, 61.72, 63.48, 65.49, 66.55, 67.52, 67.51, 68.81, 68.47, 70.12, 70.02, 70.9, 72.09, 72.87, 73.15, 72.81, 73.06, 74.82, 74.74, 73.89, 73.69, 74.45, 74.45, 73.98, 74.2, 74.67, 74.8, 73.84, 74.42, 75.07, 75.54, 75.31, 75.78, 75.73, 75.51, 75.33, 75.12, 75.62, 75.81, 76.28, 76.11, 76.25, 76.74, 76.44, 76.56, 76.82, 76.76, 76.9, 76.69, 77.04, 76.67, 76.61, 76.65, 76.54, 76.79, 76.11, 76.22, 76.14, 76.32, 76.25, 76.32, 76.72, 76.42, 76.68, 77.16, 76.73, 76.45, 76.48, 76.05, 77.17, 77.02, 76.51, 76.66, 76.69, 76.28, 76.66, 76.75, 76.67, 76.86, 76.81, 77.16, 77.24, 76.52, 77.0, 76.95, 77.49, 77.04, 77.14, 76.98, 77.02, 76.93, 77.52]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.745, Test loss: 1.713, Test accuracy: 37.57
Round   1, Train loss: 1.395, Test loss: 1.296, Test accuracy: 45.38
Round   2, Train loss: 1.238, Test loss: 1.172, Test accuracy: 50.49
Round   3, Train loss: 1.155, Test loss: 1.078, Test accuracy: 57.48
Round   4, Train loss: 1.097, Test loss: 1.024, Test accuracy: 58.60
Round   5, Train loss: 1.053, Test loss: 1.014, Test accuracy: 59.86
Round   6, Train loss: 1.020, Test loss: 0.976, Test accuracy: 60.93
Round   7, Train loss: 0.984, Test loss: 0.922, Test accuracy: 63.78
Round   8, Train loss: 0.953, Test loss: 0.902, Test accuracy: 65.34
Round   9, Train loss: 0.924, Test loss: 0.895, Test accuracy: 64.76
Round  10, Train loss: 0.896, Test loss: 0.850, Test accuracy: 66.93
Round  11, Train loss: 0.870, Test loss: 0.832, Test accuracy: 67.77
Round  12, Train loss: 0.841, Test loss: 0.814, Test accuracy: 68.30
Round  13, Train loss: 0.818, Test loss: 0.796, Test accuracy: 68.97
Round  14, Train loss: 0.795, Test loss: 0.802, Test accuracy: 68.75
Round  15, Train loss: 0.773, Test loss: 0.772, Test accuracy: 70.62
Round  16, Train loss: 0.753, Test loss: 0.768, Test accuracy: 70.27
Round  17, Train loss: 0.734, Test loss: 0.742, Test accuracy: 71.40
Round  18, Train loss: 0.716, Test loss: 0.754, Test accuracy: 71.08
Round  19, Train loss: 0.698, Test loss: 0.751, Test accuracy: 71.70
Round  20, Train loss: 0.685, Test loss: 0.761, Test accuracy: 71.48
Round  21, Train loss: 0.537, Test loss: 0.753, Test accuracy: 71.89
Round  22, Train loss: 0.757, Test loss: 0.764, Test accuracy: 71.87
Round  23, Train loss: 0.655, Test loss: 0.770, Test accuracy: 71.29
Round  24, Train loss: 0.608, Test loss: 0.762, Test accuracy: 71.69
Round  25, Train loss: 0.644, Test loss: 0.759, Test accuracy: 71.78
Round  26, Train loss: 0.578, Test loss: 0.740, Test accuracy: 72.24
Round  27, Train loss: 0.571, Test loss: 0.739, Test accuracy: 72.73
Round  28, Train loss: 0.589, Test loss: 0.744, Test accuracy: 72.27
Round  29, Train loss: 0.520, Test loss: 0.735, Test accuracy: 72.34
Round  30, Train loss: 0.589, Test loss: 0.721, Test accuracy: 73.36
Round  31, Train loss: 0.457, Test loss: 0.721, Test accuracy: 73.20
Round  32, Train loss: 0.495, Test loss: 0.725, Test accuracy: 73.41
Round  33, Train loss: 0.541, Test loss: 0.740, Test accuracy: 73.05
Round  34, Train loss: 0.571, Test loss: 0.717, Test accuracy: 74.19
Round  35, Train loss: 0.530, Test loss: 0.729, Test accuracy: 73.61
Round  36, Train loss: 0.510, Test loss: 0.743, Test accuracy: 73.19
Round  37, Train loss: 0.521, Test loss: 0.740, Test accuracy: 73.43
Round  38, Train loss: 0.519, Test loss: 0.739, Test accuracy: 73.20
Round  39, Train loss: 0.475, Test loss: 0.745, Test accuracy: 73.51
Round  40, Train loss: 0.478, Test loss: 0.743, Test accuracy: 73.72
Round  41, Train loss: 0.423, Test loss: 0.720, Test accuracy: 74.18
Round  42, Train loss: 0.369, Test loss: 0.722, Test accuracy: 73.78
Round  43, Train loss: 0.498, Test loss: 0.732, Test accuracy: 74.13
Round  44, Train loss: 0.529, Test loss: 0.727, Test accuracy: 74.17
Round  45, Train loss: 0.452, Test loss: 0.735, Test accuracy: 74.02
Round  46, Train loss: 0.437, Test loss: 0.713, Test accuracy: 74.69
Round  47, Train loss: 0.429, Test loss: 0.712, Test accuracy: 75.48
Round  48, Train loss: 0.472, Test loss: 0.714, Test accuracy: 74.85
Round  49, Train loss: 0.460, Test loss: 0.700, Test accuracy: 75.50
Round  50, Train loss: 0.389, Test loss: 0.731, Test accuracy: 74.62
Round  51, Train loss: 0.379, Test loss: 0.721, Test accuracy: 74.93
Round  52, Train loss: 0.450, Test loss: 0.726, Test accuracy: 74.80
Round  53, Train loss: 0.419, Test loss: 0.722, Test accuracy: 75.06
Round  54, Train loss: 0.376, Test loss: 0.711, Test accuracy: 75.75
Round  55, Train loss: 0.450, Test loss: 0.719, Test accuracy: 75.56
Round  56, Train loss: 0.374, Test loss: 0.750, Test accuracy: 74.61
Round  57, Train loss: 0.402, Test loss: 0.735, Test accuracy: 75.28
Round  58, Train loss: 0.324, Test loss: 0.744, Test accuracy: 75.22
Round  59, Train loss: 0.344, Test loss: 0.738, Test accuracy: 74.99
Round  60, Train loss: 0.363, Test loss: 0.736, Test accuracy: 75.29
Round  61, Train loss: 0.344, Test loss: 0.739, Test accuracy: 75.34
Round  62, Train loss: 0.338, Test loss: 0.733, Test accuracy: 75.34
Round  63, Train loss: 0.323, Test loss: 0.726, Test accuracy: 75.73
Round  64, Train loss: 0.371, Test loss: 0.750, Test accuracy: 75.00
Round  65, Train loss: 0.381, Test loss: 0.758, Test accuracy: 75.09
Round  66, Train loss: 0.303, Test loss: 0.765, Test accuracy: 75.16
Round  67, Train loss: 0.286, Test loss: 0.767, Test accuracy: 74.99
Round  68, Train loss: 0.321, Test loss: 0.774, Test accuracy: 74.67
Round  69, Train loss: 0.436, Test loss: 0.746, Test accuracy: 75.08
Round  70, Train loss: 0.327, Test loss: 0.743, Test accuracy: 75.92
Round  71, Train loss: 0.348, Test loss: 0.774, Test accuracy: 74.99
Round  72, Train loss: 0.314, Test loss: 0.774, Test accuracy: 74.67
Round  73, Train loss: 0.269, Test loss: 0.764, Test accuracy: 75.06
Round  74, Train loss: 0.312, Test loss: 0.771, Test accuracy: 74.78
Round  75, Train loss: 0.300, Test loss: 0.779, Test accuracy: 75.06
Round  76, Train loss: 0.308, Test loss: 0.772, Test accuracy: 75.30
Round  77, Train loss: 0.292, Test loss: 0.781, Test accuracy: 74.63
Round  78, Train loss: 0.319, Test loss: 0.775, Test accuracy: 74.79
Round  79, Train loss: 0.337, Test loss: 0.786, Test accuracy: 74.75
Round  80, Train loss: 0.296, Test loss: 0.732, Test accuracy: 76.32
Round  81, Train loss: 0.284, Test loss: 0.764, Test accuracy: 75.63
Round  82, Train loss: 0.280, Test loss: 0.750, Test accuracy: 75.81
Round  83, Train loss: 0.280, Test loss: 0.761, Test accuracy: 76.05
Round  84, Train loss: 0.275, Test loss: 0.751, Test accuracy: 75.84
Round  85, Train loss: 0.269, Test loss: 0.768, Test accuracy: 75.74
Round  86, Train loss: 0.268, Test loss: 0.763, Test accuracy: 75.61
Round  87, Train loss: 0.264, Test loss: 0.769, Test accuracy: 75.69
Round  88, Train loss: 0.258, Test loss: 0.759, Test accuracy: 75.87
Round  89, Train loss: 0.263, Test loss: 0.758, Test accuracy: 75.93
Round  90, Train loss: 0.254, Test loss: 0.769, Test accuracy: 75.95
Round  91, Train loss: 0.255, Test loss: 0.768, Test accuracy: 76.04
Round  92, Train loss: 0.256, Test loss: 0.792, Test accuracy: 75.84
Round  93, Train loss: 0.244, Test loss: 0.774, Test accuracy: 75.95
Round  94, Train loss: 0.243, Test loss: 0.788, Test accuracy: 75.55
Round  95, Train loss: 0.243, Test loss: 0.797, Test accuracy: 75.52
Round  96, Train loss: 0.245, Test loss: 0.772, Test accuracy: 76.07
Round  97, Train loss: 0.242, Test loss: 0.806, Test accuracy: 75.27
Round  98, Train loss: 0.239, Test loss: 0.787, Test accuracy: 75.51
Round  99, Train loss: 0.238, Test loss: 0.797, Test accuracy: 75.73
Final Round, Train loss: 0.205, Test loss: 0.786, Test accuracy: 75.95
Average accuracy final 10 rounds: 75.743
3109.6114456653595
[2.9575629234313965, 5.7032856941223145, 8.453014135360718, 11.216568231582642, 13.97235631942749, 16.724026203155518, 19.477720260620117, 21.84616231918335, 24.214173555374146, 26.580346822738647, 28.947834968566895, 31.315463066101074, 33.68393278121948, 36.05503177642822, 38.41963982582092, 40.78952884674072, 43.16088676452637, 45.52888798713684, 47.931134939193726, 50.325947523117065, 52.70337510108948, 55.082170248031616, 57.46200704574585, 59.84313774108887, 62.227219343185425, 64.59722948074341, 66.96837067604065, 69.34760570526123, 71.72277021408081, 74.09318399429321, 76.460458278656, 78.82580137252808, 81.20872712135315, 83.58872532844543, 85.96448707580566, 88.34521913528442, 90.72131276130676, 93.10612463951111, 95.4873640537262, 97.86483550071716, 100.24982714653015, 102.63191270828247, 105.01088762283325, 107.39291191101074, 109.76746273040771, 112.13605380058289, 114.51279664039612, 116.8969361782074, 119.2837381362915, 121.67379689216614, 124.06123328208923, 126.45298886299133, 128.8349094390869, 131.2251901626587, 133.60913491249084, 135.98639154434204, 138.37590861320496, 140.75974345207214, 143.14257836341858, 145.52368259429932, 147.90834379196167, 150.2873079776764, 152.6783092021942, 155.06393241882324, 157.4484736919403, 159.8295931816101, 162.2129409313202, 164.59312105178833, 166.9752073287964, 169.3595108985901, 171.74310564994812, 174.12769174575806, 176.51243090629578, 178.8950114250183, 181.27694725990295, 183.66243839263916, 186.04592967033386, 188.4313690662384, 190.81562089920044, 193.20074558258057, 195.58648252487183, 197.9686815738678, 200.35525131225586, 202.74316930770874, 205.12386512756348, 207.4887397289276, 209.95851731300354, 212.37039875984192, 214.7941484451294, 217.1687216758728, 219.54738664627075, 221.92250061035156, 224.30461406707764, 226.6981384754181, 229.06957483291626, 231.44039273262024, 233.81008553504944, 236.1876883506775, 238.92921614646912, 241.70235133171082, 245.80016803741455]
[37.57, 45.38, 50.49, 57.48, 58.6, 59.86, 60.93, 63.78, 65.34, 64.76, 66.93, 67.77, 68.3, 68.97, 68.75, 70.62, 70.27, 71.4, 71.08, 71.7, 71.48, 71.89, 71.87, 71.29, 71.69, 71.78, 72.24, 72.73, 72.27, 72.34, 73.36, 73.2, 73.41, 73.05, 74.19, 73.61, 73.19, 73.43, 73.2, 73.51, 73.72, 74.18, 73.78, 74.13, 74.17, 74.02, 74.69, 75.48, 74.85, 75.5, 74.62, 74.93, 74.8, 75.06, 75.75, 75.56, 74.61, 75.28, 75.22, 74.99, 75.29, 75.34, 75.34, 75.73, 75.0, 75.09, 75.16, 74.99, 74.67, 75.08, 75.92, 74.99, 74.67, 75.06, 74.78, 75.06, 75.3, 74.63, 74.79, 74.75, 76.32, 75.63, 75.81, 76.05, 75.84, 75.74, 75.61, 75.69, 75.87, 75.93, 75.95, 76.04, 75.84, 75.95, 75.55, 75.52, 76.07, 75.27, 75.51, 75.73, 75.95]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.722, Test loss: 1.651, Test accuracy: 38.92
Round   1, Train loss: 1.376, Test loss: 1.270, Test accuracy: 46.79
Round   2, Train loss: 1.218, Test loss: 1.151, Test accuracy: 51.63
Round   3, Train loss: 1.135, Test loss: 1.072, Test accuracy: 56.92
Round   4, Train loss: 1.089, Test loss: 1.035, Test accuracy: 58.80
Round   5, Train loss: 1.044, Test loss: 1.000, Test accuracy: 59.86
Round   6, Train loss: 1.005, Test loss: 0.960, Test accuracy: 62.20
Round   7, Train loss: 0.970, Test loss: 0.926, Test accuracy: 63.72
Round   8, Train loss: 0.941, Test loss: 0.908, Test accuracy: 65.01
Round   9, Train loss: 0.909, Test loss: 0.886, Test accuracy: 65.36
Round  10, Train loss: 0.884, Test loss: 0.853, Test accuracy: 66.96
Round  11, Train loss: 0.857, Test loss: 0.829, Test accuracy: 67.89
Round  12, Train loss: 0.827, Test loss: 0.822, Test accuracy: 68.77
Round  13, Train loss: 0.806, Test loss: 0.810, Test accuracy: 69.19
Round  14, Train loss: 0.785, Test loss: 0.792, Test accuracy: 69.66
Round  15, Train loss: 0.761, Test loss: 0.791, Test accuracy: 69.76
Round  16, Train loss: 0.743, Test loss: 0.769, Test accuracy: 70.61
Round  17, Train loss: 0.721, Test loss: 0.744, Test accuracy: 72.10
Round  18, Train loss: 0.704, Test loss: 0.753, Test accuracy: 71.77
Round  19, Train loss: 0.682, Test loss: 0.740, Test accuracy: 72.62
Round  20, Train loss: 0.684, Test loss: 0.747, Test accuracy: 71.93
Round  21, Train loss: 0.649, Test loss: 0.743, Test accuracy: 72.39
Round  22, Train loss: 0.661, Test loss: 0.731, Test accuracy: 72.55
Round  23, Train loss: 0.692, Test loss: 0.736, Test accuracy: 72.59
Round  24, Train loss: 0.667, Test loss: 0.731, Test accuracy: 72.89
Round  25, Train loss: 0.636, Test loss: 0.728, Test accuracy: 72.53
Round  26, Train loss: 0.574, Test loss: 0.725, Test accuracy: 73.14
Round  27, Train loss: 0.605, Test loss: 0.733, Test accuracy: 72.62
Round  28, Train loss: 0.507, Test loss: 0.747, Test accuracy: 72.61
Round  29, Train loss: 0.512, Test loss: 0.718, Test accuracy: 73.31
Round  30, Train loss: 0.565, Test loss: 0.742, Test accuracy: 72.79
Round  31, Train loss: 0.541, Test loss: 0.725, Test accuracy: 73.36
Round  32, Train loss: 0.511, Test loss: 0.715, Test accuracy: 73.98
Round  33, Train loss: 0.591, Test loss: 0.732, Test accuracy: 73.15
Round  34, Train loss: 0.493, Test loss: 0.723, Test accuracy: 73.89
Round  35, Train loss: 0.519, Test loss: 0.724, Test accuracy: 73.90
Round  36, Train loss: 0.480, Test loss: 0.730, Test accuracy: 73.93
Round  37, Train loss: 0.541, Test loss: 0.744, Test accuracy: 73.96
Round  38, Train loss: 0.474, Test loss: 0.746, Test accuracy: 73.84
Round  39, Train loss: 0.488, Test loss: 0.738, Test accuracy: 74.26
Round  40, Train loss: 0.450, Test loss: 0.714, Test accuracy: 74.80
Round  41, Train loss: 0.543, Test loss: 0.730, Test accuracy: 74.24
Round  42, Train loss: 0.426, Test loss: 0.732, Test accuracy: 74.42
Round  43, Train loss: 0.480, Test loss: 0.730, Test accuracy: 74.58
Round  44, Train loss: 0.504, Test loss: 0.735, Test accuracy: 74.52
Round  45, Train loss: 0.373, Test loss: 0.715, Test accuracy: 74.87
Round  46, Train loss: 0.468, Test loss: 0.711, Test accuracy: 74.89
Round  47, Train loss: 0.455, Test loss: 0.715, Test accuracy: 75.18
Round  48, Train loss: 0.469, Test loss: 0.721, Test accuracy: 75.20
Round  49, Train loss: 0.489, Test loss: 0.724, Test accuracy: 75.29
Round  50, Train loss: 0.448, Test loss: 0.739, Test accuracy: 74.72
Round  51, Train loss: 0.384, Test loss: 0.730, Test accuracy: 75.27
Round  52, Train loss: 0.437, Test loss: 0.732, Test accuracy: 75.23
Round  53, Train loss: 0.419, Test loss: 0.731, Test accuracy: 75.24
Round  54, Train loss: 0.422, Test loss: 0.722, Test accuracy: 75.98
Round  55, Train loss: 0.440, Test loss: 0.716, Test accuracy: 75.66
Round  56, Train loss: 0.383, Test loss: 0.727, Test accuracy: 75.99
Round  57, Train loss: 0.343, Test loss: 0.712, Test accuracy: 75.91
Round  58, Train loss: 0.387, Test loss: 0.725, Test accuracy: 75.13
Round  59, Train loss: 0.407, Test loss: 0.722, Test accuracy: 75.76
Round  60, Train loss: 0.330, Test loss: 0.723, Test accuracy: 75.54
Round  61, Train loss: 0.305, Test loss: 0.743, Test accuracy: 75.47
Round  62, Train loss: 0.371, Test loss: 0.732, Test accuracy: 75.55
Round  63, Train loss: 0.317, Test loss: 0.722, Test accuracy: 76.17
Round  64, Train loss: 0.378, Test loss: 0.736, Test accuracy: 75.68
Round  65, Train loss: 0.312, Test loss: 0.731, Test accuracy: 76.35
Round  66, Train loss: 0.300, Test loss: 0.741, Test accuracy: 76.36
Round  67, Train loss: 0.277, Test loss: 0.745, Test accuracy: 75.81
Round  68, Train loss: 0.249, Test loss: 0.737, Test accuracy: 76.36
Round  69, Train loss: 0.443, Test loss: 0.753, Test accuracy: 75.95
Round  70, Train loss: 0.320, Test loss: 0.733, Test accuracy: 76.54
Round  71, Train loss: 0.349, Test loss: 0.743, Test accuracy: 75.99
Round  72, Train loss: 0.266, Test loss: 0.735, Test accuracy: 76.51
Round  73, Train loss: 0.326, Test loss: 0.743, Test accuracy: 76.41
Round  74, Train loss: 0.359, Test loss: 0.754, Test accuracy: 75.93
Round  75, Train loss: 0.342, Test loss: 0.747, Test accuracy: 76.24
Round  76, Train loss: 0.329, Test loss: 0.727, Test accuracy: 76.66
Round  77, Train loss: 0.334, Test loss: 0.761, Test accuracy: 76.13
Round  78, Train loss: 0.340, Test loss: 0.741, Test accuracy: 75.99
Round  79, Train loss: 0.315, Test loss: 0.723, Test accuracy: 76.72
Round  80, Train loss: 0.295, Test loss: 0.712, Test accuracy: 76.84
Round  81, Train loss: 0.288, Test loss: 0.727, Test accuracy: 76.98
Round  82, Train loss: 0.282, Test loss: 0.715, Test accuracy: 77.23
Round  83, Train loss: 0.275, Test loss: 0.721, Test accuracy: 77.15
Round  84, Train loss: 0.274, Test loss: 0.727, Test accuracy: 77.03
Round  85, Train loss: 0.271, Test loss: 0.722, Test accuracy: 77.44
Round  86, Train loss: 0.267, Test loss: 0.728, Test accuracy: 77.21
Round  87, Train loss: 0.262, Test loss: 0.737, Test accuracy: 76.97
Round  88, Train loss: 0.265, Test loss: 0.732, Test accuracy: 77.38
Round  89, Train loss: 0.262, Test loss: 0.736, Test accuracy: 77.00
Round  90, Train loss: 0.258, Test loss: 0.737, Test accuracy: 77.27
Round  91, Train loss: 0.251, Test loss: 0.736, Test accuracy: 77.26
Round  92, Train loss: 0.248, Test loss: 0.742, Test accuracy: 77.02
Round  93, Train loss: 0.249, Test loss: 0.742, Test accuracy: 77.18
Round  94, Train loss: 0.250, Test loss: 0.743, Test accuracy: 77.31
Round  95, Train loss: 0.238, Test loss: 0.736, Test accuracy: 77.50
Round  96, Train loss: 0.241, Test loss: 0.753, Test accuracy: 77.08
Round  97, Train loss: 0.235, Test loss: 0.760, Test accuracy: 76.71
Round  98, Train loss: 0.239, Test loss: 0.765, Test accuracy: 76.75
Round  99, Train loss: 0.236, Test loss: 0.761, Test accuracy: 76.68
Final Round, Train loss: 0.200, Test loss: 0.754, Test accuracy: 77.22
Average accuracy final 10 rounds: 77.07600000000001
4551.3582899570465
[3.0243892669677734, 5.741838693618774, 8.488522291183472, 11.267532587051392, 14.020178318023682, 16.733116388320923, 19.536174535751343, 22.342687606811523, 25.15427327156067, 27.978466033935547, 30.76468801498413, 33.53755044937134, 36.371750831604004, 39.19859576225281, 42.02863574028015, 44.84563589096069, 47.657352685928345, 50.483832359313965, 53.29830598831177, 56.06872367858887, 58.800615310668945, 63.02449917793274, 67.29039406776428, 71.57407784461975, 75.86465215682983, 80.19640135765076, 84.5159842967987, 88.8138484954834, 93.09077215194702, 97.40579175949097, 101.67611026763916, 105.91993594169617, 110.21152567863464, 114.49354434013367, 118.7721962928772, 123.06749844551086, 127.32519006729126, 131.54603147506714, 135.80589485168457, 140.0549373626709, 144.31342935562134, 148.50300455093384, 152.69653606414795, 156.93739867210388, 161.19263553619385, 165.46517634391785, 169.70573949813843, 173.85995411872864, 178.02388334274292, 182.26059579849243, 186.4937264919281, 190.73778915405273, 194.98682594299316, 199.21922826766968, 203.37300562858582, 207.61647367477417, 211.8083188533783, 216.0676076412201, 220.31496453285217, 224.53151559829712, 228.73409342765808, 232.93659687042236, 237.1424298286438, 241.29659247398376, 245.4596118927002, 249.56717658042908, 253.72146081924438, 257.8839259147644, 262.05191946029663, 266.2569406032562, 270.4499192237854, 274.64678859710693, 278.8107445240021, 282.974769115448, 287.1384582519531, 291.35688877105713, 295.5550625324249, 299.7473375797272, 303.9468171596527, 308.13181829452515, 312.34720730781555, 316.5492570400238, 320.78586649894714, 325.006605386734, 329.2002446651459, 333.38802576065063, 337.61685037612915, 341.8164699077606, 346.0609931945801, 350.36149621009827, 354.5560894012451, 358.7736132144928, 362.954195022583, 367.2126040458679, 371.4737823009491, 375.69804406166077, 379.97772693634033, 384.1909866333008, 388.38833832740784, 392.6432650089264, 396.6107792854309]
[38.92, 46.79, 51.63, 56.92, 58.8, 59.86, 62.2, 63.72, 65.01, 65.36, 66.96, 67.89, 68.77, 69.19, 69.66, 69.76, 70.61, 72.1, 71.77, 72.62, 71.93, 72.39, 72.55, 72.59, 72.89, 72.53, 73.14, 72.62, 72.61, 73.31, 72.79, 73.36, 73.98, 73.15, 73.89, 73.9, 73.93, 73.96, 73.84, 74.26, 74.8, 74.24, 74.42, 74.58, 74.52, 74.87, 74.89, 75.18, 75.2, 75.29, 74.72, 75.27, 75.23, 75.24, 75.98, 75.66, 75.99, 75.91, 75.13, 75.76, 75.54, 75.47, 75.55, 76.17, 75.68, 76.35, 76.36, 75.81, 76.36, 75.95, 76.54, 75.99, 76.51, 76.41, 75.93, 76.24, 76.66, 76.13, 75.99, 76.72, 76.84, 76.98, 77.23, 77.15, 77.03, 77.44, 77.21, 76.97, 77.38, 77.0, 77.27, 77.26, 77.02, 77.18, 77.31, 77.5, 77.08, 76.71, 76.75, 76.68, 77.22]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.715, Test loss: 2.121, Test accuracy: 19.38
Round   0, Global train loss: 1.715, Global test loss: 2.269, Global test accuracy: 18.28
Round   1, Train loss: 1.554, Test loss: 1.936, Test accuracy: 22.71
Round   1, Global train loss: 1.554, Global test loss: 2.245, Global test accuracy: 17.72
Round   2, Train loss: 1.599, Test loss: 1.733, Test accuracy: 31.43
Round   2, Global train loss: 1.599, Global test loss: 2.251, Global test accuracy: 18.66
Round   3, Train loss: 1.540, Test loss: 1.615, Test accuracy: 32.42
Round   3, Global train loss: 1.540, Global test loss: 2.125, Global test accuracy: 18.87
Round   4, Train loss: 1.332, Test loss: 1.477, Test accuracy: 39.58
Round   4, Global train loss: 1.332, Global test loss: 2.074, Global test accuracy: 25.99
Round   5, Train loss: 1.283, Test loss: 1.449, Test accuracy: 40.92
Round   5, Global train loss: 1.283, Global test loss: 2.125, Global test accuracy: 23.45
Round   6, Train loss: 1.421, Test loss: 1.405, Test accuracy: 42.19
Round   6, Global train loss: 1.421, Global test loss: 2.079, Global test accuracy: 28.59
Round   7, Train loss: 1.232, Test loss: 1.395, Test accuracy: 42.67
Round   7, Global train loss: 1.232, Global test loss: 2.089, Global test accuracy: 25.93
Round   8, Train loss: 1.150, Test loss: 1.380, Test accuracy: 43.24
Round   8, Global train loss: 1.150, Global test loss: 2.113, Global test accuracy: 21.22
Round   9, Train loss: 1.381, Test loss: 1.407, Test accuracy: 43.25
Round   9, Global train loss: 1.381, Global test loss: 2.239, Global test accuracy: 19.97
Round  10, Train loss: 1.393, Test loss: 1.402, Test accuracy: 42.97
Round  10, Global train loss: 1.393, Global test loss: 2.076, Global test accuracy: 24.31
Round  11, Train loss: 1.335, Test loss: 1.360, Test accuracy: 44.33
Round  11, Global train loss: 1.335, Global test loss: 2.131, Global test accuracy: 25.71
Round  12, Train loss: 1.323, Test loss: 1.352, Test accuracy: 45.66
Round  12, Global train loss: 1.323, Global test loss: 2.033, Global test accuracy: 29.05
Round  13, Train loss: 1.182, Test loss: 1.328, Test accuracy: 46.32
Round  13, Global train loss: 1.182, Global test loss: 2.076, Global test accuracy: 29.12
Round  14, Train loss: 1.142, Test loss: 1.318, Test accuracy: 46.21
Round  14, Global train loss: 1.142, Global test loss: 2.042, Global test accuracy: 30.74
Round  15, Train loss: 1.359, Test loss: 1.299, Test accuracy: 46.55
Round  15, Global train loss: 1.359, Global test loss: 2.176, Global test accuracy: 19.03
Round  16, Train loss: 0.985, Test loss: 1.304, Test accuracy: 46.65
Round  16, Global train loss: 0.985, Global test loss: 2.006, Global test accuracy: 30.44
Round  17, Train loss: 1.368, Test loss: 1.306, Test accuracy: 46.31
Round  17, Global train loss: 1.368, Global test loss: 2.229, Global test accuracy: 24.72
Round  18, Train loss: 1.231, Test loss: 1.309, Test accuracy: 47.50
Round  18, Global train loss: 1.231, Global test loss: 2.139, Global test accuracy: 25.24
Round  19, Train loss: 0.985, Test loss: 1.316, Test accuracy: 47.73
Round  19, Global train loss: 0.985, Global test loss: 1.941, Global test accuracy: 31.70
Round  20, Train loss: 1.201, Test loss: 1.331, Test accuracy: 47.57
Round  20, Global train loss: 1.201, Global test loss: 2.155, Global test accuracy: 25.28
Round  21, Train loss: 1.285, Test loss: 1.320, Test accuracy: 48.09
Round  21, Global train loss: 1.285, Global test loss: 2.163, Global test accuracy: 17.98
Round  22, Train loss: 1.254, Test loss: 1.326, Test accuracy: 47.58
Round  22, Global train loss: 1.254, Global test loss: 2.064, Global test accuracy: 34.73
Round  23, Train loss: 1.317, Test loss: 1.319, Test accuracy: 47.43
Round  23, Global train loss: 1.317, Global test loss: 2.233, Global test accuracy: 23.74
Round  24, Train loss: 1.236, Test loss: 1.332, Test accuracy: 47.12
Round  24, Global train loss: 1.236, Global test loss: 2.195, Global test accuracy: 25.88
Round  25, Train loss: 1.196, Test loss: 1.341, Test accuracy: 46.59
Round  25, Global train loss: 1.196, Global test loss: 2.139, Global test accuracy: 26.09
Round  26, Train loss: 1.229, Test loss: 1.360, Test accuracy: 46.11
Round  26, Global train loss: 1.229, Global test loss: 2.169, Global test accuracy: 20.73
Round  27, Train loss: 1.055, Test loss: 1.384, Test accuracy: 46.03
Round  27, Global train loss: 1.055, Global test loss: 2.037, Global test accuracy: 31.56
Round  28, Train loss: 0.933, Test loss: 1.362, Test accuracy: 46.94
Round  28, Global train loss: 0.933, Global test loss: 2.088, Global test accuracy: 26.14
Round  29, Train loss: 1.286, Test loss: 1.376, Test accuracy: 46.62
Round  29, Global train loss: 1.286, Global test loss: 2.155, Global test accuracy: 25.11
Round  30, Train loss: 0.937, Test loss: 1.382, Test accuracy: 47.63
Round  30, Global train loss: 0.937, Global test loss: 2.094, Global test accuracy: 25.29
Round  31, Train loss: 0.844, Test loss: 1.387, Test accuracy: 47.77
Round  31, Global train loss: 0.844, Global test loss: 2.168, Global test accuracy: 20.57
Round  32, Train loss: 0.743, Test loss: 1.407, Test accuracy: 47.71
Round  32, Global train loss: 0.743, Global test loss: 2.031, Global test accuracy: 32.70
Round  33, Train loss: 1.130, Test loss: 1.406, Test accuracy: 47.57
Round  33, Global train loss: 1.130, Global test loss: 2.088, Global test accuracy: 28.17
Round  34, Train loss: 0.938, Test loss: 1.436, Test accuracy: 48.02
Round  34, Global train loss: 0.938, Global test loss: 2.038, Global test accuracy: 28.05
Round  35, Train loss: 0.741, Test loss: 1.458, Test accuracy: 47.57
Round  35, Global train loss: 0.741, Global test loss: 2.060, Global test accuracy: 30.12
Round  36, Train loss: 0.803, Test loss: 1.468, Test accuracy: 47.74
Round  36, Global train loss: 0.803, Global test loss: 2.107, Global test accuracy: 27.72
Round  37, Train loss: 0.734, Test loss: 1.490, Test accuracy: 47.33
Round  37, Global train loss: 0.734, Global test loss: 2.146, Global test accuracy: 27.26
Round  38, Train loss: 0.776, Test loss: 1.491, Test accuracy: 47.07
Round  38, Global train loss: 0.776, Global test loss: 2.009, Global test accuracy: 27.67
Round  39, Train loss: 0.714, Test loss: 1.548, Test accuracy: 46.83
Round  39, Global train loss: 0.714, Global test loss: 1.980, Global test accuracy: 29.06
Round  40, Train loss: 1.055, Test loss: 1.524, Test accuracy: 46.75
Round  40, Global train loss: 1.055, Global test loss: 2.087, Global test accuracy: 25.57
Round  41, Train loss: 0.744, Test loss: 1.543, Test accuracy: 47.00
Round  41, Global train loss: 0.744, Global test loss: 1.998, Global test accuracy: 28.44
Round  42, Train loss: 0.845, Test loss: 1.577, Test accuracy: 46.85
Round  42, Global train loss: 0.845, Global test loss: 2.115, Global test accuracy: 25.40
Round  43, Train loss: 0.839, Test loss: 1.613, Test accuracy: 46.61
Round  43, Global train loss: 0.839, Global test loss: 2.161, Global test accuracy: 21.07
Round  44, Train loss: 0.894, Test loss: 1.628, Test accuracy: 46.62
Round  44, Global train loss: 0.894, Global test loss: 2.060, Global test accuracy: 31.60
Round  45, Train loss: 0.792, Test loss: 1.676, Test accuracy: 45.84
Round  45, Global train loss: 0.792, Global test loss: 2.041, Global test accuracy: 28.57
Round  46, Train loss: 0.931, Test loss: 1.665, Test accuracy: 46.59
Round  46, Global train loss: 0.931, Global test loss: 2.148, Global test accuracy: 24.89
Round  47, Train loss: 0.826, Test loss: 1.682, Test accuracy: 46.55
Round  47, Global train loss: 0.826, Global test loss: 2.112, Global test accuracy: 25.36
Round  48, Train loss: 0.717, Test loss: 1.725, Test accuracy: 46.07
Round  48, Global train loss: 0.717, Global test loss: 2.038, Global test accuracy: 35.24
Round  49, Train loss: 0.691, Test loss: 1.759, Test accuracy: 45.80
Round  49, Global train loss: 0.691, Global test loss: 2.067, Global test accuracy: 29.62
Round  50, Train loss: 0.710, Test loss: 1.794, Test accuracy: 46.38
Round  50, Global train loss: 0.710, Global test loss: 2.024, Global test accuracy: 31.43
Round  51, Train loss: 0.822, Test loss: 1.835, Test accuracy: 46.74
Round  51, Global train loss: 0.822, Global test loss: 2.142, Global test accuracy: 26.42
Round  52, Train loss: 0.615, Test loss: 1.810, Test accuracy: 47.05
Round  52, Global train loss: 0.615, Global test loss: 2.005, Global test accuracy: 30.70
Round  53, Train loss: 0.506, Test loss: 1.813, Test accuracy: 47.03
Round  53, Global train loss: 0.506, Global test loss: 2.043, Global test accuracy: 29.10
Round  54, Train loss: 0.578, Test loss: 1.850, Test accuracy: 46.25
Round  54, Global train loss: 0.578, Global test loss: 1.977, Global test accuracy: 32.90
Round  55, Train loss: 0.559, Test loss: 1.825, Test accuracy: 46.92
Round  55, Global train loss: 0.559, Global test loss: 2.032, Global test accuracy: 35.09
Round  56, Train loss: 0.714, Test loss: 1.836, Test accuracy: 46.24
Round  56, Global train loss: 0.714, Global test loss: 2.100, Global test accuracy: 28.88
Round  57, Train loss: 0.509, Test loss: 1.885, Test accuracy: 46.75
Round  57, Global train loss: 0.509, Global test loss: 2.118, Global test accuracy: 27.33
Round  58, Train loss: 0.327, Test loss: 1.942, Test accuracy: 46.47
Round  58, Global train loss: 0.327, Global test loss: 2.014, Global test accuracy: 28.29
Round  59, Train loss: 0.457, Test loss: 2.024, Test accuracy: 46.21
Round  59, Global train loss: 0.457, Global test loss: 2.161, Global test accuracy: 24.84
Round  60, Train loss: 0.831, Test loss: 2.027, Test accuracy: 46.20
Round  60, Global train loss: 0.831, Global test loss: 2.179, Global test accuracy: 20.21
Round  61, Train loss: 0.557, Test loss: 2.065, Test accuracy: 46.03
Round  61, Global train loss: 0.557, Global test loss: 2.201, Global test accuracy: 24.23
Round  62, Train loss: 0.432, Test loss: 2.135, Test accuracy: 45.95
Round  62, Global train loss: 0.432, Global test loss: 1.988, Global test accuracy: 31.06
Round  63, Train loss: 0.407, Test loss: 2.191, Test accuracy: 45.38
Round  63, Global train loss: 0.407, Global test loss: 2.159, Global test accuracy: 24.35
Round  64, Train loss: 0.616, Test loss: 2.227, Test accuracy: 45.87
Round  64, Global train loss: 0.616, Global test loss: 2.086, Global test accuracy: 26.76
Round  65, Train loss: 0.353, Test loss: 2.241, Test accuracy: 46.33
Round  65, Global train loss: 0.353, Global test loss: 2.097, Global test accuracy: 22.66
Round  66, Train loss: 0.366, Test loss: 2.214, Test accuracy: 46.47
Round  66, Global train loss: 0.366, Global test loss: 1.945, Global test accuracy: 32.63
Round  67, Train loss: 0.601, Test loss: 2.189, Test accuracy: 47.40
Round  67, Global train loss: 0.601, Global test loss: 2.076, Global test accuracy: 25.32
Round  68, Train loss: 0.321, Test loss: 2.184, Test accuracy: 48.12
Round  68, Global train loss: 0.321, Global test loss: 2.545, Global test accuracy: 27.67
Round  69, Train loss: 0.550, Test loss: 2.250, Test accuracy: 47.18
Round  69, Global train loss: 0.550, Global test loss: 2.092, Global test accuracy: 27.30
Round  70, Train loss: 0.343, Test loss: 2.282, Test accuracy: 47.06
Round  70, Global train loss: 0.343, Global test loss: 2.043, Global test accuracy: 28.82
Round  71, Train loss: 0.265, Test loss: 2.357, Test accuracy: 46.90
Round  71, Global train loss: 0.265, Global test loss: 2.004, Global test accuracy: 33.23
Round  72, Train loss: 0.247, Test loss: 2.426, Test accuracy: 46.87
Round  72, Global train loss: 0.247, Global test loss: 1.953, Global test accuracy: 33.93
Round  73, Train loss: 0.334, Test loss: 2.404, Test accuracy: 47.29
Round  73, Global train loss: 0.334, Global test loss: 1.992, Global test accuracy: 31.91
Round  74, Train loss: 0.365, Test loss: 2.439, Test accuracy: 46.89
Round  74, Global train loss: 0.365, Global test loss: 2.068, Global test accuracy: 31.17
Round  75, Train loss: 0.412, Test loss: 2.426, Test accuracy: 46.90
Round  75, Global train loss: 0.412, Global test loss: 2.118, Global test accuracy: 27.21
Round  76, Train loss: 0.234, Test loss: 2.412, Test accuracy: 46.56
Round  76, Global train loss: 0.234, Global test loss: 1.916, Global test accuracy: 34.12
Round  77, Train loss: 0.346, Test loss: 2.464, Test accuracy: 46.31
Round  77, Global train loss: 0.346, Global test loss: 2.204, Global test accuracy: 24.00
Round  78, Train loss: 0.239, Test loss: 2.471, Test accuracy: 46.64
Round  78, Global train loss: 0.239, Global test loss: 2.233, Global test accuracy: 26.39
Round  79, Train loss: 0.409, Test loss: 2.497, Test accuracy: 47.18
Round  79, Global train loss: 0.409, Global test loss: 2.092, Global test accuracy: 23.62
Round  80, Train loss: 0.296, Test loss: 2.573, Test accuracy: 46.63
Round  80, Global train loss: 0.296, Global test loss: 2.052, Global test accuracy: 30.56
Round  81, Train loss: 0.294, Test loss: 2.646, Test accuracy: 46.06
Round  81, Global train loss: 0.294, Global test loss: 2.064, Global test accuracy: 28.52
Round  82, Train loss: 0.255, Test loss: 2.660, Test accuracy: 46.26
Round  82, Global train loss: 0.255, Global test loss: 2.005, Global test accuracy: 27.80
Round  83, Train loss: 0.197, Test loss: 2.655, Test accuracy: 46.35
Round  83, Global train loss: 0.197, Global test loss: 1.918, Global test accuracy: 35.62
Round  84, Train loss: 0.195, Test loss: 2.647, Test accuracy: 46.55
Round  84, Global train loss: 0.195, Global test loss: 2.082, Global test accuracy: 26.71
Round  85, Train loss: 0.187, Test loss: 2.705, Test accuracy: 46.60
Round  85, Global train loss: 0.187, Global test loss: 2.012, Global test accuracy: 27.59
Round  86, Train loss: 0.323, Test loss: 2.774, Test accuracy: 46.20
Round  86, Global train loss: 0.323, Global test loss: 2.083, Global test accuracy: 28.95
Round  87, Train loss: 0.218, Test loss: 2.763, Test accuracy: 46.75
Round  87, Global train loss: 0.218, Global test loss: 2.065, Global test accuracy: 26.38
Round  88, Train loss: 0.352, Test loss: 2.762, Test accuracy: 46.34
Round  88, Global train loss: 0.352, Global test loss: 2.062, Global test accuracy: 27.35
Round  89, Train loss: 0.257, Test loss: 2.826, Test accuracy: 45.88
Round  89, Global train loss: 0.257, Global test loss: 2.085, Global test accuracy: 30.69
Round  90, Train loss: 0.254, Test loss: 2.859, Test accuracy: 45.85
Round  90, Global train loss: 0.254, Global test loss: 1.995, Global test accuracy: 32.44
Round  91, Train loss: 0.237, Test loss: 2.865, Test accuracy: 46.62
Round  91, Global train loss: 0.237, Global test loss: 2.130, Global test accuracy: 26.95
Round  92, Train loss: 0.166, Test loss: 2.896, Test accuracy: 47.02
Round  92, Global train loss: 0.166, Global test loss: 2.194, Global test accuracy: 27.02
Round  93, Train loss: 0.291, Test loss: 2.893, Test accuracy: 47.11
Round  93, Global train loss: 0.291, Global test loss: 2.162, Global test accuracy: 24.26
Round  94, Train loss: 0.311, Test loss: 2.925, Test accuracy: 46.99
Round  94, Global train loss: 0.311, Global test loss: 2.226, Global test accuracy: 18.09
Round  95, Train loss: 0.281, Test loss: 2.954, Test accuracy: 46.96
Round  95, Global train loss: 0.281, Global test loss: 2.052, Global test accuracy: 28.98
Round  96, Train loss: 0.254, Test loss: 2.920, Test accuracy: 46.56
Round  96, Global train loss: 0.254, Global test loss: 2.123, Global test accuracy: 27.51
Round  97, Train loss: 0.234, Test loss: 2.984, Test accuracy: 46.62
Round  97, Global train loss: 0.234, Global test loss: 1.982, Global test accuracy: 31.81
Round  98, Train loss: 0.285, Test loss: 3.005, Test accuracy: 46.89
Round  98, Global train loss: 0.285, Global test loss: 2.010, Global test accuracy: 28.60
Round  99, Train loss: 0.224, Test loss: 3.034, Test accuracy: 46.89
Round  99, Global train loss: 0.224, Global test loss: 2.218, Global test accuracy: 25.45
Final Round, Train loss: 0.199, Test loss: 3.133, Test accuracy: 47.10
Final Round, Global train loss: 0.199, Global test loss: 2.218, Global test accuracy: 25.45
Average accuracy final 10 rounds: 46.751 

Average global accuracy final 10 rounds: 27.110999999999997 

1330.1921796798706
[1.374422311782837, 2.748844623565674, 3.8554227352142334, 4.962000846862793, 6.072766304016113, 7.183531761169434, 8.293982744216919, 9.404433727264404, 10.513724327087402, 11.6230149269104, 12.751349925994873, 13.879684925079346, 15.00544261932373, 16.131200313568115, 17.26154613494873, 18.391891956329346, 19.521572828292847, 20.651253700256348, 21.786383628845215, 22.921513557434082, 24.04957675933838, 25.177639961242676, 26.309786319732666, 27.441932678222656, 28.569093227386475, 29.696253776550293, 30.8326632976532, 31.969072818756104, 33.0966157913208, 34.2241587638855, 35.33292841911316, 36.44169807434082, 37.55408549308777, 38.66647291183472, 39.78073716163635, 40.89500141143799, 42.00747561454773, 43.11994981765747, 44.23236656188965, 45.344783306121826, 46.460736989974976, 47.576690673828125, 48.69075679779053, 49.80482292175293, 50.91464877128601, 52.02447462081909, 53.136224031448364, 54.24797344207764, 55.36072850227356, 56.47348356246948, 57.58850574493408, 58.70352792739868, 59.82568097114563, 60.94783401489258, 62.06520676612854, 63.1825795173645, 64.30049443244934, 65.41840934753418, 66.53378009796143, 67.64915084838867, 68.76286554336548, 69.87658023834229, 70.9915828704834, 72.10658550262451, 73.220778465271, 74.33497142791748, 75.45231938362122, 76.56966733932495, 77.68254089355469, 78.79541444778442, 79.9078733921051, 81.02033233642578, 82.14307713508606, 83.26582193374634, 84.38003706932068, 85.49425220489502, 86.61128640174866, 87.7283205986023, 88.84479188919067, 89.96126317977905, 91.07793259620667, 92.19460201263428, 93.31283783912659, 94.4310736656189, 95.5492844581604, 96.6674952507019, 97.78426361083984, 98.90103197097778, 100.01848602294922, 101.13594007492065, 102.25016021728516, 103.36438035964966, 104.47887325286865, 105.59336614608765, 106.7123794555664, 107.83139276504517, 108.94520807266235, 110.05902338027954, 111.17254185676575, 112.28606033325195, 113.40068435668945, 114.51530838012695, 115.6300597190857, 116.74481105804443, 117.85993075370789, 118.97505044937134, 120.08911514282227, 121.2031798362732, 122.31775140762329, 123.43232297897339, 124.54450559616089, 125.65668821334839, 126.78587770462036, 127.91506719589233, 129.04302525520325, 130.17098331451416, 131.2988157272339, 132.4266481399536, 133.55120277404785, 134.6757574081421, 135.7951192855835, 136.9144811630249, 138.04131293296814, 139.16814470291138, 140.29520535469055, 141.42226600646973, 142.54679226875305, 143.67131853103638, 144.7938528060913, 145.91638708114624, 147.04559230804443, 148.17479753494263, 149.29937744140625, 150.42395734786987, 151.53601121902466, 152.64806509017944, 153.76204204559326, 154.87601900100708, 155.9924614429474, 157.1089038848877, 158.22635746002197, 159.34381103515625, 160.46336579322815, 161.58292055130005, 162.69833707809448, 163.81375360488892, 164.93392515182495, 166.054096698761, 167.1706826686859, 168.28726863861084, 169.4042637348175, 170.52125883102417, 171.63459253311157, 172.74792623519897, 173.86081647872925, 174.97370672225952, 176.08997178077698, 177.20623683929443, 178.2751269340515, 179.3440170288086, 180.34135723114014, 181.33869743347168, 182.29378461837769, 183.2488718032837, 184.20163798332214, 185.1544041633606, 186.10598707199097, 187.05756998062134, 188.04784750938416, 189.03812503814697, 189.99000144004822, 190.94187784194946, 191.8915455341339, 192.84121322631836, 193.79051852226257, 194.7398238182068, 195.69228672981262, 196.64474964141846, 197.5949821472168, 198.54521465301514, 199.4936327934265, 200.4420509338379, 201.39366602897644, 202.345281124115, 203.3138291835785, 204.282377243042, 205.234619140625, 206.186861038208, 207.137353181839, 208.08784532546997, 209.03695440292358, 209.9860634803772, 210.9331614971161, 211.88025951385498, 212.83635568618774, 213.7924518585205, 214.74564933776855, 215.6988468170166, 216.65109705924988, 217.60334730148315, 219.5323851108551, 221.46142292022705]
[19.38, 19.38, 22.71, 22.71, 31.43, 31.43, 32.42, 32.42, 39.58, 39.58, 40.92, 40.92, 42.19, 42.19, 42.67, 42.67, 43.24, 43.24, 43.25, 43.25, 42.97, 42.97, 44.33, 44.33, 45.66, 45.66, 46.32, 46.32, 46.21, 46.21, 46.55, 46.55, 46.65, 46.65, 46.31, 46.31, 47.5, 47.5, 47.73, 47.73, 47.57, 47.57, 48.09, 48.09, 47.58, 47.58, 47.43, 47.43, 47.12, 47.12, 46.59, 46.59, 46.11, 46.11, 46.03, 46.03, 46.94, 46.94, 46.62, 46.62, 47.63, 47.63, 47.77, 47.77, 47.71, 47.71, 47.57, 47.57, 48.02, 48.02, 47.57, 47.57, 47.74, 47.74, 47.33, 47.33, 47.07, 47.07, 46.83, 46.83, 46.75, 46.75, 47.0, 47.0, 46.85, 46.85, 46.61, 46.61, 46.62, 46.62, 45.84, 45.84, 46.59, 46.59, 46.55, 46.55, 46.07, 46.07, 45.8, 45.8, 46.38, 46.38, 46.74, 46.74, 47.05, 47.05, 47.03, 47.03, 46.25, 46.25, 46.92, 46.92, 46.24, 46.24, 46.75, 46.75, 46.47, 46.47, 46.21, 46.21, 46.2, 46.2, 46.03, 46.03, 45.95, 45.95, 45.38, 45.38, 45.87, 45.87, 46.33, 46.33, 46.47, 46.47, 47.4, 47.4, 48.12, 48.12, 47.18, 47.18, 47.06, 47.06, 46.9, 46.9, 46.87, 46.87, 47.29, 47.29, 46.89, 46.89, 46.9, 46.9, 46.56, 46.56, 46.31, 46.31, 46.64, 46.64, 47.18, 47.18, 46.63, 46.63, 46.06, 46.06, 46.26, 46.26, 46.35, 46.35, 46.55, 46.55, 46.6, 46.6, 46.2, 46.2, 46.75, 46.75, 46.34, 46.34, 45.88, 45.88, 45.85, 45.85, 46.62, 46.62, 47.02, 47.02, 47.11, 47.11, 46.99, 46.99, 46.96, 46.96, 46.56, 46.56, 46.62, 46.62, 46.89, 46.89, 46.89, 46.89, 47.1, 47.1]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 2, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.689, Test loss: 2.078, Test accuracy: 23.94
Round   0, Global train loss: 1.689, Global test loss: 2.235, Global test accuracy: 21.82
Round   1, Train loss: 1.515, Test loss: 1.815, Test accuracy: 31.24
Round   1, Global train loss: 1.515, Global test loss: 2.105, Global test accuracy: 24.56
Round   2, Train loss: 1.530, Test loss: 1.636, Test accuracy: 37.95
Round   2, Global train loss: 1.530, Global test loss: 2.215, Global test accuracy: 21.04
Round   3, Train loss: 1.410, Test loss: 1.503, Test accuracy: 42.19
Round   3, Global train loss: 1.410, Global test loss: 1.924, Global test accuracy: 30.50
Round   4, Train loss: 1.373, Test loss: 1.352, Test accuracy: 47.82
Round   4, Global train loss: 1.373, Global test loss: 1.974, Global test accuracy: 26.74
Round   5, Train loss: 1.332, Test loss: 1.264, Test accuracy: 51.83
Round   5, Global train loss: 1.332, Global test loss: 1.816, Global test accuracy: 35.22
Round   6, Train loss: 1.157, Test loss: 1.218, Test accuracy: 53.21
Round   6, Global train loss: 1.157, Global test loss: 1.620, Global test accuracy: 43.16
Round   7, Train loss: 1.289, Test loss: 1.206, Test accuracy: 53.56
Round   7, Global train loss: 1.289, Global test loss: 1.608, Global test accuracy: 44.32
Round   8, Train loss: 1.087, Test loss: 1.210, Test accuracy: 53.92
Round   8, Global train loss: 1.087, Global test loss: 1.875, Global test accuracy: 33.45
Round   9, Train loss: 1.074, Test loss: 1.173, Test accuracy: 55.67
Round   9, Global train loss: 1.074, Global test loss: 1.699, Global test accuracy: 42.10
Round  10, Train loss: 1.295, Test loss: 1.153, Test accuracy: 56.91
Round  10, Global train loss: 1.295, Global test loss: 1.647, Global test accuracy: 40.76
Round  11, Train loss: 0.977, Test loss: 1.125, Test accuracy: 57.91
Round  11, Global train loss: 0.977, Global test loss: 1.734, Global test accuracy: 41.51
Round  12, Train loss: 1.064, Test loss: 1.090, Test accuracy: 59.35
Round  12, Global train loss: 1.064, Global test loss: 1.513, Global test accuracy: 44.40
Round  13, Train loss: 0.975, Test loss: 1.084, Test accuracy: 59.81
Round  13, Global train loss: 0.975, Global test loss: 1.636, Global test accuracy: 47.02
Round  14, Train loss: 1.004, Test loss: 1.102, Test accuracy: 59.25
Round  14, Global train loss: 1.004, Global test loss: 1.472, Global test accuracy: 49.01
Round  15, Train loss: 1.133, Test loss: 1.083, Test accuracy: 59.87
Round  15, Global train loss: 1.133, Global test loss: 1.498, Global test accuracy: 47.61
Round  16, Train loss: 0.870, Test loss: 1.068, Test accuracy: 60.54
Round  16, Global train loss: 0.870, Global test loss: 1.440, Global test accuracy: 50.71
Round  17, Train loss: 0.943, Test loss: 1.047, Test accuracy: 61.33
Round  17, Global train loss: 0.943, Global test loss: 1.520, Global test accuracy: 45.62
Round  18, Train loss: 0.947, Test loss: 1.043, Test accuracy: 61.47
Round  18, Global train loss: 0.947, Global test loss: 1.483, Global test accuracy: 47.86
Round  19, Train loss: 0.914, Test loss: 1.036, Test accuracy: 61.94
Round  19, Global train loss: 0.914, Global test loss: 1.505, Global test accuracy: 47.43
Round  20, Train loss: 1.017, Test loss: 1.036, Test accuracy: 62.27
Round  20, Global train loss: 1.017, Global test loss: 1.420, Global test accuracy: 49.99
Round  21, Train loss: 1.035, Test loss: 1.030, Test accuracy: 62.50
Round  21, Global train loss: 1.035, Global test loss: 1.471, Global test accuracy: 47.61
Round  22, Train loss: 0.975, Test loss: 1.023, Test accuracy: 63.04
Round  22, Global train loss: 0.975, Global test loss: 1.516, Global test accuracy: 48.11
Round  23, Train loss: 0.902, Test loss: 1.014, Test accuracy: 63.58
Round  23, Global train loss: 0.902, Global test loss: 1.732, Global test accuracy: 42.64
Round  24, Train loss: 0.890, Test loss: 1.028, Test accuracy: 63.17
Round  24, Global train loss: 0.890, Global test loss: 1.513, Global test accuracy: 47.56
Round  25, Train loss: 0.846, Test loss: 1.021, Test accuracy: 63.41
Round  25, Global train loss: 0.846, Global test loss: 1.414, Global test accuracy: 51.26
Round  26, Train loss: 0.817, Test loss: 1.070, Test accuracy: 62.51
Round  26, Global train loss: 0.817, Global test loss: 1.354, Global test accuracy: 52.72
Round  27, Train loss: 0.818, Test loss: 1.033, Test accuracy: 63.86
Round  27, Global train loss: 0.818, Global test loss: 1.468, Global test accuracy: 48.49
Round  28, Train loss: 0.871, Test loss: 1.010, Test accuracy: 64.97
Round  28, Global train loss: 0.871, Global test loss: 1.393, Global test accuracy: 49.23
Round  29, Train loss: 0.698, Test loss: 1.014, Test accuracy: 64.59
Round  29, Global train loss: 0.698, Global test loss: 1.381, Global test accuracy: 52.19
Round  30, Train loss: 0.701, Test loss: 0.995, Test accuracy: 65.84
Round  30, Global train loss: 0.701, Global test loss: 1.534, Global test accuracy: 48.25
Round  31, Train loss: 0.793, Test loss: 0.997, Test accuracy: 65.71
Round  31, Global train loss: 0.793, Global test loss: 1.586, Global test accuracy: 47.61
Round  32, Train loss: 0.959, Test loss: 1.010, Test accuracy: 65.34
Round  32, Global train loss: 0.959, Global test loss: 1.388, Global test accuracy: 52.13
Round  33, Train loss: 0.730, Test loss: 1.016, Test accuracy: 65.38
Round  33, Global train loss: 0.730, Global test loss: 1.278, Global test accuracy: 56.13
Round  34, Train loss: 0.829, Test loss: 1.040, Test accuracy: 64.72
Round  34, Global train loss: 0.829, Global test loss: 1.395, Global test accuracy: 52.68
Round  35, Train loss: 0.678, Test loss: 1.020, Test accuracy: 65.15
Round  35, Global train loss: 0.678, Global test loss: 1.396, Global test accuracy: 52.60
Round  36, Train loss: 0.713, Test loss: 1.015, Test accuracy: 65.48
Round  36, Global train loss: 0.713, Global test loss: 1.406, Global test accuracy: 54.16
Round  37, Train loss: 0.782, Test loss: 1.006, Test accuracy: 66.02
Round  37, Global train loss: 0.782, Global test loss: 1.432, Global test accuracy: 51.50
Round  38, Train loss: 0.770, Test loss: 1.002, Test accuracy: 66.47
Round  38, Global train loss: 0.770, Global test loss: 1.360, Global test accuracy: 55.38
Round  39, Train loss: 0.728, Test loss: 1.010, Test accuracy: 66.01
Round  39, Global train loss: 0.728, Global test loss: 1.249, Global test accuracy: 58.12
Round  40, Train loss: 0.599, Test loss: 1.023, Test accuracy: 66.02
Round  40, Global train loss: 0.599, Global test loss: 1.319, Global test accuracy: 56.86
Round  41, Train loss: 0.575, Test loss: 1.036, Test accuracy: 65.92
Round  41, Global train loss: 0.575, Global test loss: 1.277, Global test accuracy: 57.56
Round  42, Train loss: 0.701, Test loss: 1.032, Test accuracy: 66.24
Round  42, Global train loss: 0.701, Global test loss: 1.300, Global test accuracy: 56.03
Round  43, Train loss: 0.743, Test loss: 1.027, Test accuracy: 66.47
Round  43, Global train loss: 0.743, Global test loss: 1.412, Global test accuracy: 51.15
Round  44, Train loss: 0.516, Test loss: 1.041, Test accuracy: 66.50
Round  44, Global train loss: 0.516, Global test loss: 1.411, Global test accuracy: 54.87
Round  45, Train loss: 0.680, Test loss: 1.045, Test accuracy: 66.70
Round  45, Global train loss: 0.680, Global test loss: 1.309, Global test accuracy: 56.07
Round  46, Train loss: 0.669, Test loss: 1.076, Test accuracy: 65.70
Round  46, Global train loss: 0.669, Global test loss: 1.319, Global test accuracy: 56.08
Round  47, Train loss: 0.560, Test loss: 1.075, Test accuracy: 65.83
Round  47, Global train loss: 0.560, Global test loss: 1.431, Global test accuracy: 54.02
Round  48, Train loss: 0.625, Test loss: 1.049, Test accuracy: 66.49
Round  48, Global train loss: 0.625, Global test loss: 1.333, Global test accuracy: 57.23
Round  49, Train loss: 0.634, Test loss: 1.067, Test accuracy: 65.85
Round  49, Global train loss: 0.634, Global test loss: 1.274, Global test accuracy: 59.22
Round  50, Train loss: 0.702, Test loss: 1.065, Test accuracy: 65.99
Round  50, Global train loss: 0.702, Global test loss: 1.246, Global test accuracy: 57.38
Round  51, Train loss: 0.465, Test loss: 1.077, Test accuracy: 66.60
Round  51, Global train loss: 0.465, Global test loss: 1.367, Global test accuracy: 56.89
Round  52, Train loss: 0.522, Test loss: 1.069, Test accuracy: 66.82
Round  52, Global train loss: 0.522, Global test loss: 1.524, Global test accuracy: 54.81
Round  53, Train loss: 0.734, Test loss: 1.086, Test accuracy: 66.88
Round  53, Global train loss: 0.734, Global test loss: 1.417, Global test accuracy: 55.23
Round  54, Train loss: 0.691, Test loss: 1.083, Test accuracy: 66.57
Round  54, Global train loss: 0.691, Global test loss: 1.284, Global test accuracy: 57.25
Round  55, Train loss: 0.570, Test loss: 1.067, Test accuracy: 67.55
Round  55, Global train loss: 0.570, Global test loss: 1.653, Global test accuracy: 52.21
Round  56, Train loss: 0.438, Test loss: 1.088, Test accuracy: 67.04
Round  56, Global train loss: 0.438, Global test loss: 1.415, Global test accuracy: 58.69
Round  57, Train loss: 0.589, Test loss: 1.105, Test accuracy: 67.06
Round  57, Global train loss: 0.589, Global test loss: 1.287, Global test accuracy: 59.82
Round  58, Train loss: 0.481, Test loss: 1.112, Test accuracy: 67.00
Round  58, Global train loss: 0.481, Global test loss: 1.439, Global test accuracy: 56.55
Round  59, Train loss: 0.505, Test loss: 1.100, Test accuracy: 67.23
Round  59, Global train loss: 0.505, Global test loss: 1.339, Global test accuracy: 58.58
Round  60, Train loss: 0.595, Test loss: 1.100, Test accuracy: 66.88
Round  60, Global train loss: 0.595, Global test loss: 1.271, Global test accuracy: 57.93
Round  61, Train loss: 0.540, Test loss: 1.122, Test accuracy: 67.30
Round  61, Global train loss: 0.540, Global test loss: 1.427, Global test accuracy: 55.77
Round  62, Train loss: 0.537, Test loss: 1.147, Test accuracy: 66.57
Round  62, Global train loss: 0.537, Global test loss: 1.434, Global test accuracy: 58.03
Round  63, Train loss: 0.471, Test loss: 1.106, Test accuracy: 67.45
Round  63, Global train loss: 0.471, Global test loss: 1.542, Global test accuracy: 56.02
Round  64, Train loss: 0.568, Test loss: 1.109, Test accuracy: 67.31
Round  64, Global train loss: 0.568, Global test loss: 1.419, Global test accuracy: 55.67
Round  65, Train loss: 0.496, Test loss: 1.112, Test accuracy: 67.16
Round  65, Global train loss: 0.496, Global test loss: 1.492, Global test accuracy: 54.93
Round  66, Train loss: 0.540, Test loss: 1.133, Test accuracy: 67.26
Round  66, Global train loss: 0.540, Global test loss: 1.391, Global test accuracy: 57.99
Round  67, Train loss: 0.579, Test loss: 1.128, Test accuracy: 67.60
Round  67, Global train loss: 0.579, Global test loss: 1.300, Global test accuracy: 59.14
Round  68, Train loss: 0.616, Test loss: 1.155, Test accuracy: 67.39
Round  68, Global train loss: 0.616, Global test loss: 1.481, Global test accuracy: 55.00
Round  69, Train loss: 0.465, Test loss: 1.190, Test accuracy: 67.10
Round  69, Global train loss: 0.465, Global test loss: 1.250, Global test accuracy: 60.65
Round  70, Train loss: 0.461, Test loss: 1.150, Test accuracy: 67.44
Round  70, Global train loss: 0.461, Global test loss: 1.259, Global test accuracy: 60.19
Round  71, Train loss: 0.516, Test loss: 1.150, Test accuracy: 67.62
Round  71, Global train loss: 0.516, Global test loss: 1.347, Global test accuracy: 58.40
Round  72, Train loss: 0.522, Test loss: 1.156, Test accuracy: 67.57
Round  72, Global train loss: 0.522, Global test loss: 1.361, Global test accuracy: 58.02
Round  73, Train loss: 0.366, Test loss: 1.158, Test accuracy: 67.88
Round  73, Global train loss: 0.366, Global test loss: 1.470, Global test accuracy: 59.03
Round  74, Train loss: 0.464, Test loss: 1.163, Test accuracy: 67.64
Round  74, Global train loss: 0.464, Global test loss: 1.704, Global test accuracy: 54.08
Round  75, Train loss: 0.431, Test loss: 1.205, Test accuracy: 67.55
Round  75, Global train loss: 0.431, Global test loss: 1.427, Global test accuracy: 57.60
Round  76, Train loss: 0.497, Test loss: 1.181, Test accuracy: 68.05
Round  76, Global train loss: 0.497, Global test loss: 1.327, Global test accuracy: 58.56
Round  77, Train loss: 0.476, Test loss: 1.186, Test accuracy: 68.12
Round  77, Global train loss: 0.476, Global test loss: 1.359, Global test accuracy: 59.07
Round  78, Train loss: 0.428, Test loss: 1.207, Test accuracy: 67.76
Round  78, Global train loss: 0.428, Global test loss: 1.447, Global test accuracy: 58.48
Round  79, Train loss: 0.443, Test loss: 1.189, Test accuracy: 68.12
Round  79, Global train loss: 0.443, Global test loss: 1.341, Global test accuracy: 58.69
Round  80, Train loss: 0.363, Test loss: 1.188, Test accuracy: 68.03
Round  80, Global train loss: 0.363, Global test loss: 1.390, Global test accuracy: 59.36
Round  81, Train loss: 0.423, Test loss: 1.178, Test accuracy: 68.48
Round  81, Global train loss: 0.423, Global test loss: 1.286, Global test accuracy: 61.02
Round  82, Train loss: 0.479, Test loss: 1.150, Test accuracy: 68.30
Round  82, Global train loss: 0.479, Global test loss: 1.279, Global test accuracy: 60.76
Round  83, Train loss: 0.495, Test loss: 1.189, Test accuracy: 67.80
Round  83, Global train loss: 0.495, Global test loss: 1.510, Global test accuracy: 57.01
Round  84, Train loss: 0.406, Test loss: 1.192, Test accuracy: 67.72
Round  84, Global train loss: 0.406, Global test loss: 1.331, Global test accuracy: 60.93
Round  85, Train loss: 0.359, Test loss: 1.181, Test accuracy: 68.29
Round  85, Global train loss: 0.359, Global test loss: 1.345, Global test accuracy: 61.13
Round  86, Train loss: 0.372, Test loss: 1.192, Test accuracy: 68.20
Round  86, Global train loss: 0.372, Global test loss: 1.390, Global test accuracy: 60.53
Round  87, Train loss: 0.443, Test loss: 1.193, Test accuracy: 68.59
Round  87, Global train loss: 0.443, Global test loss: 1.343, Global test accuracy: 60.37
Round  88, Train loss: 0.486, Test loss: 1.215, Test accuracy: 68.10
Round  88, Global train loss: 0.486, Global test loss: 1.432, Global test accuracy: 57.80
Round  89, Train loss: 0.340, Test loss: 1.229, Test accuracy: 68.00
Round  89, Global train loss: 0.340, Global test loss: 1.535, Global test accuracy: 58.88
Round  90, Train loss: 0.415, Test loss: 1.214, Test accuracy: 68.46
Round  90, Global train loss: 0.415, Global test loss: 1.539, Global test accuracy: 58.92
Round  91, Train loss: 0.407, Test loss: 1.254, Test accuracy: 67.71
Round  91, Global train loss: 0.407, Global test loss: 1.378, Global test accuracy: 58.78
Round  92, Train loss: 0.365, Test loss: 1.209, Test accuracy: 68.36
Round  92, Global train loss: 0.365, Global test loss: 1.473, Global test accuracy: 58.92
Round  93, Train loss: 0.537, Test loss: 1.229, Test accuracy: 67.92
Round  93, Global train loss: 0.537, Global test loss: 1.510, Global test accuracy: 56.88
Round  94, Train loss: 0.431, Test loss: 1.193, Test accuracy: 68.77
Round  94, Global train loss: 0.431, Global test loss: 1.472, Global test accuracy: 56.55
Round  95, Train loss: 0.338, Test loss: 1.201, Test accuracy: 68.76
Round  95, Global train loss: 0.338, Global test loss: 1.283, Global test accuracy: 63.15
Round  96, Train loss: 0.361, Test loss: 1.216, Test accuracy: 68.47
Round  96, Global train loss: 0.361, Global test loss: 1.588, Global test accuracy: 57.88
Round  97, Train loss: 0.425, Test loss: 1.235, Test accuracy: 68.56
Round  97, Global train loss: 0.425, Global test loss: 1.406, Global test accuracy: 60.66
Round  98, Train loss: 0.459, Test loss: 1.248, Test accuracy: 68.99
Round  98, Global train loss: 0.459, Global test loss: 1.403, Global test accuracy: 59.09
Round  99, Train loss: 0.407, Test loss: 1.278, Test accuracy: 68.51
Round  99, Global train loss: 0.407, Global test loss: 1.489, Global test accuracy: 57.93
Final Round, Train loss: 0.305, Test loss: 1.388, Test accuracy: 68.16
Final Round, Global train loss: 0.305, Global test loss: 1.489, Global test accuracy: 57.93
Average accuracy final 10 rounds: 68.45100000000001 

Average global accuracy final 10 rounds: 58.876000000000005 

1430.120329618454
[1.4931972026824951, 2.9863944053649902, 4.207803010940552, 5.429211616516113, 6.6685402393341064, 7.9078688621521, 9.14346981048584, 10.37907075881958, 11.619109630584717, 12.859148502349854, 14.09737753868103, 15.335606575012207, 16.57307267189026, 17.81053876876831, 19.04961395263672, 20.288689136505127, 21.53419589996338, 22.77970266342163, 24.026775121688843, 25.273847579956055, 26.515820741653442, 27.75779390335083, 29.00056552886963, 30.243337154388428, 31.488507747650146, 32.733678340911865, 33.976839780807495, 35.220001220703125, 36.455716133117676, 37.69143104553223, 38.93111824989319, 40.17080545425415, 41.41309428215027, 42.65538311004639, 43.893985986709595, 45.1325888633728, 46.37546992301941, 47.618350982666016, 48.85878086090088, 50.09921073913574, 51.33228421211243, 52.56535768508911, 53.80085730552673, 55.036356925964355, 56.27543330192566, 57.51450967788696, 58.7532742023468, 59.99203872680664, 61.2275071144104, 62.46297550201416, 63.700541973114014, 64.93810844421387, 66.17459321022034, 67.4110779762268, 68.64591479301453, 69.88075160980225, 71.1133041381836, 72.34585666656494, 73.5745837688446, 74.80331087112427, 75.9624810218811, 77.12165117263794, 78.338139295578, 79.55462741851807, 80.79309582710266, 82.03156423568726, 83.26507091522217, 84.49857759475708, 85.69554781913757, 86.89251804351807, 88.09441304206848, 89.2963080406189, 90.51954388618469, 91.74277973175049, 92.96574759483337, 94.18871545791626, 95.41397547721863, 96.639235496521, 97.86527466773987, 99.09131383895874, 100.31752300262451, 101.54373216629028, 102.7658863067627, 103.98804044723511, 105.20749306678772, 106.42694568634033, 107.65251541137695, 108.87808513641357, 110.1061794757843, 111.33427381515503, 112.56822443008423, 113.80217504501343, 115.04514980316162, 116.28812456130981, 117.52357482910156, 118.75902509689331, 119.99480438232422, 121.23058366775513, 122.46264791488647, 123.69471216201782, 124.93568897247314, 126.17666578292847, 127.41371035575867, 128.65075492858887, 129.8783574104309, 131.10595989227295, 132.33448147773743, 133.5630030632019, 134.79212141036987, 136.02123975753784, 137.25671863555908, 138.49219751358032, 139.72265076637268, 140.95310401916504, 142.18346047401428, 143.41381692886353, 144.64993834495544, 145.88605976104736, 147.12961792945862, 148.37317609786987, 149.61378502845764, 150.8543939590454, 152.09127926826477, 153.32816457748413, 154.5615701675415, 155.79497575759888, 157.03101634979248, 158.26705694198608, 159.50598669052124, 160.7449164390564, 161.98190474510193, 163.21889305114746, 164.45231437683105, 165.68573570251465, 166.9207649230957, 168.15579414367676, 169.38876032829285, 170.62172651290894, 171.85659551620483, 173.09146451950073, 174.31431484222412, 175.5371651649475, 176.7613227367401, 177.98548030853271, 179.21142530441284, 180.43737030029297, 181.67626428604126, 182.91515827178955, 184.14527940750122, 185.3754005432129, 186.60882830619812, 187.84225606918335, 189.06272196769714, 190.28318786621094, 191.50307512283325, 192.72296237945557, 193.95122122764587, 195.17948007583618, 196.40119314193726, 197.62290620803833, 198.84613823890686, 200.0693702697754, 201.29233574867249, 202.51530122756958, 203.73697996139526, 204.95865869522095, 206.1820137500763, 207.40536880493164, 208.644348859787, 209.88332891464233, 211.12498664855957, 212.3666443824768, 213.59901928901672, 214.83139419555664, 216.0651171207428, 217.29884004592896, 218.53128695487976, 219.76373386383057, 221.00270342826843, 222.2416729927063, 223.47712802886963, 224.71258306503296, 225.94596529006958, 227.1793475151062, 228.40668845176697, 229.63402938842773, 230.8683009147644, 232.10257244110107, 233.3497428894043, 234.59691333770752, 235.82720160484314, 237.05748987197876, 238.28860330581665, 239.51971673965454, 240.7476933002472, 241.97566986083984, 243.2148814201355, 244.45409297943115, 245.68204760551453, 246.9100022315979, 249.39283514022827, 251.87566804885864]
[23.94, 23.94, 31.24, 31.24, 37.95, 37.95, 42.19, 42.19, 47.82, 47.82, 51.83, 51.83, 53.21, 53.21, 53.56, 53.56, 53.92, 53.92, 55.67, 55.67, 56.91, 56.91, 57.91, 57.91, 59.35, 59.35, 59.81, 59.81, 59.25, 59.25, 59.87, 59.87, 60.54, 60.54, 61.33, 61.33, 61.47, 61.47, 61.94, 61.94, 62.27, 62.27, 62.5, 62.5, 63.04, 63.04, 63.58, 63.58, 63.17, 63.17, 63.41, 63.41, 62.51, 62.51, 63.86, 63.86, 64.97, 64.97, 64.59, 64.59, 65.84, 65.84, 65.71, 65.71, 65.34, 65.34, 65.38, 65.38, 64.72, 64.72, 65.15, 65.15, 65.48, 65.48, 66.02, 66.02, 66.47, 66.47, 66.01, 66.01, 66.02, 66.02, 65.92, 65.92, 66.24, 66.24, 66.47, 66.47, 66.5, 66.5, 66.7, 66.7, 65.7, 65.7, 65.83, 65.83, 66.49, 66.49, 65.85, 65.85, 65.99, 65.99, 66.6, 66.6, 66.82, 66.82, 66.88, 66.88, 66.57, 66.57, 67.55, 67.55, 67.04, 67.04, 67.06, 67.06, 67.0, 67.0, 67.23, 67.23, 66.88, 66.88, 67.3, 67.3, 66.57, 66.57, 67.45, 67.45, 67.31, 67.31, 67.16, 67.16, 67.26, 67.26, 67.6, 67.6, 67.39, 67.39, 67.1, 67.1, 67.44, 67.44, 67.62, 67.62, 67.57, 67.57, 67.88, 67.88, 67.64, 67.64, 67.55, 67.55, 68.05, 68.05, 68.12, 68.12, 67.76, 67.76, 68.12, 68.12, 68.03, 68.03, 68.48, 68.48, 68.3, 68.3, 67.8, 67.8, 67.72, 67.72, 68.29, 68.29, 68.2, 68.2, 68.59, 68.59, 68.1, 68.1, 68.0, 68.0, 68.46, 68.46, 67.71, 67.71, 68.36, 68.36, 67.92, 67.92, 68.77, 68.77, 68.76, 68.76, 68.47, 68.47, 68.56, 68.56, 68.99, 68.99, 68.51, 68.51, 68.16, 68.16]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 12, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.600, Test loss: 2.068, Test accuracy: 24.52
Round   0, Global train loss: 1.600, Global test loss: 2.253, Global test accuracy: 21.86
Round   1, Train loss: 1.511, Test loss: 1.816, Test accuracy: 30.97
Round   1, Global train loss: 1.511, Global test loss: 2.087, Global test accuracy: 25.21
Round   2, Train loss: 1.501, Test loss: 1.625, Test accuracy: 38.24
Round   2, Global train loss: 1.501, Global test loss: 2.129, Global test accuracy: 20.12
Round   3, Train loss: 1.326, Test loss: 1.530, Test accuracy: 39.54
Round   3, Global train loss: 1.326, Global test loss: 1.957, Global test accuracy: 25.03
Round   4, Train loss: 1.322, Test loss: 1.384, Test accuracy: 46.47
Round   4, Global train loss: 1.322, Global test loss: 1.941, Global test accuracy: 29.19
Round   5, Train loss: 1.224, Test loss: 1.302, Test accuracy: 49.58
Round   5, Global train loss: 1.224, Global test loss: 1.822, Global test accuracy: 33.91
Round   6, Train loss: 1.192, Test loss: 1.254, Test accuracy: 51.38
Round   6, Global train loss: 1.192, Global test loss: 1.663, Global test accuracy: 40.61
Round   7, Train loss: 1.085, Test loss: 1.245, Test accuracy: 52.02
Round   7, Global train loss: 1.085, Global test loss: 1.620, Global test accuracy: 42.46
Round   8, Train loss: 1.153, Test loss: 1.242, Test accuracy: 52.88
Round   8, Global train loss: 1.153, Global test loss: 1.722, Global test accuracy: 35.29
Round   9, Train loss: 1.111, Test loss: 1.214, Test accuracy: 54.00
Round   9, Global train loss: 1.111, Global test loss: 1.693, Global test accuracy: 40.32
Round  10, Train loss: 1.156, Test loss: 1.187, Test accuracy: 54.31
Round  10, Global train loss: 1.156, Global test loss: 1.609, Global test accuracy: 40.22
Round  11, Train loss: 1.064, Test loss: 1.147, Test accuracy: 56.01
Round  11, Global train loss: 1.064, Global test loss: 1.681, Global test accuracy: 41.33
Round  12, Train loss: 1.178, Test loss: 1.138, Test accuracy: 56.73
Round  12, Global train loss: 1.178, Global test loss: 1.542, Global test accuracy: 44.28
Round  13, Train loss: 0.979, Test loss: 1.106, Test accuracy: 58.22
Round  13, Global train loss: 0.979, Global test loss: 1.599, Global test accuracy: 47.05
Round  14, Train loss: 1.103, Test loss: 1.094, Test accuracy: 58.14
Round  14, Global train loss: 1.103, Global test loss: 1.497, Global test accuracy: 47.90
Round  15, Train loss: 1.010, Test loss: 1.103, Test accuracy: 58.10
Round  15, Global train loss: 1.010, Global test loss: 1.493, Global test accuracy: 47.07
Round  16, Train loss: 0.909, Test loss: 1.101, Test accuracy: 59.01
Round  16, Global train loss: 0.909, Global test loss: 1.468, Global test accuracy: 49.11
Round  17, Train loss: 0.979, Test loss: 1.071, Test accuracy: 60.28
Round  17, Global train loss: 0.979, Global test loss: 1.629, Global test accuracy: 42.02
Round  18, Train loss: 0.987, Test loss: 1.061, Test accuracy: 60.39
Round  18, Global train loss: 0.987, Global test loss: 1.539, Global test accuracy: 46.05
Round  19, Train loss: 0.978, Test loss: 1.031, Test accuracy: 61.82
Round  19, Global train loss: 0.978, Global test loss: 1.456, Global test accuracy: 48.71
Round  20, Train loss: 0.960, Test loss: 1.032, Test accuracy: 62.11
Round  20, Global train loss: 0.960, Global test loss: 1.492, Global test accuracy: 47.80
Round  21, Train loss: 0.903, Test loss: 1.014, Test accuracy: 62.69
Round  21, Global train loss: 0.903, Global test loss: 1.481, Global test accuracy: 48.40
Round  22, Train loss: 0.840, Test loss: 1.008, Test accuracy: 62.97
Round  22, Global train loss: 0.840, Global test loss: 1.420, Global test accuracy: 50.60
Round  23, Train loss: 1.046, Test loss: 0.996, Test accuracy: 63.61
Round  23, Global train loss: 1.046, Global test loss: 1.589, Global test accuracy: 45.36
Round  24, Train loss: 0.837, Test loss: 0.999, Test accuracy: 63.86
Round  24, Global train loss: 0.837, Global test loss: 1.527, Global test accuracy: 46.28
Round  25, Train loss: 0.903, Test loss: 0.998, Test accuracy: 63.92
Round  25, Global train loss: 0.903, Global test loss: 1.354, Global test accuracy: 52.91
Round  26, Train loss: 0.886, Test loss: 1.020, Test accuracy: 63.65
Round  26, Global train loss: 0.886, Global test loss: 1.389, Global test accuracy: 51.47
Round  27, Train loss: 1.027, Test loss: 0.988, Test accuracy: 64.82
Round  27, Global train loss: 1.027, Global test loss: 1.401, Global test accuracy: 51.06
Round  28, Train loss: 0.961, Test loss: 0.991, Test accuracy: 64.26
Round  28, Global train loss: 0.961, Global test loss: 1.430, Global test accuracy: 50.17
Round  29, Train loss: 0.891, Test loss: 0.988, Test accuracy: 64.12
Round  29, Global train loss: 0.891, Global test loss: 1.409, Global test accuracy: 51.46
Round  30, Train loss: 0.846, Test loss: 0.968, Test accuracy: 65.03
Round  30, Global train loss: 0.846, Global test loss: 1.483, Global test accuracy: 48.17
Round  31, Train loss: 0.838, Test loss: 0.993, Test accuracy: 64.69
Round  31, Global train loss: 0.838, Global test loss: 1.503, Global test accuracy: 47.89
Round  32, Train loss: 0.873, Test loss: 0.988, Test accuracy: 65.31
Round  32, Global train loss: 0.873, Global test loss: 1.475, Global test accuracy: 49.28
Round  33, Train loss: 0.723, Test loss: 0.999, Test accuracy: 64.93
Round  33, Global train loss: 0.723, Global test loss: 1.321, Global test accuracy: 55.17
Round  34, Train loss: 0.752, Test loss: 0.995, Test accuracy: 64.93
Round  34, Global train loss: 0.752, Global test loss: 1.273, Global test accuracy: 56.81
Round  35, Train loss: 0.803, Test loss: 0.986, Test accuracy: 65.54
Round  35, Global train loss: 0.803, Global test loss: 1.369, Global test accuracy: 53.50
Round  36, Train loss: 0.641, Test loss: 0.993, Test accuracy: 65.33
Round  36, Global train loss: 0.641, Global test loss: 1.556, Global test accuracy: 51.47
Round  37, Train loss: 0.794, Test loss: 0.989, Test accuracy: 65.21
Round  37, Global train loss: 0.794, Global test loss: 1.413, Global test accuracy: 50.89
Round  38, Train loss: 0.682, Test loss: 0.965, Test accuracy: 65.90
Round  38, Global train loss: 0.682, Global test loss: 1.386, Global test accuracy: 54.98
Round  39, Train loss: 0.720, Test loss: 0.982, Test accuracy: 66.11
Round  39, Global train loss: 0.720, Global test loss: 1.342, Global test accuracy: 54.09
Round  40, Train loss: 0.773, Test loss: 0.963, Test accuracy: 66.74
Round  40, Global train loss: 0.773, Global test loss: 1.263, Global test accuracy: 57.72
Round  41, Train loss: 0.721, Test loss: 0.964, Test accuracy: 66.44
Round  41, Global train loss: 0.721, Global test loss: 1.288, Global test accuracy: 56.35
Round  42, Train loss: 0.759, Test loss: 0.955, Test accuracy: 66.82
Round  42, Global train loss: 0.759, Global test loss: 1.298, Global test accuracy: 56.57
Round  43, Train loss: 0.795, Test loss: 0.959, Test accuracy: 67.06
Round  43, Global train loss: 0.795, Global test loss: 1.357, Global test accuracy: 52.62
Round  44, Train loss: 0.713, Test loss: 0.962, Test accuracy: 67.57
Round  44, Global train loss: 0.713, Global test loss: 1.367, Global test accuracy: 54.37
Round  45, Train loss: 0.668, Test loss: 0.942, Test accuracy: 68.15
Round  45, Global train loss: 0.668, Global test loss: 1.275, Global test accuracy: 57.60
Round  46, Train loss: 0.645, Test loss: 0.959, Test accuracy: 67.68
Round  46, Global train loss: 0.645, Global test loss: 1.337, Global test accuracy: 56.43
Round  47, Train loss: 0.700, Test loss: 0.958, Test accuracy: 67.72
Round  47, Global train loss: 0.700, Global test loss: 1.271, Global test accuracy: 57.25
Round  48, Train loss: 0.756, Test loss: 0.996, Test accuracy: 66.53
Round  48, Global train loss: 0.756, Global test loss: 1.300, Global test accuracy: 57.41
Round  49, Train loss: 0.669, Test loss: 0.975, Test accuracy: 67.39
Round  49, Global train loss: 0.669, Global test loss: 1.228, Global test accuracy: 58.99
Round  50, Train loss: 0.705, Test loss: 0.990, Test accuracy: 67.06
Round  50, Global train loss: 0.705, Global test loss: 1.204, Global test accuracy: 58.39
Round  51, Train loss: 0.634, Test loss: 0.986, Test accuracy: 67.38
Round  51, Global train loss: 0.634, Global test loss: 1.295, Global test accuracy: 57.68
Round  52, Train loss: 0.678, Test loss: 0.980, Test accuracy: 67.73
Round  52, Global train loss: 0.678, Global test loss: 1.380, Global test accuracy: 56.81
Round  53, Train loss: 0.599, Test loss: 0.992, Test accuracy: 67.73
Round  53, Global train loss: 0.599, Global test loss: 1.384, Global test accuracy: 55.81
Round  54, Train loss: 0.645, Test loss: 1.020, Test accuracy: 67.61
Round  54, Global train loss: 0.645, Global test loss: 1.262, Global test accuracy: 57.36
Round  55, Train loss: 0.675, Test loss: 1.011, Test accuracy: 67.54
Round  55, Global train loss: 0.675, Global test loss: 1.388, Global test accuracy: 55.28
Round  56, Train loss: 0.606, Test loss: 1.018, Test accuracy: 67.51
Round  56, Global train loss: 0.606, Global test loss: 1.341, Global test accuracy: 57.98
Round  57, Train loss: 0.537, Test loss: 1.007, Test accuracy: 67.66
Round  57, Global train loss: 0.537, Global test loss: 1.271, Global test accuracy: 59.29
Round  58, Train loss: 0.633, Test loss: 1.002, Test accuracy: 67.91
Round  58, Global train loss: 0.633, Global test loss: 1.308, Global test accuracy: 57.86
Round  59, Train loss: 0.499, Test loss: 0.996, Test accuracy: 67.86
Round  59, Global train loss: 0.499, Global test loss: 1.390, Global test accuracy: 57.36
Round  60, Train loss: 0.603, Test loss: 1.013, Test accuracy: 67.86
Round  60, Global train loss: 0.603, Global test loss: 1.200, Global test accuracy: 59.94
Round  61, Train loss: 0.524, Test loss: 1.026, Test accuracy: 67.48
Round  61, Global train loss: 0.524, Global test loss: 1.303, Global test accuracy: 58.35
Round  62, Train loss: 0.573, Test loss: 1.019, Test accuracy: 67.82
Round  62, Global train loss: 0.573, Global test loss: 1.325, Global test accuracy: 58.01
Round  63, Train loss: 0.567, Test loss: 1.003, Test accuracy: 68.36
Round  63, Global train loss: 0.567, Global test loss: 1.370, Global test accuracy: 57.96
Round  64, Train loss: 0.610, Test loss: 1.022, Test accuracy: 68.11
Round  64, Global train loss: 0.610, Global test loss: 1.280, Global test accuracy: 58.29
Round  65, Train loss: 0.606, Test loss: 1.012, Test accuracy: 68.24
Round  65, Global train loss: 0.606, Global test loss: 1.291, Global test accuracy: 58.27
Round  66, Train loss: 0.591, Test loss: 1.014, Test accuracy: 68.24
Round  66, Global train loss: 0.591, Global test loss: 1.265, Global test accuracy: 59.60
Round  67, Train loss: 0.572, Test loss: 1.020, Test accuracy: 68.29
Round  67, Global train loss: 0.572, Global test loss: 1.248, Global test accuracy: 59.12
Round  68, Train loss: 0.551, Test loss: 1.008, Test accuracy: 68.02
Round  68, Global train loss: 0.551, Global test loss: 1.452, Global test accuracy: 55.78
Round  69, Train loss: 0.580, Test loss: 1.030, Test accuracy: 67.73
Round  69, Global train loss: 0.580, Global test loss: 1.257, Global test accuracy: 59.82
Round  70, Train loss: 0.549, Test loss: 1.034, Test accuracy: 68.15
Round  70, Global train loss: 0.549, Global test loss: 1.245, Global test accuracy: 61.38
Round  71, Train loss: 0.488, Test loss: 1.045, Test accuracy: 67.93
Round  71, Global train loss: 0.488, Global test loss: 1.287, Global test accuracy: 59.96
Round  72, Train loss: 0.452, Test loss: 1.056, Test accuracy: 67.99
Round  72, Global train loss: 0.452, Global test loss: 1.315, Global test accuracy: 59.72
Round  73, Train loss: 0.471, Test loss: 1.048, Test accuracy: 68.18
Round  73, Global train loss: 0.471, Global test loss: 1.359, Global test accuracy: 58.75
Round  74, Train loss: 0.485, Test loss: 1.063, Test accuracy: 68.39
Round  74, Global train loss: 0.485, Global test loss: 1.367, Global test accuracy: 58.25
Round  75, Train loss: 0.517, Test loss: 1.079, Test accuracy: 68.67
Round  75, Global train loss: 0.517, Global test loss: 1.465, Global test accuracy: 55.91
Round  76, Train loss: 0.543, Test loss: 1.089, Test accuracy: 68.33
Round  76, Global train loss: 0.543, Global test loss: 1.269, Global test accuracy: 58.66
Round  77, Train loss: 0.437, Test loss: 1.107, Test accuracy: 67.91
Round  77, Global train loss: 0.437, Global test loss: 1.323, Global test accuracy: 59.60
Round  78, Train loss: 0.467, Test loss: 1.115, Test accuracy: 67.95
Round  78, Global train loss: 0.467, Global test loss: 1.448, Global test accuracy: 56.88
Round  79, Train loss: 0.595, Test loss: 1.125, Test accuracy: 68.51
Round  79, Global train loss: 0.595, Global test loss: 1.217, Global test accuracy: 61.18
Round  80, Train loss: 0.474, Test loss: 1.105, Test accuracy: 68.57
Round  80, Global train loss: 0.474, Global test loss: 1.340, Global test accuracy: 59.14
Round  81, Train loss: 0.548, Test loss: 1.077, Test accuracy: 69.01
Round  81, Global train loss: 0.548, Global test loss: 1.334, Global test accuracy: 58.95
Round  82, Train loss: 0.508, Test loss: 1.076, Test accuracy: 68.99
Round  82, Global train loss: 0.508, Global test loss: 1.291, Global test accuracy: 59.33
Round  83, Train loss: 0.469, Test loss: 1.094, Test accuracy: 68.90
Round  83, Global train loss: 0.469, Global test loss: 1.345, Global test accuracy: 58.54
Round  84, Train loss: 0.419, Test loss: 1.111, Test accuracy: 68.96
Round  84, Global train loss: 0.419, Global test loss: 1.311, Global test accuracy: 60.08
Round  85, Train loss: 0.504, Test loss: 1.089, Test accuracy: 68.81
Round  85, Global train loss: 0.504, Global test loss: 1.300, Global test accuracy: 59.67
Round  86, Train loss: 0.496, Test loss: 1.082, Test accuracy: 69.51
Round  86, Global train loss: 0.496, Global test loss: 1.313, Global test accuracy: 59.89
Round  87, Train loss: 0.473, Test loss: 1.066, Test accuracy: 69.77
Round  87, Global train loss: 0.473, Global test loss: 1.265, Global test accuracy: 60.75
Round  88, Train loss: 0.499, Test loss: 1.066, Test accuracy: 69.42
Round  88, Global train loss: 0.499, Global test loss: 1.283, Global test accuracy: 59.81
Round  89, Train loss: 0.419, Test loss: 1.090, Test accuracy: 69.21
Round  89, Global train loss: 0.419, Global test loss: 1.399, Global test accuracy: 59.19
Round  90, Train loss: 0.474, Test loss: 1.107, Test accuracy: 68.68
Round  90, Global train loss: 0.474, Global test loss: 1.503, Global test accuracy: 57.99
Round  91, Train loss: 0.426, Test loss: 1.119, Test accuracy: 68.56
Round  91, Global train loss: 0.426, Global test loss: 1.390, Global test accuracy: 59.42
Round  92, Train loss: 0.461, Test loss: 1.079, Test accuracy: 69.62
Round  92, Global train loss: 0.461, Global test loss: 1.369, Global test accuracy: 59.31
Round  93, Train loss: 0.470, Test loss: 1.095, Test accuracy: 69.21
Round  93, Global train loss: 0.470, Global test loss: 1.369, Global test accuracy: 58.53/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  94, Train loss: 0.470, Test loss: 1.117, Test accuracy: 69.02
Round  94, Global train loss: 0.470, Global test loss: 1.354, Global test accuracy: 59.28
Round  95, Train loss: 0.497, Test loss: 1.109, Test accuracy: 69.25
Round  95, Global train loss: 0.497, Global test loss: 1.404, Global test accuracy: 59.63
Round  96, Train loss: 0.393, Test loss: 1.127, Test accuracy: 68.95
Round  96, Global train loss: 0.393, Global test loss: 1.501, Global test accuracy: 58.01
Round  97, Train loss: 0.454, Test loss: 1.138, Test accuracy: 68.72
Round  97, Global train loss: 0.454, Global test loss: 1.325, Global test accuracy: 60.39
Round  98, Train loss: 0.486, Test loss: 1.146, Test accuracy: 68.85
Round  98, Global train loss: 0.486, Global test loss: 1.303, Global test accuracy: 60.70
Round  99, Train loss: 0.385, Test loss: 1.125, Test accuracy: 69.23
Round  99, Global train loss: 0.385, Global test loss: 1.327, Global test accuracy: 60.22
Final Round, Train loss: 0.342, Test loss: 1.184, Test accuracy: 69.35
Final Round, Global train loss: 0.342, Global test loss: 1.327, Global test accuracy: 60.22
Average accuracy final 10 rounds: 69.009 

Average global accuracy final 10 rounds: 59.348 

1471.3324592113495
[1.588935136795044, 3.177870273590088, 4.476110219955444, 5.774350166320801, 7.08463978767395, 8.3949294090271, 9.710924863815308, 11.026920318603516, 12.335708379745483, 13.644496440887451, 14.952519416809082, 16.260542392730713, 17.5726478099823, 18.884753227233887, 20.192569494247437, 21.500385761260986, 22.82690191268921, 24.15341806411743, 25.46947169303894, 26.78552532196045, 28.130032300949097, 29.474539279937744, 30.802692413330078, 32.13084554672241, 33.442272901535034, 34.753700256347656, 36.06980276107788, 37.385905265808105, 38.71186828613281, 40.03783130645752, 41.356226444244385, 42.67462158203125, 43.97452425956726, 45.27442693710327, 46.579991817474365, 47.88555669784546, 49.20329022407532, 50.521023750305176, 51.85310196876526, 53.18518018722534, 54.51168417930603, 55.83818817138672, 57.14606785774231, 58.4539475440979, 59.734018325805664, 61.01408910751343, 62.33236384391785, 63.650638580322266, 64.93789744377136, 66.22515630722046, 67.51395440101624, 68.80275249481201, 70.09669065475464, 71.39062881469727, 72.72451591491699, 74.05840301513672, 75.34359121322632, 76.62877941131592, 77.91474890708923, 79.20071840286255, 80.48663640022278, 81.77255439758301, 83.06960535049438, 84.36665630340576, 85.65558314323425, 86.94450998306274, 88.2306957244873, 89.51688146591187, 90.81526160240173, 92.1136417388916, 93.43141889572144, 94.74919605255127, 96.04958844184875, 97.34998083114624, 98.65256786346436, 99.95515489578247, 101.24667763710022, 102.53820037841797, 103.83266043663025, 105.12712049484253, 106.41648530960083, 107.70585012435913, 108.99907279014587, 110.29229545593262, 111.57819533348083, 112.86409521102905, 114.15500998497009, 115.44592475891113, 116.76348972320557, 118.0810546875, 119.36200428009033, 120.64295387268066, 121.93940305709839, 123.23585224151611, 124.52579092979431, 125.81572961807251, 127.13536143302917, 128.45499324798584, 129.7530815601349, 131.05116987228394, 132.34523963928223, 133.63930940628052, 134.92769384384155, 136.2160782814026, 137.5138876438141, 138.8116970062256, 140.1290843486786, 141.4464716911316, 142.7397222518921, 144.0329728126526, 145.32502245903015, 146.61707210540771, 147.90193486213684, 149.18679761886597, 150.50269055366516, 151.81858348846436, 153.09564661979675, 154.37270975112915, 155.6527214050293, 156.93273305892944, 158.22315526008606, 159.51357746124268, 160.8323884010315, 162.1511993408203, 163.45813179016113, 164.76506423950195, 166.04625177383423, 167.3274393081665, 168.6210377216339, 169.91463613510132, 171.21963477134705, 172.52463340759277, 173.80648016929626, 175.08832693099976, 176.3871955871582, 177.68606424331665, 178.99398970603943, 180.3019151687622, 181.5982322692871, 182.894549369812, 184.18301939964294, 185.47148942947388, 186.8035056591034, 188.1355218887329, 189.4394359588623, 190.7433500289917, 192.02583765983582, 193.30832529067993, 194.63281321525574, 195.95730113983154, 197.24454474449158, 198.5317883491516, 199.82692623138428, 201.12206411361694, 202.4114053249359, 203.70074653625488, 205.02482438087463, 206.34890222549438, 207.64291048049927, 208.93691873550415, 210.22650504112244, 211.51609134674072, 212.8019676208496, 214.0878438949585, 215.3769335746765, 216.66602325439453, 217.95287942886353, 219.23973560333252, 220.52348637580872, 221.8072371482849, 223.0914216041565, 224.37560606002808, 225.6604664325714, 226.94532680511475, 228.2745976448059, 229.60386848449707, 230.89896726608276, 232.19406604766846, 233.5139925479889, 234.83391904830933, 236.12905025482178, 237.42418146133423, 238.7641088962555, 240.10403633117676, 241.3944857120514, 242.68493509292603, 243.9855351448059, 245.2861351966858, 246.5879991054535, 247.8898630142212, 249.2161705493927, 250.5424780845642, 251.84854197502136, 253.15460586547852, 254.45140075683594, 255.74819564819336, 257.0783634185791, 258.40853118896484, 259.71513748168945, 261.02174377441406, 263.671914100647, 266.3220844268799]
[24.52, 24.52, 30.97, 30.97, 38.24, 38.24, 39.54, 39.54, 46.47, 46.47, 49.58, 49.58, 51.38, 51.38, 52.02, 52.02, 52.88, 52.88, 54.0, 54.0, 54.31, 54.31, 56.01, 56.01, 56.73, 56.73, 58.22, 58.22, 58.14, 58.14, 58.1, 58.1, 59.01, 59.01, 60.28, 60.28, 60.39, 60.39, 61.82, 61.82, 62.11, 62.11, 62.69, 62.69, 62.97, 62.97, 63.61, 63.61, 63.86, 63.86, 63.92, 63.92, 63.65, 63.65, 64.82, 64.82, 64.26, 64.26, 64.12, 64.12, 65.03, 65.03, 64.69, 64.69, 65.31, 65.31, 64.93, 64.93, 64.93, 64.93, 65.54, 65.54, 65.33, 65.33, 65.21, 65.21, 65.9, 65.9, 66.11, 66.11, 66.74, 66.74, 66.44, 66.44, 66.82, 66.82, 67.06, 67.06, 67.57, 67.57, 68.15, 68.15, 67.68, 67.68, 67.72, 67.72, 66.53, 66.53, 67.39, 67.39, 67.06, 67.06, 67.38, 67.38, 67.73, 67.73, 67.73, 67.73, 67.61, 67.61, 67.54, 67.54, 67.51, 67.51, 67.66, 67.66, 67.91, 67.91, 67.86, 67.86, 67.86, 67.86, 67.48, 67.48, 67.82, 67.82, 68.36, 68.36, 68.11, 68.11, 68.24, 68.24, 68.24, 68.24, 68.29, 68.29, 68.02, 68.02, 67.73, 67.73, 68.15, 68.15, 67.93, 67.93, 67.99, 67.99, 68.18, 68.18, 68.39, 68.39, 68.67, 68.67, 68.33, 68.33, 67.91, 67.91, 67.95, 67.95, 68.51, 68.51, 68.57, 68.57, 69.01, 69.01, 68.99, 68.99, 68.9, 68.9, 68.96, 68.96, 68.81, 68.81, 69.51, 69.51, 69.77, 69.77, 69.42, 69.42, 69.21, 69.21, 68.68, 68.68, 68.56, 68.56, 69.62, 69.62, 69.21, 69.21, 69.02, 69.02, 69.25, 69.25, 68.95, 68.95, 68.72, 68.72, 68.85, 68.85, 69.23, 69.23, 69.35, 69.35]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 13, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.572, Test loss: 2.211, Test accuracy: 21.64
Round   0, Global train loss: 1.572, Global test loss: 2.384, Global test accuracy: 17.76
Round   1, Train loss: 1.539, Test loss: 1.855, Test accuracy: 29.33
Round   1, Global train loss: 1.539, Global test loss: 2.143, Global test accuracy: 23.16
Round   2, Train loss: 1.455, Test loss: 1.673, Test accuracy: 37.25
Round   2, Global train loss: 1.455, Global test loss: 2.330, Global test accuracy: 19.68
Round   3, Train loss: 1.299, Test loss: 1.493, Test accuracy: 39.44
Round   3, Global train loss: 1.299, Global test loss: 1.924, Global test accuracy: 26.93
Round   4, Train loss: 1.313, Test loss: 1.353, Test accuracy: 46.25
Round   4, Global train loss: 1.313, Global test loss: 1.826, Global test accuracy: 32.01
Round   5, Train loss: 1.185, Test loss: 1.288, Test accuracy: 50.22
Round   5, Global train loss: 1.185, Global test loss: 1.875, Global test accuracy: 34.45
Round   6, Train loss: 1.223, Test loss: 1.238, Test accuracy: 53.08
Round   6, Global train loss: 1.223, Global test loss: 1.682, Global test accuracy: 40.35
Round   7, Train loss: 1.064, Test loss: 1.224, Test accuracy: 53.77
Round   7, Global train loss: 1.064, Global test loss: 1.724, Global test accuracy: 40.14
Round   8, Train loss: 1.184, Test loss: 1.222, Test accuracy: 54.09
Round   8, Global train loss: 1.184, Global test loss: 1.813, Global test accuracy: 35.18
Round   9, Train loss: 1.070, Test loss: 1.209, Test accuracy: 54.86
Round   9, Global train loss: 1.070, Global test loss: 1.831, Global test accuracy: 36.76
Round  10, Train loss: 1.083, Test loss: 1.192, Test accuracy: 55.77
Round  10, Global train loss: 1.083, Global test loss: 1.668, Global test accuracy: 41.87
Round  11, Train loss: 0.955, Test loss: 1.183, Test accuracy: 56.58
Round  11, Global train loss: 0.955, Global test loss: 1.708, Global test accuracy: 43.62
Round  12, Train loss: 1.149, Test loss: 1.181, Test accuracy: 56.54
Round  12, Global train loss: 1.149, Global test loss: 1.614, Global test accuracy: 42.11
Round  13, Train loss: 0.921, Test loss: 1.137, Test accuracy: 58.11
Round  13, Global train loss: 0.921, Global test loss: 1.646, Global test accuracy: 46.51
Round  14, Train loss: 1.048, Test loss: 1.103, Test accuracy: 59.16
Round  14, Global train loss: 1.048, Global test loss: 1.582, Global test accuracy: 44.57
Round  15, Train loss: 0.964, Test loss: 1.098, Test accuracy: 59.70
Round  15, Global train loss: 0.964, Global test loss: 1.508, Global test accuracy: 45.64
Round  16, Train loss: 0.872, Test loss: 1.080, Test accuracy: 60.38
Round  16, Global train loss: 0.872, Global test loss: 1.569, Global test accuracy: 47.37
Round  17, Train loss: 0.940, Test loss: 1.077, Test accuracy: 60.48
Round  17, Global train loss: 0.940, Global test loss: 1.510, Global test accuracy: 45.45
Round  18, Train loss: 0.921, Test loss: 1.047, Test accuracy: 61.45
Round  18, Global train loss: 0.921, Global test loss: 1.510, Global test accuracy: 47.41
Round  19, Train loss: 0.989, Test loss: 1.032, Test accuracy: 61.88
Round  19, Global train loss: 0.989, Global test loss: 1.455, Global test accuracy: 49.00
Round  20, Train loss: 0.901, Test loss: 1.029, Test accuracy: 62.41
Round  20, Global train loss: 0.901, Global test loss: 1.507, Global test accuracy: 47.84
Round  21, Train loss: 0.831, Test loss: 1.015, Test accuracy: 62.79
Round  21, Global train loss: 0.831, Global test loss: 1.421, Global test accuracy: 49.02
Round  22, Train loss: 0.838, Test loss: 0.999, Test accuracy: 63.90
Round  22, Global train loss: 0.838, Global test loss: 1.475, Global test accuracy: 49.33
Round  23, Train loss: 0.941, Test loss: 0.996, Test accuracy: 64.14
Round  23, Global train loss: 0.941, Global test loss: 1.796, Global test accuracy: 41.71
Round  24, Train loss: 0.840, Test loss: 0.992, Test accuracy: 64.47
Round  24, Global train loss: 0.840, Global test loss: 1.545, Global test accuracy: 46.28
Round  25, Train loss: 0.791, Test loss: 0.983, Test accuracy: 64.64
Round  25, Global train loss: 0.791, Global test loss: 1.342, Global test accuracy: 52.49
Round  26, Train loss: 0.798, Test loss: 0.983, Test accuracy: 64.74
Round  26, Global train loss: 0.798, Global test loss: 1.363, Global test accuracy: 52.29
Round  27, Train loss: 0.974, Test loss: 0.980, Test accuracy: 65.32
Round  27, Global train loss: 0.974, Global test loss: 1.430, Global test accuracy: 49.94
Round  28, Train loss: 0.872, Test loss: 0.994, Test accuracy: 64.96
Round  28, Global train loss: 0.872, Global test loss: 1.420, Global test accuracy: 49.44
Round  29, Train loss: 0.847, Test loss: 0.995, Test accuracy: 65.35
Round  29, Global train loss: 0.847, Global test loss: 1.279, Global test accuracy: 55.35
Round  30, Train loss: 0.836, Test loss: 1.011, Test accuracy: 65.10
Round  30, Global train loss: 0.836, Global test loss: 1.413, Global test accuracy: 52.14
Round  31, Train loss: 0.771, Test loss: 1.020, Test accuracy: 65.03
Round  31, Global train loss: 0.771, Global test loss: 1.479, Global test accuracy: 49.92
Round  32, Train loss: 0.838, Test loss: 1.010, Test accuracy: 65.52
Round  32, Global train loss: 0.838, Global test loss: 1.452, Global test accuracy: 48.88
Round  33, Train loss: 0.673, Test loss: 1.003, Test accuracy: 65.35
Round  33, Global train loss: 0.673, Global test loss: 1.303, Global test accuracy: 56.66
Round  34, Train loss: 0.628, Test loss: 1.033, Test accuracy: 65.23
Round  34, Global train loss: 0.628, Global test loss: 1.269, Global test accuracy: 56.78
Round  35, Train loss: 0.740, Test loss: 1.014, Test accuracy: 65.57
Round  35, Global train loss: 0.740, Global test loss: 1.484, Global test accuracy: 51.40
Round  36, Train loss: 0.589, Test loss: 1.007, Test accuracy: 65.86
Round  36, Global train loss: 0.589, Global test loss: 1.600, Global test accuracy: 50.18
Round  37, Train loss: 0.648, Test loss: 1.003, Test accuracy: 65.99
Round  37, Global train loss: 0.648, Global test loss: 1.398, Global test accuracy: 50.86
Round  38, Train loss: 0.694, Test loss: 1.006, Test accuracy: 66.04
Round  38, Global train loss: 0.694, Global test loss: 1.445, Global test accuracy: 53.15
Round  39, Train loss: 0.581, Test loss: 0.997, Test accuracy: 66.55
Round  39, Global train loss: 0.581, Global test loss: 1.307, Global test accuracy: 56.34
Round  40, Train loss: 0.628, Test loss: 0.998, Test accuracy: 66.56
Round  40, Global train loss: 0.628, Global test loss: 1.295, Global test accuracy: 58.33
Round  41, Train loss: 0.666, Test loss: 0.999, Test accuracy: 66.94
Round  41, Global train loss: 0.666, Global test loss: 1.374, Global test accuracy: 55.59
Round  42, Train loss: 0.673, Test loss: 1.018, Test accuracy: 66.93
Round  42, Global train loss: 0.673, Global test loss: 1.280, Global test accuracy: 55.82
Round  43, Train loss: 0.677, Test loss: 1.027, Test accuracy: 66.39
Round  43, Global train loss: 0.677, Global test loss: 1.527, Global test accuracy: 49.22
Round  44, Train loss: 0.623, Test loss: 1.021, Test accuracy: 66.24
Round  44, Global train loss: 0.623, Global test loss: 1.376, Global test accuracy: 55.09
Round  45, Train loss: 0.642, Test loss: 1.036, Test accuracy: 66.15
Round  45, Global train loss: 0.642, Global test loss: 1.282, Global test accuracy: 57.08
Round  46, Train loss: 0.598, Test loss: 1.024, Test accuracy: 66.69
Round  46, Global train loss: 0.598, Global test loss: 1.397, Global test accuracy: 55.28
Round  47, Train loss: 0.621, Test loss: 1.038, Test accuracy: 66.73
Round  47, Global train loss: 0.621, Global test loss: 1.298, Global test accuracy: 56.88
Round  48, Train loss: 0.762, Test loss: 1.038, Test accuracy: 67.16
Round  48, Global train loss: 0.762, Global test loss: 1.283, Global test accuracy: 57.53
Round  49, Train loss: 0.606, Test loss: 1.024, Test accuracy: 67.31
Round  49, Global train loss: 0.606, Global test loss: 1.226, Global test accuracy: 59.91
Round  50, Train loss: 0.613, Test loss: 1.022, Test accuracy: 67.42
Round  50, Global train loss: 0.613, Global test loss: 1.180, Global test accuracy: 59.65
Round  51, Train loss: 0.531, Test loss: 1.028, Test accuracy: 67.34
Round  51, Global train loss: 0.531, Global test loss: 1.314, Global test accuracy: 58.92
Round  52, Train loss: 0.637, Test loss: 1.029, Test accuracy: 67.31
Round  52, Global train loss: 0.637, Global test loss: 1.334, Global test accuracy: 58.06
Round  53, Train loss: 0.520, Test loss: 1.032, Test accuracy: 67.60
Round  53, Global train loss: 0.520, Global test loss: 1.406, Global test accuracy: 56.79
Round  54, Train loss: 0.537, Test loss: 1.046, Test accuracy: 66.92
Round  54, Global train loss: 0.537, Global test loss: 1.217, Global test accuracy: 59.26
Round  55, Train loss: 0.609, Test loss: 1.048, Test accuracy: 67.54
Round  55, Global train loss: 0.609, Global test loss: 1.430, Global test accuracy: 54.02
Round  56, Train loss: 0.543, Test loss: 1.054, Test accuracy: 67.63
Round  56, Global train loss: 0.543, Global test loss: 1.395, Global test accuracy: 57.00
Round  57, Train loss: 0.497, Test loss: 1.050, Test accuracy: 68.10
Round  57, Global train loss: 0.497, Global test loss: 1.307, Global test accuracy: 59.66
Round  58, Train loss: 0.531, Test loss: 1.055, Test accuracy: 67.92
Round  58, Global train loss: 0.531, Global test loss: 1.279, Global test accuracy: 59.38
Round  59, Train loss: 0.423, Test loss: 1.053, Test accuracy: 67.79
Round  59, Global train loss: 0.423, Global test loss: 1.381, Global test accuracy: 56.55
Round  60, Train loss: 0.595, Test loss: 1.054, Test accuracy: 67.90
Round  60, Global train loss: 0.595, Global test loss: 1.254, Global test accuracy: 58.26
Round  61, Train loss: 0.483, Test loss: 1.051, Test accuracy: 68.16
Round  61, Global train loss: 0.483, Global test loss: 1.373, Global test accuracy: 56.54
Round  62, Train loss: 0.524, Test loss: 1.056, Test accuracy: 68.00
Round  62, Global train loss: 0.524, Global test loss: 1.485, Global test accuracy: 55.43
Round  63, Train loss: 0.520, Test loss: 1.070, Test accuracy: 67.80
Round  63, Global train loss: 0.520, Global test loss: 1.367, Global test accuracy: 56.81
Round  64, Train loss: 0.586, Test loss: 1.081, Test accuracy: 68.03
Round  64, Global train loss: 0.586, Global test loss: 1.372, Global test accuracy: 56.06
Round  65, Train loss: 0.531, Test loss: 1.098, Test accuracy: 68.19
Round  65, Global train loss: 0.531, Global test loss: 1.436, Global test accuracy: 56.24
Round  66, Train loss: 0.509, Test loss: 1.120, Test accuracy: 67.77
Round  66, Global train loss: 0.509, Global test loss: 1.295, Global test accuracy: 59.22
Round  67, Train loss: 0.482, Test loss: 1.102, Test accuracy: 67.68
Round  67, Global train loss: 0.482, Global test loss: 1.294, Global test accuracy: 59.48
Round  68, Train loss: 0.510, Test loss: 1.104, Test accuracy: 67.41
Round  68, Global train loss: 0.510, Global test loss: 1.525, Global test accuracy: 54.84
Round  69, Train loss: 0.505, Test loss: 1.112, Test accuracy: 67.56
Round  69, Global train loss: 0.505, Global test loss: 1.399, Global test accuracy: 57.95
Round  70, Train loss: 0.494, Test loss: 1.116, Test accuracy: 67.64
Round  70, Global train loss: 0.494, Global test loss: 1.195, Global test accuracy: 62.24
Round  71, Train loss: 0.431, Test loss: 1.109, Test accuracy: 67.88
Round  71, Global train loss: 0.431, Global test loss: 1.416, Global test accuracy: 58.52
Round  72, Train loss: 0.365, Test loss: 1.106, Test accuracy: 68.28
Round  72, Global train loss: 0.365, Global test loss: 1.357, Global test accuracy: 60.33
Round  73, Train loss: 0.451, Test loss: 1.089, Test accuracy: 68.80
Round  73, Global train loss: 0.451, Global test loss: 1.378, Global test accuracy: 59.10
Round  74, Train loss: 0.417, Test loss: 1.111, Test accuracy: 68.71
Round  74, Global train loss: 0.417, Global test loss: 1.327, Global test accuracy: 59.44
Round  75, Train loss: 0.463, Test loss: 1.121, Test accuracy: 68.31
Round  75, Global train loss: 0.463, Global test loss: 1.333, Global test accuracy: 58.83
Round  76, Train loss: 0.424, Test loss: 1.122, Test accuracy: 68.69
Round  76, Global train loss: 0.424, Global test loss: 1.240, Global test accuracy: 60.98
Round  77, Train loss: 0.386, Test loss: 1.113, Test accuracy: 68.78
Round  77, Global train loss: 0.386, Global test loss: 1.315, Global test accuracy: 60.74
Round  78, Train loss: 0.376, Test loss: 1.106, Test accuracy: 68.66
Round  78, Global train loss: 0.376, Global test loss: 1.405, Global test accuracy: 58.81
Round  79, Train loss: 0.422, Test loss: 1.128, Test accuracy: 68.71
Round  79, Global train loss: 0.422, Global test loss: 1.241, Global test accuracy: 61.35
Round  80, Train loss: 0.485, Test loss: 1.153, Test accuracy: 68.54
Round  80, Global train loss: 0.485, Global test loss: 1.315, Global test accuracy: 59.09
Round  81, Train loss: 0.472, Test loss: 1.171, Test accuracy: 68.12
Round  81, Global train loss: 0.472, Global test loss: 1.383, Global test accuracy: 59.13
Round  82, Train loss: 0.452, Test loss: 1.161, Test accuracy: 68.14
Round  82, Global train loss: 0.452, Global test loss: 1.445, Global test accuracy: 56.75
Round  83, Train loss: 0.450, Test loss: 1.148, Test accuracy: 68.51
Round  83, Global train loss: 0.450, Global test loss: 1.352, Global test accuracy: 58.41
Round  84, Train loss: 0.346, Test loss: 1.130, Test accuracy: 68.88
Round  84, Global train loss: 0.346, Global test loss: 1.388, Global test accuracy: 58.84
Round  85, Train loss: 0.357, Test loss: 1.156, Test accuracy: 68.53
Round  85, Global train loss: 0.357, Global test loss: 1.405, Global test accuracy: 59.19
Round  86, Train loss: 0.390, Test loss: 1.163, Test accuracy: 68.90
Round  86, Global train loss: 0.390, Global test loss: 1.482, Global test accuracy: 58.21
Round  87, Train loss: 0.384, Test loss: 1.159, Test accuracy: 69.03
Round  87, Global train loss: 0.384, Global test loss: 1.383, Global test accuracy: 59.22
Round  88, Train loss: 0.495, Test loss: 1.165, Test accuracy: 68.82
Round  88, Global train loss: 0.495, Global test loss: 1.417, Global test accuracy: 56.93
Round  89, Train loss: 0.365, Test loss: 1.157, Test accuracy: 68.85
Round  89, Global train loss: 0.365, Global test loss: 1.472, Global test accuracy: 58.51
Round  90, Train loss: 0.406, Test loss: 1.164, Test accuracy: 69.23
Round  90, Global train loss: 0.406, Global test loss: 1.533, Global test accuracy: 59.07
Round  91, Train loss: 0.368, Test loss: 1.184, Test accuracy: 68.63
Round  91, Global train loss: 0.368, Global test loss: 1.384, Global test accuracy: 59.27
Round  92, Train loss: 0.382, Test loss: 1.179, Test accuracy: 68.67
Round  92, Global train loss: 0.382, Global test loss: 1.473, Global test accuracy: 57.65
Round  93, Train loss: 0.402, Test loss: 1.244, Test accuracy: 67.95
Round  93, Global train loss: 0.402, Global test loss: 1.482, Global test accuracy: 57.95
Round  94, Train loss: 0.389, Test loss: 1.261, Test accuracy: 67.98
Round  94, Global train loss: 0.389, Global test loss: 1.485, Global test accuracy: 57.50
Round  95, Train loss: 0.377, Test loss: 1.256, Test accuracy: 68.20
Round  95, Global train loss: 0.377, Global test loss: 1.303, Global test accuracy: 61.56
Round  96, Train loss: 0.345, Test loss: 1.276, Test accuracy: 67.52
Round  96, Global train loss: 0.345, Global test loss: 1.560, Global test accuracy: 57.90
Round  97, Train loss: 0.427, Test loss: 1.252, Test accuracy: 67.87
Round  97, Global train loss: 0.427, Global test loss: 1.320, Global test accuracy: 60.13
Round  98, Train loss: 0.451, Test loss: 1.256, Test accuracy: 68.17
Round  98, Global train loss: 0.451, Global test loss: 1.422, Global test accuracy: 58.82
Round  99, Train loss: 0.325, Test loss: 1.241, Test accuracy: 68.75
Round  99, Global train loss: 0.325, Global test loss: 1.502, Global test accuracy: 57.71
Final Round, Train loss: 0.284, Test loss: 1.351, Test accuracy: 68.51
Final Round, Global train loss: 0.284, Global test loss: 1.502, Global test accuracy: 57.71
Average accuracy final 10 rounds: 68.297
Average global accuracy final 10 rounds: 58.75599999999999
1839.541351556778
[2.6696910858154297, 5.120710134506226, 7.552695274353027, 9.99018907546997, 12.213268041610718, 14.374933958053589, 16.540858268737793, 18.703056573867798, 21.263413429260254, 23.656293869018555, 26.07837152481079, 28.509989023208618, 30.948678255081177, 33.380281925201416, 35.822954177856445, 38.262386083602905, 40.706804037094116, 43.15144443511963, 45.597559452056885, 48.03453016281128, 50.47314691543579, 52.9177303314209, 55.35496234893799, 57.51708006858826, 59.678484201431274, 61.840797901153564, 64.00808572769165, 66.17171049118042, 68.33661532402039, 70.49963068962097, 72.6598527431488, 74.82206535339355, 76.98782134056091, 79.15296578407288, 81.31864976882935, 83.48270893096924, 85.64750933647156, 87.81769728660583, 89.98218584060669, 92.15301036834717, 94.31894040107727, 96.48375940322876, 98.65235233306885, 100.82189559936523, 102.98673582077026, 105.15111660957336, 107.31854128837585, 109.48355293273926, 111.64589071273804, 113.81332612037659, 115.97741413116455, 118.14209485054016, 120.30668020248413, 122.47198987007141, 124.63528752326965, 126.81733679771423, 129.01519536972046, 131.22029876708984, 133.38360834121704, 135.54363131523132, 137.70536756515503, 139.87008380889893, 142.03188037872314, 144.19345951080322, 146.35688662528992, 148.51946926116943, 150.68158054351807, 152.84364128112793, 155.00665950775146, 157.16712737083435, 159.33507585525513, 161.4976053237915, 163.65958857536316, 165.81931281089783, 167.98466992378235, 170.14933562278748, 172.31200551986694, 174.47899436950684, 176.64604115486145, 178.80750441551208, 180.97089552879333, 183.13496470451355, 185.29729104042053, 187.45932865142822, 189.62544798851013, 191.79257202148438, 193.960444688797, 196.1281032562256, 198.29370379447937, 200.4565851688385, 202.62199330329895, 204.7889006137848, 206.95489311218262, 209.11836624145508, 211.27983736991882, 213.44691634178162, 215.65221190452576, 217.83566236495972, 220.02905344963074, 222.27184438705444, 226.2462546825409]
[21.64, 29.33, 37.25, 39.44, 46.25, 50.22, 53.08, 53.77, 54.09, 54.86, 55.77, 56.58, 56.54, 58.11, 59.16, 59.7, 60.38, 60.48, 61.45, 61.88, 62.41, 62.79, 63.9, 64.14, 64.47, 64.64, 64.74, 65.32, 64.96, 65.35, 65.1, 65.03, 65.52, 65.35, 65.23, 65.57, 65.86, 65.99, 66.04, 66.55, 66.56, 66.94, 66.93, 66.39, 66.24, 66.15, 66.69, 66.73, 67.16, 67.31, 67.42, 67.34, 67.31, 67.6, 66.92, 67.54, 67.63, 68.1, 67.92, 67.79, 67.9, 68.16, 68.0, 67.8, 68.03, 68.19, 67.77, 67.68, 67.41, 67.56, 67.64, 67.88, 68.28, 68.8, 68.71, 68.31, 68.69, 68.78, 68.66, 68.71, 68.54, 68.12, 68.14, 68.51, 68.88, 68.53, 68.9, 69.03, 68.82, 68.85, 69.23, 68.63, 68.67, 67.95, 67.98, 68.2, 67.52, 67.87, 68.17, 68.75, 68.51]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 5, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 14, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  16.6600
Round 1 global test acc  15.8200
Round 2 global test acc  16.9400
Round 3 global test acc  19.5600
Round 4 global test acc  23.5700
Round 5 global test acc  19.9500
Round 6 global test acc  30.2900
Round 7 global test acc  25.3800
Round 8 global test acc  29.8200
Round 9 global test acc  26.9000
Round 10 global test acc  29.6200
Round 11 global test acc  31.6800
Round 12 global test acc  31.6300
Round 13 global test acc  34.3100
Round 14 global test acc  31.6400
Round 15 global test acc  31.9500
Round 16 global test acc  32.2000
Round 17 global test acc  28.5700
Round 18 global test acc  36.0900
Round 19 global test acc  38.0000
Round 20 global test acc  33.4900
Round 21 global test acc  40.1900
Round 22 global test acc  33.2500
Round 23 global test acc  34.7600
Round 24 global test acc  36.6300
Round 25 global test acc  32.6500
Round 26 global test acc  35.2000
Round 27 global test acc  40.4800
Round 28 global test acc  37.8600
Round 29 global test acc  36.4800
Round 30 global test acc  32.3600
Round 31 global test acc  32.7900
Round 32 global test acc  37.1100
Round 33 global test acc  37.6200
Round 34 global test acc  39.9600
Round 35 global test acc  39.0200
Round 36 global test acc  38.7500
Round 37 global test acc  35.1700
Round 38 global test acc  38.9000
Round 39 global test acc  41.8800
Round 40 global test acc  36.5800
Round 41 global test acc  34.3600
Round 42 global test acc  32.8900
Round 43 global test acc  41.2400
Round 44 global test acc  39.2300
Round 45 global test acc  39.0900
Round 46 global test acc  41.5600
Round 47 global test acc  43.1000
Round 48 global test acc  31.2200
Round 49 global test acc  43.4300
Round 50 global test acc  42.2200
Round 51 global test acc  39.1700
Round 52 global test acc  38.6200
Round 53 global test acc  36.9300
Round 54 global test acc  42.8300
Round 55 global test acc  32.4100
Round 56 global test acc  43.0200
Round 57 global test acc  40.5600
Round 58 global test acc  43.4300
Round 59 global test acc  43.2600
Round 60 global test acc  37.1400
Round 61 global test acc  41.2600
Round 62 global test acc  40.0700
Round 63 global test acc  33.9900
Round 64 global test acc  35.5400
Round 65 global test acc  39.3900
Round 66 global test acc  42.5800
Round 67 global test acc  34.8400
Round 68 global test acc  39.5900
Round 69 global test acc  37.2500
Round 70 global test acc  41.1300
Round 71 global test acc  43.1200
Round 72 global test acc  44.0800
Round 73 global test acc  45.0500
Round 74 global test acc  37.3900
Round 75 global test acc  44.4300
Round 76 global test acc  40.8600
Round 77 global test acc  44.8600
Round 78 global test acc  41.4700
Round 79 global test acc  40.1500
Round 80 global test acc  35.4600
Round 81 global test acc  34.4900
Round 82 global test acc  33.0100
Round 83 global test acc  32.0700
Round 84 global test acc  32.0700
Round 85 global test acc  30.5700
Round 86 global test acc  30.7900
Round 87 global test acc  30.1000
Round 88 global test acc  29.0100
Round 89 global test acc  28.6600
Round 90 global test acc  28.3300
Round 91 global test acc  27.8400
Round 92 global test acc  27.4900
Round 93 global test acc  26.9000
Round 94 global test acc  27.1200
Round 95 global test acc  26.2500
Round 96 global test acc  26.1100
Round 97 global test acc  24.9900
Round 98 global test acc  24.4400
Round 99 global test acc  24.4700
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.950, Test loss: 2.219, Test accuracy: 20.37
Round   1, Train loss: 1.640, Test loss: 2.013, Test accuracy: 26.67
Round   2, Train loss: 1.594, Test loss: 1.730, Test accuracy: 35.37
Round   3, Train loss: 1.394, Test loss: 1.543, Test accuracy: 36.74
Round   4, Train loss: 1.383, Test loss: 1.355, Test accuracy: 47.23
Round   5, Train loss: 1.202, Test loss: 1.276, Test accuracy: 50.97
Round   6, Train loss: 1.172, Test loss: 1.197, Test accuracy: 53.42
Round   7, Train loss: 1.114, Test loss: 1.171, Test accuracy: 55.21
Round   8, Train loss: 1.284, Test loss: 1.174, Test accuracy: 53.90
Round   9, Train loss: 1.206, Test loss: 1.146, Test accuracy: 55.50
Round  10, Train loss: 1.136, Test loss: 1.126, Test accuracy: 57.32
Round  11, Train loss: 1.172, Test loss: 1.061, Test accuracy: 59.17
Round  12, Train loss: 1.155, Test loss: 1.069, Test accuracy: 59.58
Round  13, Train loss: 1.066, Test loss: 1.033, Test accuracy: 60.29
Round  14, Train loss: 1.139, Test loss: 1.026, Test accuracy: 60.73
Round  15, Train loss: 1.104, Test loss: 1.022, Test accuracy: 60.67
Round  16, Train loss: 0.964, Test loss: 1.000, Test accuracy: 61.57
Round  17, Train loss: 1.001, Test loss: 0.983, Test accuracy: 62.47
Round  18, Train loss: 0.927, Test loss: 0.967, Test accuracy: 63.35
Round  19, Train loss: 1.066, Test loss: 0.969, Test accuracy: 64.17
Round  20, Train loss: 0.942, Test loss: 0.939, Test accuracy: 64.52
Round  21, Train loss: 0.930, Test loss: 0.940, Test accuracy: 64.97
Round  22, Train loss: 0.930, Test loss: 0.924, Test accuracy: 65.46
Round  23, Train loss: 1.058, Test loss: 0.929, Test accuracy: 64.74
Round  24, Train loss: 1.031, Test loss: 0.921, Test accuracy: 64.99
Round  25, Train loss: 1.010, Test loss: 0.932, Test accuracy: 65.10
Round  26, Train loss: 0.926, Test loss: 0.918, Test accuracy: 65.32
Round  27, Train loss: 0.944, Test loss: 0.899, Test accuracy: 66.73
Round  28, Train loss: 0.979, Test loss: 0.898, Test accuracy: 66.93
Round  29, Train loss: 0.938, Test loss: 0.882, Test accuracy: 67.15
Round  30, Train loss: 0.986, Test loss: 0.883, Test accuracy: 67.41
Round  31, Train loss: 1.012, Test loss: 0.876, Test accuracy: 68.10
Round  32, Train loss: 0.903, Test loss: 0.878, Test accuracy: 67.90
Round  33, Train loss: 0.850, Test loss: 0.855, Test accuracy: 68.50
Round  34, Train loss: 0.842, Test loss: 0.846, Test accuracy: 68.52
Round  35, Train loss: 0.843, Test loss: 0.832, Test accuracy: 68.61
Round  36, Train loss: 0.722, Test loss: 0.844, Test accuracy: 68.72
Round  37, Train loss: 0.837, Test loss: 0.843, Test accuracy: 68.82
Round  38, Train loss: 0.803, Test loss: 0.836, Test accuracy: 69.16
Round  39, Train loss: 0.736, Test loss: 0.839, Test accuracy: 68.85
Round  40, Train loss: 0.885, Test loss: 0.838, Test accuracy: 69.02
Round  41, Train loss: 0.788, Test loss: 0.829, Test accuracy: 69.62
Round  42, Train loss: 0.831, Test loss: 0.825, Test accuracy: 69.85
Round  43, Train loss: 0.811, Test loss: 0.809, Test accuracy: 70.15
Round  44, Train loss: 0.751, Test loss: 0.816, Test accuracy: 69.92
Round  45, Train loss: 0.773, Test loss: 0.839, Test accuracy: 69.46
Round  46, Train loss: 0.802, Test loss: 0.821, Test accuracy: 70.00
Round  47, Train loss: 0.685, Test loss: 0.803, Test accuracy: 70.50
Round  48, Train loss: 0.786, Test loss: 0.803, Test accuracy: 70.64
Round  49, Train loss: 0.815, Test loss: 0.803, Test accuracy: 70.87
Round  50, Train loss: 0.698, Test loss: 0.783, Test accuracy: 70.95
Round  51, Train loss: 0.723, Test loss: 0.783, Test accuracy: 71.74
Round  52, Train loss: 0.733, Test loss: 0.794, Test accuracy: 71.18
Round  53, Train loss: 0.656, Test loss: 0.787, Test accuracy: 71.39
Round  54, Train loss: 0.729, Test loss: 0.777, Test accuracy: 72.02
Round  55, Train loss: 0.686, Test loss: 0.780, Test accuracy: 71.95
Round  56, Train loss: 0.652, Test loss: 0.770, Test accuracy: 72.28
Round  57, Train loss: 0.658, Test loss: 0.772, Test accuracy: 72.17
Round  58, Train loss: 0.721, Test loss: 0.777, Test accuracy: 72.00
Round  59, Train loss: 0.720, Test loss: 0.789, Test accuracy: 71.43
Round  60, Train loss: 0.799, Test loss: 0.782, Test accuracy: 72.04
Round  61, Train loss: 0.684, Test loss: 0.782, Test accuracy: 71.16
Round  62, Train loss: 0.635, Test loss: 0.785, Test accuracy: 71.39
Round  63, Train loss: 0.787, Test loss: 0.784, Test accuracy: 71.34
Round  64, Train loss: 0.756, Test loss: 0.777, Test accuracy: 71.96
Round  65, Train loss: 0.730, Test loss: 0.775, Test accuracy: 72.15
Round  66, Train loss: 0.742, Test loss: 0.769, Test accuracy: 72.21
Round  67, Train loss: 0.575, Test loss: 0.757, Test accuracy: 72.56
Round  68, Train loss: 0.649, Test loss: 0.765, Test accuracy: 72.18
Round  69, Train loss: 0.524, Test loss: 0.765, Test accuracy: 72.12
Round  70, Train loss: 0.768, Test loss: 0.770, Test accuracy: 72.06
Round  71, Train loss: 0.634, Test loss: 0.760, Test accuracy: 72.72
Round  72, Train loss: 0.622, Test loss: 0.763, Test accuracy: 72.81
Round  73, Train loss: 0.637, Test loss: 0.761, Test accuracy: 72.83
Round  74, Train loss: 0.597, Test loss: 0.760, Test accuracy: 72.98
Round  75, Train loss: 0.547, Test loss: 0.755, Test accuracy: 72.80
Round  76, Train loss: 0.564, Test loss: 0.756, Test accuracy: 73.21
Round  77, Train loss: 0.644, Test loss: 0.761, Test accuracy: 73.09
Round  78, Train loss: 0.621, Test loss: 0.762, Test accuracy: 73.05
Round  79, Train loss: 0.582, Test loss: 0.749, Test accuracy: 73.48
Round  80, Train loss: 0.591, Test loss: 0.759, Test accuracy: 72.87
Round  81, Train loss: 0.614, Test loss: 0.748, Test accuracy: 73.35
Round  82, Train loss: 0.494, Test loss: 0.748, Test accuracy: 72.98
Round  83, Train loss: 0.586, Test loss: 0.758, Test accuracy: 73.13
Round  84, Train loss: 0.469, Test loss: 0.763, Test accuracy: 72.84
Round  85, Train loss: 0.527, Test loss: 0.759, Test accuracy: 72.77
Round  86, Train loss: 0.432, Test loss: 0.761, Test accuracy: 72.72
Round  87, Train loss: 0.526, Test loss: 0.760, Test accuracy: 72.77
Round  88, Train loss: 0.588, Test loss: 0.763, Test accuracy: 72.70
Round  89, Train loss: 0.556, Test loss: 0.755, Test accuracy: 72.96
Round  90, Train loss: 0.574, Test loss: 0.754, Test accuracy: 73.68
Round  91, Train loss: 0.526, Test loss: 0.761, Test accuracy: 72.91
Round  92, Train loss: 0.598, Test loss: 0.765, Test accuracy: 72.73
Round  93, Train loss: 0.646, Test loss: 0.776, Test accuracy: 72.66
Round  94, Train loss: 0.586, Test loss: 0.763, Test accuracy: 73.31
Round  95, Train loss: 0.440, Test loss: 0.766, Test accuracy: 73.09
Round  96, Train loss: 0.467, Test loss: 0.752, Test accuracy: 73.49
Round  97, Train loss: 0.520, Test loss: 0.764, Test accuracy: 73.56
Round  98, Train loss: 0.459, Test loss: 0.763, Test accuracy: 73.03
Round  99, Train loss: 0.533, Test loss: 0.762, Test accuracy: 73.29
Final Round, Train loss: 0.449, Test loss: 0.772, Test accuracy: 73.23
Average accuracy final 10 rounds: 73.17500000000001
1085.4201028347015
[1.6902806758880615, 3.083629608154297, 4.482804536819458, 5.90436577796936, 7.308433771133423, 8.722274541854858, 10.121702671051025, 11.525360345840454, 12.912616729736328, 14.290157318115234, 15.668368577957153, 17.05488157272339, 18.43510603904724, 19.81239414215088, 21.195807933807373, 22.569222927093506, 23.946614742279053, 25.32289457321167, 26.721433639526367, 28.12195897102356, 29.518123149871826, 30.91849136352539, 32.31593084335327, 33.715604066848755, 35.10696530342102, 36.49743986129761, 37.89478659629822, 39.28225636482239, 40.672804832458496, 42.07525563240051, 43.47606897354126, 44.86937427520752, 46.28715753555298, 47.692652463912964, 49.093430042266846, 50.47420001029968, 51.849387407302856, 53.22144174575806, 54.625733375549316, 56.001943588256836, 57.38279938697815, 58.754836082458496, 60.13208246231079, 61.49743437767029, 62.875112533569336, 64.25101613998413, 65.62928819656372, 67.027334690094, 68.42353630065918, 69.8201892375946, 71.21934938430786, 72.59527516365051, 73.97316145896912, 75.3685929775238, 76.76959919929504, 78.1682186126709, 79.57257533073425, 80.96591353416443, 82.35025668144226, 83.7550356388092, 85.15827322006226, 86.54467678070068, 87.93099021911621, 89.30405116081238, 90.67880654335022, 92.05427885055542, 93.44081497192383, 94.83734321594238, 96.23040342330933, 97.62059736251831, 99.01103377342224, 100.39687871932983, 101.80103993415833, 103.19535732269287, 104.57828044891357, 105.98151302337646, 107.3843777179718, 108.7827718257904, 110.182293176651, 111.5763373374939, 112.97277545928955, 114.36678290367126, 115.76663279533386, 117.1618435382843, 118.54688715934753, 119.91265964508057, 121.30204200744629, 122.71556258201599, 124.11134243011475, 125.48388814926147, 126.85954356193542, 128.26046109199524, 129.6602988243103, 131.0301742553711, 132.39332222938538, 133.78171610832214, 135.1780755519867, 136.54986238479614, 137.9318950176239, 139.31299948692322, 141.31021928787231]
[20.37, 26.67, 35.37, 36.74, 47.23, 50.97, 53.42, 55.21, 53.9, 55.5, 57.32, 59.17, 59.58, 60.29, 60.73, 60.67, 61.57, 62.47, 63.35, 64.17, 64.52, 64.97, 65.46, 64.74, 64.99, 65.1, 65.32, 66.73, 66.93, 67.15, 67.41, 68.1, 67.9, 68.5, 68.52, 68.61, 68.72, 68.82, 69.16, 68.85, 69.02, 69.62, 69.85, 70.15, 69.92, 69.46, 70.0, 70.5, 70.64, 70.87, 70.95, 71.74, 71.18, 71.39, 72.02, 71.95, 72.28, 72.17, 72.0, 71.43, 72.04, 71.16, 71.39, 71.34, 71.96, 72.15, 72.21, 72.56, 72.18, 72.12, 72.06, 72.72, 72.81, 72.83, 72.98, 72.8, 73.21, 73.09, 73.05, 73.48, 72.87, 73.35, 72.98, 73.13, 72.84, 72.77, 72.72, 72.77, 72.7, 72.96, 73.68, 72.91, 72.73, 72.66, 73.31, 73.09, 73.49, 73.56, 73.03, 73.29, 73.23]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.757, Test loss: 2.195, Test accuracy: 23.29
Round   1, Train loss: 1.515, Test loss: 1.931, Test accuracy: 27.97
Round   2, Train loss: 1.316, Test loss: 1.643, Test accuracy: 41.26
Round   3, Train loss: 1.214, Test loss: 1.416, Test accuracy: 45.63
Round   4, Train loss: 1.165, Test loss: 1.265, Test accuracy: 51.42
Round   5, Train loss: 1.198, Test loss: 1.211, Test accuracy: 54.66
Round   6, Train loss: 1.176, Test loss: 1.127, Test accuracy: 57.01
Round   7, Train loss: 0.974, Test loss: 1.111, Test accuracy: 57.35
Round   8, Train loss: 1.051, Test loss: 1.106, Test accuracy: 59.05
Round   9, Train loss: 1.027, Test loss: 1.086, Test accuracy: 59.38
Round  10, Train loss: 0.959, Test loss: 1.032, Test accuracy: 61.33
Round  11, Train loss: 0.894, Test loss: 1.017, Test accuracy: 61.89
Round  12, Train loss: 0.957, Test loss: 0.989, Test accuracy: 63.21
Round  13, Train loss: 0.903, Test loss: 0.933, Test accuracy: 65.25
Round  14, Train loss: 0.885, Test loss: 0.934, Test accuracy: 65.19
Round  15, Train loss: 0.790, Test loss: 0.908, Test accuracy: 66.77
Round  16, Train loss: 0.705, Test loss: 0.893, Test accuracy: 67.03
Round  17, Train loss: 0.847, Test loss: 0.920, Test accuracy: 66.71
Round  18, Train loss: 0.847, Test loss: 0.910, Test accuracy: 67.54
Round  19, Train loss: 0.677, Test loss: 0.875, Test accuracy: 68.41
Round  20, Train loss: 0.925, Test loss: 0.879, Test accuracy: 67.92
Round  21, Train loss: 0.713, Test loss: 0.869, Test accuracy: 68.28
Round  22, Train loss: 0.737, Test loss: 0.866, Test accuracy: 68.39
Round  23, Train loss: 0.726, Test loss: 0.863, Test accuracy: 68.59
Round  24, Train loss: 0.626, Test loss: 0.864, Test accuracy: 68.54
Round  25, Train loss: 0.673, Test loss: 0.859, Test accuracy: 68.91
Round  26, Train loss: 0.594, Test loss: 0.861, Test accuracy: 68.86
Round  27, Train loss: 0.752, Test loss: 0.854, Test accuracy: 69.33
Round  28, Train loss: 0.601, Test loss: 0.864, Test accuracy: 68.70
Round  29, Train loss: 0.561, Test loss: 0.842, Test accuracy: 69.77
Round  30, Train loss: 0.579, Test loss: 0.833, Test accuracy: 70.08
Round  31, Train loss: 0.486, Test loss: 0.843, Test accuracy: 69.18
Round  32, Train loss: 0.719, Test loss: 0.844, Test accuracy: 69.77
Round  33, Train loss: 0.711, Test loss: 0.838, Test accuracy: 69.99
Round  34, Train loss: 0.517, Test loss: 0.823, Test accuracy: 70.42
Round  35, Train loss: 0.525, Test loss: 0.840, Test accuracy: 70.44
Round  36, Train loss: 0.503, Test loss: 0.857, Test accuracy: 69.46
Round  37, Train loss: 0.605, Test loss: 0.868, Test accuracy: 69.63
Round  38, Train loss: 0.561, Test loss: 0.856, Test accuracy: 70.13
Round  39, Train loss: 0.546, Test loss: 0.860, Test accuracy: 69.83
Round  40, Train loss: 0.437, Test loss: 0.870, Test accuracy: 70.10
Round  41, Train loss: 0.465, Test loss: 0.874, Test accuracy: 69.74
Round  42, Train loss: 0.559, Test loss: 0.863, Test accuracy: 69.89
Round  43, Train loss: 0.484, Test loss: 0.851, Test accuracy: 70.46
Round  44, Train loss: 0.472, Test loss: 0.863, Test accuracy: 70.28
Round  45, Train loss: 0.424, Test loss: 0.839, Test accuracy: 70.67
Round  46, Train loss: 0.476, Test loss: 0.854, Test accuracy: 70.54
Round  47, Train loss: 0.546, Test loss: 0.833, Test accuracy: 72.32
Round  48, Train loss: 0.386, Test loss: 0.827, Test accuracy: 71.99
Round  49, Train loss: 0.530, Test loss: 0.839, Test accuracy: 71.50
Round  50, Train loss: 0.454, Test loss: 0.847, Test accuracy: 71.44
Round  51, Train loss: 0.384, Test loss: 0.840, Test accuracy: 71.97
Round  52, Train loss: 0.537, Test loss: 0.858, Test accuracy: 71.64
Round  53, Train loss: 0.486, Test loss: 0.860, Test accuracy: 70.99
Round  54, Train loss: 0.495, Test loss: 0.865, Test accuracy: 70.81
Round  55, Train loss: 0.447, Test loss: 0.865, Test accuracy: 71.05
Round  56, Train loss: 0.466, Test loss: 0.880, Test accuracy: 70.54
Round  57, Train loss: 0.411, Test loss: 0.896, Test accuracy: 70.18
Round  58, Train loss: 0.473, Test loss: 0.914, Test accuracy: 69.60
Round  59, Train loss: 0.434, Test loss: 0.925, Test accuracy: 69.32
Round  60, Train loss: 0.444, Test loss: 0.879, Test accuracy: 70.32
Round  61, Train loss: 0.348, Test loss: 0.865, Test accuracy: 71.22
Round  62, Train loss: 0.360, Test loss: 0.872, Test accuracy: 70.97
Round  63, Train loss: 0.421, Test loss: 0.889, Test accuracy: 70.93
Round  64, Train loss: 0.348, Test loss: 0.894, Test accuracy: 70.70
Round  65, Train loss: 0.333, Test loss: 0.883, Test accuracy: 71.38
Round  66, Train loss: 0.361, Test loss: 0.906, Test accuracy: 71.01
Round  67, Train loss: 0.362, Test loss: 0.868, Test accuracy: 71.90
Round  68, Train loss: 0.360, Test loss: 0.887, Test accuracy: 71.57
Round  69, Train loss: 0.335, Test loss: 0.866, Test accuracy: 71.92
Round  70, Train loss: 0.362, Test loss: 0.881, Test accuracy: 71.78
Round  71, Train loss: 0.292, Test loss: 0.886, Test accuracy: 72.03
Round  72, Train loss: 0.307, Test loss: 0.885, Test accuracy: 71.83
Round  73, Train loss: 0.351, Test loss: 0.905, Test accuracy: 71.36
Round  74, Train loss: 0.350, Test loss: 0.888, Test accuracy: 71.21
Round  75, Train loss: 0.297, Test loss: 0.884, Test accuracy: 71.98
Round  76, Train loss: 0.316, Test loss: 0.900, Test accuracy: 71.22
Round  77, Train loss: 0.288, Test loss: 0.921, Test accuracy: 70.88
Round  78, Train loss: 0.363, Test loss: 0.939, Test accuracy: 70.72
Round  79, Train loss: 0.330, Test loss: 0.925, Test accuracy: 70.60
Round  80, Train loss: 0.297, Test loss: 0.922, Test accuracy: 71.02
Round  81, Train loss: 0.395, Test loss: 0.918, Test accuracy: 71.58
Round  82, Train loss: 0.287, Test loss: 0.874, Test accuracy: 72.23
Round  83, Train loss: 0.303, Test loss: 0.917, Test accuracy: 71.33
Round  84, Train loss: 0.338, Test loss: 0.962, Test accuracy: 70.65
Round  85, Train loss: 0.234, Test loss: 0.922, Test accuracy: 71.78
Round  86, Train loss: 0.249, Test loss: 0.908, Test accuracy: 71.73
Round  87, Train loss: 0.295, Test loss: 0.948, Test accuracy: 71.08
Round  88, Train loss: 0.283, Test loss: 0.920, Test accuracy: 71.53
Round  89, Train loss: 0.319, Test loss: 0.943, Test accuracy: 70.79
Round  90, Train loss: 0.310, Test loss: 0.958, Test accuracy: 70.95
Round  91, Train loss: 0.301, Test loss: 0.986, Test accuracy: 69.85
Round  92, Train loss: 0.248, Test loss: 0.961, Test accuracy: 70.65
Round  93, Train loss: 0.312, Test loss: 0.957, Test accuracy: 71.25
Round  94, Train loss: 0.348, Test loss: 0.974, Test accuracy: 70.81
Round  95, Train loss: 0.315, Test loss: 0.960, Test accuracy: 70.46
Round  96, Train loss: 0.268, Test loss: 0.959, Test accuracy: 70.81
Round  97, Train loss: 0.306, Test loss: 0.985, Test accuracy: 70.91
Round  98, Train loss: 0.286, Test loss: 0.997, Test accuracy: 70.91
Round  99, Train loss: 0.272, Test loss: 1.001, Test accuracy: 71.04
Final Round, Train loss: 0.249, Test loss: 0.986, Test accuracy: 71.63
Average accuracy final 10 rounds: 70.76400000000001
2674.0919468402863
[3.092841625213623, 5.915744066238403, 8.726369380950928, 11.511028528213501, 14.298227310180664, 17.075344800949097, 19.873087167739868, 22.66714334487915, 25.48433494567871, 28.298805475234985, 31.114723205566406, 33.938753843307495, 36.7448787689209, 39.559784173965454, 42.33802914619446, 45.13941764831543, 47.95336055755615, 50.76659822463989, 53.57634115219116, 56.38075399398804, 59.18070936203003, 63.51899456977844, 67.8181700706482, 72.16325330734253, 76.50801348686218, 80.84611916542053, 85.13670110702515, 89.45824193954468, 93.73299074172974, 98.07130193710327, 102.35860228538513, 106.63235592842102, 110.95425057411194, 115.32092070579529, 119.60583353042603, 123.86797046661377, 128.14513564109802, 132.44672560691833, 136.72097516059875, 140.9648995399475, 145.2911126613617, 149.58957147598267, 153.8903293609619, 158.20684671401978, 162.48645162582397, 166.73559188842773, 171.0454022884369, 175.35538125038147, 179.63581442832947, 183.9280490875244, 188.21818351745605, 192.499032497406, 196.81390953063965, 201.09295845031738, 205.35748076438904, 209.66692972183228, 213.96949768066406, 218.3029224872589, 222.6097390651703, 226.91378545761108, 231.19366121292114, 235.47181224822998, 239.76705741882324, 244.0638313293457, 248.3603811264038, 252.67565274238586, 256.9565646648407, 261.2281985282898, 265.50399565696716, 269.77870202064514, 274.07235860824585, 278.3726830482483, 282.65755558013916, 286.9508032798767, 291.24071049690247, 295.5178165435791, 299.86370277404785, 304.1551630496979, 308.44374775886536, 312.7483141422272, 317.0614769458771, 321.3799376487732, 325.6861574649811, 329.9977729320526, 334.2827286720276, 338.55994153022766, 342.85419487953186, 347.16785407066345, 351.46691966056824, 355.7801501750946, 360.0701816082001, 364.3689272403717, 368.67282795906067, 372.9926047325134, 377.3009376525879, 381.5978698730469, 385.9467225074768, 390.27740955352783, 394.64375495910645, 398.95137786865234, 402.9104895591736]
[23.29, 27.97, 41.26, 45.63, 51.42, 54.66, 57.01, 57.35, 59.05, 59.38, 61.33, 61.89, 63.21, 65.25, 65.19, 66.77, 67.03, 66.71, 67.54, 68.41, 67.92, 68.28, 68.39, 68.59, 68.54, 68.91, 68.86, 69.33, 68.7, 69.77, 70.08, 69.18, 69.77, 69.99, 70.42, 70.44, 69.46, 69.63, 70.13, 69.83, 70.1, 69.74, 69.89, 70.46, 70.28, 70.67, 70.54, 72.32, 71.99, 71.5, 71.44, 71.97, 71.64, 70.99, 70.81, 71.05, 70.54, 70.18, 69.6, 69.32, 70.32, 71.22, 70.97, 70.93, 70.7, 71.38, 71.01, 71.9, 71.57, 71.92, 71.78, 72.03, 71.83, 71.36, 71.21, 71.98, 71.22, 70.88, 70.72, 70.6, 71.02, 71.58, 72.23, 71.33, 70.65, 71.78, 71.73, 71.08, 71.53, 70.79, 70.95, 69.85, 70.65, 71.25, 70.81, 70.46, 70.81, 70.91, 70.91, 71.04, 71.63]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 9, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.733, Test loss: 1.698, Test accuracy: 34.05
Round   1, Train loss: 1.369, Test loss: 1.301, Test accuracy: 47.58
Round   2, Train loss: 1.189, Test loss: 1.153, Test accuracy: 53.95
Round   3, Train loss: 1.096, Test loss: 1.063, Test accuracy: 57.56
Round   4, Train loss: 1.037, Test loss: 1.023, Test accuracy: 59.57
Round   5, Train loss: 0.991, Test loss: 0.981, Test accuracy: 61.30
Round   6, Train loss: 0.952, Test loss: 0.959, Test accuracy: 62.76
Round   7, Train loss: 0.919, Test loss: 0.937, Test accuracy: 63.51
Round   8, Train loss: 0.884, Test loss: 0.908, Test accuracy: 65.01
Round   9, Train loss: 0.855, Test loss: 0.898, Test accuracy: 65.71
Round  10, Train loss: 0.825, Test loss: 0.857, Test accuracy: 67.36
Round  11, Train loss: 0.799, Test loss: 0.855, Test accuracy: 67.72
Round  12, Train loss: 0.771, Test loss: 0.829, Test accuracy: 68.53
Round  13, Train loss: 0.748, Test loss: 0.828, Test accuracy: 68.01
Round  14, Train loss: 0.728, Test loss: 0.813, Test accuracy: 68.70
Round  15, Train loss: 0.703, Test loss: 0.805, Test accuracy: 69.92
Round  16, Train loss: 0.683, Test loss: 0.804, Test accuracy: 69.74
Round  17, Train loss: 0.666, Test loss: 0.782, Test accuracy: 70.41
Round  18, Train loss: 0.645, Test loss: 0.764, Test accuracy: 71.44
Round  19, Train loss: 0.628, Test loss: 0.783, Test accuracy: 70.68
Round  20, Train loss: 0.602, Test loss: 0.793, Test accuracy: 70.11
Round  21, Train loss: 0.518, Test loss: 0.791, Test accuracy: 70.20
Round  22, Train loss: 0.607, Test loss: 0.796, Test accuracy: 70.10
Round  23, Train loss: 0.593, Test loss: 0.791, Test accuracy: 70.41
Round  24, Train loss: 0.564, Test loss: 0.789, Test accuracy: 70.29
Round  25, Train loss: 0.515, Test loss: 0.784, Test accuracy: 70.97
Round  26, Train loss: 0.530, Test loss: 0.768, Test accuracy: 71.82
Round  27, Train loss: 0.578, Test loss: 0.772, Test accuracy: 71.62
Round  28, Train loss: 0.481, Test loss: 0.770, Test accuracy: 71.89
Round  29, Train loss: 0.549, Test loss: 0.753, Test accuracy: 72.39
Round  30, Train loss: 0.502, Test loss: 0.745, Test accuracy: 73.04
Round  31, Train loss: 0.446, Test loss: 0.754, Test accuracy: 72.81
Round  32, Train loss: 0.569, Test loss: 0.742, Test accuracy: 73.74
Round  33, Train loss: 0.500, Test loss: 0.735, Test accuracy: 73.79
Round  34, Train loss: 0.454, Test loss: 0.746, Test accuracy: 73.32
Round  35, Train loss: 0.436, Test loss: 0.758, Test accuracy: 73.43
Round  36, Train loss: 0.341, Test loss: 0.771, Test accuracy: 72.89
Round  37, Train loss: 0.392, Test loss: 0.771, Test accuracy: 73.09
Round  38, Train loss: 0.487, Test loss: 0.749, Test accuracy: 73.66
Round  39, Train loss: 0.420, Test loss: 0.754, Test accuracy: 73.97
Round  40, Train loss: 0.421, Test loss: 0.744, Test accuracy: 74.46
Round  41, Train loss: 0.376, Test loss: 0.763, Test accuracy: 73.77
Round  42, Train loss: 0.394, Test loss: 0.760, Test accuracy: 73.83
Round  43, Train loss: 0.443, Test loss: 0.761, Test accuracy: 73.96
Round  44, Train loss: 0.400, Test loss: 0.767, Test accuracy: 74.33
Round  45, Train loss: 0.340, Test loss: 0.761, Test accuracy: 74.02
Round  46, Train loss: 0.355, Test loss: 0.769, Test accuracy: 73.72
Round  47, Train loss: 0.384, Test loss: 0.782, Test accuracy: 73.16
Round  48, Train loss: 0.387, Test loss: 0.766, Test accuracy: 73.66
Round  49, Train loss: 0.433, Test loss: 0.757, Test accuracy: 74.25
Round  50, Train loss: 0.361, Test loss: 0.754, Test accuracy: 74.42
Round  51, Train loss: 0.312, Test loss: 0.764, Test accuracy: 74.59
Round  52, Train loss: 0.433, Test loss: 0.763, Test accuracy: 74.68
Round  53, Train loss: 0.370, Test loss: 0.759, Test accuracy: 75.24
Round  54, Train loss: 0.325, Test loss: 0.750, Test accuracy: 74.73
Round  55, Train loss: 0.385, Test loss: 0.771, Test accuracy: 74.44
Round  56, Train loss: 0.382, Test loss: 0.771, Test accuracy: 74.44
Round  57, Train loss: 0.276, Test loss: 0.771, Test accuracy: 74.39
Round  58, Train loss: 0.320, Test loss: 0.776, Test accuracy: 74.62
Round  59, Train loss: 0.262, Test loss: 0.788, Test accuracy: 74.28
Round  60, Train loss: 0.381, Test loss: 0.772, Test accuracy: 75.12
Round  61, Train loss: 0.263, Test loss: 0.768, Test accuracy: 75.15
Round  62, Train loss: 0.376, Test loss: 0.793, Test accuracy: 74.58
Round  63, Train loss: 0.365, Test loss: 0.792, Test accuracy: 74.34
Round  64, Train loss: 0.292, Test loss: 0.790, Test accuracy: 74.29
Round  65, Train loss: 0.296, Test loss: 0.764, Test accuracy: 75.74
Round  66, Train loss: 0.375, Test loss: 0.784, Test accuracy: 75.11
Round  67, Train loss: 0.279, Test loss: 0.768, Test accuracy: 75.28
Round  68, Train loss: 0.302, Test loss: 0.793, Test accuracy: 75.12
Round  69, Train loss: 0.281, Test loss: 0.769, Test accuracy: 75.85
Round  70, Train loss: 0.278, Test loss: 0.775, Test accuracy: 75.39
Round  71, Train loss: 0.292, Test loss: 0.794, Test accuracy: 74.91
Round  72, Train loss: 0.256, Test loss: 0.814, Test accuracy: 74.93
Round  73, Train loss: 0.308, Test loss: 0.795, Test accuracy: 75.48
Round  74, Train loss: 0.298, Test loss: 0.785, Test accuracy: 75.08
Round  75, Train loss: 0.257, Test loss: 0.789, Test accuracy: 74.96
Round  76, Train loss: 0.292, Test loss: 0.779, Test accuracy: 76.18
Round  77, Train loss: 0.302, Test loss: 0.780, Test accuracy: 75.85
Round  78, Train loss: 0.276, Test loss: 0.806, Test accuracy: 74.94
Round  79, Train loss: 0.260, Test loss: 0.790, Test accuracy: 75.04
Round  80, Train loss: 0.266, Test loss: 0.789, Test accuracy: 75.44
Round  81, Train loss: 0.250, Test loss: 0.780, Test accuracy: 75.87
Round  82, Train loss: 0.245, Test loss: 0.774, Test accuracy: 75.74
Round  83, Train loss: 0.240, Test loss: 0.787, Test accuracy: 75.56
Round  84, Train loss: 0.237, Test loss: 0.800, Test accuracy: 75.16
Round  85, Train loss: 0.238, Test loss: 0.798, Test accuracy: 75.47
Round  86, Train loss: 0.231, Test loss: 0.793, Test accuracy: 75.64
Round  87, Train loss: 0.234, Test loss: 0.802, Test accuracy: 75.24
Round  88, Train loss: 0.227, Test loss: 0.813, Test accuracy: 75.47
Round  89, Train loss: 0.222, Test loss: 0.811, Test accuracy: 75.54
Round  90, Train loss: 0.221, Test loss: 0.815, Test accuracy: 75.19
Round  91, Train loss: 0.225, Test loss: 0.821, Test accuracy: 74.99
Round  92, Train loss: 0.217, Test loss: 0.829, Test accuracy: 74.74
Round  93, Train loss: 0.217, Test loss: 0.815, Test accuracy: 75.10
Round  94, Train loss: 0.216, Test loss: 0.804, Test accuracy: 75.39
Round  95, Train loss: 0.208, Test loss: 0.818, Test accuracy: 75.60
Round  96, Train loss: 0.211, Test loss: 0.826, Test accuracy: 75.22
Round  97, Train loss: 0.206, Test loss: 0.837, Test accuracy: 75.52
Round  98, Train loss: 0.208, Test loss: 0.841, Test accuracy: 74.50
Round  99, Train loss: 0.200, Test loss: 0.841, Test accuracy: 75.04
Final Round, Train loss: 0.167, Test loss: 0.828, Test accuracy: 75.86
Average accuracy final 10 rounds: 75.129
3514.77481341362
[3.1181743144989014, 5.928240060806274, 8.772908926010132, 11.588755369186401, 14.429139375686646, 17.26511812210083, 20.08001732826233, 22.9142165184021, 25.747476816177368, 28.586533069610596, 31.423142194747925, 34.24465084075928, 37.02100968360901, 39.83204221725464, 42.66666102409363, 45.48645997047424, 48.29054856300354, 51.12284970283508, 53.94642663002014, 56.757426738739014, 59.54700684547424, 62.3453893661499, 65.1375482082367, 67.95208978652954, 70.75487041473389, 73.56153178215027, 76.34083819389343, 79.14615559577942, 81.940434217453, 84.7299394607544, 87.53243565559387, 90.33949613571167, 93.14900755882263, 95.94668793678284, 98.75693368911743, 101.57561779022217, 104.37349510192871, 107.17000460624695, 109.98058915138245, 112.79403281211853, 115.61446905136108, 118.39350867271423, 121.1284830570221, 123.90884518623352, 126.72953486442566, 129.54542899131775, 132.35901141166687, 135.1621868610382, 137.96326804161072, 140.7560851573944, 143.55928468704224, 146.37178230285645, 149.18616247177124, 151.98273491859436, 154.77603793144226, 157.56845355033875, 160.3658411502838, 163.16363310813904, 165.97251176834106, 168.77501916885376, 171.57292318344116, 174.33896160125732, 177.1278519630432, 179.94459199905396, 182.73040628433228, 185.51758456230164, 188.33261442184448, 191.11964774131775, 193.92983174324036, 196.74339699745178, 199.5594518184662, 202.3630599975586, 205.16302728652954, 207.9552879333496, 210.74869871139526, 213.57618761062622, 216.38644862174988, 219.2061197757721, 222.00558757781982, 224.8362033367157, 227.67450952529907, 230.50120496749878, 233.34183478355408, 236.16989040374756, 238.92751288414001, 241.72287249565125, 244.57040214538574, 247.38578057289124, 250.2137975692749, 253.0333240032196, 255.83043122291565, 258.6453449726105, 261.45557737350464, 264.27241921424866, 267.0795946121216, 269.89056849479675, 272.7086045742035, 275.5187187194824, 278.3190748691559, 281.0951974391937, 285.1130223274231]
[34.05, 47.58, 53.95, 57.56, 59.57, 61.3, 62.76, 63.51, 65.01, 65.71, 67.36, 67.72, 68.53, 68.01, 68.7, 69.92, 69.74, 70.41, 71.44, 70.68, 70.11, 70.2, 70.1, 70.41, 70.29, 70.97, 71.82, 71.62, 71.89, 72.39, 73.04, 72.81, 73.74, 73.79, 73.32, 73.43, 72.89, 73.09, 73.66, 73.97, 74.46, 73.77, 73.83, 73.96, 74.33, 74.02, 73.72, 73.16, 73.66, 74.25, 74.42, 74.59, 74.68, 75.24, 74.73, 74.44, 74.44, 74.39, 74.62, 74.28, 75.12, 75.15, 74.58, 74.34, 74.29, 75.74, 75.11, 75.28, 75.12, 75.85, 75.39, 74.91, 74.93, 75.48, 75.08, 74.96, 76.18, 75.85, 74.94, 75.04, 75.44, 75.87, 75.74, 75.56, 75.16, 75.47, 75.64, 75.24, 75.47, 75.54, 75.19, 74.99, 74.74, 75.1, 75.39, 75.6, 75.22, 75.52, 74.5, 75.04, 75.86]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.4 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.734, Test loss: 1.742, Test accuracy: 33.80
Round   1, Train loss: 1.363, Test loss: 1.290, Test accuracy: 50.11
Round   2, Train loss: 1.183, Test loss: 1.147, Test accuracy: 53.87
Round   3, Train loss: 1.102, Test loss: 1.060, Test accuracy: 57.88
Round   4, Train loss: 1.041, Test loss: 1.019, Test accuracy: 59.66
Round   5, Train loss: 1.002, Test loss: 0.972, Test accuracy: 62.32
Round   6, Train loss: 0.961, Test loss: 0.948, Test accuracy: 62.98
Round   7, Train loss: 0.925, Test loss: 0.926, Test accuracy: 63.76
Round   8, Train loss: 0.891, Test loss: 0.906, Test accuracy: 64.50
Round   9, Train loss: 0.863, Test loss: 0.886, Test accuracy: 65.94
Round  10, Train loss: 0.834, Test loss: 0.862, Test accuracy: 67.09
Round  11, Train loss: 0.808, Test loss: 0.854, Test accuracy: 67.73
Round  12, Train loss: 0.783, Test loss: 0.839, Test accuracy: 68.25
Round  13, Train loss: 0.762, Test loss: 0.834, Test accuracy: 68.19
Round  14, Train loss: 0.742, Test loss: 0.815, Test accuracy: 69.11
Round  15, Train loss: 0.718, Test loss: 0.836, Test accuracy: 69.33
Round  16, Train loss: 0.696, Test loss: 0.808, Test accuracy: 69.46
Round  17, Train loss: 0.677, Test loss: 0.787, Test accuracy: 70.62
Round  18, Train loss: 0.660, Test loss: 0.795, Test accuracy: 70.34
Round  19, Train loss: 0.643, Test loss: 0.786, Test accuracy: 70.57
Round  20, Train loss: 0.660, Test loss: 0.789, Test accuracy: 70.98
Round  21, Train loss: 0.574, Test loss: 0.794, Test accuracy: 70.85
Round  22, Train loss: 0.550, Test loss: 0.803, Test accuracy: 70.48
Round  23, Train loss: 0.689, Test loss: 0.808, Test accuracy: 71.08
Round  24, Train loss: 0.630, Test loss: 0.811, Test accuracy: 70.34
Round  25, Train loss: 0.553, Test loss: 0.783, Test accuracy: 71.76
Round  26, Train loss: 0.558, Test loss: 0.781, Test accuracy: 72.24
Round  27, Train loss: 0.542, Test loss: 0.761, Test accuracy: 72.68
Round  28, Train loss: 0.575, Test loss: 0.775, Test accuracy: 72.36
Round  29, Train loss: 0.502, Test loss: 0.783, Test accuracy: 71.98
Round  30, Train loss: 0.480, Test loss: 0.773, Test accuracy: 71.90
Round  31, Train loss: 0.527, Test loss: 0.785, Test accuracy: 72.11
Round  32, Train loss: 0.622, Test loss: 0.779, Test accuracy: 72.63
Round  33, Train loss: 0.446, Test loss: 0.765, Test accuracy: 73.22
Round  34, Train loss: 0.443, Test loss: 0.757, Test accuracy: 73.67
Round  35, Train loss: 0.433, Test loss: 0.742, Test accuracy: 74.47
Round  36, Train loss: 0.367, Test loss: 0.754, Test accuracy: 73.94
Round  37, Train loss: 0.415, Test loss: 0.759, Test accuracy: 74.03
Round  38, Train loss: 0.502, Test loss: 0.768, Test accuracy: 73.18
Round  39, Train loss: 0.413, Test loss: 0.766, Test accuracy: 74.00
Round  40, Train loss: 0.409, Test loss: 0.757, Test accuracy: 73.90
Round  41, Train loss: 0.354, Test loss: 0.762, Test accuracy: 74.03
Round  42, Train loss: 0.376, Test loss: 0.765, Test accuracy: 74.08
Round  43, Train loss: 0.496, Test loss: 0.766, Test accuracy: 73.79
Round  44, Train loss: 0.379, Test loss: 0.767, Test accuracy: 74.16
Round  45, Train loss: 0.435, Test loss: 0.747, Test accuracy: 74.39
Round  46, Train loss: 0.411, Test loss: 0.764, Test accuracy: 74.37
Round  47, Train loss: 0.402, Test loss: 0.768, Test accuracy: 74.17
Round  48, Train loss: 0.437, Test loss: 0.793, Test accuracy: 73.60
Round  49, Train loss: 0.447, Test loss: 0.787, Test accuracy: 73.94
Round  50, Train loss: 0.347, Test loss: 0.766, Test accuracy: 74.32
Round  51, Train loss: 0.299, Test loss: 0.782, Test accuracy: 74.36
Round  52, Train loss: 0.365, Test loss: 0.767, Test accuracy: 74.04
Round  53, Train loss: 0.383, Test loss: 0.798, Test accuracy: 73.42
Round  54, Train loss: 0.373, Test loss: 0.802, Test accuracy: 73.26
Round  55, Train loss: 0.363, Test loss: 0.780, Test accuracy: 74.02
Round  56, Train loss: 0.353, Test loss: 0.779, Test accuracy: 74.14
Round  57, Train loss: 0.360, Test loss: 0.789, Test accuracy: 74.28
Round  58, Train loss: 0.341, Test loss: 0.790, Test accuracy: 73.74
Round  59, Train loss: 0.338, Test loss: 0.811, Test accuracy: 73.89
Round  60, Train loss: 0.344, Test loss: 0.786, Test accuracy: 74.33
Round  61, Train loss: 0.310, Test loss: 0.779, Test accuracy: 74.84
Round  62, Train loss: 0.334, Test loss: 0.780, Test accuracy: 75.26
Round  63, Train loss: 0.339, Test loss: 0.787, Test accuracy: 74.67
Round  64, Train loss: 0.335, Test loss: 0.805, Test accuracy: 74.50
Round  65, Train loss: 0.296, Test loss: 0.788, Test accuracy: 74.43
Round  66, Train loss: 0.373, Test loss: 0.797, Test accuracy: 74.57
Round  67, Train loss: 0.301, Test loss: 0.785, Test accuracy: 74.94
Round  68, Train loss: 0.323, Test loss: 0.793, Test accuracy: 75.23
Round  69, Train loss: 0.284, Test loss: 0.808, Test accuracy: 74.29
Round  70, Train loss: 0.293, Test loss: 0.796, Test accuracy: 74.67
Round  71, Train loss: 0.316, Test loss: 0.817, Test accuracy: 75.00
Round  72, Train loss: 0.246, Test loss: 0.815, Test accuracy: 74.43
Round  73, Train loss: 0.256, Test loss: 0.791, Test accuracy: 74.82
Round  74, Train loss: 0.238, Test loss: 0.796, Test accuracy: 75.16
Round  75, Train loss: 0.269, Test loss: 0.819, Test accuracy: 74.80
Round  76, Train loss: 0.266, Test loss: 0.802, Test accuracy: 74.87
Round  77, Train loss: 0.307, Test loss: 0.822, Test accuracy: 74.63
Round  78, Train loss: 0.239, Test loss: 0.818, Test accuracy: 74.32
Round  79, Train loss: 0.304, Test loss: 0.820, Test accuracy: 74.40
Round  80, Train loss: 0.268, Test loss: 0.786, Test accuracy: 75.76
Round  81, Train loss: 0.252, Test loss: 0.798, Test accuracy: 75.34
Round  82, Train loss: 0.251, Test loss: 0.821, Test accuracy: 75.17
Round  83, Train loss: 0.245, Test loss: 0.808, Test accuracy: 75.26
Round  84, Train loss: 0.241, Test loss: 0.798, Test accuracy: 75.43
Round  85, Train loss: 0.228, Test loss: 0.814, Test accuracy: 75.44
Round  86, Train loss: 0.232, Test loss: 0.810, Test accuracy: 75.23
Round  87, Train loss: 0.233, Test loss: 0.826, Test accuracy: 75.19
Round  88, Train loss: 0.228, Test loss: 0.813, Test accuracy: 75.31
Round  89, Train loss: 0.226, Test loss: 0.820, Test accuracy: 75.48
Round  90, Train loss: 0.225, Test loss: 0.836, Test accuracy: 75.42
Round  91, Train loss: 0.223, Test loss: 0.835, Test accuracy: 75.34
Round  92, Train loss: 0.219, Test loss: 0.847, Test accuracy: 74.75
Round  93, Train loss: 0.224, Test loss: 0.847, Test accuracy: 74.84
Round  94, Train loss: 0.211, Test loss: 0.840, Test accuracy: 75.08
Round  95, Train loss: 0.205, Test loss: 0.848, Test accuracy: 74.97
Round  96, Train loss: 0.210, Test loss: 0.865, Test accuracy: 74.90
Round  97, Train loss: 0.209, Test loss: 0.851, Test accuracy: 74.97
Round  98, Train loss: 0.211, Test loss: 0.879, Test accuracy: 74.74
Round  99, Train loss: 0.206, Test loss: 0.863, Test accuracy: 74.96
Final Round, Train loss: 0.166, Test loss: 0.856, Test accuracy: 75.42
Average accuracy final 10 rounds: 74.997
4653.574794769287
[3.153008460998535, 6.00014328956604, 8.841804504394531, 11.675153017044067, 14.50297737121582, 17.344388723373413, 20.190890073776245, 23.03236174583435, 25.868387937545776, 28.658891439437866, 31.49338674545288, 34.3366973400116, 37.17864918708801, 40.01853632926941, 42.86048626899719, 45.70767784118652, 48.53913593292236, 51.37614178657532, 54.21359920501709, 57.0412220954895, 59.81929802894592, 64.10297346115112, 68.3377366065979, 72.58101272583008, 76.87058401107788, 81.14380669593811, 85.42952871322632, 89.72112846374512, 93.9418888092041, 98.1928825378418, 102.45407438278198, 106.7095160484314, 110.99806690216064, 115.29520916938782, 119.5874891281128, 123.88001370429993, 128.11285400390625, 132.4341700077057, 136.72039794921875, 140.9985806941986, 145.26622653007507, 149.56130456924438, 153.83888506889343, 158.12109303474426, 162.39874792099, 166.66294860839844, 170.9280490875244, 175.29042553901672, 179.64976358413696, 184.01220989227295, 188.35628962516785, 192.7005922794342, 197.04807686805725, 201.38393115997314, 205.74112677574158, 210.1402337551117, 214.4356279373169, 218.7383131980896, 223.0160677433014, 227.29992723464966, 231.58238887786865, 235.93479561805725, 240.27551531791687, 244.61679601669312, 248.95436692237854, 253.30092430114746, 257.5927770137787, 261.84111881256104, 266.10179233551025, 270.4206974506378, 274.6995813846588, 278.99640226364136, 283.2866623401642, 287.5325360298157, 291.86700916290283, 296.197482585907, 300.45358443260193, 304.71645879745483, 308.9622411727905, 313.2709617614746, 317.5847063064575, 321.91703248023987, 326.2469992637634, 330.5802891254425, 334.92174768447876, 339.251357793808, 343.58410716056824, 347.9343137741089, 352.22779965400696, 356.57621788978577, 360.9160144329071, 365.27038168907166, 369.6406044960022, 373.9980068206787, 378.3402795791626, 382.6247522830963, 386.91108322143555, 391.22093176841736, 395.5204954147339, 399.80253982543945, 403.7604513168335]
[33.8, 50.11, 53.87, 57.88, 59.66, 62.32, 62.98, 63.76, 64.5, 65.94, 67.09, 67.73, 68.25, 68.19, 69.11, 69.33, 69.46, 70.62, 70.34, 70.57, 70.98, 70.85, 70.48, 71.08, 70.34, 71.76, 72.24, 72.68, 72.36, 71.98, 71.9, 72.11, 72.63, 73.22, 73.67, 74.47, 73.94, 74.03, 73.18, 74.0, 73.9, 74.03, 74.08, 73.79, 74.16, 74.39, 74.37, 74.17, 73.6, 73.94, 74.32, 74.36, 74.04, 73.42, 73.26, 74.02, 74.14, 74.28, 73.74, 73.89, 74.33, 74.84, 75.26, 74.67, 74.5, 74.43, 74.57, 74.94, 75.23, 74.29, 74.67, 75.0, 74.43, 74.82, 75.16, 74.8, 74.87, 74.63, 74.32, 74.4, 75.76, 75.34, 75.17, 75.26, 75.43, 75.44, 75.23, 75.19, 75.31, 75.48, 75.42, 75.34, 74.75, 74.84, 75.08, 74.97, 74.9, 74.97, 74.74, 74.96, 75.42]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.669, Test loss: 2.030, Test accuracy: 24.16
Round   0, Global train loss: 1.669, Global test loss: 2.242, Global test accuracy: 20.96
Round   1, Train loss: 1.656, Test loss: 1.775, Test accuracy: 29.80
Round   1, Global train loss: 1.656, Global test loss: 2.165, Global test accuracy: 20.53
Round   2, Train loss: 1.545, Test loss: 1.586, Test accuracy: 38.91
Round   2, Global train loss: 1.545, Global test loss: 2.284, Global test accuracy: 22.23
Round   3, Train loss: 1.441, Test loss: 1.461, Test accuracy: 43.61
Round   3, Global train loss: 1.441, Global test loss: 2.059, Global test accuracy: 28.14
Round   4, Train loss: 1.521, Test loss: 1.409, Test accuracy: 43.74
Round   4, Global train loss: 1.521, Global test loss: 2.334, Global test accuracy: 16.89
Round   5, Train loss: 1.436, Test loss: 1.374, Test accuracy: 45.19
Round   5, Global train loss: 1.436, Global test loss: 2.097, Global test accuracy: 25.13
Round   6, Train loss: 1.466, Test loss: 1.360, Test accuracy: 47.29
Round   6, Global train loss: 1.466, Global test loss: 2.157, Global test accuracy: 30.62
Round   7, Train loss: 1.500, Test loss: 1.301, Test accuracy: 48.46
Round   7, Global train loss: 1.500, Global test loss: 2.245, Global test accuracy: 16.83
Round   8, Train loss: 1.492, Test loss: 1.286, Test accuracy: 48.55
Round   8, Global train loss: 1.492, Global test loss: 2.117, Global test accuracy: 24.83
Round   9, Train loss: 1.370, Test loss: 1.264, Test accuracy: 49.57
Round   9, Global train loss: 1.370, Global test loss: 2.059, Global test accuracy: 26.77
Round  10, Train loss: 1.350, Test loss: 1.250, Test accuracy: 50.28
Round  10, Global train loss: 1.350, Global test loss: 2.236, Global test accuracy: 24.71
Round  11, Train loss: 1.420, Test loss: 1.238, Test accuracy: 50.47
Round  11, Global train loss: 1.420, Global test loss: 2.089, Global test accuracy: 27.72
Round  12, Train loss: 1.294, Test loss: 1.218, Test accuracy: 51.54
Round  12, Global train loss: 1.294, Global test loss: 2.075, Global test accuracy: 25.00
Round  13, Train loss: 1.242, Test loss: 1.202, Test accuracy: 52.25
Round  13, Global train loss: 1.242, Global test loss: 2.110, Global test accuracy: 28.77
Round  14, Train loss: 1.269, Test loss: 1.226, Test accuracy: 51.88
Round  14, Global train loss: 1.269, Global test loss: 2.143, Global test accuracy: 27.70
Round  15, Train loss: 1.038, Test loss: 1.203, Test accuracy: 53.42
Round  15, Global train loss: 1.038, Global test loss: 1.997, Global test accuracy: 37.24
Round  16, Train loss: 1.097, Test loss: 1.200, Test accuracy: 53.51
Round  16, Global train loss: 1.097, Global test loss: 2.150, Global test accuracy: 26.18
Round  17, Train loss: 1.096, Test loss: 1.199, Test accuracy: 53.26
Round  17, Global train loss: 1.096, Global test loss: 2.045, Global test accuracy: 27.29
Round  18, Train loss: 1.234, Test loss: 1.193, Test accuracy: 53.94
Round  18, Global train loss: 1.234, Global test loss: 2.128, Global test accuracy: 26.90
Round  19, Train loss: 1.025, Test loss: 1.186, Test accuracy: 54.46
Round  19, Global train loss: 1.025, Global test loss: 2.046, Global test accuracy: 22.40
Round  20, Train loss: 1.076, Test loss: 1.196, Test accuracy: 54.25
Round  20, Global train loss: 1.076, Global test loss: 1.861, Global test accuracy: 36.39
Round  21, Train loss: 1.035, Test loss: 1.203, Test accuracy: 54.48
Round  21, Global train loss: 1.035, Global test loss: 2.004, Global test accuracy: 32.11
Round  22, Train loss: 1.361, Test loss: 1.185, Test accuracy: 55.67
Round  22, Global train loss: 1.361, Global test loss: 2.086, Global test accuracy: 21.01
Round  23, Train loss: 1.018, Test loss: 1.204, Test accuracy: 54.97
Round  23, Global train loss: 1.018, Global test loss: 2.044, Global test accuracy: 31.11
Round  24, Train loss: 1.068, Test loss: 1.198, Test accuracy: 54.82
Round  24, Global train loss: 1.068, Global test loss: 2.022, Global test accuracy: 28.04
Round  25, Train loss: 1.088, Test loss: 1.224, Test accuracy: 54.38
Round  25, Global train loss: 1.088, Global test loss: 2.060, Global test accuracy: 29.64
Round  26, Train loss: 0.965, Test loss: 1.247, Test accuracy: 54.12
Round  26, Global train loss: 0.965, Global test loss: 2.004, Global test accuracy: 29.27
Round  27, Train loss: 1.079, Test loss: 1.266, Test accuracy: 53.75
Round  27, Global train loss: 1.079, Global test loss: 2.087, Global test accuracy: 24.11
Round  28, Train loss: 1.018, Test loss: 1.279, Test accuracy: 52.94
Round  28, Global train loss: 1.018, Global test loss: 2.164, Global test accuracy: 29.07
Round  29, Train loss: 0.952, Test loss: 1.255, Test accuracy: 54.35
Round  29, Global train loss: 0.952, Global test loss: 1.995, Global test accuracy: 33.83
Round  30, Train loss: 0.954, Test loss: 1.248, Test accuracy: 54.63
Round  30, Global train loss: 0.954, Global test loss: 1.990, Global test accuracy: 31.42
Round  31, Train loss: 1.050, Test loss: 1.233, Test accuracy: 55.27
Round  31, Global train loss: 1.050, Global test loss: 2.061, Global test accuracy: 31.10
Round  32, Train loss: 0.884, Test loss: 1.246, Test accuracy: 54.94
Round  32, Global train loss: 0.884, Global test loss: 2.125, Global test accuracy: 26.09
Round  33, Train loss: 0.854, Test loss: 1.251, Test accuracy: 54.90
Round  33, Global train loss: 0.854, Global test loss: 2.025, Global test accuracy: 30.21
Round  34, Train loss: 0.724, Test loss: 1.256, Test accuracy: 54.67
Round  34, Global train loss: 0.724, Global test loss: 2.003, Global test accuracy: 27.36
Round  35, Train loss: 0.812, Test loss: 1.273, Test accuracy: 54.14
Round  35, Global train loss: 0.812, Global test loss: 2.114, Global test accuracy: 28.93
Round  36, Train loss: 0.924, Test loss: 1.316, Test accuracy: 53.98
Round  36, Global train loss: 0.924, Global test loss: 2.107, Global test accuracy: 23.73
Round  37, Train loss: 0.977, Test loss: 1.333, Test accuracy: 54.09
Round  37, Global train loss: 0.977, Global test loss: 2.143, Global test accuracy: 19.23
Round  38, Train loss: 0.534, Test loss: 1.357, Test accuracy: 54.17
Round  38, Global train loss: 0.534, Global test loss: 2.023, Global test accuracy: 31.64
Round  39, Train loss: 0.724, Test loss: 1.360, Test accuracy: 53.90
Round  39, Global train loss: 0.724, Global test loss: 2.069, Global test accuracy: 29.23
Round  40, Train loss: 0.681, Test loss: 1.351, Test accuracy: 54.08
Round  40, Global train loss: 0.681, Global test loss: 1.992, Global test accuracy: 29.40
Round  41, Train loss: 0.583, Test loss: 1.406, Test accuracy: 53.68
Round  41, Global train loss: 0.583, Global test loss: 2.307, Global test accuracy: 27.11
Round  42, Train loss: 0.759, Test loss: 1.400, Test accuracy: 53.89
Round  42, Global train loss: 0.759, Global test loss: 2.037, Global test accuracy: 26.45
Round  43, Train loss: 0.673, Test loss: 1.425, Test accuracy: 53.75
Round  43, Global train loss: 0.673, Global test loss: 2.001, Global test accuracy: 31.93
Round  44, Train loss: 0.532, Test loss: 1.458, Test accuracy: 53.27
Round  44, Global train loss: 0.532, Global test loss: 2.002, Global test accuracy: 29.97
Round  45, Train loss: 0.978, Test loss: 1.467, Test accuracy: 53.35
Round  45, Global train loss: 0.978, Global test loss: 2.061, Global test accuracy: 24.35
Round  46, Train loss: 0.582, Test loss: 1.492, Test accuracy: 52.78
Round  46, Global train loss: 0.582, Global test loss: 2.175, Global test accuracy: 28.22
Round  47, Train loss: 0.635, Test loss: 1.499, Test accuracy: 53.12
Round  47, Global train loss: 0.635, Global test loss: 1.974, Global test accuracy: 35.20
Round  48, Train loss: 0.528, Test loss: 1.502, Test accuracy: 53.61
Round  48, Global train loss: 0.528, Global test loss: 2.019, Global test accuracy: 26.89
Round  49, Train loss: 0.840, Test loss: 1.552, Test accuracy: 53.18
Round  49, Global train loss: 0.840, Global test loss: 2.112, Global test accuracy: 28.43
Round  50, Train loss: 0.787, Test loss: 1.583, Test accuracy: 52.56
Round  50, Global train loss: 0.787, Global test loss: 2.037, Global test accuracy: 30.46
Round  51, Train loss: 0.676, Test loss: 1.612, Test accuracy: 52.32
Round  51, Global train loss: 0.676, Global test loss: 2.056, Global test accuracy: 27.03
Round  52, Train loss: 0.418, Test loss: 1.654, Test accuracy: 51.96
Round  52, Global train loss: 0.418, Global test loss: 1.980, Global test accuracy: 30.10
Round  53, Train loss: 0.460, Test loss: 1.648, Test accuracy: 51.97
Round  53, Global train loss: 0.460, Global test loss: 1.859, Global test accuracy: 39.43
Round  54, Train loss: 0.456, Test loss: 1.657, Test accuracy: 52.37
Round  54, Global train loss: 0.456, Global test loss: 1.944, Global test accuracy: 29.45
Round  55, Train loss: 0.353, Test loss: 1.684, Test accuracy: 52.75
Round  55, Global train loss: 0.353, Global test loss: 1.922, Global test accuracy: 32.58
Round  56, Train loss: 0.436, Test loss: 1.684, Test accuracy: 53.06
Round  56, Global train loss: 0.436, Global test loss: 1.996, Global test accuracy: 30.24
Round  57, Train loss: 0.582, Test loss: 1.739, Test accuracy: 52.86
Round  57, Global train loss: 0.582, Global test loss: 2.144, Global test accuracy: 22.35
Round  58, Train loss: 0.793, Test loss: 1.751, Test accuracy: 52.96
Round  58, Global train loss: 0.793, Global test loss: 2.173, Global test accuracy: 17.04
Round  59, Train loss: 0.677, Test loss: 1.788, Test accuracy: 52.67
Round  59, Global train loss: 0.677, Global test loss: 2.078, Global test accuracy: 28.99
Round  60, Train loss: 0.450, Test loss: 1.800, Test accuracy: 53.12
Round  60, Global train loss: 0.450, Global test loss: 2.130, Global test accuracy: 25.33
Round  61, Train loss: 0.510, Test loss: 1.819, Test accuracy: 53.20
Round  61, Global train loss: 0.510, Global test loss: 2.145, Global test accuracy: 25.43
Round  62, Train loss: 0.218, Test loss: 1.851, Test accuracy: 52.64
Round  62, Global train loss: 0.218, Global test loss: 1.898, Global test accuracy: 32.17
Round  63, Train loss: 0.433, Test loss: 1.907, Test accuracy: 52.18
Round  63, Global train loss: 0.433, Global test loss: 2.103, Global test accuracy: 33.29
Round  64, Train loss: 0.304, Test loss: 1.896, Test accuracy: 52.50
Round  64, Global train loss: 0.304, Global test loss: 2.016, Global test accuracy: 28.42
Round  65, Train loss: 0.429, Test loss: 1.948, Test accuracy: 52.34
Round  65, Global train loss: 0.429, Global test loss: 2.159, Global test accuracy: 24.68
Round  66, Train loss: 0.337, Test loss: 1.965, Test accuracy: 52.27
Round  66, Global train loss: 0.337, Global test loss: 2.087, Global test accuracy: 27.20
Round  67, Train loss: 0.297, Test loss: 1.992, Test accuracy: 52.39
Round  67, Global train loss: 0.297, Global test loss: 1.969, Global test accuracy: 32.30
Round  68, Train loss: 0.277, Test loss: 2.006, Test accuracy: 52.02
Round  68, Global train loss: 0.277, Global test loss: 2.129, Global test accuracy: 26.06
Round  69, Train loss: 0.424, Test loss: 2.046, Test accuracy: 51.65
Round  69, Global train loss: 0.424, Global test loss: 2.002, Global test accuracy: 29.17
Round  70, Train loss: 0.204, Test loss: 2.077, Test accuracy: 51.53
Round  70, Global train loss: 0.204, Global test loss: 2.164, Global test accuracy: 29.74
Round  71, Train loss: 0.268, Test loss: 2.083, Test accuracy: 52.14
Round  71, Global train loss: 0.268, Global test loss: 1.919, Global test accuracy: 35.55
Round  72, Train loss: 0.400, Test loss: 2.069, Test accuracy: 52.32
Round  72, Global train loss: 0.400, Global test loss: 1.991, Global test accuracy: 32.76
Round  73, Train loss: 0.329, Test loss: 2.048, Test accuracy: 52.53
Round  73, Global train loss: 0.329, Global test loss: 2.072, Global test accuracy: 32.42
Round  74, Train loss: 0.211, Test loss: 2.070, Test accuracy: 51.81
Round  74, Global train loss: 0.211, Global test loss: 2.006, Global test accuracy: 26.31
Round  75, Train loss: 0.329, Test loss: 2.119, Test accuracy: 51.38
Round  75, Global train loss: 0.329, Global test loss: 2.084, Global test accuracy: 27.99
Round  76, Train loss: 0.207, Test loss: 2.157, Test accuracy: 50.93
Round  76, Global train loss: 0.207, Global test loss: 2.097, Global test accuracy: 30.81
Round  77, Train loss: 0.215, Test loss: 2.141, Test accuracy: 51.54
Round  77, Global train loss: 0.215, Global test loss: 1.947, Global test accuracy: 31.32
Round  78, Train loss: 0.218, Test loss: 2.171, Test accuracy: 52.08
Round  78, Global train loss: 0.218, Global test loss: 1.979, Global test accuracy: 30.60
Round  79, Train loss: 0.217, Test loss: 2.266, Test accuracy: 51.94
Round  79, Global train loss: 0.217, Global test loss: 1.901, Global test accuracy: 33.76
Round  80, Train loss: 0.477, Test loss: 2.264, Test accuracy: 51.97
Round  80, Global train loss: 0.477, Global test loss: 1.954, Global test accuracy: 34.26
Round  81, Train loss: 0.194, Test loss: 2.279, Test accuracy: 51.86
Round  81, Global train loss: 0.194, Global test loss: 1.980, Global test accuracy: 34.79
Round  82, Train loss: 0.343, Test loss: 2.268, Test accuracy: 52.28
Round  82, Global train loss: 0.343, Global test loss: 1.934, Global test accuracy: 30.58
Round  83, Train loss: 0.389, Test loss: 2.276, Test accuracy: 52.40
Round  83, Global train loss: 0.389, Global test loss: 2.077, Global test accuracy: 31.73
Round  84, Train loss: 0.293, Test loss: 2.303, Test accuracy: 51.90
Round  84, Global train loss: 0.293, Global test loss: 2.024, Global test accuracy: 32.94
Round  85, Train loss: 0.312, Test loss: 2.346, Test accuracy: 51.21
Round  85, Global train loss: 0.312, Global test loss: 2.086, Global test accuracy: 27.21
Round  86, Train loss: 0.256, Test loss: 2.308, Test accuracy: 51.23
Round  86, Global train loss: 0.256, Global test loss: 2.090, Global test accuracy: 28.57
Round  87, Train loss: 0.195, Test loss: 2.346, Test accuracy: 51.22
Round  87, Global train loss: 0.195, Global test loss: 2.029, Global test accuracy: 27.59
Round  88, Train loss: 0.288, Test loss: 2.371, Test accuracy: 51.35
Round  88, Global train loss: 0.288, Global test loss: 1.889, Global test accuracy: 32.87
Round  89, Train loss: 0.195, Test loss: 2.393, Test accuracy: 51.50
Round  89, Global train loss: 0.195, Global test loss: 1.978, Global test accuracy: 30.45
Round  90, Train loss: 0.242, Test loss: 2.415, Test accuracy: 51.89
Round  90, Global train loss: 0.242, Global test loss: 2.201, Global test accuracy: 18.04
Round  91, Train loss: 0.316, Test loss: 2.436, Test accuracy: 52.12
Round  91, Global train loss: 0.316, Global test loss: 2.048, Global test accuracy: 28.16
Round  92, Train loss: 0.213, Test loss: 2.472, Test accuracy: 52.07
Round  92, Global train loss: 0.213, Global test loss: 2.154, Global test accuracy: 23.86
Round  93, Train loss: 0.145, Test loss: 2.511, Test accuracy: 51.46
Round  93, Global train loss: 0.145, Global test loss: 1.933, Global test accuracy: 33.41
Round  94, Train loss: 0.253, Test loss: 2.531, Test accuracy: 51.66
Round  94, Global train loss: 0.253, Global test loss: 1.960, Global test accuracy: 33.93
Round  95, Train loss: 0.208, Test loss: 2.534, Test accuracy: 51.41
Round  95, Global train loss: 0.208, Global test loss: 2.021, Global test accuracy: 30.77
Round  96, Train loss: 0.172, Test loss: 2.619, Test accuracy: 51.65
Round  96, Global train loss: 0.172, Global test loss: 1.956, Global test accuracy: 30.55
Round  97, Train loss: 0.184, Test loss: 2.544, Test accuracy: 52.27
Round  97, Global train loss: 0.184, Global test loss: 2.004, Global test accuracy: 28.14
Round  98, Train loss: 0.197, Test loss: 2.580, Test accuracy: 52.00
Round  98, Global train loss: 0.197, Global test loss: 1.958, Global test accuracy: 31.49
Round  99, Train loss: 0.149, Test loss: 2.573, Test accuracy: 52.07
Round  99, Global train loss: 0.149, Global test loss: 2.150, Global test accuracy: 34.46
Final Round, Train loss: 0.190, Test loss: 2.757, Test accuracy: 51.70
Final Round, Global train loss: 0.190, Global test loss: 2.150, Global test accuracy: 34.46
Average accuracy final 10 rounds: 51.86000000000001 

Average global accuracy final 10 rounds: 29.281000000000002 

1417.3957312107086
[1.4913694858551025, 2.982738971710205, 4.20187520980835, 5.421011447906494, 6.648766994476318, 7.876522541046143, 9.10144329071045, 10.326364040374756, 11.563445568084717, 12.800527095794678, 14.042180061340332, 15.283833026885986, 16.52248454093933, 17.761136054992676, 18.97493577003479, 20.188735485076904, 21.427732229232788, 22.666728973388672, 23.907036542892456, 25.14734411239624, 26.389593601226807, 27.631843090057373, 28.876137018203735, 30.120430946350098, 31.36049723625183, 32.600563526153564, 33.84228539466858, 35.084007263183594, 36.32473921775818, 37.565471172332764, 38.7999005317688, 40.034329891204834, 41.27096891403198, 42.50760793685913, 43.7484974861145, 44.98938703536987, 46.22886514663696, 47.46834325790405, 48.70751190185547, 49.946680545806885, 51.173253774642944, 52.399827003479004, 53.617140769958496, 54.83445453643799, 56.051124811172485, 57.26779508590698, 58.4923255443573, 59.71685600280762, 60.940911293029785, 62.16496658325195, 63.38900089263916, 64.61303520202637, 65.83106780052185, 67.04910039901733, 68.26898789405823, 69.48887538909912, 70.70933556556702, 71.92979574203491, 73.15256547927856, 74.37533521652222, 75.59231495857239, 76.80929470062256, 78.0298867225647, 79.25047874450684, 80.47158217430115, 81.69268560409546, 82.91186809539795, 84.13105058670044, 85.35578608512878, 86.58052158355713, 87.80945444107056, 89.03838729858398, 90.26690220832825, 91.49541711807251, 92.72986340522766, 93.96430969238281, 95.171395778656, 96.3784818649292, 97.58644556999207, 98.79440927505493, 100.02209615707397, 101.24978303909302, 102.45867013931274, 103.66755723953247, 104.87951135635376, 106.09146547317505, 107.31043791770935, 108.52941036224365, 109.74186158180237, 110.95431280136108, 112.1838891506195, 113.41346549987793, 114.63367295265198, 115.85388040542603, 117.0752387046814, 118.29659700393677, 119.52013611793518, 120.7436752319336, 121.96582531929016, 123.18797540664673, 124.41395425796509, 125.63993310928345, 126.87300777435303, 128.1060824394226, 129.33789134025574, 130.56970024108887, 131.78963208198547, 133.00956392288208, 134.233651638031, 135.45773935317993, 136.67486453056335, 137.89198970794678, 139.10849785804749, 140.3250060081482, 141.55578684806824, 142.78656768798828, 144.01461124420166, 145.24265480041504, 146.47587943077087, 147.7091040611267, 148.9342930316925, 150.1594820022583, 151.38399529457092, 152.60850858688354, 153.81654977798462, 155.0245909690857, 156.2369201183319, 157.44924926757812, 158.65503549575806, 159.860821723938, 161.07596635818481, 162.29111099243164, 163.50889587402344, 164.72668075561523, 165.94602513313293, 167.16536951065063, 168.39204144477844, 169.61871337890625, 170.84128832817078, 172.0638632774353, 173.2899899482727, 174.5161166191101, 175.73919677734375, 176.9622769355774, 178.18472409248352, 179.40717124938965, 180.62783026695251, 181.84848928451538, 183.06383633613586, 184.27918338775635, 185.5072844028473, 186.73538541793823, 187.9623565673828, 189.1893277168274, 190.4128315448761, 191.6363353729248, 192.86436319351196, 194.09239101409912, 195.31066584587097, 196.52894067764282, 197.745032787323, 198.96112489700317, 200.17154693603516, 201.38196897506714, 202.59687900543213, 203.81178903579712, 205.02602648735046, 206.2402639389038, 207.45550155639648, 208.67073917388916, 209.89221501350403, 211.1136908531189, 212.33528876304626, 213.55688667297363, 214.78348779678345, 216.01008892059326, 217.24059534072876, 218.47110176086426, 219.6859405040741, 220.90077924728394, 222.11102628707886, 223.32127332687378, 224.5442910194397, 225.76730871200562, 226.97950267791748, 228.19169664382935, 229.40912508964539, 230.62655353546143, 231.84574270248413, 233.06493186950684, 234.28000354766846, 235.49507522583008, 236.70968961715698, 237.9243040084839, 239.14230918884277, 240.36031436920166, 241.57415127754211, 242.78798818588257, 244.00205397605896, 245.21611976623535, 247.65174317359924, 250.08736658096313]
[24.16, 24.16, 29.8, 29.8, 38.91, 38.91, 43.61, 43.61, 43.74, 43.74, 45.19, 45.19, 47.29, 47.29, 48.46, 48.46, 48.55, 48.55, 49.57, 49.57, 50.28, 50.28, 50.47, 50.47, 51.54, 51.54, 52.25, 52.25, 51.88, 51.88, 53.42, 53.42, 53.51, 53.51, 53.26, 53.26, 53.94, 53.94, 54.46, 54.46, 54.25, 54.25, 54.48, 54.48, 55.67, 55.67, 54.97, 54.97, 54.82, 54.82, 54.38, 54.38, 54.12, 54.12, 53.75, 53.75, 52.94, 52.94, 54.35, 54.35, 54.63, 54.63, 55.27, 55.27, 54.94, 54.94, 54.9, 54.9, 54.67, 54.67, 54.14, 54.14, 53.98, 53.98, 54.09, 54.09, 54.17, 54.17, 53.9, 53.9, 54.08, 54.08, 53.68, 53.68, 53.89, 53.89, 53.75, 53.75, 53.27, 53.27, 53.35, 53.35, 52.78, 52.78, 53.12, 53.12, 53.61, 53.61, 53.18, 53.18, 52.56, 52.56, 52.32, 52.32, 51.96, 51.96, 51.97, 51.97, 52.37, 52.37, 52.75, 52.75, 53.06, 53.06, 52.86, 52.86, 52.96, 52.96, 52.67, 52.67, 53.12, 53.12, 53.2, 53.2, 52.64, 52.64, 52.18, 52.18, 52.5, 52.5, 52.34, 52.34, 52.27, 52.27, 52.39, 52.39, 52.02, 52.02, 51.65, 51.65, 51.53, 51.53, 52.14, 52.14, 52.32, 52.32, 52.53, 52.53, 51.81, 51.81, 51.38, 51.38, 50.93, 50.93, 51.54, 51.54, 52.08, 52.08, 51.94, 51.94, 51.97, 51.97, 51.86, 51.86, 52.28, 52.28, 52.4, 52.4, 51.9, 51.9, 51.21, 51.21, 51.23, 51.23, 51.22, 51.22, 51.35, 51.35, 51.5, 51.5, 51.89, 51.89, 52.12, 52.12, 52.07, 52.07, 51.46, 51.46, 51.66, 51.66, 51.41, 51.41, 51.65, 51.65, 52.27, 52.27, 52.0, 52.0, 52.07, 52.07, 51.7, 51.7]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.622, Test loss: 1.978, Test accuracy: 29.08
Round   0, Global train loss: 1.622, Global test loss: 2.197, Global test accuracy: 25.19
Round   1, Train loss: 1.480, Test loss: 1.750, Test accuracy: 32.01
Round   1, Global train loss: 1.480, Global test loss: 2.182, Global test accuracy: 21.63
Round   2, Train loss: 1.434, Test loss: 1.481, Test accuracy: 41.01
Round   2, Global train loss: 1.434, Global test loss: 2.085, Global test accuracy: 24.98
Round   3, Train loss: 1.283, Test loss: 1.348, Test accuracy: 45.96
Round   3, Global train loss: 1.283, Global test loss: 1.837, Global test accuracy: 33.05
Round   4, Train loss: 1.332, Test loss: 1.287, Test accuracy: 47.79
Round   4, Global train loss: 1.332, Global test loss: 1.983, Global test accuracy: 33.41
Round   5, Train loss: 1.219, Test loss: 1.224, Test accuracy: 50.31
Round   5, Global train loss: 1.219, Global test loss: 1.704, Global test accuracy: 37.00
Round   6, Train loss: 1.146, Test loss: 1.161, Test accuracy: 54.95
Round   6, Global train loss: 1.146, Global test loss: 1.696, Global test accuracy: 42.78
Round   7, Train loss: 1.185, Test loss: 1.081, Test accuracy: 57.82
Round   7, Global train loss: 1.185, Global test loss: 1.695, Global test accuracy: 38.32
Round   8, Train loss: 1.079, Test loss: 1.070, Test accuracy: 58.14
Round   8, Global train loss: 1.079, Global test loss: 1.665, Global test accuracy: 38.16
Round   9, Train loss: 1.103, Test loss: 1.054, Test accuracy: 58.37
Round   9, Global train loss: 1.103, Global test loss: 1.535, Global test accuracy: 45.78
Round  10, Train loss: 0.996, Test loss: 1.047, Test accuracy: 58.80
Round  10, Global train loss: 0.996, Global test loss: 1.731, Global test accuracy: 39.57
Round  11, Train loss: 1.039, Test loss: 1.021, Test accuracy: 60.15
Round  11, Global train loss: 1.039, Global test loss: 1.472, Global test accuracy: 46.54
Round  12, Train loss: 1.063, Test loss: 1.013, Test accuracy: 60.57
Round  12, Global train loss: 1.063, Global test loss: 1.506, Global test accuracy: 45.29
Round  13, Train loss: 1.014, Test loss: 0.973, Test accuracy: 61.97
Round  13, Global train loss: 1.014, Global test loss: 1.647, Global test accuracy: 42.70
Round  14, Train loss: 0.980, Test loss: 0.947, Test accuracy: 62.93
Round  14, Global train loss: 0.980, Global test loss: 1.543, Global test accuracy: 47.77
Round  15, Train loss: 0.931, Test loss: 0.939, Test accuracy: 63.69
Round  15, Global train loss: 0.931, Global test loss: 1.530, Global test accuracy: 48.83
Round  16, Train loss: 0.885, Test loss: 0.945, Test accuracy: 63.48
Round  16, Global train loss: 0.885, Global test loss: 1.451, Global test accuracy: 47.62
Round  17, Train loss: 1.008, Test loss: 0.935, Test accuracy: 64.02
Round  17, Global train loss: 1.008, Global test loss: 1.369, Global test accuracy: 50.99
Round  18, Train loss: 0.891, Test loss: 0.928, Test accuracy: 64.75
Round  18, Global train loss: 0.891, Global test loss: 1.379, Global test accuracy: 50.08
Round  19, Train loss: 0.915, Test loss: 0.944, Test accuracy: 64.39
Round  19, Global train loss: 0.915, Global test loss: 1.303, Global test accuracy: 52.08
Round  20, Train loss: 0.859, Test loss: 0.933, Test accuracy: 64.75
Round  20, Global train loss: 0.859, Global test loss: 1.282, Global test accuracy: 53.09
Round  21, Train loss: 0.863, Test loss: 0.893, Test accuracy: 66.49
Round  21, Global train loss: 0.863, Global test loss: 1.314, Global test accuracy: 51.94
Round  22, Train loss: 0.900, Test loss: 0.887, Test accuracy: 66.83
Round  22, Global train loss: 0.900, Global test loss: 1.275, Global test accuracy: 53.87
Round  23, Train loss: 0.862, Test loss: 0.886, Test accuracy: 67.24
Round  23, Global train loss: 0.862, Global test loss: 1.339, Global test accuracy: 51.55
Round  24, Train loss: 0.831, Test loss: 0.897, Test accuracy: 67.00
Round  24, Global train loss: 0.831, Global test loss: 1.201, Global test accuracy: 56.87
Round  25, Train loss: 0.800, Test loss: 0.888, Test accuracy: 67.82
Round  25, Global train loss: 0.800, Global test loss: 1.293, Global test accuracy: 53.93
Round  26, Train loss: 0.819, Test loss: 0.904, Test accuracy: 67.30
Round  26, Global train loss: 0.819, Global test loss: 1.347, Global test accuracy: 52.31
Round  27, Train loss: 0.752, Test loss: 0.913, Test accuracy: 67.37
Round  27, Global train loss: 0.752, Global test loss: 1.288, Global test accuracy: 55.56
Round  28, Train loss: 0.698, Test loss: 0.919, Test accuracy: 67.36
Round  28, Global train loss: 0.698, Global test loss: 1.543, Global test accuracy: 51.15
Round  29, Train loss: 0.754, Test loss: 0.905, Test accuracy: 67.96
Round  29, Global train loss: 0.754, Global test loss: 1.234, Global test accuracy: 56.99
Round  30, Train loss: 0.761, Test loss: 0.910, Test accuracy: 68.11
Round  30, Global train loss: 0.761, Global test loss: 1.226, Global test accuracy: 56.73
Round  31, Train loss: 0.667, Test loss: 0.892, Test accuracy: 68.57
Round  31, Global train loss: 0.667, Global test loss: 1.452, Global test accuracy: 52.06
Round  32, Train loss: 0.700, Test loss: 0.892, Test accuracy: 68.43
Round  32, Global train loss: 0.700, Global test loss: 1.280, Global test accuracy: 54.93
Round  33, Train loss: 0.738, Test loss: 0.910, Test accuracy: 67.77
Round  33, Global train loss: 0.738, Global test loss: 1.360, Global test accuracy: 54.15
Round  34, Train loss: 0.664, Test loss: 0.907, Test accuracy: 68.29
Round  34, Global train loss: 0.664, Global test loss: 1.241, Global test accuracy: 56.87
Round  35, Train loss: 0.608, Test loss: 0.918, Test accuracy: 68.06
Round  35, Global train loss: 0.608, Global test loss: 1.448, Global test accuracy: 51.14
Round  36, Train loss: 0.726, Test loss: 0.898, Test accuracy: 68.72
Round  36, Global train loss: 0.726, Global test loss: 1.218, Global test accuracy: 57.21
Round  37, Train loss: 0.752, Test loss: 0.888, Test accuracy: 69.38
Round  37, Global train loss: 0.752, Global test loss: 1.176, Global test accuracy: 59.29
Round  38, Train loss: 0.592, Test loss: 0.884, Test accuracy: 69.68
Round  38, Global train loss: 0.592, Global test loss: 1.272, Global test accuracy: 56.94
Round  39, Train loss: 0.725, Test loss: 0.876, Test accuracy: 70.03
Round  39, Global train loss: 0.725, Global test loss: 1.418, Global test accuracy: 53.58
Round  40, Train loss: 0.660, Test loss: 0.870, Test accuracy: 70.21
Round  40, Global train loss: 0.660, Global test loss: 1.163, Global test accuracy: 59.62
Round  41, Train loss: 0.566, Test loss: 0.870, Test accuracy: 70.55
Round  41, Global train loss: 0.566, Global test loss: 1.548, Global test accuracy: 49.24
Round  42, Train loss: 0.597, Test loss: 0.900, Test accuracy: 69.94
Round  42, Global train loss: 0.597, Global test loss: 1.307, Global test accuracy: 54.18
Round  43, Train loss: 0.578, Test loss: 0.895, Test accuracy: 70.11
Round  43, Global train loss: 0.578, Global test loss: 1.283, Global test accuracy: 58.08
Round  44, Train loss: 0.532, Test loss: 0.885, Test accuracy: 70.73
Round  44, Global train loss: 0.532, Global test loss: 1.260, Global test accuracy: 57.19
Round  45, Train loss: 0.608, Test loss: 0.897, Test accuracy: 70.91
Round  45, Global train loss: 0.608, Global test loss: 1.248, Global test accuracy: 58.05
Round  46, Train loss: 0.585, Test loss: 0.879, Test accuracy: 71.60
Round  46, Global train loss: 0.585, Global test loss: 1.368, Global test accuracy: 56.73
Round  47, Train loss: 0.558, Test loss: 0.890, Test accuracy: 71.21
Round  47, Global train loss: 0.558, Global test loss: 1.376, Global test accuracy: 56.74
Round  48, Train loss: 0.597, Test loss: 0.906, Test accuracy: 71.23
Round  48, Global train loss: 0.597, Global test loss: 1.234, Global test accuracy: 59.21
Round  49, Train loss: 0.634, Test loss: 0.900, Test accuracy: 71.13
Round  49, Global train loss: 0.634, Global test loss: 1.357, Global test accuracy: 54.73
Round  50, Train loss: 0.612, Test loss: 0.902, Test accuracy: 71.43
Round  50, Global train loss: 0.612, Global test loss: 1.193, Global test accuracy: 58.89
Round  51, Train loss: 0.577, Test loss: 0.898, Test accuracy: 71.57
Round  51, Global train loss: 0.577, Global test loss: 1.220, Global test accuracy: 58.40
Round  52, Train loss: 0.525, Test loss: 0.900, Test accuracy: 71.26
Round  52, Global train loss: 0.525, Global test loss: 1.259, Global test accuracy: 58.33
Round  53, Train loss: 0.512, Test loss: 0.877, Test accuracy: 71.28
Round  53, Global train loss: 0.512, Global test loss: 1.227, Global test accuracy: 59.57
Round  54, Train loss: 0.559, Test loss: 0.885, Test accuracy: 71.59
Round  54, Global train loss: 0.559, Global test loss: 1.123, Global test accuracy: 61.62
Round  55, Train loss: 0.538, Test loss: 0.903, Test accuracy: 71.23
Round  55, Global train loss: 0.538, Global test loss: 1.178, Global test accuracy: 59.84
Round  56, Train loss: 0.499, Test loss: 0.930, Test accuracy: 71.04
Round  56, Global train loss: 0.499, Global test loss: 1.335, Global test accuracy: 58.12
Round  57, Train loss: 0.565, Test loss: 0.934, Test accuracy: 70.84
Round  57, Global train loss: 0.565, Global test loss: 1.261, Global test accuracy: 58.29
Round  58, Train loss: 0.570, Test loss: 0.955, Test accuracy: 70.31
Round  58, Global train loss: 0.570, Global test loss: 1.196, Global test accuracy: 60.18
Round  59, Train loss: 0.514, Test loss: 0.951, Test accuracy: 70.14
Round  59, Global train loss: 0.514, Global test loss: 1.359, Global test accuracy: 57.29
Round  60, Train loss: 0.532, Test loss: 0.957, Test accuracy: 70.22
Round  60, Global train loss: 0.532, Global test loss: 1.324, Global test accuracy: 57.01
Round  61, Train loss: 0.577, Test loss: 0.942, Test accuracy: 70.45
Round  61, Global train loss: 0.577, Global test loss: 1.404, Global test accuracy: 54.31
Round  62, Train loss: 0.440, Test loss: 0.948, Test accuracy: 70.81
Round  62, Global train loss: 0.440, Global test loss: 1.123, Global test accuracy: 62.66
Round  63, Train loss: 0.468, Test loss: 0.949, Test accuracy: 70.99
Round  63, Global train loss: 0.468, Global test loss: 1.712, Global test accuracy: 52.83
Round  64, Train loss: 0.430, Test loss: 0.950, Test accuracy: 71.16
Round  64, Global train loss: 0.430, Global test loss: 1.322, Global test accuracy: 58.02
Round  65, Train loss: 0.506, Test loss: 0.946, Test accuracy: 71.52
Round  65, Global train loss: 0.506, Global test loss: 1.444, Global test accuracy: 57.48
Round  66, Train loss: 0.417, Test loss: 0.948, Test accuracy: 71.58
Round  66, Global train loss: 0.417, Global test loss: 1.268, Global test accuracy: 59.69
Round  67, Train loss: 0.429, Test loss: 0.956, Test accuracy: 71.01
Round  67, Global train loss: 0.429, Global test loss: 1.218, Global test accuracy: 60.35
Round  68, Train loss: 0.409, Test loss: 0.951, Test accuracy: 71.31
Round  68, Global train loss: 0.409, Global test loss: 1.346, Global test accuracy: 59.38
Round  69, Train loss: 0.367, Test loss: 0.921, Test accuracy: 71.99
Round  69, Global train loss: 0.367, Global test loss: 1.360, Global test accuracy: 58.26
Round  70, Train loss: 0.350, Test loss: 0.926, Test accuracy: 71.59
Round  70, Global train loss: 0.350, Global test loss: 1.553, Global test accuracy: 57.54
Round  71, Train loss: 0.421, Test loss: 0.935, Test accuracy: 71.74
Round  71, Global train loss: 0.421, Global test loss: 1.316, Global test accuracy: 60.77
Round  72, Train loss: 0.475, Test loss: 0.942, Test accuracy: 71.78
Round  72, Global train loss: 0.475, Global test loss: 1.322, Global test accuracy: 58.39
Round  73, Train loss: 0.474, Test loss: 0.971, Test accuracy: 71.32
Round  73, Global train loss: 0.474, Global test loss: 1.397, Global test accuracy: 57.61
Round  74, Train loss: 0.379, Test loss: 0.969, Test accuracy: 71.47
Round  74, Global train loss: 0.379, Global test loss: 1.414, Global test accuracy: 59.38
Round  75, Train loss: 0.424, Test loss: 0.968, Test accuracy: 71.56
Round  75, Global train loss: 0.424, Global test loss: 1.250, Global test accuracy: 61.28
Round  76, Train loss: 0.428, Test loss: 0.972, Test accuracy: 71.46
Round  76, Global train loss: 0.428, Global test loss: 1.478, Global test accuracy: 57.83
Round  77, Train loss: 0.411, Test loss: 0.970, Test accuracy: 71.28
Round  77, Global train loss: 0.411, Global test loss: 1.301, Global test accuracy: 59.12
Round  78, Train loss: 0.380, Test loss: 0.978, Test accuracy: 71.19
Round  78, Global train loss: 0.380, Global test loss: 1.218, Global test accuracy: 61.92
Round  79, Train loss: 0.391, Test loss: 0.986, Test accuracy: 70.93
Round  79, Global train loss: 0.391, Global test loss: 1.212, Global test accuracy: 61.80
Round  80, Train loss: 0.463, Test loss: 1.000, Test accuracy: 70.97
Round  80, Global train loss: 0.463, Global test loss: 1.132, Global test accuracy: 63.99
Round  81, Train loss: 0.335, Test loss: 1.021, Test accuracy: 70.73
Round  81, Global train loss: 0.335, Global test loss: 1.240, Global test accuracy: 61.92
Round  82, Train loss: 0.404, Test loss: 1.015, Test accuracy: 71.27
Round  82, Global train loss: 0.404, Global test loss: 1.211, Global test accuracy: 62.76
Round  83, Train loss: 0.430, Test loss: 0.989, Test accuracy: 71.75
Round  83, Global train loss: 0.430, Global test loss: 1.409, Global test accuracy: 57.78
Round  84, Train loss: 0.372, Test loss: 1.033, Test accuracy: 71.10
Round  84, Global train loss: 0.372, Global test loss: 1.387, Global test accuracy: 58.94
Round  85, Train loss: 0.482, Test loss: 1.019, Test accuracy: 71.73
Round  85, Global train loss: 0.482, Global test loss: 1.327, Global test accuracy: 59.24
Round  86, Train loss: 0.430, Test loss: 1.014, Test accuracy: 71.53
Round  86, Global train loss: 0.430, Global test loss: 1.216, Global test accuracy: 61.65
Round  87, Train loss: 0.388, Test loss: 1.000, Test accuracy: 72.11
Round  87, Global train loss: 0.388, Global test loss: 1.341, Global test accuracy: 58.87
Round  88, Train loss: 0.355, Test loss: 0.991, Test accuracy: 72.17
Round  88, Global train loss: 0.355, Global test loss: 1.201, Global test accuracy: 62.86
Round  89, Train loss: 0.331, Test loss: 0.983, Test accuracy: 72.59
Round  89, Global train loss: 0.331, Global test loss: 1.327, Global test accuracy: 61.18
Round  90, Train loss: 0.412, Test loss: 0.990, Test accuracy: 72.52
Round  90, Global train loss: 0.412, Global test loss: 1.304, Global test accuracy: 60.78
Round  91, Train loss: 0.417, Test loss: 1.024, Test accuracy: 72.28
Round  91, Global train loss: 0.417, Global test loss: 1.341, Global test accuracy: 60.05
Round  92, Train loss: 0.408, Test loss: 1.038, Test accuracy: 72.00
Round  92, Global train loss: 0.408, Global test loss: 1.563, Global test accuracy: 55.84
Round  93, Train loss: 0.380, Test loss: 1.034, Test accuracy: 71.54
Round  93, Global train loss: 0.380, Global test loss: 1.312, Global test accuracy: 60.11
Round  94, Train loss: 0.331, Test loss: 1.065, Test accuracy: 71.08
Round  94, Global train loss: 0.331, Global test loss: 1.293, Global test accuracy: 61.35
Round  95, Train loss: 0.364, Test loss: 1.050, Test accuracy: 71.13
Round  95, Global train loss: 0.364, Global test loss: 1.450, Global test accuracy: 58.43
Round  96, Train loss: 0.381, Test loss: 1.029, Test accuracy: 71.29
Round  96, Global train loss: 0.381, Global test loss: 1.217, Global test accuracy: 61.68
Round  97, Train loss: 0.316, Test loss: 1.028, Test accuracy: 71.19
Round  97, Global train loss: 0.316, Global test loss: 1.402, Global test accuracy: 59.44
Round  98, Train loss: 0.310, Test loss: 1.052, Test accuracy: 70.67
Round  98, Global train loss: 0.310, Global test loss: 1.361, Global test accuracy: 60.68
Round  99, Train loss: 0.296, Test loss: 1.064, Test accuracy: 70.84
Round  99, Global train loss: 0.296, Global test loss: 1.857, Global test accuracy: 54.96
Final Round, Train loss: 0.287, Test loss: 1.169, Test accuracy: 71.48
Final Round, Global train loss: 0.287, Global test loss: 1.857, Global test accuracy: 54.96
Average accuracy final 10 rounds: 71.45400000000001 

Average global accuracy final 10 rounds: 59.33200000000001 

1408.177945613861
[1.4687020778656006, 2.937404155731201, 4.145941495895386, 5.35447883605957, 6.558267593383789, 7.762056350708008, 8.976080656051636, 10.190104961395264, 11.4081449508667, 12.626184940338135, 13.840877771377563, 15.055570602416992, 16.26247000694275, 17.469369411468506, 18.680858850479126, 19.892348289489746, 21.111961841583252, 22.331575393676758, 23.54827046394348, 24.764965534210205, 25.97161555290222, 27.17826557159424, 28.38330101966858, 29.58833646774292, 30.79440426826477, 32.00047206878662, 33.22089695930481, 34.441321849823, 35.65568256378174, 36.87004327774048, 38.08916711807251, 39.30829095840454, 40.52154493331909, 41.73479890823364, 42.965238094329834, 44.195677280426025, 45.40353322029114, 46.61138916015625, 47.813013315200806, 49.01463747024536, 50.243600368499756, 51.47256326675415, 52.684629678726196, 53.89669609069824, 55.1167266368866, 56.33675718307495, 57.54212284088135, 58.747488498687744, 59.967841148376465, 61.188193798065186, 62.40415835380554, 63.6201229095459, 64.84707236289978, 66.07402181625366, 67.27755379676819, 68.48108577728271, 69.64765667915344, 70.81422758102417, 72.04505467414856, 73.27588176727295, 74.44741535186768, 75.6189489364624, 76.80799102783203, 77.99703311920166, 79.17871522903442, 80.36039733886719, 81.54285502433777, 82.72531270980835, 83.90449452400208, 85.0836763381958, 86.29158043861389, 87.49948453903198, 88.68426537513733, 89.86904621124268, 91.04010391235352, 92.21116161346436, 93.38255262374878, 94.5539436340332, 95.7855486869812, 97.0171537399292, 98.18669939041138, 99.35624504089355, 100.53124117851257, 101.70623731613159, 102.88245630264282, 104.05867528915405, 105.23887920379639, 106.41908311843872, 107.65925216674805, 108.89942121505737, 110.07127809524536, 111.24313497543335, 112.4205596446991, 113.59798431396484, 114.80304217338562, 116.0081000328064, 117.22627878189087, 118.44445753097534, 119.6445665359497, 120.84467554092407, 122.04204750061035, 123.23941946029663, 124.45148634910583, 125.66355323791504, 126.86471915245056, 128.06588506698608, 129.27696871757507, 130.48805236816406, 131.68903183937073, 132.8900113105774, 134.09594750404358, 135.30188369750977, 136.506774187088, 137.71166467666626, 138.9253330230713, 140.13900136947632, 141.37011241912842, 142.60122346878052, 143.81263279914856, 145.0240421295166, 146.23168444633484, 147.43932676315308, 148.67509698867798, 149.91086721420288, 151.12428498268127, 152.33770275115967, 153.5473711490631, 154.75703954696655, 155.97522854804993, 157.1934175491333, 158.4103078842163, 159.62719821929932, 160.83976316452026, 162.0523281097412, 163.27468419075012, 164.49704027175903, 165.70111179351807, 166.9051833152771, 168.11278080940247, 169.32037830352783, 170.53417563438416, 171.74797296524048, 172.95003843307495, 174.15210390090942, 175.35120224952698, 176.55030059814453, 177.7655005455017, 178.9807004928589, 180.19618272781372, 181.41166496276855, 182.6335482597351, 183.85543155670166, 185.05091786384583, 186.24640417099, 187.4669806957245, 188.68755722045898, 189.8972611427307, 191.10696506500244, 192.30862879753113, 193.51029253005981, 194.71938753128052, 195.92848253250122, 197.14249849319458, 198.35651445388794, 199.56515455245972, 200.7737946510315, 201.98563647270203, 203.19747829437256, 204.40860223770142, 205.61972618103027, 206.8299741744995, 208.04022216796875, 209.24482011795044, 210.44941806793213, 211.68535947799683, 212.92130088806152, 214.15744519233704, 215.39358949661255, 216.6103265285492, 217.82706356048584, 219.03689551353455, 220.24672746658325, 221.45927929878235, 222.67183113098145, 223.90138030052185, 225.13092947006226, 226.34433603286743, 227.5577425956726, 228.72276854515076, 229.8877944946289, 231.05808186531067, 232.22836923599243, 233.4079511165619, 234.58753299713135, 235.76810908317566, 236.94868516921997, 238.12640643119812, 239.30412769317627, 240.47737741470337, 241.65062713623047, 244.11920404434204, 246.5877809524536]
[29.08, 29.08, 32.01, 32.01, 41.01, 41.01, 45.96, 45.96, 47.79, 47.79, 50.31, 50.31, 54.95, 54.95, 57.82, 57.82, 58.14, 58.14, 58.37, 58.37, 58.8, 58.8, 60.15, 60.15, 60.57, 60.57, 61.97, 61.97, 62.93, 62.93, 63.69, 63.69, 63.48, 63.48, 64.02, 64.02, 64.75, 64.75, 64.39, 64.39, 64.75, 64.75, 66.49, 66.49, 66.83, 66.83, 67.24, 67.24, 67.0, 67.0, 67.82, 67.82, 67.3, 67.3, 67.37, 67.37, 67.36, 67.36, 67.96, 67.96, 68.11, 68.11, 68.57, 68.57, 68.43, 68.43, 67.77, 67.77, 68.29, 68.29, 68.06, 68.06, 68.72, 68.72, 69.38, 69.38, 69.68, 69.68, 70.03, 70.03, 70.21, 70.21, 70.55, 70.55, 69.94, 69.94, 70.11, 70.11, 70.73, 70.73, 70.91, 70.91, 71.6, 71.6, 71.21, 71.21, 71.23, 71.23, 71.13, 71.13, 71.43, 71.43, 71.57, 71.57, 71.26, 71.26, 71.28, 71.28, 71.59, 71.59, 71.23, 71.23, 71.04, 71.04, 70.84, 70.84, 70.31, 70.31, 70.14, 70.14, 70.22, 70.22, 70.45, 70.45, 70.81, 70.81, 70.99, 70.99, 71.16, 71.16, 71.52, 71.52, 71.58, 71.58, 71.01, 71.01, 71.31, 71.31, 71.99, 71.99, 71.59, 71.59, 71.74, 71.74, 71.78, 71.78, 71.32, 71.32, 71.47, 71.47, 71.56, 71.56, 71.46, 71.46, 71.28, 71.28, 71.19, 71.19, 70.93, 70.93, 70.97, 70.97, 70.73, 70.73, 71.27, 71.27, 71.75, 71.75, 71.1, 71.1, 71.73, 71.73, 71.53, 71.53, 72.11, 72.11, 72.17, 72.17, 72.59, 72.59, 72.52, 72.52, 72.28, 72.28, 72.0, 72.0, 71.54, 71.54, 71.08, 71.08, 71.13, 71.13, 71.29, 71.29, 71.19, 71.19, 70.67, 70.67, 70.84, 70.84, 71.48, 71.48]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.622, Test loss: 1.973, Test accuracy: 26.39
Round   0, Global train loss: 1.622, Global test loss: 2.193, Global test accuracy: 21.64
Round   1, Train loss: 1.615, Test loss: 1.726, Test accuracy: 31.24
Round   1, Global train loss: 1.615, Global test loss: 2.099, Global test accuracy: 21.86
Round   2, Train loss: 1.476, Test loss: 1.535, Test accuracy: 40.05
Round   2, Global train loss: 1.476, Global test loss: 2.135, Global test accuracy: 24.22
Round   3, Train loss: 1.377, Test loss: 1.421, Test accuracy: 43.80
Round   3, Global train loss: 1.377, Global test loss: 1.874, Global test accuracy: 34.13
Round   4, Train loss: 1.385, Test loss: 1.338, Test accuracy: 46.09
Round   4, Global train loss: 1.385, Global test loss: 1.965, Global test accuracy: 30.86
Round   5, Train loss: 1.405, Test loss: 1.268, Test accuracy: 48.99
Round   5, Global train loss: 1.405, Global test loss: 1.750, Global test accuracy: 35.65
Round   6, Train loss: 1.181, Test loss: 1.208, Test accuracy: 52.33
Round   6, Global train loss: 1.181, Global test loss: 1.735, Global test accuracy: 41.29
Round   7, Train loss: 1.189, Test loss: 1.139, Test accuracy: 54.46
Round   7, Global train loss: 1.189, Global test loss: 1.705, Global test accuracy: 36.66
Round   8, Train loss: 1.147, Test loss: 1.125, Test accuracy: 54.79
Round   8, Global train loss: 1.147, Global test loss: 1.711, Global test accuracy: 36.01
Round   9, Train loss: 1.150, Test loss: 1.106, Test accuracy: 55.84
Round   9, Global train loss: 1.150, Global test loss: 1.563, Global test accuracy: 43.36
Round  10, Train loss: 1.159, Test loss: 1.087, Test accuracy: 57.08
Round  10, Global train loss: 1.159, Global test loss: 1.672, Global test accuracy: 40.05
Round  11, Train loss: 1.053, Test loss: 1.051, Test accuracy: 59.07
Round  11, Global train loss: 1.053, Global test loss: 1.502, Global test accuracy: 44.41
Round  12, Train loss: 1.090, Test loss: 1.011, Test accuracy: 60.48
Round  12, Global train loss: 1.090, Global test loss: 1.476, Global test accuracy: 46.28
Round  13, Train loss: 1.118, Test loss: 0.993, Test accuracy: 61.33
Round  13, Global train loss: 1.118, Global test loss: 1.631, Global test accuracy: 41.94
Round  14, Train loss: 1.090, Test loss: 0.979, Test accuracy: 62.08
Round  14, Global train loss: 1.090, Global test loss: 1.511, Global test accuracy: 46.77
Round  15, Train loss: 1.042, Test loss: 0.973, Test accuracy: 62.66
Round  15, Global train loss: 1.042, Global test loss: 1.513, Global test accuracy: 47.51
Round  16, Train loss: 0.987, Test loss: 0.971, Test accuracy: 62.78
Round  16, Global train loss: 0.987, Global test loss: 1.434, Global test accuracy: 48.30
Round  17, Train loss: 1.026, Test loss: 0.968, Test accuracy: 63.62
Round  17, Global train loss: 1.026, Global test loss: 1.432, Global test accuracy: 47.57
Round  18, Train loss: 1.028, Test loss: 0.935, Test accuracy: 64.98
Round  18, Global train loss: 1.028, Global test loss: 1.418, Global test accuracy: 48.55
Round  19, Train loss: 1.011, Test loss: 0.935, Test accuracy: 64.80
Round  19, Global train loss: 1.011, Global test loss: 1.344, Global test accuracy: 52.59
Round  20, Train loss: 0.953, Test loss: 0.931, Test accuracy: 64.70
Round  20, Global train loss: 0.953, Global test loss: 1.268, Global test accuracy: 55.06
Round  21, Train loss: 0.986, Test loss: 0.946, Test accuracy: 64.72
Round  21, Global train loss: 0.986, Global test loss: 1.413, Global test accuracy: 48.97
Round  22, Train loss: 0.959, Test loss: 0.924, Test accuracy: 65.86
Round  22, Global train loss: 0.959, Global test loss: 1.276, Global test accuracy: 54.83
Round  23, Train loss: 0.922, Test loss: 0.916, Test accuracy: 66.16
Round  23, Global train loss: 0.922, Global test loss: 1.403, Global test accuracy: 49.69
Round  24, Train loss: 0.930, Test loss: 0.900, Test accuracy: 66.81
Round  24, Global train loss: 0.930, Global test loss: 1.238, Global test accuracy: 56.21
Round  25, Train loss: 0.892, Test loss: 0.889, Test accuracy: 66.98
Round  25, Global train loss: 0.892, Global test loss: 1.350, Global test accuracy: 51.72
Round  26, Train loss: 0.915, Test loss: 0.880, Test accuracy: 67.20
Round  26, Global train loss: 0.915, Global test loss: 1.248, Global test accuracy: 55.75
Round  27, Train loss: 0.932, Test loss: 0.879, Test accuracy: 67.26
Round  27, Global train loss: 0.932, Global test loss: 1.269, Global test accuracy: 55.44
Round  28, Train loss: 0.744, Test loss: 0.861, Test accuracy: 68.20
Round  28, Global train loss: 0.744, Global test loss: 1.425, Global test accuracy: 52.13
Round  29, Train loss: 0.885, Test loss: 0.846, Test accuracy: 68.88
Round  29, Global train loss: 0.885, Global test loss: 1.241, Global test accuracy: 55.83
Round  30, Train loss: 0.821, Test loss: 0.862, Test accuracy: 68.28
Round  30, Global train loss: 0.821, Global test loss: 1.255, Global test accuracy: 55.76
Round  31, Train loss: 0.774, Test loss: 0.856, Test accuracy: 68.45
Round  31, Global train loss: 0.774, Global test loss: 1.346, Global test accuracy: 53.21
Round  32, Train loss: 0.820, Test loss: 0.847, Test accuracy: 69.01
Round  32, Global train loss: 0.820, Global test loss: 1.321, Global test accuracy: 54.83
Round  33, Train loss: 0.772, Test loss: 0.856, Test accuracy: 68.62
Round  33, Global train loss: 0.772, Global test loss: 1.304, Global test accuracy: 54.46
Round  34, Train loss: 0.717, Test loss: 0.855, Test accuracy: 68.80
Round  34, Global train loss: 0.717, Global test loss: 1.245, Global test accuracy: 56.53
Round  35, Train loss: 0.719, Test loss: 0.847, Test accuracy: 69.17
Round  35, Global train loss: 0.719, Global test loss: 1.346, Global test accuracy: 53.08
Round  36, Train loss: 0.776, Test loss: 0.844, Test accuracy: 69.25
Round  36, Global train loss: 0.776, Global test loss: 1.208, Global test accuracy: 56.46
Round  37, Train loss: 0.802, Test loss: 0.846, Test accuracy: 69.89
Round  37, Global train loss: 0.802, Global test loss: 1.184, Global test accuracy: 57.98
Round  38, Train loss: 0.696, Test loss: 0.846, Test accuracy: 69.73
Round  38, Global train loss: 0.696, Global test loss: 1.224, Global test accuracy: 57.97
Round  39, Train loss: 0.789, Test loss: 0.866, Test accuracy: 69.18
Round  39, Global train loss: 0.789, Global test loss: 1.385, Global test accuracy: 53.62
Round  40, Train loss: 0.855, Test loss: 0.851, Test accuracy: 69.53
Round  40, Global train loss: 0.855, Global test loss: 1.160, Global test accuracy: 59.54
Round  41, Train loss: 0.774, Test loss: 0.852, Test accuracy: 69.37
Round  41, Global train loss: 0.774, Global test loss: 1.315, Global test accuracy: 53.73
Round  42, Train loss: 0.660, Test loss: 0.852, Test accuracy: 69.46
Round  42, Global train loss: 0.660, Global test loss: 1.242, Global test accuracy: 56.82
Round  43, Train loss: 0.686, Test loss: 0.864, Test accuracy: 69.10
Round  43, Global train loss: 0.686, Global test loss: 1.360, Global test accuracy: 55.77
Round  44, Train loss: 0.722, Test loss: 0.862, Test accuracy: 69.59
Round  44, Global train loss: 0.722, Global test loss: 1.173, Global test accuracy: 59.76
Round  45, Train loss: 0.681, Test loss: 0.872, Test accuracy: 69.58
Round  45, Global train loss: 0.681, Global test loss: 1.138, Global test accuracy: 61.13
Round  46, Train loss: 0.718, Test loss: 0.878, Test accuracy: 69.82
Round  46, Global train loss: 0.718, Global test loss: 1.440, Global test accuracy: 53.04
Round  47, Train loss: 0.669, Test loss: 0.874, Test accuracy: 70.11
Round  47, Global train loss: 0.669, Global test loss: 1.347, Global test accuracy: 55.83
Round  48, Train loss: 0.610, Test loss: 0.856, Test accuracy: 70.41
Round  48, Global train loss: 0.610, Global test loss: 1.159, Global test accuracy: 60.72
Round  49, Train loss: 0.676, Test loss: 0.851, Test accuracy: 70.48
Round  49, Global train loss: 0.676, Global test loss: 1.273, Global test accuracy: 55.95
Round  50, Train loss: 0.774, Test loss: 0.840, Test accuracy: 70.77
Round  50, Global train loss: 0.774, Global test loss: 1.112, Global test accuracy: 61.89
Round  51, Train loss: 0.564, Test loss: 0.851, Test accuracy: 70.68
Round  51, Global train loss: 0.564, Global test loss: 1.245, Global test accuracy: 59.29
Round  52, Train loss: 0.682, Test loss: 0.856, Test accuracy: 70.69
Round  52, Global train loss: 0.682, Global test loss: 1.138, Global test accuracy: 61.37
Round  53, Train loss: 0.672, Test loss: 0.863, Test accuracy: 70.54
Round  53, Global train loss: 0.672, Global test loss: 1.177, Global test accuracy: 60.63
Round  54, Train loss: 0.703, Test loss: 0.862, Test accuracy: 70.65
Round  54, Global train loss: 0.703, Global test loss: 1.120, Global test accuracy: 61.74
Round  55, Train loss: 0.632, Test loss: 0.853, Test accuracy: 71.04
Round  55, Global train loss: 0.632, Global test loss: 1.113, Global test accuracy: 61.56
Round  56, Train loss: 0.614, Test loss: 0.839, Test accuracy: 70.99
Round  56, Global train loss: 0.614, Global test loss: 1.278, Global test accuracy: 56.55
Round  57, Train loss: 0.656, Test loss: 0.839, Test accuracy: 71.00
Round  57, Global train loss: 0.656, Global test loss: 1.212, Global test accuracy: 59.09
Round  58, Train loss: 0.618, Test loss: 0.815, Test accuracy: 71.54
Round  58, Global train loss: 0.618, Global test loss: 1.149, Global test accuracy: 61.54
Round  59, Train loss: 0.613, Test loss: 0.816, Test accuracy: 71.97
Round  59, Global train loss: 0.613, Global test loss: 1.271, Global test accuracy: 57.64
Round  60, Train loss: 0.540, Test loss: 0.834, Test accuracy: 71.45
Round  60, Global train loss: 0.540, Global test loss: 1.212, Global test accuracy: 59.64
Round  61, Train loss: 0.683, Test loss: 0.854, Test accuracy: 71.01
Round  61, Global train loss: 0.683, Global test loss: 1.293, Global test accuracy: 55.75
Round  62, Train loss: 0.619, Test loss: 0.865, Test accuracy: 70.95
Round  62, Global train loss: 0.619, Global test loss: 1.100, Global test accuracy: 62.54
Round  63, Train loss: 0.524, Test loss: 0.878, Test accuracy: 70.63
Round  63, Global train loss: 0.524, Global test loss: 1.432, Global test accuracy: 55.23
Round  64, Train loss: 0.535, Test loss: 0.857, Test accuracy: 71.10
Round  64, Global train loss: 0.535, Global test loss: 1.302, Global test accuracy: 57.61
Round  65, Train loss: 0.579, Test loss: 0.875, Test accuracy: 70.58
Round  65, Global train loss: 0.579, Global test loss: 1.364, Global test accuracy: 56.33
Round  66, Train loss: 0.579, Test loss: 0.897, Test accuracy: 70.23
Round  66, Global train loss: 0.579, Global test loss: 1.160, Global test accuracy: 61.60
Round  67, Train loss: 0.572, Test loss: 0.894, Test accuracy: 70.13
Round  67, Global train loss: 0.572, Global test loss: 1.119, Global test accuracy: 62.31
Round  68, Train loss: 0.579, Test loss: 0.866, Test accuracy: 71.14
Round  68, Global train loss: 0.579, Global test loss: 1.324, Global test accuracy: 58.01
Round  69, Train loss: 0.491, Test loss: 0.885, Test accuracy: 71.14
Round  69, Global train loss: 0.491, Global test loss: 1.215, Global test accuracy: 61.18
Round  70, Train loss: 0.516, Test loss: 0.874, Test accuracy: 71.23
Round  70, Global train loss: 0.516, Global test loss: 1.397, Global test accuracy: 57.90
Round  71, Train loss: 0.528, Test loss: 0.899, Test accuracy: 70.87
Round  71, Global train loss: 0.528, Global test loss: 1.249, Global test accuracy: 60.09
Round  72, Train loss: 0.573, Test loss: 0.899, Test accuracy: 71.11
Round  72, Global train loss: 0.573, Global test loss: 1.216, Global test accuracy: 60.07
Round  73, Train loss: 0.512, Test loss: 0.892, Test accuracy: 71.31
Round  73, Global train loss: 0.512, Global test loss: 1.320, Global test accuracy: 58.48
Round  74, Train loss: 0.475, Test loss: 0.902, Test accuracy: 71.71
Round  74, Global train loss: 0.475, Global test loss: 1.209, Global test accuracy: 61.85
Round  75, Train loss: 0.489, Test loss: 0.903, Test accuracy: 72.05
Round  75, Global train loss: 0.489, Global test loss: 1.103, Global test accuracy: 63.29
Round  76, Train loss: 0.486, Test loss: 0.897, Test accuracy: 72.10
Round  76, Global train loss: 0.486, Global test loss: 1.405, Global test accuracy: 57.33
Round  77, Train loss: 0.458, Test loss: 0.908, Test accuracy: 72.10
Round  77, Global train loss: 0.458, Global test loss: 1.295, Global test accuracy: 59.97
Round  78, Train loss: 0.472, Test loss: 0.922, Test accuracy: 71.49
Round  78, Global train loss: 0.472, Global test loss: 1.206, Global test accuracy: 61.02
Round  79, Train loss: 0.508, Test loss: 0.908, Test accuracy: 72.17
Round  79, Global train loss: 0.508, Global test loss: 1.209, Global test accuracy: 61.28
Round  80, Train loss: 0.579, Test loss: 0.909, Test accuracy: 72.26
Round  80, Global train loss: 0.579, Global test loss: 1.132, Global test accuracy: 63.17
Round  81, Train loss: 0.446, Test loss: 0.908, Test accuracy: 72.54
Round  81, Global train loss: 0.446, Global test loss: 1.192, Global test accuracy: 61.26
Round  82, Train loss: 0.445, Test loss: 0.912, Test accuracy: 72.25
Round  82, Global train loss: 0.445, Global test loss: 1.145, Global test accuracy: 63.77
Round  83, Train loss: 0.522, Test loss: 0.898, Test accuracy: 72.31
Round  83, Global train loss: 0.522, Global test loss: 1.293, Global test accuracy: 59.47
Round  84, Train loss: 0.448, Test loss: 0.911, Test accuracy: 71.71
Round  84, Global train loss: 0.448, Global test loss: 1.266, Global test accuracy: 60.46
Round  85, Train loss: 0.558, Test loss: 0.927, Test accuracy: 71.39
Round  85, Global train loss: 0.558, Global test loss: 1.224, Global test accuracy: 60.73
Round  86, Train loss: 0.442, Test loss: 0.937, Test accuracy: 71.79
Round  86, Global train loss: 0.442, Global test loss: 1.142, Global test accuracy: 63.16
Round  87, Train loss: 0.435, Test loss: 0.924, Test accuracy: 71.94
Round  87, Global train loss: 0.435, Global test loss: 1.269, Global test accuracy: 60.52
Round  88, Train loss: 0.488, Test loss: 0.924, Test accuracy: 71.67
Round  88, Global train loss: 0.488, Global test loss: 1.149, Global test accuracy: 63.57
Round  89, Train loss: 0.400, Test loss: 0.927, Test accuracy: 71.98
Round  89, Global train loss: 0.400, Global test loss: 1.245, Global test accuracy: 61.77
Round  90, Train loss: 0.476, Test loss: 0.933, Test accuracy: 72.18
Round  90, Global train loss: 0.476, Global test loss: 1.374, Global test accuracy: 58.52
Round  91, Train loss: 0.513, Test loss: 0.938, Test accuracy: 72.28
Round  91, Global train loss: 0.513, Global test loss: 1.241, Global test accuracy: 60.46
Round  92, Train loss: 0.440, Test loss: 0.933, Test accuracy: 72.26
Round  92, Global train loss: 0.440, Global test loss: 1.350, Global test accuracy: 58.48/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.451, Test loss: 0.929, Test accuracy: 72.48
Round  93, Global train loss: 0.451, Global test loss: 1.220, Global test accuracy: 61.89
Round  94, Train loss: 0.507, Test loss: 0.931, Test accuracy: 72.62
Round  94, Global train loss: 0.507, Global test loss: 1.179, Global test accuracy: 62.20
Round  95, Train loss: 0.451, Test loss: 0.924, Test accuracy: 72.56
Round  95, Global train loss: 0.451, Global test loss: 1.297, Global test accuracy: 60.41
Round  96, Train loss: 0.467, Test loss: 0.945, Test accuracy: 71.68
Round  96, Global train loss: 0.467, Global test loss: 1.151, Global test accuracy: 62.74
Round  97, Train loss: 0.387, Test loss: 0.940, Test accuracy: 71.57
Round  97, Global train loss: 0.387, Global test loss: 1.337, Global test accuracy: 60.11
Round  98, Train loss: 0.364, Test loss: 0.937, Test accuracy: 71.96
Round  98, Global train loss: 0.364, Global test loss: 1.321, Global test accuracy: 61.11
Round  99, Train loss: 0.396, Test loss: 0.950, Test accuracy: 71.63
Round  99, Global train loss: 0.396, Global test loss: 1.615, Global test accuracy: 56.10
Final Round, Train loss: 0.360, Test loss: 1.006, Test accuracy: 72.05
Final Round, Global train loss: 0.360, Global test loss: 1.615, Global test accuracy: 56.10
Average accuracy final 10 rounds: 72.122 

Average global accuracy final 10 rounds: 60.202 

1449.3295426368713
[1.5488505363464355, 3.097701072692871, 4.38699197769165, 5.67628288269043, 6.960393190383911, 8.244503498077393, 9.511738061904907, 10.778972625732422, 12.04155683517456, 13.3041410446167, 14.5993173122406, 15.894493579864502, 17.194873094558716, 18.49525260925293, 19.79617953300476, 21.097106456756592, 22.394400358200073, 23.691694259643555, 24.976134061813354, 26.260573863983154, 27.55085253715515, 28.84113121032715, 30.161924600601196, 31.482717990875244, 32.802804470062256, 34.12289094924927, 35.449942111968994, 36.77699327468872, 38.08908271789551, 39.401172161102295, 40.65610456466675, 41.9110369682312, 43.15976595878601, 44.40849494934082, 45.65823173522949, 46.907968521118164, 48.186875104904175, 49.465781688690186, 50.74694061279297, 52.02809953689575, 53.30191946029663, 54.57573938369751, 55.852397203445435, 57.12905502319336, 58.40382981300354, 59.67860460281372, 60.96758317947388, 62.25656175613403, 63.52308440208435, 64.78960704803467, 66.05625319480896, 67.32289934158325, 68.59580755233765, 69.86871576309204, 71.14129042625427, 72.4138650894165, 73.68893957138062, 74.96401405334473, 76.23488354682922, 77.50575304031372, 78.77678918838501, 80.0478253364563, 81.32483339309692, 82.60184144973755, 83.87632250785828, 85.150803565979, 86.41985702514648, 87.68891048431396, 88.95728015899658, 90.2256498336792, 91.49446320533752, 92.76327657699585, 94.03815484046936, 95.31303310394287, 96.5851800441742, 97.85732698440552, 99.12789177894592, 100.39845657348633, 101.65668988227844, 102.91492319107056, 104.17883205413818, 105.44274091720581, 106.71319007873535, 107.98363924026489, 109.24864482879639, 110.51365041732788, 111.78594422340393, 113.05823802947998, 114.31953644752502, 115.58083486557007, 116.84483766555786, 118.10884046554565, 119.3785171508789, 120.64819383621216, 121.92174792289734, 123.19530200958252, 124.46276688575745, 125.73023176193237, 126.99968552589417, 128.26913928985596, 129.54391145706177, 130.81868362426758, 132.08833622932434, 133.3579888343811, 134.62144708633423, 135.88490533828735, 137.15364360809326, 138.42238187789917, 139.69690561294556, 140.97142934799194, 142.2637221813202, 143.55601501464844, 144.82429480552673, 146.09257459640503, 147.36188530921936, 148.6311960220337, 149.89799308776855, 151.16479015350342, 152.43507552146912, 153.70536088943481, 154.96868133544922, 156.23200178146362, 157.4996919631958, 158.76738214492798, 160.03205943107605, 161.29673671722412, 162.5624964237213, 163.8282561302185, 165.09285044670105, 166.3574447631836, 167.63045978546143, 168.90347480773926, 170.16911625862122, 171.43475770950317, 172.70103645324707, 173.96731519699097, 175.24442076683044, 176.52152633666992, 177.79594469070435, 179.07036304473877, 180.3356385231018, 181.60091400146484, 182.87320232391357, 184.1454906463623, 185.41947627067566, 186.693461894989, 187.96596932411194, 189.23847675323486, 190.51463413238525, 191.79079151153564, 193.06596088409424, 194.34113025665283, 195.6134352684021, 196.88574028015137, 198.14944124221802, 199.41314220428467, 200.68282651901245, 201.95251083374023, 203.22436428070068, 204.49621772766113, 205.7714021205902, 207.0465865135193, 208.31389832496643, 209.58121013641357, 210.8431384563446, 212.10506677627563, 213.3796169757843, 214.65416717529297, 215.92922830581665, 217.20428943634033, 218.46983861923218, 219.73538780212402, 221.00581574440002, 222.27624368667603, 223.54211330413818, 224.80798292160034, 226.08688163757324, 227.36578035354614, 228.63678574562073, 229.9077911376953, 231.17734575271606, 232.44690036773682, 233.72952604293823, 235.01215171813965, 236.28484272956848, 237.55753374099731, 238.82160902023315, 240.085684299469, 241.35463738441467, 242.62359046936035, 243.89495372772217, 245.16631698608398, 246.44823837280273, 247.73015975952148, 249.0242006778717, 250.31824159622192, 251.60657620429993, 252.89491081237793, 254.17738032341003, 255.45984983444214, 258.07176399230957, 260.683678150177]
[26.39, 26.39, 31.24, 31.24, 40.05, 40.05, 43.8, 43.8, 46.09, 46.09, 48.99, 48.99, 52.33, 52.33, 54.46, 54.46, 54.79, 54.79, 55.84, 55.84, 57.08, 57.08, 59.07, 59.07, 60.48, 60.48, 61.33, 61.33, 62.08, 62.08, 62.66, 62.66, 62.78, 62.78, 63.62, 63.62, 64.98, 64.98, 64.8, 64.8, 64.7, 64.7, 64.72, 64.72, 65.86, 65.86, 66.16, 66.16, 66.81, 66.81, 66.98, 66.98, 67.2, 67.2, 67.26, 67.26, 68.2, 68.2, 68.88, 68.88, 68.28, 68.28, 68.45, 68.45, 69.01, 69.01, 68.62, 68.62, 68.8, 68.8, 69.17, 69.17, 69.25, 69.25, 69.89, 69.89, 69.73, 69.73, 69.18, 69.18, 69.53, 69.53, 69.37, 69.37, 69.46, 69.46, 69.1, 69.1, 69.59, 69.59, 69.58, 69.58, 69.82, 69.82, 70.11, 70.11, 70.41, 70.41, 70.48, 70.48, 70.77, 70.77, 70.68, 70.68, 70.69, 70.69, 70.54, 70.54, 70.65, 70.65, 71.04, 71.04, 70.99, 70.99, 71.0, 71.0, 71.54, 71.54, 71.97, 71.97, 71.45, 71.45, 71.01, 71.01, 70.95, 70.95, 70.63, 70.63, 71.1, 71.1, 70.58, 70.58, 70.23, 70.23, 70.13, 70.13, 71.14, 71.14, 71.14, 71.14, 71.23, 71.23, 70.87, 70.87, 71.11, 71.11, 71.31, 71.31, 71.71, 71.71, 72.05, 72.05, 72.1, 72.1, 72.1, 72.1, 71.49, 71.49, 72.17, 72.17, 72.26, 72.26, 72.54, 72.54, 72.25, 72.25, 72.31, 72.31, 71.71, 71.71, 71.39, 71.39, 71.79, 71.79, 71.94, 71.94, 71.67, 71.67, 71.98, 71.98, 72.18, 72.18, 72.28, 72.28, 72.26, 72.26, 72.48, 72.48, 72.62, 72.62, 72.56, 72.56, 71.68, 71.68, 71.57, 71.57, 71.96, 71.96, 71.63, 71.63, 72.05, 72.05]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.661, Test loss: 2.010, Test accuracy: 25.44
Round   0, Global train loss: 1.661, Global test loss: 2.217, Global test accuracy: 20.60
Round   1, Train loss: 1.496, Test loss: 1.854, Test accuracy: 29.72
Round   1, Global train loss: 1.496, Global test loss: 2.264, Global test accuracy: 17.82
Round   2, Train loss: 1.424, Test loss: 1.599, Test accuracy: 39.80
Round   2, Global train loss: 1.424, Global test loss: 2.168, Global test accuracy: 24.79
Round   3, Train loss: 1.391, Test loss: 1.447, Test accuracy: 44.65
Round   3, Global train loss: 1.391, Global test loss: 1.900, Global test accuracy: 32.94
Round   4, Train loss: 1.309, Test loss: 1.358, Test accuracy: 47.24
Round   4, Global train loss: 1.309, Global test loss: 2.060, Global test accuracy: 29.41
Round   5, Train loss: 1.328, Test loss: 1.289, Test accuracy: 50.18
Round   5, Global train loss: 1.328, Global test loss: 1.790, Global test accuracy: 36.08
Round   6, Train loss: 1.190, Test loss: 1.260, Test accuracy: 51.98
Round   6, Global train loss: 1.190, Global test loss: 1.811, Global test accuracy: 40.12
Round   7, Train loss: 1.166, Test loss: 1.181, Test accuracy: 54.11
Round   7, Global train loss: 1.166, Global test loss: 1.753, Global test accuracy: 36.52
Round   8, Train loss: 1.161, Test loss: 1.153, Test accuracy: 56.19
Round   8, Global train loss: 1.161, Global test loss: 1.658, Global test accuracy: 39.93
Round   9, Train loss: 1.120, Test loss: 1.135, Test accuracy: 56.81
Round   9, Global train loss: 1.120, Global test loss: 1.702, Global test accuracy: 39.55
Round  10, Train loss: 1.140, Test loss: 1.143, Test accuracy: 56.73
Round  10, Global train loss: 1.140, Global test loss: 1.911, Global test accuracy: 32.01
Round  11, Train loss: 1.051, Test loss: 1.112, Test accuracy: 58.21
Round  11, Global train loss: 1.051, Global test loss: 1.572, Global test accuracy: 43.39
Round  12, Train loss: 1.065, Test loss: 1.091, Test accuracy: 59.57
Round  12, Global train loss: 1.065, Global test loss: 1.682, Global test accuracy: 39.11
Round  13, Train loss: 1.158, Test loss: 1.074, Test accuracy: 60.24
Round  13, Global train loss: 1.158, Global test loss: 1.651, Global test accuracy: 41.04
Round  14, Train loss: 1.094, Test loss: 1.053, Test accuracy: 60.71
Round  14, Global train loss: 1.094, Global test loss: 1.579, Global test accuracy: 45.75
Round  15, Train loss: 1.002, Test loss: 1.044, Test accuracy: 61.03
Round  15, Global train loss: 1.002, Global test loss: 1.535, Global test accuracy: 46.94
Round  16, Train loss: 0.965, Test loss: 1.042, Test accuracy: 60.96
Round  16, Global train loss: 0.965, Global test loss: 1.544, Global test accuracy: 45.26
Round  17, Train loss: 0.981, Test loss: 1.031, Test accuracy: 61.76
Round  17, Global train loss: 0.981, Global test loss: 1.490, Global test accuracy: 45.54
Round  18, Train loss: 0.933, Test loss: 1.026, Test accuracy: 62.13
Round  18, Global train loss: 0.933, Global test loss: 1.526, Global test accuracy: 45.75
Round  19, Train loss: 0.955, Test loss: 1.022, Test accuracy: 62.12
Round  19, Global train loss: 0.955, Global test loss: 1.489, Global test accuracy: 46.06
Round  20, Train loss: 0.915, Test loss: 1.003, Test accuracy: 63.29
Round  20, Global train loss: 0.915, Global test loss: 1.291, Global test accuracy: 54.19
Round  21, Train loss: 0.934, Test loss: 0.981, Test accuracy: 64.15
Round  21, Global train loss: 0.934, Global test loss: 1.437, Global test accuracy: 47.69
Round  22, Train loss: 0.939, Test loss: 0.941, Test accuracy: 65.86
Round  22, Global train loss: 0.939, Global test loss: 1.298, Global test accuracy: 53.97
Round  23, Train loss: 0.836, Test loss: 0.935, Test accuracy: 66.01
Round  23, Global train loss: 0.836, Global test loss: 1.414, Global test accuracy: 49.10
Round  24, Train loss: 0.879, Test loss: 0.952, Test accuracy: 65.68
Round  24, Global train loss: 0.879, Global test loss: 1.266, Global test accuracy: 55.03
Round  25, Train loss: 0.893, Test loss: 0.947, Test accuracy: 65.79
Round  25, Global train loss: 0.893, Global test loss: 1.362, Global test accuracy: 50.30
Round  26, Train loss: 0.837, Test loss: 0.952, Test accuracy: 65.06
Round  26, Global train loss: 0.837, Global test loss: 1.324, Global test accuracy: 53.21
Round  27, Train loss: 0.955, Test loss: 0.935, Test accuracy: 66.00
Round  27, Global train loss: 0.955, Global test loss: 1.359, Global test accuracy: 51.73
Round  28, Train loss: 0.728, Test loss: 0.916, Test accuracy: 66.98
Round  28, Global train loss: 0.728, Global test loss: 1.500, Global test accuracy: 50.09
Round  29, Train loss: 0.855, Test loss: 0.908, Test accuracy: 67.39
Round  29, Global train loss: 0.855, Global test loss: 1.271, Global test accuracy: 55.73
Round  30, Train loss: 0.723, Test loss: 0.930, Test accuracy: 66.76
Round  30, Global train loss: 0.723, Global test loss: 1.253, Global test accuracy: 55.82
Round  31, Train loss: 0.857, Test loss: 0.920, Test accuracy: 67.15
Round  31, Global train loss: 0.857, Global test loss: 1.358, Global test accuracy: 52.53
Round  32, Train loss: 0.707, Test loss: 0.920, Test accuracy: 67.33
Round  32, Global train loss: 0.707, Global test loss: 1.355, Global test accuracy: 53.55
Round  33, Train loss: 0.731, Test loss: 0.898, Test accuracy: 68.17
Round  33, Global train loss: 0.731, Global test loss: 1.277, Global test accuracy: 55.77
Round  34, Train loss: 0.680, Test loss: 0.909, Test accuracy: 67.64
Round  34, Global train loss: 0.680, Global test loss: 1.260, Global test accuracy: 54.95
Round  35, Train loss: 0.705, Test loss: 0.897, Test accuracy: 67.83
Round  35, Global train loss: 0.705, Global test loss: 1.348, Global test accuracy: 51.72
Round  36, Train loss: 0.714, Test loss: 0.894, Test accuracy: 67.95
Round  36, Global train loss: 0.714, Global test loss: 1.336, Global test accuracy: 52.83
Round  37, Train loss: 0.731, Test loss: 0.896, Test accuracy: 68.24
Round  37, Global train loss: 0.731, Global test loss: 1.212, Global test accuracy: 57.81
Round  38, Train loss: 0.725, Test loss: 0.884, Test accuracy: 69.21
Round  38, Global train loss: 0.725, Global test loss: 1.319, Global test accuracy: 54.21
Round  39, Train loss: 0.752, Test loss: 0.893, Test accuracy: 68.96
Round  39, Global train loss: 0.752, Global test loss: 1.467, Global test accuracy: 52.22
Round  40, Train loss: 0.801, Test loss: 0.912, Test accuracy: 68.38
Round  40, Global train loss: 0.801, Global test loss: 1.187, Global test accuracy: 59.04
Round  41, Train loss: 0.693, Test loss: 0.900, Test accuracy: 68.94
Round  41, Global train loss: 0.693, Global test loss: 1.471, Global test accuracy: 51.14
Round  42, Train loss: 0.592, Test loss: 0.909, Test accuracy: 68.85
Round  42, Global train loss: 0.592, Global test loss: 1.335, Global test accuracy: 53.73
Round  43, Train loss: 0.678, Test loss: 0.916, Test accuracy: 68.95
Round  43, Global train loss: 0.678, Global test loss: 1.397, Global test accuracy: 54.60
Round  44, Train loss: 0.624, Test loss: 0.920, Test accuracy: 68.89
Round  44, Global train loss: 0.624, Global test loss: 1.297, Global test accuracy: 55.92
Round  45, Train loss: 0.647, Test loss: 0.902, Test accuracy: 69.23
Round  45, Global train loss: 0.647, Global test loss: 1.292, Global test accuracy: 57.05
Round  46, Train loss: 0.688, Test loss: 0.895, Test accuracy: 69.54
Round  46, Global train loss: 0.688, Global test loss: 1.463, Global test accuracy: 54.87
Round  47, Train loss: 0.615, Test loss: 0.896, Test accuracy: 69.91
Round  47, Global train loss: 0.615, Global test loss: 1.387, Global test accuracy: 55.38
Round  48, Train loss: 0.537, Test loss: 0.894, Test accuracy: 69.94
Round  48, Global train loss: 0.537, Global test loss: 1.236, Global test accuracy: 58.05
Round  49, Train loss: 0.651, Test loss: 0.904, Test accuracy: 69.61
Round  49, Global train loss: 0.651, Global test loss: 1.360, Global test accuracy: 55.19
Round  50, Train loss: 0.686, Test loss: 0.907, Test accuracy: 69.47
Round  50, Global train loss: 0.686, Global test loss: 1.140, Global test accuracy: 60.66
Round  51, Train loss: 0.596, Test loss: 0.912, Test accuracy: 69.56
Round  51, Global train loss: 0.596, Global test loss: 1.201, Global test accuracy: 60.01
Round  52, Train loss: 0.635, Test loss: 0.924, Test accuracy: 69.32
Round  52, Global train loss: 0.635, Global test loss: 1.230, Global test accuracy: 59.16
Round  53, Train loss: 0.608, Test loss: 0.924, Test accuracy: 69.31
Round  53, Global train loss: 0.608, Global test loss: 1.227, Global test accuracy: 59.38
Round  54, Train loss: 0.568, Test loss: 0.916, Test accuracy: 69.90
Round  54, Global train loss: 0.568, Global test loss: 1.211, Global test accuracy: 59.12
Round  55, Train loss: 0.599, Test loss: 0.898, Test accuracy: 70.56
Round  55, Global train loss: 0.599, Global test loss: 1.157, Global test accuracy: 60.27
Round  56, Train loss: 0.576, Test loss: 0.917, Test accuracy: 70.12
Round  56, Global train loss: 0.576, Global test loss: 1.366, Global test accuracy: 56.38
Round  57, Train loss: 0.607, Test loss: 0.911, Test accuracy: 70.39
Round  57, Global train loss: 0.607, Global test loss: 1.300, Global test accuracy: 56.82
Round  58, Train loss: 0.567, Test loss: 0.928, Test accuracy: 70.27
Round  58, Global train loss: 0.567, Global test loss: 1.276, Global test accuracy: 58.98
Round  59, Train loss: 0.577, Test loss: 0.946, Test accuracy: 69.90
Round  59, Global train loss: 0.577, Global test loss: 1.405, Global test accuracy: 54.80
Round  60, Train loss: 0.449, Test loss: 0.934, Test accuracy: 70.23
Round  60, Global train loss: 0.449, Global test loss: 1.328, Global test accuracy: 57.82
Round  61, Train loss: 0.597, Test loss: 0.958, Test accuracy: 69.95
Round  61, Global train loss: 0.597, Global test loss: 1.354, Global test accuracy: 56.04
Round  62, Train loss: 0.567, Test loss: 0.959, Test accuracy: 70.10
Round  62, Global train loss: 0.567, Global test loss: 1.168, Global test accuracy: 60.41
Round  63, Train loss: 0.535, Test loss: 0.964, Test accuracy: 69.37
Round  63, Global train loss: 0.535, Global test loss: 1.455, Global test accuracy: 55.62
Round  64, Train loss: 0.518, Test loss: 0.962, Test accuracy: 69.46
Round  64, Global train loss: 0.518, Global test loss: 1.324, Global test accuracy: 57.79
Round  65, Train loss: 0.531, Test loss: 0.956, Test accuracy: 69.98
Round  65, Global train loss: 0.531, Global test loss: 1.485, Global test accuracy: 55.87
Round  66, Train loss: 0.521, Test loss: 0.936, Test accuracy: 70.75
Round  66, Global train loss: 0.521, Global test loss: 1.256, Global test accuracy: 59.18
Round  67, Train loss: 0.536, Test loss: 0.969, Test accuracy: 69.94
Round  67, Global train loss: 0.536, Global test loss: 1.192, Global test accuracy: 60.86
Round  68, Train loss: 0.544, Test loss: 0.966, Test accuracy: 70.35
Round  68, Global train loss: 0.544, Global test loss: 1.442, Global test accuracy: 57.37
Round  69, Train loss: 0.501, Test loss: 0.983, Test accuracy: 70.22
Round  69, Global train loss: 0.501, Global test loss: 1.410, Global test accuracy: 56.53
Round  70, Train loss: 0.508, Test loss: 0.976, Test accuracy: 70.42
Round  70, Global train loss: 0.508, Global test loss: 1.412, Global test accuracy: 58.39
Round  71, Train loss: 0.489, Test loss: 0.947, Test accuracy: 70.98
Round  71, Global train loss: 0.489, Global test loss: 1.290, Global test accuracy: 59.97
Round  72, Train loss: 0.524, Test loss: 0.928, Test accuracy: 71.75
Round  72, Global train loss: 0.524, Global test loss: 1.312, Global test accuracy: 58.92
Round  73, Train loss: 0.478, Test loss: 0.948, Test accuracy: 71.29
Round  73, Global train loss: 0.478, Global test loss: 1.335, Global test accuracy: 58.90
Round  74, Train loss: 0.481, Test loss: 0.942, Test accuracy: 71.28
Round  74, Global train loss: 0.481, Global test loss: 1.312, Global test accuracy: 59.44
Round  75, Train loss: 0.460, Test loss: 0.954, Test accuracy: 71.03
Round  75, Global train loss: 0.460, Global test loss: 1.266, Global test accuracy: 60.37
Round  76, Train loss: 0.460, Test loss: 0.987, Test accuracy: 70.66
Round  76, Global train loss: 0.460, Global test loss: 1.468, Global test accuracy: 56.33
Round  77, Train loss: 0.431, Test loss: 0.957, Test accuracy: 70.97
Round  77, Global train loss: 0.431, Global test loss: 1.304, Global test accuracy: 60.46
Round  78, Train loss: 0.442, Test loss: 0.963, Test accuracy: 70.93
Round  78, Global train loss: 0.442, Global test loss: 1.253, Global test accuracy: 60.30
Round  79, Train loss: 0.476, Test loss: 0.964, Test accuracy: 71.38
Round  79, Global train loss: 0.476, Global test loss: 1.256, Global test accuracy: 59.44
Round  80, Train loss: 0.561, Test loss: 0.952, Test accuracy: 71.64
Round  80, Global train loss: 0.561, Global test loss: 1.165, Global test accuracy: 62.54
Round  81, Train loss: 0.430, Test loss: 0.967, Test accuracy: 71.41
Round  81, Global train loss: 0.430, Global test loss: 1.183, Global test accuracy: 62.57
Round  82, Train loss: 0.460, Test loss: 0.968, Test accuracy: 71.55
Round  82, Global train loss: 0.460, Global test loss: 1.249, Global test accuracy: 60.83
Round  83, Train loss: 0.537, Test loss: 0.992, Test accuracy: 71.12
Round  83, Global train loss: 0.537, Global test loss: 1.432, Global test accuracy: 56.55
Round  84, Train loss: 0.461, Test loss: 0.989, Test accuracy: 71.33
Round  84, Global train loss: 0.461, Global test loss: 1.314, Global test accuracy: 60.37
Round  85, Train loss: 0.496, Test loss: 0.954, Test accuracy: 71.96
Round  85, Global train loss: 0.496, Global test loss: 1.200, Global test accuracy: 60.83
Round  86, Train loss: 0.392, Test loss: 0.968, Test accuracy: 71.52
Round  86, Global train loss: 0.392, Global test loss: 1.197, Global test accuracy: 61.81
Round  87, Train loss: 0.376, Test loss: 0.988, Test accuracy: 70.97
Round  87, Global train loss: 0.376, Global test loss: 1.366, Global test accuracy: 57.82
Round  88, Train loss: 0.520, Test loss: 0.998, Test accuracy: 70.65
Round  88, Global train loss: 0.520, Global test loss: 1.188, Global test accuracy: 61.67
Round  89, Train loss: 0.386, Test loss: 0.990, Test accuracy: 71.31
Round  89, Global train loss: 0.386, Global test loss: 1.312, Global test accuracy: 59.38
Round  90, Train loss: 0.403, Test loss: 1.021, Test accuracy: 71.19
Round  90, Global train loss: 0.403, Global test loss: 1.515, Global test accuracy: 55.25
Round  91, Train loss: 0.454, Test loss: 1.025, Test accuracy: 71.21
Round  91, Global train loss: 0.454, Global test loss: 1.362, Global test accuracy: 59.54
Round  92, Train loss: 0.368, Test loss: 0.971, Test accuracy: 71.89
Round  92, Global train loss: 0.368, Global test loss: 1.516, Global test accuracy: 56.01
Round  93, Train loss: 0.429, Test loss: 0.958, Test accuracy: 71.93
Round  93, Global train loss: 0.429, Global test loss: 1.257, Global test accuracy: 59.97
Round  94, Train loss: 0.497, Test loss: 0.982, Test accuracy: 71.34
Round  94, Global train loss: 0.497, Global test loss: 1.311, Global test accuracy: 58.96
Round  95, Train loss: 0.443, Test loss: 0.980, Test accuracy: 71.45
Round  95, Global train loss: 0.443, Global test loss: 1.297, Global test accuracy: 60.52
Round  96, Train loss: 0.373, Test loss: 1.014, Test accuracy: 71.10
Round  96, Global train loss: 0.373, Global test loss: 1.235, Global test accuracy: 62.21
Round  97, Train loss: 0.403, Test loss: 1.000, Test accuracy: 71.13
Round  97, Global train loss: 0.403, Global test loss: 1.302, Global test accuracy: 60.60
Round  98, Train loss: 0.406, Test loss: 1.029, Test accuracy: 70.86
Round  98, Global train loss: 0.406, Global test loss: 1.347, Global test accuracy: 60.48
Round  99, Train loss: 0.418, Test loss: 1.017, Test accuracy: 71.02
Round  99, Global train loss: 0.418, Global test loss: 1.606, Global test accuracy: 56.46
Final Round, Train loss: 0.319, Test loss: 1.106, Test accuracy: 70.97
Final Round, Global train loss: 0.319, Global test loss: 1.606, Global test accuracy: 56.46
Average accuracy final 10 rounds: 71.31200000000001
Average global accuracy final 10 rounds: 59.0
2088.071157693863
[2.853193521499634, 5.467965602874756, 8.086690187454224, 10.705804586410522, 13.340636014938354, 15.99329423904419, 18.6234028339386, 21.248887300491333, 23.887861967086792, 26.502298593521118, 29.12907361984253, 31.749907970428467, 34.36362099647522, 36.98488211631775, 39.61681842803955, 42.240506410598755, 44.85964369773865, 47.50934600830078, 50.1583456993103, 52.79399132728577, 55.42051672935486, 58.05460977554321, 60.68450140953064, 63.31896615028381, 65.94764423370361, 68.57545471191406, 71.20993852615356, 73.82948756217957, 76.47199082374573, 79.08504247665405, 81.71738290786743, 84.34765625, 86.96858191490173, 89.59403944015503, 92.22321224212646, 94.8423330783844, 97.46729183197021, 100.09034490585327, 102.70576453208923, 105.32800555229187, 107.9502649307251, 110.57265973091125, 113.19602370262146, 115.81968879699707, 118.44379138946533, 121.08594751358032, 123.7218656539917, 126.3469467163086, 128.96842789649963, 131.612224817276, 134.23342084884644, 136.85720133781433, 139.50055408477783, 142.1389284133911, 144.7668764591217, 147.39787125587463, 150.04089879989624, 152.6667788028717, 155.29064440727234, 157.91154408454895, 160.53708863258362, 163.17729210853577, 165.81839442253113, 168.4246997833252, 171.05075669288635, 173.67677640914917, 176.30064797401428, 178.91587376594543, 181.52043271064758, 184.12226128578186, 186.7308371067047, 189.37336254119873, 191.98758578300476, 194.61312437057495, 197.23931455612183, 199.85065817832947, 202.5119276046753, 205.17106699943542, 207.82690572738647, 210.45718359947205, 213.07690620422363, 215.6991355419159, 218.3110067844391, 220.920560836792, 223.52272963523865, 226.1463041305542, 228.7697949409485, 231.39441752433777, 234.01488947868347, 236.66185188293457, 239.274352312088, 241.90290760993958, 244.521089553833, 247.13834500312805, 249.7470667362213, 252.357159614563, 254.9852795600891, 257.61408591270447, 260.2514727115631, 262.88346815109253, 267.68306398391724]
[25.44, 29.72, 39.8, 44.65, 47.24, 50.18, 51.98, 54.11, 56.19, 56.81, 56.73, 58.21, 59.57, 60.24, 60.71, 61.03, 60.96, 61.76, 62.13, 62.12, 63.29, 64.15, 65.86, 66.01, 65.68, 65.79, 65.06, 66.0, 66.98, 67.39, 66.76, 67.15, 67.33, 68.17, 67.64, 67.83, 67.95, 68.24, 69.21, 68.96, 68.38, 68.94, 68.85, 68.95, 68.89, 69.23, 69.54, 69.91, 69.94, 69.61, 69.47, 69.56, 69.32, 69.31, 69.9, 70.56, 70.12, 70.39, 70.27, 69.9, 70.23, 69.95, 70.1, 69.37, 69.46, 69.98, 70.75, 69.94, 70.35, 70.22, 70.42, 70.98, 71.75, 71.29, 71.28, 71.03, 70.66, 70.97, 70.93, 71.38, 71.64, 71.41, 71.55, 71.12, 71.33, 71.96, 71.52, 70.97, 70.65, 71.31, 71.19, 71.21, 71.89, 71.93, 71.34, 71.45, 71.1, 71.13, 70.86, 71.02, 70.97]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 10, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  15.3800
Round 1 global test acc  17.4500
Round 2 global test acc  22.5300
Round 3 global test acc  21.3300
Round 4 global test acc  21.8800
Round 5 global test acc  21.8700
Round 6 global test acc  30.4800
Round 7 global test acc  26.2800
Round 8 global test acc  26.3000
Round 9 global test acc  30.0800
Round 10 global test acc  35.0200
Round 11 global test acc  35.2900
Round 12 global test acc  33.2300
Round 13 global test acc  29.9100
Round 14 global test acc  33.1800
Round 15 global test acc  34.5700
Round 16 global test acc  35.3100
Round 17 global test acc  34.5400
Round 18 global test acc  36.1700
Round 19 global test acc  29.3300
Round 20 global test acc  37.6000
Round 21 global test acc  40.2100
Round 22 global test acc  36.2600
Round 23 global test acc  35.4800
Round 24 global test acc  41.4700
Round 25 global test acc  33.4900
Round 26 global test acc  38.9600
Round 27 global test acc  33.6800
Round 28 global test acc  37.9700
Round 29 global test acc  37.2400
Round 30 global test acc  38.0100
Round 31 global test acc  36.2400
Round 32 global test acc  32.0100
Round 33 global test acc  31.7900
Round 34 global test acc  31.4100
Round 35 global test acc  34.7000
Round 36 global test acc  40.3000
Round 37 global test acc  38.1900
Round 38 global test acc  37.8300
Round 39 global test acc  34.3300
Round 40 global test acc  37.1800
Round 41 global test acc  37.7400
Round 42 global test acc  37.6900
Round 43 global test acc  37.7400
Round 44 global test acc  40.3700
Round 45 global test acc  38.7900
Round 46 global test acc  40.7800
Round 47 global test acc  37.5800
Round 48 global test acc  36.7600
Round 49 global test acc  46.5200
Round 50 global test acc  38.2100
Round 51 global test acc  38.1900
Round 52 global test acc  36.1200
Round 53 global test acc  43.4800
Round 54 global test acc  41.5600
Round 55 global test acc  43.7700
Round 56 global test acc  45.5600
Round 57 global test acc  45.9800
Round 58 global test acc  45.7800
Round 59 global test acc  42.6300
Round 60 global test acc  45.9000
Round 61 global test acc  42.0500
Round 62 global test acc  43.1400
Round 63 global test acc  45.4600
Round 64 global test acc  37.9800
Round 65 global test acc  39.0900
Round 66 global test acc  36.8100
Round 67 global test acc  38.4200
Round 68 global test acc  40.3600
Round 69 global test acc  40.8800
Round 70 global test acc  49.3800
Round 71 global test acc  45.5000
Round 72 global test acc  36.2800
Round 73 global test acc  40.9100
Round 74 global test acc  41.1500
Round 75 global test acc  41.9300
Round 76 global test acc  48.1600
Round 77 global test acc  44.7600
Round 78 global test acc  45.1800
Round 79 global test acc  43.8100
Round 80 global test acc  43.6500
Round 81 global test acc  42.6100
Round 82 global test acc  43.8600
Round 83 global test acc  44.7400
Round 84 global test acc  44.4000
Round 85 global test acc  43.8500
Round 86 global test acc  44.6000
Round 87 global test acc  42.8100
Round 88 global test acc  42.7700
Round 89 global test acc  41.9000
Round 90 global test acc  42.4200
Round 91 global test acc  42.6900
Round 92 global test acc  42.2900
Round 93 global test acc  41.2500
Round 94 global test acc  42.0100
Round 95 global test acc  40.7700
Round 96 global test acc  40.4800
Round 97 global test acc  41.0300
Round 98 global test acc  42.3900
Round 99 global test acc  41.4700
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.935, Test loss: 2.085, Test accuracy: 28.93
Round   1, Train loss: 1.595, Test loss: 1.935, Test accuracy: 28.80
Round   2, Train loss: 1.532, Test loss: 1.640, Test accuracy: 39.14
Round   3, Train loss: 1.376, Test loss: 1.458, Test accuracy: 43.20
Round   4, Train loss: 1.355, Test loss: 1.374, Test accuracy: 45.85
Round   5, Train loss: 1.306, Test loss: 1.273, Test accuracy: 49.26
Round   6, Train loss: 1.274, Test loss: 1.232, Test accuracy: 52.74
Round   7, Train loss: 1.273, Test loss: 1.144, Test accuracy: 55.60
Round   8, Train loss: 1.170, Test loss: 1.104, Test accuracy: 56.24
Round   9, Train loss: 1.205, Test loss: 1.079, Test accuracy: 57.88
Round  10, Train loss: 1.173, Test loss: 1.065, Test accuracy: 60.03
Round  11, Train loss: 1.115, Test loss: 1.021, Test accuracy: 61.61
Round  12, Train loss: 1.110, Test loss: 0.996, Test accuracy: 62.42
Round  13, Train loss: 1.064, Test loss: 0.954, Test accuracy: 63.58
Round  14, Train loss: 1.031, Test loss: 0.954, Test accuracy: 63.23
Round  15, Train loss: 1.092, Test loss: 0.945, Test accuracy: 63.91
Round  16, Train loss: 1.052, Test loss: 0.933, Test accuracy: 64.88
Round  17, Train loss: 1.046, Test loss: 0.914, Test accuracy: 65.41
Round  18, Train loss: 1.107, Test loss: 0.897, Test accuracy: 65.97
Round  19, Train loss: 1.046, Test loss: 0.900, Test accuracy: 66.56
Round  20, Train loss: 0.988, Test loss: 0.892, Test accuracy: 66.99
Round  21, Train loss: 0.996, Test loss: 0.888, Test accuracy: 66.87
Round  22, Train loss: 1.008, Test loss: 0.853, Test accuracy: 68.34
Round  23, Train loss: 1.005, Test loss: 0.856, Test accuracy: 68.32
Round  24, Train loss: 0.998, Test loss: 0.838, Test accuracy: 68.96
Round  25, Train loss: 0.894, Test loss: 0.852, Test accuracy: 68.12
Round  26, Train loss: 0.999, Test loss: 0.845, Test accuracy: 68.37
Round  27, Train loss: 0.918, Test loss: 0.820, Test accuracy: 69.15
Round  28, Train loss: 0.950, Test loss: 0.810, Test accuracy: 69.25
Round  29, Train loss: 0.937, Test loss: 0.803, Test accuracy: 70.18
Round  30, Train loss: 0.978, Test loss: 0.805, Test accuracy: 70.51
Round  31, Train loss: 0.775, Test loss: 0.807, Test accuracy: 69.98
Round  32, Train loss: 0.974, Test loss: 0.794, Test accuracy: 70.73
Round  33, Train loss: 0.849, Test loss: 0.803, Test accuracy: 70.48
Round  34, Train loss: 0.836, Test loss: 0.796, Test accuracy: 70.77
Round  35, Train loss: 0.818, Test loss: 0.777, Test accuracy: 71.74
Round  36, Train loss: 0.883, Test loss: 0.766, Test accuracy: 71.41
Round  37, Train loss: 0.853, Test loss: 0.766, Test accuracy: 71.49
Round  38, Train loss: 0.826, Test loss: 0.759, Test accuracy: 71.99
Round  39, Train loss: 0.835, Test loss: 0.762, Test accuracy: 71.84
Round  40, Train loss: 0.832, Test loss: 0.751, Test accuracy: 71.86
Round  41, Train loss: 0.830, Test loss: 0.754, Test accuracy: 71.24
Round  42, Train loss: 0.846, Test loss: 0.752, Test accuracy: 72.07
Round  43, Train loss: 0.767, Test loss: 0.753, Test accuracy: 71.97
Round  44, Train loss: 0.840, Test loss: 0.744, Test accuracy: 72.57
Round  45, Train loss: 0.771, Test loss: 0.737, Test accuracy: 72.57
Round  46, Train loss: 0.764, Test loss: 0.725, Test accuracy: 73.18
Round  47, Train loss: 0.730, Test loss: 0.728, Test accuracy: 73.20
Round  48, Train loss: 0.810, Test loss: 0.722, Test accuracy: 73.53
Round  49, Train loss: 0.714, Test loss: 0.717, Test accuracy: 73.69
Round  50, Train loss: 0.821, Test loss: 0.713, Test accuracy: 73.89
Round  51, Train loss: 0.666, Test loss: 0.711, Test accuracy: 73.82
Round  52, Train loss: 0.733, Test loss: 0.708, Test accuracy: 73.82
Round  53, Train loss: 0.763, Test loss: 0.718, Test accuracy: 73.43
Round  54, Train loss: 0.814, Test loss: 0.709, Test accuracy: 73.86
Round  55, Train loss: 0.744, Test loss: 0.708, Test accuracy: 74.06
Round  56, Train loss: 0.669, Test loss: 0.710, Test accuracy: 74.26
Round  57, Train loss: 0.694, Test loss: 0.710, Test accuracy: 74.50
Round  58, Train loss: 0.679, Test loss: 0.705, Test accuracy: 74.39
Round  59, Train loss: 0.674, Test loss: 0.698, Test accuracy: 74.74
Round  60, Train loss: 0.713, Test loss: 0.707, Test accuracy: 73.96
Round  61, Train loss: 0.698, Test loss: 0.705, Test accuracy: 74.55
Round  62, Train loss: 0.721, Test loss: 0.703, Test accuracy: 74.40
Round  63, Train loss: 0.601, Test loss: 0.680, Test accuracy: 75.10
Round  64, Train loss: 0.604, Test loss: 0.683, Test accuracy: 75.10
Round  65, Train loss: 0.663, Test loss: 0.689, Test accuracy: 75.06
Round  66, Train loss: 0.702, Test loss: 0.677, Test accuracy: 75.16
Round  67, Train loss: 0.675, Test loss: 0.686, Test accuracy: 74.95
Round  68, Train loss: 0.707, Test loss: 0.683, Test accuracy: 74.86
Round  69, Train loss: 0.604, Test loss: 0.680, Test accuracy: 74.98
Round  70, Train loss: 0.625, Test loss: 0.701, Test accuracy: 74.44
Round  71, Train loss: 0.603, Test loss: 0.686, Test accuracy: 75.35
Round  72, Train loss: 0.623, Test loss: 0.685, Test accuracy: 75.17
Round  73, Train loss: 0.623, Test loss: 0.695, Test accuracy: 74.95
Round  74, Train loss: 0.567, Test loss: 0.686, Test accuracy: 75.40
Round  75, Train loss: 0.576, Test loss: 0.681, Test accuracy: 75.03
Round  76, Train loss: 0.589, Test loss: 0.682, Test accuracy: 75.27
Round  77, Train loss: 0.617, Test loss: 0.675, Test accuracy: 75.39
Round  78, Train loss: 0.555, Test loss: 0.674, Test accuracy: 75.64
Round  79, Train loss: 0.612, Test loss: 0.673, Test accuracy: 75.99
Round  80, Train loss: 0.605, Test loss: 0.676, Test accuracy: 76.05
Round  81, Train loss: 0.567, Test loss: 0.670, Test accuracy: 76.05
Round  82, Train loss: 0.550, Test loss: 0.671, Test accuracy: 75.79
Round  83, Train loss: 0.511, Test loss: 0.670, Test accuracy: 76.30
Round  84, Train loss: 0.534, Test loss: 0.673, Test accuracy: 76.10
Round  85, Train loss: 0.646, Test loss: 0.668, Test accuracy: 76.11
Round  86, Train loss: 0.550, Test loss: 0.664, Test accuracy: 76.38
Round  87, Train loss: 0.550, Test loss: 0.666, Test accuracy: 76.38
Round  88, Train loss: 0.539, Test loss: 0.661, Test accuracy: 76.43
Round  89, Train loss: 0.489, Test loss: 0.670, Test accuracy: 76.19
Round  90, Train loss: 0.535, Test loss: 0.667, Test accuracy: 76.44
Round  91, Train loss: 0.611, Test loss: 0.667, Test accuracy: 76.15
Round  92, Train loss: 0.546, Test loss: 0.666, Test accuracy: 76.41
Round  93, Train loss: 0.527, Test loss: 0.669, Test accuracy: 76.23
Round  94, Train loss: 0.514, Test loss: 0.674, Test accuracy: 76.24
Round  95, Train loss: 0.503, Test loss: 0.676, Test accuracy: 76.13
Round  96, Train loss: 0.619, Test loss: 0.665, Test accuracy: 76.53
Round  97, Train loss: 0.457, Test loss: 0.674, Test accuracy: 76.23
Round  98, Train loss: 0.475, Test loss: 0.675, Test accuracy: 75.74
Round  99, Train loss: 0.462, Test loss: 0.671, Test accuracy: 76.45
Final Round, Train loss: 0.475, Test loss: 0.666, Test accuracy: 76.54
Average accuracy final 10 rounds: 76.255
942.7016220092773
[1.7083048820495605, 3.097757339477539, 4.489062547683716, 5.760102987289429, 7.033698081970215, 8.300703525543213, 9.563101530075073, 10.827707767486572, 12.09514856338501, 13.363296747207642, 14.634233951568604, 15.904819011688232, 17.176637887954712, 18.449953317642212, 19.721190452575684, 20.849771738052368, 21.9702730178833, 23.09043550491333, 24.210047960281372, 25.329946279525757, 26.44796633720398, 27.567994594573975, 28.688514709472656, 29.807777404785156, 30.928521156311035, 32.04832863807678, 33.167678117752075, 34.286537408828735, 35.40700173377991, 36.52621006965637, 37.64563608169556, 38.76702618598938, 39.885966300964355, 41.003788471221924, 42.121882915496826, 43.24086046218872, 44.36146688461304, 45.47996664047241, 46.59869122505188, 47.71625757217407, 48.84510350227356, 49.9758734703064, 51.10574460029602, 52.237428188323975, 53.367690324783325, 54.4971878528595, 55.615251302719116, 56.73501205444336, 57.85204577445984, 58.97820687294006, 60.107205390930176, 61.23602533340454, 62.36095905303955, 63.48946952819824, 64.6190927028656, 65.7499725818634, 66.88523483276367, 68.00697064399719, 69.12641048431396, 70.24581408500671, 71.36463642120361, 72.49296712875366, 73.62142872810364, 74.74058771133423, 75.87020206451416, 76.99903154373169, 78.12843990325928, 79.2575089931488, 80.3752338886261, 81.49671459197998, 82.61510968208313, 83.73361229896545, 84.85470151901245, 85.97311902046204, 87.10309720039368, 88.23335027694702, 89.3659405708313, 90.48428249359131, 91.6026394367218, 92.7246105670929, 93.85336089134216, 94.98270320892334, 96.10187721252441, 97.22101330757141, 98.33996415138245, 99.45929002761841, 100.58909201622009, 101.71803259849548, 102.8472249507904, 103.97509574890137, 105.10404443740845, 106.2242705821991, 107.34822487831116, 108.47581171989441, 109.60464096069336, 110.73295331001282, 111.86097025871277, 112.9797682762146, 114.10906624794006, 115.2383964061737, 117.09957242012024]
[28.93, 28.8, 39.14, 43.2, 45.85, 49.26, 52.74, 55.6, 56.24, 57.88, 60.03, 61.61, 62.42, 63.58, 63.23, 63.91, 64.88, 65.41, 65.97, 66.56, 66.99, 66.87, 68.34, 68.32, 68.96, 68.12, 68.37, 69.15, 69.25, 70.18, 70.51, 69.98, 70.73, 70.48, 70.77, 71.74, 71.41, 71.49, 71.99, 71.84, 71.86, 71.24, 72.07, 71.97, 72.57, 72.57, 73.18, 73.2, 73.53, 73.69, 73.89, 73.82, 73.82, 73.43, 73.86, 74.06, 74.26, 74.5, 74.39, 74.74, 73.96, 74.55, 74.4, 75.1, 75.1, 75.06, 75.16, 74.95, 74.86, 74.98, 74.44, 75.35, 75.17, 74.95, 75.4, 75.03, 75.27, 75.39, 75.64, 75.99, 76.05, 76.05, 75.79, 76.3, 76.1, 76.11, 76.38, 76.38, 76.43, 76.19, 76.44, 76.15, 76.41, 76.23, 76.24, 76.13, 76.53, 76.23, 75.74, 76.45, 76.54]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 15, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 3, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.754, Test loss: 2.033, Test accuracy: 29.22
Round   1, Train loss: 1.444, Test loss: 1.836, Test accuracy: 32.66
Round   2, Train loss: 1.320, Test loss: 1.538, Test accuracy: 43.34
Round   3, Train loss: 1.214, Test loss: 1.324, Test accuracy: 49.65
Round   4, Train loss: 1.191, Test loss: 1.214, Test accuracy: 54.22
Round   5, Train loss: 1.137, Test loss: 1.100, Test accuracy: 57.97
Round   6, Train loss: 1.040, Test loss: 1.050, Test accuracy: 60.62
Round   7, Train loss: 1.051, Test loss: 0.996, Test accuracy: 61.98
Round   8, Train loss: 0.966, Test loss: 0.975, Test accuracy: 62.00
Round   9, Train loss: 0.940, Test loss: 0.939, Test accuracy: 64.45
Round  10, Train loss: 0.933, Test loss: 0.917, Test accuracy: 66.04
Round  11, Train loss: 0.916, Test loss: 0.879, Test accuracy: 66.93
Round  12, Train loss: 0.859, Test loss: 0.865, Test accuracy: 67.09
Round  13, Train loss: 0.847, Test loss: 0.828, Test accuracy: 68.38
Round  14, Train loss: 0.774, Test loss: 0.814, Test accuracy: 69.36
Round  15, Train loss: 0.796, Test loss: 0.810, Test accuracy: 69.47
Round  16, Train loss: 0.806, Test loss: 0.799, Test accuracy: 69.73
Round  17, Train loss: 0.873, Test loss: 0.797, Test accuracy: 70.04
Round  18, Train loss: 0.754, Test loss: 0.785, Test accuracy: 70.77
Round  19, Train loss: 0.706, Test loss: 0.781, Test accuracy: 70.93
Round  20, Train loss: 0.684, Test loss: 0.766, Test accuracy: 71.66
Round  21, Train loss: 0.656, Test loss: 0.773, Test accuracy: 71.48
Round  22, Train loss: 0.771, Test loss: 0.742, Test accuracy: 72.42
Round  23, Train loss: 0.715, Test loss: 0.748, Test accuracy: 72.62
Round  24, Train loss: 0.724, Test loss: 0.748, Test accuracy: 72.56
Round  25, Train loss: 0.617, Test loss: 0.746, Test accuracy: 72.82
Round  26, Train loss: 0.579, Test loss: 0.743, Test accuracy: 72.59
Round  27, Train loss: 0.591, Test loss: 0.721, Test accuracy: 73.65
Round  28, Train loss: 0.549, Test loss: 0.717, Test accuracy: 73.58
Round  29, Train loss: 0.683, Test loss: 0.710, Test accuracy: 74.49
Round  30, Train loss: 0.566, Test loss: 0.722, Test accuracy: 74.01
Round  31, Train loss: 0.544, Test loss: 0.714, Test accuracy: 74.14
Round  32, Train loss: 0.584, Test loss: 0.712, Test accuracy: 74.43
Round  33, Train loss: 0.587, Test loss: 0.701, Test accuracy: 75.05
Round  34, Train loss: 0.571, Test loss: 0.715, Test accuracy: 74.56
Round  35, Train loss: 0.517, Test loss: 0.706, Test accuracy: 74.83
Round  36, Train loss: 0.543, Test loss: 0.710, Test accuracy: 74.66
Round  37, Train loss: 0.621, Test loss: 0.696, Test accuracy: 75.37
Round  38, Train loss: 0.490, Test loss: 0.698, Test accuracy: 75.19
Round  39, Train loss: 0.536, Test loss: 0.712, Test accuracy: 74.83
Round  40, Train loss: 0.523, Test loss: 0.714, Test accuracy: 74.83
Round  41, Train loss: 0.462, Test loss: 0.722, Test accuracy: 74.56
Round  42, Train loss: 0.463, Test loss: 0.726, Test accuracy: 74.49
Round  43, Train loss: 0.434, Test loss: 0.718, Test accuracy: 74.81
Round  44, Train loss: 0.404, Test loss: 0.715, Test accuracy: 74.68
Round  45, Train loss: 0.476, Test loss: 0.702, Test accuracy: 75.55
Round  46, Train loss: 0.426, Test loss: 0.691, Test accuracy: 75.98
Round  47, Train loss: 0.419, Test loss: 0.689, Test accuracy: 76.07
Round  48, Train loss: 0.413, Test loss: 0.703, Test accuracy: 76.16
Round  49, Train loss: 0.511, Test loss: 0.712, Test accuracy: 75.46
Round  50, Train loss: 0.468, Test loss: 0.731, Test accuracy: 74.99
Round  51, Train loss: 0.449, Test loss: 0.707, Test accuracy: 75.75
Round  52, Train loss: 0.422, Test loss: 0.686, Test accuracy: 76.69
Round  53, Train loss: 0.389, Test loss: 0.705, Test accuracy: 76.19
Round  54, Train loss: 0.430, Test loss: 0.719, Test accuracy: 75.37
Round  55, Train loss: 0.443, Test loss: 0.710, Test accuracy: 75.90
Round  56, Train loss: 0.366, Test loss: 0.703, Test accuracy: 76.32
Round  57, Train loss: 0.420, Test loss: 0.716, Test accuracy: 76.21
Round  58, Train loss: 0.443, Test loss: 0.719, Test accuracy: 75.94
Round  59, Train loss: 0.385, Test loss: 0.715, Test accuracy: 75.71
Round  60, Train loss: 0.356, Test loss: 0.723, Test accuracy: 75.50
Round  61, Train loss: 0.407, Test loss: 0.730, Test accuracy: 75.58
Round  62, Train loss: 0.371, Test loss: 0.723, Test accuracy: 75.87
Round  63, Train loss: 0.353, Test loss: 0.721, Test accuracy: 76.24
Round  64, Train loss: 0.305, Test loss: 0.726, Test accuracy: 76.08
Round  65, Train loss: 0.363, Test loss: 0.735, Test accuracy: 76.35
Round  66, Train loss: 0.382, Test loss: 0.730, Test accuracy: 76.00
Round  67, Train loss: 0.324, Test loss: 0.728, Test accuracy: 76.35
Round  68, Train loss: 0.377, Test loss: 0.725, Test accuracy: 76.01
Round  69, Train loss: 0.298, Test loss: 0.711, Test accuracy: 76.63
Round  70, Train loss: 0.304, Test loss: 0.728, Test accuracy: 76.27
Round  71, Train loss: 0.310, Test loss: 0.736, Test accuracy: 76.26
Round  72, Train loss: 0.310, Test loss: 0.728, Test accuracy: 76.33
Round  73, Train loss: 0.361, Test loss: 0.722, Test accuracy: 76.50
Round  74, Train loss: 0.340, Test loss: 0.744, Test accuracy: 76.04
Round  75, Train loss: 0.333, Test loss: 0.732, Test accuracy: 76.39
Round  76, Train loss: 0.296, Test loss: 0.737, Test accuracy: 76.01
Round  77, Train loss: 0.332, Test loss: 0.736, Test accuracy: 76.10
Round  78, Train loss: 0.299, Test loss: 0.755, Test accuracy: 75.71
Round  79, Train loss: 0.284, Test loss: 0.739, Test accuracy: 76.33
Round  80, Train loss: 0.391, Test loss: 0.737, Test accuracy: 76.40
Round  81, Train loss: 0.280, Test loss: 0.750, Test accuracy: 76.13
Round  82, Train loss: 0.317, Test loss: 0.756, Test accuracy: 76.25
Round  83, Train loss: 0.289, Test loss: 0.762, Test accuracy: 76.06
Round  84, Train loss: 0.289, Test loss: 0.771, Test accuracy: 76.04
Round  85, Train loss: 0.359, Test loss: 0.755, Test accuracy: 76.23
Round  86, Train loss: 0.342, Test loss: 0.777, Test accuracy: 75.46
Round  87, Train loss: 0.260, Test loss: 0.764, Test accuracy: 76.41
Round  88, Train loss: 0.313, Test loss: 0.769, Test accuracy: 75.88
Round  89, Train loss: 0.272, Test loss: 0.774, Test accuracy: 75.66
Round  90, Train loss: 0.312, Test loss: 0.783, Test accuracy: 75.63
Round  91, Train loss: 0.279, Test loss: 0.764, Test accuracy: 75.73
Round  92, Train loss: 0.274, Test loss: 0.777, Test accuracy: 75.91
Round  93, Train loss: 0.291, Test loss: 0.768, Test accuracy: 75.83
Round  94, Train loss: 0.273, Test loss: 0.776, Test accuracy: 76.02
Round  95, Train loss: 0.279, Test loss: 0.774, Test accuracy: 76.13
Round  96, Train loss: 0.262, Test loss: 0.772, Test accuracy: 76.04
Round  97, Train loss: 0.252, Test loss: 0.773, Test accuracy: 76.03
Round  98, Train loss: 0.262, Test loss: 0.782, Test accuracy: 76.16
Round  99, Train loss: 0.248, Test loss: 0.779, Test accuracy: 75.82
Final Round, Train loss: 0.272, Test loss: 0.756, Test accuracy: 76.82
Average accuracy final 10 rounds: 75.92999999999998
2688.507828235626
[3.1834452152252197, 6.001341104507446, 8.819863557815552, 11.645064353942871, 14.477160215377808, 17.304027557373047, 20.12601947784424, 22.937444925308228, 25.75106644630432, 28.569536209106445, 31.383274793624878, 34.20137572288513, 37.03860807418823, 39.84584999084473, 42.6647207736969, 45.48182225227356, 48.30664944648743, 51.12608981132507, 53.95993947982788, 56.792362451553345, 59.61599516868591, 63.921040534973145, 68.25137138366699, 72.56433463096619, 76.86584091186523, 81.20572352409363, 85.54944372177124, 89.90076541900635, 94.24743127822876, 98.59407234191895, 102.94667148590088, 107.2629783153534, 111.56229424476624, 115.97220706939697, 120.3147132396698, 124.65919923782349, 128.99920177459717, 133.35007047653198, 137.69216394424438, 141.99725222587585, 146.28724551200867, 150.62477898597717, 154.93458533287048, 159.23662161827087, 163.54173874855042, 167.837886095047, 172.1366991996765, 176.42579126358032, 180.7357611656189, 185.05103373527527, 189.3525402545929, 193.63907194137573, 197.92934584617615, 202.22549510002136, 206.5401599407196, 210.83309030532837, 215.13996958732605, 219.51822924613953, 223.84342908859253, 228.1508011817932, 232.4728033542633, 236.78882241249084, 241.1043336391449, 245.413969039917, 249.7437150478363, 254.05316281318665, 258.35679864883423, 262.67397809028625, 267.01191759109497, 271.29085421562195, 275.579115152359, 279.87141823768616, 284.18593311309814, 288.5012135505676, 292.7934982776642, 297.09884881973267, 301.4461932182312, 305.7439477443695, 310.0379822254181, 314.34284925460815, 318.6545259952545, 322.9492554664612, 327.2400162220001, 331.547212600708, 335.8538086414337, 340.1699638366699, 344.47844219207764, 348.7811703681946, 353.08744621276855, 357.3922128677368, 361.6959526538849, 365.9963593482971, 370.2908947467804, 374.6352689266205, 378.9731204509735, 383.2967529296875, 387.6598331928253, 392.008113861084, 396.4272119998932, 400.78114342689514, 404.83528327941895]
[29.22, 32.66, 43.34, 49.65, 54.22, 57.97, 60.62, 61.98, 62.0, 64.45, 66.04, 66.93, 67.09, 68.38, 69.36, 69.47, 69.73, 70.04, 70.77, 70.93, 71.66, 71.48, 72.42, 72.62, 72.56, 72.82, 72.59, 73.65, 73.58, 74.49, 74.01, 74.14, 74.43, 75.05, 74.56, 74.83, 74.66, 75.37, 75.19, 74.83, 74.83, 74.56, 74.49, 74.81, 74.68, 75.55, 75.98, 76.07, 76.16, 75.46, 74.99, 75.75, 76.69, 76.19, 75.37, 75.9, 76.32, 76.21, 75.94, 75.71, 75.5, 75.58, 75.87, 76.24, 76.08, 76.35, 76.0, 76.35, 76.01, 76.63, 76.27, 76.26, 76.33, 76.5, 76.04, 76.39, 76.01, 76.1, 75.71, 76.33, 76.4, 76.13, 76.25, 76.06, 76.04, 76.23, 75.46, 76.41, 75.88, 75.66, 75.63, 75.73, 75.91, 75.83, 76.02, 76.13, 76.04, 76.03, 76.16, 75.82, 76.82]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 17, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 6, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.765, Test loss: 1.756, Test accuracy: 37.60
Round   1, Train loss: 1.422, Test loss: 1.300, Test accuracy: 47.22
Round   2, Train loss: 1.255, Test loss: 1.144, Test accuracy: 54.57
Round   3, Train loss: 1.160, Test loss: 1.059, Test accuracy: 57.81
Round   4, Train loss: 1.100, Test loss: 1.013, Test accuracy: 59.91
Round   5, Train loss: 1.060, Test loss: 0.990, Test accuracy: 61.12
Round   6, Train loss: 1.011, Test loss: 0.934, Test accuracy: 63.18
Round   7, Train loss: 0.977, Test loss: 0.896, Test accuracy: 65.48
Round   8, Train loss: 0.944, Test loss: 0.888, Test accuracy: 66.12
Round   9, Train loss: 0.909, Test loss: 0.849, Test accuracy: 67.23
Round  10, Train loss: 0.885, Test loss: 0.857, Test accuracy: 66.98
Round  11, Train loss: 0.852, Test loss: 0.830, Test accuracy: 68.43
Round  12, Train loss: 0.830, Test loss: 0.826, Test accuracy: 68.34
Round  13, Train loss: 0.807, Test loss: 0.796, Test accuracy: 69.92
Round  14, Train loss: 0.778, Test loss: 0.795, Test accuracy: 70.18
Round  15, Train loss: 0.758, Test loss: 0.772, Test accuracy: 71.37
Round  16, Train loss: 0.732, Test loss: 0.753, Test accuracy: 72.06
Round  17, Train loss: 0.715, Test loss: 0.759, Test accuracy: 71.23
Round  18, Train loss: 0.696, Test loss: 0.771, Test accuracy: 71.60
Round  19, Train loss: 0.683, Test loss: 0.746, Test accuracy: 72.65
Round  20, Train loss: 0.685, Test loss: 0.759, Test accuracy: 72.14
Round  21, Train loss: 0.636, Test loss: 0.772, Test accuracy: 71.71
Round  22, Train loss: 0.652, Test loss: 0.756, Test accuracy: 72.00
Round  23, Train loss: 0.647, Test loss: 0.755, Test accuracy: 72.38
Round  24, Train loss: 0.637, Test loss: 0.759, Test accuracy: 72.25
Round  25, Train loss: 0.608, Test loss: 0.747, Test accuracy: 72.38
Round  26, Train loss: 0.645, Test loss: 0.735, Test accuracy: 73.37
Round  27, Train loss: 0.580, Test loss: 0.724, Test accuracy: 73.94
Round  28, Train loss: 0.542, Test loss: 0.716, Test accuracy: 73.90
Round  29, Train loss: 0.606, Test loss: 0.709, Test accuracy: 74.24
Round  30, Train loss: 0.502, Test loss: 0.735, Test accuracy: 73.98
Round  31, Train loss: 0.581, Test loss: 0.738, Test accuracy: 74.52
Round  32, Train loss: 0.524, Test loss: 0.744, Test accuracy: 73.95
Round  33, Train loss: 0.527, Test loss: 0.730, Test accuracy: 74.49
Round  34, Train loss: 0.554, Test loss: 0.745, Test accuracy: 74.12
Round  35, Train loss: 0.554, Test loss: 0.737, Test accuracy: 74.58
Round  36, Train loss: 0.525, Test loss: 0.738, Test accuracy: 74.35
Round  37, Train loss: 0.498, Test loss: 0.728, Test accuracy: 74.94
Round  38, Train loss: 0.475, Test loss: 0.716, Test accuracy: 75.05
Round  39, Train loss: 0.520, Test loss: 0.723, Test accuracy: 75.32
Round  40, Train loss: 0.521, Test loss: 0.730, Test accuracy: 75.06
Round  41, Train loss: 0.523, Test loss: 0.726, Test accuracy: 75.19
Round  42, Train loss: 0.455, Test loss: 0.736, Test accuracy: 75.08
Round  43, Train loss: 0.448, Test loss: 0.737, Test accuracy: 74.92
Round  44, Train loss: 0.440, Test loss: 0.726, Test accuracy: 74.81
Round  45, Train loss: 0.401, Test loss: 0.708, Test accuracy: 75.45
Round  46, Train loss: 0.445, Test loss: 0.711, Test accuracy: 75.37
Round  47, Train loss: 0.463, Test loss: 0.729, Test accuracy: 75.04
Round  48, Train loss: 0.385, Test loss: 0.725, Test accuracy: 74.68
Round  49, Train loss: 0.401, Test loss: 0.723, Test accuracy: 74.49
Round  50, Train loss: 0.475, Test loss: 0.723, Test accuracy: 75.05
Round  51, Train loss: 0.342, Test loss: 0.724, Test accuracy: 74.49
Round  52, Train loss: 0.383, Test loss: 0.728, Test accuracy: 74.91
Round  53, Train loss: 0.468, Test loss: 0.726, Test accuracy: 75.14
Round  54, Train loss: 0.440, Test loss: 0.750, Test accuracy: 74.56
Round  55, Train loss: 0.413, Test loss: 0.726, Test accuracy: 75.27
Round  56, Train loss: 0.379, Test loss: 0.731, Test accuracy: 75.22
Round  57, Train loss: 0.410, Test loss: 0.716, Test accuracy: 75.83
Round  58, Train loss: 0.407, Test loss: 0.719, Test accuracy: 75.61
Round  59, Train loss: 0.407, Test loss: 0.718, Test accuracy: 75.89
Round  60, Train loss: 0.399, Test loss: 0.733, Test accuracy: 75.57
Round  61, Train loss: 0.377, Test loss: 0.734, Test accuracy: 75.19
Round  62, Train loss: 0.404, Test loss: 0.727, Test accuracy: 75.79
Round  63, Train loss: 0.333, Test loss: 0.722, Test accuracy: 75.23
Round  64, Train loss: 0.298, Test loss: 0.728, Test accuracy: 75.67
Round  65, Train loss: 0.360, Test loss: 0.736, Test accuracy: 75.65
Round  66, Train loss: 0.354, Test loss: 0.733, Test accuracy: 75.32
Round  67, Train loss: 0.366, Test loss: 0.760, Test accuracy: 74.90
Round  68, Train loss: 0.313, Test loss: 0.745, Test accuracy: 75.39
Round  69, Train loss: 0.327, Test loss: 0.742, Test accuracy: 75.39
Round  70, Train loss: 0.356, Test loss: 0.771, Test accuracy: 75.29
Round  71, Train loss: 0.326, Test loss: 0.769, Test accuracy: 74.86
Round  72, Train loss: 0.316, Test loss: 0.744, Test accuracy: 75.64
Round  73, Train loss: 0.357, Test loss: 0.747, Test accuracy: 75.63
Round  74, Train loss: 0.337, Test loss: 0.750, Test accuracy: 75.53
Round  75, Train loss: 0.305, Test loss: 0.741, Test accuracy: 75.68
Round  76, Train loss: 0.278, Test loss: 0.743, Test accuracy: 75.43
Round  77, Train loss: 0.312, Test loss: 0.753, Test accuracy: 75.47
Round  78, Train loss: 0.296, Test loss: 0.757, Test accuracy: 75.59
Round  79, Train loss: 0.292, Test loss: 0.736, Test accuracy: 76.20
Round  80, Train loss: 0.312, Test loss: 0.744, Test accuracy: 76.51
Round  81, Train loss: 0.292, Test loss: 0.723, Test accuracy: 76.56
Round  82, Train loss: 0.286, Test loss: 0.738, Test accuracy: 76.14
Round  83, Train loss: 0.284, Test loss: 0.732, Test accuracy: 76.33
Round  84, Train loss: 0.281, Test loss: 0.736, Test accuracy: 76.10
Round  85, Train loss: 0.277, Test loss: 0.748, Test accuracy: 76.11
Round  86, Train loss: 0.274, Test loss: 0.726, Test accuracy: 76.78
Round  87, Train loss: 0.270, Test loss: 0.752, Test accuracy: 76.21
Round  88, Train loss: 0.265, Test loss: 0.738, Test accuracy: 76.42
Round  89, Train loss: 0.260, Test loss: 0.748, Test accuracy: 76.56
Round  90, Train loss: 0.264, Test loss: 0.745, Test accuracy: 76.77
Round  91, Train loss: 0.265, Test loss: 0.752, Test accuracy: 76.30
Round  92, Train loss: 0.260, Test loss: 0.773, Test accuracy: 76.14
Round  93, Train loss: 0.253, Test loss: 0.752, Test accuracy: 76.41
Round  94, Train loss: 0.253, Test loss: 0.760, Test accuracy: 76.34
Round  95, Train loss: 0.255, Test loss: 0.775, Test accuracy: 76.07
Round  96, Train loss: 0.249, Test loss: 0.749, Test accuracy: 76.27
Round  97, Train loss: 0.243, Test loss: 0.762, Test accuracy: 76.31
Round  98, Train loss: 0.244, Test loss: 0.761, Test accuracy: 76.26
Round  99, Train loss: 0.241, Test loss: 0.760, Test accuracy: 76.41
Final Round, Train loss: 0.209, Test loss: 0.762, Test accuracy: 76.30
Average accuracy final 10 rounds: 76.328
3475.70991563797
[3.1342904567718506, 5.955583095550537, 8.771912574768066, 11.562456369400024, 14.372772932052612, 17.198972940444946, 20.020651817321777, 22.852494955062866, 25.68582534790039, 28.524850606918335, 31.333974599838257, 34.164161682128906, 36.98175668716431, 39.737932205200195, 42.50036144256592, 45.27088761329651, 48.04790449142456, 50.83302164077759, 53.625529289245605, 56.36203479766846, 59.08748412132263, 61.80586838722229, 64.52093529701233, 67.22774720191956, 69.95531344413757, 72.66170740127563, 75.37109780311584, 78.09027290344238, 80.81399869918823, 83.53700089454651, 86.27359771728516, 88.99142837524414, 91.7286729812622, 94.45363235473633, 97.22408103942871, 99.96039867401123, 102.67815256118774, 105.40830636024475, 108.14905500411987, 110.89059090614319, 113.62383937835693, 116.34806799888611, 119.08920192718506, 121.83796644210815, 124.57008290290833, 127.29474234580994, 130.02256298065186, 132.75277423858643, 135.4833323955536, 138.2139356136322, 140.9129114151001, 143.650573015213, 146.4086365699768, 149.1610791683197, 151.9137544631958, 154.67317700386047, 157.4253740310669, 160.16483640670776, 162.9015679359436, 165.64317178726196, 168.38192558288574, 171.13870978355408, 173.87998294830322, 176.63614583015442, 179.39054131507874, 182.1517300605774, 184.884624004364, 187.62849617004395, 190.35599970817566, 193.11778712272644, 195.87288999557495, 198.60161566734314, 201.34259629249573, 204.09622740745544, 206.84144020080566, 209.57065296173096, 212.31455826759338, 215.06420588493347, 217.8138337135315, 220.58785462379456, 223.38802242279053, 226.15983319282532, 228.92347240447998, 231.68224358558655, 234.44799757003784, 237.21744179725647, 239.98539543151855, 242.77861857414246, 245.58499264717102, 248.39051580429077, 251.17188811302185, 253.91771459579468, 256.69257736206055, 259.44544529914856, 262.19798946380615, 264.9390790462494, 267.693222284317, 270.4453468322754, 273.1873197555542, 275.93562936782837, 279.88330483436584]
[37.6, 47.22, 54.57, 57.81, 59.91, 61.12, 63.18, 65.48, 66.12, 67.23, 66.98, 68.43, 68.34, 69.92, 70.18, 71.37, 72.06, 71.23, 71.6, 72.65, 72.14, 71.71, 72.0, 72.38, 72.25, 72.38, 73.37, 73.94, 73.9, 74.24, 73.98, 74.52, 73.95, 74.49, 74.12, 74.58, 74.35, 74.94, 75.05, 75.32, 75.06, 75.19, 75.08, 74.92, 74.81, 75.45, 75.37, 75.04, 74.68, 74.49, 75.05, 74.49, 74.91, 75.14, 74.56, 75.27, 75.22, 75.83, 75.61, 75.89, 75.57, 75.19, 75.79, 75.23, 75.67, 75.65, 75.32, 74.9, 75.39, 75.39, 75.29, 74.86, 75.64, 75.63, 75.53, 75.68, 75.43, 75.47, 75.59, 76.2, 76.51, 76.56, 76.14, 76.33, 76.1, 76.11, 76.78, 76.21, 76.42, 76.56, 76.77, 76.3, 76.14, 76.41, 76.34, 76.07, 76.27, 76.31, 76.26, 76.41, 76.3]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 3, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
   Client 7, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 0, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 13, noise    level: 0.4000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.746, Test loss: 1.708, Test accuracy: 34.02
Round   1, Train loss: 1.418, Test loss: 1.291, Test accuracy: 47.56
Round   2, Train loss: 1.266, Test loss: 1.150, Test accuracy: 54.36
Round   3, Train loss: 1.178, Test loss: 1.064, Test accuracy: 58.31
Round   4, Train loss: 1.117, Test loss: 1.026, Test accuracy: 59.94
Round   5, Train loss: 1.079, Test loss: 0.975, Test accuracy: 62.44
Round   6, Train loss: 1.034, Test loss: 0.938, Test accuracy: 63.86
Round   7, Train loss: 0.999, Test loss: 0.903, Test accuracy: 65.26
Round   8, Train loss: 0.963, Test loss: 0.893, Test accuracy: 66.23
Round   9, Train loss: 0.935, Test loss: 0.876, Test accuracy: 65.99
Round  10, Train loss: 0.904, Test loss: 0.839, Test accuracy: 68.15
Round  11, Train loss: 0.879, Test loss: 0.827, Test accuracy: 68.79
Round  12, Train loss: 0.849, Test loss: 0.815, Test accuracy: 69.22
Round  13, Train loss: 0.826, Test loss: 0.792, Test accuracy: 70.43
Round  14, Train loss: 0.802, Test loss: 0.780, Test accuracy: 70.98
Round  15, Train loss: 0.778, Test loss: 0.764, Test accuracy: 71.70
Round  16, Train loss: 0.759, Test loss: 0.765, Test accuracy: 71.62
Round  17, Train loss: 0.739, Test loss: 0.745, Test accuracy: 72.36
Round  18, Train loss: 0.721, Test loss: 0.751, Test accuracy: 72.42
Round  19, Train loss: 0.701, Test loss: 0.730, Test accuracy: 73.16
Round  20, Train loss: 0.691, Test loss: 0.749, Test accuracy: 72.72
Round  21, Train loss: 0.715, Test loss: 0.747, Test accuracy: 72.41
Round  22, Train loss: 0.642, Test loss: 0.742, Test accuracy: 73.26
Round  23, Train loss: 0.687, Test loss: 0.725, Test accuracy: 73.92
Round  24, Train loss: 0.661, Test loss: 0.723, Test accuracy: 73.69
Round  25, Train loss: 0.600, Test loss: 0.718, Test accuracy: 74.34
Round  26, Train loss: 0.691, Test loss: 0.728, Test accuracy: 73.90
Round  27, Train loss: 0.561, Test loss: 0.727, Test accuracy: 74.34
Round  28, Train loss: 0.620, Test loss: 0.736, Test accuracy: 73.86
Round  29, Train loss: 0.587, Test loss: 0.720, Test accuracy: 74.30
Round  30, Train loss: 0.593, Test loss: 0.714, Test accuracy: 74.32
Round  31, Train loss: 0.571, Test loss: 0.731, Test accuracy: 74.21
Round  32, Train loss: 0.545, Test loss: 0.732, Test accuracy: 74.16
Round  33, Train loss: 0.520, Test loss: 0.717, Test accuracy: 74.50
Round  34, Train loss: 0.481, Test loss: 0.726, Test accuracy: 74.30
Round  35, Train loss: 0.464, Test loss: 0.720, Test accuracy: 74.63
Round  36, Train loss: 0.630, Test loss: 0.731, Test accuracy: 74.41
Round  37, Train loss: 0.547, Test loss: 0.726, Test accuracy: 74.61
Round  38, Train loss: 0.433, Test loss: 0.717, Test accuracy: 75.10
Round  39, Train loss: 0.523, Test loss: 0.697, Test accuracy: 75.47
Round  40, Train loss: 0.483, Test loss: 0.693, Test accuracy: 75.68
Round  41, Train loss: 0.519, Test loss: 0.698, Test accuracy: 75.58
Round  42, Train loss: 0.444, Test loss: 0.704, Test accuracy: 75.99
Round  43, Train loss: 0.399, Test loss: 0.676, Test accuracy: 76.43
Round  44, Train loss: 0.509, Test loss: 0.703, Test accuracy: 75.88
Round  45, Train loss: 0.512, Test loss: 0.714, Test accuracy: 75.48
Round  46, Train loss: 0.392, Test loss: 0.705, Test accuracy: 75.99
Round  47, Train loss: 0.473, Test loss: 0.722, Test accuracy: 75.58
Round  48, Train loss: 0.455, Test loss: 0.715, Test accuracy: 75.98
Round  49, Train loss: 0.442, Test loss: 0.735, Test accuracy: 74.90
Round  50, Train loss: 0.524, Test loss: 0.731, Test accuracy: 75.01
Round  51, Train loss: 0.373, Test loss: 0.727, Test accuracy: 75.38
Round  52, Train loss: 0.442, Test loss: 0.709, Test accuracy: 76.05
Round  53, Train loss: 0.419, Test loss: 0.714, Test accuracy: 75.76
Round  54, Train loss: 0.446, Test loss: 0.731, Test accuracy: 75.64
Round  55, Train loss: 0.415, Test loss: 0.718, Test accuracy: 76.09
Round  56, Train loss: 0.450, Test loss: 0.744, Test accuracy: 75.75
Round  57, Train loss: 0.432, Test loss: 0.738, Test accuracy: 75.84
Round  58, Train loss: 0.427, Test loss: 0.734, Test accuracy: 75.53
Round  59, Train loss: 0.463, Test loss: 0.756, Test accuracy: 75.56
Round  60, Train loss: 0.418, Test loss: 0.758, Test accuracy: 75.70
Round  61, Train loss: 0.414, Test loss: 0.740, Test accuracy: 75.71
Round  62, Train loss: 0.370, Test loss: 0.731, Test accuracy: 75.86
Round  63, Train loss: 0.423, Test loss: 0.757, Test accuracy: 75.51
Round  64, Train loss: 0.301, Test loss: 0.733, Test accuracy: 75.96
Round  65, Train loss: 0.391, Test loss: 0.747, Test accuracy: 75.45
Round  66, Train loss: 0.348, Test loss: 0.745, Test accuracy: 75.87
Round  67, Train loss: 0.403, Test loss: 0.755, Test accuracy: 75.76
Round  68, Train loss: 0.342, Test loss: 0.770, Test accuracy: 75.06
Round  69, Train loss: 0.324, Test loss: 0.786, Test accuracy: 74.76
Round  70, Train loss: 0.309, Test loss: 0.794, Test accuracy: 74.86
Round  71, Train loss: 0.313, Test loss: 0.769, Test accuracy: 75.11
Round  72, Train loss: 0.392, Test loss: 0.749, Test accuracy: 75.65
Round  73, Train loss: 0.349, Test loss: 0.767, Test accuracy: 75.00
Round  74, Train loss: 0.311, Test loss: 0.752, Test accuracy: 75.97
Round  75, Train loss: 0.376, Test loss: 0.762, Test accuracy: 75.72
Round  76, Train loss: 0.284, Test loss: 0.752, Test accuracy: 76.15
Round  77, Train loss: 0.298, Test loss: 0.756, Test accuracy: 76.03
Round  78, Train loss: 0.312, Test loss: 0.770, Test accuracy: 75.90
Round  79, Train loss: 0.280, Test loss: 0.758, Test accuracy: 75.58
Round  80, Train loss: 0.313, Test loss: 0.748, Test accuracy: 75.86
Round  81, Train loss: 0.307, Test loss: 0.753, Test accuracy: 75.93
Round  82, Train loss: 0.304, Test loss: 0.769, Test accuracy: 75.56
Round  83, Train loss: 0.303, Test loss: 0.759, Test accuracy: 76.02
Round  84, Train loss: 0.292, Test loss: 0.763, Test accuracy: 75.93
Round  85, Train loss: 0.286, Test loss: 0.753, Test accuracy: 76.38
Round  86, Train loss: 0.282, Test loss: 0.749, Test accuracy: 76.69
Round  87, Train loss: 0.281, Test loss: 0.775, Test accuracy: 75.95
Round  88, Train loss: 0.273, Test loss: 0.769, Test accuracy: 75.91
Round  89, Train loss: 0.269, Test loss: 0.764, Test accuracy: 76.26
Round  90, Train loss: 0.277, Test loss: 0.763, Test accuracy: 76.33
Round  91, Train loss: 0.264, Test loss: 0.778, Test accuracy: 75.79
Round  92, Train loss: 0.264, Test loss: 0.763, Test accuracy: 76.07
Round  93, Train loss: 0.262, Test loss: 0.761, Test accuracy: 75.91
Round  94, Train loss: 0.261, Test loss: 0.776, Test accuracy: 75.97
Round  95, Train loss: 0.260, Test loss: 0.762, Test accuracy: 76.19
Round  96, Train loss: 0.255, Test loss: 0.774, Test accuracy: 75.79
Round  97, Train loss: 0.253, Test loss: 0.767, Test accuracy: 76.52
Round  98, Train loss: 0.252, Test loss: 0.792, Test accuracy: 75.77
Round  99, Train loss: 0.255, Test loss: 0.776, Test accuracy: 76.22
Final Round, Train loss: 0.214, Test loss: 0.776, Test accuracy: 76.77
Average accuracy final 10 rounds: 76.056
4672.62276673317
[2.982612133026123, 5.816688060760498, 8.657691478729248, 11.498159408569336, 14.32284140586853, 17.134870052337646, 19.947063446044922, 22.762237787246704, 25.588423490524292, 28.41321349143982, 31.224498987197876, 34.03924202919006, 36.86334681510925, 39.68070316314697, 42.51747012138367, 45.359445571899414, 48.19259834289551, 51.033488035202026, 53.87899470329285, 56.71259665489197, 59.51928353309631, 63.858105421066284, 68.19273376464844, 72.49483513832092, 76.7860975265503, 81.08207368850708, 85.36632704734802, 89.71836280822754, 94.06737422943115, 98.42503452301025, 102.72779989242554, 107.08042049407959, 111.42364645004272, 115.66772246360779, 119.91816854476929, 124.21161222457886, 128.5049376487732, 132.83225440979004, 137.16037440299988, 141.50254368782043, 145.83550429344177, 150.14330768585205, 154.47872686386108, 158.8098030090332, 163.1387152671814, 167.45969676971436, 171.76202607154846, 176.10899186134338, 180.46842408180237, 184.82347178459167, 189.13945269584656, 193.4641876220703, 197.8773500919342, 202.26017713546753, 206.59146547317505, 210.96954941749573, 215.31348419189453, 219.6306438446045, 223.94981956481934, 228.2784333229065, 232.59449911117554, 236.9194610118866, 241.2504060268402, 245.5815989971161, 249.8859589099884, 254.2074248790741, 258.54081416130066, 262.86287212371826, 267.1974768638611, 271.53326773643494, 275.84611678123474, 280.1732382774353, 284.500691652298, 288.814288854599, 293.134281873703, 297.4528224468231, 301.7644293308258, 306.0869209766388, 310.4063940048218, 314.7344129085541, 319.06924986839294, 323.43867778778076, 327.75522470474243, 332.0519366264343, 336.370920419693, 340.6844460964203, 345.0459041595459, 349.3826570510864, 353.7000606060028, 358.0288887023926, 362.3620493412018, 366.68574261665344, 371.0100607872009, 375.3977327346802, 379.7251310348511, 384.0502951145172, 388.36703610420227, 392.6744747161865, 396.9870765209198, 401.3038663864136, 405.32289838790894]
[34.02, 47.56, 54.36, 58.31, 59.94, 62.44, 63.86, 65.26, 66.23, 65.99, 68.15, 68.79, 69.22, 70.43, 70.98, 71.7, 71.62, 72.36, 72.42, 73.16, 72.72, 72.41, 73.26, 73.92, 73.69, 74.34, 73.9, 74.34, 73.86, 74.3, 74.32, 74.21, 74.16, 74.5, 74.3, 74.63, 74.41, 74.61, 75.1, 75.47, 75.68, 75.58, 75.99, 76.43, 75.88, 75.48, 75.99, 75.58, 75.98, 74.9, 75.01, 75.38, 76.05, 75.76, 75.64, 76.09, 75.75, 75.84, 75.53, 75.56, 75.7, 75.71, 75.86, 75.51, 75.96, 75.45, 75.87, 75.76, 75.06, 74.76, 74.86, 75.11, 75.65, 75.0, 75.97, 75.72, 76.15, 76.03, 75.9, 75.58, 75.86, 75.93, 75.56, 76.02, 75.93, 76.38, 76.69, 75.95, 75.91, 76.26, 76.33, 75.79, 76.07, 75.91, 75.97, 76.19, 75.79, 76.52, 75.77, 76.22, 76.77]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.702, Test loss: 2.140, Test accuracy: 20.41
Round   0, Global train loss: 1.702, Global test loss: 2.330, Global test accuracy: 18.36
Round   1, Train loss: 1.669, Test loss: 2.026, Test accuracy: 17.54
Round   1, Global train loss: 1.669, Global test loss: 2.362, Global test accuracy: 13.00
Round   2, Train loss: 1.648, Test loss: 1.883, Test accuracy: 25.34
Round   2, Global train loss: 1.648, Global test loss: 2.392, Global test accuracy: 24.15
Round   3, Train loss: 1.615, Test loss: 1.646, Test accuracy: 27.03
Round   3, Global train loss: 1.615, Global test loss: 2.125, Global test accuracy: 24.82
Round   4, Train loss: 1.633, Test loss: 1.615, Test accuracy: 28.80
Round   4, Global train loss: 1.633, Global test loss: 2.233, Global test accuracy: 21.72
Round   5, Train loss: 1.649, Test loss: 1.563, Test accuracy: 32.04
Round   5, Global train loss: 1.649, Global test loss: 2.326, Global test accuracy: 11.00
Round   6, Train loss: 1.634, Test loss: 1.534, Test accuracy: 33.66
Round   6, Global train loss: 1.634, Global test loss: 2.394, Global test accuracy: 10.99
Round   7, Train loss: 1.509, Test loss: 1.518, Test accuracy: 34.48
Round   7, Global train loss: 1.509, Global test loss: 2.193, Global test accuracy: 18.08
Round   8, Train loss: 1.433, Test loss: 1.490, Test accuracy: 35.99
Round   8, Global train loss: 1.433, Global test loss: 2.041, Global test accuracy: 29.07
Round   9, Train loss: 1.489, Test loss: 1.469, Test accuracy: 37.51
Round   9, Global train loss: 1.489, Global test loss: 2.251, Global test accuracy: 16.38
Round  10, Train loss: 1.544, Test loss: 1.467, Test accuracy: 37.55
Round  10, Global train loss: 1.544, Global test loss: 2.370, Global test accuracy: 16.04
Round  11, Train loss: 1.498, Test loss: 1.462, Test accuracy: 36.89
Round  11, Global train loss: 1.498, Global test loss: 2.210, Global test accuracy: 19.99
Round  12, Train loss: 1.418, Test loss: 1.457, Test accuracy: 37.00
Round  12, Global train loss: 1.418, Global test loss: 2.204, Global test accuracy: 22.51
Round  13, Train loss: 1.411, Test loss: 1.454, Test accuracy: 37.66
Round  13, Global train loss: 1.411, Global test loss: 2.130, Global test accuracy: 25.98
Round  14, Train loss: 1.373, Test loss: 1.447, Test accuracy: 37.63
Round  14, Global train loss: 1.373, Global test loss: 2.273, Global test accuracy: 24.14
Round  15, Train loss: 1.515, Test loss: 1.448, Test accuracy: 37.29
Round  15, Global train loss: 1.515, Global test loss: 2.227, Global test accuracy: 18.01
Round  16, Train loss: 1.485, Test loss: 1.445, Test accuracy: 38.35
Round  16, Global train loss: 1.485, Global test loss: 2.181, Global test accuracy: 18.73
Round  17, Train loss: 1.534, Test loss: 1.443, Test accuracy: 38.05
Round  17, Global train loss: 1.534, Global test loss: 2.174, Global test accuracy: 22.37
Round  18, Train loss: 1.251, Test loss: 1.443, Test accuracy: 38.41
Round  18, Global train loss: 1.251, Global test loss: 2.109, Global test accuracy: 24.35
Round  19, Train loss: 1.402, Test loss: 1.435, Test accuracy: 38.82
Round  19, Global train loss: 1.402, Global test loss: 2.187, Global test accuracy: 13.09
Round  20, Train loss: 1.284, Test loss: 1.437, Test accuracy: 38.99
Round  20, Global train loss: 1.284, Global test loss: 2.094, Global test accuracy: 29.88
Round  21, Train loss: 1.386, Test loss: 1.445, Test accuracy: 39.61
Round  21, Global train loss: 1.386, Global test loss: 2.199, Global test accuracy: 22.50
Round  22, Train loss: 1.219, Test loss: 1.433, Test accuracy: 40.11
Round  22, Global train loss: 1.219, Global test loss: 2.146, Global test accuracy: 27.75
Round  23, Train loss: 1.452, Test loss: 1.441, Test accuracy: 40.17
Round  23, Global train loss: 1.452, Global test loss: 2.150, Global test accuracy: 19.96
Round  24, Train loss: 1.201, Test loss: 1.452, Test accuracy: 39.65
Round  24, Global train loss: 1.201, Global test loss: 2.207, Global test accuracy: 17.94
Round  25, Train loss: 1.201, Test loss: 1.450, Test accuracy: 39.91
Round  25, Global train loss: 1.201, Global test loss: 2.067, Global test accuracy: 19.46
Round  26, Train loss: 1.317, Test loss: 1.454, Test accuracy: 40.38
Round  26, Global train loss: 1.317, Global test loss: 2.219, Global test accuracy: 25.04
Round  27, Train loss: 1.142, Test loss: 1.450, Test accuracy: 41.08
Round  27, Global train loss: 1.142, Global test loss: 2.069, Global test accuracy: 26.18
Round  28, Train loss: 1.394, Test loss: 1.468, Test accuracy: 39.88
Round  28, Global train loss: 1.394, Global test loss: 2.225, Global test accuracy: 19.37
Round  29, Train loss: 1.224, Test loss: 1.445, Test accuracy: 41.07
Round  29, Global train loss: 1.224, Global test loss: 2.135, Global test accuracy: 19.81
Round  30, Train loss: 1.289, Test loss: 1.468, Test accuracy: 40.03
Round  30, Global train loss: 1.289, Global test loss: 2.052, Global test accuracy: 29.40
Round  31, Train loss: 1.060, Test loss: 1.489, Test accuracy: 39.87
Round  31, Global train loss: 1.060, Global test loss: 2.046, Global test accuracy: 28.71
Round  32, Train loss: 1.488, Test loss: 1.485, Test accuracy: 40.08
Round  32, Global train loss: 1.488, Global test loss: 2.293, Global test accuracy: 17.54
Round  33, Train loss: 1.014, Test loss: 1.475, Test accuracy: 40.66
Round  33, Global train loss: 1.014, Global test loss: 2.078, Global test accuracy: 23.71
Round  34, Train loss: 0.925, Test loss: 1.490, Test accuracy: 39.82
Round  34, Global train loss: 0.925, Global test loss: 2.079, Global test accuracy: 20.82
Round  35, Train loss: 1.429, Test loss: 1.489, Test accuracy: 40.07
Round  35, Global train loss: 1.429, Global test loss: 2.249, Global test accuracy: 13.01
Round  36, Train loss: 1.186, Test loss: 1.500, Test accuracy: 40.43
Round  36, Global train loss: 1.186, Global test loss: 2.178, Global test accuracy: 14.35
Round  37, Train loss: 1.239, Test loss: 1.504, Test accuracy: 40.02
Round  37, Global train loss: 1.239, Global test loss: 2.223, Global test accuracy: 17.74
Round  38, Train loss: 1.218, Test loss: 1.515, Test accuracy: 40.14
Round  38, Global train loss: 1.218, Global test loss: 2.100, Global test accuracy: 25.91
Round  39, Train loss: 1.127, Test loss: 1.528, Test accuracy: 40.31
Round  39, Global train loss: 1.127, Global test loss: 2.200, Global test accuracy: 19.93
Round  40, Train loss: 1.089, Test loss: 1.550, Test accuracy: 40.08
Round  40, Global train loss: 1.089, Global test loss: 2.117, Global test accuracy: 27.16
Round  41, Train loss: 1.076, Test loss: 1.575, Test accuracy: 39.52
Round  41, Global train loss: 1.076, Global test loss: 2.172, Global test accuracy: 24.33
Round  42, Train loss: 1.127, Test loss: 1.591, Test accuracy: 39.51
Round  42, Global train loss: 1.127, Global test loss: 2.177, Global test accuracy: 16.64
Round  43, Train loss: 0.918, Test loss: 1.610, Test accuracy: 39.27
Round  43, Global train loss: 0.918, Global test loss: 2.068, Global test accuracy: 26.38
Round  44, Train loss: 1.043, Test loss: 1.627, Test accuracy: 39.20
Round  44, Global train loss: 1.043, Global test loss: 2.103, Global test accuracy: 21.06
Round  45, Train loss: 1.079, Test loss: 1.652, Test accuracy: 39.33
Round  45, Global train loss: 1.079, Global test loss: 2.103, Global test accuracy: 23.33
Round  46, Train loss: 1.161, Test loss: 1.655, Test accuracy: 39.54
Round  46, Global train loss: 1.161, Global test loss: 2.143, Global test accuracy: 17.76
Round  47, Train loss: 1.008, Test loss: 1.676, Test accuracy: 38.94
Round  47, Global train loss: 1.008, Global test loss: 2.084, Global test accuracy: 26.78
Round  48, Train loss: 0.837, Test loss: 1.698, Test accuracy: 39.30
Round  48, Global train loss: 0.837, Global test loss: 2.062, Global test accuracy: 25.50
Round  49, Train loss: 0.923, Test loss: 1.708, Test accuracy: 39.04
Round  49, Global train loss: 0.923, Global test loss: 2.098, Global test accuracy: 17.33
Round  50, Train loss: 0.983, Test loss: 1.767, Test accuracy: 38.71
Round  50, Global train loss: 0.983, Global test loss: 2.189, Global test accuracy: 14.16
Round  51, Train loss: 0.890, Test loss: 1.780, Test accuracy: 38.92
Round  51, Global train loss: 0.890, Global test loss: 2.214, Global test accuracy: 22.03
Round  52, Train loss: 0.611, Test loss: 1.828, Test accuracy: 38.81
Round  52, Global train loss: 0.611, Global test loss: 2.053, Global test accuracy: 23.80
Round  53, Train loss: 1.067, Test loss: 1.873, Test accuracy: 38.92
Round  53, Global train loss: 1.067, Global test loss: 2.228, Global test accuracy: 14.95
Round  54, Train loss: 1.190, Test loss: 1.889, Test accuracy: 39.05
Round  54, Global train loss: 1.190, Global test loss: 2.242, Global test accuracy: 14.74
Round  55, Train loss: 0.593, Test loss: 1.911, Test accuracy: 38.62
Round  55, Global train loss: 0.593, Global test loss: 2.045, Global test accuracy: 27.61
Round  56, Train loss: 1.076, Test loss: 1.934, Test accuracy: 38.34
Round  56, Global train loss: 1.076, Global test loss: 2.279, Global test accuracy: 13.50
Round  57, Train loss: 0.953, Test loss: 1.979, Test accuracy: 38.31
Round  57, Global train loss: 0.953, Global test loss: 2.156, Global test accuracy: 19.93
Round  58, Train loss: 0.838, Test loss: 1.997, Test accuracy: 39.04
Round  58, Global train loss: 0.838, Global test loss: 2.088, Global test accuracy: 24.26
Round  59, Train loss: 0.753, Test loss: 2.053, Test accuracy: 38.77
Round  59, Global train loss: 0.753, Global test loss: 2.092, Global test accuracy: 23.63
Round  60, Train loss: 0.883, Test loss: 2.090, Test accuracy: 38.28
Round  60, Global train loss: 0.883, Global test loss: 2.236, Global test accuracy: 13.97
Round  61, Train loss: 0.503, Test loss: 2.094, Test accuracy: 38.26
Round  61, Global train loss: 0.503, Global test loss: 2.148, Global test accuracy: 19.00
Round  62, Train loss: 0.814, Test loss: 2.111, Test accuracy: 38.09
Round  62, Global train loss: 0.814, Global test loss: 2.240, Global test accuracy: 15.12
Round  63, Train loss: 0.579, Test loss: 2.125, Test accuracy: 37.99
Round  63, Global train loss: 0.579, Global test loss: 2.017, Global test accuracy: 27.42
Round  64, Train loss: 0.743, Test loss: 2.173, Test accuracy: 38.13
Round  64, Global train loss: 0.743, Global test loss: 2.096, Global test accuracy: 21.04
Round  65, Train loss: 0.598, Test loss: 2.162, Test accuracy: 38.45
Round  65, Global train loss: 0.598, Global test loss: 2.033, Global test accuracy: 24.56
Round  66, Train loss: 0.621, Test loss: 2.228, Test accuracy: 38.66
Round  66, Global train loss: 0.621, Global test loss: 2.094, Global test accuracy: 24.11
Round  67, Train loss: 0.703, Test loss: 2.221, Test accuracy: 39.18
Round  67, Global train loss: 0.703, Global test loss: 2.204, Global test accuracy: 17.26
Round  68, Train loss: 0.836, Test loss: 2.263, Test accuracy: 38.65
Round  68, Global train loss: 0.836, Global test loss: 2.232, Global test accuracy: 15.27
Round  69, Train loss: 0.632, Test loss: 2.313, Test accuracy: 38.97
Round  69, Global train loss: 0.632, Global test loss: 2.105, Global test accuracy: 24.82
Round  70, Train loss: 0.636, Test loss: 2.355, Test accuracy: 38.86
Round  70, Global train loss: 0.636, Global test loss: 2.246, Global test accuracy: 19.32
Round  71, Train loss: 0.482, Test loss: 2.422, Test accuracy: 38.64
Round  71, Global train loss: 0.482, Global test loss: 2.131, Global test accuracy: 21.18
Round  72, Train loss: 0.400, Test loss: 2.433, Test accuracy: 38.37
Round  72, Global train loss: 0.400, Global test loss: 2.086, Global test accuracy: 20.72
Round  73, Train loss: 0.516, Test loss: 2.530, Test accuracy: 38.07
Round  73, Global train loss: 0.516, Global test loss: 2.182, Global test accuracy: 22.23
Round  74, Train loss: 0.548, Test loss: 2.592, Test accuracy: 38.04
Round  74, Global train loss: 0.548, Global test loss: 2.133, Global test accuracy: 20.38
Round  75, Train loss: 0.606, Test loss: 2.624, Test accuracy: 38.25
Round  75, Global train loss: 0.606, Global test loss: 2.149, Global test accuracy: 25.10
Round  76, Train loss: 0.313, Test loss: 2.664, Test accuracy: 37.74
Round  76, Global train loss: 0.313, Global test loss: 1.989, Global test accuracy: 29.57
Round  77, Train loss: 0.494, Test loss: 2.714, Test accuracy: 37.96
Round  77, Global train loss: 0.494, Global test loss: 2.089, Global test accuracy: 21.29
Round  78, Train loss: 0.414, Test loss: 2.652, Test accuracy: 38.61
Round  78, Global train loss: 0.414, Global test loss: 2.006, Global test accuracy: 24.40
Round  79, Train loss: 0.581, Test loss: 2.706, Test accuracy: 38.67
Round  79, Global train loss: 0.581, Global test loss: 2.194, Global test accuracy: 18.32
Round  80, Train loss: 0.305, Test loss: 2.779, Test accuracy: 38.10
Round  80, Global train loss: 0.305, Global test loss: 2.145, Global test accuracy: 18.87
Round  81, Train loss: 0.360, Test loss: 2.777, Test accuracy: 38.39
Round  81, Global train loss: 0.360, Global test loss: 2.055, Global test accuracy: 29.04
Round  82, Train loss: 0.333, Test loss: 2.810, Test accuracy: 38.27
Round  82, Global train loss: 0.333, Global test loss: 2.021, Global test accuracy: 26.34
Round  83, Train loss: 0.381, Test loss: 2.864, Test accuracy: 38.82
Round  83, Global train loss: 0.381, Global test loss: 2.129, Global test accuracy: 25.47
Round  84, Train loss: 0.466, Test loss: 2.949, Test accuracy: 38.20
Round  84, Global train loss: 0.466, Global test loss: 2.160, Global test accuracy: 18.04
Round  85, Train loss: 0.313, Test loss: 3.031, Test accuracy: 37.64
Round  85, Global train loss: 0.313, Global test loss: 2.081, Global test accuracy: 23.31
Round  86, Train loss: 0.339, Test loss: 3.095, Test accuracy: 37.42
Round  86, Global train loss: 0.339, Global test loss: 2.184, Global test accuracy: 22.58
Round  87, Train loss: 0.381, Test loss: 3.073, Test accuracy: 37.86
Round  87, Global train loss: 0.381, Global test loss: 2.173, Global test accuracy: 14.59
Round  88, Train loss: 0.413, Test loss: 2.978, Test accuracy: 38.22
Round  88, Global train loss: 0.413, Global test loss: 2.096, Global test accuracy: 23.26
Round  89, Train loss: 0.300, Test loss: 3.053, Test accuracy: 38.15
Round  89, Global train loss: 0.300, Global test loss: 2.087, Global test accuracy: 25.28
Round  90, Train loss: 0.475, Test loss: 3.116, Test accuracy: 38.40
Round  90, Global train loss: 0.475, Global test loss: 2.250, Global test accuracy: 15.60
Round  91, Train loss: 0.484, Test loss: 3.159, Test accuracy: 38.32
Round  91, Global train loss: 0.484, Global test loss: 2.229, Global test accuracy: 16.44
Round  92, Train loss: 0.499, Test loss: 3.174, Test accuracy: 37.66
Round  92, Global train loss: 0.499, Global test loss: 2.303, Global test accuracy: 11.67
Round  93, Train loss: 0.310, Test loss: 3.163, Test accuracy: 38.45
Round  93, Global train loss: 0.310, Global test loss: 2.107, Global test accuracy: 28.56
Round  94, Train loss: 0.280, Test loss: 3.177, Test accuracy: 38.62
Round  94, Global train loss: 0.280, Global test loss: 2.020, Global test accuracy: 28.45
Round  95, Train loss: 0.363, Test loss: 3.222, Test accuracy: 38.82
Round  95, Global train loss: 0.363, Global test loss: 2.202, Global test accuracy: 19.59
Round  96, Train loss: 0.260, Test loss: 3.256, Test accuracy: 39.16
Round  96, Global train loss: 0.260, Global test loss: 2.170, Global test accuracy: 20.73
Round  97, Train loss: 0.376, Test loss: 3.263, Test accuracy: 38.74
Round  97, Global train loss: 0.376, Global test loss: 2.262, Global test accuracy: 13.46
Round  98, Train loss: 0.197, Test loss: 3.331, Test accuracy: 38.59
Round  98, Global train loss: 0.197, Global test loss: 2.137, Global test accuracy: 22.44
Round  99, Train loss: 0.232, Test loss: 3.432, Test accuracy: 38.71
Round  99, Global train loss: 0.232, Global test loss: 2.128, Global test accuracy: 24.89
Final Round, Train loss: 0.261, Test loss: 3.512, Test accuracy: 39.07
Final Round, Global train loss: 0.261, Global test loss: 2.128, Global test accuracy: 24.89
Average accuracy final 10 rounds: 38.547000000000004 

Average global accuracy final 10 rounds: 20.183 

1426.3169684410095
[1.4826459884643555, 2.965291976928711, 4.1983983516693115, 5.431504726409912, 6.66683554649353, 7.902166366577148, 9.136251449584961, 10.370336532592773, 11.599188089370728, 12.828039646148682, 14.050704717636108, 15.273369789123535, 16.511654376983643, 17.74993896484375, 18.976843118667603, 20.203747272491455, 21.42164635658264, 22.639545440673828, 23.871052503585815, 25.102559566497803, 26.333713054656982, 27.564866542816162, 28.783923625946045, 30.002980709075928, 31.218090772628784, 32.43320083618164, 33.64600872993469, 34.858816623687744, 36.08914756774902, 37.3194785118103, 38.55227184295654, 39.78506517410278, 41.018465995788574, 42.251866817474365, 43.470704317092896, 44.689541816711426, 45.90764594078064, 47.12575006484985, 48.35378074645996, 49.58181142807007, 50.81201100349426, 52.04221057891846, 53.26616382598877, 54.49011707305908, 55.71471428871155, 56.939311504364014, 58.15588665008545, 59.372461795806885, 60.59198260307312, 61.811503410339355, 63.03555083274841, 64.25959825515747, 65.49056386947632, 66.72152948379517, 67.93566656112671, 69.14980363845825, 70.36976861953735, 71.58973360061646, 72.81299257278442, 74.03625154495239, 75.27201509475708, 76.50777864456177, 77.73402094841003, 78.9602632522583, 80.18525528907776, 81.41024732589722, 82.64223051071167, 83.87421369552612, 85.10870027542114, 86.34318685531616, 87.56878185272217, 88.79437685012817, 90.01827883720398, 91.24218082427979, 92.48203372955322, 93.72188663482666, 94.96034955978394, 96.19881248474121, 97.4312515258789, 98.6636905670166, 99.89270091056824, 101.12171125411987, 102.35052394866943, 103.579336643219, 104.80187392234802, 106.02441120147705, 107.25353932380676, 108.48266744613647, 109.7085075378418, 110.93434762954712, 112.16139769554138, 113.38844776153564, 114.61186003684998, 115.8352723121643, 117.06194734573364, 118.28862237930298, 119.52005743980408, 120.75149250030518, 121.97749376296997, 123.20349502563477, 124.41748261451721, 125.63147020339966, 126.85239434242249, 128.0733184814453, 129.30038261413574, 130.52744674682617, 131.74981927871704, 132.9721918106079, 134.1951367855072, 135.4180817604065, 136.63551139831543, 137.85294103622437, 139.07175159454346, 140.29056215286255, 141.5174434185028, 142.74432468414307, 143.97426629066467, 145.20420789718628, 146.4441623687744, 147.68411684036255, 148.91811442375183, 150.1521120071411, 151.3826048374176, 152.6130976676941, 153.82992506027222, 155.04675245285034, 156.25800251960754, 157.46925258636475, 158.68203020095825, 159.89480781555176, 161.10392141342163, 162.3130350112915, 163.52420902252197, 164.73538303375244, 165.9509768486023, 167.16657066345215, 168.3884632587433, 169.61035585403442, 170.83680200576782, 172.06324815750122, 173.29307341575623, 174.52289867401123, 175.7532925605774, 176.98368644714355, 178.21590089797974, 179.44811534881592, 180.67762064933777, 181.90712594985962, 183.13606667518616, 184.3650074005127, 185.59011316299438, 186.81521892547607, 188.04783296585083, 189.2804470062256, 190.51457047462463, 191.74869394302368, 192.97688269615173, 194.20507144927979, 195.4214346408844, 196.637797832489, 197.84878277778625, 199.0597677230835, 200.26779413223267, 201.47582054138184, 202.69182705879211, 203.9078335762024, 205.1192638874054, 206.3306941986084, 207.5371744632721, 208.7436547279358, 209.94815516471863, 211.15265560150146, 212.3547327518463, 213.55680990219116, 214.76924848556519, 215.9816870689392, 217.1862530708313, 218.3908190727234, 219.59941601753235, 220.8080129623413, 222.00813913345337, 223.20826530456543, 224.41877245903015, 225.62927961349487, 226.8345000743866, 228.03972053527832, 229.2401213645935, 230.4405221939087, 231.64169073104858, 232.84285926818848, 234.0638575553894, 235.28485584259033, 236.50628209114075, 237.72770833969116, 238.9187433719635, 240.10977840423584, 241.30221939086914, 242.49466037750244, 243.69754147529602, 244.9004225730896, 247.27190685272217, 249.64339113235474]
[20.41, 20.41, 17.54, 17.54, 25.34, 25.34, 27.03, 27.03, 28.8, 28.8, 32.04, 32.04, 33.66, 33.66, 34.48, 34.48, 35.99, 35.99, 37.51, 37.51, 37.55, 37.55, 36.89, 36.89, 37.0, 37.0, 37.66, 37.66, 37.63, 37.63, 37.29, 37.29, 38.35, 38.35, 38.05, 38.05, 38.41, 38.41, 38.82, 38.82, 38.99, 38.99, 39.61, 39.61, 40.11, 40.11, 40.17, 40.17, 39.65, 39.65, 39.91, 39.91, 40.38, 40.38, 41.08, 41.08, 39.88, 39.88, 41.07, 41.07, 40.03, 40.03, 39.87, 39.87, 40.08, 40.08, 40.66, 40.66, 39.82, 39.82, 40.07, 40.07, 40.43, 40.43, 40.02, 40.02, 40.14, 40.14, 40.31, 40.31, 40.08, 40.08, 39.52, 39.52, 39.51, 39.51, 39.27, 39.27, 39.2, 39.2, 39.33, 39.33, 39.54, 39.54, 38.94, 38.94, 39.3, 39.3, 39.04, 39.04, 38.71, 38.71, 38.92, 38.92, 38.81, 38.81, 38.92, 38.92, 39.05, 39.05, 38.62, 38.62, 38.34, 38.34, 38.31, 38.31, 39.04, 39.04, 38.77, 38.77, 38.28, 38.28, 38.26, 38.26, 38.09, 38.09, 37.99, 37.99, 38.13, 38.13, 38.45, 38.45, 38.66, 38.66, 39.18, 39.18, 38.65, 38.65, 38.97, 38.97, 38.86, 38.86, 38.64, 38.64, 38.37, 38.37, 38.07, 38.07, 38.04, 38.04, 38.25, 38.25, 37.74, 37.74, 37.96, 37.96, 38.61, 38.61, 38.67, 38.67, 38.1, 38.1, 38.39, 38.39, 38.27, 38.27, 38.82, 38.82, 38.2, 38.2, 37.64, 37.64, 37.42, 37.42, 37.86, 37.86, 38.22, 38.22, 38.15, 38.15, 38.4, 38.4, 38.32, 38.32, 37.66, 37.66, 38.45, 38.45, 38.62, 38.62, 38.82, 38.82, 39.16, 39.16, 38.74, 38.74, 38.59, 38.59, 38.71, 38.71, 39.07, 39.07]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.692, Test loss: 2.077, Test accuracy: 19.84
Round   0, Global train loss: 1.692, Global test loss: 2.269, Global test accuracy: 15.52
Round   1, Train loss: 1.562, Test loss: 1.848, Test accuracy: 32.77
Round   1, Global train loss: 1.562, Global test loss: 2.130, Global test accuracy: 26.49
Round   2, Train loss: 1.375, Test loss: 1.697, Test accuracy: 37.65
Round   2, Global train loss: 1.375, Global test loss: 2.124, Global test accuracy: 29.96
Round   3, Train loss: 1.201, Test loss: 1.450, Test accuracy: 42.60
Round   3, Global train loss: 1.201, Global test loss: 1.971, Global test accuracy: 31.34
Round   4, Train loss: 1.343, Test loss: 1.344, Test accuracy: 47.22
Round   4, Global train loss: 1.343, Global test loss: 1.754, Global test accuracy: 36.91
Round   5, Train loss: 1.316, Test loss: 1.275, Test accuracy: 49.23
Round   5, Global train loss: 1.316, Global test loss: 1.720, Global test accuracy: 35.56
Round   6, Train loss: 1.197, Test loss: 1.237, Test accuracy: 50.58
Round   6, Global train loss: 1.197, Global test loss: 1.827, Global test accuracy: 32.81
Round   7, Train loss: 1.153, Test loss: 1.179, Test accuracy: 53.22
Round   7, Global train loss: 1.153, Global test loss: 1.707, Global test accuracy: 37.16
Round   8, Train loss: 1.040, Test loss: 1.164, Test accuracy: 54.14
Round   8, Global train loss: 1.040, Global test loss: 1.665, Global test accuracy: 38.92
Round   9, Train loss: 1.222, Test loss: 1.144, Test accuracy: 55.53
Round   9, Global train loss: 1.222, Global test loss: 1.733, Global test accuracy: 37.85
Round  10, Train loss: 1.204, Test loss: 1.137, Test accuracy: 56.11
Round  10, Global train loss: 1.204, Global test loss: 1.763, Global test accuracy: 34.58
Round  11, Train loss: 1.038, Test loss: 1.122, Test accuracy: 56.42
Round  11, Global train loss: 1.038, Global test loss: 1.593, Global test accuracy: 44.24
Round  12, Train loss: 1.143, Test loss: 1.113, Test accuracy: 56.39
Round  12, Global train loss: 1.143, Global test loss: 1.515, Global test accuracy: 46.16
Round  13, Train loss: 1.077, Test loss: 1.096, Test accuracy: 57.71
Round  13, Global train loss: 1.077, Global test loss: 1.522, Global test accuracy: 46.43
Round  14, Train loss: 1.004, Test loss: 1.071, Test accuracy: 59.09
Round  14, Global train loss: 1.004, Global test loss: 1.757, Global test accuracy: 40.06
Round  15, Train loss: 1.096, Test loss: 1.054, Test accuracy: 59.66
Round  15, Global train loss: 1.096, Global test loss: 1.534, Global test accuracy: 44.19
Round  16, Train loss: 0.967, Test loss: 1.052, Test accuracy: 59.76
Round  16, Global train loss: 0.967, Global test loss: 1.551, Global test accuracy: 42.57
Round  17, Train loss: 1.142, Test loss: 1.041, Test accuracy: 60.73
Round  17, Global train loss: 1.142, Global test loss: 1.432, Global test accuracy: 49.88
Round  18, Train loss: 0.977, Test loss: 1.046, Test accuracy: 60.52
Round  18, Global train loss: 0.977, Global test loss: 1.574, Global test accuracy: 43.38
Round  19, Train loss: 1.008, Test loss: 1.042, Test accuracy: 60.60
Round  19, Global train loss: 1.008, Global test loss: 1.683, Global test accuracy: 40.39
Round  20, Train loss: 1.007, Test loss: 1.049, Test accuracy: 60.27
Round  20, Global train loss: 1.007, Global test loss: 1.524, Global test accuracy: 45.40
Round  21, Train loss: 0.962, Test loss: 1.026, Test accuracy: 61.22
Round  21, Global train loss: 0.962, Global test loss: 1.455, Global test accuracy: 48.78
Round  22, Train loss: 0.836, Test loss: 1.007, Test accuracy: 62.14
Round  22, Global train loss: 0.836, Global test loss: 1.637, Global test accuracy: 45.41
Round  23, Train loss: 0.973, Test loss: 1.018, Test accuracy: 61.83
Round  23, Global train loss: 0.973, Global test loss: 1.363, Global test accuracy: 51.84
Round  24, Train loss: 0.966, Test loss: 1.011, Test accuracy: 62.29
Round  24, Global train loss: 0.966, Global test loss: 1.412, Global test accuracy: 48.77
Round  25, Train loss: 0.903, Test loss: 1.005, Test accuracy: 62.42
Round  25, Global train loss: 0.903, Global test loss: 1.361, Global test accuracy: 50.97
Round  26, Train loss: 0.820, Test loss: 0.992, Test accuracy: 63.36
Round  26, Global train loss: 0.820, Global test loss: 1.409, Global test accuracy: 51.08
Round  27, Train loss: 0.801, Test loss: 0.995, Test accuracy: 63.42
Round  27, Global train loss: 0.801, Global test loss: 1.688, Global test accuracy: 48.02
Round  28, Train loss: 0.798, Test loss: 0.997, Test accuracy: 63.26
Round  28, Global train loss: 0.798, Global test loss: 1.409, Global test accuracy: 51.96
Round  29, Train loss: 0.790, Test loss: 0.988, Test accuracy: 63.74
Round  29, Global train loss: 0.790, Global test loss: 1.402, Global test accuracy: 51.64
Round  30, Train loss: 0.813, Test loss: 0.994, Test accuracy: 63.87
Round  30, Global train loss: 0.813, Global test loss: 1.243, Global test accuracy: 56.46
Round  31, Train loss: 0.753, Test loss: 0.993, Test accuracy: 64.30
Round  31, Global train loss: 0.753, Global test loss: 1.460, Global test accuracy: 50.67
Round  32, Train loss: 0.860, Test loss: 0.982, Test accuracy: 64.15
Round  32, Global train loss: 0.860, Global test loss: 1.367, Global test accuracy: 52.77
Round  33, Train loss: 0.739, Test loss: 0.982, Test accuracy: 64.57
Round  33, Global train loss: 0.739, Global test loss: 1.273, Global test accuracy: 54.38
Round  34, Train loss: 0.710, Test loss: 0.974, Test accuracy: 64.60
Round  34, Global train loss: 0.710, Global test loss: 1.323, Global test accuracy: 52.77
Round  35, Train loss: 0.792, Test loss: 0.987, Test accuracy: 64.88
Round  35, Global train loss: 0.792, Global test loss: 1.302, Global test accuracy: 53.98
Round  36, Train loss: 0.832, Test loss: 0.989, Test accuracy: 65.06
Round  36, Global train loss: 0.832, Global test loss: 1.293, Global test accuracy: 54.44
Round  37, Train loss: 0.675, Test loss: 0.969, Test accuracy: 65.47
Round  37, Global train loss: 0.675, Global test loss: 1.422, Global test accuracy: 52.27
Round  38, Train loss: 0.759, Test loss: 0.954, Test accuracy: 66.16
Round  38, Global train loss: 0.759, Global test loss: 1.289, Global test accuracy: 55.21
Round  39, Train loss: 0.718, Test loss: 0.953, Test accuracy: 66.40
Round  39, Global train loss: 0.718, Global test loss: 1.205, Global test accuracy: 58.69
Round  40, Train loss: 0.725, Test loss: 0.952, Test accuracy: 66.50
Round  40, Global train loss: 0.725, Global test loss: 1.218, Global test accuracy: 57.73
Round  41, Train loss: 0.789, Test loss: 0.970, Test accuracy: 65.73
Round  41, Global train loss: 0.789, Global test loss: 1.239, Global test accuracy: 56.41
Round  42, Train loss: 0.751, Test loss: 0.960, Test accuracy: 66.14
Round  42, Global train loss: 0.751, Global test loss: 1.269, Global test accuracy: 56.35
Round  43, Train loss: 0.628, Test loss: 0.971, Test accuracy: 66.18
Round  43, Global train loss: 0.628, Global test loss: 1.427, Global test accuracy: 52.70
Round  44, Train loss: 0.722, Test loss: 0.979, Test accuracy: 66.17
Round  44, Global train loss: 0.722, Global test loss: 1.353, Global test accuracy: 54.46
Round  45, Train loss: 0.791, Test loss: 0.977, Test accuracy: 66.29
Round  45, Global train loss: 0.791, Global test loss: 1.314, Global test accuracy: 54.44
Round  46, Train loss: 0.724, Test loss: 0.986, Test accuracy: 66.55
Round  46, Global train loss: 0.724, Global test loss: 1.277, Global test accuracy: 56.09
Round  47, Train loss: 0.749, Test loss: 1.009, Test accuracy: 66.09
Round  47, Global train loss: 0.749, Global test loss: 1.236, Global test accuracy: 57.46
Round  48, Train loss: 0.626, Test loss: 0.981, Test accuracy: 66.83
Round  48, Global train loss: 0.626, Global test loss: 1.343, Global test accuracy: 55.52
Round  49, Train loss: 0.661, Test loss: 0.997, Test accuracy: 66.55
Round  49, Global train loss: 0.661, Global test loss: 1.309, Global test accuracy: 56.50
Round  50, Train loss: 0.677, Test loss: 0.993, Test accuracy: 66.85
Round  50, Global train loss: 0.677, Global test loss: 1.382, Global test accuracy: 54.27
Round  51, Train loss: 0.763, Test loss: 0.994, Test accuracy: 66.98
Round  51, Global train loss: 0.763, Global test loss: 1.311, Global test accuracy: 55.81
Round  52, Train loss: 0.617, Test loss: 1.000, Test accuracy: 67.20
Round  52, Global train loss: 0.617, Global test loss: 1.247, Global test accuracy: 56.90
Round  53, Train loss: 0.696, Test loss: 1.015, Test accuracy: 66.81
Round  53, Global train loss: 0.696, Global test loss: 1.297, Global test accuracy: 55.35
Round  54, Train loss: 0.686, Test loss: 1.008, Test accuracy: 66.39
Round  54, Global train loss: 0.686, Global test loss: 1.347, Global test accuracy: 54.20
Round  55, Train loss: 0.623, Test loss: 1.011, Test accuracy: 66.24
Round  55, Global train loss: 0.623, Global test loss: 1.361, Global test accuracy: 54.76
Round  56, Train loss: 0.640, Test loss: 1.007, Test accuracy: 66.68
Round  56, Global train loss: 0.640, Global test loss: 1.432, Global test accuracy: 54.31
Round  57, Train loss: 0.562, Test loss: 0.999, Test accuracy: 67.10
Round  57, Global train loss: 0.562, Global test loss: 1.271, Global test accuracy: 57.60
Round  58, Train loss: 0.598, Test loss: 1.019, Test accuracy: 66.63
Round  58, Global train loss: 0.598, Global test loss: 1.207, Global test accuracy: 59.19
Round  59, Train loss: 0.596, Test loss: 1.036, Test accuracy: 66.20
Round  59, Global train loss: 0.596, Global test loss: 1.270, Global test accuracy: 57.82
Round  60, Train loss: 0.547, Test loss: 1.021, Test accuracy: 67.07
Round  60, Global train loss: 0.547, Global test loss: 1.387, Global test accuracy: 55.89
Round  61, Train loss: 0.526, Test loss: 1.028, Test accuracy: 67.07
Round  61, Global train loss: 0.526, Global test loss: 1.263, Global test accuracy: 58.96
Round  62, Train loss: 0.591, Test loss: 1.044, Test accuracy: 67.09
Round  62, Global train loss: 0.591, Global test loss: 1.321, Global test accuracy: 56.54
Round  63, Train loss: 0.574, Test loss: 1.052, Test accuracy: 67.33
Round  63, Global train loss: 0.574, Global test loss: 1.306, Global test accuracy: 57.71
Round  64, Train loss: 0.440, Test loss: 1.068, Test accuracy: 67.10
Round  64, Global train loss: 0.440, Global test loss: 1.345, Global test accuracy: 58.84
Round  65, Train loss: 0.532, Test loss: 1.075, Test accuracy: 66.98
Round  65, Global train loss: 0.532, Global test loss: 1.245, Global test accuracy: 59.99
Round  66, Train loss: 0.534, Test loss: 1.050, Test accuracy: 67.22
Round  66, Global train loss: 0.534, Global test loss: 1.283, Global test accuracy: 59.33
Round  67, Train loss: 0.534, Test loss: 1.055, Test accuracy: 67.45
Round  67, Global train loss: 0.534, Global test loss: 1.389, Global test accuracy: 55.98
Round  68, Train loss: 0.589, Test loss: 1.038, Test accuracy: 67.72
Round  68, Global train loss: 0.589, Global test loss: 1.393, Global test accuracy: 54.98
Round  69, Train loss: 0.593, Test loss: 1.058, Test accuracy: 67.16
Round  69, Global train loss: 0.593, Global test loss: 1.276, Global test accuracy: 58.15
Round  70, Train loss: 0.567, Test loss: 1.054, Test accuracy: 67.28
Round  70, Global train loss: 0.567, Global test loss: 1.391, Global test accuracy: 56.82
Round  71, Train loss: 0.541, Test loss: 1.075, Test accuracy: 67.07
Round  71, Global train loss: 0.541, Global test loss: 1.385, Global test accuracy: 56.95
Round  72, Train loss: 0.440, Test loss: 1.058, Test accuracy: 67.49
Round  72, Global train loss: 0.440, Global test loss: 1.222, Global test accuracy: 60.58
Round  73, Train loss: 0.507, Test loss: 1.049, Test accuracy: 67.86
Round  73, Global train loss: 0.507, Global test loss: 1.277, Global test accuracy: 59.35
Round  74, Train loss: 0.547, Test loss: 1.060, Test accuracy: 67.64
Round  74, Global train loss: 0.547, Global test loss: 1.273, Global test accuracy: 58.41
Round  75, Train loss: 0.518, Test loss: 1.055, Test accuracy: 68.18
Round  75, Global train loss: 0.518, Global test loss: 1.471, Global test accuracy: 55.40
Round  76, Train loss: 0.432, Test loss: 1.022, Test accuracy: 69.03
Round  76, Global train loss: 0.432, Global test loss: 1.246, Global test accuracy: 60.17
Round  77, Train loss: 0.450, Test loss: 1.057, Test accuracy: 68.40
Round  77, Global train loss: 0.450, Global test loss: 1.334, Global test accuracy: 57.91
Round  78, Train loss: 0.449, Test loss: 1.072, Test accuracy: 68.12
Round  78, Global train loss: 0.449, Global test loss: 1.171, Global test accuracy: 61.46
Round  79, Train loss: 0.564, Test loss: 1.091, Test accuracy: 67.99
Round  79, Global train loss: 0.564, Global test loss: 1.252, Global test accuracy: 59.59
Round  80, Train loss: 0.494, Test loss: 1.106, Test accuracy: 67.67
Round  80, Global train loss: 0.494, Global test loss: 1.449, Global test accuracy: 55.16
Round  81, Train loss: 0.403, Test loss: 1.100, Test accuracy: 68.12
Round  81, Global train loss: 0.403, Global test loss: 1.426, Global test accuracy: 57.25
Round  82, Train loss: 0.471, Test loss: 1.098, Test accuracy: 67.94
Round  82, Global train loss: 0.471, Global test loss: 1.231, Global test accuracy: 61.17
Round  83, Train loss: 0.527, Test loss: 1.086, Test accuracy: 68.13
Round  83, Global train loss: 0.527, Global test loss: 1.406, Global test accuracy: 56.59
Round  84, Train loss: 0.500, Test loss: 1.083, Test accuracy: 68.38
Round  84, Global train loss: 0.500, Global test loss: 1.299, Global test accuracy: 59.19
Round  85, Train loss: 0.417, Test loss: 1.075, Test accuracy: 68.69
Round  85, Global train loss: 0.417, Global test loss: 1.201, Global test accuracy: 62.20
Round  86, Train loss: 0.436, Test loss: 1.076, Test accuracy: 68.34
Round  86, Global train loss: 0.436, Global test loss: 1.570, Global test accuracy: 55.70
Round  87, Train loss: 0.497, Test loss: 1.070, Test accuracy: 68.72
Round  87, Global train loss: 0.497, Global test loss: 1.308, Global test accuracy: 59.08
Round  88, Train loss: 0.453, Test loss: 1.086, Test accuracy: 68.56
Round  88, Global train loss: 0.453, Global test loss: 1.230, Global test accuracy: 60.71
Round  89, Train loss: 0.391, Test loss: 1.096, Test accuracy: 68.52
Round  89, Global train loss: 0.391, Global test loss: 1.413, Global test accuracy: 58.28
Round  90, Train loss: 0.529, Test loss: 1.104, Test accuracy: 68.56
Round  90, Global train loss: 0.529, Global test loss: 1.320, Global test accuracy: 59.10
Round  91, Train loss: 0.499, Test loss: 1.135, Test accuracy: 67.84
Round  91, Global train loss: 0.499, Global test loss: 1.528, Global test accuracy: 55.22
Round  92, Train loss: 0.441, Test loss: 1.143, Test accuracy: 67.96
Round  92, Global train loss: 0.441, Global test loss: 1.469, Global test accuracy: 56.96
Round  93, Train loss: 0.388, Test loss: 1.124, Test accuracy: 68.14
Round  93, Global train loss: 0.388, Global test loss: 1.361, Global test accuracy: 60.65
Round  94, Train loss: 0.387, Test loss: 1.118, Test accuracy: 68.32
Round  94, Global train loss: 0.387, Global test loss: 1.407, Global test accuracy: 58.38
Round  95, Train loss: 0.414, Test loss: 1.130, Test accuracy: 67.89
Round  95, Global train loss: 0.414, Global test loss: 1.390, Global test accuracy: 58.44
Round  96, Train loss: 0.429, Test loss: 1.112, Test accuracy: 68.40
Round  96, Global train loss: 0.429, Global test loss: 1.378, Global test accuracy: 59.25
Round  97, Train loss: 0.390, Test loss: 1.129, Test accuracy: 68.20
Round  97, Global train loss: 0.390, Global test loss: 1.603, Global test accuracy: 55.85
Round  98, Train loss: 0.424, Test loss: 1.138, Test accuracy: 67.90
Round  98, Global train loss: 0.424, Global test loss: 1.357, Global test accuracy: 58.54
Round  99, Train loss: 0.457, Test loss: 1.166, Test accuracy: 67.24
Round  99, Global train loss: 0.457, Global test loss: 1.485, Global test accuracy: 56.72
Final Round, Train loss: 0.325, Test loss: 1.281, Test accuracy: 67.87
Final Round, Global train loss: 0.325, Global test loss: 1.485, Global test accuracy: 56.72
Average accuracy final 10 rounds: 68.045 

Average global accuracy final 10 rounds: 57.910999999999994 

1429.0253338813782
[1.4334774017333984, 2.866954803466797, 4.086356163024902, 5.305757522583008, 6.527506589889526, 7.749255657196045, 8.967424154281616, 10.185592651367188, 11.426680326461792, 12.667768001556396, 13.90968942642212, 15.151610851287842, 16.398295879364014, 17.644980907440186, 18.889580965042114, 20.134181022644043, 21.377816438674927, 22.62145185470581, 23.86478304862976, 25.10811424255371, 26.345252513885498, 27.582390785217285, 28.82393217086792, 30.065473556518555, 31.303229331970215, 32.540985107421875, 33.77868413925171, 35.01638317108154, 36.24779915809631, 37.479215145111084, 38.70820236206055, 39.93718957901001, 41.1764874458313, 42.41578531265259, 43.66081428527832, 44.90584325790405, 46.14155840873718, 47.37727355957031, 48.59442853927612, 49.811583518981934, 51.016111612319946, 52.22063970565796, 53.43040943145752, 54.64017915725708, 55.850263595581055, 57.06034803390503, 58.29122495651245, 59.52210187911987, 60.73273587226868, 61.94336986541748, 63.14994788169861, 64.35652589797974, 65.57497906684875, 66.79343223571777, 68.0178713798523, 69.24231052398682, 70.47643089294434, 71.71055126190186, 72.948983669281, 74.18741607666016, 75.39321255683899, 76.59900903701782, 77.8380434513092, 79.07707786560059, 80.29175996780396, 81.50644207000732, 82.70632934570312, 83.90621662139893, 85.10366797447205, 86.30111932754517, 87.51558303833008, 88.73004674911499, 89.93169403076172, 91.13334131240845, 92.33689522743225, 93.54044914245605, 94.7333755493164, 95.92630195617676, 97.12364220619202, 98.32098245620728, 99.51349830627441, 100.70601415634155, 101.8984100818634, 103.09080600738525, 104.30286002159119, 105.51491403579712, 106.74280118942261, 107.9706883430481, 109.21054816246033, 110.45040798187256, 111.69028449058533, 112.9301609992981, 114.1625108718872, 115.39486074447632, 116.62299275398254, 117.85112476348877, 119.07673358917236, 120.30234241485596, 121.53725337982178, 122.7721643447876, 124.00655245780945, 125.2409405708313, 126.47742223739624, 127.71390390396118, 128.95335173606873, 130.19279956817627, 131.4349627494812, 132.67712593078613, 133.91705799102783, 135.15699005126953, 136.39809155464172, 137.63919305801392, 138.87108659744263, 140.10298013687134, 141.32921838760376, 142.55545663833618, 143.78551197052002, 145.01556730270386, 146.24225974082947, 147.46895217895508, 148.69205141067505, 149.91515064239502, 151.141099691391, 152.36704874038696, 153.5911419391632, 154.81523513793945, 156.0542449951172, 157.29325485229492, 158.5220136642456, 159.7507724761963, 160.9737184047699, 162.1966643333435, 163.41727828979492, 164.63789224624634, 165.86754608154297, 167.0971999168396, 168.33841514587402, 169.57963037490845, 170.8140950202942, 172.04855966567993, 173.2891767024994, 174.52979373931885, 175.7725124359131, 177.01523113250732, 178.24912810325623, 179.48302507400513, 180.7168824672699, 181.95073986053467, 183.1899311542511, 184.42912244796753, 185.66278719902039, 186.89645195007324, 188.1212821006775, 189.34611225128174, 190.57170510292053, 191.79729795455933, 193.02033519744873, 194.24337244033813, 195.4647662639618, 196.68616008758545, 197.89338660240173, 199.10061311721802, 200.29458093643188, 201.48854875564575, 202.681077003479, 203.87360525131226, 205.1169400215149, 206.36027479171753, 207.58107328414917, 208.8018717765808, 210.0329487323761, 211.2640256881714, 212.48915076255798, 213.71427583694458, 214.9531888961792, 216.19210195541382, 217.43302011489868, 218.67393827438354, 219.9185917377472, 221.16324520111084, 222.39265251159668, 223.62205982208252, 224.84912776947021, 226.0761957168579, 227.29919934272766, 228.5222029685974, 229.76307773590088, 231.00395250320435, 232.24294781684875, 233.48194313049316, 234.7139868736267, 235.94603061676025, 237.17534399032593, 238.4046573638916, 239.63435912132263, 240.86406087875366, 242.09103345870972, 243.31800603866577, 244.5526306629181, 245.7872552871704, 248.24567580223083, 250.70409631729126]
[19.84, 19.84, 32.77, 32.77, 37.65, 37.65, 42.6, 42.6, 47.22, 47.22, 49.23, 49.23, 50.58, 50.58, 53.22, 53.22, 54.14, 54.14, 55.53, 55.53, 56.11, 56.11, 56.42, 56.42, 56.39, 56.39, 57.71, 57.71, 59.09, 59.09, 59.66, 59.66, 59.76, 59.76, 60.73, 60.73, 60.52, 60.52, 60.6, 60.6, 60.27, 60.27, 61.22, 61.22, 62.14, 62.14, 61.83, 61.83, 62.29, 62.29, 62.42, 62.42, 63.36, 63.36, 63.42, 63.42, 63.26, 63.26, 63.74, 63.74, 63.87, 63.87, 64.3, 64.3, 64.15, 64.15, 64.57, 64.57, 64.6, 64.6, 64.88, 64.88, 65.06, 65.06, 65.47, 65.47, 66.16, 66.16, 66.4, 66.4, 66.5, 66.5, 65.73, 65.73, 66.14, 66.14, 66.18, 66.18, 66.17, 66.17, 66.29, 66.29, 66.55, 66.55, 66.09, 66.09, 66.83, 66.83, 66.55, 66.55, 66.85, 66.85, 66.98, 66.98, 67.2, 67.2, 66.81, 66.81, 66.39, 66.39, 66.24, 66.24, 66.68, 66.68, 67.1, 67.1, 66.63, 66.63, 66.2, 66.2, 67.07, 67.07, 67.07, 67.07, 67.09, 67.09, 67.33, 67.33, 67.1, 67.1, 66.98, 66.98, 67.22, 67.22, 67.45, 67.45, 67.72, 67.72, 67.16, 67.16, 67.28, 67.28, 67.07, 67.07, 67.49, 67.49, 67.86, 67.86, 67.64, 67.64, 68.18, 68.18, 69.03, 69.03, 68.4, 68.4, 68.12, 68.12, 67.99, 67.99, 67.67, 67.67, 68.12, 68.12, 67.94, 67.94, 68.13, 68.13, 68.38, 68.38, 68.69, 68.69, 68.34, 68.34, 68.72, 68.72, 68.56, 68.56, 68.52, 68.52, 68.56, 68.56, 67.84, 67.84, 67.96, 67.96, 68.14, 68.14, 68.32, 68.32, 67.89, 67.89, 68.4, 68.4, 68.2, 68.2, 67.9, 67.9, 67.24, 67.24, 67.87, 67.87]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  prox  local_only:0   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: prox , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 18, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
prox
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.741, Test loss: 2.083, Test accuracy: 22.26
Round   0, Global train loss: 1.741, Global test loss: 2.272, Global test accuracy: 19.39
Round   1, Train loss: 1.579, Test loss: 1.886, Test accuracy: 30.38
Round   1, Global train loss: 1.579, Global test loss: 2.165, Global test accuracy: 25.14
Round   2, Train loss: 1.413, Test loss: 1.726, Test accuracy: 36.18
Round   2, Global train loss: 1.413, Global test loss: 2.151, Global test accuracy: 29.69
Round   3, Train loss: 1.377, Test loss: 1.492, Test accuracy: 40.42
Round   3, Global train loss: 1.377, Global test loss: 1.926, Global test accuracy: 31.89
Round   4, Train loss: 1.240, Test loss: 1.396, Test accuracy: 43.89
Round   4, Global train loss: 1.240, Global test loss: 1.778, Global test accuracy: 37.23
Round   5, Train loss: 1.205, Test loss: 1.331, Test accuracy: 46.26
Round   5, Global train loss: 1.205, Global test loss: 1.703, Global test accuracy: 36.75
Round   6, Train loss: 1.245, Test loss: 1.270, Test accuracy: 48.71
Round   6, Global train loss: 1.245, Global test loss: 1.802, Global test accuracy: 32.13
Round   7, Train loss: 1.280, Test loss: 1.222, Test accuracy: 51.06
Round   7, Global train loss: 1.280, Global test loss: 1.724, Global test accuracy: 36.85
Round   8, Train loss: 1.160, Test loss: 1.172, Test accuracy: 54.02
Round   8, Global train loss: 1.160, Global test loss: 1.613, Global test accuracy: 41.99
Round   9, Train loss: 1.145, Test loss: 1.158, Test accuracy: 54.40
Round   9, Global train loss: 1.145, Global test loss: 1.611, Global test accuracy: 40.99
Round  10, Train loss: 1.112, Test loss: 1.148, Test accuracy: 55.40
Round  10, Global train loss: 1.112, Global test loss: 1.727, Global test accuracy: 36.37
Round  11, Train loss: 1.102, Test loss: 1.134, Test accuracy: 55.97
Round  11, Global train loss: 1.102, Global test loss: 1.590, Global test accuracy: 44.68
Round  12, Train loss: 1.145, Test loss: 1.126, Test accuracy: 56.61
Round  12, Global train loss: 1.145, Global test loss: 1.530, Global test accuracy: 43.57
Round  13, Train loss: 1.091, Test loss: 1.120, Test accuracy: 56.92
Round  13, Global train loss: 1.091, Global test loss: 1.524, Global test accuracy: 45.08
Round  14, Train loss: 1.200, Test loss: 1.102, Test accuracy: 57.83
Round  14, Global train loss: 1.200, Global test loss: 1.704, Global test accuracy: 41.14
Round  15, Train loss: 1.011, Test loss: 1.078, Test accuracy: 59.02
Round  15, Global train loss: 1.011, Global test loss: 1.580, Global test accuracy: 41.90
Round  16, Train loss: 1.033, Test loss: 1.060, Test accuracy: 59.48
Round  16, Global train loss: 1.033, Global test loss: 1.540, Global test accuracy: 44.13
Round  17, Train loss: 1.091, Test loss: 1.056, Test accuracy: 59.94
Round  17, Global train loss: 1.091, Global test loss: 1.474, Global test accuracy: 47.41
Round  18, Train loss: 1.143, Test loss: 1.059, Test accuracy: 59.56
Round  18, Global train loss: 1.143, Global test loss: 1.661, Global test accuracy: 40.93
Round  19, Train loss: 1.074, Test loss: 1.054, Test accuracy: 59.84
Round  19, Global train loss: 1.074, Global test loss: 1.601, Global test accuracy: 41.48
Round  20, Train loss: 1.004, Test loss: 1.086, Test accuracy: 59.22
Round  20, Global train loss: 1.004, Global test loss: 1.723, Global test accuracy: 43.00
Round  21, Train loss: 1.033, Test loss: 1.068, Test accuracy: 60.20
Round  21, Global train loss: 1.033, Global test loss: 1.505, Global test accuracy: 46.88
Round  22, Train loss: 0.952, Test loss: 1.059, Test accuracy: 60.25
Round  22, Global train loss: 0.952, Global test loss: 1.648, Global test accuracy: 44.69
Round  23, Train loss: 0.929, Test loss: 1.078, Test accuracy: 59.81
Round  23, Global train loss: 0.929, Global test loss: 1.431, Global test accuracy: 49.04
Round  24, Train loss: 1.001, Test loss: 1.054, Test accuracy: 60.84
Round  24, Global train loss: 1.001, Global test loss: 1.475, Global test accuracy: 48.90
Round  25, Train loss: 0.988, Test loss: 1.037, Test accuracy: 61.82
Round  25, Global train loss: 0.988, Global test loss: 1.411, Global test accuracy: 49.69
Round  26, Train loss: 1.029, Test loss: 1.031, Test accuracy: 62.40
Round  26, Global train loss: 1.029, Global test loss: 1.519, Global test accuracy: 46.58
Round  27, Train loss: 0.921, Test loss: 1.048, Test accuracy: 61.87
Round  27, Global train loss: 0.921, Global test loss: 1.572, Global test accuracy: 49.14
Round  28, Train loss: 0.861, Test loss: 1.040, Test accuracy: 62.35
Round  28, Global train loss: 0.861, Global test loss: 1.390, Global test accuracy: 52.38
Round  29, Train loss: 0.861, Test loss: 1.034, Test accuracy: 62.15
Round  29, Global train loss: 0.861, Global test loss: 1.478, Global test accuracy: 50.56
Round  30, Train loss: 0.849, Test loss: 0.991, Test accuracy: 63.05
Round  30, Global train loss: 0.849, Global test loss: 1.291, Global test accuracy: 54.47
Round  31, Train loss: 0.930, Test loss: 0.978, Test accuracy: 63.87
Round  31, Global train loss: 0.930, Global test loss: 1.439, Global test accuracy: 49.26
Round  32, Train loss: 0.900, Test loss: 0.988, Test accuracy: 63.49
Round  32, Global train loss: 0.900, Global test loss: 1.356, Global test accuracy: 52.41
Round  33, Train loss: 0.829, Test loss: 0.989, Test accuracy: 63.43
Round  33, Global train loss: 0.829, Global test loss: 1.323, Global test accuracy: 51.82
Round  34, Train loss: 0.894, Test loss: 0.997, Test accuracy: 63.51
Round  34, Global train loss: 0.894, Global test loss: 1.298, Global test accuracy: 53.34
Round  35, Train loss: 0.775, Test loss: 0.991, Test accuracy: 63.87
Round  35, Global train loss: 0.775, Global test loss: 1.326, Global test accuracy: 52.33
Round  36, Train loss: 0.929, Test loss: 0.984, Test accuracy: 63.97
Round  36, Global train loss: 0.929, Global test loss: 1.338, Global test accuracy: 52.11
Round  37, Train loss: 0.706, Test loss: 0.962, Test accuracy: 65.10
Round  37, Global train loss: 0.706, Global test loss: 1.556, Global test accuracy: 47.40
Round  38, Train loss: 0.905, Test loss: 0.998, Test accuracy: 64.34
Round  38, Global train loss: 0.905, Global test loss: 1.346, Global test accuracy: 52.31
Round  39, Train loss: 0.685, Test loss: 0.993, Test accuracy: 64.55
Round  39, Global train loss: 0.685, Global test loss: 1.245, Global test accuracy: 55.82
Round  40, Train loss: 0.687, Test loss: 0.966, Test accuracy: 65.18
Round  40, Global train loss: 0.687, Global test loss: 1.184, Global test accuracy: 57.88
Round  41, Train loss: 0.795, Test loss: 0.980, Test accuracy: 64.53
Round  41, Global train loss: 0.795, Global test loss: 1.304, Global test accuracy: 54.80
Round  42, Train loss: 0.685, Test loss: 0.960, Test accuracy: 65.82
Round  42, Global train loss: 0.685, Global test loss: 1.241, Global test accuracy: 57.90
Round  43, Train loss: 0.783, Test loss: 0.967, Test accuracy: 65.68
Round  43, Global train loss: 0.783, Global test loss: 1.340, Global test accuracy: 53.79
Round  44, Train loss: 0.850, Test loss: 0.953, Test accuracy: 65.87
Round  44, Global train loss: 0.850, Global test loss: 1.337, Global test accuracy: 54.33
Round  45, Train loss: 0.839, Test loss: 0.964, Test accuracy: 65.57
Round  45, Global train loss: 0.839, Global test loss: 1.316, Global test accuracy: 55.17
Round  46, Train loss: 0.805, Test loss: 0.955, Test accuracy: 65.87
Round  46, Global train loss: 0.805, Global test loss: 1.309, Global test accuracy: 53.93
Round  47, Train loss: 0.741, Test loss: 0.935, Test accuracy: 66.56
Round  47, Global train loss: 0.741, Global test loss: 1.212, Global test accuracy: 58.07
Round  48, Train loss: 0.777, Test loss: 0.952, Test accuracy: 65.98
Round  48, Global train loss: 0.777, Global test loss: 1.283, Global test accuracy: 54.65
Round  49, Train loss: 0.763, Test loss: 0.955, Test accuracy: 66.15
Round  49, Global train loss: 0.763, Global test loss: 1.293, Global test accuracy: 55.36
Round  50, Train loss: 0.821, Test loss: 0.948, Test accuracy: 66.56
Round  50, Global train loss: 0.821, Global test loss: 1.367, Global test accuracy: 52.33
Round  51, Train loss: 0.758, Test loss: 0.978, Test accuracy: 65.67
Round  51, Global train loss: 0.758, Global test loss: 1.342, Global test accuracy: 53.80
Round  52, Train loss: 0.792, Test loss: 0.951, Test accuracy: 66.40
Round  52, Global train loss: 0.792, Global test loss: 1.264, Global test accuracy: 56.07
Round  53, Train loss: 0.641, Test loss: 0.958, Test accuracy: 66.37
Round  53, Global train loss: 0.641, Global test loss: 1.251, Global test accuracy: 56.20
Round  54, Train loss: 0.750, Test loss: 0.953, Test accuracy: 66.91
Round  54, Global train loss: 0.750, Global test loss: 1.430, Global test accuracy: 52.27
Round  55, Train loss: 0.716, Test loss: 0.968, Test accuracy: 66.62
Round  55, Global train loss: 0.716, Global test loss: 1.315, Global test accuracy: 55.28
Round  56, Train loss: 0.628, Test loss: 0.965, Test accuracy: 67.19
Round  56, Global train loss: 0.628, Global test loss: 1.379, Global test accuracy: 55.68
Round  57, Train loss: 0.687, Test loss: 0.948, Test accuracy: 67.36
Round  57, Global train loss: 0.687, Global test loss: 1.311, Global test accuracy: 54.78
Round  58, Train loss: 0.637, Test loss: 0.946, Test accuracy: 67.45
Round  58, Global train loss: 0.637, Global test loss: 1.196, Global test accuracy: 58.28
Round  59, Train loss: 0.581, Test loss: 0.946, Test accuracy: 67.91
Round  59, Global train loss: 0.581, Global test loss: 1.210, Global test accuracy: 58.36
Round  60, Train loss: 0.550, Test loss: 0.998, Test accuracy: 66.73
Round  60, Global train loss: 0.550, Global test loss: 1.341, Global test accuracy: 55.67
Round  61, Train loss: 0.611, Test loss: 0.993, Test accuracy: 66.50
Round  61, Global train loss: 0.611, Global test loss: 1.220, Global test accuracy: 58.15
Round  62, Train loss: 0.590, Test loss: 1.015, Test accuracy: 66.03
Round  62, Global train loss: 0.590, Global test loss: 1.381, Global test accuracy: 53.99
Round  63, Train loss: 0.595, Test loss: 1.016, Test accuracy: 66.11
Round  63, Global train loss: 0.595, Global test loss: 1.178, Global test accuracy: 59.86
Round  64, Train loss: 0.571, Test loss: 1.014, Test accuracy: 65.99
Round  64, Global train loss: 0.571, Global test loss: 1.302, Global test accuracy: 56.82
Round  65, Train loss: 0.669, Test loss: 1.016, Test accuracy: 65.81
Round  65, Global train loss: 0.669, Global test loss: 1.290, Global test accuracy: 56.46
Round  66, Train loss: 0.669, Test loss: 1.007, Test accuracy: 66.30
Round  66, Global train loss: 0.669, Global test loss: 1.214, Global test accuracy: 58.53
Round  67, Train loss: 0.753, Test loss: 1.038, Test accuracy: 65.58
Round  67, Global train loss: 0.753, Global test loss: 1.417, Global test accuracy: 51.84
Round  68, Train loss: 0.650, Test loss: 1.031, Test accuracy: 65.84
Round  68, Global train loss: 0.650, Global test loss: 1.415, Global test accuracy: 53.23
Round  69, Train loss: 0.698, Test loss: 1.015, Test accuracy: 66.74
Round  69, Global train loss: 0.698, Global test loss: 1.358, Global test accuracy: 57.04
Round  70, Train loss: 0.545, Test loss: 1.001, Test accuracy: 67.15
Round  70, Global train loss: 0.545, Global test loss: 1.332, Global test accuracy: 56.89
Round  71, Train loss: 0.572, Test loss: 1.005, Test accuracy: 67.17
Round  71, Global train loss: 0.572, Global test loss: 1.365, Global test accuracy: 55.96
Round  72, Train loss: 0.559, Test loss: 1.022, Test accuracy: 67.29
Round  72, Global train loss: 0.559, Global test loss: 1.271, Global test accuracy: 57.30
Round  73, Train loss: 0.522, Test loss: 1.022, Test accuracy: 67.29
Round  73, Global train loss: 0.522, Global test loss: 1.252, Global test accuracy: 58.87
Round  74, Train loss: 0.518, Test loss: 1.051, Test accuracy: 67.13
Round  74, Global train loss: 0.518, Global test loss: 1.263, Global test accuracy: 59.09
Round  75, Train loss: 0.623, Test loss: 1.065, Test accuracy: 66.85
Round  75, Global train loss: 0.623, Global test loss: 1.373, Global test accuracy: 56.57
Round  76, Train loss: 0.557, Test loss: 1.064, Test accuracy: 66.60
Round  76, Global train loss: 0.557, Global test loss: 1.195, Global test accuracy: 60.50
Round  77, Train loss: 0.584, Test loss: 1.038, Test accuracy: 66.62
Round  77, Global train loss: 0.584, Global test loss: 1.244, Global test accuracy: 58.54
Round  78, Train loss: 0.556, Test loss: 1.041, Test accuracy: 66.69
Round  78, Global train loss: 0.556, Global test loss: 1.177, Global test accuracy: 60.41
Round  79, Train loss: 0.628, Test loss: 1.062, Test accuracy: 65.97
Round  79, Global train loss: 0.628, Global test loss: 1.209, Global test accuracy: 59.32
Round  80, Train loss: 0.483, Test loss: 1.043, Test accuracy: 66.52
Round  80, Global train loss: 0.483, Global test loss: 1.249, Global test accuracy: 58.86
Round  81, Train loss: 0.439, Test loss: 1.045, Test accuracy: 66.61
Round  81, Global train loss: 0.439, Global test loss: 1.441, Global test accuracy: 55.74
Round  82, Train loss: 0.512, Test loss: 1.033, Test accuracy: 66.82
Round  82, Global train loss: 0.512, Global test loss: 1.196, Global test accuracy: 60.08
Round  83, Train loss: 0.482, Test loss: 1.035, Test accuracy: 66.86
Round  83, Global train loss: 0.482, Global test loss: 1.340, Global test accuracy: 57.94
Round  84, Train loss: 0.567, Test loss: 1.033, Test accuracy: 67.27
Round  84, Global train loss: 0.567, Global test loss: 1.230, Global test accuracy: 60.00
Round  85, Train loss: 0.492, Test loss: 1.054, Test accuracy: 67.35
Round  85, Global train loss: 0.492, Global test loss: 1.234, Global test accuracy: 60.16
Round  86, Train loss: 0.636, Test loss: 1.034, Test accuracy: 67.94
Round  86, Global train loss: 0.636, Global test loss: 1.441, Global test accuracy: 55.31
Round  87, Train loss: 0.521, Test loss: 1.040, Test accuracy: 67.87
Round  87, Global train loss: 0.521, Global test loss: 1.213, Global test accuracy: 60.75
Round  88, Train loss: 0.556, Test loss: 1.043, Test accuracy: 67.76
Round  88, Global train loss: 0.556, Global test loss: 1.306, Global test accuracy: 58.72
Round  89, Train loss: 0.414, Test loss: 1.045, Test accuracy: 67.76
Round  89, Global train loss: 0.414, Global test loss: 1.403, Global test accuracy: 57.92
Round  90, Train loss: 0.592, Test loss: 1.060, Test accuracy: 67.79
Round  90, Global train loss: 0.592, Global test loss: 1.327, Global test accuracy: 57.98
Round  91, Train loss: 0.525, Test loss: 1.068, Test accuracy: 67.54
Round  91, Global train loss: 0.525, Global test loss: 1.445, Global test accuracy: 55.86
Round  92, Train loss: 0.450, Test loss: 1.076, Test accuracy: 67.85
Round  92, Global train loss: 0.450, Global test loss: 1.383, Global test accuracy: 58.36/home/ChenSM/code/FL_HLS/FedProx.py:100: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  d_p.add_(weight_decay, p.data)

Round  93, Train loss: 0.485, Test loss: 1.073, Test accuracy: 67.90
Round  93, Global train loss: 0.485, Global test loss: 1.352, Global test accuracy: 59.19
Round  94, Train loss: 0.470, Test loss: 1.038, Test accuracy: 68.33
Round  94, Global train loss: 0.470, Global test loss: 1.351, Global test accuracy: 58.62
Round  95, Train loss: 0.465, Test loss: 1.044, Test accuracy: 68.18
Round  95, Global train loss: 0.465, Global test loss: 1.460, Global test accuracy: 57.32
Round  96, Train loss: 0.404, Test loss: 1.065, Test accuracy: 67.86
Round  96, Global train loss: 0.404, Global test loss: 1.361, Global test accuracy: 59.21
Round  97, Train loss: 0.458, Test loss: 1.083, Test accuracy: 67.87
Round  97, Global train loss: 0.458, Global test loss: 1.493, Global test accuracy: 57.29
Round  98, Train loss: 0.430, Test loss: 1.109, Test accuracy: 67.54
Round  98, Global train loss: 0.430, Global test loss: 1.313, Global test accuracy: 59.60
Round  99, Train loss: 0.558, Test loss: 1.122, Test accuracy: 67.31
Round  99, Global train loss: 0.558, Global test loss: 1.362, Global test accuracy: 57.74
Final Round, Train loss: 0.402, Test loss: 1.175, Test accuracy: 67.57
Final Round, Global train loss: 0.402, Global test loss: 1.362, Global test accuracy: 57.74
Average accuracy final 10 rounds: 67.817 

Average global accuracy final 10 rounds: 58.117 

1324.321634054184
[1.4633188247680664, 2.926637649536133, 4.136778116226196, 5.34691858291626, 6.3946897983551025, 7.442461013793945, 8.488467693328857, 9.53447437286377, 10.582847118377686, 11.631219863891602, 12.677929639816284, 13.724639415740967, 14.773598670959473, 15.822557926177979, 16.86910343170166, 17.915648937225342, 18.96353840827942, 20.011427879333496, 21.053773164749146, 22.096118450164795, 23.139528512954712, 24.18293857574463, 25.228583335876465, 26.2742280960083, 27.3223717212677, 28.3705153465271, 29.41821599006653, 30.465916633605957, 31.5153911113739, 32.564865589141846, 33.605090379714966, 34.645315170288086, 35.69146656990051, 36.73761796951294, 37.78667449951172, 38.8357310295105, 39.885419607162476, 40.93510818481445, 41.98314881324768, 43.03118944168091, 44.07928204536438, 45.12737464904785, 46.17433524131775, 47.22129583358765, 48.2625675201416, 49.30383920669556, 50.344990253448486, 51.386141300201416, 52.42724895477295, 53.46835660934448, 54.510952949523926, 55.55354928970337, 56.594361543655396, 57.63517379760742, 58.68004298210144, 59.72491216659546, 60.77305483818054, 61.821197509765625, 62.86915922164917, 63.917120933532715, 64.96616625785828, 66.01521158218384, 67.06294178962708, 68.11067199707031, 69.15850019454956, 70.20632839202881, 71.25176692008972, 72.29720544815063, 73.34255266189575, 74.38789987564087, 75.4341471195221, 76.48039436340332, 77.52855944633484, 78.57672452926636, 79.62873601913452, 80.68074750900269, 81.7200140953064, 82.75928068161011, 83.80296063423157, 84.84664058685303, 85.89229130744934, 86.93794202804565, 87.98607444763184, 89.03420686721802, 90.08086967468262, 91.12753248214722, 92.17701625823975, 93.22650003433228, 94.26813197135925, 95.30976390838623, 96.35411477088928, 97.39846563339233, 98.44110369682312, 99.4837417602539, 100.52536296844482, 101.56698417663574, 102.61139583587646, 103.65580749511719, 104.70282983779907, 105.74985218048096, 106.79542660713196, 107.84100103378296, 108.89074230194092, 109.94048357009888, 110.98402714729309, 112.0275707244873, 113.07484340667725, 114.12211608886719, 115.17083024978638, 116.21954441070557, 117.26178455352783, 118.3040246963501, 119.35640239715576, 120.40878009796143, 121.45396447181702, 122.49914884567261, 123.54501509666443, 124.59088134765625, 125.63642024993896, 126.68195915222168, 127.72604274749756, 128.77012634277344, 129.81523656845093, 130.86034679412842, 131.9075152873993, 132.95468378067017, 134.00176405906677, 135.04884433746338, 136.0960066318512, 137.143168926239, 138.18873071670532, 139.23429250717163, 140.28125548362732, 141.328218460083, 142.37799620628357, 143.42777395248413, 144.47305727005005, 145.51834058761597, 146.56298542022705, 147.60763025283813, 148.65759682655334, 149.70756340026855, 150.75367784500122, 151.7997922897339, 152.85801362991333, 153.91623497009277, 154.96112966537476, 156.00602436065674, 157.051819562912, 158.09761476516724, 159.1422610282898, 160.18690729141235, 161.2349967956543, 162.28308629989624, 163.32969069480896, 164.37629508972168, 165.4216468334198, 166.46699857711792, 167.51213383674622, 168.5572690963745, 169.6028983592987, 170.6485276222229, 171.69799733161926, 172.74746704101562, 173.79424786567688, 174.84102869033813, 175.88881254196167, 176.9365963935852, 177.9846465587616, 179.032696723938, 180.07774448394775, 181.12279224395752, 182.17073035240173, 183.21866846084595, 184.2622675895691, 185.30586671829224, 186.3790831565857, 187.45229959487915, 188.49945092201233, 189.5466022491455, 190.59106135368347, 191.63552045822144, 192.6881000995636, 193.74067974090576, 194.78540992736816, 195.83014011383057, 196.87596225738525, 197.92178440093994, 198.9692919254303, 200.01679944992065, 201.0652346611023, 202.11366987228394, 203.16323471069336, 204.21279954910278, 205.26530051231384, 206.3178014755249, 207.36907148361206, 208.42034149169922, 209.4665126800537, 210.5126838684082, 212.6060767173767, 214.69946956634521]
[22.26, 22.26, 30.38, 30.38, 36.18, 36.18, 40.42, 40.42, 43.89, 43.89, 46.26, 46.26, 48.71, 48.71, 51.06, 51.06, 54.02, 54.02, 54.4, 54.4, 55.4, 55.4, 55.97, 55.97, 56.61, 56.61, 56.92, 56.92, 57.83, 57.83, 59.02, 59.02, 59.48, 59.48, 59.94, 59.94, 59.56, 59.56, 59.84, 59.84, 59.22, 59.22, 60.2, 60.2, 60.25, 60.25, 59.81, 59.81, 60.84, 60.84, 61.82, 61.82, 62.4, 62.4, 61.87, 61.87, 62.35, 62.35, 62.15, 62.15, 63.05, 63.05, 63.87, 63.87, 63.49, 63.49, 63.43, 63.43, 63.51, 63.51, 63.87, 63.87, 63.97, 63.97, 65.1, 65.1, 64.34, 64.34, 64.55, 64.55, 65.18, 65.18, 64.53, 64.53, 65.82, 65.82, 65.68, 65.68, 65.87, 65.87, 65.57, 65.57, 65.87, 65.87, 66.56, 66.56, 65.98, 65.98, 66.15, 66.15, 66.56, 66.56, 65.67, 65.67, 66.4, 66.4, 66.37, 66.37, 66.91, 66.91, 66.62, 66.62, 67.19, 67.19, 67.36, 67.36, 67.45, 67.45, 67.91, 67.91, 66.73, 66.73, 66.5, 66.5, 66.03, 66.03, 66.11, 66.11, 65.99, 65.99, 65.81, 65.81, 66.3, 66.3, 65.58, 65.58, 65.84, 65.84, 66.74, 66.74, 67.15, 67.15, 67.17, 67.17, 67.29, 67.29, 67.29, 67.29, 67.13, 67.13, 66.85, 66.85, 66.6, 66.6, 66.62, 66.62, 66.69, 66.69, 65.97, 65.97, 66.52, 66.52, 66.61, 66.61, 66.82, 66.82, 66.86, 66.86, 67.27, 67.27, 67.35, 67.35, 67.94, 67.94, 67.87, 67.87, 67.76, 67.76, 67.76, 67.76, 67.79, 67.79, 67.54, 67.54, 67.85, 67.85, 67.9, 67.9, 68.33, 68.33, 68.18, 68.18, 67.86, 67.86, 67.87, 67.87, 67.54, 67.54, 67.31, 67.31, 67.57, 67.57]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_co_teaching%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 11, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 1, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.690, Test loss: 2.068, Test accuracy: 21.43
Round   0, Global train loss: 1.690, Global test loss: 2.254, Global test accuracy: 17.02
Round   1, Train loss: 1.437, Test loss: 1.880, Test accuracy: 31.05
Round   1, Global train loss: 1.437, Global test loss: 2.127, Global test accuracy: 24.26
Round   2, Train loss: 1.342, Test loss: 1.719, Test accuracy: 38.16
Round   2, Global train loss: 1.342, Global test loss: 2.135, Global test accuracy: 28.00
Round   3, Train loss: 1.358, Test loss: 1.498, Test accuracy: 42.85
Round   3, Global train loss: 1.358, Global test loss: 1.949, Global test accuracy: 31.84
Round   4, Train loss: 1.276, Test loss: 1.402, Test accuracy: 46.04
Round   4, Global train loss: 1.276, Global test loss: 1.797, Global test accuracy: 35.31
Round   5, Train loss: 1.183, Test loss: 1.353, Test accuracy: 48.25
Round   5, Global train loss: 1.183, Global test loss: 1.712, Global test accuracy: 35.68
Round   6, Train loss: 1.198, Test loss: 1.268, Test accuracy: 50.67
Round   6, Global train loss: 1.198, Global test loss: 1.803, Global test accuracy: 33.88
Round   7, Train loss: 1.205, Test loss: 1.233, Test accuracy: 52.67
Round   7, Global train loss: 1.205, Global test loss: 1.664, Global test accuracy: 40.43
Round   8, Train loss: 1.250, Test loss: 1.201, Test accuracy: 53.80
Round   8, Global train loss: 1.250, Global test loss: 1.660, Global test accuracy: 39.23
Round   9, Train loss: 1.099, Test loss: 1.207, Test accuracy: 54.15
Round   9, Global train loss: 1.099, Global test loss: 1.627, Global test accuracy: 40.49
Round  10, Train loss: 1.201, Test loss: 1.185, Test accuracy: 55.00
Round  10, Global train loss: 1.201, Global test loss: 1.771, Global test accuracy: 35.02
Round  11, Train loss: 1.049, Test loss: 1.162, Test accuracy: 56.33
Round  11, Global train loss: 1.049, Global test loss: 1.638, Global test accuracy: 43.53
Round  12, Train loss: 1.134, Test loss: 1.151, Test accuracy: 57.20
Round  12, Global train loss: 1.134, Global test loss: 1.640, Global test accuracy: 42.21
Round  13, Train loss: 1.134, Test loss: 1.138, Test accuracy: 57.72
Round  13, Global train loss: 1.134, Global test loss: 1.585, Global test accuracy: 43.90
Round  14, Train loss: 1.105, Test loss: 1.104, Test accuracy: 58.35
Round  14, Global train loss: 1.105, Global test loss: 1.766, Global test accuracy: 39.68
Round  15, Train loss: 0.987, Test loss: 1.109, Test accuracy: 58.18
Round  15, Global train loss: 0.987, Global test loss: 1.634, Global test accuracy: 39.98
Round  16, Train loss: 0.982, Test loss: 1.103, Test accuracy: 58.70
Round  16, Global train loss: 0.982, Global test loss: 1.576, Global test accuracy: 42.40
Round  17, Train loss: 0.967, Test loss: 1.099, Test accuracy: 59.33
Round  17, Global train loss: 0.967, Global test loss: 1.492, Global test accuracy: 46.02
Round  18, Train loss: 1.047, Test loss: 1.090, Test accuracy: 60.06
Round  18, Global train loss: 1.047, Global test loss: 1.607, Global test accuracy: 44.91
Round  19, Train loss: 1.031, Test loss: 1.074, Test accuracy: 60.14
Round  19, Global train loss: 1.031, Global test loss: 1.528, Global test accuracy: 46.14
Round  20, Train loss: 1.005, Test loss: 1.055, Test accuracy: 61.14
Round  20, Global train loss: 1.005, Global test loss: 1.586, Global test accuracy: 45.14
Round  21, Train loss: 0.957, Test loss: 1.045, Test accuracy: 61.31
Round  21, Global train loss: 0.957, Global test loss: 1.493, Global test accuracy: 46.97
Round  22, Train loss: 0.978, Test loss: 1.050, Test accuracy: 60.84
Round  22, Global train loss: 0.978, Global test loss: 1.606, Global test accuracy: 44.93
Round  23, Train loss: 0.943, Test loss: 1.079, Test accuracy: 60.24
Round  23, Global train loss: 0.943, Global test loss: 1.408, Global test accuracy: 50.32
Round  24, Train loss: 1.060, Test loss: 1.071, Test accuracy: 60.22
Round  24, Global train loss: 1.060, Global test loss: 1.387, Global test accuracy: 52.23
Round  25, Train loss: 1.008, Test loss: 1.058, Test accuracy: 60.63
Round  25, Global train loss: 1.008, Global test loss: 1.490, Global test accuracy: 48.41
Round  26, Train loss: 0.908, Test loss: 1.052, Test accuracy: 61.67
Round  26, Global train loss: 0.908, Global test loss: 1.559, Global test accuracy: 49.14
Round  27, Train loss: 0.840, Test loss: 1.068, Test accuracy: 61.22
Round  27, Global train loss: 0.840, Global test loss: 1.728, Global test accuracy: 46.77
Round  28, Train loss: 0.824, Test loss: 1.079, Test accuracy: 60.79
Round  28, Global train loss: 0.824, Global test loss: 1.463, Global test accuracy: 51.19
Round  29, Train loss: 0.754, Test loss: 1.037, Test accuracy: 62.45
Round  29, Global train loss: 0.754, Global test loss: 1.413, Global test accuracy: 50.90
Round  30, Train loss: 0.778, Test loss: 1.053, Test accuracy: 62.36
Round  30, Global train loss: 0.778, Global test loss: 1.377, Global test accuracy: 51.94
Round  31, Train loss: 0.848, Test loss: 1.050, Test accuracy: 62.45
Round  31, Global train loss: 0.848, Global test loss: 1.453, Global test accuracy: 49.07
Round  32, Train loss: 0.791, Test loss: 1.039, Test accuracy: 63.20
Round  32, Global train loss: 0.791, Global test loss: 1.327, Global test accuracy: 53.72
Round  33, Train loss: 0.839, Test loss: 1.019, Test accuracy: 64.14
Round  33, Global train loss: 0.839, Global test loss: 1.257, Global test accuracy: 54.72
Round  34, Train loss: 0.866, Test loss: 1.018, Test accuracy: 64.46
Round  34, Global train loss: 0.866, Global test loss: 1.329, Global test accuracy: 53.24
Round  35, Train loss: 0.715, Test loss: 1.026, Test accuracy: 63.83
Round  35, Global train loss: 0.715, Global test loss: 1.364, Global test accuracy: 52.57
Round  36, Train loss: 0.993, Test loss: 1.018, Test accuracy: 63.43
Round  36, Global train loss: 0.993, Global test loss: 1.302, Global test accuracy: 54.81
Round  37, Train loss: 0.735, Test loss: 1.017, Test accuracy: 63.43
Round  37, Global train loss: 0.735, Global test loss: 1.599, Global test accuracy: 46.78
Round  38, Train loss: 0.751, Test loss: 1.040, Test accuracy: 63.10
Round  38, Global train loss: 0.751, Global test loss: 1.383, Global test accuracy: 51.74
Round  39, Train loss: 0.672, Test loss: 1.056, Test accuracy: 62.89
Round  39, Global train loss: 0.672, Global test loss: 1.252, Global test accuracy: 56.09
Round  40, Train loss: 0.675, Test loss: 1.052, Test accuracy: 63.30
Round  40, Global train loss: 0.675, Global test loss: 1.284, Global test accuracy: 54.92
Round  41, Train loss: 0.664, Test loss: 1.054, Test accuracy: 63.25
Round  41, Global train loss: 0.664, Global test loss: 1.462, Global test accuracy: 51.41
Round  42, Train loss: 0.614, Test loss: 1.065, Test accuracy: 63.39
Round  42, Global train loss: 0.614, Global test loss: 1.304, Global test accuracy: 55.46
Round  43, Train loss: 0.698, Test loss: 1.055, Test accuracy: 63.77
Round  43, Global train loss: 0.698, Global test loss: 1.409, Global test accuracy: 53.34
Round  44, Train loss: 0.707, Test loss: 1.035, Test accuracy: 64.47
Round  44, Global train loss: 0.707, Global test loss: 1.369, Global test accuracy: 53.96
Round  45, Train loss: 0.777, Test loss: 1.029, Test accuracy: 64.87
Round  45, Global train loss: 0.777, Global test loss: 1.418, Global test accuracy: 51.63
Round  46, Train loss: 0.812, Test loss: 1.024, Test accuracy: 64.55
Round  46, Global train loss: 0.812, Global test loss: 1.335, Global test accuracy: 54.23
Round  47, Train loss: 0.749, Test loss: 1.024, Test accuracy: 65.27
Round  47, Global train loss: 0.749, Global test loss: 1.282, Global test accuracy: 56.18
Round  48, Train loss: 0.694, Test loss: 1.028, Test accuracy: 65.62
Round  48, Global train loss: 0.694, Global test loss: 1.391, Global test accuracy: 54.37
Round  49, Train loss: 0.638, Test loss: 1.060, Test accuracy: 65.10
Round  49, Global train loss: 0.638, Global test loss: 1.390, Global test accuracy: 54.09
Round  50, Train loss: 0.745, Test loss: 1.058, Test accuracy: 65.31
Round  50, Global train loss: 0.745, Global test loss: 1.475, Global test accuracy: 51.81
Round  51, Train loss: 0.749, Test loss: 1.087, Test accuracy: 64.33
Round  51, Global train loss: 0.749, Global test loss: 1.417, Global test accuracy: 53.04
Round  52, Train loss: 0.657, Test loss: 1.068, Test accuracy: 64.55
Round  52, Global train loss: 0.657, Global test loss: 1.351, Global test accuracy: 54.87
Round  53, Train loss: 0.681, Test loss: 1.059, Test accuracy: 64.88
Round  53, Global train loss: 0.681, Global test loss: 1.302, Global test accuracy: 55.70
Round  54, Train loss: 0.701, Test loss: 1.061, Test accuracy: 65.14
Round  54, Global train loss: 0.701, Global test loss: 1.593, Global test accuracy: 49.54
Round  55, Train loss: 0.732, Test loss: 1.072, Test accuracy: 65.33
Round  55, Global train loss: 0.732, Global test loss: 1.351, Global test accuracy: 55.50
Round  56, Train loss: 0.646, Test loss: 1.069, Test accuracy: 65.43
Round  56, Global train loss: 0.646, Global test loss: 1.564, Global test accuracy: 51.70
Round  57, Train loss: 0.592, Test loss: 1.063, Test accuracy: 65.44
Round  57, Global train loss: 0.592, Global test loss: 1.363, Global test accuracy: 55.12
Round  58, Train loss: 0.702, Test loss: 1.095, Test accuracy: 65.13
Round  58, Global train loss: 0.702, Global test loss: 1.273, Global test accuracy: 56.87
Round  59, Train loss: 0.589, Test loss: 1.115, Test accuracy: 64.77
Round  59, Global train loss: 0.589, Global test loss: 1.301, Global test accuracy: 56.84
Round  60, Train loss: 0.549, Test loss: 1.134, Test accuracy: 64.55
Round  60, Global train loss: 0.549, Global test loss: 1.497, Global test accuracy: 53.28
Round  61, Train loss: 0.596, Test loss: 1.126, Test accuracy: 64.87
Round  61, Global train loss: 0.596, Global test loss: 1.413, Global test accuracy: 54.42
Round  62, Train loss: 0.622, Test loss: 1.137, Test accuracy: 64.81
Round  62, Global train loss: 0.622, Global test loss: 1.425, Global test accuracy: 54.00
Round  63, Train loss: 0.602, Test loss: 1.132, Test accuracy: 65.14
Round  63, Global train loss: 0.602, Global test loss: 1.321, Global test accuracy: 56.23
Round  64, Train loss: 0.560, Test loss: 1.135, Test accuracy: 65.34
Round  64, Global train loss: 0.560, Global test loss: 1.349, Global test accuracy: 57.26
Round  65, Train loss: 0.538, Test loss: 1.141, Test accuracy: 65.48
Round  65, Global train loss: 0.538, Global test loss: 1.423, Global test accuracy: 54.17
Round  66, Train loss: 0.615, Test loss: 1.144, Test accuracy: 65.75
Round  66, Global train loss: 0.615, Global test loss: 1.287, Global test accuracy: 58.05
Round  67, Train loss: 0.640, Test loss: 1.138, Test accuracy: 65.80
Round  67, Global train loss: 0.640, Global test loss: 1.379, Global test accuracy: 54.89
Round  68, Train loss: 0.516, Test loss: 1.138, Test accuracy: 65.87
Round  68, Global train loss: 0.516, Global test loss: 1.359, Global test accuracy: 56.64
Round  69, Train loss: 0.603, Test loss: 1.127, Test accuracy: 65.81
Round  69, Global train loss: 0.603, Global test loss: 1.369, Global test accuracy: 55.19
Round  70, Train loss: 0.577, Test loss: 1.138, Test accuracy: 66.11
Round  70, Global train loss: 0.577, Global test loss: 1.441, Global test accuracy: 54.55
Round  71, Train loss: 0.558, Test loss: 1.121, Test accuracy: 66.08
Round  71, Global train loss: 0.558, Global test loss: 1.337, Global test accuracy: 55.45
Round  72, Train loss: 0.598, Test loss: 1.137, Test accuracy: 65.72
Round  72, Global train loss: 0.598, Global test loss: 1.376, Global test accuracy: 56.78
Round  73, Train loss: 0.472, Test loss: 1.129, Test accuracy: 65.87
Round  73, Global train loss: 0.472, Global test loss: 1.340, Global test accuracy: 58.36
Round  74, Train loss: 0.527, Test loss: 1.151, Test accuracy: 65.67
Round  74, Global train loss: 0.527, Global test loss: 1.338, Global test accuracy: 58.77
Round  75, Train loss: 0.538, Test loss: 1.142, Test accuracy: 66.06
Round  75, Global train loss: 0.538, Global test loss: 1.489, Global test accuracy: 54.51
Round  76, Train loss: 0.532, Test loss: 1.144, Test accuracy: 66.31
Round  76, Global train loss: 0.532, Global test loss: 1.330, Global test accuracy: 56.91
Round  77, Train loss: 0.528, Test loss: 1.139, Test accuracy: 66.26
Round  77, Global train loss: 0.528, Global test loss: 1.376, Global test accuracy: 56.31
Round  78, Train loss: 0.611, Test loss: 1.152, Test accuracy: 66.14
Round  78, Global train loss: 0.611, Global test loss: 1.259, Global test accuracy: 58.24
Round  79, Train loss: 0.511, Test loss: 1.168, Test accuracy: 65.71
Round  79, Global train loss: 0.511, Global test loss: 1.293, Global test accuracy: 58.57
Round  80, Train loss: 0.498, Test loss: 1.194, Test accuracy: 65.02
Round  80, Global train loss: 0.498, Global test loss: 1.407, Global test accuracy: 56.04
Round  81, Train loss: 0.490, Test loss: 1.181, Test accuracy: 65.16
Round  81, Global train loss: 0.490, Global test loss: 1.485, Global test accuracy: 53.44
Round  82, Train loss: 0.451, Test loss: 1.162, Test accuracy: 65.31
Round  82, Global train loss: 0.451, Global test loss: 1.338, Global test accuracy: 58.34
Round  83, Train loss: 0.503, Test loss: 1.155, Test accuracy: 65.47
Round  83, Global train loss: 0.503, Global test loss: 1.482, Global test accuracy: 55.30
Round  84, Train loss: 0.481, Test loss: 1.158, Test accuracy: 65.48
Round  84, Global train loss: 0.481, Global test loss: 1.393, Global test accuracy: 56.72
Round  85, Train loss: 0.453, Test loss: 1.172, Test accuracy: 65.51
Round  85, Global train loss: 0.453, Global test loss: 1.269, Global test accuracy: 60.24
Round  86, Train loss: 0.483, Test loss: 1.165, Test accuracy: 66.00
Round  86, Global train loss: 0.483, Global test loss: 1.621, Global test accuracy: 53.51
Round  87, Train loss: 0.440, Test loss: 1.167, Test accuracy: 66.20
Round  87, Global train loss: 0.440, Global test loss: 1.304, Global test accuracy: 59.26
Round  88, Train loss: 0.566, Test loss: 1.180, Test accuracy: 66.11
Round  88, Global train loss: 0.566, Global test loss: 1.327, Global test accuracy: 56.69
Round  89, Train loss: 0.464, Test loss: 1.186, Test accuracy: 66.37
Round  89, Global train loss: 0.464, Global test loss: 1.474, Global test accuracy: 57.09
Round  90, Train loss: 0.454, Test loss: 1.191, Test accuracy: 66.09
Round  90, Global train loss: 0.454, Global test loss: 1.449, Global test accuracy: 55.69
Round  91, Train loss: 0.412, Test loss: 1.234, Test accuracy: 65.64
Round  91, Global train loss: 0.412, Global test loss: 1.687, Global test accuracy: 51.94
Round  92, Train loss: 0.425, Test loss: 1.236, Test accuracy: 65.63
Round  92, Global train loss: 0.425, Global test loss: 1.406, Global test accuracy: 57.07
Round  93, Train loss: 0.421, Test loss: 1.213, Test accuracy: 65.61
Round  93, Global train loss: 0.421, Global test loss: 1.470, Global test accuracy: 56.51
Round  94, Train loss: 0.522, Test loss: 1.224, Test accuracy: 65.36
Round  94, Global train loss: 0.522, Global test loss: 1.358, Global test accuracy: 57.80
Round  95, Train loss: 0.391, Test loss: 1.237, Test accuracy: 65.27
Round  95, Global train loss: 0.391, Global test loss: 1.539, Global test accuracy: 55.80
Round  96, Train loss: 0.434, Test loss: 1.214, Test accuracy: 65.50
Round  96, Global train loss: 0.434, Global test loss: 1.436, Global test accuracy: 57.16
Round  97, Train loss: 0.378, Test loss: 1.215, Test accuracy: 65.54
Round  97, Global train loss: 0.378, Global test loss: 1.538, Global test accuracy: 55.18
Round  98, Train loss: 0.523, Test loss: 1.243, Test accuracy: 65.11
Round  98, Global train loss: 0.523, Global test loss: 1.401, Global test accuracy: 57.26
Round  99, Train loss: 0.506, Test loss: 1.223, Test accuracy: 65.94
Round  99, Global train loss: 0.506, Global test loss: 1.561, Global test accuracy: 55.10
Final Round, Train loss: 0.342, Test loss: 1.367, Test accuracy: 65.69
Final Round, Global train loss: 0.342, Global test loss: 1.561, Global test accuracy: 55.10
Average accuracy final 10 rounds: 65.569
Average global accuracy final 10 rounds: 55.95099999999999
2105.28799533844
[2.916541576385498, 5.553356409072876, 8.17736291885376, 10.833112239837646, 13.476310729980469, 16.14969491958618, 18.80123782157898, 21.43562602996826, 24.07420587539673, 26.735363483428955, 29.38853931427002, 32.03857946395874, 34.66639447212219, 37.27852392196655, 39.92050886154175, 42.56459021568298, 45.20043349266052, 47.843095541000366, 50.49731969833374, 53.139543771743774, 55.77656936645508, 58.41164994239807, 61.04972457885742, 63.67763376235962, 66.3159568309784, 68.94337463378906, 71.56529831886292, 74.19752907752991, 76.85584354400635, 79.50353860855103, 82.16015076637268, 84.8083815574646, 87.4458794593811, 90.09661841392517, 92.73904132843018, 95.35998392105103, 98.00566816329956, 100.63836693763733, 103.27819037437439, 105.92833852767944, 108.56756830215454, 111.19575929641724, 113.83106064796448, 116.49509930610657, 119.15573143959045, 121.80902647972107, 124.45271849632263, 127.10322594642639, 129.74049186706543, 132.39720106124878, 135.05604362487793, 137.71825981140137, 140.3660328388214, 143.03151965141296, 145.67022228240967, 148.30751729011536, 150.93748474121094, 153.57467436790466, 156.2325291633606, 158.8806803226471, 161.53381490707397, 164.17764854431152, 166.830721616745, 169.48866176605225, 172.13993883132935, 174.78515458106995, 177.43740725517273, 180.09916853904724, 182.73946976661682, 185.38685941696167, 188.03948092460632, 190.69017100334167, 193.34012150764465, 196.00322723388672, 198.65967392921448, 201.32168316841125, 203.96876168251038, 206.61477613449097, 209.27099680900574, 211.92693877220154, 214.58748173713684, 217.2399480342865, 219.89667463302612, 222.54795575141907, 225.20385599136353, 227.86707735061646, 230.50884103775024, 233.16460418701172, 235.82743859291077, 238.4818308353424, 241.1318302154541, 243.79220604896545, 246.44907665252686, 249.09687066078186, 251.74486780166626, 254.40947484970093, 257.053608417511, 259.6777172088623, 262.33562684059143, 265.00477290153503, 269.8850402832031]
[21.43, 31.05, 38.16, 42.85, 46.04, 48.25, 50.67, 52.67, 53.8, 54.15, 55.0, 56.33, 57.2, 57.72, 58.35, 58.18, 58.7, 59.33, 60.06, 60.14, 61.14, 61.31, 60.84, 60.24, 60.22, 60.63, 61.67, 61.22, 60.79, 62.45, 62.36, 62.45, 63.2, 64.14, 64.46, 63.83, 63.43, 63.43, 63.1, 62.89, 63.3, 63.25, 63.39, 63.77, 64.47, 64.87, 64.55, 65.27, 65.62, 65.1, 65.31, 64.33, 64.55, 64.88, 65.14, 65.33, 65.43, 65.44, 65.13, 64.77, 64.55, 64.87, 64.81, 65.14, 65.34, 65.48, 65.75, 65.8, 65.87, 65.81, 66.11, 66.08, 65.72, 65.87, 65.67, 66.06, 66.31, 66.26, 66.14, 65.71, 65.02, 65.16, 65.31, 65.47, 65.48, 65.51, 66.0, 66.2, 66.11, 66.37, 66.09, 65.64, 65.63, 65.61, 65.36, 65.27, 65.5, 65.54, 65.11, 65.94, 65.69]
RFL.py:4: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  from numpy import long
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%RFL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: RFL , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 14, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
LeNet(
  (conv1): Conv2d(3, 6, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))
  (batch_norm): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (fc1): Linear(in_features=400, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=84, bias=True)
  (fc3): Linear(in_features=84, out_features=10, bias=True)
)
Round 0 global test acc  18.2600
Round 1 global test acc  19.2500
Round 2 global test acc  20.9600
Round 3 global test acc  18.5200
Round 4 global test acc  22.3800
Round 5 global test acc  26.1800
Round 6 global test acc  27.9600
Round 7 global test acc  26.0100
Round 8 global test acc  31.4700
Round 9 global test acc  30.1200
Round 10 global test acc  32.4400
Round 11 global test acc  31.4600
Round 12 global test acc  33.2500
Round 13 global test acc  29.1600
Round 14 global test acc  33.9500
Round 15 global test acc  31.2500
Round 16 global test acc  29.4600
Round 17 global test acc  27.7600
Round 18 global test acc  37.9700
Round 19 global test acc  31.3600
Round 20 global test acc  34.0200
Round 21 global test acc  32.5800
Round 22 global test acc  35.4000
Round 23 global test acc  33.6000
Round 24 global test acc  28.4100
Round 25 global test acc  31.8700
Round 26 global test acc  32.3500
Round 27 global test acc  37.8300
Round 28 global test acc  38.6100
Round 29 global test acc  33.6200
Round 30 global test acc  30.2100
Round 31 global test acc  35.5300
Round 32 global test acc  32.1100
Round 33 global test acc  39.5700
Round 34 global test acc  34.2000
Round 35 global test acc  37.6300
Round 36 global test acc  32.2300
Round 37 global test acc  46.3800
Round 38 global test acc  34.8200
Round 39 global test acc  34.3000
Round 40 global test acc  32.7300
Round 41 global test acc  40.0500
Round 42 global test acc  36.5700
Round 43 global test acc  36.8800
Round 44 global test acc  39.7700
Round 45 global test acc  37.5900
Round 46 global test acc  35.3000
Round 47 global test acc  38.6100
Round 48 global test acc  38.5900
Round 49 global test acc  34.4300
Round 50 global test acc  36.3300
Round 51 global test acc  34.1800
Round 52 global test acc  30.8800
Round 53 global test acc  34.5400
Round 54 global test acc  34.9600
Round 55 global test acc  35.4200
Round 56 global test acc  36.2700
Round 57 global test acc  31.2700
Round 58 global test acc  42.7000
Round 59 global test acc  35.3800
Round 60 global test acc  37.1100
Round 61 global test acc  36.2200
Round 62 global test acc  37.1500
Round 63 global test acc  40.8400
Round 64 global test acc  36.4400
Round 65 global test acc  35.5400
Round 66 global test acc  41.7100
Round 67 global test acc  41.5900
Round 68 global test acc  40.4700
Round 69 global test acc  37.7200
Round 70 global test acc  37.2600
Round 71 global test acc  38.4900
Round 72 global test acc  34.5200
Round 73 global test acc  45.8800
Round 74 global test acc  34.4200
Round 75 global test acc  41.0100
Round 76 global test acc  37.7400
Round 77 global test acc  35.2000
Round 78 global test acc  33.8000
Round 79 global test acc  39.6500
Round 80 global test acc  37.0300
Round 81 global test acc  37.9600
Round 82 global test acc  34.3400
Round 83 global test acc  32.7000
Round 84 global test acc  31.8300
Round 85 global test acc  29.6900
Round 86 global test acc  28.3000
Round 87 global test acc  26.5400
Round 88 global test acc  24.1500
Round 89 global test acc  21.7400
Round 90 global test acc  21.0300
Round 91 global test acc  20.1400
Round 92 global test acc  19.1500
Round 93 global test acc  18.5200
Round 94 global test acc  18.3300
Round 95 global test acc  18.6900
Round 96 global test acc  18.5700
Round 97 global test acc  18.3600
Round 98 global test acc  18.2900
Round 99 global test acc  18.2500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10  

Files already downloaded and verified
Files already downloaded and verified
   Client 4, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.959, Test loss: 2.204, Test accuracy: 16.88
Round   1, Train loss: 1.590, Test loss: 1.948, Test accuracy: 29.72
Round   2, Train loss: 1.427, Test loss: 1.781, Test accuracy: 37.03
Round   3, Train loss: 1.357, Test loss: 1.502, Test accuracy: 41.19
Round   4, Train loss: 1.316, Test loss: 1.370, Test accuracy: 44.50
Round   5, Train loss: 1.318, Test loss: 1.291, Test accuracy: 48.09
Round   6, Train loss: 1.191, Test loss: 1.219, Test accuracy: 51.50
Round   7, Train loss: 1.147, Test loss: 1.168, Test accuracy: 53.42
Round   8, Train loss: 1.095, Test loss: 1.125, Test accuracy: 53.73
Round   9, Train loss: 1.117, Test loss: 1.082, Test accuracy: 55.85
Round  10, Train loss: 1.144, Test loss: 1.076, Test accuracy: 56.12
Round  11, Train loss: 1.081, Test loss: 1.044, Test accuracy: 57.36
Round  12, Train loss: 1.053, Test loss: 1.053, Test accuracy: 57.49
Round  13, Train loss: 1.048, Test loss: 1.032, Test accuracy: 57.81
Round  14, Train loss: 1.015, Test loss: 1.027, Test accuracy: 57.80
Round  15, Train loss: 0.983, Test loss: 1.007, Test accuracy: 59.10
Round  16, Train loss: 0.998, Test loss: 0.997, Test accuracy: 59.54
Round  17, Train loss: 1.052, Test loss: 0.984, Test accuracy: 60.73
Round  18, Train loss: 1.034, Test loss: 0.987, Test accuracy: 60.55
Round  19, Train loss: 1.087, Test loss: 0.987, Test accuracy: 60.76
Round  20, Train loss: 0.998, Test loss: 0.962, Test accuracy: 61.79
Round  21, Train loss: 0.982, Test loss: 0.942, Test accuracy: 62.72
Round  22, Train loss: 0.922, Test loss: 0.945, Test accuracy: 61.89
Round  23, Train loss: 1.007, Test loss: 0.933, Test accuracy: 63.23
Round  24, Train loss: 0.987, Test loss: 0.929, Test accuracy: 64.01
Round  25, Train loss: 0.894, Test loss: 0.908, Test accuracy: 64.76
Round  26, Train loss: 0.875, Test loss: 0.906, Test accuracy: 64.44
Round  27, Train loss: 0.837, Test loss: 0.894, Test accuracy: 65.07
Round  28, Train loss: 0.809, Test loss: 0.878, Test accuracy: 65.61
Round  29, Train loss: 0.746, Test loss: 0.870, Test accuracy: 66.28
Round  30, Train loss: 0.811, Test loss: 0.876, Test accuracy: 65.93
Round  31, Train loss: 0.808, Test loss: 0.870, Test accuracy: 66.11
Round  32, Train loss: 0.857, Test loss: 0.868, Test accuracy: 66.27
Round  33, Train loss: 0.872, Test loss: 0.857, Test accuracy: 67.51
Round  34, Train loss: 0.779, Test loss: 0.857, Test accuracy: 67.34
Round  35, Train loss: 0.860, Test loss: 0.852, Test accuracy: 66.88
Round  36, Train loss: 0.919, Test loss: 0.853, Test accuracy: 67.01
Round  37, Train loss: 0.787, Test loss: 0.831, Test accuracy: 67.81
Round  38, Train loss: 0.844, Test loss: 0.823, Test accuracy: 68.21
Round  39, Train loss: 0.764, Test loss: 0.827, Test accuracy: 67.98
Round  40, Train loss: 0.773, Test loss: 0.833, Test accuracy: 67.90
Round  41, Train loss: 0.754, Test loss: 0.817, Test accuracy: 68.45
Round  42, Train loss: 0.727, Test loss: 0.807, Test accuracy: 68.81
Round  43, Train loss: 0.708, Test loss: 0.812, Test accuracy: 68.86
Round  44, Train loss: 0.859, Test loss: 0.807, Test accuracy: 69.36
Round  45, Train loss: 0.781, Test loss: 0.795, Test accuracy: 69.95
Round  46, Train loss: 0.875, Test loss: 0.797, Test accuracy: 69.32
Round  47, Train loss: 0.679, Test loss: 0.793, Test accuracy: 69.58
Round  48, Train loss: 0.756, Test loss: 0.790, Test accuracy: 69.64
Round  49, Train loss: 0.779, Test loss: 0.791, Test accuracy: 69.80
Round  50, Train loss: 0.825, Test loss: 0.787, Test accuracy: 70.37
Round  51, Train loss: 0.738, Test loss: 0.787, Test accuracy: 69.93
Round  52, Train loss: 0.650, Test loss: 0.776, Test accuracy: 70.66
Round  53, Train loss: 0.734, Test loss: 0.777, Test accuracy: 70.78
Round  54, Train loss: 0.762, Test loss: 0.777, Test accuracy: 70.69
Round  55, Train loss: 0.699, Test loss: 0.772, Test accuracy: 70.57
Round  56, Train loss: 0.736, Test loss: 0.765, Test accuracy: 70.70
Round  57, Train loss: 0.767, Test loss: 0.760, Test accuracy: 71.22
Round  58, Train loss: 0.700, Test loss: 0.741, Test accuracy: 71.32
Round  59, Train loss: 0.619, Test loss: 0.749, Test accuracy: 71.34
Round  60, Train loss: 0.653, Test loss: 0.746, Test accuracy: 71.61
Round  61, Train loss: 0.661, Test loss: 0.743, Test accuracy: 71.95
Round  62, Train loss: 0.675, Test loss: 0.745, Test accuracy: 71.66
Round  63, Train loss: 0.593, Test loss: 0.754, Test accuracy: 71.17
Round  64, Train loss: 0.625, Test loss: 0.751, Test accuracy: 71.22
Round  65, Train loss: 0.629, Test loss: 0.737, Test accuracy: 71.60
Round  66, Train loss: 0.668, Test loss: 0.733, Test accuracy: 71.75
Round  67, Train loss: 0.690, Test loss: 0.731, Test accuracy: 72.00
Round  68, Train loss: 0.683, Test loss: 0.730, Test accuracy: 72.17
Round  69, Train loss: 0.688, Test loss: 0.725, Test accuracy: 72.31
Round  70, Train loss: 0.714, Test loss: 0.746, Test accuracy: 71.52
Round  71, Train loss: 0.687, Test loss: 0.737, Test accuracy: 72.18
Round  72, Train loss: 0.586, Test loss: 0.747, Test accuracy: 71.73
Round  73, Train loss: 0.578, Test loss: 0.745, Test accuracy: 72.16
Round  74, Train loss: 0.666, Test loss: 0.745, Test accuracy: 72.31
Round  75, Train loss: 0.622, Test loss: 0.730, Test accuracy: 72.50
Round  76, Train loss: 0.522, Test loss: 0.716, Test accuracy: 72.68
Round  77, Train loss: 0.620, Test loss: 0.726, Test accuracy: 72.41
Round  78, Train loss: 0.652, Test loss: 0.725, Test accuracy: 72.60
Round  79, Train loss: 0.675, Test loss: 0.722, Test accuracy: 72.77
Round  80, Train loss: 0.543, Test loss: 0.726, Test accuracy: 72.27
Round  81, Train loss: 0.507, Test loss: 0.720, Test accuracy: 72.76
Round  82, Train loss: 0.593, Test loss: 0.729, Test accuracy: 73.12
Round  83, Train loss: 0.565, Test loss: 0.734, Test accuracy: 72.37
Round  84, Train loss: 0.644, Test loss: 0.732, Test accuracy: 72.56
Round  85, Train loss: 0.459, Test loss: 0.728, Test accuracy: 72.68
Round  86, Train loss: 0.589, Test loss: 0.729, Test accuracy: 72.33
Round  87, Train loss: 0.635, Test loss: 0.731, Test accuracy: 72.79
Round  88, Train loss: 0.549, Test loss: 0.725, Test accuracy: 73.13
Round  89, Train loss: 0.466, Test loss: 0.740, Test accuracy: 72.32
Round  90, Train loss: 0.557, Test loss: 0.737, Test accuracy: 72.58
Round  91, Train loss: 0.544, Test loss: 0.744, Test accuracy: 72.39
Round  92, Train loss: 0.626, Test loss: 0.732, Test accuracy: 72.85
Round  93, Train loss: 0.464, Test loss: 0.726, Test accuracy: 73.29
Round  94, Train loss: 0.525, Test loss: 0.724, Test accuracy: 72.82
Round  95, Train loss: 0.506, Test loss: 0.729, Test accuracy: 72.72
Round  96, Train loss: 0.534, Test loss: 0.730, Test accuracy: 72.91
Round  97, Train loss: 0.520, Test loss: 0.729, Test accuracy: 73.07
Round  98, Train loss: 0.597, Test loss: 0.722, Test accuracy: 73.25
Round  99, Train loss: 0.615, Test loss: 0.733, Test accuracy: 72.89
Final Round, Train loss: 0.458, Test loss: 0.737, Test accuracy: 73.07
Average accuracy final 10 rounds: 72.877
1072.8715040683746
[1.6589279174804688, 3.011397123336792, 4.382329702377319, 5.781858444213867, 7.169023513793945, 8.575992345809937, 9.959373235702515, 11.33791971206665, 12.723099946975708, 14.109184503555298, 15.47729206085205, 16.855952501296997, 18.232053518295288, 19.61516499519348, 20.980204582214355, 22.365838050842285, 23.7438223361969, 25.111588716506958, 26.481717824935913, 27.860347747802734, 29.224751234054565, 30.595126152038574, 31.954614400863647, 33.306018352508545, 34.67448139190674, 36.04887557029724, 37.407212018966675, 38.76373744010925, 40.12631869316101, 41.48705196380615, 42.84813570976257, 44.23813796043396, 45.5997588634491, 46.968889236450195, 48.30141997337341, 49.66523718833923, 51.02393579483032, 52.38390040397644, 53.74374532699585, 55.118813276290894, 56.49617004394531, 57.857407331466675, 59.23415946960449, 60.59189534187317, 61.95241665840149, 63.32781434059143, 64.6953854560852, 66.07299041748047, 67.4684944152832, 68.85926294326782, 70.25735235214233, 71.6631269454956, 73.05782675743103, 74.42910313606262, 75.7978003025055, 77.16675043106079, 78.53251338005066, 79.89213299751282, 81.26653051376343, 82.63861441612244, 84.0295090675354, 85.41734766960144, 86.82158160209656, 88.2256212234497, 89.62256669998169, 91.03433227539062, 92.43569540977478, 93.83545875549316, 95.23475170135498, 96.632253408432, 98.03732323646545, 99.44051504135132, 100.84324359893799, 102.22914481163025, 103.60085797309875, 104.99970078468323, 106.40031337738037, 107.79630613327026, 109.19249415397644, 110.57393836975098, 111.94449210166931, 113.311354637146, 114.67897701263428, 116.04733037948608, 117.41461491584778, 118.7943811416626, 120.162193775177, 121.530837059021, 122.90068221092224, 124.26724004745483, 125.6288571357727, 127.00099349021912, 128.37370824813843, 129.7503683567047, 131.12861490249634, 132.51335525512695, 133.88753867149353, 135.25723218917847, 136.6265425682068, 138.00364542007446, 139.97936296463013]
[16.88, 29.72, 37.03, 41.19, 44.5, 48.09, 51.5, 53.42, 53.73, 55.85, 56.12, 57.36, 57.49, 57.81, 57.8, 59.1, 59.54, 60.73, 60.55, 60.76, 61.79, 62.72, 61.89, 63.23, 64.01, 64.76, 64.44, 65.07, 65.61, 66.28, 65.93, 66.11, 66.27, 67.51, 67.34, 66.88, 67.01, 67.81, 68.21, 67.98, 67.9, 68.45, 68.81, 68.86, 69.36, 69.95, 69.32, 69.58, 69.64, 69.8, 70.37, 69.93, 70.66, 70.78, 70.69, 70.57, 70.7, 71.22, 71.32, 71.34, 71.61, 71.95, 71.66, 71.17, 71.22, 71.6, 71.75, 72.0, 72.17, 72.31, 71.52, 72.18, 71.73, 72.16, 72.31, 72.5, 72.68, 72.41, 72.6, 72.77, 72.27, 72.76, 73.12, 72.37, 72.56, 72.68, 72.33, 72.79, 73.13, 72.32, 72.58, 72.39, 72.85, 73.29, 72.82, 72.72, 72.91, 73.07, 73.25, 72.89, 73.07]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 17, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.799, Test loss: 2.097, Test accuracy: 24.62
Round   1, Train loss: 1.493, Test loss: 1.845, Test accuracy: 31.62
Round   2, Train loss: 1.249, Test loss: 1.668, Test accuracy: 40.89
Round   3, Train loss: 1.145, Test loss: 1.430, Test accuracy: 45.59
Round   4, Train loss: 1.195, Test loss: 1.285, Test accuracy: 50.39
Round   5, Train loss: 1.149, Test loss: 1.202, Test accuracy: 53.97
Round   6, Train loss: 1.130, Test loss: 1.168, Test accuracy: 54.73
Round   7, Train loss: 1.099, Test loss: 1.126, Test accuracy: 56.17
Round   8, Train loss: 1.047, Test loss: 1.067, Test accuracy: 58.17
Round   9, Train loss: 1.030, Test loss: 1.024, Test accuracy: 60.41
Round  10, Train loss: 1.002, Test loss: 1.025, Test accuracy: 60.09
Round  11, Train loss: 0.825, Test loss: 0.993, Test accuracy: 61.00
Round  12, Train loss: 0.873, Test loss: 0.997, Test accuracy: 61.07
Round  13, Train loss: 0.892, Test loss: 0.964, Test accuracy: 62.13
Round  14, Train loss: 0.825, Test loss: 0.945, Test accuracy: 63.05
Round  15, Train loss: 0.911, Test loss: 0.934, Test accuracy: 63.63
Round  16, Train loss: 0.848, Test loss: 0.932, Test accuracy: 63.65
Round  17, Train loss: 0.828, Test loss: 0.922, Test accuracy: 64.54
Round  18, Train loss: 0.766, Test loss: 0.908, Test accuracy: 65.06
Round  19, Train loss: 0.852, Test loss: 0.907, Test accuracy: 65.28
Round  20, Train loss: 0.782, Test loss: 0.901, Test accuracy: 65.84
Round  21, Train loss: 0.758, Test loss: 0.892, Test accuracy: 66.12
Round  22, Train loss: 0.674, Test loss: 0.882, Test accuracy: 66.45
Round  23, Train loss: 0.700, Test loss: 0.866, Test accuracy: 66.91
Round  24, Train loss: 0.820, Test loss: 0.852, Test accuracy: 67.89
Round  25, Train loss: 0.690, Test loss: 0.860, Test accuracy: 67.87
Round  26, Train loss: 0.617, Test loss: 0.870, Test accuracy: 67.47
Round  27, Train loss: 0.677, Test loss: 0.860, Test accuracy: 67.66
Round  28, Train loss: 0.624, Test loss: 0.830, Test accuracy: 69.31
Round  29, Train loss: 0.661, Test loss: 0.849, Test accuracy: 68.48
Round  30, Train loss: 0.679, Test loss: 0.843, Test accuracy: 68.56
Round  31, Train loss: 0.548, Test loss: 0.851, Test accuracy: 68.36
Round  32, Train loss: 0.665, Test loss: 0.843, Test accuracy: 69.20
Round  33, Train loss: 0.642, Test loss: 0.839, Test accuracy: 69.60
Round  34, Train loss: 0.556, Test loss: 0.834, Test accuracy: 69.58
Round  35, Train loss: 0.623, Test loss: 0.833, Test accuracy: 69.68
Round  36, Train loss: 0.635, Test loss: 0.843, Test accuracy: 69.53
Round  37, Train loss: 0.572, Test loss: 0.826, Test accuracy: 70.04
Round  38, Train loss: 0.538, Test loss: 0.809, Test accuracy: 71.07
Round  39, Train loss: 0.541, Test loss: 0.835, Test accuracy: 70.70
Round  40, Train loss: 0.524, Test loss: 0.839, Test accuracy: 70.07
Round  41, Train loss: 0.586, Test loss: 0.867, Test accuracy: 69.48
Round  42, Train loss: 0.558, Test loss: 0.870, Test accuracy: 69.58
Round  43, Train loss: 0.494, Test loss: 0.847, Test accuracy: 69.92
Round  44, Train loss: 0.548, Test loss: 0.844, Test accuracy: 69.71
Round  45, Train loss: 0.588, Test loss: 0.849, Test accuracy: 70.21
Round  46, Train loss: 0.519, Test loss: 0.844, Test accuracy: 70.76
Round  47, Train loss: 0.521, Test loss: 0.836, Test accuracy: 70.73
Round  48, Train loss: 0.472, Test loss: 0.843, Test accuracy: 70.40
Round  49, Train loss: 0.510, Test loss: 0.837, Test accuracy: 70.99
Round  50, Train loss: 0.501, Test loss: 0.844, Test accuracy: 70.67
Round  51, Train loss: 0.545, Test loss: 0.851, Test accuracy: 71.02
Round  52, Train loss: 0.467, Test loss: 0.869, Test accuracy: 70.48
Round  53, Train loss: 0.496, Test loss: 0.873, Test accuracy: 70.83
Round  54, Train loss: 0.482, Test loss: 0.867, Test accuracy: 70.73
Round  55, Train loss: 0.487, Test loss: 0.876, Test accuracy: 70.32
Round  56, Train loss: 0.473, Test loss: 0.873, Test accuracy: 70.18
Round  57, Train loss: 0.411, Test loss: 0.858, Test accuracy: 70.39
Round  58, Train loss: 0.452, Test loss: 0.825, Test accuracy: 71.43
Round  59, Train loss: 0.422, Test loss: 0.848, Test accuracy: 71.00
Round  60, Train loss: 0.396, Test loss: 0.846, Test accuracy: 70.63
Round  61, Train loss: 0.386, Test loss: 0.841, Test accuracy: 71.09
Round  62, Train loss: 0.438, Test loss: 0.868, Test accuracy: 70.17
Round  63, Train loss: 0.448, Test loss: 0.876, Test accuracy: 70.40
Round  64, Train loss: 0.375, Test loss: 0.872, Test accuracy: 70.86
Round  65, Train loss: 0.329, Test loss: 0.868, Test accuracy: 71.09
Round  66, Train loss: 0.348, Test loss: 0.855, Test accuracy: 70.87
Round  67, Train loss: 0.404, Test loss: 0.867, Test accuracy: 71.33
Round  68, Train loss: 0.431, Test loss: 0.893, Test accuracy: 71.15
Round  69, Train loss: 0.386, Test loss: 0.889, Test accuracy: 70.64
Round  70, Train loss: 0.385, Test loss: 0.857, Test accuracy: 71.43
Round  71, Train loss: 0.338, Test loss: 0.884, Test accuracy: 70.59
Round  72, Train loss: 0.332, Test loss: 0.869, Test accuracy: 70.95
Round  73, Train loss: 0.329, Test loss: 0.871, Test accuracy: 71.42
Round  74, Train loss: 0.422, Test loss: 0.876, Test accuracy: 71.12
Round  75, Train loss: 0.365, Test loss: 0.882, Test accuracy: 70.60
Round  76, Train loss: 0.311, Test loss: 0.874, Test accuracy: 70.94
Round  77, Train loss: 0.329, Test loss: 0.877, Test accuracy: 71.25
Round  78, Train loss: 0.420, Test loss: 0.901, Test accuracy: 70.70
Round  79, Train loss: 0.378, Test loss: 0.873, Test accuracy: 71.25
Round  80, Train loss: 0.315, Test loss: 0.888, Test accuracy: 71.20
Round  81, Train loss: 0.302, Test loss: 0.869, Test accuracy: 71.63
Round  82, Train loss: 0.339, Test loss: 0.903, Test accuracy: 70.84
Round  83, Train loss: 0.341, Test loss: 0.899, Test accuracy: 71.46
Round  84, Train loss: 0.343, Test loss: 0.899, Test accuracy: 71.62
Round  85, Train loss: 0.333, Test loss: 0.917, Test accuracy: 70.58
Round  86, Train loss: 0.276, Test loss: 0.905, Test accuracy: 70.98
Round  87, Train loss: 0.324, Test loss: 0.921, Test accuracy: 70.89
Round  88, Train loss: 0.324, Test loss: 0.884, Test accuracy: 71.09
Round  89, Train loss: 0.270, Test loss: 0.911, Test accuracy: 70.73
Round  90, Train loss: 0.353, Test loss: 0.912, Test accuracy: 70.87
Round  91, Train loss: 0.340, Test loss: 0.921, Test accuracy: 70.91
Round  92, Train loss: 0.304, Test loss: 0.925, Test accuracy: 71.18
Round  93, Train loss: 0.242, Test loss: 0.922, Test accuracy: 70.62
Round  94, Train loss: 0.309, Test loss: 0.946, Test accuracy: 70.29
Round  95, Train loss: 0.312, Test loss: 0.941, Test accuracy: 71.42
Round  96, Train loss: 0.290, Test loss: 0.948, Test accuracy: 70.71
Round  97, Train loss: 0.294, Test loss: 0.933, Test accuracy: 71.30
Round  98, Train loss: 0.317, Test loss: 0.914, Test accuracy: 71.71
Round  99, Train loss: 0.302, Test loss: 0.905, Test accuracy: 71.74
Final Round, Train loss: 0.286, Test loss: 0.916, Test accuracy: 71.94
Average accuracy final 10 rounds: 71.075
2681.365923166275
[3.1205549240112305, 5.959815740585327, 8.78921890258789, 11.623038291931152, 14.447434186935425, 17.243051528930664, 20.051637172698975, 22.837146759033203, 25.63330626487732, 28.459227800369263, 31.28362274169922, 34.10904550552368, 36.93605041503906, 39.766788959503174, 42.564186096191406, 45.381994009017944, 48.201162338256836, 51.00935506820679, 53.82982087135315, 56.65013527870178, 59.46816039085388, 63.819361448287964, 68.1688175201416, 72.46422863006592, 76.75564575195312, 81.06962633132935, 85.41655468940735, 89.78946566581726, 94.12606287002563, 98.47613549232483, 102.77045345306396, 107.09322309494019, 111.39856386184692, 115.646892786026, 119.92244291305542, 124.2657618522644, 128.5186185836792, 132.85131740570068, 137.0802366733551, 141.29666662216187, 145.5393304824829, 149.8085434436798, 154.09792184829712, 158.3837263584137, 162.6969277858734, 166.9764130115509, 171.26292967796326, 175.59092903137207, 179.79955410957336, 184.01315212249756, 188.20564222335815, 192.35049533843994, 196.59923124313354, 200.84868478775024, 205.12929773330688, 209.36497569084167, 213.6944079399109, 218.0587296485901, 222.34000396728516, 226.70247387886047, 231.05388188362122, 235.37976503372192, 239.66073346138, 243.96898245811462, 248.31879949569702, 252.6586093902588, 256.99331974983215, 261.3261754512787, 265.6769666671753, 270.0176365375519, 274.34183263778687, 278.66374230384827, 282.9715609550476, 287.28758478164673, 291.624365568161, 295.950838804245, 300.3330588340759, 304.6698179244995, 309.0211892127991, 313.3579659461975, 317.69615626335144, 322.0420596599579, 326.387375831604, 330.76148104667664, 335.1096816062927, 339.46160078048706, 343.8033986091614, 348.15838074684143, 352.48831844329834, 356.8261089324951, 361.1517016887665, 365.4810767173767, 369.8292715549469, 374.18578815460205, 378.53623151779175, 382.8651900291443, 387.20225071907043, 391.5481617450714, 395.9433739185333, 400.28799629211426, 404.2873582839966]
[24.62, 31.62, 40.89, 45.59, 50.39, 53.97, 54.73, 56.17, 58.17, 60.41, 60.09, 61.0, 61.07, 62.13, 63.05, 63.63, 63.65, 64.54, 65.06, 65.28, 65.84, 66.12, 66.45, 66.91, 67.89, 67.87, 67.47, 67.66, 69.31, 68.48, 68.56, 68.36, 69.2, 69.6, 69.58, 69.68, 69.53, 70.04, 71.07, 70.7, 70.07, 69.48, 69.58, 69.92, 69.71, 70.21, 70.76, 70.73, 70.4, 70.99, 70.67, 71.02, 70.48, 70.83, 70.73, 70.32, 70.18, 70.39, 71.43, 71.0, 70.63, 71.09, 70.17, 70.4, 70.86, 71.09, 70.87, 71.33, 71.15, 70.64, 71.43, 70.59, 70.95, 71.42, 71.12, 70.6, 70.94, 71.25, 70.7, 71.25, 71.2, 71.63, 70.84, 71.46, 71.62, 70.58, 70.98, 70.89, 71.09, 70.73, 70.87, 70.91, 71.18, 70.62, 70.29, 71.42, 70.71, 71.3, 71.71, 71.74, 71.94]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: none, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 16, noise    level: 0.8000 
   Client 2, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 8, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 11, noise    level: 0.8000 
   Client 19, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 9, noise    level: 0.8000 
   Client 10, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.780, Test loss: 1.757, Test accuracy: 33.07
Round   1, Train loss: 1.462, Test loss: 1.420, Test accuracy: 43.58
Round   2, Train loss: 1.303, Test loss: 1.283, Test accuracy: 49.43
Round   3, Train loss: 1.215, Test loss: 1.194, Test accuracy: 52.91
Round   4, Train loss: 1.163, Test loss: 1.144, Test accuracy: 54.92
Round   5, Train loss: 1.119, Test loss: 1.103, Test accuracy: 56.86
Round   6, Train loss: 1.088, Test loss: 1.083, Test accuracy: 57.43
Round   7, Train loss: 1.057, Test loss: 1.055, Test accuracy: 58.95
Round   8, Train loss: 1.029, Test loss: 1.057, Test accuracy: 58.29
Round   9, Train loss: 1.002, Test loss: 1.025, Test accuracy: 60.18
Round  10, Train loss: 0.980, Test loss: 1.012, Test accuracy: 61.13
Round  11, Train loss: 0.952, Test loss: 0.979, Test accuracy: 62.31
Round  12, Train loss: 0.929, Test loss: 0.956, Test accuracy: 63.18
Round  13, Train loss: 0.906, Test loss: 0.955, Test accuracy: 63.77
Round  14, Train loss: 0.884, Test loss: 0.940, Test accuracy: 64.20
Round  15, Train loss: 0.860, Test loss: 0.920, Test accuracy: 64.99
Round  16, Train loss: 0.846, Test loss: 0.921, Test accuracy: 64.97
Round  17, Train loss: 0.824, Test loss: 0.906, Test accuracy: 65.98
Round  18, Train loss: 0.806, Test loss: 0.906, Test accuracy: 65.98
Round  19, Train loss: 0.789, Test loss: 0.910, Test accuracy: 65.83
Round  20, Train loss: 0.894, Test loss: 0.918, Test accuracy: 66.22
Round  21, Train loss: 0.879, Test loss: 0.918, Test accuracy: 65.61
Round  22, Train loss: 0.714, Test loss: 0.910, Test accuracy: 66.22
Round  23, Train loss: 0.734, Test loss: 0.895, Test accuracy: 66.69
Round  24, Train loss: 0.804, Test loss: 0.881, Test accuracy: 67.76
Round  25, Train loss: 0.746, Test loss: 0.890, Test accuracy: 67.59
Round  26, Train loss: 0.744, Test loss: 0.894, Test accuracy: 68.27
Round  27, Train loss: 0.648, Test loss: 0.892, Test accuracy: 67.61
Round  28, Train loss: 0.648, Test loss: 0.864, Test accuracy: 68.50
Round  29, Train loss: 0.566, Test loss: 0.882, Test accuracy: 67.74
Round  30, Train loss: 0.548, Test loss: 0.872, Test accuracy: 68.19
Round  31, Train loss: 0.626, Test loss: 0.873, Test accuracy: 68.07
Round  32, Train loss: 0.595, Test loss: 0.866, Test accuracy: 68.21
Round  33, Train loss: 0.599, Test loss: 0.887, Test accuracy: 67.98
Round  34, Train loss: 0.551, Test loss: 0.883, Test accuracy: 68.46
Round  35, Train loss: 0.492, Test loss: 0.872, Test accuracy: 68.59
Round  36, Train loss: 0.637, Test loss: 0.861, Test accuracy: 69.57
Round  37, Train loss: 0.585, Test loss: 0.858, Test accuracy: 69.67
Round  38, Train loss: 0.660, Test loss: 0.861, Test accuracy: 69.01
Round  39, Train loss: 0.550, Test loss: 0.874, Test accuracy: 69.42
Round  40, Train loss: 0.549, Test loss: 0.882, Test accuracy: 69.09
Round  41, Train loss: 0.604, Test loss: 0.877, Test accuracy: 69.27
Round  42, Train loss: 0.507, Test loss: 0.873, Test accuracy: 69.80
Round  43, Train loss: 0.593, Test loss: 0.889, Test accuracy: 69.27
Round  44, Train loss: 0.627, Test loss: 0.900, Test accuracy: 69.04
Round  45, Train loss: 0.627, Test loss: 0.893, Test accuracy: 69.57
Round  46, Train loss: 0.528, Test loss: 0.868, Test accuracy: 69.94
Round  47, Train loss: 0.465, Test loss: 0.882, Test accuracy: 70.07
Round  48, Train loss: 0.523, Test loss: 0.914, Test accuracy: 68.77
Round  49, Train loss: 0.521, Test loss: 0.903, Test accuracy: 69.00
Round  50, Train loss: 0.631, Test loss: 0.913, Test accuracy: 69.22
Round  51, Train loss: 0.495, Test loss: 0.903, Test accuracy: 69.19
Round  52, Train loss: 0.426, Test loss: 0.906, Test accuracy: 69.08
Round  53, Train loss: 0.559, Test loss: 0.902, Test accuracy: 69.14
Round  54, Train loss: 0.607, Test loss: 0.913, Test accuracy: 69.12
Round  55, Train loss: 0.512, Test loss: 0.916, Test accuracy: 68.58
Round  56, Train loss: 0.482, Test loss: 0.917, Test accuracy: 69.11
Round  57, Train loss: 0.459, Test loss: 0.917, Test accuracy: 69.07
Round  58, Train loss: 0.445, Test loss: 0.900, Test accuracy: 69.70
Round  59, Train loss: 0.388, Test loss: 0.894, Test accuracy: 69.65
Round  60, Train loss: 0.407, Test loss: 0.893, Test accuracy: 70.02
Round  61, Train loss: 0.419, Test loss: 0.914, Test accuracy: 69.90
Round  62, Train loss: 0.412, Test loss: 0.926, Test accuracy: 69.71
Round  63, Train loss: 0.361, Test loss: 0.909, Test accuracy: 69.58
Round  64, Train loss: 0.364, Test loss: 0.923, Test accuracy: 69.35
Round  65, Train loss: 0.383, Test loss: 0.915, Test accuracy: 69.93
Round  66, Train loss: 0.433, Test loss: 0.913, Test accuracy: 69.42
Round  67, Train loss: 0.495, Test loss: 0.935, Test accuracy: 69.21
Round  68, Train loss: 0.441, Test loss: 0.966, Test accuracy: 69.01
Round  69, Train loss: 0.472, Test loss: 0.930, Test accuracy: 69.38
Round  70, Train loss: 0.388, Test loss: 0.926, Test accuracy: 69.26
Round  71, Train loss: 0.365, Test loss: 0.942, Test accuracy: 69.06
Round  72, Train loss: 0.332, Test loss: 0.934, Test accuracy: 69.34
Round  73, Train loss: 0.315, Test loss: 0.949, Test accuracy: 69.64
Round  74, Train loss: 0.352, Test loss: 0.950, Test accuracy: 69.55
Round  75, Train loss: 0.446, Test loss: 0.943, Test accuracy: 69.75
Round  76, Train loss: 0.287, Test loss: 0.926, Test accuracy: 70.32
Round  77, Train loss: 0.408, Test loss: 0.939, Test accuracy: 69.89
Round  78, Train loss: 0.392, Test loss: 0.922, Test accuracy: 70.15
Round  79, Train loss: 0.386, Test loss: 0.930, Test accuracy: 70.20
Round  80, Train loss: 0.367, Test loss: 0.947, Test accuracy: 69.87
Round  81, Train loss: 0.351, Test loss: 0.940, Test accuracy: 69.59
Round  82, Train loss: 0.344, Test loss: 0.950, Test accuracy: 69.98
Round  83, Train loss: 0.341, Test loss: 0.951, Test accuracy: 69.94
Round  84, Train loss: 0.337, Test loss: 0.938, Test accuracy: 70.48
Round  85, Train loss: 0.327, Test loss: 0.945, Test accuracy: 70.16
Round  86, Train loss: 0.322, Test loss: 0.940, Test accuracy: 70.63
Round  87, Train loss: 0.320, Test loss: 0.970, Test accuracy: 69.89
Round  88, Train loss: 0.321, Test loss: 0.971, Test accuracy: 70.10
Round  89, Train loss: 0.315, Test loss: 0.960, Test accuracy: 70.07
Round  90, Train loss: 0.315, Test loss: 0.968, Test accuracy: 69.68
Round  91, Train loss: 0.310, Test loss: 0.964, Test accuracy: 70.30
Round  92, Train loss: 0.308, Test loss: 0.982, Test accuracy: 69.91
Round  93, Train loss: 0.307, Test loss: 0.995, Test accuracy: 69.53
Round  94, Train loss: 0.299, Test loss: 0.995, Test accuracy: 69.76
Round  95, Train loss: 0.301, Test loss: 0.982, Test accuracy: 70.16
Round  96, Train loss: 0.299, Test loss: 0.989, Test accuracy: 69.61
Round  97, Train loss: 0.301, Test loss: 0.993, Test accuracy: 69.96
Round  98, Train loss: 0.294, Test loss: 0.998, Test accuracy: 69.64
Round  99, Train loss: 0.289, Test loss: 0.997, Test accuracy: 70.04
Final Round, Train loss: 0.264, Test loss: 1.004, Test accuracy: 70.13
Average accuracy final 10 rounds: 69.859
3114.168415784836
[3.1799874305725098, 6.026942253112793, 8.847047090530396, 11.666657209396362, 14.498510360717773, 17.332717418670654, 20.180744886398315, 23.020312309265137, 25.853483200073242, 28.675628662109375, 31.513540029525757, 34.334253787994385, 37.16991400718689, 40.004202127456665, 42.84742331504822, 45.68709373474121, 48.513370513916016, 51.32960796356201, 53.93113088607788, 56.18538570404053, 58.43338990211487, 60.68101358413696, 62.93029546737671, 65.1841070652008, 67.43266487121582, 69.68219423294067, 71.93212795257568, 74.18568181991577, 76.43436217308044, 78.68539428710938, 80.9341790676117, 83.18148851394653, 85.43280935287476, 87.6885244846344, 89.93646478652954, 92.19200301170349, 94.44586157798767, 96.7005934715271, 98.95535612106323, 101.21195483207703, 103.46774888038635, 105.72072958946228, 107.9742317199707, 110.22766184806824, 112.48149728775024, 114.73587918281555, 116.98710703849792, 119.23985147476196, 121.49531483650208, 123.74929714202881, 126.00254893302917, 128.276047706604, 130.5486662387848, 132.80143857002258, 135.05615329742432, 137.30743193626404, 139.55946922302246, 141.81543111801147, 144.06762170791626, 146.32169914245605, 148.57593870162964, 150.83177661895752, 153.10489225387573, 155.3749077320099, 157.65099835395813, 159.92412567138672, 162.1912112236023, 164.4585475921631, 166.72437524795532, 168.9901990890503, 171.25838661193848, 173.53147840499878, 175.80423259735107, 178.07819294929504, 180.35309624671936, 182.6258509159088, 184.89999198913574, 187.17554211616516, 189.44961857795715, 191.71626043319702, 193.98760652542114, 196.2610433101654, 198.529212474823, 200.80193638801575, 203.07661986351013, 205.3487470149994, 207.62213230133057, 209.8935203552246, 212.16778898239136, 214.4406430721283, 216.71338987350464, 218.98605728149414, 221.25960063934326, 223.53153467178345, 225.79959535598755, 228.07113766670227, 230.34341263771057, 232.61124658584595, 234.8823082447052, 237.15656566619873, 240.88438653945923]
[33.07, 43.58, 49.43, 52.91, 54.92, 56.86, 57.43, 58.95, 58.29, 60.18, 61.13, 62.31, 63.18, 63.77, 64.2, 64.99, 64.97, 65.98, 65.98, 65.83, 66.22, 65.61, 66.22, 66.69, 67.76, 67.59, 68.27, 67.61, 68.5, 67.74, 68.19, 68.07, 68.21, 67.98, 68.46, 68.59, 69.57, 69.67, 69.01, 69.42, 69.09, 69.27, 69.8, 69.27, 69.04, 69.57, 69.94, 70.07, 68.77, 69.0, 69.22, 69.19, 69.08, 69.14, 69.12, 68.58, 69.11, 69.07, 69.7, 69.65, 70.02, 69.9, 69.71, 69.58, 69.35, 69.93, 69.42, 69.21, 69.01, 69.38, 69.26, 69.06, 69.34, 69.64, 69.55, 69.75, 70.32, 69.89, 70.15, 70.2, 69.87, 69.59, 69.98, 69.94, 70.48, 70.16, 70.63, 69.89, 70.1, 70.07, 69.68, 70.3, 69.91, 69.53, 69.76, 70.16, 69.61, 69.96, 69.64, 70.04, 70.13]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%FedPAC_PSL%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedrep , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 0, is_concept_shift: 0, dataset: cifar10,  filter_alg: loss_psl, level_n_system: 0.6 , level_n_lowerb:0.8  

Files already downloaded and verified
Files already downloaded and verified
   Client 1, noise    level: 0.8000 
   Client 7, noise    level: 0.8000 
   Client 5, noise    level: 0.8000 
   Client 15, noise    level: 0.8000 
   Client 16, noise    level: 0.8000 
   Client 18, noise    level: 0.8000 
   Client 3, noise    level: 0.8000 
   Client 0, noise    level: 0.8000 
   Client 12, noise    level: 0.8000 
   Client 4, noise    level: 0.8000 
   Client 13, noise    level: 0.8000 
   Client 6, noise    level: 0.8000 
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
['fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'conv2.weight', 'conv2.bias', 'conv1.weight', 'conv1.bias']
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
# Params: 307842 (local), 307192 (global); Percentage 99.79 (307192/307842)
learning rate, batch size: 0.01, 10
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
Round   0, Train loss: 1.783, Test loss: 1.791, Test accuracy: 27.91
Round   1, Train loss: 1.485, Test loss: 1.456, Test accuracy: 43.41
Round   2, Train loss: 1.332, Test loss: 1.317, Test accuracy: 48.23
Round   3, Train loss: 1.250, Test loss: 1.239, Test accuracy: 51.13
Round   4, Train loss: 1.196, Test loss: 1.179, Test accuracy: 54.26
Round   5, Train loss: 1.153, Test loss: 1.147, Test accuracy: 55.36
Round   6, Train loss: 1.121, Test loss: 1.115, Test accuracy: 56.83
Round   7, Train loss: 1.089, Test loss: 1.081, Test accuracy: 58.59
Round   8, Train loss: 1.062, Test loss: 1.068, Test accuracy: 59.40
Round   9, Train loss: 1.032, Test loss: 1.053, Test accuracy: 59.89
Round  10, Train loss: 1.006, Test loss: 1.043, Test accuracy: 60.52
Round  11, Train loss: 0.977, Test loss: 1.022, Test accuracy: 61.43
Round  12, Train loss: 0.953, Test loss: 1.011, Test accuracy: 62.05
Round  13, Train loss: 0.932, Test loss: 0.992, Test accuracy: 63.03
Round  14, Train loss: 0.910, Test loss: 0.990, Test accuracy: 63.10
Round  15, Train loss: 0.890, Test loss: 0.961, Test accuracy: 64.64
Round  16, Train loss: 0.872, Test loss: 0.960, Test accuracy: 64.37
Round  17, Train loss: 0.852, Test loss: 0.955, Test accuracy: 64.57
Round  18, Train loss: 0.830, Test loss: 0.954, Test accuracy: 65.00
Round  19, Train loss: 0.813, Test loss: 0.942, Test accuracy: 65.17
Round  20, Train loss: 0.899, Test loss: 0.937, Test accuracy: 65.92
Round  21, Train loss: 0.853, Test loss: 0.959, Test accuracy: 64.61
Round  22, Train loss: 0.721, Test loss: 0.954, Test accuracy: 64.65
Round  23, Train loss: 0.757, Test loss: 0.958, Test accuracy: 65.14
Round  24, Train loss: 0.901, Test loss: 0.950, Test accuracy: 65.19
Round  25, Train loss: 0.789, Test loss: 0.943, Test accuracy: 65.81
Round  26, Train loss: 0.707, Test loss: 0.934, Test accuracy: 66.43
Round  27, Train loss: 0.618, Test loss: 0.944, Test accuracy: 65.58
Round  28, Train loss: 0.619, Test loss: 0.913, Test accuracy: 66.62
Round  29, Train loss: 0.616, Test loss: 0.927, Test accuracy: 66.54
Round  30, Train loss: 0.633, Test loss: 0.931, Test accuracy: 66.64
Round  31, Train loss: 0.582, Test loss: 0.919, Test accuracy: 66.79
Round  32, Train loss: 0.581, Test loss: 0.916, Test accuracy: 67.17
Round  33, Train loss: 0.671, Test loss: 0.923, Test accuracy: 67.57
Round  34, Train loss: 0.622, Test loss: 0.938, Test accuracy: 66.62
Round  35, Train loss: 0.485, Test loss: 0.915, Test accuracy: 67.52
Round  36, Train loss: 0.679, Test loss: 0.909, Test accuracy: 67.54
Round  37, Train loss: 0.547, Test loss: 0.941, Test accuracy: 67.10
Round  38, Train loss: 0.754, Test loss: 0.930, Test accuracy: 67.63
Round  39, Train loss: 0.520, Test loss: 0.923, Test accuracy: 67.16
Round  40, Train loss: 0.518, Test loss: 0.942, Test accuracy: 67.14
Round  41, Train loss: 0.586, Test loss: 0.947, Test accuracy: 67.04
Round  42, Train loss: 0.540, Test loss: 0.960, Test accuracy: 66.57
Round  43, Train loss: 0.576, Test loss: 0.950, Test accuracy: 66.69
Round  44, Train loss: 0.679, Test loss: 0.953, Test accuracy: 66.92
Round  45, Train loss: 0.629, Test loss: 0.956, Test accuracy: 66.76
Round  46, Train loss: 0.562, Test loss: 0.945, Test accuracy: 67.04
Round  47, Train loss: 0.473, Test loss: 0.928, Test accuracy: 67.39
Round  48, Train loss: 0.529, Test loss: 0.941, Test accuracy: 67.49
Round  49, Train loss: 0.539, Test loss: 0.953, Test accuracy: 67.02
Round  50, Train loss: 0.640, Test loss: 0.969, Test accuracy: 66.89
Round  51, Train loss: 0.568, Test loss: 0.933, Test accuracy: 67.98
Round  52, Train loss: 0.561, Test loss: 0.962, Test accuracy: 67.15
Round  53, Train loss: 0.570, Test loss: 0.964, Test accuracy: 67.39
Round  54, Train loss: 0.585, Test loss: 0.965, Test accuracy: 67.33
Round  55, Train loss: 0.570, Test loss: 0.978, Test accuracy: 67.17
Round  56, Train loss: 0.493, Test loss: 0.976, Test accuracy: 67.00
Round  57, Train loss: 0.516, Test loss: 0.980, Test accuracy: 67.03
Round  58, Train loss: 0.504, Test loss: 0.994, Test accuracy: 67.22
Round  59, Train loss: 0.442, Test loss: 0.995, Test accuracy: 67.34
Round  60, Train loss: 0.417, Test loss: 1.022, Test accuracy: 66.42
Round  61, Train loss: 0.471, Test loss: 0.994, Test accuracy: 67.04
Round  62, Train loss: 0.443, Test loss: 0.977, Test accuracy: 67.85
Round  63, Train loss: 0.395, Test loss: 0.944, Test accuracy: 68.31
Round  64, Train loss: 0.372, Test loss: 0.946, Test accuracy: 68.39
Round  65, Train loss: 0.482, Test loss: 0.975, Test accuracy: 68.35
Round  66, Train loss: 0.420, Test loss: 0.987, Test accuracy: 67.75
Round  67, Train loss: 0.569, Test loss: 1.017, Test accuracy: 67.52
Round  68, Train loss: 0.461, Test loss: 1.036, Test accuracy: 66.72
Round  69, Train loss: 0.504, Test loss: 1.008, Test accuracy: 67.39
Round  70, Train loss: 0.408, Test loss: 0.987, Test accuracy: 67.77
Round  71, Train loss: 0.423, Test loss: 0.999, Test accuracy: 67.71
Round  72, Train loss: 0.359, Test loss: 0.973, Test accuracy: 68.10
Round  73, Train loss: 0.289, Test loss: 0.970, Test accuracy: 68.61
Round  74, Train loss: 0.368, Test loss: 1.009, Test accuracy: 67.18
Round  75, Train loss: 0.430, Test loss: 1.005, Test accuracy: 67.42
Round  76, Train loss: 0.403, Test loss: 1.003, Test accuracy: 67.70
Round  77, Train loss: 0.427, Test loss: 1.030, Test accuracy: 66.96
Round  78, Train loss: 0.425, Test loss: 0.996, Test accuracy: 67.49
Round  79, Train loss: 0.402, Test loss: 1.020, Test accuracy: 67.59
Round  80, Train loss: 0.390, Test loss: 0.994, Test accuracy: 68.01
Round  81, Train loss: 0.366, Test loss: 1.015, Test accuracy: 67.46
Round  82, Train loss: 0.362, Test loss: 1.022, Test accuracy: 67.37
Round  83, Train loss: 0.356, Test loss: 1.017, Test accuracy: 67.85
Round  84, Train loss: 0.355, Test loss: 1.015, Test accuracy: 68.01
Round  85, Train loss: 0.351, Test loss: 1.002, Test accuracy: 68.54
Round  86, Train loss: 0.342, Test loss: 1.025, Test accuracy: 68.22
Round  87, Train loss: 0.340, Test loss: 1.021, Test accuracy: 67.98
Round  88, Train loss: 0.334, Test loss: 1.032, Test accuracy: 67.98
Round  89, Train loss: 0.337, Test loss: 1.044, Test accuracy: 67.71
Round  90, Train loss: 0.333, Test loss: 1.034, Test accuracy: 67.86
Round  91, Train loss: 0.328, Test loss: 1.062, Test accuracy: 67.14
Round  92, Train loss: 0.326, Test loss: 1.060, Test accuracy: 67.09
Round  93, Train loss: 0.316, Test loss: 1.025, Test accuracy: 67.80
Round  94, Train loss: 0.320, Test loss: 1.055, Test accuracy: 67.41
Round  95, Train loss: 0.319, Test loss: 1.079, Test accuracy: 67.30
Round  96, Train loss: 0.314, Test loss: 1.053, Test accuracy: 67.94
Round  97, Train loss: 0.311, Test loss: 1.086, Test accuracy: 67.01
Round  98, Train loss: 0.305, Test loss: 1.060, Test accuracy: 67.65
Round  99, Train loss: 0.313, Test loss: 1.066, Test accuracy: 67.60
Final Round, Train loss: 0.274, Test loss: 1.066, Test accuracy: 67.92
Average accuracy final 10 rounds: 67.47999999999999
4029.5925641059875
[2.863262414932251, 5.38876485824585, 7.918128252029419, 10.444021224975586, 12.703385591506958, 14.963043212890625, 17.214504718780518, 19.468055486679077, 21.72061252593994, 23.97288465499878, 26.2236487865448, 28.481030225753784, 30.732165813446045, 32.983460426330566, 35.23154306411743, 37.484397649765015, 39.732263803482056, 41.989093542099, 44.23848605155945, 46.49557685852051, 48.7448513507843, 52.506824254989624, 56.2625949382782, 60.02045774459839, 63.76298666000366, 67.5147111415863, 71.2668993473053, 75.0151526927948, 78.7723126411438, 82.53152370452881, 86.28906893730164, 90.04315519332886, 93.86300778388977, 97.62762546539307, 101.39407873153687, 105.15200591087341, 108.9143328666687, 112.66920638084412, 116.42332100868225, 120.16596698760986, 123.91368269920349, 127.66285634040833, 131.41738414764404, 135.16195797920227, 138.91010427474976, 142.6699571609497, 146.42127561569214, 150.16942858695984, 153.91861963272095, 157.67105340957642, 161.41937017440796, 165.17188024520874, 168.93073630332947, 172.67816185951233, 176.43467259407043, 180.23815870285034, 183.9862413406372, 187.74560165405273, 191.5048484802246, 195.25472855567932, 199.00418090820312, 202.75041580200195, 206.5008521080017, 210.25195693969727, 214.00540256500244, 217.7551233768463, 221.504789352417, 225.21451139450073, 228.97022247314453, 232.7253439426422, 236.4349319934845, 240.14667177200317, 243.857351064682, 247.57536506652832, 251.33054614067078, 255.09556579589844, 258.8437752723694, 262.5974006652832, 266.35070991516113, 270.10515117645264, 273.8592565059662, 277.6833508014679, 281.41617465019226, 285.1454532146454, 288.8882167339325, 292.6072609424591, 296.3987464904785, 300.1250419616699, 303.854257106781, 307.60999488830566, 311.35884857177734, 315.08366346359253, 318.81341767311096, 322.5918827056885, 326.3230514526367, 330.0682466030121, 333.8292078971863, 337.5917019844055, 341.3422567844391, 345.130558013916, 348.87462425231934]
[27.91, 43.41, 48.23, 51.13, 54.26, 55.36, 56.83, 58.59, 59.4, 59.89, 60.52, 61.43, 62.05, 63.03, 63.1, 64.64, 64.37, 64.57, 65.0, 65.17, 65.92, 64.61, 64.65, 65.14, 65.19, 65.81, 66.43, 65.58, 66.62, 66.54, 66.64, 66.79, 67.17, 67.57, 66.62, 67.52, 67.54, 67.1, 67.63, 67.16, 67.14, 67.04, 66.57, 66.69, 66.92, 66.76, 67.04, 67.39, 67.49, 67.02, 66.89, 67.98, 67.15, 67.39, 67.33, 67.17, 67.0, 67.03, 67.22, 67.34, 66.42, 67.04, 67.85, 68.31, 68.39, 68.35, 67.75, 67.52, 66.72, 67.39, 67.77, 67.71, 68.1, 68.61, 67.18, 67.42, 67.7, 66.96, 67.49, 67.59, 68.01, 67.46, 67.37, 67.85, 68.01, 68.54, 68.22, 67.98, 67.98, 67.71, 67.86, 67.14, 67.09, 67.8, 67.41, 67.3, 67.94, 67.01, 67.65, 67.6, 67.92]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  fedavg  local_only:1   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

# alg: fedavg , epochs: 100, shard_per_user: 5, limit_local_output: 0, local_rep_ep: 3 , local_only: 1, is_concept_shift: 0, dataset: cifar10, level_n_system: 0.8 , level_n_lowerb:0.4  

Files already downloaded and verified
Files already downloaded and verified
   Client 6, noise    level: 0.4000 
   Client 12, noise    level: 0.4000 
   Client 14, noise    level: 0.4000 
   Client 9, noise    level: 0.4000 
   Client 17, noise    level: 0.4000 
   Client 5, noise    level: 0.4000 
   Client 10, noise    level: 0.4000 
   Client 2, noise    level: 0.4000 
   Client 11, noise    level: 0.4000 
   Client 8, noise    level: 0.4000 
   Client 19, noise    level: 0.4000 
   Client 18, noise    level: 0.4000 
   Client 4, noise    level: 0.4000 
   Client 1, noise    level: 0.4000 
   Client 16, noise    level: 0.4000 
   Client 15, noise    level: 0.4000 
fedavg
CNNCifar(
  (conv1): Conv2d(3, 64, kernel_size=(5, 5), stride=(1, 1))
  (pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  (conv2): Conv2d(64, 64, kernel_size=(5, 5), stride=(1, 1))
  (fc1): Linear(in_features=1600, out_features=120, bias=True)
  (fc2): Linear(in_features=120, out_features=64, bias=True)
  (fc3): Linear(in_features=64, out_features=10, bias=True)
)
odict_keys(['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias'])
10
[]
['conv1.weight', 'conv1.bias', 'conv2.weight', 'conv2.bias', 'fc1.weight', 'fc1.bias', 'fc2.weight', 'fc2.bias', 'fc3.weight', 'fc3.bias']
learning rate, batch size: 0.01, 10 

Round   0, Train loss: 1.760, Test loss: 2.158, Test accuracy: 16.23
Round   0, Global train loss: 1.760, Global test loss: 2.312, Global test accuracy: 14.00
Round   1, Train loss: 1.627, Test loss: 1.977, Test accuracy: 24.07
Round   1, Global train loss: 1.627, Global test loss: 2.266, Global test accuracy: 20.66
Round   2, Train loss: 1.649, Test loss: 1.659, Test accuracy: 32.60
Round   2, Global train loss: 1.649, Global test loss: 2.078, Global test accuracy: 25.44
Round   3, Train loss: 1.563, Test loss: 1.570, Test accuracy: 36.91
Round   3, Global train loss: 1.563, Global test loss: 2.106, Global test accuracy: 24.18
Round   4, Train loss: 1.515, Test loss: 1.484, Test accuracy: 38.13
Round   4, Global train loss: 1.515, Global test loss: 2.202, Global test accuracy: 21.35
Round   5, Train loss: 1.561, Test loss: 1.503, Test accuracy: 38.82
Round   5, Global train loss: 1.561, Global test loss: 2.213, Global test accuracy: 20.37
Round   6, Train loss: 1.522, Test loss: 1.420, Test accuracy: 41.70
Round   6, Global train loss: 1.522, Global test loss: 2.167, Global test accuracy: 21.09
Round   7, Train loss: 1.493, Test loss: 1.411, Test accuracy: 42.18
Round   7, Global train loss: 1.493, Global test loss: 2.188, Global test accuracy: 21.97
Round   8, Train loss: 1.389, Test loss: 1.396, Test accuracy: 43.11
Round   8, Global train loss: 1.389, Global test loss: 2.020, Global test accuracy: 25.20
Round   9, Train loss: 1.502, Test loss: 1.379, Test accuracy: 44.18
Round   9, Global train loss: 1.502, Global test loss: 2.170, Global test accuracy: 22.41
Round  10, Train loss: 1.405, Test loss: 1.366, Test accuracy: 45.30
Round  10, Global train loss: 1.405, Global test loss: 2.050, Global test accuracy: 26.71
Round  11, Train loss: 1.418, Test loss: 1.354, Test accuracy: 45.26
Round  11, Global train loss: 1.418, Global test loss: 2.088, Global test accuracy: 23.77
Round  12, Train loss: 1.294, Test loss: 1.362, Test accuracy: 46.05
Round  12, Global train loss: 1.294, Global test loss: 2.170, Global test accuracy: 22.97
Round  13, Train loss: 1.483, Test loss: 1.288, Test accuracy: 48.85
Round  13, Global train loss: 1.483, Global test loss: 2.140, Global test accuracy: 21.58
Round  14, Train loss: 1.289, Test loss: 1.286, Test accuracy: 48.66
Round  14, Global train loss: 1.289, Global test loss: 2.163, Global test accuracy: 22.54
Round  15, Train loss: 1.333, Test loss: 1.287, Test accuracy: 48.20
Round  15, Global train loss: 1.333, Global test loss: 2.153, Global test accuracy: 21.40
Round  16, Train loss: 1.351, Test loss: 1.278, Test accuracy: 49.16
Round  16, Global train loss: 1.351, Global test loss: 2.097, Global test accuracy: 19.44
Round  17, Train loss: 1.364, Test loss: 1.264, Test accuracy: 50.25
Round  17, Global train loss: 1.364, Global test loss: 2.125, Global test accuracy: 22.44
Round  18, Train loss: 1.395, Test loss: 1.262, Test accuracy: 50.08
Round  18, Global train loss: 1.395, Global test loss: 2.155, Global test accuracy: 16.64
Round  19, Train loss: 1.162, Test loss: 1.260, Test accuracy: 50.64
Round  19, Global train loss: 1.162, Global test loss: 1.966, Global test accuracy: 31.05
Round  20, Train loss: 1.321, Test loss: 1.254, Test accuracy: 50.70
Round  20, Global train loss: 1.321, Global test loss: 2.197, Global test accuracy: 22.46
Round  21, Train loss: 1.262, Test loss: 1.248, Test accuracy: 51.14
Round  21, Global train loss: 1.262, Global test loss: 2.054, Global test accuracy: 23.25
Round  22, Train loss: 1.243, Test loss: 1.241, Test accuracy: 51.20
Round  22, Global train loss: 1.243, Global test loss: 2.045, Global test accuracy: 25.43
Round  23, Train loss: 1.186, Test loss: 1.235, Test accuracy: 51.45
Round  23, Global train loss: 1.186, Global test loss: 2.061, Global test accuracy: 25.37
Round  24, Train loss: 1.188, Test loss: 1.236, Test accuracy: 51.34
Round  24, Global train loss: 1.188, Global test loss: 2.058, Global test accuracy: 28.52
Round  25, Train loss: 1.165, Test loss: 1.262, Test accuracy: 50.79
Round  25, Global train loss: 1.165, Global test loss: 2.008, Global test accuracy: 31.11
Round  26, Train loss: 1.218, Test loss: 1.274, Test accuracy: 50.23
Round  26, Global train loss: 1.218, Global test loss: 2.074, Global test accuracy: 28.04
Round  27, Train loss: 1.326, Test loss: 1.267, Test accuracy: 50.84
Round  27, Global train loss: 1.326, Global test loss: 2.013, Global test accuracy: 28.23
Round  28, Train loss: 1.023, Test loss: 1.274, Test accuracy: 50.59
Round  28, Global train loss: 1.023, Global test loss: 2.070, Global test accuracy: 24.72
Round  29, Train loss: 1.223, Test loss: 1.288, Test accuracy: 50.60
Round  29, Global train loss: 1.223, Global test loss: 2.014, Global test accuracy: 30.82
Round  30, Train loss: 1.037, Test loss: 1.285, Test accuracy: 50.50
Round  30, Global train loss: 1.037, Global test loss: 2.028, Global test accuracy: 25.84
Round  31, Train loss: 0.952, Test loss: 1.302, Test accuracy: 50.79
Round  31, Global train loss: 0.952, Global test loss: 1.988, Global test accuracy: 26.39
Round  32, Train loss: 1.000, Test loss: 1.309, Test accuracy: 51.06
Round  32, Global train loss: 1.000, Global test loss: 2.032, Global test accuracy: 21.83
Round  33, Train loss: 1.098, Test loss: 1.325, Test accuracy: 50.97
Round  33, Global train loss: 1.098, Global test loss: 2.109, Global test accuracy: 27.65
Round  34, Train loss: 0.905, Test loss: 1.317, Test accuracy: 51.13
Round  34, Global train loss: 0.905, Global test loss: 2.036, Global test accuracy: 28.88
Round  35, Train loss: 1.174, Test loss: 1.344, Test accuracy: 50.59
Round  35, Global train loss: 1.174, Global test loss: 2.030, Global test accuracy: 32.09
Round  36, Train loss: 1.015, Test loss: 1.354, Test accuracy: 50.53
Round  36, Global train loss: 1.015, Global test loss: 2.050, Global test accuracy: 26.18
Round  37, Train loss: 0.909, Test loss: 1.380, Test accuracy: 49.34
Round  37, Global train loss: 0.909, Global test loss: 2.036, Global test accuracy: 22.71
Round  38, Train loss: 0.958, Test loss: 1.386, Test accuracy: 49.52
Round  38, Global train loss: 0.958, Global test loss: 2.154, Global test accuracy: 15.10
Round  39, Train loss: 0.828, Test loss: 1.395, Test accuracy: 50.27
Round  39, Global train loss: 0.828, Global test loss: 2.071, Global test accuracy: 22.39
Round  40, Train loss: 0.908, Test loss: 1.423, Test accuracy: 49.94
Round  40, Global train loss: 0.908, Global test loss: 1.968, Global test accuracy: 30.00
Round  41, Train loss: 0.932, Test loss: 1.429, Test accuracy: 50.00
Round  41, Global train loss: 0.932, Global test loss: 2.110, Global test accuracy: 24.17
Round  42, Train loss: 0.897, Test loss: 1.466, Test accuracy: 49.64
Round  42, Global train loss: 0.897, Global test loss: 2.059, Global test accuracy: 27.22
Round  43, Train loss: 0.839, Test loss: 1.488, Test accuracy: 49.43
Round  43, Global train loss: 0.839, Global test loss: 2.144, Global test accuracy: 18.12
Round  44, Train loss: 0.896, Test loss: 1.490, Test accuracy: 49.54
Round  44, Global train loss: 0.896, Global test loss: 2.006, Global test accuracy: 26.46
Round  45, Train loss: 0.706, Test loss: 1.514, Test accuracy: 48.99
Round  45, Global train loss: 0.706, Global test loss: 2.000, Global test accuracy: 30.20
Round  46, Train loss: 0.825, Test loss: 1.544, Test accuracy: 48.50
Round  46, Global train loss: 0.825, Global test loss: 2.089, Global test accuracy: 25.25
Round  47, Train loss: 1.030, Test loss: 1.546, Test accuracy: 48.73
Round  47, Global train loss: 1.030, Global test loss: 2.197, Global test accuracy: 16.56
Round  48, Train loss: 0.840, Test loss: 1.567, Test accuracy: 48.59
Round  48, Global train loss: 0.840, Global test loss: 2.216, Global test accuracy: 22.56
Round  49, Train loss: 0.732, Test loss: 1.588, Test accuracy: 48.80
Round  49, Global train loss: 0.732, Global test loss: 2.083, Global test accuracy: 25.81
Round  50, Train loss: 0.853, Test loss: 1.633, Test accuracy: 48.80
Round  50, Global train loss: 0.853, Global test loss: 2.104, Global test accuracy: 24.53
Round  51, Train loss: 0.724, Test loss: 1.662, Test accuracy: 48.19
Round  51, Global train loss: 0.724, Global test loss: 2.057, Global test accuracy: 27.05
Round  52, Train loss: 0.907, Test loss: 1.676, Test accuracy: 48.36
Round  52, Global train loss: 0.907, Global test loss: 2.062, Global test accuracy: 23.96
Round  53, Train loss: 0.706, Test loss: 1.699, Test accuracy: 48.64
Round  53, Global train loss: 0.706, Global test loss: 2.232, Global test accuracy: 17.81
Round  54, Train loss: 0.635, Test loss: 1.722, Test accuracy: 48.44
Round  54, Global train loss: 0.635, Global test loss: 2.036, Global test accuracy: 22.86
Round  55, Train loss: 0.734, Test loss: 1.783, Test accuracy: 48.04
Round  55, Global train loss: 0.734, Global test loss: 2.094, Global test accuracy: 22.98
Round  56, Train loss: 0.779, Test loss: 1.820, Test accuracy: 47.53
Round  56, Global train loss: 0.779, Global test loss: 2.058, Global test accuracy: 26.24
Round  57, Train loss: 0.615, Test loss: 1.798, Test accuracy: 47.97
Round  57, Global train loss: 0.615, Global test loss: 2.100, Global test accuracy: 25.06
Round  58, Train loss: 0.517, Test loss: 1.850, Test accuracy: 47.84
Round  58, Global train loss: 0.517, Global test loss: 2.114, Global test accuracy: 22.06
Round  59, Train loss: 0.469, Test loss: 1.861, Test accuracy: 47.79
Round  59, Global train loss: 0.469, Global test loss: 2.112, Global test accuracy: 22.83
Round  60, Train loss: 0.629, Test loss: 1.877, Test accuracy: 47.69
Round  60, Global train loss: 0.629, Global test loss: 2.036, Global test accuracy: 29.32
Round  61, Train loss: 0.532, Test loss: 1.936, Test accuracy: 46.83
Round  61, Global train loss: 0.532, Global test loss: 2.052, Global test accuracy: 26.17
Round  62, Train loss: 0.644, Test loss: 1.952, Test accuracy: 46.77
Round  62, Global train loss: 0.644, Global test loss: 2.063, Global test accuracy: 26.69
Round  63, Train loss: 0.510, Test loss: 1.964, Test accuracy: 46.82
Round  63, Global train loss: 0.510, Global test loss: 2.000, Global test accuracy: 28.03
Round  64, Train loss: 0.430, Test loss: 1.999, Test accuracy: 47.11
Round  64, Global train loss: 0.430, Global test loss: 1.992, Global test accuracy: 28.87
Round  65, Train loss: 0.519, Test loss: 2.021, Test accuracy: 46.96
Round  65, Global train loss: 0.519, Global test loss: 1.982, Global test accuracy: 30.41
Round  66, Train loss: 0.373, Test loss: 2.061, Test accuracy: 46.56
Round  66, Global train loss: 0.373, Global test loss: 1.872, Global test accuracy: 31.00
Round  67, Train loss: 0.518, Test loss: 2.124, Test accuracy: 46.85
Round  67, Global train loss: 0.518, Global test loss: 2.055, Global test accuracy: 26.30
Round  68, Train loss: 0.448, Test loss: 2.128, Test accuracy: 46.91
Round  68, Global train loss: 0.448, Global test loss: 2.095, Global test accuracy: 28.47
Round  69, Train loss: 0.579, Test loss: 2.157, Test accuracy: 46.93
Round  69, Global train loss: 0.579, Global test loss: 2.060, Global test accuracy: 28.79
Round  70, Train loss: 0.386, Test loss: 2.198, Test accuracy: 46.92
Round  70, Global train loss: 0.386, Global test loss: 2.018, Global test accuracy: 28.32
Round  71, Train loss: 0.392, Test loss: 2.200, Test accuracy: 46.48
Round  71, Global train loss: 0.392, Global test loss: 2.062, Global test accuracy: 22.65
Round  72, Train loss: 0.385, Test loss: 2.233, Test accuracy: 46.02
Round  72, Global train loss: 0.385, Global test loss: 2.022, Global test accuracy: 25.84
Round  73, Train loss: 0.450, Test loss: 2.272, Test accuracy: 46.33
Round  73, Global train loss: 0.450, Global test loss: 1.984, Global test accuracy: 30.45
Round  74, Train loss: 0.378, Test loss: 2.306, Test accuracy: 46.79
Round  74, Global train loss: 0.378, Global test loss: 2.017, Global test accuracy: 24.45
Round  75, Train loss: 0.454, Test loss: 2.302, Test accuracy: 47.22
Round  75, Global train loss: 0.454, Global test loss: 2.109, Global test accuracy: 21.07
Round  76, Train loss: 0.349, Test loss: 2.371, Test accuracy: 47.11
Round  76, Global train loss: 0.349, Global test loss: 2.138, Global test accuracy: 21.89
Round  77, Train loss: 0.287, Test loss: 2.364, Test accuracy: 47.40
Round  77, Global train loss: 0.287, Global test loss: 2.050, Global test accuracy: 26.37
Round  78, Train loss: 0.328, Test loss: 2.375, Test accuracy: 47.58
Round  78, Global train loss: 0.328, Global test loss: 1.990, Global test accuracy: 31.87
Round  79, Train loss: 0.351, Test loss: 2.415, Test accuracy: 47.41
Round  79, Global train loss: 0.351, Global test loss: 2.097, Global test accuracy: 27.87
Round  80, Train loss: 0.377, Test loss: 2.428, Test accuracy: 47.21
Round  80, Global train loss: 0.377, Global test loss: 2.016, Global test accuracy: 25.90
Round  81, Train loss: 0.365, Test loss: 2.433, Test accuracy: 47.30
Round  81, Global train loss: 0.365, Global test loss: 2.221, Global test accuracy: 20.13
Round  82, Train loss: 0.422, Test loss: 2.468, Test accuracy: 47.14
Round  82, Global train loss: 0.422, Global test loss: 2.033, Global test accuracy: 26.91
Round  83, Train loss: 0.377, Test loss: 2.475, Test accuracy: 47.00
Round  83, Global train loss: 0.377, Global test loss: 2.074, Global test accuracy: 20.07
Round  84, Train loss: 0.299, Test loss: 2.544, Test accuracy: 46.62
Round  84, Global train loss: 0.299, Global test loss: 2.197, Global test accuracy: 18.93
Round  85, Train loss: 0.274, Test loss: 2.573, Test accuracy: 46.31
Round  85, Global train loss: 0.274, Global test loss: 2.055, Global test accuracy: 22.41
Round  86, Train loss: 0.303, Test loss: 2.622, Test accuracy: 46.27
Round  86, Global train loss: 0.303, Global test loss: 2.096, Global test accuracy: 22.10
Round  87, Train loss: 0.314, Test loss: 2.642, Test accuracy: 46.19
Round  87, Global train loss: 0.314, Global test loss: 2.160, Global test accuracy: 21.99
Round  88, Train loss: 0.280, Test loss: 2.673, Test accuracy: 46.09
Round  88, Global train loss: 0.280, Global test loss: 2.064, Global test accuracy: 26.87
Round  89, Train loss: 0.223, Test loss: 2.664, Test accuracy: 46.30
Round  89, Global train loss: 0.223, Global test loss: 2.056, Global test accuracy: 23.76
Round  90, Train loss: 0.305, Test loss: 2.657, Test accuracy: 46.27
Round  90, Global train loss: 0.305, Global test loss: 2.103, Global test accuracy: 22.95
Round  91, Train loss: 0.233, Test loss: 2.709, Test accuracy: 46.76
Round  91, Global train loss: 0.233, Global test loss: 2.136, Global test accuracy: 19.98
Round  92, Train loss: 0.206, Test loss: 2.730, Test accuracy: 46.96
Round  92, Global train loss: 0.206, Global test loss: 1.899, Global test accuracy: 29.65
Round  93, Train loss: 0.214, Test loss: 2.750, Test accuracy: 46.69
Round  93, Global train loss: 0.214, Global test loss: 1.970, Global test accuracy: 27.39
Round  94, Train loss: 0.261, Test loss: 2.773, Test accuracy: 46.98
Round  94, Global train loss: 0.261, Global test loss: 2.147, Global test accuracy: 21.19
Round  95, Train loss: 0.313, Test loss: 2.828, Test accuracy: 46.76
Round  95, Global train loss: 0.313, Global test loss: 2.233, Global test accuracy: 23.15
Round  96, Train loss: 0.230, Test loss: 2.879, Test accuracy: 46.95
Round  96, Global train loss: 0.230, Global test loss: 2.086, Global test accuracy: 23.41
Round  97, Train loss: 0.243, Test loss: 2.918, Test accuracy: 47.01
Round  97, Global train loss: 0.243, Global test loss: 2.136, Global test accuracy: 22.16
Round  98, Train loss: 0.331, Test loss: 2.945, Test accuracy: 46.70
Round  98, Global train loss: 0.331, Global test loss: 2.076, Global test accuracy: 23.14
Round  99, Train loss: 0.216, Test loss: 2.909, Test accuracy: 46.86
Round  99, Global train loss: 0.216, Global test loss: 2.059, Global test accuracy: 26.58
Final Round, Train loss: 0.209, Test loss: 3.098, Test accuracy: 46.34
Final Round, Global train loss: 0.209, Global test loss: 2.059, Global test accuracy: 26.58
Average accuracy final 10 rounds: 46.794000000000004 

Average global accuracy final 10 rounds: 23.96 

1443.3417377471924
[1.50217866897583, 3.00435733795166, 4.251810550689697, 5.499263763427734, 6.740274906158447, 7.98128604888916, 9.227813720703125, 10.47434139251709, 11.715726137161255, 12.95711088180542, 14.201376676559448, 15.445642471313477, 16.687685251235962, 17.929728031158447, 19.16481637954712, 20.39990472793579, 21.63744831085205, 22.87499189376831, 24.11284613609314, 25.35070037841797, 26.59312891960144, 27.835557460784912, 29.081494331359863, 30.327431201934814, 31.577775716781616, 32.82812023162842, 34.07244253158569, 35.31676483154297, 36.5595440864563, 37.80232334136963, 39.043710470199585, 40.28509759902954, 41.523993253707886, 42.76288890838623, 44.001067876815796, 45.23924684524536, 46.48414731025696, 47.729047775268555, 48.966715812683105, 50.204383850097656, 51.45034623146057, 52.696308612823486, 53.942397594451904, 55.18848657608032, 56.43194317817688, 57.67539978027344, 58.922759771347046, 60.170119762420654, 61.41799473762512, 62.66586971282959, 63.90576481819153, 65.14565992355347, 66.38314175605774, 67.62062358856201, 68.84999632835388, 70.07936906814575, 71.31264925003052, 72.54592943191528, 73.78712964057922, 75.02832984924316, 76.26532030105591, 77.50231075286865, 78.73755311965942, 79.9727954864502, 81.20531678199768, 82.43783807754517, 83.66980075836182, 84.90176343917847, 86.12927293777466, 87.35678243637085, 88.58856081962585, 89.82033920288086, 91.05582356452942, 92.29130792617798, 93.51620197296143, 94.74109601974487, 95.9766993522644, 97.21230268478394, 98.44517803192139, 99.67805337905884, 100.90954113006592, 102.141028881073, 103.37327527999878, 104.60552167892456, 105.84589314460754, 107.08626461029053, 108.32125926017761, 109.5562539100647, 110.798255443573, 112.0402569770813, 113.27625298500061, 114.51224899291992, 115.74918103218079, 116.98611307144165, 118.21604681015015, 119.44598054885864, 120.67498588562012, 121.90399122238159, 123.13559794425964, 124.3672046661377, 125.59326791763306, 126.81933116912842, 128.05734038352966, 129.2953495979309, 130.52903819084167, 131.76272678375244, 132.99224638938904, 134.22176599502563, 135.45892643928528, 136.69608688354492, 137.92902088165283, 139.16195487976074, 140.38134479522705, 141.60073471069336, 142.8343629837036, 144.06799125671387, 145.30688643455505, 146.54578161239624, 147.78554701805115, 149.02531242370605, 150.2679238319397, 151.51053524017334, 152.7506365776062, 153.99073791503906, 155.2329661846161, 156.47519445419312, 157.71973633766174, 158.96427822113037, 160.2073769569397, 161.45047569274902, 162.6996214389801, 163.94876718521118, 165.19400310516357, 166.43923902511597, 167.68208718299866, 168.92493534088135, 170.17054963111877, 171.4161639213562, 172.65694546699524, 173.89772701263428, 175.14239525794983, 176.38706350326538, 177.63268899917603, 178.87831449508667, 180.11780333518982, 181.35729217529297, 182.59856295585632, 183.83983373641968, 185.08595490455627, 186.33207607269287, 187.57170581817627, 188.81133556365967, 190.05239248275757, 191.29344940185547, 192.53475666046143, 193.77606391906738, 195.01167798042297, 196.24729204177856, 197.48783087730408, 198.7283697128296, 199.9635956287384, 201.19882154464722, 202.44050431251526, 203.6821870803833, 204.9182448387146, 206.1543025970459, 207.3925507068634, 208.6307988166809, 209.87033033370972, 211.10986185073853, 212.34984397888184, 213.58982610702515, 214.82665491104126, 216.06348371505737, 217.30846619606018, 218.553448677063, 219.79380631446838, 221.03416395187378, 222.27275466918945, 223.51134538650513, 224.75677371025085, 226.00220203399658, 227.2406461238861, 228.47909021377563, 229.71647882461548, 230.95386743545532, 232.19298028945923, 233.43209314346313, 234.6644320487976, 235.89677095413208, 237.1408495903015, 238.38492822647095, 239.61582851409912, 240.8467288017273, 242.08091259002686, 243.31509637832642, 244.54910707473755, 245.78311777114868, 247.02018284797668, 248.2572479248047, 250.73248028755188, 253.20771265029907]
[16.23, 16.23, 24.07, 24.07, 32.6, 32.6, 36.91, 36.91, 38.13, 38.13, 38.82, 38.82, 41.7, 41.7, 42.18, 42.18, 43.11, 43.11, 44.18, 44.18, 45.3, 45.3, 45.26, 45.26, 46.05, 46.05, 48.85, 48.85, 48.66, 48.66, 48.2, 48.2, 49.16, 49.16, 50.25, 50.25, 50.08, 50.08, 50.64, 50.64, 50.7, 50.7, 51.14, 51.14, 51.2, 51.2, 51.45, 51.45, 51.34, 51.34, 50.79, 50.79, 50.23, 50.23, 50.84, 50.84, 50.59, 50.59, 50.6, 50.6, 50.5, 50.5, 50.79, 50.79, 51.06, 51.06, 50.97, 50.97, 51.13, 51.13, 50.59, 50.59, 50.53, 50.53, 49.34, 49.34, 49.52, 49.52, 50.27, 50.27, 49.94, 49.94, 50.0, 50.0, 49.64, 49.64, 49.43, 49.43, 49.54, 49.54, 48.99, 48.99, 48.5, 48.5, 48.73, 48.73, 48.59, 48.59, 48.8, 48.8, 48.8, 48.8, 48.19, 48.19, 48.36, 48.36, 48.64, 48.64, 48.44, 48.44, 48.04, 48.04, 47.53, 47.53, 47.97, 47.97, 47.84, 47.84, 47.79, 47.79, 47.69, 47.69, 46.83, 46.83, 46.77, 46.77, 46.82, 46.82, 47.11, 47.11, 46.96, 46.96, 46.56, 46.56, 46.85, 46.85, 46.91, 46.91, 46.93, 46.93, 46.92, 46.92, 46.48, 46.48, 46.02, 46.02, 46.33, 46.33, 46.79, 46.79, 47.22, 47.22, 47.11, 47.11, 47.4, 47.4, 47.58, 47.58, 47.41, 47.41, 47.21, 47.21, 47.3, 47.3, 47.14, 47.14, 47.0, 47.0, 46.62, 46.62, 46.31, 46.31, 46.27, 46.27, 46.19, 46.19, 46.09, 46.09, 46.3, 46.3, 46.27, 46.27, 46.76, 46.76, 46.96, 46.96, 46.69, 46.69, 46.98, 46.98, 46.76, 46.76, 46.95, 46.95, 47.01, 47.01, 46.7, 46.7, 46.86, 46.86, 46.34, 46.34]
